<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2961075-A1" country="EP" doc-number="2961075" kind="A1" date="20151230" family-id="36570641" file-reference-id="287040" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160451257" ucid="EP-2961075-A1"><document-id><country>EP</country><doc-number>2961075</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-15170466-A" is-representative="NO"><document-id mxw-id="PAPP193865482" load-source="patent-office" format="original"><country>EP</country><doc-number>15170466.5</doc-number><date>20060307</date><lang>EN</lang></document-id><document-id mxw-id="PAPP193865483" load-source="docdb" format="epo"><country>EP</country><doc-number>15170466</doc-number><kind>A</kind><date>20060307</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162032204" ucid="EP-06737468-A" linkage-type="3" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>06737468</doc-number><kind>A</kind><date>20060307</date></document-id></priority-claim><priority-claim mxw-id="PPC162028349" ucid="EP-10011616-A" linkage-type="3" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>10011616</doc-number><kind>A</kind><date>20060307</date></document-id></priority-claim><priority-claim mxw-id="PPC162030005" ucid="US-17560705-A" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>17560705</doc-number><kind>A</kind><date>20050705</date></document-id></priority-claim><priority-claim mxw-id="PPC162032147" ucid="US-65952605-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>65952605</doc-number><kind>P</kind><date>20050307</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1987782704" load-source="docdb">H04B   1/69        20060101AFI20151126BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988525675" load-source="docdb">H04L  27/26        20060101ALI20151126BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988526181" load-source="docdb">H04L   5/00        20060101ALI20151126BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1927395877" load-source="docdb" scheme="CPC">H04L2025/03624     20130101 LA20160614BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1927395878" load-source="docdb" scheme="CPC">H04L  27/2613      20130101 LI20160614BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1927395879" load-source="docdb" scheme="CPC">H04L  25/025       20130101 LI20160614BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1927395880" load-source="docdb" scheme="CPC">H04L  25/023       20130101 LI20160614BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1927395881" load-source="docdb" scheme="CPC">H04L  25/022       20130101 LA20160614BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1927395882" load-source="docdb" scheme="CPC">H04L  25/0212      20130101 LA20160614BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1927395883" load-source="docdb" scheme="CPC">H04L   5/0048      20130101 LA20160614BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1927395884" load-source="docdb" scheme="CPC">H04L   5/0007      20130101 LA20160614BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1927395885" load-source="docdb" scheme="CPC">H04B   1/69        20130101 FI20160614BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165545237" lang="DE" load-source="patent-office">PILOTÜBERTRAGUNG UND KANALSCHÄTZUNG FÜR EIN KOMMUNIKATIONSSYSTEM MIT FREQUENZMULTIPLEXING</invention-title><invention-title mxw-id="PT165545238" lang="EN" load-source="patent-office">PILOT TRANSMISSION AND CHANNEL ESTIMATION FOR A COMMUNICATION SYSTEM UTILIZING FREQUENCY DIVISION MULTIPLEXING</invention-title><invention-title mxw-id="PT165545239" lang="FR" load-source="patent-office">TRANSMISSION DE PILOTE ET ESTIMATION DE CANAL POUR SYSTÈME DE COMMUNICATION UTILISANT UN MULTIPLEXAGE PAR DIVISION DE FRÉQUENCE</invention-title><citations><patent-citations><patcit mxw-id="PCIT335745973" load-source="docdb" ucid="EP-1414177-A1"><document-id format="epo"><country>EP</country><doc-number>1414177</doc-number><kind>A1</kind><date>20040428</date></document-id><sources><source name="SEA" category="Y" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT335746205" load-source="docdb" ucid="EP-1445873-A2"><document-id format="epo"><country>EP</country><doc-number>1445873</doc-number><kind>A2</kind><date>20040811</date></document-id><sources><source name="SEA" category="A" created-by-npl="N"/></sources></patcit></patent-citations><non-patent-citations><nplcit><text>ISABELLA DE BROECK: "Interleaved Frequency-Division Multiple-Access", INTERNET CITATION, 28 January 2005 (2005-01-28), XP002424443, Retrieved from the Internet &lt;URL:http://elib.tu-darmstadt.de/diss/000525/&gt; [retrieved on 20070313]</text><sources><source mxw-id="PNPL57906834" load-source="docdb" name="SEA" category="Y"/></sources></nplcit><nplcit><text>None</text><sources><source mxw-id="PNPL62141702" load-source="docdb" name="APP"/></sources></nplcit></non-patent-citations></citations></technical-data><related-documents><relation type="division"><child-doc ucid="EP-15170466-A"><document-id load-source="patent-office" format="epo"><country>EP</country><doc-number>15170466</doc-number><kind>A</kind><date>20060307</date></document-id><document-id load-source="patent-office" format="original"><country>EP</country><doc-number>15170466.5</doc-number><date>20060307</date></document-id></child-doc><parent-doc ucid="EP-06737468-A"><document-id load-source="patent-office" format="epo"><country>EP</country><doc-number>06737468</doc-number><kind>A</kind><date>20060307</date></document-id><document-id load-source="patent-office" format="original"><country>EP</country><doc-number>06737468.6</doc-number><date>20060307</date></document-id><parent-grant-document ucid="EP-1867063-B1"><document-id><country>EP</country><doc-number>1867063</doc-number><kind>B1</kind><date>20130515</date></document-id></parent-grant-document></parent-doc></relation><relation type="division"><child-doc ucid="EP-15170466-A"><document-id load-source="patent-office" format="epo"><country>EP</country><doc-number>15170466</doc-number><kind>A</kind><date>20060307</date></document-id><document-id load-source="patent-office" format="original"><country>EP</country><doc-number>15170466.5</doc-number><date>20060307</date></document-id></child-doc><parent-doc ucid="EP-10011616-A"><document-id load-source="patent-office" format="epo"><country>EP</country><doc-number>10011616</doc-number><kind>A</kind><date>20100929</date></document-id><document-id load-source="patent-office" format="original"><country>EP</country><doc-number>10011616.9</doc-number><date>20100929</date></document-id></parent-doc></relation></related-documents><parties><applicants><applicant mxw-id="PPAR1103336377" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>QUALCOMM INC</last-name><address><country>US</country></address></addressbook></applicant><applicant mxw-id="PPAR1103304628" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>QUALCOMM INCORPORATED</last-name></addressbook></applicant><applicant mxw-id="PPAR1101652554" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Qualcomm Incorporated</last-name><iid>100204376</iid><address><street>5775 Morehouse Drive</street><city>San Diego, CA 92121-1714</city><country>US</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103317189" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>PALANKI RAVI</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR1103319491" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>PALANKI, RAVI</last-name></addressbook></inventor><inventor mxw-id="PPAR1101650852" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>PALANKI, RAVI</last-name><address><street>c/o QUALCOMM Incorporated 5775 Morehouse Drive</street><city>San Diego, CA, 92121-1714</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR1103312902" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>KHANDEKAR AAMOD D</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR1103325266" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>KHANDEKAR, AAMOD D.</last-name></addressbook></inventor><inventor mxw-id="PPAR1101647527" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>KHANDEKAR, AAMOD D.</last-name><address><street>c/o Qualcomm Incorporated 5775 Morehouse Drive</street><city>San Diego, CA, 92121</city><country>US</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR1101649338" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Wegner, Hans</last-name><iid>101259466</iid><address><street>Bardehle Pagenberg Partnerschaft mbB Patentanwälte, Rechtsanwälte Prinzregentenplatz 7</street><city>81675 München</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS660681994" load-source="docdb">AT</country><country mxw-id="DS660607269" load-source="docdb">BE</country><country mxw-id="DS660782416" load-source="docdb">BG</country><country mxw-id="DS660682575" load-source="docdb">CH</country><country mxw-id="DS660607270" load-source="docdb">CY</country><country mxw-id="DS660607665" load-source="docdb">CZ</country><country mxw-id="DS660604573" load-source="docdb">DE</country><country mxw-id="DS660607275" load-source="docdb">DK</country><country mxw-id="DS660607276" load-source="docdb">EE</country><country mxw-id="DS660682135" load-source="docdb">ES</country><country mxw-id="DS660782417" load-source="docdb">FI</country><country mxw-id="DS660782418" load-source="docdb">FR</country><country mxw-id="DS660604574" load-source="docdb">GB</country><country mxw-id="DS660607277" load-source="docdb">GR</country><country mxw-id="DS660607666" load-source="docdb">HU</country><country mxw-id="DS660682576" load-source="docdb">IE</country><country mxw-id="DS660607278" load-source="docdb">IS</country><country mxw-id="DS660782419" load-source="docdb">IT</country><country mxw-id="DS660607283" load-source="docdb">LI</country><country mxw-id="DS660604579" load-source="docdb">LT</country><country mxw-id="DS660681999" load-source="docdb">LU</country><country mxw-id="DS660782420" load-source="docdb">LV</country><country mxw-id="DS660604580" load-source="docdb">MC</country><country mxw-id="DS660682000" load-source="docdb">NL</country><country mxw-id="DS660682001" load-source="docdb">PL</country><country mxw-id="DS660682136" load-source="docdb">PT</country><country mxw-id="DS660684960" load-source="docdb">RO</country><country mxw-id="DS660682002" load-source="docdb">SE</country><country mxw-id="DS660604581" load-source="docdb">SI</country><country mxw-id="DS660682577" load-source="docdb">SK</country><country mxw-id="DS660607284" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA166479627" lang="EN" load-source="patent-office"><p id="pa01" num="0001">In a wireless communication system, an apparatus is adapted to inter alia receive, from a user equipment, at least one single-carrier frequency division multiple access, SC-FDMA, symbol transmitted on the frequency resources assigned to the user equipment and comprising one or more pilot symbols generated based on a polyphase sequence, to remove a cyclic prefix in each of the at least one SC-FDMA symbol, and to demodulate the at least one SC-FDMA symbol to obtain received pilot symbols. Another apparatus is adapted to inter alia generate at least one single-carrier frequency division multiple access (SC-FDMA) symbol comprising the sequence of pilot symbols, and to transmit the at least one SC-FDMA symbol using frequency resources assigned to the apparatus.
<img id="iaf01" file="imgaf001.tif" wi="165" he="58" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA166759439" lang="EN" source="EPO" load-source="docdb"><p>In a wireless communication system, an apparatus is adapted to inter alia receive, from a user equipment, at least one single-carrier frequency division multiple access, SC-FDMA, symbol transmitted on the frequency resources assigned to the user equipment and comprising one or more pilot symbols generated based on a polyphase sequence, to remove a cyclic prefix in each of the at least one SC-FDMA symbol, and to demodulate the at least one SC-FDMA symbol to obtain received pilot symbols. Another apparatus is adapted to inter alia generate at least one single-carrier frequency division multiple access (SC-FDMA) symbol comprising the sequence of pilot symbols, and to transmit the at least one SC-FDMA symbol using frequency resources assigned to the apparatus.</p></abstract><description mxw-id="PDES98404328" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><b>BACKGROUND</b></heading><heading id="h0002"><b>Claim of Priority under 35 U.S.C. §119</b></heading><p id="p0001" num="0001">The present Application for Patent claims priority to Provisional Application No. <patcit id="pcit0001" dnum="US60659526B"><text>60/659,526</text></patcit> entitled "Estimation for Pilot Design and Channel Interleaved Frequency Division Multiple Access Communication" filed March 7, 2005, and assigned to the assignee hereof and hereby expressly incorporated by reference herein.</p><heading id="h0003"><b>I. Field</b></heading><p id="p0002" num="0002">The present invention relates generally to communication, and more specifically to pilot transmission and channel estimation for a communication system.</p><heading id="h0004"><b>II. Background</b></heading><p id="p0003" num="0003">Orthogonal frequency division multiplexing (OFDM) is a multi-carrier modulation technique that partitions the overall system bandwidth into multiple (K) orthogonal subbands. These subbands are also called tones, subcarriers, and frequency bins. With OFDM, each subband is associated with a respective subcarrier that may be modulated with data.</p><p id="p0004" num="0004">OFDM has certain desirable characteristics such as high spectral efficiency and robustness against multipath effects. However, a major drawback with OFDM is a high peak-to-average power ratio (PAPR), which means that the ratio of the peak power to the average power of an OFDM waveform can be high. The high PAPR for the OFDM waveform results from possible in-phase (or coherent) addition of all the subcarriers when they are independently modulated with data. In fact, it can be shown that the peak power can be up to K times greater than the average power for OFDM.</p><p id="p0005" num="0005">The high PAPR for the OFDM waveform is undesirable and may degrade performance. For example, large peaks in the OFDM waveform may cause a power amplifier to operate in a highly non-linear region or possibly clip, which would then cause intermodulation distortion and other artifacts that can degrade signal quality. The<!-- EPO <DP n="2"> --> degraded signal quality can adversely affect performance for channel estimation, data detection, and so on.</p><p id="p0006" num="0006">There is therefore a need in the art for techniques that can mitigate the deleterious effects of high PAPR in multi-carrier modulation.</p><heading id="h0005"><b>SUMMARY</b></heading><p id="p0007" num="0007">Pilot transmission techniques that can avoid high PAPR and channel estimation techniques are described herein. A pilot may be generated based on a polyphase sequence and using single-carrier frequency division multiple access (SC-FDMA). A polyphase sequence is a sequence that has good temporal characteristics (e.g., a constant time-domain envelope) and good spectral characteristics (e.g., a flat frequency spectrum). SC-FDMA includes (1) interleaved FDMA (IFDMA) which transmits data and/or pilot on subbands that are uniformly spaced apart across the K total subbands and (2) localized FDMA (LFDMA) which transmits data and/or pilot typically on adjacent subbands among the K total subbands. IFDMA is also called distributed FDMA, and LFDMA is also called narrowband FDMA.</p><p id="p0008" num="0008">In an embodiment for pilot transmission using IFDMA, a first sequence of pilot symbols is formed based on a polyphase sequence and is replicated multiple times to obtain a second sequence of pilot symbols. A phase ramp may be applied to the second sequence of pilot symbols to obtain a third sequence of output symbols. A cyclic prefix is appended to the third sequence of output symbols to form an IFDMA symbol, which is transmitted in the time domain via a communication channel. The pilot symbols may be multiplexed with data symbols using time division multiplexing (TDM), code division multiplexing (CDM), and/or some other multiplexing scheme.</p><p id="p0009" num="0009">In an embodiment for pilot transmission using LFDMA, a first sequence of pilot symbols is formed based on a polyphase sequence and is transformed to the frequency domain to obtain a second sequence of frequency-domain symbols. A third sequence of symbols is formed with the second sequence of frequency-domain symbols mapped onto a group of subbands used for pilot transmission and zero symbols mapped onto the remaining subbands. The third sequence of symbols is transformed to the time domain to obtain a fourth sequence of output symbols. A cyclic prefix is appended to the fourth sequence of output symbols to form an LFDMA symbol, which is transmitted in the time domain via a communication channel.<!-- EPO <DP n="3"> --></p><p id="p0010" num="0010">In an embodiment for channel estimation, at least one SC-FDMA symbol is received via the communication channel and processed (e.g., demultiplexed for a TDM pilot or dechannelized for a CDM pilot) to obtain received pilot symbols. An SC-FDMA symbol may be an IFDMA symbol or an LFDMA symbol. A channel estimate is derived based on the received pilot symbols and using a minimum mean-square error (MMSE) technique, a least-squares (LS) technique, or some other channel estimation technique. Filtering, thresholding, truncation, and/or tap selection may be performed to obtain an improved channel estimate. The channel estimate may also be improved by performing iterative channel estimation or data-aided channel estimation.</p><p id="p0011" num="0011">Various aspects and embodiments of the invention are described in further detail below.</p><heading id="h0006"><b>BRIEF DESCRIPTION OF THE DRAWINGS</b></heading><p id="p0012" num="0012">The features and nature of the present invention will become more apparent from the detailed description set forth below when taken in conjunction with the drawings in which like reference characters identify correspondingly throughout.
<ul><li><figref idrefs="f0001">FIG. 1</figref> shows an interlace subband structure for a communication system.</li><li><figref idrefs="f0002">FIG. 2</figref> shows generation of an IFDMA symbol for one set of N subbands.</li><li><figref idrefs="f0003">FIG. 3</figref> shows a narrowband subband structure.</li><li><figref idrefs="f0004">FIG. 4</figref> shows generation of an LFDMA symbol for one group of N subbands.</li><li><figref idrefs="f0005">FIGS. 5A</figref> and <figref idrefs="f0006">5B</figref> show two TDM pilot schemes with pilot and data being multiplexed across symbol periods and sample periods, respectively.</li><li><figref idrefs="f0007">FIGS. 5C and 5D</figref> show two CDM pilot schemes with pilot and data being combined across symbol periods and sample periods, respectively.</li><li><figref idrefs="f0008">FIG. 6</figref> shows a wideband pilot time division multiplexed with data.</li><li><figref idrefs="f0009">FIG. 7A</figref> shows a process for generating a pilot IFDMA symbol.</li><li><figref idrefs="f0009">FIG. 7B</figref> shows a process for generating a pilot IFDMA symbol.</li><li><figref idrefs="f0010">FIG. 8</figref> shows a process for performing channel estimation.</li><li><figref idrefs="f0011">FIG. 9</figref> shows a block diagram of a transmitter and a receiver.</li><li><figref idrefs="f0012">FIGS. 10A and 10B</figref> show transmit (TX) data and pilot processors for the TDM pilot schemes and the CDM pilot schemes, respectively.</li><li><figref idrefs="f0012">FIGS. 11A and 11B</figref> show FDMA and LFDMA modulators, respectively.<!-- EPO <DP n="4"> --></li><li><figref idrefs="f0013">FIGS. 12A and 12B</figref> show IFDMA demodulators for TDM and CDM pilots, respectively.</li><li><figref idrefs="f0014">FIGS. 13A and 13B</figref> show LFDMA demodulators for TDM and CDM pilots, respectively.</li></ul></p><heading id="h0007"><b>DETAILED DESCRIPTION</b></heading><p id="p0013" num="0013">The word "exemplary" is used herein to mean "serving as an example, instance, or illustration." Any embodiment or design described herein as "exemplary" is not necessarily to be construed as preferred or advantageous over other embodiments or designs.</p><p id="p0014" num="0014">The pilot transmission and channel estimation techniques described herein may be used for various communication systems that utilize multi-carrier modulation or perform frequency division multiplexing. For example, these techniques may be used for a frequency division multiple access (FDMA) system, an orthogonal frequency division multiple access (OFDMA) system, an SC-FDMA system, an IFDMA system, an LFDMA system, an OFDM-based system, and so on. These techniques may also be used for the forward link (or downlink) and the reverse link (or uplink).</p><p id="p0015" num="0015"><figref idrefs="f0001"><b>FIG. 1</b></figref> shows an exemplary subband structure 100 that may be used for a communication system. The system has an overall bandwidth of BW MHz, which is partitioned into K orthogonal subbands that are given indices of 1 through K. The spacing between adjacent subbands is BW/K MHz. In a spectrally shaped system, some subbands on both ends of the system bandwidth are not used for data/pilot transmission and serve as guard subbands to allow the system to meet spectral mask requirements. Alternatively, the K subbands may be defined over the usable portion of the system bandwidth. For simplicity, the following description assumes that all K total subbands may be used for data/pilot transmission.</p><p id="p0016" num="0016">For subband structure 100, the K total subbands are arranged into S disjoint subband sets, which are also called interlaces. The S sets are disjoint or non-overlapping in that each of the K subbands belongs in only one set. Each set contains N subbands that are uniformly distributed across the K total subbands such that consecutive subbands in the set are spaced apart by S subbands, where K = S ·N. Thus, set <i>u</i> contains subbands <i>u</i>, S + <i>u ,</i> 2S + <i>u, ... ,</i> (N -1) · S + <i>u</i> , where <i>u</i> is the set index and <i>u</i> ∈ {1,...,S}. Index <i>u</i> is also a subband offset that indicates the first subband in the set.<!-- EPO <DP n="5"> --> The N subbands in each set are interlaced with the N subbands in each of the other S -1 sets.</p><p id="p0017" num="0017"><figref idrefs="f0001">FIG. 1</figref> shows a specific subband structure. In general, a subband structure may include any number of subband sets, and each set may include any number of subbands. The sets may include the same or different numbers of subbands. For example, some sets may include N subbands while other sets may include 2N, 4N or some other number of subbands. The subbands in each set are uniformly distributed (i.e., evenly spaced) across the K total subbands in order to achieve the benefits described below. For simplicity, the following description assumes the use of subband structure 100 in <figref idrefs="f0001">FIG. 1</figref>.</p><p id="p0018" num="0018">The S subband sets may be viewed as S channels that may be used for data and pilot transmission. For example, each user may be assigned one subband set, and data and pilot for each user may be sent on the assigned subband set. S users may simultaneously transmit data/pilot on the S subband sets via the reverse link to a base station. The base station may also simultaneously transmit data/pilot on the S subband sets via the forward link to S users. For each link, up to N modulation symbols may be sent in each symbol period (in time or frequency) on the N subbands in each set without causing interference to the other subband sets. A modulation symbol is a complex value for a point in a signal constellation (e.g., for M-PSK, M-QAM, and so on).</p><p id="p0019" num="0019">For OFDM, modulation symbols are transmitted in the frequency domain. For each subband set, N modulation symbols may be transmitted on the N subbands in each symbol period. In the following description, a symbol period is the time duration of one OFDM symbol, one IFDMA symbol, or one LFDMA symbol. One modulation symbol is mapped to each of the N subbands used for transmission, and a zero symbol (which is a signal value of zero) is mapped to each of the K-N unused subbands. The K modulation and zero symbols are transformed from the frequency domain to the time domain by performing a K-point inverse fast Fourier transform (IFFT) on the K modulation and zero symbols to obtain K time-domain samples. The time-domain samples can have high PAPR.</p><p id="p0020" num="0020"><figref idrefs="f0002">FIG. 2</figref> shows the generation of an IFDMA symbol for one set of N subbands. An original sequence of N modulation symbols to be transmitted in one symbol period on the N subbands in set <i>u</i> is denoted as {<i>d</i><sub>1</sub>,<i>d<sub>2</sub></i>,<i>d</i><sub>3</sub><i>,...,d</i><sub>N</sub>} (block 210). The original sequence of N modulation symbols is replicated S times to obtain an<!-- EPO <DP n="6"> --> extended sequence of K modulation symbols (block 212). The N modulation symbols are sent in the time domain and collectively occupy N subbands in the frequency domain. The S copies of the original sequence result in the N occupied subbands being spaced apart by S subbands, with S-1 subbands of zero power separating adjacent occupied subbands. The extended sequence has a comb-like frequency spectrum that occupies subband set 1 in <figref idrefs="f0001">FIG. 1</figref>.</p><p id="p0021" num="0021">The extended sequence is multiplied with a phase ramp to obtain a frequency-translated sequence of output symbols (block 214). Each output symbol in the frequency-translated sequence may be generated as follows: <maths id="math0001" num="eq (1)"><math display="block"><mrow><msub><mi>x</mi><mi>n</mi></msub><mo>=</mo><msub><mi>d</mi><mi>n</mi></msub><mo>⋅</mo><msup><mi>e</mi><mrow><mo>-</mo><mi>j</mi><mo>⁢</mo><mn>2</mn><mo>⁢</mo><mi>π</mi><mo>⋅</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>/</mo><mi mathvariant="normal">K</mi></mrow></msup><mo>,</mo><mspace width="1em"/><mi>for</mi><mspace width="1em"/><mi>n</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi mathvariant="normal">K</mi><mo>,</mo></mrow></math><img id="ib0001" file="imgb0001.tif" wi="135" he="7" img-content="math" img-format="tif"/></maths><br/>
where <i>d<sub>n</sub></i> is the n-th modulation symbol in the extended sequence and <i>x<sub>n</sub></i> the n-th output symbol in the frequency-translated sequence. The phase ramp <i>e</i><sup>-j2π·(<i>n</i>-1)·(<i>u</i>-1)/K·</sup> has a phase slope of 2<i>π·</i> (<i>u</i> -1) / K <i>,</i> which is determined by the first subband in set <i>u.</i> The terms "<i>n</i> -1" and <i>"u -</i>1" in the exponent of the phase ramp are due to indices <i>n</i> and <i>u</i> starting with '1' instead of '0'. The multiplication with the phase ramp in the time domain translates the comb-like frequency spectrum of the extended sequence up in frequency so that the frequency-translated sequence occupies subband set <i>u</i> in the frequency domain.</p><p id="p0022" num="0022">The last C output symbols of the frequency-translated sequence are copied to the start of the frequency-translated sequence to form an IFDMA symbol that contains K+C output symbols (block 216). The C copied output symbols are often called a cyclic prefix or a guard interval, and C is the cyclic prefix length. The cyclic prefix is used to combat intersymbol interference (ISI) caused by frequency selective fading, which is a frequency response that varies across the system bandwidth. The K+C output symbols in the IFDMA symbol are transmitted in K + C sample periods, one output symbol in each sample period. A symbol period for IFDMA is the duration of one IFDMA symbol and is equal to K+C sample periods. A sample period is also often called a chip period.</p><p id="p0023" num="0023">Since the IFDMA symbol is periodic in the time domain (except for the phase ramp), the IFDMA symbol occupies a set of N equally spaced subbands starting with subband <i>u</i>. Users with different subband offsets occupy different subband sets and are orthogonal to one another, similar to OFDMA.<!-- EPO <DP n="7"> --></p><p id="p0024" num="0024"><figref idrefs="f0003"><b>FIG. 3</b></figref> shows an exemplary narrowband subband structure 300 that may be used for a communication system. For subband structure 300, the K total subbands are arranged into S non-overlapping groups. Each group contains N subbands that are adjacent to one another. In general, N &gt; 1, S &gt; 1, and K =S · N, where N and S for narrowband subband structure 300 may be the same or different from N and S for interlace subband structure 100 in <figref idrefs="f0001">FIG. 1</figref>. Group <i>v</i> contains subbands (<i>v</i> -1) · N + 1 , (<i>v</i>-1)·N + 2 , ..., <i>v</i>·N, where <i>v</i> is the group index and <i>v</i> ∈ {1, ..., S} . In general, a subband structure may include any number of groups, each group may contain any number of subbands, and the groups may contain the same or different numbers of subbands.</p><p id="p0025" num="0025"><figref idrefs="f0004"><b>FIG. 4</b></figref> shows the generation of an LFDMA symbol for one group of N subbands. An original sequence of N modulation symbols to be transmitted in one symbol period on the subband group is denoted as {<i>d</i><sub>1</sub><i>,d</i><sub>2</sub><i>,d</i><sub>3</sub><i>,...,d</i><sub>N</sub>} (block 410). The original sequence of N modulation symbols is transformed to the frequency domain with an N-point fast Fourier transform (FFT) to obtain a sequence of N frequency-domain symbols (block 412). The N frequency-domain symbols are mapped onto the N subbands used for transmission and K - N zero symbols are mapped onto the remaining K - N subbands to generate a sequence of K symbols (block 414). The N subbands used for transmission have indices of <i>k</i> + 1 through <i>k</i> + N, where 1 ≤ <i>k ≤</i> (K - N) . The sequence of K symbols is then transformed to the time domain with a K-point IFFT to obtain a sequence of K time-domain output symbols (block 416). The last C output symbols of the sequence are copied to the start of the sequence to form an LFDMA symbol that contains K + C output symbols (block 418).</p><p id="p0026" num="0026">The LFDMA symbol is generated such that it occupies a group of N adjacent subbands starting with subband <i>k</i> +1. Users may be assigned with different non-overlapping subband groups and are then orthogonal to one another, similar to OFDMA. Each user may be assigned different subband groups in different symbol periods to achieve frequency diversity. The subband groups for each user may be selected, e.g., based on a frequency hopping pattern.</p><p id="p0027" num="0027">SC-FDMA has certain desirable characteristics such as high spectral efficiency and robustness against multipath effects, similar to OFDMA. Furthermore, SC-FDMA does not have a high PAPR since the modulation symbols are sent in the time domain. The PAPR of an SC-FDMA waveform is determined by the signal points<!-- EPO <DP n="8"> --> in the signal constellation selected for use (e.g., M-PSK, M-QAM, and so on). However, the time-domain modulation symbols in SC-FDMA are prone to intersymbol interference due to a non-flat communication channel. Equalization may be performed on the received modulation symbols to mitigate the deleterious effects of intersymbol interference. The equalization requires a fairly accurate channel estimate for the communication channel, which may be obtained using the techniques described herein.</p><p id="p0028" num="0028">A transmitter may transmit a pilot to facilitate channel estimation by a receiver. A pilot is a transmission of symbols that are known <i>a priori</i> by both the transmitter and receiver. As used herein, a data symbol is a modulation symbol for data, and a pilot symbol is a modulation symbol for pilot. The data symbols and pilot symbols may be derived from the same or different signal constellations. The pilot may be transmitted in various manners, as described below.</p><p id="p0029" num="0029"><figref idrefs="f0005"><b>FIG. 5A</b></figref> shows a TDM pilot scheme 500 with pilot and data being multiplexed across symbol periods. For example, data may be sent in D<sub>1</sub> symbol periods, then pilot may be sent in the next P<sub>1</sub> symbol periods, then data may be sent in the next D<sub>1</sub> symbol periods, and so on. In general D<sub>1</sub> ≥ 1 and P<sub>1</sub> ≥ 1. For the example shown in <figref idrefs="f0005">FIG. 5A</figref>, D<sub>1</sub> &gt; 1 and P<sub>1</sub> = 1. A sequence of N data symbols may be sent on one subband set/group in each symbol period used for data transmission. A sequence of N pilot symbols may be sent on one subband set/group in each symbol period used for pilot transmission. For each symbol period, a sequence of N data or pilot symbols may be converted to an IFDMA symbol or an LFDMA symbol as described above for <figref idrefs="f0002">FIGS. 2</figref> and <figref idrefs="f0004">4</figref>, respectively. An SC-FDMA symbol may be an IFDMA symbol or an LFDMA symbol. An SC-FDMA symbol containing only pilot is called a pilot SC-FDMA symbol, which may be a pilot IFDMA symbol or a pilot LFDMA symbol. An SC-FDMA symbol containing only data is called a data SC-FDMA symbol, which may be a data IFDMA symbol or a data LFDMA symbol.</p><p id="p0030" num="0030"><figref idrefs="f0006"><b>FIG. 5B</b></figref> shows a TDM pilot scheme 510 with pilot and data being multiplexed across sample periods. For this embodiment, data and pilot are multiplexed within the same SC-FDMA symbol. For example, data symbols may be sent in D<sub>2</sub> sample periods, then pilot symbols may be sent in the next P<sub>2</sub> sample periods, then data symbols are sent in the next D<sub>2</sub> sample periods, and so on. In general D<sub>2</sub> ≥ 1 and P<sub>2</sub> ≥ 1. For the example shown in <figref idrefs="f0006">FIG. 5B</figref>, D<sub>2</sub> = 1 and P<sub>2</sub> =1. A sequence of N data<!-- EPO <DP n="9"> --> and pilot symbols may be sent on one subband set/group in each symbol period and may be converted to an SC-FDMA symbol as described above for <figref idrefs="f0002">FIGS. 2</figref> and <figref idrefs="f0004">4</figref>.</p><p id="p0031" num="0031">A TDM pilot scheme may also multiplex pilot and data across both symbol periods and sample periods. For example, data and pilot symbols may be sent in some symbol periods, only data symbols may be sent in some other symbol periods, and only pilot symbols may be sent in certain symbol periods.</p><p id="p0032" num="0032"><figref idrefs="f0007"><b>FIG. 5C</b></figref> shows a CDM pilot scheme 530 with pilot and data being combined across symbol periods. For this embodiment, a sequence of N data symbols is multiplied with a first M-chip orthogonal sequence {<i>w<sub>d</sub></i>} to obtain M sequences of scaled data symbols, where M &gt; 1. Each sequence of scaled data symbols is obtained by multiplying the original sequence of data symbols with one chip of the orthogonal sequence {<i>w<sub>d</sub></i>}. Similarly, a sequence of N pilot symbols is multiplied with a second M-chip orthogonal sequence {<i>w<sub>p</sub></i>} to obtain M sequences of scaled pilot symbols. Each sequence of scaled data symbols is then added with a corresponding sequence of scaled pilot symbols to obtain a sequence of combined symbols. M sequences of combined symbols are obtained by adding the M sequences of scaled data symbols with the M sequences of scaled pilot symbols. Each sequence of combined symbols is converted to an SC-FDMA symbol.</p><p id="p0033" num="0033">The orthogonal sequences may be Walsh sequences, OVSF sequences, and so on. For the example shown in <figref idrefs="f0007">FIG. 5C</figref>, M = 2, the first orthogonal sequence is {<i>w<sub>d</sub></i>= {+1 + 1}, and the second orthogonal sequence is {<i>w<sub>p</sub></i>} = {+1 -1}. The N data symbols are multiplied by +1 for symbol period <i>t</i> and also by +1 for symbol period <i>t</i> + 1. The N pilot symbols are multiplied by +1 for symbol period <i>t</i> and by -1 for symbol period <i>t</i> + 1.. For each symbol period, the N scaled data symbols are added with the N scaled pilot symbols to obtain N combined symbols for that symbol period.</p><p id="p0034" num="0034"><figref idrefs="f0007"><b>FIG. 5D</b></figref> shows a CDM pilot scheme 540 with pilot and data being combined across sample periods. For this embodiment, a sequence of N/M data symbols is multiplied with the M-chip orthogonal sequence {<i>w<sub>d</sub></i>} to obtain a sequence of N scaled data symbols. In particular, the first data symbol <i>d</i><sub>1</sub> <i>(t)</i> in the original sequence is multiplied with the orthogonal sequence {<i>w<sub>d</sub></i>} to obtain the first M scaled data symbols, the next data symbol d<i><sub>2</sub></i>(<i>t</i>) is multiplied with the orthogonal sequence {<i>w<sub>d</sub></i>} to obtain the next M scaled data symbols, and so on, and the last data symbol <i>d</i><sub><i>N</i>/<i>M</i></sub>(<i>t</i>) in the<!-- EPO <DP n="10"> --> original sequence is multiplied with the orthogonal sequence {<i>w<sub>d</sub></i>} to obtain the last M scaled data symbols. Similarly, a sequence of N/M pilot symbols is multiplied with the M-chip orthogonal sequence {<i>w<sub>p</sub></i>} to obtain a sequence of N scaled pilot symbols. The sequence of N scaled data symbols is added with the sequence of N scaled pilot symbols to obtain a sequence of N combined symbols, which is converted to an SC-FDMA symbol.</p><p id="p0035" num="0035">For the example shown in <figref idrefs="f0007">FIG. 5D</figref>, M = 2, the orthogonal sequence for data is {<i>w<sub>d</sub></i>} = {+1 + 1}, and the orthogonal sequence for pilot is {<i>w<sub>p</sub></i>} = {+1 -1}. A sequence of N / 2 data symbols is multiplied with the orthogonal sequence {+1 +1} to obtain a sequence of N scaled data symbols. Similarly, a sequence of N/2 pilot symbols is multiplied with the orthogonal sequence {+1 -1} to obtain a sequence of N scaled pilot symbols. For each symbol period, the N scaled data symbols are added with the N scaled pilot symbols to obtain N combined symbols for that symbol period.</p><p id="p0036" num="0036">A CDM pilot may be sent in each symbol period, as shown in <figref idrefs="f0007">FIGS. 5C and 5D</figref>. A CDM pilot may also be sent only in certain symbol periods. A pilot scheme may also use a combination of TDM and CDM. For example, a CDM pilot may be sent in some symbol periods and a TDM pilot may be sent in other symbol periods. A frequency division multiplexed (FDM) pilot may also be sent on a designated set of subbands, e.g., for the downlink.</p><p id="p0037" num="0037">For the embodiments shown in <figref idrefs="f0005 f0006 f0007">FIGS. 5A through 5D</figref>, a TDM or CDM pilot is sent on the N subbands used for data transmission. In general, the subbands used for pilot transmission (or simply, the pilot subbands) may be the same as or different from the subbands used for data transmission (or simply, the data subbands). The pilot may also be sent on fewer or more subbands than the data. The data and pilot subbands may be static for an entire transmission. Alternatively, the data and pilot subbands may hop across frequency in different time slots to achieve frequency diversity. For example, a physical channel may be associated with a frequency hopping (FH) pattern that indicates one or more specific subband sets or groups to use for the physical channel in each time slot. A time slot may span one or multiple symbol periods.</p><p id="p0038" num="0038"><figref idrefs="f0008"><b>FIG. 6</b></figref> shows a wideband pilot scheme 600, which may be more applicable for the reverse link. For this embodiment, each user transmits a wideband pilot, which is a pilot that is sent on all or most of the K total subbands, e.g., all subbands usable for transmission. The wideband pilot may be generated in the time domain (e.g., with a<!-- EPO <DP n="11"> --> pseudo-random number (PN) sequence) or in the frequency domain (e.g., using OFDM). The wideband pilot for each user may be time division multiplexed with the data transmission from that user, which may be generated using LFDMA (as shown in <figref idrefs="f0008">FIG. 6</figref>) or IFDMA (not shown in <figref idrefs="f0008">FIG. 6</figref>). The wideband pilots from all users may be transmitted in the same symbol periods, which can avoid interference from data to pilot for channel estimation. The wideband pilot from each user may be code division multiplexed (e.g., pseudo-random) with respect to the wideband pilots from other users. This may be achieved by assigning each user with a different PN sequence. The wideband pilot for each user has low peak-to-average power ratio (PAPR) and spans the entire system bandwidth, which allows a receiver to derive a wideband channel estimate for the user. For the embodiment shown in <figref idrefs="f0008">FIG. 6</figref>, the data subbands hop across frequency in different time slots. For each time slot, a channel estimate may be derived for the data subbands based on the wideband pilot.</p><p id="p0039" num="0039"><figref idrefs="f0005 f0006 f0007 f0008">FIGS. 5A through 6</figref> show exemplary pilot and data transmission schemes. The pilot and data may also be transmitted in other manners using any combination of TDM, CDM, and/or some other multiplexing schemes.</p><p id="p0040" num="0040">The TDM and CDM pilots may be generated in various manners. In an embodiment, the pilot symbols used to generate the TDM and CDM pilots are modulation symbols from a well-known signal constellation such as QPSK. A sequence of N modulation symbols may be used for the TDM pilot scheme shown in <figref idrefs="f0005">FIG. 5A</figref> and the CDM pilot scheme shown in <figref idrefs="f0007">FIG. 5C</figref>. A sequence of N/M modulation symbols may be used for the TDM pilot scheme shown in <figref idrefs="f0006">FIG. 5B</figref> and the CDM pilot scheme shown in <figref idrefs="f0007">FIG. 5D</figref>. The sequence of N modulation symbols and the sequence of N/M modulation symbols may each be selected to have (1) a frequency spectrum that is as flat as possible and (2) a temporal envelope that varies as little as possible. The flat frequency spectrum ensures that all subbands used for pilot transmission have sufficient power to allow the receiver to properly estimate the channel gains for these subbands. The constant envelope avoids distortion by circuit blocks such as a power amplifier.</p><p id="p0041" num="0041">In another embodiment, the pilot symbols used to generate the TDM and CDM pilots are formed based on a polyphase sequence that has good temporal and spectral characteristics. For example, the pilot symbols may be generated as follows: <maths id="math0002" num="eq (2)"><math display="block"><mrow><msub><mi>p</mi><mi>n</mi></msub><mo>=</mo><msup><mi>e</mi><mrow><mi>j</mi><mo>⁢</mo><msub><mi>φ</mi><mi>n</mi></msub></mrow></msup><mo>,</mo><mspace width="1em"/><mi>for</mi><mspace width="1em"/><mi>n</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi mathvariant="normal">N</mi><mo>,</mo></mrow></math><img id="ib0002" file="imgb0002.tif" wi="135" he="6" img-content="math" img-format="tif"/></maths><br/>
<!-- EPO <DP n="12"> -->where the phase <i>ϕ<sub>n</sub></i> may be derived based on any one of the following: <maths id="math0003" num="eq (3)"><math display="block"><mrow><msub><mi>φ</mi><mi>n</mi></msub><mo>=</mo><mi>π</mi><mo>⋅</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mi>n</mi><mo>,</mo></mrow></math><img id="ib0003" file="imgb0003.tif" wi="135" he="6" img-content="math" img-format="tif"/></maths> <maths id="math0004" num="eq (4)"><math display="block"><mrow><msub><mi>φ</mi><mi>n</mi></msub><mo>=</mo><mi>π</mi><mo>⋅</mo><msup><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mn>2</mn></msup><mo>,</mo></mrow></math><img id="ib0004" file="imgb0004.tif" wi="135" he="7" img-content="math" img-format="tif"/></maths> <maths id="math0005" num="eq (5)"><math display="block"><mrow><msub><mi>φ</mi><mi>n</mi></msub><mo>=</mo><mi>π</mi><mo>⋅</mo><mfenced open="[" close="]" separators=""><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mi mathvariant="normal">N</mi><mo>-</mo><mn>1</mn></mfenced></mfenced><mo>,</mo></mrow></math><img id="ib0005" file="imgb0005.tif" wi="134" he="6" img-content="math" img-format="tif"/></maths> <maths id="math0006" num="eq (6)"><math display="block"><mrow><msub><mi>φ</mi><mi>n</mi></msub><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left"><mtr><mtd><mi>π</mi><mo>⋅</mo><msup><mrow><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mrow><mn>2</mn></msup><mo>⋅</mo><mi mathvariant="normal">Q</mi><mo>/</mo><mi mathvariant="normal">N</mi></mtd><mtd><mi>for N even</mi><mo>,</mo></mtd></mtr><mtr><mtd><mi>π</mi><mo>⋅</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mi>n</mi><mo>⋅</mo><mi mathvariant="normal">Q</mi><mo>/</mo><mi mathvariant="normal">N</mi></mtd><mtd><mi>for N odd</mi><mn>.</mn></mtd></mtr></mtable></mrow></mrow></math><img id="ib0006" file="imgb0006.tif" wi="134" he="15" img-content="math" img-format="tif"/></maths><br/>
In equation (6), Q and N are relatively prime. Equation (3) is for a Golomb sequence, equation (4) is for a P3 sequence, equation (5) is for a P4 sequence, and equation (6) is for a Chu sequence. The P3, P4 and Chu sequences can have any arbitrary length.</p><p id="p0042" num="0042">The pilot symbols may also be generated as follows: <maths id="math0007" num="eq (7)"><math display="block"><mrow><msub><mi>p</mi><mrow><mfenced separators=""><mo>ℓ</mo><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mi mathvariant="normal">T</mi><mo>+</mo><mi>m</mi></mrow></msub><mo>=</mo><msub><mi>p</mi><mrow><mo>ℓ</mo><mo>,</mo><mi>m</mi></mrow></msub><mo>=</mo><msup><mi>e</mi><mrow><mi>j</mi><mo>⁢</mo><msub><mi>φ</mi><mrow><mi>t</mi><mo>,</mo><mi>m</mi></mrow></msub></mrow></msup><mo>,</mo><mspace width="1em"/><mi>for</mi><mspace width="1em"/><mrow><mo>ℓ</mo></mrow><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>T and</mi><mspace width="1em"/><mi>m</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi mathvariant="normal">T</mi><mo>,</mo></mrow></math><img id="ib0007" file="imgb0007.tif" wi="134" he="7" img-content="math" img-format="tif"/></maths><br/>
where the phase ϕ<sub>ℓ,<i>m</i></sub> may be derived based on any one of the following: <maths id="math0008" num="eq (8)"><math display="block"><mrow><msub><mi>φ</mi><mrow><mo>ℓ</mo><mo>,</mo><mi>m</mi></mrow></msub><mo>=</mo><mn>2</mn><mo>⁢</mo><mi>π</mi><mo>⋅</mo><mfenced separators=""><mo>ℓ</mo><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mfenced separators=""><mi>m</mi><mo>-</mo><mn>1</mn></mfenced><mo>/</mo><mi mathvariant="normal">T</mi><mo>,</mo></mrow></math><img id="ib0008" file="imgb0008.tif" wi="134" he="6" img-content="math" img-format="tif"/></maths> <maths id="math0009" num="eq (9)"><math display="block"><mrow><msub><mi>φ</mi><mrow><mo>ℓ</mo><mo>,</mo><mi>m</mi></mrow></msub><mo>=</mo><mo>-</mo><mfenced separators=""><mi>π</mi><mo>/</mo><mi mathvariant="normal">T</mi></mfenced><mo>⋅</mo><mfenced separators=""><mi mathvariant="normal">T</mi><mo>-</mo><mn>2</mn><mo>ℓ</mo><mo>+</mo><mn>1</mn></mfenced><mo>⋅</mo><mfenced open="[" close="]" separators=""><mfenced separators=""><mo>ℓ</mo><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mi mathvariant="normal">T</mi><mo>+</mo><mfenced separators=""><mi>m</mi><mo>-</mo><mn>1</mn></mfenced></mfenced><mo>,</mo></mrow></math><img id="ib0009" file="imgb0009.tif" wi="134" he="7" img-content="math" img-format="tif"/></maths> <maths id="math0010" num="eq (10)"><math display="block"><mrow><msub><mi>φ</mi><mrow><mo>ℓ</mo><mo>,</mo><mi>m</mi></mrow></msub><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left"><mtr><mtd><mfenced separators=""><mi>π</mi><mo>/</mo><mi mathvariant="normal">T</mi></mfenced><mo>⋅</mo><mfenced separators=""><mi mathvariant="normal">T</mi><mo>-</mo><mn>2</mn><mo>ℓ</mo><mo>+</mo><mn>1</mn></mfenced><mo>⋅</mo><mfenced open="[" close="]" separators=""><mfenced separators=""><mo>ℓ</mo><mo>-</mo><mn>1</mn></mfenced><mo>/</mo><mn>2</mn><mo>-</mo><mfenced separators=""><mi>m</mi><mo>-</mo><mn>1</mn></mfenced></mfenced></mtd><mtd><mi>for T even</mi><mo>,</mo></mtd></mtr><mtr><mtd><mfenced separators=""><mi>π</mi><mo>/</mo><mi mathvariant="normal">T</mi></mfenced><mo>⋅</mo><mfenced separators=""><mi mathvariant="normal">T</mi><mo>-</mo><mn>2</mn><mo>ℓ</mo><mo>+</mo><mn>1</mn></mfenced><mo>⋅</mo><mfenced open="[" close="]" separators=""><mfenced separators=""><mi mathvariant="normal">T</mi><mo>-</mo><mn>2</mn></mfenced><mo>/</mo><mn>2</mn><mo>-</mo><mfenced separators=""><mi>m</mi><mo>-</mo><mn>1</mn></mfenced></mfenced></mtd><mtd><mi>for T odd</mi><mn>.</mn></mtd></mtr></mtable></mrow></mrow></math><img id="ib0010" file="imgb0010.tif" wi="137" he="15" img-content="math" img-format="tif"/></maths><br/>
Equation (8) is for a Frank sequence, equation (9) is for a P1 sequence, and equation (10) is for a Px sequence. The lengths for the Frank, P1 and Px sequences are constrained to be N = T<sup>2</sup>, where T is a positive integer.</p><p id="p0043" num="0043">A sequence of pilot symbols generated based on any of the polyphase sequences described above has both a flat frequency spectrum and a constant time-domain envelope. Other polyphase sequences having good spectral characteristics (e.g., a flat or known frequency spectrum) and good temporal characteristics (e.g., a constant or known time-domain envelope) may also be used. A TDM or CDM pilot generated<!-- EPO <DP n="13"> --> with this pilot symbol sequence would then have. (1) a low PAPR, which avoids distortion by circuit elements such as a power amplifier, and (2) a flat frequency spectrum, which allows the receiver to accurately estimate the channel gains for all subbands used for pilot transmission.</p><p id="p0044" num="0044"><figref idrefs="f0009"><b>FIG. 7A</b></figref> shows a process 700 for generating a pilot IFDMA symbol. A first sequence of pilot symbols is formed based on a polyphase sequence, which may be any one of the polyphase sequences described above or some other polyphase sequence (block 710). The first sequence of pilot symbols is replicated multiple times to obtain a second sequence of pilot symbols (block 712). A phase ramp is applied to the second sequence of pilot symbols to obtain a third sequence of output symbols (block 714). The phase ramp may be applied digitally on the pilot symbols or accounted for by the frequency upconversion process. A cyclic prefix is appended to the third sequence of output symbols to obtain a fourth sequence of output symbols, which is a pilot IFDMA symbol (block 716). The pilot IFDMA symbol is transmitted in the time domain via a communication channel (block 718). Although not shown in <figref idrefs="f0009">FIG. 7A</figref> for simplicity, the pilot symbols may be multiplexed with data symbols using TDM and/or CDM, e.g., as described above for <figref idrefs="f0005 f0006 f0007">FIGS. 5A through 5D</figref>.</p><p id="p0045" num="0045"><figref idrefs="f0009"><b>FIG. 7B</b></figref> shows a process 750 for generating a pilot LFDMA symbol. A first sequence of pilot symbols is formed based on a polyphase sequence, which may be any one of the polyphase sequences described above or some other polyphase sequence (block 760). The first sequence of N pilot symbols is transformed to the frequency domain with an N-point FFT to obtain a second sequence of N frequency-domain symbols (block 762). The N frequency-domain symbols are then mapped onto N subbands used for pilot transmission and zero symbols are mapped to the remaining K-N subbands to obtain a third sequence of K symbols (block 764). The third sequence of K symbols is transformed to the time domain with a K-point IFFT to obtain a fourth sequence of K time-domain output symbols (block 766). A cyclic prefix is appended to the fourth sequence of output symbols to obtain a fifth sequence of K + C output symbols, which is a pilot LFDMA symbol (block 768). The pilot LFDMA symbol is transmitted in the time domain via a communication channel (block 770). Although not shown in <figref idrefs="f0009">FIG. 7B</figref> for simplicity, the pilot symbols may be multiplexed with data symbols using TDM and/or CDM, e.g., as described above for <figref idrefs="f0005 f0006 f0007">FIGS. 5A through 5D</figref>.<!-- EPO <DP n="14"> --></p><p id="p0046" num="0046">For both IFDMA and LFDMA, the number of subbands used for pilot transmission may be the same or different from the number of subbands used for data transmission. For example, a user may be assigned 16 subbands for data transmission and eight subbands for pilot transmission. The other eight subbands may be assigned to another user for data/pilot transmission. Multiple users may share the same subband set for interlace subband structure 100 in <figref idrefs="f0001">FIG. 1</figref> or the same subband group for narrowband subband structure 300 in <figref idrefs="f0003">FIG. 3</figref>.</p><p id="p0047" num="0047">For interlace subband structure 100 in <figref idrefs="f0001">FIG. 1</figref>, an FDM pilot may be transmitted on one or more subband sets to allow receiver to perform various functions such as, for example, channel estimation, frequency tracking, time tracking, and so on. In a first staggered FDM pilot, pilot IFDMA symbols are transmitted on subband <i>set p</i> in some symbol periods and on subband set <i>p+S</i>/<i>2</i> in other symbol periods. For example, if S = 8, then pilot IFDMA symbols may be transmitted using a staggering pattern of {3, 7}, so that pilot IFDMA symbols are sent on subband set 3, then on subband set 7, then on subband set 3, and so on. In a second staggered FDM pilot, pilot IFDMA symbols are transmitted on subband set <i>p</i>(<i>t</i>)=[<i>p</i>(<i>t</i>-1)+ Δ<i>p</i>]mod S+1 in symbol period <i>t</i>, where Δ<i>p</i> is the difference between subband set indices for two consecutive symbol periods, and the +1 is for an indexing scheme that starts with 1 instead of 0. For example, if S = 8 and Δ<i>p</i> = 3, then pilot IFDMA symbols may be transmitted using a staggering pattern of {1, 4, 7, 2, 5, 8, 3, 6}, so that pilot IFDMA symbols are sent on subband set 1, then on subband set 4, then on subband set 7, and so on. Other staggering patterns may also be used. A staggered FDM pilot allows the receiver to obtain channel gain estimates for more subbands, which may improve channel estimation and detection performance.</p><p id="p0048" num="0048"><figref idrefs="f0010"><b>FIG. 8</b></figref> shows a process 800 performed by a receiver to estimate the response of the communication channel based on a TDM pilot or a CDM pilot sent by the transmitter. The receiver obtains an SC-FDMA symbol for each symbol period and removes the cyclic prefix in the received SC-FDMA symbol (block 810). For IFDMA, the receiver removes the phase ramp in the received SC-FDMA symbol. For both IFDMA and LFDMA, the receiver obtains K received data/pilot symbols for the SC-FDMA symbol.</p><p id="p0049" num="0049">The receiver then undoes the TDM or CDM performed on the pilot (block 812). For the TDM pilot scheme shown in <figref idrefs="f0005">FIG. 5A</figref>, K received pilot symbols, <i>r<sub>p</sub></i>(<i>n</i>)<!-- EPO <DP n="15"> --> for <i>n</i> =1, ..., K, are obtained for each pilot SC-FDMA symbol. For the TDM pilot scheme shown in <figref idrefs="f0006">FIG. 5B</figref>, multiple received pilot symbols are obtained for each SC-FDMA symbol containing the TDM pilot.</p><p id="p0050" num="0050">For the CDM pilot scheme shown in <figref idrefs="f0007">FIG. 5C</figref>, M received SC-FDMA symbols containing the CDM pilot are processed to recover the pilot symbols, as follows: <maths id="math0011" num="eq (11)"><math display="block"><mrow><msub><mi>r</mi><mi>p</mi></msub><mfenced><mi>n</mi></mfenced><mo>=</mo><mrow><mstyle displaystyle="true"><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi mathvariant="normal">M</mi></munderover></mrow></mstyle><mrow><msub><mi>w</mi><mrow><mi>p</mi><mo>,</mo><mi>i</mi></mrow></msub></mrow></mrow><mo>⋅</mo><mi>r</mi><mfenced separators=","><msub><mi>t</mi><mi>i</mi></msub><mo>⁢</mo><mi>n</mi></mfenced><mo>,</mo><mspace width="2em"/><mi>for</mi><mspace width="1em"/><mi>n</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi mathvariant="normal">K</mi><mo>,</mo></mrow></math><img id="ib0011" file="imgb0011.tif" wi="137" he="12" img-content="math" img-format="tif"/></maths><br/>
where<br/>
<i>r</i>(<i>t<sub>i</sub>, n</i>) is a received sample for sample period <i>n</i> in symbol period <i>t<sub>i</sub>;</i><br/>
<i>w<sub>p,i</sub></i> is the <i>i</i>-th chip of the orthogonal sequence for the pilot; and<br/>
<i>r<sub>p</sub></i> (<i>n</i>) is a received pilot symbol for sample period <i>n</i>.<br/>
Equation (11) assumes that the CDM pilot is transmitted in symbol periods <i>t</i><sub>1</sub> through <i>t</i><sub>M</sub><i>,</i> where M is the length of the orthogonal sequence. K received pilot symbols are obtained from equation (11) for the CDM pilot.</p><p id="p0051" num="0051">For the CDM pilot scheme shown in <figref idrefs="f0007">FIG. 5D</figref>, each received SC-FDMA symbol containing the CDM pilot are processed to recover the pilot symbols, as follows: <maths id="math0012" num="eq (12)"><math display="block"><mrow><msub><mi>r</mi><mi>p</mi></msub><mfenced><mi>n</mi></mfenced><mo>=</mo><mrow><mstyle displaystyle="true"><mrow><munderover><mrow><mo>∑</mo></mrow><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi mathvariant="normal">M</mi></munderover></mrow></mstyle><mrow><msub><mi>w</mi><mrow><mi>p</mi><mo>,</mo><mi>i</mi></mrow></msub></mrow></mrow><mo>⋅</mo><mi>r</mi><mo>⁢</mo><mfenced separators=""><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mi mathvariant="normal">M</mi><mo>+</mo><mi>i</mi></mfenced><mo>,</mo><mspace width="2em"/><mi>for</mi><mspace width="1em"/><mi>n</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi mathvariant="normal">K</mi><mo>/</mo><mi mathvariant="normal">M</mi><mo>,</mo></mrow></math><img id="ib0012" file="imgb0012.tif" wi="137" he="12" img-content="math" img-format="tif"/></maths><br/>
where <i>r</i>((<i>n</i>-1)·<i>M</i> + <i>i</i>) is a received sample for sample period (<i>n</i>-1)·M + <i>i</i> in the received SC-FDMA symbol with the CDM pilot. K/M received pilot symbols are obtained from equation (12) for the CDM pilot.</p><p id="p0052" num="0052">A frequency selective communication channel causes intersymbol interference (ISI). However, the ISI is restricted to within a single SC-FDMA symbol because of the cyclic prefix. Furthermore, because of the cyclic prefix, a linear convolution operation due to the channel impulse response effectively becomes a circular convolution, similar to OFDMA. Therefore, it is possible to perform channel estimation, equalization, and other operations in the frequency domain when pilot symbols and data symbols are not sent in the same SC-FDMA symbol.</p><p id="p0053" num="0053">For the TDM scheme shown in <figref idrefs="f0005">FIG. 5A</figref> and the CDM scheme shown in <figref idrefs="f0007">FIG. 5C</figref>, the receiver obtains K received pilot symbols for each pilot transmission. A<!-- EPO <DP n="16"> --> K-point FFT may be performed on the K received pilot symbols, <i>r<sub>p</sub></i>(<i>n</i>) for <i>n</i> = 1,..., K, to obtain K received pilot values in the frequency domain, <i>R<sub>p</sub></i>(<i>k</i>) for <i>k</i> =1, ..., K (block 814). The received pilot values may be given as: <maths id="math0013" num="eq (13) "><math display="block"><mrow><msub><mi>R</mi><mi>p</mi></msub><mfenced><mi>k</mi></mfenced><mo>=</mo><mi>H</mi><mfenced><mi>k</mi></mfenced><mo>⋅</mo><mi>P</mi><mfenced><mi>k</mi></mfenced><mo>+</mo><mi>N</mi><mfenced><mi>k</mi></mfenced><mo>,</mo><mspace width="2em"/><mi>for</mi><mspace width="1em"/><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi mathvariant="normal">K</mi><mo>,</mo></mrow></math><img id="ib0013" file="imgb0013.tif" wi="137" he="7" img-content="math" img-format="tif"/></maths><br/>
where<br/>
<i>P</i>(<i>k</i>) is the transmitted pilot value for subband <i>k;</i><br/>
<i>H</i>(<i>k</i>) is the complex gain for the communication channel for subband <i>k</i>;<br/>
<i>R<sub>p</sub></i>(<i>k</i>) is the received pilot values for subband <i>k</i>; and<br/>
<i>N</i>(<i>k</i>) is the noise for subband <i>k.</i><br/>
The K-point FFT provides K received pilot values for the K total subbands. Only N received pilot values for the N subbands used for pilot transmission (which are called pilot subbands) are retained, and the remaining K - N received pilot values are discarded (block 816). Different pilot subbands are used for IFDMA and LFDMA and hence different received pilot values are retained for IFDMA and LFDMA. The retained pilot values are denoted as <i>R<sub>p</sub></i>(<i>k</i>) for <i>k</i> =1<i>, ...,</i>N<i>.</i> For simplicity, the noise may be assumed to be additive white Gaussian noise (AWGN) with zero mean and a variance of <i>N</i><sub>0</sub><i>.</i></p><p id="p0054" num="0054">The receiver may estimate the channel frequency response using various channel estimation techniques such as an MMSE technique, a least-squares (LS) technique, and so on. The receiver derives channel gain estimates for the N pilot subbands based on the N received pilot values and using the MMSE or LS technique (block 818). For the MMSE technique, an initial frequency response estimate for the communication channel may be derived based on the received pilot values, as follows: <maths id="math0014" num="eq (14)"><math display="block"><mrow><msub><mrow><mover><mi>H</mi><mrow><mo>^</mo></mrow></mover></mrow><mi mathvariant="italic">mmse</mi></msub><mfenced><mi>k</mi></mfenced><mo>=</mo><mfrac><mrow><msub><mi>R</mi><mi>p</mi></msub><mfenced><mi>k</mi></mfenced><mo>⋅</mo><msup><mi>P</mi><mrow><mo>*</mo></mrow></msup><mfenced><mi>k</mi></mfenced></mrow><mrow><msup><mrow><mfenced open="|" close="|" separators=""><mi>P</mi><mfenced><mi>k</mi></mfenced></mfenced></mrow><mn>2</mn></msup><mo>+</mo><msub><mi>N</mi><mn>0</mn></msub></mrow></mfrac><mo>,</mo><mspace width="2em"/><mi>for</mi><mspace width="1em"/><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi mathvariant="normal">N</mi><mo>,</mo></mrow></math><img id="ib0014" file="imgb0014.tif" wi="137" he="13" img-content="math" img-format="tif"/></maths><br/>
where <i>Ĥ<sub>mmse</sub></i>(<i>k</i>) is a channel gain estimate for subband <i>k</i> and " * " denotes a complex conjugate. The initial frequency response estimate contains N channel gains for the N pilot subbands. The pilot symbol sequence may be generated based on a polyphase sequence having a flat frequency response. In this case, |<i>P</i>(<i>k</i>)| =1 for all values of <i>k,</i> and equation (14) may be expressed as:<!-- EPO <DP n="17"> --> <maths id="math0015" num="eq (15)"><math display="block"><mrow><msub><mrow><mover><mi>H</mi><mrow><mo>^</mo></mrow></mover></mrow><mi mathvariant="italic">mmse</mi></msub><mfenced><mi>k</mi></mfenced><mo>=</mo><mfrac><mrow><msub><mi>R</mi><mi>p</mi></msub><mfenced><mi>k</mi></mfenced><mo>⋅</mo><msup><mi>P</mi><mrow><mo>*</mo></mrow></msup><mfenced><mi>k</mi></mfenced></mrow><mrow><mn>1</mn><mo>+</mo><msub><mi>N</mi><mn>0</mn></msub></mrow></mfrac><mo>,</mo><mspace width="2em"/><mi>for</mi><mspace width="1em"/><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi mathvariant="normal">N</mi><mn>.</mn></mrow></math><img id="ib0015" file="imgb0015.tif" wi="137" he="13" img-content="math" img-format="tif"/></maths><br/>
The constant factor 1/(1+<i>N</i><sub>0</sub>) may be removed to provide an unbiased MMSE frequency response estimate, which may be expressed as: <maths id="math0016" num="eq (16)"><math display="block"><mrow><msub><mrow><mover><mi>H</mi><mrow><mo>^</mo></mrow></mover></mrow><mi mathvariant="italic">mmse</mi></msub><mfenced><mi>k</mi></mfenced><mo>=</mo><msub><mi>R</mi><mi>p</mi></msub><mfenced><mi>k</mi></mfenced><mo>⋅</mo><msup><mi>P</mi><mrow><mo>*</mo></mrow></msup><mfenced><mi>k</mi></mfenced><mo>,</mo><mspace width="2em"/><mi>for</mi><mspace width="1em"/><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi mathvariant="normal">N</mi><mn>.</mn></mrow></math><img id="ib0016" file="imgb0016.tif" wi="137" he="8" img-content="math" img-format="tif"/></maths></p><p id="p0055" num="0055">For the LS technique, an initial frequency response estimate may be derived based on the received pilot values, as follows: <maths id="math0017" num="eq (17)"><math display="block"><mrow><msub><mrow><mover><mi>H</mi><mrow><mo>^</mo></mrow></mover></mrow><mi mathvariant="italic">ls</mi></msub><mfenced><mi>k</mi></mfenced><mo>=</mo><mfrac><mrow><msub><mi>R</mi><mi>p</mi></msub><mfenced><mi>k</mi></mfenced></mrow><mrow><mi>P</mi><mfenced><mi>k</mi></mfenced></mrow></mfrac><mo>,</mo><mspace width="2em"/><mi>for</mi><mspace width="1em"/><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi mathvariant="normal">N</mi><mn>.</mn></mrow></math><img id="ib0017" file="imgb0017.tif" wi="137" he="12" img-content="math" img-format="tif"/></maths></p><p id="p0056" num="0056">The impulse response of the communication channel may be characterized by L taps, where L may be much less than N. That is, if an impulse is applied to the communication channel by the transmitter, then L time-domain samples (at the sample rate of BW MHz) would be sufficient to characterize the response of the communication channel based on this impulse stimulus. The number of taps (L) for the channel impulse response is dependent on the delay spread of the system, which is the time difference between the earliest and latest arriving signal instances of sufficient energy at the receiver. A longer delay spread corresponds to a larger value for L, and vice versa.</p><p id="p0057" num="0057">A channel impulse response estimate may be derived based on the N channel gain estimates and using LS or MMSE technique (block 820). A least-squares channel impulse response estimate with L taps, <i>ĥ<sub>ls</sub></i>(<i>n</i>) for <i>n</i> =1,..., L, may be derived based on the initial frequency response estimate, as follows: <maths id="math0018" num="eq (18)"><math display="block"><mrow><msubsup><mrow><munder><mrow><mover><mi mathvariant="normal">h</mi><mrow><mo>^</mo></mrow></mover></mrow><mo>̲</mo></munder></mrow><mrow><mi mathvariant="normal">L</mi><mo>×</mo><mn>1</mn></mrow><mi mathvariant="italic">ls</mi></msubsup><mo>=</mo><msup><mfenced separators=""><msubsup><mrow><munder><mi mathvariant="normal">W</mi><mo>̲</mo></munder></mrow><mrow><mi mathvariant="normal">N</mi><mo>×</mo><mi mathvariant="normal">L</mi></mrow><mi>H</mi></msubsup><mo>⁢</mo><msub><mrow><munder><mi mathvariant="normal">W</mi><mo>̲</mo></munder></mrow><mrow><mi mathvariant="normal">N</mi><mo>×</mo><mi mathvariant="normal">L</mi></mrow></msub></mfenced><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><msubsup><mrow><munder><mi mathvariant="normal">W</mi><mo>̲</mo></munder></mrow><mrow><mi mathvariant="normal">N</mi><mo>×</mo><mi mathvariant="normal">L</mi></mrow><mi>H</mi></msubsup><mo>⁢</mo><msubsup><mrow><munder><mrow><mover><mi mathvariant="normal">H</mi><mrow><mo>^</mo></mrow></mover></mrow><mo>̲</mo></munder></mrow><mrow><mi mathvariant="normal">N</mi><mo>×</mo><mn>1</mn></mrow><mi mathvariant="italic">init</mi></msubsup><mo>,</mo></mrow></math><img id="ib0018" file="imgb0018.tif" wi="137" he="8" img-content="math" img-format="tif"/></maths><br/>
where <maths id="math0019" num=""><math display="inline"><mrow><msubsup><mrow><mover><mrow><munder><mi mathvariant="normal">H</mi><mrow><mo>̲</mo></mrow></munder></mrow><mrow><mo>^</mo></mrow></mover></mrow><mrow><mi mathvariant="normal">N</mi><mo>×</mo><mn mathvariant="normal">1</mn></mrow><mi mathvariant="italic">init</mi></msubsup></mrow></math><img id="ib0019" file="imgb0019.tif" wi="11" he="9" img-content="math" img-format="tif" inline="yes"/></maths> is an N×1 vector containing <i>Ĥ<sub>ls</sub></i>(<i>k</i>) or <i>Ĥ<sub>mmse</sub></i>(<i>k</i>) for <i>k</i> = 1, ..., N ;<br/>
<u>W</u><sub>N×L</sub> is a sub-matrix of a Fourier matrix <u>W</u><sub>K×K</sub> ;<br/>
<maths id="math0020" num=""><math display="inline"><mrow><msubsup><mrow><mover><mrow><munder><mi mathvariant="normal">h</mi><mrow><mo>̲</mo></mrow></munder></mrow><mrow><mo>^</mo></mrow></mover></mrow><mrow><mi mathvariant="normal">L</mi><mo>×</mo><mn mathvariant="normal">1</mn></mrow><mi mathvariant="italic">ls</mi></msubsup></mrow></math><img id="ib0020" file="imgb0020.tif" wi="9" he="10" img-content="math" img-format="tif" inline="yes"/></maths> is an L × 1 vector containing <i>ĥ<sub>ls</sub></i> (<i>n</i>) for <i>n</i> =1, ..., L ; and<br/>
« <i>H</i> » denotes a conjugate transpose.<br/>
The Fourier matrix <u>W</u><sub>K×K</sub> is defined such that the (<i>u,v</i>)-th entry, f<i><sub>u,v</sub>,</i> is given as:<!-- EPO <DP n="18"> --> <maths id="math0021" num="eq (19)"><math display="block"><mrow><msub><mi>f</mi><mrow><mi>u</mi><mo>,</mo><mi>v</mi></mrow></msub><mo>=</mo><msup><mi>e</mi><mrow><mo>-</mo><mi>j</mi><mo>⁢</mo><mn>2</mn><mo>⁢</mo><mi>π</mi><mo>⁢</mo><mfrac><mrow><mfenced separators=""><mi>u</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><mfenced separators=""><mi>v</mi><mo>-</mo><mn>1</mn></mfenced></mrow><mi mathvariant="normal">K</mi></mfrac></mrow></msup><mo>,</mo><mspace width="1em"/><mi>for</mi><mspace width="1em"/><mi>u</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>K and</mi><mspace width="1em"/><mi>v</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi mathvariant="normal">K</mi><mo>,</mo></mrow></math><img id="ib0021" file="imgb0021.tif" wi="137" he="10" img-content="math" img-format="tif"/></maths><br/>
where <i>u</i> is a row index and <i>v</i> is a column index. <b><u>W</u></b><sub>N×L</sub> contains N rows of <b><u>W</u></b><sub>K×K</sub> corresponding to the N pilot subbands. Each row of <b><u>W</u></b><sub>N×L</sub> contains the first L elements of the corresponding row of <u>W</u><sub>K×K</sub>. <maths id="math0022" num=""><math display="inline"><mrow><msubsup><mrow><mover><mrow><munder><mi mathvariant="normal">h</mi><mrow><mo>̲</mo></mrow></munder></mrow><mrow><mo>^</mo></mrow></mover></mrow><mrow><mi mathvariant="normal">L</mi><mo>×</mo><mn mathvariant="normal">1</mn></mrow><mi mathvariant="italic">ls</mi></msubsup></mrow></math><img id="ib0022" file="imgb0022.tif" wi="10" he="10" img-content="math" img-format="tif" inline="yes"/></maths> contains the L taps of the least-squares channel impulse response estimate.</p><p id="p0058" num="0058">An MMSE channel impulse response estimate with L taps, <i>ĥ<sub>mmse</sub> (n)</i> for <i>n</i> =1, ..., L , may be derived based on the initial frequency response estimate, as follows: <maths id="math0023" num="eq (20)"><math display="block"><mrow><msubsup><mrow><munder><mrow><mover><mi mathvariant="normal">h</mi><mrow><mo>^</mo></mrow></mover></mrow><mrow><mo>̲</mo></mrow></munder></mrow><mrow><mi mathvariant="normal">L</mi><mo>×</mo><mn>1</mn></mrow><mi mathvariant="italic">mmse</mi></msubsup><mo>=</mo><msup><mfenced separators=""><msubsup><mrow><munder><mi mathvariant="normal">W</mi><mrow><mo>̲</mo></mrow></munder></mrow><mrow><mi mathvariant="normal">N</mi><mo>×</mo><mi mathvariant="normal">L</mi></mrow><mi>H</mi></msubsup><mo>⁢</mo><msub><mrow><munder><mi mathvariant="normal">W</mi><mrow><mo>̲</mo></mrow></munder></mrow><mrow><mi mathvariant="normal">N</mi><mo>×</mo><mi mathvariant="normal">L</mi></mrow></msub><mo>+</mo><msub><mrow><munder><mi mathvariant="normal">N</mi><mrow><mo>̲</mo></mrow></munder></mrow><mrow><mi mathvariant="normal">N</mi><mo>×</mo><mi mathvariant="normal">L</mi></mrow></msub></mfenced><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><msubsup><mrow><munder><mi mathvariant="normal">W</mi><mrow><mo>̲</mo></mrow></munder></mrow><mrow><mi mathvariant="normal">N</mi><mo>×</mo><mi mathvariant="normal">L</mi></mrow><mi>H</mi></msubsup><mo>⁢</mo><msubsup><mrow><munder><mrow><mover><mi mathvariant="normal">H</mi><mrow><mo>^</mo></mrow></mover></mrow><mrow><mo>̲</mo></mrow></munder></mrow><mrow><mi mathvariant="normal">N</mi><mo>×</mo><mn>1</mn></mrow><mi mathvariant="italic">init</mi></msubsup><mo>,</mo></mrow></math><img id="ib0023" file="imgb0023.tif" wi="137" he="8" img-content="math" img-format="tif"/></maths><br/>
where <u>N</u><sub><u>L×L</u></sub> is an L×L autocovariance matrix of noise and interference. For additive white Gaussian noise (AWGN), the autocovariance matrix may be given as <maths id="math0024" num=""><math display="inline"><mrow><msub><mrow><munder><mi mathvariant="normal">N</mi><mrow><mo>̲</mo></mrow></munder></mrow><mrow><mi mathvariant="normal">L</mi><mo>×</mo><mi mathvariant="normal">L</mi></mrow></msub><mo>=</mo><msubsup><mi>σ</mi><mi>n</mi><mn>2</mn></msubsup><mo>⋅</mo><munder><mi mathvariant="normal">I</mi><mrow><mo>̲</mo></mrow></munder><mo>,</mo></mrow></math><img id="ib0024" file="imgb0024.tif" wi="26" he="9" img-content="math" img-format="tif" inline="yes"/></maths> where <maths id="math0025" num=""><math display="inline"><mrow><msubsup><mi>σ</mi><mi>n</mi><mn>2</mn></msubsup></mrow></math><img id="ib0025" file="imgb0025.tif" wi="7" he="8" img-content="math" img-format="tif" inline="yes"/></maths> is the noise variance. An N-point IFFT may also be performed on the initial frequency response estimate to obtain a channel impulse response estimate with N taps.</p><p id="p0059" num="0059">Filtering and/or post-processing may be performed on the initial frequency response estimate and/or the channel impulse response estimate to improve the quality of the channel estimate, as described below (block 822). A final frequency response estimate for all K subbands may be obtained by (1) zero-padding the L-tap or N-tap channel impulse response estimate to length K and (2) performing a K-point FFT on the extended impulse response estimate (block 824). A final frequency response estimate for all K subbands may also be obtained by (1) interpolating the N channel gain estimates, (2) performing least-squares approximation on the N channel gain estimates, or (3) using other approximation techniques.</p><p id="p0060" num="0060">A receiver can derive a longer channel impulse response estimate based on a staggered FDM pilot. In general, a channel impulse response estimate with L<sub>/T</sub> taps may be obtained based on pilot IFDMA symbols sent on L<sub>/T</sub> different subbands in one or more symbol periods. For example, if L<sub>T</sub> = 2N, then an impulse response estimate with 2N taps may be obtained based on two or more pilot IFDMA symbols sent on two or more subband sets in two or more symbol periods. A full-length impulse response<!-- EPO <DP n="19"> --> estimate with K taps may be obtained if the pilot is transmitted on all S subband sets using a complete staggering pattern.</p><p id="p0061" num="0061">The receiver may derive a longer impulse response estimate of length L<sub>T</sub> by filtering initial impulse response estimates of length N for a sufficient number of different subband sets. Each initial impulse response estimate may be derived based on a pilot IFDMA symbol for one subband set. If the pilot is transmitted on a different subband set in each symbol period, then the filtering may be performed over a sufficient number of symbol periods to obtain the longer impulse response estimate.</p><p id="p0062" num="0062">For SC-FDMA, filtering may be performed on initial frequency response estimates, least-squares or MMSE channel impulse response estimates, and/or final frequency response estimates obtained for different symbol periods to improve the quality of the channel estimate. The filtering may be based on a finite impulse response (FIR) filter, an infinite impulse response (IIR) filter, or some other type of filter. The filter coefficients may be selected to achieve the desired amount of filtering, which may be selected based on a trade off between various factors such as, e.g., the desired channel estimate quality, the ability to track fast changes in the channel, filter complexity, and so on.</p><p id="p0063" num="0063">A frequency response estimate and/or a channel impulse response estimate for the communication channel may also be obtained in other manners using other channel estimation techniques.</p><p id="p0064" num="0064">Various post-processing operations may be performed to improve the quality of the channel estimate. In certain operating environments, such as a multipath fading environment, the communication channel often has only a small number of taps in the time domain. The channel estimation described above may provide a channel impulse response estimate having a large number of taps due to noise. The post-processing attempts to remove taps that result from noise and retain taps that result from the actual channel.</p><p id="p0065" num="0065">In one post-processing scheme, which is called truncation, only the first L taps of the channel impulse response estimate are retained, and the remainng taps are replaced with zeros. In another post-processing scheme, which is called thresholding, taps with low energy are replaced with zeros. In an embodiment, the thresholding is performed as follows:<!-- EPO <DP n="20"> --> <maths id="math0026" num="eq (21)"><math display="block"><mrow><mover><mi>h</mi><mrow><mo>^</mo></mrow></mover><mfenced><mi>n</mi></mfenced><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left"><mtr><mtd><mn>0</mn></mtd><mtd><mi>for</mi><mspace width="1em"/><msup><mrow><mfenced open="|" close="|" separators=""><mover><mi>h</mi><mrow><mo>^</mo></mrow></mover><mfenced><mi>n</mi></mfenced></mfenced></mrow><mn>2</mn></msup><mo>&lt;</mo><msub><mi>h</mi><mi mathvariant="italic">th</mi></msub><mo>,</mo></mtd></mtr><mtr><mtd><mover><mi>h</mi><mrow><mo>^</mo></mrow></mover><mfenced><mi>n</mi></mfenced></mtd><mtd><mi>otherwise</mi><mo>,</mo></mtd></mtr></mtable><mspace width="1em"/></mrow><mspace width="1em"/><mi>for</mi><mspace width="1em"/><mi>n</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi mathvariant="normal">K</mi><mo>,</mo></mrow></math><img id="ib0026" file="imgb0026.tif" wi="137" he="16" img-content="math" img-format="tif"/></maths><br/>
where<br/>
<i>ĥ</i>(<i>n</i>) is the <i>n</i>-th tap of the channel impulse response estimate, which may be equal to <i>ĥ<sub>mmse</sub></i>(<i>n</i>) or <i>ĥ<sub>ls</sub></i>(<i>n</i>) ; and<br/>
<i>h<sub>th</sub></i> is the threshold used to zero out low energy taps.<br/>
The threshold <i>h<sub>th</sub></i> may be computed based on the energy of all K taps or just the first L taps of the channel impulse response estimate. The same threshold may be used for all taps. Alternatively, different thresholds may be used for different taps. For example, a first threshold may be used for the first L taps, and a second threshold (which may be lower than the first threshold) may be used for the remaining taps.</p><p id="p0066" num="0066">In yet another post-processing scheme, which is called tap selection, B best taps of the channel impulse response estimate are retained, where B ≥1, and remaining taps are set to zeros. The number of taps to retain (denoted as B) may be a fixed or variable value. B may be selected based on a received signal-to-noise-and-interference ratio (SNR) for the pilot/data transmission, the spectral efficiency of a data packet for which the channel estimate is used, and/or some other parameter. For example, two best taps may be retained if the received SNR is within a first range (e.g., from 0 to 5 decibels (dB)), three best taps may be retained if the received SNR is within a second range (e.g., from 5 to 10 dB), four best taps may be retained if the received SNR is within a third range (e.g., from 10 to 15 dB), and so on.</p><p id="p0067" num="0067">Channel estimation may be performed in the time domain for the TDM pilot scheme shown in <figref idrefs="f0006">FIG. 5B</figref>, the CDM pilot scheme shown in <figref idrefs="f0007">FIG. 5D</figref>, and other pilot schemes in which data and pilot symbols are sent in the same SC-FDMA symbol. A rake estimator may be used to identify strong signal paths, for example, by (1) correlating the received symbols with the transmitted pilot symbol sequence at different time offsets and (2) identifying time offsets that provide high correlation results. The time domain channel estimation provides a set of taps for a channel impulse response estimate for the communication channel.</p><p id="p0068" num="0068">For all pilot schemes, the channel estimation provides a channel impulse response estimate and/or a frequency response estimate that may be used for equalization of the received data symbols. A sequence of K received data symbols is<!-- EPO <DP n="21"> --> obtained for each data SC-FDMA symbol for the TDM pilot scheme shown in <figref idrefs="f0005">FIG. 5A</figref> and for each set of M received SC-FDMA symbols for the CDM pilot scheme shown in <figref idrefs="f0007">FIG. 5C</figref>. The sequence of K received data symbols may be equalized in the time domain or the frequency domain.</p><p id="p0069" num="0069">Frequency-domain equalization may be performed as follows. A K-point FFT is first performed on the K received data symbols, <i>r<sub>d</sub></i> (<i>n</i>) for <i>n</i> = 1, ..., K , to obtain K frequency-domain received data values, <i>R<sub>d</sub></i>(<i>k</i>) for <i>k</i> =1, ..., K . Only N received data values for the N subbands used for data transmission are retained, and the remaining K-N received data values are discarded. The retained data values are denoted as <i>R<sub>d</sub></i>(<i>k</i>) for <i>k</i>=1,...,N.</p><p id="p0070" num="0070">Equalization may be performed in the frequency domain on the N received data values using the MMSE technique, as follows: <maths id="math0027" num="eq (22) "><math display="block"><mrow><msub><mi>Z</mi><mi>d</mi></msub><mfenced><mi>k</mi></mfenced><mo>=</mo><mfrac><mrow><msub><mi>R</mi><mi>d</mi></msub><mfenced><mi>k</mi></mfenced><mo>⋅</mo><msup><mrow><mover><mi>H</mi><mrow><mo>^</mo></mrow></mover></mrow><mrow><mo>*</mo></mrow></msup><mfenced><mi>k</mi></mfenced></mrow><mrow><msup><mrow><mfenced open="|" close="|" separators=""><mover><mi>H</mi><mrow><mo>^</mo></mrow></mover><mfenced><mi>k</mi></mfenced></mfenced></mrow><mn>2</mn></msup><mo>+</mo><msub><mi>N</mi><mn>0</mn></msub></mrow></mfrac><mo>,</mo><mspace width="1em"/><mi>for</mi><mspace width="1em"/><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi mathvariant="normal">N</mi><mo>,</mo></mrow></math><img id="ib0027" file="imgb0027.tif" wi="137" he="13" img-content="math" img-format="tif"/></maths><br/>
where<br/>
<i>R<sub>d</sub></i>(<i>k</i>) is the received data value for subband <i>k;</i><br/>
<i>Ĥ(k)</i> is the channel gain estimate for subband <i>k,</i> which may be equal to <i>Ĥ<sub>mmse</sub></i>(<i>k</i>) or <i>Ĥ<sub>ls</sub></i>(<i>k</i>); and<br/>
<i>Z<sub>d</sub>(k)</i> is the equalized data value for subband <i>k</i>.</p><p id="p0071" num="0071">Equalization may also be performed in the frequency domain on the N received data values using the zero-forcing technique, as follows: <maths id="math0028" num="eq (23)"><math display="block"><mrow><msub><mi>Z</mi><mi>d</mi></msub><mfenced><mi>k</mi></mfenced><mo>=</mo><mfrac><mrow><msub><mi>R</mi><mi>d</mi></msub><mfenced><mi>k</mi></mfenced></mrow><mrow><mover><mi>H</mi><mrow><mo>^</mo></mrow></mover><mfenced><mi>k</mi></mfenced></mrow></mfrac><mo>,</mo><mspace width="6em"/><mi>for</mi><mspace width="1em"/><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi mathvariant="normal">N</mi><mn>.</mn></mrow></math><img id="ib0028" file="imgb0028.tif" wi="137" he="12" img-content="math" img-format="tif"/></maths></p><p id="p0072" num="0072">For both MMSE and zero-forcing equalization, the N equalized data values, <i>Z<sub>d</sub> (k)</i> for <i>k =</i>1<i>, ...,</i> N<i>,</i> may be transformed back to the time domain to obtain a sequence of N data symbol estimates, <i>d̂</i>(<i>n</i>) for <i>n</i> = 1, ..., N, which are estimates of the N data symbols in the original sequence.</p><p id="p0073" num="0073">Equalization may also be performed in the time domain on the sequence of K received data symbols, as follows:<!-- EPO <DP n="22"> --> <maths id="math0029" num="eq (24)"><math display="block"><mrow><msub><mi>z</mi><mi>d</mi></msub><mfenced><mi>n</mi></mfenced><mo>=</mo><msub><mi>r</mi><mi>d</mi></msub><mfenced><mi>n</mi></mfenced><mo>⊗</mo><mi>g</mi><mfenced><mi>n</mi></mfenced><mo>,</mo></mrow></math><img id="ib0029" file="imgb0029.tif" wi="138" he="6" img-content="math" img-format="tif"/></maths><br/>
where<br/>
<i>r<sub>d</sub>(n)</i> denotes the sequence of K received data symbols;<br/>
<i>g</i>(<i>n</i>) denotes an impulse response of a time-domain equalizer;<br/>
<i>z<sub>d</sub></i> (<i>n</i>) denotes a sequence of K equalized data symbols; and ⊗ denotes a circular convolution operation.<br/>
The frequency response of the equalizer may be derived based on the MMSE technique as: <i>G</i>(<i>k</i>) = <i>Ĥ*</i>(<i><sub>k</sub></i>)/(|<i>Ĥ(k</i>)|<sup>2</sup> <i>+N<sub>0</sub></i>), for <i>k</i> =1<i>, ...,</i>N<i>.</i> The frequency response of the equalizer may also be derived based on the zero-forcing technique as: <i>G</i>(<i>k</i>) =1 / <i>Ĥ</i>(<i>k</i>), for <i>k</i> =1<i>, ...,</i>N<i>.</i> The equalizer frequency response may be transformed to the time domain to obtain the equalizer impulse response, <i>g</i>(<i>n</i>) for <i>n</i> = 1,..., N, which is used for the time-domain equalization in equation (24).</p><p id="p0074" num="0074">The sequence of K equalized data symbols from equation (24) contains S copies of the transmitted data symbols. The S copies may be accumulated on a data symbol-by-data symbol basis to obtain N data symbol estimates, as follows: <maths id="math0030" num="eq (25)"><math display="block"><mrow><mover><mi>d</mi><mrow><mo>^</mo></mrow></mover><mfenced><mi>n</mi></mfenced><mo>=</mo><mrow><mstyle displaystyle="true"><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi mathvariant="normal">S</mi><mo>-</mo><mn>1</mn></mrow></munderover></mrow></mstyle><mrow><msub><mi>z</mi><mi>d</mi></msub><mo>⁢</mo><mfenced separators=""><mi>i</mi><mo>⋅</mo><mi mathvariant="normal">N</mi><mo>+</mo><mi>n</mi></mfenced></mrow></mrow><mo>,</mo><mspace width="1em"/><mi>for</mi><mspace width="1em"/><mi>n</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi mathvariant="normal">N</mi><mn>.</mn></mrow></math><img id="ib0030" file="imgb0030.tif" wi="138" he="12" img-content="math" img-format="tif"/></maths><br/>
Alternatively, the accumulation is not performed, and N equalized data symbols for only one copy of the transmitted data are provided as the N data symbol estimates.</p><p id="p0075" num="0075">The receiver may also estimate interference based on the received pilot values and the channel estimate. For example, the interference for each subband may be estimated as follows: <maths id="math0031" num="eq (26)"><math display="block"><mrow><mi>I</mi><mfenced><mi>k</mi></mfenced><mo>=</mo><msup><mrow><mfenced open="|" close="|" separators=""><mover><mi>H</mi><mrow><mo>^</mo></mrow></mover><mfenced><mi>k</mi></mfenced><mo>⋅</mo><mi>P</mi><mfenced><mi>k</mi></mfenced><mo>-</mo><msub><mi>R</mi><mi>p</mi></msub><mfenced><mi>k</mi></mfenced></mfenced></mrow><mn>2</mn></msup><mo>,</mo><mspace width="2em"/><mi>for</mi><mspace width="1em"/><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi mathvariant="normal">N</mi><mo>,</mo></mrow></math><img id="ib0031" file="imgb0031.tif" wi="137" he="8" img-content="math" img-format="tif"/></maths><br/>
where <i>I</i>(<i>k</i>) is the interference estimate for subband <i>k.</i> The interference estimate <i>I</i>(<i>k</i>) may be averaged over all N subbands for each SC-FDMA symbol to obtain a short-term interference estimate, which may be used for data demodulation and/or other purposes. The short-term interference estimate may be averaged over multiple SC-FDMA symbols to obtain a long-term interference estimate, which may be used to estimate operating conditions and/or for other purposes.<!-- EPO <DP n="23"> --></p><p id="p0076" num="0076">Other techniques may also be used to improve the quality of the channel estimate derived from a TDM pilot or a CDM pilot. These techniques include an iterative channel estimation technique and a data-aided channel estimation technique.</p><p id="p0077" num="0077">For the iterative channel estimation technique, an initial estimate of the communication channel is first derived based on the received pilot symbols, e.g., using the MMSE or least-squares technique. The initial channel estimate is used to derive data symbol estimates, as described above. In an embodiment, the interference due to the data symbols on the pilot symbols is estimated based on the data symbol estimates <i>d̂</i>(<i>n</i>) and the initial channel estimate <i>ĥ</i>(<i>n</i>), e.g., as <i>î</i>(<i>n</i>) = <i>d̂</i>(<i>n</i>) <i>⊗ĥ</i>(<i>n</i>), where <i>î</i>(<i>n</i>) denotes the interference estimate. In another embodiment, the data symbol estimates are processed to obtain decoded data. The decoded data is then processed in the same manner performed at the transmitter to obtain remodulated data symbols, which are convolved with the initial channel estimate to obtain the interference estimate. For both embodiments, the interference estimate is subtracted from the received pilot symbols to obtain interference-canceled pilot symbols, <maths id="math0032" num=""><math display="inline"><mrow><msubsup><mi>r</mi><mi>p</mi><mi mathvariant="italic">ic</mi></msubsup><mfenced><mi>n</mi></mfenced><mo>=</mo><msub><mi>r</mi><mi>p</mi></msub><mfenced><mi>n</mi></mfenced><mo>-</mo><mover><mi>i</mi><mrow><mo>^</mo></mrow></mover><mfenced><mi>n</mi></mfenced><mo>,</mo></mrow></math><img id="ib0032" file="imgb0032.tif" wi="36" he="8" img-content="math" img-format="tif" inline="yes"/></maths> which are then used to derive an improved channel estimate. The process may be repeated for any number of iterations to obtain progressively better channel estimates. The iterative channel estimation technique is more suited for the TDM pilot scheme shown in <figref idrefs="f0006">FIG. 5B</figref>, the CDM pilot schemes shown in <figref idrefs="f0007">FIGS. 5C and 5D</figref>, and other pilot schemes in which the data symbols may cause intersymbol interference on the pilot symbols.</p><p id="p0078" num="0078">For the data-aided channel estimation technique, the received data symbols are used along with the received pilot symbols for channel estimation. A first channel estimate is derived based on the received pilot symbols and used to obtain data symbol estimates. A second channel estimate is then derived based on the received data symbols and the data symbol estimates. In an embodiment, the received data symbols <i>r<sub>d</sub></i>(<i>n</i>) are converted to frequency-domain received data values <i>R<sub>d</sub></i>(<i>k</i>), and the data symbol estimates <i>d̂</i>(<i>n</i>) are converted to frequency-domain data values <i>D̂(k</i>). The second channel estimate may be obtained by substituting <i>R<sub>d</sub></i>(<i>k</i>) for <i>R<sub>p</sub></i>(<i>k</i>) and <i>D̂(k</i>) for <i>P</i>(<i>k</i>) in equations (14) through (18). In another embodiment, the data symbol estimates are processed to obtain decoded data, and the decoded data is processed to obtain remodulated data symbols <i>D<sub>rm</sub></i>(<i>k</i>). The second channel estimate may be<!-- EPO <DP n="24"> --> obtained by substituting <i>R<sub>d</sub></i>(<i>k</i>) for <i>R<sub>p</sub></i>(<i>k</i>) and <i>D<sub>rm</sub></i>(<i>k</i>) for <i>P</i>(<i>k</i>) in equations (14) through (18).</p><p id="p0079" num="0079">The two channel estimates obtained with the received pilot symbols and the received data symbols are combined to obtain an improved overall channel estimate. This combining may be performed, for example, as follows: <maths id="math0033" num="eq (27)"><math display="block"><mrow><msub><mrow><mover><mi>H</mi><mrow><mo>^</mo></mrow></mover></mrow><mi mathvariant="italic">overall</mi></msub><mfenced><mi>k</mi></mfenced><mo>=</mo><msub><mrow><mover><mi>H</mi><mrow><mo>^</mo></mrow></mover></mrow><mi mathvariant="italic">pilot</mi></msub><mfenced><mi>k</mi></mfenced><mo>⋅</mo><msub><mi>C</mi><mi>p</mi></msub><mfenced><mi>k</mi></mfenced><mo>+</mo><msub><mrow><mover><mi>H</mi><mrow><mo>^</mo></mrow></mover></mrow><mi mathvariant="italic">data</mi></msub><mfenced><mi>k</mi></mfenced><mo>⋅</mo><msub><mi>C</mi><mi>d</mi></msub><mfenced><mi>k</mi></mfenced><mo>,</mo><mspace width="2em"/><mi>for</mi><mspace width="1em"/><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi mathvariant="normal">N</mi><mo>,</mo></mrow></math><img id="ib0033" file="imgb0033.tif" wi="137" he="8" img-content="math" img-format="tif"/></maths><br/>
where <i>Ĥ<sub>pilot</sub></i> (<i>k</i>) is the channel estimate obtained based on the received pilot symbols;<br/>
<i>Ĥ<sub>data</sub></i> (<i>k</i>) <i>is</i> the channel estimate obtained based on the received data symbols;<br/>
<i>C<sub>p</sub></i>(<i>k</i>) and <i>C<sub>d</sub></i>(<i>k</i>) are weighting factors for pilot and data, respectively; and <i>H<sub>overall</sub></i>(<i>k</i>) is the overall channel estimate.<br/>
In general, <i>Ĥ<sub>overall</sub></i> (<i>k</i>) may be derived based on any function of <i>Ĥ</i><sub><i>pi</i>/</sub><i><sub>ot</sub>(</i>k), <i>Ĥ<sub>data</sub></i>(<i>k</i>), the confidence in the reliability of the data symbol estimates, and/or other factors. The process described above may be performed in an iterative fashion. For each iteration, <i>Ĥ<sub>overall</sub></i>(<i>k</i>) is updated based on the channel estimate obtained from the data symbol estimates, and the updated <i>Ĥ<sub>overall</sub></i>(<i>k</i>) is used to derive new data symbol estimates. The data-aided channel estimation technique may be used for all pilot schemes, including the TDM and CDM pilot schemes shown in <figref idrefs="f0005 f0006 f0007">FIGS. 5A through 5D</figref>.</p><p id="p0080" num="0080"><figref idrefs="f0011"><b>FIG. 9</b></figref> shows a block diagram of a transmitter 910 and a receiver 950. For the forward link, transmitter 910 is part of a base station and receiver 950 is part of a wireless device. For the reverse link, transmitter 910 is part of a wireless device and receiver 950 is part of a base station. A base station is generally a fixed station and may also be called a base transceiver system (BTS), an access point, or some other terminology. A wireless device may be fixed or mobile and may also be called a user terminal, a mobile station, or some other terminology.</p><p id="p0081" num="0081">At transmitter 910, a TX data and pilot processor 920 processes traffic data to obtain data symbols, generates pilot symbols, and provides the data symbols and pilot symbols. An SC-FDMA modulator 930 multiplexes the data symbols and pilot symbols using TDM and/or CDM and performs SC-FDMA modulation (e.g., for IFDMA, LFDMA, and so on) to generate SC-FDMA symbols. A transmitter unit (TMTR) 932<!-- EPO <DP n="25"> --> processes (e.g., converts to analog, amplifies, filters, and frequency upconverts) the SC-FDMA symbols and generates a radio frequency (RF) modulated signal, which is transmitted via an antenna 934.</p><p id="p0082" num="0082">At receiver 950, an antenna 952 receives the transmitted signal and provides a received signal. A receiver unit (RCVR) 954 conditions (e.g., filters, amplifies, frequency downconverts, and digitizes) the received signal to generate a stream of received samples. An SC-FDMA demodulator 960 processes the received samples and obtains received data symbols and received pilot symbols. A channel estimator/ processor 980 derives a channel estimate based on the received pilot symbols. SC-FDMA demodulator 960 performs equalization on the received data symbols with the channel estimate and provides data symbol estimates. A receive (RX) data processor 970 symbol demaps, deinterleaves, and decodes the data symbol estimates and provides decoded data. In general, the processing by SC-FDMA demodulator 960 and RX data processor 970 is complementary to the processing by SC-FDMA modulator 930 and TX data and pilot processor 920, respectively, at transmitter 910.</p><p id="p0083" num="0083">Controllers 940 and 990 direct the operation of various processing units at transmitter 910 and receiver 950, respectively. Memory units 942 and 992 store program codes and data used by controllers 940 and 990, respectively.</p><p id="p0084" num="0084"><figref idrefs="f0012"><b>FIG. 10A</b></figref> shows a block diagram of a TX data and pilot processor 920a, which is an embodiment of processor 920 in <figref idrefs="f0011">FIG. 9</figref> and may be used for the TDM pilot schemes. Within processor 920a, traffic data is encoded by an encoder 1012, interleaved by an interleaver 1014, and mapped to data symbols by a symbol mapper 1016. A pilot generator 1020 generates pilot symbols, e.g., based on a polyphase sequence. A multiplexer (Mux) 1022 receives and multiplexes the data symbols with the pilot symbols based on a TDM control and provides a stream of multiplexed data and pilot symbols.</p><p id="p0085" num="0085"><figref idrefs="f0012"><b>FIG. 10B</b></figref> shows a block diagram of a TX data and pilot processor 920b, which is another embodiment of processor 920 in <figref idrefs="f0011">FIG. 9</figref> and may be used for the CDM pilot schemes. Within processor 920b, traffic data is encoded by encoder 1012, interleaved by interleaver 1014, and mapped to data symbols by symbol mapper 1016. A multiplier 1024a multiplies each data symbol with the M chips of the orthogonal sequence {<i>w<sub>d</sub></i>} for data and provides M scaled data symbols. Similarly, a multiplier 1024b multiplies each pilot symbol with the M chips of the orthogonal sequence {<i>w<sub>p</sub></i>}<!-- EPO <DP n="26"> --> for pilot and provides M scaled pilot symbols. A summer 1026 sums the scaled data symbols with the scaled pilot symbols, e.g., as shown in <figref idrefs="f0007">FIG. 5C or 5D</figref>, and provides combined symbols.</p><p id="p0086" num="0086"><figref idrefs="f0012"><b>FIG. 11A</b></figref> shows an SC-FDMA modulator 930a for IFDMA, which is an embodiment of SC-FDMA modulator 930 in <figref idrefs="f0011">FIG. 9</figref>. Within modulator 930a, a repetition unit 1112 repeats an original sequence of data/pilot symbols S times to obtain an extended sequence of K symbols. A phase ramp unit 1114 applies a phase ramp to the extended symbol sequence to generate a frequency-translated sequence of output symbols. The phase ramp is determined by the subband set <i>u</i> used for transmission. A cyclic prefix generator 1116 appends a cyclic prefix to the frequency-translated symbol sequence to generate an IFDMA symbol.</p><p id="p0087" num="0087"><figref idrefs="f0012"><b>FIG. 11B</b></figref> shows an SC-FDMA modulator 930b for LFDMA, which is another embodiment of SC-FDMA modulator 930 in <figref idrefs="f0011">FIG. 9</figref>. Within modulator 930b, an FFT unit 1122 performs an N-point FFT on an original sequence of data/pilot symbols to obtain a sequence of N frequency-domain symbols. A symbol-to-subband-mapper 1124 maps the N frequency-domain symbols onto the N subbands used for transmission and maps K-N zero symbols onto the remaining K - N subbands. An IFFT unit 1126 performs a K-point IFFT on the K symbols from mapper 1124 and provides a sequence of K time-domain output symbols. A cyclic prefix generator 1128 appends a cyclic prefix to the output symbol sequence to generate an LFDMA symbol.</p><p id="p0088" num="0088"><figref idrefs="f0013"><b>FIG. 12A</b></figref> shows a block diagram of an SC-FDMA demodulator 960a, which is an embodiment of demodulator 960 in <figref idrefs="f0011">FIG. 9</figref> and may be used for the TDM IFDMA pilot schemes. Within SC-FDMA demodulator 960a, a cyclic prefix removal unit 1212 removes the cyclic prefix for each received IFDMA symbol. A phase ramp removal unit 1214 removes the phase ramp in each received IFDMA symbol. The phase ramp removal may also be performed by the frequency downconversion from RF to baseband. A demultiplexer (Demux) 1220 receives the output of unit 1214, and provides received data symbols to an equalizer 1230, and provides received pilot symbols to channel estimator 980. Channel estimator 980 derives a channel estimate based on the received pilot symbols, e.g., using the MMSE or least-squares technique. Equalizer 1230 performs equalization on the received data symbols with the channel estimate in the time domain or the frequency domain and provides equalized data symbols. An accumulator 1232 accumulates equalized data symbols corresponding to<!-- EPO <DP n="27"> --> multiple copies of the same transmitted data symbol and provides data symbol estimates.</p><p id="p0089" num="0089"><figref idrefs="f0013"><b>FIG. 12B</b></figref> shows a block diagram of an SC-FDMA demodulator 960b, which is another embodiment of demodulator 960 in <figref idrefs="f0011">FIG. 9</figref> and may be used for the CDM IFDMA pilot schemes. SC-FDMA demodulator 960b includes a data channelizer that recovers the transmitted data symbols and a pilot channelizer that recovers the transmitted pilot symbols. For the data channelizer, a multiplier 1224a multiplies the output of unit 1214 with the M chips of the data orthogonal sequence {<i>w<sub>d</sub></i>} and provides scaled data symbols. An accumulator 1226a accumulates M scaled data symbols for each transmitted data symbol and provides a received data symbol. For the pilot channelizer, a multiplier 1224b multiplies the output of unit 1214 with the M chips of the pilot orthogonal sequence {<i>w<sub>p</sub></i>} and provides M scaled pilot symbols for each transmitted pilot symbol, which are accumulated by an accumulator 1226b to obtain a received pilot symbol for the transmitted pilot symbol. The processing by subsequent units within SC-FDMA demodulator 960b is as described above for SC-FDMA demodulator 960a.</p><p id="p0090" num="0090"><figref idrefs="f0014"><b>FIG. 13A</b></figref> shows a block diagram of an SC-FDMA demodulator 960c, which is yet another embodiment of demodulator 960 in <figref idrefs="f0011">FIG. 9</figref> and may be used for the TDM LFDMA pilot schemes. Within SC-FDMA demodulator 960c, a cyclic prefix removal unit 1312 removes the cyclic prefix for each received LFDMA symbol. An FFT unit 1314 performs a K-point FFT on an LFDMA symbol after removal of the cyclic prefix and provides K frequency-domain values. A subband-to-symbol demapper 1316 receives the K frequency-domain values, provides N frequency-domain values for the N subbands used for transmission, and discards the remaining frequency-domain values. An IFFT unit 1318 performs an N-point FFT on the N frequency-domain values from demapper 1316 and provides N received symbols. A demultiplexer 1320 receives the output of unit 1318, provides received data symbols to an equalizer 1330, and provides received pilot symbols to channel estimator 980. Equalizer 1330 performs equalization on the received data symbols in the time domain or the frequency domain with a channel estimate from channel estimator 980 and provides data symbol estimates.</p><p id="p0091" num="0091"><figref idrefs="f0014"><b>FIG. 13B</b></figref> shows a block diagram of an SC-FDMA demodulator 960d, which is yet another embodiment of demodulator 960 in <figref idrefs="f0011">FIG. 9</figref> and may be used for the CDM LFDMA pilot schemes. SC-FDMA demodulator 960d includes a data channelizer that<!-- EPO <DP n="28"> --> recovers the transmitted data symbols and a pilot channelizer that recovers the transmitted pilot symbols. For the data channelizer, a multiplier 1324a multiplies the output of IFFT unit 1318 with the M chips of the data orthogonal sequence {<i>w<sub>d</sub></i>} and provides scaled data symbols. An accumulator 1326a accumulates M scaled data symbols for each transmitted data symbol and provides a received data symbol. For the pilot channelizer, a multiplier 1324b multiplies the output of IFFT unit 1318 with the M chips of the pilot orthogonal sequence {<i>w<sub>p</sub></i>} and provides M scaled pilot symbols for each transmitted pilot symbol, which are accumulated by an accumulator 1326b to obtain a received pilot symbol for the transmitted pilot symbol. The processing by subsequent units within SC-FDMA demodulator 960d is as described above for SC-FDMA demodulator 960c.</p><p id="p0092" num="0092">The pilot transmission and channel estimation techniques described herein may be implemented by various means. For example, these techniques may be implemented in hardware, software, or a combination thereof. For a hardware implementation, the processing units used to generate and transmit a pilot at a transmitter (e.g., each of the processing units shown in <figref idrefs="f0011 f0012 f0013 f0014">FIGS. 9 through 13B</figref>, or a combination of the processing units) may be implemented within one or more application specific integrated circuits (ASICs), digital signal processors (DSPs), digital signal processing devices (DSPDs), programmable logic devices (PLDs), field programmable gate arrays (FPGAs), processors, controllers, micro-controllers, microprocessors, electronic devices, other electronic units designed to perform the functions described herein, or a combination thereof. The processing units used to perform channel estimation at a receiver may also be implemented within one or more ASICs, DSPs, electronic devices, and so on.</p><p id="p0093" num="0093">For a software implementation, the techniques may be implemented with modules (e.g., procedures, functions, and so on) that perform the functions described herein. The software codes may be stored in a memory unit (e.g., memory unit 942 or 992 in <figref idrefs="f0011">FIG. 9</figref>) and executed by a processor (e.g., controller 940 or 990). The memory unit may be implemented within the processor or external to the processor.</p><p id="p0094" num="0094">The previous description of the disclosed embodiments is provided to enable any person skilled in the art to make or use the present invention. Various modifications to these embodiments will be readily apparent to those skilled in the art, and the generic principles defined herein may be applied to other embodiments without<!-- EPO <DP n="29"> --> departing from the spirit or scope of the invention. Thus, the present invention is not intended to be limited to the embodiments shown herein but is to be accorded the widest scope consistent with the principles and novel features disclosed herein.<br/>
<!-- EPO <DP n="30"> -->In the following, further examples are described to facilitate the understanding of the invention:
<ol><li>1. An apparatus comprising:
<ul><li>a processor operative to form a first sequence of pilot symbols based on a polyphase sequence; and</li><li>a modulator operative to replicate the first sequence of pilot symbols multiple times to obtain a second sequence of pilot symbols for transmission via a communication channel.</li></ul></li><li>2. The apparatus of 1, wherein the modulator is operative to apply a phase ramp to the second sequence of pilot symbols to obtain a third sequence of output symbols.</li><li>3. The apparatus of 2, wherein the modulator is further operative to use at least two different phase slopes for the phase ramp in at least two different symbol periods to transmit the first sequence of pilot symbols on at least two different sets of frequency subbands.</li><li>4. The apparatus of 1, wherein the modulator is operative to append a cyclic prefix to the second sequence of pilot symbols to obtain a third sequence of output symbols suitable for transmission in time domain via the communication channel.</li><li>5. The apparatus of 1, wherein the polyphase sequence has a constant envelope in time domain and a flat spectral response in frequency domain.</li><li>6. The apparatus of 1, wherein the processor is operative to form a first sequence of data symbols, to multiplex the first sequence of data symbols in a first symbol period, and to multiplex the first sequence of pilot symbols in a second symbol period.</li><li>7. The apparatus of 1, wherein the processor is operative to form a first sequence of data symbols, to multiplex the first sequence of pilot symbols with the<!-- EPO <DP n="31"> --> first sequence of data symbols, and to provide a sequence of multiplexed data and pilot symbols.</li><li>8. The apparatus of 1, wherein the processor is operative to form a first sequence of data symbols, to multiply the first sequence of data symbols with a first orthogonal sequence to obtain a plurality of sequences of scaled data symbols, to multiply the first sequence of pilot symbols with a second orthogonal sequence to obtain a plurality of sequences of scaled pilot symbols, and to combine the plurality of sequences of scaled data symbols with the plurality of sequences of scaled pilot symbols to obtain a plurality of sequences of combined symbols.</li><li>9. The apparatus of 1, wherein the processor is operative to form a first sequence of data symbols, to multiply the first sequence of data symbols with a first orthogonal sequence to obtain a sequence of scaled data symbols, to multiply the first sequence of pilot symbols with a second orthogonal sequence to obtain a sequence of scaled pilot symbols, and to combine the sequence of scaled data symbols with the sequence of scaled pilot symbols to obtain a sequence of combined symbols.</li><li>10. The apparatus of 1, wherein the first sequence of pilot symbols is sent on a first set of frequency subbands, and wherein data symbols are sent on a second set of frequency subbands containing more frequency subbands than the first set.</li><li>11. A method of generating a pilot in a communication system, comprising:
<ul><li>forming a first sequence of pilot symbols based on a polyphase sequence; and</li><li>replicating the first sequence of pilot symbols multiple times to obtain a second sequence of pilot symbols for transmission via a communication channel.</li></ul></li><li>12. The method of 11, further comprising:
<ul><li>applying a phase ramp to the second sequence of pilot symbols to obtain a third sequence of output symbols.</li></ul></li><li>13. The method of 11, further comprising:
<ul><li>appending a cyclic prefix to the second sequence of pilot symbols to obtain a third sequence of output symbols; and<!-- EPO <DP n="32"> --></li><li>transmitting the third sequence of output symbols in time domain via the communication channel.</li></ul></li><li>14. An apparatus comprising:
<ul><li>means for forming a first sequence of pilot symbols based on a polyphase sequence; and</li><li>means for replicating the first sequence of pilot symbols multiple times to obtain a second sequence of pilot symbols suitable for transmission via a communication channel.</li></ul></li><li>15. The apparatus of 14, further comprising:
<ul><li>means for applying a phase ramp to the second sequence of pilot symbols to obtain a third sequence of output symbols.</li></ul></li><li>16. The apparatus of 14, further comprising:
<ul><li>means for appending a cyclic prefix to the second sequence of pilot symbols to obtain a third sequence of output symbols; and</li><li>means for transmitting the third sequence of output symbols in time domain via the communication channel.</li></ul></li><li>17. An apparatus comprising:
<ul><li>a processor operative to form a first sequence of pilot symbols based on a polyphase sequence; and</li><li>a modulator operative to transform the first sequence of pilot symbols to frequency domain to obtain a second sequence of frequency-domain symbols, to form a third sequence of symbols with the second sequence of frequency-domain symbols mapped onto a group of frequency subbands used for pilot transmission, and to transform the third sequence of symbols to time domain to obtain a fourth sequence of output symbols for transmission via a communication channel.</li></ul></li><li>18. The apparatus of 17, wherein the modulator is operative to append a cyclic prefix to the fourth sequence of pilot symbols to obtain a fifth sequence of output symbols suitable for transmission in time domain via the communication channel.<!-- EPO <DP n="33"> --></li><li>19. The apparatus of 17, wherein the polyphase sequence has a constant envelope in the time domain and a flat spectral response in the frequency domain.</li><li>20. The apparatus of 17, wherein data symbols are sent on a second group of frequency subbands containing more frequency subbands than the group of frequency subbands used for pilot transmission.</li><li>21. An apparatus comprising:
<ul><li>a processor operative to form a sequence of pilot symbols, to form a sequence of data symbols, and to time division multiplex the sequence of data symbols and the sequence of pilot symbols; and</li><li>a modulator operative to generate at least one single-carrier frequency division multiple access (SC-FDMA) symbol based on the time division multiplexed data symbols and pilot symbols.</li></ul></li><li>22. The apparatus of 21, wherein the processor is operative to multiplex the sequence of data symbols in a first symbol period and to multiplex the sequence of pilot symbols in a second symbol period, and wherein the modulator is operative to generate a first SC-FDMA symbol for the sequence of data symbols in the first symbol period and to generate a second SC-FDMA symbol for the sequence of pilot symbols in the second symbol period.</li><li>23. The apparatus of 21, wherein the processor is operative to multiplex the sequence of data symbols and the sequence of pilot symbols in different sample periods of a symbol period, and wherein the modulator is operative to generate an SC-FDMA symbol for the multiplexed pilot and data symbols for the symbol period.</li><li>24. An apparatus comprising:
<ul><li>means for forming a sequence of pilot symbols;</li><li>means for forming a sequence of data symbols;</li><li>means for time division multiplexing the sequence of data symbols and the sequence of pilot symbols; and<!-- EPO <DP n="34"> --></li><li>means for generating at least one single-carrier frequency division multiple access (SC-FDMA) symbol based on the time division multiplexed data symbols and pilot symbols.</li></ul></li><li>25. The apparatus of 24, wherein the means for time division multiplexing the sequence of data symbols and the sequence of pilot symbols comprises<br/>
means for multiplexing the sequence of data symbols in a first symbol period, and means for multiplexing the sequence of pilot symbols in a second symbol period.</li><li>26. The apparatus of 24, wherein the means for time division multiplexing the sequence of data symbols and the sequence of pilot symbols comprises<br/>
means for multiplexing the sequence of data symbols and the sequence of pilot symbols in different sample periods of a symbol period.</li><li>27. An apparatus comprising:
<ul><li>a processor operative to form a sequence of pilot symbols and to form a sequence of data symbols; and</li><li>a modulator operative to generate a wideband pilot based on the sequence of pilot symbols, to generate at least one single-carrier frequency division multiple access (SC-FDMA) symbol based on the sequence of data symbols, and to time division multiplex the wideband pilot and the at least one SC-FDMA symbol.</li></ul></li><li>28. The apparatus of 27, wherein the processor is operative to form the sequence of pilot symbols based on a pseudo-random number (PN) sequence.</li><li>29. The apparatus of 27, wherein the modulator is operative to generate at least one interleaved FDMA (IFDMA) symbol or at least one localized FDMA (LFDMA) symbol for the sequence of data symbols.</li><li>30. The apparatus of 27, wherein the wideband pilot is pseudo-random with respect to at least one other wideband pilot from at least one other transmitter.<!-- EPO <DP n="35"> --></li><li>31. The apparatus of 27, wherein the wideband pilot is time aligned with at least one other wideband pilot from at least one other transmitter.</li><li>32. An apparatus comprising:
<ul><li>a demodulator operative to receive at least one single-carrier frequency division multiple access (SC-FDMA) symbol via a communication channel and to process the at least one SC-FDMA symbol to obtain time-domain received pilot symbols; and</li><li>a processor operative to transform the received pilot symbols to obtain frequency-domain pilot values and to derive a frequency response estimate for the communication channel based on the frequency-domain pilot values and using a minimum mean-square error (MMSE) technique or a least-squares (LS) technique.</li></ul></li><li>33. The apparatus of 32, wherein the processor is operative to derive a channel impulse response estimate for the communication channel based on the frequency response estimate.</li><li>34. The apparatus of 32, wherein the processor is operative to filter the frequency response estimate.</li><li>35. The apparatus of 33, wherein the processor is operative to filter the channel impulse response estimate.</li><li>36. The apparatus of 32, wherein the processor is operative to derive frequency response estimates for SC-FDMA symbols sent on at least two sets of frequency subbands, to derive channel impulse response estimates based on the frequency response estimates, and to filter the channel impulse response estimates to obtain an extended channel impulse response estimate having more taps than each of the channel impulse response estimates.</li><li>37. The apparatus of 33, wherein the processor is operative to retain a predetermined number of taps in the channel impulse response estimate and to set remaining taps in the channel impulse response estimate to zeros.<!-- EPO <DP n="36"> --></li><li>38. The apparatus of 37, wherein the processor is operative to select the predetermined number of taps based on a signal-to-noise-and-interference ratio (SNR) or a spectral efficiency for a data transmission via the communication channel.</li><li>39. The apparatus of 33, wherein the processor is operative to retain taps in the channel impulse response estimate exceeding a predetermined threshold and to set remaining taps in the channel impulse response estimate to zeros.</li><li>40. The apparatus of 33, wherein the processor is operative to retain first L taps in the channel impulse response estimate and to set remaining taps in the channel impulse response estimate to zeros, where L is an integer one or greater.</li><li>41. The apparatus of 32, wherein the demodulator is operative to demultiplex received symbols in the at least one SC-FDMA symbol into received data symbols and received pilot symbols.</li><li>42. The apparatus of 32, wherein the demodulator is operative to process the at least one SC-FDMA symbol with an orthogonal sequence for pilot to obtain the received pilot symbols.</li><li>43. The apparatus of 32, further comprising:
<ul><li>an equalizer operative to equalize received data symbols based on the frequency response estimate.</li></ul></li><li>44. An apparatus comprising:
<ul><li>means for processing at least one single-carrier frequency division multiple access (SC-FDMA) symbol received via a communication channel to obtain received pilot symbols;</li><li>means for transforming the received pilot symbols to obtain frequency-domain pilot values, and</li><li>means for deriving a frequency response estimate for the communication channel based on the frequency-domain pilot values and using a minimum mean-square error (MMSE) technique or a least-squares (LS) technique.</li></ul><!-- EPO <DP n="37"> --></li><li>45. The apparatus of 44, further comprising:
<ul><li>means for deriving a channel impulse response estimate for the communication channel based on the frequency response estimate, and</li><li>means for setting at least one tap of the channel impulse response estimate to zero.</li></ul></li><li>46. The apparatus of 44, further comprising:
<ul><li>means for filtering at least two frequency response estimates derived from at least two SC-FDMA symbols for at least two symbol periods.</li></ul></li><li>47. An apparatus comprising:
<ul><li>a demodulator operative to receive a pilot comprised of multiple copies of a sequence of pilot symbols generated with a polyphase sequence and to process the received pilot to obtain received pilot symbols; and</li><li>a processor operative to accumulate received pilot symbols corresponding to the multiple copies of the sequence of pilot symbols.</li></ul></li><li>48. An apparatus comprising:
<ul><li>a demodulator operative to receive at least one single-carrier frequency division multiple access (SC-FDMA) symbol via a communication channel and to time division demultiplex received symbols in the at least one SC-FDMA symbol into received data symbols and received pilot symbols; and</li><li>a processor operative to derive a channel estimate for the communication channel based on the received pilot symbols.</li></ul></li><li>49. An apparatus comprising:
<ul><li>a demodulator operative to receive at least one single-carrier frequency division multiple access (SC-FDMA) symbol via a communication channel and to process the at least one SC-FDMA symbol to obtain received pilot symbols; and</li><li>a processor operative to derive a channel estimate for the communication channel based on the received pilot symbols and using a least-squares (LS) technique.</li></ul></li><li>50. An apparatus comprising:<!-- EPO <DP n="38"> -->
<ul><li>a demodulator operative to receive at least one single-carrier frequency division multiple access (SC-FDMA) symbol via a communication channel and to process the at least one SC-FDMA symbol to obtain time-domain received pilot symbols; and</li><li>a processor operative to identify at least one tap of a channel impulse response estimate for the communication channel by correlating the received pilot symbols with transmitted pilot symbols at different time offsets.</li></ul></li><li>51. The apparatus of 50, wherein the at least one SC-FDMA symbol comprises pilot symbols and data symbols multiplexed across sample periods, and wherein the demodulator is operative to demultiplex the received pilot symbols and received data symbols in the at least one SC-FDMA symbol.</li><li>52. An apparatus comprising:
<ul><li>a demodulator operative to receive at least one single-carrier frequency division multiple access (SC-FDMA) symbol via a communication channel, to process the at least one SC-FDMA symbol to obtain received pilot symbols and received data symbols, and to process the received data symbols with a first channel estimate for the communication channel to obtain data symbol estimates; and</li><li>a first processor operative to derive the first channel estimate based on the received pilot symbols, to estimate interference due to the received data symbols based on the first channel estimate and the data symbol estimates, to derive interference-canceled pilot symbols based on the received pilot symbols and the estimated interference, and to derive a second channel estimate based on the interference-canceled pilot symbols.</li></ul></li><li>53. The apparatus of 52, further comprising:
<ul><li>a second processor operative to process the data symbol estimates to obtain decoded data and to process the decoded data to obtain remodulated data symbols, and wherein the first processor is operative to estimate the interference based on the remodulated data symbols.</li></ul></li><li>54. The apparatus of 52, wherein the demodulator and the first processor are operative to derive the data symbol estimates, to estimate the interference,<!-- EPO <DP n="39"> --> to derive the interference-canceled pilot symbols, and to derive the second channel estimate for a plurality of iterations.</li><li>55. An apparatus comprising:
<ul><li>a demodulator operative to receive at least one single-carrier frequency division multiple access (SC-FDMA) symbol via a communication channel and to process the at least one SC-FDMA symbol to obtain received pilot symbols and received data symbols; and</li><li>a first processor operative to derive a first channel estimate for the communication channel based on the received pilot symbols, to derive a second channel estimate based on the received data symbols, and to derive a third channel estimate based on the first and second channel estimates.</li></ul></li><li>56. The apparatus of 55, wherein the demodulator is operative to process the received data symbols with the first channel estimate to obtain data symbol estimates.</li><li>57. The apparatus of 56, wherein the first processor is operative to derive the second channel estimate based on the received data symbols and the data symbol estimates.</li><li>58. The apparatus of 56, further comprising:
<ul><li>a second processor operative to process the data symbol estimates to obtain decoded data and to process the decoded data to obtain remodulated data symbols, and wherein the first processor is operative to derive the second channel estimate based on the received data symbols and the remodulated data symbols.</li></ul></li><li>59. The apparatus of 55, wherein the first processor is operative to derive the third channel estimate based on a function of the first channel estimate, the second channel estimate, and an indication of confidence in reliability of the data symbol estimates.</li></ol></p></description><claims mxw-id="PCLM90459260" lang="EN" load-source="patent-office"><!-- EPO <DP n="40"> --><claim id="c-en-0001" num="0001"><claim-text>An apparatus comprising:
<claim-text>at least one processor configured to assign frequency resources to a user equipment for transmitting at least one SC-FDMA symbol; and</claim-text>
<claim-text>at least one demodulator configured to receive, from the user equipment, at least one single-carrier frequency division multiple access (SC-FDMA) symbol transmitted on the frequency resources assigned to the user equipment and comprising one or more pilot symbols generated based on a polyphase sequence, to remove a cyclic prefix in each of the at least one SC-FDMA symbol, and to demodulate the at least one SC-FDMA symbol to obtain received pilot symbols.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The apparatus of claim 1, wherein the at least one processor is further configured to derive a channel estimate for the communication channel based on the received pilot symbols.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The apparatus of claim 1, wherein the frequency resources comprise at least one subband set assigned to the user equipment.</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>The apparatus of claim 1, wherein the frequency resources comprise a group of adjacent subbands assigned to the user equipment.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>The apparatus of claim 4, wherein the at least one processor is configured to assign different non-overlapping groups of subbands to different user equipments.</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>The apparatus of claim 4, wherein the user equipment is assigned different groups of subbands in different symbol periods.</claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>The apparatus of claim 1, wherein the user equipment is assigned a pseudo-random sequence to use for forming the pilot symbols,<br/>
in particular wherein the demodulator is operative to demodulate the at least one SC-FDMA symbol to obtain a wideband pilot generated based on the pilot symbols.<!-- EPO <DP n="41"> --></claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>The apparatus of claim 1, wherein the demodulator is configured to perform time division demultiplexing to extract received data symbols and the received pilot symbols from the at least one SC-FDMA symbol,<br/>
in particular wherein the at least one processor is configured to process the received data symbols based on the received pilot symbols to obtain data symbol estimates.</claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>An apparatus comprising:
<claim-text>a processor operative to determine frequency resources assigned to the apparatus and to generate one or more pilot symbols based on a polyphase sequence;</claim-text>
<claim-text>a modulator operative to generate at least one single-carrier frequency division multiple access (SC-FDMA) symbol comprising the sequence of pilot symbols; and</claim-text>
<claim-text>a transmitter operative to transmit the at least one SC-FDMA symbol using the frequency resources assigned to the apparatus.</claim-text></claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>The apparatus of claim 9, wherein the frequency resources comprise at least one subband set assigned to the apparatus.</claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>The apparatus of claim 9, wherein the frequency resources comprise a group of adjacent subbands assigned to the apparatus.</claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>The apparatus of claim 11, wherein the at least one processor is configured to assign different non-overlapping groups of subbands to different apparatuses.</claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>The apparatus of claim 11, wherein the apparatus is assigned different groups of subbands in different symbol periods.</claim-text></claim><claim id="c-en-0014" num="0014"><claim-text>The apparatus of claim 9, wherein the apparatus is assigned a pseudo-random sequence to use for forming the pilot symbols,<br/>
in particular wherein the modulator is operative to generate a wideband pilot based on the sequence of pilot symbols.</claim-text></claim><claim id="c-en-0015" num="0015"><claim-text>The apparatus of claim 9, wherein:<!-- EPO <DP n="42"> -->
<claim-text>the processor is operative to form a sequence of data symbols and to perform time division multiplexing of the sequence of data symbols and the sequence of pilot symbols; and</claim-text>
<claim-text>the modulator operative to generate at least one SC-FDMA symbol based on the time division multiplexed sequence of data symbols and sequence of pilot symbols.</claim-text></claim-text></claim></claims><drawings mxw-id="PDW20421994" load-source="patent-office"><!-- EPO <DP n="43"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="160" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="44"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="162" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="45"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="158" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="46"> --><figure id="f0004" num="4"><img id="if0004" file="imgf0004.tif" wi="165" he="231" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="47"> --><figure id="f0005" num="5A"><img id="if0005" file="imgf0005.tif" wi="120" he="206" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="48"> --><figure id="f0006" num="5B"><img id="if0006" file="imgf0006.tif" wi="147" he="118" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="49"> --><figure id="f0007" num="5C,5D"><img id="if0007" file="imgf0007.tif" wi="160" he="220" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="50"> --><figure id="f0008" num="6"><img id="if0008" file="imgf0008.tif" wi="139" he="184" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="51"> --><figure id="f0009" num="7A,7B"><img id="if0009" file="imgf0009.tif" wi="165" he="205" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="52"> --><figure id="f0010" num="8"><img id="if0010" file="imgf0010.tif" wi="118" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="53"> --><figure id="f0011" num="9"><img id="if0011" file="imgf0011.tif" wi="88" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="54"> --><figure id="f0012" num="10A,10B,11A,11B"><img id="if0012" file="imgf0012.tif" wi="165" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="55"> --><figure id="f0013" num="12A,12B"><img id="if0013" file="imgf0013.tif" wi="165" he="194" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="56"> --><figure id="f0014" num="13A,13B"><img id="if0014" file="imgf0014.tif" wi="165" he="211" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="159" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="159" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
