<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2961105-A1" country="EP" doc-number="2961105" kind="A1" date="20151230" family-id="51390671" file-reference-id="316322" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160451576" ucid="EP-2961105-A1"><document-id><country>EP</country><doc-number>2961105</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-13875516-A" is-representative="YES"><document-id mxw-id="PAPP193866120" load-source="patent-office" format="original"><country>EP</country><doc-number>13875516.0</doc-number><date>20130219</date><lang>JA</lang></document-id><document-id mxw-id="PAPP193866121" load-source="docdb" format="epo"><country>EP</country><doc-number>13875516</doc-number><kind>A</kind><date>20130219</date><lang>JA</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162026958" ucid="JP-2013054041-W" load-source="docdb"><document-id format="epo"><country>JP</country><doc-number>2013054041</doc-number><kind>W</kind><date>20130219</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1957282696" load-source="docdb">H04L  12/40        20060101AFI20160317BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1957283379" load-source="docdb">H04L  12/437       20060101ALI20160317BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1957284552" load-source="docdb">H04L  12/939       20130101ALI20160317BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1987767583" load-source="docdb" scheme="CPC">H04L  12/40176     20130101 FI20151219BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987769791" load-source="docdb" scheme="CPC">H04L  12/437       20130101 LI20151219BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165546194" lang="DE" load-source="patent-office">NETZWERKSYSTEM</invention-title><invention-title mxw-id="PT165546195" lang="EN" load-source="patent-office">NETWORK SYSTEM</invention-title><invention-title mxw-id="PT165546196" lang="FR" load-source="patent-office">SYSTÈME DE RÉSEAU</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR1103309472" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>MITSUBISHI ELECTRIC CORP</last-name><address><country>JP</country></address></addressbook></applicant><applicant mxw-id="PPAR1103309072" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>MITSUBISHI ELECTRIC CORPORATION</last-name></addressbook></applicant><applicant mxw-id="PPAR1101650776" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Mitsubishi Electric Corporation</last-name><iid>101323123</iid><address><street>7-3 Marunouchi 2-chome Chiyoda-ku</street><city>Tokyo 100-8310</city><country>JP</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103320206" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>SHIGEEDA TETSUYA</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103304307" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>SHIGEEDA, TETSUYA</last-name></addressbook></inventor><inventor mxw-id="PPAR1101647620" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>SHIGEEDA, TETSUYA</last-name><address><street>c/o Mitsubishi Electric Corporation 7-3 Marunouchi 2-chome Chiyoda-ku</street><city>Tokyo 100-8310</city><country>JP</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR1101647323" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Witte, Weller &amp; Partner</last-name><iid>101020585</iid><address><street>Postfach 10 54 62</street><city>70047 Stuttgart</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="JP-2013054041-W"><document-id><country>JP</country><doc-number>2013054041</doc-number><kind>W</kind><date>20130219</date><lang>JA</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2014128837-A1"><document-id><country>WO</country><doc-number>2014128837</doc-number><kind>A1</kind><date>20140828</date><lang>JA</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS660607645" load-source="docdb">AL</country><country mxw-id="DS660612295" load-source="docdb">AT</country><country mxw-id="DS660607655" load-source="docdb">BE</country><country mxw-id="DS660689414" load-source="docdb">BG</country><country mxw-id="DS660687852" load-source="docdb">CH</country><country mxw-id="DS660783998" load-source="docdb">CY</country><country mxw-id="DS660612296" load-source="docdb">CZ</country><country mxw-id="DS660607656" load-source="docdb">DE</country><country mxw-id="DS660783999" load-source="docdb">DK</country><country mxw-id="DS660784000" load-source="docdb">EE</country><country mxw-id="DS660695121" load-source="docdb">ES</country><country mxw-id="DS660689419" load-source="docdb">FI</country><country mxw-id="DS660687527" load-source="docdb">FR</country><country mxw-id="DS660607657" load-source="docdb">GB</country><country mxw-id="DS660784001" load-source="docdb">GR</country><country mxw-id="DS660607658" load-source="docdb">HR</country><country mxw-id="DS660612297" load-source="docdb">HU</country><country mxw-id="DS660687853" load-source="docdb">IE</country><country mxw-id="DS660784002" load-source="docdb">IS</country><country mxw-id="DS660687528" load-source="docdb">IT</country><country mxw-id="DS660784003" load-source="docdb">LI</country><country mxw-id="DS660689420" load-source="docdb">LT</country><country mxw-id="DS660611824" load-source="docdb">LU</country><country mxw-id="DS660689421" load-source="docdb">LV</country><country mxw-id="DS660689422" load-source="docdb">MC</country><country mxw-id="DS660611825" load-source="docdb">MK</country><country mxw-id="DS660611826" load-source="docdb">MT</country><country mxw-id="DS660607671" load-source="docdb">NL</country><country mxw-id="DS660687529" load-source="docdb">NO</country><country mxw-id="DS660689428" load-source="docdb">PL</country><country mxw-id="DS660687854" load-source="docdb">PT</country><country mxw-id="DS660607672" load-source="docdb">RO</country><country mxw-id="DS660687859" load-source="docdb">RS</country><country mxw-id="DS660689429" load-source="docdb">SE</country><country mxw-id="DS660695122" load-source="docdb">SI</country><country mxw-id="DS660687530" load-source="docdb">SK</country><country mxw-id="DS660689430" load-source="docdb">SM</country><country mxw-id="DS660784004" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA166479946" lang="EN" load-source="patent-office"><p id="pa01" num="0001">In a configuration where an apparatus network 22 is connected to a backbone network 21 at two points, an apparatus 11-1 and a switch device 2-2 are normally communicatively connected to each other and also communication between an apparatus 11-4 and a switch device 2-1 is normally disconnected. The apparatus 11-1 monitors the link state with the switch device 2-2. The apparatus 11-4 queries the apparatus 11-1 about the link state. When the apparatus 11-1 and the switch device 2-2 are not communicatively connected to each other or when the apparatus 11-4 cannot communicate with the apparatus 11-1 via the apparatus network 22, the apparatus 11-4 cancels the disconnected state with the switch device 2-1.<img id="iaf01" file="imgaf001.tif" wi="165" he="99" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA166759758" lang="EN" source="EPO" load-source="docdb"><p>In a configuration where an apparatus network 22 is connected to a backbone network 21 at two points, an apparatus 11-1 and a switch device 2-2 are normally communicatively connected to each other and also communication between an apparatus 11-4 and a switch device 2-1 is normally disconnected. The apparatus 11-1 monitors the link state with the switch device 2-2. The apparatus 11-4 queries the apparatus 11-1 about the link state. When the apparatus 11-1 and the switch device 2-2 are not communicatively connected to each other or when the apparatus 11-4 cannot communicate with the apparatus 11-1 via the apparatus network 22, the apparatus 11-4 cancels the disconnected state with the switch device 2-1.</p></abstract><description mxw-id="PDES98404647" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001">Field</heading><p id="p0001" num="0001">The present invention relates to a network system having a redundant configuration.</p><heading id="h0002">Background</heading><p id="p0002" num="0002">In order to increase the availability of a network, network redundancy is implemented as a general procedure. Network redundancy refers to securing an additional network apparatus and an additional network line and setting them in standby mode as a backup system. In a case where a network apparatus or a network line in operation is down, it is switched to the standby backup system, and therefore the network can continue to operate without being down. A redundant network system has been widely used.</p><p id="p0003" num="0003">When network redundancy is implemented as described above, the availability of the network can be increased. However, network redundancy needs to be appropriately implemented. For example, when a loop is formed in the network due to the redundancy and a broadcast frame is transmitted to this network, the broadcast frame continuously circulates around this loop, thereby eventually using up the communication band and bringing the network system down. The phenomenon as described above is referred to as "broadcast storm". In order to prevent this phenomenon and properly operate the redundant network, a spanning tree protocol has been conventionally used, for example (see, for example, Non Patent Literature 1).</p><p id="p0004" num="0004">A spanning tree is a function provided to<!-- EPO <DP n="2"> --> switches that constitute the network in order to prevent the broadcast frame from continuously circulating around the loop. This function is realized by a spanning tree protocol. Even though there is a loop in the network configured from the switches, when the spanning tree is enabled, a port (a blocking port) that does not receive communication in practice is automatically set, and eventually a tree structure is formed with one of the switches at the top.</p><heading id="h0003">Citation List</heading><heading id="h0004">Non Patent Literature</heading><p id="p0005" num="0005">Non Patent Literature 1: "<nplcit id="ncit0001" npl-type="b"><text>Routing and Switching Handbook" written by Gene, published by SHUWA SYSTEM CO., LTD., (Chapter 4 "Spanning Tree Protocol</text></nplcit>")</p><heading id="h0005">Summary</heading><heading id="h0006">Technical Problem</heading><p id="p0006" num="0006">A sub-network connected to a backbone network is considered. In a case where the connection of the sub-network to the backbone network is especially important, the sub-network can have a redundant configuration by being connected to the backbone network at two points.</p><p id="p0007" num="0007">However, as a result of this connection, a loop is formed by the backbone network and the sub-network. Therefore, in order to prevent the occurrence of a broadcast storm, it is necessary to perform a procedure not to form a loop communication path.</p><p id="p0008" num="0008">As described above, the spanning tree protocol can be applied, for example, to solve this loop-structure problem. In this case, both the backbone network and the sub-network are required to comply with the spanning tree protocol. Therefore, in the case where a constructed<!-- EPO <DP n="3"> --> backbone network does not comply with the spanning tree protocol, when a sub-network is connected to the backbone network, it is necessary to reconstruct a system such that not only the sub-network, but also the backbone network, comply with the spanning tree protocol.</p><p id="p0009" num="0009">Further, even in a case where the backbone network complies with the spanning tree protocol, when a sub-network is connected to the backbone network, it is necessary to apply the spanning tree protocol to the entire network after the sub-network is connected, in order to reconstruct a communication path in the entire network.</p><p id="p0010" num="0010">Furthermore, when the spanning tree protocol is applied, time is required for convergence of the spanning tree because of processes such as analyzing the connecting structure of the network.</p><p id="p0011" num="0011">The present invention has been achieved in view of the above, and an object of the present invention is to provide a network system that is capable of preventing formation of a loop communication path and securing the redundancy of a network by means of a simple control process without applying a spanning tree protocol, in a case where the network is constituted by connecting an apparatus network that is a sub-network to a backbone network at two points.</p><heading id="h0007">Solution to Problem</heading><p id="p0012" num="0012">In order to solve the above problems and achieve the object, an aspect of the present invention is a network system including: a backbone network that is constituted by combining a plurality of switch devices; and an apparatus network that is constituted by combining a plurality of apparatuses, each of which includes therein a switch unit and a connection control unit that is capable of<!-- EPO <DP n="4"> --> controlling a connection of the switch unit to perform communication, where the apparatus network is connected to the backbone network at only two points by connecting a switch unit of a first apparatus that is one of the apparatuses to the backbone network and by connecting a switch unit of a second apparatus that is another one of the apparatuses to the backbone network, wherein a connection control unit of the first apparatus includes a determination unit that determines whether the switch unit of the first apparatus is communicatively connected to the backbone network, a connection control unit of the second apparatus includes an initial setting unit that initializes a setting of direct communication with the backbone network to a state where the switch unit of the second apparatus is disconnected from the backbone network at startup, and a determination-information obtaining unit that obtains determination information regarding whether the switch unit of the first apparatus is communicatively connected to the backbone network by querying the determination unit via the apparatus network, and based on the determination information obtained from the determination unit by the determination-information obtaining unit, when the switch unit of the first apparatus is communicatively connected to the backbone network, the connection control unit of the second apparatus maintains a state where the switch unit of the second apparatus is disconnected from the backbone network as for direct communication with the backbone network, and when the switch unit of the first apparatus is not communicatively connected to the backbone network or when the second apparatus is not capable of communicating with the first apparatus, the connection control unit of the second apparatus connects the switch unit of the second apparatus to the backbone network such that the switch unit<!-- EPO <DP n="5"> --> of the second apparatus is capable of directly communicating with the backbone network.</p><heading id="h0008">Advantageous Effects of Invention</heading><p id="p0013" num="0013">According to the present invention, an effect is obtained where it is possible to provide a network system that is capable of preventing formation of a loop communication path and securing the redundancy of a network by means of a simple control process without applying a spanning tree protocol, in a case where the network is constituted by connecting an apparatus network to a backbone network at two points.</p><heading id="h0009">Brief Description of Drawings</heading><p id="p0014" num="0014"><ul><li><figref idrefs="f0001">FIG. 1</figref> is a diagram illustrating an example of the configuration of a network system according to a first embodiment.</li><li><figref idrefs="f0001">FIG. 2</figref> is a diagram illustrating an example of the internal configuration of an apparatus according to the first embodiment.</li><li><figref idrefs="f0002">FIG. 3</figref> is a diagram illustrating a part of the functional configuration of a CPU (connection control unit) in apparatuses 11-1 and 11-4.</li><li><figref idrefs="f0002">FIG. 4</figref> is an explanatory diagram of a disconnecting function of a port P2 in the apparatus 1-4.</li><li><figref idrefs="f0003">FIG. 5</figref> is a diagram illustrating an example of the configuration of a network system according to a first modification of the first embodiment.</li><li><figref idrefs="f0003">FIG. 6</figref> is a diagram illustrating an example of the configuration of a network system according to a second modification of the first embodiment.</li><li><figref idrefs="f0004">FIG. 7</figref> is a diagram illustrating an example of the configuration of a network system according to a second<!-- EPO <DP n="6"> --> embodiment.</li></ul></p><heading id="h0010">Description of Embodiments</heading><p id="p0015" num="0015">Exemplary embodiments of a network system according to the present invention will be explained below in detail with reference to the accompanying drawings. The present invention is not limited to the embodiments.</p><heading id="h0011">First embodiment.</heading><p id="p0016" num="0016"><figref idrefs="f0001">FIG. 1</figref> is a diagram illustrating an example of the configuration of a network system according to the present embodiment. As illustrated in <figref idrefs="f0001">FIG. 1</figref>, the network system according to the present embodiment is configured from a backbone network 21 and an apparatus network 22 that is a sub-network connected to the backbone network 21 at two points. The backbone network 21 is constituted by combining switch devices 2-1 and 2-2, for example. The apparatus network 22 is configured to include apparatuses 11-1 to 11-4, for example.</p><p id="p0017" num="0017">Each of the switch devices 2-1 and 2-2 is the Ethernet<sup>®</sup> switch, for example. Each of the switch devices 2-1 and 2-2 includes five ports for network connections, for example. The switch devices 2-1 and 2-2 are connected to each other. While in the example illustrated in <figref idrefs="f0001">FIG. 1</figref>, the number of switch devices that constitute the backbone network 21 is two, it is general that a plurality of switch devices can constitute the backbone network 21.</p><p id="p0018" num="0018">The apparatuses 11-1 to 11-4 are connected in a daisy chain, for example. Specifically, the apparatus 11-1 is connected to the apparatus 11-2, the apparatus 11-2 is connected to the apparatus 11-3, and the apparatus 11-3 is connected to the apparatus 11-4. The apparatus 11-1 (first apparatus), located at one end of the daisy-chain connection in the apparatus network 22, is connected to the<!-- EPO <DP n="7"> --> switch device 2-2 (first switch device). The apparatus 11-4 (second apparatus), located at the other end of the daisy-chain connection in the apparatus network 22, is connected to the switch device 2-1 (second switch device).</p><p id="p0019" num="0019">As described above, in the network system according to the present embodiment, the apparatus network 22 is connected to the backbone network 21 at only two connection points that are the connection point between the switch device 2-2 and the apparatus 11-1 and the connection point between the switch device 2-1 and the apparatus 11-4. Therefore, in this network system, a physical loop (ring) is formed by the switch devices 2-1 and 2-2 and the apparatuses 11-1 to 11-4.</p><p id="p0020" num="0020"><figref idrefs="f0001">FIG. 2</figref> is a diagram illustrating an example of the internal configuration of the apparatus according to the present embodiment. In <figref idrefs="f0001">FIG. 2</figref>, an apparatus 11 represents any of the apparatuses 11-1 to 11-4 in <figref idrefs="f0001">FIG. 1</figref>, a common configuration to these apparatuses is illustrated. The apparatus 11 is configured to include a CPU 101 (connection control unit) and a switch unit 102 connected to this CPU 101.</p><p id="p0021" num="0021">For example, the switch unit 102 includes a switch block 103 that has a function as the Ethernet<sup>®</sup> switch body, network interface (I/F) units 104 and 105, each of which is connected to the switch block 103 to serve as an interface with an external network cable, and a CPU interface (I/F) unit 106 that is connected to the switch block 103 to serve as an interface with the CPU 101.</p><p id="p0022" num="0022">The switch unit 102 includes ports P1 to P3, for example. The port P1 is connected to the switch block 103 through the network I/F unit 104 and is also connected to the external network cable. The port P2 is connected to the switch block 103 through the network I/F unit 105 and<!-- EPO <DP n="8"> --> is also connected to the external network cable. The port P3 is connected to the switch block 103 through the CPU I/F unit 106 and is also connected to the CPU 101.</p><p id="p0023" num="0023">The switch block 103 operates as a switch between the network I/F units 104 and 105 and the CPU I/F unit 106. The switch block 103 is constituted by an IC package, for example. The network I/F units 104 and 105 convert a cable signal to an electrical signal, and vice versa. The network I/F units 104 and 105 are physical layer interfaces. The CPU 101 is connected to the switch block 103 through the CPU I/F unit 106. By controlling this switch block 103, the CPU 101 controls the connection of the switch unit 102 and can communicate externally. <figref idrefs="f0001">FIG. 2</figref> only illustrates a part of the internal configuration of the apparatus 11, which is used for communication. Therefore, illustrations of the configuration specific to the apparatus, aside from the communication function, are omitted. For example, in a case where the apparatus 11 is a display device, it is apparent that there are a display unit and the like in the apparatus 11.</p><p id="p0024" num="0024">As described above, the apparatus 11-1 is connected to the switch device 2-2 in the backbone network 21 through the port P1 by a network cable. Also, the apparatus 11-4 is connected to the switch device 2-1 in the backbone network 21 through the port P2 by a network cable. Therefore, a physical loop (ring) is formed by the apparatus network 22, the backbone network 21, and the network cables connecting them. Accordingly, in order to prevent the occurrence of a broadcast storm, it is necessary to configure an actual communication path not to have a loop.</p><p id="p0025" num="0025">Consequently, in the present embodiment, the apparatuses 11-1 and 11-4 are provided with functions as<!-- EPO <DP n="9"> --> described below. <figref idrefs="f0002">FIG. 3</figref> is a diagram illustrating a part of the functional configuration of the CPU (connection control unit) in the apparatuses 11-1 and 11-4.</p><p id="p0026" num="0026">The apparatus 11-1 is communicatively connected to the switch device 2-2 in the backbone network 21 through the port P1 by a network cable. That is, upon startup (power on), the switch unit of the apparatus 11-1 is communicatively connected to the switch device 2-2 unless a communication failure occurs in the network cable or the like.</p><p id="p0027" num="0027">The CPU (connection control unit) of the apparatus 11-1 includes a determination unit 50 (<figref idrefs="f0002">FIG. 3(a)</figref>) that determines whether the switch unit of the apparatus 11-1 is communicatively connected to the switch device 2-2. The determination unit 50 monitors the link state between the switch device 2-2 and the switch unit of the apparatus 11-1. When the determination unit 50 detects disconnection of the link between the switch device 2-2 and the switch unit of the apparatus 11-1, the determination unit 50 determines that the switch unit of the apparatus 11-1 is not communicatively connected to the switch device 2-2. The determination unit 50 performs this determination process at a given interval, for example.</p><p id="p0028" num="0028">Next, functions of the apparatus 11-4 are described. First, the apparatus 11-4 initializes the settings in order to disconnect direct communication with the backbone network 21 through the port P2 at startup (power on). That is, the CPU (connection control unit) of the apparatus 11-4 includes an initial setting unit 60 (<figref idrefs="f0002">FIG. 3(b)</figref>) that initializes the settings of direct communication with the switch device 2-2 to a state where the switch unit of the apparatus 11-4 is disconnected from the switch device 2-2 at startup (power on).<!-- EPO <DP n="10"> --></p><p id="p0029" num="0029">Upon startup (power on), the apparatus 11-4 obtains determination information regarding whether the switch unit of the apparatus 11-1 is communicatively connected to the backbone network 21 from the apparatus 11-1 (the determination unit 50) via the apparatus network 22. That is, the CPU (connection control unit) of the apparatus 11-4 includes a determination-information obtaining unit 61 that obtains determination information regarding whether the switch unit of the apparatus 11-1 is communicatively connected to the switch device 2-2 from the determination unit 50 using the apparatus network 22. For example, the determination-information obtaining unit 61 queries the determination unit 50 about the determination information and therefore can obtain the determination information as a response from the determination unit 50. For example, the determination-information obtaining unit 61 queries the determination unit 50 at a given interval and can obtain determination information sent back from the determination unit 50 at the given interval. The determination-information obtaining unit 61 can obtain determination information from the determination unit 50 by this method or any other method. For example, the apparatus 11-1 does not depend on a query from the determination-information obtaining unit 61, but can regularly transmit determination information to the apparatus 11-4 using the apparatus network 22, such that the determination-information obtaining unit 61 obtains this determination information.</p><p id="p0030" num="0030">Further, the CPU (connection control unit) of the apparatus 11-4 refers to the determination information obtained from the determination unit 50 by the determination-information obtaining unit 61. When the switch unit of the apparatus 11-1 is communicatively connected to the switch device 2-2, the CPU (connection<!-- EPO <DP n="11"> --> control unit) of the apparatus 11-4 maintains the state where the switch unit of the apparatus 11-4 is disconnected from the backbone network 21 as for direct communication with the switch device 2-1. When the switch unit of the apparatus 11-1 is not communicatively connected to the switch device 2-2 or when the apparatus 11-4 cannot communicate with the apparatus 11-1, the CPU (connection control unit) of the apparatus 11-4 sets the switch unit of the apparatus 11-4 to be connected to the switch device 2-1 so as to be capable of directly communicating with the switch device 2-1. That is, the apparatus 11-4 normally disconnects communication with the backbone network 23 through the port P2 to prevent formation of a loop communication path. On the other hand, in a case where a communication failure has occurred between the apparatus 11-1 and the switch device 2-2 or where a communication failure has occurred in the apparatus network 22 connecting the apparatus 11-1 and the apparatus 11-4, the apparatus 11-4 starts communicating with the backbone network 23 through the port P2, which has been disconnected, in order to secure the redundancy of network communication.</p><p id="p0031" num="0031">Disconnection and cancellation of communication through the port P2 in the apparatus 11-4 can be easily achieved by using a port VLAN (virtual VLAN), for example. Specifically, the same VLAN number is set for the ports P1 and P3, and the VLAN number that is different from that for the ports P1 and P3 is set for the port P2. In this manner, the ports P1 and P3 are set to a different group from the port P2.</p><p id="p0032" num="0032">The ports P1 and P3 are set to belong to the same group, and the port P2 is set to belong to a different group from the ports P1 and P3. Therefore, a communication path is established between the network I/F unit 104<!-- EPO <DP n="12"> --> connected to the port P1 and the CPU I/F unit 106 connected to the port P3. However, a communication path is not established for an independently-grouped single port P2. Accordingly, communication between the network I/F unit 104 and the network I/F unit 105, i.e., communication between the ports P1 and P2, is disconnected.</p><p id="p0033" num="0033"><figref idrefs="f0002">FIG. 4</figref> schematically illustrates, by an arrow R1, that as a result of setting the port VLAN as described above, the CPU 101 can communicate with the backbone network 21 via the port P1; however, the CPU 101 cannot communicate with the backbone network 21 via the port P2.</p><p id="p0034" num="0034">As described above, because, in the apparatus 11-4, the port VLAN is set in the switch block 103, communication between the network I/F unit 104 and the network I/F unit 105 in the apparatus 11-4 is normally disconnected, and communication through the port P2 in the apparatus 11-4 is normally disconnected. Therefore, although the backbone network 21 and the apparatus network 22 are connected at two points, a loop communication path is not formed in the network. That is, although a physical loop is formed by connecting the backbone network 21 and the apparatus network 22, a communication path between the backbone network 21 and the apparatus network 22 passes through the network cable connecting the switch device 2-2 and the apparatus 11-1, and accordingly the backbone network 21 and the apparatus network 22 are substantially in a state of being connected at this one point.</p><p id="p0035" num="0035">Meanwhile, when the switch unit of the apparatus 11-1 is not communicatively connected to the switch device 2-2 or when the apparatus 11-4 cannot communicate with the apparatus 11-1, the apparatus 11-4 determines that a fault has occurred in the connection between the apparatus 11-1 and the switch device 2-2 or in the apparatus network 22,<!-- EPO <DP n="13"> --> and then cancels the port VLAN setting. As a result of this, in the apparatus 11-4, it is possible to communicate between the network I/F unit 104, the network I/F unit 105, and the CPU I/F unit 106. That is, the apparatus 11-4 can perform communication through two ports P1 and P2 in a similar manner to the other apparatuses 11-1 to 11-3.</p><p id="p0036" num="0036">Next, operations of the network system in the present embodiment are described with reference to <figref idrefs="f0001 f0002">FIGS. 1 to 4</figref>. First, in a state where the apparatus network 22 is connected to the backbone network 21 as illustrated in <figref idrefs="f0001">FIG. 1</figref>, the power is turned on to start up the network system.</p><p id="p0037" num="0037">At startup, the apparatus 11-1 is communicatively connected to the switch device 2-2 through the port P1. Upon startup, the determination unit 50 in the apparatus 11-1 monitors the link state with the switch device 2-2 at, for example, a given interval, determines whether the switch unit of the apparatus 11-1 is communicatively connected to the switch device 2-2, and stores the determination result as determination information.</p><p id="p0038" num="0038">Meanwhile, at startup, the apparatus 11-4 is set to a state of disconnecting communication with the switch device 2-1 through the port P2. This is performed by the initial setting unit 60 by setting the port VLAN in the switch block 103, for example. Therefore, a loop is not formed in a network communication path. The apparatuses 11-1 to 11-4 are all connected to the backbone network 21 via the switch device 2-2.</p><p id="p0039" num="0039">Upon startup, the apparatus 11-4 obtains determination information regarding the link state with the switch device 2-2 from the apparatus 11-1 at a given interval, for example. This is performed, for example, by the determination-information obtaining unit 61 by querying the determination unit 50 at a given interval and by the<!-- EPO <DP n="14"> --> determination unit 50 by sending the latest determination information back to the determination-information obtaining unit 61 as a response to the query.</p><p id="p0040" num="0040">Next, based on the latest determination information, when the switch unit of the apparatus 11-1 is communicatively connected to the switch device 2-2, the CPU (connection control unit) of the apparatus 11-4 maintains the state of disconnecting communication with the switch device 2-1 through the port P2. That is, as for direct communication with the switch device 2-1, the switch unit of the apparatus 11-4 remains in the disconnected state from the switch device 2-1. In contrast to this, based on the latest determination information, when the switch unit of the apparatus 11-1 is not communicatively connected to the switch device 2-2 or when the apparatus 11-4 cannot communicate with the apparatus 11-1 via the apparatus network 22, the CPU (connection control unit) of the apparatus 11-4 determines that a communication failure has occurred between the apparatus 11-1 and the switch device 2-2 or a communication failure has occurred in the apparatus network 22, and communicatively connects the switch unit of the apparatus 11-4 to the switch device 2-1 through the port P2. For example, the CPU (connection control unit) of the apparatus 11-4 cancels the port VLAN that has been set in the switch block 103 to communicatively connect the switch unit of the apparatus 11-4 to the switch device 2-1.</p><p id="p0041" num="0041">As described above, according to the present embodiment, in a case where a network is constituted by connecting the apparatus network 22 to the backbone network 21 at two points, the determination unit 50 is provided in the apparatus 11-1 and also the initial setting unit 60 and the determination-information obtaining unit 61 are<!-- EPO <DP n="15"> --> provided in the apparatus 11-4 so as to normally disconnect direct communication between the apparatus 11-4 and the switch device 2-1 and so as to start the direct communication between the apparatus 11-4 and the switch device 2-1 when a communication failure occurs between the apparatus 11-1 and the switch device 2-2 or in the apparatus network 22. Therefore, by means of a simple control process, formation of a loop (ring) communication path can be prevented and also the redundancy of the network can be secured.</p><p id="p0042" num="0042">According to the present embodiment, a redundant network can be constructed without applying a spanning tree protocol to both the backbone network 21 and the apparatus network 22.</p><p id="p0043" num="0043">In a conventional network system to which a spanning tree protocol is applied, in order to determine a root bridge, it is necessary that switches communicate with each other. For example, bridge protocol data units (BPDUs) need to be exchanged between all the switches. In contrast thereto, in the present embodiment, the redundancy of the network can be secured by providing an additional function only to the apparatuses 11-1 and 11-4 that are connected directly to the backbone network 21 without the need of providing an additional function to the apparatuses 11-2 and 11-3 and to the backbone network 21 and without transmitting and receiving data between devices other than between the apparatuses 11-1 and 11-4.</p><p id="p0044" num="0044">By detecting the link state with the switch device 2-2, the apparatus 11-1 determines whether it is possible for the apparatus 11-1 and the backbone network 21 to communicate with each other. As described above, whether it is possible for the apparatus 11-1 and the backbone network 21 to communicate with each other is<!-- EPO <DP n="16"> --> determined based on a monitoring function in the apparatus 11-1. Therefore, it is not necessary to provide a separate device or the like that determines the possibility of communication therebetween in the backbone network 21. Accordingly, any additional setting change is not needed in the backbone network 21.</p><p id="p0045" num="0045">In the present embodiment, as illustrated in <figref idrefs="f0001">FIG. 1</figref>, the apparatuses 11-1 to 11-4 are connected in a daisy chain, for example. However, it is satisfactory if the network system has a configuration in which the apparatus network 22 and the backbone network 21 are connected at two points. The network system does not depend on a specific configuration of the apparatus network 22. For example, a configuration as illustrated in <figref idrefs="f0003">FIG. 5</figref> is also possible.</p><p id="p0046" num="0046"><figref idrefs="f0003">FIG. 5</figref> is a diagram illustrating the configuration of a network system according to a first modification of the present embodiment. In <figref idrefs="f0003">FIG. 5</figref>, an apparatus network 24 is configured differently from <figref idrefs="f0001">FIG. 1</figref>. That is, the apparatus network 24 is configured from, for example, the apparatuses 11-1 to 11-4, a switch device 2-10, and other devices, and the apparatuses 11-1 and 11-4 are not connected in a daisy chain. Specifically, the apparatus 11-1 is connected to the apparatus 11-2, the apparatus 11-2 is connected to the switch device 2-10, and the switch device 2-10 is connected to the apparatuses 11-3 and 11-4. However, the apparatus 11-1 is connected to the switch device 2-2 and the apparatus 11-4 is connected to the switch device 2-1 in a similar manner to that in <figref idrefs="f0001">FIG. 1</figref>. The apparatuses 11-1 and 11-4 have functions similar to the functions described with reference to <figref idrefs="f0001 f0002">FIGS. 1 to 4</figref>.</p><p id="p0047" num="0047">Further, the apparatus 11-4 normally disconnects direct communication with the switch device 2-1. Based on the latest determination information from the apparatus 11-1,<!-- EPO <DP n="17"> --> when the switch unit of the apparatus 11-1 is not communicatively connected to the switch device 2-2 or when the apparatus 11-4 cannot communicate with the apparatus 11-1 via the apparatus network 24 (specifically, via the switch device 2-10 and the apparatus 11-2 in this order), the apparatus 11-4 starts direct communication with the switch device 2-1. Due to this operation, the present modification can achieve effects similar to those in the configuration in <figref idrefs="f0001 f0002">FIGS. 1 to 4</figref>.</p><p id="p0048" num="0048">In the present embodiment, the backbone network 21 is configured from two switch devices 2-1 and 2-2, for example. However, the present embodiment can be applied without depending on the configuration of the backbone network 21. For example, a configuration as illustrated in <figref idrefs="f0003">FIG. 6</figref> is also possible.</p><p id="p0049" num="0049"><figref idrefs="f0003">FIG. 6</figref> is a diagram illustrating the configuration of a network system according to a second modification of the present embodiment. In <figref idrefs="f0003">FIG. 6</figref>, a backbone network 23 is configured differently from <figref idrefs="f0001">FIG. 1</figref>. That is, the backbone network 23 is configured from, for example, switch devices 2-1 to 2-3 and other devices, and a physical loop (ring) is formed by connecting the switch devices 2-1 to 2-3. The apparatus network 22 is connected to the backbone network 23 at two points. Specifically, the apparatus 11-1 and the switch device 2-2 are connected and the apparatus 11-4 and the switch device 2-1 are connected. The apparatuses 11-1 and 11-4 have functions similar to the functions described with reference to <figref idrefs="f0001 f0002">FIGS. 1 to 4</figref>.</p><p id="p0050" num="0050">The backbone network 23 is an existing network that has been already in operation, and therefore a case is considered where the apparatus network 22 is additionally connected to this existing backbone network 23. In this<!-- EPO <DP n="18"> --> case, because the backbone network 23 has been already in operation, it is apparent that a procedure has been performed in order not to form a loop (ring) in a communication path by any method. In a case where the apparatus network 22 is connected to this existing backbone network 23, a new physical loop (ring) is formed by the backbone network 23, the apparatus network 22, and network cables connecting them. However, the apparatuses 11-1 and 11-4 perform the control process described with reference to <figref idrefs="f0001 f0002">FIGS. 1 to 4</figref>. This can prevent generation of a loop communication path and can also secure the redundancy of the network.</p><p id="p0051" num="0051">As described above, even in a case where the backbone network 23 has been already constructed, the apparatus network 22 is connected later to this backbone network 23, and the apparatuses 11-1 to 11-4 are mounted on the apparatus network 22, formation of a loop can still be prevented without depending on the configuration of the backbone network 23 and without changing the configuration of the backbone network 23. Therefore, even in a case where the apparatus network 22 is added, the network system is easily constructed.</p><p id="p0052" num="0052">In contrast thereto, in a conventional case where a spanning tree protocol is applied, when a sub-network is additionally connected, it is necessary to apply the spanning tree protocol to the entire network after the sub-network is connected in order to reconstruct a communication path.</p><heading id="h0012">Second embodiment.</heading><p id="p0053" num="0053"><figref idrefs="f0004">FIG. 7</figref> is a diagram illustrating an example of the configuration of a network system according to the present embodiment. As illustrated in <figref idrefs="f0004">FIG. 7</figref>, the network system according to the present embodiment is constructed within a<!-- EPO <DP n="19"> --> train. The train is constituted by a formation in which a plurality of vehicles are coupled with each other, for example. <figref idrefs="f0004">FIG. 7</figref> illustrates a first car (a head vehicle or a tail vehicle) and a second car, for example. There is also a case where a train is constituted by a single-vehicle formation or a three or more-vehicle formation.</p><p id="p0054" num="0054">A backbone network 201 is a network provided across the vehicles within the train. The backbone network 201 is configured to include switch devices 2-1 to 2-4, and a management device 1, for example. The switch devices 2-1 to 2-4 are connected in a daisy chain in this order, for example. That is, the switch device 2-1 is connected to the switch device 2-2, the switch device 2-2 is connected to the switch device 2-3, and the switch device 2-3 is connected to the switch device 2-4. The management device 1 and the switch devices 2-1 and 2-2 are installed in the first car, for example. The management device 1 is connected to the switch device 2-1, for example. The switch devices 2-3 and 2-4 are installed in the second car, for example. Each of the switch devices 2-1 to 2-4 is the Ethernet<sup>®</sup> switch, for example, in a similar manner to the first embodiment. The number of switch devices installed in each vehicle is not limited to two in the example in <figref idrefs="f0004">FIG. 7</figref>.</p><p id="p0055" num="0055">In order to monitor the state of apparatuses 11-1 to 11-9, the management device 1 regularly communicates with these apparatuses 11-1 to 11-9 using the backbone network 201 and apparatus networks 202 and 203. The management device 1 is specifically a train-information management device. The train-information management device is a device that collects and manages train information, and can monitor the operating states of in-vehicle apparatuses and also individually control an operation of<!-- EPO <DP n="20"> --> each apparatus. The train-information management device regularly transmits a state-data request signal to the in-vehicle apparatuses. Upon reception of this state-data request signal, each of the apparatuses sends a response signal including the state data of the apparatus back to the management device 1. In this manner, the train-information management device regularly communicates with the in-vehicle apparatuses. The management device 1 can be provided in a vehicle other than the first car or the management device 1 can be provided in each vehicle.</p><p id="p0056" num="0056">The apparatus network 202 is a sub-network of apparatuses provided in the first car and is connected to the backbone network 201 at two points. The apparatus network 202 is configured from four apparatuses 11-1 to 11-4 that are connected in a daisy chain, for example. Specifically, the apparatus 11-1 is connected to the apparatus 11-2, the apparatus 11-2 is connected to the apparatus 11-3, and the apparatus 11-3 is connected to the apparatus 11-4. Each of the apparatuses 11-1 to 11-4 has an internal configuration similar to the apparatus 11 described in the first embodiment (see <figref idrefs="f0001 f0002">FIGS. 2 to 4</figref>). Particularly, the apparatus 11-1 in the apparatus network 202 is connected to the switch device 2-2 and has functions identical to the apparatus 11-1 in the first embodiment. Also, the apparatus 11-4 in the apparatus network 202 is connected to the switch device 2-1 and has functions identical to the apparatus 11-4 in the first embodiment. Therefore, the connecting mode between the apparatus network 202 and the backbone network 201 is similar to that in <figref idrefs="f0001">FIG. 1</figref> in the first embodiment.</p><p id="p0057" num="0057">The apparatus network 203 is a sub-network of apparatuses provided in the second car and is connected to the backbone network 201 at two points. The apparatus<!-- EPO <DP n="21"> --> network 203 is configured from five apparatuses 11-5 to 11-9 that are connected in a daisy chain, for example. Specifically, the apparatus 11-5 is connected to the apparatus 11-6, the apparatus 11-6 is connected to the apparatus 11-7, the apparatus 11-7 is connected to the apparatus 11-8, and the apparatus 11-8 is connected to the apparatus 11-9. Each of the apparatuses 11-5 to 11-9 has an internal configuration similar to the apparatus 11 described in the first embodiment (see <figref idrefs="f0001 f0002">FIGS. 2 to 4</figref>). Particularly, the apparatus 11-5 in the apparatus network 203 is connected to the switch device 2-4 and has functions identical to the apparatus 11-1 in the first embodiment. Also, the apparatus 11-9 in the apparatus network 203 is connected to the switch device 2-3 and has functions identical to the apparatus 11-4 in the first embodiment. Therefore, the connecting mode between the apparatus network 203 and the backbone network 201 is also similar to that in <figref idrefs="f0001">FIG. 1</figref> in the first embodiment.</p><p id="p0058" num="0058">As described above, in the present embodiment, in a case where a network is constituted by connecting each of the apparatus networks 202 and 203 to the backbone network 201 at two points, formation of a loop communication path can be prevented and also the redundancy of the network can be secured by means of a simple control process in a similar manner to the first embodiment without applying a spanning tree protocol.</p><p id="p0059" num="0059">The apparatuses 11-1 to 11-9 can be display devices, for example. In this case, the redundancy of the apparatus networks 202 and 203 is secured and the redundancy of onboard displays by the apparatuses 11-1 to 11-9 is secured.</p><p id="p0060" num="0060">While in the present embodiment, the network system is configured to provide an apparatus network in<!-- EPO <DP n="22"> --> each vehicle, the network system can be also configured to provide an apparatus network across a plurality of vehicles. Other configurations, operations, and effects of the present embodiment are similar to those of the first embodiment.</p><heading id="h0013">Industrial Applicability</heading><p id="p0061" num="0061">The present invention is useful as a network system having a redundant configuration.</p><heading id="h0014">Reference Signs List</heading><p id="p0062" num="0062">1 management device, 2-1 to 2-4, 2-10 switch device, 11-1 to 11-9 apparatus, 21, 23, 201 backbone network, 22, 24, 202, 203 apparatus network, 50 determination unit, 60 initial setting unit, 61 determination-information obtaining unit, 101 CPU, 102 switch unit, 103 switch block, 104, 105 network interface (I/F) unit, 106 CPU interface (I/F) unit, P1 to P3 port.</p></description><claims mxw-id="PCLM90459588" lang="EN" load-source="patent-office"><!-- EPO <DP n="23"> --><claim id="c-en-0001" num="0001"><claim-text>A network system comprising:
<claim-text>a backbone network that is constituted by combining a plurality of switch devices; and</claim-text>
<claim-text>an apparatus network that is constituted by combining a plurality of apparatuses, each of which includes therein a switch unit and a connection control unit that is capable of controlling a connection of the switch unit to perform communication, where the apparatus network is connected to the backbone network at only two points by connecting a switch unit of a first apparatus that is one of the apparatuses to the backbone network and by connecting a switch unit of a second apparatus that is another one of the apparatuses to the backbone network, wherein</claim-text>
<claim-text>a connection control unit of the first apparatus includes a determination unit that determines whether the switch unit of the first apparatus is communicatively connected to the backbone network,</claim-text>
<claim-text>a connection control unit of the second apparatus includes
<claim-text>an initial setting unit that initializes a setting of direct communication with the backbone network to a state where the switch unit of the second apparatus is disconnected from the backbone network at startup, and</claim-text>
<claim-text>a determination-information obtaining unit that obtains determination information regarding whether the switch unit of the first apparatus is communicatively connected to the backbone network by querying the determination unit via the apparatus network, and</claim-text></claim-text>
<claim-text>based on the determination information obtained from the determination unit by the determination-information obtaining unit, when the switch unit of the first apparatus is communicatively connected to the backbone network, the<!-- EPO <DP n="24"> --> connection control unit of the second apparatus maintains a state where the switch unit of the second apparatus is disconnected from the backbone network as for direct communication with the backbone network, and when the switch unit of the first apparatus is not communicatively connected to the backbone network or when the second apparatus is not capable of communicating with the first apparatus, the connection control unit of the second apparatus connects the switch unit of the second apparatus to the backbone network such that the switch unit of the second apparatus is capable of directly communicating with the backbone network.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The network system according to claim 1, wherein<br/>
the apparatuses are connected in a daisy chain,<br/>
an apparatus at one end of the daisy-chain connection is the first apparatus, and<br/>
an apparatus at another end of the daisy-chain connection is the second apparatus.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The network system according to claim 1 or 2, wherein the backbone network is constituted by connecting the switch devices in a loop.</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>The network system according to any one of claims 1 to 3, wherein<br/>
the backbone network is provided across vehicles of a train, and<br/>
the apparatus network is provided in each of the vehicles.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>The network system according to claim 4, wherein each of the apparatuses is a display unit.</claim-text></claim></claims><drawings mxw-id="PDW20422310" load-source="patent-office"><!-- EPO <DP n="25"> --><figure id="f0001" num="1,2"><img id="if0001" file="imgf0001.tif" wi="165" he="211" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="26"> --><figure id="f0002" num="3(a),3(b),4"><img id="if0002" file="imgf0002.tif" wi="154" he="231" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="27"> --><figure id="f0003" num="5,6"><img id="if0003" file="imgf0003.tif" wi="165" he="229" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="28"> --><figure id="f0004" num="7"><img id="if0004" file="imgf0004.tif" wi="165" he="142" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="165" he="232" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
