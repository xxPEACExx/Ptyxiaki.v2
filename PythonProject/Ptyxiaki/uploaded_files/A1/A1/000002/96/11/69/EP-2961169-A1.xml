<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2961169-A1" country="EP" doc-number="2961169" kind="A1" date="20151230" family-id="51162649" file-reference-id="254717" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160451173" ucid="EP-2961169-A1"><document-id><country>EP</country><doc-number>2961169</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-14305998-A" is-representative="YES"><document-id mxw-id="PAPP193865314" load-source="patent-office" format="original"><country>EP</country><doc-number>14305998.8</doc-number><date>20140625</date><lang>EN</lang></document-id><document-id mxw-id="PAPP193865315" load-source="docdb" format="epo"><country>EP</country><doc-number>14305998</doc-number><kind>A</kind><date>20140625</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162032639" ucid="EP-14305998-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>14305998</doc-number><kind>A</kind><date>20140625</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1988523242" load-source="docdb">H04N  19/186       20140101ALN20140922BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988526753" load-source="docdb">H04N  19/615       20140101AFI20140922BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988527808" load-source="docdb">H04N  19/36        20140101ALI20140922BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1987766178" load-source="docdb" scheme="CPC">H04N  19/14        20141101 LI20150821BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987766671" load-source="docdb" scheme="CPC">H04N  19/36        20141101 LI20141108BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987771849" load-source="docdb" scheme="CPC">H04N  19/615       20141101 FI20141108BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987777017" load-source="docdb" scheme="CPC">H04N  19/187       20141101 LI20150821BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987784537" load-source="docdb" scheme="CPC">H04N  19/1883      20141101 LI20150821BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987786394" load-source="docdb" scheme="CPC">H04N  19/86        20141101 LI20150821BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987794975" load-source="docdb" scheme="CPC">H04N  19/117       20141101 LI20150821BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165544985" lang="DE" load-source="patent-office">Verfahren und Vorrichtung zur Verarbeitung von Bildern</invention-title><invention-title mxw-id="PT165544986" lang="EN" load-source="patent-office">Method and device for processing images</invention-title><invention-title mxw-id="PT165544987" lang="FR" load-source="patent-office">Procédé et dispositif de traitement d'images</invention-title><citations><non-patent-citations><nplcit><text>BENJAMIN GUTHIER ET AL: "Flicker reduction in tone mapped high dynamic range video", PROCEEDINGS OF SPIE, vol. 7866, 23 January 2011 (2011-01-23), pages 78660C, XP055061689, ISSN: 0277-786X, DOI: 10.1117/12.872449</text><sources><source mxw-id="PNPL63883830" load-source="docdb" name="SEA" category="AD"/></sources></nplcit><nplcit><text>BOITARD R.; THOREAU D.; BOUATOUCH K.; COZOT R.: "Temporal Coherency in Video Tone Mapping, a Survey", HDRI2013 - FIRST INTERNATIONAL CONFERENCE AND SME WORKSHOP ON HDR IMAGING, vol. 1, 2013, pages 1 - 6, XP055116201</text><sources><source mxw-id="PNPL63883831" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>CHUL LEE ET AL: "Gradient Domain Tone Mapping of High Dynamic Range Videos", IMAGE PROCESSING, 2007. ICIP 2007. IEEE INTERNATIONAL CONFERENCE ON, IEEE, PI, 1 September 2007 (2007-09-01), pages III - 461, XP031158104, ISBN: 978-1-4244-1436-9</text><sources><source mxw-id="PNPL63883832" load-source="docdb" name="SEA" category="A"/></sources></nplcit><nplcit><text>GUTHIER, B.; KOPF, S.; EBLE, M.; EFFELSBERG, W.: "Flicker reduction in tone mapped high dynamic range video", PROC. OF IS&amp;T/SPIE ELECTRONIC IMAGING (EI) ON COLOR IMAGING XVI: DISPLAYING, PROCESSING, HARDCOPY, AND APPLICATIONS, 2011, pages 78660C - 78660C,15, XP055061689, DOI: doi:10.1117/12.872449</text><sources><source mxw-id="PNPL63883833" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>LEE C.; KIM C.-S.: "Gradient Domain Tone Mapping of High Dynamic Range Videos", 2007 IEEE INTERNATIONAL CONFERENCE ON IMAGE PROCESSING, 2007, pages 111 - 461,111-464, XP031158104</text><sources><source mxw-id="PNPL63883834" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>LI Y ET AL: "Compressing and companding high dynamic range images with subband architectures", ACM TRANSACTIONS ON GRAPHICS (TOG), ACM, US, vol. 24, no. 3, 1 July 2005 (2005-07-01), pages 836 - 844, XP003010943, ISSN: 0730-0301, DOI: 10.1145/1073204.1073271</text><sources><source mxw-id="PNPL63883835" load-source="docdb" name="SEA" category="XA"/></sources></nplcit><nplcit><text>RONAN BOITARD ET AL: "Survey of Temporal Brightness Artifacts in Video Tone Mapping", HDRI2014 - SECOND INTERNATIONAL CONFERENCE AND SME WORKSHOP ON HDR IMAGING, 4 March 2014 (2014-03-04), Sarajevo, Bosnia and Herzegovina, XP055116201, Retrieved from the Internet &lt;URL:http://people.irisa.fr/Ronan.Boitard/articles/2014/Survey of Temporal Artifacts in Video Tone Mapping.pdf&gt; [retrieved on 20140502]</text><sources><source mxw-id="PNPL63883836" load-source="docdb" name="SEA" category="A"/></sources></nplcit><nplcit><text>RONAN BOITARD ET AL: "Temporal coherency for video tone mapping", PROCEEDINGS OF SPIE, vol. 8499, 15 October 2012 (2012-10-15), pages 84990D, XP055116195, ISSN: 0277-786X, DOI: 10.1117/12.929600</text><sources><source mxw-id="PNPL63883837" load-source="docdb" name="SEA" category="AD"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR1103343555" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>THOMSON LICENSING</last-name><address><country>FR</country></address></addressbook></applicant><applicant mxw-id="PPAR1103335799" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>THOMSON LICENSING</last-name></addressbook></applicant><applicant mxw-id="PPAR1101640490" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Thomson Licensing</last-name><iid>101157220</iid><address><street>1-5, rue Jeanne d'Arc</street><city>92130 Issy-Les-Moulineaux</city><country>FR</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103328757" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>BOITARD RONAN</last-name><address><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103331040" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>BOITARD, Ronan</last-name></addressbook></inventor><inventor mxw-id="PPAR1101653378" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>BOITARD, Ronan</last-name><address><street>Technicolor R&amp;D France 975, avenue des Champs Blancs ZAC des Champs Blancs CS 176 16</street><city>35 576 Cesson Sévigné</city><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103309619" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>POILI TANIA</last-name><address><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103326677" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>Poili, Tania</last-name></addressbook></inventor><inventor mxw-id="PPAR1101650529" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>Poili, Tania</last-name><address><street>Technicolor R&amp;D France 975, avenue des Champs Blancs ZAC des Champs Blancs CS 176 16</street><city>35 576 Cesson Sévigné</city><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103324928" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>THOREAU DOMINIQUE</last-name><address><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103324976" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>THOREAU, DOMINIQUE</last-name></addressbook></inventor><inventor mxw-id="PPAR1101648534" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>THOREAU, DOMINIQUE</last-name><address><street>Technicolor R&amp;D France 975, avenue des Champs Blancs ZAC des Champs Blancs CS 176 16</street><city>35 576 Cesson Sévigné</city><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103322029" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>COZOT REMI</last-name><address><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103342974" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>COZOT, REMI</last-name></addressbook></inventor><inventor mxw-id="PPAR1101642089" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>COZOT, REMI</last-name><address><street>Campus Beaulieu 263 Avenue du Général Leclerc</street><city>F-35042 Rennes</city><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103319666" load-source="docdb" sequence="5" format="epo"><addressbook><last-name>BOUATOUCH KADI</last-name><address><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103333402" load-source="docdb" sequence="5" format="intermediate"><addressbook><last-name>BOUATOUCH, Kadi</last-name></addressbook></inventor><inventor mxw-id="PPAR1101645165" load-source="patent-office" sequence="5" format="original"><addressbook><last-name>BOUATOUCH, Kadi</last-name><address><street>Campus Beaulieu 263 Avenue du Général Leclerc</street><city>F-35042 Rennes</city><country>FR</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR1101641546" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Browaeys, Jean-Philippe</last-name><suffix>et al</suffix><iid>101187942</iid><address><street>Technicolor 1, rue Jeanne d'Arc</street><city>92443 Issy-Les-Moulineaux</city><country>FR</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS660680944" load-source="docdb">AL</country><country mxw-id="DS660782001" load-source="docdb">AT</country><country mxw-id="DS660680946" load-source="docdb">BE</country><country mxw-id="DS660681010" load-source="docdb">BG</country><country mxw-id="DS660604959" load-source="docdb">CH</country><country mxw-id="DS660680842" load-source="docdb">CY</country><country mxw-id="DS660680847" load-source="docdb">CZ</country><country mxw-id="DS660683208" load-source="docdb">DE</country><country mxw-id="DS660680947" load-source="docdb">DK</country><country mxw-id="DS660680848" load-source="docdb">EE</country><country mxw-id="DS660605138" load-source="docdb">ES</country><country mxw-id="DS660681019" load-source="docdb">FI</country><country mxw-id="DS660681020" load-source="docdb">FR</country><country mxw-id="DS660683209" load-source="docdb">GB</country><country mxw-id="DS660680948" load-source="docdb">GR</country><country mxw-id="DS660683210" load-source="docdb">HR</country><country mxw-id="DS660680849" load-source="docdb">HU</country><country mxw-id="DS660604960" load-source="docdb">IE</country><country mxw-id="DS660680949" load-source="docdb">IS</country><country mxw-id="DS660681021" load-source="docdb">IT</country><country mxw-id="DS660680950" load-source="docdb">LI</country><country mxw-id="DS660683219" load-source="docdb">LT</country><country mxw-id="DS660782002" load-source="docdb">LU</country><country mxw-id="DS660683220" load-source="docdb">LV</country><country mxw-id="DS660683221" load-source="docdb">MC</country><country mxw-id="DS660782003" load-source="docdb">MK</country><country mxw-id="DS660782004" load-source="docdb">MT</country><country mxw-id="DS660782005" load-source="docdb">NL</country><country mxw-id="DS660604961" load-source="docdb">NO</country><country mxw-id="DS660782006" load-source="docdb">PL</country><country mxw-id="DS660605147" load-source="docdb">PT</country><country mxw-id="DS660782007" load-source="docdb">RO</country><country mxw-id="DS660605148" load-source="docdb">RS</country><country mxw-id="DS660782008" load-source="docdb">SE</country><country mxw-id="DS660683243" load-source="docdb">SI</country><country mxw-id="DS660604962" load-source="docdb">SK</country><country mxw-id="DS660604971" load-source="docdb">SM</country><country mxw-id="DS660680955" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA166479543" lang="EN" load-source="patent-office"><p id="pa01" num="0001">A method and device for processing LDR images of a video sequence to improve image quality. The method comprises temporally decomposing successive HDR frames of a video sequence and the corresponding LDR frames and performing a comparison between the HDR and LDR frequency sub-bands. A current LDR image can then be modified on the basis of a comparison between the frequency sub-bands.
<img id="iaf01" file="imgaf001.tif" wi="165" he="107" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA166759355" lang="EN" source="EPO" load-source="docdb"><p>A method and device for processing LDR images of a video sequence to improve image quality. The method comprises temporally decomposing successive HDR frames of a video sequence and the corresponding LDR frames and performing a comparison between the HDR and LDR frequency sub-bands. A current LDR image can then be modified on the basis of a comparison between the frequency sub-bands.</p></abstract><description mxw-id="PDES98404244" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><u>TECHNICAL FIELD</u></heading><p id="p0001" num="0001">The present invention relates to a method and an apparatus for processing images of a video sequence. In particular the present invention relates to processing of a sequence of images in which LDR images are obtained from HDR images, for example by applying a tone mapping process.</p><heading id="h0002"><u>BACKGROUND</u></heading><p id="p0002" num="0002">The variation of light in a scene captured by an imaging device can vary greatly. For example, objects located in a shadow of the scene can appear very dark compared to an object illuminated by direct sunlight. The limited dynamic range and colour gamut provided by traditional low dynamic range (LDR) images often do not provide a sufficient range for accurate reproduction of the changes in luminance and colour within such scenes. Typically the values of components of LDR images representing the luminance or colour of pixels of the image are represented by a limited number of bits (typically 8, 10 or 12 bits). The limited range of luminance provided by such representation does not enable small signal variations to be effectively reproduced, in particular in bright and dark ranges of luminance.</p><p id="p0003" num="0003">High dynamic range imaging (also referred to as HDR or HDRI) enables a greater dynamic range of luminance between light and dark areas of a scene compared to traditional LDR images. This is achieved in HDR imaging by extending the signal representation to a wider dynamic range in order to provide high signal accuracy across the entire range. In HDR images, component values of pixels are usually represented with a greater number of bits (for example from 16 bits to 64 bits) including in floating-point format (for example 32-bit or 16-bit for each component, namely float or half-float), the most popular format being openEXR half-float format (16-bit per RGB component, i.e. 48 bits per pixel) or in integers with a long representation, typically at least 16 bits. Such ranges correspond to the<!-- EPO <DP n="2"> --> natural sensitivity of the human visual system. In this way HDR images more accurately represent the wide range of luminance found in real scenes thereby providing more realistic representations of the scene. High Dynamic Range imaging is becoming widely used in both the computer graphics and image processing communities.</p><p id="p0004" num="0004">Some display devices, however have a limited dynamic range that is inadequate for reproducing the full range of light intensities provided by HDR imaging. To this end various techniques have been used to render HDR image data compatible with LDR type displays. Tone mapping, for instance, is a technique used to map one set of colors to another in order to approximate the appearance of high dynamic range images in a medium that has a more limited dynamic range. Tone Mapping Operators (TMOs) enables the wide range of values available in a HDR image to be reproduced on a LDR display (Low Dynamic Range).</p><p id="p0005" num="0005">There are two main types of TMOs: global and local operators.</p><p id="p0006" num="0006">Global operators use characteristics of a HDR frame, to compute a monotonously increasing tone mapping curve for the whole image. As a consequence, these operators ensure the spatial brightness coherency. However, they usually fail to reproduce finer details contained in the HDR frame. Local operators tone map each pixel based on its spatial neighborhood. These techniques increase local spatial contrast, thereby providing more detailed frames.</p><p id="p0007" num="0007">Applying a TMO separately to each frame of an input video sequence usually results in temporal incoherency. There are two main types of temporal incoherency: flickering artifacts and temporal brightness incoherency.</p><p id="p0008" num="0008">Flickering artifacts are due to the TMO and are caused by rapid changes of the tone mapping in successive frames. As a consequence, similar HDR luminance values are mapped to different LDR values. Such flickering artifacts due to the TMO are undesirable and should be reduced.</p><p id="p0009" num="0009">Temporal brightness incoherency includes short-term and long-term temporal brightness incoherency. Short-term temporal brightness<!-- EPO <DP n="3"> --> incoherency appears when rapid changes of illumination condition (global or local) occur in a HDR scene. Applying a TMO without taking into account temporally close frames results in different HDR values being mapped to similar LDR values. Consequently, the tone mapping loses information on the scene that should have been preserved.</p><p id="p0010" num="0010">Finally long-term temporal brightness incoherency occurs when the brightness of the relative HDR frames are not preserved during the course of the tone mapping process. Consequently, frames perceived as the brightest in the HDR sequence are not necessarily the brightest in the LDR sequence. Unlike flickering artifacts and short-term temporal brightness incoherency, long-term temporal brightness incoherency does not necessarily appear through successive frames.</p><p id="p0011" num="0011">In summary, applying a TMO, global or local, to each frame separately of an HDR video sequence, results in temporal incoherency.</p><p id="p0012" num="0012">In an attempt to address such issues various approaches have been proposed. For example, solutions, based on temporal filtering have been proposed (<nplcit id="ncit0001" npl-type="s"><text>Boitard R., Thoreau D., Bouatouch K., Cozot R.: Temporal Coherency in Video Tone Mapping, a Survey. In HDRi2013 - First International Conference and SME Workshop on HDR imaging (2013), no. 1, pp. 1-6</text></nplcit>). Depending on the TMO, either the computed tone mapping curve or the variable that adapts the mapping to the picture is filtered. Examples of such variables are the geometric mean of a picture (which is an indication of the overall brightness of a picture), its maximum or minimum value etc. However, these techniques only work for global TMOs, since local TMOs have a non-linear and spatially varying tone mapping curve. In addition, when short-term temporal brightness incoherency occurs, these techniques filter both illumination conditions together resulting in tone mapping in a transition state that corresponds to neither of the illumination conditions of the original HDR scene.</p><p id="p0013" num="0013">For local TMOs, preserving temporal coherency consists in preventing high variations of the tone mapping over time and space. A solution, based on the GDC operator, has been proposed by Lee et al. (<nplcit id="ncit0002" npl-type="s"><text>Lee C., Kim C.-S.:<!-- EPO <DP n="4"> --> Gradient Domain Tone Mapping of High Dynamic Range Videos. In 2007 IEEE International Conference on Image Processing (2007), no. 2, IEEE, pp. III-461-III-464</text></nplcit>.).</p><p id="p0014" num="0014">First, this technique performs a pixel-wise motion estimation for each pair of successive HDR frames and the resulting motion field is then used as a constraint of temporal coherency for the corresponding LDR frames. This constraint ensures that two pixels, associated through a motion vector, are tone mapped similarly.</p><p id="p0015" num="0015">Despite the visual improvement resulting from this technique, several shortcomings still exist. First, this solution depends on the robustness of the motion estimation. When this estimation fails (occlusion of objects), the temporal coherency constraint is applied to pixels belonging to different objects, usually resulting in ghosting artifacts. Such a motion estimation problem will be referred to as non-coherent motion vector. This issue also arises when Short-term temporal brightness incoherency occurs. In this case, the technique levels the tone mapped value to be closer to the one in the previous frame in the LDR sequence. Moreover, this technique is designed for only one local TMO, the GDC operator, and cannot be extended to other TMOs.</p><p id="p0016" num="0016">Finally, Guthier et al (<nplcit id="ncit0003" npl-type="s"><text>Guthier, B., Kopf, S., Eble, M., &amp; Effelsberg, W. (2011). Flicker reduction in tone mapped high dynamic range video. In Proc. of IS&amp;T/SPIE Electronic Imaging (EI) on Color Imaging XVI: Displaying, Processing, Hardcopy, and Applications (p. 78660C-78660C-15</text></nplcit>)) designed a technique that reduces flickering artifacts by post-processing the output of any TMO using only information from the tone mapped sequence.</p><p id="p0017" num="0017">This method compares the geometric mean (which is an indication of the overall brightness of a picture) between successive frames of a video sequence. A flickering artifact is detected if this difference is greater than a threshold. As soon as an artifact is located, it is reduced using an iterative brightness adjustment until reaching the brightness threshold.</p><p id="p0018" num="0018">This solution detects any temporal artifacts. Consequently, brightness changes in the HDR video sequence, that are greater than the brightness<!-- EPO <DP n="5"> --> threshold, are reduced during the tone mapping process resulting in short-term temporal brightness incoherency. In addition, temporal incoherencies are only considered in a global fashion and local temporal incoherencies are ignored.</p><heading id="h0003"><u>SUMMARY</u></heading><p id="p0019" num="0019">The present invention has been devised with the foregoing in mind. A general aspect of the invention comprises temporally decomposing successive frames of the HDR source and the corresponding frames of the LDR tone mapped sequence and performing a comparison between the HDR and LDR frequency sub-bands</p><p id="p0020" num="0020">According to a first aspect of the invention there is provided a method of processing images of a video sequence, comprising performing temporal frequency decomposition of two temporally successive HDR images, comprising a current HDR image and a preceding HDR image to obtain a high HDR temporal frequency sub-band and a low HDR temporal frequency sub-band; performing temporal frequency decomposition of two temporally successive LDR images, comprising a current LDR image and a preceding LDR image, obtained respectively from the two temporally successive HDR images, to obtain a high LDR frequency sub-band and a low LDR frequency sub-band; and modifying the current LDR image on the basis of a comparison between the high HDR temporal-frequency sub-band and the high LDR temporal-frequency sub-band</p><p id="p0021" num="0021">Comparison between the HDR and LDR frequency sub-bands enables detection of temporal incoherency on a pixel-wise basis. Temporal incoherency in successive frames of a tone-mapped video sequence, for example, can be reduced. Comparison of the frequency sub-bands also enables the appearance of ghosting artifacts to be reduced.</p><p id="p0022" num="0022">High temporal frequency sub-band for HDR or LDR signifies a temporal frequency sub-band of higher frequency range than the low temporal frequency sub-band. It follows that low temporal frequency sub-band<!-- EPO <DP n="6"> --> for HDR or LDR signifies a temporal frequency sub-band of lower frequency range than the high temporal frequency sub-band.</p><p id="p0023" num="0023">In an embodiment the method includes obtaining a HDR edge map based on at least one HDR threshold from the high HDR temporal-frequency sub-band and a LDR edge map based on at least one LDR threshold from the high LDR temporal- frequency sub-band and the comparison is performed on the obtained HDR and LDR edge maps. For example, to detect for differences between corresponding pixels of the edge maps.</p><p id="p0024" num="0024">In an embodiment the method includes distinguishing between the presence of a flickering artifact and the presence of a short term brightness incoherency from the edge map comparison</p><p id="p0025" num="0025">In an embodiment the at least one HDR threshold for obtaining the HDR edge map and/or the at least one LDR threshold for obtaining the LDR edge map is user defined.</p><p id="p0026" num="0026">In an embodiment the at least one HDR threshold for obtaining the HDR edge map is based on the low HDR temporal-frequency sub-band and/or the at least one LDR threshold for obtaining the LDR edge map is based on the low LDR temporal-frequency sub-band.</p><p id="p0027" num="0027">In an embodiment the threshold per pixel of the image is dependent upon the value in the respective low temporal-frequency sub-band.</p><p id="p0028" num="0028">In an embodiment performing temporal frequency decomposition comprises performing motion compensated temporal filtering on the basis of motion vectors determined from motion estimation of two temporally successive HDR frames or corresponding LDR frames.</p><p id="p0029" num="0029">Preferably the motion vectors are obtained from motion estimation of two temporally successive HDR frames. This provides more accurate motion estimation.</p><p id="p0030" num="0030">In an embodiment the method includes performing motion estimation between the two temporally successive HDR images to provide motion vectors for performing the temporal frequency decomposition of the HDR images and the temporal frequency decomposition tone mapped LDR<!-- EPO <DP n="7"> --> images. Using motion estimation enables detection of temporal incoherency artifacts throughout the spatial and temporal domain.</p><p id="p0031" num="0031">In an embodiment modifying the current LDR image comprises reducing a flickering artifact below the LDR threshold or increasing a short-term brightness coherency over the LDR threshold.</p><p id="p0032" num="0032">It will be appreciated that the invention may be applied to any process for obtaining a LDR image from a HDR image. Any dynamic range scaling process may be applied to obtain an LDR image from a corresponding HDR image. In an embodiment the current LDR image and the preceding LDR image are each obtained respectively from the current HDR image and the preceding HDR image by a tone mapping process. It will be appreciated that in such embodiments any tone mapping operator may be applied.</p><p id="p0033" num="0033">According to a second aspect of the invention there is provided a device for processing images of a video sequence, comprising a filter for performing temporal frequency decomposition of two temporally successive HDR images, comprising a current HDR image and a preceding HDR image to obtain a high frequency HDR temporal frequency sub-band and a low frequency HDR temporal frequency sub-band; and temporal frequency decomposition of two temporally successive LDR images, obtained respectively from the two temporally successive HDR images, to obtain a high frequency LDR frequency sub-band and a low frequency LDR frequency sub-band; and a comparator for performing a comparison between the high HDR temporal-frequency sub-band and the high LDR temporal-frequency sub-band; and an image corrector for modifying the current LDR image on the basis of the comparison between the high HDR temporal-frequency sub-band and the high LDR temporal-frequency sub-band.</p><p id="p0034" num="0034">In an embodiment the device is provided with an edge map generator for obtaining a HDR edge map based on at least one HDR threshold from the high HDR temporal-frequency sub-band and a LDR edge map based on at least one LDR threshold from the high LDR temporal- frequency sub-band, wherein the comparator is configured to perform the comparison on the<!-- EPO <DP n="8"> --> obtained HDR and LDR edge maps to detect for differences between corresponding pixels.</p><p id="p0035" num="0035">In an embodiment, the at least one HDR threshold for obtaining the HDR edge map and/or the at least one LDR threshold for obtaining the LDR edge map is user defined.</p><p id="p0036" num="0036">In an embodiment, the at least one HDR threshold for obtaining the HDR edge map is based on the low frequency HDR temporal-frequency sub-band and/or the at least one LDR threshold for obtaining the LDR edge map is based on the low frequency LDR temporal-frequency sub-band.</p><p id="p0037" num="0037">In an embodiment, the filter is configured to perform motion compensated temporal filtering on the basis of motion vectors determined from motion estimation of two temporally successive HDR frames or corresponding LDR frames.</p><p id="p0038" num="0038">According to a further aspect of the invention there is provided a display device comprising a device in accordance with any embodiment of the second aspect of the invention for processing images of a video sequence; and a display for displaying LDR images.</p><p id="p0039" num="0039">Embodiments of the invention help to address both flickering artifacts and short-term incoherency artifacts since it uses the HDR sub-band to detect the temporal changes (or lack of) illumination condition (global or local) in the HDR sequence to preserve them in the LDR sequence.</p><p id="p0040" num="0040">At least parts of the methods according to embodiments of the invention may be computer implemented. Accordingly, the present invention may take the form of an entirely hardware embodiment, an entirely software embodiment (including firmware, resident software, micro-code, etc.) or an embodiment combining software and hardware aspects that may all generally be referred to herein as a "circuit", "module" or "system'. Furthermore, the present invention may take the form of a computer program product embodied in any tangible medium of expression having computer usable program code embodied in the medium.</p><p id="p0041" num="0041">Since the present invention can be implemented in software, the present invention can be embodied as computer readable code for provision<!-- EPO <DP n="9"> --> to a programmable apparatus on any suitable carrier medium. A tangible carrier medium may comprise a storage medium such as a floppy disk, a CD-ROM, a hard disk drive, a magnetic tape device or a solid state memory device and the like. A transient carrier medium may include a signal such as an electrical signal, an electronic signal, an optical signal, an acoustic signal, a magnetic signal or an electromagnetic signal, e.g. a microwave or RE signal.</p><heading id="h0004"><u>BRIEF DESCRIPTION OF THE DRAWINGS</u></heading><p id="p0042" num="0042">Embodiments of the invention will now be described, by way of example only, and with reference to the following drawings in which:
<ul><li><figref idrefs="f0001">FIG. 1</figref> is a schematic block diagram of method of processing images of a video sequence according to a first embodiment of the invention;</li><li><figref idrefs="f0002">FIG. 2</figref> is a schematic diagram of a method of performing temporal sub-band decomposition of two frames using a Motion Compensation (MC) according to an embodiment of the invention;</li><li><figref idrefs="f0003">FIG. 3</figref> is a schematic diagram illustrating steps of a method for performing comparison of frequency sub-bands according to an embodiment of the invention;</li><li><figref idrefs="f0004">FIG. 4</figref> is a block diagram of a processing device in which one or more embodiments of the invention can be implemented; and</li><li><figref idrefs="f0004">FIG. 5</figref> is a block diagram of an example of an electronic device in which one or more embodiments of the invention can be implemented.</li></ul></p><heading id="h0005"><u>DETAILED DESCRIPTION</u></heading><p id="p0043" num="0043">Temporal incoherency artifacts are global or local changes (or lack of) of brightness in successive frames of a video sequence. Two types of temporal incoherency which may be addressed by embodiments of the invention as described herein are flickering artifacts (in which there is a lack of change of brightness in the HDR sequence while a change of brightness occurs in the LDR sequence) and short-term brightness incoherencies (in<!-- EPO <DP n="10"> --> which there is a change of brightness in the HDR sequence while no change of brightness occurs in the LDR sequence).</p><p id="p0044" num="0044"><figref idrefs="f0001">Figure 1</figref> is a schematic block diagram illustrating steps of a method for processing images of a video sequence in accordance with a first embodiment of the invention.</p><p id="p0045" num="0045">The method begins in step S101 with the acquisition of HDR image data. The HDR image data in the present example is representative of a video sequence of images. The HDR image data may, for example, be acquired directly from an imaging device such as a video camera, acquired from memory on which it is stored, the memory may be located locally or remotely, or received via a wireless or wired communication line.</p><p id="p0046" num="0046">As used herein the term "HDR image" or "HDR frame" refers to any HDR image or frame that comprises high dynamic range data in floating point (float or half float), fixed point or long representation integer format typically represented in by a number of bits greater than 16.</p><p id="p0047" num="0047">In the illustrated example of <figref idrefs="f0001">Figure 1</figref>, two temporally successive HDR frames F<sup>HDR</sup><sub>t-1</sub> and F<sup>HDR</sup><sub>t</sub> are acquired from a HDR video sequence for processing: a current HDR frame F<sup>HDR</sup><sub>t</sub> (at time t) and its temporally preceding HDR frame F<sup>HDR</sup><sub>t-1</sub> (at time t-1).</p><p id="p0048" num="0048">In step S102 the two temporally successive HDR frames F<sup>HDR</sup><sub>t-1</sub> and F<sup>HDR</sup><sub>t</sub> are tone mapped by a tone mapping process using any TMO to obtain two corresponding tone mapped LDR images, F<sup>LDR</sup><sub>t-1</sub> and F<sup>LDR</sup><sub>t:</sub> a current LDR frame F<sup>LDR</sup><sub>t</sub> (at time t) and its temporally preceding LDR frame F<sup>LDR</sup><sub>t-1</sub> (at time t-1). The preceding tone mapped frame (F<sup>LDR</sup><sub>t-1</sub>) may have already undergone temporal incoherency reduction, as a current LDR frame in a previous iteration of the process according to embodiments of the invention, in which case it is denoted (F<sup>LDR*</sup><sub>t-1</sub> in <figref idrefs="f0001">Fig.1</figref>).</p><p id="p0049" num="0049">Motion estimation is performed between the preceding HDR frame F<sup>HDR</sup><sub>t-1</sub> and the current HDR frame F<sup>HDR</sup><sub>t</sub> of the HDR video sequence. The Motion vectors (Mv) obtained from the motion estimation are used to perform Motion Compensated Temporal Filtering (MCTF) in step S103 on the two successive HDR frames F<sup>HDR</sup><sub>t-1</sub> and F<sup>HDR</sup><sub>t</sub> of the HDR video sequence. This<!-- EPO <DP n="11"> --> process involves decomposing the two successive HDR frames F<sup>HDR</sup><sub>t-1</sub> and F<sup>HDR</sup><sub>t</sub> into two temporal frequency sub-bands: a higher frequency sub-band, noted generally as a high frequency sub-band (H<sup>HDR</sup>) and a lower frequency sub-band, noted generally as a low frequency sub-band (L<sup>HDR</sup>).</p><p id="p0050" num="0050">Similarly, MCTF is performed in step S104 on the preceding and current frames F<sup>LDR*</sup><sub>t-1</sub> and F<sup>LDR</sup><sub>t</sub> of the tone mapped LDR video sequence corresponding to the two successive HDR frames F<sup>HDR</sup><sub>t-1</sub> and F<sup>HDR</sup><sub>t</sub>. The MCTF applied to the preceding and current frames F<sup>LDR*</sup><sub>t-1</sub> and F<sup>LDR</sup><sub>t</sub> of the tone mapped LDR video sequence uses the same Motion vectors as those applied in the MCTF of the corresponding two successive HDR frames F<sup>HDR</sup><sub>t1</sub> and F<sup>HDR</sup><sub>t</sub> of the HDR video sequence. Consequently two temporal frequency sub-bands are obtained for the LDR frames: a higher (high) frequency sub-band (H<sup>LDR</sup>) and a lower (low) frequency sub-band (L<sup>LDR</sup>).</p><p id="p0051" num="0051">While it is preferable, for better accuracy, to obtain the motion vectors from motion estimation performed on two successive HDR frames, in some embodiments of the invention the motion vectors may be obtained from motion estimation performed on two successive LDR frames.</p><p id="p0052" num="0052">The high frequency temporal-frequency sub-bands obtained from both the LDR sequence and the HDR sequence (H<sup>LDR</sup> and H<sup>HDR</sup>) are used in step S105 to detect temporal incoherency artifacts. Using this detection, the current LDR frame of the video sequence F<sup>LDR</sup><sub>t</sub> is modified to reduce those artifacts. A processed current tone mapped frame F<sup>LDR*</sup><sub>t</sub> is obtained. It may be noted that further processing of the low frequency temporal frequency sub-bands resulting from the sub-band decomposition is not mandatory.</p><p id="p0053" num="0053">A process of temporal frequency decomposition as applied in steps S103 and S104, according to an embodiment of the invention will be described with reference to <figref idrefs="f0002">Figure 2</figref>.</p><p id="p0054" num="0054">In the example of <figref idrefs="f0002">Figure 2</figref>, the process of temporal-frequency decomposition of HDR frames F<sup>HDR</sup><sub>t-1</sub> and F<sup>HDR</sup><sub>t</sub> or corresponding tone mapped LDR frames F<sup>LDR</sup><sub>t-1</sub> and F<sup>LDR</sup><sub>t</sub>, generally referenced, in <figref idrefs="f0002">Figure 2</figref> as F<sub>t1</sub> and Ft, comprises applying orthonormal transforms using a backward motion vector, <i>v<sub>b</sub></i> and a forward motion vector <i>v<sub>f</sub></i>, obtained from Motion<!-- EPO <DP n="12"> --> estimation between the preceding HDR frame F<sup>HDR</sup><sub>t-1</sub> and the current HDR frame F<sup>HDR</sup><sub>t,</sub> to obtain respectively in steps S201 and S202 the high temporal-frequency subband H and low temporal-frequency subband L: <maths id="math0001" num="(step s201)"><math display="block"><mi>H</mi><mfenced><mi>n</mi></mfenced><mo>=</mo><mfrac><mrow><msub><mi>F</mi><mi>t</mi></msub><mfenced><mi>n</mi></mfenced><mo>-</mo><msub><mi>F</mi><mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>+</mo><msub><mi>v</mi><mi>b</mi></msub></mfenced></mrow><msqrt><mn>2</mn></msqrt></mfrac></math><img id="ib0001" file="imgb0001.tif" wi="89" he="11" img-content="math" img-format="tif"/></maths> <maths id="math0002" num="(step s202)"><math display="block"><mi>L</mi><mfenced><mi>p</mi></mfenced><mo>=</mo><msqrt><mn>2</mn></msqrt><mo>×</mo><msub><mi>F</mi><mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow></msub><mfenced><mi>p</mi></mfenced><mo>-</mo><mi>H</mi><mo>⁢</mo><mfenced separators=""><mi>p</mi><mo>+</mo><msub><mi>v</mi><mi>f</mi></msub></mfenced></math><img id="ib0002" file="imgb0002.tif" wi="101" he="9" img-content="math" img-format="tif"/></maths><br/>
where <i>H</i> and <i>L</i> are respectively the high and low temporal-frequency sub-bands obtained at the LDR level or the HDR level, <i>v<sub>b</sub></i> and <i>v<sub>f</sub></i> are respectively the backward and forward motion vectors obtained from motion estimation between the temporally successive HDR frames while n is the pixel position in frame F<sub>t</sub> and p corresponds to <i>n</i> + <i>v<sub>b</sub></i>.</p><p id="p0055" num="0055">An example of an embodiment in accordance with the invention for implementation of the Artifacts Detection and Reduction function of step S105 of <figref idrefs="f0001">FIG.1</figref> will be described with reference to <figref idrefs="f0003">FIG.3</figref>. The high temporal-frequency sub-band at the LDR level H<sup>LDR</sup> and the high temporal-frequency sub-band at the HDR level H<sup>HDR</sup> each uses a respective threshold in steps S311 and S321, respectively, to create a respective edge map E<sup>HDR</sup> and E<sup>LDR</sup> <maths id="math0003" num="(a)"><math display="block"><msup><mi>E</mi><mi mathvariant="italic">HDR</mi></msup><mfenced><mi>n</mi></mfenced><mo>=</mo><mrow><mo>{</mo><mtable><mtr><mtd><mn>1</mn><mspace width="1em"/><mi mathvariant="italic">if</mi><mspace width="1em"/><msup><mi>H</mi><mi mathvariant="italic">HDR</mi></msup><mfenced><mi>n</mi></mfenced><mo>&gt;</mo><mi mathvariant="italic">HDR Threshold</mi></mtd></mtr><mtr><mtd><mn>0</mn><mspace width="1em"/><mi mathvariant="italic">if</mi><mspace width="1em"/><msup><mi>H</mi><mi mathvariant="italic">HDR</mi></msup><mfenced><mi>n</mi></mfenced><mo>≤</mo><mi mathvariant="italic">HDR Threshold</mi></mtd></mtr></mtable></mrow></math><img id="ib0003" file="imgb0003.tif" wi="96" he="13" img-content="math" img-format="tif"/></maths> <maths id="math0004" num="(b)"><math display="block"><msup><mi>E</mi><mi mathvariant="italic">LDR</mi></msup><mfenced><mi>n</mi></mfenced><mo>=</mo><mrow><mo>{</mo><mtable><mtr><mtd><mn>1</mn><mspace width="1em"/><mi mathvariant="italic">if</mi><mspace width="1em"/><msup><mi>H</mi><mi mathvariant="italic">LDR</mi></msup><mfenced><mi>n</mi></mfenced><mo>&gt;</mo><mi mathvariant="italic">LDR Threshold</mi></mtd></mtr><mtr><mtd><mn>0</mn><mspace width="1em"/><mi mathvariant="italic">if</mi><mspace width="1em"/><msup><mi>H</mi><mi mathvariant="italic">LDR</mi></msup><mfenced><mi>n</mi></mfenced><mo>≤</mo><mi mathvariant="italic">LDR Threshold</mi></mtd></mtr></mtable></mrow></math><img id="ib0004" file="imgb0004.tif" wi="94" he="13" img-content="math" img-format="tif"/></maths></p><p id="p0056" num="0056">The two edge maps are then compared with one another in step S330 to detect for edge differences and if a difference is detected, then it is considered that a temporal incoherency artifact is present. Several cases may be distinguished as summarized in the example of Table 1:
<tables id="tabl0001" num="0001"><table frame="all"><title><i>Table1. Detection of temporal incoherency</i></title><tgroup cols="3"><colspec colnum="1" colname="col1" colwidth="21mm"/><colspec colnum="2" colname="col2" colwidth="16mm"/><colspec colnum="3" colname="col3" colwidth="129mm"/><thead><row><entry valign="top">E<i><sup>HDR</sup></i>(<i>n</i>)</entry><entry valign="top"><i>E<sup>LDR</sup></i> (<i>n</i>)</entry><entry align="center" valign="top">Problem?</entry></row></thead><tbody><row><entry>0</entry><entry>0</entry><entry>No issue</entry></row><row><entry>0</entry><entry>1</entry><entry>A difference that was not present in the HDR sequence was created during the tone mapping process. Flickering Artifact!</entry></row><!-- EPO <DP n="13"> --><row><entry>1</entry><entry>0</entry><entry>A difference that was present in the HDR sequence has been suppressed during the tone mapping process. Short-term Brightness incoherency!</entry></row><row><entry>1</entry><entry>1</entry><entry>No issue</entry></row></tbody></tgroup></table></tables></p><p id="p0057" num="0057">To correct for any difference occurring in the edge maps, the current tone mapped frame (F<sup>LDR</sup><sub>t</sub>) is corrected in step S340 at each required pixel location (x,y) so as to reduce a flickering artifact below the threshold or a short-term brightness incoherency over the threshold.</p><p id="p0058" num="0058">While table 1 presents an example of binary edge maps in which the obtained values for <i>E<sup>HDR</sup></i>(<i>n</i>) and <i>E<sup>LDR</sup></i>(<i>n</i>) are either 1 or 0, it will be appreciated that in other embodiments of the invention, a plurality of thresholds may be applied to the HDR and LDR high temporal-frequency sub-bands to obtain the corresponding edge maps. In the case where a plurality of different thresholds are used to obtain each edge map, respective HDR and LDR edge maps indicating the strength of the edges are obtained. If the strength is different between the HDR and LDR high frequency subband, then the current LDR image is modified on the basis of the difference in strength differences.</p><p id="p0059" num="0059">The HDR Threshold and LDR threshold may be computed in several ways.</p><p id="p0060" num="0060">For example, in one embodiment the thresholds are user-defined.</p><p id="p0061" num="0061">In another embodiment, the thresholds are derived respectively from the two low frequency sub-bands (L<sup>HDR</sup> and L<sup>LDR</sup>). In such a case, there is a threshold per pixel depending on the value in the low frequency sub-band.</p><p id="p0062" num="0062">Application of a correct edge difference function in accordance with an embodiment of the invention will now be described. In the example of Table 1, there are two cases that should be addressed. First, no temporal edges<!-- EPO <DP n="14"> --> exist between the two temporally successive HDR frames while there was an edge in the corresponding temporally successive LDR frames. This corresponds to a flickering artifact introduced by the application of the TMO. In the example this artifact is referred to as case "FA". Second, a temporal edge exists between the two temporally successive HDR frames while none existed in the temporally successive LDR frames. This is a short-term temporal brightness incoherency. In the example this artifact is referred to as case " "BI".</p><p id="p0063" num="0063">According to an embodiment, artifacts are reduced in such a way that both HDR and LDR edge maps E<sup>HDR</sup> and E<sup>LDR</sup> have the same value. For example, to respect the following expression: <maths id="math0005" num=""><math display="block"><msup><mi>H</mi><mi mathvariant="italic">LDR</mi></msup><mfenced><mi>n</mi></mfenced><mo>=</mo><mfrac><mrow><msubsup><mi>F</mi><mi>t</mi><mrow><mi mathvariant="italic">LDR</mi><mo>*</mo></mrow></msubsup><mfenced><mi>n</mi></mfenced><mo>-</mo><msubsup><mi>F</mi><mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow><mi mathvariant="italic">LDR</mi></msubsup><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>+</mo><msub><mi>v</mi><mi>b</mi></msub></mfenced></mrow><msqrt><mn>2</mn></msqrt></mfrac><mo>=</mo><mi mathvariant="italic">LDR Threshold</mi></math><img id="ib0005" file="imgb0005.tif" wi="103" he="14" img-content="math" img-format="tif"/></maths><br/>
where <maths id="math0006" num=""><math display="inline"><msubsup><mi mathvariant="italic">F</mi><mi mathvariant="italic">t</mi><mrow><mi mathvariant="italic">LDR</mi><mo>*</mo></mrow></msubsup></math><img id="ib0006" file="imgb0006.tif" wi="12" he="8" img-content="math" img-format="tif" inline="yes"/></maths> is the post-processed current LDR frame in which artifacts have been reduced and is computed as follows: <maths id="math0007" num=""><math display="block"><msubsup><mi>F</mi><mi>t</mi><mrow><mi mathvariant="italic">LDR</mi><mo>*</mo></mrow></msubsup><mfenced separators=""><mi>f</mi><mo>⁢</mo><mi>a</mi></mfenced><mo>=</mo><mi mathvariant="italic">LDR Threshold</mi><mo>*</mo><msqrt><mn>2</mn></msqrt><mo>+</mo><msubsup><mi>F</mi><mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow><mi mathvariant="italic">LDR</mi></msubsup><mo>⁢</mo><mfenced separators=""><mi>f</mi><mo>⁢</mo><mi>a</mi><mo>+</mo><mi>f</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><msub><mi>v</mi><mi>b</mi></msub></mfenced></math><img id="ib0007" file="imgb0007.tif" wi="101" he="8" img-content="math" img-format="tif"/></maths> <maths id="math0008" num=""><math display="block"><msubsup><mi>F</mi><mi>t</mi><mrow><mi mathvariant="italic">LDR</mi><mo>*</mo></mrow></msubsup><mfenced><mi mathvariant="italic">bi</mi></mfenced><mo>=</mo><mi mathvariant="italic">LDR Threshold</mi><mo>*</mo><msqrt><mn>2</mn></msqrt><mo>+</mo><msubsup><mi>F</mi><mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow><mi mathvariant="italic">LDR</mi></msubsup><mrow><mi mathvariant="italic">bi</mi><mo>+</mo><mi mathvariant="italic">bi</mi><mo>⁢</mo><msub><mi>v</mi><mi>b</mi></msub><mo>)</mo></mrow><mo>+</mo><mi mathvariant="italic">delta</mi></math><img id="ib0008" file="imgb0008.tif" wi="113" he="8" img-content="math" img-format="tif"/></maths><br/>
Where "fa", and "bi", represent the pixels where flickering artifacts "FA" and temporal brightness incoherency artifacts "BI", respectively have been detected. <i>fav<sub>b</sub>,</i> and <i>biv<sub>b</sub>,</i> correspond to the motion vectors associated with the pixels "fa" and "bi" respectively. Finally "delta" is a quantization step applied to put the resulting value above the threshold so as to respect the inequalities in equations (A) and (B).</p><p id="p0064" num="0064">In <figref idrefs="f0001 f0002 f0003">Figures 1 to 3</figref>, the illustrated modules correspond to functional units, which may or may not correspond to distinguishable physical units. For example, a plurality of such modules may be associated in a unique component or circuit, or correspond to a software module. Moreover, a<!-- EPO <DP n="15"> --> module may potentially be composed of separate physical entities or software functionalities.</p><p id="p0065" num="0065">Devices compatible with embodiments of the invention may be implemented either solely by hardware, solely by software or by a combination of hardware and software. In terms of hardware for example dedicated hardware, may be used, such as, for example ASIC « Application Specific Integrated Circuit », FPGA « Field-Programmable Gate Array »or VLSI, « Very Large Scale Integration »; or by using several integrated electronic components embedded in a device or from a combination of hardware and software components.</p><p id="p0066" num="0066"><figref idrefs="f0004">Figure 4</figref> is a schematic block diagram representing functional components of an electronic device 400 in which one or more embodiments of the invention may be implemented.</p><p id="p0067" num="0067">The electronic device 400 includes memory 410, one or more processing units (CPUs) 420, an input/output interface 430 for transfer of data from and to an application and an interface port 470 for connection to an external device or network. The components communicate over one or more communication buses 450.</p><p id="p0068" num="0068">Memory may include high speed random access memory (RAM) 411 and read only memory (ROM) 412. A register of memory may correspond to portion of low capacity (some bits) or to a high capacity portion (for example entire computer program code or large amounts of compressed or uncompressed data) of any of the memories of the device. ROM 412 stores at least program code and parameters. Algorithms of the methods for processing a sequence of images according to embodiments of the invention may be stored in ROM 412.</p><p id="p0069" num="0069">The one or more CPUs 420 run various software programs and/or sets of instructions stored in memory 410 to perform functions of the processing device 400 and to process data. RAM 411 comprises, in a register, a program executed by the CPU 420 and uploaded after switch on of the device 400, input data in a register, intermediate data at different states of the algorithm in a register, and other variables used for the execution of the<!-- EPO <DP n="16"> --> algorithm in a register. When switched on, the CPU 420 uploads a software program from the RAM 411 and executes the corresponding instructions.</p><p id="p0070" num="0070">Images to be processed in accordance with embodiments of the invention may be stored in the memory 410. Processed images obtained from the methods in accordance with embodiments of the invention may be stored in the memory 410.</p><p id="p0071" num="0071">Memory 410 may include non-volatile memory, such as one or more magnetic disk storage devices, flash memory devices or other non-volatile solid state memory devices. In some embodiments, the memory may further include storage remotely located from the one or more CPUs 420. For example storage accessible via an interface and/or a communication network.</p><p id="p0072" num="0072">In some embodiments the device is provided with a power source such as a battery 440. According to alternative embodiments, the power source may be external to the device.</p><p id="p0073" num="0073">The device may be provided with a display 460, for example a LDR compatible display for display of the processed LDR images obtained from methods according to embodiments of the invention. In other embodiments the display is located remotely to the device 400 and processed images are transferred to the display, for example by the port 470 via a wired or wireless data communication interface or via a wired or wireless network connection. The HDR images may be received by the port 470 via a wired or wireless communication interface or via a wired or wireless network connection.</p><p id="p0074" num="0074"><figref idrefs="f0004">Figure 5</figref> is a schematic block diagram illustrating components of an electronic system in which embodiments of the invention may be implemented. The electronic system comprises an image acquisition module 510 for acquiring HDR images, an image processor 520 for processing the HDR images in accordance with one or more embodiments of the invention and a display device compatible with the display of LDR images. The HDR acquisition device 510 may be for example a video recorder configured to acquire images in a HDR format, or a medium on which HDR images are stored.<!-- EPO <DP n="17"> --></p><p id="p0075" num="0075">The image processor 520 comprises a filter 521 for performing temporal frequency decomposition of two temporally successive HDR images F<sup>HDR</sup><sub>t-1</sub> and F<sup>HDR</sup><sub>t</sub>, comprising a current HDR image F<sup>HDR</sup><sub>t-1</sub> and F<sup>HDR</sup><sub>t</sub> and a preceding HDR image F<sup>HDR</sup><sub>t-1</sub> to obtain a high HDR temporal frequency sub-band H<sup>HDR</sup> and a low HDR temporal frequency sub-band L<sup>HDR</sup>; and temporal frequency decomposition of two temporally successive LDR images F<sup>LDR</sup><sub>t-1</sub> and F<sup>LDR</sup><sub>t</sub>, obtained respectively from the two temporally successive HDR images, to obtain a high LDR temporal-frequency sub-band H<sup>LDR</sup> and a low LDR temporal-frequency sub-band L<sup>LDR</sup>; a comparator 522 for performing a comparison between the high HDR temporal-frequency sub-band and the high LDR temporal-frequency sub-band H<sup>HDR</sup> and H<sup>LDR</sup>; and an image corrector 523 for modifying the current LDR image F<sup>LDR</sup><sub>t</sub> on the basis of the comparison between the high HDR temporal-frequency sub-band H<sup>HDR</sup> and the high LDR temporal-frequency sub-band H<sup>LDR</sup>. The processed images are then transferred to LDR display device 530 for display.</p><p id="p0076" num="0076">Embodiments of the invention enable detection of flickering artifacts and short-term brightness incoherencies and reduction of such effects. Moreover, embodiments of the invention can be used to distinguish flickering artifacts from short-term brightness coherency. The invention is generic to any tone mapping or other HDR-LDR scaling technique. In the case of tone mapping embodiments of the invention help to detect ghosting artifacts that have been introduced by the tone mapping operator used in the tone mapping process.</p><p id="p0077" num="0077">Although the present invention has been described hereinabove with reference to specific embodiments, it will be appreciated that the present invention is not limited to the specific embodiments, and modifications will be apparent to a skilled person in the art which lie within the scope of the present invention.</p><p id="p0078" num="0078">For instance, it will be appreciated that while embodiments of the invention have been described with respect to tone mapping techniques for transforming a HDR image into a LDR image, it will be appreciated that the<!-- EPO <DP n="18"> --> invention is not limited to tone mapping techniques and may be applied to any technique for converting a HDR image to a LDR compatible image.</p><p id="p0079" num="0079">Many further modifications and variations will suggest themselves to those versed in the art upon making reference to the foregoing illustrative embodiments, which are given by way of example only and which are not intended to limit the scope of the invention, that being determined solely by the appended claims. In particular the different features from different embodiments may be interchanged, where appropriate.</p></description><claims mxw-id="PCLM90459174" lang="EN" load-source="patent-office"><!-- EPO <DP n="19"> --><claim id="c-en-0001" num="0001"><claim-text>A method of processing images of a video sequence, comprising<br/>
performing temporal frequency decomposition (S103) of two temporally successive HDR images, comprising a current HDR image and a preceding HDR image to obtain a high HDR temporal frequency sub-band and a low HDR temporal frequency sub-band;<br/>
performing temporal frequency decomposition (S104) of two temporally successive LDR images, obtained respectively from the two temporally successive HDR images, to obtain a high LDR temporal-frequency sub-band and a low LDR temporal- frequency sub-band; and<br/>
modifying the current LDR image (S105) on the basis of a comparison between the high HDR temporal-frequency sub-band and the high LDR temporal-frequency sub-band</claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>A method according to claim 1 comprising obtaining a HDR edge map (S311), based on at least one HDR threshold, from the high HDR temporal-frequency sub-band, and a LDR edge map (S321), based on at least one LDR threshold, from the high LDR temporal-frequency sub-band, wherein the comparison is performed on the obtained HDR and LDR edge maps (S330) to detect for differences between corresponding pixels.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>A method according to claim 2 comprising distinguishing between the presence of a flickering artifact and the presence of a short term brightness incoherency from the edge map comparison<!-- EPO <DP n="20"> --></claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>A method according to claim 2 or 3 wherein the at least one HDR threshold for obtaining the HDR edge map and/or the at least one LDR threshold for obtaining the LDR edge map is user defined.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>A method according to claim 2 or 3 wherein the at least one HDR threshold for obtaining the HDR edge map is based on the low HDR temporal-frequency sub-band and/or the at least one LDR threshold for obtaining the LDR edge map is based on the low LDR temporal-frequency sub-band.</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>A method according to claim 5 wherein the threshold per pixel of the image is dependent upon the value in the respective low temporal-frequency sub-band.</claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>A method according to any preceding claim wherein performing temporal frequency decomposition comprises performing motion compensated temporal filtering on the basis of motion vectors determined from motion estimation of two temporally successive HDR frames or two temporally successive corresponding LDR frames</claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>A method according to any one of claims 2 to 7 wherein modifying the current LDR image comprises reducing a flickering artifact below the LDR threshold or increasing a short-term brightness coherency over the LDR threshold.</claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>A method according to any preceding claim wherein the current LDR image and the preceding LDR image are obtained respectively from the current HDR image and the preceding HDR image by a tone mapping process.</claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>A device for processing images of a video sequence, comprising<br/>
<!-- EPO <DP n="21"> -->a filter (521) for performing temporal frequency decomposition of two temporally successive HDR images, comprising a current HDR image and a preceding HDR image to obtain a high HDR temporal frequency sub-band and a low HDR temporal frequency sub-band; and temporal frequency decomposition of two temporally successive LDR images, obtained respectively from the two temporally successive HDR images, to obtain a high LDR temporal-frequency sub-band and a low LDR temporal-frequency sub-band; and<br/>
a comparator (522) for performing a comparison between the high HDR temporal-frequency sub-band and the high LDR temporal-frequency sub-band; and<br/>
an image corrector (523) for modifying the current LDR image on the basis of the comparison between the high HDR temporal-frequency sub-band and the high LDR temporal-frequency sub-band.</claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>A device according to claim 10, comprising an edge map generator for obtaining a HDR edge map, based on at least one HDR threshold, from the high HDR temporal-frequency sub-band, and a LDR edge map, based on at least one LDR threshold, from the high LDR temporal-frequency sub-band, wherein the comparator is configured to perform the comparison on the obtained HDR and LDR edge maps to detect for differences between corresponding pixels.</claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>A device according to claim 11 wherein at least one HDR threshold for obtaining the HDR edge map and/or at least one LDR threshold for obtaining the LDR edge map is user defined.</claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>A method according to claim 11 or 12 wherein at least one HDR threshold for obtaining the HDR edge map is based on the low HDR temporal-frequency sub-band and/or at least one LDR threshold for obtaining the LDR edge map is based on the low LDR temporal-frequency sub-band.<!-- EPO <DP n="22"> --></claim-text></claim><claim id="c-en-0014" num="0014"><claim-text>A device according to any one of claims 10 to 13 wherein the filter (521) is configured to perform motion compensated temporal filtering on the basis of motion vectors determined from motion estimation of two temporally successive HDR frames or of two temporally successive corresponding LDR frames.</claim-text></claim><claim id="c-en-0015" num="0015"><claim-text>A display device comprising:
<claim-text>a device (520) in accordance with any one of claims 10 to 14 for processing images of a video sequence; and</claim-text>
<claim-text>a display (530) for displaying LDR images.</claim-text></claim-text></claim><claim id="c-en-0016" num="0016"><claim-text>A computer program product for a programmable apparatus, the computer program product comprising a sequence of instructions for implementing a method according to any one of claims 1 to 9 when loaded into and executed by the programmable apparatus.</claim-text></claim></claims><drawings mxw-id="PDW20421910" load-source="patent-office"><!-- EPO <DP n="23"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="129" he="216" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="24"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="158" he="141" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="25"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="158" he="164" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="26"> --><figure id="f0004" num="4,5"><img id="if0004" file="imgf0004.tif" wi="158" he="178" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="159" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="159" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
