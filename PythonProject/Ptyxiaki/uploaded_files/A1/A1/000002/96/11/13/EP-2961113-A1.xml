<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2961113-A1" country="EP" doc-number="2961113" kind="A1" date="20151230" family-id="51176299" file-reference-id="313851" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160451229" ucid="EP-2961113-A1"><document-id><country>EP</country><doc-number>2961113</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-14305985-A" is-representative="YES"><document-id mxw-id="PAPP193865426" load-source="patent-office" format="original"><country>EP</country><doc-number>14305985.5</doc-number><date>20140624</date><lang>EN</lang></document-id><document-id mxw-id="PAPP193865427" load-source="docdb" format="epo"><country>EP</country><doc-number>14305985</doc-number><kind>A</kind><date>20140624</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162029055" ucid="EP-14305985-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>14305985</doc-number><kind>A</kind><date>20140624</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1988519835" load-source="docdb">H04L  12/703       20130101ALI20140911BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988520983" load-source="docdb">H04L  12/437       20060101ALI20140911BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988522134" load-source="docdb">H04L  12/707       20130101AFI20140911BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988524164" load-source="docdb">H04L  12/723       20130101ALI20140911BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988524785" load-source="docdb">H04L  12/24        20060101ALI20140911BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1804352726" load-source="docdb" scheme="CPC">H04L  45/50        20130101 LI20170607BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1804352940" load-source="docdb" scheme="CPC">H04L  45/22        20130101 LI20170607BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1804353838" load-source="docdb" scheme="CPC">H04L  12/437       20130101 LI20170607BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1804357057" load-source="docdb" scheme="CPC">H04L  45/28        20130101 FI20170607BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1804357091" load-source="docdb" scheme="CPC">H04L  41/0654      20130101 LI20170601BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165545153" lang="DE" load-source="patent-office">Steuerung der Schutzschaltung in einem Kommunikationsnetzwerk</invention-title><invention-title mxw-id="PT165545154" lang="EN" load-source="patent-office">Control of protection switching in a communication network</invention-title><invention-title mxw-id="PT165545155" lang="FR" load-source="patent-office">Commande de commutation de protection dans un r√©seau de communication</invention-title><citations><non-patent-citations><nplcit><text>"G.8132 draft MPLS-TP shared protection ring protection", ITU-T DRAFT RECOMMENDATION, May 2009 (2009-05-01)</text><sources><source mxw-id="PNPL62638752" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>BUSI I ET AL: "Operations, Administration, and Maintenance Framework for MPLS-Based Transport Networks; rfc6371.txt", OPERATIONS, ADMINISTRATION, AND MAINTENANCE FRAMEWORK FOR MPLS-BASED TRANSPORT NETWORKS; RFC6371.TXT, INTERNET ENGINEERING TASK FORCE, IETF; STANDARD, INTERNET SOCIETY (ISOC) 4, RUE DES FALAISES CH- 1205 GENEVA, SWITZERLAND, 21 September 2011 (2011-09-21), pages 1 - 62, XP015081297</text><sources><source mxw-id="PNPL62638753" load-source="docdb" name="SEA" category="A"/></sources></nplcit><nplcit><text>IETF INTERNET-DRAFT ''MPLS-TP RING PROTECTION SWITCHING (MRPS, 18 April 2014 (2014-04-18)</text><sources><source mxw-id="PNPL62638754" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>JEONG-DONG RYOO ETRI REP OF KOREA: "Latest draft of G.8132 MPLS-TP shared protection ring;WD 03", ITU-T DRAFT ; STUDY PERIOD 2009-2012, INTERNATIONAL TELECOMMUNICATION UNION, GENEVA ; CH, vol. 9/9, 6 September 2012 (2012-09-06), pages 1 - 19, XP017576731</text><sources><source mxw-id="PNPL62638755" load-source="docdb" name="SEA" category="A"/></sources></nplcit><nplcit><text>VAN HELVOORT H ET AL: "MPLS-TP Ring Protection Switching (MRPS); draft-helvoort-mpls-tp-ring-protection-switching-06.txt", MPLS-TP RING PROTECTION SWITCHING (MRPS); DRAFT-HELVOORT-MPLS-TP-RING-PROTECTION-SWITCHING-06.TXT, INTERNET ENGINEERING TASK FORCE, IETF; STANDARDWORKINGDRAFT, INTERNET SOCIETY (ISOC) 4, RUE DES FALAISES CH- 1205 GENEVA, SWITZERLAND, 18 April 2014 (2014-04-18), pages 1 - 41, XP015098740</text><sources><source mxw-id="PNPL62638756" load-source="docdb" name="SEA" category="A"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR1103303476" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ALCATEL LUCENT</last-name><address><country>FR</country></address></addressbook></applicant><applicant mxw-id="PPAR1103311615" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>ALCATEL LUCENT</last-name></addressbook></applicant><applicant mxw-id="PPAR1101640356" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Alcatel Lucent</last-name><iid>101464136</iid><address><street>148/152 Route de la Reine</street><city>92100 Boulogne-Billancourt</city><country>FR</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103319168" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ADDEO CHRISTIAN</last-name><address><country>IT</country></address></addressbook></inventor><inventor mxw-id="PPAR1103305386" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>ADDEO, CHRISTIAN</last-name></addressbook></inventor><inventor mxw-id="PPAR1101642788" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>ADDEO, CHRISTIAN</last-name><address><street>ALCATEL-LUCENT ITALIA S.p.A. Via Trento, 30</street><city>20059 Vimercate</city><country>IT</country></address></addressbook></inventor><inventor mxw-id="PPAR1103321421" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>BERSANI LAURA</last-name><address><country>IT</country></address></addressbook></inventor><inventor mxw-id="PPAR1103323388" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>BERSANI, LAURA</last-name></addressbook></inventor><inventor mxw-id="PPAR1101645189" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>BERSANI, LAURA</last-name><address><street>ALCATEL-LUCENT ITALIA S.p.A. Via Trento, 30</street><city>20059 Vimercate</city><country>IT</country></address></addressbook></inventor><inventor mxw-id="PPAR1103315085" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>ROSSI ALESSANDRA</last-name><address><country>IT</country></address></addressbook></inventor><inventor mxw-id="PPAR1103324448" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>ROSSI, ALESSANDRA</last-name></addressbook></inventor><inventor mxw-id="PPAR1101645402" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>ROSSI, ALESSANDRA</last-name><address><street>ALCATEL-LUCENT ITALIA S.p.A. Via Trento, 30</street><city>20059 Vimercate</city><country>IT</country></address></addressbook></inventor><inventor mxw-id="PPAR1103317583" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>LIU DALIN</last-name><address><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR1103305120" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>LIU, DALIN</last-name></addressbook></inventor><inventor mxw-id="PPAR1101644805" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>LIU, DALIN</last-name><address><street>ALCATEL-LUCENT SHANGHAI BELL Building 6, 388 Nr, Ningqiao Road Jinqiao PuDong</street><city>201206 Shanghai</city><country>CN</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR1101646112" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Colombo, Stefano Paolo</last-name><suffix>et al</suffix><iid>101014935</iid><address><street>Marchi &amp; Partners S.r.l. Via Vittor Pisani, 13</street><city>20124 Milano</city><country>IT</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS660782280" load-source="docdb">AL</country><country mxw-id="DS660606879" load-source="docdb">AT</country><country mxw-id="DS660782282" load-source="docdb">BE</country><country mxw-id="DS660682243" load-source="docdb">BG</country><country mxw-id="DS660681758" load-source="docdb">CH</country><country mxw-id="DS660604087" load-source="docdb">CY</country><country mxw-id="DS660606880" load-source="docdb">CZ</country><country mxw-id="DS660782283" load-source="docdb">DE</country><country mxw-id="DS660604088" load-source="docdb">DK</country><country mxw-id="DS660604089" load-source="docdb">EE</country><country mxw-id="DS660681683" load-source="docdb">ES</country><country mxw-id="DS660682244" load-source="docdb">FI</country><country mxw-id="DS660681763" load-source="docdb">FR</country><country mxw-id="DS660782284" load-source="docdb">GB</country><country mxw-id="DS660604090" load-source="docdb">GR</country><country mxw-id="DS660782285" load-source="docdb">HR</country><country mxw-id="DS660606881" load-source="docdb">HU</country><country mxw-id="DS660684263" load-source="docdb">IE</country><country mxw-id="DS660604111" load-source="docdb">IS</country><country mxw-id="DS660681764" load-source="docdb">IT</country><country mxw-id="DS660604112" load-source="docdb">LI</country><country mxw-id="DS660682245" load-source="docdb">LT</country><country mxw-id="DS660607154" load-source="docdb">LU</country><country mxw-id="DS660682246" load-source="docdb">LV</country><country mxw-id="DS660682251" load-source="docdb">MC</country><country mxw-id="DS660607159" load-source="docdb">MK</country><country mxw-id="DS660607160" load-source="docdb">MT</country><country mxw-id="DS660684264" load-source="docdb">NL</country><country mxw-id="DS660681684" load-source="docdb">NO</country><country mxw-id="DS660684265" load-source="docdb">PL</country><country mxw-id="DS660682252" load-source="docdb">PT</country><country mxw-id="DS660606882" load-source="docdb">RO</country><country mxw-id="DS660682253" load-source="docdb">RS</country><country mxw-id="DS660684266" load-source="docdb">SE</country><country mxw-id="DS660681765" load-source="docdb">SI</country><country mxw-id="DS660681685" load-source="docdb">SK</country><country mxw-id="DS660681686" load-source="docdb">SM</country><country mxw-id="DS660607161" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA166479599" lang="EN" load-source="patent-office"><p id="pa01" num="0001">It is disclosed a method for controlling the protection switching in a communication network having a ring topology. The method applies when a lockout of protection command is applied at a node, a bidirectional failure occurs on a span connecting the node to an adjacent node, and the lockout of protection command is subsequently removed. The method comprises, at any one of the node and the adjacent node, detecting the failure and, if there is not a further lockout of protection command locally applied at the any one of the node and the adjacent node, sending a request packet carrying a signal fail indication towards the other node.
<img id="iaf01" file="imgaf001.tif" wi="122" he="91" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA166759411" lang="EN" source="EPO" load-source="docdb"><p>It is disclosed a method for controlling the protection switching in a communication network having a ring topology. The method applies when a lockout of protection command is applied at a node, a bidirectional failure occurs on a span connecting the node to an adjacent node, and the lockout of protection command is subsequently removed. The method comprises, at any one of the node and the adjacent node, detecting the failure and, if there is not a further lockout of protection command locally applied at the any one of the node and the adjacent node, sending a request packet carrying a signal fail indication towards the other node.</p></abstract><description mxw-id="PDES98404300" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><b><u>Technical field</u></b></heading><p id="p0001" num="0001">The present invention relates to the field of communication networks. In particular, the present invention relates to a method for controlling protection switching in a communication network (in particular, but not exclusively, an MPLS or MPLS-TP network) having a ring topology.</p><heading id="h0002"><b><u>Background art</u></b></heading><p id="p0002" num="0002">As known, in a packet-switched communication network each user traffic flow is divided into packets which are routed from a source node to a destination node along a path comprising one or more intermediate nodes connected by links.</p><p id="p0003" num="0003">In an MPLS (Multi-Protocol Label Switching) network, as defined by the IETF RFC 3031 (January 2001), the path followed by the packets carrying a given user traffic flow through the network is called Label Switched Path (briefly, LSP).</p><p id="p0004" num="0004">A particular version of MPLS, which is termed MPLS-TP (MPLS Transport Profile), is employed as a network layer technology for transport networks.</p><p id="p0005" num="0005">MPLS and MPLS-TP networks may have various topologies, including a ring topology. In particular, the ITU-T draft Recommendation "G.8132 draft MPLS-TP shared protection ring protection" (May 2009) and the IETF Internet-Draft "MPLS-TP Ring Protection Switching (MRPS)", draft-helvoort-mpls-tp-ring-protection-switching-06.txt, (April 18, 2014) defines an MPLS-TP Ring Protection Switching (in brief, MRPS) scheme allowing to protect user traffic flows transmitted over an MPLS-TP network comprising a number of nodes connected by links according to a ring topology. In particular, according to the MRPS<!-- EPO <DP n="2"> --> scheme, the links form two counter-rotating ringlets, namely a clockwise ringlet and a counterclockwise ringlet, carrying traffic in opposite directions relative to each other. In particular, the bandwidth of each ringlet is divided into a working bandwidth dedicated to working LSPs, i.e. LSPs carrying user traffic flows, and a protection bandwidth dedicated to protection LSPs. The protection LSP(s) of one ringlet may be used to carry working LSP(s) of the other ringlet in case of failure.</p><p id="p0006" num="0006">In case of a link or node failure, user traffic transmitted by the affected working LSP(s) may be switched to any of the protection LSPs, e.g. according to a wrapping technique.</p><p id="p0007" num="0007">According to the wrapping technique, in an exemplary case of a unidirectional failure affecting a link of the clockwise ringlet, the node that detects the failure (i.e. the node downstream the failed link) informs the node at the opposite side of the failure (i.e. the node upstream the failed link) and both perform protection switching, i.e. they both switch the MPLS packets of the working LSP(s) transmitted over the failed link to the protection LSP(s) in the opposite direction. According to the example above, the nodes adjacent to the failed link switch the packets to the counterclockwise ringlet. Therefore, from the node upstream the failed link the packets travel along the counterclockwise ringlet until they reach the node downstream the failed link. Then, this node switches the packets back to the clockwise ringlet. User traffic whose working direction is clockwise is protected in the counterclockwise direction and vice versa.</p><p id="p0008" num="0008">The nodes of the network typically implement a control protocol for controlling and coordinating the protection switching actions. An example of control protocol is the Automatic Protection Switching (APS) protocol. According to the ITU-T draft Recommendation "G.8132 draft MPLS-TP shared protection ring protection" and the IETF Internet-Draft "MPLS-TP Ring Protection Switching (MRPS)", draft-helvoort-mpls-tp-ring-protection-switching-06.txt,<!-- EPO <DP n="3"> --> (April 18, 2014), cited above, in a MPLS-TP ring network, the wrapping technique implies that the node detecting a failure sends out, in both directions, an APS request packet or packet to the node at the opposite side and adjacent to the failure, so that both nodes may switch the user traffic from working LSP(s) to a protection LSP. If the failure is unidirectional, the APS request packets reach the node at the opposite side and adjacent to the failure from both directions. If the failure is bidirectional, the APS request packets reach that node from one direction only.</p><p id="p0009" num="0009">Generally, APS request packets transfer within the network a set of commands, which may be automatically initiated by the nodes in case of failure conditions or they may be externally initiated.</p><p id="p0010" num="0010">An APS request packets comprises a payload in turn comprising four fields used to carry APS-specific information:
<ul><li>a destination node identifier identifying the node to which the APS request is destined;</li><li>a source node identifier identifying the node generating the APS request;</li><li>an APS request code comprising a four bits code identifying the request type (or command); and</li><li>a reserved field of one byte.</li></ul>
The APS request code (also referred to, in the following, as simply "code" or "indication") may be one of the following: Lockout of Protection (LP), Forced Switch (FS), Signal Fail (SF), Manual Switch (MS), Wait-To-Restore (WTR), Exerciser (EXER), Reverse Request (RR), No Request (NR). The codes are listed from the highest to the lowest priority, i.e. the Lockout of Protection code corresponds to a request having the highest priority. The APS request codes are used to transfer respective commands and detected defect indications within the network.<!-- EPO <DP n="4"> --></p><p id="p0011" num="0011">In particular, the Lockout of Protection code corresponds to a command which prevents any protection activity and prevents using protection switches anywhere in the ring. In particular, a respective command may be applied at a node of the ring by a network operator and the node sends APS request packets, on both the short path and the long path of the ring, carrying the Lockout of Protection code. When the nodes of the ring receive this packet, all existing switches in the ring must be dropped.</p><p id="p0012" num="0012">The Signal Fail code corresponds to a detected defect indication which is issued when a node detects a signal failure condition.</p><p id="p0013" num="0013">In the absence of failures, each node of the network typically periodically (e.g. every 5 seconds) dispatches APS request packets to the adjacent nodes containing a No Request code.</p><p id="p0014" num="0014">In the following description, the term "signaling" associated with one of the APS codes above will indicate one or more APS request packets carrying that code. For instance, the expression "Lockout of Protection (or any other APS request code) signaling" will indicate one or more APS request packets carrying the Lockout of Protection code (or any other APS request code). Moreover, the expression "send/receive a Lockout of Protection (or any other APS request code) signaling" will indicate the transmission/reception of one or more APS request packets carrying the Lockout of Protection code (or any other APS request code) according to the APS control protocol. Analogously, the expression "to signal a Lockout of Protection command (or any other command)" will indicate the transmission of one or more APS request packets carrying the Lockout of Protection code (or any other APS request code) according to the APS control protocol.</p><p id="p0015" num="0015">Moreover, the APS standard provides for different states of the nodes of the ring. In particular, a node is in a idle state when it has no APS request and is sourcing and receiving messages comprising the<!-- EPO <DP n="5"> --> No Request code to/from both directions. A node is in a pass-through state when its highest priority APS request is a request not destined to or sourced by it. The pass-through is bidirectional. A node not in the idle or pass-through states is in the switching state. Moreover, the switching state is usually associated with a command or a detected defect indication: for instance, a node may be in a Lockout of protection switching state (LP-SW) when a local Lockout of protection command is applied at the node, or it may be in a Signal Fail switching state (SF-SW) when it detects a failure condition.</p><heading id="h0003"><b><u>Summary of the invention</u></b></heading><p id="p0016" num="0016">The inventors noticed that in a ring network implementing the MRPS scheme and the APS protocol mentioned above, the following situation may occur.
<ol><li>1) A Lockout of Protection command is applied to a node of the ring in idle condition on an interface towards an adjacent remote node. As a consequence, the node addressed by the command (also referred to as "tail end") sends APS request packets carrying the Lockout of Protection code towards the remote node (also referred to as "head end") on both the short path (i.e. the path connecting directly the head end and the tail end along a ringlet) and the long path (i.e. the path along which the head end and tail end are connected through intermediate nodes, along the opposite ringlet) of the ring; the remote node, upon receiving the Lockout of Protection signaling, issues a same APS request packet and sends it over the long path, and issues an APS request packet containing a Reverse Request code and sends it over the short path.</li><li>2) A bidirectional failure condition occurs in the same span of the network interested by the Lockout of Protection command (i.e. the span connecting directly the head end and the tail end) and the failure is detected bidirectionally by both the adjacent end nodes of<!-- EPO <DP n="6"> --> that span. Due to the higher priority, the Lockout of Protection command is still kept and signaled. But, as a consequence of the bidirectional failure condition, the Reverse Request signaling previously received by the node where the Lockout of Protection command is applied is not received anymore along the short path; however, a Lockout of Protection signaling is still received along the long path. In the following description and in the claims, the term "span" will indicate any section of the ring comprising two adjacent nodes and the links therebetween.</li><li>3) A Clear command is applied at the node where the Lockout of Protection command was previously applied. Provided that the node is still receiving a Lockout of Protection signaling over the long path (indeed, this Lockout of Protection signaling is transmitted by the head end as an acknowledgement of the command previously present), the node is not allowed to drop the Lockout of Protection condition which is still kept and, as a consequence, it enters a socalled deadlock condition.</li><li>4) The failure is not protected and the traffic is lost.</li></ol></p><p id="p0017" num="0017">Each of the two end nodes of the failed span receives an APS request packet carrying a Lockout of Protection code, i.e. each of the two end nodes is signaled as if a Lockout of Protection command was applied on the other node. This command is referred to as Lockout of Protection-Far End. In other words, the situation in which one Lockout of Protection command is applied to an end node and the situation in which two Lockout of Protection commands are applied at the two end nodes are indistinguishable.</p><p id="p0018" num="0018">Consequently, the two end nodes of the failed span result in a switching state, indicated as "Lockout of Protection-Far End switching state" or "LP-FE-SW state", that cannot change either automatically or by intervention of an operator until the failure affecting the span is<!-- EPO <DP n="7"> --> recovered. In this case, indeed, the APS signaling over the span carries a Reverse Request code allowing both nodes to evolve to idle state.</p><p id="p0019" num="0019">The deadlock condition may be overcome by removing and reconfiguring the MRPS protection from the node where the Lockout of Protection command is applied or, in alternative, by removing the failure condition, which would allow the node to evolve to idle state.</p><p id="p0020" num="0020">However, these procedures have some drawbacks. On the one hand, they are disadvantageous in terms of operational costs and recovery times. Indeed, the procedure is not automatic as it requires an operator to be alerted for activating the proper actions. On the other hand, they are disadvantageous in terms of performance. Indeed, when the deadlock condition occurs and for the time it affects the ring, the ring experiences a loss of the recovery capability provided by the MRPS scheme, as the traffic traveling along the failed span is not protected and it is lost.</p><p id="p0021" num="0021">In view of the above, the Applicant has faced the problem of providing a method for controlling protection switching in a communication network (in particular, but not exclusively, an MPLS or MPLS-TP network) having a ring topology, which overcomes the aforesaid drawbacks. In particular, the Applicant has faced the problem of providing a method for controlling protection switching in a ring communication network which allows avoiding a deadlock condition in a manner which is automatic and compatible with the protection switching scheme, while keeping the ring under the full recovery capability provided by the protection switching scheme.</p><p id="p0022" num="0022">In the following description and in the claims,
<ul><li>the expression "lockout of protection command" will indicate a command inhibiting any protection switching operation in the whole communication network, such as the Lockout of Protection command described above with reference to the APS control<!-- EPO <DP n="8"> --> protocol;</li><li>the expression "request packet" will indicate a packet carrying a command and/or a detected defect indication within the communication network according to the control protocol used for controlling the protection switching, such as the APS request packet described above;</li><li>the expression "signal fail indication" will indicate an information carried within a request packet indicative of a failure condition in the communication network, such as the Signal Fail code described above;</li><li>the expression "lockout of protection indication" will indicate an information carried within a request packet indicative of a lockout of protection command applied at a node, such as the Lockout of Protection code described above;</li><li>the expression "signal fail switching state" will indicate a state of a protection switching instance in a node according to which the node detects a failure condition, sends a corresponding signaling within the network and implements the protection switching for circumventing the failure. The wording "protection switching instance" (in particular, MRPS instance) indicates the set of network resources at the nodes of the communication network which may be used for an application/implementation of a protection switching scheme (in particular, MRPS) as described above. At one node, a protection switching instance comprises the attributes and parameters that apply to support the instance itself.</li><li>The expression "lockout of protection switching state" will indicate a state of a protection switching instance in a node where a lockout of protection command is applied, the node being prevented from implementing the protection switching; and</li><li>the expression "lockout of protection - far end switching state" will<!-- EPO <DP n="9"> --> indicate a state of a protection switching instance in a node according to which the node is receiving a signaling carrying a lockout of protection indication that a lockout of protection command has been applied at another node, and is prevented from implementing the protection switching.</li></ul></p><p id="p0023" num="0023">According to a first aspect, the present invention provides a method for controlling protection switching in a communication network having a ring topology, wherein<br/>
a lockout of protection command is applied at a node of the network;<br/>
a bidirectional failure occurs on a span connecting said node to an adjacent node of the network; and<br/>
a further command is applied at the node, the further command removing the lockout of protection command,<br/>
the method comprising, at any one of the node and the adjacent node, detecting the failure and, if there is not a further lockout of protection command locally applied at any one of the node and the adjacent node, sending a request packet carrying a signal fail indication towards the other one of the node and the adjacent node.</p><p id="p0024" num="0024">According to a first embodiment, the method comprises:
<ol><li>a) at the adjacent node, detecting the failure and, if there is not the further lockout of protection command locally applied at the adjacent node, sending the request packet carrying the signal fail indication towards the node; and</li><li>b) at the node, detecting the failure, receiving the request packet and, if there is not an even further lockout of protection command locally applied at the node, implementing the protection switching to a user traffic flow affected by the failure.<br/>
Preferably, the method further comprises, at step b), entering a signal fail switching state and sending a further request packet carrying the<!-- EPO <DP n="10"> --> signal fail indication towards the adjacent node.<br/>
Preferably, the method further comprises:</li><li>c) at the adjacent node (A), receiving the further request packet, entering a signal fail switching state and implementing the protection switching to the user traffic flow affected by the failure.</li></ol></p><p id="p0025" num="0025">According to a second embodiment, the method comprises comprises:
<ul><li>a') at the node, detecting the failure and, if there is not the further lockout of protection command locally applied at the node, sending the request packet carrying the signal fail indication, and implementing the protection switching to a user traffic flow affected by the failure; and</li><li>b') at the adjacent node, detecting the failure, receiving the request packet and, if there is not an even further lockout of protection command locally applied at the adjacent node, implementing the protection switching to the user traffic flow.<br/>
Preferably, the method further comprises, at step a'), entering a signal fail switching state.<br/>
Preferably, the method further comprises, at step b'), entering a signal fail switching state and sending a further request packet carrying the signal fail indication towards the node.<br/>
Profitably, the method further comprises, at the step a'), launching a timer.<br/>
Preferably, the timer has a pre-determined duration and the duration is pre-determined on the basis of a round-trip time of a request packet over a long path between the node and the adjacent node.<br/>
Preferably, the method further comprises :</li><li>c') at the node, receiving the further request packet and, if the timer is not yet expired, stopping the timer.<br/>
Preferably, the method further comprises, at the node, upon expiration of the timer, receiving an even further request packet carrying<!-- EPO <DP n="11"> --> a lockout of protection indication from the adjacent node, entering a lockout of protection - far end switching state and stopping implementing the protection switching to the user traffic flow.</li></ul></p><p id="p0026" num="0026">According to a second aspect, the present invention provides node for a communication network having a ring topology and implementing a protection switching scheme, the node being configured to, when<br/>
a lockout of protection command is applied at a further node of the communication network adjacent to the node;<br/>
a bidirectional failure occurs on a span connecting the node to the adjacent node; and<br/>
a further command is applied at the adjacent node, the further<br/>
command removing the lockout of protection command,<br/>
detect the failure and, if there is not a further lockout of protection command locally applied at the node, send a request packet carrying a signal fail indication towards the adjacent node.</p><p id="p0027" num="0027">According to a third aspect, the present invention provides a node for a communication network having a ring topology and implementing a protection switching scheme, the node being configured to, when a lockout of protection command is applied at the node;<br/>
a bidirectional failure occurs on a span connecting the node to a further node of the communication network adjacent to the node; and<br/>
a further command is applied at the node, the further command removing the lockout of protection command,<br/>
detect the failure and, if there is not a further lockout of protection command locally applied at the node, send a request packet carrying a signal fail indication towards the adjacent node.</p><p id="p0028" num="0028">According to a fourth aspect, the present invention provides a communication network having a ring topology comprising a node as set forth above.<!-- EPO <DP n="12"> --></p><p id="p0029" num="0029">Preferably, the communication network is an MPLS or MPLS-TP communication network and the protection switching scheme is the MLPS-TP Ring Protection Switching scheme.</p><heading id="h0004"><b><u>Brief description of the drawings</u></b></heading><p id="p0030" num="0030">The present invention will become clearer by reading the following detailed description, given by way of example and not of limitation, to be read by referring to the accompanying drawings, wherein:
<ul><li><figref idrefs="f0001">Figure 1</figref> schematically shows a communication network having a ring topology and a working path passing over a span of the network;</li><li><figref idrefs="f0002">Figure 2</figref> schematically shows the network of <figref idrefs="f0001">Figure 1</figref> when a lockout of protection command is applied at a node;</li><li><figref idrefs="f0002">Figure 3</figref> schematically shows the network of <figref idrefs="f0002">Figure 2</figref> when a failure occurs on the span of the network over which the working path is passing;</li><li><figref idrefs="f0003">Figure 4</figref> schematically shows the network of <figref idrefs="f0002">Figure 3</figref> when the lockout of protection command is removed, according to a first embodiment of the present invention;</li><li><figref idrefs="f0003">Figure 5</figref> schematically shows the network of <figref idrefs="f0003">Figure 4</figref> and a protection path for the working path of <figref idrefs="f0001">Figure 1</figref>;</li><li><figref idrefs="f0004">Figure 6</figref> is a flow chart illustrating the state diagrams of the end nodes of the span affected by the failure according to the first embodiment of the present invention;</li><li><figref idrefs="f0005">Figure 7</figref> schematically shows the network of <figref idrefs="f0002">Figure 3</figref> when the lockout of protection command is removed, according to a second embodiment of the present invention; and</li><li><figref idrefs="f0006">Figure 8</figref> is a flow chart illustrating the state diagrams of the end nodes of the span affected by the failure according to the second embodiment of the present invention.</li></ul></p><heading id="h0005"><b><u>Detailed description of preferred embodiments of the invention</u></b></heading><!-- EPO <DP n="13"> --><p id="p0031" num="0031"><figref idrefs="f0001">Figure 1</figref> schematically shows a communication network RN having a ring topology.</p><p id="p0032" num="0032">The communication network RN preferably comprises a number of nodes connected to form a ring. Exemplarily, the communication network RN of <figref idrefs="f0001">Figure 1</figref> comprises four nodes, A, B, C, D.</p><p id="p0033" num="0033">Preferably, the nodes A, B, C, D are connected through unidirectional physical links both in a clockwise direction and in a counter-clockwise direction. The unidirectional physical links connecting the nodes A, B, C, D in the clockwise direction preferably form a clockwise ringlet CWR, while the unidirectional physical links connecting the nodes A, B, C, D in the counter-clockwise direction preferably form a counter-clockwise ringlet CCWR.</p><p id="p0034" num="0034">The communication network RN is preferably a packet-switched network. More preferably, the communication network CN is an MPLS network or an MPLS-TP network.</p><p id="p0035" num="0035">Preferably, the nodes of the network RN are configured to implement a protection switching scheme (in particular, the MPLS-TP Ring Protection Switching, or MRPS, scheme) and the wrapping technique described above. Moreover, each node of the communication network RN is preferably configured to implement a control protocol for controlling and coordinating protection switching actions with the other nodes of the network. Preferably, the control protocol is the APS (Automatic Protection Switching) protocol described above.</p><p id="p0036" num="0036">For sake of simplicity, in the following description, reference will be made in particular to the MPLS-TP Ring Protection Switching scheme and the APS protocol, and the language will adhere to the language used in the current standard specifications mentioned above. However, the present invention is not intended to be limited to the protection switching scheme and the control protocol as described therein, as it may be applied also when other protection switching schemes and<!-- EPO <DP n="14"> --> control protocols, with corresponding provisions, are implemented.</p><p id="p0037" num="0037">It is assumed that a working path WP carrying a user traffic flow comprises span A-D of the network RN. Moreover, it is assumed that the working path WP, in case of failure affecting span A-D, is normally protected by wrapping the traffic flow along a protection path PP comprising spans A-B, B-C and C-D.</p><p id="p0038" num="0038">It is also assumed that the following two conditions are contemporarily present within the network RN:
<ol><li>1) a Lockout of Protection command is applied at node D, in particular on the span A-D connecting node D to node A; and</li><li>2) a bidirectional failure affects span A-D.</li></ol>
The two conditions above can occur in any order.</p><p id="p0039" num="0039">Moreover, it is finally assumed that a Clear command is applied to node D to remove the Lockout of Protection command.</p><p id="p0040" num="0040">In this situation, both node D and node A are in a Lockout of Protection-Far End switching state, while nodes B and C as in pass-through state.</p><p id="p0041" num="0041">The skilled person may easily appreciate that this situation would lead to a deadlock condition as described in the preceding section, which would cause a loss of packets comprised in the user traffic flow.</p><p id="p0042" num="0042">However, according to a first embodiment of the present invention when node A:
<ul><li>detects a failure on span A-D;</li><li>receives a Lockout of Protection signaling over the long path (i.e. the path comprising spans D-C, C-B and B-A) from node D; and</li><li>has no locally applied Lockout of Protection commands,<br/>
it preferably remains in the Lockout of Protection-Far End switching state but it sends a Signal Fail signaling over the long path, as an exception to the provisions of MRPS scheme and APS control protocol, as described in the "G.8132 draft MPLS-TP shared protection ring<!-- EPO <DP n="15"> --> protection" (May 2009) and the IETF Internet-Draft "MPLS-TP Ring Protection Switching (MRPS)", draft-helvoort-mpls-tp-ring-protection-switching-06.txt, (April 18, 2014).</li></ul></p><p id="p0043" num="0043">Then, when node D:
<ul><li>detects the failure on span A-D;</li><li>receives over the long path a Signal Fail signaling from node A; and</li><li>has no locally applied Lockout of Protection commands,<br/>
it preferably moves from the Lockout of Protection-Far End switching state to the Signal Fail switching state, sends a Signal Fail signaling over the long path and applies the protection switching scheme by wrapping the user traffic flow from the failed working path to the protection path.</li></ul></p><p id="p0044" num="0044">Then, also node A preferably moves from the Lockout of Protection-Far End switching state to the Signal Fail switching state, sends a Signal Fail signaling over the long path and applies the protection switching scheme by wrapping the user traffic flow from the failed working path to the protection path.</p><p id="p0045" num="0045">According to a second embodiment of the present invention, when node A:
<ul><li>detects a failure on span A-D;</li><li>receives a Lockout of Protection signaling over the long path from node D; and</li><li>has no locally applied Lockout of Protection commands,<br/>
it preferably remains in the Lockout of Protection-Far End switching state and it sends a Lockout of Protection signaling over the long path.</li></ul></p><p id="p0046" num="0046">Then, when node D:
<ul><li>detects the failure on span A-D;</li><li>receives over the long path a Lockout of Protection signaling from node A; and<!-- EPO <DP n="16"> --></li><li>has no locally applied Lockout of Protection commands,<br/>
it preferably moves from the Lockout of Protection-Far End switching state to a Signal Fail switching state, as an exception to the provisions of MRPS scheme and APS control protocol, as described in the "G.8132 draft MPLS-TP shared protection ring protection" (May 2009) and the IETF Internet-Draft "MPLS-TP Ring Protection Switching (MRPS)", draft-helvoort-mpls-tp-ring-protection-switching-06.txt, (April 18, 2014). Then, node D sends a Signal Fail signaling over the long path and applies the protection switching scheme by wrapping the user traffic flow from the failed working path to the protection path. At the same time, node D preferably launches a timer with a predetermined duration.</li></ul></p><p id="p0047" num="0047">Then, when node A receives the Signal Fail signaling over the long path from node D (and if there is not a locally applied Lockout of Protection command), it moves from the Lockout of Protection-Far End switching state to the Signal Fail switching state, sends a Signal Fail signaling over the long path to node D and applies the protection switching scheme by wrapping the user traffic flow from the failed working path to the protection path.</p><p id="p0048" num="0048">During the timer's running time, node D preferably remains in the Signal Fail switching state and continues sending the Signal Fail signaling. In other words, during the timer's running time, node D "ignores" the request packets that it is receiving over the long path.</p><p id="p0049" num="0049">If, before expiration of the timer or upon expiration of the timer, node D receives a Signal Fail signaling over the long path from node A (because node A, upon reception of a Signal Fail signaling over the long path from node D, has entered the Signal Fail switching state), it preferably remains in the Signal Fail switching state, stops timer and continues sending the Signal Fail signaling. In this case, both node D and node A are implementing the protection switching scheme and they<!-- EPO <DP n="17"> --> are wrapping the user traffic flow from the failed working path WP to the protection path PP.</p><p id="p0050" num="0050">If, upon expiration of the timer, node D receives a Lockout of Protection signaling over the long path from node A (because, for instance, a local Lockout of Protection command has been applied at node A on span A-D), it preferably moves from the Signal Fail switching state into the Lockout of Protection-Far End switching state and starts sending the Lockout of Protection signaling over the long path. In this case, node D stops wrapping the user traffic flow from the working path WP to the protection path PP.</p><p id="p0051" num="0051">According to both the embodiments above, the method of the present invention provides for controlling protection switching within the network RN by overriding the provisions of the standard specifications for the MRPS protection switching scheme and the APS control protocol. Indeed, according to the present invention, in a situation of possible deadlock as described above, one node at an end of the span affected by the failure, namely either node A (first embodiment) or node D (second embodiment), sends a Signal Fail signaling to the node at the opposite end of the span, irrespective of the provisions of the standard specifications. According to the first embodiment, node A sends such signaling even if it is in a Lockout of Protection-Far End switching state. According to the second embodiment, node D enters the Signal Fail switching state and sends a corresponding signaling even if it is receiving a Lockout of Protection signaling over the long path.</p><p id="p0052" num="0052">In this way, according to both the first embodiment of the present invention and the second embodiment of the present invention, the deadlock condition is advantageously avoided. Hence, a user traffic flow, which is protected according to the implemented protection switching scheme and passes (in normal conditions) through the failed span, may be advantageously correctly recovered.<!-- EPO <DP n="18"> --></p><p id="p0053" num="0053"><figref idrefs="f0002">Figures 2, 3</figref>, <figref idrefs="f0003">4, 5</figref> and <figref idrefs="f0004">6</figref> illustrate in greater detail the first embodiment of the present invention. In particular, <figref idrefs="f0004">Figure 6</figref> is a flow chart representing the state diagram of nodes A and D.</p><p id="p0054" num="0054">Nodes A, B, C, D are initially in idle state (step 600 of <figref idrefs="f0004">Figure 6</figref>) and they issue and send request packets carrying a No Request code (not shown in the Figures).</p><p id="p0055" num="0055">Further, it is assumed that a Lockout of Protection command is applied at node D (see <figref idrefs="f0002">Figure 2</figref>). In <figref idrefs="f0002">Figure 2</figref> and in <figref idrefs="f0004">Figure 6</figref>, application of the Lockout of Protection command is represented by means of an arrow labeled with the reference "LP_cmd". In particular, the Lockout of Protection command LP_cmd is preferably applied at node D with reference to the span connecting node D to node A of network RN.</p><p id="p0056" num="0056">In this case, as illustrated in <figref idrefs="f0004">Figure 6</figref>, step 601, node D enters a Lockout of Protection switching state (LP-SW state).</p><p id="p0057" num="0057">As already described above, when the Lockout of Protection command LP_cmd is applied at node D and node D enters the Lockout of Protection switching state, it issues one or more request packets according to the control protocol mentioned above. In particular, the request packets issued by node D preferably comprises a Lockout of Protection code.</p><p id="p0058" num="0058">Then, node D preferably send the request packets to node A over the short path (i.e. span A-D) and send similar request packets to node A over the long path. In <figref idrefs="f0002">Figure 2</figref>, these request packets are indicated with the same reference LP(DA).</p><p id="p0059" num="0059">Node A, upon receiving the request packet LP(DA) from node D preferably enters a Lockout of Protection-Far End switching state (LP-FE-SW state), as illustrated in <figref idrefs="f0004">Figure 6</figref>, step 602. Then, preferably, node A:
<ul><li>issues one or more first request packets, carrying the Lockout of<!-- EPO <DP n="19"> --> Protection code. Then, node A sends the first request packets subsequently over the long path towards node D. The first request packet issued by node A is indicated in <figref idrefs="f0002">Figure 2</figref> with reference LP(AD); and</li><li>issues one or more second request packets, carrying the Reverse Request code, and send them subsequently over the short path (i.e. send them towards node D). The second request packet issued at node A is indicated in <figref idrefs="f0002">Figure 2</figref> with reference RR(AD).<br/>
Node B and node C enter a pass-through state.</li></ul></p><p id="p0060" num="0060">At this point, it is assumed that a bidirectional failure F affects span A-D (see <figref idrefs="f0002">Figure 3</figref>).</p><p id="p0061" num="0061">The two conditions described above, namely applying the Lockout of Protection command LP_cmd and the occurrence of failure F, may occur in any order, namely firstly the Lockout of Protection command LP_cmd is applied at node D and then the bidirectional failure occurs on span A-D or viceversa. <figref idrefs="f0002 f0003">Figures 2-5</figref> illustrate the situation according to which the Lockout of Protection command LP_cmd is applied first and then the bidirectional failure F occurs.</p><p id="p0062" num="0062">When the failure F occurs, the failure is detected bidirectionally by both node D and node A (steps 603 and 606 of <figref idrefs="f0004">Figure 6</figref>).</p><p id="p0063" num="0063">In particular, at step 603, node D preferably:
<ul><li>detects the bidirectional failure F;</li><li>receives over the long path the first request packet LP(AD) carrying the Lockout of Protection code from node A; and</li><li>remains in the Lockout of Protection switching state.</li></ul></p><p id="p0064" num="0064">At this point, as illustrated in <figref idrefs="f0003">Figure 4</figref> and <figref idrefs="f0004">Figure 6</figref>, a further command C_cmd may be applied to node D in order to remove the Lockout of Protection command LP_cmd. As mentioned above, this further command is preferably a Clear command.</p><p id="p0065" num="0065">In the meanwhile, node D is receiving from node A over the long path<!-- EPO <DP n="20"> --> a first request packet LP(AD) carrying the Lockout of Protection code. When node D detects that it is receiving over the long path a first request packet LP(AD) carrying the Lockout of Protection code (step 604), it moves from the Lockout of Protection switching state to a Lockout of Protection-Far End switching state (step 605 of <figref idrefs="f0004">Figure 6</figref>) and keeps sending over the long path request packets carrying the Lockout of Protection code, indicated in <figref idrefs="f0003">Figure 4</figref> with reference LP(DA).</p><p id="p0066" num="0066">At step 606, node A preferably:
<ul><li>detects the bidirectional failure F; and</li><li>receives from node D the request packet LP(DA) comprising the Lockout of Protection code over the long path.</li></ul></p><p id="p0067" num="0067">If no Lockout of Protection command is locally applied at node A on span A-D, node A remains in the Lockout of Protection-Far End switching state but issues and sends over the long path one or more request packets containing a Signal Fail code. This request packet is indicated in <figref idrefs="f0003">Figure 4</figref> by reference SF(AD).</p><p id="p0068" num="0068">When node D detects that over the long path it is receiving a request packet SF(AD) carrying the Signal Fail code from node A (step 604 of <figref idrefs="f0004">Figure 6</figref>), it preferably moves from the Lockout of Protection-Far End switching state to a Signal Fail switching state (step 607). Moreover, at step 607, node D issues and sends over the long path request packets containing the Signal Fail code, as illustrated in <figref idrefs="f0003">Figure 5</figref>. This request packet is indicated in <figref idrefs="f0003">Figure 5</figref> by reference SF(DA). Finally, at step 607, node D preferably implements the protection switching scheme and wraps the user traffic flow from the failed working path WP to the protection path PP.</p><p id="p0069" num="0069">At this point, also node A preferably moves from the Lockout of Protection-Far End switching state to a Signal Fail switching state, implements the protection switching scheme and wraps the user traffic flow from the failed working path WP to the protection path PP (step<!-- EPO <DP n="21"> --> 608).</p><p id="p0070" num="0070">It is to be noticed that if a Lockout of Protection command is applied at node A on span A-D, at any time, node A preferably enters a Lockout of Protection switching state, and issues and sends over the long path request packets carrying a Lockout of Protection code. Any wrapping operation possibly initiated by node A for circumventing failure F is stopped. In this case node D enters a Lockout of Protection-Far End switching state and sends a Lockout of Protection signaling over the long path. When the failure is detected, node D starts sending a Signal Fail signaling as per the protocol exception described above.</p><p id="p0071" num="0071">As already mentioned above, according to this first embodiment of the present invention, the deadlock condition is advantageously avoided. Indeed, the node which is receiving a Lockout of Protection signaling over the long path and detects a failure over the span on which the user traffic flow should pass (node A in the situation above, by way of example), sends a Signal Fail signaling over the long path. This is an exception to the provisions of the MRPS scheme and the APS control protocol. In this way, the node at the opposite side of the failed span, upon removal of the Lockout of Protection command, may send a Signal Fail signaling as well, so that the two nodes may implement the protection switching scheme for recovering the user traffic flow.</p><p id="p0072" num="0072">In the following, the method according to this second embodiment of the present invention will be described in greater detail with reference to <figref idrefs="f0002">Figures 2, 3</figref>, <figref idrefs="f0005">7</figref>, <figref idrefs="f0003">5</figref> and <figref idrefs="f0006">8</figref>. In particular, <figref idrefs="f0006">Figure 8</figref> is a flow chart illustrating the state diagrams of nodes D and A.</p><p id="p0073" num="0073">As already described above with reference to the first embodiment of the present invention, nodes A, B, C, D are initially in idle state (step 800 of <figref idrefs="f0006">Figure 8</figref>) and they issue and send request packets carrying a No Request code (not shown in the Figures).<!-- EPO <DP n="22"> --></p><p id="p0074" num="0074">Further, it is assumed that a Lockout of Protection command LP_cmd is applied at node D (see <figref idrefs="f0002">Figure 2</figref>). In this case, as illustrated in <figref idrefs="f0006">Figure 8</figref>, step 801, node D enters a Lockout of Protection switching state (LP-SW state) and it preferably issues one or more request packets carrying a Lockout of Protection request code. These request packets, indicated with reference LP(DA) in <figref idrefs="f0002">Figure 2</figref>, are sent to node A over both the short path and the long path,</p><p id="p0075" num="0075">Node A, upon receiving the request packet LP(DA) from node D preferably enters a Lockout of Protection-Far End switching state (LP-FE-SW state), as illustrated in <figref idrefs="f0006">Figure 8</figref>, step 802. Then, preferably, node A:
<ul><li>issues one or more first request packets LP(AD) carrying the Lockout of Protection code and sends them over the long path towards node D; and</li><li>issues one or more second request packets RR(AD) carrying the Reverse Request code and send them over the short path send them towards node D.<br/>
Node B and node C enter a pass-through state.</li></ul></p><p id="p0076" num="0076">At this point, it is assumed that a bidirectional failure F affects span A-D (see <figref idrefs="f0002">Figure 3</figref>).</p><p id="p0077" num="0077">Again, the two conditions described above, namely the application of command LP_cmd and the occurrence of failure F, may occur in any order, namely firstly the command LP_cmd is applied at node D and then the bidirectional failure occurs on span A-D or viceversa.</p><p id="p0078" num="0078">When the failure F occurs, the failure is detected bidirectionally by both node D and node A (steps 803 and 804 of <figref idrefs="f0006">Figure 8</figref>).</p><p id="p0079" num="0079">In particular, at step 803, node D preferably:
<ul><li>detects the bidirectional failure F;</li><li>receives over the long path the first request packets LP(AD) carrying the Lockout of Protection code from node A; and<!-- EPO <DP n="23"> --></li><li>remains in the Lockout of Protection switching state.</li></ul></p><p id="p0080" num="0080">Node A preferably:
<ul><li>detects the bidirectional failure F;</li><li>receives over the long path the request packet LP(DA) carrying the Lockout of Protection code from node D; and</li><li>remains in the Lockout of Protection-Far End switching state.</li></ul></p><p id="p0081" num="0081">At this point, as illustrated in <figref idrefs="f0005">Figure 7</figref> and <figref idrefs="f0006">Figure 8</figref>, a further command C_cmd may be applied to node D in order to remove the command LP_cmd. Preferably, this further command is a Clear command.</p><p id="p0082" num="0082">When the further command C_cmd is applied at node D, node D preferably enters the Signal Fail switching state irrespective of the fact that it is still receiving over the long path from node A request packets carrying the Lockout of Protection code. Then, node D preferably starts issuing and sending request packets carrying the Signal Fail code over the long path (indicated in <figref idrefs="f0005">Figure 7</figref> by reference SF(DA)) and starts implementing the protection switching scheme by wrapping the user traffic flow from the failed working path WP to the protection path PP. In the meanwhile, preferably, node D launches a timer.</p><p id="p0083" num="0083">As already mentioned above, the timer has preferably a predetermined duration. The pre-determined duration is preferably set by a network operator and depends on the number of nodes in the network RN. It also preferably depends on an average time T, which is determined as the average time in which a request packet is issued at a node and transmitted from that node to an adjacent node. Preferably, the duration of the timer is equal to (N-1)√ó2√óT, where N is the number of nodes in the network RN. In other words, the predetermined timer duration is preferably equal to a round-trip time of a request packet over the long path. If, for instance, T=3.3 ms and N=128, the predetermined timer duration is equal to 838.2 ms.<!-- EPO <DP n="24"> --></p><p id="p0084" num="0084">For the period during which the timer is running, node D preferably remains in the Signal Fail switching state, issues and sends request packets comprising the Signal Fail code and wraps the user traffic flow.</p><p id="p0085" num="0085">In the meanwhile, at step 806, node A preferably:
<ul><li>detects the bidirectional failure F; and</li><li>receives from node D the request packet SF(DA) comprising the Signal Fail code over the long path.<br/>
If no Lockout of Protection command is locally applied at node A, node A moves from the Lockout of Protection-Far End switching state to the Signal Fail switching state and start issuing and sending over the long path one or more request packets containing the Signal Fail. This request packet is indicated in <figref idrefs="f0003">Figure 5</figref> by reference SF(AD). Moreover, node A starts performing protection switching actions and wrapping the user traffic flow.</li></ul></p><p id="p0086" num="0086">When the timer expires or before the timer expires, node D preferably detects that it is receiving over the long path request packets SF(AD) carrying the Signal Fail code. Therefore, node D preferably remains in the Signal Fail switching state, stops the timer and continues sending request packets carrying the Signal Fail code. Moreover, node D continues implementing the protection switching scheme and wrapping the user traffic flow from the failed working path WP to the protection path PP.</p><p id="p0087" num="0087">It is to be noticed that if a Lockout of Protection command is locally applied at node A on span A-D, at any time, node A preferably enters a Lockout of Protection switching state, and issues and sends over the long path request packets carrying a Lockout of Protection code. In this case, if, upon expiration of the timer, node D receives request packets carrying the Lockout of Protection code over the long path from node A, node D preferably moves from the Signal Fail switching state to a Lockout of Protection-Far End switching state, issues request packets<!-- EPO <DP n="25"> --> carrying the Lockout of Protection code and sends the Lockout of Protection signaling over the long path.</p><p id="p0088" num="0088">Also according to this second embodiment of the present invention, the deadlock condition is advantageously avoided. Indeed, when the Lockout of Protection command is removed at node D, and node D is detecting the failure on span A-D while receiving over the long path a Lockout of Protection signaling from node A, it moves from the Lockout of Protection-Far End switching state to a Signal Fail switching state, instead of moving into the Lockout of Protection-Far End switching state, as provided by the standard MRPS protection switching scheme and the APS control protocol. This advantageously allows starting implementing the protection switching scheme at node D overriding the Lockout of Protection signaling that node D is receiving over the long path from node A.</p><p id="p0089" num="0089">Therefore, according to the second embodiment of the present invention, in a situation in which a Lockout of Protection is applied and then removed at a node which is detecting a failure, the node enters a Signal Fail switching state that allows the node to start implementing the protection switching scheme for recovering the user traffic flow affected by the failure. This feature also allows reducing the recovery time in the presence of a unidirectional failure in combination with a Lockout of Protection command, as it will be described herein after.</p><p id="p0090" num="0090">Firstly, the "standard" behaviour of the nodes of network RN in presence of a unidirectional failure in combination with a Lockout of Protection command will be described as provided by the MRPS protection switching scheme and the APS control protocol.</p><p id="p0091" num="0091">Initially, the nodes A, B, C, D are all in the idle state and the working path WP is carrying a user traffic flow over span A-D of the network RN. Then, at node D, a Lockout of Protection command is applied on span A-D, as already described above with reference to <figref idrefs="f0002">Figure 2</figref>. Node D<!-- EPO <DP n="26"> --> enters a Lockout of Protection switching state, issues request packets carrying the Lockout of Protection code and sends them over the short path and the long path towards node A. Upon reception of a request packet carrying the Lockout of Protection code, node A enters a Lockout of Protection-Far End switching state. Then, also node A issues request packets carrying the Lockout of Protection code and sends them over the long path towards node D. Nodes B and C enter the pass-through state.</p><p id="p0092" num="0092">Then, a unidirectional failure occurs on span A-D (e.g. in the direction from node A to node D). In this case, node D and node A remain in the respective current state.</p><p id="p0093" num="0093">When a further command is applied at node D removing the Lockout of Protection command (i.e. the Clear command already described above), node D, which is receiving request packets carrying the Lockout of Protection code over the long path and is detecting a failure over span A-D, enters the Lockout of Protection-Far End switching state. Node D issues and sends a Lockout of protection signaling over the long path and a Reverse Request signaling over the short path, i.e. over the link which is not affected by the unidirectional failure.</p><p id="p0094" num="0094">Upon reception of the Reverse Request signaling over the short path, node A enters a idle state, and issues and sends request packets carrying the No Request code over the long path.</p><p id="p0095" num="0095">When node D receives the request packet carrying the No Request code from node A and still detects the unidirectional failure, node D enters a Signal Fail switching state, issues and sends request packets carrying the Signal Fail code over both the short path and the long path and starts implementing the protection switching scheme by wrapping the user traffic flow affected by the unidirectional failure from the working path WP to the protection path PP. Upon reception of the request packet carrying the Signal fail code, also node A starts<!-- EPO <DP n="27"> --> implementing the protection switching scheme by wrapping the user traffic flow affected by the unidirectional failure from the working path WP to the protection path PP.</p><p id="p0096" num="0096">The recovery time, i.e. the time needed to recover the user traffic flow is (N+1)xT, where T is the average time in which a request packet is issued at a node and transmitted from that node to an adjacent node, as already mentioned above.</p><p id="p0097" num="0097">According to the method of the second embodiment of the present invention, as applied in case the failure is unidirectional, when the Lockout of Protection command is removed at node D, node D preferably enters a Signal Fail switching state. Hence, node D preferably starts issuing and sending request packets carrying the Signal Fail code over both the short path and the long path towards node A. In the meanwhile, node D preferably starts implementing the protection switching scheme by wrapping the user traffic flow affected by the unidirectional failure from the working path WP to the protection path PP. At this point, node A receives request packets carrying the Signal Fail code and enters the Signal Fail switching state. Node A then issues and sends request packets carrying the Signal Fail code over the long path, and issues and sends request packets carrying the Reverse Request code over the short path. In the meanwhile, also node A starts implementing the protection switching scheme by wrapping the user traffic flow affected by the unidirectional failure from the working path WP to the protection path PP.</p><p id="p0098" num="0098">Implementing the method of the second embodiment of the present invention in case of a unidirectional failure, the recovery time is equal to about T and it is much faster than the time needed to protect the user traffic flow according to the "standard" procedures described above. For example, if N=16, the recovery time according to the method of the second embodiment as applied when a unidirectional failure is<!-- EPO <DP n="28"> --> considered, is equal to about 3.3 ms, while the recovery time according to the standard procedure is equal to about 56.1 ms. If N=128, the recovery time according to the method of the second embodiment is still equal to about 3.3 ms, while the recovery time according to the standard procedure is equal to about 425.7 ms. It is apparent that the method according to the second embodiment of the present invention as applied in case of a unidirectional failure occurs, allows to greatly reduce the recovery time, especially when large networks are considered.</p></description><claims mxw-id="PCLM90459231" lang="EN" load-source="patent-office"><!-- EPO <DP n="29"> --><claim id="c-en-0001" num="0001"><claim-text>A method for controlling protection switching in a communication network (RN) having a ring topology, wherein<br/>
a lockout of protection command (LP_cmd) is applied at a node (D) of said network (RN);<br/>
a bidirectional failure occurs on a span connecting said node to an adjacent node (A) of the network (RN); and<br/>
a further command (C_cmd) is applied at said node (D), said further command (C_cmd) removing said lockout of protection command (LP_cmd),<br/>
the method comprising, at any one of said node (D) and said adjacent node (A), detecting said failure (F) and, if there is not a further lockout of protection command locally applied at said any one of said node (D) and said adjacent node (A), sending a request packet (SF(AD)) carrying a signal fail indication towards the other one of said node (D) and said adjacent node (A).</claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The method according to claim 1, wherein it comprises:
<claim-text>a) at said adjacent node (A), detecting said failure (F) and, if there is not said further lockout of protection command locally applied at said adjacent node (A), sending said request packet (SF(AD)) carrying the signal fail indication towards said node (D); and</claim-text>
<claim-text>b) at said node (D), detecting said failure (F), receiving said request packet (SF(AD)) and, if there is not an even further lockout of protection command locally applied at said node (D), implementing said protection switching to a user traffic flow affected by said failure (F).</claim-text></claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The method according to claim 2, wherein it further comprises, at said step b), entering a signal fail switching state and sending a<!-- EPO <DP n="30"> --> further request packet (SF(DA)) carrying the signal fail indication towards said adjacent node (A).</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>The method according to claim 3, wherein it further comprises:
<claim-text>c) at said adjacent node (A), receiving said further request packet (SF(DA)), entering a signal fail switching state and implementing said protection switching to said user traffic flow affected by said failure (F).</claim-text></claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>The method according to claim 1, wherein it comprises:
<claim-text>a') at said node (D), detecting said failure (F) and, if there is not said further lockout of protection command locally applied at said node (D), sending said request packet (SF(DA)) carrying the signal fail indication, and implementing said protection switching to a user traffic flow affected by said failure (F); and b') at said adjacent node (A), detecting said failure (F), receiving said request packet (SF(DA)) and, if there is not an even further lockout of protection command locally applied at said adjacent node (A), implementing said protection switching to said user traffic flow.</claim-text></claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>The method according to claim 5, wherein it further comprises, at said step a'), entering a signal fail switching state.</claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>The method according to claim 5 or 6, wherein it further comprises, at said step b'), entering a signal fail switching state and sending a further request packet (SF(AD)) carrying the signal fail indication towards said node (D).</claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>The method according to any one of claims 5 to 7, wherein it further comprises, at said step a'), launching a timer.</claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>The method according to claim 8, wherein said timer has a predetermined duration and said duration is pre-determined on the<!-- EPO <DP n="31"> --> basis of a round-trip time of a request packet over a long path between said node (D) and said adjacent node (A).</claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>The method according to claim 7 and claim 8 or 9, wherein it further comprises :
<claim-text>c') at said node (D), receiving said further request packet (SF(AD)) and, if said timer is not yet expired, stopping said timer.</claim-text></claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>The method according to any one of claims 8 to 10, wherein it further comprises, at said node (D), upon expiration of said timer, receiving an even further request packet carrying a lockout of protection indication from said adjacent node (A), entering a lockout of protection - far end switching state and stopping implementing said protection switching to said user traffic flow.</claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>A node (A) for a communication network (RN) having a ring topology and implementing a protection switching scheme, said node (A) being configured to, when<br/>
a lockout of protection command (LP_cmd) is applied at a further node (D) of the communication network (RN) adjacent to said node (A);<br/>
a bidirectional failure occurs on a span connecting said node (A) to said adjacent node (D); and<br/>
a further command (C_cmd) is applied at said adjacent node (D), said further command (C_cmd) removing said lockout of protection command (LP_cmd),<br/>
detect said failure (F) and, if there is not a further lockout of protection command locally applied at said node (D), send a request packet (SF(AD)) carrying a signal fail indication towards said adjacent node (D).</claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>A node (D) for a communication network (RN) having a ring topology and implementing a protection switching scheme, said<!-- EPO <DP n="32"> --> node (D) being configured to, when<br/>
a lockout of protection command (LP_cmd) is applied at said node (D);<br/>
a bidirectional failure occurs on a span connecting said node (D) to a further node (A) of the communication network (RN) adjacent to said node (D); and<br/>
a further command (C_cmd) is applied at said node (D), said further command (C_cmd) removing said lockout of protection command (LP_cmd),<br/>
detect said failure (F) and, if there is not a further lockout of protection command locally applied at said node (D), send a request packet (SF(DA)) carrying a signal fail indication towards said adjacent node (A).</claim-text></claim><claim id="c-en-0014" num="0014"><claim-text>A communication network (RN) having a ring topology comprising a node according to claim 12 or 13.</claim-text></claim><claim id="c-en-0015" num="0015"><claim-text>The communication network (RN) according to claim 14, wherein said communication network (RN) is an MPLS or MPLS-TP communication network and said protection switching scheme is the MLPS-TP Ring Protection Switching scheme.</claim-text></claim></claims><amended-claims mxw-id="PCLM90459230" lang="EN" load-source="patent-office" amended-claim-type="EPC"><heading id="h0006">Amended claims in accordance with Rule 137(2) EPC.</heading><claim id="ac-en-0001" num="0001"><claim-text>A method for controlling protection switching in a communication network (RN) having a ring topology, said communication network (RN) being configured to implement an MLPS-TP ring protection switching scheme and an automatic protection switching control protocol, wherein
<claim-text>a lockout of protection command (LP_cmd) is applied at a node (D) of said network (RN);</claim-text>
<claim-text>a bidirectional failure occurs on a span connecting said node to an adjacent node (A) of the network (RN); and</claim-text>
<claim-text>a further command (C_cmd) is applied at said node (D), said further command (C_cmd) removing said lockout of protection command (LP_cmd),</claim-text>
the method comprising, at any one of said node (D) and said adjacent node (A), detecting said failure (F),<br/>
the method being <b>characterized in that</b> it comprises, if there is not a further lockout of protection command locally applied at said any one of said node (D) and said adjacent node (A), sending a request packet (SF(AD)) carrying a signal fail indication towards the other one of said node (D) and said adjacent node (A).</claim-text></claim><claim id="ac-en-0002" num="0002"><claim-text>The method according to claim 1, wherein it comprises:
<claim-text>a) at said adjacent node (A), detecting said failure (F) and, if there is not said further lockout of protection command locally applied at said adjacent node (A), sending said request packet (SF(AD)) carrying the signal fail indication towards said node (D); and</claim-text>
<claim-text>b) at said node (D), detecting said failure (F), receiving said request packet (SF(AD)) and, if there is not an even further lockout of protection command locally applied at said node (D), implementing said protection switching to a user traffic flow affected by said failure (F).</claim-text></claim-text></claim><claim id="ac-en-0003" num="0003"><claim-text>The method according to claim 2, wherein it further comprises, at said step b), entering a signal fail switching state and sending a further request packet (SF(DA)) carrying the signal fail indication towards said adjacent node (A).</claim-text></claim><claim id="ac-en-0004" num="0004"><claim-text>The method according to claim 3, wherein it further comprises:
<claim-text>c) at said adjacent node (A), receiving said further request packet (SF(DA)), entering a signal fail switching state and implementing said protection switching to said user traffic flow affected by said failure (F).</claim-text></claim-text></claim><claim id="ac-en-0005" num="0005"><claim-text>The method according to claim 1, wherein it comprises:
<claim-text>a') at said node (D), detecting said failure (F) and, if there is not said further lockout of protection command locally applied at said node (D), sending said request packet (SF(DA)) carrying the signal fail indication, and implementing said protection switching to a user traffic flow affected by said failure (F); and</claim-text>
<claim-text>b') at said adjacent node (A), detecting said failure (F), receiving said request packet (SF(DA)) and, if there is not an even further lockout of protection command locally applied at said adjacent node (A), implementing said protection switching to said user traffic flow.</claim-text></claim-text></claim><claim id="ac-en-0006" num="0006"><claim-text>The method according to claim 5, wherein it further comprises, at said step a'), entering a signal fail switching state.</claim-text></claim><claim id="ac-en-0007" num="0007"><claim-text>The method according to claim 5 or 6, wherein it further comprises, at said step b'), entering a signal fail switching state and sending a further request packet (SF(AD)) carrying the signal fail indication towards said node (D).</claim-text></claim><claim id="ac-en-0008" num="0008"><claim-text>The method according to any one of claims 5 to 7, wherein it further comprises, at said step a'), launching a timer.</claim-text></claim><claim id="ac-en-0009" num="0009"><claim-text>The method according to claim 8, wherein said timer has a pre-determined duration and said duration is pre-determined on the basis of a round-trip time of a request packet over a long path between said node (D) and said adjacent node (A).</claim-text></claim><claim id="ac-en-0010" num="0010"><claim-text>The method according to claim 7 and claim 8 or 9, wherein it further comprises :
<claim-text>c') at said node (D), receiving said further request packet (SF(AD)) and, if said timer is not yet expired, stopping said timer.</claim-text></claim-text></claim><claim id="ac-en-0011" num="0011"><claim-text>The method according to any one of claims 8 to 10, wherein it further comprises, at said node (D), upon expiration of said timer, receiving an even further request packet carrying a lockout of protection indication from said adjacent node (A), entering a lockout of protection - far end switching state and stopping implementing said protection switching to said user traffic flow.</claim-text></claim><claim id="ac-en-0012" num="0012"><claim-text>A node (A) for a communication network (RN) having a ring topology and implementing a protection switching scheme, said protection switching scheme being an MLPS-TP ring protection switching scheme, said node (A) being configured to implement an automatic protection switching control protocol and to, when
<claim-text>a lockout of protection command (LP_cmd) is applied at a further node (D) of the communication network (RN) adjacent to said node (A);</claim-text>
<claim-text>a bidirectional failure occurs on a span connecting said node (A) to said adjacent node (D); and</claim-text>
<claim-text>a further command (C_cmd) is applied at said adjacent node (D), said further command (C_cmd) removing said lockout of protection command (LP_cmd),</claim-text>
detect said failure (F), the node (A) being <b>characterized in that</b> it is further configured to, if there is not a further lockout of protection command locally applied at said node (A), send a request packet (SF(AD)) carrying a signal fail indication towards said adjacent node (D).</claim-text></claim><claim id="ac-en-0013" num="0013"><claim-text>A node (D) for a communication network (RN) having a ring topology and implementing a protection switching scheme, said protection switching scheme being an MLPS-TP ring protection switching scheme, said node (D) being configured to implement an automatic protection switching control protocol and to, when
<claim-text>a lockout of protection command (LP_cmd) is applied at said node (D);</claim-text>
<claim-text>a bidirectional failure occurs on a span connecting said node (D) to a further node (A) of the communication network (RN) adjacent to said node (D); and</claim-text>
<claim-text>a further command (C_cmd) is applied at said node (D), said further command (C_cmd) removing said lockout of protection command (LP_cmd),</claim-text>
detect said failure (F), the node (D) being <b>characterized in that</b> it is further configured to, if there is not a further lockout of protection command locally applied at said node (D), send a request packet (SF(DA)) carrying a signal fail indication towards said adjacent node (A).</claim-text></claim><claim id="ac-en-0014" num="0014"><claim-text>A communication network (RN) having a ring topology comprising a node according to claim 12 or 13.</claim-text></claim><claim id="ac-en-0015" num="0015"><claim-text>The communication network (RN) according to claim 14, wherein said communication network (RN) is an MPLS or MPLS-TP communication network.</claim-text></claim></amended-claims><drawings mxw-id="PDW20421966" load-source="patent-office"><!-- EPO <DP n="33"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="151" he="156" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="34"> --><figure id="f0002" num="2,3"><img id="if0002" file="imgf0002.tif" wi="165" he="97" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="35"> --><figure id="f0003" num="4,5"><img id="if0003" file="imgf0003.tif" wi="165" he="95" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="36"> --><figure id="f0004" num="6"><img id="if0004" file="imgf0004.tif" wi="165" he="125" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="37"> --><figure id="f0005" num="7"><img id="if0005" file="imgf0005.tif" wi="135" he="152" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="38"> --><figure id="f0006" num="8"><img id="if0006" file="imgf0006.tif" wi="165" he="162" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="158" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="158" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
