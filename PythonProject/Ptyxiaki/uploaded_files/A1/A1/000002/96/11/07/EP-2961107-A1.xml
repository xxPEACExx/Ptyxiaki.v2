<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2961107-A1" country="EP" doc-number="2961107" kind="A1" date="20151230" family-id="51390691" file-reference-id="286466" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160451574" ucid="EP-2961107-A1"><document-id><country>EP</country><doc-number>2961107</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-13875498-A" is-representative="NO"><document-id mxw-id="PAPP193866116" load-source="patent-office" format="original"><country>EP</country><doc-number>13875498.1</doc-number><date>20130220</date><lang>JA</lang></document-id><document-id mxw-id="PAPP193866117" load-source="docdb" format="epo"><country>EP</country><doc-number>13875498</doc-number><kind>A</kind><date>20130220</date><lang>JA</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162027319" ucid="JP-2013054162-W" linkage-type="A" load-source="docdb"><document-id format="epo"><country>JP</country><doc-number>2013054162</doc-number><kind>W</kind><date>20130220</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1976511644" load-source="docdb">H04L  12/24        20060101ALI20160125BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1976516733" load-source="docdb">H04L  12/46        20060101AFI20160125BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1892467171" load-source="docdb" scheme="CPC">H04L  41/08        20130101 LI20160928BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987781718" load-source="docdb" scheme="CPC">H04L  12/4641      20130101 FI20151017BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165546188" lang="DE" load-source="patent-office">SCHALTER UND PROGRAMM</invention-title><invention-title mxw-id="PT165546189" lang="EN" load-source="patent-office">SWITCH AND PROGRAM</invention-title><invention-title mxw-id="PT165546190" lang="FR" load-source="patent-office">COMMUTATEUR ET PROGRAMME</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR1103336018" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>FUJITSU LTD</last-name><address><country>JP</country></address></addressbook></applicant><applicant mxw-id="PPAR1103320773" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>FUJITSU LIMITED</last-name></addressbook></applicant><applicant mxw-id="PPAR1101640054" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Fujitsu Limited</last-name><iid>101071604</iid><address><street>1-1, Kamikodanaka 4-chome Nakahara-ku</street><city>Kawasaki-shi, Kanagawa 211-8588</city><country>JP</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103344879" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>NAMIHIRA DAISUKE</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103330134" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>NAMIHIRA, DAISUKE</last-name></addressbook></inventor><inventor mxw-id="PPAR1101648692" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>NAMIHIRA, DAISUKE</last-name><address><street>c/o FUJITSU LIMITED 1-1 Kamikodanaka 4-chome Nakahara-ku</street><city>Kawasaki-shi Kanagawa 211-8588</city><country>JP</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR1101640341" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>HOFFMANN EITLE</last-name><iid>100061036</iid><address><street>Patent- und Rechtsanwälte PartmbB Arabellastraße 30</street><city>81925 München</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="JP-2013054162-W"><document-id><country>JP</country><doc-number>2013054162</doc-number><kind>W</kind><date>20130220</date><lang>JA</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2014128858-A1"><document-id><country>WO</country><doc-number>2014128858</doc-number><kind>A1</kind><date>20140828</date><lang>JA</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS660687809" load-source="docdb">AL</country><country mxw-id="DS660611808" load-source="docdb">AT</country><country mxw-id="DS660687815" load-source="docdb">BE</country><country mxw-id="DS660689382" load-source="docdb">BG</country><country mxw-id="DS660687507" load-source="docdb">CH</country><country mxw-id="DS660612274" load-source="docdb">CY</country><country mxw-id="DS660611809" load-source="docdb">CZ</country><country mxw-id="DS660695106" load-source="docdb">DE</country><country mxw-id="DS660687816" load-source="docdb">DK</country><country mxw-id="DS660612279" load-source="docdb">EE</country><country mxw-id="DS660783989" load-source="docdb">ES</country><country mxw-id="DS660689387" load-source="docdb">FI</country><country mxw-id="DS660689388" load-source="docdb">FR</country><country mxw-id="DS660695111" load-source="docdb">GB</country><country mxw-id="DS660687817" load-source="docdb">GR</country><country mxw-id="DS660687818" load-source="docdb">HR</country><country mxw-id="DS660612280" load-source="docdb">HU</country><country mxw-id="DS660687508" load-source="docdb">IE</country><country mxw-id="DS660687835" load-source="docdb">IS</country><country mxw-id="DS660689389" load-source="docdb">IT</country><country mxw-id="DS660687836" load-source="docdb">LI</country><country mxw-id="DS660695112" load-source="docdb">LT</country><country mxw-id="DS660611810" load-source="docdb">LU</country><country mxw-id="DS660695113" load-source="docdb">LV</country><country mxw-id="DS660695114" load-source="docdb">MC</country><country mxw-id="DS660611815" load-source="docdb">MK</country><country mxw-id="DS660611816" load-source="docdb">MT</country><country mxw-id="DS660689390" load-source="docdb">NL</country><country mxw-id="DS660687509" load-source="docdb">NO</country><country mxw-id="DS660689395" load-source="docdb">PL</country><country mxw-id="DS660783990" load-source="docdb">PT</country><country mxw-id="DS660689396" load-source="docdb">RO</country><country mxw-id="DS660783991" load-source="docdb">RS</country><country mxw-id="DS660689397" load-source="docdb">SE</country><country mxw-id="DS660607605" load-source="docdb">SI</country><country mxw-id="DS660687510" load-source="docdb">SK</country><country mxw-id="DS660687515" load-source="docdb">SM</country><country mxw-id="DS660687837" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA166479944" lang="EN" load-source="patent-office"><p id="pa01" num="0001">A switch relating to this embodiment includes: a first applying unit that applies a setting of a virtual subnetwork to a first port that is connected to an external apparatus, upon detecting an instruction to apply the setting to the first port; and a second applying unit that applies, upon detecting that the setting was applied to the first port in the switch or other switches, the setting to a second port that is connected to an external network and is associated with the first port in advance.<img id="iaf01" file="imgaf001.tif" wi="145" he="110" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA166759756" lang="EN" source="EPO" load-source="docdb"><p>A switch relating to this embodiment includes: a first applying unit that applies a setting of a virtual subnetwork to a first port that is connected to an external apparatus, upon detecting an instruction to apply the setting to the first port; and a second applying unit that applies, upon detecting that the setting was applied to the first port in the switch or other switches, the setting to a second port that is connected to an external network and is associated with the first port in advance.</p></abstract><description mxw-id="PDES98404645" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001">Technical Field</heading><p id="p0001" num="0001">This technique relates to a technique for setting switches automatically.</p><heading id="h0002">Background Technology</heading><p id="p0002" num="0002">Systems in data centers or companies have been integrated by cloud migration recently. As described in <figref idrefs="f0001">FIG. 1</figref>, a cloud system includes virtualized servers (or storages) and network switches connecting them (hereinafter, abbreviated to switches), and is often connected to a core network (a router, a L3 (Layer 3) switch, and the like. It is also called an external network that is different from a network including switches) through the switches.</p><p id="p0003" num="0003">As servers are virtualized and comprehensively managed in configuration of such a cloud system, efficiency of operation is sometimes improved by virtually unifying plural switches into one and unifying control and management of plural routes.</p><p id="p0004" num="0004">Here, a switch side provides networks used by each VM (Virtual Machine) as communication environment of layer 2, because VMs that operate on servers in virtual environment are ordinarily interconnected by layer 2. Moreover, it is general to provide layer 2 communication environment among VMs by using VLAN (Virtual Local Area Network) or the like, because the networks used by each VM (a broadcast range of layer 2) are different from each other.</p><p id="p0005" num="0005">In present server virtualizing systems, there are several methods that define a VLAN between a server and a port of a switch that is directly connected to the server, and a VLAN definition in a boundary point between the server and the port is automatically or manually set according to a state of a VM that is used.</p><p id="p0006" num="0006">On the other hand, when servers communicate with external networks through a core network, a setting of the same VLAN as a VLAN that has been defined for ports of switches that are directly connected to the servers is applied to ports of switches that are connected to the core network. However, there is no proper method for setting a VLAN like this automatically.<!-- EPO <DP n="2"> --></p><heading id="h0003">Prior technical documents</heading><heading id="h0004">Patent Documents</heading><p id="p0007" num="0007"><ul><li>Patent Document 1: <patcit id="pcit0001" dnum="JP9284328A"><text>Japanese Laid-open Patent Publication No. 09-284328</text></patcit></li><li>Patent Document 2: <patcit id="pcit0002" dnum="JP9284329A"><text>Japanese Laid-open Patent Publication No. 09-284329</text></patcit></li></ul></p><heading id="h0005">Summary of the Invention</heading><heading id="h0006">Object to be solved by the Invention</heading><p id="p0008" num="0008">Therefore, an object of this technique is, as one aspect, to provide a technique for applying a setting of a virtual subnetwork to switches between external apparatuses and an external network automatically.</p><heading id="h0007">Means for solving the Problem</heading><p id="p0009" num="0009">A switch relating to this technique includes: a memory; and a processor configured to use the memory and execute a process. And the process includes: first applying a setting of a virtual subnetwork to a first port that is connected to an external apparatus, upon detecting an instruction to apply the setting to the first port; and upon detecting that the setting was applied to the first port in the switch or other switches, second applying the setting to a second port that is connected to an external network and is associated with the first port in advance.</p><heading id="h0008">Brief description of the drawings</heading><p id="p0010" num="0010"><ul><li><figref idrefs="f0001">FIG. 1</figref> is a diagram for explaining a relationship among a core network, switches, and external apparatuses such as servers or the like;</li><li><figref idrefs="f0002">FIG. 2</figref> is a diagram for explaining an outline of this embodiment;</li><li><figref idrefs="f0003">FIG. 3</figref> is a diagram depicting an example of configuration of a switch relating to this embodiment;</li><li><figref idrefs="f0003">FIG. 4</figref> is a diagram depicting an example of a port information table;</li><li><figref idrefs="f0004">FIG. 5</figref> is a diagram depicting an example of a VLAN cooperation table;</li><li><figref idrefs="f0005">FIG. 6</figref> is a diagram depicting a processing flow performed<!-- EPO <DP n="3"> --> when defining a VLAN;</li><li><figref idrefs="f0006">FIG. 7</figref> is a diagram depicting a processing flow performed when receiving a VLAN definition cooperation notification;</li><li><figref idrefs="f0004">FIG. 8</figref> is a diagram depicting a processing flow performed when receiving the VLAN definition cooperation notification;</li><li><figref idrefs="f0007">FIG. 9</figref> is a diagram depicting a processing flow performed when deleting the VLAN definition;</li><li><figref idrefs="f0008">FIG. 10</figref> is a diagram depicting a processing flow performed when receiving a VLAN deletion cooperation notification;</li><li><figref idrefs="f0009">FIG. 11</figref> is a diagram depicting a processing flow performed when receiving the VLAN deletion cooperation notification; and</li><li><figref idrefs="f0010">FIG. 12</figref> is a functional block diagram representing a case such that a switch is implemented by a computer.</li></ul></p><heading id="h0009">Mode for carrying out the invention</heading><p id="p0011" num="0011">By using <figref idrefs="f0002">FIG. 2</figref>, an example of a network relating to this embodiment will be explained. In this embodiment, a network including switches 1 to 6 is set up between a core network and external apparatuses such as servers and storages. The switches 1 and 2 include a port connected to the core network (hereinafter referred to as a Network Port) and a port connected to other switches (hereinafter referred to an Inner Port). On the other hand, the switches 3 to 6 include a port connected to the external apparatuses such as servers (hereinafter referred to as an End Port) and the inner port connected to other switches.</p><p id="p0012" num="0012">In this embodiment, a VLAN definition that has been set for end ports of the switches 3 and 4 in <figref idrefs="f0002">FIG. 2</figref> is reflected to a network port of the switch 1 connected to the core network. In other words, the VLAN definition is reflected by defining the end ports and the network port surrounded by a dotted line A as one group A. On the other hand, a VLAN definition that has been set for end ports of the switches 5 and 6 is reflected to a network port of the switch 2 connected to the core network. In other words, the VLAN definition is reflected by defining the end ports and the network port surrounded by a dotted line B as one group B. An end port and a network port sometimes belong to plural groups. By defining such groups, it becomes possible to control a range to which a VLAN definition is reflected.</p><p id="p0013" num="0013">In this embodiment, the VLAN definition that has been set in the end ports is also reflected to inner ports. This is because<!-- EPO <DP n="4"> --> Ethernet (a registered trademark) frames of each VLAN are exchanged through the inner ports among switches 1 to 6.</p><p id="p0014" num="0014">Next, <figref idrefs="f0003">FIG. 3</figref> illustrates a functional block diagram of a switch relating to this embodiment. A switch 100 includes a controller 110, a memory 120, a switch hardware 130, and ports 1 to n. The controller 110 controls the whole switch 100 including the switch hardware 130, and includes a first setting processing unit 111 that changes settings of VLAN definitions for end ports of the switch 100 and that notifies the switch 100 and other switches, and a second setting processing unit 112 that changes settings of VLAN definitions for ports other than the end ports according to the notification from the switch 100 or other switches. The controller 110 is realized by, for example, a combination of a processor and programs. In this case, the programs stored in the memory 120 or other ROM (Read Only Memories) are executed by the processor and the controller 110 is realized. The memory 120 stores data used in processing executed by the controller 110.</p><p id="p0015" num="0015">The switch hardware 130 is a semiconductor apparatus that relays frames among ports. The switch 100 is called a Fabric switch, and may be a switch that can use plural lines as redundant routes by logically unifying plural switches of the same kinds into one switch and exchanging conditions inside. In this case, the switch hardware 130 has a function that communicates with other Fabric switches by an original format of the switch hardware 130. The ports 1 to n are connected with cables that connect other Fabric switches, external networks, servers, and the like.</p><p id="p0016" num="0016">Moreover, a port information table and a VLAN cooperation table are stored in the memory 120. <figref idrefs="f0003">FIG. 4</figref> illustrates an example of the port information table. In the example of <figref idrefs="f0003">FIG. 4</figref>, a port type (End Port / Network Port / Inner Port) and a group number list, which is a list of group numbers are registered in association with a port number. As described above, in <figref idrefs="f0003">FIG. 4</figref>, a port whose port number is 3 belongs to both the group 1 and the group 2. On the other hand, a port whose port number is 1 and a port whose port number is 2 belong to the group 1 and the group 2, respectively. A user is able to set the port type and the group number list. For example, the user sets them by using a conventional setting interface for switch such as CLI (Command Line Interface), Web, or the like.</p><p id="p0017" num="0017">Moreover, <figref idrefs="f0004">FIG. 5</figref> illustrates an example of the VLAN cooperation table. In the example of <figref idrefs="f0004">FIG. 5</figref>, a VLAN ID, a cooperation possibility<!-- EPO <DP n="5"> --> flag, and a setting counter are registered in association with a port number. As for a combination of the VLAN ID and the cooperation possibility flag, a user sets, for each port, for all possible combinations in advance. The cooperation possibility flag is a flag that represents whether cooperative processing for reflecting the VLAN definition to other switches when a VLAN is defined is performed or not. Moreover, an initial value of the setting counter is 0.</p><p id="p0018" num="0018">Moreover, each switch 100 maintains address information of other switches (or the address information is defined in advance) to communicate with other switches. Moreover, when so-called Fabric that operates as one logical switch as a whole is provided as the switches 1 to 6 in <figref idrefs="f0002">FIG. 2</figref>, notification as described below may be used by using inner communication for Fabric configuration.</p><p id="p0019" num="0019">Next, by using <figref idrefs="f0004 f0005 f0006 f0007 f0008 f0009">FIGs. 6 to 11</figref>, operation of the switch 100 will be explained. First, by using <figref idrefs="f0005">FIG. 6</figref>, processing of the first setting processing unit 111, which is performed when a VLAN is defined, will be explained.</p><p id="p0020" num="0020">The first setting processing unit 111 accepts a setting instruction of VLAN for a specific port through a predetermined interface (<figref idrefs="f0005">FIG. 6</figref>: step S1). The setting instruction of VLAN includes a VLAN ID of a VLAN to be defined.</p><p id="p0021" num="0021">Then, the first setting processing unit 111 applies a setting of a VLAN to the specif ic port, for example, through the switch hardware 130 (step S3). For example, the VLAN ID is registered.</p><p id="p0022" num="0022">Moreover, the first setting processing unit 111 searches the port information table by the port number of the specific port for which the VLAN has been set, and determines whether the specific port is an end port or not (step S5) . When it is determined that the specific port is not end port, the processing ends because the VLAN definition is not reflected to other ports and other switches.</p><p id="p0023" num="0023">On the other hand, when the specific port is an end port, the first setting processing unit 111 determines whether "cooperation possible" is set for a combination of the specific port for which the VLAN has been set and the set VLAN ID in the VLAN cooperation table (step S7). It is determined whether the cooperation possibility flag represents that it is possible to cooperate or not. When it is determined that it is impossible to cooperate, the processing ends.</p><p id="p0024" num="0024">On the other hand, when it is determined that "cooperation possible" is set for the combination, the first setting processing<!-- EPO <DP n="6"> --> unit 111 reads out a group number list of the specific port for which VLAN has been set from the port information table (step S9). Furthermore, the first setting processing unit 111 generates VLAN definition cooperation notification including the VLAN ID and the group number list that has been read out, and transmits it to the second setting processing unit 112 of the switch 100 and other switches (step S11). Then, the processing ends.</p><p id="p0025" num="0025">Thus, the first setting processing unit 111 sets the VLAN definition that has been instructed for the specific port, and notifies the VLAN definition to be reflected to other switches.</p><p id="p0026" num="0026">Next, by using <figref idrefs="f0006">FIGs. 7</figref> and <figref idrefs="f0004">8</figref>, processing performed by the second setting processing unit 112 that has received the VLAN definition cooperation notification will be explained. A port that has received the VLAN definition cooperation notification from other switches outputs the VLAN definition cooperation notification to the second setting processing unit 112 through the switch hardware 130, for example.</p><p id="p0027" num="0027">When the second setting processing unit 112 receives the VLAN definition cooperation notification (<figref idrefs="f0006">FIG. 7</figref>: step S21), the second setting processing unit 112 determines whether there is an entry whose port type is Network Port, which is associated with the same group number as group number of the group number list that has been notified in the port information table (step S23). In the example of <figref idrefs="f0003">FIG. 4</figref>, an entry of a port whose port number is "3" is applicable when group number "1" is included in the group number list.</p><p id="p0028" num="0028">When it is determined that there is no entry satisfying the condition of the step S23, the second setting processing unit 112 determines whether there is an entry whose port type is Inner Port in the port information table (step S25). In the example of <figref idrefs="f0003">FIG. 4</figref>, an entry of a port whose port number is "4" satisfies the condition. If there is no inner port, the processing ends through a terminal A.</p><p id="p0029" num="0029">On the other hand, when it is determined that there is an entry satisfying the conditions of the step S23 or the step S25, the second setting processing unit 112 identifies a port of an unprocessed entry satisfying the conditions of the step S23 or the step S25, and determines whether a value of a setting counter of an entry, which has a port number of the identified port and the notified VLAN ID, is 0 in the VLAN cooperation table (step S27).<!-- EPO <DP n="7"> --></p><p id="p0030" num="0030">In the example of the network illustrated in <figref idrefs="f0002">FIG. 2</figref>, although four end ports of the switches 3 and 4 are included in the group A, there's a possibility that VLAN definitions is to be set for each end port of these end ports. In other words, since the same VLAN ID is sometimes set for each end port of these end ports, counting how many times the VLAN ID is set for each combination of the port and the VLAN ID is performed by using the setting counter, and later it can be determined whether the VLAN should be defined for the ports or not.</p><p id="p0031" num="0031">The VLAN has not been set for the identified port yet when a value of the setting counter is 0. Therefore, the second setting processing unit 112 applies a VLAN of the notified VLAN ID to the identified port through the switch hardware 130 (step S29). Then, the processing shifts to the step S31.</p><p id="p0032" num="0032">On the other hand, the VLAN has already been set when a value of the setting counter is not 0. Therefore, the processing shifts to the step S31, and the second setting processing unit 112 increments the value of the setting counter for the identified port by 1 (step S31) . Then, the processing shifts to the processing of <figref idrefs="f0004">FIG. 8</figref> through a terminal B.</p><p id="p0033" num="0033">Shifting to the explanation of the processing of <figref idrefs="f0004">FIG. 8</figref>, the second setting processing unit 112 determines whether there is an unprocessed entry whose port type is Network Port, which is associated with the same group number as group number of the group number list that has been notified in the port information table (step S33) . For example, entries satisfying the condition of the step S23 are extracted, and it may be determined whether there is an unprocessed entry by processing a list of the entries in order. When it is determined that there is an unprocessed entry satisfying the condition of the step S33, the processing returns to the step S27 through a terminal C.</p><p id="p0034" num="0034">On the other hand, when it is determined that there is no unprocessed entry satisfying the condition of the step S33 , the second setting processing unit 112 determines whether there is an unprocessed entry whose port type is Inner Port in the port information table (step S35). For example, if the processing does not go through the step S25, when the step S35 is executed at first, entries whose port type is Inner Port are extracted, and a list of the entries are processed in order.</p><p id="p0035" num="0035">When it is determined that there is an unprocessed entry<!-- EPO <DP n="8"> --> satisfying the condition of the step S35, the processing returns to the step S27 through the terminal C. On the other hand, when it is determined that there is no unprocessed entry satisfying the condition of the step S35, the processing ends.</p><p id="p0036" num="0036">By executing the processing as described above, a VLAN definition is automatically set for network ports and inner ports. Moreover, by counting how many times the same VLAN definition is set for each combination of a port and a VLAN ID, it can be prevented that the VLAN definition is carelessly removed.</p><p id="p0037" num="0037">Next, by using <figref idrefs="f0007 f0008 f0009">FIGs. 9 to 11</figref>, processing performed when deletion of a VLAN definition is instructed will be explained.</p><p id="p0038" num="0038">The first setting processing unit 111 accepts a deletion instruction of a VLAN definition for a specific port through a predetermined interface (<figref idrefs="f0007">FIG. 9</figref>: step S41) . The deletion instruction of the VLAN definition includes a VLAN ID, which relates to the VLAN definition to be deleted.</p><p id="p0039" num="0039">Then, the first setting processing unit 111 deletes the VLAN definition of the specific port, for example, through the switch hardware 130 (step S43). For example, the VLAN ID is deleted.</p><p id="p0040" num="0040">Moreover, the first setting processing unit 111 searches the port information table by the port number of the specific port of which the VLAN definition is deleted, and determines whether the specific port is an end port or not (step S45) . When it is determined that the specific port is not an end port, the processing ends since the VLAN definition is not reflected to other ports and other switches.</p><p id="p0041" num="0041">On the other hand, when it is determined that the specific port is an end point, the first setting processing unit 111 determines whether "cooperation possible" is set for a combination of the specific port of which the VLAN definition is deleted and the VLAN ID which has been set in the VLAN cooperation table (step S47). The cooperation possibility flag represents that it is possible to cooperate or not. When it is determined that it is not possible to cooperate, the processing ends.</p><p id="p0042" num="0042">On the other hand, when it is determined that "cooperation possible" is set for the combination, the first setting processing unit 111 reads out, from the port information table, a group number list of the specific port of which the VLAN definition is deleted (step S49). Furthermore, the first setting processing unit 111 generates VLAN deletion cooperation notification including the VLAN<!-- EPO <DP n="9"> --> ID and the group number list that has been read out, and transmits it to the second setting processing unit 112 of the switch 100 and other switches (step S51). Then, the processing ends.</p><p id="p0043" num="0043">Thus, the first setting processing unit 111 deletes the VLAN definition according to the instruction, and notifies other switches that the deletion of VLAN definition to be reflected.</p><p id="p0044" num="0044">Next, by using <figref idrefs="f0008 f0009">FIGs. 10 to 11</figref>, processing performed by the second setting processing unit 112 that has received the VLAN deletion cooperation notification will be explained. A port that has received the VLAN deletion cooperation notification from other switches outputs the VLAN deletion cooperation notification to the second setting processing unit 112, for example, through the switch hardware 130.</p><p id="p0045" num="0045">When the second setting processing unit 112 receives the VLAN deletion cooperation notification (<figref idrefs="f0008">FIG. 10</figref>: step S61), the second setting processing unit 112 determines whether there is an entry whose port type is Network Port, which is associated with the same group number as group number of the group number list that has been notified in the port information table (step S63) . This condition is the same as that of the step S23.</p><p id="p0046" num="0046">When it is determined that there is no entry satisfying the condition of the step S63, the second setting processing unit 112 determines whether there is an entry whose port type is Inner Port in the port information table (step S65) . This condition is also the same as that of the step S25. If there is no inner port, the processing ends through a terminal D.</p><p id="p0047" num="0047">On the other hand, when it is determined that there is an entry satisfying the conditions of the step S63 or the step S65, the second setting processing unit 112 identifies an unprocessed port of an entry satisfying the conditions of the step S63 or the step S65, and determines whether a value of a setting counter of an entry, which has the port number of the identified port and the notified VLAN ID, is 1 in the VLAN cooperation table (step S67).</p><p id="p0048" num="0048">In the example of the network illustrated in <figref idrefs="f0002">FIG. 2</figref>, four end ports are included in the switches 3 and 4 in the group A, and there's a possibility that VLAN definitions is to be set for each end port of these end ports. Moreover, there's a possibility that the VLAN definition of each end port of these end ports is to be deleted. Therefore, if a VLAN definition of a network port is deleted when a VLAN ID of an end port is deleted, VLAN definitions of the same<!-- EPO <DP n="10"> --> VLAN ID, which has been set for other end ports, are deleted in the network port. Then, it becomes impossible for external apparatuses relating to other end ports to properly communicate with apparatuses in the core network side.</p><p id="p0049" num="0049">Therefore, in this embodiment, it may be checked that there are no other end ports using this VLAN definition at the step S67 since a value of a setting counter, which is 1, represents that there are no other end ports using this VLAN definition.</p><p id="p0050" num="0050">When a value of a setting counter is 1, there is no problem even if a VLAN definition is deleted. Therefore, the second setting processing unit 112 deletes the VLAN definition of the VLAN ID that has been notified for the identified port (step S69). Then, the processing shifts to the step S71.</p><p id="p0051" num="0051">On the other hand, when the value of the setting counter is not 1, the VLAN definition has not been deleted yet. Therefore, the processing shifts to the step S71, and the second setting processing unit 112 decrements the value of the setting counter for the identified port by 1 (step S71). Then, the processing shifts to the processing of <figref idrefs="f0009">FIG. 11</figref> through a terminal E.</p><p id="p0052" num="0052">Shifting to the explanation of the processing of <figref idrefs="f0009">FIG. 11</figref>, the second setting processing unit 112 determines whether there is an unprocessed entry whose port type is Network Port, which is associated with the same group number as group number of the group number list that has been notified in the port information table (step S73) . For example, entries satisfying the condition of the step S63 are extracted, and it maybe determined whether there is an unprocessed entry or not by processing a list of the entries in order. When it is determined that there is an unprocessed entry satisfying the condition of the step S63, the processing returns to the step S67 through a terminal F.</p><p id="p0053" num="0053">On the other hand, when it is determined that there is no unprocessed entry satisfying the condition of the step S63 , the second setting processing unit 112 determines whether there is an unprocessed entry whose port type is Inner Port in the port information table (step S75). For example, if the processing does not go through the step S65, when the step S75 is executed at first, entries whose port type is Inner Port are extracted, and a list of the entries are processed in order.</p><p id="p0054" num="0054">When it is determined that there is an unprocessed entry<!-- EPO <DP n="11"> --> satisfying the condition of the step S75, the processing returns to the step S67 through the terminal F. On the other hand, when it is determined that there is no unprocessed entry satisfying the condition of the step S75, the processing ends.</p><p id="p0055" num="0055">In a server peripheral network (and a network of a general server system) established in a data center, it is difficult for server managers who carry out setting for servers to carry out both setting for servers and setting for networks, and a demand for automating network configuration has increased. For this situation, there's attention to the matter that a network switch is allocated between external apparatuses such as servers or storages and a core network in network environment deployed on the preceding stage of servers in the data center. And it is possible to simplify network settings by automatically reflecting VLAN definitions of ports of external apparatuses side to ports connected to the core network side.</p><p id="p0056" num="0056">Moreover, unnecessary settings of VLAN definitions are never applied to the ports of the core network side by reflecting only VLAN settings of the external apparatuses side. Therefore, it is possible to prevent unnecessary traffic from flowing from the core network and to realize improvement of security. Moreover, even if plural external apparatuses belong to the same VLAN, it becomes possible to avoid the situation such that unnecessary deletion is performed and the communication stops when VLAN definitions are deleted, by preparing a setting counter of a VLAN definition for a port of the core network side.</p><p id="p0057" num="0057">Although the embodiment of this technique was explained above, this technique is not limited to those. For example, as for the processing flow, as long as the processing results do not change, the turns of the steps may be exchanged or the steps may be executed in parallel. Moreover, the functional block diagram of <figref idrefs="f0003">FIG. 3</figref> is an example, and the configuration in the functional block diagram does not always correspond to actual program module configuration and hardware configuration.</p><p id="p0058" num="0058">Moreover, the aforementioned switch 100 sometimes has configuration such that a memory 2601, a CPU 2603, a hard disk drive (HDD) 2605, a display controller 2607 connected to a display device 2609, a drive device 2613 for a removable disk 2611, an input unit 2615, and communication controllers 2617 (In <figref idrefs="f0010">FIG. 12</figref>, 2617a to 2617c) for connection with a network are connected through a bus 2619 as<!-- EPO <DP n="12"> --> shown in <figref idrefs="f0010">FIG. 12</figref>. In some case, the display controller 2607, the display device 2609, the drive device 2613 and the input unit 2615 are not included. An operating system (OS: Operating System) and an application program for carrying out the foregoing processing in the embodiment, are stored in the HDD 2605, and when executed by the CPU 2603, they are read out from the HDD 2605 to the memory 2601. The CPU 2603 controls the display controller 2607, the communication controllers 2617, and the drive device 2613 as necessary, and causes them to perform necessary operations. Data that is input through any one of the communication controllers 2617 is output through another communication controller 2617. The CPU 2603 controls the communication controllers 2617, and properly switches the output destination. Besides, intermediate processing data is stored in the memory 2601, and if necessary, it is stored in the HDD 2605. In this embodiment of this technique, the application program to realize the aforementioned functions is stored in the computer-readable, non-transitory removable disk 2611 and distributed, and then it is installed into the HDD 2605 from the drive device 2613. It may be installed into the HDD 2605 via the network such as the Internet and the communication controller 2617. In the computer as stated above, the hardware such as the CPU 2603 and the memory 2601, the OS and the necessary application programs systematically cooperate with each other, so that various functions as described above in details are realized.</p><p id="p0059" num="0059">The aforementioned embodiment is summarized as follows:</p><p id="p0060" num="0060">A switch relating to this technique includes: a first applying unit that applies a setting of a virtual subnetwork to a first port that is connected to an external apparatus, upon detecting an instruction to apply the setting to the first port; and a second applying unit that applies, upon detecting that the setting was applied to the first port in the switch or other switches, the setting to a second port that is connected to an external network and is associated with the first port in advance.</p><p id="p0061" num="0061">By this means, the setting of the virtual subnetwork for the first port connected to the external apparatus is automatically reflected to the second port connected to the external network.</p><p id="p0062" num="0062">Moreover, the second applying unit may count, in association with an identifier of a port and an identifier of a virtual subnetwork, a number of times that a setting of the virtual subnetwork was applied to the first port that is associated with the port and is in the switch<!-- EPO <DP n="13"> --> or the other switches; and apply, upon detecting that a number of times for the second port is zero, the setting to the second port. By this means, the setting is properly removed (deleted) by counting how many times the setting has been applied, because the same setting of the virtual subnetwork can be applied to plural first port which are associated.</p><p id="p0063" num="0063">Furthermore, the first applying unit may transmit a notification including an identifier of a group of ports associated with the first port and an identifier of the virtual subnetwork to the second applying unit and the other switches. In this case, the second applying unit may apply the setting to the second port upon detecting the notification. By this means, the association can be flexibly performed.</p><p id="p0064" num="0064">Furthermore, the second applying unit may apply the setting to ports other than the first port and the second port. This is because the setting of the virtual subnetwork is used for relaying frames among switches.</p><p id="p0065" num="0065">Moreover, first applying unit may include a first removing unit that removes the setting of the virtual subnetwork applied to the first port, upon detecting an instruction to remove the setting applied to the first port. In this case, the second applying unit may include a second removing unit that removes, upon detecting that the setting applied to the first port that is associated with the second port was removed, the setting applied to the second port. Thus, removal of the setting of the virtual subnetwork applied to the first port connected to the external apparatus is automatically reflected to the second port connected to the external network.</p><p id="p0066" num="0066">Furthermore, the second removing unit may count, in association with an identifier of a port and an identifier of a virtual subnetwork, a number of times that a setting of the virtual subnetwork was applied to the first port that is associated with the port and is in the switch or the other switches; and remove, upon detecting that a number of times for the second port is zero, the setting applied to the second port. When it is confirmed that the setting of other first ports are not left, it becomes possible to remove the setting of the second port associated with the first ports.</p><p id="p0067" num="0067">Furthermore, the first removing unit may transmit a notification including an identifier of a group of ports associated with the first port and an identifier of a virtual subnetwork to the<!-- EPO <DP n="14"> --> switch and the other switches. And the second removing unit may execute processing related to removal of the setting in response to the notification. By this means, the setting is properly removed.</p><p id="p0068" num="0068">Furthermore, the second removing unit may remove the setting for ports other than the first port and the second port.</p><p id="p0069" num="0069">Moreover, the first applying unit may apply the setting to the first port, upon detecting that cooperation of settings of virtual subnetworks is set for a combination of an identifier of the virtual subnetwork and the first port. It becomes possible to flexibly reflect the setting.</p></description><claims mxw-id="PCLM90459586" lang="EN" load-source="patent-office"><!-- EPO <DP n="15"> --><claim id="c-en-0001" num="0001"><claim-text>A switch, comprising:
<claim-text>a memory; and</claim-text>
<claim-text>a processor conf igured to use the memory and execute a process, the process comprising:
<claim-text>first applying a setting of a virtual subnetwork to a first port that is connected to an external apparatus, upon detecting an instruction to apply the setting to the first port; and</claim-text>
<claim-text>upon detecting that the setting was applied to the first port in the switch or other switches, second applying the setting to a second port that is connected to an external network and is associated with the first port in advance.</claim-text></claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The switch as set forth in claim 1, wherein the second applying comprises:
<claim-text>counting, in association with an identifier of a port and an identifier of a virtual subnetwork, a number of times that a setting of the virtual subnetwork was applied to the first port that is associated with the port and is in the switch or the other switches; and</claim-text>
<claim-text>upon detecting that a number of times for the second port is zero, applying the setting to the second port.</claim-text></claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The switch as set forth in claim 1, wherein the first applying comprises:
<claim-text>transmitting a notification including an identifier of a group of ports associated with the first port and an identifier of the virtual subnetwork to the switch and the other switches, and</claim-text>
<claim-text>the second applying comprises:
<claim-text>applying the setting to the second port upon detecting the notification.</claim-text></claim-text></claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>The switch as set forth in claim 1, wherein the second applying comprises:
<claim-text>applying the setting to ports other than the first port and the second port.</claim-text><!-- EPO <DP n="16"> --></claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>The switch as set forth in claim 1, wherein the first applying comprises:
<claim-text>first removing the setting of the virtual subnetwork applied to the first port, upon detecting an instruction to remove the setting applied to the first port, and</claim-text>
<claim-text>the second applying comprises:
<claim-text>upon detecting that the setting applied to the first port that is associated with the second port was removed, second removing the setting applied to the second port.</claim-text></claim-text></claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>The switch as set forth in claim 5, wherein the second removing comprises:
<claim-text>counting, in association with an identifier of a port and an identifier of a virtual subnetwork, a number of times that a setting of the virtual subnetwork was applied to the first port that is associated with the port and is in the switch or the other switches; and</claim-text>
<claim-text>upon detecting that a number of times for the second port is zero, removing the setting applied to the second port.</claim-text></claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>The switch as set forth in claim 5, wherein the first removing comprises:
<claim-text>transmitting a notification including an identifier of a group of ports associated with the first port and an identifier of a virtual subnetwork to the switch and the other switches, and</claim-text>
<claim-text>the second removing comprises:
<claim-text>executing processing related to removal of the setting in response to the notification.</claim-text></claim-text></claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>The switch as set forth in claim 5, wherein the second removing comprises:
<claim-text>removing the setting for ports other than the first port and the second port.</claim-text></claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>The switch as set forth in claim 1, wherein the first applying comprises:
<claim-text>applying the setting to the first port, upon detecting that cooperation of settings of virtual subnetworks is set for a combination of an identifier of the virtual subnetwork and the first port.</claim-text><!-- EPO <DP n="17"> --></claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>A program for causing a computer to execute a process comprising:
<claim-text>first applying a setting of a virtual subnetwork to a first port that is connected to an external apparatus, upon detecting an instruction to apply the setting to the first port; and</claim-text>
<claim-text>upon detecting that the setting was applied to the first port in the switch or other switches, second applying the setting to a second port that is connected to an external network and is associated with the first port in advance.</claim-text></claim-text></claim></claims><drawings mxw-id="PDW20422308" load-source="patent-office"><!-- EPO <DP n="18"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="162" he="188" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="19"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="165" he="203" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="20"> --><figure id="f0003" num="3,4"><img id="if0003" file="imgf0003.tif" wi="144" he="210" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="21"> --><figure id="f0004" num="5,8"><img id="if0004" file="imgf0004.tif" wi="160" he="210" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="22"> --><figure id="f0005" num="6"><img id="if0005" file="imgf0005.tif" wi="131" he="210" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="23"> --><figure id="f0006" num="7"><img id="if0006" file="imgf0006.tif" wi="131" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="24"> --><figure id="f0007" num="9"><img id="if0007" file="imgf0007.tif" wi="131" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="25"> --><figure id="f0008" num="10"><img id="if0008" file="imgf0008.tif" wi="131" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="26"> --><figure id="f0009" num="11"><img id="if0009" file="imgf0009.tif" wi="131" he="142" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="27"> --><figure id="f0010" num="12"><img id="if0010" file="imgf0010.tif" wi="143" he="233" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="165" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
