<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2961112-A1" country="EP" doc-number="2961112" kind="A1" date="20151230" family-id="48550132" file-reference-id="297135" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160451230" ucid="EP-2961112-A1"><document-id><country>EP</country><doc-number>2961112</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-13875436-A" is-representative="YES"><document-id mxw-id="PAPP193865428" load-source="patent-office" format="original"><country>EP</country><doc-number>13875436.1</doc-number><date>20130917</date><lang>ZH</lang></document-id><document-id mxw-id="PAPP193865429" load-source="docdb" format="epo"><country>EP</country><doc-number>13875436</doc-number><kind>A</kind><date>20130917</date><lang>ZH</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162036299" ucid="CN-2013083685-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>CN</country><doc-number>2013083685</doc-number><kind>W</kind><date>20130917</date></document-id></priority-claim><priority-claim mxw-id="PPC162035841" ucid="CN-201310055687-A" load-source="docdb"><document-id format="epo"><country>CN</country><doc-number>201310055687</doc-number><kind>A</kind><date>20130221</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1973198181" load-source="docdb">H04L  12/703       20130101AFI20160201BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1973198182" load-source="docdb">H04L  12/46        20060101ALI20160201BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1699660117" load-source="docdb" scheme="CPC">H04L  12/462       20130101 LI20180205BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1962083856" load-source="docdb" scheme="CPC">H04L  45/245       20130101 LI20160303BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1962087164" load-source="docdb" scheme="CPC">H04L  45/44        20130101 FI20160303BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165545156" lang="DE" load-source="patent-office">NACHRICHTENWEITERLEITUNGSSYSTEM, VERFAHREN UND VORRICHTUNG</invention-title><invention-title mxw-id="PT165545157" lang="EN" load-source="patent-office">MESSAGE FORWARDING SYSTEM, METHOD AND DEVICE</invention-title><invention-title mxw-id="PT165545158" lang="FR" load-source="patent-office">SYSTÈME, PROCÉDÉ ET DISPOSITIF DE TRANSFERT DE MESSAGE</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR1103326507" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ZTE CORP</last-name><address><country>CN</country></address></addressbook></applicant><applicant mxw-id="PPAR1103318911" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>ZTE CORPORATION</last-name></addressbook></applicant><applicant mxw-id="PPAR1101645722" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>ZTE Corporation</last-name><iid>101115168</iid><address><street>ZTE Plaza Keji Road South Hi-Tech Industrial Park Nanshan District</street><city>Shenzhen, Guangdong 518057</city><country>CN</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103315568" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>YE AO</last-name><address><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR1103327939" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>YE, Ao</last-name></addressbook></inventor><inventor mxw-id="PPAR1101646024" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>YE, Ao</last-name><address><street>ZTE Plaza Keji Road South Hi-Tech Industrial Park Nanshan District</street><city>Shenzhen Guangdong 518057</city><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR1103328052" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>YANG QI</last-name><address><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR1103315966" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>YANG, QI</last-name></addressbook></inventor><inventor mxw-id="PPAR1101649434" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>YANG, QI</last-name><address><street>ZTE Plaza Keji Road South Hi-Tech Industrial Park Nanshan District</street><city>Shenzhen Guangdong 518057</city><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR1103314286" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>ZHOU HAISHAN</last-name><address><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR1103304430" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>ZHOU, HAISHAN</last-name></addressbook></inventor><inventor mxw-id="PPAR1101646730" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>ZHOU, HAISHAN</last-name><address><street>ZTE Plaza Keji Road South Hi-Tech Industrial Park Nanshan District</street><city>Shenzhen Guangdong 518057</city><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR1103318843" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>HE QING</last-name><address><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR1103320070" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>HE, QING</last-name></addressbook></inventor><inventor mxw-id="PPAR1101648731" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>HE, QING</last-name><address><street>ZTE Plaza Keji Road South Hi-Tech Industrial Park Nanshan District</street><city>Shenzhen Guangdong 518057</city><country>CN</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR1101642085" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Deambrogi, Edgardo</last-name><suffix>et al</suffix><iid>100051714</iid><address><street>Jacobacci &amp; Partners S.p.A. Corso Emilia 8</street><city>10152 Torino</city><country>IT</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="CN-2013083685-W"><document-id><country>CN</country><doc-number>2013083685</doc-number><kind>W</kind><date>20130917</date><lang>ZH</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2014127629-A1"><document-id><country>WO</country><doc-number>2014127629</doc-number><kind>A1</kind><date>20140828</date><lang>ZH</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS660606887" load-source="docdb">AL</country><country mxw-id="DS660782287" load-source="docdb">AT</country><country mxw-id="DS660606889" load-source="docdb">BE</country><country mxw-id="DS660681691" load-source="docdb">BG</country><country mxw-id="DS660684279" load-source="docdb">CH</country><country mxw-id="DS660604113" load-source="docdb">CY</country><country mxw-id="DS660782288" load-source="docdb">CZ</country><country mxw-id="DS660606890" load-source="docdb">DE</country><country mxw-id="DS660604114" load-source="docdb">DK</country><country mxw-id="DS660604127" load-source="docdb">EE</country><country mxw-id="DS660681766" load-source="docdb">ES</country><country mxw-id="DS660681692" load-source="docdb">FI</country><country mxw-id="DS660681693" load-source="docdb">FR</country><country mxw-id="DS660606899" load-source="docdb">GB</country><country mxw-id="DS660604128" load-source="docdb">GR</country><country mxw-id="DS660606900" load-source="docdb">HR</country><country mxw-id="DS660782289" load-source="docdb">HU</country><country mxw-id="DS660684280" load-source="docdb">IE</country><country mxw-id="DS660604129" load-source="docdb">IS</country><country mxw-id="DS660681694" load-source="docdb">IT</country><country mxw-id="DS660604130" load-source="docdb">LI</country><country mxw-id="DS660607162" load-source="docdb">LT</country><country mxw-id="DS660782290" load-source="docdb">LU</country><country mxw-id="DS660607163" load-source="docdb">LV</country><country mxw-id="DS660607164" load-source="docdb">MC</country><country mxw-id="DS660682254" load-source="docdb">MK</country><country mxw-id="DS660682259" load-source="docdb">MT</country><country mxw-id="DS660782291" load-source="docdb">NL</country><country mxw-id="DS660606901" load-source="docdb">NO</country><country mxw-id="DS660604143" load-source="docdb">PL</country><country mxw-id="DS660607166" load-source="docdb">PT</country><country mxw-id="DS660782292" load-source="docdb">RO</country><country mxw-id="DS660607167" load-source="docdb">RS</country><country mxw-id="DS660604144" load-source="docdb">SE</country><country mxw-id="DS660607168" load-source="docdb">SI</country><country mxw-id="DS660606902" load-source="docdb">SK</country><country mxw-id="DS660604145" load-source="docdb">SM</country><country mxw-id="DS660682260" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA166479600" lang="EN" load-source="patent-office"><p id="pa01" num="0001">Provided are a system, a method and a device for forwarding a packet. The system comprises: an LCC comprising a first LCC's control ether switch unit and a second LCC's control ether switch unit, a first CFC comprising a first CFC's control ether switch unit, and a second CFC comprising a second CFC's control ether switch unit, wherein a control message channel and a protocol packet channel are separately arranged between the first and the second LCC's control ether switch units and the first and the second CFC's control ether switch units. Through the disclosure, the problem that the reliability and security of the cluster-based router may be reduced if the control message and the protocol packet are transmitted in the same channel in the related arts is solved, so as to achieve the effects of forwarding the control message and the protocol packet in a cluster-based router separately and enhancing the reliability and the security of the cluster-based router.<img id="iaf01" file="imgaf001.tif" wi="78" he="64" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA166759412" lang="EN" source="EPO" load-source="docdb"><p>Provided are a system, a method and a device for forwarding a packet. The system comprises: an LCC comprising a first LCC's control ether switch unit and a second LCC's control ether switch unit, a first CFC comprising a first CFC's control ether switch unit, and a second CFC comprising a second CFC's control ether switch unit, wherein a control message channel and a protocol packet channel are separately arranged between the first and the second LCC's control ether switch units and the first and the second CFC's control ether switch units. Through the disclosure, the problem that the reliability and security of the cluster-based router may be reduced if the control message and the protocol packet are transmitted in the same channel in the related arts is solved, so as to achieve the effects of forwarding the control message and the protocol packet in a cluster-based router separately and enhancing the reliability and the security of the cluster-based router.</p></abstract><description mxw-id="PDES98404301" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><b><u>Technical Field</u></b></heading><p id="p0001" num="0001">The disclosure relates to the field of communications, including a system, method and device for forwarding a packet.</p><heading id="h0002"><b><u>Background</u></b></heading><p id="p0002" num="0002">To meet the high-speed development of the Internet service and the mobile communications, an ultrahigh requirement is proposed on the capacity and the extensibility of the core router of the backbone network. For example, in the telecommunication process of the IP network, the ultrahigh requirement is proposed on the aspects such as, the capacity, security and reliability, multi-service bearing capacity of a high-end core router. The core router of the backbone network need to be of an excellent extensibility and upgrading capability to adapt to the trends of changeability and rapid development of the Internet. The network may be attacked to become paralyzed while bringing convenience to people. Because the TCP/IP for constructing the Internet lacks security, the network security becomes an actual problem having to be faced. The network may be attacked in various ways, including packet interception, IP address spoofing, source route attack, port scanning, Denial of Service (DoS) attack, application layer attack and the like; in addition, the reliability and the line security of the network are also an important problem.</p><p id="p0003" num="0003">A cluster-based router in the related arts has some problems: for example, all the packets in the cluster-based router are transmitted through a same channel, including a control message and a protocol packet. The control message is an internal control plane message of the cluster-based router and has a higher priority and a higher requirement on the transmission reliability than that of the protocol packet. With the wide application of the network, more protocol packets appear, and some attacked packets may enter into the<!-- EPO <DP n="2"> --> network due to the existence of network attack. Therefore, the number of the protocol packets may increase sharply, and the bandwidth of the control plane message may be occupied when the traffic of the protocol packets increases; accordingly, the control plane message may be congested or discarded, and the running of the whole system may be affected once one control plane message is discarded. Sometimes, there may be many control plane messages in the cluster-based router, which may affect the transmission of the protocol packet. Therefore, the reliability and security of the cluster-based router may be reduced when the control message and the protocol packet are transmitted in the same channel.</p><heading id="h0003"><b><u>Summary</u></b></heading><p id="p0004" num="0004">A system, a method and a device for forwarding a packet are provided, in order to at least solve the problem that the reliability and security of the cluster-based router may be reduced when a control message and a protocol packet are transmitted in a same channel in the related arts.</p><p id="p0005" num="0005">In one aspect, a system for forwarding a packet is provided, comprising: an LCC comprising a first LCC's control ether switch unit and a second LCC's control ether switch unit; a first CFC comprising a first CFC's control ether switch unit; and a second CFC comprising a second CFC's control ether switch unit, wherein a control message channel and a protocol packet channel are separately arranged between the first and the second LCC's control ether switch units and the first and the second CFC's control ether switch units.</p><p id="p0006" num="0006">In an example embodiment, separately arranging the control message channel and the protocol packet channel between the first and the second LCC's control ether switch units and the first and the second CFC's control ether switch units comprises: a link between the first LCC's control ether switch unit and the first CFC's control ether switch unit serving as a control message channel, and a link between the second LCC's control ether switch unit and the second CFC's control ether switch unit serving as a protocol packet channel; or,<!-- EPO <DP n="3"> --> a link between the first LCC's control ether switch unit and the second CFC's control ether switch unit serving as a control message channel, and a link between the second LCC's control ether switch unit and the first CFC's control ether switch unit serving as a protocol packet channel.</p><p id="p0007" num="0007">In an example embodiment, the system further comprises: a local exchange unit, coupled with the first LCC's control ether switch unit and the second LCC's control ether switch unit, and configured to exchange a control message and a protocol packet with the first LCC's control ether switch unit and the second LCC's control ether switch unit respectively.</p><p id="p0008" num="0008">In an example embodiment, the system further comprises: a Central Processing Unit,CPU, with two network cards, wherein the CPU is coupled with the local exchange unit, one of the two network cards is configured to exchange a control message with the local exchange unit, and the other one of the two network cards is configured to exchange a protocol packet with the local exchange unit.</p><p id="p0009" num="0009">According to the other aspect of the disclosure, a method for forwarding a packet is provided, comprising: determining a control message channel and a protocol packet channel which are separately arranged between first and second LCC's control ether switch units in an LCC, and first and second CFC's control ether switch units respectively in first and second CFCs; and transmitting a control message and a protocol packet respectively according to the determined control message channel and the determined protocol packet channel.</p><p id="p0010" num="0010">In an example embodiment, determining the control message channel and the protocol packet channel which are separately arranged between the first and second LCC's control ether switch units in the LCC, and the first and second CFC's control ether switch units respectively in the first and second CFCs comprises: stacking the first LCC's control ether switch unit with the second LCC's control ether switch unit, and stacking the first CFC's control ether switch unit with the second CFC's control ether switch unit, wherein port<!-- EPO <DP n="4"> --> information of ports for forming channels are synchronized between the stacked switch units; and determining the control message channel and the protocol packet channel by judging, via packet negotiations, whether the ports join a Link Aggregation Group,LAG.</p><p id="p0011" num="0011">In an example embodiment, before transmitting the control message and the protocol packet respectively according to the determined control message channel and the determined protocol packet channel, the method further comprises: allocating a load to each port belonging to the LAG for link aggregation between a local exchange unit and the first and second LCC's control ether switch units.</p><p id="p0012" num="0012">In an example embodiment, before transmitting the control message and the protocol packet respectively according to the determined control message channel and the determined protocol packet channel, the method further comprises: for a CPU with two network cards, configuring a number limit of received and/or sent packets of one network card for exchanging the control message with the local exchange unit to be higher than that of the other one network card for exchanging a protocol packet with the local exchange unit.</p><p id="p0013" num="0013">According to another aspect of the disclosure, a device for forwarding a packet is provided, comprising: a determining component, configured to determine a control message channel and a protocol packet channel which are separately arranged between first and second LCC's control ether switch units in an LCC and first and second CFC's control ether switch units respectively in first and second CFCs; and a transmitting component, configured to transmit a control message and a protocol packet respectively according to the determined control message channel and the determined protocol packet channel.</p><p id="p0014" num="0014">In an example embodiment, the determining component comprises: a stacking element, configured to stack the first LCC's control ether switch unit with the second LCC's control ether switch unit and the first CFC's control ether switch unit with the second CFC's control ether switch unit, wherein port<!-- EPO <DP n="5"> --> information of ports for forming channels are synchronized between the stacked switch units; and a determining element, configured to determine the control message channel and the protocol packet channel by judging, via packet negotiations, whether the ports join a Link Aggregation Group,LAG.</p><p id="p0015" num="0015">In an example embodiment, the device further comprises: an allocating element, configured to allocate a load to each port belonging to the LAG for link aggregation between a local exchange unit and the first and second LCC's control ether switch units.</p><p id="p0016" num="0016">In an example embodiment, the device further comprises: a configuring component, configured to, for a CPU with two network cards, configure a number limit of received and/or sent packets of one network card for exchanging the control message with the local exchange unit to be higher than that of the other one network card for exchanging the protocol packet with the local exchange unit.</p><p id="p0017" num="0017">Through the disclosure, due to the adoption of the LCC including the first LCC's control ether switch unit and the second LCC's control ether switch unit, the first CFC including the first CFC's control ether switch unit, and the second CFC including the second CFC's control ether switch unit, wherein a control message channel and a protocol packet channel are separately arranged between the first and the second LCC's control ether switch units and the first and the second CFC's control ether switch units, the problem that the reliability and security of the cluster-based router may be reduced when the control message and the protocol packet are transmitted in the same channel in the related arts is solved, so as to achieve the effects of forwarding the control message and the protocol packet in a cluster-based router separately and enhancing the reliability and the security of the cluster-based router.</p><heading id="h0004"><b><u>Brief Description of the Drawings</u></b></heading><p id="p0018" num="0018">The drawings illustrated here are to provide further understanding of the disclosure and constitute one part of the application, and the exemplary<!-- EPO <DP n="6"> --> embodiments of the disclosure and the explanations thereof are intended to explain the disclosure, instead of improperly limiting the disclosure. In the drawings:
<ul><li><figref idrefs="f0001">Fig. 1</figref> is a block diagram showing a structure of a system for forwarding a packet according to an embodiment of the disclosure;</li><li><figref idrefs="f0001">Fig. 2</figref> is a first block diagram showing an example structure of the system for forwarding the packet according to an embodiment of the disclosure;</li><li><figref idrefs="f0002">Fig. 3</figref> is a second block diagram showing an example structure of the system for forwarding the packet according to an embodiment of the disclosure;</li><li><figref idrefs="f0002">Fig. 4</figref> is a flowchart of a method for forwarding a packet according to an embodiment of the disclosure;</li><li><figref idrefs="f0003">Fig. 5</figref> is a block diagram showing a structure of a device for forwarding a packet according to an embodiment of the disclosure;</li><li><figref idrefs="f0003">Fig. 6</figref> is a first block diagram showing an example structure of the determining component 52 in the device for forwarding the packet according to an embodiment of the disclosure;</li><li><figref idrefs="f0004">Fig. 7</figref> is a first block diagram showing an example structure of the device for forwarding the packet according to an embodiment of the disclosure;</li><li><figref idrefs="f0004">Fig. 8</figref> is a second block diagram showing an example structure of the device for forwarding the packet according to an embodiment of the disclosure;</li><li><figref idrefs="f0005">Fig. 9</figref> is a diagram showing a structure of a system for separating a control message channel and a protocol packet channel according to an example embodiment of the disclosure;</li><li><figref idrefs="f0006">Fig. 10</figref> is a flowchart of a packet forwarding process according to an embodiment of the disclosure; and</li><li><figref idrefs="f0007">Fig. 11</figref> is a diagram showing a structure for separating the channels of a control message and a protocol packet after the link not forwarding any packet is removed according to an embodiment of the disclosure.</li></ul><!-- EPO <DP n="7"> --></p><heading id="h0005"><b><u>Detailed Description of the Embodiments</u></b></heading><p id="p0019" num="0019">The disclosure will be described below with reference to the drawings and in combination with the embodiments in detail. It should be noted that, in case of no conflict, the embodiments of the application and features therein can be combined with one another.</p><p id="p0020" num="0020">A system for forwarding a packet is provided in the embodiment of the disclosure, and <figref idrefs="f0001">Fig. 1</figref> is a block diagram showing a structure of a system for forwarding a packet according to an embodiment of the disclosure. As shown in <figref idrefs="f0001">Fig. 1</figref>, the system includes: an LCC 11 including a first LCC's control ether switch unit 31 and a second LCC's control ether switch unit 32, a first CFC 13 including a first CFC's control ether switch unit 21, and a second CFC 14 including a second CFC's control ether switch unit 22, wherein a control message channel and a protocol packet channel are separately arranged between the first and the second LCC's control ether switch units 31, 32 and the first and the second CFC's control ether switch units 21, 22.</p><p id="p0021" num="0021">According to the control message channels and the protocol packet channels which are separated in a cluster-based router, a control message and a protocol packet can be forwarded separately, thus, in comparison with the way of transmitting the control message and the protocol packet in a same channel in the related arts, the mutual influence between the transmission of the control message and the transmission of the protocol packet is avoided effectively; moreover, two corresponding switch units are arranged in the LCC and the CFCs so as to be favourable for the implementation of inter-backup function, that is to say, the reliability and security of the cluster-based router are improved to a certain extent.</p><p id="p0022" num="0022">It should be noted that the control message channel and the protocol packet channel can be separately arranged between the first and the second LCC's control ether switch units and the first and the second CFC's control ether switch units in various ways. For example, the first example combination way is: the link between the first LCC's control ether switch unit<!-- EPO <DP n="8"> --> and the first CFC's control ether switch unit is served as a control message channel, and the link between the second LCC's control ether switch unit and the second CFC's control ether switch unit is served as a protocol packet channel; or, the second example combination way is: the link between the first LCC's control ether switch unit and the second CFC's control ether switch unit is served as a control message channel, and the link between the second LCC's control ether switch unit and the first CFC's control ether switch unit is served as a protocol packet channel.</p><p id="p0023" num="0023"><figref idrefs="f0001">Fig. 2</figref> is a first block diagram showing an example structure of the system for forwarding the packet according to an embodiment of the disclosure. As shown in <figref idrefs="f0001">Fig. 2</figref>, besides all the structures in <figref idrefs="f0001">Fig. 1</figref>, the system further includes a local exchange unit 222, and the local exchange unit 222 is described below.</p><p id="p0024" num="0024">The local exchange unit 222 is coupled with the first LCC's control ether switch unit 31 and the second LCC's control ether switch unit 32 and is configured to exchange a control message and a protocol packet with the first LCC's control ether switch unit and the second LCC's control ether switch unit respectively. It should be noted that, in the system for separating the control message channel and the protocol packet channel, the link between the local exchange unit and the first and the second LCC's control ether switch units in the LCC can also be not separated but is processed separately, and in comparison with non-separation, this way not only can enable the control message channel and the protocol packet channel to be separated but also implement the benefits of avoiding the link redundancy and improving the bandwidth.</p><p id="p0025" num="0025"><figref idrefs="f0002">Fig. 3</figref> is a second block diagram showing an example structure of the system for forwarding the packet according to an embodiment of the disclosure. As shown in <figref idrefs="f0002">Fig. 3</figref>, besides all the structures in <figref idrefs="f0001">Fig. 2</figref>, the system further includes a CPU 32 with two network cards, and the CPU is described below.</p><p id="p0026" num="0026">The CPU 32 with two network cards is coupled with the local exchange unit, wherein one network card 1 is configured to exchange a control message<!-- EPO <DP n="9"> --> with the local exchange unit, and the other network card 2 is configured to exchange a protocol packet with the local exchange unit. Thus, not only the effect of separating the control message channel and the protocol packet channel is achieved, but also a basis is laid for the configuration of the control message channel and the protocol packet channel. For example, for the control message channel and the protocol packet channel which are separate, the number limit of the network card for receiving and transmitting the control message can be set to be higher than that of the network card for receiving and transmitting the protocol packet, thus, the reliability for receiving and transmitting the control messages can be protected to a certain extent.</p><p id="p0027" num="0027">A method for forwarding a packet is provided in the embodiment of the disclosure. <figref idrefs="f0002">Fig. 4</figref> is a flowchart of a method for forwarding a packet according to an embodiment of the disclosure. As shown in <figref idrefs="f0002">Fig. 4</figref>, the flow includes the following steps:
<ul><li>Step 402: A control message channel and a protocol packet channel which are separately arranged between first and second LCC's control ether switch units in an LCC and a first and second CFC's control ether switch units respectively in first and second CFCs are determined.</li><li>Step 404: A control message and a protocol packet are transmitted respectively according to the determined control message channel and the determined protocol packet channel.</li></ul></p><p id="p0028" num="0028">Through the step, the control message channel for transmitting the control message and the protocol packet channel for transmitting the protocol packet are separated, in comparison with the way of transmitting the control message and the protocol packet in a same channel in the related arts, not only the mutual influence between the transmission of the control message and the transmission of the protocol packet is avoided effectively but also the reliability and security of the cluster-based router are improved to a certain extent.</p><p id="p0029" num="0029">The control message channel and the protocol packet channel which are mutually separated can be determined in various ways. For example, in the<!-- EPO <DP n="10"> --> LCC including the first LCC's control ether switch unit and the second LCC's control ether switch unit, the first CFC including the first CFC's control ether switch unit, and the second CFC including the second CFC's control ether switch unit, the control message channel and the protocol packet channel which are separately arranged between the first and the second LCC's control ether switch units in the LCC and the first and the second CFC's control ether switch units respectively in the first and the second CFCs can be determined in the following ways: the first LCC's control ether switch unit and the second LCC's control ether switch unit are stacked, and the first CFC's control ether switch unit and the second CFC's control ether switch unit are stacked, wherein the port information of ports for forming the channels are synchronized between the stacked switch units, namely, the two stacked switch units can timely acquire the status information of the port of the opposite-end switch unit, thus the ports for forming the control message channel and the protocol packet channel are in an aggregation group; then, the control message channel and the protocol packet channel are determined by judging, via packet negotiation, whether the ports join the link aggregation group; in the determining process, a corresponding switch unit can be distinguished by the corresponding chassis number (the serial number of each CFC's control ether switch unit) and the corresponding slot number (the serial number of each LCC's control ether switch unit) of the corresponding switch unit carried in the packet, and whether the port coupled with the switch unit is joined the aggregation group is determined according to the serial number specified in the packet, and the ports not to be joined to the aggregation group are not used for forwarding the control message and the protocol packet, so that the links not for forwarding the control message and the protocol packet are removed, and it is determined that the links between the ports joining the aggregation group are the control message channel for transmitting the control message and the protocol packet channel for transmitting the protocol packet.</p><p id="p0030" num="0030">To enable the resources for transmitting packets to be reasonable, before<!-- EPO <DP n="11"> --> the control message and the protocol packet are transmitted according to the determined control message channel and the protocol packet channel, loads are allocated to each port belonging to the LAG for link aggregation between the local exchange unit and the first and the second LCC's control ether switch units; when a packet passes through the aggregation link, which port in the aggregation group the packet is transmitted from is determined according to a load sharing principle; and there may be various load sharing principles: for example, it can be determined according to a source Media Access Control (MAC) address; source and destination MAC addresses plus the address of a Virtual Local Area Network (VLAN); and source and destination IP addresses.</p><p id="p0031" num="0031">In order to control the bandwidth resources of the control message channel for transmitting the control message and the protocol packet channel for transmitting the protocol packet more effectively, the transmission bandwidth of the control message channel and the protocol packet channel can be configured before the control message and the protocol packet are transmitted according to the determined control message channel and the determined protocol packet channel. For example, in order to ensure the reliability of the control message channel to a certain extent, for a CPU with two network cards, the number limit of received and/or sent packets of one network card for exchanging the control message with the local exchange unit can be configured to be higher than that of the other one network card for exchanging the protocol packet with the local exchange unit; thus, the internal reliability of the router is improved.</p><p id="p0032" num="0032">A device for forwarding a packet is provided in the embodiment of the disclosure, and the device is configured to implement the embodiments and the example embodiments above, thereby needing no further description. As below, the term "component" can implement the combination of software and/or hardware of predetermined functions. Although the device described in the following embodiments is preferably implemented by software, the implementation of hardware or the combination of the software and hardware<!-- EPO <DP n="12"> --> can also be composed.</p><p id="p0033" num="0033"><figref idrefs="f0003">Fig. 5</figref> is a block diagram showing a structure of a device for forwarding a packet according to an embodiment of the disclosure; as shown in <figref idrefs="f0003">Fig. 5</figref>, the device includes: a determining component 52 and a transmitting component 54, and the device is described below.</p><p id="p0034" num="0034">The determining component 52 is configured to determine a control message channel and a protocol packet channel which are separately arranged between first and second LCC's control ether switch units in an LCC and first and second CFC's control ether switch units respectively in first and second CFCs, and the transmitting component 54 is coupled with the determining component 52 and is configured to transmit a control message and a protocol packet respectively according to the determined control message channel and the determined protocol packet channel.</p><p id="p0035" num="0035"><figref idrefs="f0003">Fig. 6</figref> is a first block diagram showing an example structure of the determining component 52 in the device for forwarding the packet according to an embodiment of the disclosure. As shown in <figref idrefs="f0003">Fig. 6</figref>, the acquiring module 52 includes a stacking element 62 and a determining element 64 and is specifically described below.</p><p id="p0036" num="0036">The stacking element 62 is configured to stack the first LCC's control ether switch unit with the second LCC's control ether switch unit and the first CFC's control ether switch unit with the second CFC's control ether switch unit, wherein the port information of ports for forming the channels are synchronized between the stacked switch units, and the determining element 64 is coupled with the stacking element 62 and is configured to determine the control message channel and the protocol packet channel by judging, via packet negotiations, whether the ports join an LAP.</p><p id="p0037" num="0037"><figref idrefs="f0004">Fig. 7</figref> is a first block diagram showing an example structure of the device for forwarding the packet according to an embodiment of the disclosure. As shown in <figref idrefs="f0004">Fig. 7</figref>, besides all the components in <figref idrefs="f0003">Fig. 5</figref>, the example structure further includes an allocating module 72 which is described below.<!-- EPO <DP n="13"> --></p><p id="p0038" num="0038">The allocating module 72 is coupled with the determining component 52 and the transmitting component 54 and is configured to allocate a load to each port belongign to the LAG for link aggregation between the local exchange unit and the first and the second LCC's control ether switch units.</p><p id="p0039" num="0039"><figref idrefs="f0004">Fig. 8</figref> is a second block diagram showing an example structure of the device for forwarding the packet according to an embodiment of the disclosure. As shown in <figref idrefs="f0004">Fig. 8</figref>, besides all the components in <figref idrefs="f0003">Fig. 5</figref>, the example structure further includes a configuring component 82 which is described below.</p><p id="p0040" num="0040">The configuring component 82 is coupled with the determining component 52 and the transmitting component 54 and is configured to, for a CPU with two network cards, configure the number limit of received and/or sent packets of one network card for exchanging the control message with the local exchange unit to be higher than that of the other one network card for exchanging the protocol packet with the local exchange unit.</p><p id="p0041" num="0041">In the embodiments and the example embodiments of the disclosure, based on the internal control plane security technology in a cluster-based router, a system for improving the reliability and security of the cluster-based router is provided. The system includes a packet transmitting model in which a control message channel and a protocol packet channel are separated and the implementing method of the packet transmitting model. When the cluster-based router suffers from an external attack or there are many protocol packets, the reliable transmission and processing of the internal control message are ensured.</p><p id="p0042" num="0042">A system in which the control message channel and the protocol packet channel are separated includes: at least two CFCs, at least two CFC's control ether switch units, at least one LCC, at least two LCC's control ether switch units, at least two local exchange units, at least two CPUs with two network cards, and at least one interface card.</p><p id="p0043" num="0043">The CFCs play the role to connect between the LCCs, the CFC's control ether switch units are in the CFCs, and each LCC is connected to the CFC's<!-- EPO <DP n="14"> --> control ether switch units. The CFCs and the LCC both include the LCC's control ether switch units, the local exchange units and the CPUs, and each LCC at least includes two LCC's control ether switch units. The LCC's control ether switch unit of the LCC is connected to the CFC's control ether switch unit and the local exchange unit of the LCC, and the local exchange unit is connected to the LCC's control ether switch unit and CPU of the LCC. The LCC's control ether switch unit of the CFC is connected to the CFC's control ether switch unit and the local exchange units of the CFC, and the local exchange unit is connected to the LCC's control ether switch unit and CPU of the CFC.</p><p id="p0044" num="0044">The CFC is the chassis where the CFC's control ether switch unit locates, and there is at least one CFC's control ether switch unit and at least two LCC's control ether switch units and a plurality of local exchange units and CPUs in the CFC.</p><p id="p0045" num="0045">The CFC's control ether switch units are mainly responsible for the exchange between the LCC's control ether switch units, and the CFC's control ether switch units are necessary for the exchange between the LCC's control ether switch unit of one chassis and the LCC's control ether switch unit of another chassis. The links between the CFC's control ether switch units and the LCC's control ether switch units are subjected to link aggregation through an LACP. The CFC's control ether switch units are stacked to act as one switch unit from the view of the LCC's control ether switch units. Due to the two CFC's control ether switch units, mutual backup can be implemented and the reliability can be improved, moreover, the control message channel and the protocol packet channel can be separated, one CFC's control ether switch unit exchanges a protocol packet and the other CFC's control ether switch unit exchanges a control message.</p><p id="p0046" num="0046">The LCC includes an LCC's control ether switch unit, a local exchange unit and a CPU for processing a packet.</p><p id="p0047" num="0047">The LCC's control ether switch unit is of two functions, one function is to<!-- EPO <DP n="15"> --> connect an LCC to the CFC so that the LCC can communicate with other chassises. The other function is to implement the interconnection between the local exchange units of the LCC, so that the local exchange units in the LCC can communicate with each other and can also communicate with other chassises. The LCC's control ether switch units can also be stacked so as to be shown as one switch unit.</p><p id="p0048" num="0048">The local exchange unit is mainly responsible for exchanging a protocol packet and a control message of a local CPU to the CFC's control ether switch units and receiving the protocol packet and the control message from the LCC's control ether switch units. The local exchange unit is coupled with the two LCC's control ether switch units by links, in one aspect, link redundancy is implemented and the bandwidth is improved; in another aspect, the control message channel and the protocol packet channel can be separated. The ports coupled with the LCC's control ether switch units are subjected to link aggregation through an LACP, and the link aggregation allows one or more links to be aggregated together to form a link aggregation group. When a packet is transmitted through the aggregation group, from which port in the aggregation group the packet is transmitted is determined according to a load sharing principle, and generally, there are many load sharing principles, for example, it is determined according to a source MAC address and a destination MAC address, a source MAC address and a destination MAC address plus an VLAN, a source IP and a destination IP and the like.</p><p id="p0049" num="0049">The CPU includes two network cards, wherein one network card is responsible for receiving and transmitting the protocol packet, and the other network card is responsible for receiving and transmitting the control message, so that the effect of separating the control message channel and the protocol packet channel is achieved. When the number of received and/or sent packets of the network card for receiving and the transmitting the control message is configured to be higher than that of the network card for receiving and the transmitting the protocol packet in the CPU, it is ensured that the<!-- EPO <DP n="16"> --> control message can be preferably received and processed by the CPU, and the internal reliability of the router is improved. The MAC address of each CPU network card needs to be allocated rationally so that the protocol packet and the control message can be sent out from different ports during the load sharing of the aggregation group.</p><p id="p0050" num="0050">The interface card is mainly coupled with an external network to receive a packet from the external network; if it is detected that the packet is the protocol packet and needs to be processed by the router, the packet may be forwarded to the internal CPU of the router. When the internal CPU of the router needs to forward the packet to other routers, the packet also needs to be forwarded through the interface card.</p><p id="p0051" num="0051">The process for separating the control message channel and the protocol packet channel provided in the embodiment of the disclosure includes the following: (1) Two CFC's control ether switch units are stacked. (2) Whether the links between the CFC's control ether switch units and the LCC's control ether switch units are joined to the aggregation group is determined. (3) A load sharing rule is set for the CFC's control ether switch units, specifically, one CFC's control ether switch unit is set to exchange the protocol packet and the other is set to exchange the control message. (4) The MAC address of the network card is set. (5) The port is joined to the link aggregation through the negotiation of an LACP packet, and is set to a port for transmitting the protocol packet or a port for transmitting the control message.</p><p id="p0052" num="0052">A system for separating a control message channel and a protocol packet channel in the example embodiment of the disclosure is described below in combination with the drawings.</p><p id="p0053" num="0053"><figref idrefs="f0005">Fig. 9</figref> is a diagram showing a structure of a system for separating a control message channel and a protocol packet channel according to an example embodiment of the disclosure. As shown in <figref idrefs="f0005">Fig. 9</figref>, the system includes:
<ul><li>two CFCs and two LCCs. Each chassis is identified by a chassis serial<!-- EPO <DP n="17"> --> number, and the serial numbers of the LCCs and the CFCs can be continuous or separate. Now, the serial number of the upper LCC is labelled as number 1, the serial number of the lower LCC is labelled as number 2, the serial number of the left CFC is labelled as number 3 and the serial number of the right CFC is labelled as number 4. The LCC's control ether switch unit in each chassis is provided with a number which is a slot number, the slot number of the left chassis is smaller than the slot number of the right chassis, and these numbers are not fixed and are only intended for the later description. It should be noted that the CFC can include an LCC's control ether switch unit, a local exchange unit and a CPU, and the LCC 11 can include an interface card. In addition, the separation of packet channels referred in the embodiment and the example embodiment of the disclosure can be between two LCCs or between an LCC and a central chassis. In order to describe the principle of the composition and structure and the method more clearly, a simplification is made in <figref idrefs="f0005">Fig. 9</figref>, for example, the LCC's control ether switch unit 31 or the LCC's control ether switch unit 33 in <figref idrefs="f0005">Fig. 9</figref> is equivalent to the first LCC's control ether switch unit 31; the LCC's control ether switch unit 32 or the LCC's control ether switch unit 34 in <figref idrefs="f0005">Fig. 9</figref> is equivalent to the second LCC's control ether switch unit 32; the CFC 13 in <figref idrefs="f0005">Fig. 9</figref> is equivalent to the first CFC 13 above; the CFC 14 in <figref idrefs="f0005">Fig. 9</figref> is equivalent to the second CFC 14 above; the CFC's control ether switch unit 21 in <figref idrefs="f0005">Fig. 9</figref> is equivalent to the first CFC's control ether switch unit 21 above; the CFC's control ether switch unit 22 in <figref idrefs="f0005">Fig. 9</figref> is equivalent to the second CFC's control ether switch unit 22 above; the local exchange unit 41 and the local exchange unit 42 in <figref idrefs="f0005">Fig. 9</figref> are equivalent to the local exchange unit 222 above; the control network card 1 or the control network card 2 is equivalent to the network card 1, the protocol network card 1 or the protocol network card 2 is equivalent to the network card 2; and CPU1 and CPU 2 are equivalent to the CPU 32 with two network cards.</li></ul></p><p id="p0054" num="0054">The CPU is coupled with two LCC's control ether switch units of the chassis, and the LCC's control ether switch unit of each LCC is coupled with<!-- EPO <DP n="18"> --> two CFC's control ether switch units, thus, each LCC's control ether switch unit can forward a packet to any CFC's control ether switch unit, but the external protocol packet of the router and the internal control message channel of the router cannot be separated and may pass through a same CFC's control ether switch unit or a same LCC's control ether switch unit.</p><p id="p0055" num="0055">To separate the protocol packet channel from the control message channel, two CFC's control ether switch units need to be stacked, and the LCC's control ether switch units in each chassis also need to be stacked. The stacked switch units need to synchronize stacked information by a regular synchronization way and a variable synchronization way. The ports of the stacked switch units are maintained by the two synchronization ways, that is to say, the opposite-end port is added to the aggregation group of this switch unit or is deleted from the aggregation group, and the information of the ports between the stacked switch units and the information of the aggregation group are consistent. The port of each switch unit is added to or deleted from the aggregation group through the LACP, and the port information refers to the information that the port is added to or is deleted from the aggregation group and the serial number of the aggregation group corresponding to the port.</p><p id="p0056" num="0056">In one aspect, the port information needs to be synchronized to the other switch unit on time, and the other switch unit receives the synchronized port information and then compares the synchronized port information with the port information saved previously and updates the port information. In another aspect, the port information is synchronized to the other switch unit in a variable way; when the port status of this switch unit changes, this end need to add the port to the aggregation group or deletes the port from the aggregation group; moreover, a notification message needs to be sent to the other switch unit at once; after the opposite end receives the change of the status information of the port, the port is added to or is deleted from the aggregation group corresponding to the port. The stacked switch units need to store a global table of the ports of the opposite end, wherein the ports of the opposite<!-- EPO <DP n="19"> --> end has been added to the aggregation group, and the content of the global table includes: aggregation group number of the port, port number, the chip number of equipment to which the port belongs, and the chip number of the equipment, i.e., the serial numbers of the stacked switch units, used for distinguishing the stacked switch units. After the message which is used for synchronizing information in a variable way or a regular way from the opposite end is received, the information in the message is compared with the information in the global table, and the information in the global table is updated so as to keep the information of this end to be synchronous with the opposite end. The regular synchronization ensures the consistence of the content in the global table, and the variable synchronization ensures the real-time performance of the content in the global table. The regular synchronization mainly overcomes the defect of failure of the variable synchronization, and if the variable synchronization is failed, the information of the two ends can also be ensured to be consistent by regular synchronization within a certain period.</p><p id="p0057" num="0057">The two CFC's control ether switch units and the LCC's control ether switch unit in each chassis are stacked completely, and the ports of the LCC's control ether switch units of each LCC and the ports of the CFC's control ether switch units are in an aggregation group; when it is stipulated that the LCC's control ether switch unit 31 and the CFC's control ether switch unit 21 only forward the control message, and the LCC's control ether switch unit 32 and the CFC's control ether switch unit 22 only forward the protocol packet, the control message of the LCC's control ether switch unit 31 may also be forwarded to the CFC's control ether switch unit 22, so that the channels cannot be separated. To enable the LCC's control ether switch unit forwarding the protocol packet to forward only the protocol packet to the CFC's control ether switch unit only forwarding the protocol packet, and to enable the LCC's control ether switch unit forwarding the control message to forward only the control message to the CFC's control ether switch unit only forwarding the<!-- EPO <DP n="20"> --> control message, it is necessary to set links between the CFC's control ether switch units and the LCC's control ether switch units to enable the crossed links not to forward any packet temporarily, wherein the crossed links include the link between the LCC's control ether switch unit forwarding the protocol packet and the CFC's control ether switch unit forwarding the control message, and include the link between the LCC's control ether switch unit forwarding the control message and the CFC's control ether switch unit forwarding the protocol packet; but the crossed links is not allowed to forward the packet forever, for example, when a directly-connected link is failed, the crossed links may prepare for forwarding the packet within one hundred and fifty milliseconds. To achieve the effects, the following steps need to be completed according to the following principle.</p><p id="p0058" num="0058">Firstly, when the ports of the CFC's control ether switch units send an LACP packet, the two bytes in the source MAC of the packet are the chassis number and slot number of each CFC's control ether switch unit respectively, and the two CFC's control ether switch units are different at least in term of one of the chassis number and the slot number, thus, the two CFC's control ether switch units can be distinguished according to the two items.</p><p id="p0059" num="0059">After the ports of the LCC's control ether switch units receive the LACP packet from the CFC's control ether switch units, the chassis numbers and slot numbers of the CFC's control ether switch units are parsed from the source MAC of the LACP packet to check whether the packets from the two CFC's control ether switch units are received, if the packet from only one of the CFC's control ether switch units is received, the port joins to the aggregation group normally through the negotiation of the LACP packet.</p><p id="p0060" num="0060">If the LCC's control ether switch units receive the LACP packets from the two CFC's control ether switch units, the chassis numbers of the CFCs are compared, and if the two CFC's control ether switch units are inserted in one chassis, their slot numbers are compared. When the LCC's control ether switch unit is the left LCC's control ether switch unit, the port coupled with the<!-- EPO <DP n="21"> --> CFC's control ether switch unit with a small chassis number is normally added to the aggregation group through the negotiation of the LACP packet; the port coupled with the CFC's control ether switch unit with a larger chassis number is only negotiated by the LACP packet but is not added to the aggregation group after the negotiation is successful, and the port is in a BLOCK status not forwarding the packet and the status of the port may depend on a tag which shows whether the port is added to the aggregation group and is added in the reserved field of an LACP packet transmitted to the CFC's control ether switch unit with a larger chassis number; and then, the tag is set to one showing that the port is not added to the aggregation group to be sent out, and the location of the tag in the LACP packet is an aggregation-flag field. After the CFC's control ether switch units receive the tag, the port of this end is not added to the aggregation group and is set to be in a BLOCK status.</p><p id="p0061" num="0061">Thus, when the LCC's control ether switch unit is the right LCC's control ether switch unit, the port coupled with the CFC's control ether switch unit with a larger chassis number is normally added to the aggregation group through the negotiation of the LACP packet; the port coupled with the CFC's control ether switch unit with a small chassis number is only negotiated by the LACP packet but is not added to the aggregation group after the negotiation is successful, and the port is in a BLOCK status, and the tag showing whether the port is added to the aggregation group in the LACP packet is set to one showing that the port is not added to the aggregation group.</p><p id="p0062" num="0062">In combination with the structure shown in <figref idrefs="f0005">Fig. 9</figref>, an example embodiment of the disclosure provides a method for forwarding a packet. <figref idrefs="f0006">Fig. 10</figref> is a flowchart of a packet forwarding process according to an embodiment of the disclosure. As shown in <figref idrefs="f0006">Fig. 10</figref>, the flow includes the following steps:
<ul><li>Step 1002: A port of a CFC's control ether switch unit sends an LACP packet with a chassis number and a slot number, and then Step 1004 is executed.</li><li>Step 1004: Whether the LCC's control ether switch unit is the LCC's<!-- EPO <DP n="22"> --> control ether switch unit with a small slot number is judged, if so, Step 1006 is executed, otherwise, Step 1008 is executed.</li><li>Step 1006: Whether the LACP packet received by the LCC's control ether switch unit belongs to the CFC's control ether switch unit 21, if so, Step 1010 is executed, otherwise, Step 1012 is executed.</li><li>Step 1008: Whether the LACP packet received by the LCC's control ether switch unit belongs to the CFC's control ether switch unit 22, if so, Step 1018 is executed, otherwise, Step 1020 is executed.</li><li>Step 1010: The port is added to the aggregation group by the negotiation of the LACP packet, and Step 1014 is executed.</li><li>Step 1012: The port is only negotiated by the LACP packet and is not added to the aggregation group, Step 1016 is executed.</li><li>Step 1014: A link 91 is failed and is deleted from the aggregation group, and Step 1016 is executed.</li><li>Step 1016: A link 92 is added to the aggregation group.</li><li>Step 1018: The port is added to the aggregation group by the negotiation of the LACP packet, and Step 1022 is executed.</li><li>Step 1020: The port is only negotiated by the LACP packet and is not added to the aggregation group, Step 1024 is executed;</li><li>Step 1022: The link 94 is failed and is deleted from the aggregation group, and Step 1024 is executed.</li><li>Step 1024: A link 93 is added to the aggregation group.</li></ul></p><p id="p0063" num="0063">After the links not forwarding any packet are removed by the method, <figref idrefs="f0007">Fig. 11</figref> is a diagram showing a structure for separating the channels of a control message and a protocol packet after the link not forwarding any packet is removed according to an embodiment of the disclosure. As shown in <figref idrefs="f0007">Fig. 11</figref>, the connecting relationship of each switch unit of the whole system is: there are two separate channels on the communication of the CPUs and the interface cards between the LCC 11 and the LCC12 physically, so as to lay a solid foundation for the channel separation of the control message and the<!-- EPO <DP n="23"> --> protocol packet.</p><p id="p0064" num="0064">It should be noted that, for the crossed links between the LCC's control ether switch units and the CFC's control ether switch units, i.e., the links which are successfully negotiated by the LACP but are not added to the aggregation group temporarily. However, the crossed links is not allowed to join the aggregation group forever, for example, when the link between the LCC's control ether switch unit 31 with a small slot number and a CFC's control ether switch unit 21 with a small chassis number is failed and cannot implement normal communication, the communication of the link between the LCC's control ether switch unit 31 and the CFC's control ether switch unit 21 may switch to the link between the LCC's control ether switch unit 31 and the CFC's control ether switch unit 22 within one hundred and fifty milliseconds, and the link may be added to the aggregation group. After the communication of the link 91 goes back to normal, the link 92 is deleted from the aggregation group again and cannot forward the control message and the protocol packet.</p><p id="p0065" num="0065">Two physically-separated channels have been formed, and it is necessary to set the MAC addresses of the network cards and the interface cards and a load sharing rule for the CFC's control ether switch units, the LCC's control ether switch units and the local exchange units so that the protocol packet and the control message are transmitted in two separate channels. The steps are as follows:
<ul><li>The bottom three bits of the MAC address of the protocol network interface of the CPU and the bottom three bits of the MAC address of the interface card are 100. For example, if the MAC address is in a form of BYTEO: BYTE1: BYTE2: BYTE3: BYTE4: BYTE5, the bottom three bits of the byte BYTE5 are 100.</li><li>The bottom three bits of the MAC address of the control surface network interface of the CPU are set to be 000.</li></ul></p><p id="p0066" num="0066">The CFC's control ether switch unit with a small chassis number and the LCC's control ether switch unit with a small slot number are set to forward the<!-- EPO <DP n="24"> --> control message, that is to say, these switch units only forward the packets in which the bottom three bits of the source MAC are 000.</p><p id="p0067" num="0067">The CFC's control ether switch unit with a large chassis number and the LCC's control ether switch unit with a large slot number are set to forward the protocol packet, that is to say, these switch units only forward the packets in which the bottom three bits of the source MAC are 100.</p><p id="p0068" num="0068">The port of the local exchange unit coupled with the LCC's control ether switch unit with a small slot number is set to only forward the control message, namely, when a packet needs to be forwarded from the local exchange unit to the LCC's control ether switch unit, if the bottom three bits of the source MAC of the packet is 000, the packet is forwarded from the port.</p><p id="p0069" num="0069">The port of the local exchange unit coupled with the LCC's control ether switch unit with a large slot number is set to only forward the protocol packet, namely, when a packet needs to be forwarded from the local exchange unit to the LCC's control ether switch units, if the bottom three bits of the source MAC of the packet is 100, the packet is forwarded from the port.</p><p id="p0070" num="0070">If a CFC's control ether switch unit is failed, all the packets are forwarded from the other CFC's control ether switch unit. Similarly, when an LCC's control ether switch unit in a chassis is failed, the other LCC's control ether switch unit may forward all the packets. In addition, when a port of the local exchange unit is failed, the other port may forward and receive all the packets.</p><p id="p0071" num="0071">To sum up, after all the settings are completed, as shown in <figref idrefs="f0007">Fig. 11</figref>, the channel for the control message is: an LCC's control ether switch unit 31-a CFC's control ether switch unit 21-an LCC's control ether switch unit 33; and the channel for the protocol packet is: an LCC's control ether switch unit 32-a CFC's control ether switch unit 22- an LCC's control ether switch unit 34. Here, one of the divided channels is for transmitting the control message and the other one is for transmitting the protocol packet, which is not fixed, or, as shown in <figref idrefs="f0007">Fig. 11</figref>, the left channel for transmitting the control message is configured to forward the protocol packet and the other one is configured to<!-- EPO <DP n="25"> --> forward the control message.</p><p id="p0072" num="0072">Obviously, those skilled in the art shall understand that the components or steps of the disclosure may be implemented by general computing apparatus and centralized in a single computing apparatus or distributed in a network consisting of multiple computing apparatus. Optionally, the components or steps may be implemented by program codes executable by the computing apparatus, so that they may be stored in a storage apparatus and executed by the computing apparatus, and, in some cases, the steps can be executed in a sequence different from the illustrated or described sequence, or they are respectively made into the integrated circuit components or many of them are made into a single integrated circuit component. By doing so, the disclosure is not limited to any specific combination of hardware and software.</p><p id="p0073" num="0073">The above are only the preferred embodiments of the disclosure and not intended to limit the disclosure. For those skilled in the art, various modifications and changes can be made in the disclosure. Any modifications, equivalent replacements, improvements and the like within the spirit and principle of the disclosure shall fall within the scope of protection of the disclosure.</p></description><claims mxw-id="PCLM90459232" lang="EN" load-source="patent-office"><!-- EPO <DP n="26"> --><claim id="c-en-0001" num="0001"><claim-text>A system for forwarding a packet, comprising:
<claim-text>a Line Card Chassis,LCC, comprising a first LCC's control ether switch unit and a second LCC's control ether switch unit;</claim-text>
<claim-text>a first Central Fabric Chassis,CFC, comprising a first CFC's control ether switch unit; and</claim-text>
<claim-text>a second CFC comprising a second CFC's control ether switch unit, wherein</claim-text>
<claim-text>a control message channel and a protocol packet channel are separately arranged between the first and the second LCC's control ether switch units and the first and the second CFC's control ether switch units.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The system according to claim 1, wherein separately arranging the control message channel and the protocol packet channel between the first and the second LCC's control ether switch units and the first and the second CFC's control ether switch units comprises:
<claim-text>a link between the first LCC's control ether switch unit and the first CFC's control ether switch unit serving as a control message channel, and a link between the second LCC's control ether switch unit and the second CFC's control ether switch unit serving as a protocol packet channel; or,</claim-text>
<claim-text>a link between the first LCC's control ether switch unit and the second CFC's control ether switch unit serving as a control message channel, and a link between the second LCC's control ether switch unit and the first CFC's control ether switch unit serving as a protocol packet channel.</claim-text></claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The system according to claim 1, further comprising:
<claim-text>a local exchange unit, coupled with the first LCC's control ether switch unit and the second LCC's control ether switch unit, and configured to exchange a control message and a protocol packet with the first LCC's control ether switch unit and the second LCC's control ether switch unit respectively.</claim-text></claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>The system according to claim 3, further comprising:
<claim-text>a Central Processing Unit,CPU, with two network cards, wherein the CPU<!-- EPO <DP n="27"> --> is coupled with the local exchange unit, one of the two network cards is configured to exchange a control message with the local exchange unit, and the other one of the two network cards is configured to exchange a protocol packet with the local exchange unit.</claim-text></claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>A method for forwarding a packet, comprising:
<claim-text>determining a control message channel and a protocol packet channel which are separately arranged between first and second LCC's control ether switch units in a Line Card Chassis,LCC" and first and second CFC's control ether switch units respectively in first and second CFCs; and</claim-text>
<claim-text>transmitting a control message and a protocol packet respectively according to the determined control message channel and the determined protocol packet channel.</claim-text></claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>The method according to claim 5, wherein determining the control message channel and the protocol packet channel which are separately arranged between the first and second LCC's control ether switch units in the LCC, and the first and second CFC's control ether switch units respectively in the first and second CFCs comprises:
<claim-text>stacking the first LCC's control ether switch unit with the second LCC's control ether switch unit, and stacking the first CFC's control ether switch unit with the second CFC's control ether switch unit, wherein port information of ports for forming channels are synchronized between the stacked switch units; and</claim-text>
<claim-text>determining the control message channel and the protocol packet channel by judging, via packet negotiations, whether the ports join a Link Aggregation Group,LAG.</claim-text></claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>The method according to claim 6, wherein before transmitting the control message and the protocol packet respectively according to the determined control message channel and the determined protocol packet channel, the method further comprises:
<claim-text>allocating a load to each port belonging to the LAG for link aggregation<!-- EPO <DP n="28"> --> between a local exchange unit and the first and second LCC's control ether switch units.</claim-text></claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>The method according to claim 6, wherein before transmitting the control message and the protocol packet respectively according to the determined control message channel and the determined protocol packet channel, the method further comprises:
<claim-text>for a CPU with two network cards, configuring a number limit of received and/or sent packets of one network card for exchanging the control message with the local exchange unit to be higher than that of the other one network card for exchanging a protocol packet with the local exchange unit.</claim-text></claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>A device for forwarding a packet, comprising:
<claim-text>a determining component, configured to determine a control message channel and a protocol packet channel which are separately arranged between first and second LCC's control ether switch units in a Line Card Chassis,LCC, and first and second CFC's control ether switch units respectively in first and second CFCs; and</claim-text>
<claim-text>a transmitting component, configured to transmit a control message and a protocol packet respectively according to the determined control message channel and the determined protocol packet channel.</claim-text></claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>The device according to claim 9, wherein the determining component comprises:
<claim-text>a stacking element, configured to stack the first LCC's control ether switch unit with the second LCC's control ether switch unit and the first CFC's control ether switch unit with the second CFC's control ether switch unit, wherein port information of ports for forming channels are synchronized between the stacked switch units; and</claim-text>
<claim-text>a determining element, configured to determine the control message channel and the protocol packet channel by judging, via packet negotiations, whether the ports join a Link Aggregation Group,LAG.</claim-text></claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>The device according to claim 10, further comprising:<!-- EPO <DP n="29"> -->
<claim-text>an allocating element, configured to allocate a load to each port belonging to the LAG for link aggregation between a local exchange unit and the first and second LCC's control ether switch units.</claim-text></claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>The device according to claim 10, further comprising:
<claim-text>a configuring component, configured to, for a CPU with two network cards, configure a number limit of received and/or sent packets of one network card for exchanging the control message with the local exchange unit to be higher than that of the other one network card for exchanging the protocol packet with the local exchange unit.</claim-text></claim-text></claim></claims><drawings mxw-id="PDW20421967" load-source="patent-office"><!-- EPO <DP n="30"> --><figure id="f0001" num="1,2"><img id="if0001" file="imgf0001.tif" wi="116" he="205" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="31"> --><figure id="f0002" num="3,4"><img id="if0002" file="imgf0002.tif" wi="153" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="32"> --><figure id="f0003" num="5,6"><img id="if0003" file="imgf0003.tif" wi="95" he="183" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="33"> --><figure id="f0004" num="7,8"><img id="if0004" file="imgf0004.tif" wi="95" he="200" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="34"> --><figure id="f0005" num="9"><img id="if0005" file="imgf0005.tif" wi="152" he="231" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="35"> --><figure id="f0006" num="10"><img id="if0006" file="imgf0006.tif" wi="165" he="190" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="36"> --><figure id="f0007" num="11"><img id="if0007" file="imgf0007.tif" wi="148" he="233" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="165" he="220" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="165" he="218" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
