<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2961208-A1" country="EP" doc-number="2961208" kind="A1" date="20151230" family-id="51228388" file-reference-id="274001" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160451134" ucid="EP-2961208-A1"><document-id><country>EP</country><doc-number>2961208</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-14306041-A" is-representative="YES"><document-id mxw-id="PAPP193865236" load-source="patent-office" format="original"><country>EP</country><doc-number>14306041.6</doc-number><date>20140627</date><lang>EN</lang></document-id><document-id mxw-id="PAPP193865237" load-source="docdb" format="epo"><country>EP</country><doc-number>14306041</doc-number><kind>A</kind><date>20140627</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162036377" ucid="EP-14306041-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>14306041</doc-number><kind>A</kind><date>20140627</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1988524514" load-source="docdb">H04L  29/06        20060101ALN20141218BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988524654" load-source="docdb">H04W  12/04        20090101AFI20141218BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988525255" load-source="docdb">H04W  12/06        20090101ALN20141218BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1832231715" load-source="docdb" scheme="CPC">H04L  63/168       20130101 LA20170405BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1857145959" load-source="docdb" scheme="CPC">H04W  12/08        20130101 LI20170118BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1857145960" load-source="docdb" scheme="CPC">H04W   4/12        20130101 LA20170118BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1857145961" load-source="docdb" scheme="CPC">H04L  63/0823      20130101 LA20170118BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987793986" load-source="docdb" scheme="CPC">H04W  12/06        20130101 LA20141215BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987797756" load-source="docdb" scheme="CPC">H04L  63/0815      20130101 LA20141215BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987800725" load-source="docdb" scheme="CPC">H04W  12/04        20130101 FI20141215BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165544868" lang="DE" load-source="patent-office">Verfahren zum Zugreifen auf einen Dienst und entsprechender Anwendungsserver, Vorrichtung und System</invention-title><invention-title mxw-id="PT165544869" lang="EN" load-source="patent-office">Method for accessing a service and corresponding application server, device and system</invention-title><invention-title mxw-id="PT165544870" lang="FR" load-source="patent-office">Procédé permettant d'accéder à un service et serveur, dispositif et système d'application correspondant</invention-title><citations><patent-citations><patcit mxw-id="PCIT335961648" load-source="docdb" ucid="EP-2658297-A1"><document-id format="epo"><country>EP</country><doc-number>2658297</doc-number><kind>A1</kind><date>20131030</date></document-id><sources><source name="SEA" category="Y" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT335961646" load-source="docdb" ucid="WO-2006045402-A1"><document-id format="epo"><country>WO</country><doc-number>2006045402</doc-number><kind>A1</kind><date>20060504</date></document-id><sources><source name="SEA" category="Y" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT335961647" load-source="docdb" ucid="WO-2007131548-A1"><document-id format="epo"><country>WO</country><doc-number>2007131548</doc-number><kind>A1</kind><date>20071122</date></document-id><sources><source name="SEA" category="Y" created-by-npl="N"/></sources></patcit></patent-citations><non-patent-citations><nplcit><text>None</text><sources><source mxw-id="PNPL57937122" load-source="docdb" name="APP"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR1103305041" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>GEMALTO SA</last-name><address><country>FR</country></address></addressbook></applicant><applicant mxw-id="PPAR1103310875" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>GEMALTO SA</last-name></addressbook></applicant><applicant mxw-id="PPAR1101650119" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Gemalto SA</last-name><iid>101122644</iid><address><street>6, rue de la Verrerie</street><city>92190 Meudon</city><country>FR</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103324831" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>PAILLART FRÉDÉRIC</last-name><address><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103318524" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>Paillart, Frédéric</last-name></addressbook></inventor><inventor mxw-id="PPAR1101650729" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Paillart, Frédéric</last-name><address><street>c/o Gemalto SA Service brevets Avenue du Jujubier ZI Athélia IV</street><city>13705 La Ciotat</city><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103314168" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>DANDELOT THOMAS</last-name><address><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103323507" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>Dandelot, Thomas</last-name></addressbook></inventor><inventor mxw-id="PPAR1101647339" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>Dandelot, Thomas</last-name><address><street>c/o Gemalto SA Service brevets Avenue du Jujubier ZI Athélia IV</street><city>13705 La Ciotat</city><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103303778" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>CHRETIEN STÉPHANE</last-name><address><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103304108" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>Chretien, Stéphane</last-name></addressbook></inventor><inventor mxw-id="PPAR1101641373" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>Chretien, Stéphane</last-name><address><street>c/o Gemalto SA Service brevets Avenue du Jujubier ZI Athélia IV</street><city>13705 La Ciotat</city><country>FR</country></address></addressbook></inventor></inventors></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS660604382" load-source="docdb">AL</country><country mxw-id="DS660603441" load-source="docdb">AT</country><country mxw-id="DS660604392" load-source="docdb">BE</country><country mxw-id="DS660681739" load-source="docdb">BG</country><country mxw-id="DS660680353" load-source="docdb">CH</country><country mxw-id="DS660604598" load-source="docdb">CY</country><country mxw-id="DS660603442" load-source="docdb">CZ</country><country mxw-id="DS660604393" load-source="docdb">DE</country><country mxw-id="DS660604607" load-source="docdb">DK</country><country mxw-id="DS660604608" load-source="docdb">EE</country><country mxw-id="DS660680380" load-source="docdb">ES</country><country mxw-id="DS660681740" load-source="docdb">FI</country><country mxw-id="DS660681741" load-source="docdb">FR</country><country mxw-id="DS660604394" load-source="docdb">GB</country><country mxw-id="DS660604609" load-source="docdb">GR</country><country mxw-id="DS660604399" load-source="docdb">HR</country><country mxw-id="DS660603443" load-source="docdb">HU</country><country mxw-id="DS660680354" load-source="docdb">IE</country><country mxw-id="DS660604400" load-source="docdb">IS</country><country mxw-id="DS660681742" load-source="docdb">IT</country><country mxw-id="DS660604610" load-source="docdb">LI</country><country mxw-id="DS660680321" load-source="docdb">LT</country><country mxw-id="DS660603444" load-source="docdb">LU</country><country mxw-id="DS660680322" load-source="docdb">LV</country><country mxw-id="DS660680327" load-source="docdb">MC</country><country mxw-id="DS660781805" load-source="docdb">MK</country><country mxw-id="DS660781806" load-source="docdb">MT</country><country mxw-id="DS660680381" load-source="docdb">NL</country><country mxw-id="DS660603445" load-source="docdb">NO</country><country mxw-id="DS660781807" load-source="docdb">PL</country><country mxw-id="DS660604623" load-source="docdb">PT</country><country mxw-id="DS660680382" load-source="docdb">RO</country><country mxw-id="DS660604624" load-source="docdb">RS</country><country mxw-id="DS660781808" load-source="docdb">SE</country><country mxw-id="DS660604625" load-source="docdb">SI</country><country mxw-id="DS660603446" load-source="docdb">SK</country><country mxw-id="DS660781809" load-source="docdb">SM</country><country mxw-id="DS660680359" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA166479504" lang="EN" load-source="patent-office"><p id="pa01" num="0001">The invention relates to a method for accessing a service.</p><p id="pa02" num="0002">According to the invention, a device 12 authenticates to a mobile network server. The device sends to an application server 18 an enrolment request 22. The application server sends to the device at least one key 26 relating to the application server. The device sends to the application server a request 28 for getting at least one token accompanied with at least one key relating to a device application. The device application key is ciphered by using the application server key. The application server receives an identifier 210 relating to a device user. The application server verifies whether the identified device user is or is not authorized to access the service. Only if the identified device user is authorized, the application server deciphers the ciphered device application key and ciphers at least one token by using the device application key. The application server sends to the device at least one ciphered token 212. The device deciphers the at least one ciphered token. The device stores the at least one token that allows the device application to be authenticated.</p><p id="pa03" num="0003">The invention also relates to corresponding device, application server and system.
<img id="iaf01" file="imgaf001.tif" wi="93" he="91" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA166759316" lang="EN" source="EPO" load-source="docdb"><p>The invention relates to a method for accessing a service.  According to the invention, a device 12 authenticates to a mobile network server. The device sends to an application server 18 an enrolment request 22. The application server sends to the device at least one key 26 relating to the application server. The device sends to the application server a request 28 for getting at least one token accompanied with at least one key relating to a device application. The device application key is ciphered by using the application server key. The application server receives an identifier 210 relating to a device user. The application server verifies whether the identified device user is or is not authorized to access the service. Only if the identified device user is authorized, the application server deciphers the ciphered device application key and ciphers at least one token by using the device application key. The application server sends to the device at least one ciphered token 212. The device deciphers the at least one ciphered token. The device stores the at least one token that allows the device application to be authenticated.  The invention also relates to corresponding device, application server and system.</p></abstract><description mxw-id="PDES98404205" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><b>Field of the invention:</b></heading><p id="p0001" num="0001">The invention relates generally to a method for accessing a service.</p><p id="p0002" num="0002">Furthermore, the invention pertains to an application server for accessing a service.</p><p id="p0003" num="0003">Moreover, the invention also relates to a device for accessing a service.</p><p id="p0004" num="0004">The present invention is notably applicable to a mobile radio-communication field in which the device is a mobile terminal, like a mobile (tele)phone.</p><p id="p0005" num="0005">Finally, the invention concerns a system for accessing a service that includes a device and an application server which are connected to each other.</p><heading id="h0002"><b>State of the art:</b></heading><p id="p0006" num="0006">As known per se, a mobile phone is being more and more used for accessing a service, like e.g. a mobile payment service. To access a service, the mobile phone requests a service provider to download a corresponding application.</p><p id="p0007" num="0007">However, once the application is downloaded and installed on the mobile phone, there is a need to securely enrol the application to an application server before a phone user uses the application.</p><heading id="h0003"><b>Summary of the invention:</b></heading><p id="p0008" num="0008">The invention proposes a solution for satisfying the just herein above specified need by providing a method for accessing a service.</p><p id="p0009" num="0009">According to the invention, the method comprises the following steps. A device authenticates to a mobile network server. The device sends to an application server an enrolment request. The application server sends to the device at least one key relating to the application server. The device sends to the application server a request for getting at least one token accompanied with at least one key relating to a device application. The device application key is ciphered by using the application server key.<!-- EPO <DP n="2"> --> The application server receives an identifier relating to a device user. The application server verifies whether the identified device user is or is not authorized to access the service. Only if the identified device user is authorized, the application server deciphers the ciphered device application key and ciphers at least one token by using the device application key. The application server sends to the device at least one ciphered token. The device deciphers the at least one ciphered token. The device stores the at least one token, the at least one token allowing the device application to be authenticated.</p><p id="p0010" num="0010">The principle of the invention consists in using a device authentication to a mobile network server before the device transmits a request for enrolling a device application to an application server. The application server sends back a server key which the device uses to cipher a device application key that is thus transmitted back along with a token request. The application server identifies a device user. When the identified device user is authorized, the application server then uses the device application key to cipher a token(s) for its(their) sending to the device.</p><p id="p0011" num="0011">The application server provides the device application with a key relating to the application server, as server key, so as to send, in a ciphered manner, data from the device application to the application server. Then, the device application by using the server key provides securely the application server with a key relating to the device application, as device application key, so as to send, in a ciphered manner, data from the application server to the device application.</p><p id="p0012" num="0012">It is to be noted that the device application key is used as a transport key, i.e. to transport sensitive data, namely a token(s), during such an (application) enrolment method.</p><p id="p0013" num="0013">A device authentication to a mobile network server, as an application enrolment process pre-requisite, has occurred. Then, the application server gets an identifier relating to a device user that is trustable since the mobile network server has authenticated the device. The identifier relating to a device user is used by the application server as a proof or evidence of a previous successful mobile network server authentication.</p><p id="p0014" num="0014">Otherwise, i.e. if the device is not authenticated by the mobile network server, then the application server does not get any identifier relating to a device user and does not provide the device application with any token.<!-- EPO <DP n="3"> --></p><p id="p0015" num="0015">Thus, the invention solution allows providing securely the device application with one or several tokens that are ciphered by using the device application key.</p><p id="p0016" num="0016">The token(s), as authentication data, is(are) data allowing the device application to be authenticated, so as to access a corresponding service.</p><p id="p0017" num="0017">The device user does not have to provide manually user credentials, as authentication data, like a device user, a Personal Identity Number (or PIN), a login and a password, so as to enrol the device application to the application server.</p><p id="p0018" num="0018">The invention solution is therefore user friendly.</p><p id="p0019" num="0019">Moreover, the Mobile Network Operator (or MNO) or another third party does not need to pre-provision any user credentials, as token(s) and application authentication data, into the device application.</p><p id="p0020" num="0020">The invention solution is also therefore convenient for the MNO or another party.</p><p id="p0021" num="0021">Thus, the invention solution allows provisioning automatically one or several tokens without involving the device user (apart from her or his possible authentication at the device side, so as to allow unlocking an authentication key that is used for the device authentication before a mobile network entity).</p><p id="p0022" num="0022">Once provided with the token(s) by the application server, the device application is able to authenticate to one or several remote servers by using the token(s), through either a mobile network channel, such as an MNO's 3GPP network, or a non-mobile network channel, like a Wi-Fi network, so as to access a corresponding service.</p><p id="p0023" num="0023">According to a further aspect, the invention is an application server for accessing a service.</p><p id="p0024" num="0024">According to the invention, the server is configured to receive an enrolment request, to send to the device at least one key relating to the application server, and to receive a request for getting at least one token accompanied with at least one key relating to a device application. The device application key is ciphered by using the server key. The server is further configured to receive an identifier relating to a device user, to verify whether the identified device user is or is not authorized to access the service, to decipher, only if the identified device user is authorized, the ciphered device application key, to cipher at least one token by using the device application key and to send to the device at least one ciphered token.</p><p id="p0025" num="0025">According to still a further aspect, the invention is a device for accessing a service.<!-- EPO <DP n="4"> --></p><p id="p0026" num="0026">According to the invention, the device is configured to authenticate to a mobile network server, to send to an application server an enrolment request, to receive at least one key relating to the application server, to send to the application server a request for getting at least one token accompanied with at least one key relating to a device application. The device application key is ciphered by using the application server key. The device is further configured to receive at least one ciphered token, to decipher the at least one ciphered token and to store the at least one token. The at least one token allows the device application to be authenticated.</p><p id="p0027" num="0027">It is to be noted that the device may be any kind of communicating device, like a chip soldered to a host device, a Secure Element (or SE), a terminal or a user terminal.</p><p id="p0028" num="0028">According to still a further aspect, the invention is a system for accessing a service.</p><p id="p0029" num="0029">According to the invention, the system comprises a device and an application server. The device is connected to the application server. The device is configured to authenticate to a mobile network server and to send to the application server an enrolment request. The application server is configured to send to the device at least one key relating to the application server, to receive an identifier relating to a device user and to verify whether the identified device user is or is not authorized to access the service. The application server is further configured to decipher, only if the identified device user is authorized, the ciphered device application key and to cipher at least one token by using the device application key and to send to the device at least one ciphered token. The device is configured to decipher the at least one ciphered token and to store the at least one token. The at least one token allows the device application to be authenticated.</p><heading id="h0004"><b>Brief description of the drawings:</b></heading><p id="p0030" num="0030">Additional features and advantages of the invention will be apparent from a detailed description of one preferred embodiment of the invention, given as an indicative and non-limitative example, in conjunction with the following drawings:
<ul><li><figref idrefs="f0001">Figure 1</figref> illustrates a simplified diagram including a first (remote) server that is connected to a second (remote) server and a mobile phone, as a (client) device, the second server being arranged to receive a message with a device user identifier, to<!-- EPO <DP n="5"> --> check whether the identified device user is authorized and to send to the authorized device a token(s) by using a device application key, according to the invention; and</li><li><figref idrefs="f0001">Figure 2</figref> represents an example of a message flow between the device, the first and the second server of <figref idrefs="f0001">figure 1</figref>, so that, further to a device initiation of a communication with the second server, the device downloads securely a token(s) allowing to be authenticated through a mobile or a non-mobile communication network.</li></ul></p><heading id="h0005"><b>Detailed description:</b></heading><p id="p0031" num="0031">Herein under is considered a case in which the invention method for accessing a service is implemented by a mobile equipment, as a device for accessing a service, being coupled to or including a chip, a mobile network entity, as a first remote server, and an application server, as a second remote server.</p><p id="p0032" num="0032">According to another embodiment, the invention method for accessing a service is implemented by a mobile phone, as a standalone device for accessing a service, and two remote servers. In other words, the mobile phone does not cooperate with any chip, so as to authenticate to a mobile communication network and to get a token(s) allowing to authenticate a mobile phone application. According to such an embodiment (not represented), the device for accessing a service is adapted to carry out the functions that are carried out by the chip and the device and that are described infra.</p><p id="p0033" num="0033">Naturally, the herein below described embodiment is only for exemplifying purposes and is not considered to reduce the scope of the invention.</p><p id="p0034" num="0034"><figref idrefs="f0001">Figure 1</figref> shows schematically a mobile equipment 10, one or several mobile radio-communication networks 16, a first remote server 162 and a second remote server 18.</p><p id="p0035" num="0035">The mobile equipment 10 includes a mobile phone 12, as a user terminal, and an embedded Universal Integrated Circuit Card (or eUICC) 14, as an incorporated chip.</p><p id="p0036" num="0036">Instead of being embedded, the chip may be included within a smart card or another medium, as a Secure Element (or SE), that is coupled to the user terminal, as host device. The chip may be either fixed to or removable from the host device.</p><p id="p0037" num="0037">The chip may be included within an SE.</p><p id="p0038" num="0038">The invention does not impose any constraint as to a kind of the SE type. As removable SE, it may be a Subscriber Identity Module (or SIM) type card, a Secure<!-- EPO <DP n="6"> --> Removable Module (or SRM), a smart dongle of the USB (acronym for "Universal Serial Bus") type, a (micro-) Secure Digital (or SD) type card or a Multi-Media type Card (or MMC) or any format card to be coupled to a host device, as device for accessing a service.</p><p id="p0039" num="0039">For the sake of simplicity, the mobile phone 12, the eUICC 14, the mobile radio-communication network(s) 16, the first remote server 162 and the second remote server 18 are termed herein after the phone 12, the chip 14, the network 16, the first server 162 and the second server 18 respectively.</p><p id="p0040" num="0040">Only one phone 12 that is connected, through the network 16, to the second server 18 is represented for a clarity reason. However, the second server 18 is able to be accessed from and to access, Over-The-Air (or OTA), Over-The-Internet (or OTI), or Over The Cloud (or OTC), a fleet of connected devices.</p><p id="p0041" num="0041">Instead of a phone 12, it may be any other device including means for processing data, comprising or being connected to Long Range (or LR) Radio-Frequency (or RF) communication means for exchanging data with outside, and comprising or being connected to means for storing data.</p><p id="p0042" num="0042">The LR RF may be fixed at several hundreds of MHz, e.g. around 850, 900, 1800, 1900 and/or 2100 MHz.</p><p id="p0043" num="0043">The phone 12 is used for accessing the network 16.</p><p id="p0044" num="0044">As to the phone 12, it may be any device including means for processing data, comprising or being connected to an LR RF antenna 122 for sending to and/or receiving data from outside, comprising or being connected to means for interfacing with a user, as Man Machine Interface (or MMI), like a keyboard 124, a loudspeaker (not represented) and/or a display screen 126, and comprising or being connected to means for storing data.</p><p id="p0045" num="0045">The phone 12 may be connected to or include Contact-Less (or CL) communication means for exchanging data, like e.g. a Wi-Fi link (not represented), with outside, such as a server (not represented).</p><p id="p0046" num="0046">Within the present description, the adjective "contact-less" denotes notably that the communication means communicates via one or several Short Range (or SR) RF links.</p><p id="p0047" num="0047">The SR RF link may be related to any CL technology that allows the phone 12 to exchange data through a CL link with outside. The SR RF may be related to, e.g. a<!-- EPO <DP n="7"> --> Near Field Communication (or NFC), a Wi-Fi and/or a Bluetooth type communication technology(ies) or the like, as a non-mobile (radio-)communication channel.</p><p id="p0048" num="0048">Instead of the phone 12, the device for accessing a service may be, for instance, a Machine-to-Machine (or M2M) controller, a set-up box, a desktop computer, a laptop computer, a media-player, a game console, a tablet, a netbook, a handset and/or a Personal Digital Assistance (or PDA) that incorporates or cooperates with a baseband radio processor.</p><p id="p0049" num="0049">The LR RF antenna 122 allows communicating data, through an LR RF link 15, with one or several networks 16.</p><p id="p0050" num="0050">The phone 12 is able to exchange data, in a distant manner, with any entity included or connected to the network 16, like the second server 18.</p><p id="p0051" num="0051">A phone microprocessor, as data processing means, processes data originating from either an internal component or an external entity.</p><p id="p0052" num="0052">A phone memory(ies), as data storing means, may comprise one or several volatile memories and one and/or several non-volatile memories.</p><p id="p0053" num="0053">The phone memory stores data, like user data.</p><p id="p0054" num="0054">The phone memory (or an SE memory) stores an identifier relating to the second server 18.</p><p id="p0055" num="0055">The phone memory stores an Operating System (or OS) and one or several applications to be executed by the phone microprocessor.</p><p id="p0056" num="0056">As supported application(s), there is one or several applications for communicating with an external device, like the second server 18, including an application that allows enrolling an application or a set of applications. The application to be enrolled may be a mobile payment application, a mobile wallet application, as application set, that includes several applications that need an enrolment prior to its(their) use by the phone user.</p><p id="p0057" num="0057">The invention application supported by the phone 12 or termed (phone) enrolment application allows getting, in a seamless manner, a token(s), as credentials to be used for accessing one or several services.</p><p id="p0058" num="0058">To get the token(s), the enrolment application allows sending to the second server 18 an enrolment request.</p><p id="p0059" num="0059">The enrolment application allows receiving one or several keys relating to the second server 18, as second server key.<!-- EPO <DP n="8"> --></p><p id="p0060" num="0060">The enrolment application may verify a signature or a certificate relating to the second server 18, so as to authenticate, when the signature or the certificate is successfully verified respectively, a sender of the concerned second server 18 key(s).</p><p id="p0061" num="0061">The enrolment application allows sending to the second server 18 a request for getting one or several tokens along with one or several keys relating to the enrolment application. The enrolment application key is ciphered by using a received second server key.</p><p id="p0062" num="0062">The enrolment application allows receiving one or several ciphered tokens and deciphering the ciphered token(s). Such a token(s) originates from the second server 18 by using a second server 18 key.</p><p id="p0063" num="0063">The enrolment application allows storing within a phone memory or a chip memory the received token(s). The received token(s) allow(s) the enrolment application to be authenticated to access the service.</p><p id="p0064" num="0064">The received token(s) may be stored after its(their) encryption by using a key, like a key relating to a controller (e.g. a server) of the token(s).</p><p id="p0065" num="0065">The phone memory stores preferentially an application for generating a key, as phone application key, relating to the enrolment application.</p><p id="p0066" num="0066">The phone memory stores a key relating to the enrolment application (to be enrolled). The phone application key may be asymmetric or symmetric.</p><p id="p0067" num="0067">According to a particular embodiment, the phone memory stores an application for ciphering data, like the phone application key, to be sent from the phone 12 to a recipient of the concerned data by using a key either relating to the recipient or that is shared with the recipient. The ciphering application may use a predetermined algorithm, like a Rivest Shamir Adleman (or RSA) type algorithm, and a key relating to the second server 18, as addressee of the phone application key.</p><p id="p0068" num="0068">The phone memory stores an application for deciphering data, like a token(s), to be received from the second server 18 by using preferably a key relating to the phone application. The deciphering application may use a predetermined algorithm, such as an Advanced Encryption Standard (or AES), a Data Encryption Standard (or DES) type algorithm or the like, and a key relating to the second server 18, as addressee of the phone application key.</p><p id="p0069" num="0069">The phone MMI allows a phone user to interact with the phone 12, the chip 14 or a device external to the mobile equipment, like a remote server. Such a phone user<!-- EPO <DP n="9"> --> interaction may be used notably for providing, over a non-mobile communication network, a remote server with a downloaded token(s), so as to access a service.</p><p id="p0070" num="0070">The phone 12 plays preferably a role of a modulator-demodulator (or modem) notably for the chip 14.</p><p id="p0071" num="0071">The phone 12 is preferably coupled or connected to the chip 14.</p><p id="p0072" num="0072">The phone I/O interfaces include one or several I/O interfaces for exchanging data with the chip 14.</p><p id="p0073" num="0073">The chip 14 is under control of the phone microprocessor.</p><p id="p0074" num="0074">Alternately, instead of being coupled to the chip 14, the phone memory(ies) stores data stored within the chip 14 as described infra.</p><p id="p0075" num="0075">According to a particular embodiment, the chip 14 is soldered to a Printed Circuit Board (or PCB) of the phone 12.</p><p id="p0076" num="0076">Alternatively, the phone I/O interface with the chip 14 is an International Organization for Standardization (or ISO) 7816 type interface, as contact interface, when the chip 14 is inserted, in a removable manner, within the phone 12.</p><p id="p0077" num="0077">Alternately, instead of a contact interface, the phone I/O interface with the chip 14 is connected to or includes a CL interface.</p><p id="p0078" num="0078">The chip 14 belongs to a user, as subscriber to a wireless service(s).</p><p id="p0079" num="0079">The chip 14 is connected, through a bi-directional link 13, to the phone 12, as a chip host device.</p><p id="p0080" num="0080">The chip 14 includes a microprocessor(s) 142, as data processing means, a memory(ies) 144, as data storing means, and one or several I/O interfaces 146 that are internally all connected, through an internal bidirectional data bus 143, to each other.</p><p id="p0081" num="0081">The I/O interface(s) 146 allow(s) communicating data from the internal chip components to the chip exterior and conversely.</p><p id="p0082" num="0082">The (chip) memory 144 stores an OS.</p><p id="p0083" num="0083">The memory 144 stores data relating to one or several subscriptions.</p><p id="p0084" num="0084">The data relating to one subscription include:
<ul><li>an International Mobile Subscriber Identity (or IMSI), as subscriber and service subscription identifier for accessing a (mobile radio-communication) network 16;</li><li>a key Ki, as network authentication key, allowing to authenticate the concerned subscriber to the network 16; and<!-- EPO <DP n="10"> --></li><li>Milenage or any other authentication algorithm allowing to authenticate the concerned subscriber to the network 16.</li></ul></p><p id="p0085" num="0085">The IMSI is used for identifying a subscriber to an MNO or the like.</p><p id="p0086" num="0086">The IMSI is associated, at the network 16 side, with an identifier(s) relating to a device user, like a Mobile Subscriber Integrated Services Digital network Number (or MSISDN) and/or an URI.</p><p id="p0087" num="0087">The microprocessor 142 processes, controls and communicates internally data with all the other components incorporated within the chip and, through the I/O interface(s) 146, with the chip exterior.</p><p id="p0088" num="0088">The microprocessor 142 executes or runs one or several applications.</p><p id="p0089" num="0089">As application(s) supported by the chip 14, there is one or several Subscriber Identity Module (or SIM) type applications for authenticating a subscriber/chip/host device to a (mobile) network(s) 16.</p><p id="p0090" num="0090">The SIM type application(s) includes, among others, a SIM application for a type Global Service for Mobiles (or GSM) network, a Universal Subscriber Identity Module (or USIM) application for a Universal Mobile Telecommunications System (or UMTS) type network, a Code Division Multiple Access (or CDMA) Subscriber Identity Module (or CSIM) application and/or an Internet protocol Multimedia Subsystem (or IMS) Subscriber Identity Module (or ISIM) application.</p><p id="p0091" num="0091">The SIM type application(s) is(are) stored within the chip memory 144.</p><p id="p0092" num="0092">The SIM type application(s) allow(s) the phone 12 to identify and to authenticate to one or several networks 16 and more exactly a (mobile) network authentication server, like, e.g. a Home Location Register (or HLR) relating to a GSM and/or UMTS type network(s) or a Home Subscriber Server (or HSS) relating to a LTE type network.</p><p id="p0093" num="0093">The microprocessor 142 executes, in a preferred manner, one or several security functions.</p><p id="p0094" num="0094">The security functions include preferably a user authentication process to be used prior to continuing an execution of an application, like the enrolment application, that has to be executed by the phone 12 or the chip 14. To authenticate the user, the user has to provide a Personal Identity Number (or PIN) or biometric data, as user reference data. The user reference data is securely stored within the (chip) memory 144.</p><p id="p0095" num="0095">The microprocessor 142 is preferably able to initiate actions, in order to interact directly with the outside world, in an independent manner of the phone 12, as a chip<!-- EPO <DP n="11"> --> host device. Such a capacity of interaction at the initiative of the chip 14 is also known as a proactive capacity. According to one preferred embodiment, the chip 14 is able to use a SIM ToolKit (or STK) type command, as a proactive command to be sent to the chip host device.</p><p id="p0096" num="0096">The chip 14 is thus able to send, at its (own) initiative, through its host, to any device connected to the host data by using a proactive command for sending a message to the concerned device to be addressed. The device to be addressed, like an entity for authenticating the subscriber/chip/host, may be included within or connected to the network 16.</p><p id="p0097" num="0097">The network 16 may be constituted by a GSM, a General Packet Radio Service (or GPRS), a UMTS, a UTRAN (acronym for "UMTS Terrestrial Radio Access Network"), an EDGE (acronym for "Enhanced Data Rates for GSM Evolution"), a Code Division Multiple Access (or CDMA), a WLAN (acronym for "Wide Local Area Network") and/or a Long Term Evolution (or LTE) type network(s).</p><p id="p0098" num="0098">Such a network set is not exhaustive but only for exemplifying purposes.</p><p id="p0099" num="0099">The network 16 is connected to (and/or comprises) at least one Internet type network.</p><p id="p0100" num="0100">The network 16 includes a Short Message Service Center (or SMS-C) or the like, as a mobile network entity.</p><p id="p0101" num="0101">As known per se, the SMS-C is able to receive, store and forward a Short Message Service (or SMS) type message to its or their specified addressee devices.</p><p id="p0102" num="0102">The network 16 includes a network entity, such as a Home Location Register (or HLR) (not represented), a Home Subscriber Server (or HSS) 164 or the like, as a mobile network server (not represented).</p><p id="p0103" num="0103">As known per se, the HLR adds, as routing information, within an SMS type message, an MSISDN, as an identifier that is associated with the phone 12 and that allows reaching the phone 12, as an addressee of an SMS type message. The MSISDN, as a phone user identifier, is used for routing a call to the concerned subscriber.</p><p id="p0104" num="0104">The network 16 includes, e.g. a Gateway GPRS Support Node (or GGSN) equipment, as a mobile network server and first server 162.</p><p id="p0105" num="0105">The first server 162 is only known to the network 16 operator and the second server 18.<!-- EPO <DP n="12"> --></p><p id="p0106" num="0106">The first server 162 is identified by a Uniform Resource Identifier (or URI), like an Uniform Resource Locator (or URL), an Internet Protocol (or IP) address or the like, as an identifier relating to the first server 162.</p><p id="p0107" num="0107">The first server 162 may be operated by a mobile radio-communication network operator, as a Mobile Network Operator (or MNO) or a Mobile Virtual Network Operator (or MVNO), a service provider or on its behalf.</p><p id="p0108" num="0108">The first server 162 is hosted by a computer.</p><p id="p0109" num="0109">The first server 162 includes a processor(s) (not represented), as data processing means, comprises and/or is connected to a memory(ies) (not represented), as data storing means, and one or several I/O interfaces (not represented).</p><p id="p0110" num="0110">The first server memory stores a predetermined identifier relating to the second server 18.</p><p id="p0111" num="0111">The first server 162 is dedicated to running an application for managing a first database and communicating data of the first database to outside, when applicable.</p><p id="p0112" num="0112">The first database includes a set in which each client device is identified and associated with one (or several) updated identifier(s) relating to the concerned client device. Each (identified) client device is accessible by using the updated (client) device identifier that is valid for addressing the client device.</p><p id="p0113" num="0113">The updated client device (user) identifier(s) may include:
<ul><li>an MSISDN;</li><li>an IMSI;</li><li>a Temporary Mobile Subscriber Identity (or TMSI); and/or</li><li>a URI.</li></ul></p><p id="p0114" num="0114">Once the first server 162 has retrieved the corresponding (updated) client device user identifier, the first server 162 writes it within the first database in association with the client device included within the client device set.</p><p id="p0115" num="0115">The first server 162 thus tracks each managed client device.</p><p id="p0116" num="0116">The first server 162 plays a role of a gateway between the (mobile) network 16 and one or several external Internet Protocol (or IP) type networks (not represented).</p><p id="p0117" num="0117">The first server 162 is able to receive a message received from a managed client device, as a sender that is identified within the received message, while keeping the message content and inserting an (updated) identifier relating to the client device user, and to send a thus generated message to the second server 18.<!-- EPO <DP n="13"> --></p><p id="p0118" num="0118">The first server 162 is able to detect a predetermined URI, URL, IP address or the like, as an identifier relating to the second server 18, that is comprised within a message to be received.</p><p id="p0119" num="0119">The first server 162 is thus able to intercept a message originating from a registered client device connected to the network 16 and including an identifier relating to the second server 18.</p><p id="p0120" num="0120">The sender of the intercepted message is the client device entity that addresses the intercepted message to the second server 18.</p><p id="p0121" num="0121">The intercepted message comprises the second server 18 identifier, as an addressee or recipient of the received message.</p><p id="p0122" num="0122">The first server 162 generates a message that includes the content of the intercepted message by inserting notably an identifier relating to a client device user that is associated with an identifier of the sender of the intercepted message.</p><p id="p0123" num="0123">The first server 162 may further insert within the generated message an identifier relating to a predetermined connection point relating to the second server 18, so as to connect, via a dedicated and secured channel, to the second server 18.</p><p id="p0124" num="0124">The second server 18, like a Cloud Enrolment Service (or C.E.S.) server, as application server, is connected, through a bi-directional link 17, to the network 16.</p><p id="p0125" num="0125">The second server 18 is identified by a URI, like an URL, an IP address or the like, as an identifier relating to the second server 18. The second server identifier may be stored within a phone memory or the chip memory 144.</p><p id="p0126" num="0126">The second server 18 may be operated by a service provider or on its behalf.</p><p id="p0127" num="0127">The second server 18 is hosted by a computer.</p><p id="p0128" num="0128">The second server 18 includes a processor(s) (not represented), as data processing means, comprises and/or is connected to a memory(ies) (not represented), as data storing means, and one or several I/O interfaces (not represented).</p><p id="p0129" num="0129">The second server 18 memory stores a database. The database includes a predetermined set of one or several identifiers relating to device users, as a white list and/or a black list. Such a device user identifier set associates information relating to either an authorization for accessing the requested service or an interdiction for accessing the requested service with each device user identifier.<!-- EPO <DP n="14"> --></p><p id="p0130" num="0130">The second server 18 memory stores one or several keys relating to the second server 18, like a private key and a corresponding public key relating to the second server 18 or a symmetric key to be shared with a client device.</p><p id="p0131" num="0131">The second server 18 memory stores, for each identified device user, one or several tokens, as credentials to be used for accessing one or several services.</p><p id="p0132" num="0132">The second server 18 is dedicated to running an application for managing a second database and communicating a token(s) of the second database to outside.</p><p id="p0133" num="0133">The invention application supported by the second server 18 or termed server enrolment application allows providing securely a requesting device with a token(s).</p><p id="p0134" num="0134">The second server 18 is configured to receive, through possibly the first server 162, from a (client) device, like the phone 12, an enrolment request.</p><p id="p0135" num="0135">The second server 18 is arranged to send to the identified device application one or several keys relating to the second server 18.</p><p id="p0136" num="0136">The second server 18 sends preferably to the identified device application a certificate including one or several public keys relating to the second server 18 or a key to be shared with the sender of the enrolment request.</p><p id="p0137" num="0137">Alternately, the second server 18 signs the (second) server key(s) and sends to the sender of the enrolment request the (second) server key(s) along with the associated signature.</p><p id="p0138" num="0138">The second server 18 is further arranged to receive a request for getting one or several tokens along with one or several keys relating to the enrolment application supported by a requesting device, as device application key(s). The device application key(s) is(are) preferentially ciphered at the requesting device side by using the second server 18 key.</p><p id="p0139" num="0139">The second server 18 is configured to receive an identifier relating to a device user.</p><p id="p0140" num="0140">The second server 18 uses the device user identifier for proving that the device user is registered to a mobile network 16 and has previously been successfully authenticated since the device user identifier is to be provided by the first server 162, as a mobile network controller.</p><p id="p0141" num="0141">The second server 18 is adapted to verify whether the identified device user is or is not authorized to access the (requested) service.<!-- EPO <DP n="15"> --></p><p id="p0142" num="0142">If the identified device user is not authorized to access the service, then the second server 18 aborts the thus launched enrolment process and no token is issued to the requesting device. The second server 18 may further inform the requesting device user that she or he will not be provided with any token. The identified device user will therefore not be able to access a service that needs to be provided with a token(s).</p><p id="p0143" num="0143">Otherwise, i.e. only if the identified device user is authorized, the second server 18 is arranged to continue the launched enrolment process. The second server 18 is preferably able to decipher the device application key(s) by using either a private key relating to the second server 18 that corresponds to the public key relating to the second server 18 or a key shared with the requesting device. The second server 18 may generate one or several tokens. The second server 18 is preferentially able to cipher the token(s) to be sent by using a key relating to an application supported by the requesting device, as device application key.</p><p id="p0144" num="0144">The second server 18 is able to send to the requesting device the token(s) that is(are) preferably ciphered.</p><p id="p0145" num="0145"><figref idrefs="f0001"><b>Figure 2</b></figref> depicts an exemplary embodiment of a message flow 20 that involves the phone 12, as a user terminal, the first server 162, as a mobile network entity, and the second server 18, as an application server.</p><p id="p0146" num="0146">In the described example, it is assumed that the phone 12 is connected to the mobile network 16. In other words, the phone user has subscribed to a mobile (communication) network service allowing to communicate to or through the mobile network 16 and the phone 12 is authenticated to a mobile network server.</p><p id="p0147" num="0147">It is further assumed that the phone 12 exchanges with the second server 18 by using e.g. HyperText Transfer Protocol (or HTTP) type messages or HTTP/SMS type messages. However, any other data communication protocol between the phone 12 and the server 18, like e.g. a Secure Sockets Layer (or SSL) protocol, may be used alternatively or additionally to the HTTP and/or SMS protocol(s).</p><p id="p0148" num="0148">While it is specified infra that the phone 12 exchanges with the second server 18, more exactly, it is a (phone) enrolment application that exchanges with a (second) server enrolment application.</p><p id="p0149" num="0149">The phone 12 sends to the second server 18 a first message 22 including an enrolment request, such as an "HTTP://g-host/enroll/initiate", as a request of the type "HTTP GET".<!-- EPO <DP n="16"> --></p><p id="p0150" num="0150">The enrolment request includes a predetermined URL relating to the second server 18, as a particular second server identifier.</p><p id="p0151" num="0151">According to a particular invention embodiment (represented), the predetermined second server identifier is to be detected or found by the first server 162.</p><p id="p0152" num="0152">The first server 162, as a mobile network entity, intercepts the first message 22 including the enrolment request by detecting the predetermined second server identifier, as a recipient device of the first message 22.</p><p id="p0153" num="0153">The first server 162 gets from a retrieved subscription identifier, like an IMSI, that is used by the mobile network 16 to identify the mobile equipment 10 (i.e. the phone 12/chip 14 system), a corresponding MSISDN, as an identifier relating to a phone user.</p><p id="p0154" num="0154">Once the first server 162 has retrieved the phone user identifier, the first server 162 generates based on the first message 22 a second message 24 including the enrolment request, by inserting the phone user identifier within a header of the second message 24. The second message 24 includes, besides the first message 22 content, the corresponding MSISDN, as the phone user identifier.</p><p id="p0155" num="0155">The first server 162 may further insert within a thus generated second message an identifier relating to a predetermined connection point relating to the second server 18. The predetermined second server connection point identifier allows addressing a connection point that is dedicated to accessing the second server 18 for an application enrollment process.</p><p id="p0156" num="0156">According to an alternative (not represented), instead of passing the enrolment request through the first server 162, the phone 12 sends directly to the second server 18 a unique message including an enrolment request, such as an "HTTP://ghost/enroll/initiate", as a request of the type "HTTP GET". The unique message does not include any phone user identifier. The message includes preferably an identifier relating to a predetermined connection point relating to the second server 18 that allows addressing a connection point that is dedicated to accessing the second server 18 for an application enrollment process. According to such an alternative, the first server 162 is not involved to transmit to the second server 18 the enrolment request accompanied with a phone user identifier. According to such an alternative, the second server 18 does not therefore receive any phone user identifier.<!-- EPO <DP n="17"> --></p><p id="p0157" num="0157">Then, the first server 162 sends to the second server 18 the second message 24, such as an "HTTP://g-host/enroll/initiate", as a request of the type "HTTP GET", that includes the corresponding MSISDN, as the phone user identifier.</p><p id="p0158" num="0158">Subsequently, based on the open socket relating to the IP at the second server 18 side, the second server 18 sends back to the phone 12 a message 26, as a response of the type "HTTP response 200 OK", including preferably a certificate, like a X.509 type certificate, including one (or several) public key(s) relating to the second server 18. Such a second server certificate transmission allows transferring to the phone 12 a second server key.</p><p id="p0159" num="0159">The phone 12 verifies whether the received certificate is or is not a genuine certificate originating from the second server 18.</p><p id="p0160" num="0160">If the received certificate is not a genuine certificate relating to the second server 18, then the phone 12 aborts the launched application enrolment process.</p><p id="p0161" num="0161">Otherwise, i.e. only if the received certificate is a genuine certificate originating from the second server 18, the phone 12 goes ahead in the application enrolment process.</p><p id="p0162" num="0162">When the phone 12 has successfully verified the certificate as a genuine certificate that originates from the second server 18, the phone 12 retrieves a key relating to the phone enrolment application, as a transport key TK.</p><p id="p0163" num="0163">The phone 12 may have previously generated the transport key TK.</p><p id="p0164" num="0164">The phone 12 extracts from the received genuine certificate the public key relating to the second server 18, as a public (second) server 18 key.</p><p id="p0165" num="0165">The phone 12 ciphers preferably the transport key TK by using the public server 18 key and a predetermined algorithm, like an RSA type algorithm. The phone 12 gets thus a ciphered transport key [TK].</p><p id="p0166" num="0166">Then, the phone 12 sends to the second server 18 a third message 28 including a request, such as an "HTTP://g-host/enroll/getAccessToken?TK=[CTK]", as a request of the type "HTTP GET", for getting one or several tokens accompanied with the ciphered transport key denoted [CTK].</p><p id="p0167" num="0167">The third message 28 includes a predetermined URL relating to the second server 18, as a particular second server identifier.</p><p id="p0168" num="0168">According to a particular invention embodiment (represented), the predetermined second server identifier is to be detected or found by the first server 162. The first<!-- EPO <DP n="18"> --> server 162 intercepts the third message 28 including the token request by detecting the predetermined identifier relating to the second server 18, as a recipient of the third message 28.</p><p id="p0169" num="0169">The first server 162 gets from a retrieved subscription identifier, like an IMSI, that is used by the mobile network 16 to identify the mobile equipment 10 (i.e. the phone 12/chip 14 system), a corresponding MSISDN, as a phone user identifier.</p><p id="p0170" num="0170">Once the first server 162 has retrieved the phone user identifier, the first server 162 generates a fourth message 210 including the token request, by inserting the phone user identifier within a header of the fourth message 210. The fourth message 210 includes the corresponding phone user identifier.</p><p id="p0171" num="0171">Then, the first server 162 sends to the second server 18 the fourth message 210 including the token request, such as an "HTTP://ghost/enroll/getAccessToken?TK=[CTK]", as a request of the type "HTTP GET", for getting one or several tokens accompanied with the ciphered transport key [CTK].</p><p id="p0172" num="0172">The first server 162 may further insert within a thus generated message an identifier relating to a predetermined connection point relating to the second server 18. The predetermined second server connection point identifier allows addressing a connection point that is dedicated to accessing the second server 18 for an application enrollment process.</p><p id="p0173" num="0173">The second server 18 receives within the fourth message 210 the concerned phone user identifier.</p><p id="p0174" num="0174">Then, the second server 18 verifies whether the identified phone user is or is not authorized to access the (requested) service. When authorized, the received phone user identifier constitutes a proof that the considered phone user has been previously authenticated by a corresponding mobile network server.</p><p id="p0175" num="0175">If the identified phone user is not authorized to access the service, then the second server 18 aborts the launched application enrolment process.</p><p id="p0176" num="0176">Otherwise, i.e. only if the identified phone user is authorized to access the service, the second server 18 deciphers the ciphered transport key [CTK] by using a corresponding private key relating to the second server 18. Furthermore, the second server 18 may generate one or several tokens that allow the second server 18 interlocutor to be authenticated to access a requested service.<!-- EPO <DP n="19"> --></p><p id="p0177" num="0177">The second server 18 fetches the stored token(s), like a kind of identifier denoted ApplicationTokenldentifier (or ATI) and a kind of key denoted AuthorizationTokenSecret (or ATS). The second server 18 ciphers the token(s) by using the transport key TK, as the phone application key. The resulting ciphered tokens are denoted [ATI and ATS] TK.</p><p id="p0178" num="0178">According to an alternative (not represented), instead of using an HTTP type message and involving the first server 162, the phone 12 sends, through two mobile network entities, e.g. an HLR and an SMS-C, to the second server 18 an SMS type message, as a third message, including an enrolment request and a ciphered phone application key. The first server 162 is thus not involved to transmit to the second server 18 the SMS type message. The SMS type message is preferably an SMS-Mobile Originated (or MO) message. As known per se, the HLR gets, as routing information, the corresponding MSISDN, as the phone user identifier associated with the phone 12 that allows reaching the phone 12. The SMS-C generates an SMS type message, as a fourth message, by inserting the corresponding phone user identifier to the received SMS type message and forwards the fourth message to the second server 18 as the addressee or recipient specified within the third message.</p><p id="p0179" num="0179">Subsequently, based on the open socket relating to the IP at the second server 18 side, the second server 18 sends back to the phone 12 a fifth message 212, like an "HTTP response 200 OK", as an HTTP type response to the previous received HTTP request, that includes one or several ciphered tokens [ATI, ATS] TK.</p><p id="p0180" num="0180">Likewise, according to the alternative (not represented), instead of using an HTTP type message and involving the first server 162, the second server 18 sends to the phone 12 one or several SMS type messages, as the fifth message, including one or several ciphered tokens [ATI, ATS] TK. The first server 162 is thus not involved to transmit to the phone 12 the SMS type message. The SMS type message is preferably an SMS-Mobile Terminated (or MT) message.</p><p id="p0181" num="0181">The phone 12 deciphers the ciphered tokens ATI, ATS.</p><p id="p0182" num="0182">Once deciphered, the phone 12 stores the tokens ATI, ATS that allow the phone 12 to access one or several services.</p><p id="p0183" num="0183">The phone 12 sends preferably to the second server 18 a sixth message 214 including a request, such as an "HTTP://g-host/enroll/commit", as a request of the type "HTTP GET", for committing to the second server 18 along with a corresponding<!-- EPO <DP n="20"> --> signature that the phone 12 generates by using e.g. the ATS, as one or several received tokens.</p><p id="p0184" num="0184">The second server 18 verifies whether the signature is valid or not.</p><p id="p0185" num="0185">If the signature is not valid, then the second server 12 does not allow the phone 12 to use the issued tokens by e.g. invalidating the issued tokens.</p><p id="p0186" num="0186">Otherwise, i.e. if the signature is valid, the second server 12 sends back to the phone 12 an "HTTP response 200 OK" 216, as an HTTP type response to the previous received HTTP request 214, so as to validate the issued tokens.</p><p id="p0187" num="0187">The invention solution allows thus providing, in a seamless and secure manner, the phone application with one or several tokens without needing to involve the phone user (except for her or his authentication to unlock an authentication key for a phone authentication before a mobile network entity, like an HLR or an HSS).</p><p id="p0188" num="0188">Subsequently, the phone 12 uses the stored token(s), as authentication data allowing the phone application to be authenticated, so as to access a corresponding service(s) through either a mobile network channel, such as an MNO's 3GPP network, or a non-mobile network channel, like a Wi-Fi network.</p></description><claims mxw-id="PCLM90459133" lang="EN" load-source="patent-office"><!-- EPO <DP n="21"> --><claim id="c-en-0001" num="0001"><claim-text>A method (20) for accessing a service,<br/>
<b>characterized in that</b> the method comprises the following steps:
<claim-text>- a device (12) authenticates to a mobile network server;</claim-text>
<claim-text>- the device sends to an application server (18) an enrolment request (22);</claim-text>
<claim-text>- the application server sends to the device at least one key (26) relating to the application server;</claim-text>
<claim-text>- the device sends to the application server a request (28) for getting at least one token accompanied with at least one key relating to a device application, the device application key being ciphered by using the application server key;</claim-text>
<claim-text>- the application server receives an identifier (210) relating to a device user;</claim-text>
<claim-text>- the application server verifies whether the identified device user is or is not authorized to access the service;</claim-text>
<claim-text>- only if the identified device user is authorized, the application server deciphers the ciphered device application key and ciphers at least one token by using the device application key;</claim-text>
<claim-text>- the application server sends to the device at least one ciphered token (212);</claim-text>
<claim-text>- the device deciphers the at least one ciphered token;</claim-text>
<claim-text>- the device stores the at least one token, the at least one token allowing the device application to be authenticated.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>Method according to claim 1, wherein, prior to receiving, by the application server, an identifier relating to a device user, the method further includes:
<claim-text>- a mobile network entity (162) intercepts a first message (22) including the enrolment request, by detecting a predetermined identifier relating to the application server, as a recipient device;</claim-text>
<claim-text>- the mobile network entity inserts within a second message including the enrolment request the identifier relating to a device user; and</claim-text>
<claim-text>- the mobile network entity sends to the application server the second message (24).</claim-text></claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>Method according to claim 2, wherein the mobile network entity further inserts within the second message including the enrolment request an identifier relating to a predetermined connection point relating to the application server.<!-- EPO <DP n="22"> --></claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>Method according to any previous claim, wherein the application server sends to the device a certificate including at least one public key relating to the application server and, prior to sending the device application key, the device verifies successfully that the server certificate is a genuine certificate.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>Method according to any previous claim, wherein a mobile network entity (162) intercepts a third message (28) including the token request and the device application key;
<claim-text>- the mobile network entity inserts the identifier relating to a device user within a fourth message including the token request and the device application key; and</claim-text>
<claim-text>- the mobile network entity sends to the application server the fourth message (210).</claim-text></claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>Method according to any previous claim, wherein the token request and the device application key are included within an HTTP type message or an SMS type message.</claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>Method according to any previous claim, wherein the device sends to the application server a request (214) for committing to the application server accompanied with a signature generated by using at least one received token, the application server verifies whether the signature is or is not valid, and, only if the signature is valid, the application server sends to the device an approval (216) for establishing at least one communication session.</claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>An application server (18) for accessing a service,<br/>
<b>characterized in that</b> the server is configured:
<claim-text>- to receive an enrolment request (24) ;</claim-text>
<claim-text>- to send to the device at least one key (26) relating to the application server;</claim-text>
<claim-text>- to receive a request (210) for getting at least one token accompanied with at least one key relating to a device application, the device application key being ciphered by using the server key;</claim-text>
<claim-text>- to receive an identifier (210) relating to a device user;</claim-text>
<claim-text>- to verify whether the identified device user is or is not authorized to access the service;</claim-text>
<claim-text>- to decipher, only if the identified device user is authorized, the ciphered device application key;<!-- EPO <DP n="23"> --></claim-text>
<claim-text>- to cipher at least one token by using the device application key; and</claim-text>
<claim-text>- to send to the device at least one ciphered token (212).</claim-text></claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>A device (12) for accessing a service,<br/>
<b>characterized in that</b> the device is configured:
<claim-text>- to authenticate to a mobile network server;</claim-text>
<claim-text>- to send to an application server an enrolment request (22);</claim-text>
<claim-text>- to receive at least one key (26) relating to the application server;</claim-text>
<claim-text>- to send to the application server a request (28) for getting at least one token accompanied with at least one key relating to a device application, the device application key being ciphered by using the application server key;</claim-text>
<claim-text>- to receive at least one ciphered token (212);</claim-text>
<claim-text>- to decipher the at least one ciphered token;</claim-text>
<claim-text>- to store the at least one token, the at least one token allowing the device application to be authenticated.</claim-text></claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>A system for accessing a service,<br/>
<b>characterized in that</b>, the system comprising a device (12) and an application server (18), the device being connected to the application server, the device is configured:
<claim-text>- to authenticate to a mobile network server;</claim-text>
<claim-text>- to send to the application server an enrolment request (22);</claim-text>
<b>in that</b> the application server is configured:
<claim-text>- to send to the device at least one key (26) relating to the application server;</claim-text>
<claim-text>- to receive an identifier (210) relating to a device user;</claim-text>
<claim-text>- to verify whether the identified device user is or is not authorized to access the service;</claim-text>
<claim-text>- to decipher, only if the identified device user is authorized, the ciphered device application key and to cipher at least one token by using the device application key;</claim-text>
<claim-text>- to send to the device at least one ciphered token (212);</claim-text>
and <b>in that</b> the device is configured:
<claim-text>- to decipher the at least one ciphered token; and</claim-text>
<claim-text>- to store the at least one token, the at least one token allowing the device application to be authenticated.</claim-text></claim-text></claim></claims><drawings mxw-id="PDW20421871" load-source="patent-office"><!-- EPO <DP n="24"> --><figure id="f0001" num="1,2"><img id="if0001" file="imgf0001.tif" wi="139" he="233" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="157" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="157" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
