<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2961218-A1" country="EP" doc-number="2961218" kind="A1" date="20151230" family-id="51672913" file-reference-id="260144" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160451124" ucid="EP-2961218-A1"><document-id><country>EP</country><doc-number>2961218</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-14783339-A" is-representative="YES"><document-id mxw-id="PAPP193865216" load-source="docdb" format="epo"><country>EP</country><doc-number>14783339</doc-number><kind>A</kind><date>20140409</date><lang>ZH</lang></document-id><document-id mxw-id="PAPP193865217" load-source="patent-office" format="original"><country>EP</country><doc-number>14783339.6</doc-number><date>20140409</date><lang>ZH</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162029141" ucid="CN-201310121350-A" load-source="docdb"><document-id format="epo"><country>CN</country><doc-number>201310121350</doc-number><kind>A</kind><date>20130409</date></document-id></priority-claim><priority-claim mxw-id="PPC162028218" ucid="CN-2014074936-W" load-source="docdb"><document-id format="epo"><country>CN</country><doc-number>2014074936</doc-number><kind>W</kind><date>20140409</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1969294721" load-source="ipcr">H04W  28/18        20090101AFI20160205BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1981007853" load-source="docdb" scheme="CPC">H04W  72/0446      20130101 LI20160121BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1981011479" load-source="docdb" scheme="CPC">H04W  84/12        20130101 LA20160121BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1981011958" load-source="docdb" scheme="CPC">H04W  28/26        20130101 FI20160121BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1981013144" load-source="docdb" scheme="CPC">H04W  74/0816      20130101 LI20160122BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1981014425" load-source="docdb" scheme="CPC">H04W  74/04        20130101 LI20160121BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987799341" load-source="docdb" scheme="CPC">H04W  72/12        20130101 LA20150216BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165544838" lang="DE" load-source="patent-office">VERFAHREN UND VORRICHTUNG ZUR RESSOURCENRESERVIERUNG</invention-title><invention-title mxw-id="PT165544839" lang="EN" load-source="patent-office">METHOD AND DEVICE FOR RESOURCE RESERVATION</invention-title><invention-title mxw-id="PT165544840" lang="FR" load-source="patent-office">PROCÉDÉ ET DISPOSITIF DE RÉSERVATION DE RESSOURCES</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR1103310811" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>HUAWEI DEVICE CO LTD</last-name><address><country>CN</country></address></addressbook></applicant><applicant mxw-id="PPAR1103326642" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>HUAWEI DEVICE CO., LTD.</last-name></addressbook></applicant><applicant mxw-id="PPAR1101653676" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Huawei Device Co., Ltd.</last-name><iid>101239330</iid><address><street>Building B2 Huawei Industrial Base Bantian Longgang District</street><city>Shenzhen, Guangdong 518129</city><country>CN</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103325353" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>DU ZHENGUO</last-name><address><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR1103336288" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>DU, Zhenguo</last-name></addressbook></inventor><inventor mxw-id="PPAR1101646734" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>DU, Zhenguo</last-name><address><street>Huawei Administration Building Bantian Longgang</street><city>Shenzhen Guangdong 518129</city><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR1103306954" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>FANG PING</last-name><address><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR1103321042" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>FANG, PING</last-name></addressbook></inventor><inventor mxw-id="PPAR1101645190" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>FANG, PING</last-name><address><street>Huawei Administration Building Bantian Longgang</street><city>Shenzhen Guangdong 518129</city><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR1103321803" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>DING ZHIMING</last-name><address><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR1103342576" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>DING, ZHIMING</last-name></addressbook></inventor><inventor mxw-id="PPAR1101650837" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>DING, ZHIMING</last-name><address><street>Huawei Administration Building Bantian Longgang</street><city>Shenzhen Guangdong 518129</city><country>CN</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR1101650216" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Goddar, Heinz J.</last-name><iid>100002032</iid><address><street>Boehmert &amp; Boehmert Anwaltspartnerschaft mbB Patentanwälte Rechtsanwälte Pettenkoferstrasse 20-22</street><city>80336 München</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="CN-2014074936-W"><document-id><country>CN</country><doc-number>2014074936</doc-number><kind>W</kind><date>20140409</date><lang>ZH</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2014166379-A1"><document-id><country>WO</country><doc-number>2014166379</doc-number><kind>A1</kind><date>20141016</date><lang>ZH</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS660681515" load-source="docdb">AL</country><country mxw-id="DS660680238" load-source="docdb">AT</country><country mxw-id="DS660606366" load-source="docdb">BE</country><country mxw-id="DS660604415" load-source="docdb">BG</country><country mxw-id="DS660604246" load-source="docdb">CH</country><country mxw-id="DS660606375" load-source="docdb">CY</country><country mxw-id="DS660680251" load-source="docdb">CZ</country><country mxw-id="DS660681517" load-source="docdb">DE</country><country mxw-id="DS660606376" load-source="docdb">DK</country><country mxw-id="DS660606377" load-source="docdb">EE</country><country mxw-id="DS660781755" load-source="docdb">ES</country><country mxw-id="DS660604416" load-source="docdb">FI</country><country mxw-id="DS660604251" load-source="docdb">FR</country><country mxw-id="DS660681518" load-source="docdb">GB</country><country mxw-id="DS660606378" load-source="docdb">GR</country><country mxw-id="DS660681527" load-source="docdb">HR</country><country mxw-id="DS660680252" load-source="docdb">HU</country><country mxw-id="DS660604252" load-source="docdb">IE</country><country mxw-id="DS660606395" load-source="docdb">IS</country><country mxw-id="DS660604417" load-source="docdb">IT</country><country mxw-id="DS660606396" load-source="docdb">LI</country><country mxw-id="DS660604418" load-source="docdb">LT</country><country mxw-id="DS660680258" load-source="docdb">LU</country><country mxw-id="DS660604423" load-source="docdb">LV</country><country mxw-id="DS660604424" load-source="docdb">MC</country><country mxw-id="DS660680263" load-source="docdb">MK</country><country mxw-id="DS660680264" load-source="docdb">MT</country><country mxw-id="DS660604425" load-source="docdb">NL</country><country mxw-id="DS660604253" load-source="docdb">NO</country><country mxw-id="DS660604426" load-source="docdb">PL</country><country mxw-id="DS660781756" load-source="docdb">PT</country><country mxw-id="DS660681529" load-source="docdb">RO</country><country mxw-id="DS660781757" load-source="docdb">RS</country><country mxw-id="DS660604431" load-source="docdb">SE</country><country mxw-id="DS660603386" load-source="docdb">SI</country><country mxw-id="DS660604254" load-source="docdb">SK</country><country mxw-id="DS660604263" load-source="docdb">SM</country><country mxw-id="DS660606397" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA166479494" lang="EN" load-source="patent-office"><p id="pa01" num="0001">A resource reservation method and apparatus applied to a WiFi system is disclosed, where the method includes: receiving, by a destination node, a resource reservation request sent by a source node, and sending a resource reservation response to the source node, where the resource reservation response includes a reservation time, and the resource reservation response is used to enable another node, which can monitor the resource reservation response, in the WiFi system to set a network allocation vector of the another node according to the reservation time; determining, by the destination node, whether data sent by the source node is received within a predetermined time; and if the data is not received, sending a resource release instruction, so that the another node initializes the network allocation vector of the another node, and re-contends for a resource, thereby solving a hidden node problem and also ensuring that a network resource is fully and properly used.<img id="iaf01" file="imgaf001.tif" wi="78" he="66" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA166759306" lang="EN" source="EPO" load-source="docdb"><p>A resource reservation method and apparatus applied to a WiFi system is disclosed, where the method includes: receiving, by a destination node, a resource reservation request sent by a source node, and sending a resource reservation response to the source node, where the resource reservation response includes a reservation time, and the resource reservation response is used to enable another node, which can monitor the resource reservation response, in the WiFi system to set a network allocation vector of the another node according to the reservation time; determining, by the destination node, whether data sent by the source node is received within a predetermined time; and if the data is not received, sending a resource release instruction, so that the another node initializes the network allocation vector of the another node, and re-contends for a resource, thereby solving a hidden node problem and also ensuring that a network resource is fully and properly used.</p></abstract><description mxw-id="PDES98404195" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><p id="p0001" num="0001">This application claims priority to Chinese Patent Application No. <patcit id="pcit0001" dnum="CN201310121350"><text>201310121350.9, filed with the Chinese Patent Office on April 9, 2013</text></patcit>, which is incorporated herein by reference in its entirety.</p><heading id="h0001"><b>TECHNICAL FIELD</b></heading><p id="p0002" num="0002">The present invention relates to the field of communications technologies, and in particular, to a resource reservation method and apparatus.</p><heading id="h0002"><b>BACKGROUND</b></heading><p id="p0003" num="0003">To resolve a "hidden node" problem that exists in a WiFi network, an RTS/CTS (Request To Send/Clear To Send, request to send/clear to send) mechanism is introduced in the IEEE802.11 standard, where the mechanism is equivalent to a handshake protocol, and a basic principle of the mechanism is that a source node and a destination node separately send a short frame used to reserve a resource, so as to suppress another node from contending for the resource. A specific process may be summarized as follows:</p><p id="p0004" num="0004">First, the source node sends an RTS (Request To Send, request to send) frame to another node in the network, so that a node that monitors the frame sets a NAV (Network Allocation Vector, network allocation vector) of the node according to a time T1 indicated by a duration domain Duration in the RTS frame, and further avoids, in a NAV countdown manner, contending a resource with the source node.</p><p id="p0005" num="0005">Then, after receiving the RTS frame, the destination node sends a CTS (Clear To Send, clear to send) frame to another node in the network after an interval of one SIFS (Short Interframe Space, short interframe space), so that a node that monitors the frame sets a NAV of the node according to a T2 indicated by a Duration domain in the CTS frame, and further avoids, in the NAV countdown manner, contending a resource with the destination node.</p><p id="p0006" num="0006">Finally, after receiving the CTS frame, the source node performs data<!-- EPO <DP n="2"> --> transmission with the destination node after an internal of one SIFS.</p><p id="p0007" num="0007">NAVs of all nodes that receive the RTS frame or the CTS frame are greater than a default value 0, and so long as a NAV is greater than 0, a node considers that data transmission exists around and a channel is in a busy state; therefore, the node does not attempt to contend for the channel, thereby effectively avoiding a node collision. It should be noted that, although the destination node and the source node may also set a NAV value of themselves according to the RTS frame or the CTS frame, the two nodes does not need to determine a channel status according to the NAV value.</p><p id="p0008" num="0008">However, due to influence of interference or random noise, a channel of a WiFi system is usually in an unstable state, and a case in which transmission of the CTS frame fails or the source node fails to parse the CTS frame may occur, which further causes that the source node does not send a subsequent data frame any longer; as a result, the destination node cannot receive, upon expiry of an interval of one SIFS after sending a CTS frame, a data frame sent by the source node. However, after the destination node sends the CTS frame, nodes that can monitor the frame have already set a NAV of themselves according to a time T2. Before the NAV returns to zero, these nodes continues to consider that the channel is in the busy state, and transmission by these nodes is suppressed, which causes a waste of a channel resource in this period of time, and reduces a utilization rate of a network resource.</p><heading id="h0003"><b>SUMMARY</b></heading><p id="p0009" num="0009">A resource reservation method and apparatus in embodiments of the present invention are used to improve resource utilization of a WiFi system.</p><p id="p0010" num="0010">Therefore, the embodiments of the present invention provide the following technical solutions:</p><p id="p0011" num="0011">According to a first aspect, an embodiment of the present invention provides a resource reservation method, where the method is applied to a WiFi system, and the method includes:
<ul><li>receiving, by a destination node, a resource reservation request sent by a source node, and sending a resource reservation response to the source node, where the resource reservation response includes a reservation time, and the resource reservation response is used to enable another node, which can monitor the resource<!-- EPO <DP n="3"> --> reservation response, in the WiFi system to set a network allocation vector of the another node according to the reservation time; and</li><li>determining, by the destination node, whether data sent by the source node is received within a predetermined time; and if the data is not received, sending a resource release instruction, so that the another node initializes the network allocation vector of the another node, and re-contends for a resource.</li></ul></p><p id="p0012" num="0012">In a first possible implementation manner of the first aspect, before the sending a resource release instruction to the another node, the method further includes:
<ul><li>obtaining a remaining time of the reservation time by calculation, and comparing the remaining time with a time required for sending the resource release instruction; and if the remaining time is not less than the time required for sending the resource release instruction, sending the resource release instruction to the another node, where the remaining time is a difference between the reservation time and the predetermined time.</li></ul></p><p id="p0013" num="0013">With reference to the first aspect and the first possible implementation manner of the first aspect, in a second possible implementation manner, the resource reservation response is a first resource reservation response that is sent upon expiry of an interval of one first interframe space after the destination node receives the resource reservation request; and
<ul><li>the sending a resource release instruction to the another node includes:
<ul><li>sending, by the destination node, a first resource release instruction to the another node, so that the another node initializes the network allocation vector according to the first resource release instruction.</li></ul></li></ul></p><p id="p0014" num="0014">With reference to the first aspect and the first possible implementation manner of the first aspect, in a third possible implementation manner, the resource reservation response is a second resource reservation response that is sent upon expiry of an interval of one first interframe space, one first resource reservation response, and one second interframe space after the destination node receives the resource reservation request; and<br/>
the sending a resource release instruction to the another node includes:
<ul><li>sending, by the destination node, a first resource release instruction to the another node, and sending a second resource release instruction to the another node after an interval of one first interframe space, so that the another node initializes the<!-- EPO <DP n="4"> --> network allocation vector according to the first resource release instruction or the second resource release instruction.</li></ul></p><p id="p0015" num="0015">With reference to the first aspect and any possible implementation manner of the first to third possible implementation manners of the first aspect, in a fourth possible implementation manner, <maths id="math0001" num=""><math display="block"><mrow><mi>the predetermined time T</mi><mo>=</mo><mi>aSIFSTime</mi><mo>+</mo><mi>aPHY</mi><mo>-</mo><mi>RX</mi><mo>-</mo><mi>START</mi><mo>-</mo><mi>Delay</mi><mo>+</mo><mi>aSlotTime</mi><mo>;</mo></mrow></math><img id="ib0001" file="imgb0001.tif" wi="149" he="12" img-content="math" img-format="tif"/></maths> where aSIFSTime is a first interframe space; aPHY-RX-START-Delay is a physical layer response time; aSlotTime is a timeslot length.</p><p id="p0016" num="0016">With reference to the first aspect and any possible implementation manner of the first to fourth possible implementation manners of the first aspect, in a fifth possible implementation manner, a manner of obtaining the resource release instruction is as follows:
<ul><li>modifying any one of the resource reservation response, an acknowledgment frame, and a null data packet to obtain the resource release instruction; or</li><li>using a contention-free end frame as the resource release instruction; or</li><li>constructing a new control frame as the resource release instruction.</li></ul></p><p id="p0017" num="0017">With reference to the fifth possible implementation manner of the first aspect, in a sixth possible implementation manner, if the resource release instruction is obtained by modifying the resource reservation response or the acknowledgment frame, a resource release indication bit is any reserved bit in a frame control domain; or<br/>
if the resource release instruction is obtained by modifying the resource reservation response or the acknowledgment frame, a resource release indication bit is any reserved combination in a duration domain; or<br/>
if the resource release instruction is obtained by modifying the null data packet, a resource release indication bit is any reserved combination in a modulation and coding scheme domain; where<br/>
the resource release indication bit is used to instruct the another node to initialize the network allocation vector of the another node.</p><p id="p0018" num="0018">With reference to the sixth possible implementation manner of the first aspect, in a seventh possible implementation manner, if the resource release indication bit is any reserved bit in the frame control domain, a duration domain of the resource<!-- EPO <DP n="5"> --> reservation response is set to a default value of the network allocation vector.</p><p id="p0019" num="0019">According to a second aspect, an embodiment of the present invention provides a resource reservation apparatus, where the apparatus is applied to a WiFi system, and the apparatus includes:
<ul><li>a receiving unit, configured to receive a resource reservation request sent by a source node;</li><li>a sending unit, configured to send a resource reservation response to the source node after the resource reservation request is received, where the resource reservation response includes a reservation time, and the resource reservation response is used to enable another node, which can monitor the resource reservation response, in the WiFi system to set a network allocation vector of the another node according to the reservation time;</li><li>a first determining unit, configured to determine whether data sent by the source node is received within a predetermined time; and</li><li>a resource releasing unit, configured to, when the first determining unit determines that the data sent by the source node is not received, send a resource release instruction to the another node, so that the another node initializes the network allocation vector of the another node, and re-contends for a resource.</li></ul></p><p id="p0020" num="0020">In a first possible implementation manner of the second aspect, the apparatus further includes:
<ul><li>a calculating unit, configured to obtain a remaining time of the reservation time by calculation, where the remaining time is a difference between the reservation time and the predetermined time; and</li><li>a second determining unit, configured to compare the remaining time with a time required for sending the resource release instruction by the resource releasing unit; and if the remaining time is not less than the time required for sending the resource release instruction, instruct the resource releasing unit to send the resource release instruction to the another node.</li></ul></p><p id="p0021" num="0021">With reference to the second aspect and the first possible implementation manner of the second aspect, in a second possible implementation manner, the sending unit is specifically configured to send a first resource reservation response to the source node upon expiry of an interval of one first interframe space after the resource reservation request is received; and then<br/>
the resource releasing unit is specifically configured to send a first<!-- EPO <DP n="6"> --> resource release instruction to the another node, so that the another node initializes the network allocation vector according to the first resource release instruction.</p><p id="p0022" num="0022">With reference to the second aspect and the first possible implementation manner of the second aspect, in a second possible implementation manner, the sending unit is specifically configured to send a second resource reservation response to the source node upon expiry of an interval of one first interframe space, one first resource reservation response, and one second interframe space after the resource reservation request is received; and then<br/>
the resource releasing unit is specifically configured to send a first resource release instruction to the another node, and after an interval of one first interframe space, send a second resource release instruction to the another node, so that the another node initializes the network allocation vector according to the first resource release instruction or the second resource release instruction.</p><p id="p0023" num="0023">With reference to the second aspect and any possible implementation manner of the first to the third possible implementation manners of the second aspect, in a fourth possible implementation manner, a predetermined time T during which the first determining unit determines whether the data sent by the source node is received is as follows: <maths id="math0002" num=""><math display="block"><mrow><mi mathvariant="normal">T</mi><mo>=</mo><mi mathvariant="normal">aSIFSTime</mi><mo>+</mo><mi mathvariant="normal">aPHY</mi><mo>-</mo><mi mathvariant="normal">RX</mi><mo>-</mo><mi mathvariant="normal">START</mi><mo>-</mo><mi mathvariant="normal">Delay</mi><mo>-</mo><mi mathvariant="normal">aSlotTime</mi><mo>;</mo></mrow></math><img id="ib0002" file="imgb0002.tif" wi="98" he="5" img-content="math" img-format="tif"/></maths><br/>
where aSIFSTime is a first interframe space; aPHY-RX-START-Delay is a physical layer response time; aSlotTime is a timeslot length.</p><p id="p0024" num="0024">According to the resource reservation method and apparatus in the embodiments of the present invention, after receiving a resource reservation request of a source node, a destination node first returns a resource reservation response that includes a reservation time to the source node, thereby controlling another node that can monitor the resource reservation response and in a system to set a network allocation vector of the another node according to the reservation time, which avoids a collision with a data sending process of the source node on the destination node; then the destination node further determines whether the source node sends data to the destination node within a predetermined time, and if the data is not sent, ends a transmission suppression process on the another node in advance by using a resource release instruction, thereby solving a hidden node problem and also ensuring that a network resource is fully and properly used.<!-- EPO <DP n="7"> --></p><heading id="h0004">BRIEF DESCRIPTION OF DRAWINGS</heading><p id="p0025" num="0025">To describe the technical solutions in the embodiments of the present application or in the prior art more clearly, the following briefly introduces the accompanying drawings required for describing the embodiments or the prior art. Apparently, the accompanying drawings in the following description show merely some embodiments recorded in the present application, and a person of ordinary skill in the art may still derive other drawings from these accompanying drawings.
<ul><li><figref idrefs="f0001">FIG. 1</figref> is a schematic structural diagram of a hidden node;</li><li><figref idrefs="f0001">FIG. 2</figref> is a flowchart of a resource reservation method according to Embodiment 1 of the present invention;</li><li><figref idrefs="f0001">FIG. 3</figref> is a schematic diagram of an RTS/CTS mechanism in the prior art;</li><li><figref idrefs="f0002">FIG. 4</figref> is a schematic diagram of using an RTS/CTS mechanism of a solution according to the present invention;</li><li><figref idrefs="f0002">FIG. 5a</figref> is a format diagram of an SIG domain in a preamble in a standard earlier than an 802.11n standard;</li><li><figref idrefs="f0003">FIG. 5b</figref> is a format diagram of an SIG domain in a preamble in an 802.11n standard;</li><li><figref idrefs="f0004">FIG. 6</figref> is a schematic structural diagram of a CTS/ACK frame;</li><li><figref idrefs="f0005">FIG. 7</figref> is a schematic structural diagram of a Frame Control domain;</li><li><figref idrefs="f0006">FIG. 8</figref> is a schematic diagram of using of a Duration domain;</li><li><figref idrefs="f0007">FIG. 9</figref> is a schematic structural diagram of a CF-End frame;</li><li><figref idrefs="f0007">FIG 10</figref> is a flowchart of a resource reservation method according to Embodiment 2 of the present invention;</li><li><figref idrefs="f0008">FIG. 11</figref> is a schematic diagram of an application manner of the present invention in a double CTS mechanism;</li><li><figref idrefs="f0008">FIG. 12</figref> is a schematic diagram of another application manner of the present invention in a double CTS mechanism;</li><li><figref idrefs="f0009">FIG 13</figref> is a schematic diagram of a resource reservation apparatus according to Embodiment 1 of the present invention;</li><li><figref idrefs="f0009">FIG. 14</figref> is a schematic diagram of a resource reservation apparatus according to Embodiment 2 of the present invention; and</li><li><figref idrefs="f0010">FIG. 15</figref> is a hardware constitution diagram of a resource reservation apparatus according to the present invention.</li></ul><!-- EPO <DP n="8"> --></p><heading id="h0005"><b>DESCRIPTION OF EMBODIMENTS</b></heading><p id="p0026" num="0026">In order to enable a person skilled in the art to better understand the solutions in the present invention, the following describes the embodiments of the present invention in more detail with reference to accompanying drawings and implementation manners.</p><p id="p0027" num="0027">In an existing WiFi system, a hidden node problem seriously affects performance of a wireless network. The so-called hidden node refers to that node A can be seen by node B, but cannot be seen by node C that communicates with node B, and therefore, node C is a hidden node for node A.</p><p id="p0028" num="0028">The following describes a process of affecting network performance by a hidden node with reference to a schematic diagram shown in <figref idrefs="f0001">FIG 1</figref>. Node 3 is a hidden node of node 1, that is, node 3 cannot monitor a signal sent by node 1. If node 1 sends data to node 2 at a current moment, because node 3 does not know whether communication is performed between node 1 and node 2, and in this case, node 3 may also send data to node 2. As a result, node 3 collides with node 1 on node 2, which causes a receiving error of node 2, so that this transmission opportunity (Transmission Opportunity, TXOP) is wasted. In addition, if positions where nodes in a WiFi system are deployed are close, although node 3 does not send data to node 2 and instead, send data to node 4 at a same moment, that node 2 receives data sent by node 1 may be interfered because node 3 sends data to node 4, which may cause a receiving error of node 2, and reduce transmission performance of a wireless network.</p><p id="p0029" num="0029">An RTS/CTS (Request To Send/Clear To Send, request to send/clear to send) mechanism that is proposed for solving this problem may be understood as that: before establishing communication with a destination node (node 2 in the foregoing example may be considered as a destination node), a source node (node 1 in the foregoing example may be considered as a source node) first sends an RTS frame to the destination node to apply for a resource, and enables, by using the RTS frame, a node that can monitor the frame to set a NAV of the node according to the frame, thereby suppressing data transmission of those nodes, and avoiding a collision with the source node. Accordingly, after receiving the RTS frame, the destination node sends a CTS frame to the source node, and enables a node (such as node 3 in the foregoing example) that can monitor the CTS frame to set a NAV of the node according to the CTS frame, thereby suppressing data transmission of this part of<!-- EPO <DP n="9"> --> nodes, and avoiding a collision with the destination node. In this way, a case in which transmission by a hidden node of the source node collides with transmission by the source node does not occur.</p><p id="p0030" num="0030">Besides solving the hidden node problem, the RTS/CTS mechanism also brings a new problem, that is, a resource waste problem that occurs after CTS frame transmission between the source node and the destination node fails or parsing of the CTS frame by the source node fails. The technical solutions in the present invention are proposed for resolving this new problem.</p><p id="p0031" num="0031">The following describes a resource reservation method that is in the present invention.</p><p id="p0032" num="0032">Referring to <figref idrefs="f0001">FIG 2, FIG. 2</figref> shows a flowchart of a resource reservation method according to Embodiment 1 of the present invention, where the method is applied to a WiFi system, and the method includes:</p><p id="p0033" num="0033">Step 101: A destination node receives a resource reservation request sent by a source node, and sends a resource reservation response to the source node, where the resource reservation response includes a reservation time, and the resource reservation response is used to enable another node, which can monitor the resource reservation response, in the WiFi system to set a network allocation vector of the another node according to the reservation time.</p><p id="p0034" num="0034">To avoid a collision between nodes, before establishing communication with the destination node, the source node first sends the resource reservation request to the destination node. As an implementation manner of the request, the request may be expressed as an RTS frame. Nodes that receive the RTS frame may be classified into two types according to a processing action.</p><p id="p0035" num="0035">One type is the destination node, where the node is a node with which the source node wants to establish communication. Therefore, upon expiry of an interval of one SIFS after receiving the RTS frame, the node needs to send a resource reservation response to the source node. As an implementation manner of the response, the response may be expressed as a CTS frame.</p><p id="p0036" num="0036">The other type is another node except the destination node. This type of node can monitor data sent by the source node, and may further be a hidden node of the destination node. Therefore, the source node needs to control, by using the RTS frame, this type of node to set a NAV of this type of node, so that this type of node may determine usage of a resource according to a size of the NAV. Referring to a<!-- EPO <DP n="10"> --> schematic diagram shown in <figref idrefs="f0001">FIG. 3</figref>, it can be learned that, the NAV set by this type of node is (CTS_Time+Data_Time+ACK_Time+3×SIFS), where CTS_Time is a time for sending the CTS frame by the destination node; Data_Time is a time for transmitting a data frame by the source node; ACK_Time is a time for sending an acknowledgment frame by the destination node after data transmission is completed; and SIFS is a short interframe space.</p><p id="p0037" num="0037">It should be noted that, the destination node also sets a NAV of the destination node according to the RTS frame, but the destination node does not need to determine usage of a resource by using the NAV set by the destination node. A purpose of setting the NAV by the destination node in the present invention is not temporarily described herein.</p><p id="p0038" num="0038">Certainly, nodes that receive the CTS frame may also be classified into two types according to a processing action:</p><p id="p0039" num="0039">One type is the source node, where the node wants to send data to the destination node. Therefore, after receiving the CTS frame and after an interval of one SIFS, the source node transfers a data frame to the destination node.</p><p id="p0040" num="0040">The other type is another node except the source node. This type of node can monitor data sent by the destination node, may further be a hidden node of the source node, and affects data receiving of the destination node. Therefore, the destination node needs to control, by using the CTS frame, this type of node to set a NAV of this type of node, so that this type of node may determine usage of a resource according to a size of the NAV. Referring to <figref idrefs="f0001">FIG. 3</figref>, it can be learned that the NAV set by this type of node is (Data_Time+ACK_Time+2×SIFS).</p><p id="p0041" num="0041">It should be noted that, the source node may also set a NAV of the source node according to the CTS frame. However, because the source node needs to send data to the destination node by using an occupied resource, the source node does not need to determine usage of a resource by using the NAV, and setting the NAV by the source node is no more described in the present invention.</p><p id="p0042" num="0042">This step refers to a process in which a node that can monitor the CTS frame sets a NAV of the node according to the CTS frame, where the reservation time is the foregoing (Data_Time+ACK_Time+2×SIFS).</p><p id="p0043" num="0043">It should be noted that, in the present invention, a resource may be specifically expressed as a wireless channel resource, and a node may be expressed as a wireless access point AP (Access Point) or a station device STA (Station) such as a<!-- EPO <DP n="11"> --> mobile phone, which may be determined by an actual application situation, and is not further limited.</p><p id="p0044" num="0044">Step 102: The destination node determines whether data sent by the source node is received within a predetermined time; and if the data is not received, sends a resource release instruction to the another node, so that the another node initializes the network allocation vector of the another node, and re-contends for a resource.</p><p id="p0045" num="0045">As described above, in a normal case, the source node sends a data frame to the destination node upon expiry of an interval of one SIFS after receiving the CTS frame of the destination node. However, if a case in which the source node does not send the data frame to the destination node occurs due to instability of a channel, to avoid a resource waste in this case, the destination node in the present invention actively determines, after waiting for an appropriate delay, whether the destination node receives the data sent by the source node. If the data is received, data sending and receiving may still be performed according to a normal process; if the data is not received, a resource occupied by the source node is released, and the node that sets the NAV of the node according to the CTS frame is instructed to re-contend for a channel resource after the NAV of the node is initialized. Therefore, a waste of the channel resource in a case in which the source node occupies the channel but does not send data may be effectively avoided.</p><p id="p0046" num="0046">It should be noted that the foregoing appropriate delay, that is, the predetermined time T, is greater than an interval of an SIFS during which the source node sends the data frame to the destination node in a normal case. That is, in a technical solution of the present invention, if the data sent by the source node is received within a time interval t, it is considered to be a normal circumstance; if the data sent by the source node is still not received beyond T, it is considered to be an abnormal circumstance, and transmission suppression on the another node should be terminated, so that the another node and the source node re-start to contend for a channel resource. For details, refer to a schematic diagram shown in <figref idrefs="f0002">FIG. 4</figref>. A data frame and an ACK frame in dashed line boxes indicate frames that are not sent; a black part in a NAV (CTS) indicates a time during which transmission by a node is suppressed; a white part indicates a time during which a node ends a transmission suppression process in advance.</p><p id="p0047" num="0047">The following describes selection of the predetermined time T in the present invention.<!-- EPO <DP n="12"> --></p><p id="p0048" num="0048">As specified in the 802.11 standard, if a subsequent frame is not detected after (theoretical receiving time + Timeout Interval), it is considered to be timeout. Accordingly, in the technical solution of the present invention, the theoretical receiving time is aSIFSTime, Timeout Interval = aPHY-RX-START-Delay + aSlotTime, that is, t shown in <figref idrefs="f0002">FIG. 4</figref>; then, the predetermined time T = aSIFSTime + aPHY-RX-START-Delay + aSlotTime, where<br/>
aSIFSTime is a short interframe space time, and is a physical layer parameter. The SIFS mentioned in the foregoing is a MAC (Media Access Control, media access control) layer parameter, and aSIFSTime is a representation of an SIFS at a physical layer, and values of the two are equal;<br/>
aPHY-RX-START-Delay indicates a time required from detecting of start of frame transmission at the physical layer of a device to sending of a receiving instruction to an upper layer, that is, a response time at the physical layer, which is a physical layer parameter; and<br/>
aSlotTime is a timeslot length, and is also a physical layer parameter. The parameter is set considering an effect of a factor such as clock alignment on timing accuracy, that is, existing of a possible delay of one aSlotTime is allowed for the data frame.</p><p id="p0049" num="0049">The foregoing two parameters may be both defined and given a specific value in the standard. For example, in the 802.11n standard, when a frequency band of 2.4 GHz is used, aSlotTime = 9 µs or 20 us, and when a frequency band of 5 GHz is used, aSlotTime = 9 µs; accordingly, in the two cases, aPHY-RX-START-Delay = 33 µs. However, at an OFDM (Orthogonal Frequency Division Multiplexing, orthogonal frequency division multiplexing) physical layer in a standard earlier than the 802.11n standard, values of these parameters are related to bandwidth; for example, values of aSlotTime corresponding to 20/10/5 MHz are respectively 9/13/21 µs, and accordingly, values of aPHY-RX-START-Delay are respectively 25/49/97 µs.</p><p id="p0050" num="0050">It can be learned from the foregoing content that, when a maximum allowed delay time (that is, the predetermined time) for receiving the data frame by the destination node is determined, three factors need to be considered: one is the theoretical receiving time aSIFSTime; one is physical layer response time aPHY-RX-START-Delay; one is a timeslot aSlotTime.</p><p id="p0051" num="0051">In the present invention, to resolve a resource waste problem in a case in<!-- EPO <DP n="13"> --> which a channel is not stable, a destination node monitors, within a predetermined time, data sent by a source node. If the data is detected, occupation of a channel resource by the source node is reserved; if the data is not detected, a channel resource allocated to the source node is released, and at the same time, transmission suppression on another node that can monitor data of the destination node is further removed, which ensures that the channel is used as appropriately as possible. In this way, not only a hidden node problem is resolved, but utilization of a network resource is improved.</p><p id="p0052" num="0052">In an actual application, nodes that can monitor data of the destination node may be classified into two types: one type is a node that not only can monitor the data of the destination node, but also can monitor data of the source node; the other type is a node that can monitor only the data of the destination node, but cannot monitor the data of the source node. The latter is a hidden node of the source node. The former not only may re-contend for a channel according to the resource release instruction, but also may further determine, by monitoring a data sending status of the source node, whether to remove a transmission suppression process of the former. However, a latter type of node cannot learn the data sending status of the source node, and can only remove a transmission suppression process in advance by using the resource release instruction. Therefore, in the present invention, to ensure a reasonable and fair contention for a channel resource by different nodes in a case in which the source node does not send data, the destination replaces the another node to monitor the data sending status of the source node, and instructs, when a channel resource needs to be released, the another node to initialize the NAV and re-contend for the resource.</p><p id="p0053" num="0053">In addition, it should be noted that, the so-called initializing a NAV refers to that a value of the NAV is set to a default value, where the default value may be zero in the prior art; that is, initializing the NAV is to control the NAV to return to zero. The default value may also be set to any value as required, for example, may be set to 1; then, when the NAV is set according to a time indicated by a Duration domain, the NAV needs to be set based on the default value 1; further, when the NAV is initialized, the value of the NAV is returned to the default value 1. The present invention imposes no limitation on setting of an initial default value of the NAV.</p><p id="p0054" num="0054">The resource release instruction that controls the another node that communicates with the destination node to initialize the NAV may be implemented by<!-- EPO <DP n="14"> --> constructing a new control frame, or may be implemented by using a contention-free end frame CF-End, or may be implemented by modifying an existing frame, for example, modifying a resource reservation response CTS, an acknowledgment frame ACK (Acknowledgment), or a null data packet NDP (Null Data Packet), which are described one by one in the following.</p><heading id="h0006">1. Modifying a NDP frame to obtain the resource release instruction</heading><p id="p0055" num="0055">The resource release instruction is used to release occupation of a channel by the source node and remove transmission suppression on the another node, and considering channel resource saving and power saving, the shorter a frame length is, the better; therefore, the NDP frame may be considered for use.</p><p id="p0056" num="0056">Generally, a frame actually sent consists of a physical header preamble and a MAC frame. The Preamble includes long/short training, a signal domain SIG, and the like; further, the SIG domain further includes information such as a transmit rate and a length of the MAC frame. Because the SIG domain may include some simple information, it may be that only the Preamble is sent and a subsequent MAC frame is not sent, and this type of frame that includes only the preamble but does not include the MAC frame is referred to as the NDP frame.</p><p id="p0057" num="0057">Referring to <figref idrefs="f0002">FIG. 5a, FIG. 5a</figref> shows a format diagram of the SIG domain in a physical header in a standard earlier than the 802.11n standard. Because the OFDM physical layer supports only eight transmit rates, eight reserved combinations in 16 combinations composed by a four-bit rate domain RATE still exists. Therefore, any one of these reserved combinations may be used to indicate a resource release indication, thereby modifying the NDP frame into the resource release instruction for use. Certainly, a LENGTH domain may further carry other information, such as a part of a MAC address of the source node or a current NAV value of the destination node. The part of the MAC address is obtained by capturing a part (for example, last 12 bits) of a complete MAC address or converting (for example, a Hash operation) a complete MAC address. Therefore, after receiving the resource release instruction obtained by modifying the NDP frame, the another node that can monitor the data of the destination node may determine a combination used by the RATE domain of the resource release instruction; if the RATE domain is one of the reserved combinations, the another node may initialize the NAV of the another node to a default value according to the resource release indication. A specific release process may be shown in the following:<!-- EPO <DP n="15"> --></p><p id="p0058" num="0058">If the LENGTH domain is a part of the MAC address of the source node, after receiving the resource release instruction, the another node first determines whether the another node needs to initialize the NAV according to the instruction. When a node monitors a CTS frame and sets a NAV according to the CTS frame, the node records an RA domain of the CTS domain, that is, needs to know a source node under whose effect transmission is suppressed this time. Therefore, after receiving the resource release instruction, the node may compare whether the RA domain recorded by the node matches the part of the MAC address in the LENGTH domain; if matched, initializes the NAV of the node to a default value according to the resource release instruction; if not matched, discards the resource release instruction.</p><p id="p0059" num="0059">If the LENGTH domain is a current NAV value of the destination node, after receiving the resource release instruction, the another node first determines whether an absolute value of a difference between the NAV value of the another node and the LENGTH domain is less than or equal to a predefined threshold; if yes, initializes the NAV of the another node to a default value according to the resource release instruction; if no, discards the resource release instruction. The foregoing threshold is a system parameter, and may be broadcasted in a beacon frame Beacon by an AP. This technical solution is the foregoing purpose of enabling the destination node to set the NAV of the destination node according to the RTS frame.</p><p id="p0060" num="0060">Referring to <figref idrefs="f0003">FIG 5b, FIG. 5b</figref> shows a format diagram of the SIG domain in a physical header in the 802.11n standard. Compared with <figref idrefs="f0002">FIG. 5a</figref>, a RATE field is replaced by a modulation and coding scheme (Modulation and Coding Scheme, MCS) field, which is used to indicate a transmit rate. A seven-bit MCS field may represent 128 modulation and coding schemes, and 77 modulation and coding schemes are supported in the 802.11n standard; therefore, there are 51 reserved combinations. Therefore, the resource release indication may be indicated by using any one of these reserved combinations, thereby modifying the NDP frame into the resource release instruction for use. It should be noted that in the SIG domain, except a cyclic redundancy check CRC, a tail bit Tail Bit, and a not sounding signal Not Sounding, another field may be used to carry information such as a part of the MAC address of the source node or a current NAV value of the destination node. A process of initializing the NAV of the another node by the another node according to the resource release instruction is similar to that at the OFDM physical layer, and details are not described herein again. In addition, to be compatible with a current standard, the Not<!-- EPO <DP n="16"> --> Sounding field should be set to 1.</p><heading id="h0007">2. Modifying a CTS/ACK frame to obtain the resource release instruction</heading><p id="p0061" num="0061">CTS and ACK are both control frames, and have a similar frame structure. Referring to <figref idrefs="f0004">FIG. 6, FIG. 6</figref> shows a schematic diagram of the CTS/ACK frame, where Frame Control is a frame control domain; Duration is a duration domain (which is used to indicate a time required for sending and acknowledgment of subsequent data); RA is the MAC address of the source node; FCS is a frame check sequence. In the present invention, the resource release instruction may be obtained by modifying the Frame Control domain or the Duration domain, which is separately described in the following.</p><heading id="h0008">(1) Modifying the Frame Control domain to obtain the resource release instruction</heading><p id="p0062" num="0062">Referring to <figref idrefs="f0005">FIG. 7, FIG. 7</figref> shows a schematic structural diagram of the Frame Control domain. CTS/ACK are both control frames, and there are some reserved bits in a control frame, for example: a bit To DS indicating that data goes to an external network; a bit From DS indicating that data is from an external network; a bit More Fragments indicating frame fragment transmission; a bit Retry indicating data retransmission; a bit Protected Frame indicating whether a encryption algorithm is used; a bit Order indicating that an HT control domain exists or sending needs to be in a strict sequence, and the foregoing reserved bits are not used in the control frame. Therefore, any reserved bit selected from the foregoing reserved bits may be used as a resource release indication bit, and CTS/ACK is modified into a resource release instruction bit for use.</p><p id="p0063" num="0063">It should be noted that, according to a meaning proximity principle and considering meaning of each reserved bit, the Retry bit may be preferably used as the resource release indication bit. Certainly, compared with other foregoing reserved bits, the Retry bit has no essential difference.</p><p id="p0064" num="0064">Therefore, after receiving the resource release instruction obtained by modifying the Frame Control domain, the another node that can monitor the data of the destination node may determine a value of a reserved bit used as the resource release instruction, and further determine whether to initialize the NAV.</p><heading id="h0009">(2) Modifying the Duration domain to obtain the resource release instruction</heading><p id="p0065" num="0065">The Duration domain includes a total of 16 bits, 0-15. If used in a PS-Poll<!-- EPO <DP n="17"> --> frame, the Duration domain is used to indicate an AID (Association Identifier, association identifier); if used in a frame transmitted during a CFP (Contention Free Period, contention free period) in a PCF (Point Coordination Function, point coordination function), the Duration domain is set to a fixed value 32768; if used in another frame, the Duration domain indicates a time required for sending and acknowledgment of subsequent data. In addition, there are some unused reserved combinations in the Duration domain; for details, refer to a schematic diagram shown in <figref idrefs="f0006">FIG. 8</figref>. Therefore, any one of these reserved combinations may be used to indicate the resource release indication, thereby modifying CTS/ACK into the resource release instruction for using.</p><p id="p0066" num="0066">Therefore, after receiving the resource release instruction obtained by modifying the Duration domain, the another node that can monitor the data of the destination node may determine a combination used by the Duration domain; if the combination is one of the reserved combinations, the another node may initialize the NAV of the another node to a default value according to the resource release indication. For example, a reserved combination whose two most significant bits are 1 and another bit is 0 is used as the resource release indication for use. If the another node that communicates with the destination node finds that the Duration domain is the reserved combination, the another node initializes the NAV and re-contends for a resource.</p><p id="p0067" num="0067">For the foregoing manner of obtaining the resource release instruction by modifying the CTS/ACK frame, the present invention further provides the following exemplary solution, which is specifically described as follows:</p><p id="p0068" num="0068">Considering a problem of device compatibility, while the Frame Control frame is modified, a time that is required for sending and acknowledgment of subsequent data and is indicated by the Duration domain of the CTS/ACK frame may be set to a default value of the NAV. If a solution in the prior art that the default value of the NAV is 0 is used, that is, the time indicated by the Duration domain is set to 0, in this way, compatibility between a new node device in the present invention and an old node device in the prior art (the new node device and the old node device herein refer to the another node that can monitor data of the destination node) is implemented.</p><p id="p0069" num="0069">Because the resource release instruction is obtained by modifying the CTS/ACK frame (specifically, by modifying the Frame Control domain), the<!-- EPO <DP n="18"> --> instruction includes the Duration domain. Therefore, after receiving the resource release instruction, the old node device automatically reads the Duration domain, and sets a NAV of the old node device according to the Duration domain. If a time indicated by the Duration domain in the instruction is greater than a current NAV value set by the node, the node modifies the NAV of the node to the time (generally, the node chooses a larger value as the current NAV value of the node) indicated by the Duration domain; if the time indicated by the Duration domain is not greater than the current NAV value of the node, setting of the NAV of the node is not affected. Therefore, to ensure that the resource release instruction can not only instruct the node to end a transmission suppression process, but also does not affect setting of the NAV of the node, the time indicated by the Duration domain needs to be set to a default value of the NAV (the current NAV value of the node shall never be greater than the default value of the NAV).</p><p id="p0070" num="0070">However, so long as detecting the resource release indication in the Frame Control domain, the new node device that has a function of identifying the resource release instruction does not set the NAV of the new node device according to the Duration domain any longer. If a value of the resource release indication bit indicates that the NAV needs to be initialized, the node further needs to initialize the NAV of the node to a default value, and ends a transmission suppression process.</p><p id="p0071" num="0071">For the manner of obtaining the resource release instruction by modifying the CTS/ACK frame, a specific release process of a node may be expressed as follows:</p><p id="p0072" num="0072">After receiving the resource release instruction, the node first determines whether the NAV needs to be initialized, that is, determines whether the resource release indication bit in the Frame Control domain is a preset value (for example, if it is stipulated that a preset value of "1" indicates that a resource needs to be released, determines whether the indication bit is "1"), or determines whether the Duration domain uses one of the reserved combinations. If it is determined that the NAV needs to be initialized, the node further determines whether the instruction is for the node, which may be implemented by comparing an RA domain of a CTS frame recorded by the node with an RA domain of the resource release instruction. If RA domains are the same, the NAV of the node is initialized to a default value according to the resource release instruction; if RA domains are different, the resource release instruction is discarded.<!-- EPO <DP n="19"> --></p><p id="p0073" num="0073">Besides the foregoing obtaining of the resource release instruction by modifying an existing frame, a CF-End frame may further be directly used as the resource release instruction, and specific description is as follows:</p><p id="p0074" num="0074">In the prior art, after completing data interaction with the destination node, if the source node finds that there is a surplus of the reservation time, and the surplus is sufficient for sending one CF-End frame, the source node sends the CF-End frame to notify the destination node that the destination node may release a resource in advance. Accordingly, as a response action of the destination node, the destination node also returns a CF-End frame to the source node. Therefore, the another node that can monitor the data of the destination node initializes the NAV of the another node under a function of the response CF-End frame.</p><p id="p0075" num="0075">In conclusion, in the present invention, the CF-End frame may be used as the resource release instruction so as to remove transmission suppression on the another node in advance. However, in the prior art, a main body that triggers to send the CF-End frame is the source node, and a trigger condition is that there is a sufficient remaining resource after data interaction. In the technical solution of the present invention, the main body that triggers to send the CF-End frame is the destination node, and the trigger condition is that the destination node determines that the source node does not transmit data as agreed.</p><p id="p0076" num="0076">Referring to a schematic structural diagram of a CF-End frame shown in <figref idrefs="f0007">FIG. 9</figref>, a release process of a node in this manner may be expressed as follows:</p><p id="p0077" num="0077">A Duration domain of CF-End is set to a current NAV value of the destination node. After receiving a CF-End frame used as the resource release instruction, the another node first determines whether the another node needs to initialize the NAV according to the instruction, that is, determines whether an absolute value of a difference between a NAV value of the node and the Duration domain of the CF-End frame is less than or equal to a predetermined threshold; if yes, initializes the NAV of the node to a default value; if no, discards the resource release instruction. The foregoing threshold is a system parameter, and may be broadcasted in a Beacon frame by an AP.</p><p id="p0078" num="0078">Another method for implementing the resource release instruction by using CF-End is as follows: An RA domain is set to the MAC address of the source node, and a TA domain is set to a MAC address of the destination node. After receiving a CF-End frame used as the resource release instruction, the another node first<!-- EPO <DP n="20"> --> determines whether the another node needs to initialize the NAV according to the instruction, which is implemented by comparing an RA domain of a CTS frame recorded by the node with an RA domain of the resource release instruction. If RA domains are the same, the NAV of the node is initialized to a default value; if RA domains are different, the resource release instruction is discarded.</p><p id="p0079" num="0079">Referring to <figref idrefs="f0007">FIG. 10, FIG. 10</figref> shows a flowchart of a resource reservation method according to Embodiment 2 of the present invention, where the method is applied to a WiFi system, and the method includes:
<ul><li>Step 201: A destination node receives a resource reservation request sent by a source node, and sends a resource reservation response to the source node, where the resource reservation response includes a reservation time, and the resource reservation response is used to enable another node, which can monitor the resource reservation response, in the WiFi system to set a network allocation vector of the another node according to the reservation time.</li><li>Step 202: The destination node determines whether data sent by the source node is received within a predetermined time.</li><li>Step 203: If the data sent by the source node is not received within the predetermined time, obtain a remaining time of the reservation time by calculation, and compare the remaining time with a time required for sending a resource release instruction, where the remaining time is a difference between the reservation time and the predetermine time.</li><li>Step 204: If the remaining time is not less than the time required for sending the resource release instruction, send the resource release instruction to the another node, so that the another node initializes the network allocation vector of the another node, and re-contends for a resource.</li></ul></p><p id="p0080" num="0080">In an exemplary solution in the present invention, when determining that the data sent by the source node is not received within an appropriate delay time, the destination node does not directly send the resource release instruction to the another node, because a certain time is required for sending the instruction. Therefore, it is first determined which of a current remaining time and a time used for sending the instruction is longer. The so-called remaining time refers to duration from a current moment to ending of the reservation time, that is, duration from the current moment to a time when the another node can re-contend for a channel; or which may also be understood as a time from the current moment to a time when the NAV is counted<!-- EPO <DP n="21"> --> down to a default value, and a specific calculation manner is as follows: remaining time = reservation time - predetermined time.</p><p id="p0081" num="0081">If the time used for sending the instruction is less than the remaining time, obviously, a transmission suppression process of the another node may be ended in advance by using the resource release instruction, so that a node in a network re-contends for a channel resource, and a resource waste is reduced as much as possible.</p><p id="p0082" num="0082">If the time for sending the instruction is greater than the remaining time, a manner of initializing the NAV by using the resource release instruction prolongs a resource-wasting time on the contrary. Therefore, in this case, the destination node may not send the resource release instruction to the another node, but waits for the another node to end the transmission suppression process in a manner in which the NAV is counted down to a default value.</p><p id="p0083" num="0083">If the time used for sending the instruction is equal to the remaining time, the transmission suppression process of the another node is ended at a same moment in the two manners. Therefore, occupation of a channel by the source node may be terminated in any of the two manners, which is not limited in the present invention.</p><p id="p0084" num="0084">The following briefly describes an implementation process of the technical solution of the present invention with reference to specific applications.</p><p id="p0085" num="0085">Currently, there are two mechanisms to resolve a hidden node problem. One is a single CTS mechanism, which is applicable to a network that includes only an old node device or a network that includes only a new node device. The other is a double CTS mechanism, which is applicable to a network that includes both a new node device and an old node device. The so-called new node device refers to a node that supports an STBC (Space-Time Block Coding, space-time block coding) mode and a non-STBC mode. The old node device refers to a node that supports only the non-STBC mode.</p><p id="p0086" num="0086">For the single CTS mechanism, the implementation process of the technical solution of the present maybe described as follows:
<ol><li>(1) The source node sends an RTS frame to the destination node to request to perform channel resource reservation. A node that can monitor the RTS frame sets a NAV of the node to (CTS_Time+Data_Time+ACK_Time+3×SIFS), and starts to count in a countdown manner.</li><li>(2) After receiving the RTS frame, the destination node sends a CTS frame<!-- EPO <DP n="22"> --> (which may be considered as a first resource reservation response, and SIFS may be considered as a first interframe space) to the source node after an interval of one SIFS. A node that can monitor the CTS frame sets a NAV of the node to (Data_Time+ACK_Time+2×SIFS), and starts to count in a countdown manner.</li><li>(3) The destination node starts to time from PHY-TXEND.confirm corresponding to the transmission of the CTS frame. If PHY-RXSTART.indication from a physical layer is not detected within a predetermined time (aSIFSTime + aPHY-RX-START-Delay + aSlotTime), it is considered that the CTS frame transferred by the destination node fails to be transmitted, and a channel resource that the source node requests to occupy may be released.</li><li>(4) There are two manners of releasing a channel resource occupied by the source node. One is waiting for the NAV of the another node to be counted down to zero, the other is sending a resource release instruction. To make a resource release process more appropriate, in the present invention, in a case in which it is determined that transmission of the CTS frame is failed, the following steps may further be performed:</li></ol></p><p id="p0087" num="0087">The destination node obtains the remaining time of the reservation time by calculation, and determines whether the remaining time is less than the time required for transmitting the resource release instruction. If the remaining time is less than the time required for transmitting the resource release instruction, the destination node waits for the NAV of the another node to be counted down to zero in the first manner to release a channel resource; if the remaining time is not less than the time required for transmitting the resource release instruction, the resource release instruction (which may be considered as a first resource release instruction) is sent in the second manner, and the instruction directly controls the another node to initialize the NAV and release a channel resource.
<ul><li>(5) For the manner of sending the first resource release instruction, if a reserved bit Retry in a Frame Control domain is used as a resource release indication bit, and when the indication bit is "1 ", a node is controlled to initialize a NAV, after receiving the instruction, the another node reads the Retry bit, and if the Retry bit is "1 ", the node initializes the NAV to a default value regardless of a number to which the NAV is counted down, and re-contends for a channel resource with a node in a network. So far, a resource reservation process of the present invention is completed.</li></ul></p><p id="p0088" num="0088">For the double CTS mechanism, the implementation process of the<!-- EPO <DP n="23"> --> technical solution of the present may be described as follows:
<ol><li>(1) The source node sends an RTS frame to the destination node to request to perform channel resource reservation. A node that can monitor the RTS frame sets a NAV of the node to (CTS_Time+Data_Time+ACK_Time+3×SIFS), and starts to count in a countdown manner.</li><li>(2) After receiving the RTS frame, the destination node sends a CTS frame to the source node separately in an STBC mode and in a non-STBC mode. If a node that can monitor the CTS frame can identify a CTS frame that is in the STBC mode, the node sets a NAV of the node according to the CTS frame that is in the STBC mode; if the node can identify a CTS frame that is in the non-STBC mode, the node sets a NAV of the node according to the CTS frame that is in the non-STBC mode. A finally set NAV value is (Data_Time+ACK_Time+2×SIFS), and the node also starts to count in a countdown manner.</li></ol></p><p id="p0089" num="0089">In this step, a specific process of sending the CTS frame by the destination node is as follows: After receiving the RTS frame, the destination node sends a first resource reservation response after an interval of one first interframe space, and then sends a second resource reservation response after an interval of one second interframe space.</p><p id="p0090" num="0090">Referring to a schematic diagram shown in <figref idrefs="f0008">FIG. 11</figref>, if the source node sends an RTS frame that is in the STBC mode, the destination node sends a CTS (which may be considered as the first resource reservation response) that is in the STBC mode after an interval of one SIFS (which may be considered as the first interframe space), and then sends a CTS (which may be considered as the second resource reservation response) that is in the non-STBC mode after another interval of one SIFS (which may be considered as the second interframe space).</p><p id="p0091" num="0091">Alternatively, referring to a schematic diagram shown in <figref idrefs="f0008">FIG. 12</figref>, if the source node sends an RTS frame that is in the non-STBC mode, the destination node sends a CTS (which may be considered as the first resource reservation response) that is in the non-STBC mode after an interval of one SIFS (which may be considered as the first interframe space), and then further sends a CTS (which may be considered as the second resource reservation response) that is in the STBC mode after an interval of one PIFS (PCF Interframe Space, point coordination function interframe space, where PIFS&gt;SIFS, and may be considered as the second interframe space).</p><p id="p0092" num="0092">For the schematic diagram shown in <figref idrefs="f0008">FIG. 12</figref>, because the new node device<!-- EPO <DP n="24"> --> and the old node device both can send the RTS frame that is in the non-STBC mode, after receiving the RTS frame that is in the non-STBC mode, the destination node cannot determine a source node that the RTS frame comes from. In addition, if the source node is the old node device, upon expiry of an interval of one SIFS after the destination node returns a CTS frame, the source node sends a data frame to the destination node. If the destination node also sends a second CTS frame upon expiry of an interval of one SIFS after sending a first CTS frame, a collision is caused. Therefore, after receiving the RTS frame that is in the non-STBC mode, the destination node further sends a second CTS frame upon expiry of an interval of one PIFS after sending a first CTS frame, which avoids a collision with transmission by the old node device.</p><p id="p0093" num="0093">For the schematic diagram shown in <figref idrefs="f0008">FIG. 11</figref>, because only the new node device can send the RTS frame that is in the non-STBC mode, the destination node may determine a type of a source node that sends the RTS frame, and therefore, may send a second CTS frame after an SIFS.
<ul><li>(3) The destination node starts to time from PHY-TXEND.confirm at which the second CTS frame is sent. If PHY-RXSTART.indication from a physical layer is not detected within a predetermined time (aSIFSTime + aPHY-RX-START-Delay + aSlotTime), it is considered that the CTS frame transferred by the destination node fails to be transmitted, and a channel resource that the source node requests to occupy may be released.</li><li>(4) There are two manners of releasing a channel resource occupied by the source node. One is waiting for the NAV of the another node to be counted down to zero, the other is sending a resource release instruction. To make a resource release process more appropriate, in the present invention, in a case in which it is determined that transmission of the CTS frame is failed, the following steps may further be performed:</li></ul></p><p id="p0094" num="0094">The destination node obtains the remaining time of the reservation time by calculation, and determines whether the remaining time is less than the time required for transmitting the resource release instruction. If the remaining time is less than the time required for transmitting the resource release instruction, the another node waits, in the first manner, for the NAV of the another node to be counted down to zero to release a channel resource; if the remaining time is not less than the time required for transmitting the resource release instruction, the resource release instruction is sent to<!-- EPO <DP n="25"> --> the another node in the second manner, and the instruction directly controls the NAV of the another node to return to zero and release a channel resource.</p><p id="p0095" num="0095">In this step, a specific process of sending the resource release instruction by the destination node is as follows: when determining that the remaining time is relatively large, the destination node sends a first resource release instruction, and then further sends a second resource release instruction after an interval of one first interframe space. In this step, the time required for sending the resource release instruction refers to a sum of a time required for sending the first resource release instruction, a time required for sending the second resource release instruction and an interval of a first interframe space.</p><p id="p0096" num="0096">Referring to the schematic diagram shown in <figref idrefs="f0008">FIG. 11</figref>, the destination node sends a resource release instruction MRI (Medium Release Indication, which may be considered as the first resource release instruction) that is in the STBC mode, and then further sends an MRI (which may be considered as the second resource release instruction) that is in the non-STBC mode after an interval of one SIFS.</p><p id="p0097" num="0097">Referring to the schematic diagram shown in <figref idrefs="f0008">FIG. 12</figref>, the destination node sends a resource release instruction MRI (which may be considered as the first resource release instruction) that is in the non-STBC mode, and then further sends an MRI (which may be considered as the second resource release instruction) that is in the STBC mode after an interval of one SIFS.</p><p id="p0098" num="0098">It should be noted that, to improve network performance, and enable the source node to receive a CTS frame and sends a data frame to the destination as soon as possible, generally, the destination node first sends a CTS frame of a mode the same as that of an RTS frame (for example, if the RTS frame is in the STBC mode, the destination node first sends a CTS that is in the STBC mode, and then sends a CTS that is in the non-STBC mode after an interval of one interframe space). However, there is no requirement on a sequence of sending resource release instructions that are in the two modes. Certainly, if the network performance is not considered, and it is only required that the source node is enabled to receive the CTS frame, there is no requirement on a sequence for sending CTS frames that are in the two modes by the destination node. The present invention imposes no limitation thereto.
<ul><li>(5) For a manner of sending the first resource release instruction and the second resource release instruction, if a Retry bit of "1" indicates releasing of a<!-- EPO <DP n="26"> --> resource, if a node that receives the instruction can identify an instruction that is in the STBC mode, the node initializes the NAV of the node to zero according to the instruction that is in the STBC mode; if the node can identify an instruction that is in the non-STBC mode, the node initializes the NAV of the node to a default value according to the instruction that is in the non-STBC, and re-contends for a channel resource with a node in a network. So far, a resource reservation process of the present invention is completed.</li></ul></p><p id="p0099" num="0099">Referring to <figref idrefs="f0009">FIG. 13, FIG. 13</figref> shows a schematic diagram of a resource reservation apparatus according to Embodiment 1 of the present invention, where the apparatus is applied to a WiFi system, and the apparatus includes:
<ul><li>a receiving unit 301, configured to receive a resource reservation request sent by a source node;</li><li>a sending unit 302, configured to send a resource reservation response to the source node after the resource reservation request is received (specifically, after an interval of one SIFS), where the resource reservation response includes a reservation time, and the resource reservation response is used to enable another node, which can monitor the resource reservation response, in the WiFi system to set a network allocation vector of the another node according to the reservation time;</li><li>a first determining unit 303, configured to determine whether data sent by the source node is received within a predetermined time; where</li><li>the predetermined time T = aSIFSTime + aPHY-RX-START-Delay + aSlotTime;</li><li>where aSIFSTime is a first interframe space; aPHY-RX-START-Delay is a physical layer response time; aSlotTime is a timeslot length; and</li><li>a resource releasing unit 304, configured to, when the first determining unit determines that the data sent by the source node is not received, send a resource release instruction to the another node, so that the another node initializes the network allocation vector of the another node, and re-contends for a resource.</li></ul></p><p id="p0100" num="0100">It should be noted that, the resource release instruction sent by the resource releasing unit may be implemented by constructing a new control frame, or may be implemented by using a contention-free end frame CF-End frame, or may be implemented by modifying an existing frame, for example, modifying a resource reservation response CTS, an acknowledgment frame ACK, or a null data packet NDP. A specific implementation manner of the resource release instruction is described<!-- EPO <DP n="27"> --> above method embodiments, and details are not described herein.</p><p id="p0101" num="0101">Currently, there are two mechanisms to resolve a hidden node problem. One is a single CTS mechanism, and the other is a double CTS mechanism.</p><p id="p0102" num="0102">For a solution of the single CTS mechanism:
<ul><li>the sending unit is specifically configured to send a first resource reservation response to the source node upon expiry of an interval of one first interframe space after the resource reservation request is received; and then</li><li>the resource releasing unit is specifically configured to send a first resource release instruction to the another node, so that the another node initializes the network allocation vector according to the first resource release instruction.</li></ul></p><p id="p0103" num="0103">For a solution of the double CTS mechanism:
<ul><li>the sending unit is specifically configured to send a second resource reservation response to the source node upon expiry of an interval of one first interframe space, one first resource reservation response, and one second interframe space after the resource reservation request is received; and then</li><li>the resource releasing unit is specifically configured to send a first resource release instruction to the another node, and after an interval of one first interframe space, send a second resource release instruction to the another node, so that the another node initializes the network allocation vector according to the first resource release instruction or the second resource release instruction.</li></ul></p><p id="p0104" num="0104">Referring to <figref idrefs="f0009">FIG. 14, FIG. 14</figref> shows a schematic diagram of a resource reservation apparatus according to Embodiment 2 of the present invention, where the apparatus is applied to a WiFi system, and the apparatus includes:
<ul><li>a receiving unit 401, configured to receive a resource reservation request sent by a source node;</li><li>a sending unit 402, configured to send a resource reservation response to the source node after the resource reservation request is received, where the resource reservation response includes a reservation time, and the resource reservation response is used to enable another node, which can monitor the resource reservation response, in the WiFi system to set a network allocation vector of the another node according to the reservation time;</li><li>a first determining unit 403, configured to determine whether data sent by the source node is received within a predetermined time;</li><li>a calculating unit 404, configured to, when the first determining unit<!-- EPO <DP n="28"> --> determines that the data sent by the source node is not received, calculate a remaining time of the reservation time, where the remaining time is a difference between the reservation time and the predetermined time;</li><li>a second determining unit 405, configured to compare the remaining time with a time required for sending the resource release instruction by the resource releasing unit; and</li><li>a resource releasing unit 406, configured to, when the second determining unit determines that the remaining time is not less than the time required for sending the resource release instruction, send the resource release instruction to the another node, so that the another node initializes the network allocation vector of the another node, and re-contends for a resource.</li></ul></p><p id="p0105" num="0105">It should be noted that, for a solution of a single CTS mechanism, the time for sending the resource release instruction refers to a time required for sending a first resource release instruction; for a solution of a double CTS mechanism, the time for sending the resource release instruction refers to a sum of a time required for sending a first resource release instruction, a time required for sending a second resource release instruction, and an interval of a first interframe space, where the first resource release instruction and the second resource release instruction respectively refer to an instruction sent in an STBC mode and an instruction sent in a non-STBC mode.</p><p id="p0106" num="0106">Further, this embodiment of the present invention further separately provides a hardware constitution of the resource reservation apparatus. The resource reservation apparatus may include at least one processor (for example, CPU), at least one network interface or another communications interface, a memory, and at least one communications bus which is used to implement communication and connections among these apparatuses. The processor is configured to execute an executable module stored in the memory, for example, a computer program. The memory may include a high-speed random access memory (RAM: Random Access Memory) and may further include a non-volatile memory (non-volatile memory), for example, at least one disk memory. Through at least one network interface (with or without a cable), communication connection between a system gateway and at least one another network element may be implemented by using the Internet, a wide area network, a local area network, a metropolitan area network, and the like.</p><p id="p0107" num="0107">Referring to <figref idrefs="f0010">FIG. 15</figref>, in some implementation manners, a memory stores a program instruction, where the program instruction may be executed by a processor,<!-- EPO <DP n="29"> --> and the program instruction includes a receiving unit 301, a sending unit 302, a determining unit 303, and a resource releasing unit 304. For specific implementation of each unit, refer to a corresponding unit disclosed in <figref idrefs="f0009">FIG 13</figref>. Alternatively, the program instruction may further include another unit disclosed in <figref idrefs="f0009">FIG 14</figref>, and details are not described herein again.</p><p id="p0108" num="0108">The solutions in the present invention can be described in the general context of executable computer instructions executed by a computer, for example, a program unit. Generally, the program unit includes a routine, program, object, component, data structure, and the like for executing a particular task or implementing a particular abstract data type. The solutions in the present invention may also be practiced in distributed computing environments in which tasks are performed by remote processing devices that are connected through a communications network. In a distributed computing environment, program units may be located in both local and remote computer storage media including storage devices.</p><p id="p0109" num="0109">The embodiments in this specification are all described in a progressive manner, for same or similar parts in the embodiments, reference may be made to these embodiments, and each embodiment focuses on a difference from other embodiments. Especially, an apparatus embodiment is basically similar to a method embodiment, and therefore is described briefly; for related parts, reference may be made to partial descriptions in the method embodiment. The described apparatus embodiment is merely exemplary. The units described as separate parts may or may not be physically separate, and parts displayed as units may or may not be physical units, may be located in one position, or may be distributed on a plurality of network units. Some or all of the modules may be selected according to actual requirements to achieve the objectives of the solutions of the embodiments. A person of ordinary skill in the art may understand and implement the embodiments of the present invention without creative efforts.</p><p id="p0110" num="0110">The foregoing describes the embodiments of the present invention in detail. The present invention is described in this specification by using specific implementation manners. The foregoing embodiments are described to help understand the method and the device of the present invention. Meanwhile, a person of ordinary skill in the art may change the specific implementation manners and application scope according to the idea of the present invention. Therefore, the specification shall not be construed as a limitation on the present invention.</p></description><claims mxw-id="PCLM90459123" lang="EN" load-source="patent-office"><!-- EPO <DP n="30"> --><claim id="c-en-0001" num="0001"><claim-text>A resource reservation method, wherein the method is applied to a WiFi system, and the method comprises:
<claim-text>receiving, by a destination node, a resource reservation request sent by a source node, and sending a resource reservation response to the source node, wherein the resource reservation response comprises a reservation time, and the resource reservation response is used to enable another node, which can monitor the resource reservation response, in the WiFi system to set a network allocation vector of the another node according to the reservation time; and</claim-text>
<claim-text>determining, by the destination node, whether data sent by the source node is received within a predetermined time; and if the data is not received, sending a resource release instruction, so that the another node initializes the network allocation vector of the another node, and re-contends for a resource.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The method according to claim 1, wherein before the sending a resource release instruction to the another node, the method further comprises:
<claim-text>obtaining a remaining time of the reservation time by calculation, and comparing the remaining time with a time required for sending the resource release instruction; and if the remaining time is not less than the time required for sending the resource release instruction, sending the resource release instruction to the another node, wherein the remaining time is a difference between the reservation time and the predetermined time.</claim-text></claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The method according to claim 1 or 2, wherein:
<claim-text>the resource reservation response is a first resource reservation response that is sent upon expiry of an interval of one first interframe space after the destination node receives the resource reservation request; and</claim-text>
<claim-text>the sending a resource release instruction to the another node comprises:
<claim-text>sending, by the destination node, a first resource release instruction to the another node, so that the another node initializes the network allocation vector according to the first resource release instruction.</claim-text></claim-text></claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>The method according to claim 1 or 2, wherein:
<claim-text>the resource reservation response is a second resource reservation response sent<!-- EPO <DP n="31"> --> upon expiry of an interval of one first interframe space, one first resource reservation response, and one second interframe space after the destination node receives the resource reservation request; and</claim-text>
<claim-text>the sending a resource release instruction to the another node comprises:
<claim-text>sending, by the destination node, a first resource release instruction to the another node, and sending a second resource release instruction to the another node after an interval of one first interframe space, so that the another node initializes the network allocation vector according to the first resource release instruction or the second resource release instruction.</claim-text></claim-text></claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>The method according to any one of claims 1 to 4, wherein:
<claim-text>the predetermined time T = aSIFSTime + aPHY-RX-START-Delay + aSlotTime;</claim-text>
<claim-text>wherein aSIFSTime is a first interframe space; aPHY-RX-START-Delay is a physical layer response time; aSlotTime is a timeslot length.</claim-text></claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>The method according to any one of claims 1 to 5, wherein a manner of obtaining the resource release instruction is as follows:
<claim-text>modifying any one of the resource reservation response, an acknowledgment frame, and a null data packet to obtain the resource release instruction; or</claim-text>
<claim-text>using a contention-free end frame as the resource release instruction; or</claim-text>
<claim-text>constructing a new control frame as the resource release instruction.</claim-text></claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>The method according to claim 6, wherein:
<claim-text>if the resource release instruction is obtained by modifying the resource reservation response or the acknowledgment frame, a resource release indication bit is any reserved bit in a frame control domain; or</claim-text>
<claim-text>if the resource release instruction is obtained by modifying the resource reservation response or the acknowledgment frame, a resource release indication bit is any reserved combination in a duration domain; or</claim-text>
<claim-text>if the resource release instruction is obtained by modifying the null data packet, a resource release indication bit is any reserved combination in a modulation and coding scheme domain; wherein</claim-text>
<claim-text>the resource release indication bit is used to instruct the another node to initialize the network allocation vector of the another node.</claim-text></claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>The method according to claim 7, wherein:
<claim-text>if the resource release indication bit is any reserved bit in the frame control domain, the duration domain of the resource reservation response is set to a default<!-- EPO <DP n="32"> --> value of the network allocation vector.</claim-text></claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>A resource reservation apparatus, wherein the apparatus is applied to a WiFi system, and the apparatus comprises:
<claim-text>a receiving unit, configured to receive a resource reservation request sent by a source node;</claim-text>
<claim-text>a sending unit, configured to send a resource reservation response to the source node after the resource reservation request is received, wherein the resource reservation response comprises a reservation time, and the resource reservation response is used to enable another node, which can monitor the resource reservation response, in the WiFi system to set a network allocation vector of the another node according to the reservation time;</claim-text>
<claim-text>a first determining unit, configured to determine whether data sent by the source node is received within a predetermined time; and</claim-text>
<claim-text>a resource releasing unit, configured to, when the first determining unit determines that the data sent by the source node is not received, send a resource release instruction to the another node, so that the another node initializes the network allocation vector of the another node, and re-contends for a resource.</claim-text></claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>The apparatus according to claim 1, wherein the apparatus further comprises:
<claim-text>a calculating unit, configured to obtain a remaining time of the reservation time by calculation, wherein the remaining time is a difference between the reservation time and the predetermined time; and</claim-text>
<claim-text>a second determining unit, configured to compare the remaining time with a time required for sending the resource release instruction by the resource releasing unit; and if the remaining time is not less than the time required for sending the resource release instruction, instruct the resource releasing unit to send the resource release instruction to the another node.</claim-text></claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>The apparatus according to claim 9 or 10, wherein:
<claim-text>the sending unit is specifically configured to send a first resource reservation response to the source node upon expiry of an interval of one first interframe space after the resource reservation request is received; and then</claim-text>
<claim-text>the resource releasing unit is specifically configured to send a first resource release instruction to the another node, so that the another node initializes the network allocation vector according to the first resource release instruction.</claim-text></claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>The apparatus according to claim 9 or 10, wherein:<!-- EPO <DP n="33"> -->
<claim-text>the sending unit is specifically configured to send a second resource reservation response to the source node upon expiry of an interval of one first interframe space, one first resource reservation response, and one second interframe space after the resource reservation request is received; and then</claim-text>
<claim-text>the resource releasing unit is specifically configured to send a first resource release instruction to the another node, and after an interval of one first interframe space, send a second resource release instruction to the another node, so that the another node initializes the network allocation vector according to the first resource release instruction or the second resource release instruction.</claim-text></claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>The apparatus according to any one of claims 9 to 12, wherein the predetermined time T during which the first determining unit determines whether the data sent by the source node is received is as follows: <maths id="math0003" num=""><math display="block"><mrow><mi mathvariant="normal">T</mi><mo>=</mo><mi mathvariant="normal">aSIFSTime</mi><mo>+</mo><mi mathvariant="normal">aPHY</mi><mo>-</mo><mi mathvariant="normal">RX</mi><mo>-</mo><mi mathvariant="normal">START</mi><mo>-</mo><mi mathvariant="normal">Delay</mi><mo>+</mo><mi mathvariant="normal">aSlotTime</mi><mo>,</mo></mrow></math><img id="ib0003" file="imgb0003.tif" wi="165" he="11" img-content="math" img-format="tif"/></maths><br/>
wherein aSIFSTime is a first interframe space; aPHY-RX-START-Delay is a physical layer response time; aSlotTime is a timeslot length.</claim-text></claim></claims><drawings mxw-id="PDW20421861" load-source="patent-office"><!-- EPO <DP n="34"> --><figure id="f0001" num="1,2,3"><img id="if0001" file="imgf0001.tif" wi="127" he="207" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="35"> --><figure id="f0002" num="4,5a"><img id="if0002" file="imgf0002.tif" wi="161" he="171" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="36"> --><figure id="f0003" num="5b"><img id="if0003" file="imgf0003.tif" wi="165" he="178" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="37"> --><figure id="f0004" num="6"><img id="if0004" file="imgf0004.tif" wi="146" he="55" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="38"> --><figure id="f0005" num="7"><img id="if0005" file="imgf0005.tif" wi="75" he="209" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="39"> --><figure id="f0006" num="8"><img id="if0006" file="imgf0006.tif" wi="161" he="145" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="40"> --><figure id="f0007" num="9,10"><img id="if0007" file="imgf0007.tif" wi="149" he="194" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="41"> --><figure id="f0008" num="11,12"><img id="if0008" file="imgf0008.tif" wi="151" he="193" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="42"> --><figure id="f0009" num="13,14"><img id="if0009" file="imgf0009.tif" wi="93" he="169" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="43"> --><figure id="f0010" num="15"><img id="if0010" file="imgf0010.tif" wi="147" he="85" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="165" he="229" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="165" he="226" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
