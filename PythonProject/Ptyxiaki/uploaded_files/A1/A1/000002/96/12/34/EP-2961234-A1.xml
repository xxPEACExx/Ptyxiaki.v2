<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2961234-A1" country="EP" doc-number="2961234" kind="A1" date="20151230" family-id="51391243" file-reference-id="312929" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160451108" ucid="EP-2961234-A1"><document-id><country>EP</country><doc-number>2961234</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-14754928-A" is-representative="YES"><document-id mxw-id="PAPP193865184" load-source="docdb" format="epo"><country>EP</country><doc-number>14754928</doc-number><kind>A</kind><date>20140218</date><lang>JA</lang></document-id><document-id mxw-id="PAPP193865185" load-source="patent-office" format="original"><country>EP</country><doc-number>14754928.1</doc-number><date>20140218</date><lang>JA</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162033191" ucid="JP-2014053743-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>JP</country><doc-number>2014053743</doc-number><kind>W</kind><date>20140218</date></document-id></priority-claim><priority-claim mxw-id="PPC162034231" ucid="US-201361766518-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201361766518</doc-number><kind>P</kind><date>20130219</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1897318011" load-source="docdb">H04W  92/18        20090101ALI20160902BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1897318012" load-source="docdb">H04W  72/04        20090101AFI20160902BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1687166268" load-source="docdb" scheme="CPC">H04W  76/14        20180201 FI20180219BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984697622" load-source="docdb" scheme="CPC">H04W  88/04        20130101 LA20151231BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984700863" load-source="docdb" scheme="CPC">H04W  72/04        20130101 LI20160106BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984701229" load-source="docdb" scheme="CPC">H04W   8/005       20130101 LI20151231BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984704104" load-source="docdb" scheme="CPC">H04W  92/18        20130101 LA20160106BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984704958" load-source="docdb" scheme="CPC">H04W   4/24        20130101 LI20151231BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165544790" lang="DE" load-source="patent-office">MOBILKOMMUNIKATIONSSYSTEM, BENUTZERENDGERÄTE UND BASISSTATIONEN</invention-title><invention-title mxw-id="PT165544791" lang="EN" load-source="patent-office">MOBILE COMMUNICATION SYSTEM, USER TERMINALS AND BASE STATIONS</invention-title><invention-title mxw-id="PT165544792" lang="FR" load-source="patent-office">SYSTÈME DE COMMUNICATION MOBILE, TERMINAUX UTILISATEUR ET STATIONS DE BASE</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR1103324643" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>KYOCERA CORP</last-name><address><country>JP</country></address></addressbook></applicant><applicant mxw-id="PPAR1103327361" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>KYOCERA CORPORATION</last-name></addressbook></applicant><applicant mxw-id="PPAR1101653981" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Kyocera Corporation</last-name><iid>101027790</iid><address><street>6, Takedatobadono-cho Fushimi-ku</street><city>Kyoto-shi, Kyoto 612-8501</city><country>JP</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103320102" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>MORITA KUGO</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103333181" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>MORITA, KUGO</last-name></addressbook></inventor><inventor mxw-id="PPAR1101651539" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>MORITA, KUGO</last-name><address><street>c/o KYOCERA Corporation Head Office 6 Takeda Tobadono-cho Fushimi-ku</street><city>Kyoto-shi Kyoto 612-8501</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103324152" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>IWABUCHI AKINORI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103326847" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>IWABUCHI, AKINORI</last-name></addressbook></inventor><inventor mxw-id="PPAR1101650167" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>IWABUCHI, AKINORI</last-name><address><street>c/o KYOCERA Corporation Head Office 6 Takeda Tobadono-cho Fushimi-ku</street><city>Kyoto-shi Kyoto 612-8501</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103315937" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>SUNAGA TOHRU</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103338554" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>SUNAGA, TOHRU</last-name></addressbook></inventor><inventor mxw-id="PPAR1101649992" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>SUNAGA, TOHRU</last-name><address><street>c/o KYOCERA Corporation Head Office 6 Takeda Tobadono-cho Fushimi-ku</street><city>Kyoto-shi Kyoto 612-8501</city><country>JP</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR1101651422" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Schwabe - Sandmair - Marx</last-name><iid>100060632</iid><address><street>Patentanwälte Stuntzstraße 16</street><city>81677 München</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="JP-2014053743-W"><document-id><country>JP</country><doc-number>2014053743</doc-number><kind>W</kind><date>20140218</date><lang>JA</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2014129453-A1"><document-id><country>WO</country><doc-number>2014129453</doc-number><kind>A1</kind><date>20140828</date><lang>JA</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS660603312" load-source="docdb">AL</country><country mxw-id="DS660604021" load-source="docdb">AT</country><country mxw-id="DS660603314" load-source="docdb">BE</country><country mxw-id="DS660603178" load-source="docdb">BG</country><country mxw-id="DS660605257" load-source="docdb">CH</country><country mxw-id="DS660781673" load-source="docdb">CY</country><country mxw-id="DS660604022" load-source="docdb">CZ</country><country mxw-id="DS660603315" load-source="docdb">DE</country><country mxw-id="DS660781674" load-source="docdb">DK</country><country mxw-id="DS660781675" load-source="docdb">EE</country><country mxw-id="DS660603570" load-source="docdb">ES</country><country mxw-id="DS660603179" load-source="docdb">FI</country><country mxw-id="DS660602980" load-source="docdb">FR</country><country mxw-id="DS660603316" load-source="docdb">GB</country><country mxw-id="DS660781676" load-source="docdb">GR</country><country mxw-id="DS660603317" load-source="docdb">HR</country><country mxw-id="DS660604027" load-source="docdb">HU</country><country mxw-id="DS660605258" load-source="docdb">IE</country><country mxw-id="DS660781677" load-source="docdb">IS</country><country mxw-id="DS660602981" load-source="docdb">IT</country><country mxw-id="DS660781678" load-source="docdb">LI</country><country mxw-id="DS660603180" load-source="docdb">LT</country><country mxw-id="DS660604198" load-source="docdb">LU</country><country mxw-id="DS660603181" load-source="docdb">LV</country><country mxw-id="DS660603182" load-source="docdb">MC</country><country mxw-id="DS660604207" load-source="docdb">MK</country><country mxw-id="DS660604208" load-source="docdb">MT</country><country mxw-id="DS660603318" load-source="docdb">NL</country><country mxw-id="DS660602982" load-source="docdb">NO</country><country mxw-id="DS660603188" load-source="docdb">PL</country><country mxw-id="DS660605259" load-source="docdb">PT</country><country mxw-id="DS660603319" load-source="docdb">RO</country><country mxw-id="DS660605260" load-source="docdb">RS</country><country mxw-id="DS660603189" load-source="docdb">SE</country><country mxw-id="DS660603875" load-source="docdb">SI</country><country mxw-id="DS660602987" load-source="docdb">SK</country><country mxw-id="DS660603190" load-source="docdb">SM</country><country mxw-id="DS660781679" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA166479478" lang="EN" load-source="patent-office"><p id="pa01" num="0001">A mobile communication system according to the embodiment supports cellular communication in which a data path passes through a network and D2D communication that is direct device-to-device communication in which a data path does not pass through the network. A frequency division multiplexing scheme is applied to the cellular communication and a code division multiplexing scheme is applied to the D2D communication. The network assigns a spread code having orthogonality to a user terminal in response to a request from the user terminal. The user terminal performs the D2D communication by using the spread code assigned by the network.<img id="iaf01" file="imgaf001.tif" wi="76" he="105" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA166759290" lang="EN" source="EPO" load-source="docdb"><p>A mobile communication system according to the embodiment supports cellular communication in which a data path passes through a network and D2D communication that is direct device-to-device communication in which a data path does not pass through the network. A frequency division multiplexing scheme is applied to the cellular communication and a code division multiplexing scheme is applied to the D2D communication. The network assigns a spread code having orthogonality to a user terminal in response to a request from the user terminal. The user terminal performs the D2D communication by using the spread code assigned by the network.</p></abstract><description mxw-id="PDES98404179" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001">TECHNICAL FIELD</heading><p id="p0001" num="0001">The prevent invention relates to a mobile communication system which supports D2D communication.</p><heading id="h0002">BACKGROUND ART</heading><p id="p0002" num="0002">In 3GPP (3rd Generation Partnership Project) which is a project aiming to standardize a mobile communication system, it is considered to introduce communication between devices (Device to Device: D2D) as a new function to be specified in Release 12 or subsequent versions (see Non Patent Literature 1).</p><p id="p0003" num="0003">In the D2D communication, a plurality of neighboring user terminals perform direct communication without passing through a network. That is, a data path of the D2D communication does not pass through the network. On the other hand, a data path of normal communication (cellular communication) of a mobile communication system passes through the network.</p><heading id="h0003">[Citation List]</heading><heading id="h0004">[Non Patent Literature]</heading><p id="p0004" num="0004">[Non Patent Literature 1] <nplcit id="ncit0001" npl-type="s"><text>3GPP Technical Report "TR 22.803 V2.0.0" November 2012</text></nplcit></p><heading id="h0005">SUMMARY OF THE INVENTION</heading><p id="p0005" num="0005">A network can easily manage a communication state in cellular communication. In contrast, it is difficult for a network to manage a communication state in D2D communication. Accordingly, there is a problem that a billing operation, for example, is difficult to perform in the D2D communication.</p><p id="p0006" num="0006">Therefore, the present invention provides a mobile communication system with<!-- EPO <DP n="2"> --> which it is possible to facilitate an operation for the D2D communication.</p><p id="p0007" num="0007">A mobile communication system according to the embodiment supports cellular communication in which a data path passes through a network and D2D communication that is direct device-to-device communication in which a data path does not pass through the network. A frequency division multiplexing scheme is applied to the cellular communication and a code division multiplexing scheme is applied to the D2D communication. The network assigns a spread code having orthogonality to a user terminal in response to a request from the user terminal. The user terminal performs the D2D communication by using the spread code assigned by the network.</p><heading id="h0006">BRIEF DESCRIPTION OF DRAWINGS</heading><p id="p0008" num="0008"><ul><li>[<figref idrefs="f0001">Fig. 1] Fig. 1</figref> is a configuration diagram of an LTE system.</li><li>[<figref idrefs="f0002">Fig. 2] Fig. 2</figref> is a block diagram of the UE.</li><li>[<figref idrefs="f0002">Fig. 3] Fig. 3</figref> is a block diagram of the eNB.</li><li>[<figref idrefs="f0003">Fig. 4] Fig. 4</figref> is a protocol stack diagram of a radio interface in the LTE system.</li><li>[<figref idrefs="f0003">Fig. 5] Fig. 5</figref> is a configuration diagram of a radio frame used in the LTE system.</li><li>[<figref idrefs="f0004">Fig. 6] Fig. 6</figref> is a diagram illustrating a direct communication mode in D2D communication.</li><li>[<figref idrefs="f0004">Fig. 7] Fig. 7</figref> is a diagram illustrating a frequency assignment according to a first embodiment.</li><li>[<figref idrefs="f0005">Fig. 8] Fig. 8</figref> is a diagram illustrating an operation environment according to the first embodiment.</li><li>[<figref idrefs="f0006">Fig. 9] Fig. 9</figref> is a sequence diagram according to the first embodiment.</li><li>[<figref idrefs="f0007">Fig. 10] Fig. 10</figref> is a sequence diagram according to a first modification of the first embodiment.</li><li>[<figref idrefs="f0008">Fig. 11] Fig. 11</figref> is a sequence diagram according to a second modification of the first embodiment.</li><li>[<figref idrefs="f0009">Fig. 12] Fig. 12</figref> is a sequence diagram in which a part of the sequence of <figref idrefs="f0008">Fig. 11</figref> is changed.</li><li>[<figref idrefs="f0010">Fig. 13] Fig. 13</figref> is a sequence diagram according to a third modification of the first embodiment.</li><li>[<figref idrefs="f0011">Fig. 14] Fig. 14</figref> is a diagram illustrating a data transmission method according to a fourth modification of the first embodiment.</li><li>[<figref idrefs="f0012">Fig. 15] Fig. 15</figref> is a diagram illustrating a transmission data format according to a<!-- EPO <DP n="3"> --> sixth modification of the first embodiment.</li><li>[<figref idrefs="f0013">Fig. 16] Fig. 16</figref> is a flow diagram according to a seventh modification of the first embodiment.</li><li>[<figref idrefs="f0014">Fig. 17] Fig. 17</figref> is a sequence diagram according to an eighth modification of the first embodiment.</li><li>[<figref idrefs="f0015">Fig. 18] Fig. 18</figref> is a sequence diagram in which a part of the sequence of <figref idrefs="f0014">Fig. 17</figref> is changed.</li><li>[<figref idrefs="f0016">Fig. 19] Fig. 19</figref> is a sequence diagram according to a second embodiment.</li><li>[<figref idrefs="f0017">Fig. 20] Fig. 20</figref> is a sequence diagram according to a first modification of the second embodiment.</li><li>[<figref idrefs="f0018">Fig. 21] Fig. 21</figref> is a sequence diagram according to a second modification of the second embodiment.</li><li>[<figref idrefs="f0019">Fig. 22] Fig. 22</figref> is a sequence diagram according to a third modification of the second embodiment.</li><li>[<figref idrefs="f0020">Fig. 23] Fig. 23</figref> is a diagram illustrating an operation overview according to a third embodiment.</li><li>[<figref idrefs="f0021">Fig. 24] Fig. 24</figref> is a sequence diagram according to the third embodiment.</li><li>[<figref idrefs="f0022">Fig. 25] Fig. 25</figref> is a diagram illustrating an operation overview according to a fourth embodiment.</li><li>[<figref idrefs="f0023">Fig. 26] Fig. 26</figref> is a sequence diagram according to the fourth embodiment.</li><li>[<figref idrefs="f0024">Fig. 27] Fig. 27</figref> is a diagram illustrating an operation overview according to a first modification of the fourth embodiment.</li><li>[<figref idrefs="f0025">Fig. 28] Fig. 28</figref> is a sequence diagram according to the first modification of the fourth embodiment.</li><li>[<figref idrefs="f0026">Fig. 29] Fig. 29</figref> is a sequence diagram obtained by changing a part of the sequence of <figref idrefs="f0025">Fig. 28</figref>.</li><li>[<figref idrefs="f0027">Fig. 30] Fig. 30</figref> is a diagram illustrating an operation overview according to a second modification of the fourth embodiment.</li><li>[<figref idrefs="f0028">Fig. 31] Fig. 31</figref> is a sequence diagram according to the second modification of the fourth embodiment.</li><li>[<figref idrefs="f0029">Fig. 32] Fig. 32</figref> is a diagram illustrating an operation overview according to a third modification of the fourth embodiment.</li><li>[<figref idrefs="f0030">Fig. 33] Fig. 33</figref> is a sequence diagram according to a fifth embodiment.</li><li>[<figref idrefs="f0031">Fig. 34] Fig. 34</figref> is a diagram illustrating an operation according to a first modification of the fifth embodiment.</li><li>[<figref idrefs="f0032">Fig. 35] Fig. 35</figref> is a sequence diagram according to a second modification of the<!-- EPO <DP n="4"> --> fifth embodiment.</li><li>[<figref idrefs="f0033">Fig. 36] Fig. 36</figref> is a sequence diagram when the number of UEs included in a D2D UE group increases according to a sixth embodiment.</li><li>[<figref idrefs="f0034">Fig. 37] Fig. 37</figref> is a sequence diagram when the number of UEs included in the D2D UE group decreases according to the sixth embodiment.</li><li>[<figref idrefs="f0035">Fig. 38] Fig. 38</figref> is a diagram illustrating an operation according to a seventh embodiment (part 1).</li><li>[<figref idrefs="f0036">Fig. 39] Fig. 39</figref> is a diagram illustrating an operation according to the seventh embodiment (part 2).</li><li>[<figref idrefs="f0037">Fig. 40] Fig. 40</figref> is a diagram illustrating an operation according to the seventh embodiment (part 3).</li><li>[<figref idrefs="f0038">Fig. 41] Fig. 41</figref> is a diagram illustrating an operation environment according to an eighth embodiment.</li></ul></p><heading id="h0007">DESCRIPTION OF EMBODIMENTS</heading><heading id="h0008">[Overview of Embodiment]</heading><p id="p0009" num="0009">A mobile communication system according to the embodiment supports cellular communication in which a data path passes through a network and D2D communication that is direct device-to-device communication in which a data path does not pass through the network. A frequency division multiplexing scheme is applied to the cellular communication and a code division multiplexing scheme is applied to the D2D communication. The network assigns a spread code having orthogonality to a user terminal in response to a request from the user terminal. The user terminal performs the D2D communication by using the spread code assigned by the network.</p><p id="p0010" num="0010">In the embodiment, the network performs charging for the use of the spread code by the user terminal.</p><p id="p0011" num="0011">In the embodiment, a valid time is set for the spread code. The user terminal to which the spread code is assigned requests the network to reassign the spread code in order to continue the D2D communication.</p><p id="p0012" num="0012">In the embodiment, the network controls the valid time on the basis of at least one of an elapsed time of the D2D communication by the user terminal, an application that the user terminal uses for the D2D communication, a billing contract of the user terminal, and<!-- EPO <DP n="5"> --> movement speed of the user terminal.</p><p id="p0013" num="0013">In the embodiment, the user terminal requests the network to reassign the spread code in response to detection of deterioration in communication quality of the D2D communication, even before the valid time expires.</p><p id="p0014" num="0014">In the embodiment, when the user terminal ends the D2D communication before the valid time expires, the user terminal notifies the network of the end of the D2D communication.</p><p id="p0015" num="0015">In the embodiment, when reassigning the spread code, the network assigns, to the user terminal, a spread code different from the spread code before the reassignment.</p><p id="p0016" num="0016">In the embodiment, the network assigns, to the user terminal, the spread code for transmission in the D2D communication and the spread code for reception in the D2D communication.</p><p id="p0017" num="0017">In the embodiment, the network controls a code length of the spread code to be assigned to the user terminal on the basis of at least one of communication quality of the D2D communication in the user terminal and the number of user terminals performing the D2D communication in a cell to which the user terminal belongs.</p><p id="p0018" num="0018">In the embodiment, when the network determines that the code length of the spread code to be assigned to the user terminal is longer than a predetermined length, the network instructs the user terminal to switch from the D2D communication to the cellular communication.</p><p id="p0019" num="0019">In the embodiment, the user terminal retains an initial spread code having no orthogonality. The user terminal performs the D2D communication by using the initial spread code even when the spread code is not assigned by the network.</p><p id="p0020" num="0020">In the embodiment, the user terminal performing the D2D communication by using the initial spread code requests the network to assign the spread code in response to detection of deterioration in communication quality of the D2D communication.</p><p id="p0021" num="0021">In the embodiment, when the network determines that the communication quality<!-- EPO <DP n="6"> --> will improve by assigning the spread code, the network assigns the spread code to the user terminal.</p><p id="p0022" num="0022">In the embodiment, the user terminal performing the D2D communication by using the initial spread code performs transmission in the D2D communication on the basis of a result of monitoring an interference wave signal.</p><p id="p0023" num="0023">In the embodiment, the network assigns the spread code to a user terminal group including the user terminal and another user terminal which is to perform the D2D communication with the user terminal.</p><p id="p0024" num="0024">In the embodiment, the user terminal transmits the request to the network on the basis of an increase and decrease in the number of user terminals included in the user terminal group.</p><p id="p0025" num="0025">In the embodiment, the network controls the number of spread codes to be assigned to the user terminal group on the basis of the number of user terminals included in the user terminal group.</p><p id="p0026" num="0026">In the embodiment, the network denies the assignment of the spread code to the user terminal group when a user terminal under a billing contract for which the D2D communication is not permitted is included in the user terminal group.</p><p id="p0027" num="0027">In the embodiment, the network notifies the user terminal of transmission and reception start timing of the D2D communication by using, as a reference, timing of the cellular communication.</p><p id="p0028" num="0028">In the embodiment, the network comprises a plurality of cells. Each of the plurality of cells notifies a neighboring cell of an assignment situation of the spread code in the self cell.</p><p id="p0029" num="0029">In the embodiment, the network assigns the spread code to the user terminal on the basis of an identifier associated with the user terminal.</p><p id="p0030" num="0030">In the embodiment, the user terminal performing the D2D communication by using the spread code performs transmission by applying the spread code to each of a plurality of<!-- EPO <DP n="7"> --> subcarriers.</p><p id="p0031" num="0031">In the embodiment, when the user terminal performing the D2D communication transmits data, the user terminal transmits information indicating an application corresponding to the data by adding the information to the data.</p><p id="p0032" num="0032">In the embodiment, the network broadcasts information indicating a spread code that should be used for a discovery process of discovering a neighboring terminal that should be a communication partner in the D2D communication.</p><p id="p0033" num="0033">In the embodiment, the network comprises a server device that is shared by a plurality of communication providers and that performs assignment of the spread code.</p><p id="p0034" num="0034">A user terminal according to the embodiment is used in a mobile communication system that supports cellular communication in which a data path passes through a network, and D2D communication that is direct device-to-device communication in which a data path does not pass through the network. The user terminal comprises: a controller that performs the D2D communication by using a spread code assigned by the network and having orthogonality. A frequency division multiplexing scheme is applied to the cellular communication and a code division multiplexing scheme is applied to the D2D communication.</p><p id="p0035" num="0035">A base station according to the embodiment is used in a mobile communication system that supports cellular communication in which a data path passes through a network, and D2D communication that is direct device-to-device communication in which a data path does not pass through the network. The base station comprises: a controller that assigns, to a user terminal, a spread code having orthogonality, for the D2D communication, in response to a request from the user terminal. A frequency division multiplexing scheme is applied to the cellular communication and a code division multiplexing scheme is applied to the D2D communication.</p><heading id="h0009">[First embodiment]</heading><p id="p0036" num="0036">Hereinafter, with reference to the accompanying drawings, a description will be provided for an embodiment in a case where D2D communication is introduced to a mobile communication system (an LTE system) configured on the basis of the 3GPP standards. In addition, in the description of the drawings below, identical or similar symbols are assigned<!-- EPO <DP n="8"> --> to identical or similar portions.</p><heading id="h0010">(Configuration of LTE system)</heading><p id="p0037" num="0037"><figref idrefs="f0001">Fig. 1</figref> is a configuration diagram of an LTE system according to a first embodiment. As illustrated in <figref idrefs="f0001">Fig. 1</figref>, the LTE system includes a plurality of UE (User Equipment) 1A to 1C, E-UTRAN (Evolved-UMTS Terrestrial Radio Access Network) 10, and EPC (Evolved Packet Core) 20. The E-UTRAN 10 corresponds to a radio access network and the EPC 20 corresponds to a core network. The E-UTRAN 10 and the EPC 20 configure a network of the LTE system.</p><p id="p0038" num="0038">The UE 1 is a mobile communication device and performs radio communication with a cell (a serving cell) to which the UE 1 is connected. The UE 1 corresponds to the user terminal.</p><p id="p0039" num="0039">The E-UTRAN 10 includes a plurality of eNB (evolved Node-B) 2A to 2C. The eNB 2 corresponds to a base station. The eNB 2 manages one or a plurality of cells and performs radio communication with the UE 1 which establishes a connection with the cell of the eNB 2. It is noted that the "cell" is used as a term indicating a minimum unit of a radio communication area, and is also used as a term indicating a function of performing radio communication with the UE 1.</p><p id="p0040" num="0040">The eNB 2, for example, has a radio resource management (RRM) function, a function of routing user data, and a measurement control function for mobility control and scheduling.</p><p id="p0041" num="0041">The EPC 20 includes a plurality of MME (Mobility Management Entity)/S-GW (Serving-Gateway) 3A and 3B, and a charging server 4. The MME is a network node that performs various mobility controls and the like for the UE 1 and corresponds to a controller. The S-GW is a network node that performs transfer control of user data and corresponds to a mobile switching center. The charging server 4 is a network node that manages charging for the UE 1. The charging server 4 charges not only for the cellular communication, but also for the D2D communication, however, details thereof will be described later.</p><p id="p0042" num="0042">The eNBs 2 are connected mutually via an X2 interface. Furthermore, the eNB 2 is connected to the EPC 20 via an S1 interface.</p><p id="p0043" num="0043"><!-- EPO <DP n="9"> --> Next, the configurations of the UE 1 and the eNB 2 will be described.</p><p id="p0044" num="0044"><figref idrefs="f0002">Fig. 2</figref> is a block diagram of the UE 1. As illustrated in <figref idrefs="f0002">Fig. 2</figref>, the UE 1 includes an antenna 101, a radio transceiver 110, a user interface 120, a GNSS (Global Navigation Satellite System) receiver 130, a battery 140, a memory 150, and a processor 160. The memory 150 and the processor 160 configure a controller. The UE 1 may not have the GNSS receiver 130. Furthermore, the memory 150 may be integrally formed with the processor 160, and this set (that is, a chipset) may be called a processor 160'.</p><p id="p0045" num="0045">The antenna 101 and the radio transceiver 110 are used to transmit and receive a radio signal. The antenna 101 includes a plurality of antenna elements. The radio transceiver 110 converts a baseband signal output from the processor 160 into the radio signal, and transmits the radio signal from the antenna 101. Furthermore, the radio transceiver 110 converts the radio signal received by the antenna 101 into the baseband signal, and outputs the baseband signal to the processor 160.</p><p id="p0046" num="0046">The user interface 120 is an interface with a user carrying the UE 1, and includes, for example, a display, a microphone, a speaker, and various buttons. The user interface 120 receives an operation from a user and outputs a signal indicating the content of the operation to the processor 160. The GNSS receiver 130 receives a GNSS signal in order to obtain location information indicating a geographical location of the UE 1, and outputs the received signal to the processor 160. The battery 140 accumulates a power to be supplied to each block of the UE 1.</p><p id="p0047" num="0047">The memory 150 stores a program to be executed by the processor 160 and information to be used for a process by the processor 160. The processor 160 includes a baseband processor that performs modulation and demodulation, encoding and decoding and the like on the baseband signal, and a CPU (Central Processing Unit) that performs various processes by executing the program stored in the memory 150. The processor 160 may further include a codec that performs encoding and decoding on sound and video signals. The processor 160 executes various processes and various communication protocols described later.</p><p id="p0048" num="0048"><figref idrefs="f0002">Fig. 3</figref> is a block diagram of the eNB 2. As illustrated in <figref idrefs="f0002">Fig. 3</figref>, the eNB 2 includes an antenna 201, a radio transceiver 210, a network interface 220, a memory 230, and a processor 240. The memory 230 and the processor 240 configure a controller.<!-- EPO <DP n="10"> --></p><p id="p0049" num="0049">The antenna 201 and the radio transceiver 210 are used to transmit and receive a radio signal. The antenna 201 includes a plurality of antenna elements. The radio transceiver 210 converts the baseband signal output from the processor 240 into the radio signal, and transmits the radio signal from the antenna 201. Furthermore, the radio transceiver 210 converts a radio signal received by the antenna 201 into the baseband signal, and outputs the baseband signal to the processor 240.</p><p id="p0050" num="0050">The network interface 220 is connected to a neighboring eNB 2 via an X2 interface and is connected to the MME/S-GW 300 via the S1 interface. The network interface 220 is used in communication performed on the X2 interface and communication performed on the S1 interface.</p><p id="p0051" num="0051">The memory 230 stores a program to be executed by the processor 240 and information to be used for a process by the processor 240. The processor 240 includes the baseband processor that performs modulation and demodulation, encoding and decoding and the like on the baseband signal and a CPU that performs various processes by executing the program stored in the memory 230. The processor 240 executes various processes and various communication protocols described later.</p><p id="p0052" num="0052"><figref idrefs="f0003">Fig. 4</figref> is a protocol stack diagram of a radio interface in the LTE system. As illustrated in <figref idrefs="f0003">Fig. 4</figref>, the radio interface protocol is classified into a layer 1 to a layer 3 of an OSI reference model, wherein the layer 1 is a physical (PHY) layer. The layer 2 includes a MAC (Media Access Control) layer, an RLC (Radio Link Control) layer, and a PDCP (Packet Data Convergence Protocol) layer. The layer 3 includes an RRC (Radio Resource Control) layer.</p><p id="p0053" num="0053">The physical layer performs encoding and decoding, modulation and demodulation, antenna mapping and demapping, and resource mapping and demapping. Between the physical layer of the UE 1 and the physical layer of the eNB 2, data is transmitted via a physical channel.</p><p id="p0054" num="0054">The MAC layer performs priority control of data, and a retransmission process and the like by hybrid ARQ (HARQ). Between the MAC layer of the UE 1 and the MAC layer of the eNB 2, data is transmitted via a transport channel. The MAC layer of the eNB 2 includes a transport format of an uplink and a downlink (a transport block size and a<!-- EPO <DP n="11"> --> modulation and coding scheme (MCS)) and a scheduler for determining a resource block to be assigned.</p><p id="p0055" num="0055">The RLC layer transmits data to an RLC layer of a reception side by using the functions of the MAC layer and the physical layer. Between the RLC layer of the UE 1 and the RLC layer of the eNB 2, data is transmitted via a logical channel.</p><p id="p0056" num="0056">The PDCP layer performs header compression and decompression, and encryption and decryption.</p><p id="p0057" num="0057">The RRC layer is defined only in a control plane. Between the RRC layer of the UE 1 and the RRC layer of the eNB 2, a control (an RRC) for various types of setting is transmitted. The RRC layer controls the logical channel, the transport channel, and the physical channel in response to establishment, re-establishment, and release of a radio bearer. When there is an RRC connection between the RRC of the UE 1 and the RRC of the eNB 2, the UE 1 is in a connected state (an RRC connected state), and when there is no RRC connection, the UE 1 is in an idle state (an RRC idle state).</p><p id="p0058" num="0058">A NAS (Non-Access Stratum) layer positioned above the RRC layer performs session management, mobility management and the like.</p><p id="p0059" num="0059"><figref idrefs="f0003">Fig. 5</figref> is a configuration diagram of a radio frame used in the LTE system. The frequency division multiplexing scheme is applied to the LTE system. Specifically, OFDMA (Orthogonal Frequency Division Multiplexing Access) is applied to a downlink, and SC-FDMA (Single Carrier Frequency Division Multiple Access) is applied to an uplink, respectively.</p><p id="p0060" num="0060">As illustrated in <figref idrefs="f0003">Fig. 5</figref>, the radio frame is configured by 10 subframes arranged in a time direction, wherein each subframe is configured by two slots arranged in the time direction. Each subframe has a length of 1 ms and each slot has a length of 0.5 ms. Each subframe includes a plurality of resource blocks (RBs) in a frequency direction, and a plurality of symbols in the time direction. The resource block includes a plurality of subcarriers in the frequency direction. Among radio resources assigned to the UE 1, a frequency resource can be designated by a resource block and a time resource can be specified by a subframe (or slot).</p><p id="p0061" num="0061"><!-- EPO <DP n="12"> --> In the downlink, an interval of several symbols at the head of each subframe is a control region used as a physical downlink control channel (PDCCH) for mainly transmitting a control signal. Furthermore, the other interval of each subframe is a region available as a physical downlink shared channel (PDSCH) for mainly transmitting user data.</p><p id="p0062" num="0062">In the uplink, both ends in the frequency direction of each subframe are control regions used as a physical uplink control channel (PUCCH) for mainly transmitting a control signal. Furthermore, the central portion in the frequency direction of each subframe is a region available as a physical uplink shared channel (PUSCH) for mainly transmitting user data.</p><heading id="h0011">(Operation according to first embodiment)</heading><p id="p0063" num="0063">Next, an operation according to the first embodiment will be described. The LTE system according to the first embodiment supports D2D communication that is direct UE-to-UE communication. Hereinafter, the D2D communication will be described in comparison with normal communication (cellular communication) of the LTE system.</p><p id="p0064" num="0064">In the cellular communication, a data path passes through the EPC 20 that is the core network. The data path indicates a communication path of user data (a user plane). On the other hand, in the D2D communication, the data path set between UEs does not pass through the EPC 20. Thus, it is possible to reduce traffic load of the EPC 20.</p><p id="p0065" num="0065">The UE 1 discovers another UE 1 that exists in the vicinity of the UE 1, and starts the D2D communication. The D2D communication includes a direct communication mode and a locally routed mode.</p><p id="p0066" num="0066"><figref idrefs="f0004">Fig. 6</figref> is a diagram illustrating the direct communication mode in the D2D communication. As illustrated in <figref idrefs="f0004">Fig. 6</figref>, in the direct communication mode, a data path does not pass through the eNB 2. UE 1A and UE 1B adjacent to each other directly perform radio communication with low transmission power in a cell of the eNB 2. Thus, a merit including reduction of power consumption of the UE 1 and decrease of interference to a neighboring cell can be obtained.</p><p id="p0067" num="0067">The UE 1A and UE 1B are D2D UEs (D2D terminals) that perform the D2D communication in the direct communication mode in the cell of the eNB 2. The UE 1A and UE 1B in a connected state perform the D2D communication by using a radio resource that<!-- EPO <DP n="13"> --> is assigned by the eNB 2. The UE 1A and UE 1B transmit and receive user data to and from each other, and transmit and receive a control signal to and from the eNB 2. As described above, the control of the D2D communication is performed at the initiative of the eNB 2.</p><p id="p0068" num="0068">UE 1C is a cellular UE (a cellular terminal) that performs cellular communication in the cell of the eNB 2. The UE 1C in a connected state performs the cellular communication by using the radio resource that is assigned by the eNB 2. The UE 1C transmits and receives user data and a control signal to and from the eNB 2.</p><p id="p0069" num="0069">In addition, in the locally routed mode, a data path between UEs passes through the eNB 2, however, the data path does not pass through the EPC 20. That is, in the locally routed mode, the UE 1A and UE 1B perform radio communication via the eNB 2 without passing through the EPC 20. The locally routed mode is able to reduce traffic load of the EPC 20, however, has a smaller merit as compared with the direct communication mode. Thus, in the first embodiment, the direct communication mode is mainly assumed.</p><p id="p0070" num="0070">Further, in the first embodiment, a case, in which the D2D communication is performed in a frequency band (a licensed band) of the LTE system, is assumed.</p><p id="p0071" num="0071"><figref idrefs="f0004">Fig. 7</figref> is a diagram illustrating a frequency assignment according to the first embodiment. As illustrated in <figref idrefs="f0004">Fig. 7</figref>, the frequency band of the LTE system is divided into a frequency band for cellular communication and a frequency band for D2D communication. Such frequency assignment enables to avoid interference between the cellular communication and the D2D communication.</p><p id="p0072" num="0072">Further, in the first embodiment, the frequency division multiplexing scheme is applied to the cellular communication and the code division multiplexing scheme is applied to the D2D communication. Namely, for a cellular UE, a different frequency resource (a resource block) is assigned, thereby realizing multiplexing. For a D2D UE, a different spread code (a code) is assigned, thereby realizing multiplexing.</p><p id="p0073" num="0073"><figref idrefs="f0005">Fig. 8</figref> is a diagram illustrating an operation environment according to the first embodiment. As illustrated in <figref idrefs="f0005">Fig. 8</figref>, a plurality ofUE 1A to UE 1D camp on the cell of the eNB 2. Each of the plurality of UE 1A to UE 1D retains the initial spread code having no orthogonality (for example, all 1).<!-- EPO <DP n="14"> --></p><p id="p0074" num="0074">The UE 1B discovers the UE 1A by the discovery process of discovering a neighboring UE that should be a communication partner in D2D communication, and starts the D2D communication with the UE 1A. The UE 1A and UE 1B performs the D2D communication (guaranteed D2D communication) by using the spread code assigned by the eNB 2. The guaranteed D2D communication is to be charged by the charging server 4. The spread code assigned by the eNB 2 has orthogonality, and thus, excellent communication quality and high confidentiality are guaranteed in the guaranteed D2D communication.</p><p id="p0075" num="0075">The UE 1D discovers the UE 1C by the discovery process and starts D2D communication with the UE 1C. The UE 1C and UE 1D perform the D2D communication (non-guaranteed D2D communication) by using the initial spread code. The non-guaranteed D2D communication is not to be charged by the charging server 4, that is, the communication is free of charge. The non-guaranteed D2D communication is available for free, but communication quality and confidentiality are not guaranteed.</p><p id="p0076" num="0076"><figref idrefs="f0006">Fig. 9</figref> is a sequence diagram according to the first embodiment. Hereinafter, an operation to start the D2D communication of the UE 1A and UE 1B after completing the discovery process will be described.</p><p id="p0077" num="0077">As illustrated in <figref idrefs="f0006">Fig. 9</figref>, firstly, the UE 1B in a connection state in the cell of the eNB 2 transmits, to the eNB 2, a D2D request to request assignment for the D2D communication (S1). The D2D request includes an identifier of each of the UEs 1 (the UE 1A and UE 1B) that requests the assignment. It is noted that, in the description of the drawings below, the identifiers of the UE 1A, the UE 1B, ... is denoted as "UE 1A", "UE 1B", ... , appropriately</p><p id="p0078" num="0078">Secondly, the eNB 2 that has received the D2D request calculates a spread code having orthogonality in response to the D2D request (S2). For example, a Walsh code may be used as the spread code having orthogonality. When the eNB 2 realizes the spread code being assigned in the neighboring eNB (which will be described later in a seventh embodiment), it is preferable that the eNB 2 calculates a spread code that does not overlap with the spread code being assigned in the neighboring eNB.</p><p id="p0079" num="0079">Thirdly, the eNB 2 transmits D2D permission to permit the D2D communication, to the UE 1A and UE 1B (S3, S4). The D2D permission includes code information indicating<!-- EPO <DP n="15"> --> the calculated spread code (assigned spread code) and an identifier of each of the UEs 1 (the UE 1A and UE 1B) that are permitted to perform the D2D communication. As a result, the spread code is assigned to the UE 1A and UE 1B.</p><p id="p0080" num="0080">Fourthly, the eNB 2 that has assigned the spread code to the UE 1A and UE 1B transmits, to the charging server 4, D2D charging information to charge for the use of the spread code by the UE 1A and UE 1B (S8). The D2D charging information includes the identifier of each of the UEs 1 (the UE 1A and UE 1B) that are to be charged. The charging server 4 charges each of the UEs 1 (the UE 1A and UE 1B) corresponding to the identifier included in the D2D charging (S9).</p><p id="p0081" num="0081">Fifthly, the UE 1A and UE 1B, which have received the D2D permission from the eNB 2, set the spread code corresponding to the code information included in the D2D permission (code1 in this case) (S5, S6). Then, the UE 1A and UE 1B perform the D2D communication by using the set spread code (S7).</p><p id="p0082" num="0082">As described above, in the first embodiment, excellent communication quality and high confidentiality are guaranteed for the UE 1A and UE 1B that perform the guaranteed D2D communication on condition of the charging. Further, the network (the eNB 2 and the charging server 4) can appropriately operate the charging of the D2D communication by charging for the use of the spread code. Further, though communication quality and confidentiality are not guaranteed for the UE 1C and UE 1D that perform the non-guaranteed D2D communication, the UE 1C and UE 1D can perform the D2D communication.</p><heading id="h0012">[First modification of first embodiment]</heading><p id="p0083" num="0083">Any one of the UE 1A and UE 1B may be UE (hereinafter, an anchor UE) capable of controlling the other UE in the D2D communication. When the anchor UE exists, the other UE (the communication partner UE) can transmit and receive the control signal to and from not the eNB 2 but the anchor UE.</p><p id="p0084" num="0084"><figref idrefs="f0007">Fig. 10</figref> is a sequence diagram according to a first modification of the first embodiment. Hereinafter, a case where the UE 1B is the anchor UE will be described.</p><p id="p0085" num="0085">As illustrated in <figref idrefs="f0007">Fig. 10</figref>, the eNB 2 transmits the D2D permission only to the UE 1B (S3). That is, the eNB 2 notifies only the UE 1B of the assigned spread code.</p><p id="p0086" num="0086"><!-- EPO <DP n="16"> --> The UE 1B that has received the D2D permission transfers the D2D permission to the UE 1A (S4). As a result, the assigned spread code is notified to the UE 1A.</p><p id="p0087" num="0087">As described above, in the first modification of first embodiment, signaling between the eNB and UE can be reduced by notifying the UE 1A of the assigned spread code via the UE 1B.</p><heading id="h0013">[Second modification of first embodiment]</heading><p id="p0088" num="0088">The UE 1A and UE 1B camp not only on the identical cell, but may also camp on different cells.</p><p id="p0089" num="0089"><figref idrefs="f0008">Fig. 11</figref> is a sequence diagram according to a second modification of the first embodiment. Hereinafter, a case where the UE 1B camps on the cell of eNB 2A and the UE 1A camps on the cell of eNB 2B will be described.</p><p id="p0090" num="0090">As illustrated in <figref idrefs="f0008">Fig. 11</figref>, the eNB 2A that has calculated the spread code (S2) transmits D2D permission to the UE 1B (S3) and transmits D2D permission to the eNB 2B (S3').</p><p id="p0091" num="0091">The eNB 2B that has received the D2D permission from the eNB 2A transfers the D2D permission to the UE 1A (S4). Thus, the assigned spread code is notified by the eNB 2A to the UE 1A via the eNB 2B.</p><p id="p0092" num="0092">As described above, in the second modification of first embodiment, the UE 1A and UE 1B can perform the D2D communication even when the UE 1A and UE 1B camp on different cells.</p><p id="p0093" num="0093"><figref idrefs="f0009">Fig. 12</figref> is a sequence diagram obtained by changing a part of the sequence of <figref idrefs="f0008">Fig. 11</figref>. As illustrated in <figref idrefs="f0009">Fig. 12</figref>, when the UE 1A and UE 1B camp on different cells, the UE 1B operates as an anchor UE. The UE 1B that has received the D2D permission from the eNB 2A transfers the D2D permission to the UE 1A (S4).</p><heading id="h0014">[Third modification of first embodiment]</heading><p id="p0094" num="0094">In a third modification of the first embodiment, the UE 1A and UE 1B use the assigned spread code after attempt of use. <figref idrefs="f0010">Fig. 13</figref> is a sequence diagram according to the third modification of the first embodiment.<!-- EPO <DP n="17"> --></p><p id="p0095" num="0095">As illustrated in <figref idrefs="f0010">Fig. 13</figref>, after setting the spread code (S5, S6), the UE 1A and UE 1B attempt the D2D communication by using the spread code (S11, S12).</p><p id="p0096" num="0096">When the attempt is successful, the UE 1A and UE 1B transmit, to the eNB 2, a D2D permission reply indicating the success in the attempt (S13, S14) and start the D2D communication (S7).</p><p id="p0097" num="0097">When the eNB 2 receives the D2D permission reply indicating the success in the attempt, the eNB 2 transmits the D2D charging information to the charging server 4 (S8). The charging server 4 that has received the D2D charging information charges the UE 1A and UE 1B (S9).</p><p id="p0098" num="0098">On the other hand, when the UE 1B detects failure in the attempt, the UE 1B transmits, to the eNB 2, the D2D permission reply indicating the failure in the attempt (S15). The UE 1A detects success in the attempt and transmits, to the eNB 2, the D2D permission reply indicating the success in the attempt (S16). The eNB 2 that has received, from the UE 1B, the D2D permission reply indicating the failure in the attempt instructs the UE 1A and UE 1B to perform cellular communication (S17, S18). The UE 1A and UE 1B that have received the cellular communication instruction initialize the set spread code (S19, S20) and shift to the cellular communication.</p><p id="p0099" num="0099">As described above, in the third modification of first embodiment, continuity in communication can be guaranteed by switching to the cellular communication when the attempt of the assigned spread code fails. The UE 1A and UE 1B are not charged when the attempt of the assigned spread code by the UE 1A and UE 1B is not successful, and thus, it is possible to prevent being charged despite the D2D communication not being able to be performed.</p><heading id="h0015">[Fourth modification of first embodiment]</heading><p id="p0100" num="0100">In a fourth modification of the first embodiment, the multicarrier code division multiplexing scheme is applied to D2D communication. <figref idrefs="f0011">Fig. 14</figref> is a diagram illustrating a data transmission method according to the fourth modification of the first embodiment.</p><p id="p0101" num="0101">As illustrated in <figref idrefs="f0011">Fig. 14</figref>, the UE 1 performing the D2D communication performs transmission by applying the spread code to each of a plurality of subcarriers. Specifically,<!-- EPO <DP n="18"> --> the transmission data is S/P (Serial/Parallel) converted in accordance with a plurality of subcarriers included in a transmission and reception frequency band of the D2D communication, and the transmission data for each subcarrier is encoded (spread) by the spread code and transmitted. <figref idrefs="f0011">Fig. 14(A)</figref> illustrates a case where timing offset of data D between the subcarriers occurs, and <figref idrefs="f0011">Fig. 14(B)</figref> illustrates a case where no timing offset of data D between the subcarriers occurs.</p><p id="p0102" num="0102">As described above, in the fourth modification of the first embodiment, the communication speed of the D2D communication can be improved by transmitting data in parallel in the plurality of subcarriers.</p><heading id="h0016">[Fifth modification of first embodiment]</heading><p id="p0103" num="0103">In a fifth modification of the first embodiment, the eNB 2 designates transmission and reception start timing (encoding start point) of D2D communication.</p><p id="p0104" num="0104">The eNB 2 broadcasts information indicating the encoding start point by using, as a reference, timing of cellular communication. The encoding start point means timing at which encoding by applying one spread code starts. For example, each data Dx illustrated in <figref idrefs="f0011">Fig. 14</figref> corresponds to a period of several subframes, and thus, it is necessary to designate the encoding start point, that is a start point (start timing) of the period.</p><p id="p0105" num="0105">For example, the eNB 2 instructs the encoding start point by broadcast information such as a system information block (SIB) or a master information block (MIB). As the designation of the encoding start point, for example, the following T<sub>STEP</sub> and T<sub>OFFSET</sub> are designated in the broadcast information.<maths id="math0001" num=""><math display="block"><mrow><msub><mi>T</mi><mi mathvariant="italic">OFFSET</mi></msub><mo>=</mo><mfenced separators=""><mi>S</mi><mo>⁢</mo><mi>F</mi><mo>⁢</mo><mi>N</mi><mo>×</mo><mn>10</mn><mo>+</mo><mi mathvariant="italic">subframe</mi></mfenced><mspace width="1em"/><mi>mod</mi><mspace width="1em"/><mrow><msub><mi>T</mi><mi mathvariant="italic">STEP</mi></msub></mrow></mrow></math><img id="ib0001" file="imgb0001.tif" wi="73" he="6" img-content="math" img-format="tif"/></maths></p><p id="p0106" num="0106">In this case, SFN represents a radio frame number and subframe represents a subframe number. On the basis of T<sub>STEP</sub> and T<sub>OFFSET</sub>, the UE 1 performing the D2D communication specifies the encoding start point by using the above-described calculation formula.</p><p id="p0107" num="0107">Further, transmission in the D2D communication is performed, in a cell, either at a timing synchronized with a reception timing of downlink of the cellular communication or at a timing synchronized with a timing corrected in Timing Advance (TA). The<!-- EPO <DP n="19"> --> synchronization in this case is synchronization in one subframe unit.</p><heading id="h0017">[Sixth modification of first embodiment]</heading><p id="p0108" num="0108">In a sixth modification of the first embodiment, when the UE 1 performing D2D communication transmits data, the UE 1 transmits information indicating an application corresponding to the data (application information) by adding the information to the data.</p><p id="p0109" num="0109"><figref idrefs="f0012">Fig. 15</figref> is a diagram illustrating a transmission data format according to the sixth modification of the first embodiment. As illustrated in <figref idrefs="f0012">Fig. 15</figref>, in addition to a field where data is stored, the format has fields for application information, a data start flag, a data termination flag, a sequence number, and a data length. The application information may be an identifier indicating an application, an application type, QoS that is requested for the application, bearer identification information or the like.</p><p id="p0110" num="0110">As described above, in the sixth modification of the first embodiment, by adding the application information to the transmission data in the D2D communication, it is possible for the reception side to determine which application the reception data is for. Therefore, when the data is received, it is possible to decrypt the data. As a result, it is possible to start communication without a connection procedure between the UEs that perform the D2D communication.</p><heading id="h0018">[Seventh modification of first embodiment]</heading><p id="p0111" num="0111">In a seventh modification of the first embodiment, the UE 1 (UE 1C and UE 1D in <figref idrefs="f0005">Fig. 8</figref>) performing the D2D communication by using the initial spread code performs transmission in the D2D communication, on the basis of the result of monitoring an interference wave signal (that is, carrier sense).</p><p id="p0112" num="0112"><figref idrefs="f0013">Fig. 16</figref> is a flow diagram according to the seventh modification of the first embodiment. As illustrated in <figref idrefs="f0013">Fig. 16</figref>, the UE 1 sets the initial spread code (S1001), and upon performing the D2D communication, performs carrier sense (S1002). In this case, it is confirmed whether or not the interference wave signal is received in the transmission and reception frequency band of the D2D communication (S1003). The UE 1 performs transmission, after the UE 1 confirms that no interference wave signal is received (S1004).</p><p id="p0113" num="0113">As described above, in the seventh modification of the first embodiment, the interference occurring in the non-guaranteed D2D communication can be reduced by<!-- EPO <DP n="20"> --> performing carrier sense.</p><heading id="h0019">[Eighth modification of first embodiment]</heading><p id="p0114" num="0114">In an eighth modification of the first embodiment, the UE 1 (UE 1C and UE 1D in <figref idrefs="f0005">Fig. 8</figref>) performing the D2D communication by using the initial spread code requests the eNB 2 to assign a spread code in response to detection of deterioration in communication quality of the D2D communication.</p><p id="p0115" num="0115"><figref idrefs="f0014">Fig. 17</figref> is a sequence diagram according to the eighth modification of the first embodiment. As illustrated in <figref idrefs="f0014">Fig. 17</figref>, during the D2D communication by using the initial spread code (S0), when the UE 1D detects deterioration in communication quality of the D2D communication, the UE 1D requests the eNB 2 to assign the spread code (S1). As a result, the non-guaranteed D2D communication is switched to the guaranteed D2D communication.</p><p id="p0116" num="0116">For example, the UE 1D detects the deterioration in communication quality of the D2D communication on the basis of information (error level information) such as channel information, interference power, a path loss, or the (mean) number of times of retransmissions. The error level information can be calculated on the basis of a reference signal having known transmission power and timing, which is transmitted and received in the D2D communication.</p><p id="p0117" num="0117">As described above, in the eighth modification of the first embodiment, even when the communication quality of the non-guaranteed D2D communication deteriorates, it is possible to continue the D2D communication by the guaranteed D2D communication.</p><p id="p0118" num="0118"><figref idrefs="f0015">Fig. 18</figref> is a sequence diagram obtained by changing a part of the sequence of <figref idrefs="f0014">Fig. 17</figref>. As illustrated in <figref idrefs="f0015">Fig. 18</figref>, when detecting deterioration in communication quality of the D2D communication and when determining that the communication quality will improve by assigning the spread code, the UE 1D requests the eNB 2 to assign the spread code (S1). For example, when the received power of a reference signal from the UE 1C is sufficient (that is, the path loss is small), while the interference power is high (or retransmission occurs frequently), the UE 1D determines that the communication quality will improve by assigning the spread code.</p><p id="p0119" num="0119">On the other hand, for example, when the received power of a reference signal from<!-- EPO <DP n="21"> --> the UE 1C is low (that is, the path loss is large), the UE 1D determines that improvement in the communication quality by assigning the spread code is not expected. In this case, the UE 1D requests the cellular communication to the eNB 2 (S81), and the eNB 2 causes the UE 1C and UE 1D to start the cellular communication (S82, S83).</p><heading id="h0020">[Second embodiment]</heading><p id="p0120" num="0120">Next, a second embodiment will be described regarding a difference from the first embodiment. The second embodiment is different from the first embodiment in that a valid time is set for the spread code assigned by the eNB 2. The UE 1 to which the spread code is assigned by the eNB 2 requests the eNB 2 to reassign the spread code in order to continue the D2D communication.</p><p id="p0121" num="0121"><figref idrefs="f0016">Fig. 19</figref> is a sequence diagram according to the second embodiment. As illustrated in <figref idrefs="f0016">Fig. 19</figref>, the eNB 2 further includes valid time information indicating the valid time of the assigned spread code in the D2D permission, and then transmits the D2D permission (S3, S4). The UE 1A and UE 1B, which have received the D2D permission, set the spread code indicated by the code information included in the D2D permission (S5, S6).</p><p id="p0122" num="0122">Further, the UE 1A and UE 1B set two types of timers (a timer 1 and a timer 2) on the basis of the valid time information included in the D2D permission (S21, S22). For the timer 1, a time obtained by subtracting a predetermined time (At) from the valid time indicated by the valid time information is set. That is, the timer 1 is set so as to expire before the original valid time expires. Preferably, the predetermined time (At) is a time equal to or longer than a time required for the procedure of reassigning a spread code. For the timer 2, the valid time indicated by the valid time information is set.</p><p id="p0123" num="0123">The UE 1A and UE 1B perform the D2D communication by using the set spread code (S7).</p><p id="p0124" num="0124">When the UE 1A and UE 1B continue the D2D communication at a point of time when the timer 1 expires, the UE 1A and UE 1B start the procedure of reassigning a spread code. The UE 1B transmits, to the eNB 2, a D2D request indicating a request for the reassignment of a spread code (S1').</p><p id="p0125" num="0125">The eNB 2 that has received the D2D request calculates a new spread code having orthogonality in response to the D2D request (S2'). The eNB 2 assigns the new spread<!-- EPO <DP n="22"> --> code to the UE 1A and UE 1B (S3', S4'). A valid time is also set for the new spread code.</p><p id="p0126" num="0126">The UE 1A and UE 1B set the new spread code (S5', S6'), and set two types of timers (timer 1, timer 2) (S21', S22'). The UE 1A and UE 1B continue the D2D communication by using the set spread code (S7').</p><p id="p0127" num="0127">The eNB 2 that has assigned the new spread code to the UE 1A and UE 1B transmits, to the charging server 4, the charging information (S8'). The charging server 4 additionally charges the UE 1A and UE 1B (S9').</p><p id="p0128" num="0128">On the other hand, when the UE 1A and UE 1B end the D2D communication at a point of time when the timer 2 expires, the UE 1A and UE 1B initialize the set spread code (S23, S24).</p><p id="p0129" num="0129">As described above, in the second embodiment, the valid time is set for the spread code for the D2D communication and charging is performed each time the spread code is reassigned, and thus, it is possible to charge in accordance with the D2D communication time. Therefore, it is possible to set higher charge as the D2D communication time becomes longer.</p><heading id="h0021">[First modification of second embodiment]</heading><p id="p0130" num="0130">In a first modification of the second embodiment, when reassigning the spread code, the eNB 2 assigns a spread code different from the spread code before the reassignment (the previous code).</p><p id="p0131" num="0131"><figref idrefs="f0017">Fig. 20</figref> is a sequence diagram according to the first modification of the second embodiment. As illustrated in <figref idrefs="f0017">Fig. 20</figref>, in the procedure of reassigning a spread code, operations when the new spread code (selected code) calculated by the eNB 2 (S2') is different from the previous code are similar to those in the above-mentioned second embodiment.</p><p id="p0132" num="0132">On the other hand, for example, when all spread codes having the same code length as that of the previous code have been assigned, the selected code becomes the same code as the previous code, and thus, it is not possible to assign a spread code different from the previous spread code. In this case, the eNB 2 changes the code length of the spread code (S71).<!-- EPO <DP n="23"> --></p><p id="p0133" num="0133">Operations when the spread code (selected code) is different from the previous code after the code length is changed are similar to those in the above-mentioned second embodiment (S72). In contrast, when the spread code (selected code) is the same as the previous code after the code length is changed, the code length is changed again (S73).</p><p id="p0134" num="0134">However, in a case where the code length of the spread code cannot be changed, the eNB 2 instructs the UE 1A and UE 1B to perform switching to cellular communication (S74, S75). In this case, the case where the code length of the spread code cannot be changed is a case where all spread codes have been assigned or a case where a requested band (requested data rate) cannot be satisfied due to the elongation of the code length. It is noted that the latter case will be described in a third modification of the fifth embodiment.</p><p id="p0135" num="0135">As described above, in the first modification of the second embodiment, by assigning a spread code different from the spread code before the reassignment (the previous code), it is possible to ensure confidentiality in the D2D communication.</p><heading id="h0022">[Second modification of second embodiment]</heading><p id="p0136" num="0136">In a second modification of the second embodiment, only a single type of timers is used. <figref idrefs="f0018">Fig. 21</figref> is a sequence diagram according to the second modification of the second embodiment.</p><p id="p0137" num="0137">As illustrated in <figref idrefs="f0018">Fig. 21</figref>, the UE 1A and UE 1B set only a single type of timers corresponding to the valid time of the spread code (S21, S22). When the UE 1A and UE 1B continue the D2D communication at a point of time when the timer expires, the UE 1A and UE 1B initialize the spread code (S23, S24) and start the procedure of reassigning a spread code. The UE 1A and UE 1B perform non-guaranteed D2D communication by using the initial spread code or stop the data communication from the expiry of timer until reassignment of a spread code.</p><p id="p0138" num="0138">On the other hand, when the UE 1A and UE 1B end the D2D communication at a point of time when the timer expires, the UE 1A and UE 1B initialize the spread code without starting the procedure of reassigning a spread code (S23', S24').</p><p id="p0139" num="0139">As described above, in the second modification of the second embodiment, when the timer expires, the non-guaranteed D2D communication is temporarily performed or the<!-- EPO <DP n="24"> --> communication is stopped. However, simple management of the timer in the UE 1A and UE 1B can be achieved.</p><heading id="h0023">[Third modification of second embodiment]</heading><p id="p0140" num="0140">In a third modification of the second embodiment, when the UE 1A and UE 1B end the D2D communication before the valid time of a spread code expires, the UE 1A and UE 1B notify the eNB 2 of the end of the D2D communication. <figref idrefs="f0019">Fig. 22</figref> is a sequence diagram according to the third modification of the second embodiment.</p><p id="p0141" num="0141">As illustrated in <figref idrefs="f0019">Fig. 22</figref>, when the UE 1A and UE 1B end the D2D communication and when the valid time of a spread code does not expire at the point of time (at the end of the D2D communication), the UE 1A and UE 1B notify the eNB 2 of the end of the D2D communication (S61, S62). Further, the eNB 2 notifies the charging server 4 of the end of the D2D communication by the UE 1A and UE 1B (S63). At this time, the eNB 2 measures the usage time of the assigned spread code and notifies the charging server 4 of the measured actual usage time (specifically, usage time from the assignment of the spread code until receiving a notification of the end of the D2D communication (S61, S62)). The charging server 4 decreases charging in accordance with the unused time (valid time of a spread code - actual usage time).</p><p id="p0142" num="0142">Alternatively, when the usage time of the spread code is measured in the UE 1A and UE 1B, upon notifying the eNB 2 of the end of the D2D communication (S61, S62), each of the UE 1A and UE 1B also notifies the eNB 2 of the measured usage time. The eNB 2 notifies the charging server 4 of the actual usage time measured in each of the UE 1A and UE1B. The charging server 4 selects the longer usage time from the usage times measured in each of the UE 1A and UE 1B as the actual usage time, and decreases the charging in accordance with the unused time (valid time of a spread code - actual usage time).</p><p id="p0143" num="0143">As described above, in the third modification of the second embodiment, it is possible to charge more strictly in accordance with the D2D communication time.</p><heading id="h0024">[Third embodiment]</heading><p id="p0144" num="0144">Next, a third embodiment will be described regarding a difference from the above-described first embodiment and second embodiment. In the above-described first embodiment and second embodiment, the eNB 2 assigns a single type of the spread codes for the UE 1A and UE 1B. In this case, in order for the UE 1A and UE 1B to perform<!-- EPO <DP n="25"> --> bidirectional D2D communication, it is necessary to perform half-duplex communication in which transmission and reception are switched in a time-division manner. In the third embodiment, two types of the spread codes are assigned, thereby realizing full-duplex D2D communication.</p><p id="p0145" num="0145"><figref idrefs="f0020">Fig. 23</figref> is a diagram illustrating an operation overview according to the third embodiment. As illustrated in <figref idrefs="f0020">Fig. 23</figref>, when the UE 1A and UE 1B request full-duplex communication (full type), the eNB 2 assigns the two types of the spread codes (for transmission and for reception) to the UE 1A and UE 1B. On the other hand, when the UE 1A and UE 1B request half-duplex communication (half type), the eNB 2 assigns a single type of the spread codes to the UE 1A and UE 1B.</p><p id="p0146" num="0146"><figref idrefs="f0021">Fig. 24</figref> is a sequence diagram according to the third embodiment. Hereinafter, similar to the above-described modification of the second embodiment, an example in which only a single type of the timers is used will be described.</p><p id="p0147" num="0147">As illustrated in <figref idrefs="f0021">Fig. 24</figref>, the UE 1B transmits, to the eNB 2, a D2D request including information indicating which of the full-duplex communication or the half-duplex communication is requested (S1).</p><p id="p0148" num="0148">When the full-duplex communication is requested, the eNB 2 calculates two types of the spread codes (S2), and assigns the calculated spread codes to the UE 1A and UE 1B (S3, S4). The UE 1A and UE 1B set the two types of the spread codes (S5, S6). Then, the UE 1A and UE 1B set the timer (S21, S22) and perform the full-duplex D2D communication by using the set spread code (S7A, S7B).</p><p id="p0149" num="0149">On the other hand, when the half-duplex communication is requested, the eNB 2 calculates the single type of the spread codes (S2'), and assigns the calculated spread code to the UE 1A and UE 1B (S3', S4'). The UE 1A and UE 1B set the single type of the spread codes (S5', S6'). Then, the UE 1A and UE 1B set the timer (S21', S22') and perform the half-duplex D2D communication by using the set spread code (S7A', S7B').</p><p id="p0150" num="0150">The eNB 2 notifies the charging server 4 of the number of the assigned spread codes (S8, S8') and the charging server 4 performs charging in accordance with the number of the assigned spread codes (S9, S9'). The charging for the full-duplex communication (cost A) is set to be more expensive than the charging for the half-duplex communication<!-- EPO <DP n="26"> --> (cost B).</p><p id="p0151" num="0151">As described above, in the third embodiment, the full-duplex D2D communication can be achieved. Further, it is possible that the charging is made different between the full-duplex D2D communication and the half-duplex D2D communication.</p><heading id="h0025">[Fourth embodiment]</heading><p id="p0152" num="0152">Next, a fourth embodiment will be described regarding a difference from the above-described first embodiment to third embodiment. In the above-described embodiments, it is assumed that the valid time of the spread code assigned by the eNB 2 is constant. In the fourth embodiment, the eNB 2 controls the valid time of the spread code on the basis of an elapsed time from when the UE 1A and UE 1B start the D2D communication.</p><p id="p0153" num="0153"><figref idrefs="f0022">Fig. 25</figref> is a diagram illustrating an operation overview according to the fourth embodiment. As illustrated in <figref idrefs="f0022">Fig. 25</figref>, the eNB 2 elongates the valid time of the spread code each time the spread code is reassigned (updated). Thus, an update interval of the spread code is short at first, and then gradually becomes longer.</p><p id="p0154" num="0154"><figref idrefs="f0023">Fig. 26</figref> is a sequence diagram according to the fourth embodiment. As illustrated in <figref idrefs="f0023">Fig. 26</figref>, the procedures (S1 to S7) of assigning the spread code and the D2D communication using the spread code are similar to those in the above-described modifications of the embodiments. However, when assigning the spread code to the UE 1A and UE 1B, the eNB 2 sets, for the spread code, a valid time corresponding to the elapsed time from when the UE 1A and UE 1B start the D2D communication.</p><p id="p0155" num="0155">The eNB 2 notifies the charging server 4 of the valid time of the spread code in response to the assignment of the spread code to the UE 1A and UE 1B (S8). The charging server 4 performs charging in accordance with the notified valid time.</p><p id="p0156" num="0156">Alternatively, the eNB 2 may notify the charging server 4 of the elapsed time of the D2D communication, instead of notifying the charging server 4 of the valid time of the spread code. In this case, the charging server 4 performs charging in accordance with the notified elapsed time.</p><p id="p0157" num="0157">As described above, in the fourth embodiment, the time interval of reassignment of<!-- EPO <DP n="27"> --> the spread code (that is, update interval) is elongated in accordance with the elapse of time of the D2D communication, and thus, it is possible to reduce a process load and signaling.</p><heading id="h0026">[First modification of fourth embodiment]</heading><p id="p0158" num="0158">In a first modification of the fourth embodiment, the eNB 2 controls the valid time of the spread code on the basis of an application (hereinafter, an application used) which the UE 1A and UE 1B use for the D2D communication. <figref idrefs="f0024">Fig. 27</figref> is a diagram illustrating an operation overview according to the first modification of the fourth embodiment.</p><p id="p0159" num="0159">As illustrated in <figref idrefs="f0024">Fig. 27</figref>, the eNB 2 makes the valid time of the spread code different in accordance with the application used, and thus the update interval of the spread code is optimized for the application used. For example, the update interval is elongated for an application 1 (such as a real time competition game and telephone call) in which communication is continuously performed, while the update interval is shortened for an application 2 (such as a competition game (hereinafter, shogi or a Japanese chess) and chat) in which communication is discontinuously performed.</p><p id="p0160" num="0160"><figref idrefs="f0025">Fig. 28</figref> is a sequence diagram according to the first modification of the fourth embodiment. As illustrated in <figref idrefs="f0025">Fig. 28</figref>, the UE 1B transmits, to the eNB 2, a D2D request including the application information on the application used (S1). In this case, the application information is an identifier indicating an application, an application type, QoS that is requested for the application, bearer identification information or the like.</p><p id="p0161" num="0161">The eNB 2 calculates the spread code and the valid time in accordance with the application used (S2). Further, when assigning the calculated spread code to the UE 1A and UE 1B (S3, S4), the eNB 2 notifies the UE 1A and UE 1B of the valid time in accordance with the application used. Further, the eNB 2 notifies the charging server 4 of the application used (S8). The charging server 4 performs charging in accordance with the notified application used (S9).</p><p id="p0162" num="0162">As described above, in the first modification of the fourth embodiment, the update interval of the spread code is optimized for the application used.</p><p id="p0163" num="0163">It is noted that the application information in the modification may be applied to the above-described third embodiment. <figref idrefs="f0026">Fig. 29</figref> is a sequence diagram obtained by changing a part of the sequence of <figref idrefs="f0025">Fig. 28</figref>.<!-- EPO <DP n="28"> --></p><p id="p0164" num="0164">As illustrated in <figref idrefs="f0026">Fig. 29</figref>, the UE 1B transmits, to the eNB 2, the D2D request including the application information on the application used (S1). The eNB 2 inquires, of an application management server 5, which of the full-duplex communication and half-duplex communication is suitable for the application used (S31, S32). The application management server 5 is provided in the EPC 20, for example.</p><p id="p0165" num="0165">When it is determined that the application used is suitable for the full-duplex communication, the eNB 2 calculates two types of the spread codes (S2), and assigns the calculated spread codes to the UE 1A and UE 1B (S3, S4). The UE 1A and UE 1B set the two types of the spread codes (S5, S6). Then, the UE 1A and UE 1B set the timer (S21, S22) and perform the full-duplex D2D communication by using the set spread code (S7A, S7B).</p><p id="p0166" num="0166">On the other hand, when it is determined that the application used is suitable for the half-duplex communication, the eNB 2 calculates a single type of the spread codes (S2'), and assigns the calculated spread code to the UE 1A and UE 1B (S3', S4'). The UE 1A and UE 1B set the single type of the spread codes (S5', S6'). Then, the UE 1A and UE 1B set the timer (S21', S22') and perform the half-duplex D2D communication by using the set spread code (S7A', S7B').</p><heading id="h0027">[Second modification of fourth embodiment]</heading><p id="p0167" num="0167">In a second modification of the fourth embodiment, the eNB 2 controls the valid time of the spread code on the basis of a billing contract of the UE 1A and UE 1B. The billing contract may be a billing contract for both of cellular communication and D2D communication or a billing contract only for D2D communication. <figref idrefs="f0027">Fig. 30</figref> is a diagram illustrating an operation overview according to the second modification of the fourth embodiment.</p><p id="p0168" num="0168">As illustrated in <figref idrefs="f0027">Fig. 30</figref>, the eNB 2 makes the valid time of the spread code different in accordance with the billing contract of the UE 1A and UE 1B, and thus, the update interval of the spread code is optimized for the billing contract. For example, the update interval is elongated for flat rate charge, while the update interval is shortened for measured rate charge.</p><p id="p0169" num="0169"><figref idrefs="f0028">Fig. 31</figref> is a sequence diagram according to the second modification of the fourth<!-- EPO <DP n="29"> --> embodiment. As illustrated in <figref idrefs="f0028">Fig. 31</figref>, the eNB 2 that has received the D2D request inquires of the charging server 4 about the condition of the billing contract of the UE 1A and UE 1B (S41, S42). Further, the eNB 2 calculates the spread code and the valid time in accordance with the billing contract (S2). When assigning the calculated spread code to the UE 1A and UE 1B (S3, S4), the eNB 2 notifies the UE 1A and UE 1B of the valid time in accordance with the billing contract. The charging server 4 performs charging in accordance with the billing contract of the UE 1A and UE 1B (S9).</p><p id="p0170" num="0170">As described above, in the second modification of the fourth embodiment, the update interval of the spread code is optimized for the billing contract.</p><heading id="h0028">[Third modification of fourth embodiment]</heading><p id="p0171" num="0171">In a third modification of the fourth embodiment, the eNB 2 controls the valid time of the spread code on the basis of movement speed of the UE 1A and UE 1B. It is noted that a technique for obtaining the movement speed is well-known, and thus a description thereof will be omitted.</p><p id="p0172" num="0172"><figref idrefs="f0029">Fig. 32</figref> is a diagram illustrating an operation overview according to the third modification of the fourth embodiment. As illustrated in <figref idrefs="f0029">Fig. 32</figref>, the eNB 2 makes the valid time of the spread code different in accordance with the movement speed of the UE 1A and UE 1B, and thus, the update interval of the spread code is optimized for the movement speed. For example, the update interval becomes shorter as the movement speed increases. Further, when at least one of the UE 1A and UE 1B moves at no less than certain speed (that is, moves at high speed), the eNB 2 causes the UE 1A and UE 1B to perform the cellular communication rather than the D2D communication.</p><p id="p0173" num="0173">Preferably, the eNB 2 sets the valid time of the spread code to a time equal to or shorter than a time during which the UE 1A and UE 1B camp in the coverage of the cell of the eNB 2 on the basis of the movement speed. Thus, the valid time also depends on the cell size, and therefore, the eNB 2 may regulate the valid time in accordance with the size of the cell of the eNB 2. For example, in a case of a pico cell or a femto cell, the valid time is shortened.</p><p id="p0174" num="0174">As described above, in the third modification of the fourth embodiment, the update interval of the spread code is optimized for the movement speed.<!-- EPO <DP n="30"> --></p><heading id="h0029">[Fifth embodiment]</heading><p id="p0175" num="0175">Next, a fifth embodiment will be described regarding a difference from the above-described first embodiment to fourth embodiment. In the fifth embodiment, the eNB 2 controls the code length of the spread code to be assigned to the UE 1A and UE 1B on the basis of the communication quality of the D2D communication.</p><p id="p0176" num="0176"><figref idrefs="f0030">Fig. 33</figref> is a sequence diagram according to the fifth embodiment. As illustrated in <figref idrefs="f0030">Fig. 33</figref>, the UE 1B transmits, to the eNB 2, a D2D request including the error level information indicating the communication quality in the D2D communication (S1).</p><p id="p0177" num="0177">The eNB 2 calculates the spread code having an appropriate code length on the basis of the error level information included in the D2D request (S2). As described above, the error level information is information such as channel information, interference power, a path loss, or the (mean) number of times of retransmissions. For example, when the path loss is small while the interference power is high (or retransmission occurs frequently), the eNB 2 elongates the code length of the spread code in order to provide higher orthogonality. Further, the eNB 2 assigns the calculated spread code to the UE 1A and UE 1B (S3, S4).</p><p id="p0178" num="0178">It is noted that there is a case where a change in the code length of the spread code to be assigned to another UE 1 (UE 1E, UE 1F) is needed due to the change in the code length of the spread code to be assigned to the UE 1A and UE 1B. In this case, the eNB 2 assigns a new spread code to the other UE 1 (UE 1E, UE 1F) (S3', S4').</p><p id="p0179" num="0179">As described above, in the fifth embodiment, it is possible to improve the communication quality of the D2D communication by changing the code length of the spread code.</p><heading id="h0030">[First modification of fifth embodiment]</heading><p id="p0180" num="0180">In a first modification of the fifth embodiment, the code length of the spread code is controlled on the basis of the number of the UEs 1 (specifically, the number of the UEs 1 performing the D2D communication) which camp on the cell of the eNB 2.</p><p id="p0181" num="0181"><figref idrefs="f0031">Fig. 34</figref> is a diagram illustrating an operation according to the first modification of the fifth embodiment. As illustrated in <figref idrefs="f0031">Fig. 34</figref>, the eNB 2 elongates the code length of the spread code in order to provide higher orthogonality as the number of the UEs 1 performing the D2D communication increases in the cell of the eNB 2.<!-- EPO <DP n="31"> --></p><p id="p0182" num="0182">As described above, in the first modification of the fifth embodiment, it is possible to improve the communication quality of the D2D communication under a situation where the deterioration in communication quality of the D2D communication easily occurs.</p><heading id="h0031">[Second modification of fifth embodiment]</heading><p id="p0183" num="0183">In a second modification of the fifth embodiment, the UE 1A and UE 1B request the eNB 2 to reassign the spread code in response to detection of deterioration in communication quality of the D2D communication, even before the valid time of the spread code expires. The eNB 2 assigns a spread code having a code length longer than that of the spread code to the UE 1A and UE 1B on the basis of the request.</p><p id="p0184" num="0184"><figref idrefs="f0032">Fig. 35</figref> is a sequence diagram according to the second modification of the fifth embodiment. As illustrated in <figref idrefs="f0032">Fig. 35</figref>, the UE 1B detects the deterioration in communication quality of the D2D communication before the valid time of the spread code expires (that is, before the timer expires). For example, the UE 1B detects the deterioration in communication quality of the D2D communication on the basis of information (error level information) such as channel information, interference power, a path loss, or the (mean) number of times of retransmissions. The error level information can be calculated on the basis of a reference signal having known transmission power and timing, which is transmitted and received in the D2D communication.</p><p id="p0185" num="0185">When detecting the deterioration in communication quality of the D2D communication and when determining that the communication quality will improve by assigning the spread code, the UE 1B requests the eNB 2 to reassign the spread code (S1"). For example, when the received power of a reference signal from the UE 1A is sufficient (that is, the path loss is small), while the interference power is high (or retransmission occurs frequently), the UE 1B determines that the communication quality will improve by reassigning the spread code. In this case, the UE 1B transmits, to the eNB 2, a D2D request including the error level information indicating the communication quality in the D2D communication. The eNB 2 calculates the spread code having an appropriate code length on the basis of the error level information included in the D2D request (S2"). In this case, the eNB 2 calculates the spread code having the code length longer than that of the spread code previously assigned. Further, the eNB 2 assigns the calculated spread code to the UE 1A and UE 1B (S3", S4").</p><p id="p0186" num="0186"><!-- EPO <DP n="32"> --> On the other hand, when detecting deterioration in communication quality of the D2D communication and when determining that the communication quality will not improve by assigning the spread code, the UE 1B requests the eNB 2 to switch to cellular communication (S51). For example, when the received power of a reference signal from the UE 1A is low (that is, the path loss is large), the UE 1B determines that improvement in the communication quality by reassigning the spread code is not expected. In this case, the eNB 2 instructs the UE 1A and UE 1B to switch to the cellular communication in response to the request to switch to the cellular communication (S52, S53).</p><p id="p0187" num="0187">As described above, in the second modification of the fifth embodiment, it is possible to improve the communication quality of the D2D communication by changing the code length of the spread code.</p><heading id="h0032">[Third modification of fifth embodiment]</heading><p id="p0188" num="0188">In the above-described fifth embodiment and the modifications thereof, the communication speed (data rate) becomes lower as the code length of the spread code is elongated. Therefore, in a case where the communication speed becomes lower than a certain speed by elongating the code length of the spread code, the eNB 2 or UE 1 may control to perform switching from the D2D communication to the cellular communication. In this case, the certain speed may be a communication speed requested by the application in use.</p><heading id="h0033">[Sixth embodiment]</heading><p id="p0189" num="0189">Next, a sixth embodiment will be described regarding a difference from the above-described first embodiment to fifth embodiment. In the sixth embodiment, the UE 1 performing the D2D communication transmits, to the eNB 2, a request for the assignment of the spread code on the basis of an increase and decrease in the number of UEs included in a D2D UE group to which the UE 1 belongs.</p><p id="p0190" num="0190"><figref idrefs="f0033">Fig. 36</figref> is a sequence diagram when the number of UEs included in the D2D UE group increases. Hereinafter, a case where the UE 1C is added to the D2D UE group after starting the D2D communication in a D2D UE group including the UE 1A and UE 1B (S7) will be described. As illustrated in <figref idrefs="f0033">Fig. 36</figref>, the UE 1C transmits the Discovery signal (S91, S92). The Discovery signal is a signal that is used in the discovery process of discovering a neighboring UE that should be a communication partner in the D2D communication. The UE 1A and the UE 1B receive the Discovery signal from the UE 1C, and transmits, to the<!-- EPO <DP n="33"> --> UE 1C, a response to the Discovery signal (S93, S94).</p><p id="p0191" num="0191">The UE 1B transmits, to the eNB 2, a D2D request to add the UE 1C to the D2D UE group (S1'). The eNB 2 calculates a spread code (S2') and assigns the spread code to the UE 1A to the UE 1C (S3', S4', S95). As a result, the D2D communication by the UE 1A to the UE 1C starts. Further, the eNB 2 notifies the charging server 4 of the addition of the UE 1C (S8'), and the charging server 4 charges the UE 1C.</p><p id="p0192" num="0192"><figref idrefs="f0034">Fig. 37</figref> is a sequence diagram when the number of UEs included in the D2D UE group decreases. Hereinafter, a case where the UE 1A separates from the D2D UE group after starting the D2D communication by the UE 1A to the UE 1C will be described. As illustrated in <figref idrefs="f0034">Fig. 37</figref>, the UE 1A that ends the D2D communication notifies the UE 1B, the UE 1C, and the eNB 2 of that effect (S100, S101, S103). At this time, the UE 1A may notify the eNB 2 of the spread code that the UE 1A has used. The eNB 2 notifies the charging server 4 of the end of the D2D communication in the UE 1A (and the usage time of the spread code) (S104). The charging server 4 ends the charging for the UE 1A (and decreases the charging in accordance with the unused time) (S105). Then, the D2D communication by the UE 1B and the UE 1C is performed.</p><p id="p0193" num="0193">As described above, in the sixth embodiment, it is possible to appropriately assign the spread code in accordance with an increase and decrease in the number of UEs included in the D2D UE group.</p><heading id="h0034">[First modification of sixth embodiment]</heading><p id="p0194" num="0194">In a first modification of the sixth embodiment, the assignment of the spread code is controlled at the initiative of the eNB 2 in accordance with an increase and decrease in the number of UEs included in the D2D UE group. For example, when the number of the UEs included in the D2D UE group increases, it is necessary to increase assignment of the spread code in order to perform the full-duplex communication between the UEs. In such a case, the eNB 2 increases the assignment of the spread code for the D2D UE group according to the determination of the eNB 2 itself. When increasing assignment of the spread code, the charging server 4 may divide the charging for use of the spread code among all the UEs included in the D2D UE group or among respective UEs using the spread code for transmission.</p><heading id="h0035">[Second modification of sixth embodiment]</heading><!-- EPO <DP n="34"> --><p id="p0195" num="0195">In a second modification of the sixth embodiment, the eNB 2 denies the assignment of the spread code on the basis of a billing contract of each UE included in the D2D UE group to which the UE 1 requesting the assignment of the spread code belongs. Specifically, the eNB 2 denies the assignment of the spread code to the D2D UE group when UE under a billing contract (for example, the measured rate charge) in which the D2D communication is not permitted is included in the D2D UE group. The billing contract can be comprehended by inquiring of the charging server 4. Further, when the eNB 2 denies the assignment of the spread code, the eNB 2 may notify the UE to be denied, of the reason for the denial (for example, the fact of the measured rate charge).</p><heading id="h0036">[Seventh embodiment]</heading><p id="p0196" num="0196">Next, a seventh embodiment will be described regarding a difference from the above-described first embodiment to sixth embodiment. In the seventh embodiment, an assignment situation of the spread code is shared among neighboring cells.</p><p id="p0197" num="0197"><figref idrefs="f0035 f0036 f0037">Fig. 38 to Fig. 40</figref> are diagrams illustrating an operation according to the seventh embodiment. As illustrated in <figref idrefs="f0035">Fig. 38</figref>, the eNB 2A stores the spread code (code1) assigned to the UE 1A and UE 1B as a spread code assigned by the eNB 2A (hereinafter, distribution code). The eNB 2A notifies the eNB 2B and eNB 2C, which are adjacent to the eNB 2A, of the distribution code (code1) of the eNB 2A, respectively. The eNB 2B and eNB 2C store the distribution code (code1) of the eNB 2A, respectively.</p><p id="p0198" num="0198">The eNB 2D stores the spread code (code1) assigned to the UE 1C and UE 1D as a distribution code of the eNB 2D. The eNB 2D notifies the eNB 2B and eNB 2C, which are adjacent to the eNB 2D, of the distribution code (code1) of the eNB 2D, respectively. The eNB 2B and eNB 2C store the distribution code (code1) of the eNB 2D, respectively.</p><p id="p0199" num="0199">As illustrated in <figref idrefs="f0036">Fig. 39</figref>, the eNB 2C assigns a spread code (code3) to the UE 1E and UE 1F. The eNB 2C stores the spread code (code3) assigned to the UE 1E and UE 1F as a distribution code of the eNB 2C. The eNB 2C notifies the eNB 2A, eNB 2B, and eNB 2D, which are adjacent to the eNB 2C, of the distribution code (code3) of the eNB 2C, respectively. The eNB 2A, eNB 2B, and eNB 2D store the distribution code (code3) of the eNB 2C, respectively.</p><p id="p0200" num="0200">As illustrated in <figref idrefs="f0037">Fig. 40</figref>, the eNB 2A reassigns a spread code (code2) to the UE 1A and UE 1B. The eNB 2A updates the distribution code of the eNB 2A to the spread code<!-- EPO <DP n="35"> --> (code2) assigned to the UE 1A and UE 1B. The eNB 2A notifies the eNB 2B and eNB 2C, which are adjacent to the eNB 2A, of the distribution code (code1) released from the assignment and the distribution code (code2) newly assigned. The eNB 2B and eNB 2C delete the distribution code (code1) released by the eNB 2A and store the distribution code (code2) newly assigned by the eNB 2A, as a distribution code of the eNB 2A, respectively.</p><p id="p0201" num="0201">As described above, in the seventh embodiment, each eNB 2 comprehends the distribution code of the neighboring eNB 2, and thus, each eNB 2 can assign a spread code without overlapping with that of the neighboring eNB 2, and thus, it is possible to suppress the interference between the D2D communications. For example, even when the UE 1A and UE 1B to which the spread code is assigned by the cell of the eNB 2A move into the cell of the eNB 2A adjacent to the eNB 2A, the D2D communication can be continued with no occurrence of interference in the cell of the eNB 2A.</p><heading id="h0037">[Eighth embodiment]</heading><p id="p0202" num="0202">Next, an eighth embodiment will be described regarding a difference from the above-described first embodiment to seventh embodiment. In the above-described embodiment, the assignment of the spread code is performed by the eNB 2. In the eighth embodiment, the assignment of the spread code is performed by the network node that is shared by a plurality of communication providers (carriers).</p><p id="p0203" num="0203"><figref idrefs="f0038">Fig. 41</figref> is a diagram illustrating an operation environment according to the eighth embodiment. As illustrated in <figref idrefs="f0038">Fig. 41</figref>, the UE 1A, the eNB 2A, and a charging server 4A belong to a communication provider A. The UE 1B, the eNB 2B, and a charging server 4B belong to a communication provider B. When the D2D communication is performed by the UE 1A and UE 1B in such an operation environment, it is difficult for the eNB 2A and eNB 2B to assign, in a coordinated manner, the spread code to the UE 1A and UE 1B.</p><p id="p0204" num="0204">Therefore, in the eighth embodiment, an assignment management server 6 shared by the communication providers A and B assigns the spread code to the UE 1A and UE 1B. The UE 1A and UE 1B notify the assignment management server 6 of the D2D request, and the assignment management server 6 notifies the UE 1A and UE 1B of an assigned spread code. Further, the assignment management server 6 notifies the charging servers 4A and 4B of the assignment situation of the spread code. Alternatively, the assignment management server 6 further manages charging, and provides the charging information to the communication providers A and B.<!-- EPO <DP n="36"> --></p><p id="p0205" num="0205">As described above, in the eighth embodiment, the D2D communication can be performed across communication providers (carriers).</p><heading id="h0038">[Other embodiments]</heading><p id="p0206" num="0206">For example, the eNB 2 may assign the spread code to the UE 1 on the basis of an identifier associated with the UE 1. The identifier associated with the UE 1 is an IP address of the UE 1, an ID assigned by an application, or the like. The eNB 2 or the assignment management server 6 may assign at least a part of such UE-specific values to the UE 1 as the spread code. Alternatively, another spread code in one-to-one correspondence with at least a part of such UE-specific values may be assigned to the UE 1.</p><p id="p0207" num="0207">The code division multiplexing scheme may be applied for the Discovery signal. In this case, the eNB 2 broadcasts information indicating a spread code that should be used for the discovery process. The UE 1 applies the spread code indicated by the broadcast information to the Discovery signal, and transmits the Discovery signal.</p><p id="p0208" num="0208">The above-described embodiment and modification thereof may be performed separately and independently and may also be performed through a combination of two or more thereof.</p><p id="p0209" num="0209">In the above-described embodiment, the frequency band of the LTE system is divided into a frequency band for the cellular communication and a frequency band for the D2D communication. However, the frequency band for the cellular communication and the frequency band for the D2D communication may be overlapped at least at a part thereof.</p><p id="p0210" num="0210">In the above-described embodiment, the direct communication mode in the D2D communication is mainly described. However, instead of the direct communication mode, the locally routed mode may also be applied.</p><p id="p0211" num="0211">In the above-described embodiment, an example in which the present invention is applied to the LTE system is described. However, the present invention may also be applied to systems other than the LTE system, as well as the LTE system.</p><p id="p0212" num="0212">Thus, the present invention includes a variety of embodiments not described herein. Further, it is possible to combine embodiments and modifications described above.<!-- EPO <DP n="37"> --> Therefore, the technical scope of the present invention is defined only by matters accoding to claims based on the above description.</p><p id="p0213" num="0213">The entire contents of <patcit id="pcit0001" dnum="US61766518A"><text>U.S. Provisional Application No. 61/766518 (filed on February 19, 2013</text></patcit>) are incorporated herein by reference.</p><heading id="h0039">INDUSTRIAL APPLICABILITY</heading><p id="p0214" num="0214">According to the present invention, it is possible to provide a mobile communication system, a user terminal and a base station capable of facilitating an operation for the D2D communication.</p></description><claims mxw-id="PCLM90459107" lang="EN" load-source="patent-office"><!-- EPO <DP n="38"> --><claim id="c-en-0001" num="0001"><claim-text>A mobile communication system that supports cellular communication in which a data path passes through a network and D2D communication that is direct device-to-device communication in which a data path does not pass through the network, wherein<br/>
a frequency division multiplexing scheme is applied to the cellular communication and a code division multiplexing scheme is applied to the D2D communication,<br/>
the network assigns a spread code having orthogonality to a user terminal in response to a request from the user terminal, and<br/>
the user terminal performs the D2D communication by using the spread code assigned by the network.</claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The mobile communication system according to claim 1, wherein<br/>
the network performs charging for the use of the spread code by the user terminal.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The mobile communication system according to claim 1, wherein<br/>
a valid time is set for the spread code, and<br/>
the user terminal to which the spread code is assigned requests the network to reassign the spread code in order to continue the D2D communication.</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>The mobile communication system according to claim 3, wherein<br/>
the network controls the valid time on the basis of at least one of an elapsed time of the D2D communication by the user terminal, an application that the user terminal uses for the D2D communication, a billing contract of the user terminal, and movement speed of the user terminal.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>The mobile communication system according to claim 3, wherein<br/>
the user terminal requests the network to reassign the spread code in response to detection of deterioration in communication quality of the D2D communication, even before the valid time expires.</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>The mobile communication system according to claim 3, wherein<br/>
when the user terminal ends the D2D communication before the valid time expires, the user terminal notifies the network of the end of the D2D communication.</claim-text></claim><claim id="c-en-0007" num="0007"><claim-text><!-- EPO <DP n="39"> --> The mobile communication system according to claim 3, wherein<br/>
when reassigning the spread code, the network assigns, to the user terminal, a spread code different from the spread code before the reassignment.</claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>The mobile communication system according to claim 1, wherein<br/>
the network assigns, to the user terminal, the spread code for transmission in the D2D communication and the spread code for reception in the D2D communication.</claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>The mobile communication system according to claim 1, wherein<br/>
the network controls a code length of the spread code to be assigned to the user terminal on the basis of at least one of communication quality of the D2D communication in the user terminal and the number of user terminals performing the D2D communication in a cell to which the user terminal belongs.</claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>The mobile communication system according to claim 9, wherein<br/>
when the network determines that the code length of the spread code to be assigned to the user terminal is longer than a predetermined length, the network instructs the user terminal to switch from the D2D communication to the cellular communication.</claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>The mobile communication system according to claim 1, wherein<br/>
the user terminal retains an initial spread code having no orthogonality, and<br/>
the user terminal performs the D2D communication by using the initial spread code even when the spread code is not assigned by the network.</claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>The mobile communication system according to claim 11, wherein<br/>
the user terminal performing the D2D communication by using the initial spread code requests the network to assign the spread code in response to detection of deterioration in communication quality of the D2D communication.</claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>The mobile communication system according to claim 12, wherein<br/>
when the network determines that the communication quality will improve by assigning the spread code, the network assigns the spread code to the user terminal.</claim-text></claim><claim id="c-en-0014" num="0014"><claim-text>The mobile communication system according to claim 11, wherein<br/>
the user terminal performing the D2D communication by using the initial spread code performs transmission in the D2D communication on the basis of a result of monitoring<!-- EPO <DP n="40"> --> an interference wave signal.</claim-text></claim><claim id="c-en-0015" num="0015"><claim-text>The mobile communication system according to claim 1, wherein<br/>
the network assigns the spread code to a user terminal group including the user terminal and another user terminal which is to perform the D2D communication with the user terminal.</claim-text></claim><claim id="c-en-0016" num="0016"><claim-text>The mobile communication system according to claim 15, wherein<br/>
the user terminal transmits the request to the network on the basis of an increase and decrease in the number of user terminals included in the user terminal group.</claim-text></claim><claim id="c-en-0017" num="0017"><claim-text>The mobile communication system according to claim 15, wherein<br/>
the network controls the number of spread codes to be assigned to the user terminal group on the basis of the number of user terminals included in the user terminal group.</claim-text></claim><claim id="c-en-0018" num="0018"><claim-text>The mobile communication system according to claim 15, wherein<br/>
the network denies the assignment of the spread code to the user terminal group when a user terminal under a billing contract for which the D2D communication is not permitted is included in the user terminal group.</claim-text></claim><claim id="c-en-0019" num="0019"><claim-text>The mobile communication system according to claim 1, wherein<br/>
the network notifies the user terminal of transmission and reception start timing of the D2D communication by using, as a reference, timing of the cellular communication.</claim-text></claim><claim id="c-en-0020" num="0020"><claim-text>The mobile communication system according to claim 1, wherein<br/>
the network comprises a plurality of cells, and<br/>
each of the plurality of cells notifies a neighboring cell of an assignment situation of the spread code in the self cell.</claim-text></claim><claim id="c-en-0021" num="0021"><claim-text>The mobile communication system according to claim 1, wherein<br/>
the network assigns the spread code to the user terminal on the basis of an identifier associated with the user terminal.</claim-text></claim><claim id="c-en-0022" num="0022"><claim-text>The mobile communication system according to claim 1, wherein<br/>
the user terminal performing the D2D communication by using the spread code performs transmission by applying the spread code to each of a plurality of subcarriers.<!-- EPO <DP n="41"> --></claim-text></claim><claim id="c-en-0023" num="0023"><claim-text>The mobile communication system according to claim 1, wherein<br/>
when the user terminal performing the D2D communication transmits data, the user terminal transmits information indicating an application corresponding to the data by adding the information to the data.</claim-text></claim><claim id="c-en-0024" num="0024"><claim-text>The mobile communication system according to claim 1, wherein<br/>
the network broadcasts information indicating a spread code that should be used for a discovery process of discovering a neighboring terminal that should be a communication partner in the D2D communication.</claim-text></claim><claim id="c-en-0025" num="0025"><claim-text>The mobile communication system according to claim 1, wherein<br/>
the network comprises a server device that is shared by a plurality of communication providers and that performs assignment of the spread code.</claim-text></claim><claim id="c-en-0026" num="0026"><claim-text>A user terminal that is used in a mobile communication system that supports cellular communication in which a data path passes through a network, and D2D communication that is direct device-to-device communication in which a data path does not pass through the network, comprising:
<claim-text>a controller that performs the D2D communication by using a spread code assigned by the network and having orthogonality, wherein</claim-text>
<claim-text>a frequency division multiplexing scheme is applied to the cellular communication and a code division multiplexing scheme is applied to the D2D communication.</claim-text></claim-text></claim><claim id="c-en-0027" num="0027"><claim-text>A base station that is used in a mobile communication system that supports cellular communication in which a data path passes through a network, and D2D communication that is direct device-to-device communication in which a data path does not pass through the network, comprising:
<claim-text>a controller that assigns, to a user terminal, a spread code having orthogonality, for the D2D communication, in response to a request from the user terminal, wherein</claim-text>
<claim-text>a frequency division multiplexing scheme is applied to the cellular communication and a code division multiplexing scheme is applied to the D2D communication.</claim-text></claim-text></claim></claims><drawings mxw-id="PDW20421845" load-source="patent-office"><!-- EPO <DP n="42"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="144" he="196" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="43"> --><figure id="f0002" num="2,3"><img id="if0002" file="imgf0002.tif" wi="140" he="221" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="44"> --><figure id="f0003" num="4,5"><img id="if0003" file="imgf0003.tif" wi="154" he="209" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="45"> --><figure id="f0004" num="6,7"><img id="if0004" file="imgf0004.tif" wi="130" he="228" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="46"> --><figure id="f0005" num="8"><img id="if0005" file="imgf0005.tif" wi="158" he="177" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="47"> --><figure id="f0006" num="9"><img id="if0006" file="imgf0006.tif" wi="114" he="208" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="48"> --><figure id="f0007" num="10"><img id="if0007" file="imgf0007.tif" wi="112" he="206" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="49"> --><figure id="f0008" num="11"><img id="if0008" file="imgf0008.tif" wi="96" he="219" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="50"> --><figure id="f0009" num="12"><img id="if0009" file="imgf0009.tif" wi="99" he="221" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="51"> --><figure id="f0010" num="13"><img id="if0010" file="imgf0010.tif" wi="158" he="221" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="52"> --><figure id="f0011" num="14(A),14(B)"><img id="if0011" file="imgf0011.tif" wi="165" he="167" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="53"> --><figure id="f0012" num="15"><img id="if0012" file="imgf0012.tif" wi="87" he="180" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="54"> --><figure id="f0013" num="16"><img id="if0013" file="imgf0013.tif" wi="114" he="137" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="55"> --><figure id="f0014" num="17"><img id="if0014" file="imgf0014.tif" wi="108" he="212" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="56"> --><figure id="f0015" num="18"><img id="if0015" file="imgf0015.tif" wi="157" he="223" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="57"> --><figure id="f0016" num="19"><img id="if0016" file="imgf0016.tif" wi="164" he="200" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="58"> --><figure id="f0017" num="20"><img id="if0017" file="imgf0017.tif" wi="158" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="59"> --><figure id="f0018" num="21"><img id="if0018" file="imgf0018.tif" wi="165" he="202" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="60"> --><figure id="f0019" num="22"><img id="if0019" file="imgf0019.tif" wi="165" he="222" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="61"> --><figure id="f0020" num="23"><img id="if0020" file="imgf0020.tif" wi="160" he="178" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="62"> --><figure id="f0021" num="24"><img id="if0021" file="imgf0021.tif" wi="156" he="216" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="63"> --><figure id="f0022" num="25"><img id="if0022" file="imgf0022.tif" wi="135" he="97" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="64"> --><figure id="f0023" num="26"><img id="if0023" file="imgf0023.tif" wi="109" he="210" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="65"> --><figure id="f0024" num="27"><img id="if0024" file="imgf0024.tif" wi="129" he="86" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="66"> --><figure id="f0025" num="28"><img id="if0025" file="imgf0025.tif" wi="107" he="204" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="67"> --><figure id="f0026" num="29"><img id="if0026" file="imgf0026.tif" wi="161" he="215" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="68"> --><figure id="f0027" num="30"><img id="if0027" file="imgf0027.tif" wi="136" he="103" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="69"> --><figure id="f0028" num="31"><img id="if0028" file="imgf0028.tif" wi="121" he="206" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="70"> --><figure id="f0029" num="32"><img id="if0029" file="imgf0029.tif" wi="134" he="92" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="71"> --><figure id="f0030" num="33"><img id="if0030" file="imgf0030.tif" wi="141" he="224" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="72"> --><figure id="f0031" num="34"><img id="if0031" file="imgf0031.tif" wi="131" he="97" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="73"> --><figure id="f0032" num="35"><img id="if0032" file="imgf0032.tif" wi="158" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="74"> --><figure id="f0033" num="36"><img id="if0033" file="imgf0033.tif" wi="165" he="197" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="75"> --><figure id="f0034" num="37"><img id="if0034" file="imgf0034.tif" wi="162" he="216" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="76"> --><figure id="f0035" num="38"><img id="if0035" file="imgf0035.tif" wi="159" he="178" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="77"> --><figure id="f0036" num="39"><img id="if0036" file="imgf0036.tif" wi="165" he="174" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="78"> --><figure id="f0037" num="40"><img id="if0037" file="imgf0037.tif" wi="161" he="184" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="79"> --><figure id="f0038" num="41"><img id="if0038" file="imgf0038.tif" wi="165" he="162" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="165" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="165" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
