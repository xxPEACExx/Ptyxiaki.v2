<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2961200-A1" country="EP" doc-number="2961200" kind="A1" date="20151230" family-id="51022231" file-reference-id="311904" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160451142" ucid="EP-2961200-A1"><document-id><country>EP</country><doc-number>2961200</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-14173544-A" is-representative="YES"><document-id mxw-id="PAPP193865252" load-source="patent-office" format="original"><country>EP</country><doc-number>14173544.9</doc-number><date>20140623</date><lang>EN</lang></document-id><document-id mxw-id="PAPP193865253" load-source="docdb" format="epo"><country>EP</country><doc-number>14173544</doc-number><kind>A</kind><date>20140623</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162026776" ucid="EP-14173544-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>14173544</doc-number><kind>A</kind><date>20140623</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1988520180" load-source="docdb">H04W   4/00        20090101AFI20141010BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988520731" load-source="docdb">H04W   4/12        20090101ALI20141010BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988526283" load-source="docdb">H04W  12/06        20090101ALN20141010BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988526956" load-source="docdb">G06Q  10/10        20120101ALN20141010BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988527157" load-source="docdb">G06F  21/35        20130101ALN20141010BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1627894677" load-source="docdb" scheme="CPC">G06Q  10/10        20130101 LA20180609BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1627894678" load-source="docdb" scheme="CPC">G06F  21/35        20130101 LI20180609BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1627894679" load-source="docdb" scheme="CPC">H04W  12/06        20130101 LI20180609BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1627894680" load-source="docdb" scheme="CPC">H04W   4/80        20180201 LI20180609BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984701415" load-source="docdb" scheme="CPC">G07C   9/00007     20130101 LI20151224BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984704944" load-source="docdb" scheme="CPC">G07C   1/10        20130101 FI20151224BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165544892" lang="DE" load-source="patent-office">Nahfeldkommunikationssystem</invention-title><invention-title mxw-id="PT165544893" lang="EN" load-source="patent-office">Near Field Communication System</invention-title><invention-title mxw-id="PT165544894" lang="FR" load-source="patent-office">Dispositif de communication de champ proche</invention-title><citations><patent-citations><patcit mxw-id="PCIT386368739" load-source="docdb" ucid="EP-2487629-A1"><document-id format="epo"><country>EP</country><doc-number>2487629</doc-number><kind>A1</kind><date>20120815</date></document-id><sources><source name="SEA" category="YA" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT335961656" load-source="docdb" ucid="GB-2507742-A"><document-id format="epo"><country>GB</country><doc-number>2507742</doc-number><kind>A</kind><date>20140514</date></document-id><sources><source name="SEA" category="A" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT386368738" load-source="docdb" ucid="WO-2013163338-A2"><document-id format="epo"><country>WO</country><doc-number>2013163338</doc-number><kind>A2</kind><date>20131031</date></document-id><sources><source name="SEA" category="XY" created-by-npl="N"/></sources></patcit></patent-citations><non-patent-citations><nplcit><text>None</text><sources><source mxw-id="PNPL57937126" load-source="docdb" name="APP"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR1103344287" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>NXP BV</last-name><address><country>NL</country></address></addressbook></applicant><applicant mxw-id="PPAR1103324556" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>NXP B.V.</last-name></addressbook></applicant><applicant mxw-id="PPAR1101644679" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>NXP B.V.</last-name><iid>100810158</iid><address><street>High Tech Campus 60</street><city>5656 AG Eindhoven</city><country>NL</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103319439" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>GALLO FRANCESCO</last-name><address><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR1103334603" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>GALLO, FRANCESCO</last-name></addressbook></inventor><inventor mxw-id="PPAR1101651576" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>GALLO, FRANCESCO</last-name><address><street>Intellectual Property and Licensing NXP Semiconductors Red Central 60 High Street</street><city>Redhill, Surrey RH1 1SH</city><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR1103311332" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>MUEHLBERGER ANDREAS</last-name><address><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR1103332216" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>MUEHLBERGER, ANDREAS</last-name></addressbook></inventor><inventor mxw-id="PPAR1101639778" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>MUEHLBERGER, ANDREAS</last-name><address><street>Intellectual Property and Licensing NXP Semiconductors Red Central 60 High Street</street><city>Redhill, Surrey RH1 1SH</city><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR1103325416" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>LESJAK CHRISTIAN MICHAEL</last-name><address><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR1103316061" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>LESJAK, CHRISTIAN MICHAEL</last-name></addressbook></inventor><inventor mxw-id="PPAR1101641237" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>LESJAK, CHRISTIAN MICHAEL</last-name><address><street>Intellectual Property and Licensing NXP Semiconductors Red Central 60 High Street</street><city>Redhill, Surrey RH1 1SH</city><country>GB</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR1101650622" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Hardingham, Christopher Mark</last-name><suffix>et al</suffix><iid>101423837</iid><address><street>NXP Semiconductors Intellectual Property and Licensing Red Central 60 High Street</street><city>Redhill, Surrey RH1 1SH</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS660682648" load-source="docdb">AL</country><country mxw-id="DS660604511" load-source="docdb">AT</country><country mxw-id="DS660682650" load-source="docdb">BE</country><country mxw-id="DS660680489" load-source="docdb">BG</country><country mxw-id="DS660781846" load-source="docdb">CH</country><country mxw-id="DS660680435" load-source="docdb">CY</country><country mxw-id="DS660604512" load-source="docdb">CZ</country><country mxw-id="DS660682663" load-source="docdb">DE</country><country mxw-id="DS660680436" load-source="docdb">DK</country><country mxw-id="DS660680437" load-source="docdb">EE</country><country mxw-id="DS660603486" load-source="docdb">ES</country><country mxw-id="DS660680490" load-source="docdb">FI</country><country mxw-id="DS660680495" load-source="docdb">FR</country><country mxw-id="DS660682664" load-source="docdb">GB</country><country mxw-id="DS660680438" load-source="docdb">GR</country><country mxw-id="DS660682665" load-source="docdb">HR</country><country mxw-id="DS660604513" load-source="docdb">HU</country><country mxw-id="DS660781847" load-source="docdb">IE</country><country mxw-id="DS660680451" load-source="docdb">IS</country><country mxw-id="DS660680496" load-source="docdb">IT</country><country mxw-id="DS660680452" load-source="docdb">LI</country><country mxw-id="DS660680500" load-source="docdb">LT</country><country mxw-id="DS660604514" load-source="docdb">LU</country><country mxw-id="DS660680501" load-source="docdb">LV</country><country mxw-id="DS660680502" load-source="docdb">MC</country><country mxw-id="DS660604692" load-source="docdb">MK</country><country mxw-id="DS660604693" load-source="docdb">MT</country><country mxw-id="DS660682666" load-source="docdb">NL</country><country mxw-id="DS660680497" load-source="docdb">NO</country><country mxw-id="DS660680524" load-source="docdb">PL</country><country mxw-id="DS660781848" load-source="docdb">PT</country><country mxw-id="DS660682671" load-source="docdb">RO</country><country mxw-id="DS660781849" load-source="docdb">RS</country><country mxw-id="DS660680525" load-source="docdb">SE</country><country mxw-id="DS660603487" load-source="docdb">SI</country><country mxw-id="DS660680498" load-source="docdb">SK</country><country mxw-id="DS660680526" load-source="docdb">SM</country><country mxw-id="DS660680453" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA166479512" lang="EN" load-source="patent-office"><p id="pa01" num="0001">The disclosure relates to a method of operating a system, the system comprising a near field communication, NFC, tag, an NFC device associated with a user of the system and a computer, the method comprising: the NFC device requesting a message from the NFC tag; the NFC tag generating a message comprising a representation of a counter value; the NFC tag sending the message to the NFC device; the NFC device generating a request comprising the representation of the counter value in response to receiving the message; the NFC device sending the request to a computer; the NFC device submitting user authentication data to the computer; and the computer executing an operation on verification of the counter value and the authentication data.
<img id="iaf01" file="imgaf001.tif" wi="94" he="87" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA166759324" lang="EN" source="EPO" load-source="docdb"><p>The disclosure relates to a method of operating a system, the system comprising a near field communication, NFC, tag, an NFC device associated with a user of the system and a computer, the method comprising: the NFC device requesting a message from the NFC tag; the NFC tag generating a message comprising a representation of a counter value; the NFC tag sending the message to the NFC device; the NFC device generating a request comprising the representation of the counter value in response to receiving the message; the NFC device sending the request to a computer; the NFC device submitting user authentication data to the computer; and the computer executing an operation on verification of the counter value and the authentication data.</p></abstract><description mxw-id="PDES98404213" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><p id="p0001" num="0001">The invention relates to a method of operating a system comprising a near field communication, NFC, tag.</p><p id="p0002" num="0002">Identification products, such as smart cards and RFID tags, are widely used in fields such as transport (ticketing, road tolling, baggage tagging), finance (debit and credit cards, electronic purse, merchant card), communications (SIM card for GSM phone), and tracking (access control, inventory management, asset tracking). RFID is an acronym of radio frequency identification. International standard ISO14443A is the industry standard for contactless smart cards. ISO14443A-compliant products such as MIFARE provide RF communication technology for transmitting data between a card or tag and a reader device. For example, in electronic ticketing for public transport, travelers wave their card over a reader at the turnstiles or entry point, benefiting from improved convenience and speed in the ticketing process. Such products are said to be the key to individual mobility in the future, supporting multiple applications including road tolling, airline tickets, access control and many more.</p><p id="p0003" num="0003">Evolving from a combination of contactless identification and networking technologies, near field communication (NFC) is a very short-range wireless technology, for distances measured in centimeters. NFC technology can be applied to consumer electronics devices such as mobile telephones and personal computers, for example.</p><p id="p0004" num="0004">NFC has been described on the website http://www.nxp.com/nfc and in the standard ISO/IEC 18092. NFC technology is optimized for intuitive, easy and secure communication between various devices without the need for manual configuration by a user. In order to make two devices communicate, users bring them close together or make them touch. The devices comprise NFC interfaces that will automatically connect and configure themselves to form a peer-to-peer network. NFC can also bootstrap other protocols like Bluetooth or wireless Ethernet (Wi-Fi) by exchanging configuration and session data. NFC is compatible with contactless smart card platforms. This enables NFC devices to read information from these cards, making contactless smart cards the ideal solution for bringing information and vouchers into the NFC world. NFC devices can also operate like a contactless card or tag, which makes them compatible with the existing infrastructure of ISO14443A-compliant systems.</p><p id="p0005" num="0005">The NFC Forum (http://www.nfc-forum.org/) is a non-profit industry association which<!-- EPO <DP n="2"> --> promotes the use of NFC short-range wireless interaction in the fields of consumer electronics, mobile devices and personal computers. The NFC Forum promotes the implementation and standardization of NFC technology to ensure interoperability between devices and services.</p><p id="p0006" num="0006">An NFC Forum tag can be read by any NFC-compliant device, such as a smart phone. NFC tags may be associated with services that are available to the NFC device from a server by touching the device to the tag.</p><p id="p0007" num="0007">It is possible to read out static content from a genuine tag and write this content to another NFC tag in order to create a cloned tag. The cloned tag may be used by an unauthorised user to gain access to a service without needing to access the genuine tag. In addition, the static content of the tag can be read and stored by an NFC smart phone. An attacker may modify a smart phone application to develop a malicious application that uses the static content to access a service without needing to touch the genuine tag. Therefore an attacker can easily circumvent the requirement to be physically present in the vicinity of the tag in order to gain access to the service.</p><p id="p0008" num="0008">According to a first aspect of the invention there is provided a method of operating a system, the system comprising a near field communication, NFC, tag, an NFC device associated with a user of the system and a computer, the method comprising:
<ul><li>the NFC device requesting a message from the NFC tag;</li><li>the NFC tag generating a message comprising a representation of a counter value;</li><li>the NFC tag sending the message to the NFC device;</li><li>the NFC device generating a request comprising the representation of the counter value in response to receiving the message;</li><li>the NFC device sending the request to a computer;</li><li>the NFC device submitting user authentication data to the computer; and</li><li>the computer executing an operation on verification of the counter value and the authentication data.</li></ul></p><p id="p0009" num="0009">The counter of the tag can be configured to amend the counter value in response to receiving the request from the NFC device according to a predetermined function, which may be as simple as incrementing the counter value. By incorporating a counter inside the NFC Forum Tag it is no longer possible to copy static content to another tag in order to clone the tag because counter logic within the tag alters the content of the tag upon each read access.<!-- EPO <DP n="3"> --></p><p id="p0010" num="0010">Requiring user authentication can mean that a specific individual that is registered with the system can be associated with a request for a service. The combination of requesting user authentication and the use of a counter provides a more secure system because a registered user can be discouraged from making anonymous requests that contain invalid counter details without risking detection. As such, an attacker can be discouraged from attempting a trial-and-error-type attack in which a large number of anonymous requests with different possible counter values are attempted in order to obtain a service from the computer. This is because such an attack would have to be associated with a registered user in order to have the possibility of obtaining a service and the unsuccessful attempts may be logged so that action can be taken against the user.</p><p id="p0011" num="0011">The method may further comprise the NFC device submitting user authentication data to the computer as part of sending the request to the computer. The NFC device may submit user authentication data to the computer before or after sending the request to a computer. The computer may generate a request for the user authentication data from the NFC device. The request for the user authentication data may comprise a log-on or password screen. The user authentication data may comprise a password, personal identification code or biometric information associated with the user. Biometric information includes a finger or thumb print, iris scan, or voice pattern of the user, for example.</p><p id="p0012" num="0012">The method may further comprise the NFC tag obfuscating or encrypting the counter value before generating the message. The method may comprise the NFC tag signing the message before sending the message to the NFC device. The NFC tag may apply a hash function to the counter value to provide a hashed counter value. The computer may generate one or more hashed expected values corresponding to one or more expected counter values. The one or more expected values may be the subsequent values in a counter value sequence to the most recently received counter value from the tag. The computer may compare the hashed counter value with the one or more hashed expected values in order to determine the counter value from the tag.</p><p id="p0013" num="0013">The message may comprise a uniform resource identifier, URI, for the computer, wherein the URI includes the counter value and the identifier of the tag. The computer may be a remote server on the internet. The uniform resource identifier may be an internet address, such as a universal resource location, associated with the computer.<!-- EPO <DP n="4"> --></p><p id="p0014" num="0014">The message generated by the tag and/or the request generated by the device may comprise an identifier of the tag.</p><p id="p0015" num="0015">An identifier for the computer may be stored on the NFC device. The NFC device may perform the step of requesting a message and generating the request using generic software. Generic software may be able to perform a number of non-proprietary functions or may have standard functions for interacting with other software. For example, a web browser is an example of a piece of generic software because the functions of communicating with a web server are the subject of agreed standards. Generic software may only use open protocols. Open protocols are protocols that are available to the public so that third party developers can implement them in software.</p><p id="p0016" num="0016">The message may be an NFC Data Exchange Format, NDEF, message.</p><p id="p0017" num="0017">The method may further comprise the NFC device including sensor data in the request and/or the NFC tag including sensor data in the message. The method may further comprise the NFC device taking a photograph in order to provide the sensor data. The method may further comprise the NFC device recording audio in order to provide the sensor data. The method may comprise the computer using the sensor data in order to verify the identifier of the user or verify an identifier of the NFC tag.</p><p id="p0018" num="0018">According to a further aspect of the invention there is provided a method of operating a time entry recording system, TERS, comprising performing the method of any preceding claim, wherein the NFC tag is associated with a function (for example, arrive or leave) of the TERS, the NFC device is associated with a user of the TERS and the step of the computer executing the operation comprises recording a time associated with the function of the TERS and the user of the NFC device.</p><p id="p0019" num="0019">According to a further aspect of the invention there is provided a method of operating an electronic poster, comprising performing the method of any preceding claim. The NFC tag may be embedded in the poster. The method may further comprise the NFC tag providing a URL for an electronic coupon and the computer.</p><p id="p0020" num="0020">According to a further aspect of the invention there is provided a system comprising a near field communication, NFC, tag, an NFC device associated with a user of the system and a computer, the system configured to perform the method of any preceding claim.<!-- EPO <DP n="5"> --></p><p id="p0021" num="0021">According to a further aspect of the invention there is provided a computer for a time entry recording system, configured to:
<ul><li>receive one or more requests from a NFC device, the one or more requests comprising:
<ul><li>an identifier of the tag that is associated with a function of a time entry recording system,</li><li>a representation of a counter value, and</li><li>user authentication data for a user of the NFC device;</li></ul></li><li>verify the counter value;</li><li>verify the authentication data; and</li><li>record a time associated with the function of the TERS and the user of the NFC device upon verification of the counter value and the authentication data.</li></ul></p><p id="p0022" num="0022">Embodiments will now be described by way of example with reference to the accompanying figure, in which Figure 1 illustrates a NFC system that is used to illustrate a method of operating the NFC system.</p><p id="p0023" num="0023">The NFC system 100 comprises a near field communication, NFC, tag 102, an NFC device 104 and a computer 104. The NFC device 104 may be provided by an NFC enabled smart phone and the computer 106 acts as a backend information system, or server.</p><p id="p0024" num="0024">The tag 102 comprises counter logic, a tag ID (ID<sub>T</sub>) and a NFC device exchange format, NDEF, message generator.</p><p id="p0025" num="0025">The counter logic operates on a counter value (C#). The counter logic is configured to alter the counter logic according to a predetermined rule, by incrementing the count value for example. The counter logic may also save or overwrite the counter value that is stored in the memory of the tag 102 with the altered counter value (C#). Alteration of the counter value (C#) may be triggered by the device 104 reading the tag 102. The counter value (C#) cannot be modified except by the counter logic of the tag 102, in some examples. An expected value for the counter value may be known to the computer 106. In some examples, the counter logic may have been initialized by the computer 106.</p><p id="p0026" num="0026">The NDEF message generator may be configured to insert the counter value (C#) into an NDEF message as part of a universal resource identifier, URI, such as a universal resource locator, URL. An electronic signature may be applied to the counter value (C#), URI or NDEF message. The NFC tag may obfuscate or encrypt the counter value (C#)<!-- EPO <DP n="6"> --> before generating the NDEF message. The use of an electronic signature, obfuscation or encryption may further increase the security of the system.</p><p id="p0027" num="0027">The tag 102 can be identified by the tag ID (ID<sub>T</sub>), which is unique in at least the context of the system 100. The tag (ID<sub>T</sub>) may be provided by data in the memory of the tag 102. Different tags, and so different tag IDs (ID<sub>T</sub>), may be associated with different actions or services provided by the computer. For example, in a time recording system, touching a first tag with a device may cause a first message to be sent from the first tag to the device 104 and relayed by the device to the computer 106. The first message may be indicative of an employee entering a building. Touching a second tag with the device 104 may cause a second message to be sent from the second tag to the device 104 and relayed by the device to the computer. The second message may be indicative of the employee leaving the building.</p><p id="p0028" num="0028">The device 104 may be an NFC-enabled smart phone that belongs to a user of the system 100. The user is issued with credentials, which may be a digital certificate that is stored in the memory of the smart phone. In addition or alternatively, the credentials may comprise a username and password combination, which may either be stored in a protected area of the smart phone memory or supplied by the user on demand.</p><p id="p0029" num="0029">The device 104 is an NFC Forum device and is capable of reading the NDEF message received from the tag 102 according the NFC Forum Type Tag Operation specification. The device 104 is also capable of generating a request for the computer 106 including information received from the tag 102 including the URL that comprises the counter value (C#). The request to the computer 106 may be any kind of internet based communication, such as a request to access a website, download data representative of a specific content, or a communication with a web-service offered by the server.</p><p id="p0030" num="0030">The reading and requesting functionality of the device 104 may be implemented using generic software. The generic software may be able to perform a number of non-proprietary functions or may have standard functions for interacting with other software. The generic software may only use open protocols that are available to the public so that third party developers can implement them in software. A web browser is an example of a piece of generic software because the functions of communicating with a web server are the subject of agreed standards; HTML and CSS are examples of open protocols. The NDEF message format is also an example of an open protocol.<!-- EPO <DP n="7"> --></p><p id="p0031" num="0031">The computer 106 is configured to execute an operation on verification of the counter value (C#) and the authentication data. The computer 106, or backend information system, IS, may be accessible by the device 104 via the Internet or any other network and provides an application programming interface to communicate with the device 104. All tag IDs (ID<sub>T</sub>) in the system 100 may be stored in a database of the computer 106 and associated with the corresponding action or service.</p><p id="p0032" num="0032">Access to the computer 106 by the device 104 is secured by the user authentication and optionally also by electronic signature, obfuscation or encryption of the counter value (C#). For each user, credentials can be issued in advance of use of the system. The user authentication data may comprise a digital certificate, username, password, personal identification code or biometric information associated with the user. Allowing only authenticated users to access the computer 106 discourages malicious use of the system because unauthenticated requests by the system are ignored. In addition, user activity can be identified as belonging to a particular user and the users are personally responsible for malicious activity, which also decrease any incentive to attack the system.</p><p id="p0033" num="0033">The computer 106 can enforce the technical security provided by the system in one or more of a number of ways:
<ul><li>Each access to the system must be authenticated. This reduces the likelihood of successful attacks from outsiders who have not previously been issued credentials. Attempted unauthenticated access to the backend may be logged.</li><li>A registered user (a person to whom credentials have been issued) may attempt to exploit the system using a malicious reader app on a smart phone that transmits a series of guesses of counter value (C#) to the backend system. The system can detect the attempted use of an invalid counter value (C#) and so the user may be held responsible for this attack. For example, the user's account may be deleted or suspended.</li></ul></p><p id="p0034" num="0034">The computer 106 can use a number of methods to detect attempted malicious activity:
<ul><li>The counter value (C#) is altered in a predetermined sequence, for example the counter value (C#) is incremented by 1 upon each read of the tag 102. Previously received counter values are stored in a database of the computer 106. A new counter value received from the tag 102 may not be verified if the new counter value is lower than (or earlier in the predetermined sequence than) the last verified counter value in<!-- EPO <DP n="8"> --> the database. Access to the system may be denied in the case where the counter value is not verified.</li><li>A sudden increase of the counter value (by an attacker trying to guess an upcoming counter value (C#)), can also be detected by the backend system and cause the counter value not to be verified. The new counter value received from the tag 102 may not be verified if the new counter value is more than a predetermined number of counts greater than (or later in the predetermined sequence than) the last verified counter value.</li><li>From the number of expected daily users of the system, predications about the expected change of the counter value (C#) transmitted to the backend system allow detection algorithms to identify malicious attempts. For example, the detection algorithm may determine whether a frequency of the requests deviates from a normal frequency of requests by more than a threshold value.</li></ul></p><p id="p0035" num="0035">The system 100 illustrated in Figure 1 enables a method to be performed by the tag 102, device 104 and computer 106. In general, the method may be applied to any system comprising a tag, an NFC device and a computer, where the purpose of the tag is to trigger an action in the computer upon touching the tag with the device 104.</p><p id="p0036" num="0036">The method comprises one or more of the steps of:
<ol><li>1. The NFC-enabled smart phone (device 104) undertakes the necessary steps to read the information contained on the tag 102. This step is initiated after the smart phone user touches the tag 102 with the device 104.</li><li>2. The tag 102 undertakes two actions before sending an NDEF message to the device 104:
<ol><li>a) the tag 102 alters the counter value (C#) according to a rule (for example a predetermined function such as "increment by 1") and stores the altered value in a memory of the tag 102.</li><li>b) the tag 102 incorporates the original or altered counter value (C#) and the static tag ID (ID<sub>T</sub>) into a URL that points to the computer (for example http://www.nxp.com/service.jsp?counter=1234&amp;id=9876)</li></ol></li><li>3. The URL (including the counter value (C#) and the tag ID (ID<sub>T</sub>) is transmitted to the device 104 as part of the NDEF message.</li><li>4. The device 104 requests some means of authentication, such as a challenge prompt that requests authentication information, from an application programming interface of the computer 106.<!-- EPO <DP n="9"> --></li><li>5. The challenge prompt is generated by the computer 106 and returned to the device 104.</li><li>6. The device 104 undertakes a number of steps of:
<ol><li>a) processing the challenge and preparing an answer. This process might require the presence of a previously issued certificate on the device 104 or the user to enter a valid username/password combination.</li><li>b) accessing the URL previously read from the tag.</li></ol></li><li>7. Upon accessing the URL, both counter value (C#) and tag ID (ID<sub>T</sub>) can be transmitted implicitly as part of the URL to the computer 106, whereas the authentication response may be transmitted to the computer in any suitable way, which may include a universal resource indicator, URI.</li><li>8. As the computer 106 receives the URL and the authentication response (which together provide an authenticated service request), it can undertake one or more of a number of security measures:
<ol><li>a. The authentication response is checked. For example, the presence of the valid username/password combination can be established in order to verify the authentication data. If the user cannot be authenticated successfully, the process is stopped and the request may be logged without executing an operation of the computer 106 that would provide a service to the device 104.</li><li>b. The tag ID (ID<sub>T</sub>), that is present in the URL, is looked-up in a database.
<ol><li>i. If the tag ID (ID<sub>T</sub>) is unknown, the process is stopped and the request may be logged without executing an operation of the computer 106 that would provide a service to the device 104.</li><li>ii. The counter value of a previous or last request for this tag 102 is retrieved from the database of previous counter values.</li></ol></li><li>c. The counter value retrieved from the database is used to check the validity of a new counter value from the request, e.g.
<ol><li>i. The new counter value (C#) should be later in a predetermined sequence of counter values than the counter values of previous requests from the database.</li><li>ii. The counter value (C#) should not have suddenly jumped in value because this might indicate guessing by an attacker. For example, the counter value (C#) may be verified if it is within a threshold number of counter values from the last received request. If the counter value (C#) is more than the threshold number of counter values from the last received request, the counter value may not be verified.<!-- EPO <DP n="10"> --></li><li>iii. Further checks, based on statistical/specific information associated with a particular implementation of the system 100 may be performed. For example, in a time tracking system for employees, an identification of multiple random requests by an employee immediately may lead to an alert being generated because this behaviour is considered unusual.</li><li>iv. If any check fails, the process is stopped and the request may be logged</li></ol></li><li>d. If the counter value (C#) and the tag ID (ID<sub>T</sub>) are verified, the computer 106 triggers an action according to the tag ID (ID<sub>T</sub>) or provides a service or content to the device 104, depending on the actual application. In the example of a time tracking system, the computer may indicate to the user via the device 104 that his "come" or "leave" indication has been successfully recorded.</li></ol></li><li>9. The computer executes an operation on verification of the counter value (C#) and the authentication data. The operation may include replying to, or relaying data to, the device 104.</li></ol></p><p id="p0037" num="0037">In some examples, the tag ID (ID<sub>T</sub>) may not be required. For example, if a dedicated smart phone app is used and the computer 106 only allows any tag 102 to trigger a single action by the computer 106 then it is not necessary for the computer 106 to be able to distinguish between different tags 102.</p><p id="p0038" num="0038">In some examples, the message generated by the tag does not comprise a URL. If a dedicated smart phone app is used, the application itself might be aware of which backend system to connect to, and hence a URL is not required upon each tag read.</p><p id="p0039" num="0039">The authentication procedure described in steps 4-7 do not necessarily have to take place in a specific order. Any suitable method of authentication of the device 104 by the computer 106 may be used.</p><p id="p0040" num="0040">Through the combination of:
<ol><li>(1) a counter value that is stored in memory associated with the tag 102, which is propagated into the content served by the tag 102 to the device 104 (by using an NDEF message, for example) and then to the computer 106 (embedded in a URL for example); and</li><li>(2) the computer 106 using information from a counter transmitted by an authenticated smart phone, the security of the system 100 can be improved in order to serve a broad range of NFC-tag based applications. Such a system may discourage a would-be attacker from attempting a trial-and-error-type attack in which a large number of<!-- EPO <DP n="11"> --> anonymous requests with different possible counter values (C#) are attempted in order to obtain a service from the computer 106.</li></ol></p><p id="p0041" num="0041">For example, the system 100 may be used to implement an employee time recording system, for issuing electronic coupons, secure data monitoring or restricted content access.</p><p id="p0042" num="0042">Two dedicated tags 102 can be mounted at the entrance to a building. One tag is associated with the sign in, or "come", function, and the other tag is associated with the sign out, or "leave", function. Once an employee enters the building in the morning, he touches the "come" tag with his smart phone 104, which forwards information regarding his arrival to the backend computer 106. When the employee leaves at the end of the day, he touches the "leave" tag, which forwards information regarding his departure to the backend computer 106. In both cases, the backend computer 106 uses the method presented below to detect potential misuse of, or attacks on, the system 100 (for example by an employee lying about when he actually left by using modified phone software that postpones sending the "leave" request to the computer 106).</p><p id="p0043" num="0043">In advertising, posters that include a tag 102 are used to attract a user's attention. By touching the part of the poster where the tag is mounted with his smart phone 104, the user can be issued with a URL for an electronic coupon by the tag. The coupon may entitle the user to a free drink, for example. To ensure the user does not exploit the system and collect multiple coupons, the method described above can be used to control the issue of electronic coupons by the computer 106 to the device 104 for the registered user. For example, a single registered user may only be entitled to redeem one coupon obtained from the tag.</p><p id="p0044" num="0044">The tag 102 may be connected to, or in electronic communication with, a measurement device that provides measurement data to the tag 102, for example continuously or intermittently. Upon each touch between the tag 102 and the device 104, the current measurement data or recent measurement data can be transferred via the device 104 to the computer 106, for example as part of an NDEF message. In one example, temperature sensors can be installed with the tag 102 at certain locations inside a refrigerating plant. When an inspector periodically visits the sensor locations and touches the tag 102 the current measurement data can be transmitted to the computer 106 by the device 104. In certain industries, such as the food industry, the enhanced security offered by the present invention may assist with ensuring compliance with safety and legal<!-- EPO <DP n="12"> --> standards. The NDEF message and request may contain a TAG ID and the counter value, both of which may be protected by a signature.</p><p id="p0045" num="0045">The invention can allow restricted content access for authorised users in an authorised location. For example, only visitors to a location where an NFC tag is mounted may be able to view certain web content or start a live video or audio stream from the Internet. In a shop, tags 102 attached to products can be used to direct the user's browser to a website with additional product information, or multimedia content, to enhance the shopping experience. In order to protect this information against public access from any competitor, the system requires a user to be physically present in the store and registered with the store.</p><p id="p0046" num="0046">It will be appreciated that any reference to "higher than", "greater than, "lower than", or "less than, etc, can refer to the parameter in question being less than or greater than a threshold value, or between two threshold values, depending upon the context.</p></description><claims mxw-id="PCLM90459142" lang="EN" load-source="patent-office"><!-- EPO <DP n="13"> --><claim id="c-en-0001" num="0001"><claim-text>A method of operating a system, the system comprising a near field communication, NFC, tag, an NFC device associated with a user of the system and a computer, the method comprising:
<claim-text>the NFC device requesting a message from the NFC tag;</claim-text>
<claim-text>the NFC tag generating a message comprising a representation of a counter value;</claim-text>
<claim-text>the NFC tag sending the message to the NFC device;</claim-text>
<claim-text>the NFC device generating a request comprising the representation of the counter value in response to receiving the message;</claim-text>
<claim-text>the NFC device sending the request to a computer;</claim-text>
<claim-text>the NFC device submitting user authentication data to the computer; and</claim-text>
<claim-text>the computer executing an operation on verification of the counter value and the authentication data.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The method of claim 1 further comprising the NFC device submitting user authentication data to the computer as part of sending the request to the computer.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The method of claim 1 or claim 2 further comprising the NFC tag obfuscating or encrypting the counter value before generating the message.</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>The method of any preceding claim further comprising the NFC tag signing the message before sending the message to the NFC device.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>The method of any preceding claim wherein the message comprises a uniform resource identifier, URI, for the computer, wherein the URI includes the counter value and the identifier of the tag.</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>The method of claim 5 wherein the computer is a remote server on the internet and the uniform resource identifier is an internet address associated with the computer.</claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>The method of any of claims 1 to 4 wherein an identifier for the computer is stored on the NFC device.</claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>The method of any preceding claim wherein the message generated by the tag and the request generated by the device comprise an identifier of the tag.<!-- EPO <DP n="14"> --></claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>The method of any preceding claim wherein the NFC device performs the step of requesting a message and generating the request using generic software.</claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>The method of any preceding claim wherein the message is an NFC Data Exchange Format, NDEF, message.</claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>The method of any preceding claim further comprising:
<claim-text>the NFC device including sensor data in the request and/or the NFC tag including sensor data in the message; and</claim-text>
<claim-text>the computer using the sensor data in order to verify the identifier of the user.</claim-text></claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>A method of operating a time entry recording system, TERS, comprising performing the method of any preceding claim, wherein the NFC tag is associated with a function of the TERS, the NFC device is associated with a user of the TERS and the step of the computer executing the operation comprises recording a time associated with the function of the TERS and the user of the NFC device.</claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>A method of operating an electronic poster, comprising performing the method of any of claims 1 to 11, wherein the NFC tag is configured to issue a coupon and is embedded in the poster and executing the desired operation of the computer comprises providing a service to the NFC device .</claim-text></claim><claim id="c-en-0014" num="0014"><claim-text>A system comprising a near field communication, NFC, tag, an NFC device associated with a user of the system and a computer, the system configured to perform the method of any preceding claim.</claim-text></claim><claim id="c-en-0015" num="0015"><claim-text>A computer for a time entry recording system, configured to:
<claim-text>receive one or more requests from a NFC device, the one or more requests comprising:
<claim-text>an identifier of the tag that is associated with a function of a time entry recording system,</claim-text>
<claim-text>a representation of a counter value, and</claim-text></claim-text>
<claim-text>user authentication data for a user of the NFC device;</claim-text>
<claim-text>verify the counter value;</claim-text>
<claim-text>verify the authentication data; and</claim-text>
<claim-text>record a time associated with the function of the TERS and the user of the NFC device upon verification of the counter value and the authentication data.</claim-text></claim-text></claim></claims><amended-claims mxw-id="PCLM90459141" lang="EN" load-source="patent-office" amended-claim-type="EPC"><heading id="h0001">Amended claims in accordance with Rule 137(2) EPC.</heading><claim id="ac-en-0001" num="0001"><claim-text>A method of operating a system, the system comprising a near field communication, NFC, tag (102), an NFC device (104) associated with a user of the system and a computer (106), the method comprising:
<claim-text>the NFC device requesting (1) a message from the NFC tag;</claim-text>
<claim-text>the NFC tag amending the counter value according to a predetermined rule in response to receiving the request;</claim-text>
<claim-text>the NFC tag generating a message comprising a representation of a counter value;</claim-text>
<claim-text>the NFC tag sending (3) the message to the NFC device;</claim-text>
<claim-text>the NFC device generating a request comprising the representation of the counter value in response to receiving the message;</claim-text>
<claim-text>the NFC device sending (4) the request to a computer;</claim-text>
<claim-text>the NFC device submitting (7) user authentication data to the computer; and</claim-text>
<claim-text>the computer executing an operation on verification of the counter value and the authentication data.</claim-text></claim-text></claim><claim id="ac-en-0002" num="0002"><claim-text>The method of claim 1 further comprising the NFC device submitting user authentication data to the computer as part of sending the request to the computer.</claim-text></claim><claim id="ac-en-0003" num="0003"><claim-text>The method of claim 1 or claim 2 further comprising the NFC tag obfuscating or encrypting the counter value before generating the message.</claim-text></claim><claim id="ac-en-0004" num="0004"><claim-text>The method of any preceding claim further comprising the NFC tag signing the message before sending the message to the NFC device.</claim-text></claim><claim id="ac-en-0005" num="0005"><claim-text>The method of any preceding claim wherein the message comprises a uniform resource identifier, URI, for the computer, wherein the URI includes the counter value and the identifier of the tag.</claim-text></claim><claim id="ac-en-0006" num="0006"><claim-text>The method of claim 5 wherein the computer is a remote server on the internet and the uniform resource identifier is an internet address associated with the computer.</claim-text></claim><claim id="ac-en-0007" num="0007"><claim-text>The method of any of claims 1 to 4 wherein an identifier for the computer is stored on the NFC device.</claim-text></claim><claim id="ac-en-0008" num="0008"><claim-text>The method of any preceding claim wherein the message generated by the tag and the request generated by the device comprise an identifier of the tag.</claim-text></claim><claim id="ac-en-0009" num="0009"><claim-text>The method of any preceding claim wherein the NFC device performs the step of requesting a message and generating the request using generic software.</claim-text></claim><claim id="ac-en-0010" num="0010"><claim-text>The method of any preceding claim wherein the message is an NFC Data Exchange Format, NDEF, message.</claim-text></claim><claim id="ac-en-0011" num="0011"><claim-text>The method of any preceding claim further comprising:
<claim-text>the NFC device including sensor data in the request and/or the NFC tag including sensor data in the message; and</claim-text>
<claim-text>the computer using the sensor data in order to verify the identifier of the user.</claim-text></claim-text></claim><claim id="ac-en-0012" num="0012"><claim-text>A method of operating a time entry recording system, TERS, comprising performing the method of any preceding claim, wherein the NFC tag is associated with a function of the TERS, the NFC device is associated with a user of the TERS and the step of the computer executing the operation comprises recording a time associated with the function of the TERS and the user of the NFC device.</claim-text></claim><claim id="ac-en-0013" num="0013"><claim-text>A method of operating an electronic poster, comprising performing the method of any of claims 1 to 11, wherein the NFC tag is configured to issue a coupon and is embedded in the poster and executing the desired operation of the computer comprises providing a service to the NFC device.</claim-text></claim><claim id="ac-en-0014" num="0014"><claim-text>A system comprising a near field communication, NFC, tag, an NFC device associated with a user of the system and a computer, the system configured to perform the method of any preceding claim.</claim-text></claim><claim id="ac-en-0015" num="0015"><claim-text>A computer for a time entry recording system, configured to:
<claim-text>receive one or more requests from a NFC device, the one or more requests comprising:
<claim-text>an identifier of the tag that is associated with a function of a time entry recording system,</claim-text>
<claim-text>a representation of a counter value, and</claim-text></claim-text>
<claim-text>user authentication data for a user of the NFC device;</claim-text>
<claim-text>verify the counter value using a counter value of a previous or last request;</claim-text>
<claim-text>verify the authentication data; and</claim-text>
<claim-text>record a time associated with the function of the TERS and the user of the NFC device upon verification of the counter value and the authentication data.</claim-text></claim-text></claim></amended-claims><drawings mxw-id="PDW20421879" load-source="patent-office"><!-- EPO <DP n="15"> --><figure id="f0001" num=","><img id="if0001" file="imgf0001.tif" wi="165" he="163" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="157" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="157" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
