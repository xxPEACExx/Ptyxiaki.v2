<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2961207-A1" country="EP" doc-number="2961207" kind="A1" date="20151230" family-id="51176995" file-reference-id="275349" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160451135" ucid="EP-2961207-A1"><document-id><country>EP</country><doc-number>2961207</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-14305986-A" is-representative="YES"><document-id mxw-id="PAPP193865238" load-source="docdb" format="epo"><country>EP</country><doc-number>14305986</doc-number><kind>A</kind><date>20140624</date><lang>EN</lang></document-id><document-id mxw-id="PAPP193865239" load-source="patent-office" format="original"><country>EP</country><doc-number>14305986.3</doc-number><date>20140624</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162032317" ucid="EP-14305986-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>14305986</doc-number><kind>A</kind><date>20140624</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1988520210" load-source="docdb">H04L  29/06        20060101ALI20141128BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988521052" load-source="docdb">H04W   8/24        20090101AFI20141128BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988523381" load-source="docdb">H04W  12/06        20090101ALI20141128BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1779706468" load-source="docdb" scheme="CPC">H04W   8/245       20130101 LI20170728BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1779706469" load-source="docdb" scheme="CPC">H04L  63/166       20130101 LI20170728BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1779706470" load-source="docdb" scheme="CPC">H04L  41/046       20130101 LI20170727BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1779706471" load-source="docdb" scheme="CPC">H04L   9/0819      20130101 FI20170727BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1779706472" load-source="docdb" scheme="CPC">H04W  84/12        20130101 LA20170727BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1779706473" load-source="docdb" scheme="CPC">H04L2209/80        20130101 LA20170727BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1779706474" load-source="docdb" scheme="CPC">H04W  12/06        20130101 LI20170728BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1779706475" load-source="docdb" scheme="CPC">H04L  67/20        20130101 LI20170727BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1793400154" load-source="docdb" scheme="CPC">H04W  12/04        20130101 LA20170704BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165544871" lang="DE" load-source="patent-office">Verfahren, Server und TK-System für die Einrichtung, durch eine OTA-Server, einem gesicherten Kommunikationskanal zwischen einer Verwaltungsstelle innerhalb eines Geräts und den Server einer dritten Partei</invention-title><invention-title mxw-id="PT165544872" lang="EN" load-source="patent-office">Method, server and telecommunications system for establishing, through an OTA server, a secured communication channel between an administrative agent comprised in a device and a third party server</invention-title><invention-title mxw-id="PT165544873" lang="FR" load-source="patent-office">Méthode , serveur et système de télécommunications pour l'établissement, par le biais d'un serveur OTA, un canal de communication sécurisé entre un agent administratif comprise dans un dispositif et un serveur tiers</invention-title><citations><patent-citations><patcit mxw-id="PCIT377493807" load-source="docdb" ucid="SE-2008050380-W" dnum-type="application"><document-id format="epo"><country>SE</country><doc-number>2008050380</doc-number><kind>W</kind><date>20080402</date></document-id><sources><source name="APP" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT335961650" load-source="docdb" ucid="US-20090191857-A1"><document-id format="epo"><country>US</country><doc-number>20090191857</doc-number><kind>A1</kind><date>20090730</date></document-id><sources><source name="SEA" category="A" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT335961649" load-source="docdb" ucid="WO-2009046400-A1"><document-id format="epo"><country>WO</country><doc-number>2009046400</doc-number><kind>A1</kind><date>20090409</date></document-id><sources><source name="SEA" category="A" created-by-npl="N"/></sources></patcit></patent-citations><non-patent-citations><nplcit><text>FANG-CHUN KUO ET AL: "Comparison Studies between Pre-Shared and Public Key Exchange Mechanisms for Transport Layer Security", INFOCOM 2006. 25TH IEEE INTERNATIONAL CONFERENCE ON COMPUTER COMMUNICA TIONS. PROCEEDINGS, IEEE, PISCATAWAY, NJ, 1 April 2006 (2006-04-01), pages 1 - 6, XP031072092, ISBN: 978-1-4244-0221-2, DOI: 10.1109/INFOCOM.2006.115</text><sources><source mxw-id="PNPL62141698" load-source="docdb" name="SEA" category="A"/></sources></nplcit><nplcit><text>FRÉDÉRIC GALLAS ET AL: "OMA-SCT-2007-0094R01-CR_Multi_Admin.doc ; OMA-SCT-2007-0094R01-CR_Multi_Admin", 10 December 2007 (2007-12-10), pages 1 - 7, XP064022219, Retrieved from the Internet &lt;URL:ftp/Public_documents/ARCH/ARC-SEC_SCT/2007/&gt; [retrieved on 20071210]</text><sources><source mxw-id="PNPL62141699" load-source="docdb" name="SEA" category="A"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR1103339914" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>GEMALTO SA</last-name><address><country>FR</country></address></addressbook></applicant><applicant mxw-id="PPAR1103330784" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>GEMALTO SA</last-name></addressbook></applicant><applicant mxw-id="PPAR1101648336" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Gemalto SA</last-name><iid>101122644</iid><address><street>6, rue de la Verrerie</street><city>92190 Meudon</city><country>FR</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103335804" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>BERARD XAVIER</last-name><address><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103330469" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>BERARD, XAVIER</last-name></addressbook></inventor><inventor mxw-id="PPAR1101644220" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>BERARD, XAVIER</last-name><address><street>c/o Gemalto SA Service brevets Avenue du Jujubier ZI Athélia IV</street><city>13705 La Ciotat</city><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103317382" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>PAILLART FRÉDÉRIC</last-name><address><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103339675" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>Paillart, Frédéric</last-name></addressbook></inventor><inventor mxw-id="PPAR1101651145" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>Paillart, Frédéric</last-name><address><street>c/o Gemalto SA Service brevets Avenue du Jujubier ZI Athélia IV</street><city>13705 La Ciotat</city><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103320039" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>FAURE FRÉDÉRIC</last-name><address><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103328794" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>Faure, Frédéric</last-name></addressbook></inventor><inventor mxw-id="PPAR1101654003" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>Faure, Frédéric</last-name><address><street>c/o Gemalto SA Service brevets Avenue du Jujubier ZI Athélia IV</street><city>13705 La Ciotat</city><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103319128" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>MALLET LIONEL</last-name><address><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103310100" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>MALLET, LIONEL</last-name></addressbook></inventor><inventor mxw-id="PPAR1101652621" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>MALLET, LIONEL</last-name><address><street>c/o Gemalto SA Service brevets Avenue du Jujubier ZI Athélia IV</street><city>13705 La Ciotat</city><country>FR</country></address></addressbook></inventor></inventors></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS660680395" load-source="docdb">AL</country><country mxw-id="DS660681779" load-source="docdb">AT</country><country mxw-id="DS660680397" load-source="docdb">BE</country><country mxw-id="DS660603447" load-source="docdb">BG</country><country mxw-id="DS660781810" load-source="docdb">CH</country><country mxw-id="DS660680329" load-source="docdb">CY</country><country mxw-id="DS660681780" load-source="docdb">CZ</country><country mxw-id="DS660680360" load-source="docdb">DE</country><country mxw-id="DS660680398" load-source="docdb">DK</country><country mxw-id="DS660680330" load-source="docdb">EE</country><country mxw-id="DS660604401" load-source="docdb">ES</country><country mxw-id="DS660603448" load-source="docdb">FI</country><country mxw-id="DS660603449" load-source="docdb">FR</country><country mxw-id="DS660680403" load-source="docdb">GB</country><country mxw-id="DS660680404" load-source="docdb">GR</country><country mxw-id="DS660680405" load-source="docdb">HR</country><country mxw-id="DS660680339" load-source="docdb">HU</country><country mxw-id="DS660781811" load-source="docdb">IE</country><country mxw-id="DS660680406" load-source="docdb">IS</country><country mxw-id="DS660603450" load-source="docdb">IT</country><country mxw-id="DS660680340" load-source="docdb">LI</country><country mxw-id="DS660680361" load-source="docdb">LT</country><country mxw-id="DS660681781" load-source="docdb">LU</country><country mxw-id="DS660680362" load-source="docdb">LV</country><country mxw-id="DS660680371" load-source="docdb">MC</country><country mxw-id="DS660604626" load-source="docdb">MK</country><country mxw-id="DS660604639" load-source="docdb">MT</country><country mxw-id="DS660604402" load-source="docdb">NL</country><country mxw-id="DS660603451" load-source="docdb">NO</country><country mxw-id="DS660604411" load-source="docdb">PL</country><country mxw-id="DS660603452" load-source="docdb">PT</country><country mxw-id="DS660604412" load-source="docdb">RO</country><country mxw-id="DS660603453" load-source="docdb">RS</country><country mxw-id="DS660604413" load-source="docdb">SE</country><country mxw-id="DS660781812" load-source="docdb">SI</country><country mxw-id="DS660604640" load-source="docdb">SK</country><country mxw-id="DS660604641" load-source="docdb">SM</country><country mxw-id="DS660680341" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA166479505" lang="EN" load-source="patent-office"><p id="pa01" num="0001">a method, a remote server and a third-party server for establishing a first secured communication channel (14) between an administrative agent (12, e. g., Admin Agent of OMA standardization body) comprised in a device (10) and a remote server (13, e.g., an OTA server), the device (10) comprising a secure element (11, e. g., a SIM/UICC/eUICC card) communicating with the administrative agent (12), the secure element (11) being administrated through the administrative agent (12) by the remote server (13), the administrative agent (12) being administrated by a third party server (15) through a second secured communication channel (16), the remote server (13) and the third party server (15) being connected through a third secured channel (17), the method consisting in:<br/>
a- Requesting (20, 21), from the third party server (15) to the remote server (13), an operation (20) on the secure element (11) and a one-time PSK (21);<br/>
b- Sending (22) from the remote server (13) to the third party server (15) the one-time PSK;<br/>
c- Sending (23) from the third party server (15) to the administrative agent (12) a triggering message including the one-time PSK;<br/>
d- Performing (24) a TLS-PSK handshake between the administrative agent (12) and the remote server (13) with the one-time PSK in order to establish the first secured communication channel (14).
<img id="iaf01" file="imgaf001.tif" wi="144" he="77" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA166759317" lang="EN" source="EPO" load-source="docdb"><p>a method, a remote server and a third-party server for establishing a first secured communication channel (14) between an administrative agent (12, e. g., Admin Agent of OMA standardization body) comprised in a device (10) and a remote server (13, e.g., an OTA server), the device (10) comprising a secure element (11, e. g., a SIM/UICC/eUICC card) communicating with the administrative agent (12), the secure element (11) being administrated through the administrative agent (12) by the remote server (13), the administrative agent (12) being administrated by a third party server (15) through a second secured communication channel (16), the remote server (13) and the third party server (15) being connected through a third secured channel (17), the method consisting in: 
a- Requesting (20, 21), from the third party server (15) to the remote server (13), an operation (20) on the secure element (11) and a one-time PSK (21); 
b- Sending (22) from the remote server (13) to the third party server (15) the one-time PSK; 
c- Sending (23) from the third party server (15) to the administrative agent (12) a triggering message including the one-time PSK; 
d- Performing (24) a TLS-PSK handshake between the administrative agent (12) and the remote server (13) with the one-time PSK in order to establish the first secured communication channel (14).</p></abstract><description mxw-id="PDES98404206" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><p id="p0001" num="0001">The invention relates to telecommunications and in particular to the administration of a secure element cooperating with a device.</p><p id="p0002" num="0002">The device is typically a smartphone, a PDA, a tablet, a mobile phone or a machine (for M2M applications) like a car for example.</p><p id="p0003" num="0003">The secure element is for example a UICC (Universal Integrated Circuit Card), can be in the format of a smart card, or in the format of a packaged chip as described in <patcit id="pcit0001" dnum="SE2008050380W"><text>PCT/SE2008/050380</text></patcit>, or any other format. It can be used in mobile terminals in GSM and UMTS networks for instance. The UICC ensures network authentication, integrity and security of all kinds of personal data.</p><p id="p0004" num="0004">In a GSM network, the UICC contains mainly a SIM application and in a UMTS network it is the USIM application. In a LTE network (4G), the UICC contains a ISIM application. A UICC may contain several other applications, making it possible for the same smart card to give access to both GSM and UMTS networks, and also provide storage of a phone book and other applications. It is also possible to access a GSM network using an USIM application and it is possible to access UMTS networks using a SIM application with mobile terminals prepared for this.</p><p id="p0005" num="0005">In a CDMA network, the UICC contains a CSIM application, in addition to 3GPP USIM and SIM applications. A card with all three features is called a removable user identity card, or R-UIM. Thus, the R-UIM card can be inserted into CDMA, GSM, or UMTS devices, and will work in all three cases.</p><p id="p0006" num="0006">In 2G networks, the SIM card and SIM application were bound together, so that "SIM card" could mean the physical card, or any physical card with the SIM application.</p><p id="p0007" num="0007">UICCs are standardized by 3GPP and ETSI.</p><p id="p0008" num="0008">A UICC can normally be removed from a mobile terminal, for example when the user wants to change his mobile terminal. After having inserted his UICC in his new terminal, the user will still have access to his applications, contacts and credentials (network operator).</p><p id="p0009" num="0009">It is also known to solder or weld the UICC in a terminal, in order to get it dependent of this terminal. This is done in M2M (Machine to Machine) applications (e.g. following the form factor indicated in the ETSI TS 102 671). The same objective<!-- EPO <DP n="2"> --> is reached when a chip (a secure element) containing the SIM, ISIM or USIM applications and files is contained in the terminal. The chip is for example soldered to the mother-board of the terminal or machine and constitutes an UICC.</p><p id="p0010" num="0010">Other secure elements are possible, for example eUICCs. eUICCs are UICCs that are either soldered either not totally linked to devices but that are removable with difficulty because they are not intended to be removed, located in terminals that are distant or deeply integrated in machines. A special form factor of the UICC (very small for example and therefore not easy to handle) can also be a reason to consider it as in fact integrated in a terminal. TS 102 671 also applies to eUICCs The same applies when a UICC is integrated in a machine that is not intended to be opened. The GSMA provides a technical specification for eUICCs.</p><p id="p0011" num="0011">In the next description, we will refer in general to secure elements that can be UICCs, eUICCs, embedded secure elements (soldered to a motherboard of the device), secure memory cards or micro SD cards for example. These secure elements can be administrated by operators via OTA (Over The Air).</p><p id="p0012" num="0012">The operator's network (OTA platform) can administrate the secure element through an administrative agent located in the device (admin agent). This is typically the case when the secure element cannot open a data channel to communicate with the OTA platform (the device is not BIP compliant for example). It is then necessary to provide in the device an admin agent for establishing a data channel between the secure element and the OTA platform.</p><p id="p0013" num="0013">In the following, a telecommunications system as represented in <figref idrefs="f0001">figure 1</figref> will be considered.</p><p id="p0014" num="0014">In this figure, a device 10, for example a smartphone, contains a secure element 11 (here a UICC) and an administrative agent 12. The secure element 11 communicates with the administrative agent 12.</p><p id="p0015" num="0015">The secure element 11 is administrated by a distant server 13 (here an OTA server) through the administrative agent 12. This administration is done through a first secure channel 14 as defined in "<nplcit id="ncit0001" npl-type="s"><text>Global Platform Device Secure Element Remote Application Management", for example version 1.0, May 2011</text></nplcit>, document referenced GPD_SPE_008.</p><p id="p0016" num="0016">The administrative agent 12 is administrated by a third party server 15 through a second secured channel 16, the distant server 13 and the third party server 15 being connected through a third secured channel 17.<!-- EPO <DP n="3"> --></p><p id="p0017" num="0017">The third party server 15 is for example an administration system of a device maker, a service provider, a TSM, or a bank system that is managing an NFC application present in the device 10 (in a secure element as mentioned above). It can also be an administration system of a device maker, like a car maker.</p><p id="p0018" num="0018">The problem solved by the present invention is related to the establishment of the first secure channel 14 between the distant server 13 and the admin agent 12, as defined in GlobalPlatform Device Secure Element Remote Application Management.</p><p id="p0019" num="0019">Authentication mechanisms are already proposed in the GlobalPlatform Device Secure Element Remote Application Management, for example version 1.0, May 2011, document referenced GPD_SPE_008. These mechanisms are:
<ul><li>TLS mutual authentication using PSK-TLS (see RFC 4279 [10a], RFC 4785 [10c], and RFC 5487 [10b]).</li><li>TLS mutual authentication TLS using Public Keys based on client certificates (see RFC 2246 [8a], RFC 4346 [8b], and RFC 5246 [8c]).</li><li>TLS with only server authentication to manage the confidentiality and the integrity (for confidentiality) and then HTTP Basic or Digest Authentication for the client authentication (see RFC 2617 [12]) (for authentication using login password mechanism).</li></ul></p><p id="p0020" num="0020">All these methods require basically having credentials stored at device 10 side.</p><p id="p0021" num="0021">We could also imagine that the admin agent 12 doesn't authenticate itself because at the end the payload that will be returned by the distant server 13 in the HTTP response is secured itself but then the solution would be open to at least DoS attack (Deny of Service).</p><p id="p0022" num="0022">The technical problem to solve is therefore double:
<ul><li>Firstly, there is a security issue: Sensible credentials required to establish the communication channel 14 need to be stored in a very unsecured environment which is the device 10;</li><li>Secondly, there is a provisioning issue: Most of the time admin agent 12 and the distant server 13 are provisioned and operated by distinct entities and decorrelated of the final target which is the secure element 11 to administrate. So initializing a shared secret becomes very difficult, or almost impossible. So the<!-- EPO <DP n="4"> --> credentials becomes something like a generic user / password being the same for all admin agent instances, which makes the first security issue even more critical.</li></ul></p><p id="p0023" num="0023">The present invention has the purpose to propose a solution to these problems.</p><p id="p0024" num="0024">More precisely, the present invention proposes to establish a secured communication channel as defined in GlobalPlatform Device Secure Element Remote Application Management between a distant server, like an OTA server for example, and a secure element comprised in a device, through an admin agent comprised in this device, without having to store credentials at the level of the device or having to manage secrets between the distant server and a third party server that is administrating the admin agent. This secured communication channel must ensure integrity, authenticity and confidentiality.</p><p id="p0025" num="0025">This objective is achieved thanks to a method for establishing a first secured communication channel between an administrative agent comprised in a device and a distant server, the device comprising a secure element communicating with the administrative agent, the secure element being administrated through the administrative agent by the distant server, the administrative agent being administrated by a third party server through a second secured communication channel, the distant server and the third party server being connected through a third secured channel, the method consisting in:
<ul><li>a- Requesting, from the third party server to the distant server, an operation on the secure element and a one-time PSK;</li><li>b- Sending from the distant server to the third party server this one-time PSK;</li><li>c- Sending from the third party server to the administrative agent a triggering message including this one-time PSK;</li><li>d- Performing a TLS-PSK handshake between the administrative agent and the distant server with the one-time PSK in order to establish the first secured communication channel.</li></ul></p><p id="p0026" num="0026">Thus, the admin agent authentication is based on a one-time PSK generated by the distant server in the configuration of <figref idrefs="f0001">figure 1</figref>.</p><p id="p0027" num="0027">Preferably, the device is a mobile terminal.</p><p id="p0028" num="0028">Advantageously, the secure element is a UICC, a eUICC, an embedded secure element, a secure memory cards or a micro SD card.</p><p id="p0029" num="0029">Step -a- is preferably performed when the device is under Wifi coverage.<!-- EPO <DP n="5"> --></p><p id="p0030" num="0030">In a preferred embodiment, the distant server is an OTA server or a server specified in the GSMA eUICC specification.</p><p id="p0031" num="0031">The invention also concerns a server for administrating a secure element comprised in a device, the device comprising an administrative agent, the server being able to administrate the secure element through this administrative agent, the server comprising means for:
<ul><li>sending a one-time PSK to a third party server, at the request of this third party server;</li><li>performing a TLS-PSK handshake with the administrative agent, once the third party server has sent to the administrative agent the one-time PSK, in order to administrate the secure element.</li></ul></p><p id="p0032" num="0032">The invention also concerns a third party server connected to a distant server able to administrate a secure element comprised in a device through an administrative agent comprised in the device, the administrative agent being administrated by the party server through a second secured channel, the distant server and the third party server being connected through a third secured channel, the third party server comprising means for:
<ul><li>a- Requesting to the distant server, an operation on the secure element and a one-time PSK;</li><li>b- Receiving from the distant server the one-time PSK;</li><li>c- Sending to the administrative agent a triggering message including the one-time PSK, in order to perform a TLS-PSK handshake between the administrative agent and the distant server with the one-time PSK, in order to establish a first secured communication channel between the administrative agent and the distant server.</li></ul></p><p id="p0033" num="0033">Finally, the invention concerns a telecommunications system comprising:
<ul><li>a device comprising a secure element and an administrative agent, the secure element communicating with the administrative agent;</li><li>a distant server able to administrate the secure element via the administrative agent through a first secured communication channel,</li><li>a third party server able to administrate the administrative agent through a second secured communication channel, the distant server and the third party server being connected through a third secured channel, the system comprising means for:</li><li>Requesting, from the third party server to the distant server, an operation on the secure element and a one-time PSK;<!-- EPO <DP n="6"> --></li><li>Sending from the distant server to the third party server the one-time PSK;</li><li>Sending from the third party server to the administrative agent a triggering message including the one-time PSK;</li><li>Performing a TLS-PSK handshake between the administrative agent and the distant server with the one-time PSK in order to establish the first secured communication channel.</li></ul></p><p id="p0034" num="0034">Other features and advantages of the present invention will appear in the following description of the figures that represent:
<ul><li><figref idrefs="f0001">Figure 1</figref>, a system according to the present invention;</li><li><figref idrefs="f0001">Figure 2</figref>, the method according to the present invention.</li></ul></p><p id="p0035" num="0035">As already explained in regard to <figref idrefs="f0001">figure 1</figref>, the distant server 13 and the secure element 11 are owned and administrated by an actor 1 (typically a telecommunication network operator) through a first secured channel 14. The third party server 15 and the admin agent 12 are owned and administrated by an actor 2 (for example a bank, a TSM (Trusted Service Manager) or a manufacturer of the device 10) through a second (proprietary) secured channel 16. All these channels provide integrity, authenticity and confidentiality to the communications.</p><p id="p0036" num="0036">The connection (third channel 17) between the distant server 13 and the third party server 15 is trusted and secured also.</p><p id="p0037" num="0037"><figref idrefs="f0001">Figure 2</figref> represents a flowchart explaining the method according to the present invention.</p><p id="p0038" num="0038">Only the distant server 13, the third party server 15 and the admin agent 12 are represented in this figure. The secure element 11 (<figref idrefs="f0001">fig.1</figref>) is administrated by the distant server 13 through the admin agent 12 to which it is connected. The admin agent 12 constitutes therefore a proxy.</p><p id="p0039" num="0039">The method according to the invention consists in four main steps:
<ul><li>The first step, referenced 20, consists in requesting, from the third party server 15 to the distant server 13, an operation on the secure element and a one-time PSK (Pre-Shared Key). The request of a one-time PSK can be done during step 20 or during another following step 21. The third party server 15 provides identification of the admin agent 12 and identification of the final targeted secure element that is behind the admin agent 12.</li><li>The second step, referenced 22, consists in sending from the distant server 13 to the third party server 15 a one-time PSK (and associated PSK_ID).</li></ul><!-- EPO <DP n="7"> --></p><p id="p0040" num="0040">These communications occur on the third secured channel 13 (<figref idrefs="f0001">fig.1</figref>).</p><p id="p0041" num="0041">The third step, referenced 23, consists in sending from the third party server 15 to its administrative agent 12 a triggering message including at least the one-time PSK and associated PSK_ID, using the secured proprietary channel 16 (<figref idrefs="f0001">fig. 1</figref>). This triggering message can be a conventional SMS containing the one-time PSK.</p><p id="p0042" num="0042">It is also possible to establish a voice communication with the admin agent 12 and to send from the third party server 15 the one-time PSK in the form of a speech signal.</p><p id="p0043" num="0043">The fourth step, referenced 24, consists in performing a TLS-PSK handshake between the administrative agent 12 and the distant server 13 with the received one-time PSK in order to establish the first secured communication channel (referenced 14 in <figref idrefs="f0001">figure 1</figref>). The TLS-PSK handshake is done in the same way it would have been done with an admin agent comprised in the secure element using the provided one-time PSK and PSK_ID.</p><p id="p0044" num="0044">After the TLS-PSK handshake, the first secured communication channel 14 is established and the distant server 13 can administrate the secure element 11 through the admin agent 12. This channel is secured and the secure element 11 to be administrated and the corresponding admin agent have been authenticated with a high security level.</p><p id="p0045" num="0045">The one-time PSK is a PSK that is valid only for establishing a unique communication channel (the one-time PSK changes at each request from the third party server 15 and is used for deriving the TLS session key).</p><p id="p0046" num="0046">TLS (Transport Layer Security) is a protocol used in Internet communication security. The TLS-PSK protocol is designed to implement TLS by using a pre-shared symmetric key, instead of using a public key certificate, and to avoid a complicated calculation necessary for an authentication process using a public key. The TLS and the TLS-PSK protocols are respectively defined in Request for Comments (RFC) 4346 and RFC 4279.</p><p id="p0047" num="0047">The distant server 13 and the third party server 15 can be a single entity.</p><p id="p0048" num="0048">In a preferred embodiment, the device 10 is a mobile terminal, like a mobile phone, a smartphone or a tablet for example.</p><p id="p0049" num="0049">The secure element 11 can be a UICC, a eUICC, an embedded secure element, a secure memory cards or a micro SD card.<!-- EPO <DP n="8"> --></p><p id="p0050" num="0050">In the scope of the invention, it is the third party server 15 that is at the origin of the establishment of the administration of the secure element 11 by the distant server 13. The trigger of the administration can be based on time or location of the device 10. The trigger of the administration can also be initiated by the Admin Agent to the third party server 15. For example, the third party server 15 can decide that an administration of the secure element 11 should happen when the device 10 is under Wifi coverage. This permits to lower the quantity of signals to be sent over the air since administration via Wifi is done in http (fixed phone lines). It is then not necessary that the device 10 be in data mode. It is also possible to decide, at the level of the distant server 13, that a communication with the secure element 11 has to be established (for example in the scope of a campaign), and to ask to the third party server 15 to request a one-time PSK. The admin agent 12 can also inform the third party server 15 that it is ready for establishing the first secure channel 14.</p><p id="p0051" num="0051">The distant server 13 is preferably an OTA server. It can also be a eUICC server as specified in GSMA eUICC document or any future ETSI/3GPP related specifications.</p><p id="p0052" num="0052">The invention also concerns a server 13 for administrating a secure element 11 comprised in a device 10, the device 10 comprising an administrative agent 12, the server 13 being able to administrate the secure element 11 through the administrative agent 12, this server comprising means for:
<ul><li>sending a one-time PSK to the third party server 15, at the request of this third party server 15;</li><li>performing a TLS-PSK handshake with the administrative agent 12, once the third party server 15 has sent to the administrative agent 12 the one-time PSK, in order to administrate the secure element 11.</li></ul></p><p id="p0053" num="0053">The invention also concerns such a third party server 15 connected to a distant server 13 able to administrate a secure element 11 comprised in a device 10 through an administrative agent 12 comprised in the device 10, the administrative agent 12 being administrated by the third party server 15 through a second secured channel 16, the distant server 13 and the third party server 15 being connected through a third secured channel 17, the third party server 15 comprising means for:
<ul><li>a- Requesting to the distant server 13, an operation on the secure element 11 and a one-time PSK;</li><li>b- Receiving from the distant server 13 the one-time PSK;<!-- EPO <DP n="9"> --></li><li>c- Sending to the administrative agent 12 a triggering message including the one-time PSK, in order to perform a TLS-PSK handshake between the administrative agent 12 and the distant server 13 with the one-time PSK, in order to establish a first secured communication channel 14 between the administrative agent 12 and the distant server 13.</li></ul></p><p id="p0054" num="0054">Finally, the invention also concerns a telecommunications system comprising:
<ul><li>a device 10 comprising a secure element 11 and an administrative agent 12, the secure element 11 communicating with the administrative agent 12;</li><li>a distant server 13 able to administrate the secure element 11 via the administrative agent 12 through a first secured communication channel 14,</li><li>a third party server 15 able to administrate the administrative agent 12 through a second secured communication channel 16, the distant server 13 and the third party server 15 being connected through a third secured channel 17, the system comprising means for:</li><li>Requesting, from the third party server 15 to the distant server 13, an operation on the secure element 11 and a one-time PSK;</li><li>Sending from the distant server 13 to the third party server 15 the one-time PSK;</li><li>Sending from the third party server 15 to the administrative agent 12 a triggering message including the one-time PSK;</li><li>Performing a TLS-PSK handshake between the administrative agent 12 and the distant server 13 with the one-time PSK in order to establish the first secured communication channel 14.</li></ul></p><p id="p0055" num="0055">The invention avoids having several authentication schemas being implemented in the distant server 13, avoids storing any credential from the distant server 13 on the admin agent 12 side, avoids any complex provisioning schema and provides a good level of authentication.</p></description><claims mxw-id="PCLM90459134" lang="EN" load-source="patent-office"><!-- EPO <DP n="10"> --><claim id="c-en-0001" num="0001"><claim-text>Method for establishing a first secured communication channel (14) between an administrative agent (12) comprised in a device (10) and a distant server (13), said device (10) comprising a secure element (11) communicating with said administrative agent (12), said secure element (11) being administrated through said administrative agent (12) by said distant server (13), said administrative agent (12) being administrated by a third party server (15) through a second secured communication channel (16), said distant server (13) and said third party server (15) being connected through a third secured channel (17), said method consisting in:
<claim-text>a- Requesting, from said third party server (15) to said distant server (13), an operation on said secure element (11) and a one-time PSK;</claim-text>
<claim-text>b- Sending from said distant server (13) to said third party server (15) said one-time PSK;</claim-text>
<claim-text>c- Sending from said third party server (15) to said administrative agent (12) a triggering message including said one-time PSK;</claim-text>
<claim-text>d- Performing a TLS-PSK handshake between said administrative agent (12) and said distant server (13) with said one-time PSK in order to establish said first secured communication channel (14).</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>Method according to claim 1, wherein said device (10) is a mobile terminal.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>Method according to any of the claims 1 and 2, wherein said secure element (11) is a UICC, a eUICC, an embedded secure element (11), a secure memory card or a micro SD card.</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>Method according to any of the claims 1 to 3, wherein step -a- is performed when said device (10) is under Wifi coverage.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>Method according to any of the claims 1 to 4, wherein said distant server (13) is an OTA server or a server specified in the GSMA eUICC specification.</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>Server (13) for administrating a secure element (11) comprised in a device (10), said device (10) comprising an administrative agent (12), said server (13) being<!-- EPO <DP n="11"> --> able to administrate said secure element (11) through said administrative agent (12), wherein said server (13) comprises means for:
<claim-text>- sending a one-time PSK to a third party server (15), at the request of said third party server (15);</claim-text>
<claim-text>- performing a TLS-PSK handshake with said administrative agent (12), once said third party server (15) has sent to said administrative agent (12) said one-time PSK, in order to administrate said secure element (11).</claim-text></claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>Third party server (15) connected to a distant server (13) able to administrate a secure element (11) comprised in a device (10) through an administrative agent (12) comprised in said device (10), said administrative agent (12) being administrated by said third party server (15) through a second secured channel (16), said distant server (13) and said third party server (15) being connected through a third secured channel (17), said third party server (15) comprising means for:
<claim-text>a- Requesting to said distant server (13), an operation on said secure element (11) and a one-time PSK;</claim-text>
<claim-text>b- Receiving from said distant server (13) said one-time PSK;</claim-text>
<claim-text>c- Sending to said administrative agent (12) a triggering message including said one-time PSK, in order to perform a TLS-PSK handshake between said administrative agent (12) and said distant server (13) with said one-time PSK, in order to establish a first secured communication channel (14) between said administrative agent (12) and said distant server (13).</claim-text></claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>Telecommunications system comprising:
<claim-text>- a device (10) comprising a secure element (11) and an administrative agent (12), said secure element (11) communicating with said administrative agent (12);</claim-text>
<claim-text>- a distant server (13) able to administrate said secure element (11) via said administrative agent (12) through a first secured communication channel (14),</claim-text>
<claim-text>- a third party server (15) able to administrate said administrative agent (12) through a second secured communication channel (16), said distant server (13) and said third party server (15) being connected through a third secured channel (17), said system comprising means for:</claim-text>
<claim-text>- Requesting, from said third party server (15) to said distant server (13), an operation on said secure element (11) and a one-time PSK;<!-- EPO <DP n="12"> --></claim-text>
<claim-text>- Sending from said distant server (13) to said third party server (15) said one-time PSK;</claim-text>
<claim-text>- Sending from said third party server (15) to said administrative agent (12) a triggering message including said one-time PSK;</claim-text>
<claim-text>- Performing a TLS-PSK handshake between said administrative agent (12) and said distant server (13) with said one-time PSK in order to establish said first secured communication channel (14).</claim-text></claim-text></claim></claims><drawings mxw-id="PDW20421872" load-source="patent-office"><!-- EPO <DP n="13"> --><figure id="f0001" num="1,2"><img id="if0001" file="imgf0001.tif" wi="165" he="178" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="157" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="157" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
