<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2960808-A1" country="EP" doc-number="2960808" kind="A1" date="20151230" family-id="51390781" file-reference-id="280346" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160451469" ucid="EP-2960808-A1"><document-id><country>EP</country><doc-number>2960808</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-13875718-A" is-representative="YES"><document-id mxw-id="PAPP193865906" load-source="patent-office" format="original"><country>EP</country><doc-number>13875718.2</doc-number><date>20130225</date><lang>JA</lang></document-id><document-id mxw-id="PAPP193865907" load-source="docdb" format="epo"><country>EP</country><doc-number>13875718</doc-number><kind>A</kind><date>20130225</date><lang>JA</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162030217" ucid="JP-2013054735-W" linkage-type="A" load-source="docdb"><document-id format="epo"><country>JP</country><doc-number>2013054735</doc-number><kind>W</kind><date>20130225</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1892463413" load-source="docdb">G09C   1/00        20060101ALI20160920BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1892463585" load-source="docdb">G06F  17/30        20060101AFI20160920BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1892465724" load-source="docdb">G06F  21/60        20130101ALI20160920BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1892466554" load-source="docdb">H04L   9/30        20060101ALI20160920BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1892469140" load-source="docdb">G06F  21/62        20130101ALI20160920BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1852723023" load-source="docdb" scheme="CPC">G06F  21/6245      20130101 LI20170201BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1897317933" load-source="docdb" scheme="CPC">G09C   1/00        20130101 LI20160913BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1897317934" load-source="docdb" scheme="CPC">H04L   9/30        20130101 LI20160913BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984703001" load-source="docdb" scheme="CPC">G06F  21/62        20130101 LI20160106BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984703956" load-source="docdb" scheme="CPC">G06F  21/72        20130101 FI20151224BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165545873" lang="DE" load-source="patent-office">SERVERVORRICHTUNG, PRIVATES SUCHPROGRAMM, AUFZEICHNUNGSMEDIUM UND PRIVATES SUCHSYSTEM</invention-title><invention-title mxw-id="PT165545874" lang="EN" load-source="patent-office">SERVER DEVICE, PRIVATE SEARCH PROGRAM, RECORDING MEDIUM, AND PRIVATE SEARCH SYSTEM</invention-title><invention-title mxw-id="PT165545875" lang="FR" load-source="patent-office">DISPOSITIF SERVEUR, PROGRAMME DE RECHERCHE PRIVÉE, SUPPORT D'ENREGISTREMENT ET SYSTÈME DE RECHERCHE PRIVÉE</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR1103325407" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>MITSUBISHI ELECTRIC CORP</last-name><address><country>JP</country></address></addressbook></applicant><applicant mxw-id="PPAR1103314895" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>MITSUBISHI ELECTRIC CORPORATION</last-name></addressbook></applicant><applicant mxw-id="PPAR1101649070" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Mitsubishi Electric Corporation</last-name><iid>101323123</iid><address><street>7-3 Marunouchi 2-chome Chiyoda-ku</street><city>Tokyo 100-8310</city><country>JP</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103335771" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ITO TAKASHI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103302688" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>ITO, TAKASHI</last-name></addressbook></inventor><inventor mxw-id="PPAR1101649617" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>ITO, TAKASHI</last-name><address><street>c/o Mitsubishi Electric Corporation 7-3 Marunouchi 2-chome Chiyoda-ku</street><city>Tokyo 100-8310</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103307760" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>MATSUDA NORI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103323138" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>MATSUDA, NORI</last-name></addressbook></inventor><inventor mxw-id="PPAR1101647703" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>MATSUDA, NORI</last-name><address><street>c/o Mitsubishi Electric Corporation 7-3 Marunouchi 2-chome Chiyoda-ku</street><city>Tokyo 100-8310</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103320581" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>HATTORI MITSUHIRO</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103303019" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>HATTORI, MITSUHIRO</last-name></addressbook></inventor><inventor mxw-id="PPAR1101642710" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>HATTORI, MITSUHIRO</last-name><address><street>c/o Mitsubishi Electric Corporation 7-3 Marunouchi 2-chome Chiyoda-ku</street><city>Tokyo 100-8310</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103315324" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>MORI TAKUMI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103338898" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>MORI, TAKUMI</last-name></addressbook></inventor><inventor mxw-id="PPAR1101651034" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>MORI, TAKUMI</last-name><address><street>c/o Mitsubishi Electric Corporation 7-3 Marunouchi 2-chome Chiyoda-ku</street><city>Tokyo 100-8310</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103319010" load-source="docdb" sequence="5" format="epo"><addressbook><last-name>HIRANO TAKATO</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103344355" load-source="docdb" sequence="5" format="intermediate"><addressbook><last-name>HIRANO, Takato</last-name></addressbook></inventor><inventor mxw-id="PPAR1101642969" load-source="patent-office" sequence="5" format="original"><addressbook><last-name>HIRANO, Takato</last-name><address><street>c/o Mitsubishi Electric Corporation 7-3 Marunouchi 2-chome Chiyoda-ku</street><city>Tokyo 100-8310</city><country>JP</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR1101650786" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Pfenning, Meinig &amp; Partner GbR</last-name><iid>100060642</iid><address><street>Patent- und Rechtsanwälte Theresienhöhe 11a</street><city>80339 München</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="JP-2013054735-W"><document-id><country>JP</country><doc-number>2013054735</doc-number><kind>W</kind><date>20130225</date><lang>JA</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2014128958-A1"><document-id><country>WO</country><doc-number>2014128958</doc-number><kind>A1</kind><date>20140828</date><lang>JA</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS660685481" load-source="docdb">AL</country><country mxw-id="DS660606560" load-source="docdb">AT</country><country mxw-id="DS660685491" load-source="docdb">BE</country><country mxw-id="DS660690377" load-source="docdb">BG</country><country mxw-id="DS660685091" load-source="docdb">CH</country><country mxw-id="DS660783465" load-source="docdb">CY</country><country mxw-id="DS660606561" load-source="docdb">CZ</country><country mxw-id="DS660687763" load-source="docdb">DE</country><country mxw-id="DS660783466" load-source="docdb">DK</country><country mxw-id="DS660783467" load-source="docdb">EE</country><country mxw-id="DS660610622" load-source="docdb">ES</country><country mxw-id="DS660690378" load-source="docdb">FI</country><country mxw-id="DS660690383" load-source="docdb">FR</country><country mxw-id="DS660685492" load-source="docdb">GB</country><country mxw-id="DS660685493" load-source="docdb">GR</country><country mxw-id="DS660685494" load-source="docdb">HR</country><country mxw-id="DS660606562" load-source="docdb">HU</country><country mxw-id="DS660685092" load-source="docdb">IE</country><country mxw-id="DS660685503" load-source="docdb">IS</country><country mxw-id="DS660690384" load-source="docdb">IT</country><country mxw-id="DS660783468" load-source="docdb">LI</country><country mxw-id="DS660687764" load-source="docdb">LT</country><country mxw-id="DS660606563" load-source="docdb">LU</country><country mxw-id="DS660687765" load-source="docdb">LV</country><country mxw-id="DS660687766" load-source="docdb">MC</country><country mxw-id="DS660610512" load-source="docdb">MK</country><country mxw-id="DS660610513" load-source="docdb">MT</country><country mxw-id="DS660610635" load-source="docdb">NL</country><country mxw-id="DS660690385" load-source="docdb">NO</country><country mxw-id="DS660610636" load-source="docdb">PL</country><country mxw-id="DS660685093" load-source="docdb">PT</country><country mxw-id="DS660610637" load-source="docdb">RO</country><country mxw-id="DS660685094" load-source="docdb">RS</country><country mxw-id="DS660610638" load-source="docdb">SE</country><country mxw-id="DS660685099" load-source="docdb">SI</country><country mxw-id="DS660610514" load-source="docdb">SK</country><country mxw-id="DS660610519" load-source="docdb">SM</country><country mxw-id="DS660783469" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA166479839" lang="EN" load-source="patent-office"><p id="pa01" num="0001">A server device 201 comprises a communication part 231, a search history storage region 213, a data storage part 210, and a checking part 220. The communication part receives a set of a trapdoor and a deterministic encrypted keyword from a search device 401. The search history storage region 213 stores the set of the trapdoor and the deterministic encrypted keyword. The data storage part 210 stores keyword information in which search target data and an encrypted keyword are associated with each other. If the deterministic encrypted keyword is obvious, a deterministic encrypted keyword corresponding to the encrypted keyword is additionally associated with the search target data and the encrypted keyword in the keyword information. The checking part 220 checks whether or not a deterministic encrypted keyword which matches the received deterministic encrypted keyword exists in the search history storage region 213. If the deterministic encrypted keyword exists, the checking part 220 executes a concealed search targeting the data storage part 210, based on a deterministic encryption scheme using the deterministic encrypted keyword existing in the search history storage region 213. If the deterministic encrypted keyword does not exist, the checking part 220 executes the concealed search targeting the data storage part 210, based on a probabilistic encryption scheme using the received trapdoor and the encrypted keyword stored in the data storage part 210.<img id="iaf01" file="imgaf001.tif" wi="76" he="100" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA166759651" lang="EN" source="EPO" load-source="docdb"><p>A server device 201 comprises a communication part 231, a search history storage region 213, a data storage part 210, and a checking part 220. The communication part receives a set of a trapdoor and a deterministic encrypted keyword from a search device 401. The search history storage region 213 stores the set of the trapdoor and the deterministic encrypted keyword. The data storage part 210 stores keyword information in which search target data and an encrypted keyword are associated with each other. If the deterministic encrypted keyword is obvious, a deterministic encrypted keyword corresponding to the encrypted keyword is additionally associated with the search target data and the encrypted keyword in the keyword information. The checking part 220 checks whether or not a deterministic encrypted keyword which matches the received deterministic encrypted keyword exists in the search history storage region 213. If the deterministic encrypted keyword exists, the checking part 220 executes a concealed search targeting the data storage part 210, based on a deterministic encryption scheme using the deterministic encrypted keyword existing in the search history storage region 213. If the deterministic encrypted keyword does not exist, the checking part 220 executes the concealed search targeting the data storage part 210, based on a probabilistic encryption scheme using the received trapdoor and the encrypted keyword stored in the data storage part 210.</p></abstract><description mxw-id="PDES98404540" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><b>Technical Field</b></heading><p id="p0001" num="0001">The present invention relates to a server device which conducts a concealed search, a concealed search program, a recording medium, and a concealed search system.</p><heading id="h0002"><b>Background Art</b></heading><p id="p0002" num="0002">In the concealed search system, a searcher can search data saved in a server, by specifying a keyword. In the search, the data and keyword are concealed from the server. The concealed search system is expected to be applied to the outsourcing of confidential data management and the filtering of encrypted mail in a mail server. Various techniques have been proposed for the concealed search system such as a technique to achieve different types of security requirements as well as techniques to reduce the server storage, a searcher storage, communication overhead, and computation overhead.</p><p id="p0003" num="0003">The concealed search can be roughly classified into those that are based on deterministic encryption and those that are based on probabilistic encryption. The concealed search based on deterministic encryption is advantageous because, since the same keyword corresponds to the same encrypted keyword, the server only needs to conduct a binary matching check based on a specified encrypted keyword, enabling high-speed concealed search employing an existing search technique. The keyword frequency information, however, directly appears as the encrypted keyword frequency<!-- EPO <DP n="2"> --> information. This leads to a defect that an attack called "frequency analysis" is possible in which the server estimates a corresponding keyword by examining the encrypted keyword frequency.</p><p id="p0004" num="0004">On the other hand, in the concealed search based on probabilistic encryption, since different encrypted keywords are generated from the same keyword, the keyword frequency information is not saved, and the system is not exposed to the frequency analysis attack described above. Instead, collation of the encrypted keyword and a search request (trapdoor) requires particular computation that is not a binary matching check. Also, the high-speed technique employed in ordinary search cannot be employed. Therefore, there is a problem that a lot of time is spent until the search is completed. As a countermeasure for this problem, a method is available that employs probabilistic encryption and deterministic encryption so that both the security of the probabilistic encryption and the high speed performance of the deterministic encryption are achieved.</p><p id="p0005" num="0005">Patent Literature 1 discloses a method of searching the value of a probabilistic encryption at a high speed by preparing a table that stores the value of the probabilistic encryption and a table that stores the value of the deterministic encryption and utilizing a table that holds an encrypted relation between the two tables.</p><heading id="h0003"><b>Citation List</b></heading><heading id="h0004"><b>Patent Literature</b></heading><p id="p0006" num="0006">Patent Literature 1: <patcit id="pcit0001" dnum="JP2011198079A"><text>JP 2011-198079</text></patcit></p><heading id="h0005"><b>Summary of Invention</b></heading><heading id="h0006"><b>Technical Problem</b></heading><p id="p0007" num="0007">According to the method of Patent Literature 1, in a data registration process, both the value of a probabilistic encryption and the value of a deterministic encryption<!-- EPO <DP n="3"> --> are transmitted to a server. Information concerning the correspondence of the two values is encrypted in a later process. Therefore, if data leaks to an external attacker, the attacker cannot associate the value of the probabilistic encryption and the value of the deterministic encryption, so that the security of the data is maintained to the same level as with the probabilistic encryption. Meanwhile, the server itself can associate the value of the probabilistic encryption and the value of the deterministic encryption at the time of the data registration process. If the server is malicious, it can make a frequency analysis attack using the information on the correspondence of the two values. Then, the security against the server decreases to the same level as with the deterministic encryption.</p><p id="p0008" num="0008">The present invention has been made to solve the above problem, and has as its object to increase the search speed of the concealed search system as a whole by adopting the element of deterministic encryption, without the risk of decreasing the security against the server from the level of concealed search based on the probabilistic encryption.</p><heading id="h0007"><b>Solution to Problem</b></heading><p id="p0009" num="0009">A server device according to the present invention executes a concealed search and includes:
<ul><li>a server-side communication part that receives a set of a trapdoor and a deterministic encrypted keyword, as a concealed search request from a search device, the trapdoor being generated from a keyword in accordance with a probabilistic encryption scheme and used for a matching check with an encrypted keyword obtained by encrypting a keyword of search target data in the concealed search in accordance with the probabilistic encryption scheme, the deterministic encrypted keyword being generated from the keyword from which the trapdoor has been generated, in accordance<!-- EPO <DP n="4"> --> with a deterministic encryption scheme;</li><li>a search history storage part that stores the set of the trapdoor and the deterministic encrypted keyword, as a history of a past concealed search request, the set being received by the server-side communication part;</li><li>a data storage part that stores keyword information in which the search target data and the encrypted keyword of the search target data are associated with each other, wherein if the deterministic encrypted keyword is obvious, the deterministic encrypted keyword corresponding to the encrypted keyword is further associated with the search target data and the encrypted keyword of the search target data in the keyword information; and</li><li>a checking part that checks whether or not the deterministic encrypted keyword which matches the deterministic encrypted keyword received by the server-side communication part exists in the search history storage part; and if it is decided that the deterministic encrypted keyword exists, executes the concealed search of the search target data targeting the data storage part, based on the deterministic encryption scheme using the deterministic encrypted keyword existing in the search history storage part, and if it is decided that the deterministic encrypted keyword does not exist, executes the concealed search of the search target data targeting the data storage part, based on the probabilistic encryption scheme using the trapdoor received and the encrypted keyword of the keyword information stored in the data storage part.</li></ul></p><heading id="h0008"><b>Advantageous Effects of Invention</b></heading><p id="p0010" num="0010">According to the present invention, the search speed of the concealed search system as a whole can be increased without the risk of decreasing the security against the server from the level of concealed search based on the probabilistic encryption.</p><heading id="h0009"><b>Brief Description of Drawings</b></heading><!-- EPO <DP n="5"> --><p id="p0011" num="0011"><ul><li><figref idrefs="f0001">Fig. 1</figref> is a diagram illustrating a configuration of a concealed search system 100 according to Embodiment 1.</li><li><figref idrefs="f0002">Fig. 2</figref> is a block diagram of a server device 201 according to Embodiment 1.</li><li><figref idrefs="f0003">Fig. 3</figref> is a block diagram of a registration device 301 according to Embodiment 1.</li><li><figref idrefs="f0003">Fig. 4</figref> is a block diagram of a search device 401 according to Embodiment 1.</li><li><figref idrefs="f0004">Fig. 5</figref> is an illustration representing an encrypted keyword storage region 211 according to Embodiment 1.</li><li><figref idrefs="f0004">Fig. 6</figref> is an illustration representing a data storage region 212 according to Embodiment 1.</li><li><figref idrefs="f0005">Fig. 7</figref> is an illustration representing a search history storage region 213 according to Embodiment 1.</li><li><figref idrefs="f0005">Fig. 8</figref> is an illustration representing the encrypted keyword storage region 211 according to Embodiment 1.</li><li><figref idrefs="f0006">Fig. 9</figref> is an illustration representing the data storage region 212 according to Embodiment 1.</li><li><figref idrefs="f0006">Fig. 10</figref> is an illustration representing the encrypted keyword storage region 211 according to Embodiment 1.</li><li><figref idrefs="f0007">Fig. 11</figref> is an illustration representing the data storage region 212 according to Embodiment 1.</li><li><figref idrefs="f0007">Fig. 12</figref> is an illustration representing the search history storage region 213 according to Embodiment 1.</li><li><figref idrefs="f0008">Fig. 13</figref> is an illustration representing the encrypted keyword storage region 211 according to Embodiment 1.</li><li><figref idrefs="f0008">Fig. 14</figref> is an illustration representing the encrypted keyword storage region<!-- EPO <DP n="6"> --> 211 according to Embodiment 1.</li><li><figref idrefs="f0009">Fig. 15</figref> is an illustration representing the search history storage region 213 according to Embodiment 1.</li><li><figref idrefs="f0009">Fig. 16</figref> is an illustration representing the encrypted keyword storage region 211 according to Embodiment 1.</li><li><figref idrefs="f0010">Fig. 17</figref> is an illustration representing the search history storage region 213 according to Embodiment 1.</li><li><figref idrefs="f0010">Fig. 18</figref> is an illustration representing a storage region having a combined content of the encrypted keyword storage region 211 and data storage region 212 according to Embodiment 1.</li><li><figref idrefs="f0011">Fig. 19</figref> is an illustration representing the encrypted keyword storage region 211 according to Embodiment 1.</li><li><figref idrefs="f0011">Fig. 20</figref> is an illustration representing the encrypted keyword storage region 211 according to Embodiment 1.</li><li><figref idrefs="f0012">Fig. 21</figref> is a flowchart indicating the initial setting of the server device 201, registration device 301, and search device 401 according to Embodiment 1.</li><li><figref idrefs="f0013">Fig. 22</figref> is a flowchart indicating the transmission process of the information registration device 301 according to Embodiment 1.</li><li><figref idrefs="f0014">Fig. 23</figref> is a flowchart indicating the registration process of the server device 201 according to Embodiment 1.</li><li><figref idrefs="f0015">Fig. 24</figref> is a flowchart indicating a search request transmission process of the search device 401 according to Embodiment 1.</li><li><figref idrefs="f0016">Fig. 25</figref> is a flowchart indicating concealed search of the search device 401 according to Embodiment 1.</li><li><figref idrefs="f0017">Fig. 26</figref> is an illustration of an example of the appearance of a server device<!-- EPO <DP n="7"> --> 201 or the like according to Embodiment 2.</li><li><figref idrefs="f0018">Fig. 27</figref> is a diagram illustrating the hardware configuration of the server device 201 or the like according to Embodiment 2.</li></ul></p><heading id="h0010"><b>Description of Embodiments</b></heading><heading id="h0011">Embodiment 1.</heading><p id="p0012" num="0012">Embodiment 1 will be described with reference to <figref idrefs="f0001 f0002 f0003 f0004 f0005 f0006 f0007 f0008 f0009 f0010 f0011 f0012 f0013 f0014 f0015 f0016">Figs. 1 to 25</figref>.</p><p id="p0013" num="0013"><figref idrefs="f0001 f0002 f0003">Figs. 1 to 4</figref> are diagrams illustrating the configurations of a concealed search system 100 and other devices.</p><p id="p0014" num="0014"><figref idrefs="f0004 f0005 f0006 f0007 f0008 f0009 f0010 f0011">Figs. 5 to 20</figref> are illustrations representing the statuses of storage regions.</p><p id="p0015" num="0015"><figref idrefs="f0012 f0013 f0014 f0015 f0016">Figs. 21 to 25</figref> are flowcharts indicating the operations of the devices. Where a constituent element is indicated in parentheses, the constituent element is the subject of the process.</p><p id="p0016" num="0016"><figref idrefs="f0001">Fig. 1</figref> illustrates a configuration example of the concealed search system 100. In the concealed search system 100, the user can search data (search target data) saved in a server device 201, by specifying a keyword. In the search, the concealed search system 100 conceals the data and the keyword from the server device 201. The concealed search system 100 includes the server device 201, an information registration device 301, and an information search device 401. The server device 201, the information registration device 301, and the information search device 401 are connected to a network 101 and communicate with each other via the network 101. The information registration device 301 and the information search device 401 will be respectively referred to as the registration device 301 and the search device 401 hereinafter.</p><p id="p0017" num="0017"><figref idrefs="f0002">Fig. 2</figref> is a block diagram illustrating a configuration example of the server device 201, in the concealed search system 100, where the data and keyword are held<!-- EPO <DP n="8"> --> and searched for. The constituent elements of each device illustrated in <figref idrefs="f0002">Fig. 2</figref> will be described below.
<ol><li>(1) An encrypted keyword storage region 211 associates a keyword (to be referred to as encrypted keyword hereinafter) encrypted by probabilistic encryption and a keyword (to be referred to as deterministic encrypted keyword hereinafter) encrypted by deterministic encryption with corresponding data IDs, and stores the associated encrypted keyword and deterministic encrypted keyword.<br/>
<figref idrefs="f0004">Fig. 5</figref> represents an example of the data stored in the encrypted keyword storage region 211.</li><li>(2) A data storage region 212 associates the data with the corresponding data ID and stores the associated data.<br/>
<figref idrefs="f0004">Fig. 6</figref> represents an example of the data stored in the data storage region 212. Examples of the data include a numerical value such as age, an attribute such as sex, a character string such as name, and a file such as a document. A plurality of types of data may be held for one data ID. The encrypted keyword storage region 211 and the data storage region 212 constitute a data storage part 210. As will be described later in S201 of <figref idrefs="f0014">Fig. 23</figref>, in the encrypted keyword storage region 211 and the data storage region 212, the encrypted keyword and the data are associated through a data ID. For example, in <figref idrefs="f0004">Figs. 5 and 6</figref>, an encrypted keyword (c<sub>1</sub>) and data (d<sub>1</sub>) are associated with each other through a data ID (id<sub>1</sub>). If an associated deterministic encrypted keyword (det) is obvious, the obvious deterministic encrypted keyword (det) is associated with an encrypted keyword (c) and data (d). Information that holds this relation is called keyword information. The keyword information may be realized by the encrypted keyword storage region 211 and the data storage region 212, or by a content to be described later with reference to <figref idrefs="f0010">Fig. 18</figref>.<!-- EPO <DP n="9"> --></li><li>(3) A search history storage region 213 (search history storage part) stores a past search request sent from the search device 401, as a search history.<br/>
<figref idrefs="f0005">Fig. 7</figref> represents an example of data stored in the search history storage region 213.</li><li>(4) A cache policy storage region 214 stores a policy on whether or not to store the search request sent from the search device 401 and the result of a search process, to the search history storage region 213 and encrypted keyword storage region 211.<br/>
Examples of the policy include:
<ul><li>to cache all search requests and all search results;</li><li>to cache the search request and search result only when specified by the searcher;</li><li>to cache all search requests and to cache the search results of a search request executed n times or more; and</li><li>to cache a deterministic encrypted keyword in the search request, and all search results.</li></ul></li><li>(5) A probabilistic encryption collation part 221 checks whether or not keywords match between a trapdoor included in the search request sent from the search device 401 and the encrypted keyword (by probabilistic encryption) stored by the encrypted keyword storage region 211. The probabilistic encryption collation part 221 also conducts a keyword matching check between the trapdoor stored in the search history storage region 213 and an encrypted keyword sent from the registration device 301. These processes can be realized using an existing cryptographic technology (concealed search technique based on probabilistic encryption).</li><li>(6) A deterministic encryption collation part 222 checks whether or not keywords match between a deterministic encrypted keyword included in the search<!-- EPO <DP n="10"> --> request transmitted by the search device 401 and a deterministic encrypted keyword stored in the encrypted keyword storage region 211. This process can be realized using a binary matching check. The probabilistic encryption collation part 221 and the deterministic encryption collation part 222 constitute a checking part 220.</li><li>(7) Based on the content of the cache policy storage region 214, a cache processing part 223 stores the search request sent from the search device 401 and the result of the search process to the search history storage region 213 and the encrypted keyword storage region 211.</li><li>(8) A registration part 224 stores the encrypted keyword, encrypted data, and the like received from the registration device 301, to the encrypted keyword storage region 211 and the data storage region 212.</li><li>(9) A communication part 231 (server-side communication part) communicates with the registration device 301 and the search device 401.</li></ol></p><p id="p0018" num="0018"><figref idrefs="f0003">Fig. 3</figref> is a block diagram illustrating a configuration example of the registration device 301 in the concealed search system 100, which registers the encrypted data (search target data) to the server device 201.
<ol><li>(1) Referring to <figref idrefs="f0003">Fig. 3</figref>, the registration cipher key storage region 311 stores cipher keys used for data encryption and encrypted keyword generation in data registration.</li><li>(2) A data encryption processing part 321 encrypts the data using a data encryption key stored in the registration cipher key storage region 311. This process can be realized using an existing cryptographic technology (for example, public key cryptography) such as RSA (registered trademark).</li><li>(3) Using an encrypted keyword generation key stored in the registration cipher key storage region 311, an encrypted keyword generating part 322 generates an<!-- EPO <DP n="11"> --> encrypted keyword for concealed search, from a keyword. This process can be realized using an existing cryptographic technology (concealed search technique based on probabilistic encryption).</li><li>(4) A communication part 331 communicates with the server device 201.</li></ol></p><p id="p0019" num="0019"><figref idrefs="f0003">Fig. 4</figref> is a block diagram illustrating a configuration example of the search device 401 in the concealed search system 100, which requests the server device 201 to search encrypted data.
<ol><li>(1) Referring to <figref idrefs="f0003">Fig. 4</figref>, a search cipher key storage region 411 stores private information used for trapdoor generation in data search, deterministic encrypted keyword generation in data search, and data decryption in data search.</li><li>(2) A data decryption processing part 421 decrypts the data using a data decryption key stored in the search cipher key storage region 411. This process can be realized using an existing cryptographic technology (for example, public key cryptography such as RSA (registered trademark)).</li><li>(3) A trapdoor generating part 422 generates a search request (trapdoor) for concealed search from the keyword using a trapdoor generation key stored in the search cipher key storage region 411. This process can be realized using an existing cryptographic technology (concealed search technique based on probabilistic encryption).</li><li>(4) A deterministic encrypted keyword generating part 423 generates a deterministic encrypted keyword from the keyword using a deterministic encrypted keyword generation key stored in the search cipher key storage region 411. This process can be realized using an existing cryptographic technology (common key cryptography such as AES).</li><li>(5) A communication part 431 (search-side transmission part)<!-- EPO <DP n="12"> --> communicates with the server device 201.</li></ol></p><p id="p0020" num="0020">The procedures in the concealed search system 100 are roughly classified into
<ol><li>(A) a portion where initial setting of each device is carried out,</li><li>(B) a portion where the registration device 301 transmits and stores the search target data to the server device 201, and</li><li>(C) a portion where the search device 401 searches for data on the server device 201 and acquires the data. Each procedure will be described below.</li></ol></p><heading id="h0012">(A. Initial Device Setting)</heading><p id="p0021" num="0021"><figref idrefs="f0012">Fig. 21</figref> indicates initial setting of the server device 201 and the like. As shown in <figref idrefs="f0012">Fig. 21</figref>, the server device 201 stores the cache policy to the cache policy storage region 214. The cache policy is, for example, a policy on "whether or not to store the search request sent from the search device 401 and the result of a search process to the search history storage region 213 and the encrypted keyword storage region 211". The cache policy may be decided by the administrator of a company or the like that utilizes the search device 401 and the concealed search system 100, and sent to the server device 201 by the administrator. Alternatively, the cache policy may be decided by the server device 201 itself. In the following description, the cache policy is "to cache all search requests and search results".</p><p id="p0022" num="0022">As indicated in <figref idrefs="f0012">Fig. 21</figref>, the search device 401 stores the private information to be used for data decryption, trapdoor generation, and deterministic encrypted keyword generation, to the search cipher key storage region 411. The private information may be generated by the data decryption processing part 421, trapdoor generating part 422, and deterministic encrypted keyword generating part 423 themselves. Alternatively, private information appropriately generated by an external device may be acquired. If the private information for data decryption and trapdoor generation is to be generated by<!-- EPO <DP n="13"> --> the search device 401 itself, corresponding cipher keys for data encryption and encrypted keyword generation may be open to the public or sent to the registration device 301.</p><p id="p0023" num="0023">As indicated in <figref idrefs="f0012">Fig. 21</figref>, the registration device 301 stores the cipher keys to be used for data encryption and encrypted keyword generation to the registration cipher key storage region 311. Usually, in order that the right search device 401 can perform search/decryption process correctly, the registration device 301 acquires cipher keys corresponding to the private information stored in the search cipher key storage region 411 of the search device 401, and stores the acquired cipher keys. The procedure is now completed.</p><heading id="h0013">(B. Transmission and Storage of Search Target Data)</heading><p id="p0024" num="0024">When the registration device 301 transmits data to the server device 201, the registration device 301 transmits encrypted keyword and encrypted data separately so that the search device 401 can perform concealed search later on. The server device 201 that has received the encrypted keyword and encrypted data stores the encrypted keyword and encrypted data to the encrypted keyword storage region 211 and the data storage region 212 by referring to the search history storage region 213 as required. This procedure will be described below step by step together with a practical example.</p><p id="p0025" num="0025"><figref idrefs="f0013">Fig. 22</figref> is a flowchart of the transmission process of the registration device 301. The process of transmitting data to the server device 201 by the registration device 301 will be described with reference to <figref idrefs="f0013">Fig. 22</figref>.
<ol><li>(1) First, in S101, the data encryption processing part 321 of the registration device 301 assigns a unique data ID (id<sub>x</sub>) to the data.</li><li>(2) Then, in S102, the data encryption processing part 321 encrypts the data using data encryption key stored in the registration cipher key storage region 311. An<!-- EPO <DP n="14"> --> existing cryptographic technology that allows only the right search device 401 to decrypt is utilized (the encrypted data is denoted as d<sub>x</sub>).</li><li>(3) After that, in S103, the encrypted keyword generating part 322 encrypts the keyword associated with the data, using the encrypted keyword generation key stored in the registration cipher key storage region 311. In this case, an existing cryptographic technology (concealed search technique based on probabilistic encryption) that allows only the right search device 401 to search is utilized (the encrypted keyword is denoted as c<sub>x</sub>).</li><li>(4) Then, in S104, the communication part 331 transmits a set (id<sub>x</sub>, c<sub>x</sub>, d<sub>x</sub>) of the data ID, encrypted keyword, and encrypted data to the server device 201.</li></ol></p><heading id="h0014">(Server Device 201)</heading><p id="p0026" num="0026"><figref idrefs="f0014">Fig. 23</figref> is a flowchart of a data registration process of the server device 201. The data registration process by the server device 201 will be described with reference to <figref idrefs="f0014">Fig. 23</figref>.
<ol><li>(1) When the communication part 231 receives (id<sub>x</sub>, c<sub>x</sub>, d<sub>x</sub>) from the registration device 301, the registration part 224 associates the encrypted keyword (c<sub>x</sub>) with the data ID (id<sub>x</sub>) and stores the associated encryption keyword (c<sub>x</sub>) and data ID (id<sub>x</sub>) to the keyword storage region 211, and associates the encrypted data (d<sub>x</sub>) with the data ID (id<sub>x</sub>) and stores the associated encrypted data (d<sub>x</sub>) and data ID (id<sub>x</sub>) to the data storage region 212. (S201). Namely, the registration part 224 associates the data and stores the associated data like (c<sub>x</sub>, id<sub>x</sub>), (d<sub>x</sub>, id<sub>x</sub>). For example, assume that the contents of the encrypted keyword storage region 211 and data storage region 212 before this procedure are as in <figref idrefs="f0005">Figs. 8</figref> and <figref idrefs="f0006">9</figref>. In this case, when the server device 201 receives (id<sub>6</sub>, c<sub>6</sub>, d<sub>6</sub>) and processes (id<sub>6</sub>, c<sub>6</sub>, d<sub>6</sub>), the contents of the encrypted keyword storage region 211 and data storage region 212 are updated as in <figref idrefs="f0006">Figs. 10</figref> and <figref idrefs="f0007">11</figref>, respectively.<!-- EPO <DP n="15"> --></li><li>(2) In S202, the probabilistic encryption collation part 221 checks whether or not a trapdoor exists in the search history storage region 213. The "trapdoor" is information that is transmitted from the search device 401 to the server device 201 as a concealed search request. The trapdoor will be described later referring to S301 of <figref idrefs="f0015">Fig. 24</figref>. If a trapdoor exists (YES in S202), the probabilistic encryption collation part 221 performs a collation process using the trapdoor (if a trapdoor does not exist, this process is skipped).</li><li>(3) If a trapdoor exists, then in S203, the probabilistic encryption collation part 221 executes a matching check (executes a collation process) on whether or not the keywords match between each trapdoor (td<sub>i</sub>) stored in the search history storage region 213 and the received encrypted keyword (c<sub>x</sub>).</li><li>(4) In S204, the probabilistic encryption collation part 221 checks whether or not a trapdoor with a matching keyword exists among the trapdoors (td<sub>i</sub>) in the search history storage region 213. If a trapdoor with a matching keyword exists (this trapdoor will be denoted as td<sub>y</sub>), the probabilistic encryption collation part 221 specifies a deterministic encrypted keyword (det<sub>y</sub>) associated with the trapdoor (td<sub>y</sub>) and stored in the search history storage region 213. The probabilistic encryption collation part 221 associates the specified keyword (det<sub>y</sub>) with the received encrypted keyword (c<sub>x</sub>) and stores the associated keyword (det<sub>y</sub>) as the deterministic encrypted keyword in the encrypted keyword storage region 211 (S205).</li></ol></p><p id="p0027" num="0027">For example, in a sequel to the above example, if the content of the search history storage region 213 is as represented in <figref idrefs="f0007">Fig. 12</figref>, the probabilistic encryption collation part 221 conducts a keyword matching check of the trapdoors (td<sub>1</sub>) to (td<sub>5</sub>) and the encrypted keyword (c<sub>6</sub>). If keyword matching is confirmed between (td<sub>2</sub>) and (c<sub>6</sub>), it indicates that the deterministic encrypted keyword corresponding to the encrypted<!-- EPO <DP n="16"> --> keyword (c<sub>6</sub>) is (det<sub>2</sub>). Thus, (c<sub>6</sub>) and (det<sub>2</sub>) are associated with each other and stored in the encrypted keyword storage region 211. As a result, the encrypted keyword storage region 211 is updated as in <figref idrefs="f0008">Fig. 13</figref>. If a keyword matching is not found, no particular process is performed. The procedure is now completed.</p><heading id="h0015">(C. Search and Acquisition of Data)</heading><p id="p0028" num="0028">The right search device 401 can perform concealed search for data stored in the server device 201 by specifying a keyword. This procedure will be described below step by step together with a practical example.</p><heading id="h0016">(Search Request by Search Device 401)</heading><p id="p0029" num="0029"><figref idrefs="f0015">Fig. 24</figref> is a flowchart indicating a search request process of the search device 401. The search request transmission process by the search device 401 will be described with reference to <figref idrefs="f0015">Fig. 24</figref>.
<ol><li>(1) First, in S301, using the trapdoor generation key stored in the search cipher key storage region 411, the trapdoor generating part 422 of the search device 401 generates a trapdoor from a keyword to be searched. In this case, an existing cryptographic technology (concealed search technique based on probabilistic encryption) will be utilized (the trapdoor will be referred to as td<sub>x</sub>). The trapdoor is information that is generated from the keyword to be searched in accordance with a probabilistic encryption. The trapdoor is used in a matching check with the encrypted keyword that has been obtained by encrypting the keyword of the search target data in concealed search in accordance with the probabilistic encryption. Simultaneously, in S302, using the deterministic encrypted keyword generation key stored in the search cipher key storage region 411, the deterministic encrypted keyword generating part 423 generates a deterministic encrypted keyword from the keyword to be searched. In this case, an existing cryptographic technology (for example, a common key cryptography<!-- EPO <DP n="17"> --> such as AES) will be used as the deterministic encryption (the deterministic encrypted keyword will be denoted as det<sub>x</sub>). In other words, the deterministic encrypted keyword generating part 423 generates the deterministic encrypted keyword (det<sub>x</sub>) from the keyword td<sub>x</sub> from which the trapdoor d<sub>x</sub> has been generated, in accordance with the deterministic encryption scheme.<br/>
Then,</li><li>(2) the communication part 431 transmits the set (td<sub>x</sub>, det<sub>x</sub>) of the trapdoor (td<sub>x</sub>) and deterministic encrypted keyword (det<sub>x</sub>) to the server device 201 as the concealed search request (S303).<br/>
Note that since (det<sub>x</sub>) is generated by the deterministic encryption, if the keyword to be searched is the same, the same value is always obtained.</li><li>(3) The search device 401 receives a search result from the server device 201 (S401).</li></ol></p><heading id="h0017">(Server Device 201)</heading><p id="p0030" num="0030"><figref idrefs="f0016">Fig. 25</figref> is a process flowchart of a concealed search of the server device 201. The concealed search process of the server device 201 will be described with reference to <figref idrefs="f0016">Fig. 25</figref>.
<ol><li>(1) The communication part 231 receives a search request (td<sub>x</sub>, det<sub>x</sub>) from the search device 401.</li><li>(2) The server device 201 having received this search request first checks whether or not the keyword to be searched is included in the past search history. More specifically, the deterministic encryption collation part 222 checks whether or not keywords match between each deterministic encrypted keyword (det<sub>i</sub>) stored in the search history storage region 213 and a deterministic encrypted keyword (det<sub>x</sub>) included in the search request (td<sub>x</sub>, det<sub>x</sub>) (S304, S305). Since this checking (search) can be<!-- EPO <DP n="18"> --> performed by a binary matching check, an existing search technique (for a case where encryption is not considered) can be utilized. Examples of the existing search technique include achieving speed-up by sorting data in advance and achieving speed-up by use of a hash table.</li><li>(3) If a binary matching is found (YES in S305), it indicates that a past search result can be utilized. This perception is based the cache process (S312) performed by a cache processing part to be described later. The deterministic encryption collation part 222 extracts, from the encrypted keyword storage region 211, a record in which the deterministic encrypted keyword matches the deterministic encrypted keyword (det<sub>x</sub>) included in the search request. In the same manner as described above (S304), since this extraction process can be performed by a binary matching check, an existing search technique can be utilized. Then, the deterministic encryption collation part 222 acquires a data ID (id) from the matching record (S306) and acquires encrypted data (d) corresponding to the acquired data ID from the data storage region 212 (S307).</li><li>(4) After that, the communication part 231 transmits the encrypted data acquired in S307 to the search device 401 (S308). If a plurality of pieces of encrypted data are acquired, all of them may be transmitted, or part of them may be transmitted.</li><li>(5) On the other hand, if a binary matching is not found (NO in S305), the records in the encrypted keyword storage region 211 are searched one by one utilizing an existing concealed search technique. More specifically, the probabilistic encryption collation part 221 conducts a keyword matching check for all encrypted keywords (c<sub>i</sub>) contained in the encrypted keyword storage region 211 with reference to the trapdoor (td<sub>x</sub>) included in the search request (td<sub>x</sub>, det<sub>x</sub>) (S309). If an encrypted keyword (c) that matches the received trapdoor (td<sub>x</sub>) is hit, (YES in S310), the probabilistic encryption collation part 221 acquires a data ID (id) out of the matching record from the encrypted<!-- EPO <DP n="19"> --> keyword storage region 211, and acquires encrypted data corresponding to the data ID (id) from the data storage region 212 (S311). After that, the communication part 231 transmits the encrypted data acquired in the above manner to the search device 401 (S308).</li><li>(6) If an encrypted keyword corresponding to the search request does not exist (NO in S310), information indicating the nonexistence is transmitted.</li><li>(7) &lt;Cache Process&gt;</li></ol></p><p id="p0031" num="0031">If a binary matching of the deterministic encrypted keyword is not found (NO in S305), then, a cache process of "search request and search result" is further practiced (S312). More specifically, the cache processing part 223 stores the search request to the search history storage region 213 in accordance with the content of the cache policy (history policy) stored in the cache policy storage region 214. For the record with a matching keyword among the records of the encrypted keyword storage region 211, the cache processing part 223 stores the deterministic encrypted keyword (det<sub>x</sub>) included in the search request, as the deterministic encrypted keyword (det) (S311, S312). In this case, in the checking of S310, if an encrypted keyword (c) corresponding to (td<sub>x</sub>) of the search request (td<sub>x</sub>, det<sub>x</sub>) is hit in the encrypted keyword storage region 211 (c that is hit is denoted as c<sub>k</sub>), the cache processing part 223 decides whether or not to store det<sub>x</sub> included in the search request (td<sub>x</sub>, det<sub>x</sub>) in accordance with the content of the cache policy (association policy) stored in the cache policy storage region 214. If the cache policy instructs to store det<sub>x</sub>, the cache processing part 223 stores det<sub>x</sub> of the search request by associating det<sub>x</sub> with (c<sub>k</sub>) of the encrypted keyword storage region 211. Due to the cache process of S312, in every subsequent search conducted using the same keyword, high-speed search (binary matching search) utilizing the deterministic encrypted keyword (det) can be performed (S306, S307). Where data (id, c, d) is<!-- EPO <DP n="20"> --> transmitted from the registration device 301 and additionally registered, an encrypted keyword (c) that matches the past search keyword (td) can be listed up in advance utilizing the trapdoor of the search history storage region 213. As a result, the time required for the search process can be shortened (S202 to S205 of <figref idrefs="f0014">Fig. 23</figref>).</p><heading id="h0018">(Search Device 401)</heading><p id="p0032" num="0032">Finally, as illustrated in S401 of <figref idrefs="f0015">Fig. 24</figref>, the data decryption processing part 421 of the search device 401 that has received the encrypted data, being the search result, decrypts the encrypted data using the data decryption key stored in the search cipher key storage region 411. In this case, an existing cryptographic technology that allows only the right search device 401 to decrypt is utilized. The procedure is now completed.</p><p id="p0033" num="0033">A supplementary explanation on this procedure will be made with reference to an example. Assume that the contents of the encrypted keyword storage region 211, data storage region 212, and search history storage region 213 of the server device 201 are as indicated in <figref idrefs="f0006">Figs. 10</figref>, <figref idrefs="f0007">11, and 12</figref>, respectively. Also assume that the cache policy storage region 214 stores a policy to "cache all search requests and search results", as mentioned in the procedure (A. Initial Device Setting). A case will be considered where the search device 401 generates a search request (td<sub>6</sub>, det<sub>6</sub>) from a keyword which is to be searched for the first time, and transmits the search request to the server device 201. Namely, (det<sub>6</sub>) is a value that is different from any one of (det<sub>1</sub>) to (det<sub>5</sub>). At this time, if the deterministic encryption collation part 222 of the server device 201 searches the search history storage region 213 (<figref idrefs="f0007">Fig. 12</figref>) for the deterministic encrypted keyword (det<sub>6</sub>), the deterministic encrypted keyword (det<sub>6</sub>) cannot be found. Thus, the probabilistic encryption collation part 221 searches the encrypted keyword storage region 211 (<figref idrefs="f0006">Fig. 10</figref>) for an encrypted keyword that matches the trapdoor (td<sub>6</sub>).<!-- EPO <DP n="21"> --> As a result, for example, if (c<sub>2</sub>) and (c<sub>5</sub>) are hit, the server device 201 transmits encrypted data (d<sub>2</sub>) and (d<sub>5</sub>) corresponding to (c<sub>2</sub>) and (c<sub>5</sub>) to the search device 401 as the search result. Based on the cache policy, the cache processing part 223 of the server device 201 stores the deterministic encrypted keyword (det<sub>6</sub>) to a matching record in the encrypted keyword storage region 211 (<figref idrefs="f0006">Fig. 10</figref>) and stores the search request (td<sub>6</sub>, det<sub>6</sub>) to the search history storage region 213 (<figref idrefs="f0007">Fig. 12</figref>). As a result, the encrypted keyword storage region 211 and search history storage region 213 are updated as in <figref idrefs="f0008">Figs. 14</figref> and <figref idrefs="f0009">15</figref>, respectively.</p><p id="p0034" num="0034">In this situation, assume that the search device 401 further transmits a search request (td<sub>7</sub>, det<sub>6</sub>) generated from the same keyword to the server device 201 (note that the deterministic encrypted keywords have the same value while the trapdoors have different values). When the deterministic encryption collation part 222 of the server device 201 searches the search history storage region 213 (<figref idrefs="f0009">Fig. 15</figref>) for the deterministic encrypted keyword (det<sub>6</sub>), the deterministic encrypted keyword that has been stored as described above is found. Thus, the deterministic encryption collation part 222 searches the encrypted keyword storage region 211 (<figref idrefs="f0008">Fig. 14</figref>) for a record that includes the deterministic encrypted keyword (det<sub>6</sub>). As a result, records that include (c<sub>2</sub>) and (c<sub>5</sub>) are hit. Thus, the server device 201 transmits encrypted data (d<sub>2</sub>) and (d<sub>5</sub>) corresponding to (c<sub>2</sub>) and (c<sub>5</sub>) to the search device 401 as the search results. Since the deterministic encrypted keyword is found this time by the binary matching checking of the search history storage region 213 (<figref idrefs="f0009">Fig. 15</figref>), a cache process concerning the search request and search result will not be performed.</p><p id="p0035" num="0035">As described above, the procedures of (A. Initial Device Setting) to (C. Search and Acquisition of Data) can realize a concealed search system in which the search device 401 can perform search while concealing data and keyword from the server<!-- EPO <DP n="22"> --> device 201. As is apparent from the case described in (C. Search and Acquisition of Data), in second and subsequent searches that use the same keyword, a process (concealed search based on probabilistic encryption) by the probabilistic encryption collation part 221 is not performed at all, and all keyword matching checks are performed only as a binary matching check of the deterministic encryption collation part 222. Therefore, the time required for the search process can be shortened largely. At the same time, regarding the security, when compared to conventional concealed search (that uses only probabilistic encryption), the method described in this embodiment additionally discloses only the deterministic encrypted keyword (det<sub>x</sub>) included in the search request to the server device 201. Hence, if a secure deterministic encrypted keyword is employed, the security against the server device 201 does not decrease at all. During the system operation, as represented in, for example, <figref idrefs="f0008">Fig. 14</figref>, the keyword identicalness may leak for some encrypted keywords in <figref idrefs="f0008">Fig. 14</figref>, ((c<sub>2</sub>) and (c<sub>5</sub>)) stored in the encrypted keyword storage region 211. Note that this information is available to the server device 201 even in conventional concealed search (that employs only probabilistic encryption). Thus, the security against the server device 201 is not decreased.</p><p id="p0036" num="0036">On the other hand, because the server device 201 stores the deterministic encrypted keyword, additional information may leak to an attacker if data leaks to the external attacker. More specifically, in the conventional search request (that employs only the probabilistic encryption), when data leaks, the external attacker cannot make a frequency analysis attack. On the contrary, with the method described in this embodiment, a frequency analysis attack for a searched keyword is possible. This poses the issue of trade-off between "high-speed search" and "security against an external attacker". The cache policy storage region 214 and cache processing part 223<!-- EPO <DP n="23"> --> have as one of their roles to control this issue. More specifically, if the user side of the concealed search system 100 puts the highest priority to the speed-up of the search, all search histories and all search results may be cached, as in this embodiment. Alternatively, if the speed-up need be ensured only for a frequently used search keyword, a cache policy that satisfies it may be set.</p><p id="p0037" num="0037">Another significance of the cache policy is to control the number of trapdoors to be stored in the search history storage region 213. If all the search histories (or the trapdoors included in all the search histories) are cached as in Embodiment 1, when the number of trapdoors increases, data registration in the procedure of (B. Transmission and Storage of Search Target Data) wastes time for the collation process of the encrypted keyword and each trapdoor (S203). In view of this, a cache policy that restricts the number of trapdoors to be stored in the search history storage region 213 may be set, so that data registration will not take too much time.</p><p id="p0038" num="0038">In that case, an encrypted keyword (c) collated (collation of S309) with a certain trapdoor (td<sub>x</sub>) and an encrypted keyword (c) non-collated may mix in the encrypted keyword storage region 211. Therefore, information for distinguishing the two different keywords is necessary. For example, assume that the encrypted keyword storage region 211 stores a content as represented in <figref idrefs="f0009">Fig. 16</figref> and that the search history storage region 213 stores a content as represented in <figref idrefs="f0010">Fig. 17</figref>. <figref idrefs="f0009">Figs. 16</figref> and <figref idrefs="f0010">17</figref> can express the following contents. <figref idrefs="f0010">Fig. 17</figref> can express the following circumstance. For record IDs 1 to 5 (c<sub>1</sub> to c<sub>5</sub>) of the encrypted keyword storage region 211 (<figref idrefs="f0009">Fig. 16</figref>), collation (search collation) using trapdoors corresponding to (det<sub>1</sub>) to (det<sub>6</sub>), that is, (td<sub>1</sub>) to (td<sub>6</sub>), has been conducted, and after that, (td<sub>1</sub>) and (td<sub>2</sub>) are deleted. For the record ID 6 of <figref idrefs="f0009">Fig. 16</figref>, collation is performed only with (td<sub>3</sub>) to (td<sub>6</sub>). In this case, the server device 201 which has received (td<sub>7</sub>, det<sub>1</sub>) as the search request from the search device<!-- EPO <DP n="24"> --> 401 recognizes that the record IDs 1 to 5 of <figref idrefs="f0009">Fig. 16</figref> do not match in the search (without using the trapdoor (td<sub>7</sub>)). This is apparent from <figref idrefs="f0010">Fig. 17</figref> where the trapdoor corresponding to (det<sub>1</sub>) is subjected to a search/collation process (S309) with the record IDs 1 to 5 (c<sub>1</sub> to c<sub>5</sub>) of <figref idrefs="f0009">Fig. 16</figref>. Also, as is apparent from <figref idrefs="f0009">Fig. 16</figref>, none of the encrypted keywords (c<sub>1</sub> to c<sub>5</sub>) is associated with (det<sub>1</sub>), and thus the encrypted keywords (c<sub>1</sub> to c<sub>5</sub>) do not match (td<sub>7</sub>) corresponding to (det<sub>1</sub>). In fine, only the collation process (collation during search) between the encrypted keyword (c<sub>6</sub>) and the trapdoor (td<sub>7</sub>) need be executed. Regarding the choice of the trapdoors at the time the number of the trapdoor reaches the maximum, an existing cache technique can be utilized.</p><p id="p0039" num="0039">According to this embodiment, the registration device 301 also encrypts data (pre-encryption data which will form the encrypted data) not used for search and transmits the encrypted data to the server device 201. However, if the data need not be concealed, it may be transmitted to the server device 201 without being encrypted. If data that needs to be concealed and data that does not mix among data that are not to be used for search, only the data that needs to be concealed may be encrypted and transmitted to the server device 201.</p><p id="p0040" num="0040">According to this embodiment, encryption (for example, common key cryptography such as AES) with which the same keyword is always transformed into the same value is employed as a means for generating the deterministic encrypted keyword. However, the keyword need not always be encrypted as far as the same keyword is transformed into the same value and that the original keyword is concealed. Namely, since the original keyword need not be decrypted from the deterministic encrypted keyword, a keyed hash function such as HMAC may be employed.</p><p id="p0041" num="0041">According to this embodiment, a deterministic encrypted keyword and a trapdoor which is generated probabilistically from a keyword are employed as the<!-- EPO <DP n="25"> --> search request. If a trapdoor that can be collated with an encrypted keyword (which is generated probabilistically) can be generated from a keyword deterministically, then a single deterministic trapdoor can be imparted with the function of the trapdoor and the function of the deterministic encrypted keyword. This can be realized by, for example, deterministically generating a random number to be used for probabilistic trapdoor generation (by means of, for example, applying the hash function to the keyword). In this case, it is necessary to pay attention because deterministic random number generation may decrease the security of the method.</p><p id="p0042" num="0042">According to this embodiment, the cache policy determined in the procedure (A. Initial Device Setting) stays unchanged throughout the entire system. Alternatively, during the system operation, the cache policy may be changed by, for example, the administrator of the company that uses the system.</p><p id="p0043" num="0043">According to this embodiment, in the procedure (B. Transmission and Storage of Search Target Data), each time the server device 201 receives an encrypted keyword, the server device 201 conducts a collation process with respect to each of the trapdoors stored in the search history storage region 213. However, this collation process may be performed as a batch process during, for example, the night (where the server device 201 may have a surplus processing capability). In this case, a collated encrypted keyword and a non-collated encrypted keyword with respect to a trapdoor in the search history storage region 213 may exist in the encrypted keyword storage region 211. Hence, information for distinguishing the two types of keywords is necessary.</p><p id="p0044" num="0044">According to this embodiment, the registration device 301 assigns a data ID to each piece of data and associates the encrypted keyword and the encrypted data with each other. Alternatively, this may be performed by the server device 201. More specifically, the registration device 301 transmits a set (c<sub>x</sub>, d<sub>x</sub>) of an encrypted keyword<!-- EPO <DP n="26"> --> and encrypted data to the server device 201. Then, the server device 201 assigns a unique data ID (id<sub>x</sub>) to the set, and stores (c<sub>x</sub>, id<sub>x</sub>) to the encrypted keyword storage region 211 and (id<sub>x</sub>, d<sub>x</sub>) to the data storage region 212.</p><p id="p0045" num="0045">According to this embodiment, in the server device 201, the encrypted keyword and the encrypted data are stored separately in the encrypted keyword storage region 211 and data storage region 212, respectively. However, it is possible to manage the encrypted keyword and the encrypted data totally. In that case, the data to be stored will be, for example, as indicated in <figref idrefs="f0010">Fig. 18</figref>.</p><p id="p0046" num="0046">This embodiment indicates an example in which one keyword corresponds to one piece of data. Alternatively, a plurality of keywords may correspond to one piece of data. In that case, for example, the data indicated in <figref idrefs="f0011">Fig. 19</figref> are stored in the encrypted keyword storage region 211. In the example of <figref idrefs="f0011">Fig. 19</figref>, encrypted keywords (c<sub>3</sub>) and (c<sub>4</sub>) correspond to data associated with (id<sub>3</sub>). Also, there may be a plurality of types of keywords, as indicated in <figref idrefs="f0011">Fig. 20</figref>.</p><p id="p0047" num="0047">According to this embodiment, the data storage region 212 is utilized to return the encrypted data as the search result. However, if the encrypted data need not be returned, the server device 201 need not have the data storage region 212. For example, the encrypted data may be held by another device, and only the data ID may be returned to enable access to the encrypted data.</p><p id="p0048" num="0048">According to this embodiment, the registration device 301 and the search device 401 are separate devices. However, in a case where, for example, only the information searcher can register information, the registration device 301 and the search device 401 may be put together into one device. In that case, the encrypted keyword generation key and the like no longer need be open to the public. As a result, the concealed search system 100 can be operated without the risk of giving unsolicited<!-- EPO <DP n="27"> --> information to the attacker.</p><p id="p0049" num="0049">According to this embodiment, the cipher key and the private information are stored in the registration cipher key storage region 311 of the registration device 301 and the search cipher key storage region 411 of the search device 401. Alternatively, instead of storing the cipher key and the private information, they may be acquired from the outside when necessary. For example, the cipher key and the private information may be acquired from an IC card or automatically generated from the password or biological information.</p><p id="p0050" num="0050">According to this embodiment, a single set of registration device 301 and a single set of search device 401 are employed. However, a plurality of registration devices 301 and a plurality of search devices 401 may be employed that can register and search data independently. In that case, if the plurality of search devices 401 share the trapdoor generation key and the deterministic encrypted keyword generation key, different devices can obtain the same search result. On the other hand, if search results are to differ from one device to another using the same search keyword, the different devices must have different trapdoor generation keys as well as different deterministic encrypted keyword generation keys.</p><heading id="h0019">Embodiment 2.</heading><p id="p0051" num="0051">Embodiment 2 will now be described with reference to <figref idrefs="f0017">Figs. 26</figref> and <figref idrefs="f0018">27</figref>. Embodiment 2 explains the hardware configuration of a server device 201, a registration device 301, or a search device 401 each being a computer. Since the server device 201, the registration device 301, and the search device 401 are each a computer, the server device 201 will be explained below as an example. The following explanation on the server device 201 applies to the registration device 301 and the search device 401 as well.<!-- EPO <DP n="28"> --></p><p id="p0052" num="0052"><figref idrefs="f0017">Fig. 26</figref> is an illustration of an example of the appearance of the server device 201 which is a computer.</p><p id="p0053" num="0053"><figref idrefs="f0018">Fig. 27</figref> is a diagram illustrating an example of the hardware resources of the server device 201 which is a computer.</p><p id="p0054" num="0054">Referring to <figref idrefs="f0017">Fig. 26</figref> which illustrates the appearance, the server device 201 includes hardware resources such as a system unit 830, a display device 813 such as a CRT (Cathode Ray Tube) or LCD (Liquid Crystal Display) having a display screen, a keyboard 814 (K/B), a mouse 815, and a compact disk drive 818 (CDD: Compact Disk Drive). These hardware resources are connected via cables and signal lines. The system unit 830 is connected to a network.</p><p id="p0055" num="0055">In <figref idrefs="f0018">Fig. 27</figref> illustrating the hardware resources, the server device 201 has a CPU 810 (Central Processing Unit) which executes programs. The CPU 810 is connected to a ROM (Read Only Memory) 811, a RAM (Random Access Memory) 812, the display device 813, the keyboard 814, the mouse 815, a communication board 816, the CDD 818, and a magnetic disk device 820 via a bus 825, and controls these hardware devices. In place of the magnetic disk device 820, a storage device such as an optical disc device or flash memory may be employed.</p><p id="p0056" num="0056">The RAM 812 is an example of a volatile memory. Storage media such as the ROM 811, the CDD 818, and the magnetic disk device 820 are examples of a nonvolatile memory. These memories are examples of a storage device, storage part, storing part, buffer, or storage region. The communication board 816, keyboard 814, and the like are examples of an input part or input device. Also, the communication board 816, display device 813, and the like are examples of an output part or output device. The communication board 816 (communication part) is connected to the network.<!-- EPO <DP n="29"> --></p><p id="p0057" num="0057">The magnetic disk device 820 stores an operating system 821 (OS), a window system 822, programs 823, and files 824. The CPU 810, operating system 821, and window system 822 execute each program of the programs 823.</p><p id="p0058" num="0058">The programs 823 include a program that executes the function described as a "part" in the description of this embodiment. The program is read and executed by the CPU 810.</p><p id="p0059" num="0059">Information, data, signal values, variable values, parameters, and the like described as the "checking result", "calculation result", "extraction result", "generation result", or "processing result" in the above explanation of the embodiments are stored in the files 824 as the items of a "file" or "database". The "file" and "database" are stored in a recording medium such as a disk or memory. The information, data, signal values, variable values, and parameters stored in a storage medium such as a disk or memory are read into the main memory or cache memory by the CPU 810 through a read/write circuit, and are used for the operation of the CPU 810 such as extraction, search, look-up, comparison, computation, calculation, processing, output, print, and display. The information, data, signal values, variable values, and parameters are temporarily stored in the main memory, cache memory, or buffer memory during the operation of the CPU such as extraction, search, look-up, comparison, computation, calculation, processing, output, print, and display.</p><p id="p0060" num="0060">In the explanation of the embodiments described above, the data and signals are recorded in a recording medium such as the memory of the RAM 812, the compact disk of the CDD 818, the magnetic disk of the magnetic disk device 820, an optical disc, a minidisc, a DVD (Digital Versatile Disk), or the like. The data and signals are transmitted online via the bus 825, the signal lines, the cables, or other transmission media.<!-- EPO <DP n="30"> --></p><p id="p0061" num="0061">What is described as a "part" in the description of the above embodiments may be a "means"; or a "step", "procedure", or "process". Namely, what is described as a "part" may be implemented only as software, as a combination of software and hardware, or as a combination of software, hardware, and firmware. The firmware and software are stored, as programs, in a recording medium such as the magnetic disk, flexible disk, optical disk, compact disc, minidisc, or DVD. The program is read by the CPU 810 and executed by the CPU 810. That is, the program causes the computer to function as a "part" mentioned above. Alternatively, the program causes the computer to execute the procedure or method of a "part" mentioned above.</p><p id="p0062" num="0062">In the above embodiments, for example, the server device 201 is explained. As is apparent from the above explanation, the server device 201 can also be treated as a concealed search program which is to serve as the server device 201. As is apparent from the above explanation, the operation of each "part" of the server device 201 can be treated as a concealed search method.</p><heading id="h0020"><b>Reference Signs List</b></heading><p id="p0063" num="0063">100: concealed search system; 201: server device; 210: data storage part; 211: encrypted keyword storage region; 212: data storage region; 213: search history storage region; 214: cache policy storage region; 220: checking part; 221: probabilistic encryption collation part; 222: deterministic encryption collation part; 223: cache processing part; 224: registration part; 231: communication part; 301: information registration device; 311: registration cipher key storage region; 321: data encryption processing part; 322: encrypted keyword generating part; 331: communication part; 401: information search device; 411: search cipher key storage region; 421: data decryption processing part; 422: trapdoor generating part; 423: deterministic encrypted keyword generating part; 431: communication part</p></description><claims mxw-id="PCLM90459477" lang="EN" load-source="patent-office"><!-- EPO <DP n="31"> --><claim id="c-en-0001" num="0001"><claim-text>A server device that executes a concealed search, comprising:
<claim-text>a server-side communication part that receives a set of a trapdoor and a deterministic encrypted keyword, as a concealed search request from a search device, the trapdoor being generated from a keyword in accordance with a probabilistic encryption scheme and used for a matching check with an encrypted keyword obtained by encrypting a keyword of search target data in the concealed search in accordance with the probabilistic encryption scheme, the deterministic encrypted keyword being generated from the keyword from which the trapdoor has been generated, in accordance with a deterministic encryption scheme;</claim-text>
<claim-text>a search history storage part that stores the set of the trapdoor and the deterministic encrypted keyword, as a history of a past concealed search request, the set being received by the server-side communication part;</claim-text>
<claim-text>a data storage part that stores keyword information in which the search target data and the encrypted keyword of the search target data are associated with each other, wherein if the deterministic encrypted keyword is obvious, the deterministic encrypted keyword corresponding to the encrypted keyword is further associated with the search target data and the encrypted keyword of the search target data in the keyword information; and</claim-text>
<claim-text>a checking part that checks whether or not the deterministic encrypted keyword which matches the deterministic encrypted keyword received by the server-side communication part exists in the search history storage part; and if it is decided that the deterministic encrypted keyword exists, executes the concealed search of the search target data targeting the data storage part, based on the deterministic encryption scheme using the deterministic encrypted keyword existing in the search<!-- EPO <DP n="32"> --> history storage part, and if it is decided that the deterministic encrypted keyword does not exist, executes the concealed search of the search target data targeting the data storage part, based on the probabilistic encryption scheme using the trapdoor received and the encrypted keyword of the keyword information stored in the data storage part.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The server device according to claim 1, further comprising:
<claim-text>a policy storage part that stores a history policy on whether or not to store the set of the trapdoor and the deterministic encrypted keyword to the search history storage part, the set being received by the server-side communication part; and</claim-text>
<claim-text>a cache processing part that, if it is decided by the checking part that the deterministic encrypted keyword which matches the deterministic encrypted keyword received by the server-side communication part does not exist in the search history storage part, decides whether or not to store the received set of the trapdoor and the deterministic encrypted keyword to the search history storage part, in accordance with the history policy of the policy storage part.</claim-text></claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The server device according to claim 2,<br/>
wherein if it is decided that the deterministic encrypted keyword which matches the deterministic encrypted keyword received by the server-side communication part does not exist in the search history storage part, the checking part executes, in the data storage part as a target, a matching check between the trapdoor that has been received and the encrypted keyword of the keyword information stored in the data storage part,<br/>
wherein the policy storage part includes an association policy on, if the checking part detects the encrypted keyword which matches the received trapdoor, in the data storage part by the matching check, whether or not to associate the deterministic encrypted keyword of the set that includes the received trapdoor, with the<!-- EPO <DP n="33"> --> encrypted keyword detected, and<br/>
wherein the cache processing part, if the checking part detects the encrypted keyword which matches the received trapdoor, in the data storage part by the matching check, decides whether or not to associate the deterministic encrypted keyword of the set that includes the received trapdoor, with the keyword information of the encrypted keyword detected, in accordance with the association policy.</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>The server device according to any one of claims 1 to 3,<br/>
wherein the server-side communication part receives search target data and an encrypted keyword of the search target data from a registration device that requests registration of the search target data,<br/>
the server device further comprising:
<claim-text>a registration part that associates the search target data received by the server-side communication part with the encrypted keyword received by the server-side communication part, and stores the search target data and the encrypted keyword to the data storage part; and</claim-text>
<claim-text>wherein the checking part executes a matching check between the encrypted keyword received by the server-side communication part and the trapdoor stored in the search history storage part, and if the trapdoor which matches the encrypted keyword received by the server-side communication part is detected in the matching check, associates the deterministic encrypted keyword which forms a set with the detected trapdoor, with the encrypted keyword stored in the data storage part by the registration part.</claim-text></claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>A concealed search program that causes a computer to serve as:
<claim-text>a server-side communication part that receives a set of a trapdoor and a deterministic encrypted keyword, as a concealed search request from a search device,<!-- EPO <DP n="34"> --> the trapdoor being generated from a keyword in accordance with a probabilistic encryption scheme and used for a matching check with an encrypted keyword obtained by encrypting a keyword of search target data in a concealed search in accordance with the probabilistic encryption scheme, the deterministic encrypted keyword being generated from the keyword from which the trapdoor has been generated, in accordance with a deterministic encryption scheme;</claim-text>
<claim-text>a search history storage part that stores the set of the trapdoor and the deterministic encrypted keyword, as a history of a past concealed search request, the set being received by the server-side communication part;</claim-text>
<claim-text>a data storage part that stores keyword information in which the search target data and the encrypted keyword of the search target data are associated with each other, wherein if the deterministic encrypted keyword is obvious, the deterministic encrypted keyword corresponding to the encrypted keyword is further associated with the search target data and the encrypted keyword of the search target data in the keyword information; and</claim-text>
<claim-text>a checking part that checks whether or not the deterministic encrypted keyword which matches the deterministic encrypted keyword received by the server-side communication part exists in the search history storage part; and if it is decided that the deterministic encrypted keyword exists, executes the concealed search of the search target data targeting the data storage part, based on the deterministic encryption scheme using the deterministic encrypted keyword existing in the search history storage part, and if it is decided that the deterministic encrypted keyword does not exist, executes the concealed search of the search target data targeting the data storage part, based on the probabilistic encryption scheme using the trapdoor received and the encrypted keyword of the keyword information stored in the data storage part.</claim-text><!-- EPO <DP n="35"> --></claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>A computer-readable recording medium in which stores the concealed search program according to claim 5 is stored.</claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>A concealed search system comprising a search device and a server device, the search device serving to transmit a concealed search request to the server device, the server device serving to execute a concealed search in response to the concealed search request,<br/>
wherein the search device includes a search-side transmission part that transmits a set of a trapdoor and a deterministic encrypted keyword, as the concealed search request, the trapdoor being generated from a keyword in accordance with a probabilistic encryption scheme and used for a matching check with an encrypted keyword obtained by encrypting a keyword of search target data in the concealed search in accordance with the probabilistic encryption scheme, the deterministic encrypted keyword being generated from the keyword from which the trapdoor has been generated, in accordance with a deterministic encryption scheme,<br/>
the server device including:
<claim-text>a server-side communication part that receives the set of the trapdoor and the deterministic encrypted keyword, the set being transmitted by the search-side transmission part;</claim-text>
<claim-text>a search history storage part that stores the set of the trapdoor and the deterministic encrypted keyword, as a history of a past concealed search request, the set being received by the server-side communication part;</claim-text>
<claim-text>a data storage part that stores keyword information in which the search target data and the encrypted keyword of the search target data are associated with each other, wherein if the deterministic encrypted keyword is obvious, the deterministic encrypted keyword corresponding to the encrypted keyword is further associated with the search<!-- EPO <DP n="36"> --> target data and the encrypted keyword of the search target data in the keyword information; and</claim-text>
<claim-text>a checking part that checks whether or not the deterministic encrypted keyword which matches the deterministic encrypted keyword received by the server-side communication part exists in the search history storage part; and if it is decided that the deterministic encrypted keyword exists, executes the concealed search of the search target data targeting the data storage part, based on the deterministic encryption scheme using the deterministic encrypted keyword existing in the search history storage part, and if it is decided that the deterministic encrypted keyword does not exist, executes the concealed search of the search target data targeting the data storage part, based on the probabilistic encryption scheme using the trapdoor received and the encrypted keyword of the keyword information stored in the data storage part.</claim-text></claim-text></claim></claims><drawings mxw-id="PDW20422203" load-source="patent-office"><!-- EPO <DP n="37"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="165" he="113" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="38"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="165" he="225" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="39"> --><figure id="f0003" num="3,4"><img id="if0003" file="imgf0003.tif" wi="165" he="231" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="40"> --><figure id="f0004" num="5,6"><img id="if0004" file="imgf0004.tif" wi="165" he="226" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="41"> --><figure id="f0005" num="7,8"><img id="if0005" file="imgf0005.tif" wi="153" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="42"> --><figure id="f0006" num="9,10"><img id="if0006" file="imgf0006.tif" wi="150" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="43"> --><figure id="f0007" num="11,12"><img id="if0007" file="imgf0007.tif" wi="164" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="44"> --><figure id="f0008" num="13,14"><img id="if0008" file="imgf0008.tif" wi="159" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="45"> --><figure id="f0009" num="15,16"><img id="if0009" file="imgf0009.tif" wi="149" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="46"> --><figure id="f0010" num="17,18"><img id="if0010" file="imgf0010.tif" wi="165" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="47"> --><figure id="f0011" num="19,20"><img id="if0011" file="imgf0011.tif" wi="164" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="48"> --><figure id="f0012" num="21"><img id="if0012" file="imgf0012.tif" wi="148" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="49"> --><figure id="f0013" num="22"><img id="if0013" file="imgf0013.tif" wi="154" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="50"> --><figure id="f0014" num="23"><img id="if0014" file="imgf0014.tif" wi="162" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="51"> --><figure id="f0015" num="24"><img id="if0015" file="imgf0015.tif" wi="165" he="230" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="52"> --><figure id="f0016" num="25"><img id="if0016" file="imgf0016.tif" wi="165" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="53"> --><figure id="f0017" num="26"><img id="if0017" file="imgf0017.tif" wi="154" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="54"> --><figure id="f0018" num="27"><img id="if0018" file="imgf0018.tif" wi="165" he="215" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="165" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="165" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
