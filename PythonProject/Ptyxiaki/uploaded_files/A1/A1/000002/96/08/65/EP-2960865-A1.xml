<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2960865-A1" country="EP" doc-number="2960865" kind="A1" date="20151230" family-id="51059281" file-reference-id="257226" date-produced="20180826" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160451816" ucid="EP-2960865-A1"><document-id><country>EP</country><doc-number>2960865</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-14173457-A" is-representative="YES"><document-id mxw-id="PAPP193866600" load-source="patent-office" format="original"><country>EP</country><doc-number>14173457.4</doc-number><date>20140623</date><lang>EN</lang></document-id><document-id mxw-id="PAPP193866601" load-source="docdb" format="epo"><country>EP</country><doc-number>14173457</doc-number><kind>A</kind><date>20140623</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162027541" ucid="EP-14173457-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>14173457</doc-number><kind>A</kind><date>20140623</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1987791917" load-source="docdb">G06T  15/50        20060101AFI20141205BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988520780" load-source="docdb">G01N  23/00        20060101ALI20141205BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988526640" load-source="docdb">G06T  11/00        20060101ALI20141205BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1984697688" load-source="docdb" scheme="CPC">G01N2223/401       20130101 LA20160104BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984701745" load-source="docdb" scheme="CPC">G01N  23/2251      20130101 LI20160104BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984702356" load-source="docdb" scheme="CPC">G01N2223/418       20130101 LA20160104BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984702710" load-source="docdb" scheme="CPC">G01N2223/405       20130101 LA20160104BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984703053" load-source="docdb" scheme="CPC">G01N2223/402       20130101 LA20160104BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984703860" load-source="docdb" scheme="CPC">G01N2223/616       20130101 LA20160104BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987766135" load-source="docdb" scheme="CPC">G06T  15/503       20130101 FI20141127BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987776636" load-source="docdb" scheme="CPC">G06T  11/00        20130101 LI20141127BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987795807" load-source="docdb" scheme="CPC">G01N  23/00        20130101 LI20141202BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165546914" lang="DE" load-source="patent-office">Mischungsmodi für Mineralogiebilder</invention-title><invention-title mxw-id="PT165546915" lang="EN" load-source="patent-office">Blend modes for mineralogy images</invention-title><invention-title mxw-id="PT165546916" lang="FR" load-source="patent-office">Modes de mélange pour images minéralogies</invention-title><citations><patent-citations><patcit mxw-id="PCIT335962517" load-source="docdb" ucid="GB-2223842-A"><document-id format="epo"><country>GB</country><doc-number>2223842</doc-number><kind>A</kind><date>19900418</date></document-id><sources><source name="SEA" category="I" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT335962519" load-source="docdb" ucid="US-20110144922-A1"><document-id format="epo"><country>US</country><doc-number>20110144922</doc-number><kind>A1</kind><date>20110616</date></document-id><sources><source name="SEA" category="XD" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT377492147" load-source="docdb" ucid="US-201314073523-A" dnum-type="application"><document-id format="epo"><country>US</country><doc-number>201314073523</doc-number><kind>A</kind><date>20131106</date></document-id><sources><source name="APP" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT377489002" load-source="docdb" ucid="US-86669709-A" dnum-type="application"><document-id format="epo"><country>US</country><doc-number>86669709</doc-number><kind>A</kind><date>20090206</date></document-id><sources><source name="APP" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT335962518" load-source="docdb" ucid="WO-1996031770-A1"><document-id format="epo"><country>WO</country><doc-number>1996031770</doc-number><kind>A1</kind><date>19961010</date></document-id><sources><source name="SEA" category="X" created-by-npl="N"/></sources></patcit></patent-citations><non-patent-citations><nplcit><text>LEV ZAKARHOV ET AL: "Electron Beam MicroAnalysis- Theory and Application Electron Probe MicroAnalysis - (EPMA) Imaging: (Analog imaging and X-ray mapping)", 20 March 2006 (2006-03-20), pages 1 - 66, XP055156452, Retrieved from the Internet &lt;URL:http://epmalab.uoregon.edu/pdfs/Electron Beam MicroAnalysis-Geol_619-13.ppt&gt; [retrieved on 20141203]</text><sources><source mxw-id="PNPL69817764" load-source="docdb" name="SEA" category="A"/></sources></nplcit><nplcit><text>ROBERT THOMAS: "Photoshop Blend Modes Explained - Photo Blog Stop", 17 April 2011 (2011-04-17), pages 1 - 44, XP055156463, Retrieved from the Internet &lt;URL:http://photoblogstop.com/photoshop/photoshop-blend-modes-explained&gt; [retrieved on 20141203]</text><sources><source mxw-id="PNPL69817765" load-source="docdb" name="SEA" category="A"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR1103324095" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>FEI CO</last-name><address><country>US</country></address></addressbook></applicant><applicant mxw-id="PPAR1103327040" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>FEI COMPANY</last-name></addressbook></applicant><applicant mxw-id="PPAR1101642259" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>FEI COMPANY</last-name><iid>100121689</iid><address><street>5350 NE Dawson Creek Drive</street><city>Hillsboro, Oregon 97124-5793</city><country>US</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103318812" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>HOWELL GARTH</last-name><address><country>AU</country></address></addressbook></inventor><inventor mxw-id="PPAR1103328294" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>HOWELL, GARTH</last-name></addressbook></inventor><inventor mxw-id="PPAR1101650181" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>HOWELL, GARTH</last-name><address><street>34 Bardot St.</street><city>McDowall, Queensland 4053</city><country>AU</country></address></addressbook></inventor><inventor mxw-id="PPAR1103304777" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>OWEN MICHAEL</last-name><address><country>AU</country></address></addressbook></inventor><inventor mxw-id="PPAR1103311348" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>OWEN, MICHAEL</last-name></addressbook></inventor><inventor mxw-id="PPAR1101649924" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>OWEN, MICHAEL</last-name><address><street>40 Sunbury St.</street><city>Geebung, Queensland 4034</city><country>AU</country></address></addressbook></inventor><inventor mxw-id="PPAR1103326654" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>SALAZAR LEONARDO</last-name><address><country>AU</country></address></addressbook></inventor><inventor mxw-id="PPAR1103326012" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>SALAZAR, Leonardo</last-name></addressbook></inventor><inventor mxw-id="PPAR1101649232" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>SALAZAR, Leonardo</last-name><address><street>31101/2 Harbour Rd</street><city>Hamilton, New South Wales 4007</city><country>AU</country></address></addressbook></inventor><inventor mxw-id="PPAR1103333026" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>HABERLAH DAVID</last-name><address><country>AU</country></address></addressbook></inventor><inventor mxw-id="PPAR1103330471" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>HABERLAH, David</last-name></addressbook></inventor><inventor mxw-id="PPAR1101646748" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>HABERLAH, David</last-name><address><street>4 Kellett Road</street><city>Salibury, Queensland 4107</city><country>AU</country></address></addressbook></inventor><inventor mxw-id="PPAR1103326369" load-source="docdb" sequence="5" format="epo"><addressbook><last-name>GOERGEN ERIC</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR1103316430" load-source="docdb" sequence="5" format="intermediate"><addressbook><last-name>GOERGEN, Eric</last-name></addressbook></inventor><inventor mxw-id="PPAR1101650733" load-source="patent-office" sequence="5" format="original"><addressbook><last-name>GOERGEN, Eric</last-name><address><street>764 NW Adwick Dr</street><city>Beaverton, OR Oregon 97006</city><country>US</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR1101653798" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Bakker, Hendrik</last-name><iid>100998972</iid><address><street>FEI Company Patent Department P.O. Box 1745</street><city>5602 BS Eindhoven</city><country>NL</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS660693270" load-source="docdb">AL</country><country mxw-id="DS660785193" load-source="docdb">AT</country><country mxw-id="DS660693276" load-source="docdb">BE</country><country mxw-id="DS660690908" load-source="docdb">BG</country><country mxw-id="DS660701860" load-source="docdb">CH</country><country mxw-id="DS660611071" load-source="docdb">CY</country><country mxw-id="DS660785194" load-source="docdb">CZ</country><country mxw-id="DS660693204" load-source="docdb">DE</country><country mxw-id="DS660693277" load-source="docdb">DK</country><country mxw-id="DS660611072" load-source="docdb">EE</country><country mxw-id="DS660615029" load-source="docdb">ES</country><country mxw-id="DS660690909" load-source="docdb">FI</country><country mxw-id="DS660690910" load-source="docdb">FR</country><country mxw-id="DS660693278" load-source="docdb">GB</country><country mxw-id="DS660693283" load-source="docdb">GR</country><country mxw-id="DS660693284" load-source="docdb">HR</country><country mxw-id="DS660611073" load-source="docdb">HU</country><country mxw-id="DS660701861" load-source="docdb">IE</country><country mxw-id="DS660693285" load-source="docdb">IS</country><country mxw-id="DS660690919" load-source="docdb">IT</country><country mxw-id="DS660611074" load-source="docdb">LI</country><country mxw-id="DS660693205" load-source="docdb">LT</country><country mxw-id="DS660785195" load-source="docdb">LU</country><country mxw-id="DS660693206" load-source="docdb">LV</country><country mxw-id="DS660693211" load-source="docdb">MC</country><country mxw-id="DS660615392" load-source="docdb">MK</country><country mxw-id="DS660615393" load-source="docdb">MT</country><country mxw-id="DS660785196" load-source="docdb">NL</country><country mxw-id="DS660693286" load-source="docdb">NO</country><country mxw-id="DS660785197" load-source="docdb">PL</country><country mxw-id="DS660693291" load-source="docdb">PT</country><country mxw-id="DS660785198" load-source="docdb">RO</country><country mxw-id="DS660693292" load-source="docdb">RS</country><country mxw-id="DS660785199" load-source="docdb">SE</country><country mxw-id="DS660693213" load-source="docdb">SI</country><country mxw-id="DS660611083" load-source="docdb">SK</country><country mxw-id="DS660611084" load-source="docdb">SM</country><country mxw-id="DS660615394" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA166480186" lang="EN" load-source="patent-office"><p id="pa01" num="0001">Optimized blending mode for mineralogy images. A luminosity value is determined for a pixel in a base layer or top layer mineralogy image. An image weighting value is determined from the luminosity value and an optional mixing parameter. A multiply value is determined by multiplying the base and top layer pixel values. An overlay value is determined from twice the multiply value if the value of one of the base layer or top layer pixel values is over a threshold, otherwise it is determined by inverting twice the product of the inverted top layer pixel value with the inverted base layer pixel value. A blended image pixel value is determined by adding the multiply value weighted with the image weighting value and the overlay value weighted with the inverted image weighting value.
<img id="iaf01" file="imgaf001.tif" wi="62" he="113" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA166759998" lang="EN" source="EPO" load-source="docdb"><p>Optimized blending mode for mineralogy images. A luminosity value is determined for a pixel in a base layer or top layer mineralogy image. An image weighting value is determined from the luminosity value and an optional mixing parameter. A multiply value is determined by multiplying the base and top layer pixel values. An overlay value is determined from twice the multiply value if the value of one of the base layer or top layer pixel values is over a threshold, otherwise it is determined by inverting twice the product of the inverted top layer pixel value with the inverted base layer pixel value. A blended image pixel value is determined by adding the multiply value weighted with the image weighting value and the overlay value weighted with the inverted image weighting value.</p></abstract><description mxw-id="PDES98404887" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><u>Technical Field of the Invention</u></heading><p id="p0001" num="0001">The present invention relates to the generation and display of mineralogy images, and in particular to a method for automatically blending mineralogy images of a sample, including textural, elemental and spatial mineral identification images.</p><heading id="h0002"><u>Background of the Invention</u></heading><p id="p0002" num="0002">To properly understand and interpret the mineralogy of a sample, knowledge of both the textural information of the sample and the spatial distribution of minerals in the sample is required.</p><p id="p0003" num="0003">The textural information of a geological sample refers to the size, shape and arrangement of grains or crystals within the sample, the homogeneity of the sample, its degree of isotropy, and the distribution of elements within the minerals The textural information can be measured, for example, by scanning the sample with a high energy beam of charged particles, and measuring at each scanned position the intensity of back-scattered electrons ("BSE's") that are received at an electron detector. The measured BSE intensities are indicators of the average atomic number of elements in the sample as a function of scan position. A plot of the intensity versus scan position can be presented as a grey scale image, where each pixel in the image is a shade of grey that corresponds to the measured BSE intensity at the scanned position. The image so obtained will be darkest where the measured BSE intensity is least, and lightest where the measured BSE intensity is greatest. Of course, this color scheme can be inverted so that the image will be lightest where the measured BSE intensity is least, and darkest where the measured BSE intensity is greatest.</p><p id="p0004" num="0004">In addition to BSE intensity, other forms of textural information can include representation of the rate of x-ray production at each pixel. This is measured by scanning the sample with a high energy beam of charged particles, and measuring the intensity of x-rays produced by the sample and received by an x-ray detector. The x-rays are produced when the charged particles dislodge electrons in the sample, and electrons from higher energy shells fall into the energy shells vacated by the dislodged electrons. The rate at which the x-rays are produced is roughly proportional to the volume and atomic number of the material in the sample. A plot of the x-ray generation rate versus scan position can be presented as a grey scale image, where each pixel in the image is a shade of grey corresponding to the measured rate of x-ray production at each scan position. The image so obtained will be darkest where the measured x-ray production rate is lowest, and brightest where the measured x-ray production rate is highest.<!-- EPO <DP n="2"> --></p><p id="p0005" num="0005">The spatial distribution of minerals in the sample is a plot of the minerals identified in the sample as a function of sample position. It can be generated by scanning the sample with a high energy beam, and measuring the energy distribution of x-rays emitted from the sample as a function of scan position. On a per pixel basis, these energy distributions can be fitted and/or compared to a catalog of energy distributions obtained from pure elements or pure minerals in order to identify the elements and/or minerals in the sample at each scanned position. Techniques for identifying minerals based on a catalog of elemental x-ray spectra are disclosed, for example, in <patcit id="pcit0001" dnum="US86669709A"><text>U.S. Patent Application No. 12/866,697, filed on Feb. 6, 2009</text></patcit>, which is herein incorporated by reference in its entirety. Techniques for identifying minerals based on a catalog of mineral x-ray spectra are disclosed, for example, in <patcit id="pcit0002" dnum="US07352313A"><text>U.S. Patent Application No. 14/073,523, filed on Nov. 6, 2013</text></patcit>, which is herein incorporated by reference in its entirety. Different colors can be assigned to different minerals in the catalog, and an image of the spatial mineral distribution in the sample can be generated by plotting the colors of identified minerals as a function of scanned position.</p><p id="p0006" num="0006">Since proper understanding of the mineralogy of a sample requires knowledge of both the textural information of the sample and the spatial distribution of minerals in the sample, methods are needed to combine the textural and spatial mineral distribution images into a single composite image that reveals both the spatial mineral distribution and textural information about the sample.</p><heading id="h0003"><u>Summary of the Invention</u></heading><p id="p0007" num="0007">An object of the invention is to provide an automated mechanism to allow data from multiple detectors to be simultaneously visualized without losing information from either data source.</p><p id="p0008" num="0008">In one aspect, the invention features a computer implemented method for blending mineralogy images, including a base layer mineralogy image and a top layer mineralogy image. For each pixel in the base or top layer mineralogy images a base layer value is determined from the pixel in the base layer mineralogy image, and a top layer value is determined from the pixel in the top layer mineralogy image. A luminosity value is determined from one of the base layer or top layer values. A multiply value is determined by multiplying the base and top layer values. An overlay value is determined by doubling the multiply value if one of the base layer or top layer values is less than a threshold, and by otherwise inverting twice the product of the inverted top layer value with the inverted bottom layer value. An image blending weight is determined from the luminosity value. A blended image value is determined as a weighted average of the multiply value and the<!-- EPO <DP n="3"> --> overlay value, wherein the multiply value is weighted by the image blending weight and the overlay value is weighted by the inverted image blending weight.</p><p id="p0009" num="0009">Implementations of the invention may include one or more of the following features. The base layer mineralogy image can be a textural mineralogy image and the top layer mineralogy image can be a spatial mineral distribution image. The textural mineralogy image can be an image of the intensity of back-scattered electrons or an image of the intensity of generated x-rays. The image blending weight can be determined by multiplying the luminosity value by a mixing parameter. A blended image, where each pixel of the blended image has a blended image value determined from the base layer value and top layer value, can be displayed on a display device.</p><p id="p0010" num="0010">In another aspect, the invention features a computer implemented method for blending mineralogy images of a sample, including an elemental distribution image of the sample, and a mineral distribution image of the sample. A blended image of the sample can be generated by blending the elemental and mineral distribution images of the sample.</p><p id="p0011" num="0011">Implementations of the invention may include one or more of the following features. Each pixel in the blended image of the sample can be generated from each pixel in the elemental and mineral distribution images. A base layer value can be determined from the pixel in the elemental distribution image. A top layer value can be determined from the pixel in the mineral distribution image. A luminosity value can be determined from one of the base layer or top layer values. A multiply value can be determined by multiplying the base and top layer values. An overlay value can be determined by doubling the multiply value if one of the base layer or top layer values is less than a threshold, and by otherwise inverting twice the product of the inverted top layer value with the inverted bottom layer value. An image blending weight can be determined from the luminosity value. A blended image value can be determined as a weighted average of the multiply value and the overlay value, wherein the multiply value is weighted by the image blending weight and the overlay value is weighted by the inverted image blending weight. The image blending weight can be determined by multiplying the luminosity value by a mixing parameter.</p><p id="p0012" num="0012">The foregoing has outlined rather broadly the features and technical advantages of the present invention in order that the detailed description of the invention that follows may be better understood. Additional features and advantages of the invention will be described hereinafter. It should be appreciated by those skilled in the art that the conception and specific embodiments disclosed may be readily utilized as a basis<!-- EPO <DP n="4"> --> for modifying or designing other structures for carrying out the same purposes of the present invention. It should also be realized by those skilled in the art that such equivalent constructions do not depart from the scope of the invention as set forth in the appended claims.</p><p id="p0013" num="0013">Implementations of the invention may also include one or more of the following features. Each pixel in the blended image of the sample can be generated by determining a top layer value from the pixel in the mineral distribution image, determining an opacity value from the pixel in the elemental distribution image; and alpha blending the top layer value with a black pixel value using the opacity value. The pixel in the blended image can be rendered black when the corresponding pixel in the elemental distribution image has a value that is less than an elemental threshold.</p><heading id="h0004"><u>Brief Description of the Drawings</u></heading><p id="p0014" num="0014">The patent or application file contains at least one drawing executed in color. Copies of this patent or patent application publication with color drawings will be provided by the Office upon request and payment of the necessary fee. For a more thorough understanding of the present invention, and advantages thereof, reference is now made to the following descriptions taken in conjunction with the accompanying drawings, in which:
<ul><li><figref idrefs="f0001">FIG. 1</figref> is a flow chart depicting a method for blending textural and spatial mineral distribution images.</li><li><figref idrefs="f0002">FIG. 2A</figref> is an illustration of a blended image made by blending a textural image with a spatial mineral distribution image using the multiply blend mode.</li><li><figref idrefs="f0002">FIG. 2B</figref> is an illustration of a blended image made by blending a textural image with a spatial mineral distribution image using the multiply blend mode.</li><li><figref idrefs="f0003">FIG. 2C</figref> is an illustration of a blended image made by blending a textural image with a spatial mineral distribution image using the overlay blend mode.</li><li><figref idrefs="f0003">FIG. 2D</figref> is an illustration of a blended image made by blending a textural image with a spatial mineral distribution image using the special blend mode.</li><li><figref idrefs="f0004">FIG. 3</figref> is a flow chart depicting a method for blending an elemental distribution image and a spatial mineral distribution image.</li><li><figref idrefs="f0005">FIG. 4</figref> is an illustration of a blended image made by blending an elemental distribution image with a spatial mineral distribution image.</li><li><figref idrefs="f0006">FIG. 5</figref> is an illustration of a mineral identification and analysis system.</li></ul></p><heading id="h0005"><u>Detailed Description of Preferred Embodiments</u></heading><!-- EPO <DP n="5"> --><p id="p0015" num="0015">Proper understanding of the mineralogy of a sample requires knowledge of both the texture of the sample and the spatial distribution of minerals in the sample. Methods are disclosed for forming a blended image by combining textural and spatial mineral distribution images of a sample to facilitate an understanding of its mineralogy. In one embodiment, the two images can be blended together using known image blending techniques, such as by compositing the two images as layers in a blended image. The degree of blending can be controlled by assigning a global opacity value to the alpha channel of the spatial mineral distribution image. The textural and spatial mineral distribution images can then be blended using a conventional alpha blending algorithm. This approach, however, tends to wash out the colors in the spatial mineral distribution layer.</p><p id="p0016" num="0016">Other image blending techniques from the image processing arts can be used to combine the textural and spatial mineral distribution images. For example, the color values of pixels in the textural and spatial mineral distribution images can be added together, subtracted, multiplied or divided by one another to obtain the color values of corresponding pixels in the blended image. Since each of these image blending techniques is globally applied (i.e., identically applied to each pixel in the blended image), each technique produces a global effect on the blended image. For example, multiplying images creates a blended image that is everywhere darker than either of the combined images, while dividing images creates a blended image that is everywhere lighter than either of the combined images.</p><p id="p0017" num="0017">Some image blending modes address these global compositing issues by thresholding the image compositing function. That is, different image compositing functions are used depending on whether the color value in one of the layers to be blended exceeds a threshold. Examples of such blending modes include the overlay, hard light, and soft light blending. However, depending on the threshold selected, portions of the image far from the threshold may appear too dark or too light.</p><p id="p0018" num="0018">To optimize the information presented in a blended image consisting of textural and spatial mineral distribution images from a sample, a custom blending method has been developed. This method combines elements from conventional multiply, screen and overlay blending modes, and mixes these modes on a per pixel basis as a function of the luminosity of the pixel color in the textural or spatial mineral distribution images.</p><p id="p0019" num="0019"><figref idrefs="f0001">FIG. 1</figref> is a flow chart depicting a method for blending textural and spatial mineral distribution images. The method begins by receiving a textural image and<!-- EPO <DP n="6"> --> a spatial mineral distribution image for a sample (100). In one implementation, an optional mixing parameter <i>k</i> that ranges in value between 0 and 1 is also received (110). In some implementations, the mixing parameter <i>k</i> can be received from a computer memory, where it is set to a default value such as 0.6. In other implementations, the mixing parameter can be received as user input, e.g., from a text box or as a radio button selection in a graphical user interface presented to the user. Setting the mixing parameter <i>k</i> to a default value of 1 is equivalent to having no mixing parameter at all, as further explained below.</p><p id="p0020" num="0020">The method proceeds by looping through all of the pixels in the textural and spatial mineral distribution images (120). If the images have different resolutions, one or both images can be renormalized so they have the same resolution or number of pixels. For each pixel, the luminance of the color in either the textural or the spatial mineral distribution image is determined (130). For example, in one implementation, the luminance of the textural image is determined. If this distribution is a grey scale image (e.g., representing the intensity of BSE's), the luminance is simply the grey value for that pixel. In another implementation, the luminance of the spatial mineral distribution image is determined. If the pixel color in the spatial mineral distribution image is stored in the RGB or red, green, blue color space, the luminance Y can be determined as: <maths id="math0001" num="(eq. 1)"><math display="block"><mi>Y</mi><mo>=</mo><mn>0.299</mn><mo>⁢</mo><mi>R</mi><mo>+</mo><mn>0.587</mn><mo>⁢</mo><mi>G</mi><mo>+</mo><mn>0.114</mn><mo>⁢</mo><mi>B</mi></math><img id="ib0001" file="imgb0001.tif" wi="72" he="9" img-content="math" img-format="tif"/></maths></p><p id="p0021" num="0021">If the pixel color is stored in other color spaces, well known formulas can be used to determine the luminance from the pixel's color values in those color spaces. By normalization, the luminance lies within a range of 0 to 1.</p><p id="p0022" num="0022">Next, pixel values for the conventional multiply, screen and overlay blending modes are obtained from the pixel values of the textural and spatial mineral distribution images. The multiply blend value is simply the product of the pixel values from these two images: <maths id="math0002" num="(eq. 2)"><math display="block"><msub><mi>M</mi><mi mathvariant="italic">ij</mi></msub><mfenced><mi>l</mi></mfenced><mo>=</mo><msub><mi>T</mi><mi mathvariant="italic">ij</mi></msub><mfenced><mi>l</mi></mfenced><mo>*</mo><msub><mi mathvariant="italic">SMD</mi><mi mathvariant="italic">ij</mi></msub><mfenced><mi>l</mi></mfenced></math><img id="ib0002" file="imgb0002.tif" wi="64" he="10" img-content="math" img-format="tif"/></maths> where <i>M<sub>ij</sub>(l), T<sub>ij</sub>(l), and SMD<sub>ij</sub>(l)</i> are respectively the multiply blend value, the textural image value, and the spatial mineral distribution image value for the <i>lth</i> color component of pixel <i>(i,j).</i> The pixel value in the multiply blend will be darker than the pixel values in either the textural or spatial mineral distribution images. This mode is therefore useful for blending high intensity areas of the textural and spatial mineral distribution images; however, low intensity areas often come out too dark to provide useful information about the mineralogy of the sample. The screen blend pixel value <i>SCR<sub>ij</sub>(l)</i> is obtained by inverting the product<!-- EPO <DP n="7"> --> of the inverted pixel values from the textural and spatial mineral distribution images. It can be computed as: <maths id="math0003" num="(eq. 3)"><math display="block"><msub><mi mathvariant="italic">SCR</mi><mi mathvariant="italic">ij</mi></msub><mfenced><mi>l</mi></mfenced><mo>=</mo><mn>1</mn><mo>-</mo><mfenced separators=""><mn>1</mn><mo>-</mo><msub><mi>T</mi><mi mathvariant="italic">ij</mi></msub><mfenced><mi>l</mi></mfenced></mfenced><mo>*</mo><mfenced separators=""><mn>1</mn><mo>-</mo><msub><mi mathvariant="italic">SMD</mi><mi mathvariant="italic">ij</mi></msub><mfenced><mi>l</mi></mfenced></mfenced></math><img id="ib0003" file="imgb0003.tif" wi="96" he="10" img-content="math" img-format="tif"/></maths> The pixel value in the screen blend will be lighter than the pixel values in either the textural or spatial mineral distribution images. This mode is therefore useful for low intensity areas of the textural and spatial mineral distribution images; however, high intensity areas often come out too light to provide useful information about the mineralogy of the sample. Finally, the overlay blend value <i>O<sub>ij</sub>(l)</i> can be computed as: <maths id="math0004" num="(eq. 4)"><math display="block"><msub><mi>O</mi><mi mathvariant="italic">ij</mi></msub><mfenced><mi>l</mi></mfenced><mo>=</mo><mrow><mo>{</mo><mtable><mtr><mtd><msub><mi>M</mi><mi mathvariant="italic">ij</mi></msub><mfenced><mi>l</mi></mfenced></mtd><mtd><msub><mi mathvariant="italic">if SMD</mi><mi mathvariant="italic">ij</mi></msub><mfenced><mi>l</mi></mfenced><mo>&lt;</mo><mn>0.5</mn></mtd></mtr><mtr><mtd><msub><mi mathvariant="italic">SCR</mi><mi mathvariant="italic">ij</mi></msub><mfenced><mi>l</mi></mfenced></mtd><mtd><mi mathvariant="italic">otherwise</mi></mtd></mtr></mtable></mrow></math><img id="ib0004" file="imgb0004.tif" wi="87" he="15" img-content="math" img-format="tif"/></maths> The overlay blend mode attempts to address the shortcomings in the multiply and screen blend modes when dealing with very bright or dark compositing layers by selecting the multiply mode if the pixel value is less than a threshold and the screen mode if the pixel value is greater than the threshold.</p><p id="p0023" num="0023">Next, a special blend value is calculated for the pixel in the blended image from the multiply and overlay pixel values, the mixing parameter <i>k</i>, and the luminosity of the pixel color in either the textural or the spatial mineral distribution image. The special blend value is computed as a weighted average of the multiply and overlay pixel values, where the weights are determined by the product r = <i>k</i> * <i>Y,</i> where <i>k</i> is the optional mixing parameter and Y is the luminosity of the pixel color in the textural or spatial mineral distribution image. Thus, the special blend <i>SB<sub>ij</sub>(l)</i> value of the pixel is given by: <maths id="math0005" num="(eq. 5)"><math display="block"><msub><mi mathvariant="italic">SB</mi><mi mathvariant="italic">ij</mi></msub><mfenced><mi>l</mi></mfenced><mo>=</mo><mi>r</mi><mo>⁢</mo><msub><mi>M</mi><mi mathvariant="italic">ij</mi></msub><mfenced><mi>l</mi></mfenced><mo>+</mo><mfenced separators=""><mn>1</mn><mo>-</mo><mi>r</mi></mfenced><mo>⁢</mo><msub><mi>O</mi><mi mathvariant="italic">ij</mi></msub><mfenced><mi>l</mi></mfenced></math><img id="ib0005" file="imgb0005.tif" wi="78" he="10" img-content="math" img-format="tif"/></maths> Since both the mixing parameter <i>k</i> and the pixel intensity Y are normalized to lie in the range of 0 to 1, the weight r also lies in the range of 0 to 1. Note that when the special mixing parameter <i>k</i> = <i>1,</i> the weight r reduces to the luminosity Y as if there were no mixing parameter <i>k</i>.</p><p id="p0024" num="0024">As a weighted average, the special blend provides for continuous blending of the textural and spatial mineral distribution images, with no thresholding. It produces a blended image that is optimized for both low and high luminosity areas in the spatial mineral distribution image, when blended with both low and high luminosity areas in the textural image. High intensity colors in the spatial mineral distribution image (e.g., bright reds and yellows) retain their chrominance in the blended image and are easily discernible, even when blended with high intensity areas of the textural image. Moreover, high intensity colors in the spatial mineral distribution image retain their luminance in the<!-- EPO <DP n="8"> --> blended image, even when blended with low intensity areas of the textural image.</p><p id="p0025" num="0025"><figref idrefs="f0002">FIG. 2A</figref> is an illustration of a blended image made by blending a textural image with a spatial mineral distribution image using the multiply blend mode. The blended textural and spatial mineral distribution images were made for a sample containing the minerals pyrite (bright yellow) and rutile (red). As seen in the illustration, while the multiply blend image preservers the colors of the pyrite and rutile minerals, it is everywhere else too dark, and fails to preserve useful information from the textural and the spatial mineral distribution images.</p><p id="p0026" num="0026"><figref idrefs="f0002">FIG. 2B</figref> is an illustration of a blended image made by blending a textural image with a spatial mineral distribution image using the screen blend mode. As seen in the illustration, the screen blend image is lighter than the multiply blend image shown in <figref idrefs="f0002">FIG. 2A</figref>. As a result, more information from both the textural and spatial mineral distribution images is revealed. Nonetheless, the high luminosity colors for pyrite and rutile are significantly faded, resulting in a loss of information from the spatial mineral distribution image.</p><p id="p0027" num="0027"><figref idrefs="f0003">FIG. 2C</figref> is an illustration of a blended image made by blending a textural image with a spatial mineral distribution image using the overlay blend mode. As seen in the illustration, the overlay blend image is lighter than the multiply blend image shown in <figref idrefs="f0002">FIG. 2A</figref>, but darker than the screen blend image shown in <figref idrefs="f0002">FIG. 2B</figref>. As a result, more information from both the textural and spatial mineral distribution images is revealed in the overlay blended image. Nonetheless, the high luminosity colors for pyrite and rutile remain faded in the blended image, resulting in a loss of information from the spatial mineral distribution image.</p><p id="p0028" num="0028"><figref idrefs="f0003">FIG. 2D</figref> is an illustration of a blended image made by blending a textural image with a spatial mineral distribution image using the special blend mode. As seen in the illustration, the special blend image is lighter than the multiply blend image shown in <figref idrefs="f0002">FIG. 2A</figref>, but darker than the overlay blend image shown in <figref idrefs="f0003">FIG. 2C</figref>. As a result, more information from both the textural and spatial mineral distribution images is revealed. Moreover, the high luminosity colors for pyrite and rutile continue to stand out in the special blend image, preserving information about these minerals in the sample recorded in the spatial mineral distribution image</p><p id="p0029" num="0029">The methods disclosed herein can be used to blend any type of textural and spatial mineral distribution information. In some embodiments, the textural image can be a per pixel record of the total number of x-rays emitted by the sample at the pixel scan position. In this embodiment, the blended image can provide a user with<!-- EPO <DP n="9"> --> information regarding confidence in the mineral identification for the sample. For example, if a sample's spatial mineral distribution image contained a large monotone red area (indicating the identification of rutile in some area of the sample), and the sample's textural image (composed of per-pixel x-ray counts) showed large counts in the center of the red area but smaller counts toward its edges, the corresponding area in the blended image would be different shades of red corresponding to the different x-ray pixel counts in the textural image. Where the x-ray count is larger (e.g., in the center), the red in the blended image would be a brighter shade than in those areas where the x-ray count is smaller (e.g., along the edges). Since the likelihood of correctly identifying a mineral is proportional to the x-ray count, areas of the blended image having a brighter shade of a pure mineral color (e.g., red, blue) will be areas of higher mineral identification confidence, while areas of the blended image having a darker shade of a pure mineral color will be areas of lower mineral identification confidence.</p><p id="p0030" num="0030"><figref idrefs="f0004">FIG. 3</figref> is a flow chart depicting, in yet another embodiment of the invention, a method for blending elemental and mineral distribution images. Both the elemental distribution image and the mineral distribution image can be obtained by analyzing, on a per pixel basis, the energy distribution of x-rays emitted from a sample when bombarded with charged particles. As shown in <figref idrefs="f0004">FIG. 3</figref>, the process begins by raster scanning the sample (300). Next, for each pixel in the image (310), an x-ray emission spectrum is obtained (320). This sample x-ray emission spectrum is then analyzed to determine both the elemental (330) and the mineral (340) composition of the sample at the pixel scan position. This process is repeated (350), for all pixels or scan positions for the sample.</p><p id="p0031" num="0031">As disclosed in <patcit id="pcit0003" dnum="US86669709A"><text>U.S. Patent Application No. 12/866,697, filed on Feb. 6, 2009</text></patcit>, which is herein incorporated by reference, the elemental distribution image for the sample can be obtained by fitting, on a per pixel basis, the sample's x-ray emission spectrum with elemental x-ray emission spectra to determine the number, kind, and percentage of elements present in the sample. The elemental composition so determined can then be used to determine the mineral composition and the mineral distribution of the sample. Moreover, for each element present in the sample, an elemental distribution image can be generated by assigning a grayscale value to each pixel in the image corresponding to the percentage of the element found in the sample at that pixel location or scan position.</p><p id="p0032" num="0032">As disclosed in <patcit id="pcit0004" dnum="US07352313A"><text>U.S. Patent Application No. 14/073,523, filed on Nov. 6, 2013</text></patcit>, which is herein incorporated by reference in its entirety, the spatial mineral<!-- EPO <DP n="10"> --> distribution image for the sample can also be obtained by fitting, on a per pixel basis, the sample's x-ray emission spectra with mineral x-ray emission spectra to determine the number, kind, and percentage of minerals present in the sample. Each mineral determined to be present in the sample can be assigned a color, and when more than one mineral is present the colors can be blended together, with the amount of blend determined by the percentage of mineral present in the sample.</p><p id="p0033" num="0033">Referring again to <figref idrefs="f0004">FIG. 3</figref>, once the elemental and mineral distribution images are obtained, an elemental selection can be received. For example, the process can present a user with a list of elements and minerals identified in the sample, and with the percentages of each. The user can then select a particular element for forming a blended image. For example, the user can select the element by entering its name in a text box, or by selecting a radio button or check box associated with the element in a graphical user interface. Once selected, the elemental distribution image and the mineral distribution image can be combined.</p><p id="p0034" num="0034">In one embodiment, the elemental and mineral distribution images can be combined using the special blend mode discussed above in reference to <figref idrefs="f0001">FIG. 1</figref>.</p><p id="p0035" num="0035">In other embodiments, the elemental and mineral distribution images can be combined using any conventional image blending function. For example, the grayscale value recorded in the elemental distribution image can be used to determine the opacity of the mineral distribution image. In this way, the blended image will only contain areas of the mineral distribution image that overlap with areas in the elemental distribution image. All other areas of the blended image will appear black. Moreover, the shades of color244 assigned to minerals identified in the mineral distribution image will vary in the blended image depending on the percentage of the selected element found in the elemental distribution image. Identified mineral colors in the blended image will be brightest in those areas corresponding to elemental distribution image areas having a high percentage of the selected element, and darkest in those areas corresponding to elemental distribution image areas having a low percentage of the selected element.</p><p id="p0036" num="0036">In some embodiments, when an element selection is received in step 360, an elemental threshold can be optionally received. In these embodiments, pixels in the elemental distribution image will only be blended with pixels in the mineral distribution image if they are above the elemental threshold. For example, if the received elemental threshold is 12%, the blended image will only contain pixels in the mineral distribution image blended with pixels in the elemental distribution image that have a grayscale value greater than 0.12. Pixels in the elemental distribution image having a<!-- EPO <DP n="11"> --> grayscale value less than 0.12 will appear black in the blended image. In this way, regions of interest, defined as regions having an elemental composition greater than a specified threshold value, can be easily defined and displayed.</p><p id="p0037" num="0037"><figref idrefs="f0005">FIG. 4</figref> is an illustration of a blended image made by blending an elemental distribution image with a mineral distribution image. In <figref idrefs="f0005">FIG. 4</figref>, the selected element is magnesium (Mg), and the blended image shows areas of a sample where Mg is present in either dolomite (blue) or clay (green). As seen from the image, different shades of green indicate areas containing clays (identified in the mineral distribution image) having different percentages of Mg (determined from elemental distribution image).</p><p id="p0038" num="0038"><figref idrefs="f0006">FIG. 5</figref> is an illustration of a mineral identification and analysis system 200. The mineral identification system 200 includes a scanning electron beam system 241, an x-ray detector 240, and a secondary or backscatter electron detector 243. An electron beam 232 emitted from a cathode 253 is accelerated toward an anode 254. Electron beam 232 is subsequently focused to a fine spot by means of a condensing lens 256 and an objective lens 258, and can be deflected across a sample 202 by means of a deflection coil 260 to perform a two-dimensional raster scan of the sample. The condensing lens 256, objective lens 258, and deflection coil 260 are supplied current by a power supply 245 operated under the control of a system controller 233. The sample 202 is preferably mounted on a movable X-Y stage 204 within a lower vacuum chamber 210. The vacuum chamber 210 is evacuated to high vacuum by a mechanical pumping system 269 and an ion pump 268 operated under the control of vacuum controller 234.</p><p id="p0039" num="0039">When the electron beam 232 strikes the sample 202, several forms of radiation are emitted, including backscattered electrons from the electron beam 232, secondary electrons produced by interactions between the electron beam 232 and the sample, and x-rays produced by interactions between the electron beam 232 and the sample that are characteristic of the elements in the sample. The back scattered electrons are detected by an electron detector 242, which outputs a signal indicative of the flux or intensity of back scattered electrons. This signal is received by processor 220. The x-rays emitted from the sample are detected by x-ray detector 240, which preferably outputs a signal indicative of the energy of the detected x-rays. To that end, x-ray detector 240 is preferably an energy dispersive detector such as a silicon drift detector. The output signal of x-ray detector 240 can be amplified and received by processor 220. The back-scattered or secondary electrons are detected by an electron detector, such as a<!-- EPO <DP n="12"> --></p><p id="p0040" num="0040">Processor 220 can be programmed to store, for each scanned pixel, a count of the number of back scattered electrons detected, a count of the number of x-rays detected, and a histogram counting the number of x-rays detected in each of a plurality of energy bins over some energy range. Typically, the energy range is on the order of 0 - 10keV, and is subdivided into energy bins of 10-20 eV, for a total of 500 to 1000 energy bins or channels per pixel.</p><p id="p0041" num="0041">System 200 also includes a display 244 for displaying the results of the textural and mineral analysis and other information by way of video circuit 292; a program memory 222 for storing executable computer program code to program the processor 220, and a data memory 223 /224 for storing data, such as per-pixel BSE counts, x-ray counts, and x-ray emission spectra recorded from sample 202, and a library of standardized elemental or mineral x-ray emission spectra. Program memory 222 can include computer storage media in the form of removable and/or non-removable, volatile and/or nonvolatile memory and can provide storage of computer-readable instructions, data structures, program modules and other data. Generally, the processor 220 is programmed by means of instructions stored in the various computer-readable storage media. Programs and operating systems are typically distributed, for example, on floppy disks or CD-ROMs. From there, they are installed or loaded into the secondary memory of a computer. At execution, they are loaded at least partially into the computer's primary electronic memory. The invention described herein includes these and other various types of computer-readable storage media when such media contain instructions or programs for implementing the steps described above in conjunction with a microprocessor or other data processor. The invention also includes the computer itself when programmed according to the methods and techniques described herein.</p><p id="p0042" num="0042">While the embodiment shown uses a scanning electron microscope to generate x-rays from sample 202, other embodiments could employ a transmission electron microscope or a scanning transmission electron microscope. An x-ray fluorescence system could also be used to generate x-rays from sample 202. In other embodiments, different forms of characteristic radiation emitted from the sample, such as gamma rays, may be detected.</p><p id="p0043" num="0043">According to some embodiments of the present invention, a computer implemented method for blending mineralogy images of a sample, comprises receiving a base layer mineralogy image of the sample; receiving a top layer mineralogy image of the sample; generating, via a computer processor, a blended image of the sample; and displaying the blended image; characterized in that generating a blended<!-- EPO <DP n="13"> --> image of the sample comprises blending the base layer mineralogy and top layer mineralogy images of the sample.</p><p id="p0044" num="0044">In some embodiments, blending the base layer mineralogy and top layer mineralogy images of the sample, comprises, for each pixel in the base layer mineralogy and top layer mineralogy images, determining a base layer value from the pixel in the base layer image; determining a top layer value from the pixel in the top layer image; determining a luminosity value from one of the base layer or top layer values; determining a multiply value by multiplying the base and top layer values; determining an overlay value by doubling the multiply value if one of the base layer or top layer values is less than a threshold, and by otherwise inverting twice the product of the inverted top layer value with the inverted bottom layer value; determining an image blending weight from the luminosity value; and determining a blended image value for the pixel as a weighted average of the multiply value and the overlay value, wherein the multiply value is weighted by the image blending weight and the overlay value is weighted by the inverted image blending weight.</p><p id="p0045" num="0045">In some embodiments, the base layer mineralogy image comprises an elemental distribution image and the top layer mineralogy image comprises a mineral distribution image. In some embodiments, blending the elemental and mineral distribution images of the sample, comprises, for each pixel in the elemental and mineral distribution images, determining a top layer value from the pixel in the mineral distribution image; determining an opacity value from the pixel in the elemental distribution image; and alpha blending the top layer value with a black pixel value using the opacity value. In some embodiments, the computer implemented method further comprises receiving an elemental threshold; and wherein generating a blended image of the sample by blending the elemental and mineral distribution images of the sample comprises rendering a pixel of the blended image black when a corresponding pixel of the elemental distribution image has a value that is less than the elemental threshold.</p><p id="p0046" num="0046">In some embodiments, the base layer mineralogy image comprises a textural mineralogy image and the top layer mineralogy image comprises a spatial distribution image. In some embodiments, the textural mineralogy image is an image of the intensity of back-scattered electrons.</p><p id="p0047" num="0047">In some embodiments, the luminosity value is determined from the top layer value. In some embodiments, the overlay value is determined by doubling the multiply value if the top layer value is less than a threshold, and by otherwise inverting twice the product of the inverted top layer value with the inverted bottom layer value. In<!-- EPO <DP n="14"> --> some embodiments, the computer implemented method further comprises receiving a mixing parameter; and determining the image blending weight by multiplying the luminosity value by the mixing parameter.</p><p id="p0048" num="0048">According to some embodiments of the present invention, a computer program product, stored on a non-transitory computer readable medium, comprising instructions operable to cause a programmable processor to perform any of the methods described above.</p><p id="p0049" num="0049">According to some embodiments of the present invention, a charged particle beam apparatus, comprises a charged particle beam source for illuminating a portion of the sample; at least one detector for detecting radiation emitted from the illuminated portion of the sample; and a program memory for storing executable computer program code to program one or more programmable processors to perform any of the methods described above.</p><p id="p0050" num="0050">Although much of the previous description is directed at mineral samples from drill cores, the invention could be used to prepare samples of any suitable material. The terms "work piece," "sample," "substrate," and "specimen" are used interchangeably in this application unless otherwise indicated. Further, whenever the terms "automatic," "automated," or similar terms are used herein, those terms will be understood to include manual initiation of the automatic or automated process or step.</p><p id="p0051" num="0051">In the following discussion and in the claims, the terms "including" and "comprising" are used in an open-ended fashion, and thus should be interpreted to mean "including, but not limited to ...." To the extent that any term is not specially defined in this specification, the intent is that the term be given its plain and ordinary meaning. The accompanying drawings are intended to aid in understanding the present invention and, unless otherwise indicated, are not drawn to scale. Particle beam systems suitable for carrying out the present invention are commercially available, for example, from FEI Company, the assignee of the present application.</p><p id="p0052" num="0052">Although the present invention and its advantages have been described in detail, it should be understood that various changes, substitutions and alterations can be made to the embodiments described herein without departing from the invention as defined by the appended claims. Moreover, the present application is not intended to be limited to the particular embodiments of the process, machine, manufacture, composition of matter, means, methods and steps described in the specification. As one of ordinary skill in the art will readily appreciate from the disclosure of the present invention, processes, machines, manufacture, compositions of matter, means, methods, or steps,<!-- EPO <DP n="15"> --> presently existing or later to be developed that perform substantially the same function or achieve substantially the same result as the corresponding embodiments described herein may be utilized according to the present invention. Accordingly, the appended claims are intended to include such processes, machines, manufacture, compositions of matter, means, methods, or steps.</p></description><claims mxw-id="PCLM90459837" lang="EN" load-source="patent-office"><!-- EPO <DP n="16"> --><claim id="c-en-0001" num="1"><claim-text><b>1.</b> A computer implemented method for blending mineralogy images of a sample (202), comprising:
<claim-text>receiving a base layer mineralogy image of the sample;</claim-text>
<claim-text>receiving a top layer mineralogy image of the sample;</claim-text>
<claim-text>generating, via a computer processor (220), a blended image of the sample; and</claim-text>
<claim-text>displaying the blended image (244);</claim-text>
<claim-text><b>characterized in that</b> generating a blended image of the sample comprises blending the base layer mineralogy and top layer mineralogy images of the sample.</claim-text></claim-text></claim><claim id="c-en-0002" num="2"><claim-text><b>1.</b> The computer implemented method of claim 1, wherein blending the base layer mineralogy and top layer mineralogy images of the sample, comprises, for each pixel in the base layer mineralogy and top layer mineralogy images:
<claim-text>determining a base layer value from the pixel in the base layer mineralogy image;</claim-text>
<claim-text>determining a top layer value from the pixel in the top layer mineralogy image;</claim-text>
<claim-text>determining a luminosity value from one of the base layer or top layer values;</claim-text>
<claim-text>determining a multiply value by multiplying the base and top layer values;</claim-text>
<claim-text>determining an overlay value by doubling the multiply value if one of the base layer or top layer values is less than a threshold, and by otherwise inverting twice the product of the inverted top layer value with the inverted bottom layer value;</claim-text>
<claim-text>determining an image blending weight from the luminosity value; and</claim-text>
<claim-text>determining a blended image value for the pixel as a weighted average of the multiply value and the overlay value, wherein the multiply value is weighted by the image blending weight and the overlay value is weighted by the inverted image blending weight.</claim-text></claim-text></claim><claim id="c-en-0003" num="3"><claim-text><b>2.</b> The computer implemented method of claim 1 or claim 2 in which the base layer mineralogy image comprises an elemental distribution image and the top layer mineralogy image comprises a mineral distribution image.</claim-text></claim><claim id="c-en-0004" num="4"><claim-text><b>3.</b> The computer implemented method of claim 3, wherein blending the elemental and mineral distribution images of the sample, comprises, for each pixel in the elemental and mineral distribution images:
<claim-text>determining a top layer value from the pixel in the mineral distribution image;</claim-text>
<claim-text>determining an opacity value from the pixel in the elemental distribution image;<!-- EPO <DP n="17"> --> and</claim-text>
<claim-text>alpha blending the top layer value with a black pixel value using the opacity value.</claim-text></claim-text></claim><claim id="c-en-0005" num="5"><claim-text><b>4.</b> The computer implemented method of claim 3 or claim 4, further comprising:
<claim-text>receiving an elemental threshold; and</claim-text>
<claim-text>wherein generating a blended image of the sample by blending the elemental and mineral distribution images of the sample comprises rendering a pixel of the blended image black when a corresponding pixel of the elemental distribution image has a value that is less than the elemental threshold.</claim-text></claim-text></claim><claim id="c-en-0006" num="6"><claim-text><b>5.</b> The computer implemented method of claim 1 or claim 2 in which the base layer mineralogy image comprises a textural mineralogy image and the top layer mineralogy image comprises a spatial distribution image.</claim-text></claim><claim id="c-en-0007" num="7"><claim-text><b>6.</b> The computer implemented method of claim 6 wherein the textural mineralogy image is an image of the intensity of back-scattered electrons.</claim-text></claim><claim id="c-en-0008" num="8"><claim-text><b>7.</b> The computer implemented method of any of claims 2 - 7, wherein the luminosity value is determined from the top layer value.</claim-text></claim><claim id="c-en-0009" num="9"><claim-text><b>8.</b> The computer implemented method of any of claims 2 - 8, wherein the overlay value is determined by doubling the multiply value if the top layer value is less than a threshold, and by otherwise inverting twice the product of the inverted top layer value with the inverted bottom layer value.</claim-text></claim><claim id="c-en-0010" num="10"><claim-text><b>9.</b> The computer implemented method of any of the preceding claims, further comprising:
<claim-text>receiving a mixing parameter; and</claim-text>
<claim-text>determining the image blending weight by multiplying the luminosity value by the mixing parameter.</claim-text></claim-text></claim><claim id="c-en-0011" num="11"><claim-text><b>10.</b> A computer program product, stored on a non-transitory computer readable medium, comprising instructions operable to cause a programmable processor (220) to perform the method of any of the preceding claims.<!-- EPO <DP n="18"> --></claim-text></claim><claim id="c-en-0012" num="12"><claim-text><b>11.</b> A charged particle beam apparatus, comprising:
<claim-text>a charged particle beam source (253) for illuminating a portion of a sample (202);</claim-text>
<claim-text>at least one detector (240, 243) for detecting radiation emitted from the illuminated portion of the sample; and</claim-text>
<claim-text>a program memory (222) for storing executable computer program code to program one or more programmable processors (220) to perform the method of any of claims 1 - 10.</claim-text></claim-text></claim></claims><drawings mxw-id="PDW20422549" load-source="patent-office"><!-- EPO <DP n="19"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="126" he="229" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="20"> --><figure id="f0002" num="2A,2B"><img id="if0002" file="imgf0002.tif" wi="100" he="146" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="21"> --><figure id="f0003" num="2C,2D"><img id="if0003" file="imgf0003.tif" wi="97" he="145" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="22"> --><figure id="f0004" num="3"><img id="if0004" file="imgf0004.tif" wi="94" he="225" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="23"> --><figure id="f0005" num="4"><img id="if0005" file="imgf0005.tif" wi="157" he="146" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="24"> --><figure id="f0006" num="5"><img id="if0006" file="imgf0006.tif" wi="157" he="141" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="157" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="157" he="233" type="tif"/><doc-page id="srep0003" file="srep0003.tif" wi="157" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
