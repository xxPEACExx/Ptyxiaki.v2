<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2960860-A1" country="EP" doc-number="2960860" kind="A1" date="20151230" family-id="51176300" file-reference-id="254717" date-produced="20180826" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160451821" ucid="EP-2960860-A1"><document-id><country>EP</country><doc-number>2960860</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-14305994-A" is-representative="YES"><document-id mxw-id="PAPP193866610" load-source="docdb" format="epo"><country>EP</country><doc-number>14305994</doc-number><kind>A</kind><date>20140624</date><lang>EN</lang></document-id><document-id mxw-id="PAPP193866611" load-source="patent-office" format="original"><country>EP</country><doc-number>14305994.7</doc-number><date>20140624</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162032848" ucid="EP-14305994-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>14305994</doc-number><kind>A</kind><date>20140624</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1988525772" load-source="docdb">G06T  11/60        20060101ALI20150128BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988527728" load-source="docdb">G06T   7/00        20060101AFI20150128BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1861372014" load-source="docdb" scheme="CPC">G06T  11/60        20130101 FI20150123BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1861377026" load-source="docdb" scheme="CPC">G06T   7/12        20170101 LI20170102BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1861378598" load-source="docdb" scheme="CPC">G06T   7/155       20170101 LI20170102BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1957285878" load-source="docdb" scheme="CPC">G06T2207/20116     20130101 LA20160324BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1957288747" load-source="docdb" scheme="CPC">G06T2207/20132     20130101 LA20160324BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987790805" load-source="docdb" scheme="CPC">G06T2207/20096     20130101 LA20150123BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165546929" lang="DE" load-source="patent-office">Verfahren und Vorrichtung zum Klonen eines Objekts aus einem Quellbild zu einem Zielbild</invention-title><invention-title mxw-id="PT165546930" lang="EN" load-source="patent-office">Method and apparatus for cloning an object from a source image to a target image</invention-title><invention-title mxw-id="PT165546931" lang="FR" load-source="patent-office">Procédé et appareil pour cloner un objet à partir d'une image source vers une image cible</invention-title><citations><non-patent-citations><nplcit><text>ASEEM AGARWALA ET AL: "Interactive digital photomontage", ACM TRANSACTIONS ON GRAPHICS, vol. 3, no. 23, 1 August 2004 (2004-08-01), pages 294 - 302, XP055164343, ISSN: 0730-0301, DOI: 10.1145/1015706.1015718</text><sources><source mxw-id="PNPL57937434" load-source="docdb" name="SEA" category="A"/></sources></nplcit><nplcit><text>ERIC N. MORTENSEN ET AL: "Intelligent scissors for image composition", PROCEEDINGS OF THE 22ND ANNUAL CONFERENCE ON COMPUTER GRAPHICS AND INTERACTIVE TECHNIQUES , SIGGRAPH '95, 6 August 1995 (1995-08-06), New York, New York, USA, pages 191 - 198, XP055164568, ISBN: 978-0-89-791701-8, DOI: 10.1145/218380.218442</text><sources><source mxw-id="PNPL63883883" load-source="docdb" name="SEA" category="A"/></sources></nplcit><nplcit><text>FANG-LUE ZHANG ET AL: "ImageAdmixture: Putting Together Dissimilar Objects from Groups", IEEE TRANSACTIONS ON VISUALIZATION AND COMPUTER GRAPHICS, IEEE SERVICE CENTER, LOS ALAMITOS, CA, US, vol. 18, no. 11, 1 November 2012 (2012-11-01), pages 1849 - 1857, XP011460061, ISSN: 1077-2626, DOI: 10.1109/TVCG.2012.68</text><sources><source mxw-id="PNPL57937436" load-source="docdb" name="SEA" category="XI"/></sources></nplcit><nplcit><text>FARBMAN, Z.; HOFFER, G.; LIPMAN, Y.; COHEN-OR, D.; LISCHINSKI, D.: "Coordinates for instant image cloning", ACM TRANSACTIONS ON GRAPHICS (TOG, vol. 28, no. 3, July 2009 (2009-07-01), pages 67, XP055162676, DOI: doi:10.1145/1531326.1531373</text><sources><source mxw-id="PNPL63883884" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>JIAYA JIA ET AL: "Drag-and-drop pasting", ACM TRANSACTIONS ON GRAPHICS, vol. 25, no. 3, 1 July 2006 (2006-07-01), pages 631, XP055151245, ISSN: 0730-0301, DOI: 10.1145/1141911.1141934</text><sources><source mxw-id="PNPL57937438" load-source="docdb" name="SEA" category="A"/></sources></nplcit><nplcit><text>PEREZ P ET AL: "Poisson image editing", 1 July 2003, ACM TRANSACTIONS ON GRAPHICS (TOG), ACM, US, PAGE(S) 313 - 318, ISSN: 0730-0301, XP040167345</text><sources><source mxw-id="PNPL57937439" load-source="docdb" name="SEA" category="A"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR1103310397" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>THOMSON LICENSING</last-name><address><country>FR</country></address></addressbook></applicant><applicant mxw-id="PPAR1103326213" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>THOMSON LICENSING</last-name></addressbook></applicant><applicant mxw-id="PPAR1101651693" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Thomson Licensing</last-name><iid>101157220</iid><address><street>1-5, rue Jeanne d'Arc</street><city>92130 Issy-Les-Moulineaux</city><country>FR</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103306342" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>MARQUANT GWENAËLLE</last-name><address><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103317659" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>MARQUANT, Gwenaëlle</last-name></addressbook></inventor><inventor mxw-id="PPAR1101642106" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>MARQUANT, Gwenaëlle</last-name><address><street>c/o Technicolor R&amp;D France 975 Avenue des Champs Blancs CS 17616</street><city>35576 Cesson-Sévigné</city><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103311323" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>HELLIER PIERRE</last-name><address><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103335288" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>HELLIER, PIERRE</last-name></addressbook></inventor><inventor mxw-id="PPAR1101639839" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>HELLIER, PIERRE</last-name><address><street>c/o Technicolor R&amp;D France 975 Avenue des Champs Blancs CS 17616</street><city>35576 Cesson-Sévigné</city><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103327295" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>OISEL LIONEL</last-name><address><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR1103325285" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>OISEL, LIONEL</last-name></addressbook></inventor><inventor mxw-id="PPAR1101644802" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>OISEL, LIONEL</last-name><address><street>c/o Technicolor R&amp;D France 975 Avenue des Champs Blancs CS 17616</street><city>35576 Cesson-Sévigné</city><country>FR</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR1101643031" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Huchet, Anne</last-name><iid>101463286</iid><address><street>Technicolor 1-5 rue Jeanne d'Arc</street><city>92130 Issy-Les-Moulineaux</city><country>FR</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS660615452" load-source="docdb">AL</country><country mxw-id="DS660702068" load-source="docdb">AT</country><country mxw-id="DS660615453" load-source="docdb">BE</country><country mxw-id="DS660611138" load-source="docdb">BG</country><country mxw-id="DS660785219" load-source="docdb">CH</country><country mxw-id="DS660615454" load-source="docdb">CY</country><country mxw-id="DS660690968" load-source="docdb">CZ</country><country mxw-id="DS660615074" load-source="docdb">DE</country><country mxw-id="DS660615459" load-source="docdb">DK</country><country mxw-id="DS660615460" load-source="docdb">EE</country><country mxw-id="DS660693262" load-source="docdb">ES</country><country mxw-id="DS660611151" load-source="docdb">FI</country><country mxw-id="DS660611152" load-source="docdb">FR</country><country mxw-id="DS660615083" load-source="docdb">GB</country><country mxw-id="DS660615461" load-source="docdb">GR</country><country mxw-id="DS660615084" load-source="docdb">HR</country><country mxw-id="DS660690969" load-source="docdb">HU</country><country mxw-id="DS660785220" load-source="docdb">IE</country><country mxw-id="DS660615462" load-source="docdb">IS</country><country mxw-id="DS660611153" load-source="docdb">IT</country><country mxw-id="DS660615471" load-source="docdb">LI</country><country mxw-id="DS660615085" load-source="docdb">LT</country><country mxw-id="DS660702069" load-source="docdb">LU</country><country mxw-id="DS660611154" load-source="docdb">LV</country><country mxw-id="DS660615086" load-source="docdb">MC</country><country mxw-id="DS660702070" load-source="docdb">MK</country><country mxw-id="DS660702075" load-source="docdb">MT</country><country mxw-id="DS660693447" load-source="docdb">NL</country><country mxw-id="DS660693343" load-source="docdb">NO</country><country mxw-id="DS660693448" load-source="docdb">PL</country><country mxw-id="DS660611179" load-source="docdb">PT</country><country mxw-id="DS660690970" load-source="docdb">RO</country><country mxw-id="DS660611180" load-source="docdb">RS</country><country mxw-id="DS660693449" load-source="docdb">SE</country><country mxw-id="DS660785221" load-source="docdb">SI</country><country mxw-id="DS660693344" load-source="docdb">SK</country><country mxw-id="DS660693345" load-source="docdb">SM</country><country mxw-id="DS660702076" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA166480191" lang="EN" load-source="patent-office"><p id="pa01" num="0001">A method and an apparatus for cloning an object from a source image to a target image are suggested. The suggested method comprises: creating a segmentation curve for the object to be cloned in the source image; calculating a stopping criterion as a function of the spatial gradients in the surroundings of the segmentation curve; adapting the segmentation curve according to a comparison between the stopping criterion and a threshold; and cloning the object with the adapted segmentation curve to the target image. According to the suggested method and an apparatus, a user can be provided with at least one modified segmentation curve adapted according to a comparison between a stopping criterion as a function of the spatial gradients in the surroundings of the segmentation curve and a threshold. Upon the validation of the user, the modified segmentation curve is used for the cloning process, which can improve the subjective quality of the cloning even with low-quality segmentation.
<img id="iaf01" file="imgaf001.tif" wi="77" he="130" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA166760003" lang="EN" source="EPO" load-source="docdb"><p>A method and an apparatus for cloning an object from a source image to a target image are suggested. The suggested method comprises: creating a segmentation curve for the object to be cloned in the source image; calculating a stopping criterion as a function of the spatial gradients in the surroundings of the segmentation curve; adapting the segmentation curve according to a comparison between the stopping criterion and a threshold; and cloning the object with the adapted segmentation curve to the target image. According to the suggested method and an apparatus, a user can be provided with at least one modified segmentation curve adapted according to a comparison between a stopping criterion as a function of the spatial gradients in the surroundings of the segmentation curve and a threshold. Upon the validation of the user, the modified segmentation curve is used for the cloning process, which can improve the subjective quality of the cloning even with low-quality segmentation.</p></abstract><description mxw-id="PDES98404892" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><b><u>TECHNICAL FIELD</u></b></heading><p id="p0001" num="0001">The present disclosure generally relates to image and video processing. In particular, the present disclosure relates to a method and an apparatus for cloning an object from a source image to a target image.</p><heading id="h0002"><b><u>BACKGROUND</u></b></heading><p id="p0002" num="0002">In image processing, cloning refers to the process of segmenting an object in an image (referred to as the source image hereinafter) in order to place it into another image (referred to as the target image hereinafter). For non-professional image and video editing, seamless cloning is required to obtain good subjective quality results.</p><p id="p0003" num="0003">In a reference of <nplcit id="ncit0001" npl-type="s"><text>Farbman, Z., Hoffer, G., Lipman, Y., Cohen-Or, D., &amp; Lischinski, D. (2009, July), entitled "Coordinates for instant image cloning", ACM Transactions on Graphics (TOG) (Vol. 28, No. 3, p. 67</text></nplcit>) (referred to as [Farbman2009] hereinafter), a cloning method based on user interaction is proposed. According to the method in [Farbman2009], the user can paint over a portion of the boundary that causes an undesirable artifact in the cloned result. In this manner the marked boundary vertices are transmitted to the cloning routine as not participating in the membrane evaluation. Consequently, the mean value weights are set to zero (and the remaining weights are re-normalized accordingly).</p><p id="p0004" num="0004">The contour of the segmented object can be modified in the cloning process. However, some unwanted details may still lay in the contour of the object to be cloned and result in visual artifacts in the cloning scene.</p><p id="p0005" num="0005">Next, the conventional cloning process will be introduced in more details with reference to <figref idrefs="f0001 f0002">Figures 1-4</figref>.</p><p id="p0006" num="0006">A cloning process can be based on a rough drawing of the boundary of an object in a source image. Such rough drawing can be quickly made with a mouse or with a finger of a user on a touch screen on which the source image is displayed. This will lead to the segmentation curve 101 shown in <figref idrefs="f0001">Figure 1</figref>. The drawing can then be dilated, which leads to the segmentation curve 102 shown in <figref idrefs="f0001">Figure 1</figref>, in order to have a boundary curve outside the object to be cloned. The<!-- EPO <DP n="2"> --> boundary curve 102 is used to cut out the object and paste/insert the object somewhere else, normally, a target image. The mentioned dilation can be obtained by using a circular or square morphological operator of arbitrary size. The size can be initially set to 10 pixels by the system and can be modified by the user.</p><p id="p0007" num="0007"><figref idrefs="f0001">Figure 2</figref> shows the result of a basic cut &amp; paste operation (on the left) and the cloning result (on the right).</p><p id="p0008" num="0008">However, there might still be some unwanted artifact (generally high frequencies) in the surroundings of the object to be cloned. <figref idrefs="f0002">Figure 3</figref> is a diagram showing an unwanted artifact. As shown in <figref idrefs="f0002">Figure 3</figref>, the beak of another penguin that stands up near to the one to be duplicated appears inside the patch to be cloned.</p><p id="p0009" num="0009"><figref idrefs="f0002">Figure 4</figref> is a diagram showing the result of the seamless cloning from the source image to a target image based on the patch shown in <figref idrefs="f0002">Figure 3</figref>. As shown in <figref idrefs="f0002">Figure 4</figref>, the piece of the beak is apparently undesirable in the sky.</p><p id="p0010" num="0010">Therefore, there is a need for a solution for cloning an object from an image to a target image, which can improve the subjective quality of a cloning process even with low-quality segmentation.</p><heading id="h0003"><b><u>SUMMARY</u></b></heading><p id="p0011" num="0011">In view of the above problem in the conventional technologies, the present disclosure provides a method and an apparatus for cloning an object from a source image to a target image. According to the present disclosure, the width of the dilation band is automatically and iteratively adjusted in order to avoid including unwanted details.</p><p id="p0012" num="0012">According to a first aspect of the disclosure, a method for cloning an object from a source image to a target image is provided. The method comprises: creating a segmentation curve for the object to be cloned in the source image; calculating a stopping criterion as a function of the spatial gradients in the surroundings of the segmentation curve; adapting the segmentation curve according to a comparison between the stopping criterion and a threshold; and cloning the object with the adapted segmentation curve to the target image.</p><p id="p0013" num="0013">In an embodiment, the stopping criterion is a gradient Gk at pixel k in the patch to be cloned defined by the segmentation curve and along the seam.<!-- EPO <DP n="3"> --></p><p id="p0014" num="0014">In an embodiment, the stopping criterion is a variation in cloning interpolant.</p><p id="p0015" num="0015">In an embodiment, the adaption of the segmentation curve comprises a morphological process of dilating the segmentation curve.</p><p id="p0016" num="0016">In an embodiment, the adaption of the segmentation curve comprises a morphological process of eroding the segmentation curve.</p><p id="p0017" num="0017">In an embodiment, the adaption of the segmentation curve comprises a morphological process of a mixed dilation and erosion of the segmentation curve.</p><p id="p0018" num="0018">According to a second aspect of the disclosure, an apparatus for cloning an object from a source image to a target image is provided. The apparatus comprises: an interaction unit for a user to select a source image and a target image for the cloning, and to create a segmentation curve for the object to be cloned in the source image; and an adapting unit for providing at least one modified segmentation curve adapted according to a comparison between a stopping criterion as a function of the spatial gradients in the surroundings of the segmentation curve and a threshold.</p><p id="p0019" num="0019">In an embodiment, upon the creation of the segmentation curve, the interaction unit displays the result of the cloning of the object in the target image.</p><p id="p0020" num="0020">In an embodiment, upon the selection of one of the at least one modified segmentation curve, the interaction unit displays the result of the cloning of the object in the target image.</p><p id="p0021" num="0021">In an embodiment, the adapting unit modifies the segmentation curve with a morphological process of dilating the segmentation curve.</p><p id="p0022" num="0022">In an embodiment, the adapting unit modifies the segmentation curve with a morphological process of eroding the segmentation curve.</p><p id="p0023" num="0023">In an embodiment, the adapting unit modifies the segmentation curve with a morphological process of a mixed dilation and erosion of the segmentation curve.</p><p id="p0024" num="0024">According to a third aspect of the disclosure, a computer program product downloadable from a communication network and/or recorded on a medium readable by computer and/or executable by a processor is provided. The computer program product comprises program code instructions for implementing the steps of the method according to the first aspect of the invention.</p><p id="p0025" num="0025">According to a fourth aspect of the disclosure, a Non-transitory computer-readable medium comprising a computer program product recorded thereon and capable of being run by a processor is provided. The Non-transitory computer-readable<!-- EPO <DP n="4"> --> medium includes program code instructions for implementing the steps of a method according to the first aspect of the invention.</p><p id="p0026" num="0026">It is to be understood that more aspects and advantages of the invention will be found in the following detailed description of the present invention.</p><heading id="h0004"><b><u>BRIEF DESCRIPTION OF THE DRAWINGS</u></b></heading><p id="p0027" num="0027">The accompanying drawings are included to provide further understanding of the embodiments of the invention together with the description which serves to explain the principle of the embodiments. The invention is not limited to the embodiments.</p><p id="p0028" num="0028">In the drawings:
<ul><li><figref idrefs="f0001">Figure 1</figref> is diagram showing a segmentation of an object in a source image with a mouse or a finger during a cloning process;</li><li><figref idrefs="f0001">Figure 2</figref> is a diagram showing the result of a basic cut &amp; paste operation (on the left) and the MVC cloning result (on the right);</li><li><figref idrefs="f0002">Figure 3</figref> is a diagram showing an unwanted artifact appearing inside the patch to be cloned;</li><li><figref idrefs="f0002">Figure 4</figref> is a diagram showing the result of the seamless cloning from the source image to a target image based on the patch shown in <figref idrefs="f0002">Figure 3</figref>;</li><li><figref idrefs="f0003">Figure 5</figref> is a flow chart showing a method for cloning an object from a source image to a target image according to an embodiment of the invention;</li><li><figref idrefs="f0004">Figure 6</figref> is a diagram showing gradients in the area of the cloning process for image in <figref idrefs="f0002">Figure 4</figref>;</li><li><figref idrefs="f0004">Figure 7</figref> is a diagram showing the delineation adapted according to the method of the embodiment of the invention</li><li><figref idrefs="f0005">Figure 8</figref> is a diagram showing the result of the seamless cloning based on the adaptive delineation;</li><li><figref idrefs="f0006">Figure 9</figref> is a block diagram showing a apparatus for cloning an object from a source image to a target image according to an embodiment of the invention; and</li><li><figref idrefs="f0005 f0007 f0008">Figures 10-14</figref> are diagrams showing user interfaces for implementing the method according to the embodiment of the invention.</li></ul><!-- EPO <DP n="5"> --></p><heading id="h0005"><b><u>DESCRIPTION OF EMBODIMENTS</u></b></heading><p id="p0029" num="0029">An embodiment of the present invention will now be described in detail in conjunction with the drawings. In the following description, some detailed descriptions of known functions and configurations may be omitted for conciseness.</p><p id="p0030" num="0030">An embodiment of the invention provides a method for cloning an object from a source image to a target image. Next, the method of the embodiment of the present invention will be described in details.</p><p id="p0031" num="0031"><figref idrefs="f0003">Figure 5</figref> is a flow chart showing a method for cloning an object from a source image to a target image according to an embodiment of the invention.</p><p id="p0032" num="0032">As shown in <figref idrefs="f0003">Figure 5</figref>, at step S501, it creates a segmentation curve for the object to be cloned in the source image. As described above, the segmentation curve can be drawn by a user with an input device (for example, a mouse) on the screen of a display apparatus. In the case that the screen of the display apparatus is a touch sensitive type, the user can use his/her finger as the input device to create the segmentation curve. The display apparatus refers to any apparatus capable of displaying image/video to a user including, but not limited to, computer, laptop, mobile device, and tablet device, etc.</p><p id="p0033" num="0033">At the next step S502, it applies a gradient based cloning approach to the object to be cloned with the segmentation curve. Any known gradient based cloning approach, such as the one described in [Farbman2009], can be applied in this step. It can be appreciated that human visual behavior pays more attention to measuring local intensity differences rather than the intensity itself. Solving the cloning problem in the gradient domain can be classified into two approaches: either solving a Poisson equation or using a barycentric coordinates approach to solve the interpolation problem. No further details will be provided in this respect since it is well known to a person skilled in the art and beyond the scope of the present disclosure.</p><p id="p0034" num="0034">At step S503, it calculates a stopping criterion as a function of the spatial gradients in the surroundings of the segmentation curve.</p><p id="p0035" num="0035">One example of the stopping criterion is a gradient Gk at pixel k in the patch to be cloned defined by the segmentation curve and along the seam. <figref idrefs="f0004">Figure 6</figref> is a diagram showing gradients in the area of the cloning process for the image in<!-- EPO <DP n="6"> --> <figref idrefs="f0002">Figure 4</figref>. In <figref idrefs="f0004">Figure 6</figref>, the line 601 refers to the gradients on the object to be cloned and the line 602 refers to the gradients along the seam. Gradients along the seam are assumed to be a low, which means an unnoticeable seam. When higher gradients arise in the seam area, it means that unwanted details have been added. As shown in <figref idrefs="f0004">Figure 6</figref>, the reference number 603 indicates higher gradients in the seam area.</p><p id="p0036" num="0036">In this example, the gradient Gk may be obtained as follows for every pixels k by:
<ul><li>computing original and vertical gradients for each color component; and</li><li>computing L-2 norm.</li></ul></p><p id="p0037" num="0037">Another example of the stopping criterion is a variation in cloning interpolant, i.e. <maths id="math0001" num=""><math display="block"><mfrac><mi mathvariant="normal">d</mi><mi>dt</mi></mfrac><mo>⁢</mo><msub><mo>∬</mo><msub><mi mathvariant="normal">ΩP</mi><mi mathvariant="normal">k</mi></msub></msub><mspace width="1em"/><mi>correction</mi><mspace width="1em"/><mfenced><mi mathvariant="normal">x</mi><mi mathvariant="normal">y</mi></mfenced><mn mathvariant="normal">.</mn><mi>dxdy</mi></math><img id="ib0001" file="imgb0001.tif" wi="63" he="12" img-content="math" img-format="tif"/></maths><br/>
where :
<ul><li>ΩP<sub>k</sub> are the pixels included both in a disk centered at contour pixel Pk and inside the patch; and</li><li>correction(x,y) is the MVC interpolant at pixel (x,y).</li></ul></p><p id="p0038" num="0038">At step S504, it adapts the segmentation curve according to a comparison between the stopping criterion and a threshold.</p><p id="p0039" num="0039">In the case of the first example of stopping criterion described above, it can determine if gradient Gk at pixel k in the patch to be cloned and along the seam exceeds a threshold T1.</p><p id="p0040" num="0040">In the case of the second example of stopping criterion described above, it can determine if variation in cloning interpolant exceeds a threshold T2, i.e. <maths id="math0002" num=""><math display="block"><mfrac><mi mathvariant="normal">d</mi><mi>dt</mi></mfrac><mo>⁢</mo><msub><mo>∬</mo><msub><mi mathvariant="normal">ΩP</mi><mi mathvariant="normal">k</mi></msub></msub><mspace width="1em"/><mi>correction</mi><mspace width="1em"/><mfenced><mi mathvariant="normal">x</mi><mi mathvariant="normal">y</mi></mfenced><mn mathvariant="normal">.</mn><mi>dxdy</mi><mo>&gt;</mo><mi>T</mi><mo>⁢</mo><mn>2</mn></math><img id="ib0002" file="imgb0002.tif" wi="72" he="12" img-content="math" img-format="tif"/></maths><br/>
where :
<ul><li>ΩP<sub>k</sub> are the pixels included both in a disk centered at contour pixel Pk and inside the patch; and □</li><li>correction(x,y) is the MVC interpolant at pixel (x,y).</li></ul><!-- EPO <DP n="7"> --></p><p id="p0041" num="0041">With the above determination based on the stopping criterion over a threshold, it can detect whether and where unwanted details exist.</p><p id="p0042" num="0042">Then the segmentation curve is adapted according to the determination made based on the comparison between the stopping criterion and the threshold.</p><p id="p0043" num="0043">The adaption of the segmentation curve can be implemented by a morphological process to the segmentation curve.</p><p id="p0044" num="0044">The morphological process can comprise dilating the segmentation curve. It can be appreciated that the segmentation curve can be made by a rough drawing, which may be not precise enough for the following cloning steps. For example, in the above-described case of a touch screen inputted by a user finger, some factors, such as a finger width and a trembling finger, may influence the preciseness of the segmentation curve. Thus the segmentation curve can be dilated with a structuring element of different size. The objective of the dilation is to enlarge the segmentation curve so that it will lay outside the contour of the object to be cut &amp; cloned. Dilation also ensures a smoothing of the drawing to erase shivers.</p><p id="p0045" num="0045">The morphological process can also comprise eroding the segmentation curve. In this case, it will keep the segmentation curve and erode it with a small structuring element where unwanted details have been detected. In this sense, the erosion is just to reduce the segmentation curve where it is detected to be not well positioned.</p><p id="p0046" num="0046">The morphological process also can comprise a mixed dilation and erosion of the segmentation curve, which is known as closing and opening in the image processing as the basic workhorse of morphological noise removal.</p><p id="p0047" num="0047">The morphological process can be carried out iteratively, which applies a circular or square morphological operator of arbitrary size S. In one example, the size can be initially fixed to 10 pixels, or tuned manually by the user.</p><p id="p0048" num="0048">For example, if it detects that there exists at least one pixel j of which the stopping criteria exceeds a threshold, it can erode this area with a structuring element of size 1, or dilate the original segmentation curve using the chosen morphological operator of size S and using size S-1 in the surroundings of the detected stopping criteria pixel.</p><p id="p0049" num="0049"><figref idrefs="f0004">Figure 7</figref> is a diagram showing the adapted segmentation curve according to the method of the embodiment of the invention.<!-- EPO <DP n="8"> --></p><p id="p0050" num="0050">According to the embodiment of the invention, unwanted details can be automatically detected given any line detector for instance. Once detected, unwanted details can be either automatically avoided forcing an adaptive smaller dilation band in this area or interactively indicated for a user to decide whether to keep or not.</p><p id="p0051" num="0051">It can be appreciated that if no unwanted details are detected by the comparison between the stopping criterion and a threshold, there is no need to adapt the original segmentation curve.</p><p id="p0052" num="0052">At step S505, it clones the object with the adapted segmentation curve to the target image. Any known cloning process can be used and no further details will be provided in this respect.</p><p id="p0053" num="0053"><figref idrefs="f0005">Figure 8</figref> is a diagram showing the result of the seamless cloning based on the adaptive delineation. As shown in <figref idrefs="f0005">Figure 8</figref>, no visual artifact is visible in the area of the beak of the penguin in the final target image.</p><p id="p0054" num="0054">The invention can be used in cloning applications to provide at least one adapted segmentation curve based on a rough segmentation curve made by a user to achieve a more precise cloning.</p><p id="p0055" num="0055">The at least one adapted segmentation curve needs to respect the following constraints:
<ol><li>1. it encompasses the object to be cloned;</li><li>2. it includes neither other objects nor undesirable gradients that will cause artifact, for example, as shown in <figref idrefs="f0002">Figure 4</figref>.</li></ol></p><p id="p0056" num="0056">The above constraints can be achieved by a PDE (partial differential equation) governing the evolution of the segmentation curve. There exist techniques which used such a formulation for level set segmentation, interpolation or smoothing. The embodiment of the invention can rely on the same formalism and incorporate the gradient in the formulation. More specifically, the evolution of the segmentation curve is performed, for each point, along the normal to the contour of the segmentation curve. It is easy to incorporate the gradient as a stopping criterion as described above, i.e., the evolution of the segmentation curve for any point is stopped if a certain amount of gradient magnitude is detected.</p><p id="p0057" num="0057">The above constraints can also be achieved by using mathematical morphology. First, a binary mask of the object to be cloned is performed using the rough segmentation curve. Then, a dilation of the rough segmentation curve is<!-- EPO <DP n="9"> --> performed using a structuring element of size M that depends on the detected gradient magnitude. For instance structuring element can be a square of size 15 everywhere and progressively decreases to half this size where high gradient magnitude is detected. Finally, a contour detector (such as Canny or Prewitt approaches) is applied on the final dilated binary mask to get an adapted segmentation curve.</p><p id="p0058" num="0058">An embodiment of the invention provides an apparatus for cloning an object from a source image to a target image.</p><p id="p0059" num="0059"><figref idrefs="f0006">Figure 9</figref> is a block diagram showing a apparatus for cloning an object from a source image to a target image according to an embodiment of the invention.</p><p id="p0060" num="0060">The apparatus 900 can be any apparatus capable of displaying image/video to a user for the user to carry out a cloing process, which includes, but not limited to, computer, laptop, mobile device, and tablet device, etc.</p><p id="p0061" num="0061">The apparatus 900 comprises an interaction unit 910 for interacting with a user to interchange command and instructions for implementing the cloning process. In one example, the interaction unit 910 comprises a touch screen.</p><p id="p0062" num="0062"><figref idrefs="f0005">Figure 10</figref> is a diagram showing a user interface implemented on the interaction unit for a user to select a source image and a target image for the cloning. In <figref idrefs="f0006">Figure 9</figref>, the user interface presents a source image to the user, from which an object (in this example, a penguin) can be selected, segmented and then cloned to a target image (in this example, a lighthouse) which is also presented to the user.</p><p id="p0063" num="0063"><figref idrefs="f0007">Figure 11</figref> is a diagram showing a user interface for the user to create a segmentation curve for the object to be cloned in the source image. As shown in <figref idrefs="f0007">Figure 11</figref>, once the source image is selected, the user can roughly delineate the piece of the source image to be duplicated into the target image. Optionally, because of the very approximate delineation, a morphologic dilation can be made automatically.</p><p id="p0064" num="0064">Optionally, the preliminary result of the cloning can be displayed by the interaction unit automatically in the target image, as shown in <figref idrefs="f0007">Figure 11</figref>. At this moment, the user can look at the full automatic result through the interaction unit. As indicated in <figref idrefs="f0007">Figure 12</figref>, a visual artifact exists in the cloning result made by the original segmentation curve.<!-- EPO <DP n="10"> --></p><p id="p0065" num="0065">According to the embodiment of the invention, the apparatus 900 further comprises an adapting unit 920 for providing at least one modified segmentation curve adapted according to a comparison between the stopping criterion and a threshold. The segmentation curve can be adapted according to the method of the above-described embodiment.</p><p id="p0066" num="0066">As shown in <figref idrefs="f0008">Figure 13</figref>, modifications of the segmentation curve are provided to the user by the interaction unit 910, which only need to be validated or not by the user, for instance, with a mouse click. In <figref idrefs="f0008">Figure 13</figref>, only one proposal for the modified segmentation curve is shown. However, it can be appreciated that more proposals can be provided to the user.</p><p id="p0067" num="0067">As shown in <figref idrefs="f0008">Figure 14</figref>, upon the validation of the modified segmentation curve, associated cloning result is displayed simultaneously in the target image by the interaction unit.</p><p id="p0068" num="0068">As shown in <figref idrefs="f0006">Figure 9</figref>, for the operation of the interaction unit 910, the adapting unit 920 and other components of the apparatus 900, at least one processor 930 and at least one storeage device/ medium 940 are included in the apparatus 900.</p><p id="p0069" num="0069">With the apparatus 900 according to the embodiment of the invention, a user can be provided with at least one modified segmentation curve adapted according to a comparison between a stopping criterion as a function of the spatial gradients in the surroundings of the segmentation curve and a threshold. Upon the validation of the user, the modified segmentation curve is used for the cloning process, which can improve the subjective quality of the cloning even with low-quality segmentation.</p><p id="p0070" num="0070">A further embodiment of the invention provides a computer program product downloadable from a communication network and/or recorded on a medium readable by computer and/or executable by a processor, comprising program code instructions for implementing the steps of the method described above.</p><p id="p0071" num="0071">A further embodiment of the invention provides a non-transitory computer-readable medium comprising a computer program product recorded thereon and capable of being run by a processor, including program code instructions for implementing the steps of a method described above.</p><p id="p0072" num="0072">It is to be understood that the present invention may be implemented in various forms of hardware, software, firmware, special purpose processors, or a<!-- EPO <DP n="11"> --> combination thereof. Moreover, the software is preferably implemented as an application program tangibly embodied on a program storage device. The application program may be uploaded to, and executed by, a machine comprising any suitable architecture. Preferably, the machine is implemented on a computer platform having hardware such as one or more central processing units (CPU), a random access memory (RAM), and input/output (I/O) interface(s). The computer platform also includes an operating system and microinstruction code. The various processes and functions described herein may either be part of the microinstruction code or part of the application program (or a combination thereof), which is executed via the operating system. In addition, various other peripheral devices may be connected to the computer platform such as an additional data storage device and a printing device.</p><p id="p0073" num="0073">It is to be further understood that, because some of the constituent system components and method steps depicted in the accompanying figures are preferably implemented in software, the actual connections between the system components (or the process steps) may differ depending upon the manner in which the present invention is programmed. Given the teachings herein, one of ordinary skill in the related art will be able to contemplate these and similar implementations or configurations of the present invention.</p></description><claims mxw-id="PCLM90459843" lang="EN" load-source="patent-office"><!-- EPO <DP n="12"> --><claim id="c-en-0001" num="0001"><claim-text>A method for cloning an object from a source image to a target image, <b>characterized in that</b> it comprises the steps of:
<claim-text>creating (S501) a segmentation curve for the object to be cloned in the source image;</claim-text>
<claim-text>calculating (S503) a stopping criterion as a function of the spatial gradients in the surroundings of the segmentation curve;</claim-text>
<claim-text>adapting (S504) the segmentation curve according to a comparison between the stopping criterion and a threshold; and</claim-text>
<claim-text>cloning (S505) the object with the adapted segmentation curve to the target image.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The method according to the claim 1, <b>characterized in that</b> the stopping criterion is a gradient Gk at pixel k in the patch to be cloned defined by the segmentation curve and along the seam.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The method according to the claim 1, <b>characterized in that</b> the stopping criterion is a variation in cloning interpolant.</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>The method according to the claim 1, <b>characterized in that</b> the adaption of the segmentation curve comprises a morphological process of dilating the segmentation curve.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>The method according to the claim 1, <b>characterized in that</b> the adaption of the segmentation curve comprises a morphological process of eroding the segmentation curve.</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>The method according to the claim 1, <b>characterized in that</b> the adaption of the segmentation curve comprises a morphological process of a mixed dilation and erosion of the segmentation curve.</claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>The method according to any one of the claims 4-6, <b>characterized in that</b> the morphological process is carried out iteratively, applying a circular or square morphological operator of arbitrary size.<!-- EPO <DP n="13"> --></claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>An apparatus (900) for cloning an object from a source image to a target image, <b>characterized in that</b> it comprises:
<claim-text>an interaction unit (910) for a user to select a source image and a target image for the cloning, and to create a segmentation curve for the object to be cloned in the source image; and</claim-text>
<claim-text>an adapting unit (920) for providing at least one modified segmentation curve adapted according to a comparison between a stopping criterion as a function of the spatial gradients in the surroundings of the segmentation curve and a threshold.</claim-text></claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>The apparatus according to the claim 8, <b>characterized in that</b> upon the creation of the segmentation curve, the interaction unit (910) displays the result of the cloning of the object in the target image.</claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>The apparatus according to the claim 8, <b>characterized in that</b> upon the selection of one of the at least one modified segmentation curve, the interaction unit (910) displays the result of the cloning of the object in the target image.</claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>The apparatus according to the claim 8, <b>characterized in that</b> the adapting unit (920) modifies the segmentation curve with a morphological process of dilating the segmentation curve.</claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>The apparatus according to the claim 8, <b>characterized in that</b> the adapting unit (920) modifies the segmentation curve with a morphological process of eroding the segmentation curve.</claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>The apparatus according to the claim 8, <b>characterized in that</b> the adapting unit (920) modifies the segmentation curve with a morphological process of a mixed dilation and erosion of the segmentation curve.</claim-text></claim><claim id="c-en-0014" num="0014"><claim-text>Computer program product downloadable from a communication network and/or recorded on a medium readable by computer and/or executable by a<!-- EPO <DP n="14"> --> processor, comprising program code instructions for implementing the steps of a method according to at least one of claims 1 to 7.</claim-text></claim><claim id="c-en-0015" num="0015"><claim-text>Non-transitory computer-readable medium comprising a computer program product recorded thereon and capable of being run by a processor, including program code instructions for implementing the steps of a method according to at least one of claims 1 to 7.</claim-text></claim></claims><drawings mxw-id="PDW20422554" load-source="patent-office"><!-- EPO <DP n="15"> --><figure id="f0001" num="1,2"><img id="if0001" file="imgf0001.tif" wi="161" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="16"> --><figure id="f0002" num="3,4"><img id="if0002" file="imgf0002.tif" wi="165" he="221" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="17"> --><figure id="f0003" num="5"><img id="if0003" file="imgf0003.tif" wi="116" he="188" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="18"> --><figure id="f0004" num="6,7"><img id="if0004" file="imgf0004.tif" wi="165" he="210" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="19"> --><figure id="f0005" num="8,10"><img id="if0005" file="imgf0005.tif" wi="165" he="231" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="20"> --><figure id="f0006" num="9"><img id="if0006" file="imgf0006.tif" wi="165" he="231" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="21"> --><figure id="f0007" num="11,12"><img id="if0007" file="imgf0007.tif" wi="165" he="232" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="22"> --><figure id="f0008" num="13,14"><img id="if0008" file="imgf0008.tif" wi="162" he="233" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="161" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="161" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
