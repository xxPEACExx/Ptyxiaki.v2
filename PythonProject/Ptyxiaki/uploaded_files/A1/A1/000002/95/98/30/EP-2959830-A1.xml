<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2959830-A1" country="EP" doc-number="2959830" kind="A1" date="20151230" family-id="53476666" file-reference-id="316602" date-produced="20180825" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160452848" ucid="EP-2959830-A1"><document-id><country>EP</country><doc-number>2959830</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-15170995-A" is-representative="YES"><document-id mxw-id="PAPP193868664" load-source="patent-office" format="original"><country>EP</country><doc-number>15170995.3</doc-number><date>20150608</date><lang>EN</lang></document-id><document-id mxw-id="PAPP193868665" load-source="docdb" format="epo"><country>EP</country><doc-number>15170995</doc-number><kind>A</kind><date>20150608</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162029222" ucid="JP-2014129752-A" load-source="docdb"><document-id format="epo"><country>JP</country><doc-number>2014129752</doc-number><kind>A</kind><date>20140625</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1988522177" load-source="docdb">A61B   5/0452      20060101AFI20151104BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988523283" load-source="docdb">G06F  19/00        20110101ALI20151104BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988524240" load-source="docdb">G06T  19/00        20110101ALN20151104BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988524840" load-source="docdb">G06T  17/00        20060101ALN20151104BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1613213024" load-source="docdb" scheme="CPC">G06F  19/00        20130101 LI20180725BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1660023342" load-source="docdb" scheme="CPC">G06T  19/00        20130101 LI20180314BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1660023343" load-source="docdb" scheme="CPC">A61B   5/0452      20130101 LI20180314BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1687166092" load-source="docdb" scheme="CPC">G16H  50/50        20180101 LI20180219BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1944025419" load-source="docdb" scheme="CPC">G06T   7/0012      20130101 FI20160506BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165550010" lang="DE" load-source="patent-office">VORRICHTUNG, VERFAHREN UND PROGRAMM ZUR VISUALISIERUNG</invention-title><invention-title mxw-id="PT165550011" lang="EN" load-source="patent-office">APPARATUS, METHOD, AND PROGRAM FOR VISUALIZATION</invention-title><invention-title mxw-id="PT165550012" lang="FR" load-source="patent-office">APPAREIL, PROCEDE ET PROGRAMME DE VISUALISATION</invention-title><citations><patent-citations><patcit mxw-id="PCIT335740943" load-source="docdb" ucid="JP-2007313122-A"><document-id format="epo"><country>JP</country><doc-number>2007313122</doc-number><kind>A</kind><date>20071206</date></document-id><sources><source name="APP" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT335741086" load-source="docdb" ucid="US-20090135992-A1"><document-id format="epo"><country>US</country><doc-number>20090135992</doc-number><kind>A1</kind><date>20090528</date></document-id><sources><source name="SEA" category="X" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT405775054" load-source="docdb" ucid="US-5273038-A"><document-id format="epo"><country>US</country><doc-number>5273038</doc-number><kind>A</kind><date>19931228</date></document-id><sources><source name="SEA" category="XI" created-by-npl="N"/></sources></patcit></patent-citations><non-patent-citations><nplcit><text>SERMESANT M ET AL: "An Electromechanical Model of the Heart for Image Analysis and Simulation", IEEE TRANSACTIONS ON MEDICAL IMAGING, IEEE SERVICE CENTER, PISCATAWAY, NJ, US, vol. 25, no. 5, 1 May 2006 (2006-05-01), pages 612 - 625, XP001545798, ISSN: 0278-0062, DOI: 10.1109/TMI.2006.872746</text><sources><source mxw-id="PNPL57907283" load-source="docdb" name="SEA" category="A"/></sources></nplcit><nplcit><text>TSUYUNASHI; OGURI; MATSUO; IWATA: "The Holter ECG waveform classification using clustering", THE INSTITUTE OF ELECTRONICS, INFORMATION AND COMMUNICATION ENGINEERS (IEICE), TECHNICAL REPORT OF IEICE. MBE, ME AND BIOCYBERNETICS, vol. 103, no. 489, 1 December 2003 (2003-12-01), pages 23 - 28</text><sources><source mxw-id="PNPL57907284" load-source="docdb" name="APP"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR1103332158" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>FUJITSU LTD</last-name><address><country>JP</country></address></addressbook></applicant><applicant mxw-id="PPAR1103333842" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>FUJITSU LIMITED</last-name></addressbook></applicant><applicant mxw-id="PPAR1101648419" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>FUJITSU LIMITED</last-name><iid>100126510</iid><address><street>1-1, Kamikodanaka 4-chome, Nakahara-ku</street><city>Kawasaki-shi, Kanagawa 211-8588</city><country>JP</country></address></addressbook></applicant><applicant mxw-id="PPAR1103343201" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>UNIV TOKYO</last-name><address><country>JP</country></address></addressbook></applicant><applicant mxw-id="PPAR1103304687" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>THE UNIVERSITY OF TOKYO</last-name></addressbook></applicant><applicant mxw-id="PPAR1101640374" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>The University of Tokyo</last-name><iid>100237914</iid><address><street>3-1, Hongo 7-chome</street><city>Bunkyo-ku, Tokyo 113-8654</city><country>JP</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103339174" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>WATANABE MASAHIRO</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103320108" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>WATANABE, MASAHIRO</last-name></addressbook></inventor><inventor mxw-id="PPAR1101651818" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>WATANABE, MASAHIRO</last-name><address><street>c/o FUJITSU LIMITED 1-1, Kamikodanaka 4-chome Nakahara-ku,</street><city>Kawasaki-shi, Kanagawa 211-8588</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103309063" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>FUCHIKAMI SATOSHI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103343575" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>Fuchikami, Satoshi</last-name></addressbook></inventor><inventor mxw-id="PPAR1101642902" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>Fuchikami, Satoshi</last-name><address><street>c/o FUJITSU KYUSHU SYSTEMS LIMITED 2-2-1, Momochihama, Sawara-ku</street><city>Fukuoka-shi, Fukuoka 814-8589</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103316997" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>ATAKA TADASHI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103311597" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>ATAKA, TADASHI</last-name></addressbook></inventor><inventor mxw-id="PPAR1101652863" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>ATAKA, TADASHI</last-name><address><street>c/o FUJITSU LIMITED 1-1, Kamikodanaka 4-chome Nakahara-ku,</street><city>Kawasaki-shi, Kanagawa 211-8588</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103326128" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>KADOOKA YOSHIMASA</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103325020" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>KADOOKA, YOSHIMASA</last-name></addressbook></inventor><inventor mxw-id="PPAR1101642555" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>KADOOKA, YOSHIMASA</last-name><address><street>c/o FUJITSU LIMITED 1-1, Kamikodanaka 4-chome Nakahara-ku,</street><city>Kawasaki-shi, Kanagawa 211-8588</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103329646" load-source="docdb" sequence="5" format="epo"><addressbook><last-name>HISADA TOSHIAKI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103327972" load-source="docdb" sequence="5" format="intermediate"><addressbook><last-name>HISADA, TOSHIAKI</last-name></addressbook></inventor><inventor mxw-id="PPAR1101652146" load-source="patent-office" sequence="5" format="original"><addressbook><last-name>HISADA, TOSHIAKI</last-name><address><street>c/o THE UNIVERSITY OF TOKYO 3-1, Hongo 7-chome</street><city>Bunkyo-ku, Tokyo 113-8654</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103338742" load-source="docdb" sequence="6" format="epo"><addressbook><last-name>SUGIURA SEIRYO</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103322511" load-source="docdb" sequence="6" format="intermediate"><addressbook><last-name>SUGIURA, SEIRYO</last-name></addressbook></inventor><inventor mxw-id="PPAR1101643914" load-source="patent-office" sequence="6" format="original"><addressbook><last-name>SUGIURA, SEIRYO</last-name><address><street>c/o THE UNIVERSITY OF TOKYO 3-1, Hongo 7-chome</street><city>Bunkyo-ku, Tokyo 113-8654</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103302543" load-source="docdb" sequence="7" format="epo"><addressbook><last-name>WASHIO TAKUMI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103310793" load-source="docdb" sequence="7" format="intermediate"><addressbook><last-name>WASHIO, TAKUMI</last-name></addressbook></inventor><inventor mxw-id="PPAR1101650919" load-source="patent-office" sequence="7" format="original"><addressbook><last-name>WASHIO, TAKUMI</last-name><address><street>c/o THE UNIVERSITY OF TOKYO 3-1, Hongo 7-chome</street><city>Bunkyo-ku, Tokyo 113-8654</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103333201" load-source="docdb" sequence="8" format="epo"><addressbook><last-name>OKADA JUN-ICHI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR1103330045" load-source="docdb" sequence="8" format="intermediate"><addressbook><last-name>OKADA, JUN-ICHI</last-name></addressbook></inventor><inventor mxw-id="PPAR1101645393" load-source="patent-office" sequence="8" format="original"><addressbook><last-name>OKADA, JUN-ICHI</last-name><address><street>c/o THE UNIVERSITY OF TOKYO 3-1, Hongo 7-chome</street><city>Bunkyo-ku, Tokyo 113-8654</city><country>JP</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR1101643061" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Wilding, Frances Ward</last-name><iid>100046171</iid><address><street>Haseltine Lake LLP Lincoln House, 5th Floor 300 High Holborn</street><city>London WC1V 7JH</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS660629872" load-source="docdb">AL</country><country mxw-id="DS660629999" load-source="docdb">AT</country><country mxw-id="DS660629874" load-source="docdb">BE</country><country mxw-id="DS660714511" load-source="docdb">BG</country><country mxw-id="DS660709756" load-source="docdb">CH</country><country mxw-id="DS660790313" load-source="docdb">CY</country><country mxw-id="DS660630000" load-source="docdb">CZ</country><country mxw-id="DS660707816" load-source="docdb">DE</country><country mxw-id="DS660629883" load-source="docdb">DK</country><country mxw-id="DS660790314" load-source="docdb">EE</country><country mxw-id="DS660732979" load-source="docdb">ES</country><country mxw-id="DS660714512" load-source="docdb">FI</country><country mxw-id="DS660714513" load-source="docdb">FR</country><country mxw-id="DS660629884" load-source="docdb">GB</country><country mxw-id="DS660629885" load-source="docdb">GR</country><country mxw-id="DS660629886" load-source="docdb">HR</country><country mxw-id="DS660790315" load-source="docdb">HU</country><country mxw-id="DS660709757" load-source="docdb">IE</country><country mxw-id="DS660629895" load-source="docdb">IS</country><country mxw-id="DS660714514" load-source="docdb">IT</country><country mxw-id="DS660790316" load-source="docdb">LI</country><country mxw-id="DS660707817" load-source="docdb">LT</country><country mxw-id="DS660630001" load-source="docdb">LU</country><country mxw-id="DS660707818" load-source="docdb">LV</country><country mxw-id="DS660707819" load-source="docdb">MC</country><country mxw-id="DS660628937" load-source="docdb">MK</country><country mxw-id="DS660628938" load-source="docdb">MT</country><country mxw-id="DS660629896" load-source="docdb">NL</country><country mxw-id="DS660714519" load-source="docdb">NO</country><country mxw-id="DS660629897" load-source="docdb">PL</country><country mxw-id="DS660714520" load-source="docdb">PT</country><country mxw-id="DS660629898" load-source="docdb">RO</country><country mxw-id="DS660714521" load-source="docdb">RS</country><country mxw-id="DS660629907" load-source="docdb">SE</country><country mxw-id="DS660709758" load-source="docdb">SI</country><country mxw-id="DS660707821" load-source="docdb">SK</country><country mxw-id="DS660707822" load-source="docdb">SM</country><country mxw-id="DS660790317" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA166480946" lang="EN" load-source="patent-office"><p id="pa01" num="0001">Based on heart behavior data, a computation unit determines a first time step at which a heart exhibits a first behavior in response to a first wave of an electrical signal, as well as a second time step at which the heart exhibits a second behavior in response to a second wave of the same. The computation unit reproduces the heart's behavior over time by updating a three-dimensional model of the heart according to the heart behavior data, simultaneously with variations in electrical signal strength over time according to electrocardiogram data. The computation unit coordinates this reproduction such that a first shape of the heart at the first time is reproduced step simultaneously with the first wave of the electrical signal, and such that a second shape of the heart at the second time step is reproduced simultaneously with the second wave of the electrical signal.
<img id="iaf01" file="imgaf001.tif" wi="63" he="93" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA166760758" lang="EN" source="EPO" load-source="docdb"><p>Based on heart behavior data, a computation unit determines a first time step at which a heart exhibits a first behavior in response to a first wave of an electrical signal, as well as a second time step at which the heart exhibits a second behavior in response to a second wave of the same. The computation unit reproduces the heart's behavior over time by updating a three-dimensional model of the heart according to the heart behavior data, simultaneously with variations in electrical signal strength over time according to electrocardiogram data. The computation unit coordinates this reproduction such that a first shape of the heart at the first time is reproduced step simultaneously with the first wave of the electrical signal, and such that a second shape of the heart at the second time step is reproduced simultaneously with the second wave of the electrical signal.</p></abstract><description mxw-id="PDES98405647" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001">FIELD</heading><p id="p0001" num="0001">The embodiments discussed herein relate to an apparatus, method, and program for visualizing behavior of a heart.</p><heading id="h0002">BACKGROUND</heading><p id="p0002" num="0002">The recent advancement of computer-based numerical analysis has enabled reproduction of various phenomena in a heart by modeling it on a computer. For example, the behavior of myocardium is analyzed numerically and reproduced on a monitor screen with the techniques of three-dimensional computer graphics. It is also possible to produce an electrocardiogram on the thorax of a person as an outcome of simulation. Such output data representing electrical activities in a heart may be visualized as video images, along with other data indicating the propagation of cardiac excitation.</p><p id="p0003" num="0003">Electrocardiograms are used as source data for analysis of arrhythmia and other heart diseases. For example, one proposed electrocardiogram analyzer evaluates electrical activities in a heart in terms of the distribution of indicators that are useful for prediction of fatal arrhythmias. Also, several researchers have proposed a method for classifying waveforms of Holter electrocardiography by using clustering techniques. See, for example, the following documents:
<ul><li>Japanese Laid-open Patent Publication No. <patcit id="pcit0001" dnum="JP2007313122A"><text>2007-313122</text></patcit></li></ul></p><p id="p0004" num="0004"><nplcit id="ncit0001" npl-type="s"><text>Tsuyunashi, Oguri, Matsuo, Iwata, "The Holter ECG waveform classification using clustering," The Institute of Electronics, Information and Communication Engineers (IEICE), Technical Report of IEICE. MBE, ME and Biocybernetics, December 1, 2003, 103(489), pp.23-28</text></nplcit></p><p id="p0005" num="0005">A patient suspected of having a heart disease is subjected to monitoring of electrical signals produced in his or her myocardium, and the result is obtained as electrocardiogram data. There is a need in some situations for visually checking the behavior of the heart in comparison with electrocardiogram data. This is achieved by conducting a<!-- EPO <DP n="2"> --> dynamic simulation of myocardial motion and blood flows and reproducing the simulated heart behavior in the form of a three-dimensional model on a monitor screen.</p><p id="p0006" num="0006">It is not easy, however, for the conventional tools to make a simulation result exactly simultaneous with electrocardiogram data because of their difference in the progress of time. More specifically, existing electrocardiogram data is used as input data for a behavioral simulation of myocardium, where the electrocardiogram data provides particular conditions about propagation of excitation in the patient's heart. The simulation process produces a set of output data indicating the state of the heart at each discrete time step. There is, however, some amount of time difference between the generation of electrical signals seen in the electrocardiogram and the consequent contraction of myocardium. Because of this time difference, simply starting an electrocardiogram together with animation of a heart beat would not be sufficient for achieving correct synchronization between the variations of electrical signal strength and the motion of cardiac muscle.</p><heading id="h0003">SUMMARY</heading><p id="p0007" num="0007">It is desirable in an embodiment of one aspect to provide a technique for synchronizing an electrocardiogram measured from a patient with simulated behavior of his or her heart.</p><p id="p0008" num="0008">In an embodiment of one aspect, there is provided a visualization apparatus, including: storage means for storing a three-dimensional model of a heart of a patient, heart behavior data representing shapes of the heart at different time steps of a behavioral simulation of the heart, and electrocardiogram data representing temporal variations of an electrical signal in myocardium that have been measured from the patient; and computation means for determining a first time step at which the heart exhibits a first behavior in response to a first wave of the electrical signal, as well as a second time step at which the heart exhibits a second behavior in response to a second wave of the electrical signal, based on the heart behavior data, and for reproducing behavior of the heart over time by updating the three-dimensional model according to the heart behavior data, simultaneously with variations in strength of the electrical signal over time according to the electrocardiogram data, such that a first shape of the<!-- EPO <DP n="3"> --> heart at the first time step is reproduced simultaneously with the first wave of the electrical signal, and such that a second shape of the heart at the second time step is reproduced simultaneously with the second wave of the electrical signal.</p><heading id="h0004">BRIEF DESCRIPTION OF DRAWINGS</heading><p id="p0009" num="0009">The invention is described, by way of example only, with reference to the following drawings, in which:
<ul><li><figref idrefs="f0001">FIG. 1</figref> illustrates an exemplary functional structure of a visualization apparatus according to a first embodiment;</li><li><figref idrefs="f0002">FIG. 2</figref> illustrates an exemplary hardware configuration of a computer according to a second embodiment;</li><li><figref idrefs="f0003">FIG. 3</figref> is a functional block diagram of a computer of the second embodiment;</li><li><figref idrefs="f0004">FIG. 4</figref> illustrates an exemplary structure of data stored in an unstructured grid data storage unit;</li><li><figref idrefs="f0005">FIG. 5</figref> illustrates an example of a three-dimensional cardiac model;</li><li><figref idrefs="f0006">FIG. 6</figref> illustrates an exemplary structure of data stored in a simulation result storage unit;</li><li><figref idrefs="f0007">FIG. 7</figref> illustrates an exemplary structure of data stored in an electrocardiogram data storage unit;</li><li><figref idrefs="f0008">FIG. 8</figref> illustrates an example of propagation of cardiac excitation;</li><li><figref idrefs="f0009">FIG. 9</figref> illustrates an example of an electrocardiogram;</li><li><figref idrefs="f0010">FIG. 10</figref> illustrates how an electrocardiogram relates to propagation of cardiac excitation;</li><li><figref idrefs="f0011">FIG. 11</figref> illustrates an example of a twelve-lead electrocardiogram;</li><li><figref idrefs="f0012">FIG. 12</figref> is a flowchart of a visualization process;</li><li><figref idrefs="f0013">FIG. 13</figref> is a flowchart illustrating a procedure of determining initial positions of atriums and ventricles;</li><li><figref idrefs="f0014">FIG. 14</figref> illustrates the bottommost portion of a ventricular cavity;</li><li><figref idrefs="f0015">FIG. 15</figref> illustrates an example of long and short axes;<!-- EPO <DP n="4"> --></li><li><figref idrefs="f0016">FIG. 16</figref> illustrates initial positions;</li><li><figref idrefs="f0017">FIGS. 17</figref> and <figref idrefs="f0018">18</figref> are first and second halves of a flowchart illustrating a procedure of producing synchronization data;</li><li><figref idrefs="f0019">FIG. 19</figref> illustrates an example of synchronization data;</li><li><figref idrefs="f0020">FIG. 20</figref> illustrates an example of a picture that reproduces heart behavior together with an electrocardiogram;</li><li><figref idrefs="f0021">FIG. 21</figref> illustrates an exemplary screenshot of a twelve-lead electrocardiogram;</li><li><figref idrefs="f0022">FIG. 22</figref> illustrates how the heart changes its shape with the progress of reproduction time; and</li><li><figref idrefs="f0023">FIG. 23</figref> illustrates an exemplary screenshot that depicts heart behavior together with an electrocardiogram in the case of arrhythmia.</li></ul></p><heading id="h0005">DESCRIPTION OF EMBODIMENTS</heading><p id="p0010" num="0010">Several embodiments of the present invention will be described below with reference to the accompanying drawings. These embodiments may be combined with each other unless they have contradictory features.</p><heading id="h0006">(a) First Embodiment</heading><p id="p0011" num="0011">This section describes a first embodiment. To start with, <figref idrefs="f0001">FIG. 1</figref> illustrates an exemplary functional structure of a visualization apparatus according to a first embodiment. The illustrated visualization apparatus 10 includes a storage unit 11 and a computation unit 12.</p><p id="p0012" num="0012">The storage unit 11 stores a three-dimensional cardiac model 1, heart behavior data 2, and electrocardiogram data 3. The three-dimensional cardiac model 1 is a structure model representing a heart under analysis. The heart behavior data 2 represents shapes of the heart at different time steps of a behavioral simulation of the heart. For reproduction of simulated behavior of the heart, the time steps are labeled in their chronological order, with successively larger numbers starting from zero. The electrocardiogram data 3 represents temporal variations of an electrical signal in myocardium that have been measured from the patient's body. For example, the electrical signal is measured in terms of voltage.</p><p id="p0013" num="0013">Based on of the heart behavior data 2 noted above, the computation unit 12<!-- EPO <DP n="5"> --> determines a first time step at which the heart exhibits a first behavior in response to a first wave of the electrical signal, as well as a second time step at which the heart exhibits a second behavior in response to a second wave of the electrical signal (step S1). For example, the first wave is P wave seen in an electrocardiogram given by the electrocardiogram data 3, and the first time step refers to the moment when the atriums begin to contract. The second wave is, on the other hand, R wave seen in the electrocardiogram, and the second time step refers to the moment when the ventricles begin to contract.</p><p id="p0014" num="0014">The computation unit 12 reproduces behavior of the heart over time by updating the three-dimensional cardiac model 1 according to the heart behavior data 2, simultaneously with variations in strength of the electrical signal over time according to the electrocardiogram data 3 (step S2). Here the computation unit 12 coordinates the reproduction of heart behavior such that a first shape of the heart at the first time step will be reproduced simultaneously with the first wave of the electrical signal, and such that a second shape of the heart at the second time step will be reproduced simultaneously with the second wave of the electrical signal. More specifically, the computation unit 12 reproduces the first shape at the moment when the reproduced electrical signal reaches a peak (maximum) of the first wave, and reproduces the second shape at the moment when the reproduced electrical signal reaches a peak of the second wave. The computation unit 12 displays the reproduced electrocardiogram and heart behavior on a monitor screen 4, for example.</p><p id="p0015" num="0015">In operation of the above-described visualization apparatus 10, the computation unit 12 analyzes heart behavior data 2 obtained as result of a simulation and determines a first time step at which the atriums begin to contract. This first time step is distinguished by its number i, where i is an integer equal to or greater than zero. The computation unit 12 also determines a second time step at which the ventricles begin to contract. This second time step is distinguished by its number j, where j is an integer equal to or greater than zero.</p><p id="p0016" num="0016">The computation unit 12 then reproduces an electrocardiogram and an image depicting the heart's behavior in a synchronized manner. Specifically, the computation unit 12 determines when to reproduce each time step of the heart behavior data 2, on the basis of the electrocardiogram data 3. For example, the i-th time step (i.e., start of atrial contraction) is<!-- EPO <DP n="6"> --> supposed to be reproduced when the electrical signal exhibits a peak of P wave in the electrocardiogram. That moment is referred to as time ti in <figref idrefs="f0001">FIG. 1</figref>. Similarly the j-th time step (i.e., start of ventricular contraction) is supposed to be reproduced when the electrical signal exhibits a peak of R wave in the electrocardiogram. That moment is referred to as time tj in <figref idrefs="f0001">FIG. 1</figref>.</p><p id="p0017" num="0017">In accordance with the reproduction time determined in the way described above, the visualization apparatus 10 dynamically reproduces how the heart changes its shape at each time step, as the electrical signal varies with time in the reproduced electrocardiogram, thus achieving correct synchronization between the electrocardiogram and heart behavior. For example, the electrocardiogram is reproduced as a graph with horizontal and vertical axes respectively representing reproduction time and electrical signal intensity. With the progress of reproduction time, a special mark representing the current position moves along the curved line of the graph so as to indicate the current signal strength being reproduced.</p><p id="p0018" num="0018">The visualization apparatus 10 displays the synchronized electrocardiogram and heart behavior on a monitor screen 4, thus making it easier for the viewer to understand the relationship between electrical signals seen in the electrocardiogram and actual behavior of the heart. Particularly, the visualization apparatus 10 is designed to adjust the electrocardiogram and heart behavior such that the start of atrial contraction is timed to the peak of P wave, and the start of ventricular contraction is timed to the peak of R wave. This adjustment reflects the delay time from reception of electrical signals by myocardium and consequent contraction of the myocardium, and thus contributes to correct synchronization between the electrocardiogram and heart behavior. More specifically, the atrial myocardium receives an electrical signal when P wave begins. The atriums, however, do not respond immediately, but start to contract some time after the reception of those electrical signals. For realistic reproduction of heart behavior, the visualization apparatus 10 waits for the electrocardiogram to reach the peak of P wave before rendering the contraction of atriums.</p><p id="p0019" num="0019">The above-described computation unit 12 may be implemented as, for example, functions performed by a processor in the visualization apparatus 10. The storage unit 11 may be implemented as part of the data storage space of memory devices or the like in the<!-- EPO <DP n="7"> --> visualization apparatus 10.</p><p id="p0020" num="0020">It is noted that the lines interconnecting the functional blocks in <figref idrefs="f0001">FIG. 1</figref> represent some of their communication paths. The person skilled in the art would appreciate that there may be other communication paths in actual implementations.</p><p id="p0021" num="0021">It is also noted that the storage unit 11 discussed above in <figref idrefs="f0001">FIG. 1</figref> may be termed as a storage means for storing a three-dimensional cardiac model 1, heart behavior data 2, and electrocardiogram data 3. Similarly, the computation unit 12 discussed above in <figref idrefs="f0001">FIG. 1</figref> may be termed as a computation means for determining first and second time steps and reproducing behavior of the heart simultaneously with variations in electrical signal strength.</p><heading id="h0007">(b) Second Embodiment</heading><p id="p0022" num="0022">This section describes a second embodiment, which provides more specific techniques for visualizing the result of behavioral simulation of a patient's heart, precisely in synchronization with his or her electrocardiogram.</p><p id="p0023" num="0023"><figref idrefs="f0002">FIG. 2</figref> illustrates an exemplary hardware configuration of a computer according to the second embodiment. The illustrated computer 100 includes a processor 101 to control its entire operation. The processor 101 is coupled to a memory 102 and other various devices and interfaces via a bus 109. The processor 101 may be a single processing device or a multiprocessor system including two or more processing devices, such as a central processing unit (CPU), micro processing unit (MPU), or digital signal processor (DSP). It is also possible to implement the processing functions of the processor 101 wholly or partly in an application-specific integrated circuit (ASIC), programmable logic device (PLD), or other electronic circuits, or their combinations.</p><p id="p0024" num="0024">The memory 102 serves as a primary storage device of the computer 100. Specifically, the memory 102 is used to temporarily store at least some of the operating system (OS) programs and application programs that the processor 101 executes, in addition to other various data objects that it manipulates at runtime. The memory 102 may be, for example, a random access memory (RAM) or other volatile semiconductor memory devices.</p><p id="p0025" num="0025">Other devices on the bus 109 include a hard disk drive (HDD) 103, a graphics processor 104, an input device interface 105, an optical disc drive 106, a peripheral device<!-- EPO <DP n="8"> --> interface 107, and a network interface 108. The HDD 103 writes and reads data magnetically on its internal platters. The HDD 103 serves as a secondary storage device in the computer 100 to store program files and data files relating to the operating system and applications. Flash memory and other semiconductor memory devices may also be used as secondary storage devices, in place of or together with the HDD 103.</p><p id="p0026" num="0026">The graphics processor 104, coupled to a monitor 21, produces video images in accordance with drawing commands from the processor 101 and displays them on a screen of the monitor 21. The monitor 21 may be, for example, a cathode ray tube (CRT) display or a liquid crystal display.</p><p id="p0027" num="0027">The input device interface 105 is used to connect input devices such as a keyboard 22 and a mouse 23 to the computer 100 and supply signals from these devices to the processor 101. The mouse 23 is a pointing device, which may be replaced with other kinds of pointing devices such as a touchscreen, tablet, touchpad, and trackball.</p><p id="p0028" num="0028">The optical disc drive 106 reads out data encoded on an optical disc 24, by using laser light or the like. The optical disc 24 is a portable data storage medium, the data recorded on which can be read as a reflection of light or the lack of the same. The optical disc 24 may be a digital versatile disc (DVD), DVD-RAM, compact disc read-only memory (CD-ROM), CD-Recordable (CD-R), or CD-Rewritable (CD-RW), for example.</p><p id="p0029" num="0029">The peripheral device interface 107 is a communication interface for connecting some peripheral devices to the computer 100. For example, the peripheral device interface 107 may be used to connect a memory device 25 and a memory card reader/writer 26. The memory device 25 is a data storage medium with a capability of communicating with the peripheral device interface 107. The memory card reader/writer 26 is an adapter used to write data to or read data from a memory card 27, which is a data storage medium in the form of a small card. The network interface 108 is connected to a network 20 to exchange data with other computers or network devices (not illustrated).</p><p id="p0030" num="0030">The above hardware configuration serves as a platform of processing functions to implement the second embodiment. It is noted that the foregoing visualization apparatus 10 of the first embodiment may also be implemented on the same hardware platform discussed in<!-- EPO <DP n="9"> --> <figref idrefs="f0002">FIG. 2</figref> for the computer 100 of the second embodiment.</p><p id="p0031" num="0031">The computer 100 provides various processing functions of the second embodiment by executing programs stored in a non-transitory computer-readable storage medium. These processing functions of the computer 100 are encoded in the form of computer programs, which may be stored in a variety of storage media. For example, the computer 100 may store program files in its own HDD 103. The processor 101 loads the memory 102 with at least part of these programs read out of the HDD 103 and executes them on the memory 102. It is also possible to store programs files in an optical disc 24, memory device 25, memory card 27, or the like. The programs stored in a portable storage medium are installed in the HDD 103 under the control of the processor 101, so that they are ready to execute upon request. It may also be possible for the processor 101 to execute program codes read out of a portable storage medium, without installing them in its local storage devices.</p><p id="p0032" num="0032"><figref idrefs="f0003">FIG. 3</figref> is a functional block diagram of a computer of the second embodiment. The illustrated computer 100 includes an unstructured grid data storage unit 110, a heart simulator 120, a simulation result storage unit 130, an electrocardiogram data storage unit 140, and a visualization unit 150.</p><p id="p0033" num="0033">The unstructured grid data storage unit 110 stores unstructured grid data that describes the shape of a heart in three-dimensional form. For example, unstructured grid data expresses the geometry of a heart as a collection of tetrahedral elements with irregular shapes. More specifically, many nodes are placed in a heart simulation domain, where each four neighboring nodes define a tetrahedron. The heart is thus represented as a collection of many tetrahedrons each serving as an element that portrays myocardial cells. For example, the unstructured grid data storage unit 110 may be implemented as part of storage space of the memory 102 or HDD 103.</p><p id="p0034" num="0034">The heart simulator 120 mimics the behavior of a heart under test, including its beating motion, on the basis of a given three-dimensional cardiac model. The heart simulator 120 may also simulate coronary circulation (blood flow in the heart). The heart simulator 120 outputs its simulation result to the simulation result storage unit 130. For example, the heart simulator 120 repetitively calculates new node positions of the three-dimensional cardiac model<!-- EPO <DP n="10"> --> and some relating physical quantities (e.g., blood pressure and amount of blood flow) at each node or cardiac element, while advancing the simulation clock by a predetermined time step size. The node positions and their relating physical quantities at a specific time step are calculated on the basis of those obtained at one or more preceding time steps. The simulation result includes the calculated positions of nodes and new physical quantities at those nodes or elements at each predetermined point on the simulation time axis.</p><p id="p0035" num="0035">The simulation result storage unit 130 stores data of simulation results discussed above. For example, the simulation result storage unit 130 may be implemented as part of storage space of the memory 102 or HDD 103.</p><p id="p0036" num="0036">The electrocardiogram data storage unit 140 stores original measurement data of an electrocardiogram of a patient. This data indicates the strength of electrical signals produced in the heart. For example, the electrocardiogram data storage unit 140 may be implemented as part of storage space of the memory 102 or HDD 103.</p><p id="p0037" num="0037">The visualization unit 150 displays the patient's electrocardiogram and heart behavior on the monitor 21 in a synchronized manner. For example, the simulated heart behavior includes contraction of atriums and ventricles. The visualization unit 150 positions the electrocardiogram in such a way that the peak of P wave will match with the atrial contraction, and the peak of R wave with the ventricular contraction.</p><p id="p0038" num="0038">The visualization unit 150 is an exemplary implementation of the computation unit 12 discussed previously in <figref idrefs="f0001">FIG. 1</figref> for the first embodiment. The unstructured grid data storage unit 110, simulation result storage unit 130, and electrocardiogram data storage unit 140 are collectively equivalent to the storage unit 11 discussed previously in <figref idrefs="f0001">FIG. 1</figref> for the first embodiment. It is noted that the lines interconnecting the functional blocks in <figref idrefs="f0003">FIG. 3</figref> represent some of their communication paths. The person skilled in the art would appreciate that there may be other communication paths in actual implementations. It is also noted that the functions of each element seen in <figref idrefs="f0003">FIG. 3</figref> may be implemented as program modules executed by a computer.</p><p id="p0039" num="0039">Referring now to <figref idrefs="f0004">FIG. 4</figref>, an exemplary structure of data stored in the unstructured grid data storage unit 110 will be described below. The unstructured grid data<!-- EPO <DP n="11"> --> storage unit 110 contains, for example, a node data table 111 and an element data table 112, which constitute unstructured grid data. Each entry of the node data table 111 defines a node as a combination of its node number and coordinate position. The node coordinates defined in this node data table 111 indicate the initial position of each node before a simulation is started. During a simulation, these node coordinates in the node data table 111 are changed with the progress of simulated heart beat motion. The element data table 112, on the other hand, describes tetrahedral elements of a cardiac model. Specifically, each tetrahedral element is distinguished by a specific element number, and its four corners are designated by their corresponding node numbers.</p><p id="p0040" num="0040">A three-dimensional cardiac model is produced from the foregoing data in the unstructured grid data storage unit 110 of <figref idrefs="f0004">FIG. 4</figref>. <figref idrefs="f0005">FIG. 5</figref> illustrates an example of such a three-dimensional cardiac model. The illustrated three-dimensional cardiac model 31 is made up of a large number of tetrahedral elements. With a given initial condition of electrical signals in this three-dimensional cardiac model 31, the heart simulator 120 computationally reproduces a process of electrical signal conduction (propagation of excitation) in the heart muscle. The three-dimensional cardiac model 31 is also given some other conditions relating to the contraction and relaxation of myocardium, enabling the heart simulator 120 to mimic the heart's mechanical behavior (motion) as well. As the simulation progresses, its outcome is accumulated in the simulation result storage unit 130 in the way described below.</p><p id="p0041" num="0041"><figref idrefs="f0006">FIG. 6</figref> illustrates an exemplary structure of data stored in a simulation result storage unit. Each single cycle of computation in the simulation process is referred to as a "simulation time step" or simply "time step." The simulation result storage unit 130 contains a plurality of myocardium datasets 131, 132, 133, ... obtained at different time steps. These myocardium datasets 131, 132, 133, ..., given a series of time step indexes, represent how the heart changes its state (including shape) with the progress of simulation time.</p><p id="p0042" num="0042">More specifically, each record in the myocardium datasets 131, 132, 133, ... is associated with a particular element or node of the three-dimensional cardiac model and thus includes its element ID or node ID, coordinate position, and various physical quantities. The node positions vary with time, thus representing a varying shape of the heart at each time step.<!-- EPO <DP n="12"> --> The coordinate position of a tetrahedral element actually means its centroid, or the center of gravity. Each column of physical quantity is populated with data only in the element records, or only in the node records, or in the both.</p><p id="p0043" num="0043">Referring now to <figref idrefs="f0007">FIG. 7</figref>, the next section describes an exemplary structure of electrocardiogram data stored in the electrocardiogram data storage unit 140. The illustrated electrocardiogram data storage unit 140 stores a plurality of electrocardiogram datasets 141, 142, 143, ... containing records of voltage observed at different points on the patient's body. In the case of, for example, a twelve-lead electrocardiogram, the electrocardiogram data storage unit 140 stores twelve electrocardiogram datasets corresponding to the twelve leads. Each electrocardiogram dataset 141, 142, 143, ... is a time-series of voltage values of electrical signals measured with the progress of time relative to the measurement start time.</p><p id="p0044" num="0044">The above-described electrocardiogram data has been obtained by measuring myocardial voltage of the patient of interest, with a plurality of electrodes attached to his or her body. The measured values of myocardium voltage represent the strength of propagating electrical signals that cause cardiac excitation.</p><p id="p0045" num="0045">The next section will describe how the excitation propagates over the myocardium and how it is detected as electrical signals.</p><p id="p0046" num="0046"><figref idrefs="f0008">FIG. 8</figref> illustrates an example of propagation of cardiac excitation. The illustrated heart 40 is formed from four chambers called right atrium 41, left atrium 42, right ventricle 43, and left ventricle 44. Each of these heart chambers contracts in accordance with electrical signals that propagate through the heart's stimulus conduction system. Specifically, the stimulus conduction system is made up of a collection of muscle cells specialized for conducting electrical signals that stimulate muscle contraction.</p><p id="p0047" num="0047">The stimulus conduction system includes a tissue called "sinoatrial node" 45 that serves as the source of electrical signals. The sinoatrial node 45 sits in the right atrium 41 and generates an electrical impulse signal at regular intervals without the need for external stimulation. The generated signal is sent first to the right atrium 41, and to the left atrium 42 as well, and propagates through the atrial muscle before reaching the place called "atrioventricular node" 46. The muscles of the right atrium 41 and left atrium 42 contract in<!-- EPO <DP n="13"> --> response to the electrical signals that they receive. Then with some delay time after that, the atrioventricular node 46 transfers the electrical signal to the ventricles. The electrical signal then bifurcates to the left and right bundle branches. These signals go down to the bottom of each ventricle and then propagate across the entire ventricular muscle.</p><p id="p0048" num="0048">Such excitation-causing electrical signals are observed as the voltage potential of myocardium through a process called electrocardiography. The graph representing these recorded voltage variations over time is referred to as an electrocardiogram.</p><p id="p0049" num="0049"><figref idrefs="f0009">FIG. 9</figref> illustrates an example of an electrocardiogram. A healthy heart exhibits six waves named P, Q, R, S, T, and U waves in its electrocardiogram. Q, R, and S waves occur back-to-back (i.e., without interruption) and are collectively referred to as a QRS complex. P wave represents depolarization (excitation) of the atriums. That is, P wave is the first upward (i.e., positive) wave that comes after the electrical signal begins to propagate in a heart beat cycle. The subsequent QRS complex represents depolarization (excitation) of the ventricles, which begins with a downward (i.e., negative) Q wave and continues to an upward R wave and then to a downward S wave.</p><p id="p0050" num="0050"><figref idrefs="f0010">FIG. 10</figref> illustrates how an electrocardiogram relates to propagation of cardiac excitation. Specifically, the sinoatrial node 45 generates an electrical signal, initiating P wave. This P wave disappears when the electrical signal reaches the atrioventricular node 46. The electrical signal further propagates from the atrioventricular node 46 through the bundle of His 47 and bifurcates into the left and right bundle branches, causing a QRS complex to begin. The QRS complex is finished when the bifurcated electrical signals arrive at the extreme ends of those two bundle branches within the ventricular myocardium.</p><p id="p0051" num="0051">Most electrocardiograms are obtained as twelve leads, meaning that twelve different views of a heart are captured at a time. <figref idrefs="f0011">FIG. 11</figref> illustrates an example of a twelve-lead electrocardiogram. The illustrated twelve-lead electrocardiogram 51 actually includes twelve different waveforms, or leads. Many leads have R waves larger than their subsequent S waves (negative), while some may exhibit S waves larger than R waves. There may even be a missing wave in some of those leads. Electrocardiograms contain some amount of noise introduced during the measurement process, which may be visible in their waveforms.<!-- EPO <DP n="14"> --></p><p id="p0052" num="0052">The computer 100 of the second embodiment displays such an electrocardiogram together with a picture visualizing simulated behavior of the heart in question. This feature of the computer 100 permits the user to understand how the heart behaves in response to electrical signals seen in the electrocardiogram.</p><p id="p0053" num="0053">The patient's electrocardiogram is used to determine the values of parameters for a behavioral simulation of his or her heart. With such parameters based on electrocardiogram data, the simulation result will reflect the condition of the patient's cardiac excitation system. Suppose, for example, the patient in question has a symptom of cardiac arrhythmia. The use of his electrocardiogram data for simulation makes it possible to reproduce the heart's behavior under the arrhythmic condition.</p><p id="p0054" num="0054">The visualization unit 150 makes some timing adjustment to synchronize the heart actions with the given electrocardiogram when reproducing them on a monitor screen. Specifically, P wave in the electrocardiogram is timed to atrial contraction caused by an electrical signal from the sinoatrial node 45, and R wave is timed to ventricular contraction caused by an electrical signal from the atrioventricular node 46. In other words, the visualization unit 150 renders the reproduced heart behavior so as to make the atriums begin to contract at the peak point of P wave, as well as to make the ventricles begin to contract at the peak point of R wave.</p><p id="p0055" num="0055">The following description will now explain how the visualization unit 150 reproduces heart behavior in a three-dimensional model in synchronization with a corresponding electrocardiogram. <figref idrefs="f0012">FIG. 12</figref> is a flowchart of a visualization process.</p><p id="p0056" num="0056">(Step S101) The visualization unit 150 determines initial positions of atriums and ventricles. For example, two points in the atriums or ventricles are selected such that they are as distant as possible, assuming that it is before a heart beat begins. A displacement of atriums from their initial positions will be interpreted as a start of atrial contraction. Similarly, a displacement of ventricles from their initial positions will be interpreted as a start of ventricular contraction. Details of this step S101 will be discussed later with reference to <figref idrefs="f0013">FIG. 13</figref>.</p><p id="p0057" num="0057">(Step S102) The visualization unit 150 produces synchronization data that specifies when to reproduce heart behavior of each time step. Details of this processing will<!-- EPO <DP n="15"> --> be discussed later with reference to <figref idrefs="f0017">FIG. 17</figref>.</p><p id="p0058" num="0058">(Step S103) The visualization unit 150 reproduces behavior of the heart in its three-dimensional model, and the visualization unit 150 displays it on the monitor 21 in synchronization with an electrocardiogram.</p><p id="p0059" num="0059">The description will now provide details of how to determine the initial positions of atriums and ventricles. <figref idrefs="f0013">FIG. 13</figref> is a flowchart illustrating a procedure of determining initial positions of atriums and ventricles.</p><p id="p0060" num="0060">(Step S111) The visualization unit 150 retrieves data of a three-dimensional cardiac model 31 from the unstructured grid data storage unit 110.</p><p id="p0061" num="0061">(Step S112) The visualization unit 150 sets a cardiac axis (long axis of the heart) in the three-dimensional cardiac model 31. The long axis runs through the heart in its vertical direction.</p><p id="p0062" num="0062">(Step S113) The visualization unit 150 sets an atrial short axis and a ventricular short axis in three-dimensional cardiac model 31. The atrial short axis refers to a lateral axis of atriums that is perpendicular to the long axis of the heart. The ventricular short axis refers to a lateral axis of ventricles that is perpendicular to the long axis of the heart.</p><p id="p0063" num="0063">(Step S114) The visualization unit 150 calculates the coordinates of points at which the atrial short axis intersects with free walls of myocardium and determines these intersectional coordinates as the initial positions of atriums. Similarly, the visualization unit 150 calculates the coordinates of points at which the ventricular short axis intersects with free walls of myocardium and determines these intersectional coordinates as the initial positions of ventricles.</p><p id="p0064" num="0064">A specific example of initial position setup will now be described below with reference to <figref idrefs="f0014 f0015 f0016">FIGS. 14 to 16</figref>. The process starts with setting a long axis of the heart in its three-dimensional cardiac model. It is assumed here that the heart is in the condition before a heart beat begins. The visualization unit 150 sets a long axis through the bottommost portion of a ventricular cavity.</p><p id="p0065" num="0065"><figref idrefs="f0014">FIG. 14</figref> illustrates the bottommost portion of a ventricular cavity. The long axis is defined as a straight line passing through the illustrated bottommost ventricular portion 60 in<!-- EPO <DP n="16"> --> the three-dimensional cardiac model 31.</p><p id="p0066" num="0066"><figref idrefs="f0015">FIG. 15</figref> illustrates an example of long and short axes. The visualization unit 150 draws a line segment 61 between the center of the aorta valve and that of the mitral valve in the three-dimensional cardiac model 31. The visualization unit 150 then determines the midpoint of this line segment 61 and draws a straight line that goes through the midpoint and the above-noted bottommost ventricular portion 60, thereby determining a long axis 62 as seen in <figref idrefs="f0015">FIG. 15</figref>.</p><p id="p0067" num="0067">The visualization unit 150 then produces two straight lines 63 and 64 perpendicular to the long axis 62. One straight line 63 passes through the bottommost ventricular portion 60. The other straight line 64 meets the long axis 62 at the topmost point of the heart. Let La be the distance between the line segment 61 and the latter straight line 64, and Lv be the distance between the line segment 61 and the former straight line 63. The visualization unit 150 now draws a straight line that is perpendicular to the long axis 62 and apart from the line segment 61 at a distance of la being equal to two fifths of La. This straight line will be an atrial short axis 65 of the heart. The visualization unit 150 draws another straight line that is perpendicular to the long axis 62 and apart from the straight line 63 at a distance of Iv being equal to two fifths of Lv. This straight line will be a ventricular short axis 66 of the heart.</p><p id="p0068" num="0068">The visualization unit 150 now determines at which points the atrial short axis 65 meets free walls (cardiac walls other than the septum) of the atriums. These points are initial positions of the atriums. Similarly, the visualization unit 150 determines at which points the ventricular short axis 66 meets free walls of the ventricles, and sets these points as initial positions of the ventricles. <figref idrefs="f0016">FIG. 16</figref> illustrates such initial positions. Specifically, two initial positions 71 and 72 are seen on the atrial short axis 65 in the three-dimensional cardiac model 31, and another two initial positions 73 and 74 are seen on the ventricular short axis 66.</p><p id="p0069" num="0069">The above-described procedure determines initial positions of atriums and ventricles. Based on those initial positions, the visualization unit 150 produces synchronization data as a preparation for reproduction of heart behavior recorded in myocardium datasets 131, 132, 133, and so on. For example, the visualization unit 150 seeks a time point at which the<!-- EPO <DP n="17"> --> atrial free walls move from their initial positions 71 and 72 and maps that time point to the peak of P wave seen in the electrocardiogram. The visualization unit 150 also seeks another time point at which the ventricular free walls move from their initial positions 73 and 74 and maps that time point to the peak of R wave seen in the electrocardiogram.</p><p id="p0070" num="0070">The visualization unit 150 further maps a single heart beat cycle in the myocardium datasets to that in the electrocardiogram. For example, a heart beat cycle is defined as a period from the peak of one P wave to that of the next P wave. As an alternative, a heart beat cycle may refer to a period between the rising edges of two P waves in the case where the first simulation time step corresponds to the time point when the sinoatrial node 45 starts to output an electrical signal. As another alternative, a heart beat cycle may start at a change in the ventricles from relaxation to contraction and end at another such change. Such a change from relaxation to contraction of ventricles occurs after R wave appears in the QRS period (i.e., from the beginning of Q wave to the end of S wave).</p><p id="p0071" num="0071">The visualization unit 150 now produces synchronization data in the way described below. The synchronization data enables the visualization unit 150 to determine when to reproduce each time step of simulated heart behavior, while ensuring its synchronization with an associated electrocardiogram. <figref idrefs="f0017">FIGS. 17</figref> and <figref idrefs="f0018">18</figref> are first and second halves of a flowchart illustrating a procedure of producing synchronization data.</p><p id="p0072" num="0072">(Step S121) The visualization unit 150 retrieves a myocardium dataset 131, 132, 133, ... of each time step from the simulation result storage unit 130.</p><p id="p0073" num="0073">(Step S122) The visualization unit 150 initializes a variable T to zero, where T indicates the current time step number.</p><p id="p0074" num="0074">(Step S123) The visualization unit 150 determines whether variable T is smaller than Max_timestep, or the total number of time steps constituting a single heart beat cycle. If T is smaller than Max_timestep, the process advances to step S124. Otherwise, the process branches to step S131 in <figref idrefs="f0018">FIG. 18</figref>.</p><p id="p0075" num="0075">(Step S124) Variable T has not reached the end of the heart beat cycle. The visualization unit 150 thus checks the cardiac shape of time step T to determine whether the atrial myocardium has started to move from its initial position. For example, the visualization<!-- EPO <DP n="18"> --> unit 150 watches the current positions of some pieces of atrial myocardium while variable P_top contains no values. When any movement from their initial positions is found at time step T, the visualization unit 150 determines that the atrial myocardium started to move at that time step T, which means that the atriums have started to contract. Upon detection of such a movement, the process advances to step S125. The process skips to step S128 when there is no such movement as of time step T, or the atriums have already started to move.</p><p id="p0076" num="0076">(Step S125) The visualization unit 150 assigns the current value of T to variable P_top to record the time step at which the atriums started contraction.</p><p id="p0077" num="0077">(Step S126) The visualization unit 150 checks the cardiac shape of time step T to determine whether the ventricular myocardium has started to move from its initial position. For example, the visualization unit 150 watches the current positions of some pieces of ventricular myocardium while variable R_top contains no values. When any movement from their initial positions is found at time step T, the visualization unit 150 determines that the ventricular myocardium started to move at that time step T, which means that the ventricles have started to contract. Upon detection of such a movement, the process advances to step S127. The process skips to step S128 when there is no such movement as of time step T, or the ventricles have already started to move.</p><p id="p0078" num="0078">(Step S127) The visualization unit 150 assigns the current value of T to variable R_top to record the time step at which the ventricles started contraction.</p><p id="p0079" num="0079">(Step S128) The visualization unit 150 increments variable T by one and makes the process go back to step S123.</p><p id="p0080" num="0080">The above-described processing steps of <figref idrefs="f0017">FIG. 17</figref> cause two variables P_top and R_top to gain their values respectively indicating at which time steps the atriums and ventricles started contraction. The visualization unit 150 then determines when to render the cardiac shape of each subsequent time step as defined in the myocardium datasets.</p><p id="p0081" num="0081"><figref idrefs="f0018">FIG. 18</figref> is the second half of the flowchart illustrating a procedure of generating synchronization data.</p><p id="p0082" num="0082">(Step S131) The visualization unit 150 retrieves electrocardiogram datasets 141, 142, 143, ... from the electrocardiogram data storage unit 140.<!-- EPO <DP n="19"> --></p><p id="p0083" num="0083">(Step S132) The visualization unit 150 initializes variable T to zero.</p><p id="p0084" num="0084">(Step S133) The visualization unit 150 calculates a first time interval t1 of each time step of heart behavior that is supposed to be reproduced in the period from the beginning of electrical signal output to the peak of P wave in the electrocardiogram. Suppose, for example, that the myocardium datasets include n1 time steps between the beginning of a heart beat cycle and the time step P_top. Also suppose that the electrocardiogram gives a time length of t1 between the beginning of electrical signal output and the peak of P wave. The visualization unit 150 obtains t1 by dividing t1 by n1.</p><p id="p0085" num="0085">(Step S134) The visualization unit 150 determines whether variable T is smaller than P_top. If T is smaller than P_top, the process advances to step S135. Otherwise, the process proceeds to step S137.</p><p id="p0086" num="0086">(Step S135) As will be illustrated later, the synchronization data specifies reproduction time of each time step of heart behavior. At this step S135, the visualization unit 150 determines reproduction time for time step T such that the cardiac shape of time step T will be rendered t1 after that of time step (T-1). It is noted that time step 0 is supposed to be reproduced simultaneously with the start of a single heart beat cycle in the electrocardiogram.</p><p id="p0087" num="0087">(Step S136) The visualization unit 150 increments variable T by one and moves the process back to step S134.</p><p id="p0088" num="0088">(Step S137) The visualization unit 150 calculates a second time interval t2 of each time step of heart behavior that is supposed to be reproduced in the period from the peak of P wave to the peak of R wave in the electrocardiogram. Suppose, for example, that the myocardium datasets include n2 time steps between two time steps P_top and R_top. Also suppose that the electrocardiogram gives a time length of t2 between the peak of P wave and the peak of R wave. The visualization unit 150 obtains t2 by dividing t2 by n2.</p><p id="p0089" num="0089">(Step S138) The visualization unit 150 determines whether variable T is smaller than R_top. If T is smaller than R_top, the process advances to step S139. Otherwise, the process proceeds to step S141.</p><p id="p0090" num="0090">(Step S139) The visualization unit 150 determines reproduction time for time step T such that the cardiac shape of time step T will be rendered t2 after that of time step (T-1).<!-- EPO <DP n="20"> --></p><p id="p0091" num="0091">(Step S140) The visualization unit 150 increments variable T by one and makes the process go back to step S138.</p><p id="p0092" num="0092">(Step S141) The visualization unit 150 calculates a third time interval t3 of each time step of heart behavior that is supposed to be reproduced in the period from the peak of R wave to the end of the heart beat cycle in the electrocardiogram. Suppose, for example, that the myocardium datasets include n3 time steps between time step R_top and the last time step of the heart beat cycle. Also suppose that the electrocardiogram gives a time length of t3 between the peak of R wave and the end of the heart beat cycle. The visualization unit 150 obtains t3 by dividing t3 by n3.</p><p id="p0093" num="0093">(Step S142) The visualization unit 150 determines whether variable T is smaller than Max_timestep, or the number of time steps constituting the heart beat cycle. If T is smaller than Max_timestep, the process advances to step S143. Otherwise, the visualization unit 150 exits from the present process of <figref idrefs="f0018">FIG. 18</figref>.</p><p id="p0094" num="0094">(Step S143) The visualization unit 150 determines reproduction time for time step T such that the cardiac shape of time step T will be rendered t3 after that of time step (T-1).</p><p id="p0095" num="0095">(Step S144) The visualization unit 150 increments variable T by one and makes the process go back to step S142.</p><p id="p0096" num="0096">The above-described processing steps enable the visualization unit 150 to produce synchronization data that specifies when to reproduce the cardiac shape of each time step.</p><p id="p0097" num="0097"><figref idrefs="f0019">FIG. 19</figref> illustrates an example of synchronization data. The illustrated synchronization data 151 contains time code values associated with different time step numbers. These values are labeled "reproduction time" and each indicate when the cardiac shape of the associated time step is to be rendered, in terms of the elapsed time since the beginning of a heart beat cycle in the electrocardiogram. This synchronization data 151 is located in, for example, a storage space of the memory 102 that the visualization unit 150 manages.</p><p id="p0098" num="0098">It is noted that the synchronization data may be implemented in other forms than the table illustrated in the example of <figref idrefs="f0019">FIG. 19</figref>. For example, the synchronization data may be<!-- EPO <DP n="21"> --> contained in an array of time code values indexed by the time step number.</p><p id="p0099" num="0099">It is also noted that one heart beat cycle period may be divided differently from the foregoing example of <figref idrefs="f0018">FIGS. 18</figref> and <figref idrefs="f0019">19</figref>, which has illustrated three sections demarcated by the peaks of P and R waves. For example, the visualization unit 150 may be configured to calculate the interval of each time step in a unified period from the peak of R wave in one heart beat cycle to the peak of P wave in the next cycle.</p><p id="p0100" num="0100">The above description has discussed how the visualization unit 150 produces synchronization data 151. This synchronization data 151 is used to reproduce the heart behavior on a monitor screen so that the user can see it in synchronization with an electrocardiogram.</p><p id="p0101" num="0101"><figref idrefs="f0020">FIG. 20</figref> illustrates an example of a picture that reproduces heart behavior together with an electrocardiogram. The illustrated picture 80 is formed from an electrocardiogram section 81 and a heart behavior section 82. The electrocardiogram section 81 displays an electrocardiogram reproduced from electrocardiogram data, with a mark 83 indicating which time point is being reproduced. For example, the mark 83 moves from left to right along the waveform indicating voltage strength in the electrocardiogram, according to the progress of cardiac image reproduction.</p><p id="p0102" num="0102">The heart behavior section 82 depicts the behavior of the heart in the form of a three-dimensional model by deforming its shape in accordance with a series of myocardium datasets 131, 132, 133, and so on. That is, the three-dimensional model seen in the heart behavior section 82 has a shape reproduced from a myocardium dataset that corresponds to the reproduction time indicated by the mark 83 in the electrocardiogram section 81. The three-dimensional model is updated with its new myocardium dataset as the mark 83 moves with time, so that the behavior of the heart will be presented in an animated way.</p><p id="p0103" num="0103">While the above example of <figref idrefs="f0020">FIG. 20</figref> depicts only one lead, the electrocardiogram section 81 may optionally display all waveforms of twelve leads. <figref idrefs="f0021">FIG. 21</figref> illustrates an exemplary screenshot of a twelve-lead electrocardiogram. The illustrated electrocardiogram section 81 presents all waveforms of a twelve-lead electrocardiogram, each having a mark 83 indicating the current time point in the waveforms. Seen in the heart behavior section 82 is a<!-- EPO <DP n="22"> --> reproduced image of the heart at the current time point (reproduction time) indicated by the mark 83, relative to the beginning of the electrocardiogram. The cardiac image in the heart behavior section 82 changes as the mark 83 moves rightward.</p><p id="p0104" num="0104"><figref idrefs="f0022">FIG. 22</figref> illustrates how the heart changes its shape with the progress of reproduction time. The illustrated mark 83 moves rightward along the waveform of electrocardiogram in the electrocardiogram section 81 with the passage of reproduction time. The heart behavior section 82, on the other hand, contains an image of the heart at a time point corresponding to the current voltage indicated by the mark 83 in the electrocardiogram. For example, when the mark 83 is at the peak of P wave, the heart behavior section 82 displays the shape of the heart at time step P_top. When the mark 83 is at the peak of R wave, the heart behavior section 82 displays the shape of the heart at time step R_top.</p><p id="p0105" num="0105">The proposed techniques of the second embodiment are not limited to the visualization of normal heart behavior, but may also be applied to the case of arrhythmia. That is, it is possible to depict an arrhythmic heart beat in synchronization with an electrocardiogram of a patient experiencing arrhythmia. <figref idrefs="f0023">FIG. 23</figref> illustrates an exemplary screenshot that depicts heart behavior together with an electrocardiogram in the case of arrhythmia. More particularly, <figref idrefs="f0023">FIG. 23</figref> illustrates the case of tachyarrhythmia. This means that the patient's electrocardiogram contains more frequent waves than normal persons', which may be observed in the heart behavior section 82 as unnatural creases on the heart surface.</p><p id="p0106" num="0106">As can be seen from the above examples, an animated image of a patient's heart is displayed in synchronization with his or her electrocardiogram, thus making it easier for the user to understand how the heart actually behaves when a particular pattern of electrical signals appears in the electrocardiogram. In this way, the proposed techniques contribute to more precise diagnosis of the patient's medical condition.</p><p id="p0107" num="0107">In one aspect of the embodiments described above, the proposed techniques enable synchronized reproduction of a measured electrocardiogram and a simulated behavior of the heart under diagnosis.</p></description><claims mxw-id="PCLM90460612" lang="EN" load-source="patent-office"><!-- EPO <DP n="23"> --><claim id="c-en-0001" num="0001"><claim-text>A visualization apparatus, comprising:
<claim-text>storage means (11) for storing a three-dimensional model (1) of a heart of a patient, heart behavior data (2) representing shapes of the heart at different time steps of a behavioral simulation of the heart, and electrocardiogram data (3) representing temporal variations of an electrical signal in myocardium that have been measured from the patient; and</claim-text>
<claim-text>computation means (12) for determining a first time step at which the heart exhibits a first behavior in response to a first wave of the electrical signal, as well as a second time step at which the heart exhibits a second behavior in response to a second wave of the electrical signal, based on the heart behavior data (2), and for reproducing behavior of the heart over time by updating the three-dimensional model (1) according to the heart behavior data (2), simultaneously with variations in strength of the electrical signal over time according to the electrocardiogram data (3), such that a first shape of the heart at the first time step is reproduced simultaneously with the first wave of the electrical signal, and such that a second shape of the heart at the second time step is reproduced simultaneously with the second wave of the electrical signal.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The visualization apparatus according to claim 1, wherein the first wave is P wave appearing in an electrocardiogram, and the second wave is R wave appearing in the electrocardiogram.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The visualization apparatus according to claim 1 or 2, wherein the first time step is a time step at which atriums of the heart begin to contract, and the second time step is a time step at which ventricles of the heart begin to contract.</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>The visualization apparatus according to any of claims 1 to 3, wherein the computation means reproduces the first shape of the heart when the electrical signal reaches a peak of the first wave, and the second shape of the heart when the electrical signal reaches a<!-- EPO <DP n="24"> --> peak of the second wave.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>The visualization apparatus according to any of claims 1 to 4, wherein:
<claim-text>the computation means divides a single heart beat cycle into first to third sections, the first section being a period from a start of the electrical signal that initiates the single heart beat cycle to a peak of the first wave, the second section being a period from the peak of the first wave to a peak of the second wave, the third section being a period from the peak of the second wave to an end of the electrical signal that terminates the single heart beat cycle; and</claim-text>
<claim-text>the computation means determines at what constant time intervals the computation means is to reproduce the shapes of the heart at different time steps, depending on to which of the first to third sections of the single heart beat cycle the different time steps belong.</claim-text></claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>The visualization apparatus according to any of claims 1 to 5, wherein:
<claim-text>the first time step is a time step at which an initial move of atrial myocardium is detected at an intersection point of a straight line traversing atriums of the heart and a free wall of the atriums; and</claim-text>
<claim-text>the second time step is a time step at which an initial move of ventricular myocardium is detected at an intersection point of a straight line traversing ventricles of the heart and a free wall of the ventricles.</claim-text></claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>A visualization method to be executed by a computer, the visualization method comprising:
<claim-text>determining a first time step at which a heart of a patient exhibits a first behavior in response to a first wave of an electrical signal in myocardium of the heart, as well as a second time step at which the heart exhibits a second behavior in response to a second wave of the electrical signal, based on heart behavior data (2) representing shapes of the heart at different time steps of a behavioral simulation of the heart; and</claim-text>
<claim-text>reproducing behavior of the heart over time by updating a three-dimensional model (1) of the heart according to the heart behavior data (2), simultaneously with variations in<!-- EPO <DP n="25"> --> strength of the electrical signal over time according to electrocardiogram data (3) representing temporal variations of the electrical signal that have been measured from the patient, such that a first shape of the heart at the first time step is reproduced simultaneously with the first wave of the electrical signal, and such that a second shape of the heart at the second time step is reproduced simultaneously with the second wave of the electrical signal.</claim-text></claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>A program that causes a computer to perform a procedure comprising:
<claim-text>determining a first time step at which a heart of a patient exhibits a first behavior in response to a first wave of an electrical signal in myocardium of the heart, as well as a second time step at which the heart exhibits a second behavior in response to a second wave of the electrical signal, based on heart behavior data (2) representing shapes of the heart at different time steps of a behavioral simulation of the heart; and</claim-text>
<claim-text>reproducing behavior of the heart over time by updating a three-dimensional model (1) of the heart according to the heart behavior data (2), simultaneously with variations in strength of the electrical signal over time according to electrocardiogram data (3) representing temporal variations of the electrical signal that have been measured from the patient, such that a first shape of the heart at the first time step is reproduced simultaneously with the first wave of the electrical signal, and such that a second shape of the heart at the second time step is reproduced simultaneously with the second wave of the electrical signal.</claim-text></claim-text></claim></claims><drawings mxw-id="PDW20423230" load-source="patent-office"><!-- EPO <DP n="26"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="158" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="27"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="165" he="193" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="28"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="165" he="175" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="29"> --><figure id="f0004" num="4"><img id="if0004" file="imgf0004.tif" wi="165" he="183" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="30"> --><figure id="f0005" num="5"><img id="if0005" file="imgf0005.tif" wi="165" he="183" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="31"> --><figure id="f0006" num="6"><img id="if0006" file="imgf0006.tif" wi="165" he="194" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="32"> --><figure id="f0007" num="7"><img id="if0007" file="imgf0007.tif" wi="114" he="155" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="33"> --><figure id="f0008" num="8"><img id="if0008" file="imgf0008.tif" wi="157" he="179" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="34"> --><figure id="f0009" num="9"><img id="if0009" file="imgf0009.tif" wi="157" he="151" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="35"> --><figure id="f0010" num="10"><img id="if0010" file="imgf0010.tif" wi="165" he="121" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="36"> --><figure id="f0011" num="11"><img id="if0011" file="imgf0011.tif" wi="147" he="206" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="37"> --><figure id="f0012" num="12"><img id="if0012" file="imgf0012.tif" wi="119" he="152" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="38"> --><figure id="f0013" num="13"><img id="if0013" file="imgf0013.tif" wi="119" he="152" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="39"> --><figure id="f0014" num="14"><img id="if0014" file="imgf0014.tif" wi="135" he="178" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="40"> --><figure id="f0015" num="15"><img id="if0015" file="imgf0015.tif" wi="165" he="188" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="41"> --><figure id="f0016" num="16"><img id="if0016" file="imgf0016.tif" wi="165" he="180" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="42"> --><figure id="f0017" num="17"><img id="if0017" file="imgf0017.tif" wi="144" he="220" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="43"> --><figure id="f0018" num="18"><img id="if0018" file="imgf0018.tif" wi="145" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="44"> --><figure id="f0019" num="19"><img id="if0019" file="imgf0019.tif" wi="124" he="198" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="45"> --><figure id="f0020" num="20"><img id="if0020" file="imgf0020.tif" wi="164" he="188" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="46"> --><figure id="f0021" num="21"><img id="if0021" file="imgf0021.tif" wi="165" he="188" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="47"> --><figure id="f0022" num="22"><img id="if0022" file="imgf0022.tif" wi="157" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="48"> --><figure id="f0023" num="23"><img id="if0023" file="imgf0023.tif" wi="163" he="189" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="160" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="160" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
