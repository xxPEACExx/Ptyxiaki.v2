<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2959425-A1" country="EP" doc-number="2959425" kind="A1" date="20151230" family-id="50190791" file-reference-id="252649" date-produced="20180825" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160453236" ucid="EP-2959425-A1"><document-id><country>EP</country><doc-number>2959425</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-14707562-A" is-representative="NO"><document-id mxw-id="PAPP193869440" load-source="docdb" format="epo"><country>EP</country><doc-number>14707562</doc-number><kind>A</kind><date>20140212</date><lang>EN</lang></document-id><document-id mxw-id="PAPP193869441" load-source="patent-office" format="original"><country>EP</country><doc-number>14707562.6</doc-number><date>20140212</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162033982" ucid="US-201313770032-A" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201313770032</doc-number><kind>A</kind><date>20130219</date></document-id></priority-claim><priority-claim mxw-id="PPC162033962" ucid="US-2014016131-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>2014016131</doc-number><kind>W</kind><date>20140212</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1988522660" load-source="docdb">G06F  21/62        20130101AFI20140910BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988522811" load-source="docdb">G06F  21/53        20130101ALI20140910BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1987771114" load-source="docdb" scheme="CPC">G06F  21/6281      20130101 LI20150612BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987774365" load-source="docdb" scheme="CPC">G06F  21/53        20130101 LI20150612BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987788592" load-source="docdb" scheme="CPC">G06F  21/6209      20130101 FI20140821BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165551174" lang="DE" load-source="patent-office">VERFAHREN UND TECHNIK ZUR ANWENDUNGS- UND VORRICHTUNGSSTEUERUNG IN EINER VIRTUALISIERTEN UMGEBUNG</invention-title><invention-title mxw-id="PT165551175" lang="EN" load-source="patent-office">METHOD AND TECHNIQUE FOR APPLICATION AND DEVICE CONTROL IN A VIRTUALIZED ENVIRONMENT</invention-title><invention-title mxw-id="PT165551176" lang="FR" load-source="patent-office">PROCÉDÉ ET TECHNIQUE POUR APPLICATION ET CONTRÔLE DE DISPOSITIF DANS UN ENVIRONNEMENT VIRTUALISÉ</invention-title><citations><non-patent-citations><nplcit><text>See references of WO 2014130328A1</text><sources><source mxw-id="PNPL67568148" load-source="docdb" name="SEA"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR1103311653" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>SYMANTEC CORP</last-name><address><country>US</country></address></addressbook></applicant><applicant mxw-id="PPAR1103305636" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>SYMANTEC CORPORATION</last-name></addressbook></applicant><applicant mxw-id="PPAR1101651986" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Symantec Corporation</last-name><iid>101216101</iid><address><street>350 Ellis Street</street><city>Mountain View, CA 94043</city><country>US</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103309959" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>MANMOHAN SARIN SUMIT</last-name><address><country>IN</country></address></addressbook></inventor><inventor mxw-id="PPAR1103306385" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>MANMOHAN, SARIN SUMIT</last-name></addressbook></inventor><inventor mxw-id="PPAR1101639598" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>MANMOHAN, SARIN SUMIT</last-name><address><street>D404 Supreme Palms S.No. 119/2B Baner Balewadi</street><city>Pune 411045</city><country>IN</country></address></addressbook></inventor><inventor mxw-id="PPAR1103312407" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>JAISWAL SUMESH</last-name><address><country>IN</country></address></addressbook></inventor><inventor mxw-id="PPAR1103316651" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>JAISWAL, SUMESH</last-name></addressbook></inventor><inventor mxw-id="PPAR1101646404" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>JAISWAL, SUMESH</last-name><address><street>Flat 18 Unit 2 Sunshine Court Kalyani Nagar</street><city>Pune 411006</city><country>IN</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR1101647820" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Meldrum, David James</last-name><iid>101545223</iid><address><street>D Young &amp; Co LLP 120 Holborn</street><city>London EC1N 2DY</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="US-2014016131-W"><document-id><country>US</country><doc-number>2014016131</doc-number><kind>W</kind><date>20140212</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2014130328-A1"><document-id><country>WO</country><doc-number>2014130328</doc-number><kind>A1</kind><date>20140828</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS660634073" load-source="docdb">AL</country><country mxw-id="DS660717084" load-source="docdb">AT</country><country mxw-id="DS660634083" load-source="docdb">BE</country><country mxw-id="DS660792245" load-source="docdb">BG</country><country mxw-id="DS660637397" load-source="docdb">CH</country><country mxw-id="DS660742587" load-source="docdb">CY</country><country mxw-id="DS660717085" load-source="docdb">CZ</country><country mxw-id="DS660634084" load-source="docdb">DE</country><country mxw-id="DS660742588" load-source="docdb">DK</country><country mxw-id="DS660742589" load-source="docdb">EE</country><country mxw-id="DS660713508" load-source="docdb">ES</country><country mxw-id="DS660792246" load-source="docdb">FI</country><country mxw-id="DS660792247" load-source="docdb">FR</country><country mxw-id="DS660634085" load-source="docdb">GB</country><country mxw-id="DS660742590" load-source="docdb">GR</country><country mxw-id="DS660634086" load-source="docdb">HR</country><country mxw-id="DS660717086" load-source="docdb">HU</country><country mxw-id="DS660637398" load-source="docdb">IE</country><country mxw-id="DS660634095" load-source="docdb">IS</country><country mxw-id="DS660792248" load-source="docdb">IT</country><country mxw-id="DS660742599" load-source="docdb">LI</country><country mxw-id="DS660635319" load-source="docdb">LT</country><country mxw-id="DS660717091" load-source="docdb">LU</country><country mxw-id="DS660635320" load-source="docdb">LV</country><country mxw-id="DS660635321" load-source="docdb">MC</country><country mxw-id="DS660723136" load-source="docdb">MK</country><country mxw-id="DS660723137" load-source="docdb">MT</country><country mxw-id="DS660717092" load-source="docdb">NL</country><country mxw-id="DS660634096" load-source="docdb">NO</country><country mxw-id="DS660742600" load-source="docdb">PL</country><country mxw-id="DS660635335" load-source="docdb">PT</country><country mxw-id="DS660717093" load-source="docdb">RO</country><country mxw-id="DS660635336" load-source="docdb">RS</country><country mxw-id="DS660717094" load-source="docdb">SE</country><country mxw-id="DS660635337" load-source="docdb">SI</country><country mxw-id="DS660634097" load-source="docdb">SK</country><country mxw-id="DS660742601" load-source="docdb">SM</country><country mxw-id="DS660723138" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA139072441" ref-ucid="WO-2014130328-A1" lang="EN" load-source="patent-office"><p num="0000">A data loss prevention (DLP) manager running on a security virtual machine manages DLP policies for a plurality of guest virtual machines. The DLP manager identifies a source associated with a file open or create event. The source is at least one of an application or a device being used by a guest virtual machine (GVM). The DLP manager enforces a first response rule associated with the GVM when the source is a non-approved source per a source control policy. The DLP manager enforces a second response rule when the file violates a DLP policy.</p></abstract><abstract mxw-id="PA139540090" ref-ucid="WO-2014130328-A1" lang="EN" source="national office" load-source="docdb"><p>A data loss prevention (DLP) manager running on a security virtual machine manages DLP policies for a plurality of guest virtual machines. The DLP manager identifies a source associated with a file open or create event. The source is at least one of an application or a device being used by a guest virtual machine (GVM). The DLP manager enforces a first response rule associated with the GVM when the source is a non-approved source per a source control policy. The DLP manager enforces a second response rule when the file violates a DLP policy.</p></abstract><abstract mxw-id="PA139072442" ref-ucid="WO-2014130328-A1" lang="FR" load-source="patent-office"><p num="0000">L'invention concerne un gestionnaire de prévention de perte de données (DLP) exécuté sur une machine virtuelle de sécurité qui gère les politiques de DLP pour une pluralité de machines virtuelles invitées. Le gestionnaire de DLP identifie une source associée à un fichier ouvert ou à une création d'événement. La source est au moins un élément parmi une application ou un dispositif utilisé par une machine virtuelle invitée (GVM). Le gestionnaire de DLP applique une première règle de réponse associée à la GVM quand la source est une source non approuvée selon une politique de contrôle de source. Le gestionnaire de DLP applique une seconde règle de réponse quand le fichier enfreint une politique de DLP.</p></abstract><abstract mxw-id="PA139540091" ref-ucid="WO-2014130328-A1" lang="FR" source="national office" load-source="docdb"><p>L'invention concerne un gestionnaire de prévention de perte de données (DLP) exécuté sur une machine virtuelle de sécurité qui gère les politiques de DLP pour une pluralité de machines virtuelles invitées. Le gestionnaire de DLP identifie une source associée à un fichier ouvert ou à une création d'événement. La source est au moins un élément parmi une application ou un dispositif utilisé par une machine virtuelle invitée (GVM). Le gestionnaire de DLP applique une première règle de réponse associée à la GVM quand la source est une source non approuvée selon une politique de contrôle de source. Le gestionnaire de DLP applique une seconde règle de réponse quand le fichier enfreint une politique de DLP.</p></abstract><description mxw-id="PDES78476557" ref-ucid="WO-2014130328-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="3"/>--><p id="p0001" num="0001"> METHOD AND TECHNIQUE FOR APPLICATION AND DEVICE CONTROL IN A VIRTU ALIZED ENVIRONMENT</p><p id="p0002" num="0002">TECHNICAL FIELD </p><p id="p0003" num="0003"> [0001] The embodiments of the disclosure relate generally to virtual machine systems and, more specifically, relate to data loss prevention in a virtualized environment. </p><p id="p0004" num="0004">BACKGROUND </p><p id="p0005" num="0005"> [0002] In computer science, a virtual machine (VM) is a portion of software that, when executed on appropriate hardware, creates an environment allowing the virtualization of an actual physical computer system. Each VM may function as a self-contained platform, running its own operating system (OS) and software applications (processes). Typically, a virtual machine monitor (VMM) manages allocation and virtualization of computer resources and performs context switching, as may be necessary, to cycle between various VMs. </p><p id="p0006" num="0006"> [0003] A host machine (e.g., computer or server) is typically enabled to simultaneously run multiple VMs, where each VM may be used by a remote client. The host machine allocates a certain amount of the host's resources to each of the VMs. Each VM is then able to use the allocated resources to execute applications, including operating systems known as guest operating systems. The VMM virtualizes the underlying hardware of the host machine or emulates hardware devices, making the use of the VM transparent to the guest operating system or the remote client that uses the VM. </p><p id="p0007" num="0007"> [0004] Data Loss Prevention (DLP) in a virtual machine environment requires an agent to be installed on each virtual machine to prevent loss of sensitive data through the use of applications, removable devices (i.e., USB drives, CD/DVD) , and network shares. However, ensuring that every VM that gets created has an up-to-date DLP agent is a challenge and an inefficient use of system resources. </p><p id="p0008" num="0008"> SUMMARY </p><p id="p0009" num="0009"> [0005] Embodiments of the present disclosure provide a DLP manager running on a security virtual machine that manages DLP policies for a plurality of guest virtual machines. The DLP manager identifies a source associated with a file open or create event. The source is at least one of an application or a device being used by a guest virtual machine (GVM). The DLP manager enforces a first response rule associated with the GVM when the source is a non-approved source per a source control policy. The DLP manager enforces a second response rule when the file violates a DLP policy. The DLP manager identifies a startup event of a guest virtual machine, and installs a DLP component 
<!-- EPO <DP n="4"/>-->
 in the guest virtual machine. In one embodiment, the DLP manager installs a DLP component in the guest virtual machine before any other applications are launched or devices are used in the guest virtual machine. The DLP component communicates with the DLP manager operating within the security virtual machine. The DLP manager also receives file system events from the DLP component, and enforces one or more response rules associated with the guest virtual machine if the file system event violates a DLP policy. </p><p id="p0010" num="0010"> [0006] In one embodiment of a method, a dedicated security virtual machine (SVM) executing by a computing system monitors, a file open or create event to access a file by a guest virtual machine (GVM) executing by the computing system The dedicated SVM identifies a source associated with the file open or create event, wherein the source is at least one of an application or a device being used by the GVM. The dedicated SVM enforces a first response rule associated with the GVM when the source associated with the file open or create event is a non-approved source per a source control policy. The dedicated SVM enforces a second response rule associated with the GVM when the file violates a data loss prevention (DLP) policy. </p><p id="p0011" num="0011"> [0007] In a further embodiment, the dedicated SVM determines whether the source control policy exists to restrict access to the identified source to determine if the DLP policy requires monitoring of the source. The dedicated SVM monitors for file system events associated with the file to determine if the file violates the DLP policy. </p><p id="p0012" num="0012"> [0008] In a further embodiment, the dedicated SVM monitors by identifying a file close or save event associated with the file open or create event, analyzing data associated with the file close event to determine if the data violates the DLP policy, and executing the second response rule associated with the DLP policy if the data violates the DLP policy. </p><p id="p0013" num="0013"> [0009] In a further embodiment, the dedicated SVM reports a DLP policy violation when the data violates the DLP policy. </p><p id="p0014" num="0014"> [0010] In a further embodiment, the dedicated SVM determines if the DLP policy requires monitoring of the source application, stores a copy of the file when application tries to open the file, and restores the copy of the file in the close event if the data violates the DLP policy when application tries to save the file. </p><p id="p0015" num="0015"> [0011] In a further embodiment, the dedicated SVM installing a DLP user interface in the guest virtual machine configured to notify a user of DLP violations. </p><p id="p0016" num="0016"> [0012] In another embodiment, the dedicated SVM retrieves a DLP profile associated with 
<!-- EPO <DP n="5"/>-->
 the GVM from a profile repository, the DLP profile comprising the source control policy, DLP policy and the second response rule. </p><p id="p0017" num="0017"> [0013] In another embodiment, the source control policy is at least one of an application control policy or a device control policy, and the dedicated SVM can determine whether the file open or create event originates from the application or the device. </p><p id="p0018" num="0018"> [0014] In another embodiment, the dedicated SVM determines that the file does not violate the DLP policy. The dedicated SVM caches a result of the determination when the file does not violate the DLP policy. The dedicated SVM does not cache the result when at least one of the file violates the DLP policy or when the source is a non-approved source. The cache is cleared when there is a change in the DLP profile associated with the GVM. </p><p id="p0019" num="0019"> [0015] In addition, a computer readable storage medium for managing DLP policies for guest virtual machines is described. An exemplary computer readable storage medium provides instructions, which when executed on a processing system causes the processing system to perform operations such as the exemplary methods discussed above. </p><p id="p0020" num="0020"> [0016] Further, systems and apparatus for a DLP manager are described. An exemplary apparatus may include a memory and a processor coupled to the memory. The processor is configured to perform various operations, such as those described above. </p><p id="p0021" num="0021"> BRIEF DESCRIPTION OF THE DRAWINGS </p><p id="p0022" num="0022"> [0017] Embodiments of the present disclosure are illustrated by way of example, and not by way of limitation, and can be more fully understood with reference to the following detailed description when considered in connection with the figures in which: </p><p id="p0023" num="0023"> [0018] Figure 1 illustrates one embodiment of a virtual machine (VM) host server device, which employs a dedicated security virtual machine and a Data Loss Protection (DLP) manager to perform data loss protection; </p><p id="p0024" num="0024"> [0019] Figure 2 illustrates one embodiment of a DLP manager and a DLP component operating in a virtual machine environment; </p><p id="p0025" num="0025"> [0020] Figure 3 illustrates one embodiment of the DLP manager and DLP component; </p><p id="p0026" num="0026"> [0021] Figure 4 illustrates a flow diagram of one embodiment of a method for implementing a DLP manager; </p><p id="p0027" num="0027"> [0022] Figure 5 illustrates a flowchart diagram of a method for monitoring file system events according to one embodiment; 
<!-- EPO <DP n="6"/>-->
 [0023] Figure 6 illustrates a flowchart diagram of a method for another embodiment of monitoring a file system event; </p><p id="p0028" num="0028"> [0024] Figure 7 illustrates a flowchart diagram of a method for another embodiment of monitoring application and device events; and </p><p id="p0029" num="0029"> [0025] Figure 8 is a diagram of one embodiment of a computer system for facilitating the execution of the DLP manager. </p><p id="p0030" num="0030"> DETAILED DESCRIPTION </p><p id="p0031" num="0031"> [0026] Described herein are methods and systems for data loss prevention (DLP) in virtual machines. Embodiments of the present disclosure provide a DLP manager running on a security virtual machine that manages DLP policies for a plurality of guest virtual machines. The DLP manager identifies a source associated with a file open or create event. The source is at least one of an application or a device being used by a guest virtual machine (GVM). The DLP manager enforces a first response rule associated with the GVM when the source is a non-approved source per a source control policy. The DLP manager enforces a second response rule when the file violates a DLP policy. The DLP manager identifies a startup event of a guest virtual machine, and installs a DLP component in the guest virtual machine. In one embodiment, the DLP manager installs a DLP component in the guest virtual machine before any other applications are launched or devices are used in the guest virtual machine. The DLP component communicates with the DLP manager operating within the security virtual machine. The DLP manager also receives file system events from the DLP component, and enforces one or more response rules associated with the guest virtual machine if the file system event violates a DLP policy. </p><p id="p0032" num="0032"> [0027] In the following description, numerous details are set forth. It will be apparent, however, to one skilled in the art, that the present invention may be practiced without these specific details. In some instances, well-known structures and devices are shown in block diagram form, rather than in detail, in order to avoid obscuring the present invention. </p><p id="p0033" num="0033"> [0028] Some portions of the detailed descriptions, which follow, are presented in terms of algorithms and symbolic representations of operations on data bits within a computer memory. These algorithmic descriptions and representations are the means used by those skilled in the data processing arts to most effectively convey the substance of their work to others skilled in the art. An algorithm is here, and generally, conceived to 
<!-- EPO <DP n="7"/>-->
 be a self-consistent sequence of steps leading to a desired result. The steps are those requiring physical manipulations of physical quantities. Usually, though not </p><p id="p0034" num="0034">necessarily, these quantities take the form of electrical or magnetic signals capable of being stored, transferred, combined, compared, and otherwise manipulated. It has proven convenient at times, principally for reasons of common usage, to refer to these signals as bits, values, elements, symbols, characters, terms, numbers or the like. </p><p id="p0035" num="0035"> [0029] It should be borne in mind, however, that all of these and similar terms are to be associated with the appropriate physical quantities and are merely convenient labels applied to these quantities. Unless specifically stated otherwise, as apparent from the following discussion, it is appreciated that throughout the description, discussions utilizing terms such as "providing," "generating," "installing," "monitoring," "enforcing," "receiving," "logging," "intercepting ", or the like, refer to the action and processes of a computer system, or similar electronic computing device, that manipulates and transforms data represented as physical (electronic) quantities within the computer system's registers and memories into other data similarly represented as physical quantities within the computer system memories or registers or other such information storage, transmission or display devices. </p><p id="p0036" num="0036"> [0030] The present invention also relates to an apparatus for performing the operations herein. This apparatus may be specially constructed for the required purposes, or it may comprise a general-purpose computer selectively activated or reconfigured by a computer program stored in the computer. Such a computer program may be stored in a computer readable storage medium, such as, but not limited to, any type of disk including floppy disks, optical disks, CD-ROMs, and magnetic-optical disks, read-only memories (ROMs), random access memories (RAMs), EPROMs, EEPROMs, magnetic or optical cards, or any type of media suitable for storing electronic instructions, each coupled to a computer system bus. </p><p id="p0037" num="0037"> [0031] The present invention may be provided as a computer program product, or software, that may include a machine -readable medium having stored thereon instructions, which may be used to program a computer system (or other electronic devices) to perform a process according to the present invention. A machine -readable medium includes any mechanism for storing or transmitting information in a form readable by a machine (e.g., a computer). For example, a machine -readable (e.g., computer-readable) medium includes a machine (e.g., a computer) readable storage 
<!-- EPO <DP n="8"/>-->
 medium such as a read only memory ("ROM"), random access memory ("RAM"), magnetic disk storage media, optical storage media, flash memory devices, etc. </p><p id="p0038" num="0038"> [0032] Reference in the description to "one embodiment" or "an embodiment" means that a particular feature, structure or characteristic described in connection with the embodiment is included in at least one embodiment of the invention. The phrase "in one embodiment" located in various places in this description does not necessarily refer to the same embodiment. Like reference numbers signify like elements throughout the description of the figures. </p><p id="p0039" num="0039"> [0033] Figure 1 illustrates one embodiment of a virtual machine (VM) host server device 100, which employs a dedicated security virtual machine 101 and a Data Loss Protection (DLP) manager 104 to perform data loss protection. As illustrated, base platform hardware 116 comprises a computing platform, which may be capable, for example, of executing an operating system (OS) or a virtual -machine monitor (VMM), such as VMM 1 12. In some embodiments, base hardware platform 116 may include a processor 118, memory devices (memory 120 and disk 125), network devices, drivers, and so on. The VMM 112 virtualizes the physical resources of the base hardware platform 116 for one or more guest VMs 102 that are hosted by the server device 100 having the base hardware platform 116. In some embodiments, the VMM 1 12 may also be referred to as a hypervisor, a kernel-based hypervisor (e.g., Kernel-based VM (KVM)), or a host OS. In one embodiment, each VM 102 includes a guest operating system (OS), such as guest OS 106 and various guest software applications 110. </p><p id="p0040" num="0040"> [0034] The DLP manager 104 identifies, monitors, and protects data in use (e.g., endpoint actions), data in motion (e.g., network actions), and data at rest (e.g., data storage). Such data may be in the form of files, messages, web requests or the like. Typically, a DLP system monitors various files, messages, etc. to determine whether they constitute use-restricted documents or objects. A use-restricted document represents a document that cannot be freely distributed or manipulated due to its sensitive nature. Use-restricted documents may be marked with such words as "confidential," "sensitive," "stock," etc. to indicate their sensitive nature. In addition, use-restricted documents may include confidential information such as customer, employee, or patient personal information, pricing data, design plans, source code, CAD drawings, financial reports, etc. A use restricted object represents a removable device or an application that is non-approved. A use restricted application may be uniquely be identified using the executable file of the application or other information like it's internal name, 
<!-- EPO <DP n="9"/>-->
 version, hash, digital signature, publisher, etc. A use restricted device may be uniquely be identified using the hardware Id, manufacture, etc. </p><p id="p0041" num="0041"> [0035] The DLP manager 104 may determine whether a file or a message is a use-restricted document by applying a DLP policy. A DLP policy may specify what data should be present in a file or message to be classified as a use-restricted document. For example, a DLP policy may specify one or more keywords (e.g., "confidential," "sensitive," "stock," names of specific diseases (e.g., "cancer," "HIV," etc.), etc.) for searching various files, messages and the like. Additionally, the DLP Policy may specify other methods for identifying policy violations including, but not limited to, exact data matching (EDM), indexed document matching (IDM), and vector machine learning (VML). DLP policies will be discussed in greater detail below with reference to Figure 3. The DLP manager 104 may determine that a object is use restricted by applying source control policies. </p><p id="p0042" num="0042"> [0036] Instead of a typical DLP system, where each virtual machine would include a DLP agent, Figure 1 illustrates that the DLP manager 104 operates within a dedicated security VM (SVM) 101 and communicates with DLP components 108 operating on the guest VMs 102. In another embodiment, the DLP manager 104 may operate within the VMM 1 12 or other hypervisor process. The DLP manager 104 communicates across a virtual communication channel with a DLP component 108 operating within each of the guest VMs 102. The virtual communication channel, in one embodiment, is a virtual network where each VM 101, 102 may communicate using standard networking protocols, or proprietary networking protocols over an isolated virtual network dedicated to security functions. In another embodiment, the virtual communication channel is a virtualized communication bus coupling each of the VMs 101 , 102 with the VMM 112. The DLP component 108 may be configured as part of the operating system 106, or alternatively, an embedded process of the virtualized hardware of the guest virtual machine 102. The DLP manager 104 and DLP component 108 will be discussed below in greater detail with reference to Figure 2 and 3. In some embodiments, the SVM may remotely monitor the user interaction with an application, a device and the file in the GVM. For example, the VMware vShield™ framework, developed by VMware® of Palo Alto, CA, can be used for the DLP manager 104 and DLP component 108. Alternatively, other configurations may be used. </p><p id="p0043" num="0043"> [0037] Figure 2 illustrates one embodiment of a DLP manager 104 and a DLP component 108 operating in a virtual machine environment under embodiments of the present invention. In the depicted embodiment, the DLP manager 104 and the DLP component 108 are 
<!-- EPO <DP n="10"/>-->
 configured to operate in concert with a DLP system 201 that includes a hypervisor security driver 202 and VM security drivers 204. One example of a virtual machine DLP system suitable for use with the present disclosure is the VMware vShield™ framework developed by VMware® of Palo Alto, CA. Alternatively, and as described above, the DLP manager 104 and the DLP component 108 may be configured to operate independently of a virtual machine DLP system 201. </p><p id="p0044" num="0044"> [0038] The hypervisor security driver 202 may be implemented as a process operating on the VMM 112 and may be configured to communicating with a plurality of guest virtual machines 102, although only one is depicted here in Figure 2 for clarity. The DLP manager 104, in one embodiment, communicates with each guest DLP component 108 via the DLP system 201. The DLP manager 104 is configured to receive notifications from the DLP component 108 that are indicative of virtual machine and file system activity events. </p><p id="p0045" num="0045">Examples of virtual machine events include, but are not limited to, VM power on events, shutdown events, migration and reconfiguration events. Examples of file system events include, but are not limited to, file open events, file create events, file close (e.g., save) events, file read/write, copy/paste events, move file events and file deletion events. </p><p id="p0046" num="0046"> [0039] When the guest VM 102 is powered on, the DLP manager 104 is configured to intercept the power on event of the VM 102, identify the VM 102, and maintain identity information of the VM 102, as will be described in greater detail below with reference to Figure 3. In one embodiment, the DLP manager 104 identifies the VM 102 by identifying the operating system and/or roles (e.g., file server, email server, desktop, etc.), business unit (e.g., engineering, finance, marketing, HR, etc) of the VM 102.. In another example, the DLP manager 104 identifies the VM 102 by name specified in the VMM 112. One of skill in the art will recognize that there are many different methods for uniquely identifying a VM 102 that may be used in accordance with embodiments of the present disclosure. </p><p id="p0047" num="0047"> [0040] The DLP component 108 is configured to communicate with the DLP manager 104 file system events. For example, when a user initiates a file system event within the guest VM 102, the DLP component 108 intercepts the file system event and analyzes the event to determine the type of file system event (e.g., open, create, close, move, copy, read, write, delete, etc.) and transmits this information to the DLP manager 104. The information collected by the DLP component 108 and communicated with the DLP manager 104 may also comprise file or object information including, but not limited to, source, destination, application, file type (e.g., document, spreadsheet, media object, etc.), and file classification 
<!-- EPO <DP n="11"/>-->
 (e.g., personal, corporate, confidential, etc.). In some embodiments the information collected by the DLP component 108 and communicated with the DLP Manager 104 may include the application and the user initiating the file system event. The DLP component 108 is also configured, in one embodiment, with a DLP user interface for receiving from a user a justification for in the event where the DLP manager 104 identifies the user has violated a DLP policy. </p><p id="p0048" num="0048"> [0041] Figure 3 illustrates one embodiment of the DLP manager 104 and DLP component 108 under embodiments of the present invention. In one embodiment, the DLP manager 104 includes a VM identifier 302 and a VM identity repository 304. The VM identifier 302 uniquely identifies guest virtual machines as described above with reference to Figure 2. The DLP manager 104 is configured to determine if an identified guest virtual machine has a DLP security profile 306 associated with the guest virtual machine stored in the repository 304. The repository 304 maintains a plurality of profiles 306, one profile 306 for each virtual machine, or, one profile 306 for multiple virtual machines. Each of the profiles 306 may include a security control policy 312, data policy 308 and a response rule 310 for when the data policy 308 is violated. </p><p id="p0049" num="0049"> [0042] The DLP policies 308 specify rules for monitoring content to detect presence of confidential information. For example, a DLP policy 308 rule may specify one or more keywords (e.g., "confidential," "sensitive," "stock," names of specific diseases (e.g., "cancer," "HIV," etc.), etc.) for searching various files, messages and the like. In addition to keywords, a DLP policy 308 may include other rules for detecting presence of confidential data in information content being monitored. For example, in a financial organization, a DLP policy 308 may specify that if a message contains the word "confidential," further search of the message should be performed to determine whether the message includes customer data (e.g., a social security number, first name, last name, etc.) or other sensitive information (e.g., financial reports, source code, etc.). The response rule 310 specifies what actions should be taken when a policy violation is detected. For example, a response rule 310 may require that a message containing confidential data be blocked, re-routed, reported, quarantined, encrypted, etc. </p><p id="p0050" num="0050"> [0043] In one embodiment, the DLP policy 308 includes rules for exact data matching (EDM) and/or an indexed document matching (IDM). Exact data matching (EDM) may be used for protecting data that is typically in structured formats, such as database records. Indexed document matching (IDM) may be used to protect unstructured data, such as 
<!-- EPO <DP n="12"/>-->
 Microsoft® Word or PowerPoint® documents, or CAD drawings. For both EDM and IDM, sensitive data is first identified. The DLP manager 104 then fingerprints the sensitive data for precise, ongoing detection. In one embodiment, the fingerprinting process includes accessing and extracting text and data, normalizing it, and securing it using a nonreversible hash. When a file or other data is to be scanned, a fingerprint (e.g., hash) is generated of that file or contents of that file and compared to stored fingerprints. If a match is found, then the scanned file is identified as containing sensitive data. </p><p id="p0051" num="0051"> [0044] In one embodiment, the DLP policy 3038 includes a vector machine learning (VML) profile. Vector machine learning may be used to protect sensitive unstructured data. For VML, a training data set including a set of sensitive data and a set of non-sensitive data is provided to the DLP Manager 104. The DLP manager 104 analyzes the training data set using vector machine learning to generate a classification model and a feature set, which are added to the VM security profile 306 along with the training data set. The classification model is a statistical model for data classification that includes a map of support vectors that represent boundary features. The feature set is a data structure such as a list or table that includes multiple features (e.g., words) extracted from the training data set. The DLP manager 104 is configured to process the profile 306 and input unclassified data to classify the data as sensitive or non-sensitive (or to classify the data as personal data or corporate data). </p><p id="p0052" num="0052"> [0045] The DLP manager 104 may create a default policy for every VM detected, or may customize a VM profile 306 depending upon the role of the virtual machine. Additionally, the DLP manager 104 is configured to receive customized VM profiles 306 for various users who log onto the VM, other DLP managers 104 or hypervisor security devices. </p><p id="p0053" num="0053"> [0046] DLP policies 308 are provided to the DLP manager 104 that in turn performs content monitoring to detect policy violations across the VMs 102. In another embodiment, the DLP manager 104 is configured to communicate the VM profile 306 (e.g., DLP configuration) that is associated with a specific VM 102 and DLP component 108. The DLP component 108 is configured to determine if the DLP policy requires monitoring of the destination device which may include data in motion such outgoing messages or web requests transported using various protocols (e.g., simple mail transfer protocol (SMTP), hypertext transfer protocol (HTTP), file transfer protocol (FTP), AOL Instant Messaging (AIM), ICQ, single object access protocol (SOAP), SQLNet, transmission control protocol/Internet protocol (TCP/IP), user datagram protocol (UDP), Ethernet, 802.11, etc.). If the DLP component 108 identifies that the destination device requires monitoring, the DLP component 108 transmits a notification to the 
<!-- EPO <DP n="13"/>-->
 DLP manager 104. The DLP manager 104 may analyze the data associated with the file and create a record identifying the content, the relevant DLP policy 308, and a user associated with the violation, if the data violates policy 308. In addition, the DLP manager 104 may be configured to remotely take other actions required by the response rules 310. In another embodiment, the DLP component 108 locally performs these actions required by the response rules 310. </p><p id="p0054" num="0054"> [0047] The DLP component 108, in one embodiment, may also be configured to analyze fingerprints of the source data instead of the actual source data, to avoid exposing the confidential information and to facilitate more efficient searching of the content. Fingerprints may include hashes of source data, encrypted source data or any other signatures uniquely identifying the source data. The DLP component 108 may then report DLP policy violation(s) to the DLP manager 104, and/or may perform other necessary actions (e.g., blocking or rerouting the relevant content). Alternatively, the DLP manager 104 may be configured to remotely perform the monitoring and analyzing of data. </p><p id="p0055" num="0055"> [0048] The DLP manager 104 in SVM identifies the user using a non-approved application or device. If there are no application or device control policies, the DLP manager 104 may apply DLP policy and response rule by identifying whether the file being accessed by the application contains sensitive information. The application accessing the sensitive data may or may not be approved. When a user in GVM accesses any file, the DLP manager 104 in the SVM intercepts the file open or create event. The DLP manager 104 retrieves the saved identity of the VM to determine the source GVM. The DLP manager 104 uses the DLP kernel driver to identify the process or application, device being used, user and the file being access in the GVM. If the application or the device has source control policies access to the device and/or execution of application is blocked. If there are no application or device control policies, the DLP manager 104 applies DLP policy for monitoring file access activity, where the DLP manager 104 in SVM remotely reads the file data, and performs detection on this local data. If the data violates a DLP policy, the DLP manager 104 in SVM remotely executes response rules in the GVM. The response rules can be, but not limited to, blocking access to the sensitive data. </p><p id="p0056" num="0056"> [0049] In further embodiments, to optimize the operation, the DLP manager 104 may request the vShield framework to not cache the result. If the data is found to be not sensitive, the DLP manager 104 may request the vShield framework to cache the result so that further 
<!-- EPO <DP n="14"/>-->
 notifications for the same file are not sent until the file is either modified or renamed. The cache is cleared when there is a change in the DLP profile associated with the GVM. </p><p id="p0057" num="0057">[0050] User notification may be remotely presented by the DLP manager 104 in SVM to the user in GVM, using the lightweight DLP UI component 108 in the GVM as described earlier. In addition to remotely executing the response rules in the GVM, the DLP manager 104 in SVM creates an incident for the policy violation, which in addition to the user, file, application, device, data leak vector contains the source of the VM. In some embodiments, before DLP manager 104 performs detection on the data, the DLP manager 104 may determine the GVM from where the operation is performed and apply machine filters to optimize detection or to avoid detection. In some embodiments, when a user in GVM accesses a file, the DLP manager 104 may determine the user performing the operation and may apply user or user-group filters to optimize detection or avoid detection. In some embodiments, before the DLP manager 104 performs detection on the file, file type, file path and size filters may be applied to optimize detection or avoid detection. </p><p id="p0058" num="0058"> [0051] The embodiments described herein provide an efficient agentless DLP solution for server and desktop virtualized environments. The embodiments may also be used in mobile environments. VMs, which may be dynamically provisioned, may be automatically protected by the DLP manager 104 in SVM. Having a single DLP manager 104 for all VMs on server may simplify DLP manager 104 management and may improves system performance. The embodiments may improve the overall security of the system by reducing, or possibly eliminating, the DLP manager 104 foot print in each VM. </p><p id="p0059" num="0059"> [0052] Figures 4-7 are flowchart and/or block diagram illustrations of methods, systems and computer program products according to an embodiment of the disclosure. It will be understood that each block of the flowchart and/or block diagram illustrations, and combinations of blocks in the flowchart and/or block diagram illustrations, may be implemented by processing logic. The processing logic may comprise hardware (circuitry, dedicated logic, etc.), software (such as is run on a general-purpose computer system or a dedicated machine), or a combination of both. These software instructions, or other computer program instructions, may be provided to a processor of a general purpose computer, special purpose computer, or other programmable data processing apparatus to produce the processing logic, such that the instructions, which execute via the processor of a computer or other programmable data processing apparatus, implement the functions specified in the flowchart and/or block diagram block or blocks. 
<!-- EPO <DP n="15"/>-->
 [0053] Figure 4 illustrates a flow diagram of one embodiment of a method 400 for implementing a DLP manager 104 under embodiments of the present invention. The method starts and the processing logic, at block 402, detects a virtual machine startup event. In one embodiment, the processing logic is configured to capture a startup event by identifying a virtual machine that has requested computing resources from a hypervisor. The processing logic then, at block 404, intercepts the startup request and identifies, at block 406, the virtual machine. The processing logic is configured to identify the virtual machine by analyzing the characteristics of the virtual machine. These characteristics can include, but are not limited to, resources requested by the virtual machine, the type of operating system of the virtual machine, the operating role of the virtual machine (e.g., file server, email server, database server, etc.), and/or the name of the virtual machine as specified in the VMM or name of the business unit to which the virtual machine belongs. </p><p id="p0060" num="0060"> [0054] At block 408, the processing logic saves the virtual machine information to the repository 304. In one embodiment, the processing logic determines if the virtual machine information already exists as a virtual machine profile 306. If a virtual machine profile 306 does not exist for the identified virtual machine, the processing logic is configured to create a new virtual machine profile 306 with a default source control policy, DLP policy 308 and response rule 310. In another embodiment, the processing logic retrieves a virtual machine profile 306 from, for example, the hypervisor security driver 202 of Figure 2. </p><p id="p0061" num="0061"> [0055] At block 410, the processing logic remotely installs the DLP component in the identified virtual machine. The processing logic is configured to install the DLP component by pushing and automatically installing the DLP component. At block 412, the processing logic optionally installs a user interface configured to notify a user of DLP policy violations. In one embodiment, the user interface presents a visual or aural message to the user. </p><p id="p0062" num="0062">Alternatively, the user interface may transmit a message (e.g., email) to the user. The method 400 then ends. </p><p id="p0063" num="0063"> [0056] Figure 5 illustrates a flowchart diagram of a method 500 for monitoring file system events under embodiments of the present invention. The method begins and processing logic, at block 502, detects a "file close" event in the guest virtual machine. In one embodiment, the processing logic receives a notification from, for example, a DLP component 108 of the virtual machine 102 that indicates a user is closing or saving a file. The processing logic, at block 504, retrieves the VM identity profile 306 from the repository 304 (see Figure 3) that matches the VM that initiated the file close event. 
<!-- EPO <DP n="16"/>-->
 [0057] At block 506, the processing logic identifies the storage target associated with the file close or save event. For example, the processing logic is configured to determine if the storage target device is a removable device, removable medium, network share, etc. If the DLP policy 308 requires monitoring of the storage target device, the processing logic, at block 10, is configured to analyze the data the user is requesting to be stored on the target device. If the DLP policy 308 does not require monitoring of the storage target device, the processing logic, at block 512, allows the data transfer. </p><p id="p0064" num="0064"> [0058] At block 514, the processing logic determines if the analyzed data violates the DLP policy 308. For example, the DLP policy 308 rule may specify one or more keywords (e.g., "confidential," "sensitive," "stock," names of specific diseases (e.g., "cancer," "HIV," etc.), etc.) for searching various files, messages and the like. In addition to keywords, the DLP policy 308 may include other rules for detecting presence of confidential data in information content being monitored. For example, in a financial organization, a DLP policy 308 may specify that if a message contains the word "confidential," further search of the message should be performed to determine whether the message includes customer data (e.g., a social security number, first name, last name, etc.) or other sensitive information (e.g., financial reports, source code, etc.). If the analyzed data does not violate the DLP policy 308, the processing logic, at block 512, allows the data transfer. </p><p id="p0065" num="0065"> [0059] If, however, the analyzed data does violate the DLP policy, the processing logic, at block 16, executes the response rule(s) 310 associated with the DLP policy 308. For example, the response rule 310 may require that a message containing confidential data be blocked, re-routed, reported, quarantined, encrypted, etc. The processing logic, at block 518, reports the policy violation and the actions taken in response to the policy violation. In a further embodiment, the processing logic instructs the DLP user interface to indicate to the user that the user has violated a DLP policy. For example, the DLP user interface may be configured to present a message on a screen to the user, and/or transmit a message to the user via email. The method 500 then ends. </p><p id="p0066" num="0066"> [0060] Figure 6 illustrates a flowchart diagram of a method 600 for another embodiment of monitoring a file system event under embodiments of the present invention. The method 600 starts and the processing logic, at block 602, detects a file creation or file open event in a guest virtual machine. The processing logic, in one embodiment, is configured to remotely monitor file system events in the virtual machine. Alternatively, the processing logic is configured to receive notification from the DLP component 108. 
<!-- EPO <DP n="17"/>-->
 [0061] At block 604, the processing logic retrieves the virtual machine identity of the virtual machine associated with the file system event. The processing logic, as described above, is configured to uniquely identify the virtual machine by analyzing characteristics of the virtual machine. The characteristics may include, but are not limited to, type of operating system, types of virtual devices associated with the virtual machine, and the role of the virtual machine. The processing logic is also configured to retrieve from the repository 304 a DLP profile associated with the identified virtual machine. </p><p id="p0067" num="0067"> [0062] At block 606, the processing logic identifies the source device of the file system event. For example, the processing logic identifies if a user is attempting to open an existing file from the Internet, from an attached storage device, from a local storage drive, from a network attached storage device, etc. The processing logic then, at block 608, determines if the DLP profile 308 requires monitoring of the identified source device. If the DLP profile 308 does not require monitoring of the source device, the processing logic, at block 610, allows the file to be opened </p><p id="p0068" num="0068"> [0063] If, however, the DLP profile 308 requires monitoring of the source device, the processing logic makes a copy, at block 612, of the data in the file to be opened. In one embodiment, the processing logic may make a copy of the data in a dedicated storage area of the security VM 101 of Figure 1. Alternatively, the processing logic may make a copy of the data in a dedicated storage area in the guest VM 102. The processing logic, at block 616, when receives a notification from the DLP component 108 of the virtual machine 102 that indicates a user is closing or saving a file, it determines whether the modified file violates the DLP policy 308. For example, the processing logic is configured to analyze the content for words and media objects (e.g., images, audio objects and video objects) that violate the DLP policy. If the processing logic determines the analyzed data does not violate the DLP policy 308, the processing logic allows the data transfer at block 610. If the analyzed data violate the DLP policy, the processing logic at block 618 executes the response rule(s) 310 associated with the DLP policy 308 and restores the copy of the file to its original location. The processing logic, at block 619, deletes the copy of the file and method 600 then ends. </p><p id="p0069" num="0069"> [0064] Figure 7 illustrates a flowchart diagram of a method 600 for another embodiment of monitoring a file system event under embodiments of the present invention. The method 700 starts and the processing logic, at block 702, detects a file creation or file open event in a guest virtual machine. The processing logic, in one embodiment, is configured to remotely monitor file system events in the virtual machine. Alternatively, the processing logic is 
<!-- EPO <DP n="18"/>-->
 configured to receive notification from the DLP component 108. In one embodiment, previous to block 702, the processing logic may receive other GVM activity events and File System activity events, such as a VM startup event. When a GVM is powered on, the DLP manager 104 in SVM intercepts the VM startup event, identifies the identity of the new VM, saves this information with the VM context and optionally pushes two lightweight components, a DLP UI component and a DLP kernel driver into the GVM. As described herein, the DLP UI component is used for educating the user and collecting user justification. The DLP kernel driver can be used to intercept file system activity events, as well as monitor other activities by the GVM. In addition, the DLP kernel driver can help identify an application or a device accessing a file as described below. </p><p id="p0070" num="0070"> [0065] At block 704, the processing logic retrieves the virtual machine identity of the virtual machine associated with the open or create file event. The processing logic, as described above, is configured to uniquely identify the virtual machine by analyzing characteristics of the virtual machine. The characteristics may include, but are not limited to, type of operating system, types of virtual devices associated with the virtual machine, and the role of the virtual machine. The processing logic is also configured to retrieve from the repository 304 a DLP profile associated with the identified virtual machine. </p><p id="p0071" num="0071"> [0066] At block 706, the processing logic identifies the source of the open or create file event of the file system event. The source may be an application, a device or the like. For example, the processing logic identifies the user is using a non-approved application or a non- approved device for application control policies or device control policies. For example, the processing logic can remotely apply application or device control policies when user uses a non-approved application or a non-approved device. If there are no application or device control policies, the processing logic can apply DLP policies and response rules by identifying whether the file being accessed contains sensitive information. The processing logic may also identify a type of the application, type of device, or other information associated with the file system activity event. </p><p id="p0072" num="0072"> [0067] At block 708, the processing logic determines whether a source control policy exists to restrict access to the identified source to determine if the DLP policy requires monitoring of the source. If at block 708 the processing logic determines that there is a source control policy, the processing logic determines if the source is an approved source (block 710). If at block 710 the processing logic determines that the source is an approved source, the processing logic can allow the data transfer at block 720. If the source is not approved, the 
<!-- EPO <DP n="19"/>-->
 processing logic blocks the data transfer (block 712) and the method 700 ends. If there is no source control policy at block 708, the processing logic monitors the source as described below. For example, the processing logic can determine if the DLP profile 308 requires monitoring. </p><p id="p0073" num="0073"> [0068] At block 714, the processing logic the processing logic makes a copy of the data in the file to be opened. In one embodiment, the processing logic may make a copy of the data in a dedicated storage area of the security VM 101 of Figure 1. Alternatively, the processing logic may make a copy of the data in a dedicated storage area in the guest VM 102. The processing logic, at block 716, when receives a notification from the DLP component 108 of the virtual machine 102 that indicates a user is closing or saving a file, it determines whether the modified file violates the DLP policy 308 (block 718). For example, the processing logic is configured to analyze the content for words and media objects (e.g., images, audio objects and video objects) that violate the DLP policy. If the processing logic determines the analyzed data does not violate the DLP policy 308 at block 718, the processing logic allows the data transfer at block 720. If the analyzed data violates the DLP policy at block 718, the processing logic at block 722 executes the response rule(s) 310 associated with the DLP policy 308 and restores the copy of the file to its original location. The processing logic, at block 724, deletes the copy of the file and method 700 ends. </p><p id="p0074" num="0074"> [0069] In another embodiment, the processing logic monitors, by a dedicated SVM, a file open or create event to access a file by a GVM. The processing logic identifies a source associated with the file open or create event, where the source is at least one of an application or a device being used by the GVM. The processing logic enforces a first response rule associated with the GVM when the source associated with the file open or create event is a non-approved source per a source control policy. The processing logic enforces a second response rule associated with the GVM when the file violates a DLP policy. </p><p id="p0075" num="0075"> [0070] In a further embodiment, the processing logic determines whether the source control policy exists to restrict access to the identified source to determine if the DLP policy requires monitoring of the source. The processing logic monitors the source for file system events associated with the file to determine if the file violates the DLP policy. </p><p id="p0076" num="0076"> [0071] In a further embodiment, the processing logic monitors by identifying a file close or save event associated with the file open event, analyzing data associated with the file close or save event to determine if the data violates the DLP policy, and executing the second response rule associated with the DLP policy if the data violates the DLP policy. In a further 
<!-- EPO <DP n="20"/>-->
 embodiment, the processing logic logs a DLP policy violation when the data violates the DLP policy. </p><p id="p0077" num="0077"> [0072] In another embodiment, the processing logic determines if the DLP policy requires monitoring of the source. The processing logic stores a copy of the file and restores the copy of the file in the close or save event if the data violates the DLP policy. </p><p id="p0078" num="0078"> [0073] In another embodiment, the processing logic remotely installs the DLP component in the identified virtual machine. The processing logic is configured to install the DLP component by pushing and automatically installing the DLP component. The processing logic optionally installs a user interface configured to notify a user of DLP policy violations. In one embodiment, the user interface presents a visual or aural message to the user. </p><p id="p0079" num="0079"> [0074] In a further embodiment, the processing logic retrieves a DLP profile associated with the GVM from a profile repository, the DLP profile comprising the source control policy, DLP policy and the second response rule. In another embodiment, the source control policy is at least one of an application control policy or a device control policy. The processing logic identifies the source comprises determining whether the file open or create event originates from the application or the device. </p><p id="p0080" num="0080"> [0075] In another embodiment, the processing logic determines that the file does not violate the DLP policy. The processing logic caches a result of the determination when the file does not violate the DLP policy. The result is not cached when at least one of the file violates the DLP policy or when the source is a non-approved source. The cache is cleared when there is a change in the DLP profile associated with the GVM. </p><p id="p0081" num="0081"> [0076] Figure 8 is a diagram of one embodiment of a computer system for facilitating the execution of the DLP manager. Within the computer system 800 is a set of instructions for causing the machine to perform any one or more of the methodologies discussed herein. In alternative embodiments, the machine may be connected (e.g., networked) to other machines in a LAN, an intranet, an extranet, or the Internet. The machine can be a host in a cloud, a cloud provider system, a cloud controller or any other machine. The machine can operate in the capacity of a server or a client machine in a client-server network environment, or as a peer machine in a peer-to-peer (or distributed) network environment. The machine may be a personal computer (PC), a tablet PC, a console device or set-top box (STB), a Personal Digital Assistant (PDA), a cellular telephone, a web appliance, a server, a network router, switch or bridge, or any 
<!-- EPO <DP n="21"/>-->
 machine capable of executing a set of instructions (sequential or otherwise) that specify actions to be taken by that machine. Further, while only a single machine is illustrated, the term "machine" shall also be taken to include any collection of machines (e.g., computers) that individually or jointly execute a set (or multiple sets) of instructions to perform any one or more of the methodologies discussed herein. </p><p id="p0082" num="0082"> [0077] The exemplary computer system 800 includes a processing device 802, a main memory 804 (e.g., read-only memory (ROM), flash memory, dynamic random access memory (DRAM) such as synchronous DRAM (SDRAM) or DRAM (RDRAM), etc.), a static memory 806 (e.g., flash memory, static random access memory (SRAM), etc.), and a secondary memory 818 (e.g., a data storage device in the form of a drive unit, which may include fixed or removable computer -readable storage medium), which communicate with each other via a bus 830. </p><p id="p0083" num="0083"> [0078] Processing device 802 represents one or more general-purpose processing devices such as a microprocessor, central processing unit, or the like. More particularly, the processing device 802 may be a complex instruction set computing (CISC) microprocessor, reduced instruction set computing (RISC) microprocessor, very long instruction word (VLIW) microprocessor, processor implementing other instruction sets, or processors implementing a combination of instruction sets. Processing device 802 may also be one or more special-purpose processing devices such as an application specific integrated circuit (ASIC), a field programmable gate array (FPGA), a digital signal processor (DSP), network processor, or the like. Processing device 802 is configured to execute the instructions 826 for performing the operations and steps discussed herein. </p><p id="p0084" num="0084"> [0079] The computer system 800 may further include a network interface device 822. The computer system 800 also may include a video display unit 810 (e.g., a liquid crystal display (LCD) or a cathode ray tube (CRT)) connected to the computer system through a graphics port and graphics chipset, an alphanumeric input device 812 (e.g., a keyboard), a cursor control device 814 (e.g., a mouse), and a signal generation device 820 (e.g., a speaker). </p><p id="p0085" num="0085"> [0080] The secondary memory 818 may include a machine-readable storage medium (or more specifically a computer-readable storage medium) 824 on which is stored one or more sets of instructions 826 embodying any one or more of the methodologies or functions described herein. In one embodiment, the instructions 826 include instructions for the DLP manager 104. The instructions 826 may also reside, completely or at least partially, within the 
<!-- EPO <DP n="22"/>-->
 main memory 804 and/or within the processing device 802 during execution thereof by the computer system 800, the main memory 804 and the processing device 802 also constituting machine-readable storage media. </p><p id="p0086" num="0086"> [0081] The computer-readable storage medium 824 may also be used to store the instructions 826 persistently. While the computer-readable storage medium 824 is shown in an exemplary embodiment to be a single medium, the term "computer-readable storage medium" should be taken to include a single medium or multiple media (e.g., a centralized or distributed database, and/or associated caches and servers) that store the one or more sets of instructions. The term "computer-readable storage medium" shall also be taken to include any medium that is capable of storing or encoding a set of instructions for execution by the machine and that cause the machine to perform any one or more of the methodologies of the present invention. The term "computer-readable storage medium" shall accordingly be taken to include, but not be limited to, solid-state memories, and optical and magnetic media. </p><p id="p0087" num="0087"> [0082] The instructions 826, components and other features described herein can be implemented as discrete hardware components or integrated in the functionality of hardware components such as ASICS, FPGAs, DSPs or similar devices. In addition, the instructions 826 can be implemented as firmware or functional circuitry within hardware devices. Further, the instructions 826 can be implemented in any combination hardware devices and software components. </p><p id="p0088" num="0088"> [0083] In the above description, numerous details are set forth. It will be apparent, however, to one skilled in the art, that the present invention may be practiced without these specific details. In some instances, well-known structures and devices are shown in block diagram form, rather than in detail, in order to avoid obscuring the present invention. </p><p id="p0089" num="0089"> [0084] Some portions of the detailed description, which follows, are presented in terms of algorithms and symbolic representations of operations on data bits within a computer memory. These algorithmic descriptions and representations are the means used by those skilled in the data processing arts to most effectively convey the substance of their work to others skilled in the art. An algorithm is here, and generally, conceived to be a self-consistent sequence of steps leading to a result. The steps are those requiring physical manipulations of physical quantities. Usually, though not necessarily, these quantities take the form of electrical or magnetic signals capable of being stored, transferred, combined, compared, and otherwise manipulated. It has proven convenient at times, principally for reasons of common 
<!-- EPO <DP n="23"/>-->
 usage, to refer to these signals as bits, values, elements, symbols, characters, terms, numbers or the like. </p><p id="p0090" num="0090"> [0085] It should be borne in mind, however, that all of these and similar terms are to be associated with the appropriate physical quantities and are merely convenient labels applied to these quantities. Unless specifically stated otherwise as apparent from the following discussion, it is appreciated that throughout the description, discussions utilizing terms such as "providing," "generating," "installing," "monitoring," "enforcing," "receiving," "logging," "intercepting," or the like, refer to the actions and processes of a computer system, or similar electronic computing device, that manipulates and transforms data represented as physical (e.g., electronic) quantities within the computer system's registers and memories into other data similarly represented as physical quantities within the computer system memories or registers or other such information storage, transmission or display devices. </p><p id="p0091" num="0091"> [0086] It is to be understood that the above description is intended to be illustrative, and not restrictive. Many other embodiments will be apparent to those of skill in the art upon reading and understanding the above description. Although the present invention has been described with reference to specific exemplary embodiments, it will be recognized that the invention is not limited to the embodiments described, but can be practiced with modification and alteration within the spirit and scope of the appended claims. Accordingly, the specification and drawings are to be regarded in an illustrative sense rather than a restrictive sense. The scope of the invention should, therefore, be determined with reference to the appended claims, along with the full scope of equivalents to which such claims are entitled. 
</p></description><claims mxw-id="PCLM70076801" ref-ucid="WO-2014130328-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="24"/>-->CLAIMS We claim: </claim-statement><claim id="clm-0001" num="1"><claim-text> 1. A method comprising: </claim-text><claim-text> monitoring, by a dedicated security virtual machine (SVM) executing by a computing system, a file open event to access a file by a guest virtual machine (GVM) executing by the computing system; </claim-text><claim-text> identifying a source associated with the file open event, wherein the source is at least one of an application or a device being used by the GVM; </claim-text><claim-text> enforcing a first response rule associated with the GVM when the source associated with the file open event is a non-approved source per a source control policy; and </claim-text><claim-text> enforcing a second response rule associated with the GVM when the file violates a data loss prevention (DLP) policy. </claim-text></claim><claim id="clm-0002" num="2"><claim-text> 2. The method of claim I, further comprising: </claim-text><claim-text> determining whether the source control policy exists to restrict access to the identified source to determine if the DLP policy requires monitoring of the source; and </claim-text><claim-text> monitoring the source for file system events associated with the file to determine if the file violates the DLP policy, wherein the monitoring comprises: </claim-text><claim-text> identifying a file close event associated with the file open event; </claim-text><claim-text> analyzing data associated with the file close event to determine if the data violates the DLP policy; </claim-text><claim-text> executing the second response rule associated with the DLP policy if the data violates the DLP policy; and </claim-text><claim-text> reporting a DLP policy violation when the data violates the DLP policy. </claim-text></claim><claim id="clm-0003" num="3"><claim-text> 3. The method of claim 1, further comprising: </claim-text><claim-text> determining if the DLP policy requires monitoring of the source; </claim-text><claim-text> storing a copy of the file; and </claim-text><claim-text> restoring the copy of the file in the close event if the data violates the DLP policy. </claim-text></claim><claim id="clm-0004" num="4"><claim-text> 4. The method of claim 1, further comprising installing a DLP user interface in the guest virtual machine configured to notify a user of DLP violations. </claim-text></claim><claim id="clm-0005" num="5"><claim-text> 5. The method of claim 1 , further comprising retrieving a DLP profile associated with the GVM from a profile repository, the DLP profile comprising the source control policy, DLP policy and the second response rule. </claim-text></claim><claim id="clm-0006" num="6"><claim-text> 6. The method of claim 1 , wherein the source control policy is at least one of an application control policy or a device control policy, and wherein the identifying the source comprises determining whether the file open event originates from the application or the device. 
<!-- EPO <DP n="25"/>-->
</claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. The method of claim 1, further comprising: </claim-text><claim-text> determining that the file does not violate the DLP policy; and </claim-text><claim-text> caching a result of the determination when the file does not violate the DLP policy, wherein the result is not cached when at least one of the file violates the DLP policy or when the source is a non-approved source. </claim-text></claim><claim id="clm-0008" num="8"><claim-text> 8. A non-transitory computer readable storage medium including instructions that, when executed by a processing device, cause the processing device to perform operations comprising: monitoring, by a dedicated security virtual machine (SVM) executing by a computing system, a file open event to access a file by a guest virtual machine (GVM) executing by the computing system; </claim-text><claim-text> identifying a source associated with the file open event, wherein the source is at least one of an application or a device being used by the GVM; </claim-text><claim-text> enforcing a first response rule associated with the GVM when the source associated with the file open event is a non-approved source per a source control policy; and </claim-text><claim-text> enforcing a second response rule associated with the GVM when the file violates a data loss prevention (DLP) policy. </claim-text></claim><claim id="clm-0009" num="9"><claim-text> 9. The computer readable storage medium of claim 8, wherein the operations further comprise: </claim-text><claim-text> determining whether the source control policy exists to restrict access to the identified source to determine if the DLP policy requires monitoring of the source; and </claim-text><claim-text> monitoring the source for file system events associated with the file to determine if the file violates the DLP policy, wherein the monitoring comprises: </claim-text><claim-text> identifying a file close event associated with the file open event; </claim-text><claim-text> analyzing data associated with the file close event to determine if the data violates the DLP policy; and </claim-text><claim-text> executing the second response rule associated with the DLP policy if the data violates the DLP policy. </claim-text></claim><claim id="clm-0010" num="10"><claim-text> 10. The computer readable storage medium of claim 8, wherein the operations further comprise: </claim-text><claim-text> determining that the file does not violate the DLP policy; and </claim-text><claim-text> caching a result of the determination when the file does not violate the DLP policy, wherein the result is not cached when at least one of the file violates the DLP policy or when the source is a non-approved source. </claim-text></claim><claim id="clm-0011" num="11"><claim-text> 11. A computing apparatus comprising: </claim-text><claim-text> a memory to store instructions for providing a data loss prevention (DLP) manager; and 
<!-- EPO <DP n="26"/>-->
 a computing device, coupled to the memory, wherein the computing device is configured to execute the DLP manager: </claim-text><claim-text> monitor, by the DLP manager, a file open event to access a file by a guest virtual machine (GVM) executing by the computing system; </claim-text><claim-text> identify a source associated with the file open event, wherein the source is at least one of an application or a device being used by the GVM; </claim-text><claim-text> enforce a first response rule associated with the GVM when the source associated with the file open event is a non-approved source per a source control policy; and </claim-text><claim-text> enforce a second response rule associated with the GVM when the file violates a data loss prevention (DLP) policy. </claim-text></claim><claim id="clm-0012" num="12"><claim-text> 12. The computing apparatus of claim 11 , wherein the DLP manager is further configured to: </claim-text><claim-text> determine whether the source control policy exists to restrict access to the identified source to determine if the DLP policy requires monitoring of the source; and </claim-text><claim-text> monitor the source for file system events associated with the file to determine if the file violates the DLP policy. </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. The computing apparatus of claim 12, wherein the DLP manager is further configured to: </claim-text><claim-text> identify a file close event associated with the file open event; </claim-text><claim-text> analyze data associated with the file close event to determine if the data violates the DLP policy; and </claim-text><claim-text> execute the second response rule associated with the DLP policy if the data violates the DLP policy. </claim-text></claim><claim id="clm-0014" num="14"><claim-text> 14. The computing apparatus of claim 11 , wherein the DLP manager is further configured to retrieve a DLP profile associated with the GVM from a profile repository, the DLP profile comprising the source control policy, DLP policy and the response rule. </claim-text></claim><claim id="clm-0015" num="15"><claim-text> 15. The computing apparatus of claim 11, wherein the DLP manager is further configured to install a DLP user interface in the guest virtual machine configured to notify a user of DLP violations. 
</claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
