<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2959397-A1" country="EP" doc-number="2959397" kind="A1" date="20151230" family-id="51389694" file-reference-id="313465" date-produced="20180826" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160452572" ucid="EP-2959397-A1"><document-id><country>EP</country><doc-number>2959397</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-14753736-A" is-representative="NO"><document-id mxw-id="PAPP193868112" load-source="docdb" format="epo"><country>EP</country><doc-number>14753736</doc-number><kind>A</kind><date>20140225</date><lang>EN</lang></document-id><document-id mxw-id="PAPP193868113" load-source="patent-office" format="original"><country>EP</country><doc-number>14753736.9</doc-number><date>20140225</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162036586" ucid="US-201361768946-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201361768946</doc-number><kind>P</kind><date>20130225</date></document-id></priority-claim><priority-claim mxw-id="PPC162033955" ucid="US-2014018431-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>2014018431</doc-number><kind>W</kind><date>20140225</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1892460777" load-source="docdb">H04L  29/12        20060101AFI20160919BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1804352517" load-source="docdb" scheme="CPC">H04L  63/1458      20130101 LI20170607BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1804353044" load-source="docdb" scheme="CPC">H04L  61/2503      20130101 LI20170606BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1804355355" load-source="docdb" scheme="CPC">H04L  63/1416      20130101 LI20170606BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1804356806" load-source="docdb" scheme="CPC">H04L  63/0236      20130101 FI20170606BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1897317839" load-source="docdb" scheme="CPC">H04L  63/0218      20130101 LA20160915BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1897317840" load-source="docdb" scheme="CPC">H04L  61/2532      20130101 LA20160915BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987779673" load-source="docdb" scheme="CPC">H04L  61/2514      20130101 LI20150827BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987784625" load-source="docdb" scheme="CPC">H04L  61/2539      20130101 LI20150827BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987797081" load-source="docdb" scheme="CPC">H04L  61/2557      20130101 LI20150827BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165549182" lang="DE" load-source="patent-office">IP-REFLEXION</invention-title><invention-title mxw-id="PT165549183" lang="EN" load-source="patent-office">IP REFLECTION</invention-title><invention-title mxw-id="PT165549184" lang="FR" load-source="patent-office">RÉFLEXION IP</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR1103326619" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>F5 NETWORKS INC</last-name><address><country>US</country></address></addressbook></applicant><applicant mxw-id="PPAR1103322485" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>F5 NETWORKS, INC</last-name></addressbook></applicant><applicant mxw-id="PPAR1101641269" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>F5 Networks, Inc</last-name><iid>100755886</iid><address><street>401 Elliot Avenue West</street><city>Seattle, WA 98119</city><country>US</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103322264" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>LYON BARRETT GIBSON</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR1146515154" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>LYON, BARRETT GIBSON</last-name></addressbook></inventor><inventor mxw-id="PPAR1101646584" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>LYON, Barrett, Gibson</last-name><address><street>1301 Shoreway Road Suite 380</street><city>Belmont, CA 94002</city><country>US</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR1101646974" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Gervasi, Gemma</last-name><iid>100018865</iid><address><street>Notarbartolo &amp; Gervasi S.p.A. Corso di Porta Vittoria 9</street><city>20122 Milano</city><country>IT</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="US-2014018431-W"><document-id><country>US</country><doc-number>2014018431</doc-number><kind>W</kind><date>20140225</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2014131048-A1"><document-id><country>WO</country><doc-number>2014131048</doc-number><kind>A1</kind><date>20140828</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS660626127" load-source="docdb">AL</country><country mxw-id="DS660725861" load-source="docdb">AT</country><country mxw-id="DS660626129" load-source="docdb">BE</country><country mxw-id="DS660625026" load-source="docdb">BG</country><country mxw-id="DS660703674" load-source="docdb">CH</country><country mxw-id="DS660625372" load-source="docdb">CY</country><country mxw-id="DS660725862" load-source="docdb">CZ</country><country mxw-id="DS660788940" load-source="docdb">DE</country><country mxw-id="DS660625373" load-source="docdb">DK</country><country mxw-id="DS660625374" load-source="docdb">EE</country><country mxw-id="DS660710107" load-source="docdb">ES</country><country mxw-id="DS660625039" load-source="docdb">FI</country><country mxw-id="DS660625040" load-source="docdb">FR</country><country mxw-id="DS660626130" load-source="docdb">GB</country><country mxw-id="DS660626139" load-source="docdb">GR</country><country mxw-id="DS660626140" load-source="docdb">HR</country><country mxw-id="DS660725867" load-source="docdb">HU</country><country mxw-id="DS660703679" load-source="docdb">IE</country><country mxw-id="DS660626141" load-source="docdb">IS</country><country mxw-id="DS660625041" load-source="docdb">IT</country><country mxw-id="DS660625383" load-source="docdb">LI</country><country mxw-id="DS660788941" load-source="docdb">LT</country><country mxw-id="DS660725868" load-source="docdb">LU</country><country mxw-id="DS660788942" load-source="docdb">LV</country><country mxw-id="DS660788943" load-source="docdb">MC</country><country mxw-id="DS660703940" load-source="docdb">MK</country><country mxw-id="DS660703941" load-source="docdb">MT</country><country mxw-id="DS660710108" load-source="docdb">NL</country><country mxw-id="DS660725869" load-source="docdb">NO</country><country mxw-id="DS660710109" load-source="docdb">PL</country><country mxw-id="DS660625384" load-source="docdb">PT</country><country mxw-id="DS660710110" load-source="docdb">RO</country><country mxw-id="DS660625385" load-source="docdb">RS</country><country mxw-id="DS660710119" load-source="docdb">SE</country><country mxw-id="DS660625386" load-source="docdb">SI</country><country mxw-id="DS660703942" load-source="docdb">SK</country><country mxw-id="DS660703947" load-source="docdb">SM</country><country mxw-id="DS660703680" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA139071691" ref-ucid="WO-2014131048-A1" lang="EN" load-source="patent-office"><p num="0000">IP reflection comprising double static NAT (network address translation) is disclosed. In some embodiments, a packet having a public IP address is received at a protecting network. The public IP address of the packet is translated to a corrresponding protected IP address associated with a protected network, and the packet is forwarded to the protected network for servicing. The protected IP address of a response to the packet from the protected network is translated back to the public IP address at the protected network before sending.</p></abstract><abstract mxw-id="PA139539340" ref-ucid="WO-2014131048-A1" lang="EN" source="national office" load-source="docdb"><p>IP reflection comprising double static NAT (network address translation) is disclosed. In some embodiments, a packet having a public IP address is received at a protecting network. The public IP address of the packet is translated to a corrresponding protected IP address associated with a protected network, and the packet is forwarded to the protected network for servicing. The protected IP address of a response to the packet from the protected network is translated back to the public IP address at the protected network before sending.</p></abstract><abstract mxw-id="PA139071692" ref-ucid="WO-2014131048-A1" lang="FR" load-source="patent-office"><p num="0000">La présente invention concerne une réflexion IP comprenant une double NAT (traduction d'adresse réseau) statique. Dans certains modes de réalisation, un paquet possédant une adresse IP publique est reçu au niveau d'un réseau de protection. L'adresse IP publique du paquet est traduite en une adresse IP protégée correspondante associée à un réseau protégé, et le paquet est transmis au réseau protégé pour une mise en service. L'adresse IP protégée d'une réponse au paquet provenant du réseau protégé est traduite en retour en l'adresse IP publique au niveau du réseau protégé avant l'envoi.</p></abstract><abstract mxw-id="PA139539341" ref-ucid="WO-2014131048-A1" lang="FR" source="national office" load-source="docdb"><p>La présente invention concerne une réflexion IP comprenant une double NAT (traduction d'adresse réseau) statique. Dans certains modes de réalisation, un paquet possédant une adresse IP publique est reçu au niveau d'un réseau de protection. L'adresse IP publique du paquet est traduite en une adresse IP protégée correspondante associée à un réseau protégé, et le paquet est transmis au réseau protégé pour une mise en service. L'adresse IP protégée d'une réponse au paquet provenant du réseau protégé est traduite en retour en l'adresse IP publique au niveau du réseau protégé avant l'envoi.</p></abstract><description mxw-id="PDES78476181" ref-ucid="WO-2014131048-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="3"/>--><p id="p0001" num="0001"> IP REFLECTION </p><p id="p0002" num="0002"> CROSS REFERENCE TO OTHER APPLICATIONS </p><p id="p0003" num="0003">[0001] This application claims priority to U.S. Provisional Patent Application No.</p><p id="p0004" num="0004">61/768,946 entitled IP REFLECTION filed February 25, 2013 which is incorporated herein by reference for all purposes. </p><p id="p0005" num="0005">BACKGROUND OF THE INVENTION </p><p id="p0006" num="0006">[0002] DDoS (distributed denial of service) attacks remain a prevalent network security issue. Improved techniques for detecting and stopping such attacks are useful. </p><p id="p0007" num="0007">BRIEF DESCRIPTION OF THE DRAWINGS </p><p id="p0008" num="0008">[0003] Various embodiments of the invention are disclosed in the following detailed description and the accompanying drawings. </p><p id="p0009" num="0009">[0004] Figure 1 is a high level block diagram illustrating an embodiment of a network environment in which network traffic is scrubbed and filtered and appropriately routed via IP reflection. </p><p id="p0010" num="0010">[0005] Figure 2 comprises flow charts illustrating embodiments of processes for servicing a client request. </p><p id="p0011" num="0011">[0006] Figure 3 is a flow chart illustrating an embodiment of a process for handling an ingress packet. </p><p id="p0012" num="0012">[0007] Figures 4A and 4B are tables illustrating embodiments of client-to-server and server-to-client communications, respectively. </p><p id="p0013" num="0013">[0008] Figure 5 is a flow chart illustrating an embodiment of a process associated with a drop handler. </p><p id="p0014" num="0014">DETAILED DESCRIPTION </p><p id="p0015" num="0015">[0009] The invention can be implemented in numerous ways, including as a process; an apparatus; a system; a composition of matter; a computer program product embodied on a 
<!-- EPO <DP n="4"/>-->
 computer readable storage medium; and/or a processor, such as a processor configured to execute instructions stored on and/or provided by a memory coupled to the processor. In this specification, these implementations, or any other form that the invention may take, may be referred to as techniques. In general, the order of the steps of disclosed processes may be altered within the scope of the invention. Unless stated otherwise, a component such as a processor or a memory described as being configured to perform a task may be implemented as a general component that is temporarily configured to perform the task at a given time or a specific component that is manufactured to perform the task. As used herein, the term </p><p id="p0016" num="0016">'processor' refers to one or more devices, circuits, and/or processing cores configured to process data, such as computer program instructions. </p><p id="p0017" num="0017">[0010] A detailed description of one or more embodiments of the invention is provided below along with accompanying figures that illustrate the principles of the invention. The invention is described in connection with such embodiments, but the invention is not limited to any embodiment. The scope of the invention is limited only by the claims, and the invention encompasses numerous alternatives, modifications, and equivalents. Numerous specific details are set forth in the following description in order to provide a thorough understanding of the invention. These details are provided for the purpose of example, and the invention may be practiced according to the claims without some or all of these specific details. For the purpose of clarity, technical material that is known in the technical fields related to the invention has not been described in detail so that the invention is not unnecessarily obscured. </p><p id="p0018" num="0018">[0011] Techniques for scrubbing network traffic are disclosed in detail herein. In some cases, the described network traffic scrubbing service is facilitated by a third party provider on behalf of one or more customers (e.g., enterprises) that employ the third party provider to filter traffic such that malicious traffic is blocked or removed and only clean traffic is allowed. In some embodiments, the network traffic scrubbing service uses IP (Internet Protocol) reflection to appropriately route clean traffic. IP reflection comprises a new routing technology used to route traffic from one location to another without a backbone, tunnel, or direct network connection while at the same time not encapsulating it. This technology used in conjunction with anycast provides a clean routing platform for service based DDoS defense and solves many problems with existing DDoS defense services. 
<!-- EPO <DP n="5"/>-->
 [0012] Figure 1 is a high level block diagram illustrating an embodiment of a network environment in which network traffic is scrubbed and filtered and appropriately routed via IP reflection. Although not explicitly depicted, the various components comprising network environment 100 or parts thereof may communicate via a network such as the Internet. As depicted, ingress traffic from one or more clients 102 is received by protecting network 104, and only clean traffic is routed by protecting network 104 to protected network 106 for servicing. Egress traffic in response to clean ingress traffic is routed by protected network 106 directly to the requesting clients 102. Clean ingress traffic and corresponding egress traffic are appropriately routed using IP reflection. In the given example, IP reflection comprises double static NAT (network address translation). That is, protecting network 104 translates a public IP address of a clean packet into a corresponding private IP address to appropriately route the packet to protected network 106, and protected network 106 thereafter translates the private IP address of a response packet into the corresponding public IP address. Thus, the communications comprising a request from and a response to a legitimate client 102 appear uninterrupted to that client. </p><p id="p0019" num="0019">[0013] In some embodiments, an entity that subscribes to a traffic scrubbing service as described with respect to network environment 100 has a network (e.g., Internet) connection configured using BGP (Border Gateway Protocol) with the ability to announce a single network prefix of a /24 or larger. The third party traffic scrubbing service may provide the network addresses required for routing via IP reflection. In some embodiments, the services provided by the entity (e.g., www, mail, etc.) are announced via public prefixes which route to protecting network 104. Protecting network 104, for example, may comprise a non-backbone connected anycast cloud of one or more scrubbing centers associated with the third party traffic scrubbing service. Thus, when an entity is "on boarded" to protecting network 104, the /24 of the entity that is put under protection is announced to the peers and networks at each scrubbing center location comprising protecting network 104. </p><p id="p0020" num="0020">[0014] As depicted, all ingress traffic is first received by protecting network 104.</p><p id="p0021" num="0021">After ingress traffic has been scrubbed and deemed safe, the traffic is routed to an appropriate destination (e.g., a server or server farm) on protected network 106 of the entity using IP reflection. A public destination IP address accessible via protecting network 104 corresponds to a private (i.e., hidden or protected) destination IP address (or prefix of a /32 or larger) on protected network 106. The private prefix is used to return or respond to the traffic from the 
<!-- EPO <DP n="6"/>-->
 public prefix. The mapping relationship between the public and private IP addresses is used to appropriately forward packets from protecting network 104 to protected network 106. In some embodiments, a 1 : 1 ratio of prefixes that are active are employed. As an example, the entity may use 1.1.1.0/24 as its public prefix with services sitting on 1.1.1.1 and 1.1.1.2. In this case, two /32 prefixes also exist on the protected side to receive the 1.1.1.1 and 1.1.1.2 traffic. In this example, for instance, 1.1.1.1 may forward to 2.2.2.1 and 1.1.1.2 to 2.2.2.2. The private prefix does not need to be contiguous nor does it need to match the last octet in the public prefix, but in some embodiments it should be uniquely assigned to a single /32 and not be a part of the public prefix. </p><p id="p0022" num="0022">[0015] Protecting network 104 and protected network 106 further comprise IP reflection routers. Such IP reflection routers are configured to perform network address translations between corresponding public and private IP addresses. Specifically, an IP reflection router on the protecting network 104 side is configured to change the destination IP address of a packet from the public IP address to the appropriately mapped private IP address. For example, if the public prefix is 1.1.1.1/32 and the private prefix is 1.1.2.1/32, the destination IP address is re-written as 1.1.2.1/32, and the packet is forwarded back to the Internet for routing to protected network 106. This routing can be greatly accelerated by a private peering connection between the protecting 104 and protected 106 networks. In a similar manner, an IP reflection router on the protected network 106 side converts traffic from the private prefix back to the public prefix. An IP reflection router moreover rewrites the checksum of a header during network address translation. IP address mapping tables are distributed to and maintained by the IP reflection routers on protecting network 104 and protected network 106 and are the same on both sides. In some embodiments, a simple non- stateful mapping exists between a prescribed public IP address and a corresponding private IP address. In other embodiments, more complex IP address and port relationships are facilitated via dynamically updatable mapping tables. </p><p id="p0023" num="0023">[0016] Figure 2 comprises flow charts illustrating embodiments of processes for servicing a client request. For example, process 200 may be employed by one or more nodes of protecting network 104 while process 214 may be employed by one or more nodes of protected network 106. Process 200 starts at step 202 at which a packet is received, e.g., from a client 102. At step 204, the received packet is scrubbed, e.g., at a scrubbing site. At step 206, it is determined whether the received packet is clean. If it is determined at step 206 
<!-- EPO <DP n="7"/>-->
 that the received packed is not clean, appropriate action is taken at step 208, e.g., to prevent or at least mitigate a potential attack. For example, the packet may be dropped at step 208. If it is determined at step 206 that the received packed is clean, a public to private network address translation is performed at step 210 to translate the destination IP address. At step 212, the packet is rerouted. The packet rerouted at step 212 of process 200 is received at a destination corresponding to the translated network address at step 216 of process 214. At step 218, a response to the received packet is determined, e.g., by a server. A private to public network address translation is performed at step 220 to translate the source IP address of the response packet. At step 222, the response is sent to the client from which the request of step 202 is received. In some embodiments, the network address translations of step 210 of process 200 and step 220 of process 214 are performed by IP reflection routers. </p><p id="p0024" num="0024">[0017] Given that the communication flow through an IP reflection router is asynchronous, keeping state on traffic flow is a little more difficult than if it were </p><p id="p0025" num="0025">synchronous. Despite only half of the traffic of a communication flow passing through, a full state table may be deduced, for example, on the protecting network 104 side based on the ingress traffic. Such a state table may be used, for instance, to prevent or reduce basic DDoS attacks. Four types of connection flows exist: client-to-server, server-to-client, out-of-state, and mid-flow. Non-state related attacks happen in the out-of-state or mid-flow areas. Thus, extra care must be exercised when accepting these types of flows. Client-to-server flows are monitored in a variety of ways to ensure that connections are appropriately established and broken and to catch high bandwidth related flows and connection floods. </p><p id="p0026" num="0026">[0018] Figure 3 is a flow chart illustrating an embodiment of a process for handling an ingress packet. For example, process 300 may comprise corresponding steps of process 200 of Figure 2. In some embodiments, process 300 is employed by a scrubbing node of protecting network 104 of Figure 1. Process 300 starts at step 302 at which an ingress packet is received. At step 304, it is determined whether the destination IP address of the packet is serviced by the network. If not, the packet is sent to a drop handler configured to drop the packet at step 306. At step 308, it is determined whether the packet is from a blacklisted source. If so, the packet is sent to the drop handler at step 306. At step 310, it is determined whether the packet is from a source included in a drop list. If so, the packet is sent to the drop handler at step 306. At step 312, it is determined whether the packet is from a whitelisted source. If so, the packet is sent to a forward handler at step 314 that is configured 
<!-- EPO <DP n="8"/>-->
 to forward the packet to an appropriate node for servicing. At step 316, it is determined whether an ACL (access control list) is passed. If not, the packet is sent to the drop handler at step 306. At step 318, it is determined whether the packet is part of a current or new flow. If not, the packet is sent to the drop handler at step 306. At step 320, it is determined whether pending connections to the destination IP address/port are greater than a threshold. If so, the packet is sent to a flood handler at step 322. If not, the packet is sent to the forward handler at step 314. </p><p id="p0027" num="0027">[0019] Figures 4 A and 4B are tables illustrating embodiments of client-to-server and server-to-client communications, respectively. The given tables are rudimentary examples of how hints from the ingress traffic flow (e.g., client-to-server communications) may be used to create state without seeing the entire symmetrical flow of the traffic. Many other types of packets exist, but the general concept is to similarly use hints from the seen traffic to create (TCP) state tables. In some embodiments, packet dropping and forwarding involves counters. Seeing what each flow is doing helps to properly classify traffic as good or bad. </p><p id="p0028" num="0028">[0020] Figure 5 is a flow chart illustrating an embodiment of a process associated with a drop handler. Process 500 starts at 502 at which a packet to drop is received. At step 504, an associated counter is incremented. At step 506, it is determined whether the counter exceeds a threshold. If so, the source IP address is added to a drop list table at step 508. The received packet is dropped at step 510. Process 500 provides one example of populating a drop list. A drop list may be implemented in any other appropriate manner. For example, in some embodiments, a drop list table comprises a fast drop list of bad IP addresses that expire after a prescribed time duration (e.g., 300 seconds). In such cases, an associated (e.g., 300 second) counter is updated when an IP address is re-added to the drop list. </p><p id="p0029" num="0029">[0021] The drop and/or flood tables may need to be synchronized between locations.</p><p id="p0030" num="0030">In some embodiments, the ability to flush and/or update these tables, e.g., from stdin </p><p id="p0031" num="0031">(standard input), is provided. On detecting a large attack, for example, providing the ability to push known bad addresses into each scrubbing center is very helpful. In some </p><p id="p0032" num="0032">embodiments, a multicast style method to update these tables is provided. In some such cases, they are broadcasted to their local network, e.g., via UDP (User Datagram Protocol), so that each machine can keep these tables in sync at a local PoP (point of presence). Keeping them in sync locally helps the machines deal with traffic flows when load balancing of the traffic changes during an attack. 
<!-- EPO <DP n="9"/>-->
 [0022] In a network environment employing IP reflection, mapping configuration may be achieved in any appropriate manner. For example, in a flat file, the formatting may comprise: /usr/local/etc/reflection-mapping.conf Public Prefix -&gt; Private Prefix -&gt; Customer ID Examples of such a mapping format scheme include: 1.1.1.1/32 -&gt; 1.1.2.1/32 - &gt; BANK X and 8.8.8.0/24 -&gt; 9.9.9.0/24 -&gt; ENTITY X. In many cases, including a customer identifier is useful to prevent future confusion. For example, the customer identifier may be used to help resolve state table information (e.g., who is under attack, which traffic belongs to whom, etc.). Furthermore, a mapping table may be updated in any appropriate manner. Similar to pfctl, a mapping table may be refreshed without harming any existing connections. New updates may be added to the system. Conflicts result in the entire pre-existing conflict to receive a RST to reset each connection so they conform with the new configuration. </p><p id="p0033" num="0033">[0023] In a basic version of IP reflection, a simple table may be queried with a tool that can be displayed in an easy to read format such as: Customer ID : Mapping : Gauge 64 : PPS. The following is an example of such a format: BANK X : 1.1.1.1/32 -&gt; 1.1.2.1/32 : 1000000000000000000 : 250. As the state table becomes more complex, several different tables to query may exist including a drop table, a flood table, and/or a forward table (i.e., actual connection state table). Thus query tools are needed to inspect each table on its own and query against the table so that customer specific statistics and flow information may be built for a customer dashboard. This also helps in debugging attacks and seeing what traffic is doing globally on the network. </p><p id="p0034" num="0034">[0024] Although the foregoing embodiments have been described in some detail for purposes of clarity of understanding, the invention is not limited to the details provided. There are many alternative ways of implementing the invention. The disclosed embodiments are illustrative and not restrictive. 
</p></description><claims mxw-id="PCLM70076420" ref-ucid="WO-2014131048-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="10"/>--> CLAIMS </claim-statement><claim id="clm-0001" num="1"><claim-text>1. A method, comprising: </claim-text><claim-text> receiving a packet having a public IP address at a protecting network; </claim-text><claim-text> translating the public IP address of the packet to a corresponding protected IP address associated with a protected network; and </claim-text><claim-text> forwarding the packet to the protected network for servicing; </claim-text><claim-text> wherein the protected IP address of a response to the packet from the protected network is translated back to the public IP address at the protected network before sending. </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. The method of claim 1 , wherein the packet is received at a scrubbing node of the protecting network. </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. The method of claim 1, further comprising determining that the packet received at the protecting network comprises clean or legitimate traffic. </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. The method of claim 1 , wherein the protecting network is associated with a third party network traffic scrubbing service. </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. The method of claim 4, wherein the third party network traffic scrubbing service comprises a plurality of scrubbing nodes for filtering received traffic. </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. The method of claim 4, wherein the third party network traffic scrubbing service comprises a non-backbone connected anycast cloud of one or more scrubbing nodes for filtering received traffic. </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. The method of claim 4, wherein the third party network traffic scrubbing service forwards clean traffic to the protected network for servicing. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. The method of claim 1, wherein an IP reflection router of the protecting network is configured to translate the public IP address of the packet to the corresponding protected IP address. </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. The method of claim 1 , wherein an IP reflection router of the protected network is configured to translate the protected IP address of the response to the corresponding public IP address. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. The method of claim 1, wherein the protected network comprises an enterprise network. 
<!-- EPO <DP n="11"/>-->
</claim-text></claim><claim id="clm-0011" num="11"><claim-text>11. The method of claim 1 , wherein the public IP address and the corresponding protected IP address of the received packet comprise destination IP addresses. </claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. The method of claim 1, wherein the protected IP address and the corresponding public IP address of the response to the packet comprise source IP addresses. </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. The method of claim 1, wherein the protecting network is configured to receive ingress traffic of the protected network. </claim-text></claim><claim id="clm-0014" num="14"><claim-text>14. The method of claim 1, further comprising maintaining a mapping between the public IP address and the protected IP address at both the protecting network and the protected network. </claim-text></claim><claim id="clm-0015" num="15"><claim-text>15. The method of claim 14, wherein a non-stateful, one-to-one mapping exists between the public IP address and the protected IP address. </claim-text></claim><claim id="clm-0016" num="16"><claim-text>16. The method of claim 14, wherein a mapping between the public IP address and the protected IP address is facilitated via dynamically updated mapping tables. </claim-text></claim><claim id="clm-0017" num="17"><claim-text>17. The method of claim 1, further comprising determining a communication flow state table based on ingress traffic seen at the protecting network. </claim-text></claim><claim id="clm-0018" num="18"><claim-text>18. The method of claim 1 , wherein the protecting network provides defense against DDoS (distributed denial of service) attacks. </claim-text></claim><claim id="clm-0019" num="19"><claim-text>19. A system, comprising: </claim-text><claim-text> a processor of a node of a protected network configured to: </claim-text><claim-text> receive a packet having a public IP address; </claim-text><claim-text> translate the public IP address of the packet to a corresponding protected IP address associated with a protected network; and </claim-text><claim-text> forward the packet to the protected network for servicing; and a communication interface coupled to the processor and configured to forward the translated packet; </claim-text><claim-text> wherein the protected IP address of a response to the packet from the protected network is translated back to the public IP address at the protected network before sending. </claim-text></claim><claim id="clm-0020" num="20"><claim-text>20. A computer program product embodied in a non-transitory computer readable storage medium and comprising computer instructions for: 
<!-- EPO <DP n="12"/>-->
 receiving a packet having a public IP address at a protecting network; translating the public IP address of the packet to a corresponding protected IP address associated with a protected network; and </claim-text><claim-text> forwarding the packet to the protected network for servicing; </claim-text><claim-text> wherein the protected IP address of a response to the packet from the protected network is translated back to the public IP address at the protected network before sending. 
</claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
