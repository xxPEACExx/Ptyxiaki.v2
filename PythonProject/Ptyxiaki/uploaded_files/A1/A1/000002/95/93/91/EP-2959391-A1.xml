<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2959391-A1" country="EP" doc-number="2959391" kind="A1" date="20151230" family-id="50277311" file-reference-id="311201" date-produced="20180826" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160452578" ucid="EP-2959391-A1"><document-id><country>EP</country><doc-number>2959391</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-14710096-A" is-representative="NO"><document-id mxw-id="PAPP193868124" load-source="patent-office" format="original"><country>EP</country><doc-number>14710096.0</doc-number><date>20140218</date><lang>EN</lang></document-id><document-id mxw-id="PAPP193868125" load-source="docdb" format="epo"><country>EP</country><doc-number>14710096</doc-number><kind>A</kind><date>20140218</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162031044" ucid="US-201313769965-A" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201313769965</doc-number><kind>A</kind><date>20130219</date></document-id></priority-claim><priority-claim mxw-id="PPC162032038" ucid="US-2014016993-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>2014016993</doc-number><kind>W</kind><date>20140218</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1988526728" load-source="docdb">G06F  12/08        20060101AFI20140912BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1987764432" load-source="docdb" scheme="CPC">G06F  12/0891      20130101 FI20140821BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987766715" load-source="docdb" scheme="CPC">G06F  12/121       20130101 LI20140821BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987768350" load-source="docdb" scheme="CPC">G06F2212/7211      20130101 LA20151119BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987768430" load-source="docdb" scheme="CPC">G06F2212/1032      20130101 LA20151119BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987784855" load-source="docdb" scheme="CPC">G06F  12/0895      20130101 LI20151119BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165549200" lang="DE" load-source="patent-office">VERFAHREN UND VORRICHTUNG FÜR INTRA-SET-ABNUTZUNGSAUSGLEICH FÜR SPEICHER MIT BEGRENZTER SCHREIBAUSDAUER</invention-title><invention-title mxw-id="PT165549201" lang="EN" load-source="patent-office">METHODS AND APPARATUS FOR INTRA-SET WEAR-LEVELING FOR MEMORIES WITH LIMITED WRITE ENDURANCE</invention-title><invention-title mxw-id="PT165549202" lang="FR" load-source="patent-office">PROCÉDÉS ET APPAREIL POUR UNE RÉPARTITION L'USURE INTRAJEU POUR DES MÉMOIRES PRÉSENTANT UNE ENDURANCE D'ÉCRITURE LIMITÉE</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR1103312788" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>QUALCOMM INC</last-name><address><country>US</country></address></addressbook></applicant><applicant mxw-id="PPAR1103320235" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>QUALCOMM INCORPORATED</last-name></addressbook></applicant><applicant mxw-id="PPAR1101648370" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Qualcomm Incorporated</last-name><iid>101331406</iid><address><street>5775 Morehouse Drive</street><city>San Diego, CA 92121-1714</city><country>US</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103315154" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>DONG XIANGYU</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR1103318999" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>DONG, Xiangyu</last-name></addressbook></inventor><inventor mxw-id="PPAR1101640007" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>DONG, Xiangyu</last-name><address><street>5775 Morehouse Drive</street><city>San Diego, California 92121-1714</city><country>US</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR1101649818" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Skrba, Sinéad</last-name><suffix>et al</suffix><iid>101317890</iid><address><street>Tomkins &amp; Co. 5 Dartmouth Road</street><city>Dublin 6</city><country>IE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="US-2014016993-W"><document-id><country>US</country><doc-number>2014016993</doc-number><kind>W</kind><date>20140218</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2014130483-A1"><document-id><country>WO</country><doc-number>2014130483</doc-number><kind>A1</kind><date>20140828</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS660725961" load-source="docdb">AL</country><country mxw-id="DS660626211" load-source="docdb">AT</country><country mxw-id="DS660703984" load-source="docdb">BE</country><country mxw-id="DS660703745" load-source="docdb">BG</country><country mxw-id="DS660710197" load-source="docdb">CH</country><country mxw-id="DS660703985" load-source="docdb">CY</country><country mxw-id="DS660626212" load-source="docdb">CZ</country><country mxw-id="DS660725971" load-source="docdb">DE</country><country mxw-id="DS660703986" load-source="docdb">DK</country><country mxw-id="DS660703991" load-source="docdb">EE</country><country mxw-id="DS660788971" load-source="docdb">ES</country><country mxw-id="DS660703746" load-source="docdb">FI</country><country mxw-id="DS660710198" load-source="docdb">FR</country><country mxw-id="DS660725972" load-source="docdb">GB</country><country mxw-id="DS660703992" load-source="docdb">GR</country><country mxw-id="DS660725973" load-source="docdb">HR</country><country mxw-id="DS660626213" load-source="docdb">HU</country><country mxw-id="DS660710203" load-source="docdb">IE</country><country mxw-id="DS660703993" load-source="docdb">IS</country><country mxw-id="DS660703751" load-source="docdb">IT</country><country mxw-id="DS660703994" load-source="docdb">LI</country><country mxw-id="DS660703752" load-source="docdb">LT</country><country mxw-id="DS660625428" load-source="docdb">LU</country><country mxw-id="DS660703753" load-source="docdb">LV</country><country mxw-id="DS660703754" load-source="docdb">MC</country><country mxw-id="DS660625429" load-source="docdb">MK</country><country mxw-id="DS660625430" load-source="docdb">MT</country><country mxw-id="DS660703759" load-source="docdb">NL</country><country mxw-id="DS660710204" load-source="docdb">NO</country><country mxw-id="DS660703760" load-source="docdb">PL</country><country mxw-id="DS660788972" load-source="docdb">PT</country><country mxw-id="DS660725995" load-source="docdb">RO</country><country mxw-id="DS660788973" load-source="docdb">RS</country><country mxw-id="DS660703761" load-source="docdb">SE</country><country mxw-id="DS660625112" load-source="docdb">SI</country><country mxw-id="DS660710205" load-source="docdb">SK</country><country mxw-id="DS660710206" load-source="docdb">SM</country><country mxw-id="DS660704007" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA139073341" ref-ucid="WO-2014130483-A1" lang="EN" load-source="patent-office"><p num="0000">Efficient techniques are described for extending the usable lifetime for memories with limited write endurance. A technique for wear-leveling of caches addresses unbalanced write traffic on cache lines which cause heavily written cache lines to fail much fast than other lines in the cache. A counter is incremented for each write operation to a cache array. A line affected by a current write operation which caused the counter to meet a threshold is evicted from the cache rather than writing data to the affected line. A dynamic adjustment of the threshold can be made depending on the operating program. Updates to a current replacement policy pointer are stopped due to the counter meeting the threshold.</p></abstract><abstract mxw-id="PA139540990" ref-ucid="WO-2014130483-A1" lang="EN" source="national office" load-source="docdb"><p>Efficient techniques are described for extending the usable lifetime for memories with limited write endurance. A technique for wear-leveling of caches addresses unbalanced write traffic on cache lines which cause heavily written cache lines to fail much fast than other lines in the cache. A counter is incremented for each write operation to a cache array. A line affected by a current write operation which caused the counter to meet a threshold is evicted from the cache rather than writing data to the affected line. A dynamic adjustment of the threshold can be made depending on the operating program. Updates to a current replacement policy pointer are stopped due to the counter meeting the threshold.</p></abstract><abstract mxw-id="PA139073342" ref-ucid="WO-2014130483-A1" lang="FR" load-source="patent-office"><p num="0000">L'invention concerne des techniques efficaces destinées à allonger la durée de vie utile de mémoires présentant une endurance d'écriture limitée. Une technique de répartition de l'usure de trafic d'écriture déséquilibré d'adresses d'antémémoire sur des lignes d'antémémoire qui provoquent une défaillance des lignes d'antémémoire fortement écrites bien plus rapide que les autres lignes de l'antémémoire. Un compteur est incrémenté pour chaque opération d'écriture sur une matrice d'antémémoire. Une ligne affectée par une opération d'écriture actuelle qui a amené le compteur à atteindre un seuil est éliminée de l'antémémoire plutôt que d'écrire des données sur la ligne affectée. Un réglage dynamique du seuil peut être réalisé en fonction du programme d'exploitation. Des mises à jour sur un pointeur de politique de remplacement actuel prennent fin en raison du seuil atteint par le compteur.</p></abstract><abstract mxw-id="PA139540991" ref-ucid="WO-2014130483-A1" lang="FR" source="national office" load-source="docdb"><p>L'invention concerne des techniques efficaces destinées à allonger la durée de vie utile de mémoires présentant une endurance d'écriture limitée. Une technique de répartition de l'usure de trafic d'écriture déséquilibré d'adresses d'antémémoire sur des lignes d'antémémoire qui provoquent une défaillance des lignes d'antémémoire fortement écrites bien plus rapide que les autres lignes de l'antémémoire. Un compteur est incrémenté pour chaque opération d'écriture sur une matrice d'antémémoire. Une ligne affectée par une opération d'écriture actuelle qui a amené le compteur à atteindre un seuil est éliminée de l'antémémoire plutôt que d'écrire des données sur la ligne affectée. Un réglage dynamique du seuil peut être réalisé en fonction du programme d'exploitation. Des mises à jour sur un pointeur de politique de remplacement actuel prennent fin en raison du seuil atteint par le compteur.</p></abstract><description mxw-id="PDES78476914" ref-ucid="WO-2014130483-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="3"/>--><p id="p0001" num="0001"> METHODS AND APPARATUS FOR INTRA-SET WEAR-LEVELING FOR MEMORIES WITH LIMITED WRITE ENDURANCE </p><p id="p0002" num="0002">Field of the Disclosure </p><p id="p0003" num="0003"> [0001] The present disclosure relates generally to aspects of processing systems and in particular to methods and apparatus to extend the usable lifetime of memories with limited write endurance. </p><p id="p0004" num="0004">Background </p><p id="p0005" num="0005"> [0002] Many portable products, such as cell phones, laptop computers, personal data assistants (PDAs) and the like, utilize a processing system that executes programs, such as communication and multimedia programs. A processing system for such products may include multiple processors, complex memory systems including multi- levels of caches and memory for storing instructions and data, controllers, peripheral devices such as communication interfaces, and fixed function logic blocks configured, for example, on a single chip. At the same time, portable products have a limited energy source in the form of batteries that are often required to support high performance operations by the processing system and increasingly large memory capacities as functionality increases. To improve battery life, it is desirable to perform these operations as efficiently as possible. However, the scaling of common memory platforms, such as static random access memory (SRAM) and embedded dynamic random access memory (eDRAM), is increasingly constrained by leakage power and cell density. Such concerns extend to personal computer products which are also being developed with efficient designs to operate with reduced overall energy consumption. </p><p id="p0006" num="0006">[0003] A number of memory technologies, such as flash memory, magnetorestive random access memory (MRAM), phase change memory (PCM), resistive RAM 
<!-- EPO <DP n="4"/>-->
 (ReRAM), and others, have various limits on the number of write operations that can be performed to the device before memory cells begin to wear out and fail. Memories such as caches, which operate based on principles of spatial and temporal locality and at high data rates, show a wide variability in cache line accesses from program to program and may have cells that experience a very high rate of write accesses. For example, set associative caches which have a plurality of sets of data, each set divided in a plurality of selectable cache ways and each way in a set holding a cache line, experience different write access patterns within each set depending on the program in execution. Also, the write access variability from line to line in a set may be very large and may vary dynamically during system operations. </p><p id="p0007" num="0007"> [0004] For example, an 8-way set associative 64 kbyte cache may be constructed having 256 sets of eight 32-byte cache lines per set and access one cache line for each way. Such a cache may be used in a level 1 data cache in a portable device, such as a cell phone, tablet, lap top and the like. In the eight way set associative cache for a program X, write access to a line of data in way 2 may occur multiple orders of magnitude more often than write access to a line of data in a different cache way, such as way 7. Thus, the line of memory internal to the cache for way 2 may fail much earlier than the memory line in way 7 and most other lines in the cache having write access rates lower than the write access rates of way 2. The memory wear endurance affects each level of a memory hierarchy, such as level 1, 2, and 3 caches, flash memory, and system memory, though to different degrees in each level and each device. With processors running in the gigahertz (GHz) frequency, caches experience a large number of write accesses which may be to specific lines in the cache and thus such locality of accesses may cause a system to too rapidly approach the write limits of the cache memory. Since any cache line may experience high write operations depending 
<!-- EPO <DP n="5"/>-->
 on the program in execution and such a cache line hotspot is not known in advance, the cost for monitoring every cache line to determine which cache line in a cache set is affected and should be relocated to reduce wear may be prohibitive. </p><p id="p0008" num="0008">SUMMARY </p><p id="p0009" num="0009"> [0005] Among its several aspects, the present disclosure recognizes that providing more efficient methods and apparatuses for intra-set wear-leveling extends the usable lifetime of memories with limited write endurance. To such ends, an embodiment of the invention addresses a method for wear-leveling of a cache. A counter is incremented for each write operation to the cache. A line affected by a current write operation which caused the counter to meet a threshold is evicted from the cache. The current write to the line affected by the current write operation is stopped due to the counter meeting the threshold. </p><p id="p0010" num="0010"> [0006] Another embodiment addresses an apparatus for wear-leveling a cache. A cache having a plurality of ways is coupled to a processor complex which writes data to the cache. A write threshold circuit and a counter circuit are configured to count write operations to the cache and generate an indication when the counter circuit has reached a threshold based on a comparison in the write threshold circuit. A line flush circuit is configured to evict from the cache a line affected by the current write operation in response to the indication. A replacement policy circuit is configured to stop updates to change a current line replacement policy pointer in response to the indication. </p><p id="p0011" num="0011">[0007] Another embodiment addresses a computer readable non-transitory medium encoded with computer readable program data and code. A counter is incremented for each write operation to a cache. A line affected by a current write operation which caused the counter to meet a threshold is evicted from the cache. The current write to 
<!-- EPO <DP n="6"/>-->
 the line affected by the current write operation is stopped due to the counter meeting the threshold. </p><p id="p0012" num="0012"> [0008] A further embodiment addresses apparatus for wear- leveling a cache. Means is utilized for writing data to a cache having a plurality of ways coupled to a processor complex. Means is utilized for counting write operations to the cache and generating an indication when the counter has reached a threshold. Means is utilized for evicting from the cache a line affected by the current write operation in response to the indication. Means is utilized for stopping updates to change a current line replacement policy pointer in response to the indication. </p><p id="p0013" num="0013"> [0009] It is understood that other embodiments of the present invention will become readily apparent to those skilled in the art from the following detailed description, wherein various embodiments of the invention are shown and described by way of illustration. As will be realized, the invention is capable of other and different embodiments and its several details are capable of modification in various other respects, all without departing from the spirit and scope of the present invention. </p><p id="p0014" num="0014">Accordingly, the drawings and detailed description are to be regarded as illustrative in nature and not as restrictive. </p><p id="p0015" num="0015">BRIEF DESCRIPTION OF THE DRAWINGS </p><p id="p0016" num="0016">[0010] Various aspects of the present invention are illustrated by way of example, and not by way of limitation, in the accompanying drawings, wherein: </p><p id="p0017" num="0017">[0011] FIG. 1 illustrates an exemplary cache system in which an embodiment of the invention may be advantageously employed; </p><p id="p0018" num="0018"> [0012] FIG. 2 illustrates an advantageous process for wear-leveling; and 
<!-- EPO <DP n="7"/>-->
 [0013] FIG. 3 illustrates a particular embodiment of a portable device having a processor complex that is configured to extend wear endurance in the portable devices memory system. </p><p id="p0019" num="0019">DETAILED DESCRIPTION </p><p id="p0020" num="0020"> [0014] The detailed description set forth below in connection with the appended drawings is intended as a description of various exemplary embodiments of the present invention and is not intended to represent the only embodiments in which the present invention may be practiced. The detailed description includes specific details for the purpose of providing a thorough understanding of the present invention. However, it will be apparent to those skilled in the art that the present invention may be practiced without these specific details. In some instances, well known structures and </p><p id="p0021" num="0021">components are shown in block diagram form in order to avoid obscuring the concepts of the present invention. </p><p id="p0022" num="0022"> [0015] FIG. 1 illustrates an exemplary memory system 100 in which an embodiment of the invention may be advantageously employed. The memory system 100 includes a cache 102, for example a data cache, a next level cache 103, a system memory 105, and a processor complex 106. The system memory 105 provides access for instructions and data that are not found in the cache 102 or in the next level cache 103. It is noted that the cache 102 and the next level cache 103 may be integrated with processor complex 106. The system memory 105 may also be integrated with the processor complex 106 or separately coupled to the processor complex 106. The processor complex 106 may include one or more processors, such as a dual or a quad processor system. The cache 102 is illustrated as an N-way set associative cache that is representative of a level 1 data cache and in this case, the next level cache 103 would be a level 2 (L2) cache. It is 
<!-- EPO <DP n="8"/>-->
 noted that the wear- leveling techniques described herein are also applicable to an L2 cache and a level 3 (L3) cache depending on the type of memory used at each level of the memory hierarchy. The system memory 105 generally experiences a different form of wear- leveling than that experienced in caches. The cache 102 comprises a cache control circuit 108 having a cache write counter 110, a write threshold circuit 111, an address tag selector circuit 114, a line flush circuit 115, and a replacement policy circuit 116 for implementing wear-leveling in the cache 102. The cache 102 also comprises way 1 118i, way 2 118<sub>2</sub>, ..., way N 118N- Each way is configured with sets such as set i 120 comprising a tag 122 and line 123 in way 1 118i and each way 118<sub>2</sub> ... 118N is similarly configured. </p><p id="p0023" num="0023"> [0016] A technique for wear-leveling of caches addresses unbalanced write traffic on cache lines which cause heavily written cache lines to fail much fast than other lines in the cache. It is also noted that write traffic to blocks of memory in a bulk memory, such as system memory 105 having limited write endurance, may also be unbalanced and cause heavily written memory blocks to fail sooner than other memory blocks in the bulk memory. To address this problem of wear-leveling in caches with limited write endurance, means are provided to count write operations to the cache and generate an indication when a write threshold has been reached. For example, the cache write counter 110 is configured to increment a count for every cache write operation under control of the cache control circuit 108. Upon reaching or exceeding a write count threshold, also referred to as a line-flush threshold (FT), the cache line under the current write operation is evicted, for example by means to flush the line from the cache such as provided by the line flush circuit 115. Generally, a line is flushed from a cache when the line is indicated to be a least recently used (LRU) line and thus is available to be rewritten. In the case of reaching the FT, means are provided to stop an update to a 
<!-- EPO <DP n="9"/>-->
 cache line replacement operation for this current write operation. The cache write counter 110 is then reset to initialize the counter in preparation for the next cache write monitoring period. The evicted cache line is written to the next level cache and whenever that cache line is accessed again it is reloaded into a line in the cache based on the replacement policy which indicates a cache line different from the line it was evicted from. </p><p id="p0024" num="0024"> [0017] In particular, when a cache line is evicted from the lower level cache, that cache line is marked invalid indicating that the invalid line can be filled with new content. A cache line may be marked invalid by setting a valid bit to an invalid state in the tag associated with the cache line. A cache line that is evicted in standard operations is generally identified by the replacement policy, such as a least recently used (LRU) policy, to be available to be rewritten. After invalidation, it is possible for a cache line that is used frequently, to have the frequently used cache line be rewritten on a subsequent miss on the same cache line. To avoid this rewriting problem for evicted cache lines, when the cache write counter has reached or exceeded the count threshold, an update to a current line replacement policy pointer is blocked and the pointer is not updated. Since the replacement policy pointer is not updated, the current LRU pointer, for example, points to a different line than was evicted. Thus, the cache line that was evicted remains empty until that line really becomes least recently used. </p><p id="p0025" num="0025">[0018] For example in Fig. 1, with the cache 102 configured for a write operation, the processor complex 106 issues an address 130 to the cache 102. In response to the write operation an address tag 131 is generated and compared in tag compare circuit 124 to the tags in each way, such as tag 122 in way 1 118i- If a tag compare matches, the tag compare circuit 124 causes a cache line select circuit 125 to select a path to a way, such as associated with line 123 in way 1 118i and data 132 is written to the selected 
<!-- EPO <DP n="10"/>-->
 line 123. A dirty bit may also be written to the tag 122 indicating data in the line 123 has been modified. For each write operation, the cache write counter 110 is incremented. A write operation may be determined and the cache write counter incremented by a write signal internal to the cache control circuit 108 that is generated when data is to be written to a particular way and line in the cache. Alternatively, the cache control circuit 108 may use an internal command decode operation to set a bit or internal signal state that indicates whether the commanded operation will cause a write operation or a read operation. </p><p id="p0026" num="0026"> [0019] The count value from the cache write counter 110 is compared to a preset threshold, such as FT in the write threshold circuit 111. Upon reaching or exceeding the threshold, the line flush circuit 115 is notified and the cache line for the current write operation is flushed, rather than writing the data to the selected line. The evicted line, such as the line 123 in way 1 118i is written to the next level cache 103, such as an</p><p id="p0027" num="0027">L2 cache if the cache 102 is a level 1 data cache. In an alternative embodiment, the evicted line is written to an L3 cache if the cache 102 is an L2 cache and the processor complex 106 includes a level 1 data cache. The replacement policy circuit 116 is also notified and the replacement policy, such as least recently used (LRU) is not updated. At a later time when the evicted cache line 123 is rewritten to the cache 102, the cache control circuit 108 ensures that the evicted cache line 123 is written to a different location in set i 120, such as a line in one of the other ways, way 2 118<sub>2</sub> through way N</p><p id="p0028" num="0028">118<sub>N</sub>. </p><p id="p0029" num="0029"> [0020] The more frequently a program writes to a cache line, the more likely that cache line will be selected when the cache write counter saturates by reaching or exceeding a preset threshold value. Over an operating period, this wear-leveling 
<!-- EPO <DP n="11"/>-->
 technique is probabilistic, evicts hotspot cache lines, and relocates these lines to different cache locations providing a significant degree of wear-leveling across the cache array. Thus, by using a global counter of cache write accesses a significant degree of wear-leveling is achieved at a low cost without requiring a costly monitoring of each cache line. Also, by allowing the write count threshold to be settable, a dynamic adjustment of the threshold can be made depending on the operating program. A smaller write count threshold results in a higher frequency of line invalidations, thus the threshold can be dynamically tuned to provide a more balanced intra-set write distribution that is adaptable to a particular program or set of programs. For example, when a new program is executed that has an increased number of hotspots in a cache compared to a previous operating program, the write counter threshold for that cache is reduced to improve the odds of reducing write operations to the hotspots and thereby improve the wear endurance of that cache. </p><p id="p0030" num="0030"> [0021] In an alternative embodiment, rather than marking the evicted cache line invalid and blocking an update to the replacement policy due to the evicted line, an additional bit may be added to each cache line's tag which indicates this cache line is a probabilistic invalidated line and reuse of the evicted line should be delayed. A replacement policy, such as LRU, will select a different line for eviction if the selected LRU line has this bit set. The probabilistic invalidated line bit may be reset after a predetermined number of successful cache line write operations to that cache set or reset after a predetermined time period under control of a timer, for example. </p><p id="p0031" num="0031">[0022] The cache unit 102, as a stand-alone cache chip or fixed-integrated module, may receive controls 134 to load a threshold value to the write threshold circuit 111. The controls 134 may include a serial input path that is used to load the threshold value on initialization or at a time determined by a program operating on the processor 
<!-- EPO <DP n="12"/>-->
 complex 106. The threshold value could initially be a default threshold value hardcoded on the chip or fixed-integrated module. Then, the default threshold value as loaded in the write threshold circuit 111 may be adjusted according to the program in operation. In an alternative embodiment, monitors, such as a performance drop monitor or a wear effectiveness monitor are implemented in hardware external of the cache 102 or in software coded in a program that operates on the processor complex 106. The internal cache control circuit 108 then receives a signal from one or more such monitors that indicates a threshold value in the write threshold circuit 111 should be increased, decreased, or allowed to stay the same as previously set. </p><p id="p0032" num="0032"> [0023] FIG. 2 illustrates an advantageous process 200 for wear- leveling. At block 202, cache operations are monitored for a write operation. At decision block 204, a determination is made whether a cache write has been detected. A cache write operation may be determined, for example, in the cache control circuit 108 of FIG. 1. If no cache write operation has been identified, the process 200 returns to block 202. If a cache write operation has been identified, then the process 200 proceeds to block 206. At block 206, the cache write counter is incremented. At block 208, a determination is made whether the count value in the cache write counter is equal to or in an alternate embodiment has exceeded a preset threshold (FT). If it is determined that the count value is not equal to or has not exceeded the preset threshold FT, the process 200 returns to block 202. If the count value is equal to or has exceeded the preset threshold FT, the process 200 proceeds to block 210. At block 210, the cache write counter is reset, the line that would have been written to the monitored cache is instead written to the next level cache, the line in the monitored cache is invalidated, and a replacement policy update is blocked for this write. The process 200 returns to block 202. 
<!-- EPO <DP n="13"/>-->
 [0024] FIG. 3 illustrates a particular embodiment of a device 300 having a cache controller circuit 328 that is configured to extend the usable lifetime of the memories having limited wear endurance in the memory system of the device 300. The device 300 may be a wireless electronic portable device and include the processor complex 310 coupled to a system memory 312 having software instructions 318. The system memory 312 may include the system memory 105 of FIG. 1. The processor complex 310 may include a processor 311, an integrated memory subsystem 314 having a level 1 data cache (LI Dcache) 322, a level 1 instruction cache (LI Icache) 324, and the cache controller circuit 328. The processor complex 310 may include the processor complex 106 of FIG. 1. The integrated memory subsystem 314 may also include a level 2 (L2) unified cache 326. The LI Dcache 322 may include the cache 102 of FIG. 1 and the L2 unified cache 326 may include the next level cache 103 of FIG. 1, each of which may have limited wear endurance. </p><p id="p0033" num="0033"> [0025] The integrated memory subsystem 314 may be included in the processor complex 310 or may be implemented as one or more separate devices or circuitry (not shown) external to the processor complex 310. In an illustrative example, the processor complex 310 operates according to the software instructions 318 and in accordance with any of the embodiments illustrated in or associated with FIGS. 1 and 2. For example, as shown in FIG. 3, the LI Icache 326, the LI Dcache 322, and the cache controller circuit 328 are accessible within the processor complex 310, and the processor 311 is configured to access data or program instructions stored in the memories of the integrated memory subsystem 314 or in the system memory 312. </p><p id="p0034" num="0034">[0026] A camera interface 334 is coupled to the processor complex 310 and also coupled to a camera, such as a video camera 336. A display controller 340 is coupled to the processor complex 310 and to a display device 342. A coder/decoder (CODEC) 344 
<!-- EPO <DP n="14"/>-->
 may also be coupled to the processor complex 310. A speaker 346 and a microphone 348 may be coupled to the CODEC 344. A wireless interface 350 may be coupled to the processor complex 310 and to a wireless antenna 352 such that wireless data received via the antenna 352 and wireless interface 350 can be provided to the dual processor 311. </p><p id="p0035" num="0035"> [0027] The processor 311 may be configured to execute software instructions 318 accessed from the system memory 312 and stored in a non- transitory computer-readable medium that are executable to cause a computer, such as the processor 311 , to execute a program, such as the process 200 of FIG. 2. The software instructions 318 are further executable to cause the processor 311 to process instructions that read and write access the memories of the integrated memory subsystem 314 and the system memory 312. </p><p id="p0036" num="0036">[0028] In a particular embodiment, the processor complex 310, the display controller 340, the system memory 312, the CODEC 344, the wireless interface 350, and the camera interface 334 are included in a system-in-package or system-on-chip device 304. In a particular embodiment, an input device 356 and a power supply 358 are coupled to the system-on-chip device 304. Moreover, in a particular embodiment, as illustrated in FIG. 3, the display device 342, the input device 356, the speaker 346, the microphone 348, the wireless antenna 352, the video camera 336, and the power supply 358 are external to the system-on-chip device 304. However, each of the display device 342, the input device 356, the speaker 346, the microphone 348, the wireless antenna 352, the video camera 336, and the power supply 358 can be coupled to a component of the system-on-chip device 304, such as an associated interface or controller. </p><p id="p0037" num="0037"> [0029] The device 300 in accordance with embodiments described herein may be incorporated in a variety of electronic devices, such as a set top box, an entertainment 
<!-- EPO <DP n="15"/>-->
 unit, a navigation device, a communications device, a personal digital assistant (PDA), a fixed location data unit, a mobile location data unit, a mobile phone, a cellular phone, a computer, a portable computer, tablets, a monitor, a computer monitor, a television, a tuner, a radio, a satellite radio, a music player, a digital music player, a portable music player, a video player, a digital video player, a digital video disc (DVD) player, a portable digital video player, any other device that stores or retrieves data or computer instructions, or any combination thereof. </p><p id="p0038" num="0038"> [0030] The various illustrative logical blocks, modules, circuits, elements, or components described in connection with the embodiments disclosed herein may be implemented or performed with a general purpose processor, a digital signal processor (DSP), an application specific integrated circuit (ASIC), a field programmable gate array (FPGA) or other programmable logic components, discrete gate or transistor logic, discrete hardware components, or any combination thereof designed to perform the functions described herein. The processor 311 may be a general purpose processor, or in the alternative, the processor 311 may be a combination of a conventional processor, a digital signal processor, a microcontroller, or a state machine. The processor 311 may also be implemented as a combination of computing components, for example, a combination of a DSP and a microprocessor, a plurality of microprocessors, one or more microprocessors in conjunction with a DSP core, or any other such configuration appropriate for a desired application. </p><p id="p0039" num="0039"> [0031] The methods described in connection with the embodiments disclosed herein may be embodied directly in hardware, in a software module executed by a processor, or in a combination of the two. A software module may reside in RAM memory, flash memory, ROM memory, EPROM memory, EEPROM memory, registers, hard disk, a removable disk, a CD-ROM, or any other form of non-transitory storage medium 
<!-- EPO <DP n="16"/>-->
 known in the art. A non-transitory storage medium may be coupled to the processor such that the processor can read information from, and write information to, the non- transitory storage medium. In the alternative, the non-transitory storage medium may be integral to the processor. </p><p id="p0040" num="0040"> [0032] The processor complex 106 of FIG. 1 or the processor 311 of FIG. 3, for example, may be configured to execute instructions including instructions selected from a wear- leveling program stored on a computer readable non-transitory storage medium either directly associated locally with the processor 311, such as may be available through an instruction cache, or accessible through input device 356 or through the wireless interface 350. The input device 356 or the wireless interface 350 also may access data residing in a memory device either directly associated locally with the processor, such as the LI Icache 324, the LI Dcache 322, the L2 cache 326 or accessible from another processor's memory. The computer readable non-transitory storage medium may include random access memory (RAM), dynamic random access memory (DRAM), synchronous dynamic random access memory (SDRAM), flash memory, read only memory (ROM), programmable read only memory (PROM), erasable programmable read only memory (EPROM), electrically erasable </p><p id="p0041" num="0041">programmable read only memory (EEPROM), compact disk (CD), digital video disk (DVD), other types of removable disks, or any other suitable non-transitory storage medium. </p><p id="p0042" num="0042"> [0033] While the invention is disclosed in the context of illustrative embodiments for use in processor systems, it will be recognized that a wide variety of </p><p id="p0043" num="0043">implementations may be employed by persons of ordinary skill in the art consistent with the above discussion and the claims which follow below. For example, a fixed function implementation may also utilize various embodiments of the present invention. 
</p></description><claims mxw-id="PCLM70077176" ref-ucid="WO-2014130483-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="17"/>--> CLAIMS  WHAT IS CLAIMED IS: </claim-statement><claim id="clm-0001" num="1"><claim-text> 1. A method for wear-leveling of a cache, the method comprising: </claim-text><claim-text> incrementing a counter for each write operation to the cache; </claim-text><claim-text> evicting from the cache a line affected by a current write operation which caused the counter to meet a threshold; and </claim-text><claim-text> stopping the current write to the line affected by the current write operation due to the counter meeting the threshold. </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. The method of claim 1 further comprising: </claim-text><claim-text> stopping updates to a current replacement policy pointer due to the counter meeting the threshold. </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. The method of claim 1, wherein the threshold is a program settable value that is compared to the count value output of the counter which provides an indication when the count value matches the threshold. </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. The method of claim 1 , wherein the line when next accessed is written to a cache line that is different from the cache line it was previously evicted from. 
<!-- EPO <DP n="18"/>-->
</claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. The method of claim 1, wherein the evicted line is selected from a way of an addressed set of ways in the cache and the line when next accessed is written to a different line in the addressed set of ways. </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. The method of claim 1 further comprising: </claim-text><claim-text> reseting the counter to initialize the counter in preparation for a succeeding cache write monitoring period. </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. The method of claim 1 further comprising: </claim-text><claim-text> writing the evicted line to the next level cache, wherein the cache is a level 1 cache and the next level cache is a level 2 cache. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. The method of claim 1 further comprising: </claim-text><claim-text> writing the evicted line to the next level cache, wherein the cache is a level 2 cache and the next level cache is a level 3 cache. </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. The method of claim 1 further comprising: </claim-text><claim-text> marking the line affected by the current write operation which caused the counter to meet the threshold invalid, wherein the invalid mark causes the line to be evicted from the cache. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. An apparatus for wear-leveling a cache, the apparatus comprising: </claim-text><claim-text> a cache having a plurality of ways coupled to a processor complex which controls write operations to write data to the cache; 
<!-- EPO <DP n="19"/>-->
 a write threshold circuit and a counter circuit configured to count the write operations to the cache and to generate an indication when the counter circuit has reached a threshold based on a comparison of a count output of the counter circuit with a threshold value; </claim-text><claim-text> a line flush circuit configured to evict from the cache a line affected by the current write operation in response to the indication; and </claim-text><claim-text> a replacement policy circuit is configured to stop updates to change a current line replacement policy pointer in response to the indication. </claim-text></claim><claim id="clm-0011" num="11"><claim-text>11. The apparatus of claim 10, wherein the threshold value is a program settable value that is compared to the count value output of the counter which provides the indication when the count value matches the threshold. </claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. The apparatus of claim 10, wherein the threshold value is a default value that is stored in the write threshold circuit and adjusted according to a program in operation. </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. The apparatus of claim 10, wherein the line when next accessed is written to a cache line that is different from the cache line it was previously evicted from. </claim-text></claim><claim id="clm-0014" num="14"><claim-text>14. The apparatus of claim 10, wherein the evicted line is selected from a way of an addressed set of ways in the cache and the line when next accessed is written to a different line in the addressed set of ways. </claim-text></claim><claim id="clm-0015" num="15"><claim-text>15. The apparatus of claim 10, wherein the counter circuit is reset to initialize the counter in preparation for a succeeding cache write monitoring period. 
<!-- EPO <DP n="20"/>-->
</claim-text></claim><claim id="clm-0016" num="16"><claim-text>16. The apparatus of claim 10 further comprising: </claim-text><claim-text> a level 1 cache configured as the cache; and </claim-text><claim-text> a level 2 cache configured as a next level cache, wherein the evicted line is written to the level 2 cache. </claim-text></claim><claim id="clm-0017" num="17"><claim-text>17. The apparatus of claim 10 further comprising: </claim-text><claim-text> a level 2 cache configured as the cache; and </claim-text><claim-text> a level 3 cache configured as a next level cache, wherein the evicted line is written to the level 3 cache. </claim-text></claim><claim id="clm-0018" num="18"><claim-text>18. The apparatus of claim 10, wherein an invalidated line bit is included in each cache line's tag to indicate this cache line is a probabilistic invalidated line and reuse of the evicted line should be delayed </claim-text></claim><claim id="clm-0019" num="19"><claim-text>19. A computer readable non-transitory medium encoded with computer readable program data and code, the program data and code when executed operable to: </claim-text><claim-text> increment a counter for each write operation to a cache; </claim-text><claim-text> evict from the cache a line affected by a current write operation which caused the counter to meet a threshold; and </claim-text><claim-text> stop the current write to the line affected by the current write operation due to the counter meeting the threshold. </claim-text></claim><claim id="clm-0020" num="20"><claim-text>20. An apparatus for wear-leveling a cache, the apparatus comprising: 
<!-- EPO <DP n="21"/>-->
 means for writing data to a cache having a plurality of ways coupled to a processor complex; </claim-text><claim-text> means for counting write operations to the cache and generating an indication when the counter has reached a threshold; </claim-text><claim-text> means for evicting from the cache a line affected by the current write operation in response to the indication; and </claim-text><claim-text> means for stopping updates to change a current line replacement policy pointer in response to the indication. 
</claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
