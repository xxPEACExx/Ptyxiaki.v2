<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2959650-A1" country="EP" doc-number="2959650" kind="A1" date="20151230" family-id="51390394" file-reference-id="259719" date-produced="20180826" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160452526" ucid="EP-2959650-A1"><document-id><country>EP</country><doc-number>2959650</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-14754917-A" is-representative="NO"><document-id mxw-id="PAPP193868020" load-source="patent-office" format="original"><country>EP</country><doc-number>14754917.4</doc-number><date>20140219</date><lang>EN</lang></document-id><document-id mxw-id="PAPP193868021" load-source="docdb" format="epo"><country>EP</country><doc-number>14754917</doc-number><kind>A</kind><date>20140219</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162029659" ucid="AU-2013900552-A" load-source="docdb"><document-id format="epo"><country>AU</country><doc-number>2013900552</doc-number><kind>A</kind><date>20130219</date></document-id></priority-claim><priority-claim mxw-id="PPC162031391" ucid="AU-2014000139-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>AU</country><doc-number>2014000139</doc-number><kind>W</kind><date>20140219</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1865060821" load-source="docdb">H04L  27/00        20060101ALI20161213BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1865060822" load-source="docdb">H04L  25/00        20060101AFI20161213BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1865060823" load-source="docdb">H04L   7/00        20060101ALI20161213BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1865060824" load-source="docdb">H04J   3/00        20060101ALI20161213BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1839973600" load-source="docdb" scheme="CPC">H04L  27/2679      20130101 LI20170308BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1839973601" load-source="docdb" scheme="CPC">H04L  27/2675      20130101 LI20170308BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1839973602" load-source="docdb" scheme="CPC">H04L  27/2671      20130101 LI20170308BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1839973603" load-source="docdb" scheme="CPC">H04L  27/2663      20130101 LI20170308BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1839973604" load-source="docdb" scheme="CPC">H04L  27/18        20130101 LA20170306BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1839973605" load-source="docdb" scheme="CPC">H04L  27/00        20130101 LA20170306BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1839973606" load-source="docdb" scheme="CPC">H04L   5/0023      20130101 LA20170306BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1839973607" load-source="docdb" scheme="CPC">H04L   1/0054      20130101 LA20170306BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984696646" load-source="docdb" scheme="CPC">H04L   7/0087      20130101 FI20160107BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984698977" load-source="docdb" scheme="CPC">H04L  27/2278      20130101 LI20160107BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984703588" load-source="docdb" scheme="CPC">H04L   7/042       20130101 LI20160107BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165549044" lang="DE" load-source="patent-office">SYNCHRONISATION MIT PILOTSIGNALEN UND -DATEN</invention-title><invention-title mxw-id="PT165549045" lang="EN" load-source="patent-office">SYNCHRONISATION USING PILOTS AND DATA</invention-title><invention-title mxw-id="PT165549046" lang="FR" load-source="patent-office">SYNCHRONISATION À L'AIDE DE PILOTES ET DE DONNÉES</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR1103344372" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>UNIV SOUTH AUSTRALIA</last-name><address><country>AU</country></address></addressbook></applicant><applicant mxw-id="PPAR1103331455" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>UNIVERSITY OF SOUTH AUSTRALIA</last-name></addressbook></applicant><applicant mxw-id="PPAR1101644526" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>University Of South Australia</last-name><iid>101033693</iid><address><street>North Terrace</street><city>Adelaide, SA 5000</city><country>AU</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103325753" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>COWLEY WILLIAM GEORGE</last-name><address><country>AU</country></address></addressbook></inventor><inventor mxw-id="PPAR1103331548" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>COWLEY, William George</last-name></addressbook></inventor><inventor mxw-id="PPAR1101644084" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>COWLEY, William George</last-name><address><street>c/- University of South Australia North Terrace</street><city>Adelaide South Australia 5000</city><country>AU</country></address></addressbook></inventor><inventor mxw-id="PPAR1103324318" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>MCKILLIAM ROBERT GEORGE</last-name><address><country>AU</country></address></addressbook></inventor><inventor mxw-id="PPAR1103306056" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>McKILLIAM, Robert George</last-name></addressbook></inventor><inventor mxw-id="PPAR1101645377" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>McKILLIAM, Robert George</last-name><address><street>c/- University of South Australia North Terrace</street><city>Adelaide South Australia 5000</city><country>AU</country></address></addressbook></inventor><inventor mxw-id="PPAR1103340908" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>POLLOK ANDRE</last-name><address><country>AU</country></address></addressbook></inventor><inventor mxw-id="PPAR1103344809" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>POLLOK, Andre</last-name></addressbook></inventor><inventor mxw-id="PPAR1101651756" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>POLLOK, Andre</last-name><address><street>c/- University of South Australia North Terrace</street><city>Adelaide South Australia 5000</city><country>AU</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR1101639781" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Finnie, Peter John</last-name><iid>100038361</iid><address><street>Gill Jennings &amp; Every LLP The Broadgate Tower 20 Primrose Street</street><city>London EC2A 2ES</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="AU-2014000139-W"><document-id><country>AU</country><doc-number>2014000139</doc-number><kind>W</kind><date>20140219</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2014127407-A1"><document-id><country>WO</country><doc-number>2014127407</doc-number><kind>A1</kind><date>20140828</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS660788712" load-source="docdb">AL</country><country mxw-id="DS660703148" load-source="docdb">AT</country><country mxw-id="DS660788714" load-source="docdb">BE</country><country mxw-id="DS660624665" load-source="docdb">BG</country><country mxw-id="DS660625426" load-source="docdb">CH</country><country mxw-id="DS660709414" load-source="docdb">CY</country><country mxw-id="DS660703149" load-source="docdb">CZ</country><country mxw-id="DS660623986" load-source="docdb">DE</country><country mxw-id="DS660709419" load-source="docdb">DK</country><country mxw-id="DS660709420" load-source="docdb">EE</country><country mxw-id="DS660703215" load-source="docdb">ES</country><country mxw-id="DS660624666" load-source="docdb">FI</country><country mxw-id="DS660624679" load-source="docdb">FR</country><country mxw-id="DS660788715" load-source="docdb">GB</country><country mxw-id="DS660709421" load-source="docdb">GR</country><country mxw-id="DS660788716" load-source="docdb">HR</country><country mxw-id="DS660703150" load-source="docdb">HU</country><country mxw-id="DS660625435" load-source="docdb">IE</country><country mxw-id="DS660788717" load-source="docdb">IS</country><country mxw-id="DS660624680" load-source="docdb">IT</country><country mxw-id="DS660709422" load-source="docdb">LI</country><country mxw-id="DS660623999" load-source="docdb">LT</country><country mxw-id="DS660703155" load-source="docdb">LU</country><country mxw-id="DS660624000" load-source="docdb">LV</country><country mxw-id="DS660624001" load-source="docdb">MC</country><country mxw-id="DS660724873" load-source="docdb">MK</country><country mxw-id="DS660724874" load-source="docdb">MT</country><country mxw-id="DS660624681" load-source="docdb">NL</country><country mxw-id="DS660703216" load-source="docdb">NO</country><country mxw-id="DS660624682" load-source="docdb">PL</country><country mxw-id="DS660724887" load-source="docdb">PT</country><country mxw-id="DS660624691" load-source="docdb">RO</country><country mxw-id="DS660724888" load-source="docdb">RS</country><country mxw-id="DS660624692" load-source="docdb">SE</country><country mxw-id="DS660724889" load-source="docdb">SI</country><country mxw-id="DS660625436" load-source="docdb">SK</country><country mxw-id="DS660625437" load-source="docdb">SM</country><country mxw-id="DS660624007" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA139081633" ref-ucid="WO-2014127407-A1" lang="EN" load-source="patent-office"><p num="0000">A method for estimating a time offset of a transmitted signal which comprises pilot symbols and data symbols, the method comprising: receiving the transmitted signal to produce a received signal; and processing an optimising function of the received signal at a finite number of possible time offsets to produce an estimator of the time offset.</p></abstract><abstract mxw-id="PA139547960" ref-ucid="WO-2014127407-A1" lang="EN" source="national office" load-source="docdb"><p>A method for estimating a time offset of a transmitted signal which comprises pilot symbols and data symbols, the method comprising: receiving the transmitted signal to produce a received signal; and processing an optimising function of the received signal at a finite number of possible time offsets to produce an estimator of the time offset.</p></abstract><abstract mxw-id="PA139081634" ref-ucid="WO-2014127407-A1" lang="FR" load-source="patent-office"><p num="0000">L'invention concerne un procédé d'estimation d'un décalage temporel d'un signal transmis, qui comprend des symboles de pilotes et des symboles de données. Le procédé comprend les étapes suivantes : la réception du signal transmis pour produire un signal reçu ; et le traitement d'une fonction d'optimisation du signal reçu à un nombre fini de décalages temporels possibles, afin de produire un estimateur du décalage temporel.</p></abstract><abstract mxw-id="PA139547961" ref-ucid="WO-2014127407-A1" lang="FR" source="national office" load-source="docdb"><p>L'invention concerne un procédé d'estimation d'un décalage temporel d'un signal transmis, qui comprend des symboles de pilotes et des symboles de données. Le procédé comprend les étapes suivantes : la réception du signal transmis pour produire un signal reçu ; et le traitement d'une fonction d'optimisation du signal reçu à un nombre fini de décalages temporels possibles, afin de produire un estimateur du décalage temporel.</p></abstract><description mxw-id="PDES78478695" ref-ucid="WO-2014127407-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="2"/>--><p id="p0001" num="0001"> SYNCHRONISATION USING PILOTS AND DATA PRIORITY DOCUMENT </p><p id="p0002" num="0002">[00011 The present application claims priority from: </p><p id="p0003" num="0003"> Australian Provisional Patent Application No. 2013900552 titled "Synchronisation using pilots and data" and filed on 19 February 20 3. </p><p id="p0004" num="0004"> The content of this application is hereby incorporated by reference in its entirety. INCORPORATION BY REFERENCE </p><p id="p0005" num="0005">[0002] The following patent application is referred to in the following description: </p><p id="p0006" num="0006">[0003] PCT/AU2013/001464 entitled "Carrier phase and amplitude estimatio for phase shift keying using pilots and data" filed on 13 December 2013, claiming priority from Australian Provisional Patent Application No. 2012905489. </p><p id="p0007" num="0007">[0004] The content of this application is hereby incorporated by reference in its entirety. TECHNICAL FIELD </p><p id="p0008" num="0008">[0005] The present inventio relates to communication systems. In particular, the present invention relates to estimation of time offset of a received signal in a communication system. </p><p id="p0009" num="0009">BACKGROUND </p><p id="p0010" num="0010">[0006] In passband communication systems, a transmitted signal typically undergoes time offset (delay), phase shift, and attenuation (amplitude change). These effects must he compensated for at the receiver. </p><p id="p0011" num="0011">[0007| Estimation of time offset is critical for good receiver performance. The ability to improve the estimation accuracy for this time offset can be translated into a number of valuable benefits, including increased receiver sensitivity, increased power efficiency, a reduction in the amount of overhead required for pi lot/traini g sequences. </p><p id="p0012" num="0012">[0008 J A transmitted signal contains pilot symbols and data symbols. Signalling constellations that have symbols on the complex unit circle such as binary phase shift keying (BPS ), quaternary phase 
<!-- EPO <DP n="3"/>-->
 shift keying (QPSK) and M -ary phase shift keying ( M -PSK) are often used* but more generally, quadrature amplitude modulated (QAM) constellations can also be used. </p><p id="p0013" num="0013">[0009] The problem of estimating time offset has undergone considerable prior research. Traditional approaches involve analogue phase-lock-loops and digital implementations motivated by phase-lock- loops. These approaches focus on estimating t<sub>0</sub> modulo the symbol period T , that is, if </p><p id="p0014" num="0014">r„ = <sub>0</sub> + i<sub>{]</sub> T where i<sub>n</sub> e Z and γ<sub>η</sub> e [—772 , 772) , then an estimator of y<sub>n</sub> is given. This estimate may be used to drive a sampling device applied to the received signal (usually after matched filtering) Some other method must then be used to align the samples, i.e., to estimate ¾ . The problem of estimating γ<sub>0</sub> is usually called symbol synchronisation, while the second problem of estimating ¾ is usually called frame synchronisation. </p><p id="p0015" num="0015">[0010] More recently iterative methods attempting to exploit the error correcting code used by the transmitter have appeared. These estimators typically apply the expectation maximisation (EM) algorithm under a Gaussian assumption regarding the noise w(f) . A ke problem is that the EM algorithm converges correctly only if initialised at some T sufficiently close to r<sub>0</sub> . Methods for efficiently obtaining a ΐ close to T<sub>0</sub> are still required. </p><p id="p0016" num="0016">SUMMARY </p><p id="p0017" num="0017">[0011] According to a first aspect of the present invention, there is provided a method for estimating a time offset of a transmitted signal which comprises pilot symbols and data symbols, the method comprising: receiving the transmitted signal to produce a received signal; and processing an optimising function of the received signal at a finite number of possible time offsets to produce an estimator of the time offset. </p><p id="p0018" num="0018">[0012] In one form, the optimising functio comprises a function of the received signal with a finite number of possible pilots. </p><p id="p0019" num="0019">[0013] In one form, the optimising function comprises a functio of the received signal with a finite number of possible data symbols. </p><p id="p0020" num="0020">[0014] In one form, the optimising function comprises a mathematical function, or equivalent, of SS(x) = Ζ(τ) + Υ(τ) where Z is a function of the received signal, the time offset and positions of a 
<!-- EPO <DP n="4"/>-->
 finite number of data symbols, and Y is a function of the received signal, the time offset and positions of a finite number of possible pilot symbols. </p><p id="p0021" num="0021">[0015] In one form, the optimising function is processed at the finite number of possible time offsets T. . Γ, .— 1 <sup>'</sup> <sub>K</sub> for some positive integer K where T<sub>M</sub>— T<sub>l</sub> = A , and Δ = Tic where T is the symbol period of the pilot symbols and data symbols, and C is a positive integer. </p><p id="p0022" num="0022">[0016] In one form, the data symbols are complex numbers. </p><p id="p0023" num="0023">[0017] In one form, the data symbols are from the complex unit circle. </p><p id="p0024" num="0024">[0018] In one form, the data symbols are from a -PS constellation. </p><p id="p0025" num="0025">[0019] In one form, the step of processing an optimising function comprises: computing b<sub>k</sub> for all k = 1 + cmin(Pu D)... ,, K+ cmax(Pu D) , where Pis set of indices describing positions of the pilots symbols, D is set of indices describing positions of the data symbols, K and C are positive integers; computing Z<sub>k</sub> = Z( T<sub>k</sub> ) , based on b<sub>k</sub> , for all k = 1 , . .. , K , where T<sub>k</sub> is an possible time offset; computing Y<sub>k</sub> = Y(T<sub>k</sub> ) , based on b<sub>k</sub> , for all k = l ,..., K , Y(T<sub>k</sub>) being a different function from Z(T<sub>k</sub> ) ; computing k e { 1 , ... , K} that maximises Z<sub>k</sub> + Y<sub>k</sub> ; computing an approximate time offset estimate, f , based on k that maximises Z<sub>t</sub> + Y<sub>t</sub> ; and applying a numerical optimisation procedure initialized with 7 to produce the estimator of the time offset. </p><p id="p0026" num="0026">[0020] In one form, the step of computing an approximate time offset estimate comprises: computing —T<sub>]</sub> + Δ(1 - 1 ) = <sub>mm</sub> + A(k - 1 ), where k is the k that maximises Z<sub>t</sub> + Y<sub>k</sub>,A = Tc where T is the symbol period of the pilot symbols and data symbols, and C is a positive integer. </p><p id="p0027" num="0027">[0021] According to second aspect of the present invention, there is provided a computer program product configurable to perform the method of the first aspect, and/or its various forms. </p><p id="p0028" num="0028">[0022] According to third aspect of the present invention, there is provided a receiver configurable to perform the method of the first aspect, and/or its various forms. </p><p id="p0029" num="0029">[0023] According to fourth aspect of the present invention, there is provided a communication system, comprising: a transmitter for transmitting a transmitted signal which comprises pilot symbols 
<!-- EPO <DP n="5"/>-->
 and data symbols; and a receiver configurable to perform the method of the first aspect, and/or its various forms. </p><p id="p0030" num="0030"> BRIEF DESCRIPTION OF DRAWINGS </p><p id="p0031" num="0031"> [00241 A preferred embodiment of the present invention will be discussed with reference to the accompanying drawings wherein: </p><p id="p0032" num="0032"> [0025| Figure 1 depicts a block diagram illustrating one embodiment of the present invention; </p><p id="p0033" num="0033"> [0026] Figure 2 depicts one embodiment of the function SS(x) of figure 1 ; </p><p id="p0034" num="0034"> [0027] Figure 3 summarises steps involved in performing the present invention; </p><p id="p0035" num="0035"> [0028] Figure 4 depicts steps which present the novel time offset estimation algorithm of one embodiment of the present invention ; </p><p id="p0036" num="0036"> [0029] Figure 5 depicts Mean Square Error (MSE) versus Signal to Noise Ratio (SNR) with \B = 5 and root-raised cosine (RRC) pulse with roil-off ; </p><p id="p0037" num="0037"> [0030] Figure 6 depicts Mean Square Error (MSE) versus Signal to Noise Ratio (SNR) with \ = 10 and root-raised cosine (RRC) pulse with roll-off y ; </p><p id="p0038" num="0038"> [0031] Figure 7 depicts Mean Square Error (MSE) versus Signal to Noise Ratio (SNR) with \ f = 20 and root-raised cosine (RRC) pulse with roll-off - ; </p><p id="p0039" num="0039"> [0032] Figure 8 depicts Mean Square Error (MSE) versus Signal to Noise Ratio (SNR) with \ = 100 and root-raised cosine (RRC) pulse with roll-off ; </p><p id="p0040" num="0040"> [0033] Figure 9 depicts Mean Square Error (MSE) versus Signal to Noise Ratio (SNR) with = 5 and root-raised cosine (RRC) pulse with roll-off ; </p><p id="p0041" num="0041"> [0034] Figure 10 depicts Mean Square Error (MSE) versus Signal to Noise Ratio (SNR) with \P = 10 and root-raised cosine (RRC) pulse with roll-off -^- ; 
<!-- EPO <DP n="6"/>-->
 [0035] Figure 1 1 depicts Mean Square Error (MSE) versus Signal to Noise Ratio (SNR) with \P\ = 20 and root-raised cosine (RRC) pulse with roll-off ; and </p><p id="p0042" num="0042">[0036} Figure 12 depicts Mean Square Error (MSE) versus Signal to Noise Ratio (SNR) with \F[ = 100 and root-raised cosine (RRC) pulse with roll-off . </p><p id="p0043" num="0043">[0037] In the following description, like reference characters designate like or corresponding parts throughout the figures. </p><p id="p0044" num="0044">DESCRIPTION OF EMBODIMENTS </p><p id="p0045" num="0045">A. Overview </p><p id="p0046" num="0046">[0038J The present invention relates to estimating the time offset of a transmitted signal, and the description of the present invention treats the phase shift and attenuation of a transmitted signal as nuisance parameters. However, the present invention can be readily applied to any system or receiver which also considers phase shift and attenuation of a transmitted signal together with the time offset. </p><p id="p0047" num="0047">[0039] A transmitted signal may take the (complex baseband) form where g( f) is the transmit pulse, 7 is the symbol period, s<sub>t</sub> e C is the i th symbol, and C is the set of complex numbers. Some of the transmitted symbols are pilot symbols known to the receiver and the remainder are information carrying data symbols, w<sup>r</sup>ith phase that is unknown to the receiver. So, </p><p id="p0048" num="0048"><img id="imgf000006_0001" he="19" wi="35" file="imgf000006_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 , where <sup>;</sup> is t he set of indices describing the position of the pilot symbols p<sub>t</sub> , and D i s a set of indices describing the position of the data symbols (/. . The sets F and D are disjoint, i.e. </p><p id="p0049" num="0049">Pn D = 0 and the union f u D contains all those indices where the transmitter is active. The total number of symbols transmitted L = + . The transmitted signal can be rewritten as: 
<img id="imgf000006_0002" he="6" wi="34" file="imgf000006_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 where 
<!-- EPO <DP n="7"/>-->
 
<img id="imgf000007_0001" he="10" wi="85" file="imgf000007_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 are the pilot and data portions of the transmitted signal. </p><p id="p0050" num="0050">[0040] t ean be assumed that the received signal undergoes time and phase offset, is attenuated by some amount and is also subjected to additive noise. One possible model for the analogue received signal is, i{t) = a<sub>0</sub>x{t - T<sub>0</sub>) + w{t) </p><p id="p0051" num="0051">where ¾ 6 is a complex number representing both attenuation and phase offset, T<sub>0</sub> is the time offset and ½(t) is a continuous noise process. </p><p id="p0052" num="0052">[0041 1 The problem of time offset estimation is made difficult b the fact that the receiver does not know the complex amplitude os<sub>0</sub> nor the data symbols. </p><p id="p0053" num="0053">[0042] In practice it is often necessary to also estimate the complex amplitude <sub>0</sub> . Given an accurate estimate of time offset (such as the nov el estimate in accordance with one or more aspects of the present invention), one can use existing techniques known to a person skilled in the art to estimate or<sub>0</sub> after applying a matched filter. </p><p id="p0054" num="0054">[ 0043] The setting described herein involves a finite number of transmitted symbols, represented by the indices in P u D . This has been known to a person skilled i the art as packet data transmission or hurst-mode transmission. An alternative setting, continuous data transmission, assumes that </p><p id="p0055" num="0055">F u D - Z , but that the receiver only wishes to process the received signal r(f) inside some .finite window of time. The novel estimator described herein can be used in either of these settings. However, for the sake of a clear exposition, only packet data transmission is explained in the description below. Extension to other settings is straightforward for someone skilled in the art. </p><p id="p0056" num="0056">[0044] The estimator described herein also combines frame synchronisation and symbol </p><p id="p0057" num="0057">synchronisation into a single operation that estimates the time offset. </p><p id="p0058" num="0058">[0045] f igure 1 depicts a block diagram 1 illustrating one embodiment of the present invention. This is an overview only and detailed implementations will.be presented later. An analogue received signal 
<!-- EPO <DP n="8"/>-->
 f (t), which is provided by a receiver (not shown), is sampled by switch 3 to become the digital signal ΐ<sub>α</sub>. The digital signal r<sub>n</sub> is then processed by processing block 5 using a function SS(t) where τ takes the value of a finite number of possible time offsets. For example, the finite number of possible time offsets are Γ, , ,,... , T<sub>K</sub> for some positive integer A<sup>'</sup> where τ<sub>ί</sub> — T, = A , and Δ = 77c where T is the symbol period of the pilot symbols and data symbols, and C is a positive integer. The function SS(T) is often known as an optimising function, and it can be a minimiser or a maximiscr. The optimising function of SS(T) over Ί<sub>λ</sub> , τ<sub>2</sub> , ... , τ<sub>κ</sub> produces an approximation of the true estimator f . To obtain T from Γ , a further refinement process by processing block 7 is in place. However, it is possible that further refinement process by processing block 7 is not necessary depending on the requirement of the accuracy of the time offset. In other words, the approximation f may be sufficiently accurate and a further refinement process by processing block 7 is not required. </p><p id="p0059" num="0059">[0046] Figure 2 depicts a diagram 1 1 showing one embodiment of the functio SS(T) of figure h I this embodiment, the digital signal r<sub>n</sub> is processed by functions Y(t) 13 and Z(t) 15. Function Y(r) 13 is computed at T<sub>x</sub> , T<sub>2</sub>, .. . , T<sub>K</sub> . For example, Υ(τ) 13 can be a correlation of r<sub>n</sub> and a finite number of possible pilot symbols. Z(t) 15 is computed at f<sub>t</sub>, T<sub>2</sub>, . . ., T<sub>K</sub> . For example, Z(t) 15 can be a correlation of r<sub>n</sub> and a finite number of possible data symbols . In one embodiment as shown, the output of function Y(t) 1 is further processed by processing block 17 to produce a modulus of the output of function Υ(τ). The modul us is then combined by combiner 19 with the output of function Ζ(τ) 15 to produce T . In another embodiment, the output of function Υ(τ) 13 can be combined with the output of function Ζ(τ) 15 to produce t . In a general form, maximising a linear combination of Υ(τ) 13 and Ζ(τ) 15 produces T . </p><p id="p0060" num="0060"> [0047] Figure 3 summarises steps involved in performing the present invention. In particular, to estimate a time offset of a transmitted signal which comprises both pilot symbols and data symbols, the present invention includes step 31 of firstly receiving the transmitted signal to produce a received signal. This is then followed by step 33 of processing an optimising function of the received signal at a finite number of possible time offsets to produce an estimator of the time offset. </p><p id="p0061" num="0061">[0048] A receiver which includes the functions described with respect to Figure 1 can take various forms deemed suitable by a person skilled in the art. The receiver can also be part of a communication system, which also includes a corresponding transmitter. Further, the functions may be stored as instructions in a computer readable medium, such as a non-transitory processor readable medium (e.g. hard disk, Flash memory, optical disk (CDROM, DVD), etc.) for causing processor to implement the functions. 
<!-- EPO <DP n="9"/>-->
 [0049] Those of skill in the art would understand that information and signals may be represented using any of a variety of technologies and techniques. For example, data, instructions, commands, information, signals, bits, symbols, and chips may be referenced throughout the above description may be represented by voltiiges, currents, electromagnetic waves, magnetic fields or particles, optical fields or particles, or any combination thereof. </p><p id="p0062" num="0062">[0050] Those of skill in the art would further appreciate that the various illustrative logical blocks, modules, circuits, and algorithm steps described in connection with the embodiments disclosed herein may be implemented as electronic hardware, computer software, or combinations of both. To clearly illustrate this inter-changeability of hardware and software, various illustrative components, blocks, modules, circuits, and steps have been described above generally in terms of their functionality. </p><p id="p0063" num="0063">Whether such functionality is implemented as hardware or software depends upon the particular application and design constraints imposed on the overall system. A person skilled in the art may implement the described functionality in varying ways for each particular application, but such implementation decisions should not be interpreted as causing a departure from the scope of the present invention. For example, the invention herein described may be implemented in ground-satellite communication, mobile device communications etc. In fact, cost aside, the invention described herein can be applied to any form of communication equipment. </p><p id="p0064" num="0064">[0051] The steps of a method or algorithm described in connection with the embodiments disclosed herein may be embodied directly in hardware, in a software module executed by a processor, or in a combination of the two. For a hardware implementation, processing may be implemented within one or more application specific integrated circuits (ASICs), digital signal processors (DSPs), digital signal processing devices (DSPDs), programmable logic devices (PLDs), field programmable gate arrays (FPGAs), processors, controllers, micro-controllers, microprocessors, other electronic units designed to perform the functions described herein, or a combination thereof. A central processing unit (CPU) may be used, containing an Input/Output Interface, an Arithmetic and Logic Unit (ALU) and a Control Unit and Program Counter element which is in communication with input and output devices or modules through the Input/Output interface, and a memory. Software modules, also known as computer programs, computer codes, or instructions, may contain a number number of source code or object code segments or instructions, and may reside in any computer or processor readable medium such as a RAM memory, flash memory, ROM memory, EPROM memory, registers, hard disk, a removable disk, a CD-ROM, a DVD-ROM or any other form of computer readable medium, in the alternative, the computer readable medium may be integral to the processor. The processor and the computer readable medium may reside in an ASIC or related device. The software codes may be stored in a memory unit and executed by a processor. The memory unit may be implemented within 
<!-- EPO <DP n="10"/>-->
 the processor or external to the processor, in which case it can be communicatively coupled to the processor via various means as is known in the art. </p><p id="p0065" num="0065">[0052] The newly devel oped estimator of the time offset of a transmitted communications signal contains both pilot symbols, known to the receiver, and data symbols, unknown to the receiver. A number of different algorithms is derived for computing the estimator, that work under the assumption that the transmit pulse has finite duration. Faster algorithms are available if the symbol rate is rationally related to the sample rate, and even faster algorithms exist if the data symbols are arranged in a small number of contiguous blocks. Some of the algorithms require a number of operations that grows only l inearly with the number of transmitted symbols. Monte Carlo simulations with the new<sup>r</sup> estimator are also presented. The simulations show that the new- estimator performs substantially better than the estimator that correlates the received signal with the pilot signal, ignoring the data symbols. The simulations also suggest that when the signal to noise ratio is sufficiently high, the new estimator performs similarly to the estimator that results when all of the transmitted symbols are known a priori at the receiver. The new estimator performs favourably when compared to the estimator that combines the symbol timing estimator of "Oerder-Meyr" (see M. Oerder and H. Meyr, "Digital Filter and square timing recovery", IEEE Trans. Commun., vol. 36, no. 5, pp. 605 - 612, May 1988) with the frame synchronisation algorithm of "Massey" (see J. L. Massey, "Optimum frame synchronization", IEEE Trans. Commun., vol. 20, no. 2, pp. 1 5 - 1 19, 1 72). This is particularly the case with bandwidth efficient transmit pulses, such as root raised cosine with small roll-off. </p><p id="p0066" num="0066">B. The estimator </p><p id="p0067" num="0067">[0053] The received signal is sampled to obtain 
<img id="imgf000010_0001" he="6" wi="51" file="imgf000010_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0068" num="0068"> w<sub>B</sub> + a<sub>a</sub> jiT<sub>s</sub>n- Ti- T<sub>0</sub>)s. (1) </p><p id="p0069" num="0069">where n is an integer and Γ<sub>5</sub> is the sampling period and { u . , n&amp; Z} is a sequence of noise variables. This model for the sampled signal assumes instantaneous sampling. This is a reasonable </p><p id="p0070" num="0070">approximation for highly oversampled signals, i.e. when 4- is large compared to the bandwidth of g( t) . If this instantaneous sampling assumption is not valid, but the sampling device can be reasonably modelled by a linear time-invariant system with impulse response g (t) , then the effect of 
<!-- EPO <DP n="11"/>-->
 sampling can be included by replacing gif) with the convolution of g(t) and g<sub>s</sub>(t) , i.e., by replacing g(t) with 
<img id="imgf000011_0001" he="9" wi="35" file="imgf000011_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0071" num="0071">[0054] The objective function is defined as </p><p id="p0072" num="0072">SS(T) = Υ{τ)+ Ζ(τ) where 
<img id="imgf000011_0002" he="13" wi="132" file="imgf000011_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 and 
<img id="imgf000011_0003" he="13" wi="124" file="imgf000011_0003.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 where the inner product r(tXg(t- iT- T)) =∑r(nT<sub>s</sub>)g * (Tji- Ti- T) </p><p id="p0073" num="0073">and * denotes complex conjugates and where t\, f<sub>2</sub>, g<sub>l</sub> and gi are functions that are free to be chosen. The algorithms described herein apply for any choice of t\, fz, g&lt; and gi, but to keep the notation clean and the discussion simpler, it is set </p><p id="p0074" num="0074">(4) in what follows, where \ denotes the complex magnitude. n this case 
<img id="imgf000011_0004" he="14" wi="133" file="imgf000011_0004.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 and 
<!-- EPO <DP n="12"/>-->
 
<img id="imgf000012_0001" he="10" wi="133" file="imgf000012_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0075" num="0075">This choice is motivated by least squares statistical methodology, but it may be that other choices of t[, f<sub>2</sub>, gi and g<sub>2</sub> are good in certain situations. The present invention applies for all functions /i, f<sub>2</sub>, g<sub>\</sub> and </p><p id="p0076" num="0076">[0055] The estimator operates on the sampled signal directly. There is no need for resampling or interpolation as commo in known 'all-digital' receiver implementations. The process of 'interpolation' is built into the inner products in (7) to be described. What is assumed is that the transmit pulse, i.e. the function g ". P (-&gt; P , is known, and computable at the receiver. If it is computationally complex to compute g{t) for any given t then it may be advantageous to pre-compute g on a fine grid, and store the values in a lookup table. Simple interpolation (for example linear interpolation) can then be used based on the values in the table. This ca be made as accurate as desired by appropriately choosing the size of the lookup table. </p><p id="p0077" num="0077">C. Computing the estimator </p><p id="p0078" num="0078">[0056] in this section, practical algorithms for computing the minimiser of SS given the discrete received sequence {r<sub>r</sub>,, n&amp; Z} from (1) are described. To compute SS( ) for a particular T , it is necessary to compute both Y(l) and Z(r) . Both Y and Z contain inner products of the form </p><p id="p0079" num="0079">{r(t),git-iT- T)) =∑r(nT<sub>s</sub>)g (T<sub>s</sub>n 
<img id="imgf000012_0002" he="14" wi="67" file="imgf000012_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 and these infinite sums cannot be computed in practice. To alleviate this, it is assumed that the transmit pulse g(f) has finite duration, that is, g(i) is nonzero only for t in some interval [t<sub>m</sub> </p><p id="p0080" num="0080"> In this case the inner product can be computed by the finite sum 
<img id="imgf000012_0003" he="10" wi="98" file="imgf000012_0003.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 where </p><p id="p0081" num="0081">G = {tie Z I 7 - Ti- te [i<sub>min</sub> , /<sub>ma</sub>J} . 
<!-- EPO <DP n="13"/>-->
 [0057] This assumption is reasonable in practical systems that make use of truncated transmit pulses. </p><p id="p0082" num="0082">[0058] Another assumption made is that the time offset T<sub>0</sub> is known to lie in some compact interval [T<sub>jjjj</sub>,, , f<sub>max</sub> ] of P , This estimator is then the minimiser of SS( ) over this interval, f = ars max S(.z). </p><p id="p0083" num="0083"> 1 </p><p id="p0084" num="0084"> 1 imn ' max <sup>1</sup> </p><p id="p0085" num="0085">[0059] A result of these assumptions is that the receiver only requires those values of r<sub>p</sub> within which the signal can reside. That is, only for D satisfying A &lt; n &lt; B where </p><p id="p0086" num="0086"><img id="imgf000013_0001" he="36" wi="60" file="imgf000013_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 and where min( u D) and max( u D) denote the minimum and maximum symbol indices, and P<sup>~</sup>| and [_· J denote the smallest integer greater than or equal to, and the largest integer less than or equal to their arguments. In this way, the receiver only need observe a finite number of elements {r , A≤n≤ B} . </p><p id="p0087" num="0087">[0060] To compute 7 , SS is first computed on a finite uniform grid of values &gt; ^2 ' * <sup>* * ?</sup> κ for some positive integer K w<sup>r</sup>here <sub>M</sub> - T<sub>}</sub> = Δ , and Δ = 77 c is a fraction of the symbol period, and C is a positive integer. Then 
<img id="imgf000013_0002" he="13" wi="61" file="imgf000013_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 so that the grid is spaced over the interval [T<sub>mm</sub> , r<sub>max</sub> ] and 
<!-- EPO <DP n="14"/>-->
 
<img id="imgf000014_0001" he="12" wi="38" file="imgf000014_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 f0061j Efficient algorithms for computing all of SS(T<sub>X</sub> )...., SS(T<sub>K</sub>) will be described. Provided that Δ is chosen sufficiently small (equivalently C is chosen sufficiently large) the grid point that minimises SS , denoted by ΐ , is a good approximation of the true minimiser . An optimisation procedure, initialised at T , can then be used to obtain f . Practical optimisation procedures are discussed in section G. For now, the focus is on computing the approximation f . </p><p id="p0088" num="0088">[0062] To compute all of SS(T<sub>T</sub> }, . , . , SS{T<sub>K</sub> ) one needs to compute all of Υ(τ<sub>ι</sub> ),, .. , Y( <sub>K</sub> ) and all of Z(r, ),. , ., Ζ{τ<sub>κ</sub> ) . A naive approach is to directly compute Yfc ),... , Υ(τ<sub>κ</sub> ) and Z(r<sub>t</sub>), Ζ(τ<sub>κ</sub> ) using formula (5) and (6) (or (2) and (3) for general f<sub>\</sub>, f<sub>2</sub>, gi and gi). </p><p id="p0089" num="0089">[0063] The following sections describe a much faster algorithm for computing all of </p><p id="p0090" num="0090"> , . . , SS(T<sub>K</sub> ) . This algorithm requires that the sample period T<sub>S</sub> is rationally related to the symbol period T, i.e., T = - TVhere /;&gt; and g re relatively prime integers. This assumption can always be made an accurate approximation by an appropriate choice of p and q. The algorithm is described under the assumption that }, ?, g[ and g% are chosen according to (4), however it is trivial to modify the algorithms so that they work for any choice of the functions j , /<sub>2</sub>, g<sub>\</sub> and g<sub>2</sub>. </p><p id="p0091" num="0091">Dl. Computing
<img id="imgf000014_0002" he="6" wi="13" file="imgf000014_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 , . , Ζ(τ<sub>κ</sub>) </p><p id="p0092" num="0092">T fa </p><p id="p0093" num="0093"> [0064] Write A =— =·— T<sub>s</sub> where a and b are relatively prime positive integers such that </p><p id="p0094" num="0094"> c pc a </p><p id="p0095" num="0095"> - pct. = . For 1 = 0,..., 0-1 , let </p><p id="p0096" num="0096">&amp;.<sub>0</sub> <sup>=</sup> g i-^-^^ -^+iO </p><p id="p0097" num="0097">so that </p><p id="p0098" num="0098">[0065] Let 
<!-- EPO <DP n="15"/>-->
 
<img id="imgf000015_0001" he="13" wi="133" file="imgf000015_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0099" num="0099">be a zero filled version of r„ and let </p><p id="p0100" num="0100">[0066] Put Z<sub>k</sub> = Z(T<sub>k</sub>) so that, </p><p id="p0101" num="0101"><img id="imgf000015_0002" he="49" wi="132" file="imgf000015_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/></p><p id="p0102" num="0102">where the last line follows since z<sub>a</sub> = 0 whenever n is not a multiple of &lt;3. Now, 
<img id="imgf000015_0003" he="40" wi="134" file="imgf000015_0003.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0103" num="0103">∑|¾.J&gt; </p><p id="p0104" num="0104">where</p><p id="p0105" num="0105"><img id="imgf000015_0004" he="10" wi="21" file="imgf000015_0004.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/></p><p id="p0106" num="0106">is the convolution of the sequence {Z<sub>;</sub>„, 7GZ} with the sequence {g<sub>( n</sub>,ne Z} and 
<!-- EPO <DP n="16"/>-->
 h-l </p><p id="p0107" num="0107"> (12) f=-0 </p><p id="p0108" num="0108">[0067J A person skilled in the art familiar with multi-rate systems and filter banks will recognise (9) to (10) as similar to the derivation of a polyphase filter. The I <sub>A</sub> corresponds with the indi vidual filter banks. The computational complexity of our algorithms do depend on the fraction— , but this structure ensures that the complexity will not depend on the magnitude of either p or q individually. This is desirable. It is not desirable for the algorithms to be fast when, say ^ = , but slow when, say JL = l ot </p><p id="p0109" num="0109">q 4000 - </p><p id="p0110" num="0110">[0068 j To compute all of Z<sub>]</sub> , , . , , Z<sub>K</sub> the values of b<sub>k</sub> for k = 1 + cmm(D)<sub>y</sub>. , . , K+ craax(fl) are required, where max(ZT) and misi(D) are the largest and smallest elements in D . To compute each b<sub>k</sub> the value of 1 - <sub>k</sub> for έ <sup>'</sup> = 0, , .. , q— 1 is required. Methods for computing h <sub>k</sub> are considered in subsections D3. The required values of b<sub>k</sub> can be computed and stored so that accessing any b<sub>k</sub> requires constant time. </p><p id="p0111" num="0111">[0069] In many practical scenarios it is the case that the data symbols occur in a small number of contiguous blocks, and in this case a faster algorithm exists. The algorithm for the case when the data symbols occur in a single contiguous block will be described, that is </p><p id="p0112" num="0112">D = {min( D), m (D) + 1 , ... , ax(D)}. </p><p id="p0113" num="0113">[0070J For each k = 0, ... , c—\ one can compute Z<sub>k</sub> = J<sub>¾+d</sub>l using O(j-D|) operations and, because the data symbols are in a contiguous block, k\-c{ l) \ 
<img id="imgf000016_0001" he="8" wi="25" file="imgf000016_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 and so Z<sub>k</sub> , Z<sub>t^</sub>„, Z<sub>i+2r</sub>, ... satisfy the recursion </p><p id="p0114" num="0114">7 </p><p id="p0115" num="0115"> = 7 - l /&gt; </p><p id="p0116" num="0116"> k + mc. k+ :mm(17) i ir+mt-t-irmax( Z?) + 
<!-- EPO <DP n="17"/>-->
 [0071] Each of Z<sub>l</sub> , ... , <sub>f</sub>_<sub>j</sub> can be computed using (5) and the remaining elements Z,.,... , Z<sub>K</sub> can be computed using the recursion above. A similar approach applies when the data symbols occur in a small number of contiguous blocks. A similar recursive procedure (not described here) can be readily developed by a person skilled in the art if the data symbols occur in a small number of separate contiguous blocks, </p><p id="p0117" num="0117">D2. Computing Υ{τ<sub>λ</sub> ), .. , , Υ(τ<sub>κ</sub> ) </p><p id="p0118" num="0118">[0072J Let b<sub>k</sub> be defined as in (12) and put Y<sub>k</sub> = Y(t<sub>k</sub>) . By working analogous to that from (9) to (10), </p><p id="p0119" num="0119">Y<sub>k</sub> =∑p (r(t), g(t iT- T<sub>t</sub>))</p><p id="p0120" num="0120"><img id="imgf000017_0001" he="9" wi="49" file="imgf000017_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/></p><p id="p0121" num="0121"> =∑/¾-«· </p><p id="p0122" num="0122">[0073] To compute all of Y<sub>K</sub> we require b<sub>k</sub> for k = l + cmm(P , ..., K+ cmax(P) . As in the previous subsection, the required values of b<sub>k</sub> can be computed and stored so that accessing them requires constant time. </p><p id="p0123" num="0123">D3. Computing b<sub>k</sub> and h, <sub>k</sub> </p><p id="p0124" num="0124">[0074] During the previous subsections it is assumed that certain values of b<sub>k</sub> had already been computed, and this subsection describes how to perfonn these computations efficiently. To compute b<sub>k</sub> it is necessary to compute: 
<img id="imgf000017_0002" he="10" wi="65" file="imgf000017_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0125" num="0125"> [0075] Since g(t) is nonzero only when | t<sub>mh</sub>. , ,,,,., ] then g,. <sub>n</sub> is nonzero only if - (n- Y)A - T<sub>1</sub> + i T<sub>s</sub> G [i<sub>mm</sub> , ^ , that is, only if A &lt; n≤ B where 
<!-- EPO <DP n="18"/>-->
 A = \ - <sup>tm + Tl</sup> +- and B = \- · + - Δ b and— T— ~ . Now h<sub>t k</sub> can be expressed as the finite sum </p><p id="p0126" num="0126"> ah 
<img id="imgf000018_0001" he="11" wi="25" file="imgf000018_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 where G = [n \ A &lt; k - n &lt; B } . Since z, <sub>n</sub> = is nonzero only for those integers n satisfying bn + £≡ 0(mod a) , the sum above can be further simplified to 
<img id="imgf000018_0002" he="11" wi="125" file="imgf000018_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 where G = \n&amp; G j bn + i = 0(mod a)} . Since a and b are relatively prime, there exist integers ./¾ and m<sub>0</sub> such that bn<sub>0</sub> + am<sub>n</sub> = 1. Both ¾ and ¾ can be computed using the extended Euclidean algorithm. Now £bn<sub>0</sub>≡ £ mod a) and </p><p id="p0127" num="0127">G = {ma-£i \ m = B , B + l ,..., A } where 
<img id="imgf000018_0003" he="13" wi="72" file="imgf000018_0003.tif" img-format="tif" img-content="table" orientation="portrait" inline="no"/>
 </p><p id="p0128" num="0128"> E. Summar of the Algorithm </p><p id="p0129" num="0129"> [0076| Figure 4 depicts the following steps which present the novel time offset estimation algorithm of one embodiment of the present invention. The maximisation in Step 4 is straightforward, and the optimisation in Step 6 can use any one of a number of numerical optimisation procedures that are known to someone skilled in the art. One particular example is given in Section F. </p><p id="p0130" num="0130">[0077) STEP 1: Compute and store the value of b<sub>k</sub> for all </p><p id="p0131" num="0131">A' = 1+ cmin(Pu D),..., K+ cmax(Pu D). 
<!-- EPO <DP n="19"/>-->
 Each b<sub>k</sub> can be efficiently computed using (12) and the algorithm described in subsection D3. </p><p id="p0132" num="0132">[0078] STEP 2: Compute and store Z<sub>k</sub> = Z(T<sub>k</sub> ) for all k = l,..., K using either the direct or recursive procedures described in subsection Dl . </p><p id="p0133" num="0133">[0079] STEP 3: Compute and store Y<sub>k</sub> = Y(T<sub>k</sub>) for all k = 1 ,, .. , K using the procedures described in subsection D2. </p><p id="p0134" num="0134">[0080] STEP 4; Find the ke { \, K} that maximises Z<sub>k</sub> + Y<sub>k</sub>, that is, compute k = arg max (Z<sub>t</sub> + YA. </p><p id="p0135" num="0135">[008 J J STEP 5: Compute the approximate estimate t = T<sub>l</sub> + A(k- l) = T<sub>mm</sub> + A{k - l ). </p><p id="p0136" num="0136">[0082] STEP 6; Apply a numerical optimisation procedure to SS(T) initialized with f to find the minimiser . Section G describes an implementation of Brent's method for this purpose (see R. P. Brent, Algorithms for Minimization without Derivatives, Prentice-Hall, Englewood Cliffs, New Jersey, 1973). </p><p id="p0137" num="0137">F. Obtaining f from T </p><p id="p0138" num="0138">[0083] In the previous section methods for computin f , the minimiser of SS over the grid</p><p id="p0139" num="0139">T<sub>r</sub>, . . . , T<sub>K</sub> are described. This serv es as an approximation of , the true minimiser of SS . Methods for obtaining from are now discussed. Many approaches could be taken. For example, the Newton-</p><p id="p0140" num="0140">Raphson method, or gradient ascent could be employed with Γ as a starting point, in one embodiment, Brent's method is used. This has the advantage of not requiring the derivatives of SS( T )</p><p id="p0141" num="0141">. Brent's method requires three initialisation points, A. , y and z , such that f e [A, z] and </p><p id="p0142" num="0142"> SS( ) &lt; SS( z) and SS( y) &lt; SS(x) . f and it's adjacent grid points are used for initialisation, that is, x= T—A ., y= T and z= T + A . </p><p id="p0143" num="0143">G. Numerical Results 
<!-- EPO <DP n="20"/>-->
 [[00008844]] RReessuullttss ooff MMoonnttee CCaarrlloo ssiimmuullaattiioonnss wwiitthh oouurr nneeww eessttiimmaatotorr ((tthhee mmiinniimmiisseerr ooff 5555 )) aarree pprreesseenntteedd,, wwiitthh tthhee eessttiimmaattoorr aassssuummiinngg aallll ssyymmbboollss aarree kknnoowwnn (({{DD|j == 00 aanndd ||PP|| == LL,, LL bbeeiinngg tthhee ttoottaall nnuummbbeerr ooff ssyymmbboollss)),, aanndd tthhee eessttiimmaattoorr tthhaatt oonnllyy uusseess tthhee ppiilloott ssyymmbboollss ((jjDDii == 00)).. SSiimmuullaattiioonnss wwiitthh tthhee eessttiimmaattoorr m thaatt ccoommbbiinneess tthhee OOeerrddeerr--MMeeyyrr ''ssqquuaarree aanndd f fiilltteerr ssyymmbbooll'' ttiimmiinngg eessttiimmaattoorr ((sseeee M M.. OOeerrddeerr aanndd HH.. MMeeyyrr,, ""DDiiggiittaall FFiilltteerr aanndd ssqquuaarree ttiimmiinngg.. rreeccoovveerryy"",, IIEEEEEE TTrraannss.. CCoommmmuunn..,, vvooll.. 3366,, nnoo.. 55,, pppp.. 660055 -- 661122,, M Maayy 11998888)) wwiitthh t thhee ""hhiigghh SSNNRR'' ffrraammee ssyynncchhrroonniissaattiioonn aallggoorriitthhmm ooff MMaasssseeyy aarree aallssoo pprreesseenntteedd.. FFoorr tthhee ssiimmuullaattiioonnss tthhee nnooiissee {{ »» }} iiss ccoommpplleexx GGaauussssiiaann wwiitthh zzeerroo mmeeaann aanndd iinnddeeppeennddeenntt rreeaall aanndd iimmaaggiinnaarryy ppaarrttss hhaavviinngg vvaaririaannccee ii77<sup>""</sup> .. IInn tthhiiss sseettttiinngg tthhee eessttiimmaattoorr tthhaatt aassssuummeess aallll ssyymmbboollss aarree k knnoowwnn iiss tthhee m maaxxiimmuumm lliikkeelliihhoooodd eessttiimmaattoorr.. TThhee ssiiggnnaall ttoo nnooiissee rraattiioo ((SSNNRR)) iiss ddeeffiinneedd aass </p><p id="p0144" num="0144"> EE,, </p><p id="p0145" num="0145"> SSNNRR ==—— ~~ wwhheerree ££<sub>55</sub> == TTJJTT iiss tthhee aavveerraaggee eenneerrggyy ppeerr ssaammppllee.. I Inn tthhiiss ccaassee,, iitt iiss sseelleecctteedd tthhaatt 22&lt;&lt;77~~ </p><p id="p0146" num="0146">pp == 33 aanndd qq== \\ ll ssoo tthhee ssaammppllee ppeerriioodd iiss ΓΓ<sub>¾¾</sub> ==——·· .. TThhee ttiimmee ooffffsseett sseeaarrcchh iinntteerrvvaall iiss </p><p id="p0147" num="0147">[[rr<sub>mmii</sub> ,, rr<sub>iiJJiiaaxx</sub> ]] == [[4400,,7700]] ,, aanndd cc == 1122 ,, ssoo tthhaatt ΔΔ == ~~<sup>■■</sup> == ~ .. TThhiiss ccoorrrreessppoonnddss ttoo tthhee ggrriidd </p><p id="p0148" num="0148">4400,, 4400 ++ ., 4400 ++ ¾¾.... ...... ,, 7700 - -<sub>j</sub>½ ,7700 tthhaatt iiss sseeaarrcchheedd iinn oorrddeerr ttoo pprroovviiddee tthhee aapppprrooxxiimmaattee eessttiimmaattee TT .. BBrreenntt''ss mmeetthhoodd iiss uusseedd ttoo rreefifinnee TT ttoo w wiitthhiinn 1100<sup>""</sup>'' ooff ff .. MMoonnttee CCaarrlloo ssiimmuullaattiioonnss aarree rruunn ffoorr SSNNRR bbeettwweeeenn --1177ddBB ttoo 2233ddBB iinn sstteeppss ooff 11..55ddBB.. TThhee nnuummbbeerr ooff rreepplliiccaattiioonnss uusseedd ppeerr eexxppeerriimmeenntt iiss NN == 22000000.. NN eessttiimmaatteess <sub>ll</sub> tt<sub>NN</sub> iiss oobbttaaiinneedd,, aanndd tthhee mmeeaann ssqquuaarree eerrrroorr ((MMSSEE)) iiss ccoommppuutteedd aaccccoorrddiinngg ttoo i<sub>j</sub> ^^j <sub>}</sub>(f„n ~~ <sup>ττ</sup>οοΫΫ■■ FF°°<sup>rr eeaacc</sup>hh rreepplliiccaattiioonn tthhee ppiilloott ssyymmbboollss aanndd ddaattaa ssyymmbboollss aarree uunniiffoorrmmllyy rraannddoommllyy ggeenneerraatteedd QQPPSSKK ssyymmbboollss,, tthhee ccoommpplleexx aammpplliittuuddee <sub>00</sub> hhaass mmaaggnniittuuddee oonnee aanndd pphhaassee uunniiffoorrmmllyy rraannddoommllyy ggeenneerraatteedd oonn [[00,,22 )) ,, aanndd tthhee ttiimmee ooffffsseett ff<sub>00</sub> iiss uunniiffoorrmmllyy rraannddoommllyy ggeenneerraatteedd oonn tthhee iinntteerrvvaall [[rr<sub>BBllllttll</sub> ++ 11 ,, rr<sub>mm::ii</sub>.. -- II ]] == [[4411 ,,6699]] .. </p><p id="p0149" num="0149">110000885511 SSiimmuullaattiioonnss ffoorr LL == 4400 aanndd LL == 440000 aarree ppeerrffoorrmmeedd.. FFiigguurreess 55 ttoo 88 ddiissppllaayy tthhee rreessuullttss wwiitthh tthhee nnuummbbeerr ooff ppiilloottss ssyymmbboollss || f i-jj == 55,, 1100,,2200 wwhheenn LL == 4400 aanndd JJffjj == 55,, 1100,,2200,, 110000 wwhheenn LL == 440000 aanndd w whheenn tthhee ttrraannssmmiitt ppuullssee iiss a a rroooott--rraaiisseedd ccoossiinnee ((RRRRCC)) wwiitthh rroollll--ooffff 44-- aanndd ppeerriioodd 77 == 11 .. TThhee ppuullssee iiss ttrruunnccaatteedd aatt tthhee 1155tthh zzeerroo oonn tthhee ppoossiittiivvee aanndd nneeggaattiivvee rreeaall aaxxiiss.. TThheessee zzeerrooss ooccccuurr aatt </p><p id="p0150" num="0150">tt == ++tt<sub>gg</sub> «« 11 11..663355663399 ssoo tthhee ppuullssee iiss sseett ttoo zzeerroo oouuttssiiddee tthhee i inntteerrvvaall [[—- it<sub>00</sub> ,, tt<sub>00</sub>]] .. TThhiiss ttrruunnccaatteedd ppuullssee iiss tthheenn nnoorrmmaalliisseedd ttoo hhaavvee eenneerrggyy 11.. IInn aallll ccaasseess tthhee ppiilloott ssyymmbboollss aarree aarrrraannggeedd iinn aa ccoonnttiigguuoouuss bblloocckk wwiitthh iinnddiicceess PP == {{ 11 ,, ...... ,, || ffjj}} aanndd tthhee ddaattaa ssyymmbboollss aarree aarrrraannggeedd iinn aa ccoonnttiigguuoouuss bblloocckk wwiitthh iinnddiicceess</p><p id="p0151" num="0151">DD == {{II PP ++ 11 ,, ...... ,, * .. AAss eexxppeecctteedd,, tthhee eessttiimmaattoorr uussiinngg oonnllyy tthhee ppiilloott ssiiggnnaall wwoorrkkss bbeetttteerr wwhheenn tthheerree 
<!-- EPO <DP n="21"/>-->
 are more pilot symbols. This estimator performs poorly compared to the other estimators when the number of pilots is small. The performance of our new estimator is poor until the SNR is sufficiently large, a threshold effect is then observed, after which, the performance is not far from the estimator that results when all of the symbols are known in advance. The value of SNR where the threshold occurs appears to depend largely on the number of pilots, and little on the total number of symbols L . </p><p id="p0152" num="0152">[0086] Figures 9 to 12 display result under the same conditions as in Figures 5 to 8 but where the transmit pulse is now a root-raised cosine with roll-off and period 7 = 1 . The pulse is now truncated at the 30th zero on the positive and negative real axis. These zeros occur at </p><p id="p0153" num="0153">t = ±t<sub>Q</sub> ~ 29.59077 and the pulse is set to zero outside the interval [— i<sub>0</sub> , f<sub>0</sub>] . This truncated pulse is then normalised to have energy 1. In this setting the MSE of the estimator based on the Oerder-Meyr symbol timing estimator and Massey's frame synchroniser is larger than that when the roll-off was .</p><p id="p0154" num="0154">This is due to the Oerder-Meyr synchroniser being less accurate when the roll-off is small. The behaviour is studied in M. Oerder and H. Meyr, "Digital Filter and square timing recovery", IEEE Trans. Commun., vol. 36, no. 5, pp. 605 - 612, May 1988, where it is shown that the variance of the</p><p id="p0155" num="0155">Oerder-Meyr synchroniser is inversely proportional to the energy of the signal
<img id="imgf000021_0001" he="7" wi="11" file="imgf000021_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 at frequency j .</p><p id="p0156" num="0156">That is, if </p><p id="p0157" num="0157">is
<img id="imgf000021_0002" he="24" wi="133" file="imgf000021_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 T) j . The value of J P( 1 / T) can be observed to decrease with the roll-off, making the Oerder-Meyr synchroniser less accurate. By contrast, the new estimator described herein appears to be minimally affected by the change in roll-off. </p><p id="p0158" num="0158">[0087] Throughout the specification and the claims that follow, unless the context requires otherwise, the words "comprise" and "include" and variations such as "comprising" and "including" will be understood to imply the inclusion of a stated integer or group of integers, but not the exclusion of any other integer or group of integers. </p><p id="p0159" num="0159">[0088] The reference to any prior art in this specification is not, and should not be taken as, an acknowledgement of any form of suggestio that such prior art forms part of the common general knowledge. 
<!-- EPO <DP n="22"/>-->
 [0089] It will be appreciated by those skilled in the art that the invention is not restricted in its use to the particular application described. Neither is the 'present invention restricted in its preferred embodiment with regard to the particular elements and/or features described or depicted herein. It will be appreciated that tire invention is not limited to the embodiment or embodiments disclosed, but is capable of numerous rearrangements, modifications and substitutions without departing from the scope of the invention. 
</p></description><claims mxw-id="PCLM70078988" ref-ucid="WO-2014127407-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="23"/>-->CLAIMS </claim-statement><claim id="clm-0001" num="1"><claim-text>1. A method for estimating a time offset of a transmitted signal which comprises pilot symbols and data symbols, the method comprising: </claim-text><claim-text> receiving the transmitted signal to produce a received signal; and </claim-text><claim-text> processing an optimising function of the received signal at a finite number of possible time offsets to produce an estimator of the time offset. </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. The method of claim 1 , wherein the optimising function comprises a function of the received signal with a finite number of possible pilots. </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. The method of claim 1 or 2, wherein the optimising function comprises a functio of the received signal with a finite number of possible data symbols, </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. The method of claim 1, wherein the optimising function comprises a mathematical function, or equivalent, of SS(t) = Ζ(τ) + Υ(τ) where Z is a function of the received signal, the time offset and positions of a finite number of the data symbols, and Y is a function of the received signal, the time offset and positions of a finite number of possible pilot symbols. </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. The method of any one of claims 1 to 4, wherein the optimising function is processed at the finite number of possible time offsets T, , Γ, , ..., T<sub>K</sub> for some positive integer K where T<sub>M</sub>— t, = Δ , and Δ = Tic where T is the symbol period of the pilot symbols and data symbols, and C is a positi ve integer. </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. The method of claim 1, wherein the data symbols are complex numbers. </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. The method of claim 1 , wherein the data symbols are from a finite set on a complex unit circle. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. The method of claim 7, wherein the data symbols are from a M-PSK constellations. </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. The method of claim 1, wherein the step of processing an optimising function comprises: computing ¾ for all k = 1 + cmin( u D),..., K + cmax(P D) , where P is set of indices describing positions of the pilots symbols, D is set of indices describing positions of the data symbols, K and C are positive integers; 
<!-- EPO <DP n="24"/>-->
 computing Z<sub>k</sub> = Z(r<sub>k</sub> ) , based on b<sub>k</sub> , for all k = 1 , ... , K , where T<sub>k</sub> is an possible time offset; computing Y<sub>k</sub> = Y(T<sub>k</sub> ) , based on ¾ , for all k = l,..., K , F(r. ) being a different function from Z( r.. ) ; </claim-text><claim-text> computing k e { 1 , , .. , K} that maximises Z<sub>k</sub> + Y<sub>k</sub> ; </claim-text><claim-text> computing an approximate time offset estimate, , based on k that maximises Z<sub>k</sub> + Y<sub>k</sub> ; applying a numerical optimisation procedure initialized with T to produce the estimator of the time offset. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. The method of claim 9. wherein the step of computing an approximate time offset estimate comprises: computing f = <sub>i</sub> + A(k— 1) = T<sub>mia</sub> + A(k— 1 ), where k is the ir that maximises Z<sub>k</sub> + Y<sub>k</sub> ,</claim-text><claim-text>Δ = Tic where T is the s^Tnbol period of the pilot symbols and data Symbols, and C is a positive integer. </claim-text></claim><claim id="clm-0011" num="11"><claim-text>1 1. A computer program product configurable to perform the method of 1 to 10. </claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. A receiver configurable to perform the method of 1 to 10. </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. A communication system, comprising: </claim-text><claim-text> a transmitter for transmitting a transmitted signal which comprises pilot symbols and data symbols; and </claim-text><claim-text> a receiver configurable to perform the method of 1 to 1 . 
</claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
