<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2959639-A1" country="EP" doc-number="2959639" kind="A1" date="20151230" family-id="50343735" file-reference-id="311201" date-produced="20180826" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160452537" ucid="EP-2959639-A1"><document-id><country>EP</country><doc-number>2959639</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-14711690-A" is-representative="NO"><document-id mxw-id="PAPP193868042" load-source="docdb" format="epo"><country>EP</country><doc-number>14711690</doc-number><kind>A</kind><date>20140221</date><lang>EN</lang></document-id><document-id mxw-id="PAPP193868043" load-source="patent-office" format="original"><country>EP</country><doc-number>14711690.9</doc-number><date>20140221</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162026334" ucid="EP-13156085-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>13156085</doc-number><kind>A</kind><date>20130221</date></document-id></priority-claim><priority-claim mxw-id="PPC162030676" ucid="EP-14711690-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>14711690</doc-number><kind>A</kind><date>20140221</date></document-id></priority-claim><priority-claim mxw-id="PPC162027320" ucid="EP-2014053448-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>2014053448</doc-number><kind>W</kind><date>20140221</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1988519993" load-source="docdb">H04L  12/721       20130101ALI20140912BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988522082" load-source="docdb">H04L  12/947       20130101ALI20140912BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988522551" load-source="docdb">H04L  29/06        20060101ALI20140912BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988522898" load-source="docdb">H04L  12/26        20060101AFI20140912BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988523521" load-source="docdb">H04L  12/24        20060101ALI20140912BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988525406" load-source="docdb">H04L  12/715       20130101ALI20140912BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1898973479" load-source="docdb" scheme="CPC">H04L  63/12        20130101 LI20160907BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984017495" load-source="docdb" scheme="CPC">H04L  43/10        20130101 FI20160115BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984017746" load-source="docdb" scheme="CPC">H04L  45/38        20130101 LI20160114BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984017938" load-source="docdb" scheme="CPC">H04L  63/126       20130101 LI20160114BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984021691" load-source="docdb" scheme="CPC">H04L  45/64        20130101 LI20160115BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984023707" load-source="docdb" scheme="CPC">H04L  43/106       20130101 LI20160115BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984024265" load-source="docdb" scheme="CPC">H04L  49/25        20130101 LI20160115BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984025090" load-source="docdb" scheme="CPC">H04L  41/0893      20130101 LI20160115BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984025170" load-source="docdb" scheme="CPC">H04L  43/0864      20130101 LI20160115BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165549077" lang="DE" load-source="patent-office">SICHERUNG VON NETZWERKMESSUNGEN MITTELS OPENFLOW</invention-title><invention-title mxw-id="PT165549078" lang="EN" load-source="patent-office">SECURING NETWORK MEASUREMENTS USING OPENFLOW</invention-title><invention-title mxw-id="PT165549079" lang="FR" load-source="patent-office">SÉCURISATION DE MESURES DE RÉSEAU À L'AIDE D'UN DISPOSITIF OPENFLOW</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR1103304679" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>NEC EUROPE LTD</last-name><address><country>DE</country></address></addressbook></applicant><applicant mxw-id="PPAR1103336518" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>NEC EUROPE LTD.</last-name></addressbook></applicant><applicant mxw-id="PPAR1101653573" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>NEC Europe Ltd.</last-name><iid>101223261</iid><address><street>Kurfürsten-Anlage 36</street><city>69115 Heidelberg</city><country>DE</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103335476" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>KARAME GHASSAN</last-name><address><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR1103315278" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>KARAME, Ghassan</last-name></addressbook></inventor><inventor mxw-id="PPAR1101647069" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>KARAME, Ghassan</last-name><address><street>Heinrich-Fuchs-Strasse 59</street><city>69126 Heidelberg</city><country>DE</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR1101642081" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Ullrich &amp; Naumann</last-name><iid>101257954</iid><address><street>PartG mbB Schneidmuehlstrasse 21</street><city>69115 Heidelberg</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="EP-2014053448-W"><document-id><country>EP</country><doc-number>2014053448</doc-number><kind>W</kind><date>20140221</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2014128265-A1"><document-id><country>WO</country><doc-number>2014128265</doc-number><kind>A1</kind><date>20140828</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS660709566" load-source="docdb">AL</country><country mxw-id="DS660624131" load-source="docdb">AT</country><country mxw-id="DS660709572" load-source="docdb">BE</country><country mxw-id="DS660703211" load-source="docdb">BG</country><country mxw-id="DS660703345" load-source="docdb">CH</country><country mxw-id="DS660788768" load-source="docdb">CY</country><country mxw-id="DS660624132" load-source="docdb">CZ</country><country mxw-id="DS660709573" load-source="docdb">DE</country><country mxw-id="DS660788769" load-source="docdb">DK</country><country mxw-id="DS660788770" load-source="docdb">EE</country><country mxw-id="DS660625553" load-source="docdb">ES</country><country mxw-id="DS660703212" load-source="docdb">FI</country><country mxw-id="DS660725042" load-source="docdb">FR</country><country mxw-id="DS660709574" load-source="docdb">GB</country><country mxw-id="DS660788771" load-source="docdb">GR</country><country mxw-id="DS660709579" load-source="docdb">HR</country><country mxw-id="DS660624133" load-source="docdb">HU</country><country mxw-id="DS660703346" load-source="docdb">IE</country><country mxw-id="DS660788772" load-source="docdb">IS</country><country mxw-id="DS660725047" load-source="docdb">IT</country><country mxw-id="DS660788773" load-source="docdb">LI</country><country mxw-id="DS660703213" load-source="docdb">LT</country><country mxw-id="DS660624903" load-source="docdb">LU</country><country mxw-id="DS660703214" load-source="docdb">LV</country><country mxw-id="DS660703219" load-source="docdb">MC</country><country mxw-id="DS660624904" load-source="docdb">MK</country><country mxw-id="DS660624905" load-source="docdb">MT</country><country mxw-id="DS660625554" load-source="docdb">NL</country><country mxw-id="DS660725048" load-source="docdb">NO</country><country mxw-id="DS660624906" load-source="docdb">PL</country><country mxw-id="DS660703351" load-source="docdb">PT</country><country mxw-id="DS660625559" load-source="docdb">RO</country><country mxw-id="DS660703352" load-source="docdb">RS</country><country mxw-id="DS660624919" load-source="docdb">SE</country><country mxw-id="DS660709580" load-source="docdb">SI</country><country mxw-id="DS660725049" load-source="docdb">SK</country><country mxw-id="DS660624920" load-source="docdb">SM</country><country mxw-id="DS660788774" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA139079858" ref-ucid="WO-2014128265-A1" lang="EN" load-source="patent-office"><p num="0000">A method of performing secure network measurements between a verifier (1 ) and a prover (2), wherein said verifier (1 ) generates probe request packets destined to said prover (2) and said prover (2) echoes its probe reply packets back to said verifier (1 ), is characterized in that a path between said verifier (1 ) and said prover (2) traverses a network domain (3) that includes at least one software defined network (SDN) controller (4, 5) and one or more SDN switches (6, 7, 8), wherein tampering of said network measurements by said prover (2) is obviated by selectively influencing the probe request packets sent by said verifier (1 ) and/or the probe reply packets sent by said prover (2) by means of programmable packet forwarding rules said at least one SDN controller (4, 5) implements on said one or more SDN switches (6, 7, 8).</p></abstract><abstract mxw-id="PA139546413" ref-ucid="WO-2014128265-A1" lang="EN" source="national office" load-source="docdb"><p>A method of performing secure network measurements between a verifier (1 ) and a prover (2), wherein said verifier (1 ) generates probe request packets destined to said prover (2) and said prover (2) echoes its probe reply packets back to said verifier (1 ), is characterized in that a path between said verifier (1 ) and said prover (2) traverses a network domain (3) that includes at least one software defined network (SDN) controller (4, 5) and one or more SDN switches (6, 7, 8), wherein tampering of said network measurements by said prover (2) is obviated by selectively influencing the probe request packets sent by said verifier (1 ) and/or the probe reply packets sent by said prover (2) by means of programmable packet forwarding rules said at least one SDN controller (4, 5) implements on said one or more SDN switches (6, 7, 8).</p></abstract><abstract mxw-id="PA139079859" ref-ucid="WO-2014128265-A1" lang="FR" load-source="patent-office"><p num="0000">L'invention concerne un procédé permettant d'effectuer des mesures de réseau sécurisées entre une entité authentifiante (1) et une entité à authentifier (2), ladite entité authentifiante (1) générant des paquets de demandes d'essai destinés à ladite entité à authentifier (2) et ladite entité à authentifier (2) renvoyant en écho ses paquets de réponses d'essai à ladite entité authentifiante (1). Le procédé est caractérisé en ce qu'un chemin entre ladite entité authentifiante (1) et ladite entité à authentifier (2) traverse un domaine réseau (3) comprenant au moins un contrôleur SDN (software defined network) (4, 5) et un ou plusieurs commutateurs SDN (6, 7, 8), la falsification desdites mesures de réseau par ladite entité à authentifier (2) étant évitée en influençant de manière sélective les paquets de demandes d'essai envoyés par ladite entité authentifiante (1) et/ou les paquets de réponses d'essai envoyés par ladite entité à authentifier (2) au moyen de règles de transfert de paquet programmable que ledit contrôleur SDN (4, 5) met en œuvre sur le ou lesdits commutateurs SDN (6, 7, 8).</p></abstract><abstract mxw-id="PA139546414" ref-ucid="WO-2014128265-A1" lang="FR" source="national office" load-source="docdb"><p>L'invention concerne un procédé permettant d'effectuer des mesures de réseau sécurisées entre une entité authentifiante (1) et une entité à authentifier (2), ladite entité authentifiante (1) générant des paquets de demandes d'essai destinés à ladite entité à authentifier (2) et ladite entité à authentifier (2) renvoyant en écho ses paquets de réponses d'essai à ladite entité authentifiante (1). Le procédé est caractérisé en ce qu'un chemin entre ladite entité authentifiante (1) et ladite entité à authentifier (2) traverse un domaine réseau (3) comprenant au moins un contrôleur SDN (software defined network) (4, 5) et un ou plusieurs commutateurs SDN (6, 7, 8), la falsification desdites mesures de réseau par ladite entité à authentifier (2) étant évitée en influençant de manière sélective les paquets de demandes d'essai envoyés par ladite entité authentifiante (1) et/ou les paquets de réponses d'essai envoyés par ladite entité à authentifier (2) au moyen de règles de transfert de paquet programmable que ledit contrôleur SDN (4, 5) met en œuvre sur le ou lesdits commutateurs SDN (6, 7, 8).</p></abstract><description mxw-id="PDES78478079" ref-ucid="WO-2014128265-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="2"/>--><p id="p0001" num="0001"> SECURING NETWORK MEASUREMENTS USING OPENFLOW </p><p id="p0002" num="0002">The present invention relates to a method of performing secure network measurements between a verifier and a prover, wherein said verifier generates probe request packets destined to said prover and said prover echoes its probe reply packets back to said verifier. </p><p id="p0003" num="0003">Furthermore, the present invention relates to a system for performing secure network measurements between a verifier and a prover, wherein said verifier is configured to generate probe request packets destined to said prover and said prover is configured to echo its probe reply packets back to said verifier. </p><p id="p0004" num="0004">Network measurements are becoming crucial for the operation and security of the Internet, and of several services including for instance application-level multicast trees, content distribution and peer-to-peer (P2P) systems. Numerous tools for estimating various aspects of network performance have been proposed, among them, for instance, with regard to bandwidth measurements: Sprobe (see for reference S. Sariou, P. Gummadi and S. Gribble: "SProbe: A Fast Technique for Measuring Bottleneck Bandwidth in Uncooperative Environments", in INFOCOM, 2002), with regard to latency: traceroute (see for reference ftp://ftp.ee.lbl.gov/traceroute.tar.gz) or ping (see for reference ftp://ftp.arl.mil/pub/ping.shar), or with regard to link quality: mtr (see for reference http://www.bitwizard.nl/mtr/). Given the current trends in designing a secure next-generation Internet, the design of current measurement tools is showing the limits of foresight in the design/deployment of these tools: </p><p id="p0005" num="0005">First of all, current network measurement tools were developed without prior security considerations, which makes them vulnerable to external and internal attacks ranging from IP spoofing to delay and rushing attacks. Since the measurements are performed end-to-end, the end-hosts might not be able to distinguish these attacks from "authentic" measurements. These security vulnerabilities might also affect the operation of the applications that make use of 
<!-- EPO <DP n="3"/>-->
 these measurement tools, thus increasing the gain of the attacker. Some of these problems are described in detail in M.A. Kaafar, L. Mathy, C. Barakat. K. Salamatian, T. Turletti, and W. Dabbous: "Securing Internet Coordinate Embedding Systems", in Proceedings of ACM SIGCOMM, 2007, or also in G. Karame, B. Danev, C. Bannwart, and S. Capkun: "On the Security of End-to- End Measurements based on Packet-Pair Dispersions", in IEEE Transactions on Information Forensics &amp; Security (TIFS), 2013. </p><p id="p0006" num="0006">Secondly, there are no implicit trust assumptions as current network measurement tools implicitly assume that both end-hosts are honest and behave "correctly". However, in many situations, end-hosts might have considerable incentives to cheat and increase their advantage in the network (e.g., free-riding). In this regard, references made, e.g., to A. Walters, D. Zage and C. Nita-Rotaru: "A Framework for Mitigating Attacks Against Measurement-Based Adaptation Mechanisms in Unstructured Multicast Overlay Networks", in ACM/IEEE Trans, on Networking, 2007. Indeed, if the endpoints misbehave and do not obey the measurement protocol, the estimated end-to-end metric will not reflect the authentic state of the network. Given the above obstructions, it is an objective of the present invention to improve and further develop a method and a system for performing secure network measurements in such a way that the degree of security and reliability of the measurements, in particular in view of network entities tampering with the measurements, is enhanced. </p><p id="p0007" num="0007">In accordance with the invention, the aforementioned object is accomplished by a method comprising the features of claim 1. According to this claim such a method is characterized in that a path between said verifier and said prover traverses a network domain that includes at least one software defined network (SDN) controller and one or more SDN switches, wherein tampering of said network measurements by said prover is obviated by selectively influencing the probe request packets sent by said verifier and/or the probe reply packets sent by said prover by means of programmable packet forwarding rules said at least one SDN controller implements on said one or more SDN switches. 
<!-- EPO <DP n="4"/>-->
 Furthermore, the above mentioned objective is accomplished by a system comprising the features of claim 16. According to this claim such a system is characterized in that it comprises at least one software defined network (SDN) controller and one or more SDN switches located in a network domain through which traverses a path between said verifier and said prover, wherein said at least one SDN controller is configured to implement on said one or more SDN switches programmable packet forwarding rules that are designed to obviate tampering of said network measurements by said prover by selectively influencing the probe request packets sent by said verifier and/or the probe reply packets sent by said prover. </p><p id="p0008" num="0008">According to the present invention it has been recognized that a higher degree of security and reliability of the measurements can be achieved by relying on intelligence of SDN network components implemented in a network domain between the verifier and the prover. More specifically, the network measurements are conducted by making use of and with support from the smartness as provided by an SDN controller that selectively implements programmable packet forwarding rules on SDN switches within the network domain. The packet forwarding rules are designed that they selectively influence the probe request packets sent by the verifier and/or the probe reply packets sent by the prover in such a way that the prover is disabled to tamper with the measurements. This is in strong contrast to solutions according to the prevalent end-to-end principle in which network measurements are conducted without any support from the network, i.e. in scenarios in which a "naive" network just forwards probe packets in an unaware manner. </p><p id="p0009" num="0009">According to a preferred embodiment the programmable packet forwarding rules may be directed at selectively controlling the routing of the probe request packets sent by the verifier and/or the probe reply packets sent by the prover. This means that the paths the probe packets take on their way from the verifier to the prover, and reverse, may be specifically designed, for instance in such a way that the prover is not aware of the paths that are actually taken. Alternatively or additionally, the programmable packet forwarding rules may be directed at selectively controlling 
<!-- EPO <DP n="5"/>-->
 the temporal behavior of the probe request packets, for instance by artificially inserting packet delays the prover is not aware of. </p><p id="p0010" num="0010">In some embodiments of the invention the network measurements include bottleneck bandwidth estimations. In this context it may be provided that the verifier sends two equally sized probe request packets back to back to the prover and the prover echoes two equally sized probe reply packets back to the verifier, wherein the size of the probe reply packets is larger than the size of the probe request packets. Preferably, the size of the probe reply packets is chosen to be rather large (e.g., each packet having a size of 1.500 byte) in order to generate a high probability that these packets queue at the bottleneck link. </p><p id="p0011" num="0011">In accordance with a preferred embodiment the SDN controller determines the SDN switch closest to the prover and propagates a packet forwarding rule to that SDN switch, which instructs that SDN switch to queue all probe reply packets that SDN switch receives from the prover. In other words, any delay, which probe requests that are received by that configured SDN switch may have, is removed, i.e. that configured SDN switch sends out the probe packets back to back. In addition, the arrival times ti, t∑ of the two probe reply packets at that configured SDN switch may be reported to the verifier. For instance, the SDN controller may request that the configured SDN switch forwards received probe packet-pairs, along with their received timestamps, ti and t∑, to the SDN controller, which may then automatically send / and t∑ to the verifier. </p><p id="p0012" num="0012">According to a preferred embodiment it may be provided that the verifier, upon receiving the two probe reply packets from the prover, compares the observed dispersion between the two probe reply packets against the arrival times ti, 6 of the two probe reply packets at that SDN switch located closest to prover and having been programmed with the enqueue command, as described above. In case the time difference between ti and t∑ is smaller than or equals the measured dispersion, the verifier knows for sure that the bottleneck link is located somewhere within the network domain between his own location and the location of the configured SDN switch and that his measurement was correct (and has not been tampered by the 
<!-- EPO <DP n="6"/>-->
 prover). Otherwise, the verifier knows that the bottleneck link is somewhere beyond the configured SDN switch, and the verifier can at least deternnine a lower bound of the bandwidth. In order to enable the SDN controller to support the network measurements conducted by the verifier, embodiments of the invention require the cooperation of the verifier with the SDN controller. In particular it may be provided that the verifier informs the SDN controller of the prover's IP address, in order to enable the SDN controller to properly identifying the SDN switch closest to the prover and to properly configure this SDN switch with the enqueue command. </p><p id="p0013" num="0013">Preferably, in order to ensure that the prover cannot predict the probe request packets, the probe request packets may contain pseudo-randomly generated payloads. </p><p id="p0014" num="0014">In some embodiments of the invention the network measurements include RTT (Round Trip Time) measurements. In this context it may be provided that the SDN controller dynamically configures a number of random paths across that SDN switches for probe request packets issued by the verifier towards the prover. Then, the verifier may conduct independent measurements of the RTT for each configured path. The number of configured paths is chosen to be at least two, preferably three or more. In case of at least three paths and corresponding independent measurements, the verifier can apply triangulation techniques which will reveal any tampering attempts of the prover. </p><p id="p0015" num="0015">In some embodiments of the present invention, the RTT measurements as described above may be used for securing Internet coordinate systems. In such cases the probe request packets may be generated in form of ICMP (Internet Control Message Protocol) echo request packets. </p><p id="p0016" num="0016">As described above, the specific capabilities of SDN network elements - controller and switches - are used in accordance with embodiments of the present invention to provide enhanced security and reliability of network measurements. While some embodiments of the invention are described using OpenFlow controller and 
<!-- EPO <DP n="7"/>-->
 OpenFlow switches (i.e., to be more specific, SDN controller/switches using the OpenFlow protocol) as examples of SDN network elements, it will be understood that the methods of the invention may be used with any flow-based programmable controller/switch. </p><p id="p0017" num="0017">There are several ways how to design and further develop the teaching of the present invention in an advantageous way. To this end it is to be referred to the patent claims subordinate to patent claims 1 and 16 on the one hand and to the following explanation of preferred embodiments of the invention by way of example, illustrated by the drawing on the other hand. In connection with the explanation of the preferred embodiments of the invention by the aid of the drawing, generally preferred embodiments and further developments of the teaching will be explained. In the drawing </p><p id="p0018" num="0018">Fig. 1 is a schematic view illustrating an application scenario of secure bottleneck bandwidth estimation in accordance with an embodiment of the invention, and </p><p id="p0019" num="0019">Fig. 2 is a schematic view illustrating an application scenario of secure RTT measurements in accordance with an embodiment of the invention. </p><p id="p0020" num="0020">Till recently, the end-to-end principle (for reference, see J.H. Saltzer, DP. Reed and D.D. Clark: "End-to-End Arguments in System Design", in ACM Transactions on Computer Systems, 1984) has provided a justifiable rationale for moving functions closer to the end-hosts and has shaped the way the current Internet is designed. The true leverage of the end-to-end argument was implicitly a global architecture comprising a "naive" network and "smart" applications that do not require functionality from the switching elements deployed within the network. Given this, the design of network measurements tools equally adopted the end-to-end principle. </p><p id="p0021" num="0021">The present invention turns away from the end-to-end principle and proposes to perform network measurements with the help of infrastructural support from the network, thereby enhancing the security of the measurements. More specifically, the 
<!-- EPO <DP n="8"/>-->
 present invention makes use of intelligence provided by software defined networks (SDNs). These networks separate the "control plane" and the "data plane", and thus achieve a large degree of "network virtualization". OpenFlow (see for reference "OpenFlow-Enabling Innovation in your Network", available from http://www.openflow.org/) is one such protocol that enables the construction of SDNs in practice. OpenFlow is a data link layer communication protocol that enables an OpenFlow controllers configure paths, in software, through a number of OpenFlow-operated switches. Here, the controller issues routing rules to the switches using a secure control channel; the switches can then dynamically implement the requested routing rules on the data plane. </p><p id="p0022" num="0022">Hereinafter, by making references to the embodiments of the instant invention illustrated in the figures, it is shown how SDN networks, in particular OpenFlow- operated networks, can strengthen the security of bottleneck bandwidth estimation processes and of RTT measurements. In connection with the illustrated embodiments the extent to which SDNs (and OpenFlow-operated switches) can help in securing network measurements is described, thereby focusing on securing end-to-end bottleneck bandwidth estimations and on securing end-to-end RTT measurements. </p><p id="p0023" num="0023">First, the underlying system and attacker model is outlined as follows: </p><p id="p0024" num="0024">While they might be different in purpose and technique, most active end-to-end measurement tools share a similar system model consisting of a verifier and a ycvwerconnected by a network. The verifier wants to measure and verify the end-to- end performance of the path to the prover. The verifier actively generates probe packets - hereinafter denoted probe request packets - destined to the prover, who appropriately echoes back its probe packets - hereinafter denoted probe reply packets - to the verifier. The verifier then estimates the performance of the end-to- end path to the prover by extracting and analyzing the probe packets' arrival times depending on the measurement technique in question. </p><p id="p0025" num="0025">While an external attacker can spoof t IP address of the prover and issue back replies on its behalf (see, for instance, B. Harris and R. Hunt: "TCP/IP security 
<!-- EPO <DP n="9"/>-->
 threats and attack methods", in Computer Communications, 1999), untrusted provers constitute the core of the present underlying internal attacker model. Untrusted provers denote those hosts involved in the measurement process, but they are not trusted by the verifier to correctly execute the measurement steps. Untrusted provers can intentionally manipulate the sending time of their reply probes and claim a measurement value of their choice. </p><p id="p0026" num="0026">Referring now to Fig. 1 , this figure illustrates a setting where a path (as illustrated by the dashed lines) between a verifier 1 and a prover 2 traverses a network domain 3 that is governed by an SDN controller 4, operated as an OpenFlow controller 5. Also, a number of SDN switches 6, operated as OpenFlow switches 7, 8, are implemented within the network domain 3. It is further assumed that the OpenFlow controller 5 cooperates with the verifier 1 (which might be, e.g., the network operator) in order to ensure the security of the conducted measurements. </p><p id="p0027" num="0027">It will be easily appreciated by those skilled in the art that OpenFlow is only one specific protocol that may be employed and that the described embodiment may be realized with any SDN controller/switch using protocols other than OpenFlow. In any case, it is important to note that in contrast to conventional networks, software defined networks (SDN's), such as OpenFlow, along with virtualization technologies on switches, offer immense flexibility both in terms of defining and monitoring the network state. For example, within the OpenFlow paradigm, the network is completely controlled by a controller entity, i.e. the OpenFlow controller 5, which communicates with network elements that also understand the OpenFlow protocol, i.e. with the OpenFlow switches 7. The network traffic is controlled by a set of programmable traffic forwarding rules, which map incoming packets on a switch port to the outgoing switch port within an instance of a switch (either physical or virtual). Thus, the OpenFlow protocol has built-in functionality for forwarding traffic. At any given time, the controller entity in an OpenFlow network has a detailed view of the network state, which is built by exchanging control messages between the controller and various network elements, in particular OpenFlow switches. These capabilities of OpenFlow controllers/switches (or, more generally, of SDN controllers/switches) are used in accordance with embodiments of the present invention to enhance the 
<!-- EPO <DP n="10"/>-->
 security of network measurements without altering widely used network architectures or protocols. </p><p id="p0028" num="0028">Fig. 1 relates to a preferred embodiment of the invention that leverages OpenFlow and enables the secure estimation of the bottleneck bandwidth of the prover 2. It is assumed that the verifier 1 measures the bottleneck bandwidth of the path to the prover 2 using the packet-pair technique. More specifically, to measure the upload bandwidth of the path to the prover 2, the verifier 1 sends two back to back request packets of small size (e.g., 40 bytes) to the prover 2. These packets contain pseudo-randomly generated payloads in order to ensure that the prover 2 cannot predict them. Within their headers these packets encapsulate a predefined flag, e.g., in the ToS (Type of Service) field. This flag serves to announce to the OpenFlow- operated switches 7 on the path to the prover 2 that the packets correspond to bandwidth measurement packets. </p><p id="p0029" num="0029">Upon reception of these packets at the prover 2, the prover 2 sends two back to back large echo replies (e.g., of 1500 byte each) to the verifier 1. Since these probe reply packets are large in size, they are likely to queue at the bottleneck link, thus ensuring that their dispersion is inversely proportional to download bottleneck bandwidth of the path (as described in K. Lai, M. Baker: "Measuring link bandwidths using a deterministic model of packet delays", in Proceedings of ACM SIGCOMM 2000). However, generally this kind of network measurements can be severely disturbed and manipulated by the prover 2, who can artificially insert delays within the transmission of the probe reply packets in order to alter its bandwidth claims and prevent the queueing of the packets. </p><p id="p0030" num="0030">To ensure that the prover 2 does not tamper with the measurements, the verifier 1 informs the OpenFlow controller 5 about the IP address of the prover 2 (as indicated by the solid line arrow denoted "IP"). The OpenFlow controller 5 then propagates a rule to the OpenFlow switch 8 closest to the prover 2 (as indicated by the solid line arrow denoted "Enqueue Command") requesting to queue all the packets that it receives from the prover's 2 IP address, whose header contain a measurement flag. 
<!-- EPO <DP n="11"/>-->
 ln addition, the OpenFlow controller 5 requests that the selected OpenFlow switch 8 forwards the packet-pair, along with their received timestamps, ti and t∑, to the OpenFlow controller 5. The OpenFlow controller 5 automatically sends ti and t∑ to the verifier 1. </p><p id="p0031" num="0031">Let disp denote the dispersion between the packets measured by the verifier 1 , and let d= (t2 - ti). Here, two cases emerge: </p><p id="p0032" num="0032">• d &lt;= disp. In this case, the verifier 1 can be certain that the measurement is correct since the bottleneck link is located after the OpenFlow switch 8, i.e. somewhere on the path between the OpenFlow switch 8 and the verifier 1.</p><p id="p0033" num="0033">• disp &lt; d. In this case, the bottleneck link is before the OpenFlow switch 8 and the verifier 1 can at least measure (on the basis of the measured dispersion d) a lower bound on the bandwidth of the prover 2. </p><p id="p0034" num="0034">Given this, the closer (in number of hops) is the prover 2 to the network domain 3, the more accurate is the estimate acquired by the verifier 1. That is, the smaller is the number of hops that separate the prover 2 from the outermost OpenFlow switch 8, the higher is the probability that the bottleneck link is located after the OpenFlow switch 8, i.e. within the network domain 3 itself. This conforms with recent studies that show that bottleneck links typically coexist within inter-domains links (see for reference N. Hu, L.E. Li, Z.M. Mao, P. Steenkiste, and J. Wang: "A Measurement Study of Internet Bottlenecks", in Proceedings of INFOCOM, 2005). Referring now to Fig. 2, in which like reference characters generally refer to the same parts and components as in Fig. 1 , this figure illustrates an embodiment of the present invention related to securing RTT measurements. </p><p id="p0035" num="0035">In this regard it is referred to M.A. Kaafar, L. Mathy, T. Turletti, and W. Dabbous: "Virtual Networks under Attack: Disrupting Internet Coordinate Systems", in Proceedings of CoNext, 2006., in which authors propose the reliance on trusted surveyor nodes to secure Internet coordinate systems. In connection with the embodiment illustrated in Fig. 2 it is shown that SDNs can also be used to secure such Internet coordinate systems by detecting delay attacks on RTT measurements. 
<!-- EPO <DP n="12"/>-->
 In this context it is assumed that the prover 2 is interested in claiming a specific RTT distance to the verifier 1 , e.g., in order to be optimally placed in a content distribution tree. In order to detect such misbehavior on the side of the prover 2, the verifier 1 specially-crafts its probe request packets, which - in the context of Internet coordinate systems - are also known as ICMP (Internet Control Message Protocol) echo request packets. In particular, the verifier 1 ensures that the content of the ICMP echo request packets cannot be predicted (in order to prevent rushing attacks) and inserts a flag in their header field (e.g., in the ToS field). Given the IP address of both the prover 2 and the verifier 1 , the OpenFlow controller 5 then dynamically configures a random path (across the OpenFlow switches 6, 7) for the ICMP echo request packets issued by the verifier 1 along the path to the prover 2. This process is repeated for a number of independent measurements, in which the verifier 1 measures the RTT of each configured path. The different path may be created by the OpenFlow controller 5 installing dedicated routing commands within the OpenFlow switches 6, 7, for instance, by addressing certain switch ports by means of random-based modulo rules. In Fig. 2, this process is illustrated for three different paths, indicated by solid lines, dashed lines, and dotted lines. It is noted that between the last OpenFlow switches 6, 7 within network domain 3 and the prover 2, in practice, the paths will include further network elements located in other network domains, which have been omitted in Fig. 2for the sake of simplicity. </p><p id="p0036" num="0036">Since the prover 2 cannot predict the paths that the ICMP packets will follow to the verifier 1 , it is easy to see that the prover 2 cannot insert the accurate amount of delays in order to claim an RTT distance of its choice to the verifier 1 without being detected. At least when the number of paths configured by the OpenFlow controller 5 is three or more, in which case the verifier 1 may apply triangulation techniques, effectively the prover 2 will always end up claiming a number of different RTT locations. A detailed reasoning of this effect is described in S. Capkun, K.B. Rasmussen, M. Cagalj and M. Srivastava: "Secure Location Verification With Hidden and Mobile Base Stations", in IEEE Transactions on Mobile Computing, 
<!-- EPO <DP n="13"/>-->
 2008. Clearly, the bigger is the network domain 3, the larger are the amounts of OpenFlow switches 6,7, and the harder it becomes for the prover 2 to predict the path to the verifierl . Here, the prover 2 does not have to be located in the proximity of network domain 3. </p><p id="p0037" num="0037">Many modifications and other embodiments of the invention set forth herein will come to mind the one skilled in the art to which the invention pertains having the benefit of the teachings presented in the foregoing description and the associated drawings. Therefore, it is to be understood that the invention is not to be limited to the specific embodiments disclosed and that modifications and other embodiments are intended to be included within the scope of the appended claims. Although specific terms are employed herein, they are used in a generic and descriptive sense only and not for purposes of limitation. 
</p></description><claims mxw-id="PCLM70078364" ref-ucid="WO-2014128265-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="14"/>-->C l a i m s </claim-statement><claim id="clm-0001" num="1"><claim-text>1. Method of performing secure network measurements between a verifier (1 ) and a prover (2), wherein said verifier (1 ) generates probe request packets destined to said prover (2) and said prover (2) echoes its probe reply packets back to said verifier (1 ), </claim-text><claim-text>c h a r a c t e r i z e d i n that a path between said verifier (1 ) and said prover (2) traverses a network domain (3) that includes at least one software defined network (SDN) controller (4, 5) and one or more SDN switches (6, 7, 8), wherein tampering of said network measurements by said prover (2) is obviated by selectively influencing the probe request packets sent by said verifier (1 ) and/or the probe reply packets sent by said prover (2) by means of programmable packet forwarding rules said at least one SDN controller (4, 5) implements on said one or more SDN switches (6, 7, 8). </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. Method according to claim 1 , wherein said programmable packet forwarding rules are directed at selectively controlling the routing and/or the temporal behavior of the probe request packets sent by said verifier (1 ) and/or the probe reply packets sent by said prover (2). </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. Method according to claim 1 or 2, wherein said network measurements include bottleneck bandwidth estimations. </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. Method according to any of claims 1 to 3, wherein said verifier (1 ) sends two equally sized probe request packets back to back to said prover (2) and said prover</claim-text><claim-text>(2) echoes two equally sized probe reply packets back to said verifier (1 ), wherein the size of said probe reply packets is larger than the size of said probe request packets. </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. Method according to any of claims 1 to 4, wherein said SDN controller (4, 5) propagates a packet forwarding rule to the SDN switch (8) closest to said prover (2) that instructs said SDN switch (8) to queue all probe reply packets said SDN switch (8) receives from said prover (2). 
<!-- EPO <DP n="15"/>-->
</claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. Method according to claim 5, wherein the arrival times ti, 6 of the two probe reply packets at said closest SDN switch (8) are reported to said verifier (1 ). </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. Method according to claim 6, wherein said verifier (1 ), upon receiving the two probe reply packets from said prover (2), compares the observed dispersion between the two probe reply packets against the arrival times ti, 6 of the two probe reply packets at said closest SDN switch (8). </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. Method according to any of claims 1 to 7, wherein said verifier (1 ) informs said SDN controller (4, 5) of said prover's (2) IP address. </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. Method according to any of claims 1 to 8, wherein the probe request packets contain pseudo-randomly generated payloads. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. Method according to any of claims 1 to 10, wherein said network measurements include RTT (Round Trip Time) measurements. </claim-text></claim><claim id="clm-0011" num="11"><claim-text>1 1. Method according to any of claims 1 to 10, wherein said SDN controller (4, 5) dynamically configures a number of random paths across said SDN switches (6, 7) for probe request packets issued by said verifier (1 ) towards said prover (2). </claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. Method according to claim 1 1 , wherein said verifier (1 ) conducts independent measurements of the RTT for each configured path. </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. Method according to claim 1 1 or 12, wherein the number of configured paths is chosen to be at least two, preferably three or more. </claim-text></claim><claim id="clm-0014" num="14"><claim-text>14. Method according to any of claims 1 to 13, wherein the probe request packets are generated in form of ICMP (Internet Control Message Protocol) echo request packets. </claim-text></claim><claim id="clm-0015" num="15"><claim-text>15. Method according to any of claims 1 to 14, wherein said SDN controller (4, 5) and said SDN switches (6, 7) are configured to use the OpenFlow protocol. 
<!-- EPO <DP n="16"/>-->
</claim-text></claim><claim id="clm-0016" num="16"><claim-text>16. System for performing secure network measurements between a verifier (1 ) and a prover (2), wherein said verifier (1 ) is configured to generate probe request packets destined to said prover (2) and said prover (2) is configured to echo its probe reply packets back to said verifier (1 ), </claim-text><claim-text>c h a r a c t e r i z e d i n that the system comprises </claim-text><claim-text> at least one software defined network (SDN) controller (4, 5) and one or more SDN switches (6, 7, 8) located in a network domain (3) through which traverses a path between said verifier (1 ) and said prover (2), </claim-text><claim-text> wherein said at least one SDN controller (4, 5) is configured to implement on said one or more SDN switches (6, 7, 8) programmable packet forwarding rules that are designed to obviate tampering of said network measurements by said prover (2) by selectively influencing the probe request packets sent by said verifier (1 ) and/or the probe reply packets sent by said prover (2). </claim-text></claim><claim id="clm-0017" num="17"><claim-text>17. System according to claim 16, wherein said SDN controller (4, 5) and said SDN switches (6, 7, 8) are configured to use the OpenFlow protocol. 
</claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
