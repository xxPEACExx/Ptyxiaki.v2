<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2959589-A1" country="EP" doc-number="2959589" kind="A1" date="20151230" family-id="47750669" file-reference-id="303554" date-produced="20180825" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160453072" ucid="EP-2959589-A1"><document-id><country>EP</country><doc-number>2959589</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-13706236-A" is-representative="NO"><document-id mxw-id="PAPP193869112" load-source="patent-office" format="original"><country>EP</country><doc-number>13706236.0</doc-number><date>20130221</date><lang>EN</lang></document-id><document-id mxw-id="PAPP193869113" load-source="docdb" format="epo"><country>EP</country><doc-number>13706236</doc-number><kind>A</kind><date>20130221</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162033598" ucid="EP-2013053424-W" linkage-type="A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>2013053424</doc-number><kind>W</kind><date>20130221</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1988522312" load-source="docdb">H03M   3/00        20060101AFI20140905BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1937858341" load-source="docdb" scheme="CPC">H03M   3/344       20130101 LI20160518BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1937860211" load-source="docdb" scheme="CPC">H03M   3/368       20130101 LA20160518BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1976519167" load-source="docdb" scheme="CPC">H03M   3/464       20130101 FI20160204BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1976520117" load-source="docdb" scheme="CPC">H03M   3/454       20130101 LI20160205BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165550682" lang="DE" load-source="patent-office">FREQUENZSELEKTIVE SCHALTUNG ZUR KONVERTIERUNG EINES ANALOGEN EINGANGSSIGNALS IN EIN DIGITALES AUSGANGSSIGNAL</invention-title><invention-title mxw-id="PT165550683" lang="EN" load-source="patent-office">A FREQUENCY SELECTIVE CIRCUIT CONFIGURED TO CONVERT AN ANALOG INPUT SIGNAL TO A DIGITAL OUTPUT SIGNAL</invention-title><invention-title mxw-id="PT165550684" lang="FR" load-source="patent-office">CIRCUIT SÉPARATEUR DE FRÉQUENCES CONÇU POUR CONVERTIR UN SIGNAL D'ENTRÉE ANALOGIQUE EN UN SIGNAL DE SORTIE NUMÉRIQUE</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR1103311109" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ERICSSON TELEFON AB L M</last-name><address><country>SE</country></address></addressbook></applicant><applicant mxw-id="PPAR1103324372" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>TELEFONAKTIEBOLAGET L M ERICSSON (PUBL)</last-name></addressbook></applicant><applicant mxw-id="PPAR1101647173" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Telefonaktiebolaget L M Ericsson (Publ)</last-name><iid>101460901</iid><address><city>164 83 Stockholm</city><country>SE</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103305892" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>MATTISSON SVEN</last-name><address><country>SE</country></address></addressbook></inventor><inventor mxw-id="PPAR1103325909" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>MATTISSON, SVEN</last-name></addressbook></inventor><inventor mxw-id="PPAR1101641405" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>MATTISSON, SVEN</last-name><address><street>Östanväg 3</street><city>S-237 36 Bjärred</city><country>SE</country></address></addressbook></inventor><inventor mxw-id="PPAR1103321503" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>PALM MATTIAS</last-name><address><country>SE</country></address></addressbook></inventor><inventor mxw-id="PPAR1103332876" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>PALM, Mattias</last-name></addressbook></inventor><inventor mxw-id="PPAR1101641154" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>PALM, Mattias</last-name><address><street>Joachim Becks gata 22</street><city>S-233 63 Bara</city><country>SE</country></address></addressbook></inventor><inventor mxw-id="PPAR1103344380" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>ANDREANI PIETRO</last-name><address><country>SE</country></address></addressbook></inventor><inventor mxw-id="PPAR1103327671" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>ANDREANI, PIETRO</last-name></addressbook></inventor><inventor mxw-id="PPAR1101640239" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>ANDREANI, PIETRO</last-name><address><street>Nygatan 20</street><city>S-222 29 Lund</city><country>SE</country></address></addressbook></inventor><inventor mxw-id="PPAR1103304337" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>ANDERSON MARTIN</last-name><address><country>SE</country></address></addressbook></inventor><inventor mxw-id="PPAR1103304193" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>ANDERSON, MARTIN</last-name></addressbook></inventor><inventor mxw-id="PPAR1101641847" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>ANDERSON, MARTIN</last-name><address><street>Barsebäcksvägen 99</street><city>S-246 32 Löddeköpinge</city><country>SE</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR1101650258" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Ericsson</last-name><iid>101511059</iid><address><street>Patent Development Torshamnsgatan 21-23</street><city>164 80 Stockholm</city><country>SE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="EP-2013053424-W"><document-id><country>EP</country><doc-number>2013053424</doc-number><kind>W</kind><date>20130221</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2014127821-A1"><document-id><country>WO</country><doc-number>2014127821</doc-number><kind>A1</kind><date>20140828</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS660632956" load-source="docdb">AL</country><country mxw-id="DS660739149" load-source="docdb">AT</country><country mxw-id="DS660632958" load-source="docdb">BE</country><country mxw-id="DS660634263" load-source="docdb">BG</country><country mxw-id="DS660710725" load-source="docdb">CH</country><country mxw-id="DS660631971" load-source="docdb">CY</country><country mxw-id="DS660739150" load-source="docdb">CZ</country><country mxw-id="DS660632967" load-source="docdb">DE</country><country mxw-id="DS660631972" load-source="docdb">DK</country><country mxw-id="DS660631973" load-source="docdb">EE</country><country mxw-id="DS660719339" load-source="docdb">ES</country><country mxw-id="DS660634264" load-source="docdb">FI</country><country mxw-id="DS660634265" load-source="docdb">FR</country><country mxw-id="DS660632968" load-source="docdb">GB</country><country mxw-id="DS660631974" load-source="docdb">GR</country><country mxw-id="DS660632969" load-source="docdb">HR</country><country mxw-id="DS660739163" load-source="docdb">HU</country><country mxw-id="DS660710726" load-source="docdb">IE</country><country mxw-id="DS660631979" load-source="docdb">IS</country><country mxw-id="DS660634266" load-source="docdb">IT</country><country mxw-id="DS660631980" load-source="docdb">LI</country><country mxw-id="DS660791420" load-source="docdb">LT</country><country mxw-id="DS660714236" load-source="docdb">LU</country><country mxw-id="DS660791421" load-source="docdb">LV</country><country mxw-id="DS660791422" load-source="docdb">MC</country><country mxw-id="DS660714237" load-source="docdb">MK</country><country mxw-id="DS660714238" load-source="docdb">MT</country><country mxw-id="DS660719340" load-source="docdb">NL</country><country mxw-id="DS660739164" load-source="docdb">NO</country><country mxw-id="DS660714243" load-source="docdb">PL</country><country mxw-id="DS660631981" load-source="docdb">PT</country><country mxw-id="DS660719341" load-source="docdb">RO</country><country mxw-id="DS660631982" load-source="docdb">RS</country><country mxw-id="DS660714244" load-source="docdb">SE</country><country mxw-id="DS660632970" load-source="docdb">SI</country><country mxw-id="DS660739165" load-source="docdb">SK</country><country mxw-id="DS660714245" load-source="docdb">SM</country><country mxw-id="DS660710731" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA139080021" ref-ucid="WO-2014127821-A1" lang="EN" load-source="patent-office"><p num="0000">A frequency selective circuit configured to convert an analog input signal to a digital output signal comprises an analog-to-digital converter (44) to generate the digital output signal of the circuit based on an analog input signal to the analog-to-digital converter (44); a digital-to-analog converter (46, 47) to generate an analog feedback signal based on the digital output signal from the analog-to-digital converter (44), and an analog filter arranged to generate the analog input signal to the analog-to-digital converter based on the analog feedback signal and an analog input signal to the circuit. The analog filter comprises at least two integrators (41, 42) in series, each having a feedback path comprising the analog-to-digital converter (44) in cascade with a digital- to-analog converter (46, 47), so that the overall noise transfer function of the circuit has at least two zeros in addition to zeros in the noise transfer function of the analog-to-digital converter.</p></abstract><abstract mxw-id="PA139546576" ref-ucid="WO-2014127821-A1" lang="EN" source="national office" load-source="docdb"><p>A frequency selective circuit configured to convert an analog input signal to a digital output signal comprises an analog-to-digital converter (44) to generate the digital output signal of the circuit based on an analog input signal to the analog-to-digital converter (44); a digital-to-analog converter (46, 47) to generate an analog feedback signal based on the digital output signal from the analog-to-digital converter (44), and an analog filter arranged to generate the analog input signal to the analog-to-digital converter based on the analog feedback signal and an analog input signal to the circuit. The analog filter comprises at least two integrators (41, 42) in series, each having a feedback path comprising the analog-to-digital converter (44) in cascade with a digital- to-analog converter (46, 47), so that the overall noise transfer function of the circuit has at least two zeros in addition to zeros in the noise transfer function of the analog-to-digital converter.</p></abstract><abstract mxw-id="PA139080022" ref-ucid="WO-2014127821-A1" lang="FR" load-source="patent-office"><p num="0000">Un circuit séparateur de fréquences conçu pour convertir un signal d'entrée analogique en un signal de sortie numérique comprend : un convertisseur analogique-numérique (44) destiné à produire le signal de sortie numérique du circuit sur la base d'un signal d'entrée analogique dans le convertisseur analogique-numérique (44); un convertisseur numérique-analogique (46-47) destiné à produire un signal de retour analogique sur la base du signal de sortie numérique provenant du convertisseur analogique-numérique (44); et un filtre analogique conçu pour produire le signal d'entrée analogique dans le convertisseur analogique-numérique sur la base du signal de retour analogique et d'un signal d'entrée analogique dans le circuit. Le filtre analogique comprend au moins deux intégrateurs (41, 42) en série, chacun ayant un trajet de retour comprenant le convertisseur analogique-numérique (44) en cascade avec un convertisseur numérique-analogique (46-47), de sorte que la fonction de transfert de bruit globale du circuit compte au moins deux zéros de plus que les zéros de la fonction de transfert de bruit du convertisseur analogique-numérique.</p></abstract><abstract mxw-id="PA139546577" ref-ucid="WO-2014127821-A1" lang="FR" source="national office" load-source="docdb"><p>Un circuit séparateur de fréquences conçu pour convertir un signal d'entrée analogique en un signal de sortie numérique comprend : un convertisseur analogique-numérique (44) destiné à produire le signal de sortie numérique du circuit sur la base d'un signal d'entrée analogique dans le convertisseur analogique-numérique (44); un convertisseur numérique-analogique (46-47) destiné à produire un signal de retour analogique sur la base du signal de sortie numérique provenant du convertisseur analogique-numérique (44); et un filtre analogique conçu pour produire le signal d'entrée analogique dans le convertisseur analogique-numérique sur la base du signal de retour analogique et d'un signal d'entrée analogique dans le circuit. Le filtre analogique comprend au moins deux intégrateurs (41, 42) en série, chacun ayant un trajet de retour comprenant le convertisseur analogique-numérique (44) en cascade avec un convertisseur numérique-analogique (46-47), de sorte que la fonction de transfert de bruit globale du circuit compte au moins deux zéros de plus que les zéros de la fonction de transfert de bruit du convertisseur analogique-numérique.</p></abstract><description mxw-id="PDES78478152" ref-ucid="WO-2014127821-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="2"/>--><p id="p0001" num="0001"> A frequency selective circuit configured to convert an analog input signal to a digital output signal </p><p id="p0002" num="0002">Technical Field </p><p id="p0003" num="0003"> The invention relates to a frequency selective circuit configured to convert an analog input signal to a digital output signal, comprising an analog-to-digital converter, a digital-to-analog converter and an analog filter. The work leading to this invention has received funding from the European Atomic Energy Community Seventh Framework Program (FP7/2007-2013) under grant agreement n° 248277.12. </p><p id="p0004" num="0004">Background </p><p id="p0005" num="0005">In radio frequency or wireless communication systems, a radio frequency (RF) receiver is a fundamental building block. The zero- and low-IF receiver (RX) architectures dominate today's low-cost wireless receiver market. For such receivers, the wanted signal is down-converted to DC, or close to DC, by the RX mixer. Before this mixer, the only frequency selectivity provided is, typically, band selectivity via the duplexer or the RX (surface-acoustic wave, SAW) filter (for frequency-division duplex, FDD, or time-division duplex, TDD, systems, respectively). In the RX-band adjacent-channel signals and leakage from the terminal's own transmitter (TX) may be much stronger than the wanted signal. </p><p id="p0006" num="0006">These off-channel signals are typically suppressed by the channel-select filters (CSF) following the RX mixer. Up to the CSF all circuitry has to support the full dynamic range (DR) of the wanted signal and all off-channel signals, including sufficient margin to the noise and interference floor required for proper signal detection, present at the LNA input. For the low-noise amplifier (LNA) the floor is determined by the thermal noise of its input signal, and the maximum signal is limited by the supply voltage and its bias current. For subsequent stages the signal power is increased, and for power-consumption 
<!-- EPO <DP n="3"/>-->
 reasons this means some voltage gain (say 30 dB) is applied stressing the upper limit of the dynamic range as the supply voltage is (about) the same for all the circuitry. To relax the dynamic-range requirements in later stages, channel-select filtering is applied and ideally (with brick-wall filters) this would result in only the wanted signal challenging the upper limit of the dynamic range after the CSF. Today's receivers typically implement the CSF as a passive pole at the mixer output followed by an active ladder, or biquad-based, low-pass filter resulting in a finite attenuation of the off-channel signals. To keep the thermal noise low, the filter capacitors have to be relatively large (the available thermal noise voltage v<sub>n</sub> across a capacitor C is v<sub>n</sub><sup>2</sup> = kTI C , where k is Boltzmann's constant and T is the absolute temperature) and they add significantly to the circuit area, and hence cost. These capacitors also add to the power con- sumption as a high bias current is required to drive them without generating too much distortion (which results in inter-modulation noise). In a multi- standard (e.g. GSM, WCDMA and LTE) receiver the CSF response has to be optimized for each mode, either by shifting the filter poles or by switching between fixed frequency filters, otherwise adjacent-channel suppression will be effective only for the mode with the widest bandwidth. </p><p id="p0007" num="0007">After the CSF the resulting signal is digitized in an analog-to-digital converter (ADC). Because the analog CSF has limited off-channel suppression, for component tolerance and signal integrity reasons, the maximum level of the signal out of the CSF will be set by a strong off-channel signal or TX leakage. Thus, the ADC has to have a higher dynamic range than what is required by the wanted signal alone. In practice this is accomplished by letting the wanted signal stay well below the ADC clipping level (except perhaps for the case when the wanted signal is approaching its maximum signal level in which case it is at least as strong as the off channel and no extra dynamic range margin is needed). This extra dynamic range increases the complexity, size, and power consumption of the ADC. The clipping point is close to the compression point (CP<sub>;</sub>- and CP<sub>Q</sub> for input- and output-referred compression, 
<!-- EPO <DP n="4"/>-->
 respectively) which is a more convenient way to measure the maximum signal level. The CP<sub>;</sub>- (CP<sub>Q</sub>) is defined as the input (output) signal level where the gain drops by 1 dB from its small-signal value. The ADC noise floor for the wanted signal (i.e. the on-channel noise floor) is typically similar to, or lower than, the corresponding noise floor at the CSF output. ADC off-channel noise can often be ignored as it is usually not limiting the design and it can advantageously be filtered out by subsequent digital filters. </p><p id="p0008" num="0008">A very popular ADC topology is the Delta-Sigma ADC. In this topology, the input signal is fed through a filter (e.g. a set of integrators) in front of a quantizer. The quantizer output is routed to a digital-to-analog converter (DAC) who's output is subtracted from the input signal at the ADC input forming a feedback loop. </p><p id="p0009" num="0009">To increase RX integration it is desirable to combine the ADC and channel- select filters such that (some) filter integrators also may contribute in suppressing the ADC noise. Further, for multi-standard receivers it is desirable to move most of the selectivity into the digital domain where a flexible and tighter filter response can be accomplished, and an ADC with a compression point that increases with the frequency offset would enable more filtering in the digital domain. Thus, a low on-channel noise floor and high off-channel compression point are desirable features of an ADC. </p><p id="p0010" num="0010">In WO 2012/0731 17 it has been suggested that the noise contribution of the ADC can be reduced by making it a part of the CSF. They suggest to replace the feedback resistor in a low-pass Rauch filter by an ADC-DAC cascade. By feeding the ADC symbols to a feedback DAC with the proper transfer gain, which replaces the feedback resistor, the filter behavior is preserved, except for the fact that the ADC noise now occurs inside the filter feedback loop and the filter integrator gain helps suppressing this noise. The noise shaping now has a zero at the origin causing the improvement to depend on the (norma- 
<!-- EPO <DP n="5"/>-->
 lized) filter bandwidth. Thus, the input-referred noise of a wide CSF contains less ADC noise than a CSF with a cut-off at the channel bandwidth. Thus, to fully exploit the ADC noise suppression, the CSF bandwidth needs to be wide causing poor attenuation for adjacent channels. </p><p id="p0011" num="0011">In summary, the circuit of that document has replaced a resistor in the Rauch low-pass CSF with an ADC-DAC cascade and accomplished a filtering ADC. This merged CSF and ADC yields an additional single zero in the ADC noise shaping reducing the input-referred on-channel ADC noise contribution. The analog-to-digital converter can be e.g. a Delta-Sigma converter. In the document it has also been shown that higher-order noise shaping can be accomplished by increasing the order of the Delta-Sigma modulator in the ADC itself. This is, however, equivalent to improving a stand-alone ADC and does not take any benefit from the CSF. Any integrators added to the Delta-Sigma modulator do not contribute to the CSF and will, thus, just add to the circuit area (cost), power consumption and aggravate any ADC modulator stability issues. </p><p id="p0012" num="0012">Although useful improvements are demonstrated in WO 2012/0731 17, the additional noise shaping provided by the CSF is only of first order, and there is a conflict with CSF and the signal bandwidth and, thus, there is a need for further improvements. </p><p id="p0013" num="0013">Summary </p><p id="p0014" num="0014">Therefore, it is an object of embodiments of the invention to provide a frequency selective circuit, in which the shaping of ADC noise performed by the CSF can be extended to be of second or higher order. </p><p id="p0015" num="0015">According to embodiments of the invention the object is achieved in a fre- quency selective circuit configured to convert an analog input signal to a digital output signal, comprising an analog-to-digital converter configured to generate the digital output signal of the frequency selective circuit based on an analog input signal to the analog-to-digital converter; a digital-to-analog con- 
<!-- EPO <DP n="6"/>-->
 verier arranged to generate an analog feedback signal based on the digital output signal generated by the analog-to-digital converter, and an analog filter arranged to generate the analog input signal to the analog-to-digital converter based on the analog feedback signal generated by the digital-to- analog converter and an analog input signal to the frequency selective circuit. The object is achieved, when the analog filter comprises at least two integrators in series, each integrator having a feedback path comprising the analog- to-digital converter in cascade with a digital-to-analog converter, so that the overall noise transfer function of the frequency selective circuit has at least two zeros in addition to zeros in the noise transfer function of the analog-to- digital converter. </p><p id="p0016" num="0016">When the analog filter comprises two or more integrators in series and each integrator has a feedback path comprising the analog-to-digital converter in cascade with a digital-to-analog converter, the at least two additional zeros in the overall noise transfer function of the frequency selective circuit will extend the shaping of ADC noise performed by the CSF to be of second, or higher, order, which will relax the conflict between channel and CSF bandwidths as the slope of the noise shaping is much steeper. </p><p id="p0017" num="0017">In one embodiment each integrator of the analog filter provides a low pass filtering function having a cut-off frequency corresponding to a selected frequency band of the analog input signal to the frequency selective circuit. The analog-to-digital converter may then be configured to generate the digital output signal at a sampling rate that is significantly higher than the cut-off frequency of the integrators of the analog filter. When the cut-off frequency of the signal transfer function of the analog filter is a lot smaller than the sampling rate of the analog-to-digital converter, the circuit is enabled to have a pass band gain larger than unity in the analog filter without running into com- pression when receiving strong signals outside the filter pass band. </p><p id="p0018" num="0018">When the analog filter has a gain larger than unity the noise, clock jitter, and linearity requirements for the digital-to-analog converter(s) in the feedback 
<!-- EPO <DP n="7"/>-->
 path(s) are relaxed. This makes it easier to realize a large dynamic range compared to a circuit without filtering and gain. </p><p id="p0019" num="0019">In one embodiment, each integrator of the analog filter has a separate feed- back path comprising a digital-to-analog converter arranged to generate an analog feedback signal to the input of that integrator. In this way the quantization noise will be subject to second or higher order noise shaping. </p><p id="p0020" num="0020">The circuit may be configured to have a substantially flat signal transfer func- tion in the pass band of the analog filter, which allows a more accurate filter response. </p><p id="p0021" num="0021">In one embodiment, each integrator of the analog filter comprises an operational amplifier, a capacitor coupled between the output and an input of the operational amplifier and an input resistor coupled to said input of the operational amplifier. This is an RC integrator. Alternatively, the analog filter could also be implemented using a transconductor-C (Gm-C) type integrator, or other suitable active circuitry providing integrator-like properties. In one embodiment, the circuit further comprises a resistor arranged to form a resonator loop around two integrators of the analog filter. This makes it possible to optimally distribute the zeros of the noise transfer function in the pass band of the filtering circuit, so that the noise shaping from the analog filter is improved and the noise requirements of the analog-to-digital con- verier can be relaxed even more. </p><p id="p0022" num="0022">The analog-to-digital converter may in one embodiment be a quantizer. Alternatively, the analog-to-digital converter may be a Delta-Sigma converter. The Delta-Sigma converter may be a first order or a higher order Delta- Sigma converter. In the case of a Delta-Sigma converter, the analog-to-digital converter may have a discrete-time loop filter or a continuous-time loop filter. 
<!-- EPO <DP n="8"/>-->
 When the analog-to-digital converter is a Delta-Sigma converter the analog- to-digital converter may further comprise a cascade of integrators with feedforward compensation. In this way a signal transfer function of the analog-to- digital converter can be achieved that affects the signal transfer function of the frequency selective circuit as little as possible by having a flat magnitude response and minimum phase shift. </p><p id="p0023" num="0023">In case of a Delta-Sigma converter having a continuous-time loop filter, a similar effect can be achieved when a resistor is coupled in series with the capacitor coupled between the output and an input of the operational amplifier of at least one of the integrators of the analog filter or of the loop filter of the analog-to-digital converter. </p><p id="p0024" num="0024">In some embodiments, the circuit is further configured with a zero inserted in the feedback path from the digital-to-analog converter to the analog filter. An insertion of a zero in the feedback path allows frequency compensation of the effects that the transfer function of the feedback digital-to-analog converter(s) may have on the signal transfer function of the overall frequency selective circuit. The zero may be implemented by a direct path from the output of the digital-to-analog converter to the output of the analog filter. Alternatively, when the analog-to-digital converter is a Delta-Sigma converter, the zero may be implemented by modified feedback coefficients of a loop filter of the Delta-Sigma converter. Brief Description of the Drawings </p><p id="p0025" num="0025"> Embodiments of the invention will now be described more fully below with reference to the drawings, in which </p><p id="p0026" num="0026">Figure 1 shows a block diagram of a typical radio frequency transceiver; </p><p id="p0027" num="0027">Figure 2 shows a block diagram of a Delta-Sigma analog-to-digital converter; 
<!-- EPO <DP n="9"/>-->
 Figure 3 shows a simple noise model of the Delta-Sigma analog-to-digital converter of Figure 2; </p><p id="p0028" num="0028">Figure 4 shows an example of a known channel select filter, a so-called low pass Rauch filter; </p><p id="p0029" num="0029">Figure 5 shows a channel select filter, in which a feedback resistor has been replaced by an ADC-DAC cascade; Figure 6 shows an example of a Tow-Thomas biquad filter having two integrator circuits; </p><p id="p0030" num="0030">Figure 7 shows the filter of Figure 6 with ADC noise modelled as a voltage source; </p><p id="p0031" num="0031">Figure 8 shows a simplified Tow-Thomas biquad filter with alternative routings for feedback paths; </p><p id="p0032" num="0032">Figure 9 shows a Tow-Thomas biquad filter merged with an analog-to-digital converter using one common digital-to-analog converter for both feedback paths; </p><p id="p0033" num="0033">Figure 10 shows a Tow-Thomas biquad filter merged with an analog-to-digital converter using a separate digital-to-analog converter in each feedback path; </p><p id="p0034" num="0034">Figure 1 1 shows the transfer function of noise from the Delta-Sigma modulator to the filter output of Figure 9 or Figure 10; </p><p id="p0035" num="0035">Figure 12 shows an example of a third-order continuous time Delta-Sigma modulator with additional feed-forward paths; </p><p id="p0036" num="0036">Figure 13 shows a signal transfer function of a merged Delta-Sigma converter and filter; 
<!-- EPO <DP n="10"/>-->
 Figure 14 shows another way of illustrating the merging of an analog filter and an analog-to-digital filter in a frequency selective circuit; Figure 15 shows the circuit of Figure 14 when the analog-to-digital filter is a Delta-Sigma modulator; </p><p id="p0037" num="0037">Figure 16 shows an example of a third order analog filter with separate feedback DACs using a resistor forming a resonator loop around two of the inte- grators; </p><p id="p0038" num="0038">Figure 17 shows the signal-transfer-function and the noise-transfer function for a third order analog filter, with and without the resonator loop around two of the integrators; </p><p id="p0039" num="0039">Figure 18 shows a plot illustrating the effect on the signal transfer function of the frequency selective circuit caused by the transfer function of the feedback digital-to-analog converters due to sample/hold and delay; Figure 19 shows how frequency compensation of the DAC S&amp;H and DAC delay can be done by inserting a zero into the feedback path; </p><p id="p0040" num="0040">Figure 20 shows how the zero of Figure 19 can be implemented by adjusting the feedback coefficients of the analog filter and adding a direct path from the feedback DAC to the output of the analog filter; </p><p id="p0041" num="0041">Figure 21 shows how the zero of Figure 19 can be implemented by adjusting the feedback coefficients of the Delta-Sigma modulator loop filter; Figure 22 shows a plot illustrating the effect on the signal transfer function of the frequency selective circuit caused by the signal transfer function of the analog-to-digital converter; and 
<!-- EPO <DP n="11"/>-->
 Figure 23 shows an example of how the signal transfer function of the analog-to-digital converter can be implemented to minimize its effect on the signal transfer function of the frequency selective circuit. Detailed Description </p><p id="p0042" num="0042"> Figure 1 shows a block diagram of a typical RF transceiver 1 in which the invention can be used. The transceiver 1 has a receiver part and a transmitter part. Most modern transceiver solutions use direct conversion (or low IF) receiver and transmitter architectures to reduce complexity and minimize power consumption. The receiver and the transmitter use quadrature local oscillator signals. </p><p id="p0043" num="0043">An antenna 2 is connected to a transmitter/receiver switch 3. The transmitter part comprises a power amplifier 4 and a PA matching and filtering block 5, but will not be described in further detail here. </p><p id="p0044" num="0044">In the receiver part the signal from the transmitter/receiver switch 3 is fed to a duplexer or a RX filter 6, e.g. a surface-acoustic wave (SAW) filter, (for frequency-division duplex, FDD, or time-division duplex, TDD, systems, respec- tively) that provides the only frequency selectivity before the RX mixer. From the duplexer or RX filter 6 the signal is fed through a low noise amplifier 7 to RX quadrature mixers 8, 9 in which the received information is translated to baseband frequency (i.e. down-converted to DC or close to DC) by mixing the received signals with quadrature local oscillator signals. These are nor- mally generated by dividing a local oscillator signal from a local oscillator or synthesizer 10 responsible for frequency generation by a factor 2 or a higher even multiple in the divider 1 1 . The two outputs from the mixers 8, 9 are an in-phase component and a quadrature component, and they are low pass filtered in the channel select filters 12 and 13 before they are converted to digital values in the analog-to-digital converter units 14 and 15 and further processed in the baseband processing stages. 
<!-- EPO <DP n="12"/>-->
 In the RX-band, adjacent-channel signals and leakage from the terminal's own transmitter (TX) may be much stronger than the wanted signal. These off-channel signals are typically suppressed by the channel-select filters (CSF) 12, 13 following the RX mixers 8, 9. Up to the CSF all circuitry has to support the full dynamic range (DR) of the wanted signal and all off-channel signals, including sufficient margin to the noise and interference floor required for proper signal detection, present at the LNA input. For the low-noise amplifier (LNA) 7 the floor is determined by the thermal noise of its input signal, and the maximum signal is limited by the supply voltage and its bias cur- rent. For subsequent stages the signal power is increased, and for power- consumption reasons this means some voltage gain (say 30 dB) is applied stressing the upper limit of the dynamic range as the supply voltage is (about) the same for all the circuitry. The following part of the description will relate to the channel select filter 12 or 13 In combination with the analog-to-digital converters 14 or 15. </p><p id="p0045" num="0045">As illustrated in Figure 2, the analog-to-digital converter 14 (or 15) may be a Delta-Sigma ADC, which is a very popular ADC topology. In this topology, the input signal V, is fed through a filter 21 (e.g. a set of integrators) in front of the quantizer 22. The quantizer 22 only has a few output bits sampled at a rate much higher than the signal bandwidth; often the quantizer 22 is just a single bit comparator and only rarely more than four bits are used. The quantizer output So is routed to a digital-to-analog converter (DAC) 23 who's out- put is subtracted from the input signal at the ADC input in the adder 24, forming a feedback loop. The quantizer output is also the digitized output of the ADC. The Delta-Sigma ADC thus acts like a signal follower, where the digital output stream represents the input signal (e.g. voltage). To enhance the ADC resolution, the digital ADC output stream is filtered and down-sampled to provide further selectivity and increased resolution of the wanted signal. Figure 3 illustrates a simple noise model of the Delta-Sigma ADC of Figure 2. 
<!-- EPO <DP n="13"/>-->
 For in-band signals the Delta-Sigma ADC clipping occurs in the last stage (i.e. the quantizer) and results in an output sequence with mostly ones, or zeroes, for a single-bit comparator (for a multi-bit quantizer we get mostly sequences of the highest or the lowest code). </p><p id="p0046" num="0046">For off-channel signals and interference, clipping occurs progressively earlier in the signal chain as the frequency offset of the clipping signal increases (i.e. the frequency difference between the wanted and unwanted signals increases) and for very high frequency offsets it is typically the first ADC integrator that limits the signal. The first integrator is also the stage limiting the ADC lower-frequency noise floor. Hence, this stage has to be carefully designed both to handle linearity and noise which adds to its complexity. Also, the ADC on-channel noise floor has to be similar, or preferably lower, than the output on-channel noise floor of the CSF not to limit the RX sensitivity too much. </p><p id="p0047" num="0047">The Delta-Sigma ADC can be continuous or discrete time. In the former case the ADC filter is an analog continuous-time filter and sampling is done by the quantizer, and in the latter case, sampling is done before the ADC and the entire ADC is sampled, typically with switched-capacitor filters in the forward path. For noise reasons the ADC filter typically has a similar complexity as the preceding analog channel-select filter. </p><p id="p0048" num="0048">An example of a known channel select filter 12, a so-called low pass Rauch filter, is shown in Figure 4. The channel select filter 12 receives an analog input signal from a signal source l<sub>in</sub>, which here represents the output of the down converting mixer 8. The channel select filter 12 comprises a low pass filtering capacitor Ci and an integrator circuit, the latter comprising an operational amplifier 31 , a capacitor C2 and a resistor Ri. The output signal V<sub>ou</sub>t of the operational amplifier 31 is fed back to the inverting input of the operation- al amplifier 31 via the capacitor C2 and to the input terminal via the resistor Rfb. The input terminal is connected to the inverting input via the resistor Ri. The non-inverting input of the operational amplifier 31 is connected to ground. The integrator acts as a low-pass filter, and the values of the capaci- 
<!-- EPO <DP n="14"/>-->
 tor C2 and the resistor Ri are selected to provide a cut-off frequency corresponding to the bandwidth of the wanted channel. The output signal V<sub>ou</sub>t of the channel select filter 12 is connected to the analog-to-digital converter 14 as in Figure 1 . </p><p id="p0049" num="0049">To increase RX integration it is desirable to combine the ADC and channel- select filters such that (some) filter integrators also may contribute in suppressing the ADC noise. Further, for multi-standard receivers it is desirable to move most of the selectivity into the digital domain where a flexible and tigh- ter filter response can be accomplished, and an ADC with a compression point that increases with the frequency offset would enable more filtering in the digital domain. Thus, a low on-channel noise floor and high off-channel compression point are desirable features of an ADC. As mentioned above, It has been suggested in WO 2012/0731 17 that the noise contribution of the ADC can be reduced by making it a part of the CSF. They suggest to replace the feedback resistor R<sub>fb</sub> in the low-pass Rauch filter by an ADC-DAC cascade 33 comprising an analog-to-digital converter 34 and a digital-to-analog converter 35, as it is illustrated in Figure 5. In the Rauch filter, the resistor R<sub>fb</sub> senses the filter output voltage, which essentially is the same signal as the ADC output. By feeding the ADC symbols to a feedback DAC with the proper transfer gain, which replaces Rf<sub>b</sub>, the filter behavior is preserved, except for the fact that the ADC noise now occurs inside the filter feedback loop and the filter integrator gain helps suppressing this noise. The noise shaping now has a zero at the origin causing the improvement to depend on the (normalized) filter bandwidth. Thus, the input-referred noise of a wide CSF contains less ADC noise than a CSF with a cut-off at the channel bandwidth. Thus, to fully exploit the ADC noise suppression, the CSF bandwidth needs to be wide causing poor attenuation for adjacent channels. </p><p id="p0050" num="0050">In summary, the circuit of that document has replaced a resistor R<sub>fb</sub> in the Rauch low-pass CSF with an ADC-DAC cascade 33 and accomplished a 
<!-- EPO <DP n="15"/>-->
 filtering ADC. This merged CSF and ADC yields an additional single zero in the ADC noise shaping reducing the input-referred on-channel ADC noise contribution. Although useful improvements are demonstrated there is a conflict with CSF and the signal bandwidth and, thus, there is a need for further improvements. </p><p id="p0051" num="0051">It is noted that in Figure 5 the analog-to-digital converter 34 is illustrated as a simple quantizer. However, this ADC can also be e.g. a complete Delta- Sigma converter, such as the one shown in Figure 2. In the above document it has also been shown that higher-order noise shaping can be accomplished by increasing the order of the Delta-Sigma modulator in the ADC itself. This is, however, equivalent to improving a stand-alone ADC and does not take any benefit from the CSF. Any integrators added to the Delta-Sigma modulator do not contribute to the CSF and will, thus, just add to the circuit area (cost), power consumption and aggravate any ADC modulator stability issues. </p><p id="p0052" num="0052">To better understand the merged CSF-ADC noise properties we can look at Figure 3 again. Straight-forward analysis results in the following expression for the feedback-loop, or Delta-Sigma ADC, output signal. 
<img id="imgf000015_0001" he="12" wi="19" file="imgf000015_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 where s is the complex frequency and H(s) is the forward-path gain. For sim- plicity, but without loss of generality, we have used the common assumption of unity-gain feedback. </p><p id="p0053" num="0053">The first right-hand-side term in (1 ) corresponds to the signal transfer function (STF) and the second to the noise transfer function (NTF), respectively. </p><p id="p0054" num="0054">By referring the noise represented by V<sub>nq</sub> to the input of the feedback loop model we can more clearly see the effect the loop has on this noise and how it relates to the input signal . For a stand-alone ADC, V<sub>nq</sub> would typically 
<!-- EPO <DP n="16"/>-->
 represent the quantization noise but in the general case it may be any kind of noise originating after the filter (i.e. H(s)). V<sub>nq</sub> could also describe noise that is modeled as if it did originate after the filter but the noise process itself may be more complex. </p><p id="p0055" num="0055">To refer any output quantity back to the input we simply divide the output signal with the STF. Applying this to our noise model we get v <sub>s</sub>) = ^ = V<sub>i</sub> (s)<sub>+</sub> - <sub>r</sub>- v (s). (2) STF ' H{s) <sup>q</sup> </p><p id="p0056" num="0056">Thus, when H(s) is represented by an integrator (i.e. H(s)=Ms) the suppression of V<sub>nq</sub> increases when the frequency decreases. That is, the lower- frequency on-channel noise gets more suppressed than the higher-frequency off-channel noise. </p><p id="p0057" num="0057">Now this model is derived for the ADC itself, when V<sub>nq</sub> typically would represent quantization noise, but it can actually be applied equally well for the merged CSF and ADC. Thus, to increase the suppression of the ADC V<sub>nq</sub> it would be advantageous to use a filter with more than one integrator (as opposed to the Rauch filter used WO 2012/0731 17) when merging with the ADC. </p><p id="p0058" num="0058">One such filter is, for example, the Tow-Thomas biquad filter 40, which is illustrated in Figure 6, in which the filter 40 has two integrator circuits. The first integrator circuit comprises an operational amplifier 41 , a capacitor Ci and a resistor Ri. The output signal of the operational amplifier 41 is fed back to its inverting input via the capacitor Ci. The input signal to the filter is connected to the inverting input of the operational amplifier 41 via the resistor Ri. The non-inverting input of the operational amplifier 41 is connected to ground. The output signal of this first integrator circuit is connected to the input of a second integrator circuit, which similarly comprises an operational amplifier 42, a capacitor C2 and a resistor R<sub>3</sub>. The output signal of the opera- 
<!-- EPO <DP n="17"/>-->
 tional amplifier 42 is fed back to its inverting input via the capacitor C2. The signal from the first integrator circuit is connected to the inverting input of the operational amplifier 42 via the resistor R<sub>3</sub>. The non-inverting input of the operational amplifier 42 is connected to ground. The output signal of the opera- tional amplifier 42, which is also the output signal of the filter 40, can be connected to an analog-to-digital converter 14 as it was the case for the filter of Figure 4, and it is also fed back to the inverting input of the operational amplifier 41 via the resistor R<sub>2</sub> and to the inverting input of the operational amplifier 42 via the resistor R . The integrators act as a low-pass filter, and the values of the capacitors Ci and C2 and the resistors Ri and R3 are selected to provide a cut-off frequency corresponding to the bandwidth of the wanted channel. </p><p id="p0059" num="0059">When this filter is merged with an ADC, the ADC noise may be modeled via the voltage source V<sub>nq</sub> as illustrated in Figure 7. This particular filter topology has undamped integrators, relative to V<sub>nq</sub>, which will provide higher low- frequency forward-path gain and will, thus, suppress the on-channel noise more than damped ones will. A problem with the Tow-Thomas example of Figure 6 is the fact that we have two feedback paths, via R2 and R<sub>4</sub>, respectively. If we just replace one of the resistors with an ADC-DAC cascade, only the corresponding loop will benefit from noise shaping. It could be possible to replace either the feedback path via R2, the feedback path via R<sub>4</sub> or both of them. A noise model illustrating these possibilities is shown in Figure 8, which shows a simplified Tow- Thomas biquad with alternative routings for the R2 and R<sub>4</sub> feedback paths outlined. The ADC quantization noise is represented by (V<sub>nq</sub>) and DAC-based paths are shown with dashed lines and resistor ones with dash-dotted lines, respectively. </p><p id="p0060" num="0060">Straight-forward analysis of the three possible feedback element combinations, as shown in Figure 8 (i.e. with one or two feedback DACs), results in the following noise transfer functions, NTFs, where NTF<sub>R2</sub> denotes Vo/V<sub>nq</sub> 
<!-- EPO <DP n="18"/>-->
 when R<sub>2</sub> is replaced by a DAC, NTF<sub>R4</sub> denotes Vo/V<sub>nq</sub> when R is replaced by a DAC, and NTF<sub>R2</sub>,R4 denotes Vo V<sub>nq</sub> when both R<sub>2</sub> and R<sub>4</sub> are replaced by DACs. </p><p id="p0061" num="0061">1 </p><p id="p0062" num="0062"> NTF, (3) l+ H^+ H^H^) 
<img id="imgf000018_0001" he="12" wi="106" file="imgf000018_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 l + H^H^) </p><p id="p0063" num="0063"> (5) </p><p id="p0064" num="0064">When Hi(s) and H<sub>2</sub>(s) are implemented as integrators, i.e. Hi(s) and H<sub>2</sub>(s) cx i/s , then NTF<sub>R2</sub>,R4 will have a double zero at the origin, NTF<sub>R2</sub> a single, and NTF<sub>R4</sub> unity gain with a notch around the filter corner frequency, respectively. An intuitive explanation to this difference in NTFs is that each NTF is the inverse gain of the signal path from V, to the injection point of V<sub>nq</sub> with the corresponding feedback element(s) open circuited. For example, substituting R<sub>2</sub> benefits from a first-order zero only as there is just one integrator in the path from Vi to V<sub>nq</sub> (amplified by the ratioR<sub>4</sub>/Rs). Asymptotically NTF<sub>R4</sub> is unity except in the filter transition region resulting in no significant noise shaping for on-channel ADC noise. Thus it is preferable to replace both feedback paths. Thus the merging of the Tow-Thomas biquad filter with the ADC can be implemented e.g. by using one common DAC for both feedback paths (i.e, keeping the resistors) as illustrated in Figure 9, or by using a separate DAC in each feedback path as illustrated in Figure 10. In Figure 9, the output of the second integrator circuit (i.e. operational amplifier 42) is connected to an ADC-DAC cascade comprising an analog-to-digital converter 44 and a digital-to-analog converter 45, and the output of the digital-to-analog converter 45 is fed back to the inverting input of the operational amplifier 41 via the resistor R<sub>2</sub> and to the inverting input of the operational amplifier 42 via the resistor R . 
<!-- EPO <DP n="19"/>-->
 In Figure 10, the output of the second integrator circuit (i.e. operational amplifier 42) is again connected to an analog-to-digital converter 44, but the output of this analog-to-digital converter 44, which is also the output of the merged filter and ADC, is now connected to two digital-to-analog converters, of which digital-to-analog converter 46 replaces resistor R<sub>2</sub> and provides the feedback signal to the inverting input of the operational amplifier 41 , while digital-to- analog converter 47 replaces resistor R and provides the feedback signal to the inverting input of the operational amplifier 42. </p><p id="p0065" num="0065">In both Figures 9 and 10 the analog-to-digital converter 44 is shown as a Delta-Sigma converter. It is noted that the converter may be a first order or a higher order Delta-Sigma converter, and just like the circuit of Figure 5 it may also just be a quantizer. </p><p id="p0066" num="0066">Recognizing that the quantization error occurs in the quantizer, i.e. the ADC of the ADC-DAC cascade, it can be seen that by having one ADC but multiple DACs we can replace both R<sub>2</sub> and R<sub>4</sub> by DACs, see Figure 10, and the resulting quantization noise would be subject to second-order noise shaping in the Tow-Thomas example as both integrators are undamped when DACs are used instead of resistors. This is illustrated in Figure 1 1 , which shows the transfer function of noise from the Delta-Sigma modulator to the filter output of Figure 9 or Figure 10. The upper curve shows the noise transfer function for 13MHz cutoff frequency, while the lower curve shows the noise transfer function for 20MHz cutoff frequency. </p><p id="p0067" num="0067">Of course replacing a bidirectional resistor with a unidirectional DAC may cause deviations in the CSF characteristics but these are linear effects and can easily be compensated for. In this example both resistors/DACs are con- nected to virtual ground nodes so the current flow is essentially unidirectional and no compensation is required. 
<!-- EPO <DP n="20"/>-->
 We still have to compromise between the CSF and channel bandwidth but with the proposed method the NTF slope is much steeper relaxing this problem significantly, see Figure 1 1 . The filter described above is a second order filter, i.e. it comprises two integrator circuits in series, but the effect can be improved by using a filter of a higher order comprising additional integrator circuits and then using a corresponding number of feedback paths with a ADC-DAC cascade. By having multiple feedback DACs connected to the same ADC we can extend the ap- proach to other filter topologies (than the Tow-Thomas filter) with multiple feedback loops, while having only one source of quantization noise. </p><p id="p0068" num="0068">It is noted that adding the ADC inside the CSF feedback loop(s) may cause stability problems due to the finite ADC bandwidth. Provided the ADC band- width is significantly higher than the CSF bandwidth, it suffices to insert a resistor in series with one or more of the CSF integrator capacitors (here Ci and C<sub>2</sub>) generating one or more zeroes that will improve the filter phase margin, see for example R<sub>z</sub> in Figures 9 and 10. It is also possible to improve stability by shaping the ADC Delta-Sigma modulator frequency response, e.g. increasing its bandwidth by adding feed-forward paths as shown in Figure 12, which illustrates an example of a third-order continuous time Delta- Sigma modulator with additional feed-forward phase compensation paths (Rb2 and Rb3). In this case the Delta-Sigma modulator is a balanced or differential circuit. The effect of using feed-forward compensation is illustrated in Figure 13, which shows the signal transfer function STF of a merged Delta- Sigma converter and filter. The solid curve shows the STF when the feed-in path via Rb2 and Rb3 in the Delta-Sigma converter is enabled. The dashed curve shows the STF when the feed-in path via Rb2 and Rb3 in the Delta- Sigma converter is disabled. </p><p id="p0069" num="0069">The DAC(s) will also add some loop delay, similarly to the ADC, but a DAC typically has much higher intrinsic bandwidth, or less delay, than the ADC does. The DAC delay depends on the clock frequency (over-sampling ratio). 
<!-- EPO <DP n="21"/>-->
 The clocking of the ADC-DAC combination may also incur an extra delay but with a high enough clocking frequency any of the above techniques can be used to compensate for the aggregate phase-delay effect of the ADC, DAC and clocking. However, the clock frequency should be minimized to save power. Another way of DAC delay compensation is described later. Thus the analog-to-digital converter may be configured to generate the digital output signal at a sampling rate that is significantly higher than the bandwidth of the integrators of the analog filter. The problem with DAC delay is dealt with in further detail below. </p><p id="p0070" num="0070">For simplicity, but without loss of generality, single-ended filters have been used in the examples but in actual designs balanced, or differential, signals and components are probably preferable. </p><p id="p0071" num="0071">In a traditional CSF-ADC cascade ,e.g. as shown in Figure 4, the on-channel ADC noise, referred back to the CSF input, will add to the input noise of the CSF without any additional noise shaping (i.e. the ADC noise is subject to the same shaping by the CSF as the signal itself is). Typically the ADC is then designed to have the same, or lower, on-channel noise floor as the CSF in order not to degrade the overall dynamic range too much. With the ADC inside the CSF, as proposed in WO 2012/0731 17, an additional first-order (only) shaping is provided, however, resulting in a conflict between noise shaping and CSF bandwidth. With the method disclosed here we extend the first- order ADC noise shaping by the CSF to be of second, or higher, order, which will relax the conflict between channel and CSF bandwidths as the slope of the noise shaping is much steeper. </p><p id="p0072" num="0072">Thus for the same equivalent noise at the CSF input we can design the ADC with a higher noise floor, resulting in lower power consumption and smaller circuit area. For example, the ADC input integrator can employ smaller capacitors, requiring less bias current, or the ADC filter can be of lower order (lower order Delta-Sigma modulator). Alternatively, for the same power con- 
<!-- EPO <DP n="22"/>-->
 sumption we can achieve a lower overall noise floor as the ADC contribution will decrease, or a combination of higher ADC noise floor and better overall noise performance. The examples and the analyses have been done with continuous-time converters. The same principles apply in a sampled (e.g. switched capacitor) Delta-Sigma ADC as long as aliasing distortion is properly accounted for (e.g. by having a sufficiently high forward-path attenuation for signals that would fold into the wanted signal bandwidth or a high enough sampling frequency to avoid folded frequency components to compromise the wanted signal). </p><p id="p0073" num="0073">Other types of ADCs than the Delta-Sigma may also be used. Like in the discrete-time Delta-Sigma case, proper handling of aliasing may then be needed. </p><p id="p0074" num="0074">An ADC-DAC cascade as described above has a flat frequency response for typical signals of interest. By inserting a digital filter, between the ADC and any of its associated DACs, inductors, capacitors and more complex network responses can be synthesized, in addition to the resistor discussed above. Clearly this may have an impact on the loop delay as well as the required resolution of a DAC preceded by a filter. The same ADC output may be filtered (or unfiltered) in different ways to each associated DAC. </p><p id="p0075" num="0075">The exemplary CSFs have been of low-pass type. The described approach may also be extended to other well-known types of CSF, like band-pass and complex filters (with I and Q paths). </p><p id="p0076" num="0076">A number of improvements and additional features may be implemented in the circuits described above, and some of these are mentioned in the follow- ing. </p><p id="p0077" num="0077">The circuits merging an analog filter (i.e. the CSF) and an analog-to-digital converter described above can also be illustrated as in Figure 14 showing a 
<!-- EPO <DP n="23"/>-->
 frequency selective circuit, comprising an analog-to-digital converter ADC, a feedback digital-to-analog converter DAC and an analog filter l_i . The analog filter l_i could, as an example, be implemented as the second order filter shown in Figure 10. V, is the input signal to the analog filter, V<sub>x</sub> is the analog signal from the filter to the ADC, S<sub>0</sub> is the digital output signal from the circuit, which is also connected to the feedback DAC, and V<sub>0</sub>i is the analog feedback signal from the DAC to the input of the filter. </p><p id="p0078" num="0078">The transfer functions of the analog filter l_i can be written as l_i<sub>a</sub> = V<sub>x</sub> / V<sub>0</sub>i and l_i<sub>b</sub> = V<sub>x</sub> / V,. The signal transfer function (STF) and noise transfer function (NTF) of the frequency selective circuit in Figure 14 are </p><p id="p0079" num="0079">STF = Li<sub>b</sub> / (1 - Li<sub>a</sub>) </p><p id="p0080" num="0080"> NTF = 1 / (1 - Li<sub>a</sub>) </p><p id="p0081" num="0081">This frequency selective circuit is different from a regular continuous-time Delta-Sigma modulator in that the cutoff frequency (or bandwidth) of its STF (realized by Li) is a lot smaller than the sampling rate of its ADC, because, as mentioned previously, it corresponds to the bandwidth of the wanted channel. </p><p id="p0082" num="0082">A benefit of this is that the channel select filtering provided by the frequency selective circuit enables it to have a pass band gain larger than unity in its analog filter without running into compression when receiving strong signals outside the filter pass band. The fact that the filter can have large gain is an important feature, for example providing the benefit of relaxing the noise, clock jitter, and linearity requirements for the feedback DAC(s). This makes it easier to realize a large dynamic range (DR) compared to a circuit without filtering and gain. </p><p id="p0083" num="0083">Even though the analog filter poles are optimized to achieve the desired STF (instead of the optimal NTF), it still provides noise shaping of the analog noise and quantization noise injected in the ADC. 
<!-- EPO <DP n="24"/>-->
 As also disclosed already, to further reduce the quantization noise, the ADC may be a Delta-Sigma modulator, as shown in Figure 15, where the Delta- Sigma modulator comprises the filter L<sub>2</sub>, the quantizer Q and a feedback DAC designated DAC2. The transfer function of L<sub>2</sub> changes both the STF and NTF of the frequency selective circuit. While the NTF improves in the frequency band of interest, the STF is degraded by the transfer functions of DACi and STF<sub>2</sub>. These cause the STF to peak at frequencies where there are large blocking signals. Thus the signal transfer function STF and the noise transfer function NTF of the circuit can now be written as </p><p id="p0084" num="0084">STF = L<sub>1 b</sub><sup>*</sup>STF<sub>2</sub> / (1 - L<sub>1a</sub><sup>*</sup>l_DAci*STF2 </p><p id="p0085" num="0085"> NTF = 1 / (1 - L<sub>1a</sub>*L2b - L<sub>2</sub>a) </p><p id="p0086" num="0086">As mentioned above, some limitations of the circuit described in WO 2012/ 0731 17 and shown in Figure 5 are that due to the second order Rauch filter, the filter order is limited to two (no other analog filters are described), and the analog filtering part gives only a first order noise shaping of the noise from the ADC. </p><p id="p0087" num="0087">Above, frequency selective circuits are disclosed in which it is possible to increase the order of the analog filter, so that the STF of the filtering circuit has a sharper roll off outside its pass band and a higher order (better) noise shaping is provided. That improves the selectivity of the filtering circuit and relaxes the noise requirements of the ADC to a much larger extent. </p><p id="p0088" num="0088">A further improvement can be obtained by using a resonator loop inside the analog filter, which makes it possible to optimally distribute the NTF zeroes in the pass band of the filtering circuit, having the benefit of improving the noise shaping from the analog filter to relax the noise requirements of the ADC even more (without increasing the number of integrators or affecting the STF). The noise shaping provided by the analog filter l_i can be improved by the use of a resonator loop around two of the integrators, using a resistor 
<!-- EPO <DP n="25"/>-->
 (R<sub>g</sub>), as shown in Figure 1 6, which illustrates an example of a third order analog filter with separate feedback DACs. A resonator loop is formed around two of the integrators using resistor R<sub>g</sub> to be able to place the NTF zeros optimally in the pass band of the filtering circuit. By proper selection of R<sub>g</sub>, two of the NTF zeros can be moved from their original position at DC up to 
<img id="imgf000025_0001" he="6" wi="44" file="imgf000025_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 where R<sub>C</sub>2 is the resistor connected between the second and third integrator, C2 is the integrator capacitor of integrator 2, and C3 is the integrator capacitor of integrator 3. Figure 1 7 shows the STF and NTF with and without the resonator loop implemented by R<sub>g</sub> for a third order analog filter having 4.5 MHz cutoff frequency. It can be clearly seen that moving the NTF zeros to about 90% of the cutoff frequency improves the high frequency attenuation pro- vided by the integrators of the analog filter. The optimal location of the NTF zeros is the one minimizing the noise contributed by the Delta-Sigma modulator and therefore varies depending on the input noise spectrum of the Delta-Sigma modulator. In some embodiments, further improvements of the circuit may be implemented as described below. </p><p id="p0089" num="0089">A problem of the frequency selective circuits presented above can be that the signal transfer function of the overall filter is affected by the transfer function LDACI of the feedback DACs (due to sample/hold (S&amp;H) and delay), and the signal transfer function STF<sub>2</sub> of the Delta-Sigma modulator. The signal transfer function of the frequency selective circuit shown in Figure 1 5 is: </p><p id="p0090" num="0090">STF = L<sub>1 b</sub>*STF<sub>2</sub> / (1 - L<sub>1 a</sub>*LDAci*STF<sub>2</sub>) </p><p id="p0091" num="0091">As shown below, using a regular second order Delta-Sigma modulator with a continuous-time cascade-of-integrator with feedback (CIFB) loop filter may have a large impact on the STF of the filtering circuit. This STF can be very 
<!-- EPO <DP n="26"/>-->
 different from the desired one, if L<sub>D</sub>ACI and STF<sub>2</sub> have a magnitude response different from unity, and give phase shift of the signal. Thus, if not properly designed or compensated, these might degrade the filter attenuation, and affect the stability of the overall frequency selective circuit. One way to get around these problems could be to increase the ADC clock frequency relative to the cutoff frequency of the analog filter, but this increases the power consumption. </p><p id="p0092" num="0092">Regarding the DAC transfer function, it is noted that the frequency domain transfer function of DACi is the cascade of a S&amp;H L<sub>S</sub>H(S) = (1 -e<sup>"sT</sup>) / (sT) and a delay L<sub>de</sub>ia<sub>y</sub>(s) = e<sup>"sT</sup>, which gives L<sub>D</sub>ACI(S) = (1 -e<sup>"sT</sup>) / (sT) * e<sup>"sT</sup> </p><p id="p0093" num="0093">The sampling operation can be approximated by a first order Pade approximation LSH(S) « (2/T) / (s + 2/T) or a second order Pade approximation L<sub>S</sub>H(S) * (12/T<sup>2</sup>) / (s<sup>2</sup> + 6s/T + 12/T<sup>2</sup>). </p><p id="p0094" num="0094">The frequency domain transfer function for the DAC delay, e<sup>"sTd</sup>, can also be modeled by a second order Pade approximation L<sub>de</sub>ia<sub>y</sub>(s) « (1 - sT<sub>d</sub>/2 + s<sup>2</sup>T<sub>d</sub><sup>2</sup>/8) / (1 + sT<sub>d</sub>/2 + s<sup>2</sup>T<sub>d</sub><sup>2</sup>/8). </p><p id="p0095" num="0095">Inserting the two second order approximations into the analytical expression for the signal transfer function (STF) and noise transfer function (NTF) of a frequency selective circuit with a third order analog filter, DAC delay of T<sub>d</sub> = 0.5/fcik, and ADC clock rate of f<sub>c</sub>ik = 1 /T = 32*f<sub>BW</sub>) it can be seen that the filter attenuation is degraded by 3 dB, see Figure 18. For lower clock frequencies it will be worse. Figure 18 is a plot showing the effect on the STF of the frequency selective circuit having a third order analog filter, half a clock cycle DAC delay, and oversampling ratio of 16. In this case, the deviation is about 3-4 dB. The dashed line shows the ideal STF, and the solid line the actual transfer function of the filtering circuit. </p><p id="p0096" num="0096">To get an accurate filter transfer function without increasing the clock frequency, it is advantageous to make a frequency compensation of the DAC 
<!-- EPO <DP n="27"/>-->
 effects (S&amp;H and delay). The frequency compensation of the DAC S&amp;H and DAC delay can be done by inserting a zero into the feedback path, as shown in Figure 19 that illustrates the filtering circuit with a zero implemented in series with the feedback path of the analog filter to compensate for the S&amp;H and delay transfer functions. Fortunately, the zero does not have to be implemented as a separate circuit, but can be implemented by adjusting the feedback coefficients of the analog filter properly, and adding a direct path from Vo<sub>l</sub> to V<sub>x</sub> (i.e. the output of the analog filter) as shown in Figure 20. In the case of a Delta-Sigma ADC the loop filter L<sub>2</sub> of the Delta-Sigma already provides a feedback path from S<sub>0</sub> to the summing node of the first integrator of L<sub>2</sub>. Therefore, the direct path of Figure 20 can instead be implemented by properly modifying the feedback coefficients of the Delta- Sigma modulator loop filter L<sub>2</sub>. Thereby, as shown in Figure 21 no additional circuits are needed to implement the zero. Note that the transfer functions l_i<sub>a</sub> and l_2a were however modified to l_i<sub>a</sub>' and L<sub>2a</sub>'. </p><p id="p0097" num="0097">Using a zero in the feedback path of the analog filter compensates the effect of S&amp;H and delay in DACi, and creates an accurate STF for the filtering cir- cuit. Using this idea, it is possible to reduce the clock frequency without reducing the dynamic range. This was not previously possible. </p><p id="p0098" num="0098">As mentioned above, also the signal transfer function STF<sub>2</sub> of the ADC is important for the overall STF of the filtering circuit. Realizing the ADC with a standard second order continuous-time Delta-Sigma modulator, the overall loop gain order of the filtering circuit increases (by 2) and therefore the order of the STF of the filtering circuit also increases (by 2), which moves the system poles out of their wanted positions, see Figure 22 showing the effect on the STF of the frequency selective circuit when realizing the ADC using a regular second order Delta-Sigma modulator with CT (CIFB) loop filter. This results in reduced filter attenuation in the adjacent channels and potential stability problems. 
<!-- EPO <DP n="28"/>-->
 To get an accurate filter transfer function without increasing the clock frequency, it is advantageous to design the loop filter L<sub>2</sub> of the Delta-Sigma modulator so that its signal-transfer function STF<sub>2</sub> has a flat magnitude response and minimum phase shift (STF<sub>2</sub>(s) = 1 from DC to sufficiently high frequencies). The signal transfer function of the Delta-Sigma modulator can be improved in different ways, by proper design of L<sub>2</sub>, depending on whether a continuous-time (CT) or a discrete-time (DT) modulator is chosen. The preferred Delta-Sigma loop filter topology L<sub>2</sub> is a bit different depending on whether it is a DT or a CT modulator. In both cases the goal is to achieve an STF<sub>2</sub> which affects the STF of the filtering circuit as little as possible by having a flat magnitude response and minimum phase shift. </p><p id="p0099" num="0099">If the Delta Sigma modulator uses a DT loop filter, STF<sub>2</sub> can be made identical to 1 if L<sub>2</sub> is on the form being shown in Figure 23, in which STF<sub>2</sub> = 1 be- low the Nyquist frequency, and the noise transfer function of the Delta-Sigma modulator is NTF<sub>2</sub> = 1 / (1 +L). L might be of any order giving any order noise shaping without affecting STF<sub>2</sub>. This allows the desired STF = l_i<sub>b</sub> / (1 -Li<sub>a</sub>) to be realized. The loop filter L<sub>2</sub> can be implemented in at least two ways, i.e. either by the use of a cascade of integrators with feed forward compensation (CIFF), or by the use of a cascade of integrators with feedback compensation (CIFB). The principles are not limited to any specific loop filter order. </p><p id="p0100" num="0100">In the case of a CT Delta Sigma modulator, the magnitude and phase cannot be equal to 1 arbitrarily high in frequency, since a CT Delta Sigma modulator always has inherent anti-alias filtering. However, its frequency response (STF<sub>2</sub>) can be improved e.g. by using one of the methods described below. </p><p id="p0101" num="0101">One way of improving the frequency response of the CT Delta Sigma modulator is to use feed forward paths as it is illustrated with resistors Rb<sub>2</sub> and Rb3 in Figure 12 that shows an example of a third-order continuous time Delta-Sigma modulator with additional feed-forward phase compensation paths (R<sub>b2</sub> and R<sub>b3</sub>). 
<!-- EPO <DP n="29"/>-->
 Another way of improving the frequency response of the CT Delta Sigma modulator is to implement a zero using a resistor connected in series with the feedback capacitors of the integrators (see Rz of Figures 9 and 10). This resistor may be placed either in the analog filter or in the loop filter of the Delta- Sigma modulator, or even both if more than one zero is desired. </p><p id="p0102" num="0102">By realizing the loop filter L<sub>2</sub> of the Delta-Sigma modulator as described above it is possible to have high order L<sub>2</sub> (good noise shaping) without degrading the desired filter attenuation. It is also likely to improve the stability. This was not previously possible. </p><p id="p0103" num="0103">Although various embodiments of the present invention have been described and shown, the invention is not restricted thereto, but may also be embodied in other ways within the scope of the subject-matter defined in the following claims. 
</p></description><claims mxw-id="PCLM70078437" ref-ucid="WO-2014127821-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="30"/>-->C l a i m s </claim-statement><claim id="clm-0001" num="1"><claim-text>1. A frequency selective circuit configured to convert an analog input signal to a digital output signal, comprising: </claim-text><claim-text> • an analog-to-digital converter (44) configured to generate the digital output signal of the frequency selective circuit based on an analog input signal to the analog-to-digital converter (44); </claim-text><claim-text> • a digital-to-analog converter (45; 46, 47) arranged to generate an analog feedback signal based on the digital output signal generated by the analog-to-digital converter (44), and </claim-text><claim-text> • an analog filter arranged to generate the analog input signal to the analog-to-digital converter (44) based on the analog feedback signal generated by the digital-to-analog converter (45; 46, 47) and an analog input signal to the frequency selective circuit, </claim-text><claim-text>c h a r a c t e r i z e d in that the analog filter comprises at least two integrators (41, 42) in series, each integrator having a feedback path comprising the analog-to-digital converter (44) in cascade with a digital-to- analog converter (45; 46, 47), so that the overall noise transfer function of the frequency selective circuit has at least two zeros in addition to zeros in the noise transfer function of the analog-to-digital converter (44). </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. A circuit according to claim 1, c h a r a c t e r i z e d in that each integrator (41, 42) of the analog filter provides a low pass filtering func- tion having a cut-off frequency corresponding to a selected frequency band of the analog input signal to the frequency selective circuit. </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. A circuit according to claim 2, c h a r a c t e r i z e d in that the analog-to-digital converter (44) is configured to generate the digital output signal at a sampling rate that is significantly higher than the cut-off frequency of the integrators of the analog filter. 
<!-- EPO <DP n="31"/>-->
</claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. A circuit according to any one of claims 1 to 3, c h a r a c t e r i z e d in that the analog filter has a gain larger than unity. </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. A circuit according to any one of claims 1 to4, c h a r a c t e r - i z e d in that each integrator (41 , 42) of the analog filter has a separate feedback path comprising a digital-to-analog converter (46, 47) arranged to generate an analog feedback signal to the input of that integrator. </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. A circuit according to any one of claims 1 to 5, c h a r a c t e r - i z e d in that the circuit is configured to have a substantially flat signal transfer function in the pass band of the analog filter. </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. A circuit according to any one of claims 1 to 6, c h a r a c t e r i z e d in that each integrator of the analog filter comprises an opera- tional amplifier (41, 42), a capacitor (Ci, C<sub>2</sub>) coupled between the output and an input of the operational amplifier (41, 42) and an input resistor (Ri, R<sub>3</sub>) coupled to said input of the operational amplifier. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. A circuit according to any one of claims 1 to 7, c h a r a c t e r - i z e d in that the circuit further comprises a resistor (R<sub>g</sub>) arranged to form a resonator loop around two integrators of the analog filter. </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. A circuit according to any one of claims 1 to 8 c h a r a c t e r i z e d in that the analog-to-digital converter is a quantizer. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. A circuit according to any one of claims 1 to8, c h a r a c t e r i z e d in that the analog-to-digital converter is a Delta-Sigma converter (44). </claim-text></claim><claim id="clm-0011" num="11"><claim-text>11. A circuit according to claim 10, c h a r a c t e r i z e d in that the analog-to-digital converter is a higher order Delta-Sigma converter (44). 
<!-- EPO <DP n="32"/>-->
</claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. A circuit according to claim 10 or 11, c h a r a c t e r i z e d in that the analog-to-digital converter (44) has a discrete-time loop filter. </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. A circuit according to claim 10 or 11, c h a r a c t e r i z e d in that the analog-to-digital converter (44) has a continuous-time loop filter. </claim-text></claim><claim id="clm-0014" num="14"><claim-text>14. A circuit according to any one of claims 10 to 13, c h a r a c t e r i z e d in that the analog-to-digital converter (44) comprises a cascade of integrators with feedforward compensation. </claim-text></claim><claim id="clm-0015" num="15"><claim-text>15. A circuit according to claim 13, c h a r a c t e r i z e d in that a resistor (R<sub>z</sub>) is coupled in series with the capacitor (C<sub>2</sub>) coupled between the output and an input of the operational amplifier (42) of at least one of the integrators of the analog filter or of the loop filter of the analog-to-digital con- verier. </claim-text></claim><claim id="clm-0016" num="16"><claim-text>16. A circuit according to any one of claims 1 to 15, c h a r a c t e r i z e d in that the circuit is further configured with a zero inserted in the feedback path from the digital-to-analog converter to the analog filter. </claim-text></claim><claim id="clm-0017" num="17"><claim-text>17. A circuit according to claim 16, c h a r a c t e r i z e d in that the zero is implemented by modifying the feedback coefficients of the analog filter and introducing a direct path from the output of the digital-to-analog converter to the output of the analog filter. </claim-text></claim><claim id="clm-0018" num="18"><claim-text>18. A circuit according to claim 16, c h a r a c t e r i z e d in that the analog-to-digital converter is a Delta-Sigma converter and that the zero is implemented by modified feedback coefficients of both the analog filter and the Delta-Sigma converter. 
</claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
