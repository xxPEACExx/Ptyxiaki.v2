<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2958494-A1" country="EP" doc-number="2958494" kind="A1" date="20151230" family-id="50159317" file-reference-id="296092" date-produced="20180822" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="160453690" ucid="EP-2958494-A1"><document-id><country>EP</country><doc-number>2958494</doc-number><kind>A1</kind><date>20151230</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-14706342-A" is-representative="NO"><document-id mxw-id="PAPP193870348" load-source="patent-office" format="original"><country>EP</country><doc-number>14706342.4</doc-number><date>20140211</date><lang>EN</lang></document-id><document-id mxw-id="PAPP193870349" load-source="docdb" format="epo"><country>EP</country><doc-number>14706342</doc-number><kind>A</kind><date>20140211</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC162035005" ucid="IB-2014058895-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>IB</country><doc-number>2014058895</doc-number><kind>W</kind><date>20140211</date></document-id></priority-claim><priority-claim mxw-id="PPC162034306" ucid="US-201361767300-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201361767300</doc-number><kind>P</kind><date>20130221</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1988523100" load-source="docdb">A61B   6/00        20060101ALI20140911BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988523980" load-source="docdb">G06T  11/00        20060101ALI20140911BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1988526838" load-source="docdb">A61B   6/03        20060101AFI20140911BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1984697133" load-source="docdb" scheme="CPC">G06T   5/002       20130101 FI20151231BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984697459" load-source="docdb" scheme="CPC">A61B   6/032       20130101 LI20160106BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984697536" load-source="docdb" scheme="CPC">A61B   6/5258      20130101 LI20160106BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984697893" load-source="docdb" scheme="CPC">G06K   9/468       20130101 LI20151231BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984699845" load-source="docdb" scheme="CPC">A61B   6/482       20130101 LI20160106BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984700112" load-source="docdb" scheme="CPC">G06T   7/0014      20130101 LI20151231BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984702703" load-source="docdb" scheme="CPC">G06K   9/52        20130101 LI20151231BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984704026" load-source="docdb" scheme="CPC">G06K   9/46        20130101 LI20151231BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984705475" load-source="docdb" scheme="CPC">G06K2009/4666      20130101 LA20151231BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1984705565" load-source="docdb" scheme="CPC">G06T2207/10081     20130101 LA20151231BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987764845" load-source="docdb" scheme="CPC">G06T2211/408       20130101 LA20150522BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987775860" load-source="docdb" scheme="CPC">G06T  11/005       20130101 LI20150522BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987797080" load-source="docdb" scheme="CPC">A61B   6/5205      20130101 LI20140721BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT165552536" lang="DE" load-source="patent-office">STRUKTURAUSBREITUNGSWIEDERHERSTELLUNG FÜR SPEKTRAL-CT</invention-title><invention-title mxw-id="PT165552537" lang="EN" load-source="patent-office">STRUCTURE PROPAGATION RESTORATION FOR SPECTRAL CT</invention-title><invention-title mxw-id="PT165552538" lang="FR" load-source="patent-office">RECONSTITUTION DE LA PROPAGATION DANS UNE STRUCTURE POUR UNE CT SPECTRALE</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR1103309804" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>KONINKL PHILIPS NV</last-name><address><country>NL</country></address></addressbook></applicant><applicant mxw-id="PPAR1103309595" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>KONINKLIJKE PHILIPS N.V.</last-name></addressbook></applicant><applicant mxw-id="PPAR1101646428" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Koninklijke Philips N.V.</last-name><iid>101391185</iid><address><street>High Tech Campus 5</street><city>5656 AE Eindhoven</city><country>NL</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR1103332429" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>GOSHEN LIRAN</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR1103331782" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>GOSHEN, LIRAN</last-name></addressbook></inventor><inventor mxw-id="PPAR1101641492" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>GOSHEN, LIRAN</last-name><address><street>c/o High Tech Campus Building 5</street><city>NL-5656 AE Eindhoven</city><country>NL</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR1101642721" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Steffen, Thomas</last-name><iid>101483638</iid><address><street>Philips International B.V. Intellectual Property &amp; Standards High Tech Campus 5</street><city>5656 AE Eindhoven</city><country>NL</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="IB-2014058895-W"><document-id><country>IB</country><doc-number>2014058895</doc-number><kind>W</kind><date>20140211</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2014128595-A1"><document-id><country>WO</country><doc-number>2014128595</doc-number><kind>A1</kind><date>20140828</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS660732519" load-source="docdb">AL</country><country mxw-id="DS660756813" load-source="docdb">AT</country><country mxw-id="DS660732521" load-source="docdb">BE</country><country mxw-id="DS660794517" load-source="docdb">BG</country><country mxw-id="DS660640308" load-source="docdb">CH</country><country mxw-id="DS660722153" load-source="docdb">CY</country><country mxw-id="DS660756814" load-source="docdb">CZ</country><country mxw-id="DS660732522" load-source="docdb">DE</country><country mxw-id="DS660722154" load-source="docdb">DK</country><country mxw-id="DS660722159" load-source="docdb">EE</country><country mxw-id="DS660641680" load-source="docdb">ES</country><country mxw-id="DS660794518" load-source="docdb">FI</country><country mxw-id="DS660645065" load-source="docdb">FR</country><country mxw-id="DS660732523" load-source="docdb">GB</country><country mxw-id="DS660722160" load-source="docdb">GR</country><country mxw-id="DS660732524" load-source="docdb">HR</country><country mxw-id="DS660756819" load-source="docdb">HU</country><country mxw-id="DS660640309" load-source="docdb">IE</country><country mxw-id="DS660722161" load-source="docdb">IS</country><country mxw-id="DS660645066" load-source="docdb">IT</country><country mxw-id="DS660722162" load-source="docdb">LI</country><country mxw-id="DS660794519" load-source="docdb">LT</country><country mxw-id="DS660723296" load-source="docdb">LU</country><country mxw-id="DS660794520" load-source="docdb">LV</country><country mxw-id="DS660794521" load-source="docdb">MC</country><country mxw-id="DS660723297" load-source="docdb">MK</country><country mxw-id="DS660723298" load-source="docdb">MT</country><country mxw-id="DS660723303" load-source="docdb">NL</country><country mxw-id="DS660756820" load-source="docdb">NO</country><country mxw-id="DS660723304" load-source="docdb">PL</country><country mxw-id="DS660722323" load-source="docdb">PT</country><country mxw-id="DS660641681" load-source="docdb">RO</country><country mxw-id="DS660722324" load-source="docdb">RS</country><country mxw-id="DS660723305" load-source="docdb">SE</country><country mxw-id="DS660732526" load-source="docdb">SI</country><country mxw-id="DS660756821" load-source="docdb">SK</country><country mxw-id="DS660723306" load-source="docdb">SM</country><country mxw-id="DS660640310" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA139077596" ref-ucid="WO-2014128595-A1" lang="EN" load-source="patent-office"><p num="0000">A method includes obtaining at least one of projection data from a spectral scan or image data generated from the projection data, selecting a local reference dataset from the at least one of the projection data or the image data, determining a noise pattern for the selected reference dataset, estimating underlying local structure from the reference dataset based on the noise pattern, and restoring at least one of the projection data or the image data based on the estimated underlying local structure.</p></abstract><abstract mxw-id="PA139544332" ref-ucid="WO-2014128595-A1" lang="EN" source="national office" load-source="docdb"><p>A method includes obtaining at least one of projection data from a spectral scan or image data generated from the projection data, selecting a local reference dataset from the at least one of the projection data or the image data, determining a noise pattern for the selected reference dataset, estimating underlying local structure from the reference dataset based on the noise pattern, and restoring at least one of the projection data or the image data based on the estimated underlying local structure.</p></abstract><abstract mxw-id="PA139077597" ref-ucid="WO-2014128595-A1" lang="FR" load-source="patent-office"><p num="0000">Dans la présente invention, un procédé consiste à obtenir des données de projection issues d'un balayage spectral et/ou des données image générées à partir des données de projection, à sélectionner un ensemble de données de référence local parmi les données de projection et/ou les données image, à déterminer un motif de bruit pour l'ensemble de données de référence sélectionné, à évaluer une structure locale sous-jacente à partir de l'ensemble de données de référence et sur la base du motif de bruit, et à reconstituer les données de projection et/ou les données image en fonction de la structure locale sous-jacente évaluée.</p></abstract><abstract mxw-id="PA139544333" ref-ucid="WO-2014128595-A1" lang="FR" source="national office" load-source="docdb"><p>Dans la présente invention, un procédé consiste à obtenir des données de projection issues d'un balayage spectral et/ou des données image générées à partir des données de projection, à sélectionner un ensemble de données de référence local parmi les données de projection et/ou les données image, à déterminer un motif de bruit pour l'ensemble de données de référence sélectionné, à évaluer une structure locale sous-jacente à partir de l'ensemble de données de référence et sur la base du motif de bruit, et à reconstituer les données de projection et/ou les données image en fonction de la structure locale sous-jacente évaluée.</p></abstract><description mxw-id="PDES78477433" ref-ucid="WO-2014128595-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="2"/>--><p id="p0001" num="0001"> STRUCTURE PROPAGATION RESTORATION FOR SPECTRAL CT </p><p id="p0002" num="0002">The following generally relates to spectral projection data and/or spectral image data processing and more particularly to structure propagation restoration for spectral projection data and/or spectral image data, and is described with particular application to computed tomography (CT). However, the following is also amenable to other imaging modalities. </p><p id="p0003" num="0003"> Spectral (or multi-energy) CT has utilized two attenuation values (e.g., with dual energy CT) acquired simultaneously at two different photon energies to solve the photoelectric and Compton contribution that consists of the mass attenuation coefficients of a scanned material and then identify an unknown material by its value of photoelectric and Compton contribution. This approach is well-suited with materials such as iodine that have a k-edge energy close to a mean value of a diagnostic energy range. Because any two linearly independent sums of two basis functions span the entire attenuation coefficient space, any material can be represented by a linear combination of two other materials, generally referred to as basis materials, such as water and iodine. </p><p id="p0004" num="0004"> The basis material images provide new applications such as monochromatic image, material cancellation image, effective atomic number image and electron density image. With the recent technical advances there are several approaches to perform dual energy CT acquisition such as dual-source, fast kVp switching, and dual-layer detector configuration. In addition, quantitative imaging is one of the current major trends in the medical imaging community. Spectral CT supports this trend, as the additional spectral information improves the quantitative information that can be measured about the scanned object and its material composition. </p><p id="p0005" num="0005"> Dual energy material decomposition is a mathematical scheme to extract beam-hardening free line integrals representing two basis materials, i.e. the photoelectric absorption and Compton scattering within the scanned object. However, spectral CT suffers from an inherently noise challenge, especially in scenarios in which a material decomposition is conducted. As the material decomposition is an ill-posed problem, the decomposition amplifies the noise significantly, where the obtained noise is highly anti-correlated between the materials. Unfortunately, if images are directly reconstructed from the material line 
<!-- EPO <DP n="3"/>-->
 integrals, the images are very noisy. As a result, the obtained image quality is low, which may reduce the clinical value of the image. </p><p id="p0006" num="0006"> Aspects described herein address the above-referenced problems and others.</p><p id="p0007" num="0007">The following describes an approach that improves spectral CT image quality using a restoration algorithm that removes noise and/or artifacts from an imaging study (i.e., the projection data and/or the image data), while preserving the underlying object structure and spectral information. The algorithm can be applied in the projection domain, the image domain, or in both the projection and the image domains. Generally, a reference dataset, i.e., images or sinograms, is derived from the projection or image data of a spectral scan and used, in connection with a determined noise pattern, to estimate underlying local object structures, which are also utilized as additional constraints. The estimate and, optionally, the additional constraints provide a robust and quality restoration that removes noise and/or artifacts. </p><p id="p0008" num="0008"> In one aspect, a method includes obtaining at least one of projection data from a spectral scan or image data generated from the projection data, selecting a local reference dataset from the at least one of the projection data or the image data, determining a noise pattern for the selected reference dataset, estimating underlying local structure from the reference dataset based on the noise pattern, and restoring at least one of the projection data or the image data based on the estimated underlying local structure. </p><p id="p0009" num="0009"> In another aspect, a projection data and/or image data processor includes a memory that stores a structure propagation algorithm and a processor that executes the structure propagation algorithm in connection with at least one of projection data or image data from a spectral scan to remove at least one of noise or artifacts from the at least one of projection data or the image data, while preserving underlying object structure and spectral information. </p><p id="p0010" num="0010"> In another aspect, a computer readable storage medium is encoded with computer readable instructions. The computer readable instructions, when executed by a processer, causes the processor to: obtain at least one of projection data from a spectral scan or image data generated based on the projection data, select a local reference dataset from the at least one of the projection data or the image data, determine a noise pattern for the selected reference dataset, estimate underlying local structure from the reference dataset based on the noise pattern, and restore at least one of projection data or image data based on the estimated underlying local structure. </p><p id="p0011" num="0011"> The invention may take form in various components and arrangements of components, and in various steps and arrangements of steps. The drawings are only for 
<!-- EPO <DP n="4"/>-->
 purposes of illustrating the preferred embodiments and are not to be construed as limiting the invention. </p><p id="p0012" num="0012"> FIGURE 1 schematically illustrates an example imaging system in connection with a projection data and/or image data processor employing a structure propagation restoration algorithm. </p><p id="p0013" num="0013"> FIGURE 2 schematically illustrates example models of the structure propagation restoration algorithm. </p><p id="p0014" num="0014"> FIGURE 3 illustrates a prior art image reconstructed from first projection data. FIGURE 4 illustrates a restored image, using the structure propagation restoration approach described herein in connection with the first projection data. </p><p id="p0015" num="0015"> FIGURE 5 illustrates a prior art image reconstructed from second projection data. </p><p id="p0016" num="0016"> FIGURE 6 illustrates a restored image, using the structure propagation restoration approach described herein in connection with the second projection data. </p><p id="p0017" num="0017"> FIGURE 7 illustrates a prior art image reconstructed from third projection data. </p><p id="p0018" num="0018"> FIGURE 8 illustrates a restored image, using the structure propagation restoration approach described herein in connection with the third projection data. </p><p id="p0019" num="0019"> FIGURE 9 illustrates an example method for processing projection data and/or image data. </p><p id="p0020" num="0020"> The following describes an approach that improves spectral CT image quality using a restoration algorithm that removes noise and/or artifacts from projection data and/or image data of a spectral imaging study, while preserving underlying object structure and spectral information. </p><p id="p0021" num="0021"> Initially referring to FIGURE 1, a spectral imaging system 100 such as a spectral computed tomography (CT) scanner is illustrated. The illustrated spectral imaging system 100 utilizes kVp switching, as discussed in greater detail below, to produce spectral projection data. The spectral imaging system 100 includes a generally stationary gantry 102 and a rotating gantry 104, which is rotatably supported by the stationary gantry 102 and rotates around an examination region 106 about a z-axis. </p><p id="p0022" num="0022"> A radiation source 108, such as an x-ray tube, is rotatably supported by the rotating gantry 104, rotates with the rotating gantry 104, and emits radiation that traverses the examination region 106. A radiation source voltage controller 110 controls a mean or peak emission voltage of the radiation source 108. In one instance, this includes switching the 
<!-- EPO <DP n="5"/>-->
 emission voltage between two or more emission voltages (e.g., 80 keV and 140 keV, 100 keV and 120 keV, etc.) between views of a scan, within a view of a scan, and/or otherwise. </p><p id="p0023" num="0023"> A detector array 112 subtends an angular arc opposite the examination region 106 relative to the radiation source 108. The detector array 112 detects radiation that traverses the examination region 106 and generates projection data indicative thereof. Where the scan is a multiple energy scan and the radiation source voltage is switched between at least two emission voltages for the scan, the detector array 112 generates projection data (also referred herein as a sinogram) for each of the radiation source voltages. </p><p id="p0024" num="0024"> Again, the illustrated spectral imaging system 100 utilizes kVp switching. In a variation, the spectral imaging system 100 includes at least two radiation sources 108 that emit radiation at two different emission voltages to produce spectral projection data and/or the detector array 112 includes an energy-resolving detector that produces spectral projection data. In still another variation, the spectral imaging system 100 includes a combination of the above and/or other approach to produce spectral projection data. </p><p id="p0025" num="0025"> A reconstructor 114 reconstructs the spectral projection data, generating volumetric image data indicative of a scanned portion of a subject or object located in the examination region 106. This includes reconstructing spectral image data at one or more emission voltages and/or conventional (non-spectral) image data over the entire emission spectrum. A couch or subject support 116 supports a subject or object in the examination region 106. </p><p id="p0026" num="0026"> An operator console 118 includes a human readable output device such as a monitor and an input device such as a keyboard, mouse, etc. Software resident on the console 118 allows the operator to interact with and/or operate the spectral imaging system 100 via a graphical user interface (GUI) or otherwise. This may include selecting a multi- energy spectral imaging protocol in which the emission voltage is switched between two or more emission voltages. </p><p id="p0027" num="0027"> A projection data and/or image data processor 120 includes at least one microprocessor 122 that executes at least one computer readable instruction stored in computer readable storage medium, such as physical memory 124 or other non-transitory storage medium. The microprocessor 122 may also executes one or more computer readable instructions carried by a carrier wave, a signal or other transitory medium. The projection data and/or image data processor 120 can be part of the console 118 and/or other computing system. 
<!-- EPO <DP n="6"/>-->
 The at least one computer readable instruction includes a structure propagation restoration instruction(s) 126, which can be applied to spectral projection data (or the spectral domain) and/or reconstructed image data (or the image domain). Where the structure propagation restoration instruction(s) 126 is applied to both, it is first applied to the spectral projection data, generating restored projection data, which is then reconstructed to generate image data, and then the structure propagation restoration instruction(s) 126 is applied to the reconstructed image data. </p><p id="p0028" num="0028"> As described in greater detail below, executing the structure propagation restoration instruction(s) 126 includes selecting a reference projection and/or image dataset from input projection data and/or image data, determining a noise model therefrom, estimating underlying local object structure from the reference dataset based on the noise model, and propagating the estimated underlying local object structure through the input projection data and/or image data, restoring the projection and/image data. </p><p id="p0029" num="0029"> Optionally, the estimated underlying local object structure can be used as a constraint on the restoration. Furthermore, some of the removed texture and/or noise can be added back. It is to be appreciated that the structure propagation restoration instruction(s) 126 improves image quality of the spectral data through removing noise and/or artifacts, while preserving the underlying object structure and spectral information. </p><p id="p0030" num="0030"> The restored projection data and/or the restored image data can be further processed, displayed via a display monitor, filmed, archived in a data repository (e.g., a picture archiving and communication system or PACS, an electronic medical record or EMR, a radiology information system or RIS, a hospital information system or HIS, etc.), and/or otherwise utilized. </p><p id="p0031" num="0031"> FIGURE 2 schematically illustrates example modules 200 of the structure propagation restoration instruction(s) 126. </p><p id="p0032" num="0032"> A reference structure selector 202 selects a local reference dataset from input projection and/or image data, which can be generated by the imaging system 100 (FIGURE 1) and/or other system. The criterion for the reference dataset selection includes reference data in which underlying local object structures can be derived or estimated from. </p><p id="p0033" num="0033"> Examples of suitable references image data include, but are not limited to: a specific monochromatic image (e.g., 70keV) since the noise is anti-correlated between the materials and there is a specific monochromatic image in which the contrast to noise ratio (CNR) is optimal; a non-spectral (or conventional) CT image, a combined spectral / nonspectral image such as a non-spectral CT image based on all of the energies or the whole 
<!-- EPO <DP n="7"/>-->
 spectrum, which may allow for extracting structure more accurately; a low energy image and/or a high energy image based only on partial spectrum, and/or other reference image. </p><p id="p0034" num="0034"> Examples of suitable references projection data include, but are not limited to: a specific monochromatic sinogram (e.g., 70keV) since the noise is anti -correlated between the materials and a non-spectral (or conventional) CT sinogram, a combined spectral / nonspectral sinogram such as a non-spectral CT sinogram based on all of the energies or the whole spectrum without material decomposition; a low energy sinogram and/or a high energy sinogram based only on partial spectrum without material decomposition, and/or other reference projection data. </p><p id="p0035" num="0035"> In one instance, a global approach is utilized to select the reference data. For this approach, a single reference dataset can be selected for the entire received projection and/or image data. The selection can be based on one or more of the following criteria: a minimum total variation; a minimum entropy; a minimum median over a local standard deviation of the image / sinogram; a minimum average of local noise estimate; a CNR image based on input of two ROFs, etc. An example for total variation selection criterion among monochromatic images is shown in EQUATION 1 : </p><p id="p0036" num="0036">EQUATION 1 : </p><p id="p0037" num="0037"> e = argmin VR ^idj, </p><p id="p0038" num="0038"> e ■ ■ </p><p id="p0039" num="0039"> ' where e is the monochromatic energy and R<sup>*</sup>■ is the ij pixel in the reference image R. </p><p id="p0040" num="0040"> In another instance, a local approach is utilized to select the reference data. For this approach, for each pixel, an optimal reference dataset patch (or sub-set of projection and/or image data) is selected. The patch can be selected around a location of the pixel from one of the potential reference datasets. This approach utilizes the fact that different regions in the input projection and/or image data might have a different optimal reference dataset for local structure derivation. </p><p id="p0041" num="0041"> A noise modeler 204 models a noise pattern of the selected reference dataset. Examples of suitable modeling approaches includes, but is not limited to, a Monte Carlo estimate, analytics, direct extraction and/or other approaches. The obtained noise pattern or model is utilized to estimate the local structures reference dataset. An example analytical approach is described in Wunderlich, "Image Covariance and Lesion Detectability in Direct Fan-Beam X-Ray Computed Tomography", Phys. Med. Biol. 53 (2008), 2472 - 2493. 
<!-- EPO <DP n="8"/>-->
 Examples of direct extraction approaches are described in application serial number 61/264,340, filed November 25, 2009, and entitled "ENHANCED IMAGE </p><p id="p0042" num="0042">DATA/DOSE REDUCTION," which is incorporated herein by reference in its entirety, and application serial number 61/286,477, filed December 15, 2009, and entitled "ENHANCED IMAGE DATA/DOSE REDUCTION," which is incorporated herein by reference in its entirety. Other approaches are also contemplated herein. </p><p id="p0043" num="0043"> A restorer 206 restores the projection data and/or image data. The illustrated restorer 206 includes a structure deriver 208 and a structure propagator 210. </p><p id="p0044" num="0044"> The structure deriver 208 estimates the underlying local structure from the reference dataset. The estimate may improve the local CNR of the reference dataset, which facilitates estimating the dataset structures and enables a very accurate structure estimate. The structure deriver 208 utilizes the noise model generated by the noise modeler 204 as a guide, which facilitates differentiation between the noise and the underlying object structures. </p><p id="p0045" num="0045"> For the estimate, the structure deriver 208 may utilize various algorithms such as bilateral filtering, diffusion filtering, total variation de-noising, mean shifting, etc. By way of non-limiting example, the following describes an approach using a bilateral algorithm to estimate the local structures. This example includes an optional spike noise suppression. </p><p id="p0046" num="0046"> For each voxel R<sub>t</sub> . <sub>k</sub> in the reference dataset, R, the structure deriver 208 performs the following: </p><p id="p0047" num="0047"> 1. Extract a sub-volume of n voxels around voxel R<sub>l</sub> . . <sub>k</sub> ; </p><p id="p0048" num="0048">2. Calculate a kernel based on EQUATION 2: </p><p id="p0049" num="0049">E UATION 2: 
<img id="imgf000008_0001" he="16" wi="65" file="imgf000008_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 where a is a parameter that controls a aggressiveness of the weights and σ Noise is a local noise level estimate of R, estimated in the above-discussed noise modeling; 
<!-- EPO <DP n="9"/>-->
 3. Multiply a local kernel by a spatial kernel: w<sub>v</sub>
<img id="imgf000009_0001" he="7" wi="46" file="imgf000009_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0050" num="0050"> where a three dimensional (3D) spatial Gaussian kernel with standard deviation can be determined based on EQUATION 3 : </p><p id="p0051" num="0051"><img id="imgf000009_0002" he="15" wi="84" file="imgf000009_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 where dx is a size of a pixel (e.g., in millimeters or mm), dz is a slice width (e.g., in mm), and &lt;J<sub>spatial</sub> is a parameter that controls an aggressiveness of the weights; </p><p id="p0052" num="0052"> 4. Normalize w<sub>r</sub> , <sub>k</sub>, to have sum equal to one; </p><p id="p0053" num="0053">5. Apply spike noise suppression as follows: if a central weight w^ ^ &gt; </p><p id="p0054" num="0054">^ Threshold <sup>an</sup>d <sup>α &lt; a</sup>ma¾ then a = a * <sub>u</sub>it and return to step 2; and </p><p id="p0055" num="0055"> 6. Estimate the object structure based on EQUATION 4: </p><p id="p0056" num="0056">EQUATION 4: </p><p id="p0057" num="0057"><img id="imgf000009_0003" he="23" wi="63" file="imgf000009_0003.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/></p><p id="p0058" num="0058">The structure propagator 210 propagates the estimated structure to the input projection data and/or image data and, optionally, the estimate is utilized as additional constraints of the restoration. Some of the removed texture and/or noise can be added back during restoration. This may facilitate controlling final image appearance. </p><p id="p0059" num="0059"> For this, the structure propagator 210 derives the local structures according to the output of the structure deriver 208, and the noise level is defined according to the output of the noise modeler 204. A strength of this approach is that it utilizes a very well defined local structure with improved local CNR. Since the processing is done over the projection data and/or image data, the intensity values of the projection data and/or image data are preserved very accurately. 
<!-- EPO <DP n="10"/>-->
 By way of non-limiting example, in one instance, the structure propagator 210 performs N iterations of the following for each voxel V<sub>i ] k</sub> in the projection data and/or image data: </p><p id="p0060" num="0060"> 1. Extract a sub-volume of n voxels around the voxel V<sub>j j k</sub> ; </p><p id="p0061" num="0061">2. Calculate a local kernel w™"<sup>g</sup><sub>k</sub>, based on EQUATION 4: </p><p id="p0062" num="0062">EQUATION 4 
<img id="imgf000010_0001" he="16" wi="72" file="imgf000010_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 where β is an input parameter; </p><p id="p0063" num="0063"> 3. Multiply the local kernel by spatial kernel =
<img id="imgf000010_0002" he="7" wi="36" file="imgf000010_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0064" num="0064"> 4. Normalize w<sub>r</sub> , <sub>k</sub>, to have sum equal to one; and </p><p id="p0065" num="0065"> 5. Process the projection data and/image data as shown in EQUATION 5: </p><p id="p0066" num="0066">EQUATION 5: </p><p id="p0067" num="0067"> n n n </p><p id="p0068" num="0068"> ∑∑ Y v<sup>Iter</sup>-<sup>1</sup> w , <sub>k</sub>, </p><p id="p0069" num="0069"> -ylter _ i'=-n ]'=-n k'=-n </p><p id="p0070" num="0070"> i j k n n n </p><p id="p0071" num="0071"> ∑∑∑<sup>w</sup>w </p><p id="p0072" num="0072">where V <sup>ter</sup> = V is the input target dataset and Iter is an index of a current i,j,k i,j,k </p><p id="p0073" num="0073"> iteration. </p><p id="p0074" num="0074"> In step 5, some of the image texture and/or noise can be added back to the target dataset to control its final appearance. There are two optional sources for the texture and/or noise: the reference projection data and/or image data or the target projection data and/or image data. </p><p id="p0075" num="0075"> The final restoration is obtained as shown in EQUATION 6 or EQUATION 7: </p><p id="p0076" num="0076">EQUATION 6: </p><p id="p0077" num="0077"> -y Final lter -N lter-N ^</p><p id="p0078" num="0078"><img id="imgf000010_0003" he="8" wi="18" file="imgf000010_0003.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/><!-- EPO <DP n="11"/>-->
 Or </p><p id="p0079" num="0079">EQUATION 7: 
<img id="imgf000011_0001" he="8" wi="58" file="imgf000011_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 where δ is an input parameter. </p><p id="p0080" num="0080"> FIGURES 3-8 show example results of the restoration in connection with images generated without the restoration. </p><p id="p0081" num="0081"> For a first set of projection data and/or image data, FIGURE 3 represents a prior art image 300 where the structure propagation restoration instruction(s) 126 was not utilized, and FIGURE 4 represents an image 400 where the structure propagation restoration instruction(s) 126 was utilized. As shown, a region 402 is less noisey than a corresponding region 302, without visible loss of structure in the image 400. </p><p id="p0082" num="0082"> For a second set of projection data and/or image data, FIGURE 5 represents a prior art image 500 where the structure propagation restoration instruction(s) 126 was not utilized, and FIGURE 6 represents an image 600 where the structure propagation restoration instruction(s) 126 was utilized. As shown, a region 602 is less noisey than a corresponding region 502, without visible loss of structure in the image 600. </p><p id="p0083" num="0083"> For a third set of projection data and/or image data, FIGURE 7 represents a prior art image 700 where the structure propagation restoration instruction(s) 126 was not utilized, and FIGURE 8 represents an image 800 where the structure propagation restoration instruction(s) 126 was utilized. As shown, a region 802 is less noisey than a corresponding region 702, without visible loss of structure in the image 800. </p><p id="p0084" num="0084"> FIGURE 9 illustrates an example method in accordance with the disclosure herein. </p><p id="p0085" num="0085"> It is to be appreciated that the ordering of the acts is not limiting. As such, other orderings are contemplated herein. In addition, one or more acts may be omitted and/or one or more additional acts may be included. </p><p id="p0086" num="0086"> At 902, input projection data and/or image data are obtained. </p><p id="p0087" num="0087"> At 904, a local reference dataset is selected from the projection data and/or the image data. </p><p id="p0088" num="0088"> At 906, a noise model for the selected reference dataset is determined. 
<!-- EPO <DP n="12"/>-->
 At 908, underlying local structure from the reference dataset is estimated based on the noise model. </p><p id="p0089" num="0089"> At 910, the estimated structure is propagated to the projection data and/or image data, restoring the projection data and/or image data. </p><p id="p0090" num="0090"> At 912, the restored projection data and/or the restore image data can be further processed, displayed via a display monitor, filmed, archived in a data repository, and/or otherwise utilized. </p><p id="p0091" num="0091"> The above may be implemented by way of computer readable instructions, encoded or embedded on computer readable storage medium, which, when executed by a computer processor(s), cause the processor(s) to carry out the described acts. Additionally or alternatively, at least one of the computer readable instructions is carried by a signal, carrier wave or other transitory medium. </p><p id="p0092" num="0092"> The invention has been described with reference to the preferred embodiments. Modifications and alterations may occur to others upon reading and understanding the preceding detailed description. It is intended that the invention be constructed as including all such modifications and alterations insofar as they come within the scope of the appended claims or the equivalents thereof. 
</p></description><claims mxw-id="PCLM70077705" ref-ucid="WO-2014128595-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="13"/>-->CLAIMS: </claim-statement><claim id="clm-0001" num="1"><claim-text> 1. A method, comprising: </claim-text><claim-text> obtaining at least one of projection data from a spectral scan or image data generated from the projection data; </claim-text><claim-text> selecting a local reference dataset from the at least one of the projection data or the image data; </claim-text><claim-text> determining a noise pattern for the selected reference dataset; estimating underlying local structure from the reference dataset based on the noise pattern; and </claim-text><claim-text> restoring at least one of the projection data or the image data based on the estimated underlying local structure. </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. The method of claim 1, further comprising: </claim-text><claim-text> utilizing the estimated underlying local structure as a constraints on the restoration. </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. The method of any of claims 1 to 2, further comprising: </claim-text><claim-text> adding a sub-portion of at least one of removed texture or noise back to the restored projection data or image data. </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. The method of any of claims 1 to 3, wherein the local reference dataset is selected from only the projection data. </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. The method of any of claims 1 to 3, wherein the local reference dataset is selected from only the image data. </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. The method of any of claims 1 to 3, wherein the local reference dataset is selected from the projection data and the projection data is restored, and further comprising: </claim-text><claim-text> selecting a second local reference dataset from the restored projection data; determining a second noise pattern for the second selected reference dataset; estimating a second underlying local structure from the second reference dataset based on the second noise pattern; and </claim-text><claim-text> restoring the image data based on the estimated second underlying local structure. 
<!-- EPO <DP n="14"/>-->
</claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. The method of any of claims 1 to 6, wherein the local reference dataset includes one of a specific monochromatic image, a non-spectral image, a combined spectral / non-spectral image, a low energy image or a high energy image. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. The method of any of claims 1 to 7, wherein the local reference dataset includes one of a specific monochromatic sinogram, a non-spectral sinogram, a combined sinogram / non-spectral sinogram, a low energy sinogram or a high energy sinogram. </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. The method of any of claims 1 to 8, further comprising: </claim-text><claim-text> selecting the local reference dataset based on a global approach in which a single reference dataset is selected for the entire at least one of the projection image or image data. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. The method of claim 9, wherein the selection is based on one or more of: a minimum total variation; a minimum entropy; a minimum median over a local standard deviation; a minimum average of local noise estimate; and a contrast to noise ratio image based on input of two regions of interest. </claim-text></claim><claim id="clm-0011" num="11"><claim-text>11. The method of any of claims 1 to 8, further comprising: </claim-text><claim-text> selecting the local reference dataset based on a local approach in which, for each pixel, an optimal reference dataset patch is selected. </claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. The method of any of claims 1 to 11, wherein the noise pattern is based on one or more of a Monte Carlo estimate, analytics, or direct extraction. </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. The method of any of claims 1 to 12, further comprising: </claim-text><claim-text> estimating the underlying local structure from the reference dataset based on the noise pattern by extracting a sub-volume of voxels around a voxel, calculating a local kernel, multiplying the local kernel by a spatial kernel, normalizing the product to a sum equal to one, applying spike noise suppression, and estimating the structure. </claim-text></claim><claim id="clm-0014" num="14"><claim-text>14. The method of any of claims 1 to 12, further comprising: </claim-text><claim-text> restoring the at least one of the projection data or image data, for one or more 
<!-- EPO <DP n="15"/>-->
 iterations of each voxel, by extracting a sub-volume of voxels around the voxel, calculating a local kernel, multiplying the local kernel by a spatial kernel, normalizing the product to a sum equal to one; and restoring each voxel. </claim-text></claim><claim id="clm-0015" num="15"><claim-text>15. A projection data and/or image data processor (120), comprising: </claim-text><claim-text> a memory (124) that stores a structure propagation algorithm; and a microprocessor (122) that executes the structure propagation algorithm in connection with at least one of projection data or image data from a spectral scan to remove at least one of noise or artifacts from the at least one of projection data or the image data, while preserving underlying object structure and spectral information. </claim-text></claim><claim id="clm-0016" num="16"><claim-text>16. The projection data and/or image data processor of claim 15, wherein the microprocessor selects a local reference dataset from the at least one of the projection data or the image data, determines a noise pattern for the selected reference dataset, estimates underlying local structure from the reference dataset based on the noise pattern, and restores at least one of projection data or image data based on the estimated underlying local structure. </claim-text></claim><claim id="clm-0017" num="17"><claim-text>17. The projection data and/or image data processor of any of claims 15 to 16, wherein the microprocessor estimates the underlying local structure from the reference dataset based on the noise pattern by extracting a sub-volume of voxels around a voxel, calculating a local kernel, multiplying the local kernel by a spatial kernel, normalizing the product to have sum equal to one, applying spike noise suppression, and estimating the structure. </claim-text></claim><claim id="clm-0018" num="18"><claim-text>18. The projection data and/or image data processor of any of claims 15 to 16, wherein the microprocessor restores the at least one of the projection data or image data includes, for one or more iterations of each voxel, by extracting a sub-volume of voxels around the voxel, calculating a local kernel, multiplying the local kernel by a spatial kernel, normalizing the product to have sum equal to one; and restoring each voxel. </claim-text></claim><claim id="clm-0019" num="19"><claim-text>19. The projection data and/or image data processor of any of claims 15 to 18, wherein the restored at least one of the projection or image data is further processed, displayed, filmed, or archived. 
<!-- EPO <DP n="16"/>-->
</claim-text></claim><claim id="clm-0020" num="20"><claim-text>20. A computer readable storage medium encoded with computer readable instructions, which, when executed by a processer, causes the processor to: </claim-text><claim-text> obtain at least one of projection data from a spectral scan or image data generated based on the projection data; </claim-text><claim-text> select a local reference dataset from the at least one of the projection data or the image data; </claim-text><claim-text> determine a noise pattern for the selected reference dataset; estimate underlying local structure from the reference dataset based on the noise pattern; and </claim-text><claim-text> restore at least one of projection data or image data based on the estimated underlying local structure. 
</claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
