<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2262166-B1" country="EP" doc-number="2262166" kind="B1" date="20140108" family-id="40005970" file-reference-id="318266" date-produced="20180825" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146587973" ucid="EP-2262166-B1"><document-id><country>EP</country><doc-number>2262166</doc-number><kind>B1</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-09731694-A" is-representative="YES"><document-id mxw-id="PAPP154850165" load-source="docdb" format="epo"><country>EP</country><doc-number>09731694</doc-number><kind>A</kind><date>20090417</date><lang>ZH</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140554413" ucid="CN-200810104360-A" load-source="docdb"><document-id format="epo"><country>CN</country><doc-number>200810104360</doc-number><kind>A</kind><date>20080417</date></document-id></priority-claim><priority-claim mxw-id="PPC140548397" ucid="CN-2009071339-W" load-source="docdb"><document-id format="epo"><country>CN</country><doc-number>2009071339</doc-number><kind>W</kind><date>20090417</date></document-id></priority-claim></priority-claims><dates-of-public-availability><intention-to-grant-date><date>20130806</date></intention-to-grant-date><search-report-dispatch-date><date>20110516</date></search-report-dispatch-date></dates-of-public-availability><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1989324396" load-source="ipcr">H04L  12/14        20060101AFI20091105BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL1989627176" load-source="docdb" scheme="CPC">H04L  12/14        20130101 FI20130101BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989635881" load-source="docdb" scheme="CPC">H04L  12/1457      20130101 LI20130101BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132368552" lang="DE" load-source="patent-office">Verfahren, System und Vorrichtung zur Ausführung eines kombinierten Vergebührungsdienstes</invention-title><invention-title mxw-id="PT132368553" lang="EN" load-source="patent-office">Method, system and apparatus for realizing combined charging service</invention-title><invention-title mxw-id="PT132368554" lang="FR" load-source="patent-office">Procédé, système et appareil pour fournir un service de facturation combiné</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR919509537" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>HUAWEI TECH CO LTD</last-name><address><country>CN</country></address></addressbook></applicant><applicant mxw-id="PPAR919528937" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>HUAWEI TECHNOLOGIES CO., LTD.</last-name></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919509121" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>SHENG JINWEN</last-name><address><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR919525301" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>SHENG, JINWEN</last-name></addressbook></inventor><inventor mxw-id="PPAR919020920" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>SHENG, Jinwen c/o Huawei Technologies Co., Ltd. Int.Prop.Dept.</last-name><address><street>B1-3A, Bantian, Longgang District 518129</street><city>Shenzhen</city><country>CN</country></address></addressbook></inventor></inventors><assignees><assignee mxw-id="PPAR919020919" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Huawei Technologies Co., Ltd.</last-name><iid>100970540</iid><address><street>Huawei Administration Building Bantian</street><city>Longgang District, Shenzhen Guangdong 518129</city><country>CN</country></address></addressbook></assignee></assignees><agents><agent mxw-id="PPAR919020921" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Kreuz, Georg Maria</last-name><suffix>et al</suffix><iid>101240797</iid><address><street>Huawei Technologies Duesseldorf GmbH Dessauerstrasse 3</street><city>80992 München</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="CN-2009071339-W"><document-id><country>CN</country><doc-number>2009071339</doc-number><kind>W</kind><date>20090417</date><lang>ZH</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2009127162-A1"><document-id><country>WO</country><doc-number>2009127162</doc-number><kind>A1</kind><date>20091022</date><lang>ZH</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS549780800" load-source="docdb">AT</country><country mxw-id="DS549922108" load-source="docdb">BE</country><country mxw-id="DS549887389" load-source="docdb">BG</country><country mxw-id="DS549868192" load-source="docdb">CH</country><country mxw-id="DS549796221" load-source="docdb">CY</country><country mxw-id="DS549796222" load-source="docdb">CZ</country><country mxw-id="DS549870188" load-source="docdb">DE</country><country mxw-id="DS549922109" load-source="docdb">DK</country><country mxw-id="DS549922110" load-source="docdb">EE</country><country mxw-id="DS549865791" load-source="docdb">ES</country><country mxw-id="DS549887466" load-source="docdb">FI</country><country mxw-id="DS549887467" load-source="docdb">FR</country><country mxw-id="DS549870189" load-source="docdb">GB</country><country mxw-id="DS549922111" load-source="docdb">GR</country><country mxw-id="DS549870194" load-source="docdb">HR</country><country mxw-id="DS549796223" load-source="docdb">HU</country><country mxw-id="DS549868193" load-source="docdb">IE</country><country mxw-id="DS549922112" load-source="docdb">IS</country><country mxw-id="DS549887468" load-source="docdb">IT</country><country mxw-id="DS549922113" load-source="docdb">LI</country><country mxw-id="DS549870195" load-source="docdb">LT</country><country mxw-id="DS549780805" load-source="docdb">LU</country><country mxw-id="DS549887469" load-source="docdb">LV</country><country mxw-id="DS549870196" load-source="docdb">MC</country><country mxw-id="DS549780806" load-source="docdb">MK</country><country mxw-id="DS549780807" load-source="docdb">MT</country><country mxw-id="DS549780808" load-source="docdb">NL</country><country mxw-id="DS549868198" load-source="docdb">NO</country><country mxw-id="DS549780817" load-source="docdb">PL</country><country mxw-id="DS549865792" load-source="docdb">PT</country><country mxw-id="DS549779977" load-source="docdb">RO</country><country mxw-id="DS549780818" load-source="docdb">SE</country><country mxw-id="DS549870197" load-source="docdb">SI</country><country mxw-id="DS549868199" load-source="docdb">SK</country><country mxw-id="DS549922114" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data></bibliographic-data><description mxw-id="PDES63960403" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><b>FIELD OF THE TECHNOLOGY</b></heading><p id="p0001" num="0001">The present invention relates to the field of telecommunications technologies, and more particularly to a method, a system, and an apparatus for realizing a composite charging service.</p><heading id="h0002"><b>BACKGROUND OF THE INVENTION</b></heading><p id="p0002" num="0002">Service combination is one of the hot spots in the current IT industry. Due to the limit of existing technologies, the service combination remains on the level of the combination of services having "small granularity" or the combination of services having low complexity, that is, the effect and possibility of the service combination largely depend on the "granularity" of the composite services, and only the sufficiently detailed and service-oriented components, or services without association can be well combined. It is of no doubt that the application scope of the service combination is limited, and the costs required by the service combination are also increased.</p><p id="p0003" num="0003">For example, in the field of telecommunications services, a "charging process" is an event that is usually coupled. Under the conditions of the conventional technology, when it is necessary to combine features of multiple services to provide a new service, a method that new features are directly added to the original services is adopted. In the "close coupling" processing mode, the original services need to be directly modified each time, and the services cannot be reused.</p><p id="p0004" num="0004">In addition, in the conventional technology, the service combination may also be realized based on workflows, and specifically, two existing services are combined through a workflow system to provide a new service. Since charging feature coupling is carried out between the two existing services, it is necessary to split the existing services into at least three services, so as to separate the coupled charging service as an independent service. Finally, the three separated services are combined through the workflows to provide a brand-new composite service, and to solve the problem of charging coupling. The above<!-- EPO <DP n="2"> --> solution is intended to realize the service combination based on "small granularity" through workflows and provide a new service. However, in the solution, the existing services need to be modified greatly, and at least the charging service in the original services needs to be separated.</p><p id="p0005" num="0005">United States Patent Application <patcit id="pcit0001" dnum="US20040117311A"><text>20040117311</text></patcit> discloses an apparatus, methods and computer programs for metering and accounting for services accessed over a network. The method comprises the following steps: a requested composite service invoking a set of component services as required to satisfy the request, and recording identifiers of the set of invocations; each invoked component service returning to its requester composite service measured service usage data corresponding to the invocation from the requester composite service, together with the respective invocation identifier; the requester composite service correlating the measured service usage data received from its respective set of component services by reference to the set of invocation identifiers, and outputting the correlated measured usage data.</p><heading id="h0003"><b>SUMMARY OF THE INVENTION</b></heading><p id="p0006" num="0006">The present invention is directed to a method, a system, and an apparatus for realizing a composite charging service, which are capable of realizing the composite charging service in a simple and convenient manner without modifying each base service.</p><p id="p0007" num="0007">An embodiment of the invention provides a method for realizing a composite charging service according to claim 1.</p><p id="p0008" num="0008">An embodiment of the invention provides a charging control apparatus for realizing a composite charging service according to claim 8.</p><p id="p0009" num="0009">An embodiment of the invention provides a system for realizing a composite charging service according to claim 9.</p><p id="p0010" num="0010">An embodiment of the invention provides service composition engine for realizing a composite charging service according to claim 10.</p><p id="p0011" num="0011">It may be known from the technical solutions of the present invention that, according to the present invention, the charging request information from the base service is received, the service coordination process is performed on the received charging request information<!-- EPO <DP n="3"> --> from the base service according to the charging features of each base service, so as to regenerate the charging request information combining the charging features of each base service, and the regenerated charging request information is sent to the charging engine. This realizes the composite charging service based on various granularities in a simple and convenient manner without modifying each base service.</p><heading id="h0004"><b>BRIEF DESCRIPTION OF THE DRAWINGS</b></heading><p id="p0012" num="0012"><ul><li><figref idrefs="f0001">FIG. 1</figref> is a schematic structural view of a system for realizing a composite charging service according to an embodiment of the present invention;</li><li><figref idrefs="f0002">FIG. 2</figref> is a schematic structural view of a service composition engine according to an embodiment of the present invention;</li><li><figref idrefs="f0003">FIG. 3</figref> is a flow chart of a system for realizing a composite charging service according to a first embodiment of the present invention;</li><li><figref idrefs="f0004">FIG. 4</figref> is a flow chart a system for realizing a composite charging service according to a second embodiment of the present invention;</li><li><figref idrefs="f0005">FIG. 5</figref> is a flow chart a system for realizing a composite charging service according to<!-- EPO <DP n="4"> --> a third embodiment of the present invention;</li><li><figref idrefs="f0006">FIG. 6</figref> is a flow chart of a system for realizing a composite charging service according to a fourth embodiment of the present invention;</li><li><figref idrefs="f0007">FIG. 7</figref> is a flow chart of a system for realizing a composite charging service according to a fifth embodiment of the present invention; and</li><li><figref idrefs="f0008">FIG. 8</figref> is a flow chart of a system for realizing a composite charging service according to a sixth embodiment of the present invention.</li></ul></p><heading id="h0005"><b>DETAILED DESCRIPTION OF THE EMBODIMENTS</b></heading><p id="p0013" num="0013">The present invention provides a system for realizing a composite charging service, where charging request information combining charging features of each base service is generated according to charging features of received charging request information of each base service, and the regenerated charging request information is sent to a charging engine 120. The charging engine 120 responses the charging request information, and returns charging response information to each base service, which realizes the composite charging service based on various granularities in a simple and convenient manner without modifying each base service.</p><p id="p0014" num="0014">Referring to <figref idrefs="f0001">FIG. 1</figref>, a system for realizing a composite charging service according to an embodiment of the present invention includes a service composition engine 110, a charging engine 120, and a plurality of base service.</p><p id="p0015" num="0015">The service composition engine 110 is configured to perform a service coordination process on received charging request information of the base service, and send the charging request information to the charging engine 120.</p><p id="p0016" num="0016">The charging engine 120 is configured to return charging response information according to the charging request information sent by the service composition engine 110.</p><p id="p0017" num="0017">In an embodiment of the present invention, specifically, the charging engine 120 may be an online charging engine.</p><p id="p0018" num="0018">In the service composition engine 110 according to an embodiment of the present invention, a charging control apparatus 130 may be disposed, and referring to <figref idrefs="f0002">FIG. 2</figref>, the charging control apparatus 130 may specifically include functional modules, for example,<!-- EPO <DP n="5"> --> an identifier (ID) and instance generating unit 131, a base service invoking unit 132, a charging information receiving unit 133, a coordinator 134, and a charging information sending unit 135.</p><p id="p0019" num="0019">The ID and instance generating unit 131 is configured to generate various IDs and instances.</p><p id="p0020" num="0020">The base service invoking unit 132 is configured to initiate an invoke operation to each base service.</p><p id="p0021" num="0021">The charging information receiving unit 133 is configured to receive the charging request information of the base service.</p><p id="p0022" num="0022">The coordinator 134 is configured to perform the service coordination process on the received charging request information of the base service according to charging features of each base service, so as to regenerate charging request information combining the charging features of each base service.</p><p id="p0023" num="0023">The charging information sending unit 135 is configured to send the regenerated charging request information to the charging engine 120.</p><p id="p0024" num="0024">In order to enable each base service to sense that the service coordination process needs to be performed on the base service, in the system for realizing the charging service according to an embodiment of the present invention, during the specific implementation, an existing service invoking protocol needs to be extended, where a charging coordination ID, a correlation ID, and a coordination entity ID are added to the service invoking protocol.</p><p id="p0025" num="0025">The charging coordination ID is configured to represent that the service coordination process needs to be performed on the invoked base service.</p><p id="p0026" num="0026">The correlation ID is configured to identify a service control point instance and a composite service operation instance having an association relation with the base service.</p><p id="p0027" num="0027">The coordination entity ID is configured to notify the invoked base service of a coordination entity to which a charging request message of the invoked base service needs to be sent.</p><p id="p0028" num="0028">It should be noted that in the present invention, a concept of the "service control point instance" is proposed, the service control point instance is configured to uniquely identify a<!-- EPO <DP n="6"> --> composite service operation instance corresponding to the base service, and uniquely identify a charging session between the base service and the online engine in the service composition engine 110. Further, in an embodiment of the present invention, a correlation ID having an association relation with the service control point instance is generated, and the correlation ID and other information are sent to the invoked base service through the invoking protocol, the invoked base service carries the information in the charging request information subsequently sent to the coordination entity, and the coordination entity, for example, the service composition engine 110, may acquire the composite service operation instance corresponding to the base service in the service composition engine 110 according to the correlation ID and other information.</p><p id="p0029" num="0029">It is further noted that values of the charging coordination ID are different, which represents that manners for performing the service coordination process on the invoked base service are different. For example, it is assumed that two specific service combinations exist, one is formed by base service A and B and is represented as service Z, and the other is formed by base service A, B, and C and is represented as service Y For the two composite services, when processing the service Z, that is, invoking base service A and B, the service composition engine 110 may assign that the charging coordination ID is '1'; and when processing service Y, that is, invoking base service A, B, and C, the service composition engine 110 may assign that the charging coordination ID is '2'. When sending a charging request to the coordination entity, for example, the service composition engine 110, a base service execution environment may additionally carry the charging coordination ID. After receiving the charging requests, the service composition engine 110 may identify the specific service combination through the charging coordination ID, for example, whether the service combination is service Y or service Z.</p><p id="p0030" num="0030">The coordination entity may have a configuration as follows, so as to support the features.
<tables id="tabl0001" num="0001"><table frame="all"><tgroup cols="3"><colspec colnum="1" colname="col1" colwidth="44mm"/><colspec colnum="2" colname="col2" colwidth="47mm"/><colspec colnum="3" colname="col3" colwidth="76mm"/><thead><row><entry align="center" valign="top"><b>Charging Coordination ID</b></entry><entry align="center" valign="top"><b>Name of Composite Service</b></entry><entry align="center" valign="top"><b>Charging Features</b></entry></row></thead><tbody><row><entry align="center">1</entry><entry align="center">Z</entry><entry>The composite service is formed by services A and B, and has a discount of 20% off.</entry></row><!-- EPO <DP n="7"> --><row><entry align="center">2</entry><entry align="center">Y</entry><entry>The composite service is formed by services A, B, and C, services A and B have a discount of 30% off, and the charging of service C remains unchanged.</entry></row></tbody></tgroup></table></tables></p><p id="p0031" num="0031">After receiving the charging coordination ID, the correlation ID, and the coordination entity ID, the invoked base service may sense that the service coordination process needs to be performed on the charging request information, and may also know the specific coordination entity for performing the service coordination process on the charging request information.</p><p id="p0032" num="0032">It should be noted that no matter whether the base service is a composite service, it is considered as a base service in an embodiment of the present invention.</p><p id="p0033" num="0033">In addition, in the system for realizing the composite charging service according to an embodiment of the present invention, during the specific implementation, a Business Process Execution Language (Bpel) needs to be extended, so that functional modules in the system may communicate with one another, so as to acquire correlated information.</p><p id="p0034" num="0034">In order to make the objectives, technical solutions, and advantages of the present invention more comprehensible, in the following, for example, by adopting a Simple Object Access Protocol (SOAP) as the service invoking protocol, and adopting a Diameter protocol as a charging protocol, the applications of the system for realizing the composite charging service according to the present invention in a typical charging process are further described in detail with reference to the accompanying drawings.</p><p id="p0035" num="0035">It should be understood that the applicable protocols of the system for realizing the composite charging service according to the present invention are not limited to the above two protocols, and are not limited in the present invention. Further, message formats adopted to transmit the correlated charging information are not limited in the present invention.</p><p id="p0036" num="0036">In a first embodiment, the system for realizing the charging service according to the present invention is applied to a charging process based on an event mode, and referring to <figref idrefs="f0003">FIG. 3</figref>, the process specifically includes the following steps.</p><p id="p0037" num="0037">In step 301, the service composition engine 110 generates a charging coordination ID,<!-- EPO <DP n="8"> --> a correlation ID, a coordination entity ID, and a charging control point instance, and establishes an association relation between the correlation ID and the charging control point instance and an association relation between the correlation ID and a composite service operation instance in the service composition engine 110.</p><p id="p0038" num="0038">Specifically, the ID and instance generating unit 131 of the charging control apparatus 130 generates the charging coordination ID, the correlation ID, the coordination entity ID, and the charging control point instance.</p><p id="p0039" num="0039">Further, the coordinator 134 in the charging control apparatus 130 establishes the association relation between the correlation ID and the charging control point instance and the association relation between the correlation ID and the composite service operation instance in the service composition engine 110, and records the association relations.</p><p id="p0040" num="0040">The association relations recorded by the coordinator 134 may be expressed in the following table.
<tables id="tabl0002" num="0002"><table frame="all"><tgroup cols="3"><colspec colnum="1" colname="col1" colwidth="49mm"/><colspec colnum="2" colname="col2" colwidth="59mm"/><colspec colnum="3" colname="col3" colwidth="58mm"/><thead><row><entry align="center" valign="top"><b>Correlation ID (Correlationid)</b></entry><entry align="center" valign="top"><b>Charging Control Point Instance (Ctrpoint instance)</b></entry><entry align="center" valign="top"><b>Composite Service Operation Instance (Service instance)</b></entry></row></thead><tbody><row><entry align="center">CidA</entry><entry align="center">CtrpinstA</entry><entry align="center">SinstA</entry></row></tbody></tgroup></table></tables></p><p id="p0041" num="0041">It should be noted that in the system for realizing the composite charging service according to an embodiment of the present invention, in the actual application, attributes of the invoke operation in the existing Bpel need to be extended, where attributes configured to assign the charging control point and configured to indicate the value of the charging coordination ID of the base service are added.</p><p id="p0042" num="0042">The process of extending the attributes of the invoke operation may specifically be that an attribute "ChgCtrPoint" configured to assign the charging control point instance and an attribute "ChgNegotiation" configured to indicate the value of the charging coordination ID of the base service are added to the original invoke operation. The specific extending process may be described by the Bpel as follows:
<pre listing-type="program-listing">     &lt;invoke partnerLink="Partnerlinkname"
          portType="PortTypeName"<!-- EPO <DP n="9"> -->
              operation=" OperationName"
              inputVariable="RequestVar"
           outputVariable="ResponseVar"
          ChgCtrPoint="ChgctrpointName"
     ChgNegotiation="ChgNegotiationName"/&gt;</pre></p><p id="p0043" num="0043">It should be understood that the Bpel for extending the invoke operation and the Bpel involved in the specific implementation of the present invention are not limited to the statements in the specification, may be flexibly edited according to actual situations, and are not limited in the present invention.</p><p id="p0044" num="0044">In an embodiment, an instance segment of the invoke operation described by the Bpel may be as follows:
<pre listing-type="program-listing">  &lt;invoke partnerLink="employeeTravelStatus"
            portType="emp:EmployeeTravelStatusPT"
                operation="EmployeeTravelStatus"
         inputVariable="EmployeeTravelStatusRequest"
       outputVariable="EmployeeTravelStatusResponse"
     ChgCtrPoint="Chgctrpointservicel"
    ChgNegotiation="CompositionTypel"/&gt;</pre></p><p id="p0045" num="0045">In step 302, the service composition engine 110 invokes the base service to be combined by adopting the extended SOAP protocol.</p><p id="p0046" num="0046">After the coordinator 134 successfully establishes the association relations, the base service invoking unit 132 invokes the base service by adopting the extended SOAP protocol.</p><p id="p0047" num="0047">Invoking information of the SOAP protocol includes the charging coordination ID, the correlation ID, the coordination entity ID, and other information.</p><p id="p0048" num="0048">It should be noted that under a usual situation, the coordination entity is the service composition engine 110, so that the service composition engine 110 may not carry the coordination entity ID when invoking the base service by adopting the extended invoking protocol.</p><p id="p0049" num="0049">In step 303, the invoked base service sends charging request information.</p><p id="p0050" num="0050">After receiving the invoking information sent by the service composition engine 110,<!-- EPO <DP n="10"> --> the base service sends the charging request information to the service composition engine 110 by sending a charging request message.</p><p id="p0051" num="0051">The charging request information may specifically include a charging session ID, charging information, type information of the charging request message, and type information of a charging request message sending instance. When the charging request information is initial charging request information, the charging session ID includes the correlation ID received by the base service.</p><p id="p0052" num="0052">It should be noted that the base service may not carry the correlation ID when sending non-initial charging request information.</p><p id="p0053" num="0053">In step 304, the service composition engine 110 receives the charging request information.</p><p id="p0054" num="0054">Specifically, the charging information receiving unit 133 in the charging control apparatus 130 receives the charging request message carrying the charging request information sent by the base service, completes a protocol conversion, and sends the charging request message to the coordinator 134.</p><p id="p0055" num="0055">In step 305, the coordinator 134 confirms the charging control point instance and the composite service operation instance.</p><p id="p0056" num="0056">The coordinator 134 confirms the charging control point instance having the association relation with the charging session ID or the correlation ID in step 301 according to the charging session ID or the correlation ID in the charging request information, so as to confirm the associated composite service operation instance.</p><p id="p0057" num="0057">It should be noted that when the base service sends the initial charging request information, the coordinator 134 confirms the charging control point instance and the composite service operation instance according to the correlation ID in the charging session ID, and further the coordinator 134 establishes the association relation between the charging session ID and the confirmed charging control point instance and the association relation between the charging session ID and the confirmed composite service operation instance, so that the base service may not carry the correlation ID when sending the non-initial charging request information, and the coordinator 134 confirms the charging control point instance and the composite service operation instance having the association<!-- EPO <DP n="11"> --> relation with the charging session ID according to the charging session ID sent by the base service. Specifically, it may be expressed in the following table.
<tables id="tabl0003" num="0003"><table frame="all"><tgroup cols="3"><colspec colnum="1" colname="col1" colwidth="54mm"/><colspec colnum="2" colname="col2" colwidth="56mm"/><colspec colnum="3" colname="col3" colwidth="56mm"/><thead><row><entry align="center" valign="top"><b>Charging Session ID (SessionID)</b></entry><entry align="center" valign="top"><b>Charging Control Point Instance (Ctrpoint instance)</b></entry><entry align="center" valign="top"><b>Composite Service Operation Instance (Service instance)</b></entry></row></thead><tbody><row><entry align="center">SessionID</entry><entry align="center">CtrpinstA</entry><entry align="center">SinstA</entry></row></tbody></tgroup></table></tables></p><p id="p0058" num="0058">It should be noted that the charging session ID and the correlation ID are unique in the coordinator 134, and further, the association relation between the charging session ID or the correlation ID and the charging control point instance and the association relation between the charging session ID or the correlation ID and the composite service operation instance are also unique in the coordinator 134.</p><p id="p0059" num="0059">In step 306, the coordinator 134 converts the charging request message to an event.</p><p id="p0060" num="0060">The coordinator 134 converts the received charging request information to the event according to the type information of the charging request message, the type information of the charging request message sending entity, and other information in the charging request information, and the event information is unique in the coordinator 134.</p><p id="p0061" num="0061">The event information may specifically include an event name and information of the charging control point instance of the event. For example, the event name is InitialChargingRequest, and the charging control point instance is CtrpinstA. Here, the information of the charging control point instance is the information of the charging control point instance mentioned in the foregoing step.</p><p id="p0062" num="0062">The conversion may be expressed as follows.
<tables id="tabl0004" num="0004"><table frame="all"><tgroup cols="3"><colspec colnum="1" colname="col1" colwidth="35mm"/><colspec colnum="2" colname="col2" colwidth="26mm"/><colspec colnum="3" colname="col3" colwidth="37mm"/><thead><row><entry align="center" valign="top"><b>Entity Type</b></entry><entry align="center" valign="top"><b>Message Type</b></entry><entry align="center" valign="top"><b>Event Name</b></entry></row></thead><tbody><row><entry align="center">Base service</entry><entry align="center">InitialCCR</entry><entry align="center">InitialChargingRequest</entry></row><row><entry align="center">Base service</entry><entry align="center">CCR</entry><entry align="center">ChargingRequest</entry></row><row><entry align="center">Charging Engine 120</entry><entry align="center">RAR</entry><entry align="center">ReAuthRequest</entry></row></tbody></tgroup></table></tables></p><p id="p0063" num="0063">In step 307, the coordinator 134 regenerates charging request information according to the charging features of each base service.<!-- EPO <DP n="12"> --></p><p id="p0064" num="0064">In this step, the coordinator 134 triggers a logic code after matching the event information, for example, an externally input logic code, a logic code stored by the service composition engine 110, or a logic code assigned by the composite service operation instance, and in the platform of the composite service operation instance, the coordinator 134 performs the service coordination process, for example, a modifying operation, an adding operation, or a deleting operation, on the charging request information of the base service according to the charging features of each base service, so as to regenerate the charging request information combining the charging features of each base service.</p><p id="p0065" num="0065">It should be further noted that in the system for realizing the composite charging service according to an embodiment of the present invention, by adding an activity to the Bpel, the logic code may be triggered after the matching of the event information is passed. Specifically, it may be realized through the Bpel as follows:
<pre listing-type="program-listing">                    &lt;chgEventHandlers&gt;
      &lt;catch eventName="NCEventname" eventowner = "Ownername"&gt;
                                ...
                        &lt;/catch&gt;+
                    &lt;/chgEventHandlers&gt;</pre></p><p id="p0066" num="0066">Each chgEventHandlers may include a plurality of Catch units, and each Catch unit assigns the event name processed by the catch unit through the eventName, and assigns the specific charging control point to which the event belongs through the eventowner. Only when both the eventName and the eventowner are matched, the Catch unit is entered, so as to enter the externally input logic code, the logic code stored by the service composition engine 110, and/or the logic code assigned by the composite service operation instance, and perform the service coordination process on the charging request information sent by each base service. In this way, the charging request information combining the charging features of each base service is generated.</p><p id="p0067" num="0067">In an embodiment, the activity instance segment described by the Bpel may be expressed as follows:
<pre listing-type="program-listing">                      &lt;chgEventHandlers&gt;<!-- EPO <DP n="13"> -->
              &lt;catch eventName="lns:InitialChargingRequest" eventowner =
                      "Chgctrpointservice1"&gt;
                              ...
                          &lt;/catch&gt;
              &lt;catch eventName="lns:ChargingRequest" eventowner =
                      "Chgctrpointservice1"&gt;
                              ...
                          &lt;/catch&gt;
              &lt;catch eventName="lns:ReAuthRequest" eventowner =
                      "Chgctrpointservice1"&gt;
                              ...
                          &lt;/catch&gt;
              &lt;catch eventName="lns:AbortSessionRequest" eventowner =
                      "Chgctrpointservice1"&gt;
                              ...
                          &lt;/catch&gt;
                              ...
                      &lt;/chgEventHandlers&gt;</pre></p><p id="p0068" num="0068">In step 308, the service composition engine 110 sends the regenerated charging request information to the charging engine 120.</p><p id="p0069" num="0069">The coordinator 134 instructs the charging information sending unit 135 to send the regenerated charging request information.</p><p id="p0070" num="0070">The charging information sending unit 135 performs the protocol conversion on the charging request message carrying the new charging request information, and sends the charging request message after the protocol conversion to the charging engine 120.</p><p id="p0071" num="0071">It should be noted that in the system for realizing the charging service according to an embodiment of the present invention, in the actual application, an activity needs to be<!-- EPO <DP n="14"> --> added to the Bpel, so that the charging information sending unit 135 is enabled to send the charging request message to the charging engine 120. Specifically, it may be realized through the Bpel as follows:
<ul><li>chgsendtoOCS(ChgCtrPointType chgctrPointname, xsd:string msgtype)</li></ul></p><p id="p0072" num="0072">A first parameter of the function is the charging control point instance, and is configured to identify a charging session between a certain base service and the charging engine 120; and a second parameter points out the type of the sent charging request message, for example, Credit control Request, Abort session response, or Re-Auth response.</p><p id="p0073" num="0073">In this step, further, the coordinator 134 sets a state of the charging session of the composite service operation instance as a waiting state, so as to indicate that the composite service operation instance subsequently needs the charging response information.</p><p id="p0074" num="0074">In step 309, the charging engine 120 responses the received charging request information, and returns charging response information.</p><p id="p0075" num="0075">The process performed by the charging engine 120 on the charging request information is the same as that of the conventional technology, so the details are not described herein again, and the charging engine 120 returns the charging response information to the service composition engine 110 by sending a charging response message.</p><p id="p0076" num="0076">In step 310, the service composition engine 110 receives the charging response information, and performs the service coordination process on the charging response information.</p><p id="p0077" num="0077">Firstly, the charging information receiving unit 133 receives the charging response message carrying the charging response information returned by the charging engine 120, completes the protocol conversion and the format conversion, and sends the charging response message to the coordinator 134.</p><p id="p0078" num="0078">It should be noted that in the system for realizing the charging service according to the present invention, in the actual application, an activity needs to be added to the Bpel, so that the charging information receiving unit 133 is enabled to receive the charging response message from the charging engine 120. Specifically, it may be realized through the Bpel<!-- EPO <DP n="15"> --> as follows:
<ul><li>chgreceiveFromOCS(ChgCtrPointType chgctrPointname, xsd:string msgtype)</li></ul></p><p id="p0079" num="0079">A first parameter of the function is the charging control point instance, and is configured to identify a charging session between a certain base service and an online charging system; and a second parameter points out the type of the received charging response message, for example, Credit Control Answer.</p><p id="p0080" num="0080">The coordinator 134 acquires the charging control point instance having the association relation with the charging session ID according to the charging session ID in the charging response information, and further acquires the corresponding composite service operation instance. The coordinator 134 sets the state of the charging session of the composite service operation instance as a state that the response is received, so as to indicate that the charging session receives the charging response information and waits for subsequent processes.</p><p id="p0081" num="0081">Here, if the service coordination process needs to be performed on the charging response information, the modifying operation, the deleting operation, or the adding operation is performed on the charging response information by using the externally input logic code, the preset logic code, or the logic code pre-assigned by the user in the composite service.</p><p id="p0082" num="0082">It should be noted that in step 307, after the initial charging request information is received, a logic code is triggered by matching the event information, and this step is a part of the logic code. That is to say, it is determined whether to modify the received charging information and how to modify the received charging information according to specific service demands.</p><p id="p0083" num="0083">The coordinator 134 instructs the charging information sending unit 135 to send the charging response information to the base service.</p><p id="p0084" num="0084">In step 311, the service composition engine 110 sends the charging response information to each base service.</p><p id="p0085" num="0085">The charging information sending unit 135 in the service composition engine 110 performs the protocol conversion on the charging response message, and sends the charging<!-- EPO <DP n="16"> --> response message after the protocol conversion to each base service.</p><p id="p0086" num="0086">In step 312, the base service receives the charging response information.</p><p id="p0087" num="0087">The base service receives the charging response message carrying the charging response information, completes the processing of the charging response message, and returns a SOAP response to the service composition engine 110.</p><p id="p0088" num="0088">In step 313, the composite service operation instance clears the association relation with the corresponding charging control point instance in the coordinator 134 through an internal invoke message.</p><p id="p0089" num="0089">Till now, in the first embodiment of the present invention, the composite charging process based on the event mode is completed. It may be known from the above description that in the system for realizing the composite charging service according to the present invention, the service coordination process is performed on the charging request information of each base service according to the charging features of each base service, so as to generate the charging request information combining the charging features of each base service, and an interaction with the charging engine 120 is performed according to the charging request information, so as to complete the composite charging service. This realizes the composite charging service based on the event mode in a simple and convenient manner without modifying each base service. Further, in the system for realizing the composite service according to the present invention, during the specific implementation, the composite charging process of the base service based on any granularities may be realized without requiring the granularity of each base service.</p><p id="p0090" num="0090">In a second embodiment, the system for realizing the charging service according to the present invention is applied to a charging process based on a session mode, and the specific process is as shown in <figref idrefs="f0004">FIG. 4</figref>.</p><p id="p0091" num="0091">The charging process based on the session mode is basically similar to the charging process based on the event mode, except that the base service in the charging process based on the session mode may report the charging request information for many times. It is further described that the process similar to steps 303 to 311 in the first embodiment, that is, steps 403 to 411 in <figref idrefs="f0004">FIG. 4</figref>, is executed for many times in the charging process based on the session mode, and steps 412 and 413 are executed after the session is ended. Therefore,<!-- EPO <DP n="17"> --> the specific implementation of the second embodiment is not described herein again.</p><p id="p0092" num="0092">It may be known from <figref idrefs="f0004">FIG. 4</figref> and the above description that, in the system for realizing the composite charging service according to an embodiment of the present invention, the service coordination process is performed on the charging request information of each base service according to the charging features of each base service, so as to generate the charging request information combining the charging features of each base service, and an interaction with the charging engine 120 is performed according to the charging request information, so as to complete the composite charging service. This realizes the composite charging service based on the event mode and various granularities in a simple and convenient manner without modifying each base service.</p><p id="p0093" num="0093">In a third embodiment, the system for realizing the charging service according to the present invention is applied to a charging process initiated by the charging engine 120, and the specific implementation of the process is as shown in <figref idrefs="f0005">FIG. 5</figref>.</p><p id="p0094" num="0094">It should be noted that the charging engine 120 can initiate a non-initial charging request according to the received correlated charging request information only. Further, the steps of generating the correlation ID and the instance, and establishing the association relation in the third embodiment are the same as that of the first and the second embodiments, so that the procedure is not shown in <figref idrefs="f0005">FIG. 5</figref>.</p><p id="p0095" num="0095">The specific implementation of the third embodiment of the present invention includes the following steps.</p><p id="p0096" num="0096">In step 501, the charging engine 120 sends charging request information to the service composition engine 110.</p><p id="p0097" num="0097">The charging request information includes a charging session ID and other information. The online engine sends the charging request information to the service composition engine 110 by sending a charging request message.</p><p id="p0098" num="0098">It should be noted that the charging session ID of one charging engine 120 is unique, but the service composition engine 110 may interact with a plurality of charging engines 120 at the same time, so that the charging session ID received by the service composition engine 110 may not be unique, and thus when the service composition engine 110 interacts with the plurality of charging engines 120, the charging session ID is required to be unique<!-- EPO <DP n="18"> --> in the plurality of charging engines 120, which can be ensured by the plurality of charging engines 120. Alternatively, the service composition engine 110 performs a certain process on the received charging session ID, so as to make the charging session ID unique, which is, for example, realized through an algorithm as follows: new charging session ID = entity ID of the charging engine 120 + original charging session ID.</p><p id="p0099" num="0099">In the first and the second embodiments, the problem of the uniqueness of the charging session ID may be solved by adopting the same method.</p><p id="p0100" num="0100">In step 502, the charging information receiving unit 133 receives the charging request message.</p><p id="p0101" num="0101">The charging information receiving unit 133 performs a protocol conversion on the received charging request message, and sends the charging request message completing the conversion to the coordinator 134.</p><p id="p0102" num="0102">In step 503, the coordinator 134 confirms a charging control point instance and a composite service operation instance.</p><p id="p0103" num="0103">The coordinator 134 confirms the charging control point instance and the composite service operation instance having an association relation with the charging session ID according to the charging session ID carried in the charging request message.</p><p id="p0104" num="0104">In step 504, the coordinator 134 converts the charging request message to an event.</p><p id="p0105" num="0105">The coordinator 134 converts the charging request message to the event according to type information of the charging request message, type information of a charging request message sending entity, and other information in the charging request information, where the event information is unique in the coordinator 134.</p><p id="p0106" num="0106">In step 505, the coordinator 134 regenerates charging request information.</p><p id="p0107" num="0107">If the service coordination process needs to be performed on the charging information sent by the charging engine 120, a service coordination process similar to step 307 is executed, the charging request message is converted to the event, and a specific logic code is entered, so as to generate new charging request information.</p><p id="p0108" num="0108">In step 506, the coordinator 134 sends the charging request information to the base service through the charging information sending unit 135.</p><p id="p0109" num="0109">It should be noted that, in the system for realizing the charging service according to an<!-- EPO <DP n="19"> --> embodiment of the present invention, in the actual application, an activity needs to be added to a Bpel, so that the service composition engine 110 may send the charging request information to the base service. Specifically, it may be realized through the Bpel as follows:
<ul><li>chgSendtoService(ChgCtrPointType chgctrPointname, xsd:string msgtype)</li></ul></p><p id="p0110" num="0110">A first parameter ChgCtrPointType chgctrPointname in the function is the charging control point instance, and is configured to identify a charging session between a certain base service and the charging engine 120, where ChgCtrPointType is a charging type; and a second parameter points out a type of the message bearing the charging request information, for example, Credit Control Answer, Abort session Request, or Re-Auth Request.</p><p id="p0111" num="0111">In step 507, the base service returns charging response information.</p><p id="p0112" num="0112">In step 508, the service composition engine 110 forwards the charging response information to the charging engine 120.</p><p id="p0113" num="0113">It should be noted that in the system for realizing the charging service according to the present invention, in the actual application, an activity needs to be added to the Bpel, so that the service composition engine 110 is enabled to acquire the charging response information returned by the base service. Specifically, it may be realized through the Bpel as follows:
<ul><li>chgreceivefromService(ChgCtrPointType chgctrPointname, xsd:string msgtype)</li></ul></p><p id="p0114" num="0114">A first parameter in the function is the charging control point instance, and is configured to identify a charging session between a certain base service and the charging engine 120; and a second parameter points out a type of the charging request message carrying the regenerated charging request information, for example, Abort session response or Re-Auth response.</p><p id="p0115" num="0115">If necessary, in this step, the service coordination process may be performed on the received charging response information.</p><p id="p0116" num="0116">In addition, the Bpel realizing the charging response information sent by the charging information sending unit 135 to the charging engine 120 may adopt the Bpel described in step 308 of the first embodiment.<!-- EPO <DP n="20"> -->
<ul><li>chgsendtoOCS(ChgCtrPointType chgctrPointname, xsd:string msgtype)</li></ul></p><p id="p0117" num="0117">It may be known from <figref idrefs="f0005">FIG. 5</figref> and the above description that, in the system for realizing the composite charging service according to an embodiment of the present invention, the composite charging service based on various granularities and initiated by the charging engine 120 is realized in a simple and convenient manner without modifying each base service.</p><p id="p0118" num="0118">In a fourth embodiment, the system for realizing the charging service according to the present invention is applied to a charging process in which a series of services used by a user affect one another, and charging features need to be coupled, for example, the user uses a service 1, and when using a service 2 and a service 3, the user may enjoy a discount in a certain degree. Referring to <figref idrefs="f0006">FIG. 6</figref>, the procedure specifically includes the following steps.</p><p id="p0119" num="0119">In step 601, the service composition engine 110 invokes the service 1.</p><p id="p0120" num="0120">In step 602, the service 1 returns invoking information.</p><p id="p0121" num="0121">In step 603, the service composition engine 110 invokes the service 2.</p><p id="p0122" num="0122">The user already uses the service 1, so that when using the service 2, the user may enjoy the discount policy. Here, the service composition engine 110 needs to notify the service 2 that a service coordination process needs to be performed on charging request information, and the service composition engine 110 invokes the service 2 by adopting an extended SOAP protocol.</p><p id="p0123" num="0123">In this step, further, the service composition engine 110 generates a charging coordination ID, a correlation ID, a coordination entity ID, and a charging control point instance, and establishes an association relation between the correlation ID and the charging control point instance and an association relation between the correlation ID and a composite service operation instance.</p><p id="p0124" num="0124">In step 604, the service 2 sends the charging request information.</p><p id="p0125" num="0125">In step 605, the service composition engine 110 performs the service coordination process on the charging request information sent by the service 2, so as to generate new charging request information.<!-- EPO <DP n="21"> --></p><p id="p0126" num="0126">The operation procedure in this step is the same as the operation procedure in steps 304 to 307 of the first embodiment, where a logic code is triggered after matching the event information, and the service coordination process is performed on the charging request information of the service 2, so as to regenerate the new charging request information. For example, discount information is directly added to the charging information of the service 2, or the charging information of the service 2 is modified.</p><p id="p0127" num="0127">In step 606, the service composition engine 110 sends the charging request information regenerated for the service 2 to the charging engine 120.</p><p id="p0128" num="0128">In step 607, the charging engine 120 returns online charging response information.</p><p id="p0129" num="0129">In step 608, the service composition engine 110 forwards the charging response information to the service 2.</p><p id="p0130" num="0130">In step 609, the service 2 returns a SOAP response, and the charging process ends.</p><p id="p0131" num="0131">In step 610, the service composition engine 110 invokes the service 3.</p><p id="p0132" num="0132">In step 611, the service 3 sends charging request information.</p><p id="p0133" num="0133">In step 612, the service composition engine 110 performs the service coordination process on the charging request information sent by the service 3, so as to generate the new charging request information.</p><p id="p0134" num="0134">In step 613, the service composition engine 110 sends the charging request information regenerated for the service 3 to the charging engine 120.</p><p id="p0135" num="0135">In step 614, the charging engine 120 returns charging response information.</p><p id="p0136" num="0136">In step 615, the service composition engine 110 forwards the charging response information to the service 3.</p><p id="p0137" num="0137">In step 616, the service 3 returns a SOAP response, and the charging process ends.</p><p id="p0138" num="0138">It may be known from the above description that in the system for realizing the composite charging service according to the present invention, necessary modifications are made to the received charging request information according to the charging features of services 1, 2, and 3, and the regenerated charging request information is sent to the charging engine 120. This realizes the composite charging service in a simple and convenient manner without modifying each base service having the coupled relation of the charging features and without requiring the granularity of each base service.<!-- EPO <DP n="22"> --></p><p id="p0139" num="0139">When the system for realizing the composite charging service according to the present invention is applied to the scenario in the fourth embodiment, the adopted Bpel instance is as follows:
<pre listing-type="program-listing">                              ...
                &lt;invoke partnerLink="BuyAdGoods"
                   portType="ad: BuyAdGoods PT"
                     operation=" BuyAdGoods"
             inputVariable=" BuyAdGoods Request"
          outputVariable=" BuyAdGoods Response"
                 ChgCtrPoint="Chgctrpointservice1"/&gt;
              &lt;invoke partnerLink="buyTicket"
               portType="bus: buyTicket PT"
                    operation="buyTicket "
              inputVariable=" buyTicketDetails"
             outputVariable=" buyTicketResponse"
                 ChgCtrPoint="Chgctrpointservice2"/&gt;
                              ...
                     &lt;chgEventHandlers&gt;
      &lt;catch eventName="lns: InitialChargingRequest" eventowner =
                 "Chgctrpointservice1"&gt;
      &lt;chgputvalue("Discount-servicead", Chgctrpointservice1, "CCR",
                 "Service-Context-Id")/&gt;
          &lt;chgsendtoOCS(Chgctrpointservice1, "CCR")/&gt;
        &lt;chgreceiveFromOCS(Chgctrpointservice1, "CCA")/&gt;
          &lt;chgsendtoservice(Chgctrpointservice1, "CCA")/&gt;
                        &lt;/catch&gt;
      &lt;catch eventName="lns: InitialChargingRequest" eventowner =
                        "Chgctrpointservice2"&gt;
      &lt;chgputvalue(Discount-servicetic, Chgctrpointservice2, "CCR",<!-- EPO <DP n="23"> -->
                    "Service-Context-Id")/&gt;
           &lt;chgsendtoOCS(Chgctrpointservice2, "CCR")/&gt;
        &lt;chgreceiveFromOCS(Chgctrpointservice2, "CCA")/&gt;
          &lt;chgsendtoservice(Chgctrpointservice2, "CCA")/&gt;
                        &lt;/catch&gt;
                   &lt;/chgEventHandlers&gt;
                                                      ...</pre>
"chgputvalue()" is an extension function, configured to add or modify a data unit in the charging information.</p><p id="p0140" num="0140">In a fifth embodiment, the system for realizing the composite charging service according to the present invention may also be applied to a scenario in which the charging features of each base service do not need to be coupled, and referring to <figref idrefs="f0007">FIG. 7</figref>, the specific process includes the following steps.</p><p id="p0141" num="0141">In step 701, the service composition engine 110 invokes a service 1.</p><p id="p0142" num="0142">In step 702, the service 1 sends charging request information to the service composition engine 110.</p><p id="p0143" num="0143">In step 703, the service composition engine 110 forwards the charging request information sent by the service 1 to the charging engine 120.</p><p id="p0144" num="0144">Service 1 does not need to perform charging feature coupling with other services, so that the service composition engine 110 may directly forward the charging request information sent by the service 1 to the charging engine 120 without performing any modification.</p><p id="p0145" num="0145">In step 704, the charging engine 120 receives the charging request information sent by the service 1, and returns charging response information.</p><p id="p0146" num="0146">In step 705, the service composition engine 110 forwards the charging response information returned by the charging engine 120 to service 1.</p><p id="p0147" num="0147">In step 706, the service 1 returns a SOAP response, and the charging process ends.</p><p id="p0148" num="0148">Till now, in the system for realizing the composite charging service according to an embodiment of the present invention, the charging process of the service that does not have<!-- EPO <DP n="24"> --> the charging feature coupling with other services is completed. If other similar services need to be processed subsequently, steps 701 to 706 are repeatedly performed.</p><p id="p0149" num="0149">It may be known from the above description that in the system for realizing the composite service according to the present invention, the composite service charging process without the charging feature coupling is realized in a simple and convenient manner without modifying each base service.</p><p id="p0150" num="0150">When the system for realizing the composite charging service according to the present invention is applied to the scenario in the fifth embodiment, the adopted Bpel instance is as follows:
<pre listing-type="program-listing">                          ...
             &lt;invoke partnerLink="employeeTravelStatus"
              portType="emp:EmployeeTravelStatusPT"
                  operation="EmployeeTravelStatus"
           inputVariable="EmployeeTravelStatusRequest"
          outputVariable="EmployeeTravelStatusResponse"
              ChgCtrPoint="Chgctrpointservice1"/&gt;
           &lt;invoke partnerLink="AmericanAirlines"
              portType="aln:FlightAvailabilityPT"
                operation="FlightAvailability"
                inputVariable="FlightDetails"
              outputVariable="FlightResponseAA"
            ChgCtrPoint="Chgctrpointservice2"/&gt;
                          ...
&lt;                       chgEventHandlers&gt;
       &lt;catch eventName="lns: InitialChargingRequest" eventowner =
                    "Chgctrpointservice1"&gt;
            &lt;chgsendtoOCS(Chgctrpointservice1, "CCR")/&gt;
          &lt;chgreceiveFromOCS(Chgctrpointservice1, "CCA")/&gt;
             &lt;chgsendtoservice(Chgctrpointservice1, "CCA")/&gt;<!-- EPO <DP n="25"> -->
                         &lt;/catch&gt;
         &lt;catch eventName="lns: InitialChargingRequest" eventowner =
                     "Chgctrpointservice2"&gt;
             &lt;chgsendtoOCS(Chgctrpointservice2, "CCR") /&gt;
            &lt;chgreceiveFromOCS(Chgctrpointservice2, "CCA")/&gt;
               &lt;chgsendtoservice(Chgctrpointservice2, "CCA")/&gt;
                         &lt;/catch&gt;
                   &lt;/chgEventHandlers&gt;
                                                                  ...</pre></p><p id="p0151" num="0151">In a sixth embodiment, the system for realizing the composite charging service according to the present invention may also be applied to a charging process initiated by the service composition engine 110 according to the using situation of each base service, and referring to <figref idrefs="f0008">FIG. 8</figref>, the specific process includes the following steps.</p><p id="p0152" num="0152">In steps 801 to 806, the service composition engine 110 acquires the using situations of services 1, 2, and 3.</p><p id="p0153" num="0153">In step 807, the service composition engine 110 generates charging request information according to the using situation of each base service.</p><p id="p0154" num="0154">In step 808, the service composition engine 110 sends the charging request information to the charging engine 120.</p><p id="p0155" num="0155">In step 809, the charging engine 120 returns charging response information.</p><p id="p0156" num="0156">It may be known from the above description that in the system for realizing the composite service according to the present invention, the charging process initiated by the service composition engine 110 is realized in a simple and convenient manner without modifying each base service.</p><p id="p0157" num="0157">When the system for realizing the composite charging service according to the present invention is applied to the scenario in the sixth embodiment, the adopted Bpel instance is as follows:
<pre listing-type="program-listing">                                   ...
                       &lt;invoke partnerLink="Service1"<!-- EPO <DP n="26"> -->
                          portType="ad: ServicelPT"
                         operati on=" Service1operation"
                       inputVariable="Service1Request"
                    outputVariable="ServicelResponse" /&gt;
                    &lt;invoke partnerLink="BuyAdGoods"
                       portType="ad: BuyAdGoods PT"
                          operation="BuyAdGoods"
                    inputVariable="BuyAdGoods Request"
                  outputVariable="BuyAdGoods Response"/&gt;
                    &lt;invoke partnerLink="buyTicket"
                      portType="bus: buyTicket PT"
                           operation="buyTicket"
                    inputVariable="buyTicketDetails"
                       outputVariable="buyTicketResponse"/&gt;
                                   ...
        ...//here the process of adding the charging information is omitted;
                 &lt;chgsendtoOCS(Chgctrpointservice1, "CCR")/&gt;
                                   &lt;chgreceiveFromOCS(Chgctrpointservice1,
  "CCA")/&gt;</pre></p><p id="p0158" num="0158">It should be noted that, in the system for realizing the composite charging service according to an embodiment of the present invention, in the actual application, the charging request information regenerated according to the charging features of each base service is returned to each base service, and each base service interacts with the charging engine 120 according to the charging request information after the service coordination process, so as to complete the charging process.</p><p id="p0159" num="0159">Moreover, in addition to being disposed in the service composition engine 110, the charging control apparatus 130 according to the present invention may also be disposed in<!-- EPO <DP n="27"> --> the charging engine 120, or is independently disposed in the system for realizing the composite charging service according to the present invention, and interacts with the base service, the service composition engine 110, and the charging engine 120, so as to complete the charging process of the composite service.</p><p id="p0160" num="0160">To sum up, the present invention provides the system for realizing the composite charging service. The system may be applied to various modes and various scenarios, for example, may be applied to the charging process based on the event mode or the session mode, or may be applied to the scenario in which the composite services have or do not have the charging feature coupling, the service coordination process is performed on the received charging request information of the base service, the charging request information combining the charging features of each base service is regenerated, and the interaction with the charging engine 120 is performed, so as to complete the charging process of the composite service. Further, in the system for realizing the composite charging service according to the present invention, in the actual application, the charging process of the composite service based on any granularity may be realized without modifying each base service and without requiring the granularity of each base service.</p><p id="p0161" num="0161">The above descriptions are merely some exemplary embodiments of the present invention, but not intended to limit the present invention.</p></description><claims mxw-id="PCLM56983946" lang="DE" load-source="patent-office"><!-- EPO <DP n="32"> --><claim id="c-de-01-0001" num="0001"><claim-text>Verfahren zum Ausführen eines zusammengesetzten Gebührenerfassungsdienstes für einen zusammengesetzten Dienst, wobei der zusammengesetzte Dienst eine Dienstkombination ist, die durch mehrere Basisdienste gebildet wird, wobei das Verfahren Folgendes umfasst:
<claim-text>Empfangen (304) von Gebührenerfassungsanforderungsinformationen von einem Basisdienst;</claim-text>
<claim-text>Durchführen (307) eines Dienstkoordinationsprozesses an den vom Basisdienst empfangenen Gebührenerfassungsanforderungsinformationen gemäß Gebührenerfassungsmerkmalen jedes Basisdienstes;</claim-text>
<claim-text>Regenerieren von Gebührenerfassungsanforderungsinformationen, die die Gebührenerfassungsmerkmale jedes Basisdienstes kombinieren; und</claim-text>
<claim-text>Senden (308) der regenerierten Gebührenerfassungsanforderungsinformationen an eine Gebührenerfassungsmaschine;</claim-text>
<claim-text>wobei das Verfahren <b>dadurch gekennzeichnet ist, dass</b> vor dem Empfangen der Gebührenerfassungsanforderungsinformationen vom Basisdienst, das Verfahren ferner Folgendes umfasst:
<claim-text>Erzeugen (301) einer Gebührenerfassungskoordinationskennung, ID, einer Korrelations-ID, einer Koordinationsdateneinheits-ID und einer Gebührenerfassungskontrollpunktinstanz;</claim-text>
<claim-text>Herstellen einer Verbindungsbeziehung zwischen der Korrelations-ID und der Gebührenerfassungskontrollpunktinstanz und einer Verbindungsbeziehung zwischen der Korrelations-ID und einer zusammengesetzten Dienstoperationsinstanz; und</claim-text>
<claim-text>Einleiten (302) einer Aufrufoperation an jedem Basisdienst, wobei Informationen der Aufrufoperation die Gebührenerfassungskoordinations-ID, die Korrelations-ID und die Koordinationsdateneinheits-ID umfassen,</claim-text>
<claim-text>wobei die Gebührenerfassungskoordinations-ID konfiguriert ist, zu repräsentieren, dass der Dienstkoordinationsprozess am aufgerufenen Basisdienst ausgeführt werden muss und wie der Koordinationsprozess auszuführen ist;</claim-text>
<claim-text>die Korrelations-ID konfiguriert ist, die Dienstkontrollpunktinstanz und die zusammengesetzte Dienstoperationsinstanz zu kennzeichnen, die die Verbindungsbeziehung mit dem Basisdienst aufweist;</claim-text>
<claim-text>die Koordinationsdateneinheits-ID konfiguriert ist, dem Basisdienst die Koordinationsdateneinheit zu melden, an die die Gebührenerfassungsanforderungsinformationen gesendet werden sollen; und<!-- EPO <DP n="33"> --></claim-text>
<claim-text>die Dienstkontrollpunktinstanz konfiguriert ist, die zusammengesetzte Dienstoperationsinstanz zu kennzeichnen, die dem Basisdienst entspricht, und eine Gebührenerfassungssitzung zwischen dem Basisdienst und einer Onlinemaschine zu kennzeichnen.</claim-text></claim-text></claim-text></claim><claim id="c-de-01-0002" num="0002"><claim-text>Verfahren nach Anspruch 1, wobei die Gebührenerfassungsanforderungsinformationen eine Gebührenerfassungssitzungs-ID, Gebührenerfassungsinformationen des Basisdienstes, Typinformationen einer Gebührenerfassungsanforderungsnachricht und Typinformationen einer Gebührenerfassungsanforderungsnachricht-Sendedateneinheit umfassen; und<br/>
wenn die Gebührenerfassungsanforderungsnachricht eine anfängliche Gebührenerfassungsanforderungsnachricht ist, die Gebührenerfassungssitzungs-ID die Korrelations-ID aufweist.</claim-text></claim><claim id="c-de-01-0003" num="0003"><claim-text>Verfahren nach Anspruch 2, wobei das Durchführen des Dienstkoordinationsprozesses an den vom Basisdienst empfangenen Gebührenerfassungsanforderungsinformationen gemäß der Gebührenerfassungsmerkmale jedes Basisdienstes und das Regenerieren der Gebührenerfassungsanforderungsinformationen, die die Gebührenerfassungsmerkmale jedes Basisdienstes kombinieren, Folgendes umfasst:
<claim-text>Erfassen (305) der Gebührenerfassungskontrollpunktinstanz und der zusammengesetzten Dienstoperationsinstanz, die die Verbindungsbeziehung mit der Korrelations-ID oder der Gebührenerfassungssitzungs-ID aufweisen, gemäß der Korrelations-ID oder der Gebührenerfassungssitzungs-ID;</claim-text>
<claim-text>Umwandeln (306) der Gebührenerfassungsanforderungsnachricht in Ereignisinformationen gemäß der Typinformationen der Gebührenerfassungsanforderungsnachricht und der Typinformationen der Gebührenerfassungsanforderungsnachricht-Sendedateneinheit; und</claim-text>
<claim-text>Vergleichen (307) der Ereignisinformationen, und nach dem Bestehen der Vergleichsoperation, Durchführen des Dienstkoordinationsprozesses an den Gebührenerfassungsanforderungsinformationen durch einen extern eingegebenen Logikcode und/oder einen gespeicherten Logikcode und/oder einen Logikcode, der durch die zusammengesetzte Dienstoperationsinstanz zugewiesen wird, und Regenerieren der Gebührenerfassungsanforderungsinformationen, die die Gebührenerfassungsmerkmale jedes Basisdienstes kombinieren.</claim-text><!-- EPO <DP n="34"> --></claim-text></claim><claim id="c-de-01-0004" num="0004"><claim-text>Verfahren nach Anspruch 3, wobei das Erfassen der Gebührenerfassungskontrollpunktinstanz und der zusammengesetzten Dienstoperationsinstanz, die die Verbindungsbeziehung mit der Korrelations-ID oder der Gebührenerfassungssitzungs-ID aufweisen, gemäß der Korrelations-ID oder der Gebührenerfassungssitzungs-ID, Folgendes umfasst:
<claim-text>Erfassen der Gebührenerfassungskontrollpunktinstanz und der zusammengesetzten Dienstoperationsinstanz, die die Verbindungsbeziehung mit der Korrelations-ID aufweisen, gemäß der Korrelations-ID in der Gebührenerfassungssitzungs-ID, wenn die Gebührenerfassungsanforderungsnachricht die anfängliche Gebührenerfassungsanforderungsnachricht ist, und Herstellen der Verbindungsbeziehung zwischen der Gebührenerfassungssitzungs-ID und der Gebührenerfassungskontrollpunktinstanz und der Verbindungsbeziehung zwischen der Gebührenerfassungssitzungs-ID und der zusammengesetzten Dienstoperationsinstanz; und</claim-text>
<claim-text>Erfassen der Gebührenerfassungskontrollpunktinstanz und der zusammengesetzten Dienstoperationsinstanz, die die Verbindungsbeziehung mit der Gebührenerfassungssitzungs-ID aufweisen, gemäß der Gebührenerfassungssitzungs-ID, wenn die Gebührenerfassungsanforderungsnachricht eine nicht anfängliche Gebührenerfassungsanforderungsnachricht ist.</claim-text></claim-text></claim><claim id="c-de-01-0005" num="0005"><claim-text>Verfahren nach Anspruch 3, wobei die Ereignisinformationen Ereignisnameninformationen und eine Dienstkontrollpunktinstanz des Ereignisses umfassen.</claim-text></claim><claim id="c-de-01-0006" num="0006"><claim-text>Verfahren nach Anspruch 1, wobei das Durchführen des Dienstkoordinationsprozesses Folgendes umfasst:
<claim-text>Durchführen einer Modifizierungsoperation und/oder einer Löschoperation und/oder einer Additionsoperation an den Gebührenerfassungsanforderungsinformationen.</claim-text></claim-text></claim><claim id="c-de-01-0007" num="0007"><claim-text>Verfahren nach Anspruch 2, wobei nach dem Senden der regenerierten Gebührenerfassungsanforderungsinformationen an die Gebührenerfassungsmaschine, das Verfahren ferner Folgendes umfasst:
<claim-text>Empfangen (309) durch die Gebührenerfassungsmaschine der Gebührenerfassungsanforderungsinformationen, Aufzeichnen der Gebührenerfassungssitzungs-ID in den Gebührenerfassungsanforderungsinformationen und Zurückschicken von<!-- EPO <DP n="35"> --> Gebührenerfassungsantwortinformationen;</claim-text>
<claim-text>Empfangen (310) der durch die Gebührenerfassungsmaschine zurückgeschickten Gebührenerfassungsantwortinformationen; und</claim-text>
<claim-text>Senden (311) der Gebührenerfassungsantwortinformationen an den Basisdienst.</claim-text></claim-text></claim><claim id="c-de-01-0008" num="0008"><claim-text>Gebührenerfassungssteuervorrichtung zur Ausführung eines zusammengesetzten Gebührenerfassungsdienstes für einen zusammengesetzten Dienst, wobei der zusammengesetzte Dienst eine Dienstkombination ist, die durch mehrere Basisdienste gebildet wird, wobei die Vorrichtung Folgendes umfasst:
<claim-text>eine Gebührenerfassungsinformationsempfangseinheit (133), die konfiguriert ist, Gebührenerfassungsanforderungsinformationen von einem Basisdienst zu empfangen;</claim-text>
<claim-text>einen Koordinator (134), der konfiguriert ist, einen Dienstkoordinationsprozess an den vom Basisdienst empfangenen Gebührenerfassungsanforderungsinformationen gemäß Gebührenerfassungsmerkmalen jedes Basisdienstes durchzuführen und Gebührenerfassungsanforderungsinformationen zu regenerieren, die die Gebührenerfassungsmerkmale jedes Basisdienstes kombinieren; und</claim-text>
<claim-text>eine Gebührenerfassungsinformationssendeeinheit (135), die konfiguriert ist, die regenerierten Gebührenerfassungsanforderungsinformationen an eine Gebührenerfassungsmaschine zu senden; und</claim-text>
<claim-text>wobei die Vorrichtung <b>dadurch gekennzeichnet ist, dass</b> sie ferner Folgendes aufweist:
<claim-text>eine Kennungs- (ID) und Instanzerzeugungseinheit (131), die konfiguriert ist, eine Gebührenerfassungskoordinations-ID, eine Korrelations-ID, eine Koordinationsdateneinheits-ID und eine Gebührenerfassungskontrollpunktinstanz zu erzeugen; und</claim-text>
<claim-text>wobei der Koordinator (134) ferner konfiguriert ist, eine Verbindungsbeziehung zwischen der Korrelations-ID und der Gebührenerfassungskontrollpunktinstanz und eine Verbindungsbeziehung zwischen der Korrelations-ID und einer zusammengesetzten Dienstoperationsinstanz in einer Dienstzusammensetzungsmaschine herzustellen;</claim-text>
<claim-text>eine Basisdienstaufrufeinheit (132), die konfiguriert ist, eine Aufrufoperation an jedem Basisdienst einzuleiten, wobei Informationen der Aufrufoperation die Gebührenerfassungskoordinations-ID, die Korrelations-ID und die Koordinationsdateneinheits-ID umfassen;</claim-text>
<claim-text>wobei die Gebührenerfassungskoordinations-ID konfiguriert ist, zu repräsentieren, dass der Dienstkoordinationsprozess am aufgerufenen Basisdienst ausgeführt werden<!-- EPO <DP n="36"> --> muss und wie der Koordinationsprozess auszuführen ist;</claim-text>
<claim-text>die Korrelations-ID konfiguriert ist, die Dienstkontrollpunktinstanz und die zusammengesetzte Dienstoperationsinstanz zu kennzeichnen, die die Verbindungsbeziehung mit dem Basisdienst aufweisen;</claim-text>
<claim-text>die Koordinationsdateneinheits-ID konfiguriert ist, dem Basisdienst die Koordinationsdateneinheit zu melden, an die die Gebührenerfassungsanforderungsinformationen gesendet werden sollen; und</claim-text>
<claim-text>die Dienstkontrollpunktinstanz konfiguriert ist, die zusammengesetzte Dienstoperationsinstanz zu kennzeichnen, die dem Basisdienst entspricht, und eine Gebührenerfassungssitzung zwischen dem Basisdienst und einer Onlinemaschine zu kennzeichnen.</claim-text></claim-text></claim-text></claim><claim id="c-de-01-0009" num="0009"><claim-text>System zur Ausführung eines zusammengesetzten Gebührenerfassungsdienstes, das durch eine Dienstzusammensetzungsmaschine (110) und eine Gebührenerfassungsmaschine (120) gebildet wird, wobei eine Gebührenerfassungssteuervorrichtung (130) nach Anspruch 8 im System angeordnet ist.</claim-text></claim><claim id="c-de-01-0010" num="0010"><claim-text>Dienstzusammensetzungsmaschine, wobei eine Gebührenerfassungssteuervorrichtung nach Anspruch 8 in der Zusammensetzungsmaschine angeordnet ist.</claim-text></claim></claims><claims mxw-id="PCLM56983947" lang="EN" load-source="patent-office"><!-- EPO <DP n="28"> --><claim id="c-en-01-0001" num="0001"><claim-text>A method for realizing a composite charging service for a composite service, wherein the composite service is a service combination formed by a plurality of base services, the method comprising:
<claim-text>receiving (304) a charging request information from a base service;</claim-text>
<claim-text>performing (307) a service coordination process on the received charging request information from the base service according to charging features of each base service;</claim-text>
<claim-text>regenerating a charging request information combining the charging features of each base service; and</claim-text>
<claim-text>sending (308) the regenerated charging request information to a charging engine;</claim-text>
<claim-text>the method <b>characterized in that</b> before the receiving the charging request information from the base service, the method further comprises:
<claim-text>generating (301) a charging coordination identifier, ID, a correlation ID, a coordination entity ID, and a charging control point instance;</claim-text>
<claim-text>establishing an association relation between the correlation ID and the charging control point instance and an association relation between the correlation ID and a composite service operation instance; and</claim-text>
<claim-text>initiating (302) an invoke operation to each base service, wherein information of the invoke operation comprises the charging coordination ID, the correlation ID, and the coordination entity ID,</claim-text>
<claim-text>the charging coordination ID is configured to represent that the service coordination process needs to be performed on the invoked base service and how to perform the coordination process;</claim-text>
<claim-text>the correlation ID is configured to identify the service control point instance and the composite service operation instance having the association relation with the base service;</claim-text>
<claim-text>the coordination entity ID is configured to notify the base service of the coordination entity to which the charging request information is required to be sent; and</claim-text>
<claim-text>the service control point instance is configured to identify the composite service operation instance corresponding to the base service, and identify a charging session<!-- EPO <DP n="29"> --> between the base service and an online engine.</claim-text></claim-text></claim-text></claim><claim id="c-en-01-0002" num="0002"><claim-text>The method according to claim 1, wherein the charging request information comprises a charging session ID, charging information of the base service, type information of a charging request message, and type information of a charging request message sending entity; and<br/>
when the charging request message is an initial charging request message, the charging session ID comprises the correlation ID.</claim-text></claim><claim id="c-en-01-0003" num="0003"><claim-text>The method according to claim 2, wherein the performing the service coordination process on the received charging request information from the base service according to the charging features of each base service, and regenerating the charging request information combining the charging features of each base service comprises:
<claim-text>acquiring (305) the charging control point instance and the composite service operation instance having the association relation with the correlation ID or the charging session ID according to the correlation ID or the charging session ID;</claim-text>
<claim-text>converting (306) the charging request message into event information according to the type information of the charging request message and the type information of the charging request message sending entity; and</claim-text>
<claim-text>matching (307) the event information, and after passing the matching operation, performing the service coordination process on the charging request information through at least one of an externally input logic code, a stored logic code, and a logic code assigned by the composite service operation instance, and regenerating the charging request information combining the charging features of each base service.</claim-text></claim-text></claim><claim id="c-en-01-0004" num="0004"><claim-text>The method according to claim 3, wherein the acquiring the charging control point instance and the composite service operation instance having the association relation with the correlation ID or the charging session ID according to the correlation ID or the charging session ID comprises:
<claim-text>acquiring the charging control point instance and the composite service operation instance having the association relation with the correlation ID according to the correlation ID in the charging session ID, if the charging request message is the initial charging request message, and establishing the association relation between the charging session ID and the<!-- EPO <DP n="30"> --> charging control point instance and the association relation between the charging session ID and the composite service operation instance; and</claim-text>
<claim-text>acquiring the charging control point instance and the composite service operation instance having the association relation with the charging session ID according to the charging session IDif the charging request message is a non-initial charging request message.</claim-text></claim-text></claim><claim id="c-en-01-0005" num="0005"><claim-text>The method according to claim 3, wherein the event information comprises event name information and a service control point instance of the event.</claim-text></claim><claim id="c-en-01-0006" num="0006"><claim-text>The method according to claim 1, wherein the performing the service coordination process comprises:
<claim-text>performing at least one of a modifying operation, a deleting operation, and an adding operation on the charging request information.</claim-text></claim-text></claim><claim id="c-en-01-0007" num="0007"><claim-text>The method according to claim 2, wherein after the sending the regenerated charging request information to the charging engine, the method further comprises:
<claim-text>receiving (309), by the charging engine, the charging request information, recording the charging session ID in the charging request information, and returning charging response information;</claim-text>
<claim-text>receiving (310) the charging response information returned by the charging engine; and</claim-text>
<claim-text>sending (311) the charging response information to the base service.</claim-text></claim-text></claim><claim id="c-en-01-0008" num="0008"><claim-text>A charging control apparatus for realizing a composite charging service for a composite service, wherein the composite service is a service combination formed by a plurality of base services, the apparatus comprising:
<claim-text>a charging information receiving unit (133), configured to receive a charging request information from a base service;</claim-text>
<claim-text>a coordinator (134), configured to perform a service coordination process on the received charging request information from the base service according to charging features of each base service, and regenerate a charging request information combining the charging features of each base service; and</claim-text>
<claim-text>a charging information sending unit (135), configured to send the regenerated charging<!-- EPO <DP n="31"> --> request information to a charging engine; and</claim-text>
<claim-text>the apparatus <b>characterized in that</b> it further comprises:
<claim-text>an identifier (ID) and instance generating unit (131), configured to generate a charging coordination ID, a correlation ID, a coordination entity ID, and a charging control point instance; and</claim-text>
<claim-text>the coordinator (134) is further configured to establish an association relation between the correlation ID and the charging control point instance and an association relation between the correlation ID and a composite service operation instance in a service composition engine;</claim-text>
<claim-text>a base service invoking unit (132), configured to initiate an invoke operation to each base service, wherein information of the invoke operation comprises the charging coordination ID, the correlation ID, and the coordination entity ID;</claim-text>
<claim-text>the charging coordination ID is configured to represent that the service coordination process needs to be performed on the invoked base service and how to perform the coordination process;</claim-text>
<claim-text>the correlation ID is configured to identify the service control point instance and the composite service operation instance having the association relation with the base service;</claim-text>
<claim-text>the coordination entity ID is configured to notify the base service of the coordination entity to which the charging request information is required to be sent; and</claim-text>
<claim-text>the service control point instance is configured to identify the composite service operation instance corresponding to the base service, and identify a charging session between the base service and an online engine.</claim-text></claim-text></claim-text></claim><claim id="c-en-01-0009" num="0009"><claim-text>A system for realizing a composite charging service, formed by a service composition engine (110) and a charging engine (120), wherein a charging control apparatus (130) according to claim 8 is disposed in the system.</claim-text></claim><claim id="c-en-01-0010" num="0010"><claim-text>A service composition engine, wherein a charging control apparatus according to claim 8 is disposed in the composition engine.</claim-text></claim></claims><claims mxw-id="PCLM56983948" lang="FR" load-source="patent-office"><!-- EPO <DP n="37"> --><claim id="c-fr-01-0001" num="0001"><claim-text>Procédé pour mettre en oeuvre un service de facturation combiné dans un service combiné, dans lequel le service combiné est une combinaison de services formée d'une pluralité de services de base, le procédé comprenant les étapes suivantes :
<claim-text>recevoir (304) des informations de demande de facturation provenant d'un service de base ;</claim-text>
<claim-text>exécuter (307) un processus de coordination de services sur les informations de demande de facturation reçues du service de base conformément aux caractéristiques de facturation de chaque service de base ;</claim-text>
<claim-text>régénérer des informations de demande de facturation combinant les caractéristiques de facturation de chaque service de base ; et</claim-text>
<claim-text>envoyer (308) les informations de demande de facturation régénérées à un moteur de facturation ;</claim-text>
<claim-text>le procédé étant <b>caractérisé en ce que</b>, avant la réception des informations de demande de facturation du service de base, le procédé comprend en outre les étapes suivantes :
<claim-text>générer (301) un identifiant, ID, de coordination de facturation, un ID de corrélation, un ID d'entité de coordination, et une instance de point de contrôle de facturation ;</claim-text>
<claim-text>établir une relation d'association entre l'ID de corrélation et l'instance de point de contrôle de facturation et une relation d'association entre l'ID de corrélation et une instance d'exécution de service combiné ; et</claim-text>
<claim-text>initier (302) une opération de demande vers chaque service de base, où des informations de l'opération de demande comprennent l'ID de coordination de facturation, l'ID de corrélation, et l'ID d'entité de coordination,</claim-text>
<claim-text>l'ID de coordination de facturation est configuré pour représenter ce dont le processus de coordination de service a besoin pour être exécuté sur le service de base demandé et comment exécuter le processus de coordination ;</claim-text>
<claim-text>l'ID de corrélation est configuré pour identifier l'instance de point de contrôle de service et l'instance d'exécution de service combiné ayant la relation d'association avec le service de base ;</claim-text>
<claim-text>l'ID d'entité de coordination est configuré pour notifier le service de base de l'entité de coordination à laquelle les informations de demande de facturation doivent être envoyées ; et<!-- EPO <DP n="38"> --></claim-text>
<claim-text>l'instance de point de contrôle de service est configurée pour identifier l'instance d'exécution de service combiné correspondant au service de base, et identifier une session de facturation entre le service de base et un moteur en ligne.</claim-text></claim-text></claim-text></claim><claim id="c-fr-01-0002" num="0002"><claim-text>Procédé selon la revendication 1, dans lequel les informations de demande de facturation comprennent un ID de session de facturation, des informations de facturation du service de base, des informations du type de message de demande de facturation, des informations du type d'une entité envoyant un message de demande de facturation ; et<br/>
lorsque le message de demande de facturation est un message de demande de facturation initial, l'ID de session de facturation comprend l'ID de corrélation.</claim-text></claim><claim id="c-fr-01-0003" num="0003"><claim-text>Procédé selon la revendication 2, dans lequel l'exécution du processus de coordination de service sur les informations de demande de facturation reçues provenant du service de base conformément aux caractéristiques de facturation de chaque service de base, et la régénération des informations de demande de facturation combinant les caractéristiques de facturation de chaque service de base, comprennent les étapes suivantes :
<claim-text>acquérir (305) l'instance de point de contrôle de facturation et l'instance d'exécution de service combiné ayant la relation d'association avec l'ID de corrélation ou l'ID de session de facturation conformément à l'ID de corrélation ou à l'ID de session de facturation ;</claim-text>
<claim-text>convertir (306) le message de demande de facturation en informations d'événement conformément aux informations du type de message de demande de facturation et aux informations du type de l'entité envoyant un message de demande de facturation ; et</claim-text>
<claim-text>faire correspondre (307) les informations d'événement, et après exécution réussie de l'opération de correspondance, exécuter le processus de coordination de service sur les informations de demande de facturation par l'intermédiaire d'au moins un parmi un code logique d'entrée externe, un code logique stocké et un code logique assigné par l'instance d'exécution de service combiné, et régénérer les informations de demande de facturation en combinant les caractéristiques de facturation de chaque service de base.</claim-text></claim-text></claim><claim id="c-fr-01-0004" num="0004"><claim-text>Procédé selon la revendication 3, dans lequel l'acquisition de l'instance de point de contrôle de facturation et de l'instance d'exécution de service combiné, ayant la<!-- EPO <DP n="39"> --> relation d'association avec l'ID de corrélation ou l'ID de session de facturation conformément à l'ID de corrélation ou à l'ID de session de facturation , comprend les étapes suivantes :
<claim-text>acquérir l'instance de point de contrôle de facturation et l'instance d'exécution de service combiné ayant la relation d'association avec l'ID de corrélation conformément à l'ID de corrélation dans l'ID de session de facturation, si le message de demande de facturation est le message de demande de facturation initial, et établir la relation d'association entre l'ID de session de facturation et l'instance de point de contrôle de facturation et la relation d'association entre l'ID de session de facturation et l'instance d'exécution de service combiné ; et</claim-text>
<claim-text>acquérir l'instance de point de contrôle de facturation et l'instance d'exécution de service combiné ayant la relation d'association avec l'ID de session de facturation conformément à l'ID de session de facturation, si le message de demande de facturation est un message de demande de facturation non initial.</claim-text></claim-text></claim><claim id="c-fr-01-0005" num="0005"><claim-text>Procédé selon la revendication 3, dans lequel les informations d'événement comprennent des informations de nom d'événement et une instance de point de contrôle de service de l'événement.</claim-text></claim><claim id="c-fr-01-0006" num="0006"><claim-text>Procédé selon la revendication 1, dans lequel l'exécution du processus de coordination de service comprend l'étape suivante :
<claim-text>exécuter au moins une opération parmi une opération de modification, une opération de suppression, et une opération d'ajout sur les informations de demande de facturation.</claim-text></claim-text></claim><claim id="c-fr-01-0007" num="0007"><claim-text>Procédé selon la revendication 2, dans lequel après l'envoi des informations de demande de facturation régénérées au moteur de facturation, le procédé comprend en outre les étapes suivantes :
<claim-text>recevoir (309), par l'intermédiaire du moteur de facturation, les informations de demande de facturation, enregistrer l'ID de session de facturation dans les informations de demande de facturation, et retourner les informations de réponse de facturation ;</claim-text>
<claim-text>recevoir (310) les informations de réponse de facturation retournées par le moteur de facturation ; et</claim-text>
<claim-text>envoyer (311) les informations de réponse de facturation au service de base.</claim-text><!-- EPO <DP n="40"> --></claim-text></claim><claim id="c-fr-01-0008" num="0008"><claim-text>Appareil de contrôle de facturation pour mettre en oeuvre un service de facturation combiné pour un service combiné, dans lequel le service combiné est une combinaison de services formée d'une pluralité de services de base, l'appareil comprenant :
<claim-text>une unité de réception d'informations de facturation (133), configurée pour recevoir des informations de demande de facturation provenant d'un service de base ;</claim-text>
<claim-text>un coordinateur (134), configuré pour exécuter un processus de coordination de services sur les informations de demande de facturation reçues reçues du service de base conformément aux caractéristiques de facturation de chaque service de base, et pour régénérer des informations de demande de facturation combinant les caractéristiques de facturation de chaque service de base ; et</claim-text>
<claim-text>une unité d'envoi d'informations de facturation (135), configurée pour envoyer les informations de demande de facturation régénérées à un moteur de facturation ; et</claim-text>
<claim-text>l'appareil est <b>caractérisé en ce qu'</b>il comprend en outre :
<claim-text>une unité de génération d'instance et d'identifiant (131), configurée pour générer un ID de coordination de facturation, un ID de corrélation, un ID d'entité de coordination, et une instance de point de contrôle de facturation ; et</claim-text>
<claim-text>le coordinateur (134) est en outre configuré pour établir une relation d'association entre l'ID de corrélation et l'instance de point de contrôle de facturation et une relation d'association entre l'ID de corrélation et une instance d'exécution de service combiné dans un moteur de composition de service ;</claim-text>
<claim-text>une unité de demande de service de base (132), configurée pour initier une opération de demande vers chaque service de base, où des informations de l'opération de demande comprennent l'ID de coordination de facturation, l'ID de corrélation, et l'ID d'entité de coordination ;</claim-text>
<claim-text>l'ID de coordination de facturation est configuré pour représenter ce dont le processus de coordination de service a besoin pour être exécuté sur le service de base demandé et comment exécuter le processus de coordination ;</claim-text>
<claim-text>l'ID de corrélation est configuré pour identifier l'instance de point de contrôle de service et l'instance d'exécution de service combiné ayant la relation d'association avec le service de base ;</claim-text>
<claim-text>l'ID d'entité de coordination est configuré pour notifier le service de base de l'entité de coordination à laquelle les informations de demande de facturation doivent être envoyées ; et<!-- EPO <DP n="41"> --></claim-text>
<claim-text>l'instance de point de contrôle de service est configurée pour identifier l'instance d'exécution de service combiné correspondant au service de base, et identifier une session de facturation entre le service de base et un moteur en ligne.</claim-text></claim-text></claim-text></claim><claim id="c-fr-01-0009" num="0009"><claim-text>Système pour mettre en oeuvre un service de facturation combiné, formé d'un moteur de composition de service (110) et d'un moteur de facturation (120), où un appareil de contrôle de facturation (130) selon la revendication 8 est installé dans le système.</claim-text></claim><claim id="c-fr-01-0010" num="0010"><claim-text>Moteur de composition de service, dans lequel un appareil de contrôle de facturation selon la revendication 8 est installé dans le moteur de composition.</claim-text></claim></claims><drawings mxw-id="PDW16671701" load-source="patent-office"><!-- EPO <DP n="42"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="108" he="99" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="43"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="86" he="147" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="44"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="155" he="206" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="45"> --><figure id="f0004" num="4"><img id="if0004" file="imgf0004.tif" wi="156" he="203" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="46"> --><figure id="f0005" num="5"><img id="if0005" file="imgf0005.tif" wi="149" he="201" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="47"> --><figure id="f0006" num="6"><img id="if0006" file="imgf0006.tif" wi="160" he="207" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="48"> --><figure id="f0007" num="7"><img id="if0007" file="imgf0007.tif" wi="158" he="103" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="49"> --><figure id="f0008" num="8"><img id="if0008" file="imgf0008.tif" wi="157" he="171" img-content="drawing" img-format="tif"/></figure></drawings><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
