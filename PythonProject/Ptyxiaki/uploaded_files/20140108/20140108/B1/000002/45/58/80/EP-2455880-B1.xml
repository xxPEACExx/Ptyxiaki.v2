<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2455880-B1" country="EP" doc-number="2455880" kind="B1" date="20140108" family-id="44259892" file-reference-id="315078" date-produced="20180826" status="corrected" lang="FR"><bibliographic-data><publication-reference fvid="146588388" ucid="EP-2455880-B1"><document-id><country>EP</country><doc-number>2455880</doc-number><kind>B1</kind><date>20140108</date><lang>FR</lang></document-id></publication-reference><application-reference ucid="EP-11189804-A" is-representative="YES"><document-id mxw-id="PAPP154850580" load-source="docdb" format="epo"><country>EP</country><doc-number>11189804</doc-number><kind>A</kind><date>20111118</date><lang>FR</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140547069" ucid="FR-1059464-A" load-source="docdb"><document-id format="epo"><country>FR</country><doc-number>1059464</doc-number><kind>A</kind><date>20101118</date></document-id></priority-claim></priority-claims><dates-of-public-availability><intention-to-grant-date><date>20130705</date></intention-to-grant-date></dates-of-public-availability><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1989325492" load-source="ipcr">H04N   7/16        20110101ALI20120216BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1989325493" load-source="ipcr">H04L  12/28        20060101ALI20120216BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1989325494" load-source="ipcr">G06F  21/00        20130101AFI20120216BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL1989624791" load-source="docdb" scheme="CPC">H04N  21/6175      20130101 LI20131204BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989637116" load-source="docdb" scheme="CPC">H04N  21/26606     20130101 FI20131204BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989641573" load-source="docdb" scheme="CPC">H04N  21/2347      20130101 LI20130415BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989650279" load-source="docdb" scheme="CPC">H04N  21/6125      20130101 LI20130415BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132369797" lang="DE" load-source="patent-office">Sendeeinheit für IP-Netz mit verschlüsselten digitalen Videodatenströmen an direkt mit diesem Netz verbundene IP-Endgeräte</invention-title><invention-title mxw-id="PT132369798" lang="EN" load-source="patent-office">Assembly for broadcasting scrambled digital video streams via an IP network to IP terminals connected directly to said network</invention-title><invention-title mxw-id="PT132369799" lang="FR" load-source="patent-office">Ensemble de diffusion par réseau IP de flux video numériques brouillés vers des terminaux IP directement reliés à ce réseau</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR919524634" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>FREEBOX</last-name><address><country>FR</country></address></addressbook></applicant><applicant mxw-id="PPAR919504086" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>FREEBOX</last-name></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919529526" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>MASSIOT CHRISTOPHE</last-name><address><country>FR</country></address></addressbook></inventor><inventor mxw-id="PPAR919543863" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>Massiot, Christophe</last-name></addressbook></inventor><inventor mxw-id="PPAR919022890" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Massiot, Christophe</last-name><address><street>12 rue Bézout</street><city>75014 Paris</city><country>FR</country></address></addressbook></inventor></inventors><assignees><assignee mxw-id="PPAR919022889" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>FREEBOX</last-name><iid>101179505</iid><address><street>8, rue de la Ville L'Evêque</street><city>75008 Paris</city><country>FR</country></address></addressbook></assignee></assignees><agents><agent mxw-id="PPAR919022888" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Dupuis-Latour, Dominique</last-name><iid>101064756</iid><address><street>Bardehle Pagenberg 10, boulevard Haussmann</street><city>75009 Paris</city><country>FR</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS549892443" load-source="docdb">AL</country><country mxw-id="DS549923787" load-source="docdb">AT</country><country mxw-id="DS549892444" load-source="docdb">BE</country><country mxw-id="DS549878601" load-source="docdb">BG</country><country mxw-id="DS549869624" load-source="docdb">CH</country><country mxw-id="DS549802334" load-source="docdb">CY</country><country mxw-id="DS549923788" load-source="docdb">CZ</country><country mxw-id="DS549892449" load-source="docdb">DE</country><country mxw-id="DS549802335" load-source="docdb">DK</country><country mxw-id="DS549802344" load-source="docdb">EE</country><country mxw-id="DS549785027" load-source="docdb">ES</country><country mxw-id="DS549878606" load-source="docdb">FI</country><country mxw-id="DS549869625" load-source="docdb">FR</country><country mxw-id="DS549892450" load-source="docdb">GB</country><country mxw-id="DS549802345" load-source="docdb">GR</country><country mxw-id="DS549892451" load-source="docdb">HR</country><country mxw-id="DS549923789" load-source="docdb">HU</country><country mxw-id="DS549873067" load-source="docdb">IE</country><country mxw-id="DS549802346" load-source="docdb">IS</country><country mxw-id="DS549869626" load-source="docdb">IT</country><country mxw-id="DS549802347" load-source="docdb">LI</country><country mxw-id="DS549878607" load-source="docdb">LT</country><country mxw-id="DS549784510" load-source="docdb">LU</country><country mxw-id="DS549878608" load-source="docdb">LV</country><country mxw-id="DS549878609" load-source="docdb">MC</country><country mxw-id="DS549784511" load-source="docdb">MK</country><country mxw-id="DS549784512" load-source="docdb">MT</country><country mxw-id="DS549802352" load-source="docdb">NL</country><country mxw-id="DS549892452" load-source="docdb">NO</country><country mxw-id="DS549802353" load-source="docdb">PL</country><country mxw-id="DS549878614" load-source="docdb">PT</country><country mxw-id="DS549923790" load-source="docdb">RO</country><country mxw-id="DS549878615" load-source="docdb">RS</country><country mxw-id="DS549802354" load-source="docdb">SE</country><country mxw-id="DS549869627" load-source="docdb">SI</country><country mxw-id="DS549892457" load-source="docdb">SK</country><country mxw-id="DS549892458" load-source="docdb">SM</country><country mxw-id="DS549784525" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data></bibliographic-data><description mxw-id="PDES63960811" lang="FR" load-source="patent-office"><!-- EPO <DP n="1"> --><p id="p0001" num="0001">L'invention concerne la diffusion des flux vidéo numériques par un réseau de type IP (<i>Internet Protocol</i>).</p><p id="p0002" num="0002">Elle concerne notamment la diffusion de flux vidéo tels que les programmes de télévision par une technologie de type xDSL (<i>Digital Subscriber Line,</i> ligne numérique d'abonné), principalement par une technologie ADSL (<i>Asymmetric DSL</i>) ou fibre optique (notamment l'offre FTTH <i>Fiber To The Home</i>), par un opérateur de télécommunication ou fournisseur d'accès Internet (FAI) (ci-après dénommés "opérateur") à un client connu de cet opérateur (ci-après désigné "abonné").</p><p id="p0003" num="0003">La configuration typique de base pour une telle diffusion de programmes de télévision est illustrée <figref idrefs="f0001">Figure 1 (a)</figref>.</p><p id="p0004" num="0004">Dans cette configuration, la tête de réseau 10 de l'opérateur diffuse des programmes qui sont relayés vers les abonnés au moyen de commutateurs 12, par exemple un DSLAM (<i>Digital Subscriber Line Access Multiplexers,</i> multiplexeur d'accès à la ligne numérique de l'abonné), généralement installés au niveau des centraux répartiteurs de l'opérateur. Les commutateurs assurent l'interfaçage entre la tête de réseau 10 et la boucle locale à destination des divers abonnés. Chaque abonné dispose d'un équipement 14 de type "box" (boîtier), ci-après désigné "passerelle" (<i>gateway</i>), relié au commutateur par une liaison filaire ADSL ou par une liaison en fibre optique de type FTTH. Un exemple de tel boîtier 14 est l'équipement distribué sous la désignation <i>Freebox</i> par l'opérateur <i>Free,</i> Paris, France.</p><p id="p0005" num="0005">La passerelle 14 peut être un boîtier d'interfaçage multifonction, par exemple téléphone, réseau IP (par réseau filaire <i>Ethernet</i> ou sans fil <i>Wi-Fi</i>), télévision et mobile (par exemple à l'aide d'une technologie de type "femtocellule"). En ce qui concerne la télévision, la passerelle 14 est reliée par voie filaire ou sans fil à un boîtier 16 branché sur le téléviseur 18 de l'abonné, par exemple l'équipement distribué par l'opérateur Free sous la dénomination <i>Freebox HD.</i> Ce boîtier intègre décodeur, magnétoscope numérique à disque dur, serveur domestique, etc. Il assure notamment le décodage des différents signaux du flux video, qui pourront être visionnés sur le téléviseur 18. On désignera ci-après par "service" la diffusion de video, d'audio ou de métadonnées (sous-titres, données de programmes, applications interactives, etc.) à destination de l'abonné.<!-- EPO <DP n="2"> --></p><p id="p0006" num="0006">L'invention concerne plus précisément la sécurisation des flux de télévision numérique ainsi diffusés par l'opérateur.</p><p id="p0007" num="0007">Cette sécurisation met en général en oeuvre un mécanisme de protection à deux niveaux de cryptographie, correspondant à deux buts bien distincts (bien que souvent résolus par le même biais technique) :
<ul><li>contrôle d'accès : il s'agit d'empêcher un non-abonné d'accéder au service ;</li><li>protection numérique : il s'agit d'empêcher un abonné d'enregistrer le service sous une forme qui permettrait une redistribution ou une conservation non contrôlée.</li></ul></p><p id="p0008" num="0008">Les composantes audio et vidéo du service à diffuser font l'objet au préalable d'une compression par un encodeur, au moyen de procédés tels que ceux prescrits en particulier par les normes ISO/IEC 13818-2 et 3 (dites MPEG-2).</p><p id="p0009" num="0009">Après compression, les différentes composantes encodées forment des flux élémentaires continus appelés ES (<i>Elementary Stream,</i> flux élémentaire). Les flux ES sont ensuite découpés en paquets de taille variable ou PES (<i>Packetized Elementary Stream,</i> flux élémentaire en paquets), qui sont ensuite eux-mêmes découpés en paquets de taille fixe TS (<i>Transport Stream,</i> flux de transport). Chaque paquet TS est un paquet de 188 octets comprenant un en-tête d'au moins 4 octets, comprenant différents indicateurs qualifiant le contenu du paquet, ainsi qu'un numéro codé sur 13 bits (de 0000 à 8191) appelé PID (<i>Packet IDentifier,</i> identifiant de paquet), caractérisant l'appartenance des données du paquet.</p><p id="p0010" num="0010">Les paquets TS provenant des différents flux élémentaires sont ensuite multiplexés pour former un train de données binaires final, qui sera émis sur des supports de transmission tels que satellite, câble, diffusion hertzienne terrestre ou réseau IP, notamment diffusion xDSL, fibre optique ou mobile (par exemple à l'aide d'une technologie de type femtocellule).</p><p id="p0011" num="0011">Ce découpage en paquets et la distribution des flux vidéo numériques sont définis par la norme ISO/IEC 13818-1 (dite MPEG-2 système), et plus particulièrement sous la sous-partie dénommée "flux de transport". La norme peut être éventuellement étendue ou précisée par des normes régionales, notamment la norme européenne DVB ou la norme américaine ATSC.<!-- EPO <DP n="3"> --></p><p id="p0012" num="0012">Pour assurer la sécurisation des flux évoquée plus haut, les contenus (<i>payload,</i> charge utile) des paquets élémentaires TS composant un même service sont embrouillés selon un algorithme commun, tenu secret, appelé "DVB-CSA", proche de l'algorithme public DES. D'autres algorithmes peuvent être utilisés, tels que AES ou DVB-CSA3. Ces algorithmes utilisent tous une clé symétrique, c'est-à-dire que la clé pour embrouiller et désembrouiller le flux est la même. Cette clé est appelée "mot de contrôle" ou <i>Control Word</i> (CW) et sa taille est fixe, 64 bits pour DVB-CSA.</p><p id="p0013" num="0013">Ce type d'algorithme résiste mal aux attaques en force brute, et pourrait être piraté en quelques jours ou quelques semaines de calcul sur des ordinateurs du commerce. Cela n'a toutefois aucune importance, car la clé DVB-CSA (le "mot de contrôle" CW) change régulièrement, de façon aléatoire, au bout d'une durée appelée "crypto-période", généralement de l'ordre de 10 secondes. De ce fait, pour pirater un programme d'une heure et demie, il faudrait réussir à retrouver environ 500 clés DVB-CSA, ce qui est très difficile avec la technologie actuelle, et surtout impossible à exploiter pour un piratage de masse.</p><p id="p0014" num="0014">Pour permettre le désembrouillage côté abonné, il est toutefois nécessaire de disposer d'un moyen - lui-même sécurisé - de faire parvenir les différentes clés de cryptage au récepteur de l'abonné légitime, qui n'a aucun moyen de les connaître <i>a priori</i> car elles ont été générées aléatoirement au niveau de la tête de réseau.</p><p id="p0015" num="0015">C'est ici qu'intervient un deuxième niveau de cryptographie, par embrouillage de ces clés de cryptage (mots de contrôle CW) au moyen d'un algorithme plus solide et plus coûteux en ressources. Les clés ainsi embrouillées sont placées dans des paquets élémentaires TS spécifiques, appelés ECMs (<i>Entitlement Control Messages,</i> messages de contrôle d'habilitation), et ces paquets sont multiplexés à l'intérieur du flux de transport avec les autres données du programme.</p><p id="p0016" num="0016">On comprendra que toute la sécurité du système repose sur l'algorithme utilisé pour créer les ECMs, puis les décoder sur le récepteur final.</p><p id="p0017" num="0017">Cette partie n'est pas normalisée et est maintenue confidentielle par les différents opérateurs et éditeurs de solutions de cryptage. Les algorithmes utilisés présentent en général les caractéristiques suivantes :<!-- EPO <DP n="4"> -->
<ul><li>l'algorithme proprement dit n'est pas exécuté dans le boîtier décodeur 16 de l'abonné, mais dans une carte à puce, unique pour chaque client, dont il est extrêmement difficile d'extraire le code ;</li><li>cet algorithme ne peut pas être piraté par force brute, car son calcul très gourmand en ressources prendrait des siècles ou des millénaires ;</li><li>la carte à puce dispose d'une notion de "droits" ou "classes", qui lui permet de décider de désembrouiller ou non les mots de contrôle qui lui sont envoyés en fonction des "droits" dont dispose l'abonné ;</li><li>ces "droits" sont véhiculés dans le flux de transport dans des paquets appelés EMMs (<i>Entitlement Management Messages,</i> messages de gestion de l'habilitation), similaires aux ECMs ;</li><li>le boîtier décodeur de l'abonné écrit les ECMs et les EMMs dans la carte à puce et en lit en retour les mots de contrôle désembrouillés.</li></ul></p><p id="p0018" num="0018">Une configuration correspondante de mise en oeuvre est illustrée notamment <figref idrefs="f0001">Figure 1(c).</figref></p><p id="p0019" num="0019">Dans cette configuration typique, le boîtier décodeur 16 de l'abonné est pourvu d'un module spécifique 20 recevant une carte à puce 22 pour permettre l'implémentation de ces fonctions.</p><p id="p0020" num="0020">Le module 20 peut être notamment un module normalisé appelé CAM (<i>Conditional Access Module</i>) mettant en oeuvre une interface appelée Cl (<i>Conditional Interface</i>) conforme aux spécifications ETSI EN 50221.</p><p id="p0021" num="0021">Le module CAM 20, inséré dans un terminal 16 de type quelconque, reçoit l'intégralité du flux de transport TS, décide lui-même quels ECMs/EMMs envoyer à la carte à puce 22 qui est insérée dans le module 20, et désembrouille le ou les services sélectionnés du flux de transport. Le terminal 16 proprement dit n'a aucune action à effectuer pour déprotéger le service, cette fonction étant opérée en interne par le module CAM 20 et la carte à puce 22. Il suffit donc à l'abonné de disposer d'un terminal compatible CI et d'un module CAM correspondant à l'algorithme de contrôle d'accès utilisé par l'opérateur diffusant le programme.</p><p id="p0022" num="0022">Toutes ces techniques, utilisées en diffusion numérique classique, peuvent être reprises à divers degrés par les opérateurs de télévision sur IP, (IPTV) par exemple les opérateurs xDSL.<!-- EPO <DP n="5"> --></p><p id="p0023" num="0023">Ces opérateurs IPTV peuvent être classés en deux catégories :
<ul><li>la <i>première catégorie</i> est celle des opérateurs qui considèrent leur réseau comme un réseau classique de diffusion et distribuent à leurs abonnés des terminaux de type <i>set-top box</i> équipés d'un système de contrôle d'accès traditionnel avec éventuellement une carte à puce. Le contrôle d'accès est assuré par le terminal et sa carte à puce : en d'autres termes, le terminal reçoit tous les flux, mais sous forme cryptée, et le décryptage n'est assuré que si l'abonné dispose des moyens appropriés et des droits permettant de déclencher le désembrouillage. Cette configuration correspond à celle illustrée <figref idrefs="f0001">Figure 1 (b)</figref>; et</li><li>la <i>seconde catégorie</i> est celle des opérateurs qui tirent parti du fait que le réseau IP est un réseau connecté, et que chaque boîtier, constituant le point de terminaison du réseau de l'opérateur, peut être identifié de manière unique et fiable par les équipements de l'opérateur situés en amont.</li></ul>
L'invention se place dans ce second cas de figure.</p><p id="p0024" num="0024">Ce schéma nécessite de disposer d'un équipement spécifique chez l'abonné permettant d'identifier l'abonné de façon sûre (par son adresse IP), cet équipement spécifique remplaçant le terminal banalisé avec module CAM et carte à puce utilisé par l'autre catégorie d'opérateurs.</p><p id="p0025" num="0025">En effet, si l'on peut identifier de manière unique et fiable l'équipement (spécifique) chez l'abonné et donc l'abonné lui-même, le meilleur contrôle d'accès consiste alors non pas à lui envoyer un flux embrouillé qu'il a la capacité de désembrouiller ou non (comme avec la première catégorie d'opérateurs), mais à ne rien lui envoyer du tout dès lors (i) qu'il n'est pas identifié ou (ii) qu'il s'agit d'un service auquel il n'a pas accès.</p><p id="p0026" num="0026">Cette méthode revient, de manière générale, à déporter la fonctionnalité d'accès conditionnel plus en amont dans le réseau - typiquement au niveau du commutateur de l'opérateur (en technologie xDSL ou fibre optique) ou du routeur Ethernet (en télévision IP). Elle permet d'éviter tout piratage de masse, car les flux protégés ne sont pas du tout mis à disposition, sous quelque forme que ce soit, des clients qui n'y sont pas abonnés. Des protocoles standard existent pour diffuser les droits vers les équipements en réseau, chargés de gérer le contrôle d'accès par des messages comparables aux EMMs, mais distribués hors du flux de transport et présentant<!-- EPO <DP n="6"> --> une syntaxe différente. On pourra notamment se référer au <patcit id="pcit0001" dnum="FR2940870A1"><text>FR 2 940 870 A1 (Free</text></patcit>) qui décrit une technologie de type ARDP (<i>Access Right Distribution Protocol</i>) pour la diffusion de tels droits.</p><p id="p0027" num="0027">Une technique particulière est exposée par le <patcit id="pcit0002" dnum="US20030005435A1"><text>US2003/0005435 A1</text></patcit>, qui propose, au lieu de multiplexer les ECMs dans le flux de données, de les envoyer sur un canal séparé, sécurisé, par exemple via un réseau virtuel privé (VPN), une liaison de téléphonie mobile, ou encore une liaison IP distincte de la liaison servant à acheminer le flux video. L'inconvénient de cette solution est bien évidemment de nécessiter deux liaisons différentes de transmission de données là où l'on n'en utilise habituellement qu'une seule.</p><p id="p0028" num="0028">Une autre technique encore est exposée par le <patcit id="pcit0003" dnum="EP2146285A1"><text>EP 2 146 285 A1</text></patcit>, qui repose sur la personnalisation des flux transmis aux différents abonnés (diffusion unicast), avec contrôle sélectif, au niveau des serveurs, de la distribution des flux à ces derniers. Le recours à un nombre important d'équipements côté opérateurs limite fortement une mise en oeuvre à grande échelle de cette solution complexe.</p><p id="p0029" num="0029">Quelle que soit la solution retenue, il reste toutefois nécessaire de répondre au deuxième impératif exposé en préambule, à savoir la protection numérique du service.</p><p id="p0030" num="0030">C'est pour cette raison qu'un algorithme d'embrouillage est souvent utilisé, en conjonction avec la méthode précédente. Cet algorithme peut être beaucoup plus simple, car il n'a pas à vérifier les droits de l'abonné (cela est fait en amont). Seuls les ECMs sont nécessaires, et ils sont désembrouillés par un algorithme propriétaire, connu du terminal fourni par l'opérateur, pour que ce terminal puisse récupérer les mots de contrôle permettant de décoder le service.</p><p id="p0031" num="0031">Comme on l'a indiqué, la sécurité repose sur le fait que le terminal est un équipement spécifique distribué à l'abonné par l'opérateur.</p><p id="p0032" num="0032">De ce fait, ces techniques ne sont pas transposables au cas d'une diffusion IP effectuée directement sur des équipements de type "téléviseur connecté" (dit encore "téléviseur IP" ou "Internet TV") ou autre terminal comparable, n'appartenant pas à l'opérateur. Il en serait de même avec tout équipement fonctionnant de manière analogue, par exemple un ordinateur équipé des logiciels de décodage appropriés, ou un terminal mobile de type tablette ou téléphone portable.</p><p id="p0033" num="0033">Un tel équipement, ci-après désigné "terminal", dispose d'une interface IP qui permet de le connecter directement au réseau IP de l'abonné (réseau filaire Ethernet, réseau sans fil Wi-Fi, etc.) sans interposition d'un boîtier décodeur de type <i>set-top box</i> entre le terminal et le réseau.<!-- EPO <DP n="7"> --></p><p id="p0034" num="0034">Cette configuration est illustrée <figref idrefs="f0001">Figure 1(d)</figref>, où l'on voit qu'entre la passerelle 14 et le téléviseur connecté 18 il n'est prévu aucun boîtier ou élément intermédiaire, la passerelle et le téléviseur étant directement reliés par la liaison IP 24.</p><p id="p0035" num="0035">Le problème technique de l'invention est d'assurer, dans le cas d'une diffusion IP effectuée directement sur de tels équipements IP banalisés n'appartenant pas à l'opérateur, une sécurisation du flux IP avec un même niveau de protection que les techniques que l'on vient d'exposer.</p><p id="p0036" num="0036">On notera que, dans une telle configuration, les interfaces normalisées de type CI ou CI+ (qui prévoit une couche supplémentaire d'authentification entre le module et le terminal) ne sont pas utilisables. En effet, en télévision IP, la notion de module CAM n'existe pas, pour des raisons techniques, les normes CI et CI+ ayant été définies pour être intégrées dans l'architecture d'un décodeur traditionnel. L'interface CI/CI+ s'y intercale dans un bus de transport allant du démodulateur au décodeur : lorsqu'un module CAM est inséré, le bus de transport est détourné, entre dans le module CAM et en ressort, avec un flux désembrouillé.</p><p id="p0037" num="0037">Or en télévision IP l'interface Ethernet (ou autre) utilisée est directement raccordée au décodeur, et ne passe pas par le bus de transport. Il n'existe de ce fait aucun moyen d'injecter les services de télévision IP dans un module CAM.</p><p id="p0038" num="0038">Quand bien même on souhaiterait modifier les récepteurs pour autoriser un tel usage (par exemple en intégrant une sortie du bus de transport dans le décodeur, reliée à l'entrée de l'interface CI), cela serait difficile car :
<ul><li>les modules CAM sont prévus pour travailler sur des multiplexes comportant plusieurs services, à débit fixe, ce qui n'est pas nécessairement le cas en télévision IP, et il est difficile de prévoir comment ils réagiraient dans une telle utilisation ;</li><li>enfin, les algorithmes de désembrouillage des ECMs utilisés en télévision IP sont souvent spécifiques à l'opérateur, et il n'existe pas de module CAM associé ; le coût du développement d'un tel module serait donc à ajouter.</li></ul></p><p id="p0039" num="0039">Jusqu'à présent, cela ne pose de problème particulier, car les opérateurs de télévision IP distribuent à leurs clients un boîtier décodeur spécifique,<!-- EPO <DP n="8"> --> compatible avec les techniques qui leur sont propres de contrôle d'accès et d'embrouillage des ECMs.</p><p id="p0040" num="0040">En revanche, dans les prochaines années, les téléviseurs seront de plus en plus équipés d'un port Ethernet permettant de les relier directement au réseau de l'opérateur (interface IP), et le besoin va se présenter de permettre à ces téléviseurs de décoder eux-mêmes les services de l'opérateur, ce qui sera plus ergonomique (une seule télécommande, une seule interface) et plus économique (plus de boîtier entre la passerelle et le téléviseur). On peut également envisager que les opérateurs souhaitent autoriser des clients logiciels sur ordinateurs personnels ou terminaux mobiles, pour les mêmes raisons.</p><p id="p0041" num="0041">Dans le cas d'un opérateur utilisant une solution de contrôle d'accès en amont du terminal (la "seconde catégorie" d'opérateurs évoquée plus haut), le flux est diffusé en clair et peut être décodé par un téléviseur ou un logiciel sans précautions particulières. Toutefois, dès lors qu'une protection numérique est appliquée - ce qui est le cas général - ou que le contrôle d'accès repose sur un embrouillage, un matériel standard (le téléviseur connecté) ne disposera d'aucun moyen de désembrouiller le flux reçu (on a expliqué plus haut que les interfaces Cl ou CI+ sont ici inopérantes).</p><p id="p0042" num="0042">L'invention propose essentiellement, pour résoudre ce problème, de tirer parti du caractère connecté de la diffusion sur IP en (i) mettant en oeuvre un serveur de décodage des ECMs, contrôlé par l'opérateur, auquel le terminal devra recourir et (ii) en prévoyant dans le terminal un logiciel supplémentaire pour gérer les accès à ce serveur de décodage.</p><p id="p0043" num="0043">Le serveur de décodage des ECMs sera appelé ci-après "ECMD", par analogie avec l'étage ECMG (générateur d'ECMs), utilisé dans la tête de réseau de l'opérateur pour générer les ECMs.</p><p id="p0044" num="0044">L'ECMD pourra être placé sur un serveur physique dans une salle technique de l'opérateur, reliée à l'abonné par un moyen sûr et fiable, ou sur tout autre équipement maîtrisé par l'opérateur : commutateur, routeur IP, ou même sur la passerelle fournie à l'abonné par l'opérateur, et qui constitue le point de terminaison du réseau de l'opérateur.</p><p id="p0045" num="0045">Le logiciel supplémentaire à prévoir dans le terminal permettra à ce dernier, sous certaines conditions : (i) de se connecter à un ECMD, (ii) de lui<!-- EPO <DP n="9"> --> envoyer les ECMs embrouillés et (iii) d'en récupérer, de manière sécurisée, les mots de contrôle CW permettant d'accéder au service.</p><p id="p0046" num="0046">Plus précisément, l'invention vise un ensemble du type général divulgué par le <patcit id="pcit0004" dnum="US20030005435A1"><text>US2003/0005435 A1</text></patcit> précité, c'est-à-dire comprenant les éléments énoncés dans le préambule de la revendication 1.</p><p id="p0047" num="0047">La présente invention est remarquable en ce qu'elle comprend, pour atteindre les buts indiqués plus haut, les éléments énoncés dans la partie caractérisante de la revendication 1.</p><p id="p0048" num="0048">Les sous-revendications visent diverses formes de mise en oeuvre particulières, avantageuses.</p><p id="p0049" num="0049">On va maintenant décrire un exemple de mise en oeuvre du dispositif de l'invention, en référence aux dessins annexés où les mêmes références numériques désignent d'une figure à l'autre des éléments identiques ou fonctionnellement semblables.
<ul><li>Les <figref idrefs="f0001">Figures 1(a) à 1(d)</figref>, précitées, montrent différentes configurations de réseau opérateur/abonné, avec les éléments permettant d'assurer la sécurisation de la diffusion des flux vers l'abonné.</li><li>La <figref idrefs="f0002">Figure 2</figref> illustre de façon schématique les différents éléments mis en oeuvre par la configuration de diffusion selon l'invention.</li></ul></p><p id="p0050" num="0050">Sur la <figref idrefs="f0002">Figure 2</figref>, qui illustre les principaux éléments mis en oeuvre par l'invention pour assurer la sécurisation de la diffusion des flux vers l'abonné, on retrouve les principaux éléments illustrés à la <figref idrefs="f0001">Figure 1 (d) </figref>décrite en introduction, à savoir :
<ul><li>du côté du réseau opérateur : la tête de réseau 10, le commutateur 12 et la passerelle 14 (installée chez l'abonné mais qui appartient au réseau de l'opérateur), et</li><li>du côté du réseau de l'abonné : le terminal 18, par exemple de type "téléviseur connecté" ou "IPTV", et la liaison IP 24 reliant directement ce terminal 18 à la passerelle 14 - donc sans interposition d'aucun boîtier ou terminal intercalaire pour le décodage et la sécurisation des flux, à<!-- EPO <DP n="10"> --> la différence des configurations de l'état de la technique illustrées notamment <figref idrefs="f0001">Figures 1 (a) à (c).</figref></li></ul></p><p id="p0051" num="0051">La tête de réseau 10 comporte un étage 26 assurant l'embrouillage du flux de transport TS, cet embrouillage étant mis en oeuvre par un algorithme utilisant des mots de contrôle CW modifiés à intervalles réguliers. La tête de réseau comporte également un générateur d'ECMs 28 produisant à partir des mots de contrôle CW des messages embrouillés de type ECM sous forme de paquets envoyés concurremment avec le flux de transport TS embrouillé (noté TS*), pour permettre le désembrouillage ultérieur de celui-ci.</p><p id="p0052" num="0052">Ces techniques sont en elles-mêmes bien connues et ne seront pas décrites plus en détail ; elles ne sont pas modifiées pour la mise en oeuvre de l'invention.</p><p id="p0053" num="0053">Le flux embrouillé TS* et les ECMs sont transmis via la passerelle 14 à l'interface IP 30 du terminal 18, qui les reçoit donc tels quels, en entrée. L'interface 30 comporte un étage de désembrouillage 32 du flux embrouillé TS*, permettant d'obtenir le flux en clair TS.</p><p id="p0054" num="0054">Le problème consiste à obtenir le mot de contrôle CW nécessaire à ce désembrouillage, à partir des ECMs reçus en entrée.</p><p id="p0055" num="0055">Ce décodage va être opéré par un serveur de décodage 34 comprenant un module de décodage des ECMs 36, propre à générer les mots de contrôle CW à partir des ECMs envoyés par le terminal 18.</p><p id="p0056" num="0056">Le serveur 34 peut être par ailleurs associé à une base de données 40 répertoriant les droits des différents utilisateurs.</p><p id="p0057" num="0057">La nécessité de recourir à un serveur ECMD et la disponibilité de ce serveur peuvent être indiquées par exemple en positionnant un descripteur (un drapeau) en un emplacement approprié de la table CAT (<i>Conditional Access Table</i>), qui est une table de correspondance, elle-même encapsulée dans un paquet élémentaire TS, définie dans ISO/IEC 13818-1 et destinée à gérer les droits d'accès. Ce descripteur indiquera non seulement la disponibilité du serveur ECMD, mais également une ou plusieurs adresses IP et ports associés.</p><p id="p0058" num="0058">Pour établir la connexion avec le serveur ECMD, le terminal comporte un étage 42 (en pratique, un logiciel additionnel incorporé à l'interface IP 30) permettant d'ouvrir une connexion TCP/IP avec le serveur 34. Le terminal<!-- EPO <DP n="11"> --> 18 et le serveur 34 mettent en oeuvre un processus classique de "poignée de main" (<i>handshake</i>), par exemple selon l'algorithme de Diffie-Hellman : le terminal 18 et le serveur 34 génèrent chacun aléatoirement une clé asymétrique (composée d'une partie publique et d'une partie privée), chacun envoyant à l'autre sa partie publique. À l'aide de sa propre partie privée et de la partie publique de l'autre, chacun des deux est capable de calculer un secret partagé qui n'est connu que d'eux seuls. Ce secret sera utilisé comme clé d'embrouillage pour sécuriser la liaison entre le terminal et le serveur ECMD, au moyen d'un algorithme d'embrouillage symétrique plus classique tel que AES. Comme à aucun moment ce secret n'aura transité dans le réseau, un tiers ne sera pas capable d'en prendre connaissance.</p><p id="p0059" num="0059">Une fois la connexion ouverte, sécurisée et authentifiée, le terminal 18 envoie au serveur ECMD 34 les ECMs issus du flux reçu en entrée (comme schématisé par les flèches 44 et 46), afin que le serveur ECMD envoie en retour les mots de contrôle CW nécessaires au désembrouillage (flèches 48, 50).</p><p id="p0060" num="0060">Dans le cas des opérateurs de la "première catégorie" évoquée plus haut, c'est-à-dire où le contrôle d'accès repose sur l'embrouillage du flux, le serveur ECMD vérifie l'identité du client via son adresse IP (on suppose être sur le réseau interne de l'opérateur, où les adresses IP sont un paramètre fiable et sûr), obtient ses droits par exemple en interrogeant la base de données 40, et peut refuser de désembrouiller l'ECM si certaines conditions ne sont pas réunies (durée d'abonnement, etc.). On soulignera l'importance dans ce cas de l'étape décrite plus haut d'authentification du terminal.</p><p id="p0061" num="0061">Dans le cas d'un opérateur de la "seconde catégorie" évoquée plus haut, c'est-à-dire où chaque boîtier peut être identifié de manière unique et fiable par les équipements en amont, l'ECMD peut renvoyer directement les mots de contrôle CW désembrouillés.</p><p id="p0062" num="0062">De préférence, lorsque l'utilisateur change de chaîne, le terminal maintient ouverte la connexion au serveur ECMD 34 pendant un certain délai (au moins tant que l'adresse IP ne change pas). L'établissement de la communication terminal 18 et serveur 34 est en effet un processus qui peut s'avérer relativement long (typiquement de l'ordre de 1 à 2 secondes), et<!-- EPO <DP n="12"> --> l'on peut souhaiter faire l'économie des échanges protocolaires de sécurisation et d'authentification à chaque changement de chaîne.</p><p id="p0063" num="0063">Diverses variantes et perfectionnements de mise en oeuvre sont envisageables.</p><p id="p0064" num="0064">Ainsi, le serveur 34 et le terminal 18 peuvent embarquer des certificats d'authentification, fonctionnant selon le principe d'une interface à clé publique PKI (<i>Public Key Interface</i>), ces certificats étant signés par une autorité de certification indépendante, ce qui permet de vérifier l'authenticité respective du terminal et du serveur ECMD. Ceci évite :
<ul><li>de distribuer les mots de contrôle à un terminal non autorisé, potentiellement modifié par des pirates pour contourner les mécanismes de protection numérique ;</li><li>de laisser des tiers créer des serveurs ECMD pirates, partageant à plusieurs utilisateurs des mots de contrôle destinés à un seul (procédé dit du <i>card-sharing,</i> décrit par exemple dans le <patcit id="pcit0005" dnum="CN101198014A"><text>CN 101198014 A</text></patcit>) et de monter ainsi de véritables réseaux de piratage utilisant des terminaux tout à fait standard et non modifiés.</li></ul></p><p id="p0065" num="0065">La vérification du certificat se fait généralement par un défi ou challenge, où une partie envoie un texte aléatoire à l'autre, qui le signe avec son certificat et le renvoie ; la partie vérifie alors que la signature correspond bien à un certificat autorisé.</p><p id="p0066" num="0066">La mise en oeuvre de cette protection peut être extrêmement complexe, et comporter des listes de révocation dans le cas où certains terminaux seraient piratés, et leurs certificats utilisés à des fins malhonnêtes. Des techniques en elles-mêmes connues peuvent être utilisées à cet effet, telles que celles mises en oeuvre pour la protection des disques <i>Blu-ray,</i> ou le système TLS (<i>Transport Layer Security</i>) utilisé sur le web.</p><p id="p0067" num="0067">Dans un autre ordre d'idées, le protocole entre le terminal 18 et le serveur ECMD 34 peut comprendre des métadonnées pour gérer des fonctionnalités supplémentaires, par exemple, un processus de double cryptage avec contrôle parental, technique souvent implémentée via les ECMs (l'ECM contient un drapeau indiquant au terminal décodeur qu'il doit demander la désactivation du contrôle parental).</p><p id="p0068" num="0068">Dans ce cas, le serveur ECMD refusera de désembrouiller les mots de contrôle, en signalant au terminal que la saisie du code parental est obligatoire,<!-- EPO <DP n="13"> --> et attendra que le terminal réponde en envoyant le code saisi. En variante, le serveur ECMD pourra désembrouiller les mots de contrôle de façon inconditionnelle, mais en les accompagnant d'une signalisation de catégorie de programme, en laissant au terminal la responsabilité de gérer le déverrouillage par le code parental.</p></description><claims mxw-id="PCLM56985170" lang="DE" load-source="patent-office"><!-- EPO <DP n="18"> --><claim id="c-de-01-0001" num="0001"><claim-text>Einheit zum Senden eines digitalen Videostroms über ein Netz, wobei das Netz enthält:
<claim-text>- einen Betreibernetzabschnitt, der enthält:
<claim-text>• Einrichtungen, um Folgen von Kontrollwörtern CWs zu generieren, die Verwürfelungs-/Entwürfelungsschlüssel formen;</claim-text>
<claim-text>• Einrichtungen, um einen Videostrom zu erzeugen;</claim-text>
<claim-text>• Einrichtungen (26), um den Videostrom durch einen ersten Algorithmus ausgehend von den nacheinander generierten CWs zu verwürfeln, und so einen verwürfelten Videostrom zu erzeugen;</claim-text>
<claim-text>• Einrichtungen (28), um die CWs durch einen zweiten Algorithmus zu verwürfeln, und so von diesen CWs abgeleitete Berechtigungskontrollmitteilungen ECMs zu erzeugen;</claim-text>
<claim-text>• Einrichtungen, um einen Pakete mit dem verwürfelten Videostrom und Pakete mit den ECMs enthaltenden Transportstrom zu erzeugen;</claim-text>
<claim-text>• eine Verbindung zur Übertragung des Transportstroms zum Teilnehmernetz; und</claim-text>
<claim-text>• ein einen Endpunkt des Betreibernetzes formendes Gateway (14), das den Transportstrom empfängt,</claim-text></claim-text>
<claim-text>- einen privaten Teilnehmernetzabschnitt, der enthält:
<claim-text>• ein Endgerät (18), das eine Schnittstelle<!-- EPO <DP n="19"> --> (30), die am Eingang den die Pakete mit dem verwürfelten Videostrom enthaltenden Transportstrom empfangen kann, und Einrichtungen zum Entwürfeln dieses Videostroms mittels zugeordneter CWs aufweist; und</claim-text>
<claim-text>• eine Verbindung zwischen dem Endgerät und einem Ausgang des Gateways,</claim-text></claim-text>
<b>dadurch gekennzeichnet, dass</b> das Netz ein Netz der Art IP ist, und:
<claim-text>- die Schnittstelle (30) des Endgeräts eine IP-Schnittstelle ist, und die Verbindung (24) zwischen dem Endgerät (18) und dem Ausgang des Gateways (14) eine IP-Verbindung ist;</claim-text>
<claim-text>- das Endgerät (18) des privaten Teilnehmernetzes vom Betreibernetz einzig durch seine IP-Adresse erkennbar ist;</claim-text>
<claim-text>- das private Teilnehmernetz kein bedingtes Zugriffsverwaltungsmodul (CAM) mit Chipkarte aufweist;</claim-text>
<claim-text>- die Einheit außerdem einen Server zur Decodierung der ECMs (34) enthält, der eine IP-Schnittstelle und Einrichtungen (36) für den Empfang und die Decodierung der ECMs aufweist, um am Ausgang entsprechende CWs zu liefern;</claim-text>
<claim-text>- dieser Server zur Decodierung der ECMs Teil des Betreibernetzes ist;</claim-text>
<claim-text>- das Endgerät außerdem enthält:
<claim-text>• Einrichtungen (42) zum Aufbau einer Verbindung mit dem Server zur Decodierung der ECMs über: i) die IP-Schnittstelle (30) des Teilnehmernetzes und ii) das Gateway (14) des Betreibernetzes;</claim-text>
<claim-text>• Einrichtungen zum Schicken des am Eingang des Endgeräts empfangenen Transportstroms an den Server zur Decodierung der ECMs; und</claim-text>
<claim-text>• Einrichtungen, um im Gegenzug die entsprechenden CWs zu empfangen, die vom Server zur Decodierung der ECMs geliefert<!-- EPO <DP n="20"> --> werden; und</claim-text></claim-text>
<claim-text>- außerdem kryptographische Einrichtungen zur Sicherung des Datenaustauschprotokolls zwischen dem Endgerät und dem Server zur Decodierung der ECMs vorgesehen sind.</claim-text></claim-text></claim><claim id="c-de-01-0002" num="0002"><claim-text>Sendeeinheit nach Anspruch 1, die außerdem Einrichtungen zur Authentifizierung des Endgeräts beim Aufbau der Verbindung mit dem Server zur Decodierung der ECMs enthält.</claim-text></claim><claim id="c-de-01-0003" num="0003"><claim-text>Sendeeinheit nach Anspruch 1, die außerdem Einrichtungen zur Authentifizierung des Servers zur Decodierung der ECMs beim Aufbau der Verbindung mit dem Endgerät enthält.</claim-text></claim><claim id="c-de-01-0004" num="0004"><claim-text>Sendeeinheit nach Anspruch 1, wobei die Einrichtungen des Endgeräts, um die ECMs an den Server zur Decodierung der ECMs zu schicken und im Gegenzug die entsprechenden CWs zu empfangen, Einrichtungen sind, die über die IP-Verbindung zwischen dem Endgerät und der Netzschnittstelle des Betreibers wirken können.</claim-text></claim><claim id="c-de-01-0005" num="0005"><claim-text>Sendeeinheit nach Anspruch 1, wobei der Server zur Decodierung der ECMs in einem vom Betreiber kontrollierten Raum angeordnet ist.</claim-text></claim><claim id="c-de-01-0006" num="0006"><claim-text>Sendeeinheit nach Anspruch 1, wobei der Server zur Decodierung der ECMs im Gateway angeordnet ist.</claim-text></claim><claim id="c-de-01-0007" num="0007"><claim-text>Sendeeinheit nach Anspruch 1, wobei das Betreibernetz außerdem Einrichtungen enthält, um Pakete zu generieren, die einen spezifischen Verfügbarkeitsanzeiger eines Servers zur Decodierung der ECMs enthalten.</claim-text></claim><claim id="c-de-01-0008" num="0008"><claim-text>Sendeeinheit nach Anspruch 1, wobei:
<claim-text>- die Einheit außerdem eine Datenbank (40) von<!-- EPO <DP n="21"> --> jedem der Teilnehmer eigenen Zugriffsrechten enthält, die eine IP-Teilnehmerkennung und eine Einheit von Kriterien enthält, die die Zugriffsrechte definieren, und</claim-text>
<claim-text>- der Server zur Decodierung der ECMs Einrichtungen enthält, um:
<claim-text>• die IP-Adresse des Endgeräts beim Aufbau der Verbindung zu kontrollieren,</claim-text>
<claim-text>• zu untersuchen, ob die Kriterien verifiziert sind oder nicht, und</claim-text>
<claim-text>• die Decodierung der ECMs von der Verifizierung der Kriterien abhängig zu machen.</claim-text></claim-text></claim-text></claim><claim id="c-de-01-0009" num="0009"><claim-text>Sendeeinheit nach Anspruch 1, wobei:
<claim-text>- die Einrichtungen des Betreibernetzes, um den Videostrom zu verwürfeln, Einrichtungen mit doppelter Verwürfelung sind;</claim-text>
<claim-text>- das Endgerät Einrichtungen enthält, um einen Entriegelungscode zu bilden und diesen Code an den Server zur Decodierung der ECMs zu schicken; und</claim-text>
<claim-text>- der Server zur Decodierung der ECMs Einrichtungen enthält, um die Ausgabe am Ausgang der CWs vom vorhergehenden Empfang eines vom Endgerät geschickten entsprechenden Entriegelungscodes abhängig zu machen.</claim-text></claim-text></claim><claim id="c-de-01-0010" num="0010"><claim-text>Sendeeinheit nach Anspruch 1, wobei:
<claim-text>- die Einrichtungen des Betreibernetzes zur Verwürfelung des Videostroms Einrichtungen mit doppelter Verwürfelung sind;</claim-text>
<claim-text>- der Server zur Decodierung der ECMs Einrichtungen enthält, um am Ausgang an das Endgerät zusätzlich zu den CWs einen spezifischen Programmkategorieanzeiger auszugeben, der einer doppelten Verwürfelung unterzogen wird; und</claim-text>
<claim-text>- das Endgerät Einrichtungen enthält, um einen<!-- EPO <DP n="22"> --> Entriegelungscode zu bilden und die Anwendung der Entwürfelungseinrichtungen des Videostroms von der vorhergehenden Bildung eines entsprechenden Entriegelungscodes abhängig zu machen.</claim-text></claim-text></claim><claim id="c-de-01-0011" num="0011"><claim-text>Sendeeinheit nach Anspruch 1, wobei die Einrichtungen des Endgeräts zum Aufbau einer Verbindung mit dem Server zur Decodierung der ECMs die aufgebaute Verbindung selbst im Fall einer ausgehend vom Endgerät gesteuerten Kanaländerung halten können.</claim-text></claim><claim id="c-de-01-0012" num="0012"><claim-text>Sendeeinheit nach Anspruch 1, wobei das Betreibernetz außerdem Einrichtungen enthält, um zusätzlich zu den Berechtigungskontrollmitteilungen ECMs für die Entwürfelung des Videostroms Berechtigungsverwaltungsmitteilungen EMMs für die Verwaltung der dem Teilnehmer eigenen Zugriffsrechte zu generieren.</claim-text></claim></claims><claims mxw-id="PCLM56985171" lang="EN" load-source="patent-office"><!-- EPO <DP n="23"> --><claim id="c-en-01-0001" num="0001"><claim-text>An assembly for broadcasting a digital video stream via a network, wherein the network comprises:
<claim-text>- an operator network part comprising:
<claim-text>· means for generating successions of control words CWs forming scrambling/unscrambling keys;</claim-text>
<claim-text>· means for producing a video stream;</claim-text>
<claim-text>· means (26) for scrambling the video stream by a first algorithm based on the successively generated CWs, and thus producing a scrambled video flux;</claim-text>
<claim-text>· means (28) for scrambling the CWs by a second algorithm, and thus producing entitlement control messages ECMs derived from these CWs;</claim-text>
<claim-text>· means for producing a transport stream containing packets with the scrambled video stream and packets with the ECMs;</claim-text>
<claim-text>· a link for transmission of the transport stream to the subscriber network; and</claim-text>
<claim-text>· a gateway (14) forming a termination point of the operator network, receiving the transport stream,</claim-text></claim-text>
<claim-text>- a subscriber private network part comprising:
<claim-text>· a terminal (18) comprising an interface (30), adapted to receive as an input the transport stream containing the packets with the scrambled video stream, and means for unscrambling this video stream by means of associated CXs; and</claim-text>
<claim-text>· a link between the terminal and an output of the gateway,</claim-text></claim-text>
<b>characterized in that</b> the network is an IP-type network, and:
<claim-text>- the interface (30) of the terminal is an IP interface, and the link (24) between the terminal (18s) and the output of the gateway (14) is an IP link;<!-- EPO <DP n="24"> --></claim-text>
<claim-text>- the terminal (18) of the subscriber private network is univocally identifiable by the operator network, through its IP address;</claim-text>
<claim-text>- the subscriber private network have no smart-card conditional access management (CAM) module;</claim-text>
<claim-text>- the assembly further comprises an ECM decoding server (34), including an IP interface and means (36) for receiving and decoding ECMs so as to output corresponding CWs;</claim-text>
<claim-text>- this ECM decoding server is a part of the operator network;</claim-text>
<claim-text>- the terminal further comprises:
<claim-text>· means (42) for establishing a connection with the ECM decoding server via: i) the IP interface (30) of the subscriber network and ii) the gateway (14) of the operator network;</claim-text>
<claim-text>· means for sending to the decoding server the ECMs of the transport stream received as an input of the terminal; and</claim-text>
<claim-text>· means for receiving back the corresponding CWs delivered by the ECM decoding server; and</claim-text></claim-text>
<claim-text>- it is further provided cryptographic means for securing the data exchange protocol between the terminal and the ECM decoding server.</claim-text></claim-text></claim><claim id="c-en-01-0002" num="0002"><claim-text>The broadcasting assembly of claim 1, further comprising means for authenticating the terminal at the establishment of the connection with the ECM decoding server.</claim-text></claim><claim id="c-en-01-0003" num="0003"><claim-text>The broadcasting assembly of claim 1, further comprising means for authenticating the ECM decoding server at the establishment of the connection with the terminal.<!-- EPO <DP n="25"> --></claim-text></claim><claim id="c-en-01-0004" num="0004"><claim-text>The broadcasting assembly of claim 1, wherein the means of the terminal for sending the ECMs to the ECM decoding server and receiving back the corresponding CWs are means adapted to operate via said IP link between the terminal and the operator network interface.</claim-text></claim><claim id="c-en-01-0005" num="0005"><claim-text>The broadcasting assembly of claim 1, wherein the ECM decoding server is installed in a room controlled by the operator.</claim-text></claim><claim id="c-en-01-0006" num="0006"><claim-text>The broadcasting assembly of claim 1, wherein the ECM decoding server is installed in the gateway.</claim-text></claim><claim id="c-en-01-0007" num="0007"><claim-text>The broadcasting assembly of claim 1, wherein the operator network further comprises means for generating packets containing a specific indicator of availability of an ECM decoding server.</claim-text></claim><claim id="c-en-01-0008" num="0008"><claim-text>The broadcasting assembly of claim 1, wherein:
<claim-text>- the assembly further comprises a data base (40) of access rights specific to each subscriber, comprising an IP identifier of the subscriber and a set of criteria defining the access rights, and</claim-text>
<claim-text>- the ECM decoding server comprises means for:
<claim-text>· controlling the IP address of the terminal at the establishment of the connection,</claim-text>
<claim-text>· examining whether said criteria are verified, and</claim-text>
<claim-text>· conditioning the decoding of the ECMs to the verification of said criteria.</claim-text></claim-text></claim-text></claim><claim id="c-en-01-0009" num="0009"><claim-text>The broadcasting assembly of claim 1, wherein:
<claim-text>- the means of the operator network for scrambling the video stream are double-scrambling means;</claim-text>
<claim-text>- the terminal comprises means for composing an unlocking code and sending this code to the ECM<!-- EPO <DP n="26"> --> decoding server; and</claim-text>
<claim-text>- the ECM decoding server comprises means for conditioning the output of the CWs to the previous receiving of a compliant unlocking code sent by the terminal.</claim-text></claim-text></claim><claim id="c-en-01-0010" num="0010"><claim-text>The broadcasting assembly of claim 1, wherein:
<claim-text>- the means of the operator network for scrambling the video stream are double-scrambling means;</claim-text>
<claim-text>- the ECM decoding server comprises means for outputting to the terminal, in addition to the CWs, a specific indicator of program category subjected to a double-scrambling; and</claim-text>
<claim-text>- the terminal comprises means for composing an unlocking code and conditioning the implementation of the video stream unscrambling means to the previous composition of a compliant unlocking code.</claim-text></claim-text></claim><claim id="c-en-01-0011" num="0011"><claim-text>The broadcasting assembly of claim 1, wherein the means of the terminal for establishing a connection with the ECM decoding server are adapted to maintain the established connection even in case of change of chain commanded from the terminal.</claim-text></claim><claim id="c-en-01-0012" num="0012"><claim-text>The broadcasting assembly of claim 1, wherein the operator network further comprises means for generating, in addition to the entitlement control messages ECMs for unscrambling the video stream, entitlement management messages EMMs for managing the access rights specific to the subscriber.</claim-text></claim></claims><claims mxw-id="PCLM56985172" lang="FR" load-source="patent-office"><!-- EPO <DP n="14"> --><claim id="c-fr-01-0001" num="0001"><claim-text>Un ensemble de diffusion d'un flux video numérique par un réseau, dans lequel le réseau comprend :
<claim-text>- une partie de réseau d'opérateur comprenant :
<claim-text>• des moyens pour générer des successions de mots de contrôle CWs formant clés d'embrouillage/désembrouillage ;</claim-text>
<claim-text>• des moyens pour produire un flux video ;</claim-text>
<claim-text>• des moyens (26) pour embrouiller le flux video par un premier algorithme à partir des CWs successivement générés, et produire ainsi un flux video embrouillé ;</claim-text>
<claim-text>• des moyens (28) pour embrouiller les CWs par un second algorithme, et produire ainsi des messages de contrôle d'habilitation ECMs dérivés de ces CWs ;</claim-text>
<claim-text>• des moyens pour produire un flux de transport contenant des paquets avec le flux video embrouillé et des paquets avec les ECMs ;</claim-text>
<claim-text>• une liaison de transmission du flux de transport vers le réseau d'abonné ; et</claim-text>
<claim-text>• une passerelle (14) formant point de terminaison du réseau d'opérateur, recevant le flux de transport,</claim-text></claim-text>
<claim-text>- une partie de réseau privé d'abonné comprenant :
<claim-text>• un terminal (18) comportant une interface (30), apte à recevoir en entrée le flux de transport contenant les paquets avec le flux video embrouillé, et des moyens de désembrouillage de ce flux video au moyen de CWs associés ; et</claim-text>
<claim-text>• une liaison entre le terminal et une sortie de la passerelle.</claim-text></claim-text>
<b>caractérisé en ce que</b> le réseau est un réseau de type iP, et :
<claim-text>- l'interface (30) du terminal est une interface IP, et la liaison (24) entre le terminal (18s) et la sortie de la passerelle (14) est une liaison IP ;</claim-text>
<claim-text>- le terminal (18) du réseau privé d'abonné est identifiable par le réseau d'opérateur de manière unique, par son adresse IP ;</claim-text>
<claim-text>- le réseau privé d'abonné est dépourvu de module de gestion d'accès conditionnel (CAM) à carte à puce ;</claim-text>
<claim-text>- l'ensemble comprend en outre un serveur de décodage des ECMs (34), comportant une interface IP et des moyens (36) pour recevoir et décoder<!-- EPO <DP n="15"> --> des ECMs de manière à délivrer en sortie des CWs correspondants ;</claim-text>
<claim-text>- ce serveur de décodage des ECMs fait partie du réseau d'opérateur ;</claim-text>
<claim-text>- le terminal comprend en outre :
<claim-text>• des moyens (42) pour établir une connexion avec le serveur de décodage des ECMs via : i) l'interface IP (30) du réseau d'abonné et ii) la passerelle (14) du réseau d'opérateur ;</claim-text>
<claim-text>• des moyens pour envoyer au serveur de décodage les ECMs du flux de transport reçu en entrée du terminal ; et</claim-text>
<claim-text>• des moyens pour recevoir en retour les CWs correspondants délivrés par le serveur de décodage des ECMs ; et</claim-text></claim-text>
<claim-text>- il est en outre prévu des moyens cryptographiques de sécurisation du protocole d'échange de données entre le terminal et le serveur de décodage des ECMs.</claim-text></claim-text></claim><claim id="c-fr-01-0002" num="0002"><claim-text>L'ensemble de diffusion de la revendication 1, comprenant en outre des moyens d'authentification du terminal à l'établissement de la connexion avec le serveur de décodage des ECMs.</claim-text></claim><claim id="c-fr-01-0003" num="0003"><claim-text>L'ensemble de diffusion de la revendication 1, comprenant en outre des moyens d'authentification du serveur de décodage des ECMs à l'établissement de la connexion avec le terminal.</claim-text></claim><claim id="c-fr-01-0004" num="0004"><claim-text>L'ensemble de diffusion de la revendication 1, dans lequel les moyens du terminal pour envoyer les ECMs au serveur de décodage des ECMs et recevoir en retour les CWs correspondants sont des moyens aptes à opérer via ladite liaison IP entre le terminal et l'interface réseau de l'opérateur.</claim-text></claim><claim id="c-fr-01-0005" num="0005"><claim-text>L'ensemble de diffusion de la revendication 1, dans lequel le serveur de décodage des ECMs est installé dans un local contrôlé par l'opérateur.</claim-text></claim><claim id="c-fr-01-0006" num="0006"><claim-text>L'ensemble de diffusion de la revendication 1, dans lequel le serveur de décodage des ECMs est installé dans la passerelle.<!-- EPO <DP n="16"> --></claim-text></claim><claim id="c-fr-01-0007" num="0007"><claim-text>L'ensemble de diffusion de la revendication 1, dans lequel le réseau d'opérateur comprend en outre des moyens pour générer des paquets contenant un indicateur spécifique de disponibilité d'un serveur de décodage des ECMs.</claim-text></claim><claim id="c-fr-01-0008" num="0008"><claim-text>L'ensemble de diffusion de la revendication 1, dans lequel :
<claim-text>- l'ensemble comprend en outre une base de données (40) de droits d'accès propres à chaque abonné, comprenant un identifiant IP de l'abonné et un ensemble de critères définissant les droits d'accès, et</claim-text>
<claim-text>- le serveur de décodage des ECMs comprend des moyens pour :
<claim-text>• contrôler l'adresse IP du terminal à l'établissement de la connexion,</claim-text>
<claim-text>• examiner si lesdits critères sont ou non vérifiés, et</claim-text>
<claim-text>• conditionner le décodage des ECMs à la vérification desdits critères.</claim-text></claim-text></claim-text></claim><claim id="c-fr-01-0009" num="0009"><claim-text>L'ensemble de diffusion de la revendication 1, dans lequel :
<claim-text>- les moyens du réseau d'opérateur pour embrouiller le flux video sont des moyens à double embrouillage ;</claim-text>
<claim-text>- le terminal comprend des moyens pour composer un code de déverrouillage et envoyer ce code au serveur de décodage des ECMs ; et</claim-text>
<claim-text>- le serveur de décodage des ECMs comprend des moyens pour conditionner la délivrance en sortie des CWs à la réception préalable d'un code de déverrouillage conforme envoyé par le terminal.</claim-text></claim-text></claim><claim id="c-fr-01-0010" num="0010"><claim-text>L'ensemble de diffusion de la revendication 1, dans lequel :
<claim-text>- les moyens du réseau d'opérateur pour embrouiller le flux video sont des moyens à double embrouillage ;</claim-text>
<claim-text>- le serveur de décodage des ECMs comprend des moyens pour délivrer en sortie au terminal, outre les CWs, un indicateur spécifique de catégorie de programme soumis à double embrouillage ; et</claim-text>
<claim-text>- le terminal comprend des moyens pour composer un code de déverrouillage et conditionner la mise en oeuvre des moyens de désembrouillage du flux video à la composition préalable d'un code de déverrouillage conforme.</claim-text><!-- EPO <DP n="17"> --></claim-text></claim><claim id="c-fr-01-0011" num="0011"><claim-text>L'ensemble de diffusion de la revendication 1, dans lequel les moyens du terminal pour établir une connexion avec le serveur de décodage des ECMs sont aptes à maintenir la connexion établie même en cas d'un changement de chaîne commandé depuis le terminal.</claim-text></claim><claim id="c-fr-01-0012" num="0012"><claim-text>L'ensemble de diffusion de la revendication 1, dans lequel le réseau d'opérateur comprend en outre des moyens pour générer, outre les messages de contrôle d'habilitation ECMs pour le désembrouillage du flux video, des messages de gestion d'habilitation EMMs pour la gestion des droits d'accès propres à l'abonné.</claim-text></claim></claims><drawings mxw-id="PDW16672081" load-source="patent-office"><!-- EPO <DP n="27"> --><figure id="f0001" num="1(a),1(b),1(c),1(d)"><img id="if0001" file="imgf0001.tif" wi="165" he="227" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="28"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="147" he="233" img-content="drawing" img-format="tif"/></figure></drawings><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
