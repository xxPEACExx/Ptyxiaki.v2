<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2459065-B1" country="EP" doc-number="2459065" kind="B1" date="20140108" family-id="42734852" file-reference-id="315053" date-produced="20180825" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146587943" ucid="EP-2459065-B1"><document-id><country>EP</country><doc-number>2459065</doc-number><kind>B1</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-10742294-A" is-representative="NO"><document-id mxw-id="PAPP154850135" load-source="docdb" format="epo"><country>EP</country><doc-number>10742294</doc-number><kind>A</kind><date>20100723</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140547982" ucid="EP-09166924-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>09166924</doc-number><kind>A</kind><date>20090731</date></document-id></priority-claim><priority-claim mxw-id="PPC140555370" ucid="EP-10742294-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>10742294</doc-number><kind>A</kind><date>20100723</date></document-id></priority-claim><priority-claim mxw-id="PPC140557568" ucid="IB-2010053364-W" load-source="docdb"><document-id format="epo"><country>IB</country><doc-number>2010053364</doc-number><kind>W</kind><date>20100723</date></document-id></priority-claim></priority-claims><dates-of-public-availability><intention-to-grant-date><date>20130801</date></intention-to-grant-date></dates-of-public-availability><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1989324313" load-source="ipcr">A61B   5/11        20060101AFI20110216BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL1989622064" load-source="docdb" scheme="CPC">A61B   5/1102      20130101 FI20130101BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132368462" lang="DE" load-source="patent-office">VERFAHREN UND VORRICHTUNG ZUR ANALYSE EINES BALLISTOKARDIOGRAMMSIGNALS</invention-title><invention-title mxw-id="PT132368463" lang="EN" load-source="patent-office">METHOD AND APPARATUS FOR THE ANALYSIS OF A BALLISTOCARDIOGRAM SIGNAL</invention-title><invention-title mxw-id="PT132368464" lang="FR" load-source="patent-office">PROCEDE ET APPAREIL POUR L'ANALYSE D'UN SIGNAL DE BALLISTOCARDIOGRAMME</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR919517217" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>KONINKL PHILIPS NV</last-name><address><country>NL</country></address></addressbook></applicant><applicant mxw-id="PPAR919531551" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>KONINKLIJKE PHILIPS N.V.</last-name></addressbook></applicant><applicant mxw-id="PPAR919507770" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>PHILIPS INTELLECTUAL PROPERTY</last-name><address><country>DE</country></address></addressbook></applicant><applicant mxw-id="PPAR919538013" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>PHILIPS INTELLECTUAL PROPERTY &amp; STANDARDS GMBH</last-name></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919514466" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>BRUESER CHRISTOPH</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919514445" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>BRUESER, CHRISTOPH</last-name></addressbook></inventor><inventor mxw-id="PPAR919020771" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>BRUESER, CHRISTOPH</last-name><address><street>c/o High Tech Campus Building 44</street><city>NL-5656 AE Eindhoven</city><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919534502" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>STADLTHANNER KURT</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919519111" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>STADLTHANNER, KURT</last-name></addressbook></inventor><inventor mxw-id="PPAR919020768" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>STADLTHANNER, KURT</last-name><address><street>c/o High Tech Campus Building 44</street><city>NL-5656 AE Eindhoven</city><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919545653" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>Friedrich david</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919521165" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>FRIEDRICH, DAVID</last-name></addressbook></inventor><inventor mxw-id="PPAR919020769" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>FRIEDRICH, DAVID</last-name><address><street>c/o High Tech Campus Building 44</street><city>NL-5656 AE Eindhoven</city><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919538160" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>BRAUERS ANDREAS</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919544938" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>BRAUERS, ANDREAS</last-name></addressbook></inventor><inventor mxw-id="PPAR919020767" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>BRAUERS, ANDREAS</last-name><address><street>c/o High Tech Campus Building 44</street><city>NL-5656 AE Eindhoven</city><country>NL</country></address></addressbook></inventor></inventors><assignees><assignee mxw-id="PPAR919020773" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Koninklijke Philips N.V.</last-name><iid>101391185</iid><address><street>High Tech Campus 5</street><city>5656 AE Eindhoven</city><country>NL</country></address></addressbook></assignee><assignee mxw-id="PPAR919020770" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>Philips Intellectual Property &amp; Standards GmbH</last-name><iid>100798256</iid><address><street>Lübeckertordamm 5</street><city>20099 Hamburg</city><country>DE</country></address></addressbook></assignee></assignees><agents><agent mxw-id="PPAR919020772" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Smit, Frederik Jan</last-name><iid>101356389</iid><address><street>Cordian B.V. High Tech Campus 27</street><city>5656 AE Eindhoven</city><country>NL</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="IB-2010053364-W"><document-id><country>IB</country><doc-number>2010053364</doc-number><kind>W</kind><date>20100723</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2011013048-A1"><document-id><country>WO</country><doc-number>2011013048</doc-number><kind>A1</kind><date>20110203</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS549863882" load-source="docdb">AL</country><country mxw-id="DS549867870" load-source="docdb">AT</country><country mxw-id="DS549863883" load-source="docdb">BE</country><country mxw-id="DS549795759" load-source="docdb">BG</country><country mxw-id="DS549921980" load-source="docdb">CH</country><country mxw-id="DS549865501" load-source="docdb">CY</country><country mxw-id="DS549867871" load-source="docdb">CZ</country><country mxw-id="DS549886947" load-source="docdb">DE</country><country mxw-id="DS549863884" load-source="docdb">DK</country><country mxw-id="DS549865506" load-source="docdb">EE</country><country mxw-id="DS549779675" load-source="docdb">ES</country><country mxw-id="DS549795760" load-source="docdb">FI</country><country mxw-id="DS549795773" load-source="docdb">FR</country><country mxw-id="DS549863885" load-source="docdb">GB</country><country mxw-id="DS549863890" load-source="docdb">GR</country><country mxw-id="DS549863891" load-source="docdb">HR</country><country mxw-id="DS549867872" load-source="docdb">HU</country><country mxw-id="DS549921981" load-source="docdb">IE</country><country mxw-id="DS549863892" load-source="docdb">IS</country><country mxw-id="DS549795774" load-source="docdb">IT</country><country mxw-id="DS549865507" load-source="docdb">LI</country><country mxw-id="DS549886948" load-source="docdb">LT</country><country mxw-id="DS549867873" load-source="docdb">LU</country><country mxw-id="DS549886949" load-source="docdb">LV</country><country mxw-id="DS549886954" load-source="docdb">MC</country><country mxw-id="DS549780443" load-source="docdb">MK</country><country mxw-id="DS549780444" load-source="docdb">MT</country><country mxw-id="DS549779676" load-source="docdb">NL</country><country mxw-id="DS549795775" load-source="docdb">NO</country><country mxw-id="DS549779681" load-source="docdb">PL</country><country mxw-id="DS549795776" load-source="docdb">PT</country><country mxw-id="DS549779682" load-source="docdb">RO</country><country mxw-id="DS549779683" load-source="docdb">SE</country><country mxw-id="DS549921982" load-source="docdb">SI</country><country mxw-id="DS549780457" load-source="docdb">SK</country><country mxw-id="DS549780458" load-source="docdb">SM</country><country mxw-id="DS549865508" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><description mxw-id="PDES63960376" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001">TECHNICAL FIELD OF THE INVENTION</heading><p id="p0001" num="0001">The invention relates to a method and apparatus for the analysis of a ballistocardiogram signal, and in particular to a method and apparatus that provides for the detection of single heart beat events in a ballistocardiogram signal.</p><heading id="h0002">BACKGROUND TO THE INVENTION</heading><p id="p0002" num="0002">A ballistocardiograph (BCG) measures the movement of the human body due to the momentum of the blood as it is pumped by the heart.</p><p id="p0003" num="0003">The BCG has advantages over the electrocardiograph (ECG) in that the measurement of body vital signs is possible without electrodes having to be glued to the body or for special sensors like belts, textiles or the like to be worn. Due to this unobtrusive nature the BCG is best suited for monitoring the heart activity of people at night over a long period of time. Likewise, BCG systems can be used as an additional safety measure to monitor patients in the general ward of hospitals without reducing their sleep quality. Since modem BCG systems can be fully integrated into a bed and can be activated by a single switch, the additional safety provided by such a system requires minimal extra effort from healthcare professionals.</p><p id="p0004" num="0004">Currently, algorithms for analysing ballistocardiogram signals to determine the heart rate use spectral methods or methods in the time domain that detect the reoccurrence of certain patterns by, for example, evaluating the autocorrelation function of the signal. In all of these approaches, segments of the signal have to be considered which last for several seconds such that they cover multiple heart beats. As a result, average heart beats over a period of time are obtained, but no beat-to-beat information is available.</p><p id="p0005" num="0005">Some algorithms for beat-to-beat estimation from ballistocardiogram signals have been presented, but these either require a large and expensive sensor array in order to work properly ("<nplcit id="ncit0001" npl-type="b"><text>FFT averaging of multichannel BCG signals from bed mattress sensor to improve estimation of heart beat interval" by Kortelainen, J.M. and Virkkala, J., Engineering in Medicine and Biology Society, 2007, EMBS 2007, 29th Annual International Conference of the IEEE, 22-26 August 2007, pages 6685-6688</text></nplcit>), human interaction ("<nplcit id="ncit0002" npl-type="b"><text>Automatic<!-- EPO <DP n="2"> --> Ballistocardiogram (BCG) Beat Detection Using a Template Matching Approach" by J.H. Shin, B.H. Choi, Y.G. Lim, D.U. Joeng and K.S. Park, Engineering in Medicine and Biology Society, 2008, EMBS 2008, 30th Annual International Conference of the IEEE, 21-24 August 2008</text></nplcit>) or use different sensor modalities and lack accuracy ("<nplcit id="ncit0003" npl-type="b"><text>Estimation of Respiratory Waveform and Heart Rate Using an Accelerometer" by D.H. Phan, S. Bonnet, R. Guillemaud, E. Castelli, N.Y. Pham Thi, Engineering in Medicine and Biology Society, 2008, EMBS 2008, 30th Annual International Conference of the IEEE, 21-24 August 2008</text></nplcit>).</p><p id="p0006" num="0006">It is questionable whether these algorithms can be brought to market, or whether they are able to deal with the high intra- and inter-patient variability of ballistocardiogram signals, particularly those patients with arrhythmias.</p><p id="p0007" num="0007">Arrhythmias are a widespread problem and can be a predictor of critical health conditions. According to the American Heart Association an estimated 2.2 million Americans are living with atrial fibrillations. This means that the assumption made by some algorithms of a regular beating heart does not hold for a significant fraction of the people to be monitored in the general wards of hospitals, for instance.</p><p id="p0008" num="0008">Depending on the severity of arrhythmias, existing algorithms that try to detect heart beats in BCG signals fail sooner or later since they usually assume that the heart is beating rather regularly. Thus, there is a need for an algorithm for processing ballistocardiogram signals that is not based on this regularity assumption and which is thus able to work also in the case of severe arrhythmia. It is also desirable for an algorithm that can provide a reliable beat to beat analysis of the BCG signal.</p><p id="p0009" num="0009">Furthermore, many of the existing BCG analysis algorithms only work offline. Thus, it is desirable for the algorithm to be suitable for use online (i.e. continuously) and therefore suitable for monitoring and alerting tasks in hospitals, nursing homes or at home.</p><heading id="h0003">SUMMARY OF THE INVENTION</heading><p id="p0010" num="0010">According to a first aspect of the invention there is provided a method of detecting heart beats of a user in a ballistocardiogram, BCG, signal, the method comprising the steps according to claim 1.</p><p id="p0011" num="0011">According to a second aspect of the invention, there is provided an apparatus for use with a device for measuring a ballistocardiogram signal of a user, the apparatus<!-- EPO <DP n="3"> --> comprising means for receiving a ballistocardiogram signal from the device; and processing means for performing the method described above on the received ballistocardiogram signal.</p><p id="p0012" num="0012">According to a third aspect of the invention, there is provided a computer program product comprising computer program code that, when executed on a computer or processor, is configured to cause the computer or processor to perform the method described above.</p><heading id="h0004"><b>BRIEF DESCRIPTION</b> OF THE DRAWINGS</heading><p id="p0013" num="0013">The invention will now be described in the following detailed description, by way of example only, with reference to the following drawings, in which:
<ul><li><figref idrefs="f0001">Fig. 1</figref> is a flow chart illustrating the principle of detecting heart beats according to the invention;</li><li><figref idrefs="f0001">Fig. 2</figref> is a graph illustrating an unfiltered ballistocardiogram signal;</li><li><figref idrefs="f0002">Fig. 3</figref> is a flow chart illustrating a method of training the algorithm according to the invention;</li><li><figref idrefs="f0003">Fig. 4</figref> is a graph illustrating the result of filtering the ballistocardiogram signal to remove the breathing component;</li><li><figref idrefs="f0003">Fig. 5</figref> is a graph illustrating the result of smoothing the filtered ballistocardiogram signal;</li><li><figref idrefs="f0004">Fig. 6</figref> is an illustration of the parameters derived from the ballistocardiogram signal in accordance with an embodiment of the invention;</li><li><figref idrefs="f0005">Fig. 7</figref> is a flow chart illustrating the implementation of step 107 in <figref idrefs="f0002">Figure 3</figref> in more detail;</li><li><figref idrefs="f0006">Fig. 8</figref> is a graph illustrating the high frequency filter response envelope of the ballistocardiogram signal;</li><li><figref idrefs="f0007">Fig. 9</figref> is a flow chart illustrating the method of using the algorithm to detect heart beats in a ballistocardiogram signal;</li><li><figref idrefs="f0008">Fig. 10</figref> is a graph illustrating reliability score triplets;</li><li><figref idrefs="f0008">Fig. 11</figref> is a graph illustrating the effectiveness of the algorithm in relation to heart beats detected using an ECG;</li><li><figref idrefs="f0009">Fig. 12</figref> is a graph comparing the beat to beat intervals determined by the algorithm and by using an ECG;</li><li><figref idrefs="f0010">Fig. 13</figref> is a graph illustrating the effectiveness of the algorithm in detecting a heart beat when arrhythmia is present in relation to an ECG; and<!-- EPO <DP n="4"> --></li><li><figref idrefs="f0010">Fig. 14</figref> is a block diagram of an apparatus in accordance with an embodiment of the invention.</li></ul></p><heading id="h0005">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading><p id="p0014" num="0014">The flow chart in <figref idrefs="f0001">Figure 1</figref> illustrates the general principles used by the algorithm according to the invention. In the first step (step 10), the training step, a short segment of a ballistocardiogram (BCG) signal is analyzed and the typical features of the heart beat are determined. In the second step (step 12), the assignment step, newly recorded samples of a live BCG signal are scanned for heart beats, or, in other words, the algorithm tries to rediscover the features learned in the training step in the newly recorded signals. The operation of the training and assignment steps are briefly outlined below.</p><p id="p0015" num="0015">In order to learn the typical features of the heart beat during the training period (step 10), the segment of the ballistocardiogram used for the training is first filtered in order to remove any breathing components and to smooth the signal. Specific points are identified in the resulting signal which can be used to parameterize the signal. At each specific point the next n parameters are used to form a feature vector. The resulting feature vectors are clustered by similarity. Here, the principle is that the feature vectors covering individual heart beats will be similar enough that they will be clustered together, while other feature vectors will be found in different clusters.</p><p id="p0016" num="0016">Alongside this processing, the original (unfiltered) training segment is filtered in order to remove the breathing signal, but this time, no smoothing occurs. In this signal, high frequency components are determined which usually coincide with each heart beat. In this process, the passband frequencies of the filter used to detect the high frequency components are adjusted automatically.</p><p id="p0017" num="0017">The cluster that contains the feature vectors relating to the heart beats is identified using the characteristics of the individual clusters together with the determined high frequency components.</p><p id="p0018" num="0018">During the assignment step (step 12) the newly measured or received signal is again filtered, smoothed and parameterized as described above. The parameters of the signal are compared with the cluster that was identified as containing the features of the heart beats in the training step (step 10). Furthermore, high frequency components are detected in the newly arriving signal. Based on the similarity to the cluster containing the heart beats and the location of the high frequency components, a first estimate of the locations of heart beats is<!-- EPO <DP n="5"> --> made. The positions of heart beats given by the first estimate are calibrated in a refinement step which is based on an autocorrelation between two consecutive heart beat signals.</p><p id="p0019" num="0019">The operation of the algorithm according to the invention will now be described in more detail with reference to <figref idrefs="f0001 f0002 f0003 f0004 f0005 f0006 f0007 f0008">Figures 2 to 10</figref> of the accompanying drawings.</p><p id="p0020" num="0020"><figref idrefs="f0001">Figure 2</figref> shows a typical segment of a BCG signal consisting of a breathing component which expresses itself as a low frequency quasi-sinusoidal signal plus a heart beat component which leads to sharp bursts. The goal of the presented algorithm is to identify the bursts related to the heart beat and to determine the pulse-to-pulse (otherwise known as the beat-to-beat) time distance between them. For this purpose, as summarised above, the algorithm first detects and learns the characteristic features of the heart beat.</p><p id="p0021" num="0021">It will be appreciated that these features change from individual to individual and also depend strongly on the position of the monitored person relative to the BCG sensor.</p><heading id="h0006">Learning step</heading><p id="p0022" num="0022">The learning step (step 10) of the algorithm is depicted in <figref idrefs="f0002">Figure 3</figref>. In step 100, a training signal, denoted s<sub>train</sub> comprising a segment of a ballistocardiogram signal is obtained. The training segment must be long enough such that it contains a number of heart beats, and it must be clear of artefacts. This segment is preferably between 10 and 60 seconds long.</p><p id="p0023" num="0023">In step 101, the breathing component is removed from the ballistocardiogram signal by means of a high pass filter with a cut-off frequency of 1 Hz. The resulting filtered signal s<sub>filt</sub> (depicted in <figref idrefs="f0003">Figure 4</figref>) is used in two different processing paths, as described further below.</p><p id="p0024" num="0024">In the later steps of the algorithm every local extremum (i.e. maximum or minimum) of the pre-processed signal is analyzed. In these steps only meaningful, well-expressed extrema should be taken into account, while considering negligibly small extrema hampers the success of the algorithm. For this reason, the segment is first smoothed by means of a low pass filter with a cut-off frequency of 10 Hz (step 102 in the flowchart of <figref idrefs="f0002">Figure 3</figref>) in the first path of the algorithm (steps 102 to 106). <figref idrefs="f0003">Figure 5</figref> shows the smoothed signal, s<sub>smooth</sub>. As can be seen, high frequency noise and hence also small local extrema still visible in <figref idrefs="f0003">Figure 4</figref> are removed such that only the basic shape of the signal remains.</p><p id="p0025" num="0025">In the BCG signal s<sub>smooth</sub> the heart beats are discernible as groups of peaks with similar amplitudes and inter-peak-distances after the breathing component has been removed.<!-- EPO <DP n="6"> --></p><p id="p0026" num="0026">In step 103, characteristic points the filtered and smoothed BCG signal are detected. In a preferred embodiment, these characteristic points are the maximas and the minimas of the signal.</p><p id="p0027" num="0027">In step 104 each detected local maxima in the signal s<sub>smooth</sub> is parameterized. In a preferred embodiment, each local maxima k is parameterised using the following features:
<ol><li>i) the amplitude (a<sub>max</sub>) of the maxima,</li><li>ii) the distance (d<sub>max</sub>) between the local maxima and the next local minima to the right,</li><li>iii) the amplitude (a<sub>min</sub>) of the next local minima to the right of the local maxima, and</li><li>iv) the distance (d<sub>min</sub>) between the next local minima to the right of the local maxima and the next local maxima to the right.</li></ol></p><p id="p0028" num="0028">These parameters are illustrated in <figref idrefs="f0004">Figure 6</figref> and they give a rough description of the shape of the signal.</p><p id="p0029" num="0029">In step 105 the parameters of n (with n usually in the range n = 3 to 10) consecutive peaks are collated and used to form feature vectors f<sub>k</sub>. A feature vector f<sub>k</sub> is given by <maths id="math0001" num="(I)"><math display="block"><mtable><mtr><mtd><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">k</mi></msub><mo>=</mo></mtd><mtd columnalign="left"><mrow><mo>[</mo><msub><mi mathvariant="normal">a</mi><mrow><mi>max</mi><mo>,</mo><mi mathvariant="normal">k</mi></mrow></msub><mo>,</mo><msub><mi mathvariant="normal">d</mi><mrow><mi>max</mi><mo>,</mo><mi mathvariant="normal">k</mi></mrow></msub><mo>,</mo><msub><mi mathvariant="normal">a</mi><mrow><mi>min</mi><mo>,</mo><mi mathvariant="normal">k</mi></mrow></msub><mo>,</mo><msub><mi mathvariant="normal">d</mi><mrow><mi>min</mi><mo>,</mo><mi mathvariant="normal">k</mi></mrow></msub><mo>,</mo><msub><mi mathvariant="normal">a</mi><mrow><mi>max</mi><mo>,</mo><mi mathvariant="normal">k</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow></msub><mo>,</mo><msub><mi mathvariant="normal">d</mi><mrow><mi>max</mi><mo>,</mo><mi mathvariant="normal">k</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow></msub><mo>,</mo><msub><mi mathvariant="normal">a</mi><mrow><mi>min</mi><mo>,</mo><mi mathvariant="normal">k</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow></msub><mo>,</mo><msub><mi mathvariant="normal">d</mi><mrow><mi>min</mi><mo>,</mo><mi mathvariant="normal">k</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow></msub><mo>,</mo><mo>…</mo><mo>,</mo></mrow></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd columnalign="left"><mrow><msub><mi mathvariant="normal">a</mi><mrow><mi>max</mi><mo>,</mo><mi mathvariant="normal">k</mi><mo>+</mo><mi mathvariant="normal">n</mi><mo>-</mo><mn mathvariant="normal">1</mn></mrow></msub><mo>,</mo><msub><mi mathvariant="normal">d</mi><mrow><mi>max</mi><mo>,</mo><mi mathvariant="normal">k</mi><mo>+</mo><mi mathvariant="normal">n</mi><mo>-</mo><mn mathvariant="normal">1</mn></mrow></msub><mo>,</mo><msub><mi mathvariant="normal">a</mi><mrow><mi>min</mi><mo>,</mo><mi mathvariant="normal">k</mi><mo>+</mo><mi mathvariant="normal">n</mi><mo>-</mo><mn mathvariant="normal">1</mn></mrow></msub><mo>,</mo><msub><mi mathvariant="normal">d</mi><mrow><mi>min</mi><mo>,</mo><mi mathvariant="normal">k</mi><mo>+</mo><mi mathvariant="normal">n</mi><mo>-</mo><mn mathvariant="normal">1</mn></mrow></msub><mo>]</mo></mrow></mtd></mtr></mtable></math><img id="ib0001" file="imgb0001.tif" wi="141" he="23" img-content="math" img-format="tif"/></maths><br/>
where k = 1, 2, ..., K-n+1, and K denotes the number of peaks in the training segment s<sub>train</sub>. The number of peaks n to be collated into each feature vector f<sub>k</sub> roughly corresponds to the number of peaks which appear during each heart beat in the BCG signal. Thus, step 105 results in K-n+1 distinct feature vectors f<sub>k</sub>.</p><p id="p0030" num="0030">It will be appreciated by those skilled in the art that other parameterizations of the BCG signal s<sub>smooth</sub> are possible. For instance, the signal can be approximated by splines where the knots of the spline approximation are the local maxima and minima and possibly a low number of other points (usually only one) in-between them. Alternatively, parameterization of the signal in terms of its most significant Fourier coefficients is possible.</p><p id="p0031" num="0031">In step 106, the feature vectors f<sub>k</sub> are clustered by similarity. Prior to this, in some embodiments of the invention, as clustering methods usually work best in low rather than high dimensional vector spaces, the dimension of the feature vectors can be reduced by means of principal component analysis.<!-- EPO <DP n="7"> --></p><p id="p0032" num="0032">In the BCG signal s<sub>smooth</sub>, the heart beats are visible as repetitive patterns of peaks. Therefore, the particular feature vectors that describe the heart beats will be similar and will be distinguished considerably from those feature vectors that describe random fluctuations of the signal in-between the beats.</p><p id="p0033" num="0033">Therefore, in step 106, grouping the feature vectors by similarity will lead to a cluster or clusters that contain the feature vectors related to the heart beats only.</p><p id="p0034" num="0034">Those skilled in the art will appreciate that various methods, like, for instance, k-means clustering, hierarchical clustering, self organizing maps and the like are suitable for grouping the feature vectors f<sub>k</sub> into clusters. It will also be appreciated that various distance measures d, like, for instance, the Euclidian distance, the angle between the individual feature vectors etc. can be used in the clustering step.</p><p id="p0035" num="0035">In a preferred embodiment of the invention, apart from the standard clustering methods, it is of advantage to form a cluster for each feature vector that contains, each time, the P (where P is in the region of 10) next neighbours with respect to a certain distance measure (preferably the Euclidian distance).</p><p id="p0036" num="0036">Any of the clustering techniques leads to a number of clusters M, and it is necessary to identify the cluster that contains the feature vectors describing the heart beat patterns (step 107).</p><p id="p0037" num="0037">The flow chart in <figref idrefs="f0005">Figure 7</figref> illustrates the steps carried out in step 107.</p><p id="p0038" num="0038">In step 1071, for each of the M clusters, the cluster centre f<sub>cm</sub> is determined (where m indicates the m-th cluster and m = 1, ..., M). Techniques for determining cluster centres are well known to those skilled in the art, and will not be described further herein.</p><p id="p0039" num="0039">In step 1072, for each of the M cluster centres identified in step 1071, the feature vector f<sub>k</sub> in the set {f<sub>k</sub>| k=1,2,...,K-n+1} that is closest to the cluster centre f<sub>cm</sub> is identified. This feature vector is denoted as f<sub>archm</sub>, as it is the feature vector that is the archetype or model of the part of the signal represented by the m<sup>th</sup> cluster. Thus, for the cluster that represents the heart beat signal, the archetype feature vector f<sub>arch</sub> or the cluster centre f<sub>c</sub> for that cluster can be seen as a model for a parameterised heart beat.</p><p id="p0040" num="0040">Next, in step 1073, the training signal s<sub>smooth</sub> is searched for the subsegment s<sub>archm</sub> that best corresponds to f<sub>archm</sub>. Effectively, steps 103 and 104 of the learning procedure are reversed for the feature vector f<sub>archm</sub>). Thus, the located subsegment s<sub>archm</sub> contains those n peaks of s<sub>smooth</sub> whose parameterization is closest to f<sub>archm</sub>.</p><p id="p0041" num="0041">Steps 1074-1078 described below indicate how the cluster and cluster centre representing the heart beat signal are identified from the M subsegments s<sub>arch</sub> and M cluster<!-- EPO <DP n="8"> --> centres identified in step 1072. Although f<sub>c</sub> is used in the following steps, it will be appreciated that f<sub>arch</sub> could be used instead.</p><p id="p0042" num="0042">Firstly, in step 1074, the distance function between each cluster centre f<sub>cm</sub> and the individual feature vectors f<sub>k</sub> is computed. Preferably, the same distance measure as used in the clustering step (step 106) is used.</p><p id="p0043" num="0043">This distance function d will have a local minima with respect to f<sub>cm</sub> at position p, where p ∈ [1,2,...,K-n+1] when the following condition is fulfilled: d(f<sub>c</sub>, f<sub>p-1</sub>) &gt; d(f<sub>c</sub>, f<sub>p</sub>) &lt; d(f<sub>c</sub>,f<sub>p+1</sub></p><p id="p0044" num="0044">It will be appreciated that the distance function d between f<sub>cm</sub> and any feature vector related to or that is part of that cluster will have a local minimum.</p><p id="p0045" num="0045">Then, in step 1075, the cross correlation between each subseqment s<sub>archm</sub> and the training signal s<sub>smooth</sub> is determined. It will be appreciated that the results of cross correlation will have maxima where the subsegment s<sub>archm</sub> is most similar to the training signal s<sub>smooth</sub> (i.e. the parts of the signal that the feature vectors in the m<sub>th</sub> cluster represent).</p><p id="p0046" num="0046">Considering the cluster and cluster centre that represents the heart beat (which have still not been identified from the M clusters at this stage), there will be a local minimum in the distance function and a local maximum in the cross correlation at each heart beat in the BCG signal s<sub>smooth</sub>.</p><p id="p0047" num="0047">Thus, in step 1076, first estimates of heart beat locations are determined separately for each of the M clusters and cluster centres using the minima of the distance function and the maxima of the cross correlation function.Further details about how these two functions are used to identify locations is given in the assignment section below.</p><p id="p0048" num="0048">In addition to the cluster and cluster centre relating to the heart beat signal providing locations for the heart beats, the other clusters will also identify locations in s<sub>smooth</sub> having local minima in the distance function and local maxima in the cross correlation function. However, these local extrema generally only appear sporadically in the BCG signal.</p><p id="p0049" num="0049">Hence clusters that are not related to the heart beat can be identified by checking the time between two individual local extrema in the BCG signal (step 1077). If the intervals between consecutive "heart beats" are larger than say, 3 seconds and/or smaller than 0.25 seconds then it can be assumed that the corresponding cluster is not related with the heart beat and can be ignored in the further analysis.</p><p id="p0050" num="0050">Although the check in step 1077 above is useful in excluding many of the clusters from the analysis, it is often the case that more than one cluster does pass the check. Hence, a further knock-out criterion is needed.<!-- EPO <DP n="9"> --></p><p id="p0051" num="0051">It is a general observation that heart beats lead to segments with comparatively high frequencies in the BCG. In the literature ("<nplcit id="ncit0004" npl-type="s"><text>Higher Frequency Phenomena in the Normal Ballistocardiogram" by J. N. Edson, R. Dickes, G. H. Flamm and M. Tobin, Circulation Research, 1958, Vol. 1, pages 405-409</text></nplcit>) these high frequency components are said to be related with the mechanical forces caused by the opening and closing of the cardiac valves. Since the frequencies of these components can vary individually but also depending on the location of the BCG sensor, a dynamically adjusted bandpass filter is used to detect them in this method (see step 110 in <figref idrefs="f0002">Figure 3</figref>).</p><p id="p0052" num="0052">The optimal parameters are determined by filtering the signal segment s<sub>filt</sub> (from step 101 in <figref idrefs="f0002">Figure 3</figref>) with various bandpass filters. The set of bandpass filters is constructed so that each individual filter has a bandwidth of 2 Hz and the whole set covers the frequency range from 4 Hz up to 22 Hz in 0.1-0.5 Hz increments. Thus, the set of bandpass filters can comprise filters having cut-off frequencies = {[4 Hz, 6 Hz], [4.1 Hz, 6.1 Hz], [4.2 Hz, 6.2 Hz], ..., [20Hz, 22Hz]}).</p><p id="p0053" num="0053">For each filter in the set, the filter response is squared and a lowpass filter with a cut-off frequency of 3.5 Hz is applied to obtain a filter response envelope (as shown in <figref idrefs="f0006">Figure 8</figref>).</p><p id="p0054" num="0054">For each of the filter response envelopes, a relevance score is assigned to each peak in the envelope by means of
<ol><li>a) the ratio between the amplitude of the peak and the average peak amplitude plus peak amplitude standard deviation, and</li><li>b) the symmetry of the peaks.</li></ol></p><p id="p0055" num="0055">The filter which leads to the highest average relevance score is then selected and used in step 110 to detect the high frequency components of the filtered BCG signal s<sub>filt</sub>. A more detailed description of the relevance score computation is provided in the assignment section below.</p><p id="p0056" num="0056">The high frequency components detected in step 110 using the optimal filter can now help to identify the cluster related to the heart beat in step 107. Returning now to <figref idrefs="f0005">Figure 7</figref>, and specifically step 1078, the cluster whose local minima in the distance function and the local maxima in the correlation function coincide best with the location of the high frequency components determined in step 110 is considered as being best related to the heart beat. Additionally, the depth of the local minima of the distance function, the amplitude of the local maxima of the cross-correlation function as well as the amplitude of the maxima of the high frequency components can be taken into account in order to determine the cluster<!-- EPO <DP n="10"> --> best describing the heart beat pattern. This cluster is denoted c<sub>HB</sub> herein. All other clusters remaining in the analysis at this stage are now disregarded.</p><p id="p0057" num="0057">The cluster centre f<sub>c</sub> of this cluster is now denoted c<sub>HBcentre</sub> (step 108 in <figref idrefs="f0002">Figure 3</figref>) and the segment in s<sub>smooth</sub> that most closely matches c<sub>HBcentre</sub> is identified. This segment is denoted s<sub>HBarch</sub> (step 109). This terminates the learning part of the algorithm.</p><heading id="h0007">Assignment step</heading><p id="p0058" num="0058">Once the centre c<sub>HBcentre</sub> and the corresponding archetype of a heart beat signal s<sub>HBarch</sub> have been determined, newly incoming BCG signals (in the online case) or the rest of the BCG signal (in the offline case) can be scanned for heart beats (step 12 in <figref idrefs="f0001">Figure 1</figref>). In the following, the online case will be described. Those skilled in the art will appreciate that analogous considerations also hold for the offline case.</p><p id="p0059" num="0059"><figref idrefs="f0007">Figure 9</figref> illustrates the method used during the assignment step.</p><p id="p0060" num="0060">Whenever new samples (s<sub>real</sub>) come in from the BCG sensor they are filtered (step 201) and smoothed (step 202) as in steps 101 and 102 of the training algorithm shown in <figref idrefs="f0002">Figure 3</figref>. Likewise , characteristic points in the filtered and smoothed signal (i.e. local maxima and minima) are determined (step 203, which is the analogue of step 103). The signal is then parameterized at the characteristic points and feature vectors are constituted (steps 204 and 205).</p><p id="p0061" num="0061">The distances between the feature vectors and the heart beat cluster centre c<sub>HBcentre</sub> are computed and scanned for local minima in step 206 (which is analogous to step 1074 in <figref idrefs="f0005">Figure 7</figref>). Likewise, the cross correlation and its maxima between s<sub>HBarch</sub> and the newly incoming signals (after filtering and smoothing) are determined (step 207).</p><p id="p0062" num="0062">Further the optimal bandpass filter determined in step 110 of the learning algorithm is applied to scan the new BCG signal (s<sub>filt</sub>) for maxima in the high frequency envelope (step 208).</p><p id="p0063" num="0063">The results of the analysis in steps 206, 207 and 208 can be used to identify where heart beats occur in the BCG signal s<sub>real</sub>. However, it will be noted that the location of the minimum of the distance function, the maximum of the cross correlation and the maximum of the high frequency components might appear at slightly different locations (times). Additionally spurious high frequency components, but also wrong local extrema of the distance and cross correlation functions can appear. In such cases it is important to assess the reliability of the individual criteria in order to find a reasonable compromise between them. Thus, in step 209, the reliability of the minima and maxima found in steps 206, 207 and 208 is assessed.<!-- EPO <DP n="11"> --></p><p id="p0064" num="0064">The reliability of a local minimum of the distance function is evaluated by means of its depth relative to the height of the two neighbouring maxima. For this purpose the differences in amplitude between the left maxima and the minima (h<sub>l</sub>) and between the right maxima and the minima (h<sub>r</sub>) are computed. The reliability r<sub>d</sub> of a minimum with amplitude a<sub>min</sub> is then evaluated as <maths id="math0002" num=""><math display="block"><msub><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi></msub><mo>=</mo><mfenced separators=""><msub><mi mathvariant="normal">h</mi><mi mathvariant="normal">l</mi></msub><mo>+</mo><msub><mi mathvariant="normal">h</mi><mi mathvariant="normal">r</mi></msub></mfenced><mo>/</mo><mfenced separators=""><mn mathvariant="normal">2</mn><mo>⁢</mo><mfenced separators=""><msub><mi mathvariant="normal">a</mi><mi>min</mi></msub><mo>+</mo><mi>max</mi><mfenced separators=""><msub><mi mathvariant="normal">h</mi><mi mathvariant="normal">r</mi></msub><mo>⁢</mo><msub><mi mathvariant="normal">h</mi><mi mathvariant="normal">l</mi></msub></mfenced></mfenced></mfenced></math><img id="ib0002" file="imgb0002.tif" wi="63" he="8" img-content="math" img-format="tif"/></maths></p><p id="p0065" num="0065">It can be shown that r<sub>d</sub> is normalized (i.e. 0 ≤ r<sub>d</sub> ≤ 1) by construction. The maximal score of 1 is assigned to minima which are symmetric with respect to the height of their neighbouring peaks and have an amplitude of 0.</p><p id="p0066" num="0066">Likewise a cross correlation peak with amplitude a<sub>max</sub> can be assessed using <maths id="math0003" num=""><math display="block"><msub><mi mathvariant="normal">r</mi><mi mathvariant="normal">x</mi></msub><mo>=</mo><mfenced separators=""><msub><mi mathvariant="normal">h</mi><mi mathvariant="normal">l</mi></msub><mo>+</mo><msub><mi mathvariant="normal">h</mi><mi mathvariant="normal">r</mi></msub></mfenced><mo>/</mo><mfenced><msub><mi mathvariant="normal">a</mi><mi>max</mi></msub></mfenced></math><img id="ib0003" file="imgb0003.tif" wi="41" he="8" img-content="math" img-format="tif"/></maths><br/>
where h<sub>l</sub> and h<sub>r</sub> are the amplitude differences between the peak and the left and right minima respectively. As with r<sub>d</sub>, r<sub>x</sub> is normalized and the maximal score is assigned to peaks that are symmetric with respect to their height above the left and right minima.</p><p id="p0067" num="0067">Finally, the reliability of a peak in the high frequency components of the signal is evaluated using <maths id="math0004" num=""><math display="block"><msub><mi mathvariant="normal">r</mi><mi>hf</mi></msub><mo>=</mo><mfenced separators=""><msub><mi mathvariant="normal">h</mi><mi mathvariant="normal">l</mi></msub><mo>+</mo><msub><mi mathvariant="normal">h</mi><mi mathvariant="normal">r</mi></msub></mfenced><mo>/</mo><mfenced separators=""><mn mathvariant="normal">2</mn><mo>⁢</mo><msub><mi mathvariant="normal">a</mi><mi>max</mi></msub></mfenced><mo>•</mo><mfenced separators=""><msub><mi mathvariant="normal">a</mi><mi>max</mi></msub><mo>/</mo><msub><mi mathvariant="normal">a</mi><mi>ref</mi></msub></mfenced></math><img id="ib0004" file="imgb0004.tif" wi="61" he="9" img-content="math" img-format="tif"/></maths></p><p id="p0068" num="0068">In this case, the first factor of the formula is identical to the calculation of r<sub>x</sub> and thus quantifies the peak's relative symmetry, whereas the second factor adjusts the score by the ratio of the peak amplitude a<sub>max</sub> to a reference amplitude a<sub>ref</sub>. The reference amplitude a<sub>ref</sub> is calculated during the training sequence as the average amplitude of the high frequency peaks plus the amplitudes' standard deviation.</p><p id="p0069" num="0069">Eventually it has to be determined how the information about the reliabilities r<sub>x</sub>, r<sub>d</sub>, and r<sub>hf</sub> computed above can be combined advantageously in order to determine at what point in time a heart beat has actually occurred (step 210). The time points at which the cross correlation criterion, the distance criterion and the high frequency component criterion would detect, each by itself, a heart beat are denoted by t<sub>x</sub>, t<sub>d</sub>, and t<sub>hf</sub> respectively. In the ideal case, these three times would be identical (i.e. t<sub>x</sub> = t<sub>d</sub> = t<sub>hf</sub>). However, in real world settings they slightly differ from each other because they try to detect heart beats by focusing on different features of the BCG signal. If a heart beat is well detected by all three criteria (distance, cross-correlation and high frequency component) simultaneously, the times t<sub>d</sub>, t<sub>x</sub> and t<sub>hf</sub> will form clearly discernable triplets (see <figref idrefs="f0008">Figure 10</figref>). The aim of the following procedure is to identify these triplets and to replace them by a representative value which can be used to identify the individual heart beats.<!-- EPO <DP n="12"> --></p><p id="p0070" num="0070">Consider, without loss of generality, the time t<sub>hf</sub> as a starting point for the further description of the algorithm. At this time t<sub>hf</sub> the high frequency criterion suggests a heart beat. In that case the algorithm detects if t<sub>x</sub> and t<sub>d</sub> lie in the interval [t<sub>hf</sub>-c, t<sub>ht</sub>+c] where c is a constant usually set to about 0.3 seconds. If t<sub>x</sub> and t<sub>d</sub> lie in this interval a representative value R<sub>ht</sub>(r*<sub>hf</sub>,t*<sub>hf</sub>) of the three times t<sub>x</sub>, t<sub>d</sub>, and t<sub>hf</sub> and of the three reliabilities r<sub>x</sub>, r<sub>d</sub>, and r<sub>hf</sub> is constructed which is defined by a point in time t*<sub>hf</sub> and by a reliability r*<sub>hf</sub>. The representative time t*<sub>hf</sub> is computed as the sum of the times t<sub>x</sub>, t<sub>d</sub>, and t<sub>hf</sub> weighted with the corresponding reliabilities r<sub>x</sub>, r<sub>d</sub>, and r<sub>hf</sub> as follows: <maths id="math0005" num=""><math display="block"><mi mathvariant="normal">t</mi><mo>⁢</mo><msub><mo>*</mo><mi>hf</mi></msub><mo>=</mo><mfenced separators=""><msub><mi mathvariant="normal">r</mi><mi mathvariant="normal">x</mi></msub><mo>⁢</mo><msub><mi mathvariant="normal">t</mi><mi mathvariant="normal">x</mi></msub><mo>+</mo><msub><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi></msub><mo>⁢</mo><msub><mi mathvariant="normal">t</mi><mi mathvariant="normal">d</mi></msub><mo>+</mo><msub><mi mathvariant="normal">r</mi><mi>hf</mi></msub><mo>⁢</mo><msub><mi mathvariant="normal">t</mi><mi>hf</mi></msub></mfenced><mo>/</mo><mfenced separators=""><msub><mi mathvariant="normal">r</mi><mi mathvariant="normal">x</mi></msub><mo>+</mo><msub><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi></msub><mo>+</mo><msub><mi mathvariant="normal">r</mi><mi>hf</mi></msub></mfenced></math><img id="ib0005" file="imgb0005.tif" wi="60" he="8" img-content="math" img-format="tif"/></maths></p><p id="p0071" num="0071">The representative reliability is simply computed as the sum of the reliabilities of the cross correlation, distance and high frequency criterion, i.e. <maths id="math0006" num=""><math display="block"><mtable><mtr><mtd><msub><msup><mi mathvariant="normal">r</mi><mo>*</mo></msup><mi>hf</mi></msub><mo>=</mo><mfenced separators=""><msub><mi mathvariant="normal">r</mi><mi mathvariant="normal">x</mi></msub><mo>+</mo><msub><mi mathvariant="normal">r</mi><mi mathvariant="normal">d</mi></msub><mo>+</mo><msub><mi mathvariant="normal">r</mi><mi>hf</mi></msub></mfenced><mo>/</mo><mi mathvariant="normal">N</mi></mtd><mtd><mspace width="4em"/><mi mathvariant="normal">N</mi><mo>=</mo><mn mathvariant="normal">3</mn></mtd></mtr></mtable></math><img id="ib0006" file="imgb0006.tif" wi="68" he="8" img-content="math" img-format="tif"/></maths></p><p id="p0072" num="0072">Until now it has been assumed that the distance and cross correlation criterion lead to only one time t<sub>d</sub> and t<sub>x</sub>, respectively, in the time interval [t<sub>hf</sub>-c, t<sub>hf</sub>+c]. If only one or even neither of these times are found in this interval, the procedure still works as described above, however the reliabilities of the missing time points are set to zero in the above formulae. Accordingly, the value of N is set to the number of non-zero reliabilities.</p><p id="p0073" num="0073">Likewise, it is also possible that the distance and/or correlation criterion suggest more than one heart beat in the interval [t<sub>hf</sub>-c, t<sub>hf</sub>+c]. If it is assumed that the distance criterion indicates two heart beats at times t<sub>d1</sub> and t<sub>d2</sub> in the interval [t<sub>hf</sub>-c, t<sub>hf</sub>+c], then the corresponding reliabilities r<sub>d1</sub> and r<sub>d2</sub> are weighted by a symmetric window function centred at t<sub>hf</sub> which decreases linearly or nonlinearly with the distance from t<sub>hf</sub>. In a preferred embodiment, a Gaussian window function is used which decreases to (almost) zero at the ends of the interval [t<sub>hf</sub>-c, t<sub>hf</sub>+c]. Only the time point t<sub>d1</sub> or t<sub>d2</sub> which has the largest weighted reliability is considered in the following steps of the algorithm while the other one is discarded.</p><p id="p0074" num="0074">So far, the procedure described above was based on the time point t<sub>hf</sub> as a starting point. This starting point was chosen arbitrarily, and preferably in practice the procedures outlined above are repeated with t<sub>d</sub> and t<sub>x</sub>, respectively, as the starting points. This will lead to new representatives R<sub>d</sub>(t*<sub>d</sub>, r*<sub>d</sub>) and R<sub>x</sub>(t*<sub>x</sub>, r*<sub>x</sub>). In the case of clearly discernable triplets as shown in <figref idrefs="f0008">Figure 10</figref>, the time components of the representatives t*<sub>d</sub>, t*<sub>x</sub> and t*<sub>hf</sub> are identical.</p><p id="p0075" num="0075">For each time point t at which a heart beat is thought to have occurred, the algorithm computes a score. If no representative is found at time t (i.e. no representative has a<!-- EPO <DP n="13"> --> time component t*<sub>d</sub>, t*<sub>x</sub>, or t*<sub>hf</sub> that equals t) the score is zero. Otherwise, the score equals the sum of the reliability components of those representatives that have a time component equalling t.</p><p id="p0076" num="0076">For instance, assume that there are three representatives R<sub>d</sub>(t*<sub>d</sub>,r*<sub>d</sub>), R<sub>x</sub>(t*<sub>x</sub>,r*<sub>x</sub>) and R<sub>ht</sub>(t*<sub>hf</sub>,r*<sub>hf</sub>) with t*<sub>d</sub> = t*<sub>x</sub> = t*<sub>hf</sub>= t then the corresponding score S(t) at time t equals <maths id="math0007" num=""><math display="block"><mi mathvariant="normal">S</mi><mfenced><mi mathvariant="normal">t</mi></mfenced><mo>=</mo><msub><msup><mi mathvariant="normal">r</mi><mo>*</mo></msup><mi mathvariant="normal">d</mi></msub><mo>+</mo><msub><msup><mi mathvariant="normal">r</mi><mo>*</mo></msup><mi mathvariant="normal">x</mi></msub><mo>+</mo><msub><msup><mi mathvariant="normal">r</mi><mo>*</mo></msup><mi>hf</mi></msub></math><img id="ib0007" file="imgb0007.tif" wi="40" he="9" img-content="math" img-format="tif"/></maths></p><p id="p0077" num="0077">If S(t) is larger than a predefined threshold S<sub>thresh</sub> then the algorithm detects a heart beat at time t. Otherwise no heart beat is detected and the algorithm waits for the next samples (in the online case). Those skilled in the art will appreciate that the threshold S<sub>thresh</sub> can be adjusted during the training and/or assignment step depending on the reliability values of the q last detected heart beats.</p><p id="p0078" num="0078">Furthermore, in cases where the monitored person shows a rather regular heart beat, the recently determined beat-to-beat intervals can be used to predict when the next heart beat is most likely to occur. Around these points in time the threshold S<sub>thresh</sub> is lowered in order to reduce the number of missed beats.</p><p id="p0079" num="0079">The points identified above already indicate well where the individual heart beats occurred in the BCG signal. However, in order to determine the individual beat-to-beat time intervals even more precisely, a further refinement step is required. In this step the period of time over which the pattern of a peak repeats itself for the first time in the signal is fine-tuned.</p><p id="p0080" num="0080">In particular, let t<sub>1</sub>, t<sub>2</sub>, ..., t<sub>N</sub>, where N is the number of heart beats found so far, be the time points at which heart beats have been detected. Further, let s(t<sub>p</sub>,t<sub>p+1</sub>) denote the segment of the signal s<sub>filt</sub> recorded between the time points tp and t<sub>p+1</sub>, with 1 ≤ p ≤ N-1.</p><p id="p0081" num="0081">In order to fine-tune when the p-th peak repeats itself in the signal, the argument t<sub>shift</sub> <maths id="math0008" num=""><math display="block"><msub><mi mathvariant="normal">t</mi><mi>shift</mi></msub><mo>=</mo><msub><mi>arg max</mi><mi>dt</mi></msub><mspace width="1em"/><mi>xcorr</mi><mo>⁢</mo><mfenced separators=""><mi mathvariant="normal">s</mi><mo>⁢</mo><mfenced separators=""><msub><mi mathvariant="normal">t</mi><mi mathvariant="normal">p</mi></msub><mo>⁢</mo><msub><mi mathvariant="normal">t</mi><mrow><mi mathvariant="normal">p</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow></msub></mfenced><mo>,</mo><mi mathvariant="normal">s</mi><mo>⁢</mo><mfenced separators=""><msub><mi mathvariant="normal">t</mi><mrow><mi mathvariant="normal">p</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow></msub><mo>+</mo><mi>dt</mi><mo>,</mo><mn mathvariant="normal">2</mn><mo>⁢</mo><msub><mi mathvariant="normal">t</mi><mrow><mi mathvariant="normal">p</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow></msub><mo>-</mo><msub><mi mathvariant="normal">t</mi><mi mathvariant="normal">p</mi></msub><mo>+</mo><mi>dt</mi></mfenced></mfenced><mo>,</mo><mi>dt</mi><mo>∈</mo><mfenced open="[" close="]" separators=""><mo>-</mo><mn mathvariant="normal">0.15</mn><mspace width="1em"/><mi mathvariant="normal">s</mi><mo>,</mo><mspace width="1em"/><mn mathvariant="normal">0.15</mn><mspace width="1em"/><mi mathvariant="normal">s</mi></mfenced></math><img id="ib0008" file="imgb0008.tif" wi="144" he="8" img-content="math" img-format="tif"/></maths><br/>
which maximizes the cross correlation xcorr between the segment s(t<sub>p</sub>,t<sub>p+1</sub>) and the following segment s(t<sub>p+1</sub>+dt, 2t<sub>p+1</sub> - t<sub>p</sub> - 1+dt) is determined. The beat-to-beat interval i<sub>p,p+1</sub> between the p-th and the p+1-th peak can eventually be computed as <maths id="math0009" num=""><math display="block"><msub><mi mathvariant="normal">i</mi><mrow><mi mathvariant="normal">p</mi><mo>,</mo><mi mathvariant="normal">p</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow></msub><mo>=</mo><msub><mi mathvariant="normal">t</mi><mrow><mi mathvariant="normal">p</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow></msub><mo>-</mo><msub><mi mathvariant="normal">t</mi><mi mathvariant="normal">p</mi></msub><mo>+</mo><mi>dt</mi><mn mathvariant="normal">.</mn></math><img id="ib0009" file="imgb0009.tif" wi="38" he="8" img-content="math" img-format="tif"/></maths></p><p id="p0082" num="0082">After this step the detection of the heart beat and the beat to beat interval computation is finished and the algorithm waits for the next samples to arrive. Results<!-- EPO <DP n="14"> --></p><p id="p0083" num="0083"><figref idrefs="f0008">Figure 11</figref> is a graph showing the results obtained by the algorithm according to the invention when it is applied to a short segment of BCG data where the heart beats appear rather regularly, i.e. when no arrhythmia are present. As a reference, an ECG signal obtained at the same time as the BCG signal is plotted. By comparing the two plots, it can be seen that the algorithm clearly identifies the individual heart beats in the BCG signal.</p><p id="p0084" num="0084">Further <figref idrefs="f0009">Figure 12</figref> illustrates the analysis of a BCG signal and an ECG signal that were recorded simultaneously for about 8 minutes. For each new beat the time distance to the previous beat is determined in the ECG. Likewise, the algorithm according to the invention is used to compute the corresponding beat-to-beat distances based on the BCG signal. The corresponding beat-to-beat distances of both the ECG and the BCG analysis are paired together and plotted in the scatter plot shown in <figref idrefs="f0009">Figure 12</figref>. If both the BCG and the ECG analysis lead to identical estimates, the plot in <figref idrefs="f0009">Figure 12</figref> should only contain entries along the x-y diagonal (which is indicated by a dashed line). This diagonal clearly dominates <figref idrefs="f0009">Figure 12</figref> and only very small number of deviating pairs can be found. Averaged over the entire segment, the absolute deviation between the ECG based peak-to-peak intervals and the BCG intervals was 7 ms. Altogether only 0.6 % of all peaks were missed and 0.2 % false positives were detected.</p><p id="p0085" num="0085">Finally, <figref idrefs="f0010">Figure 13</figref> shows both the ECG signal and the corresponding BCG signal of an arrythmically beating heart. As in the case of the regularly beating heart (<figref idrefs="f0008">Figure 11</figref>) the algorithm according to the invention detects all heart beats in this segment. This is not possible with algorithms that are based on the assumption that the heart is beating regularly.</p><p id="p0086" num="0086">It will be appreciated by those skilled in the art that state of the art BCG sensors can be integrated invisibly into the bed of a person to be monitored and hence offer fully unobtrusive monitoring of the heart rate and also the breathing rate. Furthermore, BCG based monitoring systems are far cheaper than established intensive care unit (ICU) monitoring systems. These two features make BCG based solutions ideal for the general ward of hospitals where the patients are no longer in need of a full scale ICU monitoring system but in which the physicians are still interested if the vital functions of their patients. Especially in this setting the accurate detection of arrhythmia is important since they can often be an indicator or predictor for other severe health problems.</p><p id="p0087" num="0087">BCG based technologies can also be used at home for long term monitoring of the heart and breathing rate. This application is, for instance, of great interest for patients suffering from heart failure since in this case reduced heart rate variability is seen as a predictor of decompensations.<!-- EPO <DP n="15"> --></p><p id="p0088" num="0088">Further, especially due to its unobtrusive nature, the BCG can be used to assess sleep quality without disturbing the monitored person at night.</p><p id="p0089" num="0089">Although the invention has been described in terms of a method or algorithm, it will be appreciated that the invention can be implemented in a BCG system (i.e. a computer apparatus in combination with apparatus for measuring the BCG signals), or as a stand-alone computer system or program. It will be appreciated that the BCG system can provide a ballistocardiogram signal in analog or digital form to the inventive apparatus, and the inventive apparatus can be adapted to receive this signal accordingly. For example, the BCG system can provide the ballistocardiogram signal to the apparatus in analog form, and the apparatus can comprise an anti-alias filter and an analog-to-digital convertor for providing a digital representation of the ballistocardiogram signal to a suitably-programmed digital signal processor in the apparatus. Alternatively, the BCG system can implement an analog-to-digital convertor so the ballistocardiogram signal is provided to the apparatus (and specifically to a digital signal processor in the apparatus) in digital form. The apparatus can receive the ballistocardiogram signal using any appropriate means, such as through a wired or wireless connection to the BCG system.</p><p id="p0090" num="0090">One embodiment of an apparatus for implementing the invention is shown in <figref idrefs="f0010">Figure 14</figref>. A ballistocardiogram signal is provided from a BCG sensor 302 to the apparatus 304. The apparatus 304 receives the BCG signal at an input port 306 and processes the BCG signal as described in the preceding description using a processor 308. Instructions for causing the processor 308 to carry out the method can be stored in a memory 310.</p><p id="p0091" num="0091">There is therefore provided an improved method and apparatus for detecting single heart beat events in a ballistocardiogram signal.</p><p id="p0092" num="0092">While the invention has been illustrated and described in detail in the drawings and foregoing description, such illustration and description are to be considered illustrative or exemplary and not restrictive; the invention is not limited to the disclosed embodiments.</p><p id="p0093" num="0093">Variations to the disclosed embodiments can be understood and effected by those skilled in the art in practicing the claimed invention, from a study of the drawings, the disclosure, and the appended claims. In the claims, the word "comprising" does not exclude other elements or steps, and the indefinite article "a" or "an" does not exclude a plurality.</p><p id="p0094" num="0094">A single processor or other unit may fulfil the functions of several items recited in the claims. The mere fact that certain measures are recited in mutually different dependent claims does not indicate that a combination of these measured cannot be used to advantage. Any reference signs in the claims should not be construed as limiting the scope. A<!-- EPO <DP n="16"> --> computer program may be stored/distributed on a suitable medium, such as an optical storage medium or a solid-state medium supplied together with or as part of other hardware, but may also be distributed in other forms, such as via the Internet or other wired or wireless telecommunication systems.</p></description><claims mxw-id="PCLM56983865" lang="DE" load-source="patent-office"><!-- EPO <DP n="21"> --><claim id="c-de-01-0001" num="0001"><claim-text>Verfahren zur Erfassung von Herzschläge eines Benutzers in einem Ballistokardiogramm (BCG), wobei das Verfahren umfasst:
<claim-text>erfassen von Herzschläge in dem BCG-Signal durch Lokalisierung von typischen Merkmalen eines Herzschlages für den Benutzer in dem BCG-Signal (12), die typischen Merkmale des Herzschlages sind erhalten während einer Trainingsphase (10), <b>dadurch gekennzeichnet dass</b> die typischen Merkmale des Herzschlags einen Modellmerkmalvektor für einen typischen Herzschlag aufweist, C<sub>HBcentre</sub>, und wobei die Phase des Erfassens von Herzschläge umfasst:
<claim-text>- identifizieren charakteristischer Punkte in dem BCG-Signal (203);</claim-text>
<claim-text>- bestimmen von Parametern des BCG-Signals an jeden der identifizierten charakteristischen Punkte (204);</claim-text>
<claim-text>- bilden einer Vielzahl von Merkmalsvektoren aus den ermittelten Parametern (205), und</claim-text>
<claim-text>- Verwendung der Vielzahl von Merkmalsvektoren und C<sub>HBcentre</sub> um Herzschläge in dem BCG-Signal (206, 207, 208, 209, 210) zu erfassen.</claim-text></claim-text></claim-text></claim><claim id="c-de-01-0002" num="0002"><claim-text>Verfahren nach Anspruch 1, wobei die typischen Merkmale des Herzschlags des Weiteren umfassen einen Abschnitt eines BCG-Signal gebraucht in der Trainingsphase (10) entsprechend dem Modelmerkmalsvektor, S<sub>HBarch</sub>, und wobei der Schritt des Verwendens umfassend:
<claim-text>- Verwendung der Vielzahl der Merkmalsvektoren, C<sub>HBcentre</sub> und S<sub>HBarch</sub>, um Herzschlägen in dem BCG-Signal (206, 207, 208, 209, 210) zu erfassen.</claim-text></claim-text></claim><claim id="c-de-01-0003" num="0003"><claim-text>Verfahren nach Anspruch 2, wobei der Schritt des Verwendens umfassend:<!-- EPO <DP n="22"> -->
<claim-text>- Berechnung der Abstände zwischen jedem der Vielzahl von Merkmalsvektoren und C<sub>HBcentre</sub> (206);</claim-text>
<claim-text>- identifizieren lokaler Minima in den erhaltenen Abständen (206); bestimmen der Kreuzkorrelation zwischen S<sub>HBarch</sub> und dem BCG-Signal (207);</claim-text>
<claim-text>- identifizieren lokaler Maxima der Kreuzkorrelation (207); und</claim-text>
<claim-text>- identifizieren von Herzschlägen in dem BCG-Signal aus den Positionen der lokalen Minima in den Abständen und der lokalen Maxima der Kreuzkorrelation (208, 209, 210).</claim-text></claim-text></claim><claim id="c-de-01-0004" num="0004"><claim-text>Verfahren nach Anspruch 3, wobei die Phase des Erfassens der Herzschläge (12) ferner umfasst:
<claim-text>- filtern des BCG Signals um eine Hochfrequenzkomponentenumhüllende (208) zu erhalten;</claim-text>
<claim-text>- identifizieren von Maxima in der Hochfrequenzkomponentenumhüllenden (208);<br/>
und wobei der Schritt des Identifizierens von Herzschlägen in dem BCG-Signal umfasst:</claim-text>
<claim-text>- identifizieren von Herzschlägen in dem BCG-Signal aus den Positionen der lokalen Minima in den Abständen, der lokalen Maxima der Kreuzkorrelation und der lokalen Maxima der Hochfrequenzkomponentenumhüllenden (209, 210).</claim-text></claim-text></claim><claim id="c-de-01-0005" num="0005"><claim-text>Verfahren nach Anspruch 4, wobei der Schritt des Identifizierens von Herzschlägen in dem BCG-Signal ferner umfasst:
<claim-text>- Beurteilung der Zuverlässigkeit von jedem der lokalen Minima in den Abständen, der lokalen Maxima der Kreuzkorrelation und der lokalen Maxima der Hochfrequenzkomponentenumhüllenden (209).</claim-text></claim-text></claim><claim id="c-de-01-0006" num="0006"><claim-text>Verfahren nach Anspruch 5, wobei der Schritt des Identifizierens von Herzschlägen in dem BCG-Signal ferner umfasst:<!-- EPO <DP n="23"> -->
<claim-text>- bilden von Dreiergruppen aus den lokalen Minima in den Abständen, den lokale Maxima der Kreuzkorrelation und der lokalen Maxima der Hochfrequenzkomponentenumhüllenden (210);</claim-text>
<claim-text>- ermitteln eines repräsentativen Werts für jede Dreiergruppe aus der beurteilten Zuverlässigkeit, der repräsentative Wert angebend die Zeit zu der ein Herzschlag in dem BCG-Signal (210) aufgetreten ist.</claim-text></claim-text></claim><claim id="c-de-01-0007" num="0007"><claim-text>Verfahren nach einem der vorhergehenden Ansprüche, das Verfahren ferner umfassend eine Trainingsphase (10), in der typische Merkmale des Herzschlages aus einem Abschnitt eines BCG-Signals, s<sub>train</sub>, erlangt sind, die Trainingsphase umfassend:
<claim-text>- identifizieren charakteristischer Punkte in S<sub>train</sub> (103);</claim-text>
<claim-text>- bestimmen von Parametern von S<sub>train</sub> an jedem der identifizierten charakteristischen Punkte (104);</claim-text>
<claim-text>- bilden eine Vielzahl von Merkmalsvektoren aus den ermittelten Parametern (105);</claim-text>
<claim-text>- gruppieren der Vielzahl von Merkmalvektoren in eine Vielzahl von Clustern gemäß der Ähnlichkeit der Merkmalsvektoren (106);</claim-text>
<claim-text>- identifizieren der Cluster in der Vielzahl von Clustern zugehörig zu den Herzschlägen (107), und</claim-text>
<claim-text>- erhalten von typischen Merkmalen des Herzschlags durch die Bestimmung eines Modellmerkmalsvektors für einen typischen Herzschlag, C<sub>HBcentre</sub>, aus den Merkmalsvektoren in dem Cluster und durch die Bestimmung eines Abschnitts eines BCG-Signals, S<sub>HBarch</sub>, der dem Modellmerkmalsvektor (108, 109) entspricht.</claim-text></claim-text></claim><claim id="c-de-01-0008" num="0008"><claim-text>Verfahren nach Anspruch 7, wobei der Schritt des Identifizierens des Clusters in der Vielzahl von Clustern zugehörig zu dem Herzschläge (107) umfasst:
<claim-text>für jedes Cluster aus der Vielzahl von Clustern:
<claim-text>- bestimmen eines Clusterzentrum F<sub>CM</sub> (1071);<!-- EPO <DP n="24"> --></claim-text>
<claim-text>- Identifizierung des Merkmalsvektors f<sub>archm</sub>, der am ehesten den Cluster Zentrum F<sub>CM</sub> (1072) gleicht;</claim-text>
<claim-text>- Auffinden des Abschnittes s<sub>archm</sub> des BCG-Signals S<sub>train</sub>, der dem Merkmalsvektor f<sub>archm</sub> (1073) entspricht;</claim-text>
<claim-text>- berechnen des Abstandsfunktion zwischen dem Clusterzentrum F<sub>CM</sub> und jedem Merkmalsvektor in dem Cluster (1074);</claim-text>
<claim-text>- brechnen der Kreuzkorrelation der s<sub>archm</sub> mit dem BCG-Signal (1075); und</claim-text>
<claim-text>- bestimmen von Schätzungen der Herzschlagpositionen in dem BCG-Signal aus Merkmalsvektoren in dem Cluster mit einem lokalen Minimum für die Abstandsfunktion und einem lokalen Maximum der Kreuzkorrelation (1076);</claim-text>
<claim-text>- filtern des BCG -Signals S<sub>train</sub> um Positionen von Hochfrequenzkomponenten (110) zu identifizieren, und</claim-text>
<claim-text>- Identifizierung des Clusters zugehörig zum Herzschlag als das Cluster das aufweist:
<claim-text>(i) Schätzungen der Herzschlagpositionen, welche angeordnet sind nach Beträge, die innerhalb eines bestimmten Zeitfensters (1077) fallen, und</claim-text>
<claim-text>(ii) die lokalen Minima in der Abstandsfunktion und lokalen Maxima der Kreuzkorrelation, die am besten mit der Position der Hochfrequenzkomponenten (1078) übereinstimmen.</claim-text></claim-text></claim-text></claim-text></claim><claim id="c-de-01-0009" num="0009"><claim-text>Verfahren nach einem der Ansprüche 1 bis 8, wobei die charakteristischen Punkte in dem BCG-Signal die Maxima in dem BCG-Signal umfassen.</claim-text></claim><claim id="c-de-01-0010" num="0010"><claim-text>Verfahren nach Anspruch 9, wobei die Parameter der einzelnen Maxima in dem BCG-Signal umfassen:
<claim-text>i) die Amplitude (a<sub>max</sub>) der Maxima,</claim-text>
<claim-text>ii) der Abstand (d<sub>max</sub>) zwischen dem lokalen Maximum und dem nächsten lokalen Minimum zur rechten Seite,<!-- EPO <DP n="25"> --></claim-text>
<claim-text>iii) die Amplitude (a<sub>min</sub>) des nächsten lokalen Minimum auf der rechten Seite des lokalen Maximums, und</claim-text>
<claim-text>iv) der Abstand (d<sub>min</sub>) zwischen dem nächste lokalen Minimum auf der rechten Seite des lokalen Maximums und dem nächsten lokalen Maximum auf der rechten Seite.</claim-text></claim-text></claim><claim id="c-de-01-0011" num="0011"><claim-text>Verfahren nach einem der Ansprüche 1 bis 10, ferner umfassend den Schritt:
<claim-text>Verringerung der Dimension der Merkmalsvektoren mit Verwendung der Hauptkomponentenanalyse.</claim-text></claim-text></claim><claim id="c-de-01-0012" num="0012"><claim-text>Verfahren nach einem der vorhergehenden Ansprüche, ferner den Schritt umfassend: Verfeinern der Positionen von in dem BCG-Signal erfassten Herzschlägen, N Herzschläge entsprechend an den Zeitpunkten t<sub>1</sub>, t<sub>2</sub>, ..., t<sub>N</sub> sein erfasst worden, durch Identifizierung des Wertes eines Parameters dt, der die Kreuzkorrelation zwischen einem Segment des BCG-Signal zwischen zwei erfassten Herzschläge zu den entsprechenden Zeiten t<sub>p</sub> und t<sub>p+1</sub>, mit 1 ≤ p ≤ N-1, und einem späteren Segment des BCG-Signal zwischen dem Zeitpunkt (t<sub>p+1</sub> + dt) und dem Zeitpunkt (2t<sub>p+1</sub> - tp + dt) maximiert.</claim-text></claim><claim id="c-de-01-0013" num="0013"><claim-text>Vorrichtung (304) zur Verwendung mit einer Anlage (302) angepasst zum Messen eines Ballistokardiogrammsignals von einem Benutzer, die Vorrichtung umfassend:
<claim-text>- Mittel (306) angepasst zum Empfangen eines Ballistokardiogrammsignals von der Anlage;</claim-text>
<claim-text>- und Verarbeitungsmittel (308) angepasst zum Durchführen des Verfahrens nach einem der Ansprüche 1 bis 12 auf dem empfangenen Ballistokardiogrammsignal.</claim-text></claim-text></claim><claim id="c-de-01-0014" num="0014"><claim-text>Ein Computerprogrammprodukt umfassend Computerprogrammcode, der wenn auf einem Computer oder einem Prozessor ausgeführt, angepasst ist<!-- EPO <DP n="26"> --> den Computer oder Prozessor zu veranlassen das Verfahren nach einem der Ansprüche 1 bis 12 durchzuführen.</claim-text></claim></claims><claims mxw-id="PCLM56983866" lang="EN" load-source="patent-office"><!-- EPO <DP n="17"> --><claim id="c-en-01-0001" num="0001"><claim-text>A method of detecting heart beats of a user in a ballistocardiogram (BCG) signal, the method comprising:
<claim-text>detecting heart beats in the BCG signal by locating typical features of a heart beat for the user in the BCG signal (12), the typical features of the heart beat having been obtained during a training step (10), <b>characterized in that</b> the typical features of the heart beat comprise a model feature vector for a typical heart beat, c<sub>HBcentre</sub>, and wherein the step of detecting heart beats comprises:</claim-text>
<claim-text>identifying characteristic points in the BCG signal (203);</claim-text>
<claim-text>determining parameters of the BCG signal at each of the identified characteristic points (204);</claim-text>
<claim-text>constituting a plurality of feature vectors from the determined parameters (205); and</claim-text>
<claim-text>using the plurality of feature vectors and c<sub>HBcentre</sub> to detect heart beats in the BCG signal (206, 207, 208, 209, 210).</claim-text></claim-text></claim><claim id="c-en-01-0002" num="0002"><claim-text>A method as claimed in claim 1, wherein the typical features of the heart beat further comprise a portion of a BCG signal used in the training step (10) corresponding to the model feature vector, s<sub>HBarch</sub>, and wherein the step of using comprises:
<claim-text>using the plurality of feature vectors, c<sub>HBcentre</sub> and s<sub>HBarch</sub> to detect heart beats in the BCG signal (206, 207, 208, 209, 210).</claim-text></claim-text></claim><claim id="c-en-01-0003" num="0003"><claim-text>A method as claimed in claim 2, wherein the step of using comprises:
<claim-text>computing the distance between each of the plurality of feature vectors and c<sub>HBcentre</sub> (206);</claim-text>
<claim-text>identifying local minima in the resulting distances(206);</claim-text>
<claim-text>determining the cross correlation between s<sub>HBarch</sub> and the BCG signal (207);</claim-text>
<claim-text>identifying local maxima in the cross correlation(207); and</claim-text>
<claim-text>identifying heart beats in the BCG signal from the locations of the local minima in the distances and the local maxima in the cross correlation (208, 209, 210).</claim-text><!-- EPO <DP n="18"> --></claim-text></claim><claim id="c-en-01-0004" num="0004"><claim-text>A method as claimed in claim 3, wherein the step of detecting heart beats (12) further comprises:
<claim-text>filtering the BCG signal to obtain a high frequency component envelope (208); and</claim-text>
<claim-text>identifying maxima in the high frequency component envelope (208);</claim-text>
<claim-text>and wherein the step of identifying heart beats in the BCG signal comprises:
<claim-text>identifying heart beats in the BCG signal from the locations of the local minima in the distances, the local maxima in the cross correlation and the local maxima in the high frequency component envelope (209, 210).</claim-text></claim-text></claim-text></claim><claim id="c-en-01-0005" num="0005"><claim-text>A method as claimed in claim 4, wherein the step of identifying heart beats in the BCG signal further comprises:
<claim-text>assessing the reliability of each of the local minima in the distances, the local maxima in the cross correlation and the local maxima in the high frequency component envelope (209).</claim-text></claim-text></claim><claim id="c-en-01-0006" num="0006"><claim-text>A method as claimed in claim 5, wherein the step of identifying heart beats in the BCG signal further comprises:
<claim-text>forming triplets from the local minima in the distances, the local maxima in the cross correlation and the local maxima in the high frequency component envelope (210);</claim-text>
<claim-text>determining a representative value for each triplet from the assessed reliability, the representative value indicating the time at which a heart beat occurred in the BCG signal (210).</claim-text></claim-text></claim><claim id="c-en-01-0007" num="0007"><claim-text>A method as claimed in any preceding claim, the method further comprising a training step (10) in which typical features of the heart beat are obtained from a portion of a BCG signal, s<sub>train</sub>, the training step comprising:
<claim-text>identifying characteristic points in s<sub>train</sub> (103);</claim-text>
<claim-text>determining parameters of s<sub>train</sub> at each of the identified characteristic points (104);</claim-text>
<claim-text>constituting a plurality of feature vectors from the determined parameters (105);<!-- EPO <DP n="19"> --></claim-text>
<claim-text>grouping the plurality of feature vectors into a plurality of clusters according to the similarity of the feature vectors (106),</claim-text>
<claim-text>identifying the cluster in the plurality of clusters related to the heart beats (107); and</claim-text>
<claim-text>obtaining typical features of the heart beat by determining a model feature vector for a typical heart beat, c<sub>HBcentre</sub>, from the feature vectors in the cluster and by determining a portion of a BCG signal, s<sub>HBarch</sub>, that corresponds to the model feature vector (108, 109).</claim-text></claim-text></claim><claim id="c-en-01-0008" num="0008"><claim-text>A method as claimed in claim 7, wherein the step of identifying the cluster in the plurality of clusters related to the heart beats (107) comprises:
<claim-text>for each cluster in the plurality of clusters:
<claim-text>determining a cluster centre f<sub>cm</sub> (1071),</claim-text>
<claim-text>identifying the feature vector f<sub>archm</sub> that most closely matches the cluster centre f<sub>cm</sub> (1072);</claim-text>
<claim-text>locating the portion s<sub>archm</sub> of the BCG signal s<sub>train</sub> that corresponds to the feature vector f<sub>archm</sub> (1073);</claim-text>
<claim-text>computing the distance function between the cluster centre f<sub>cm</sub> and each feature vector in the cluster (1074);</claim-text></claim-text>
<claim-text>computing the cross correlation of s<sub>archm</sub> with the BCG signal (1075); and</claim-text>
<claim-text>determining estimates of heart beat locations in the BCG signal from feature vectors in the cluster with a local minimum for the distance function and a local maximum for the cross-correlation (1076);</claim-text>
<claim-text>filtering the BCG signal s<sub>train</sub> to identify locations of high frequency components (110); and</claim-text>
<claim-text>identifying the cluster related to the heart beat as the cluster that has:
<claim-text>(i) estimates of heart beat locations that are spaced by amounts that fall within a specified time window (1077); and</claim-text>
<claim-text>(ii) the local minima in the distance function and local maxima in the cross correlation that coincide best with the location of the high frequency components (1078).</claim-text></claim-text></claim-text></claim><claim id="c-en-01-0009" num="0009"><claim-text>A method as claimed in any of claims 1 to 8, wherein the characteristic points in the BCG signal comprise the maxima in the BCG signal.</claim-text></claim><claim id="c-en-01-0010" num="0010"><claim-text>A method as claimed in claim 9, wherein the parameters of each maxima point in the BCG signal comprise:<!-- EPO <DP n="20"> -->
<claim-text>i) the amplitude (a<sub>max</sub>) of the maxima,</claim-text>
<claim-text>ii) the distance (d<sub>max</sub>) between the local maxima and the next local minima to the right,</claim-text>
<claim-text>iii) the amplitude (a<sub>min</sub>) of the next local minima to the right of the local maxima, and</claim-text>
<claim-text>iv) the distance (d<sub>min</sub>) between the next local minima to the right of the local maxima and the next local maxima to the right.</claim-text></claim-text></claim><claim id="c-en-01-0011" num="0011"><claim-text>A method as claimed in any of claims 1 to 10, further comprising the step of:
<claim-text>reducing the dimension of the feature vectors using principal component analysis.</claim-text></claim-text></claim><claim id="c-en-01-0012" num="0012"><claim-text>A method as claimed in any preceding claim, further comprising the step of:
<claim-text>refining the locations of heart beats detected in the BCG signal, N heart beats having been detected at times t<sub>1</sub>, t<sub>2</sub>, ..., t<sub>N</sub> respectively, by identifying the value of a parameter dt that maximises the cross correlation between a segment of the BCG signal between two detected heart beats at times tp and t<sub>p+1</sub> respectively, where 1 ≤ p ≤ N-1, and a later segment of the BCG signal between time (t<sub>p+1</sub> + dt) and time (2t<sub>p+1</sub> - t<sub>p</sub> + dt).</claim-text></claim-text></claim><claim id="c-en-01-0013" num="0013"><claim-text>An apparatus (304) for use with a device (302) configured to measure a ballistocardiogram signal of a user, the apparatus comprising:
<claim-text>means (306) configured to receive a ballistocardiogram signal from the device; and</claim-text>
<claim-text>processing means (308) configured to perform the method defined in any one of claims 1 to 12 on the received ballistocardiogram signal.</claim-text></claim-text></claim><claim id="c-en-01-0014" num="0014"><claim-text>A computer program product comprising computer program code that, when executed on a computer or processor, is configured to cause the computer or processor to perform the method defined in any of claims 1 to 12.</claim-text></claim></claims><claims mxw-id="PCLM56983867" lang="FR" load-source="patent-office"><!-- EPO <DP n="27"> --><claim id="c-fr-01-0001" num="0001"><claim-text>Une méthode de détection de battements de coeur d'un utilisateur dans un signal de ballistocardiogramme (BCG), la méthode comprenant:
<claim-text>la détection des battements cardiaques dans le signal BCG en localisant des caractéristiques typiques d'un battement de coeur pour l'utilisateur dans le signal BCG (12), les caractéristiques typiques debattement de coeur ayant été obtenue lors d'une étape d'apprentissage (10), <b>caractérisée en ce que</b> les caractéristiques typiques du battement cardiaque comprennent un vecteur caractéristique du modèle pour un battement cardiaque typique, C<sub>HBcentre</sub>, et dans laquelle l'étape de détection des battements de coeur comprend:
<claim-text>- l'identification des points caractéristiques dans le signal BCG (203);</claim-text>
<claim-text>- la détermination des paramètres du signal BCG à chacun des points caractéristiques identifiés (204);</claim-text>
<claim-text>- la constitution d'une pluralité de vecteurs caractéristiques à partir des paramètres déterminés (205);</claim-text>
<claim-text>- et l'utilisation de la pluralité de vecteurs caractéristiques et C<sub>HBcentre</sub> pour détecter les battements cardiaques dans le signal BCG (206, 207, 208, 209, 210).</claim-text></claim-text></claim-text></claim><claim id="c-fr-01-0002" num="0002"><claim-text>Une méthode selon la revendication 1, dans laquelle les caractéristiques typiques du battement de coeur comprennent en outre une partie d'un signal BCG utilisé dans l'étape d'apprentissage (10) correspondant au vecteur caractéristique du modèle, S<sub>HBarch</sub>, et dans laquellle l'étape d'utilisation comprend:<!-- EPO <DP n="28"> -->
<claim-text>- l'utilisation de la pluralité de vecteurs de caractéristiques, C<sub>HBcentre</sub> et S<sub>HBarch</sub> pour détecter les battements de coeur dans le signal BCG (206, 207, 208, 209, 210).</claim-text></claim-text></claim><claim id="c-fr-01-0003" num="0003"><claim-text>Une méthode selon la revendication 2, dans laquelle l'étape d'utilisation le calcul de la distance entre chacun des vecteurs de la pluralité de vecteurs caractéristiques et C<sub>HBcentre</sub> (206);
<claim-text>- l'identification des minima locaux dans les distances résultantes (206);</claim-text>
<claim-text>- la détermination de la corrélation croisée entre S<sub>HBarch</sub> et le signal BCG (207);</claim-text>
<claim-text>- l'identification des maxima locaux dans la corrélation croisée (207); et</claim-text>
<claim-text>- l'identification des battements de coeur dans le signal BCG) partir de l'emplacement des minima locaux dans les distances et des maxima locaux dans la corrélation croisée (208, 209, 210).</claim-text></claim-text></claim><claim id="c-fr-01-0004" num="0004"><claim-text>Une méthode telle que revendiquée dans la revendication 3, dans laquelle l'étape de détection des battements cardiaques (12) comprend en outre:
<claim-text>- le filtrage du signal BCG afin d'obtenir une enveloppe du composant de haute fréquence (208); et</claim-text>
<claim-text>- l'identification des maxima dans l'enveloppe du composant de haute fréquence (208);</claim-text>
<claim-text>- et dans laquelle l'étape consistant à identifier les battements cardiaques dans le signal BCG comprend:</claim-text>
<claim-text>- l'identification des battements cardiaques dans le signal de BCG à partir de l'emplacement des minima locaux dans les distances, des maxima locaux de la corrélation croisée et des maxima locaux dans l'enveloppe du composant de haute fréquence (209, 210).</claim-text></claim-text></claim><claim id="c-fr-01-0005" num="0005"><claim-text>Une méthode selon la revendication 4, dans laquelle l'étape d'identification<!-- EPO <DP n="29"> --> des battements cardiaques dans le signal BCG comprend en outre:
<claim-text>- l'évaluation de la fiabilité de chacun des minima locaux dans les distances, des maxima locaux de la corrélation croisée et des maxima locaux dans l'enveloppe du composant de haute fréquence (209).</claim-text></claim-text></claim><claim id="c-fr-01-0006" num="0006"><claim-text>Une méthode selon la revendication 5, dans laquelle l'étape d'identification des battements cardiaques dans le signal BCG comprend en outre:
<claim-text>- la formation de triplets à partir des minima locaux dans les distances, des maxima locaux de la corrélation croisée et des maxima locaux dans l'enveloppe du composant de haute fréquence (210);</claim-text>
<claim-text>- la détermination d'une valeur représentative pour chaque triplet à partir de la fiabilité évaluée, la valeur représentative indiquant l'instant où a eu lieu un battement de coeur dans le signal BCG (210).</claim-text></claim-text></claim><claim id="c-fr-01-0007" num="0007"><claim-text>Une méthode selon une des revendications précédentes, la method comprenant en outre une étape d'apprentissage (10) dans laquelle des caractéristiques typiques du battement de coeur sont obtenues à partir d'une partie d'un signal BCG, S<sub>train</sub>, l'étape d'apprentissage comprenant:
<claim-text>- l'identification des points caractéristiques dans S<sub>train</sub> (103);</claim-text>
<claim-text>- la détermination des paramètres de S<sub>train</sub> à chacun des points caractéristiques identifiés (104); la constitution d'une pluralité de vecteurs caractéristiques à partir des paramètres déterminés (105);</claim-text>
<claim-text>- le regroupement de la pluralité de vecteurs caractéristiques en une pluralité de groupes en fonction de la similitude des vecteurs caractéristiques (106);</claim-text>
<claim-text>- l'identification de groupes dans la pluralité de groupes liés à des battements de coeur (107), et<br/>
l'obtention de caractéristiques typiques du battement cardiaque en déterminant un vecteur caractéristique du modèle pour un battement de coeur typique, C<sub>HBcentre</sub>, à partir des vecteurs caractéristiques dans le<!-- EPO <DP n="30"> --> groupe et par la détermination d'une partie d'un signal BCG, S<sub>HBarch</sub>, qui correspond au vecteur caractéristique du modèle (108, 109).</claim-text></claim-text></claim><claim id="c-fr-01-0008" num="0008"><claim-text>Une méthode selon la revendication 7, dans laquelle l'étape d'identification du groupe dans la pluralité de groupes liés à des battements de coeur (107) comprend:
<claim-text>pour chaque groupe dans la pluralité de groupes:
<claim-text>- la détermination d'un centre du groupe f<sub>cm</sub> (1071);</claim-text>
<claim-text>- l'identification du vecteur caractéristique f<sub>archm</sub> qui se rapproche le plus du centre du groupe f<sub>cm</sub> (1072);</claim-text>
<claim-text>- la localisation de la partie s<sub>archm</sub> du signal BCG qui correspond au vecteur caractéristique f<sub>archm</sub> (1073);</claim-text>
<claim-text>- le calcul de la fonction de distance entre le centre du groupe f<sub>cm</sub> et chaqu'un des vecteurs caractéristiques dans le groupe (1074);</claim-text>
<claim-text>- le calcul de la corrélation croisée entre s<sub>archm</sub> et le signal BCG (1075); et</claim-text>
<claim-text>- la détermination des estimations des emplacements des battements de coeur dans le signal BCG à partir de vecteurs caractéristiques dans le groupe avec un minimum local pour la fonction de distance et d'un maximum local de la corrélation croisée (1076);</claim-text>
<claim-text>- le filtrage du signal BCG s<sub>train</sub> pour identifier les emplacements des composants de haute fréquence (110), et</claim-text>
<claim-text>- l'identification du groupe lié au battement cardiaque comme étant le groupe qui a:
<claim-text>(i) les estimations des emplacements des battements de coeur qui sont espacées par des montants qui entrent dans un laps de temps spécifié (1077), et</claim-text>
<claim-text>(ii) les minima locaux dans la fonction de distance et les maxima locaux de la corrélation croisée qui coïncident le mieux avec l'emplacement des composants de haute fréquence (1078).</claim-text></claim-text></claim-text><!-- EPO <DP n="31"> --></claim-text></claim><claim id="c-fr-01-0009" num="0009"><claim-text>Une méthode selon une des revendications 1 à 8, dans laquelle les points caractéristiques dans le signal BCG comprennent les maxima dans le signal BCG.</claim-text></claim><claim id="c-fr-01-0010" num="0010"><claim-text>Une méthode selon la revendication 9, dans laquelle les paramètres de chaque point maximum dans le signal BCG comprennent:
<claim-text>i) l'amplitude (a<sub>max</sub>) du maximum,</claim-text>
<claim-text>ii) la distance (d<sub>max</sub>) entre le maximum local et le minimum local suivant à droite,</claim-text>
<claim-text>iii) l'amplitude (a<sub>min</sub>) du minimum local suivant à droite du maximum local, et</claim-text>
<claim-text>iv) la distance (d<sub>min</sub>) entre le minimum local suivant vers la droite du maximum local, et le maximum local suivant à droite. d<sub>min</sub></claim-text></claim-text></claim><claim id="c-fr-01-0011" num="0011"><claim-text>Une méthode selon une des revendications 1 à 10, comprenant en outre l'étape consistant à:
<claim-text>- la réduction de la dimension des vecteurs caractéristiques en utilisant une analyse en composantes principales.</claim-text></claim-text></claim><claim id="c-fr-01-0012" num="0012"><claim-text>Une méthode selon une des revendications précédentes, comprenant en outre l'étape consistant à: affiner la localisation des battements cardiaques détectés dans le signal BCG, N battements cardiaques ayant été détecté à des instants t<sub>1</sub>, t<sub>2</sub>, ... , t<sub>n</sub> respectivement, en déterminant la valeur du paramètre dt qui maximise la corrélation croisée entre un segment du signal BCG entre deux battements cardiaques détectés à des instants tp et t<sub>p+1</sub> respectivement, où 1 ≤ p ≤ N-1, et d'un segment ultérieur du signal BCG entre les instants (t<sub>p+1</sub> + dt) et l'instant (2t<sub>p+1</sub> - tp + dt).</claim-text></claim><claim id="c-fr-01-0013" num="0013"><claim-text>Un appareil (304) pour une utilisation avec un dispositif (302) configuré pour mesurer u signal de ballistocardiogramme d'un utilisateur, l'appareil comprenant:<!-- EPO <DP n="32"> -->
<claim-text>- des moyens (306) configurés pour recevoir un signal de ballistocardiogramme à partir du dispositif; et</claim-text>
<claim-text>- des moyens de traitement (308) configurés pour effectuer la méthode définie dans une des revendications 1 à 12, sur le signal de ballistocardiogramme reçu.</claim-text></claim-text></claim><claim id="c-fr-01-0014" num="0014"><claim-text>Un produit de programme informatique comprenant un code de programme informatique qui, lorsqu'il est exécuté sur un ordinateur ou un processeur, est configuré pour amener l'ordinateur ou le processeur à exécuter la méthode définie dans une des revendications 1 à 12.</claim-text></claim></claims><drawings mxw-id="PDW16671677" load-source="patent-office"><!-- EPO <DP n="33"> --><figure id="f0001" num="1,2"><img id="if0001" file="imgf0001.tif" wi="160" he="214" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="34"> --><figure id="f0002" num="3"><img id="if0002" file="imgf0002.tif" wi="162" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="35"> --><figure id="f0003" num="4,5"><img id="if0003" file="imgf0003.tif" wi="159" he="228" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="36"> --><figure id="f0004" num="6"><img id="if0004" file="imgf0004.tif" wi="131" he="100" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="37"> --><figure id="f0005" num="7"><img id="if0005" file="imgf0005.tif" wi="129" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="38"> --><figure id="f0006" num="8"><img id="if0006" file="imgf0006.tif" wi="159" he="130" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="39"> --><figure id="f0007" num="9"><img id="if0007" file="imgf0007.tif" wi="147" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="40"> --><figure id="f0008" num="10,11"><img id="if0008" file="imgf0008.tif" wi="160" he="231" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="41"> --><figure id="f0009" num="12"><img id="if0009" file="imgf0009.tif" wi="159" he="147" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="42"> --><figure id="f0010" num="13,14"><img id="if0010" file="imgf0010.tif" wi="161" he="226" img-content="drawing" img-format="tif"/></figure></drawings><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
