<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2220616-B1" country="EP" doc-number="2220616" kind="B1" date="20140108" family-id="39708001" file-reference-id="299960" date-produced="20180825" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146588033" ucid="EP-2220616-B1"><document-id><country>EP</country><doc-number>2220616</doc-number><kind>B1</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-08854582-A" is-representative="NO"><document-id mxw-id="PAPP154850225" load-source="docdb" format="epo"><country>EP</country><doc-number>08854582</doc-number><kind>A</kind><date>20081128</date><lang>EN</lang></document-id><document-id mxw-id="PAPP222721341" load-source="docdb" format="original"><country>EP</country><doc-number>08854582.7</doc-number><date>20081128</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140552136" ucid="EP-07121814-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>07121814</doc-number><kind>A</kind><date>20071128</date></document-id></priority-claim><priority-claim mxw-id="PPC140556567" ucid="EP-08854582-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>08854582</doc-number><kind>A</kind><date>20081128</date></document-id></priority-claim><priority-claim mxw-id="PPC140551886" ucid="EP-2008066482-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>2008066482</doc-number><kind>W</kind><date>20081128</date></document-id></priority-claim><priority-claim mxw-id="PPC140553075" ucid="US-99072507-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>99072507</doc-number><kind>P</kind><date>20071128</date></document-id></priority-claim></priority-claims><dates-of-public-availability><intention-to-grant-date><date>20130717</date></intention-to-grant-date></dates-of-public-availability><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1989324571" load-source="docdb">G06T   7/00        20060101AFI20090619BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1858727487" load-source="docdb" scheme="CPC">G06T   7/181       20170101 LI20170102BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1861414753" load-source="docdb" scheme="CPC">G06T   7/42        20170101 LI20170102BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1861425077" load-source="docdb" scheme="CPC">G06T   7/12        20170101 LI20170102BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1861427942" load-source="docdb" scheme="CPC">G06T   7/149       20170101 LI20170102BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2083225456" load-source="docdb" scheme="CPC">G06T2207/30032     20130101 LA20150318BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2083225457" load-source="docdb" scheme="CPC">G06T2207/20156     20130101 LA20150318BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2083225459" load-source="docdb" scheme="CPC">G06T2207/20116     20130101 LA20150318BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2083225460" load-source="docdb" scheme="CPC">G06T2207/20061     20130101 LA20150318BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2083225463" load-source="docdb" scheme="CPC">G06T   7/0012      20130101 FI20150318BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2083225464" load-source="docdb" scheme="CPC">G06T2207/10081     20130101 LA20150318BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132368732" lang="DE" load-source="patent-office">VERFAHREN ZUM DETEKTIEREN FLACHER POLYPEN IM DARM</invention-title><invention-title mxw-id="PT132368733" lang="EN" load-source="patent-office">A METHOD FOR DETECTING FLAT POLYPS IN THE COLON</invention-title><invention-title mxw-id="PT132368734" lang="FR" load-source="patent-office">PROCÉDÉ DE DÉTECTION DES POLYPES PLATS DU CÔLON</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR919505606" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>UNIV DUBLIN CITY</last-name><address><country>IE</country></address></addressbook></applicant><applicant mxw-id="PPAR919519888" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>DUBLIN CITY UNIVERSITY</last-name></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919504740" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>WHELAN PAUL FRANCIS</last-name><address><country>IE</country></address></addressbook></inventor><inventor mxw-id="PPAR919527660" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>WHELAN, PAUL FRANCIS</last-name></addressbook></inventor><inventor mxw-id="PPAR919021228" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>WHELAN, PAUL FRANCIS</last-name><address><street>29 Calderwood Road Drumcondra</street><city>Dublin 9</city><country>IE</country></address></addressbook></inventor><inventor mxw-id="PPAR919540512" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>ROBINSON KEVIN PETER</last-name><address><country>IE</country></address></addressbook></inventor><inventor mxw-id="PPAR919510831" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>ROBINSON, KEVIN PETER</last-name></addressbook></inventor><inventor mxw-id="PPAR919021226" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>ROBINSON, KEVIN PETER</last-name><address><street>112 St. Stephen's Green</street><city>Dublin 2</city><country>IE</country></address></addressbook></inventor><inventor mxw-id="PPAR919519443" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>SEZILLE NICOLAS</last-name><address><country>IE</country></address></addressbook></inventor><inventor mxw-id="PPAR919540751" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>SEZILLE, NICOLAS</last-name></addressbook></inventor><inventor mxw-id="PPAR919021227" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>SEZILLE, NICOLAS</last-name><address><street>76 Highfield Park Dundrum</street><city>Dublin 14/1E</city><country>IE</country></address></addressbook></inventor></inventors><assignees><assignee mxw-id="PPAR919021230" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Dublin City University</last-name><iid>101056797</iid><address><street>Collins Avenue Glasnevin</street><city>Dublin D9</city><country>IE</country></address></addressbook></assignee></assignees><agents><agent mxw-id="PPAR919021229" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Lane, Cathal Michael</last-name><suffix>et al</suffix><iid>101012290</iid><address><street>5 Dartmouth Road</street><city>Dublin 6</city><country>IE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="EP-2008066482-W"><document-id><country>EP</country><doc-number>2008066482</doc-number><kind>W</kind><date>20081128</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2009068679-A1"><document-id><country>WO</country><doc-number>2009068679</doc-number><kind>A1</kind><date>20090604</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS549780593" load-source="docdb">AT</country><country mxw-id="DS549797014" load-source="docdb">BE</country><country mxw-id="DS549922350" load-source="docdb">BG</country><country mxw-id="DS549872216" load-source="docdb">CH</country><country mxw-id="DS549781519" load-source="docdb">CY</country><country mxw-id="DS549780594" load-source="docdb">CZ</country><country mxw-id="DS549797015" load-source="docdb">DE</country><country mxw-id="DS549781520" load-source="docdb">DK</country><country mxw-id="DS549781533" load-source="docdb">EE</country><country mxw-id="DS549868859" load-source="docdb">ES</country><country mxw-id="DS549922351" load-source="docdb">FI</country><country mxw-id="DS549872217" load-source="docdb">FR</country><country mxw-id="DS549797016" load-source="docdb">GB</country><country mxw-id="DS549781534" load-source="docdb">GR</country><country mxw-id="DS549797021" load-source="docdb">HR</country><country mxw-id="DS549780595" load-source="docdb">HU</country><country mxw-id="DS549888170" load-source="docdb">IE</country><country mxw-id="DS549781535" load-source="docdb">IS</country><country mxw-id="DS549872222" load-source="docdb">IT</country><country mxw-id="DS549781536" load-source="docdb">LI</country><country mxw-id="DS549922352" load-source="docdb">LT</country><country mxw-id="DS549866395" load-source="docdb">LU</country><country mxw-id="DS549922353" load-source="docdb">LV</country><country mxw-id="DS549922354" load-source="docdb">MC</country><country mxw-id="DS549866396" load-source="docdb">MT</country><country mxw-id="DS549866397" load-source="docdb">NL</country><country mxw-id="DS549872223" load-source="docdb">NO</country><country mxw-id="DS549866402" load-source="docdb">PL</country><country mxw-id="DS549888171" load-source="docdb">PT</country><country mxw-id="DS549868860" load-source="docdb">RO</country><country mxw-id="DS549866403" load-source="docdb">SE</country><country mxw-id="DS549797022" load-source="docdb">SI</country><country mxw-id="DS549872224" load-source="docdb">SK</country><country mxw-id="DS549781545" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><description mxw-id="PDES63960461" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><b><u>Field of the Invention</u></b></heading><p id="p0001" num="0001">The present invention relates to the analysis of digital images. In particular, the invention is directed towards a method of computer aided detection of colon polyps in Computed Tomography Colonography scans.</p><heading id="h0002"><b><u>Background to the Invention</u></b></heading><p id="p0002" num="0002">Polyps are abnormal growths of tissue projecting from a mucous membrane, and are commonly found in the colon, stomach, nose, bladder and uterus. Polyps can be flat, pedunculated, <i>i.e.</i> mushroom shaped, or sessile. Colon polyps, in particular, are a concern as benign colon polyps have the potential to transform with time into colon cancer. It is thought that flat polyps, or flat lesions, may lead to more aggressive cancer and may progress to cancers more rapidly than is typically the case with pedunculated or sessile polyps.</p><p id="p0003" num="0003">Computed Tomography Colonography (CTC), or Virtual Colonoscopy (VC), has become a particularly popular method in the identification of pre-cancerous polyps on the colon wall. The screening technique is non-invasive and is based on a high resolution 3-D X-ray scan of the subject's abdomen. In 2001, the feasibility of automated polyp detection in CTC was discussed by <nplcit id="ncit0001" npl-type="s"><text>Summers et al. (Radiology 219, 51-59</text></nplcit>).</p><p id="p0004" num="0004">In order to improve the efficiency and accuracy associated with locating precancerous polyps in a CTC scan, various Computer Aided Detection/Computer Assisted Diagnosis (CAD) techniques have been developed to assist the examining radiologist in assessing the results of a CTC data scan. CAD-CTC systems aim to provide the radiologist with locations for potential regions of particular interest within the very large datasets generated by CTC. This is essentially an assisted tool for radiologists who, upon examining the data provided by the method, can make an informed decision as to whether to return to a specific region in the dataset and examine the point of a potential polyp. To date, the focus of such CTC-CAD systems has been in the detection of raised (pedunculated and sessile) polyps protruding significantly from the colonic surface.<!-- EPO <DP n="2"> --></p><p id="p0005" num="0005">Some of the representative CTC-CAD polyp detection algorithms are disclosed below. <nplcit id="ncit0002" npl-type="s"><text>Görtürk and co-workers (IEEE Transactions on Medical Imaging 2001, 20(12), 1251-1260</text></nplcit>) describe a statistical approach utilising training data and support vector machines to distinguish the differentiating characteristics of polyps and healthy tissue and make classifications based on this data. <nplcit id="ncit0003" npl-type="s"><text>Yoshida and Näppi (IEEE Transactions on Medical Imaging 2001, 20(12), 1261-1274</text></nplcit>) employ hysteresis thresholding to isolated candidate polyps based on standard 3D geometric features. The candidates are further subjected to fuzzy clustering and discriminant analysis to reduce the number of false positives. The efficiency of a post-processing algorithm premised on edge displacement field-based classification was evaluated by Acar and co-workers as a means of improving polyp detection and decreasing the number of false positives found (<nplcit id="ncit0004" npl-type="s"><text>IEEE Transactions on Medical Imaging 2004, 21(12), 1461-1467</text></nplcit>).</p><p id="p0006" num="0006">In 2002 Kiss <i>et al.</i> developed a dual surface normal and sphere fitting method for polyps detection <i>(</i><nplcit id="ncit0005" npl-type="s"><text>European Radiology 2002, 12(1), 77-81</text></nplcit>). A subsequent disclosure of a modified surface normal overlap method for the detection of colonic polyps and lung nodules was described by <nplcit id="ncit0006" npl-type="s"><text>Paik et al. (IEEE Transactions on Medical Imaging 2004, 23(6), 661-675</text></nplcit>). The surface normal methods exploit the fact that normals on the colon surface intersect with neighbouring normals depending on the curvature features of the colon. The mantra of these surface normal methods is that polyps show a high incidence of surface normal intersection owing to their spherical nature.</p><p id="p0007" num="0007">A number of issued patents discuss the processes involved in segmenting virtual endoscopy images/digital medical images and detecting abnormal lesions and distortions in these images (see <patcit id="pcit0001" dnum="US5133020A"><text>US 5133020</text></patcit>, <patcit id="pcit0002" dnum="US6078680A"><text>US 6078680</text></patcit>, <patcit id="pcit0003" dnum="US6366800B"><text>US 6366800</text></patcit>, <patcit id="pcit0004" dnum="US6556696B"><text>US6556696</text></patcit>, and <patcit id="pcit0005" dnum="US6909913B"><text>US6909913</text></patcit>). The subject matter of these patents is not directed to the development of a method for detecting flat polyps, which are particularly difficult to detect through existing CAD techniques.</p><p id="p0008" num="0008"><patcit id="pcit0006" dnum="US20050078858A"><text>US Patent Application Nos. 2005/0078858</text></patcit>, <patcit id="pcit0007" dnum="US20050149286A"><text>2005/0149286</text></patcit>,<patcit id="pcit0008" dnum="US20050152588A"><text> 2005/0152588</text></patcit> all disclose methods for the detection of abnormal structures and growths in medical images. These three patent applications also place specific emphasis on the detection of polyps in the colon.</p><p id="p0009" num="0009">Existing CAD techniques primed for detecting raised polyps can also detect some flat polyps, however the sensitivity is low. The anisotropic characteristics of flat polyps make their detection more difficult. Features utilised in current methods for the<!-- EPO <DP n="3"> --> detection of polyps are not well suited to identifying flat polyps. Manual examination of a CTC scan is an option, but again the detection rate of flat polyps is quite low. Thus, there is a necessity for a method that can robustly identify potential flat polyps whilst minimising the occurrence of false positives.<!-- EPO <DP n="4"> --></p><p id="p0010" num="0010">The present invention provides a method of formatting data for detecting flat polyps in a Computed Tomography Colonography, CTC, dataset comprising the steps of:
<ol><li>i) extracting colon surface data, from the CTC dataset, within a sub-volume centred on a candidate polyp seed point;</li><li>ii) identifying individual sets of points corresponding to the candidate polyp's body and the candidate polyp's base within that sub-volume;</li><li>iii) projecting the set of points corresponding to the candidate polyp's body on to a tangent plane <i>via</i> a normal vector, wherein the normal vector is calculated from the best fitting plane to the set of points corresponding to the candidate polyp's base;</li><li>iv) isolating a new seed point for the candidate polyp from the projected data;</li><li>v) locating the nearest surface point to the new seed in the extracted dataset above, and region-growing the surface <i>ab initio</i> from this point;</li><li>vi) identifying individual sets of points corresponding to the candidate polyp's body and the candidate polyp's base in the region-grown surface, and determining the normal vector from the best fitting plane to the set of points corresponding to the candidate polyp's base;</li><li>vii) using the normal vector determined in step vi) to slice the candidate structure in a number of different orientations; and</li><li>viii) generating a series of planes for each orientation, from which elliptical structures can be identified as representative of flat polyps.</li></ol></p><p id="p0011" num="0011">Preferably, candidate seed points are located utilising a 3D Hough transform.</p><p id="p0012" num="0012">In a preferred embodiment of the invention, the sub-volume is a cube of data of side 25 mm, centred on the seed point.<!-- EPO <DP n="5"> --></p><p id="p0013" num="0013">Preferably, a distance histogram technique is utilised to identify individual sets of surface voxels corresponding to the polyp candidate's body and the polyp candidate's base. The resultant histogram represents the distance of surface points to the seed. As used herein, the term "distance histogram technique" refers to a histogram calculated using the Euclidean distance between candidate seed points and colonic surface voxels. Preferably, only those points within the range of maximum allowed flatness to maximum allowed curvature are considered when plotting the distance histogram.</p><p id="p0014" num="0014">Preferably, the distance histogram technique comprises the steps of:
<ul><li>calculating a normal vector for every surface point (using a 3D Sobel filter);</li><li>determining the standard deviation of the normals in the 3 x 3 x 3 surface neighbourhood, wherein the standard deviation is used as a measure of local surface curvature (this is referred to as the normal disparity measure);</li><li>retaining only those points within the maximum allowed flatness to the maximum allowed curvature; and</li><li>plotting a surface histogram of the number of surface voxels at any given distance from the initial seed point.</li></ul></p><p id="p0015" num="0015">In a preferred embodiment, the voxels corresponding to the polyp candidate's body and the polyp candidate's base are determined by identifying the first significant maximum and its following next significant minimum from the zero-crossings of a differential of the histogram function.</p><p id="p0016" num="0016">Preferably, isolating the new seed point comprises the steps of:
<ul><li>labelling the non-flat surface of the candidate polyp's body using region-growing, wherein this process is seeded by the points which are also part of the polyp body;</li><li>projecting these labelled points onto a tangent plane, <i>via</i> the normal vector of the best fitting plane to the set of points corresponding to the candidate polyp's base;</li><li>applying least-square ellipse fitting to the data;</li><li>locating the centre of the best-fitting ellipse; and</li><li>projecting this point, <i>via</i> the previously calculated normal vector, onto a plane passing through the 3D surface's centroid, wherein this point becomes the new seed for all further processing.</li></ul><!-- EPO <DP n="6"> --></p><p id="p0017" num="0017">Preferably, the least-square error parameter associated with the least-square ellipse fitting to the data includes a normalisation factor to account for the scale effect of the radius of the ellipse at a given angle from the centre of the ellipse. A low calculated least-square error is indicative of a candidate flat polyp.</p><p id="p0018" num="0018">Preferably, the step of locating the nearest surface point to the new seed in the extracted dataset and region-growing the surface <i>ab initio</i> from this point is based on a geodesic distance metric.</p><p id="p0019" num="0019">Ideally, region-growing is done on every point whose normal disparity measure (<i>vide supra</i>) is lower than a maximum allowed convexity. The normal disparity measure is determined by calculating a normal vector for every surface point and determining the standard deviation of the normals in the 3 x 3 x 3 surface neighbourhood, wherein the standard deviation is used as a measure of local surface curvature (this is also referred to as a normal disparity measure).</p><p id="p0020" num="0020">Preferably, sets of points corresponding to the candidate polyp's body and the candidate polyp's base in the region-grown surface are identified using a distance histogram technique. The distance histogram technique preferably uses a distance metric comprising the sum of the distance to the seed plus a fraction of the point's geodesic distance. The point's geodesic distance is equivalent to its generation number in the region-growing process.</p><p id="p0021" num="0021">In a preferred embodiment, only non-flat surface voxels are considered.</p><p id="p0022" num="0022">The voxels corresponding to the polyp candidate's body and the polyp candidate's base may be determined by identifying the first significant maximum and its following next significant minimum from the zero-crossings of a differential of the histogram function.</p><p id="p0023" num="0023">In a preferred embodiment, the candidate structure is sliced in seven different orientations using the normal vector calculated from the best fitting plane to the set of points corresponding to candidate polyp's base. Preferably, the candidate structure is sliced in seven different orientations based on the orientation of the normal vector and two sets of three orientations at two different angles from the normal vector. A normal plane and a tangent plane may then be extracted for each different orientation. The surface, volume, and plane normals are then preferably rotated so that the candidate polyp has a horizontal orientation. A tightest bounding box may then be fitted to the<!-- EPO <DP n="7"> --> data, and the working volume for the data may be extracted from this sub-volume. The data may then be padded to get square images.</p><p id="p0024" num="0024">The method of the invention may optionally comprise an edge detection step, wherein edge detection may be performed on each of the planes extracted. The edges representing the candidate polyp may be detected using a canny filter. Preferably, only the three strongest connected edges are kept. Edge linking may be performed between the two strongest edges, and only the two strongest edges may be retained following edge linking. As will be appreciated by a person skilled in the art, edge strength is defined as the magnitude of the local greyscale gradient vector at the corresponding location in the original grey data.</p><p id="p0025" num="0025">Once data has been formatted in accordance with the above method, the data can be used in the subsequent classification of polyps, as also provided by the present invention. Preferably, classification is by means of a classification committee. There may be one classifier for each plane from the three orientation types. Each classifier preferably casts an individual vote on the class of polyp the plane belongs to, e.g. flat, round, or fold. Preferably, the fmal classification decision is based on the results of the individual classifiers. The features utilised in classification may be extracted from the individual planes.</p><p id="p0026" num="0026">Preferably, the features utilised in classification may comprise at least one of:
<ul><li>applying least squares fitting to the strongest edge in the plane to fmd the best fitting line, circle and ellipse;</li><li>calculating the angle between the two best fitting lines on the two edges to identify folds;</li><li>determining the tissue pixels content of the ellipse;</li><li>calculating the mean and variance of the tissue values, and</li><li>calculating the third order moment invariants from a processed edge</li></ul></p><p id="p0027" num="0027">Preferably, when applying least squares fitting, the fitting error for the line and circle are kept as features as well as the ellipse dimensions, ratio, and the ellipse error as described above.</p><p id="p0028" num="0028">The invention further provides a processing apparatus for performing the above method of data formatting and classification, The invention further provides a computer<!-- EPO <DP n="8"> --> readable medium or software having instructions which, when executed by a processor, perform the above method of data formatting and classification.</p><p id="p0029" num="0029">It will be appreciated that such software may be integrated into new or existing CAD-CTC tools to provide a fully automated tool for the detection of flat polyps in CTC data.</p><p id="p0030" num="0030">It will be appreciated that the present invention provides an automated image analysis based approach to the problems previously associated with the detection of flat polyps in CTC data. These problems include the extreme difficulty in detecting, manually or automatically, flat polyps in both CT colonography and optical colonoscopy. There are no existing automated solutions to the flat polyp detection problem. Existing automated systems for detecting raised polyps will also detect flat polyps, the sensitivity is very low. Manual examinations via optical colonoscopy or CT Colonography can sometimes detect flat polyps but the detection rate is low. The present invention provides an automated alternative to unaided manual detection. The solution provided by the present invention addresses difficult technical challenges involved in the robust identification of non-obvious features in the data.</p><heading id="h0003"><b><u>Brief Description of the Drawings</u></b></heading><p id="p0031" num="0031">Embodiments of the invention will be described, by way of example only, with reference to the accompanying drawings in which:</p><p id="p0032" num="0032"><figref idrefs="f0001">Figure 1</figref> is a distance histogram plot of a section of colon surface data extracted with a cube of data of side 25 mm, centred on a seed point;</p><p id="p0033" num="0033"><figref idrefs="f0001">Figure 2</figref> is an representation of the non-flat surface points projected onto a tangent plane with best fit ellipses overlayed, for a flat polyp, a raised polyp, and two folds;</p><p id="p0034" num="0034"><figref idrefs="f0002">Figure 3</figref> is an illustration of an ellipse utilized to formulate the modified error for the least-square ellipse fitting;</p><p id="p0035" num="0035"><figref idrefs="f0003">Figure 4</figref> illustrates fourteen extracted slicing planes of six candidate polyp structures - The first row have been extracted from a raised polyp. The next three rows come from three flat polyps, and the final two rows represent candidates, which were in fact folds;</p><p id="p0036" num="0036"><figref idrefs="f0004">Figure 5</figref> is a flow chart representing the method of the present invention.<!-- EPO <DP n="9"> --></p><heading id="h0004"><b><u>Detailed Description of the Drawings</u></b></heading><p id="p0037" num="0037">This method for detecting flat polyps in a Computed Tomography Colonography (CTC) dataset is represented in the flowchart of <figref idrefs="f0004">Figure 5</figref>. The method comprises the initial steps of segmenting the data for the colon from the rest of the data in the CTC dataset, and locating candidate polyp seed points utilising a 3D Hough transform based approach. Each candidate polyp seed point represents a higher than normal concentration of surface normal intersections; in general, more than one seed is generated for any given flat polyp, which aids in detection. The original data is composed of non-isometric voxels, typically exhibiting an inter-slice resolution of approximately half the in-slice resolution. The later steps of the method are centred on feature extraction from planes of custom orientations, thus it is necessary for the data to be rendered isotropic. This is achieved by interpolating the data set on a seed by seed approach. Interpolating the entire data set would not be computationally efficient.</p><p id="p0038" num="0038">Voxels corresponding to colon surface data are extracted within a small sub volume surrounding a given seed point from the dataset. The size of the volume extracted depends in the dataset resolution - typically it is calculated to represent a cube of data of side 25mm, centred on the seed point. The colon surface is detected by extracting tissue voxels in the neighbourhood of air voxels. This gives a set of points representing the different colon wall surface sections present in the volume. The local structure that generated the original seed point is identified using a distance histogram technique.</p><p id="p0039" num="0039"><figref idrefs="f0001">Figure 1</figref> shows a distance histogram plot of a section of colon surface data extracted within a cube of data of side 25 mm, centred on the seed point. The histogram represents the distance of surface points to the seed. In order to reduce the complexity in the histogram the amount of data used to build it is minimised - points corresponding to flat areas are not utilised, as they are not relevant. Similarly, points featuring very sharp local curvature are characteristic of fold ridges and are discarded as well.</p><p id="p0040" num="0040">The steps involved in processing the surface points for the distance histogram technique comprise:<!-- EPO <DP n="10"> -->
<ol><li>i) calculating a normal vector for every surface point using a 3D Sobel filter,</li><li>ii) determining the standard deviation of the normals in the 3 x 3 x 3 surface neighbourhood, wherein the standard deviation is used as a measure of normal dispersion, which is an indication of local surface curvature,</li><li>iii) retaining only those points within the maximum allowed flatness to the maximum allowed curvature, and</li><li>iv) plotting the surface histogram of the number of surface voxels at any given distance from the initial seed point.</li></ol></p><p id="p0041" num="0041">Identifying the polyp candidate's body and the polyp candidate's base is achieved by ascertaining the first significant maximum and its following next significant minimum. Since the feature is not always a robustly formed peak, a simple analysis of the first derivative is not enough. The peak maximum and the peak end (the following minimum) are best calculated from the smoothed third derivative. In <figref idrefs="f0001">Figure 1</figref> a distance histogram of the original data, the second derivative, and the third derivative is shown-the first derivative has been omitted for clarity. The two points of interest in the third derivative are the zero-crossing corresponding first vertical line in the histogram, and the zero-crossing corresponding to second vertical line in the histogram. Those points to the left of the first vertical line correspond to the body of the polyp candidate, whereas the points situated between the two vertical lines, i.e. the region shaded in <figref idrefs="f0001">Figure 1</figref>, represents the candidate's border ridge and part of the surrounding surface. As the polyp segmentation technique discussed above was based purely on distance, other surface voxels will be present in the set of points representing the polyp candidate's body. To compensate for this, the set of points corresponding to the polyp candidate's body are labelled and only the most relevant set of connected points are kept. This set is chosen based on its content of non-flat surface points as described earlier.</p><p id="p0042" num="0042">Using least-square fitting, a plane is fitted to the set of points representing the polyp base. The best fitting plane gives the candidate structure's orientation and the normal vector is calculated from the fitting parameters.</p><p id="p0043" num="0043">The histogram method described above is efficient in locating sessile and small flat polyps, but can fail to operate robustly for extended flat polyps. In the case of the latter, only a small section of the edge is segmented. To complete data reformatting and<!-- EPO <DP n="11"> --> enable more complete segmentation of polyp candidates the data is further processed. The steps involved in this further processing comprise:
<ol><li>i) labelling the non-flat surface using region-growing; this is seeded by the points which are also part of the polyp body,</li><li>ii) the labelled points are projected onto a tangent plane, <i>via</i> the normal vector as of the best fitting plane,</li><li>iii) applying least-square ellipse fitting to the data,</li><li>iv) locating the centre of the best fitting ellipse,</li><li>v) projecting this point, <i>via</i> the previously calculated normal vector, onto a plane passing through the 3D surface's centroid; wherein this point becomes the new seed for all further processing.</li></ol></p><p id="p0044" num="0044">Projected non-flat surface points, with best fit ellipses overlayed, for a flat polyp, a raised polyp, and two folds are given in <figref idrefs="f0001">Figure 2</figref>. The purpose of projecting the data onto a tangent plane is to identify the signature of large flat polyps. One of the characteristics of the non-flat surface set of points is that only the ridge of flat polyps is registered on the tangent plane. Since their bodies are flat they are not part of the set, similarly the surrounding colon wall is missing as well. Hence, the method must be able to identify elliptical lines in the projected plane. Round polyps are projected as full circle-like figures and folds or other structures as wide complex unstructured shapes. The data in the projected plane is represented as a binary image as can be seen in <figref idrefs="f0001">Figure 2</figref>. Any small holes in the projected data are filled in to aid identification.</p><p id="p0045" num="0045">In order for the least-square ellipse fitting to the projected data on the tangent plane to be reliable, modification of the least-square error term (δ) as shown in equation (1) and <figref idrefs="f0002">Figure 3</figref> was necessary. <maths id="math0001" num=""><math display="block"><mtable columnalign="left"><mtr><mtd><mi mathvariant="normal">δ</mi><mo>=</mo><mfrac><msup><mfenced separators=""><mi mathvariant="italic">OM</mi><mo>-</mo><mi>r</mi></mfenced><mn>2</mn></msup><mi>r</mi></mfrac></mtd><mtd><mi>error</mi></mtd></mtr><mtr><mtd><mi>r</mi><mo>=</mo><mi>a</mi><mo>⁢</mo><msqrt><mfrac><mrow><mn>1</mn><mo>-</mo><msup><mi>e</mi><mn>2</mn></msup></mrow><mrow><mn>1</mn><mo>-</mo><msup><mi>e</mi><mn>2</mn></msup><mo>⁢</mo><msup><mi>cos</mi><mn>2</mn></msup><mo>⁢</mo><mi mathvariant="normal">θ</mi></mrow></mfrac></msqrt></mtd><mtd><mi>radius</mi></mtd></mtr><mtr><mtd><mi>e</mi><mo>=</mo><msqrt><mn>1</mn><mo>-</mo><mfrac><msup><mi>b</mi><mn>2</mn></msup><msup><mi>a</mi><mn>2</mn></msup></mfrac></msqrt></mtd><mtd><mi>eccentricity</mi></mtd></mtr></mtable></math><img id="ib0001" file="imgb0001.tif" wi="87" he="34" img-content="math" img-format="tif"/></maths><br/>
Wherein;
<ul><li>a is the longest chord from the centre (o) to the circumference,</li><li>b is the shortest chord from the centre to the circumference,<!-- EPO <DP n="12"> --></li><li>OM is the distance from the origin to the point M</li><li>θ is the angle from the chord a to the point M</li></ul></p><p id="p0046" num="0046">For every fitted point, the method calculates the ideal point located on the ellipse at the same angle. In order to make the error term insensitive to scale effect, the radius of the ellipse at this angle (defined as the distance between a point on the ellipse and it's centre) is used as a normalisation factor in the calculation. The contribution to the error of every fitted point is the square of the distance between fitted and ideal points divided by the radius. This metric allows for a small band of error surrounding the ellipse line and increases quickly when the point is outside this band, both inside and outside the ellipse. For a low calculated error the projected data is considered to be a flat polyp.</p><p id="p0047" num="0047">Where the candidate is considered to be a flat polyp, this data is further processed. A new seed, which better represents the polyp's centre, is calculated from the fitted ellipse centre. The fitted ellipse centre is projected, <i>via</i> the previously calculated normal direction, onto a plane passing through the 3D surface's centroid. This point becomes the new seed for all further processing.</p><p id="p0048" num="0048">The colon surface data is region-grown from this new seed point. A geodesic distance is calculated from each of the points of the original colon wall surface to the new seed point. The closest surface point to the new seed is determined. From this point the surface is region-grown. Region growing is done on every point whose normal disparity measure is lower than the maximum allowed convexity. For each point added its generation number becomes its geodesic distance.</p><p id="p0049" num="0049">Once the data reformatting steps above have been completed, for example in the case of a candidate flat polyp, the seed has changed and the candidate has to be segmented again. The distance histogram processing technique is applied once again <i>(vide supra</i>) to re-segment the data. Re-segmenting comprises the steps of:
<ol><li>i) constructing a distance histogram for the candidate, wherein the distance metric used is defined to be the sum of the distance to the seed plus a fraction of the point's geodesic distance. Only non-flat surface points or voxels are considered.</li><li>ii) calculating the zero-crossings from the smoothed first derivative. Determination of the polyp body and polyp base from the maximum and next minimum values of the smoothed first derivative <i>(vide supra</i>)<i>.</i></li></ol><!-- EPO <DP n="13"> --></p><p id="p0050" num="0050">Using least-square fitting, a plane is fitted to the set of points representing the polyp base. The best fitting plane gives the candidate structure's orientation and the normal vector is calculated from the fitting parameters. The centroid of the polyp candidate is determined and this becomes the new seed.</p><p id="p0051" num="0051">Once re-segmentation has been completed, the candidate is further processed and the working volume for feature calculation must be determined. The candidate is sliced into seven orientations based on the orientation of the normal vector (calculated from the best-fitting plane to the set of points representing the polyp base) and two sets of three orientations at two different angles from the normal. A normal plane and a tangent plane are subsequently extracted for each orientation and a plane normal is computed for each of the planes extracted giving a total of 14 plane normals.</p><p id="p0052" num="0052">The surface, volume, and plane normals are then rotated so that the candidate has a horizontal orientation and the tightest bounding box is calculated for the candidate polyp. The sub-volume from the bounding box is subsequently extracted. This sub-volume becomes the working volume and contains only relevant data.</p><p id="p0053" num="0053">Each plane within the working volume is subsequently analysed to calculate a set of features. The data is padded to get square images. In the case where the data on the planes is not representative of perfect geometric shapes, the data may be optionally subjected to edge detection so as to obtain a reasonable structure for analysis in subsequent feature extraction steps. Edge detection comprises:
<ol><li>i) extracting the edges representing the candidate polyp from the image - this is achieved by applying a canny filter. The result is represented as a binary edge image, indicating edge and non-edge voxels. Any edges created due to padding during plane extraction are removed.</li><li>ii) the three strongest connected edges are kept - edge linking is performed between the two strongest edges. The edges' ends are located using a morphological approach. Once edge linking is complete, only the two strongest edges are retained.</li></ol></p><p id="p0054" num="0054">For maximum robustness, in the case that no significant edges are found in the plane a canny filter with more aggressive parameters is applied and if this does not succeed the plane is enlarged and the process repeated until an edge is found or a set limit is reached.<!-- EPO <DP n="14"> --></p><p id="p0055" num="0055"><figref idrefs="f0003">Figure 4</figref> illustrates the fourteen extracted planes, subjected to edge detection, for six separate candidates. The first row corresponds to a raised polyp. The next three rows show planes extracted from a flat polyps. The extracted planes in the final two rows are representative of folds.</p><p id="p0056" num="0056">Polyp classification is by means of a classification committee. For each polyp candidate the method extracts a number of features from the fourteen planes. The seven orientations guiding plane extraction can be represented in three categories: the normal orientation and the two different elevations, which means that the method has built-in redundancy. This redundancy was introduced to make the classification resistant to feature failure in some planes, as well as to improve recognition of irregular polyps and folds. Additionally, if the features from a particular plane are deemed unfit for classification they are not passed on to the classifier.</p><p id="p0057" num="0057">The features utilised in classification are calculated from the strongest edge previously found. The classification system includes at least one step selected from:
<ul><li>Applying least squares fitting to the strongest edge to find the best fitting line, circle and ellipse. The fitting error for the line and circle are kept as features as well as the ellipse dimensions, ratio, and the ellipse error as described above;</li><li>Calculating the angle between the two best fitting lines on the two edges to identify folds;</li><li>Determining the tissue pixels content of the ellipse;</li><li>Calculating the mean and variance of the tissue values;</li><li>Calculating the third order moment invariants from a processed edge, <i>i. e.</i> the strongest edge is processed so that it becomes a single curve (all additional branches are trimmed). This is achieved by tracking each of the edge's ends until a fork is found. For every fork, the shortest branch is then trimmed.</li></ul></p><p id="p0058" num="0058">All the features used for classification are by nature or artificially made scale independent.</p><p id="p0059" num="0059">The classification works as a committee of classifiers. There is one classifier for each plane from the three orientation types. This means six classifiers since each orientation leads to the extraction of two orthogonal planes (normal and tangent). Each<!-- EPO <DP n="15"> --> classifier casts an individual vote on the class the plane belongs to (flat, round, fold). The final decision is taken based on the result of the individual classifications. This approach allows the individual classifier to use different subsets of the feature space. This reduces the number of features used and allows them to be used only in relevant situations.</p><heading id="h0005"><b><u>Examples</u></b></heading><p id="p0060" num="0060">The operation of the technique has been validated on a database of CTC scans from a number of sources, containing manually flagged real flat lesions, artificial phantom data, and synthetic polyps, artificially generated and digitally inserted into the datasets, designed to mimic the characteristics of the real lesions. This use of synthetic polyps is necessary due to the small number of real polyps which have been flagged in the test databases of CTC scans. This situation is unsurprising in light of the fact that flat lesions are currently so difficult to detect.</p><p id="p0061" num="0061">The detection results presented in Table 1 illustrate the effectiveness of the procedure in identifying flat lesions. The results shown are for a series of tests conducted using CT scans of a custom phantom, designed to accurately mimic the appearance and characteristics of a real CTC examination. In this way it is possible to conduct many tests without any exposure of subjects to the ionising radiation associated with taking an x-ray CT scan.
<tables id="tabl0001" num="0001"><table frame="all"><title><b>Table 1</b> Polyp detection results for synthetic data (VSG phantom)</title><tgroup cols="3"><colspec colnum="1" colname="col1" colwidth="33mm"/><colspec colnum="2" colname="col2" colwidth="29mm"/><colspec colnum="3" colname="col3" colwidth="32mm"/><thead><row><entry valign="top">Polyp size (mm)</entry><entry align="center" valign="top">Number</entry><entry align="center" valign="top">Sensitivity</entry></row></thead><tbody><row><entry>≥10</entry><entry align="center">15</entry><entry align="center">93.3</entry></row><row><entry>5 to 10</entry><entry align="center">12</entry><entry align="center">100</entry></row><row><entry>&lt;5</entry><entry align="center">11</entry><entry align="center">100</entry></row><row><entry>Flat.</entry><entry align="center">19</entry><entry align="center">100</entry></row><row><entry>Flat + Depressed</entry><entry align="center">22</entry><entry align="center">86.3</entry></row><row><entry>All Sizes</entry><entry align="center">60</entry><entry align="center">93.3</entry></row></tbody></tgroup></table></tables><!-- EPO <DP n="16"> --></p><p id="p0062" num="0062">The invention is not limited to the embodiments hereinbefore described but may be varied in both construction and detail.</p><p id="p0063" num="0063">The words "comprises/comprising" and the words "having/including" when used herein with reference to the present invention are used to specify the presence of stated features, integers, steps or components but do not preclude the presence or addition of one or more other features, integers, steps, components or groups thereof.</p><p id="p0064" num="0064">It is appreciated that certain features of the invention, which are, for clarity, described in the context of separate embodiments, may also be provided in combination in a single embodiment. Conversely, various features of the invention which are, for brevity, described in the context of a single embodiment, may also be provided separately or in any suitable sub-combination.</p></description><claims mxw-id="PCLM56984120" lang="DE" load-source="patent-office"><!-- EPO <DP n="20"> --><claim id="c-de-01-0001" num="0001"><claim-text>Verfahren zur Formatierung von Daten zur Erkennung von flachen Polypen in einem Datensatz einer computertomographischen Kolonographie, CTC, das folgende Schritte umfasst:
<claim-text>i) Extrahieren von Daten der Kolonoberfläche aus dem CTC-Datensatz innerhalb eines Teilvolumens zentriert zu einem Saatpunkt eines Kandidatenpolypen;</claim-text>
<claim-text>ii) Identifizieren individueller, dem Körper des Kandidatenpolypen und der Basis des Kandidatenpolypen entsprechenden Menge von Punkten innerhalb dieses Teilvolumens;</claim-text>
<claim-text>iii) Projizieren der dem Polypenkörper entsprechenden Menge von Punkten auf eine Tangentialebene mittels eines Normalvektors, wobei der Normalvektor aus der Ebene berechnet wird, die der der Basis des Kandidatenpolypen entsprechenden Menge von Punkten am nächsten kommt;</claim-text>
<claim-text>iv) Isolieren eines neuen Saatpunkts für den Kandidatenpolypen aus den projizierten Daten; und</claim-text>
<claim-text>v) Lokalisieren des Flächenpunktes, der der neuen Saat im vorstehend genannten extrahierten Datensatz am nächsten gelegen ist, und Erweitern einer Region der Fläche <i>ab initio</i> von diesem Punkt aus;</claim-text>
<claim-text>vi) Identifizieren individueller Mengen von Punkten, die dem Körper des Kandidatenpolypen und der Basis des Kandidatenpolypen in der erweiterten Region der Fläche entsprechen, und Bestimmen des Normalvektors aus der Ebene, die der der Basis des Kandidatenpolypen entsprechenden Menge von Punkten am nächsten kommt;</claim-text>
<claim-text>vii) Verwenden des Normalvektors aus Schritt vi), um die Kandidatenstruktur in eine Reihe von unterschiedlichen Richtungen zu unterteilen; und</claim-text>
<claim-text>viii) Generieren einer Reihe von Ebenen für jede Richtung, wobei elliptische Strukturen als Vertreter flacher Polypen betrachtet werden können.</claim-text><!-- EPO <DP n="21"> --></claim-text></claim><claim id="c-de-01-0002" num="0002"><claim-text>Verfahren nach Anspruch 1, wobei die Kandidatensaatpunkte unter Verwendung einer 3D-Hough-Transformation lokalisiert werden.</claim-text></claim><claim id="c-de-01-0003" num="0003"><claim-text>Verfahren nach Anspruch 1, wobei eine Isolierung des neuen Saatpunks folgende Schritte umfasst:
<claim-text>i) Kennzeichnen der nicht flachen Oberfläche des Körpes des Kandidatenpolypen mittels Erweitern einer Region, wobei für diesen Prozess die Punkte als Saatpunkte dienen, die ebenso Teil des Polypenkörpers sind;</claim-text>
<claim-text>ii) Projizieren dieser gekennzeichneten Punkte auf eine Tangentialebene mittels des Normalvektors der Ebene, die der der Basis des Kandidatenpolypen entsprechenden Menge von Punkten am nächsten kommt;</claim-text>
<claim-text>iii) Ellipsenanpassung an die Daten nach der Methode der kleinsten Quadrate;</claim-text>
<claim-text>iv) Lokalisieren des Zentrums der am besten passenden Ellipse; und</claim-text>
<claim-text>v) Projizieren dieses Punks, mittels des zuvor berechneten Normalvektors auf eine Ebene, die durch den Zentroiden der 3D-Oberfläche verläuft, wobei dieser Punkt zum neuen Saatpunkt für die gesamte weitere Verarbeitung wird.</claim-text></claim-text></claim><claim id="c-de-01-0004" num="0004"><claim-text>Verfahren nach Anspruch 1, wobei die Kandidatenstruktur unter Verwendung des Normalvektors, welcher aus der Ebene berechnet wurde, die der der Basis des Kandidatenpolypen entsprechenden Menge von Punkten am nächsten kommt, in sieben verschiedenene Richtungen aufgeteilt wird.</claim-text></claim><claim id="c-de-01-0005" num="0005"><claim-text>Verfahren nach Anspruch 4, wobei eine Normalebene und eine Tangentialebene für jede verschiedene Richtung extrahiert werden.</claim-text></claim><claim id="c-de-01-0006" num="0006"><claim-text>Verfahren nach Anspruch 5, wobei eine engste umhüllende Box an die Daten angepasst wird und die Arbeitsmenge für die Daten diesem Teilvolumen entnommen wird.</claim-text></claim><claim id="c-de-01-0007" num="0007"><claim-text>Verfahren nach Anspruch 1 das einen Konturerfassungsschritt umfasst.</claim-text></claim><claim id="c-de-01-0008" num="0008"><claim-text>Verfahren nach Anspruch 7, wobei die Konturerfassung auf jeder der extrahierten Ebenen durchgeführt wird.<!-- EPO <DP n="22"> --></claim-text></claim><claim id="c-de-01-0009" num="0009"><claim-text>Verfahren nach Anspruch 8, wobei Konturen, die den Kandidatenpolypen darstellen, mittels eines Canny-Filters erkannt werden.</claim-text></claim><claim id="c-de-01-0010" num="0010"><claim-text>Verwendung der Methode nach einem der vorstehenden Ansprüche zur Klassifikation von Polypen.</claim-text></claim><claim id="c-de-01-0011" num="0011"><claim-text>Verwendung der Methode nach Anspruch 10, wobei die Klassifizierung durch einen Klassifizierungsausschuss erfolgt.</claim-text></claim><claim id="c-de-01-0012" num="0012"><claim-text>Verwendung der Methode nach Anspruch 11, wobei der Klassifizierungsausschuss einen Klassierer für jede Schnittebene umfasst.</claim-text></claim><claim id="c-de-01-0013" num="0013"><claim-text>Computerlesbares Medium mit Anweisungen, die bei Ausführung durch einen Prozessor das Verfahren nach einem der vorhergehenden Ansprüche ausführen.</claim-text></claim></claims><claims mxw-id="PCLM56984121" lang="EN" load-source="patent-office"><!-- EPO <DP n="17"> --><claim id="c-en-01-0001" num="0001"><claim-text>A method of formatting data for detecting flat polyps in a Computed Tomography Colonography, CTC, dataset comprising the steps of:
<claim-text>i) extracting colon surface data, from the CTC dataset, within a sub-volume centred on a candidate polyp seed point;</claim-text>
<claim-text>ii) identifying individual sets of points corresponding to the candidate polyp's body and the candidate polyp's base within that sub-volume;</claim-text>
<claim-text>iii) projecting the set of points corresponding to the candidate polyp's body on to a tangent plane <i>via</i> a normal vector, wherein the normal vector is calculated from the best fitting plane to the set of points corresponding to the candidate polyp's base;</claim-text>
<claim-text>iv) isolating a new seed point for the candidate polyp from the projected data; and</claim-text>
<claim-text>v) locating the nearest surface point to the new seed in the extracted dataset above, and region-growing the surface <i>ab initio</i> from this point;</claim-text>
<claim-text>vi) identifying individual sets of points corresponding to the candidate polyp's body and the candidate polyp's base in the region-grown surface, and determining the normal vector from the best fitting plane to the set of points corresponding to the candidate polyp's base;</claim-text>
<claim-text>vii) using the normal vectorin step vi) to slice the candidate structure in a number of different orientations; and</claim-text>
<claim-text>viii) generating a series of planes for each orientation, wherein elliptical structures can be identified as representative of flat polyps.</claim-text></claim-text></claim><claim id="c-en-01-0002" num="0002"><claim-text>The method of claim 1 wherein the candidate seed points are located utilising a 3D Hough transform.</claim-text></claim><claim id="c-en-01-0003" num="0003"><claim-text>The method of claim 1 wherein isolation of the new seed point comprises the steps of:
<claim-text>i) labelling the non-flat surface of the candidate polyp's body using region-growing, wherein this process is seeded by the points which are also part of the polyp body;<!-- EPO <DP n="18"> --></claim-text>
<claim-text>ii) projecting these labelled points onto a tangent plane, <i>via</i> the normal vector of the best fitting plane to the set of points corresponding to the candidate polyp's base;</claim-text>
<claim-text>iii) applying least-square ellipse fitting to the data;</claim-text>
<claim-text>iv) locating the centre of the best-fitting ellipse; and</claim-text>
<claim-text>v) projecting this point, <i>via</i> the previously calculated normal vector, onto a plane passing through the 3D surface's centroid, wherein this point becomes the new seed for all further processing.</claim-text></claim-text></claim><claim id="c-en-01-0004" num="0004"><claim-text>The method of claim 1 wherein the candidate structure is sliced in seven different orientations using the normal vector calculated from the best fitting plane to the set of points corresponding to candidate polyp's base.</claim-text></claim><claim id="c-en-01-0005" num="0005"><claim-text>The method of claim 4 wherein a normal plane and a tangent plane are extracted for each different orientation.</claim-text></claim><claim id="c-en-01-0006" num="0006"><claim-text>The method of claim 5 wherein a tightest bounding box is fitted to the data, and the working volume for the data is extracted from this sub-volume.</claim-text></claim><claim id="c-en-01-0007" num="0007"><claim-text>The method of claim 1 comprising an edge detection step.</claim-text></claim><claim id="c-en-01-0008" num="0008"><claim-text>The method of claim 7 wherein edge detection is performed on each of the planes extracted.</claim-text></claim><claim id="c-en-01-0009" num="0009"><claim-text>The method of claim 8 wherein edges representing the candidate polyp are detected using a canny filter.</claim-text></claim><claim id="c-en-01-0010" num="0010"><claim-text>Use of the method of any preceding claim in the classification of polyps.</claim-text></claim><claim id="c-en-01-0011" num="0011"><claim-text>Use of the method of claim 10 wherein classification is by means of a classification committee.<!-- EPO <DP n="19"> --></claim-text></claim><claim id="c-en-01-0012" num="0012"><claim-text>Use of the method of claim 11 wherein the classification committee comprises one classifier for each cutting plane.</claim-text></claim><claim id="c-en-01-0013" num="0013"><claim-text>A computer readable medium having instructions which, when executed by a processor, perform the method of any preceding claim.</claim-text></claim></claims><claims mxw-id="PCLM56984122" lang="FR" load-source="patent-office"><!-- EPO <DP n="23"> --><claim id="c-fr-01-0001" num="0001"><claim-text>Procédé de formatage de données pour détecter des polypes plats dans un ensemble de données de colonographie par tomographie informatisée, CTC, comprenant les étapes :
<claim-text>i) d'extraction de données de surface du côlon, de l'ensemble de données CTC, dans un sous-volume centré sur un point de germe de polype candidat ;</claim-text>
<claim-text>ii) d'indentification de séries individuelles de points correspondant au corps du polype candidat et à la base du polype candidat dans ce sous-volume ;</claim-text>
<claim-text>iii) de projection de la série de points correspondant au corps du polype candidat sur un plan tangente au moyen d'un vecteur normal, ledit vecteur normal étant calculé d'après le plan de meilleur ajustement à la série de points correspondant à la base du polype candidate ;</claim-text>
<claim-text>iv) d'isolement d'un point de germe nouveau pour le polype candidat à partir des données projetées ; et</claim-text>
<claim-text>v) de localisation du point de surface le plus proche du germe nouveau dans l'ensemble de données extraites ci-dessus, et de croissance de région de la surface <i>ab initio</i> à partir de ce point ;</claim-text>
<claim-text>vi) d'identification de séries individuelles de points correspondant au corps du polype candidat et à la base du polype candidat dans la surface de croissance de régions, et de détermination du vecteur normal à partir du plan de meilleur ajustement à la série de points correspondant à la base du polype candidat ;</claim-text>
<claim-text>vii) d'utilisation de l'étape de détermination d'un vecteur normal vi) pour découper en tranches la structure candidate en un nombre d'orientations différentes ; et</claim-text>
<claim-text>viii) de production d'une série de plans pour chaque orientation, où des structures elliptiques peuvent<!-- EPO <DP n="24"> --> être identifiées en tant que structures représentatives de polypes plats.</claim-text></claim-text></claim><claim id="c-fr-01-0002" num="0002"><claim-text>Procédé suivant la revendication 1, dans lequel les points de germes candidats sont localisés en utilisant une transformée de Hough 3D.</claim-text></claim><claim id="c-fr-01-0003" num="0003"><claim-text>Procédé suivant la revendication 1, dans lequel l'isolement du point de germe nouveau comprend les étapes :
<claim-text>i) de marquage de la surface non plate du corps du polype candidat en utilisant la croissance de régions, ce mode opératoire étant ensemencé par les points qui font également partie du corps du polype ;</claim-text>
<claim-text>ii) de projection de ces points marqués sur un plan tangente, au moyen du vecteur normal du plan de meilleur ajustement à la série de points correspondant à la base du polype candidat ;</claim-text>
<claim-text>iii) d'application d'un ajustement d'ellipse par la méthode des moindres carrés aux données ;</claim-text>
<claim-text>iv) de localisation du centre de l'ellipse obtenu par la méthode des moindres carrés ; et</claim-text>
<claim-text>v) de projection de ce point, au moyen du vecteur normal précédemment calculé, sur un plan passant à travers le centroïde de surface 3D, ce point devenant le germe nouveau pour tout traitement supplémentaire.</claim-text></claim-text></claim><claim id="c-fr-01-0004" num="0004"><claim-text>Procédé suivant la revendication 1, dans lequel la structure candidate est découpée en tranches dans sept orientations différentes en utilisant le vecteur normal calculé à partir du plan de meilleur ajustement à la série de points correspondant à la base du polype candidat.</claim-text></claim><claim id="c-fr-01-0005" num="0005"><claim-text>Procédé suivant la revendication 4, dans lequel un plan normal et un plan tangente sont extraits pour chaque orientation différente.</claim-text></claim><claim id="c-fr-01-0006" num="0006"><claim-text>Procédé suivant la revendication 5, dans lequel un boîtier de délimitation la plus étroite est adapté aux<!-- EPO <DP n="25"> --> données, et le volume de travail pour les données est extrait de ce sous-volume.</claim-text></claim><claim id="c-fr-01-0007" num="0007"><claim-text>Procédé suivant la revendication 1, comprenant une étape de détection de bord.</claim-text></claim><claim id="c-fr-01-0008" num="0008"><claim-text>Procédé suivant la revendication 7, dans lequel la détection du bord est effectuée sur chacun des plans extraits.</claim-text></claim><claim id="c-fr-01-0009" num="0009"><claim-text>Procédé suivant la revendication 8, dans lequel les bords représentant le polype candidat sont détectés en utilisant un filtre Canny.</claim-text></claim><claim id="c-fr-01-0010" num="0010"><claim-text>Utilisation du procédé de l'une quelconque des revendications précédentes dans la classification de polypes.</claim-text></claim><claim id="c-fr-01-0011" num="0011"><claim-text>Utilisation du procédé de la revendication 10, dans laquelle la classification est effectuée au moyen d'un comité de classification.</claim-text></claim><claim id="c-fr-01-0012" num="0012"><claim-text>Utilisation du procédé de la revendication 11, dans laquelle le comité de classification comprend un classificateur pour chaque plan de coupe.</claim-text></claim><claim id="c-fr-01-0013" num="0013"><claim-text>Support lisible par ordinateur comprenant des instructions qui, lors de l'exécution par un processeur, mettent en oeuvre le procédé de l'une quelconque des revendications précédentes.</claim-text></claim></claims><drawings mxw-id="PDW16671755" load-source="patent-office"><!-- EPO <DP n="26"> --><figure id="f0001" num="1,2"><img id="if0001" file="imgf0001.tif" wi="135" he="218" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="27"> --><figure id="f0002" num="3"><img id="if0002" file="imgf0002.tif" wi="119" he="92" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="28"> --><figure id="f0003" num="4"><img id="if0003" file="imgf0003.tif" wi="142" he="232" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="29"> --><figure id="f0004" num="5"><img id="if0004" file="imgf0004.tif" wi="146" he="233" img-content="drawing" img-format="tif"/></figure></drawings><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
