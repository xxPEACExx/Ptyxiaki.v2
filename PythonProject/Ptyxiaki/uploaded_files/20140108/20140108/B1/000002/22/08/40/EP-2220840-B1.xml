<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2220840-B1" country="EP" doc-number="2220840" kind="B1" date="20140108" family-id="39721916" file-reference-id="299951" date-produced="20180825" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146588032" ucid="EP-2220840-B1"><document-id><country>EP</country><doc-number>2220840</doc-number><kind>B1</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-07858853-A" is-representative="NO"><document-id mxw-id="PAPP154850224" load-source="docdb" format="epo"><country>EP</country><doc-number>07858853</doc-number><kind>A</kind><date>20071030</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140551920" ucid="IB-2007003283-W" load-source="docdb"><document-id format="epo"><country>IB</country><doc-number>2007003283</doc-number><kind>W</kind><date>20071030</date></document-id></priority-claim></priority-claims><dates-of-public-availability><intention-to-grant-date><date>20130904</date></intention-to-grant-date></dates-of-public-availability><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1989324568" load-source="ipcr">H04L  29/06        20060101AFI20130610BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1989324569" load-source="ipcr">G06F  21/35        20130101ALI20130610BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1989324570" load-source="ipcr">G06F  21/36        20130101ALI20130610BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL1989625940" load-source="docdb" scheme="CPC">H04L  63/0853      20130101 LI20130101BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989627712" load-source="docdb" scheme="CPC">G06F  21/35        20130101 LI20130101BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989641616" load-source="docdb" scheme="CPC">G06F2221/2103      20130101 LA20130101BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989645411" load-source="docdb" scheme="CPC">G06F  21/36        20130101 LI20130101BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989647729" load-source="docdb" scheme="CPC">H04L  63/0838      20130101 FI20130101BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132368729" lang="DE" load-source="patent-office">VERFAHREN ZUR AUTHENTIFIZIERUNG VON BENUTZERN IN DATENVERARBEITUNGSSYSTEMEN</invention-title><invention-title mxw-id="PT132368730" lang="EN" load-source="patent-office">METHOD OF AUTHENTICATION OF USERS IN DATA PROCESSING SYSTEMS</invention-title><invention-title mxw-id="PT132368731" lang="FR" load-source="patent-office">PROCÉDÉ D'AUTHENTIFICATION D'UTILISATEURS DANS DES SYSTÈMES DE TRAITEMENT DE DONNÉES</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR919516959" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>TELECOM ITALIA SPA</last-name><address><country>IT</country></address></addressbook></applicant><applicant mxw-id="PPAR919528218" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>TELECOM ITALIA S.P.A.</last-name></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919538673" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>GHIRARDI MAURIZIO</last-name><address><country>IT</country></address></addressbook></inventor><inventor mxw-id="PPAR919526270" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>GHIRARDI, MAURIZIO</last-name></addressbook></inventor><inventor mxw-id="PPAR919021223" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>GHIRARDI, MAURIZIO</last-name><address><street>c/o Telecom Italia S.p.A. Via G. Reiss Romoli 274</street><city>I-10148 Torino</city><country>IT</country></address></addressbook></inventor></inventors><assignees><assignee mxw-id="PPAR919021225" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Telecom Italia S.p.A.</last-name><iid>100234051</iid><address><street>Piazza degli Affari 2</street><city>20123 Milano</city><country>IT</country></address></addressbook></assignee></assignees><agents><agent mxw-id="PPAR919021224" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Maccalli, Marco</last-name><suffix>et al</suffix><iid>100044218</iid><address><street>Maccalli &amp; Pezzoli S.r.l., Via Settembrini, 40</street><city>20124 Milano</city><country>IT</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="IB-2007003283-W"><document-id><country>IB</country><doc-number>2007003283</doc-number><kind>W</kind><date>20071030</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2009056897-A1"><document-id><country>WO</country><doc-number>2009056897</doc-number><kind>A1</kind><date>20090507</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS549888163" load-source="docdb">AT</country><country mxw-id="DS549866375" load-source="docdb">BE</country><country mxw-id="DS549781493" load-source="docdb">BG</country><country mxw-id="DS549780578" load-source="docdb">CH</country><country mxw-id="DS549866376" load-source="docdb">CY</country><country mxw-id="DS549872214" load-source="docdb">CZ</country><country mxw-id="DS549868852" load-source="docdb">DE</country><country mxw-id="DS549866377" load-source="docdb">DK</country><country mxw-id="DS549866386" load-source="docdb">EE</country><country mxw-id="DS549922348" load-source="docdb">ES</country><country mxw-id="DS549781494" load-source="docdb">FI</country><country mxw-id="DS549781495" load-source="docdb">FR</country><country mxw-id="DS549868853" load-source="docdb">GB</country><country mxw-id="DS549866387" load-source="docdb">GR</country><country mxw-id="DS549872215" load-source="docdb">HU</country><country mxw-id="DS549780579" load-source="docdb">IE</country><country mxw-id="DS549866388" load-source="docdb">IS</country><country mxw-id="DS549781496" load-source="docdb">IT</country><country mxw-id="DS549866389" load-source="docdb">LI</country><country mxw-id="DS549781505" load-source="docdb">LT</country><country mxw-id="DS549888164" load-source="docdb">LU</country><country mxw-id="DS549781506" load-source="docdb">LV</country><country mxw-id="DS549781507" load-source="docdb">MC</country><country mxw-id="DS549888165" load-source="docdb">MT</country><country mxw-id="DS549781508" load-source="docdb">NL</country><country mxw-id="DS549781517" load-source="docdb">PL</country><country mxw-id="DS549922349" load-source="docdb">PT</country><country mxw-id="DS549868858" load-source="docdb">RO</country><country mxw-id="DS549781518" load-source="docdb">SE</country><country mxw-id="DS549797013" load-source="docdb">SI</country><country mxw-id="DS549780580" load-source="docdb">SK</country><country mxw-id="DS549866394" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><description mxw-id="PDES63960460" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><u>Background of the invention</u></heading><p id="p0001" num="0001">The present invention relates in general to the field of data processing systems, or computer systems, and of data networks. The invention more particularly relates to methods and systems for the authentication of users in data processing systems and data networks.</p><heading id="h0002"><u>Description of the related art</u></heading><p id="p0002" num="0002">With the term "authentication" the process is generally intended through which two or more separate entities, for instance a "client" data processing unit and a "server" data processing unit in a "client-server" system, can mutually verify their identity.</p><p id="p0003" num="0003">Several methods of authentication of a user at a computer system are known, that provide for assessing the identity of the user exploiting for instance one or more among the following verify methodologies:
<ul><li>something that the user is (for instance exploiting biometric data like the fingerprints, the vocal imprint, the retinal model, the DNA sequence or the calligraphy or other biometric identifiers of the user);</li><li>something that the user has or possesses (for instance, an identification card or a hardware device - "token" -, for example a hardware key or a "smart card" to be coupled to his/her own computer, possibly through a suitable reader device);</li><li>something that the user knows (for instance a password, a keyword and/or a "PIN"-Personal Identification Number - or a "user-name").</li></ul></p><p id="p0004" num="0004">In the past, for the authentication of a user this last paradigm was mainly exploited: the user, to be authenticated at data processing system, had to furnish a combination of user-name and password.</p><p id="p0005" num="0005">Nowadays the issue of the authentication of a user is even more felt than before, in<!-- EPO <DP n="2"> --> consequence of the continuous increase of services made available on-line through data networks (for instance, banking services, services of trading of stocks or bonds, electronic messaging services - "e-mail" -, "Really Simple Syndication"- RSS - services, newsgroups, etc.), enjoyable by a user through a computer network (Internet, company intranet and "extranet"), and, recently, also entertainment services that involve the distribution subjected to payment of contents based on the DTT (Digital Terrestrial Television) and IPTV (Internet Protocol Television) technologies.</p><p id="p0006" num="0006">Mechanisms of authentication have thus been developed that are safer and stronger in comparison to the normal mechanism based on user-name/password, such as for instance the solutions based on biometric detection or those based on hardware tokens or smart cards, accompanied by specific software ("One Time Password"- OTP -, digital certificates and the like).</p><p id="p0007" num="0007">In "<nplcit id="ncit0001" npl-type="s"><text>Authentication Using Multiple Communication Channels" by Shintaro Mizuno, Kohji Yamada, Kenji Takahashi, NTT Information Platform Sharing Laboratories, Proceedings of the 2005 workshops on Digital identity management, 2005, Fairfax, VA, USA, November 11 - 11, 2005, pages 54 - 62</text></nplcit>, a "challenge-response" authentication mechanism is described that makes use of a bidimensional barcode. The service provider site sends to a computer of the user, connected over the Internet, a barcode that includes a "challenge"; using a cellular telephone, the user reads the bidimensional barcode displayed on the screen of the computer; using again the cellular telephone, the "challenge" is sent, over a cellular telephony network, to the service provider, through an authentication server, and it is then re-sent to the cellular telephone with a signature of the service provider.</p><p id="p0008" num="0008">In <nplcit id="ncit0002" npl-type="s"><text>J.M. McCune et al., "Seeing-Is-Believing: Using Chamber Phones for Human-Verifiable Authentication", Proceedings of the 2005 IEEE Symposium on Security and Privacy, May 8-11, 2005, The Claremont Resort, Oakland, California, USA, pages 110 - 124</text></nplcit>, a system is presented that uses bidimensional barcodes and cellular phones with camera to implement a visual identification channel; the cellular phone has to be able to use the integrated camera to recognize bidimensional barcodes. The method uses the bidimensional barcodes to transfer on a mobile device a hash that will serve to verify an authentication key exchanged in other way (infrared communication, bluetooth) to establish a secure connection with a TCG-compliant application (where TCG stands for Trusted Computing Group, an organization that promotes open standards to strengthen the data processing platforms against software attacks).<!-- EPO <DP n="3"> --></p><p id="p0009" num="0009"><patcit id="pcit0001" dnum="WO2005116909A"><text>WO 2005/116909</text></patcit> discloses an apparatus for obtaining information that can be used to authenticate an entity, the apparatus comprising: an image capturing means arranged to capture an image; an image processor arranged to process the image in order to retrieve a block of ciphertext encoded in the image; and a data processor arranged to decrypt the block of ciphertext in order to obtain the information that can be used to authenticate the entity. Use of a pair of public-private encryption keys is provided for.</p><p id="p0010" num="0010"><patcit id="pcit0002" dnum="EP1713230A"><text>EP-A-1713230</text></patcit> discloses a method for setting-up a secure communication line between a user and a service provider using a non-secure communication channel within an insecure network, comprising the steps of transmitting an identity token from a user station to a service provider station both coupled to the insecure network; upon reception of the identity token, triggering the creation of a secret URL by the service provider station; transmitting the secret URL within a secure side channel to the user station; obtaining, within the user station, the secret URL, and setting-up a new communication path in the insecure network linking the user and the service provider station based on said secret URL. Beside discarding a man-in-the-middle by denying him access to the data flow it is also possible to stop him through denying him access to the content of the data flow. Such access can be denied through use of a one-time codebook with semantics only known to the User and the authentication service provider.</p><p id="p0011" num="0011"><patcit id="pcit0003" dnum="EP1713230A"><text>EP-A-1713230</text></patcit> discloses a security device for online transactions between service purveyor computer and an operator equipped with a computer. The device comprises a photo-electric sensor that is applied to the screen of the computer to identify a matrix signal from the purveyor computer which is then processed to generate a code and communications means that allows it to be accessed by the operator. The device also comprises a biometric sensor, particularly a fingerprint sensor with which data relative to the operator are input. Encryption means are provided between the photo-electric sensor and the communications means that ensures the code determined from the screen is only accessible if the fingerprint matches the one stored in the card. The security device is credit card sized and has an independent power source.<!-- EPO <DP n="4"> --></p><heading id="h0003"><u>Summary of the invention</u></heading><p id="p0012" num="0012">The Applicant has observed that the above described technologies are rather complex and their cost can exponentially grow with respect to the degree of safety and reliability that they are asked to offer.</p><p id="p0013" num="0013">For instance, in the solutions based on the use of hardware tokens, an extremely precise clock is present on the server that is able to "synchronize" with that of the device possessed by the user; discordances in the synchronization make both the user device and the authentication process unusable.</p><p id="p0014" num="0014">The technique described in the article of Mizuno <i>et al.</i> has the problem of needing a connection to a mobile telephony network, something that is not always possible.</p><p id="p0015" num="0015">The method described in the article of McCune <i>et al.</i> is not used for authenticating the user, but rather applications or devices with which it is intended to establish a data connection, and it uses some form of radio or wired communication. The security is only linked to the possession of the terminal.</p><p id="p0016" num="0016">The Applicant has therefore observed that there is the need of making available a new methodology of authentication of the user, having a high degree of security and a lower implementation cost compared to the currently available solutions.</p><p id="p0017" num="0017">The Applicant has found a methodology that is secure and, at the same time, has a low implementation cost; such methodology exploits a mechanism of authentication of the type "Challenge-Response".</p><p id="p0018" num="0018">For the purposes of the present invention, by "Challenge-Response" mechanism it is intended a mechanism such that a subject/entity that desires to authenticate at another entity, and the authenticator entity prove to share capabilities based on data processing methodologies (for instance, encryption/decryption capabilities, hashing capabilities, encoding/decoding capabilities) or information (for instance, usemame, PIN, encryption or hashing keys) that allow the mutual recognition; such "Challenge-Reponses" mechanisms are for instance exploited in the CHAP (Challenge Handshake Authentication Protocol) or Kerberos protocols, or in the authentication in mobile telephony networks of second and third generation. Particularly, for the purposes of the present invention, by "Challenge" it is intended information sent to the subject that has to be authenticated, that is univocally correlated to the subject to be authenticated, and that the subject to<!-- EPO <DP n="5"> --> be authenticated exploits for showing to possess a determined ability, generating the correct "Response" expected by the authenticator entity.</p><p id="p0019" num="0019">Particularly, the dispatch to the user of the authentication "Challenge" by the data processing system, e.g. an authentication server, at which the user desires to authenticate is for instance made in graphic form, for example in form of bidimensional barcode. The content of the graphic "Challenge" sent to the user can, if desired, be protected using encryption techniques and/or techniques of information authentication.</p><p id="p0020" num="0020">To generate the "Response" to be returned to the authentication server, the user uses a device with image capturing capabilities which is distinct from the computer through which the user has to input the information necessary to his/her authentication. For instance, such device can advantageously be a cellular telephone equipped with a camera or camcorder, a more and more diffused device nowadays, with installed a suitable software or firmware adapted to the recognition and the processing of the "Challenge" received in graphic form.</p><p id="p0021" num="0021">The "Response" sent by the user in answer as a result of the processing of the received "Challenge" does not contain enough information to make one able to retrieve the "Challenge" from which it has been calculated, and it cannot be used by an attacker with the purpose of interfering in the communication between the authentication server and the user or <i>vice versa.</i></p><p id="p0022" num="0022">An advantage of the proposed solution is that, for its operation, it does not require radio coverage, particularly by a mobile telephony network, since it exploits an "optical" reading of the information. Another advantage is that it is not based on an internal clock to produce the authentication information that has to be inputted.</p><p id="p0023" num="0023">Preferably, the authentication information produced by the authentication server, <i>i.e.</i> the "Challenge" and the "Response" expected as a response from the user, have a limited temporal validity, to prevent any possible fraudulent reuse thereof.</p><p id="p0024" num="0024">Preferably, the authentication server can implement mechanisms adapted to disable the user after a limited number, for instance equal to three, of consecutive unsuccessful attempts of authentication.</p><p id="p0025" num="0025">An advantage of the proposed solution is that the management costs are reduced compared to other authentication methodologies, because existing, non-specialized devices and software solutions are used.<!-- EPO <DP n="6"> --></p><p id="p0026" num="0026">According to an aspect of the present invention, a method of authentication of users in data processing systems is provided. The method includes:
<ul><li>generating a "Challenge" univocally associated with a user to be authenticated;</li><li>processing the "Challenge" to generate an expected answer code, to be compared to an answer code that the user has to furnish for his/her authentication;</li><li>encoding the generated "Challenge" to obtain an image displayable through a display device adapted to display the image to the user;</li><li>sending the image containing the "Challenge" to the user;</li><li>displaying the image containing the "Challenge" to the user through the display device;</li><li>through a user device equipped with an image-capturing device, optically capturing the displayed image;</li><li>through the user device, processing the captured image for extracting from the captured image the "Challenge", and subsequently processing the obtained "Challenge" to generate the answer code;</li><li>receiving the answer code from the user and comparing it to the expected answer code; and</li><li>in case of positive comparison, authenticating the user,</li></ul>
wherein one among said actions of generating the "Challenge" and the expected answer code, and said action of processing the captured image that generates said answer code exploit a secret information univocally associated with the user.</p><p id="p0027" num="0027">Said generating an expected answer code can include associating with the expected answer code a time validity limit, and said receiving the answer code from the user and comparing it to the expected answer code includes assessing if the answer code from the user is received within said time validity limit.</p><p id="p0028" num="0028">Said generating the "Challenge" can include generating a substantially random sequence of bits.</p><p id="p0029" num="0029">Said generating the "Challenge" can moreover include encoding the substantially random<!-- EPO <DP n="7"> --> sequence of bits into a first string of alphanumeric characters that univocally represents it.</p><p id="p0030" num="0030">Said encoding the "Challenge" can also include encoding the first string of alphanumeric characters, and encoding the encoded first string of alphanumeric characters to obtain the image displayable through the display device.</p><p id="p0031" num="0031">Said generating the expected answer code can include encrypting the substantially random sequence of bits with said secret information or calculating a hash of the substantially random sequence of bits with said secret information.</p><p id="p0032" num="0032">Said generating the expected answer code can also include encoding the encrypted substantially random sequence of bits, or the hash of the substantially random sequence of bits, to obtain a second string of alphanumeric characters and storing the obtained string.</p><p id="p0033" num="0033">Said processing the captured image for extracting from the captured image the "Challenge" and generating the answer code can in particular include:
<ul><li>decoding the first string of alphanumeric characters to obtain the substantially random sequence of bits;</li><li>encrypting the substantially random sequence of bits with said secret information to obtain a further encrypted substantially random sequence of bit, or calculating a hash of the substantially random sequence of bits with said secret information;</li><li>encoding the further encrypted substantially random sequence of bits, or the hash of the substantially random sequence of bits, to obtain the second string of alphanumeric characters, said second string of alphanumeric characters constituting the answer code.</li></ul></p><p id="p0034" num="0034">Said generating the "Challenge" may comprise encrypting the substantially random sequence of bits with said secret information, and possibly encoding the encrypted substantially random sequence of bits into a first string of alphanumeric characters, and encoding the first string of alphanumeric characters to obtain the image displayable through the display device.</p><p id="p0035" num="0035">Said generating the expected answer code can include encoding the substantially random sequence of bits into a second string of alphanumeric characters and storing the obtained second string.</p><p id="p0036" num="0036">Said processing the captured image for extracting from the captured image the "Challenge" and generating the answer code can include:<!-- EPO <DP n="8"> -->
<ul><li>decoding the first string of alphanumeric characters to obtain the encrypted substantially random sequence of bits;</li><li>decrypting the encrypted substantially random sequence of bits with said secret information to obtain the substantially random sequence of bits;</li><li>encoding the substantially random sequence of bits to obtain the second string of alphanumeric characters, said second string of alphanumeric characters constituting the answer code.</li></ul></p><p id="p0037" num="0037">Said encoding the generated "Challenge" to obtain an image can include generating a bidimensional barcode.</p><p id="p0038" num="0038">Said authenticating the user can include enable the user accessing, through a data processing terminal of the user connected to a data network, a service made available by a server connected to said network.</p><p id="p0039" num="0039">Said encoding the generated "Challenge" for obtaining an image can comprise including in the image summary information adapted to identify a transaction effected by the user.</p><p id="p0040" num="0040">Said sending the image containing the "Challenge" to the user can comprise including the image into an electronic mail message, and sending the electronic mail message to the user.</p><p id="p0041" num="0041">Said authenticating the user can include allowing the user to display an electronic document attached to the electronic mail message.</p><p id="p0042" num="0042">According to another aspect of the present invention, a system for the authentication of users in a data processing system is provided.</p><p id="p0043" num="0043">The system includes:
<ol><li>a) an authentication server, said authentication server being in use adapted to:
<ul><li>generate a "Challenge" univocally associated with a user to be authenticated;</li><li>processing the "Challenge" to generate an expected answer code, to be compared to an answer code that the user has to furnish for his/her authentication;</li><li>encoding the generated "Challenge" for obtaining an image;</li><li>sending the image containing the "Challenge" to a user's data processing terminal through<!-- EPO <DP n="9"> --> a data network;</li></ul>
wherein the user's data processing terminal comprises a display device adapted to display to the user the image containing the "Challenge";</li><li>b) a user device equipped with an image-capturing device, adapted to optically capture the displayed image, the user's device being adapted in use to process the captured image for extracting from the captured image the "Challenge" and to process the "Challenge" to generate an answer code to be compared to the expected answer code for the authentication of the user,<br/>
wherein one among said actions of generating a "Challenge" and generating an expected answer code, and said action of processing the captured image to generate the answer code use a secret information univocally associated with the user.</li></ol></p><heading id="h0004"><u>Brief description of the drawings</u></heading><p id="p0044" num="0044">The features and the advantages of the present invention will be made apparent by the following detailed description of some possible embodiments thereof, provided merely by way of non-limitative examples, description that will be conducted making reference to the attached drawings, wherein:
<ul><li><figref idrefs="f0001"><b>Figure 1</b></figref> schematically shows a logical model of an authentication system adapted to implement an authentication method according to an embodiment of the present invention, with represented the main constituent elements and the respective interactions;</li><li><figref idrefs="f0002"><b>Figure 2</b></figref> schematically shows a first implementation mode of an authentication method according to an embodiment of the present invention, hereinafter also defined "symmetrical mode";</li><li><figref idrefs="f0003"><b>Figure 3</b></figref> schematically shows a second implementation mode of an authentication method according to an embodiment of the present invention, hereinafter also defined "asymmetrical mode";</li><li><figref idrefs="f0004"><b>Figure 4</b></figref> schematically shows, in terms of the main operations performed by the different players and of the information exchanged among them, a possible application of the asymmetrical authentication mode, according to an embodiment of the present invention;</li><li><figref idrefs="f0005"><b>Figure 5</b></figref> schematically shows, in terms of the main operations performed by the different<!-- EPO <DP n="10"> --> players and of the information exchanged among them, another possible application of the asymmetrical authentication mode, according to an embodiment of the present invention;</li><li><figref idrefs="f0006"><b>Figure 6</b></figref> schematically shows, in terms of the main operations performed by the different players and of the information exchanged among them, a possible application of the symmetrical authentication mode, according to an embodiment of the present invention;</li><li><figref idrefs="f0007"><b>Figure 7</b></figref> schematically show, in terms of the main operations performed by the different players and of the information exchanged among them, still another possible application of the asymmetrical authentication mode, according to an embodiment of the present invention;</li><li><figref idrefs="f0008"><b>Figure 8A</b></figref> shows a possible aspect of an electronic mail message received by the user, in a further possible application of the authentication method according to an embodiment of the present invention;</li><li><figref idrefs="f0008"><b>Figure 8B</b></figref> shows a possible aspect of an attachment to the electronic mail message of <figref idrefs="f0008"><b>Figure 8A</b></figref><b>,</b> in PDF format, containing confidential information and a link to an Internet site through which on-line services are offered;</li><li><figref idrefs="f0009"><b>Figure 9</b></figref> schematizes a process of local verification of the authenticity of the electronic mail message of <figref idrefs="f0008"><b>Figure 8A</b></figref><b>.</b></li></ul></p><heading id="h0005"><u>Detailed description of some embodiments of the invention</u></heading><p id="p0045" num="0045">With reference to the drawings, in <figref idrefs="f0001"><b>Figure 1</b></figref> there is schematically shown a logical model of an authentication system <b>100</b> according to an embodiment of the present invention, with represented the main constituent elements and the respective interactions.</p><p id="p0046" num="0046">In the figure, reference <b>105</b> identifies an authentication server, at which the users, for instance the user denoted with the reference <b>110</b> in the figure, having a personal computer or user terminal <b>115</b> connected to a data network <b>120</b> like for instance the Internet, a company's intranet, an extranet, has to authenticate to be able to enter and enjoy the services made available by the authentication server <b>105</b> itself, or, in general, by one or more other servers (not shown in the figure), which rely on the services offered by the authentication server <b>105</b> for the authentication of their own users that request to exploit the services offered by such other servers. The user terminal <b>115</b> can be a conventional Personal Computer (PC), fixed or portable, or any other data processing<!-- EPO <DP n="11"> --> device.</p><p id="p0047" num="0047">Each time the user <b>110</b> wants to be authenticated at the authentication server <b>105,</b> the latter, after having received the authentication request from the user terminal <b>115</b> through the data network <b>120</b>, sends an authentication information to the terminal <b>115</b> of the user <b>110,</b> through the data network <b>120.</b></p><p id="p0048" num="0048">The authentication information is firstly generated by the authentication server <b>105</b> by means of a generation algorithm <b>123,</b> and then it is processed by a suitable processing algorithm <b>125</b>; the result of the processing of the authentication information is stored on a memory support <b>130</b>, for instance a file or a database on a non-volatile support, as a result expected as an answer from the user <b>110</b>; preferably, a respective limited temporal validity is associated with such expected result (as schematically depicted in the figure by the clock <b>135</b> associated with the memory support <b>130</b>).</p><p id="p0049" num="0049">Subsequently, the authentication server <b>105</b> encodes in graphic form the authentication information previously generated, by means of an image processing algorithm <b>140.</b></p><p id="p0050" num="0050">An authentication information <b>145</b> encoded in graphic form is thus obtained, that is sent by the authentication server <b>105</b> to the terminal <b>115</b> of the user <b>110</b>, through the data network <b>120.</b> Such authentication information <b>145</b> constitutes the graphic "Challenge" that will be received by the user <b>110</b> on his/her own terminal <b>115.</b></p><p id="p0051" num="0051">Once received by the user terminal <b>115,</b> the authentication information encoded in graphic form, <i>i.e.</i> the graphic "Challenge", is presented to the user <b>110</b> as an image, for instance on a display device <b>147</b> like a screen or monitor of the computer <b>115,</b> and/or possibly printed on a paper support by means of a printer (not shown).</p><p id="p0052" num="0052">The user <b>110</b> possesses a device <b>150</b>, preferably a portable device like for instance a cellular phone, a "smartphone", a PDA ("Personal Digital Assistant") or similar device, equipped with an optical image-capturing device <b>155</b>, for instance a digital camera or a camcorder, capable of capturing the image displayed by the user terminal <b>115</b> (or printed on the paper support), without the need of any physical contact/data link between the portable device <b>150</b> and the user terminal <b>115.</b></p><p id="p0053" num="0053">After having captured the image, the portable device <b>150</b>, by means of a suitable software preinstalled on it and that, when executed, is at least partially loaded in a working memory <b>160</b> of<!-- EPO <DP n="12"> --> the portable device <b>150,</b> performs a digital processing of the captured image. Particularly, through an image processing algorithm <b>165</b>, the graphic "Challenge" is extracted from the captured image and decoded. The information contained in the extracted and decoded graphic "Challenge" is then processed by a processing algorithm <b>170</b>, capable of providing to the user <b>110</b>, through a video and/or audio interface <b>175</b> present in the portable device <b>150</b>, information, derived from the content of the processed graphic "Challenge", that the user 110 will have to return to the authentication server <b>105</b> to be authenticated.</p><p id="p0054" num="0054">Using the terminal <b>115</b>, the user <b>110</b> communicates to the authentication server <b>105</b> the video and/or audio information provided thereto by his/her own portable device <b>150</b>; such information that the user communicates to the authentication server <b>105</b> forms the "Response" <b>180</b> to the received "Challenge" <b>145.</b></p><p id="p0055" num="0055">The authentication server <b>105</b>, having received from the user <b>110</b> the "Response" <b>180</b> through the data network <b>120,</b> by means of a comparison algorithm <b>185</b> compares the information received by the user with what previously stored on the memory support <b>130</b> as expected result, analyzing in particular the temporal validity and the content of it. If the verification has positive result, the authentication server <b>105</b> communicates to the user (through the data network <b>120</b> and the terminal <b>115</b>) that he/she has been "approved" and authenticated, otherwise the verification failure is preferably communicated to the user. Preferably, after a predetermined number, for instance three, of consecutive failed attempts of authentication, the user <b>110</b> is not accepted by the system anymore; the authentication server <b>105</b> can possibly disable the user <b>110</b>, so as to prevent further attempts of authentication; to be re-enabled, the user will for instance have to contact a help desk.</p><p id="p0056" num="0056">In the following of the present description, two possible implementation modes of the authentication method presented above will be described: a first mode, that will be called "symmetrical", and a second mode, that will be called "asymmetrical". Shortly, the symmetrical mode provides that the processing algorithm <b>125</b> used by the authentication server <b>105</b> and the processing algorithm <b>170</b> used by the portable device <b>150</b> of the user <b>110</b> are substantially identical, while the asymmetrical mode provides that the two processing algorithms are different.</p><heading id="h0006">- Symmetrical mode</heading><p id="p0057" num="0057">In <figref idrefs="f0002"><b>Figure 2</b></figref> there is schematically shown, in terms of the main operations performed by the different players and of the information exchanged among them, the symmetrical mode of<!-- EPO <DP n="13"> --> implementation of the authentication method according to an embodiment of the present invention.</p><p id="p0058" num="0058">The user <b>110</b> that desires to exploit the authentication services made available by the authentication server <b>105</b> preliminarily has to subscribe to such services. At the subscription, a profile of the user <b>110</b> is created on the authentication server <b>105,</b> and univocal identification code <i>User_ID</i> and an encryption key <i>K</i> are associated therewith; the identification code <i>User_ID</i> and the encryption key <i>K</i> are then also installed on the portable device <b>150</b> of the user <b>110</b>. The identification code <i>User_ID</i> can be configured by the user, or preferably by an administrator upon request by the user, directly on the authentication server <b>105.</b> The encryption key <i>K</i> can be provisioned to the user in different ways, and it is preferably protected through an encryption algorithm, so that for its use the user will have to enter an unblocking code known only to him/her. In particular, the encryption key <i>K</i> can be provisioned to the user <i>via</i> SMS (Short Message Service) message, sent to a cellular phone of the user and intercepted by a software installed on the cellular phone, or the encryption key <i>K</i> can be integrated in an installation package provided to the user at the subscription of the service. Another possibility consists in an optical capture of the encryption key <i>K</i>, in a way similar to that described before for the capturing of the "Challenge" <b>145</b> (in this case, the software installed on the portable device <b>150</b> of the user has personal but provisional encryption key, to be used only the first time for the installation of the encryption key <i>K</i> that will subsequently be used). A further possibility provides that the encryption key <i>K</i> is pre-installed on the portable device <b>150</b> of the user or on the SIM (Subscriber Identity Module) provisioned to the user by an operator of a mobile telephony network. Combinations of the preceding methods are also possible: for instance, the first installation of the encryption key <i>K</i> can take place through dispatch of an SMS message, and if, during the time, the encryption key <i>K</i> need to be replaced, this can be done via optical capture, or the encryption key <i>K</i>, initially installed through the installation package, can subsequently be replaced via optical capture. The user can also have more than one encryption key installed, the different encryption keys being used for different authentication services (for instance, two or more of the authentication services that will be described hereinafter).</p><p id="p0059" num="0059">The process of authentication of the user <b>110</b> starts with an explicit authentication request submitted by the user <b>110,</b> who, declaring his/her own identity to the authentication server <b>105</b>, for instance using his/her own personal identification code <i>User_ID,</i> triggers the authentication process. In an embodiment of the present invention, the authentication process evolves as described herebelow. The various phases that will be described are identified by respective reference numerals in the drawing.<!-- EPO <DP n="14"> --></p><p id="p0060" num="0060">Phase <b>205</b>. Using a suitable, hardware or software generator, schematically represented by the block <b>123</b> in <figref idrefs="f0001"><b>Figure 1</b></figref><b>,</b> the authentication server <b>105</b> generates a "Challenge" <i>CLG</i>; this latter can be for instance constituted by a random sequence of bits, for instance at least 128 bits long (however, the length of the sequence forming the "Challenge" <i>CLG</i> is not limitative for the purposes of the present invention). The generator <b>123</b> of the "Challenge" <i>CLG</i> can for instance use a generation algorithm of random sequences of bits complying to the directive NIST FIPS Pub 140-2.</p><p id="p0061" num="0061">Phase <b>210</b>. The authentication server <b>105</b> then proceeds to encrypting the "Challenge" CLG thus generated with an encryption algorithm, for instance a symmetric key algorithm, such as an algorithm complying to the standard AES (Advanced Encryption Standard), using the encryption key K associated with the user <b>110</b> identified by the personal identification code <i>User_ID</i> that the user <b>105</b> has provided to the authentication server with the authentication request. An encrypted random sequence of bits <i>ECLG</i> (Encrypted <i>CLG</i>) is thus obtained, for instance 128 bits long.</p><p id="p0062" num="0062">Phase <b>215.</b> The authentication server <b>105,</b> through a suitable algorithm, schematically represented by the block <b>125</b> in <figref idrefs="f0001"><b>Figure 1</b></figref><b>,</b> transforms the encrypted random sequence of bits <i>ECLG</i> into a textual string <i>AECLG</i> (for instance according to the ASCII code), of predetermined length (for instance of 10 characters). Preferably, an alphabet is used such as to guarantee that the textual string <i>AECLG</i> thus obtained is univocally representative of the encrypted random sequence of bits <i>ECLG</i>, it can be entered by the user using conventional data input devices (keyboard, mouse) of which a computer is normally equipped, and it does not contain ambiguities on the characters (for instance, the textual string <i>AECLG</i> preferably does not at the same time contain the characters "o","O","0" or "i","I","L"). The alphabet can have any cardinality, and can contain any alphanumeric character (for instance a.... z, A..... Z, 0.. 9, !"£$%&amp;éèàçà@ù).</p><p id="p0063" num="0063">Particularly, to transform a random sequence of mutually independent bits and uniformly distributed into a correspondent textual string, a decimation algorithm can be used. The obtained textual string is constituted by a succession of symbols, derived from the random sequence of bits, that also satisfy the requirement of independence and uniform distribution. Later on, an example of an algorithm will be described that, starting from such a random sequence of bit, is able to derive therefrom a textual string that is constituted of symbols belonging to a configurable alphabet (numerical or alphanumeric) and of configurable length.</p><p id="p0064" num="0064">Phase <b>220</b>. Preferably, the authentication server <b>105</b> sets a temporal term of validity of the textual string <i>AECLG</i>, defined as the maximum time within the authentication server <b>105</b> waits for<!-- EPO <DP n="15"> --> the user <b>110</b> to return his/her answer, that is the verification "Response" (for instance, the term of validity can be of some minutes, <i>e.g</i>. 2 minutes).</p><p id="p0065" num="0065">Phase <b>225.</b> The authentication server <b>105</b> stores the string <i>AECLG</i> and, where provided for, the temporal term of validity associated thereto in a local file (shown schematically in <figref idrefs="f0001"><b>Figure 1</b></figref> by the block <b>130</b>), waiting for them to be compared to the "Response" received by the user.</p><p id="p0066" num="0066">Phase <b>230.</b> The authentication server <b>105</b> then encodes the binary random sequence forming the "Challenge" <i>CLG</i> into characters, for instance using the Base64 format, obtaining an encoded string <i>B64CLG</i>. In alternative, to reduce the number of characters to be graphically encoded, it is possible to use a coding method that consists in converting the binary random sequence <i>CLG</i> into a sequence of Bytes, and then transforming the hexadecimal value of every Byte of the sequence into characters, according to the alphabet (0.. 9 to.. F). For instance, the sequence of bits "10101010" is encoded into "AA"; in this way, a binary sequence of 128 bits is encoded into a sequence of 32 characters.</p><p id="p0067" num="0067">Phase <b>235</b>. The authentication server <b>105</b> then uses the string <i>B64CLG</i> for the generation of a suitable graphics, that, through the data network <b>120</b>, is sent to the terminal <b>115</b> of the user <b>110.</b></p><p id="p0068" num="0068">Phase <b>240</b>. After having sent to the authentication server <b>105</b> the authentication request, the user <b>110</b> activates on his/her own portable device <b>150</b> a suitable application, previously installed on the portable device <b>150</b> (for instance in the phase of subscription to the services offered by the authentication server <b>105</b>) capable of optically capturing the graphic "Challenge" <b>145</b> received by the authentication server <b>105</b>; preferably, the application is protected by a start PIN (Personal Identification Number), that allows accessing the encryption key <i>K</i> of the user, maintained in encrypted way on the terminal.</p><p id="p0069" num="0069">Phase <b>245</b>. Through its graphic interface, the user terminal <b>115</b> displays on its screen to the user <b>110</b> an image containing the graphic "Challenge" <b>145</b> received; through the portable device <b>150</b>, the user <b>110</b> captures the displayed graphic "Challenge", for instance taking a photograph of the image of the screen <b>147</b> of the terminal <b>115</b> on which the graphic "Challenge" is displayed. In alternative to the display on the screen <b>147</b> of the terminal <b>145,</b> the printout of the image on a paper support can be foreseen.</p><p id="p0070" num="0070">Phase <b>250</b>. A suitable application (schematically represented by the block <b>165</b> in <figref idrefs="f0001"><b>Figure 1</b></figref>)<!-- EPO <DP n="16"> --> resident on the portable device <b>150</b> of the user <b>110</b> analyzes and extracts from the photographed image the string <i>B64CLG.</i></p><p id="p0071" num="0071">Phase <b>255</b>. The application <b>165</b> on the portable device <b>150</b> then converts the string <i>B64CLG</i> (encoded with B64 or other coding, for instance the hexadecimal coding previously described) into the binary sequence <i>CLG</i>.</p><p id="p0072" num="0072">Phase <b>260.</b> The processing algorithm <b>170</b> on the portable device <b>150</b> then encrypts the binary sequence <i>CLG</i> using the encryption key <i>K</i> of the user <i>110</i> (in alternative to the encryption key resident <i>K</i> on the portable device <i>150</i>, it is also possible to use as encryption key the PIN used to start the displaying application resident on the user terminal <b>115</b>), with an algorithm identical to that used by the authentication server <b>105</b>, obtaining an encrypted sequence <i>ECLG</i>, for instance 128 bits long.</p><p id="p0073" num="0073">Phase <b>265.</b> The encrypted sequence <i>ECLG</i> thus obtained is then transformed by the processing algorithm <b>170</b> on the portable device <b>150</b> into a textual string <i>AECLG</i>, using the same methodology and alphabet used by the authentication server <b>105</b> and described previously.</p><p id="p0074" num="0074">Phase <b>270</b>. The string <i>AECLG</i> thus obtained is displayed to the user <b>110</b> on a screen, or vocally announced through a loudspeaker of the portable device <b>150</b>.</p><p id="p0075" num="0075">Phase <b>275.</b> The user <b>110</b>, using the terminal <b>115</b>, for instance through the keyboard, enters the string <i>AECLG</i> communicated thereto by the portable device <b>150</b>, and the entered string <i>AECLG</i> is communicated through the data network <b>120</b> to the authentication server <b>105</b> together with the personal identification code <i>User-ID</i> of the user. In alternative to the use of the keyboard, the user <b>110</b> can use the mouse of his/her terminal <b>115,</b> or it is possible to exploit a direct communication among the portable device <b>150</b> and the user terminal <b>115</b>, for instance exploiting BlueTooth or NFC (Near Field Communication) technology.</p><p id="p0076" num="0076">Phase <b>280</b>. The authentication server <b>105,</b> after receiving from the user terminal <b>115</b> the string <i>AECLG</i>, forming the "Response" <b>180,</b> and using as a reference the personal identification code <i>User-ID</i> of the user <b>110</b>, through the algorithm <b>185</b> ascertains:
<ul><li>whether the user identified by the personal identification code <i>User-ID</i> had previously requested to be authenticated;</li><li>the temporal validity of the answer from the user <b>110,</b> in other words whether the answer arrived within the time interval set by the authentication server <b>105</b> upon generating the<!-- EPO <DP n="17"> --> "Challenge"; and</li><li>the correctness of the string <i>AECLG</i> received from the user <b>110</b>, by comparison with the value previously stored in association with that personal identification code <i>User-ID.</i></li></ul></p><p id="p0077" num="0077">Phase <b>285</b>. If the result of the above checks is positive, the authentication server <b>105</b> can for instance:
<ul><li>remove the value <i>AECLG</i> stored in the memory support <b>130</b>, to prevent any subsequent attempt of reusing the same "Challenge"; and</li><li>send or redirect the user <b>110</b> to a "welcome page", to evidence the occurred authentication of the user <b>110.</b></li></ul></p><p id="p0078" num="0078">In case one or more of the above checks did not have positive result, the authentication server <b>105</b> can for instance:
<ul><li>remove the value <i>AECLG</i> stored in the memory support <b>130,</b> to prevent any subsequent attempt of reusing the same "Challenge"; and</li><li>send or redirect the user to an "error page" that invites him/her to repeat the authentication process from the beginning.</li></ul></p><p id="p0079" num="0079">At each authentication attempt failed, the authentication server can increase a failures counter; at the third consecutive failure, the user <b>110</b> can be disabled by the authentication server <b>105</b>; once disabled, the user <b>110</b> cannot start the authentication process anymore (without being preliminarily re-enabled by the authentication server).</p><p id="p0080" num="0080">Phase <b>290</b>. The application resident on the portable device <b>150</b> can automatically terminate, after the lapse of a predetermined time interval, for instance one minute, from having communicated to the user the value to be returned to the authentication server <b>105</b>. The user <b>110</b> may also immediately terminate such application manually, possibly after having been redirected to the "welcome page."</p><p id="p0081" num="0081">Herebelow an example is described of an algorithm that, starting from a sequence of bits, particularly a random sequence, is able to derive therefrom a textual string that is constituted by symbols belonging to a configurable alphabet (numerical or alphanumeric) and of configurable length.<!-- EPO <DP n="18"> --></p><p id="p0082" num="0082">Let <i>L</i> be the length of the textual string that should be obtained, let S = {s0,.., sM} be the alphabet of the symbols that will form the string, and let M = || S || be the cardinality of the alphabet <i>S</i>.</p><p id="p0083" num="0083">From the random sequence of bits generated by the (hardware or software) generator <b>123</b>, T blocks I<sub>0</sub>, I<sub>1</sub>,..., I<sub>T</sub> are selected, each one made up of <i>B</i> bits. The parameter <i>B</i> can be selected according to the following rule: <maths id="math0001" num=""><math display="block"><mi>B</mi><mo>=</mo><mrow><mo>{</mo></mrow><mtable columnalign="left"><mtr><mtd><msub><mi>log</mi><mn>2</mn></msub><mo>⁢</mo><mi>M</mi></mtd><mtd><mi>if</mi><mspace width="1em"/><mi>M</mi><mspace width="1em"/><mi>is a power of</mi><mspace width="1em"/><mn>2</mn></mtd></mtr><mtr><mtd><mfenced open="[" close="]" separators=""><msub><mi>log</mi><mn>2</mn></msub><mo>⁢</mo><mi>M</mi></mfenced><mo>+</mo><mn>1</mn></mtd><mtd><mi>otherwise</mi></mtd></mtr></mtable></math><img id="ib0001" file="imgb0001.tif" wi="69" he="22" img-content="math" img-format="tif"/></maths></p><p id="p0084" num="0084">From each one of the <i>T</i> blocks of bits I<sub>0</sub>, I<sub>1</sub>,..., I<sub>T</sub> the associated decimal digit I<sub>0</sub>, I<sub>1</sub>,..., is obtained, which is used as an index to select the symbol from the alphabet S; for the generic, <i>M</i>-th block of bits, the associated decimal digit is I<sub>M</sub>. starting from this index, the related symbol s<sub>Im</sub> is obtained, applying following rule: <maths id="math0002" num=""><math display="block"><msub><mi>s</mi><msub><mi>I</mi><mi>m</mi></msub></msub><mo>=</mo><mrow><mo>{</mo></mrow><mtable columnalign="left"><mtr><mtd><mi>S</mi><mfenced open="[" close="]"><msub><mi mathvariant="normal">I</mi><mi mathvariant="normal">m</mi></msub></mfenced></mtd><mtd><mi>if</mi><mspace width="1em"/><msub><mi>I</mi><mi>m</mi></msub><mo>&lt;</mo><mi>M</mi></mtd></mtr><mtr><mtd><mi>otherwise</mi></mtd><mtd><mi>next block</mi></mtd></mtr></mtable></math><img id="ib0002" file="imgb0002.tif" wi="50" he="15" img-content="math" img-format="tif"/></maths></p><p id="p0085" num="0085">This algorithm has a rate of loss of bits <i>P</i> equal to <i>P</i> = (2<i><sup>B</sup></i> - <i>M</i>). In case the alphabet of symbols has a cardinality equal to a power of two, that is <i>M</i> ≡ 2<i><sup>B</sup></i>, there is no loss of bits, otherwise there will be a number <i>P</i> of unused bits. To reduce the number <i>P</i> of unused bits, the blocks of bits can be selected so as to obtain blocks of symbols or overlapping blocks.</p><p id="p0086" num="0086">The algorithm performs a decimation scanning the bits of every block of bits <i>T</i> into which the sequence of bits to be transformed into a textual string is partitioned first from the left to the right, and subsequently from the right to the left; in this way, the length in bits of each block <i>T</i> is virtually increased, and the rate of loss <i>P</i> is reduced. In case at the end of the scanning from the left to the right and from the right to left the algorithm did not converge, <i>i.e.</i> it was not possible to find a sequence of symbols of the desired length <i>L</i>, activities can be performed directed to find the remaining bits, restarting to read the bits of the generic block T from the to the right using one or both the strategies described hereinafter.</p><heading id="h0007">a) Calculation of the modulus</heading><p id="p0087" num="0087">The <i>B</i> bits read from the generic block <i>T</i> are "mapped" with respect to the selected<!-- EPO <DP n="19"> --> alphabet using the rule of the modulus: <maths id="math0003" num=""><math display="block"><msub><mi>s</mi><msub><mi>I</mi><mi>m</mi></msub></msub><mo>=</mo><mi>S</mi><mfenced open="[" close="]" separators=""><msub><mi>mod</mi><mi>M</mi></msub><mfenced><msub><mi>I</mi><mi>M</mi></msub></mfenced></mfenced></math><img id="ib0003" file="imgb0003.tif" wi="34" he="8" img-content="math" img-format="tif"/></maths></p><heading id="h0008">b) Reduction of the value of <i>B</i></heading><p id="p0088" num="0088">The number of bits read from the generic block <i>T</i> is reduced by one, so as to increase the probability to get a numerical value capable of indexing a symbol of the used alphabet. The calculation of <i>B</i> can be the following: <maths id="math0004" num=""><math display="block"><mi>K</mi><mo>=</mo><mrow><mo>{</mo></mrow><mtable columnalign="left"><mtr><mtd><mfenced separators=""><msub><mi>log</mi><mn>2</mn></msub><mo>⁢</mo><mi>M</mi></mfenced><mo>-</mo><mn>1</mn></mtd><mtd><mi>if</mi><mspace width="1em"/><mi>M</mi><mspace width="1em"/><mi>is a power of</mi><mspace width="1em"/><mn>2</mn></mtd></mtr><mtr><mtd><mfenced open="[" close="]" separators=""><msub><mi>log</mi><mn>2</mn></msub><mo>⁢</mo><mi>M</mi></mfenced></mtd><mtd><mi>otherwise</mi></mtd></mtr></mtable></math><img id="ib0004" file="imgb0004.tif" wi="69" he="24" img-content="math" img-format="tif"/></maths></p><p id="p0089" num="0089">Another possible algorithm that can be used for transforming the random sequence of bit constituting the "Challenge" <i>CLG</i> into a textual string provides, the characteristics and the modalities of calculation of the quantities <i>L</i>, <i>S</i>, <i>M</i> and <i>B</i> described above, to obtain a sequence of characters of default length <i>L</i> performing only one scan of the blocks of bit, from the left to the right.</p><p id="p0090" num="0090">The following variables are defined:
<ul><li><i>Q</i> = number of bits constituting the initial random sequence of bits (<i>i.e.</i> the "Challenge" <i>CLG</i>);</li><li><i>W</i> = maximum number of possible attempts of mapping of the random sequence of bits into the textual string, that is <i>W</i> = <i>Q</i>/<i>B</i>;</li><li><i>Y</i> = number of performed mapping attempts; and</li><li><i>Z</i> = number of symbols of the textual string of length <i>L</i> remaining to be mapped.</li></ul></p><p id="p0091" num="0091">Using the index I<sub>m</sub> calculated as previously described, the corresponding symbol s<sub>Im</sub> is obtained according to the following rule: <maths id="math0005" num=""><math display="block"><msub><mi>s</mi><msub><mi>I</mi><mi>m</mi></msub></msub><mo>=</mo><mrow><mo>{</mo></mrow><mtable columnalign="left"><mtr><mtd><mi>S</mi><mfenced open="[" close="]"><msub><mi mathvariant="normal">I</mi><mi mathvariant="normal">m</mi></msub></mfenced></mtd><mtd><mi>if</mi><mspace width="1em"/><msub><mi>I</mi><mi>m</mi></msub><mo>&lt;</mo><mi>M</mi></mtd></mtr><mtr><mtd><mi>Next K Bits</mi></mtd><mtd><mi>if Z</mi><mo>&gt;</mo><mfenced separators=""><mi>W</mi><mo>-</mo><mi>Y</mi></mfenced><mn>.</mn></mtd></mtr><mtr><mtd><mi>S</mi><mfenced open="[" close="]" separators=""><msub><mi>mod</mi><mi>M</mi></msub><mfenced><msub><mi>I</mi><mi>m</mi></msub></mfenced></mfenced></mtd><mtd><mi>if Z</mi><mo>≡</mo><mfenced separators=""><mi>W</mi><mo>-</mo><mi>Y</mi></mfenced></mtd></mtr></mtable></math><img id="ib0005" file="imgb0005.tif" wi="75" he="20" img-content="math" img-format="tif"/></maths></p><p id="p0092" num="0092">Concerning the encryption algorithm used by the authentication server <b>105</b> and the portable device <b>150</b> of the user <b>110</b>, it can possibly be replaced by a data authentication algorithm<!-- EPO <DP n="20"> --> of the HMAC (Hashed Message Authentication Code) type, with SHA-1 (Secure Hash Algorithm 1) hash mechanism type, that also generates as a result a string being a function of the encryption key <i>K</i> of the user <b>110</b>.</p><p id="p0093" num="0093">As known to those skilled in the art, HMAC is a non-reversible algorithm for the authentication of messages based on a hash function. By means of HMAC it is possible to guarantee both the integrity and the authenticity of a message. The algorithm HMAC uses a combination of the original message and of a secret key for the generation of the code. A peculiarity of the HMAC algorithm is that it is not linked to a particular hash function, and this with the purpose of allowing the replacement of the used hash function in case it is discovered to be weak. In the following table, some examples of calculation that exploit HMAC type SHA1 are reported.
<tables id="tabl0001" num="0001"><table frame="top"><tgroup cols="4" colsep="0"><colspec colnum="1" colname="col1" colwidth="14mm"/><colspec colnum="2" colname="col2" colwidth="21mm"/><colspec colnum="3" colname="col3" colwidth="15mm"/><colspec colnum="4" colname="col4" colwidth="81mm"/><thead><row><entry valign="top">Row</entry><entry valign="top">Data</entry><entry valign="top">Key</entry><entry valign="top">Result of the calculation of HMAC with HASH type SHA1</entry></row></thead><tbody><row><entry>1</entry><entry>1</entry><entry>1</entry><entry><b><u>5b0c157d4e7672444c41033561554839ed1fd2d6</u></b></entry></row><row><entry>2</entry><entry>1</entry><entry>marco</entry><entry><b><u>a9774f9c88cc84c691ca7aaf5cf42d4f58e20ad3</u></b></entry></row><row><entry>3</entry><entry>123456789</entry><entry>mirco</entry><entry><b><u>404b5c7716cfe6adda7c9be1a4e0611349b99fb3</u></b></entry></row><row><entry>4</entry><entry>123456</entry><entry>mirco</entry><entry><b><u>caca41a07de234932f29f92e0876672f39ebdce4</u></b></entry></row><row><entry>5</entry><entry>123456</entry><entry>marco</entry><entry><b><u>73c90c08d7e5996a331fe89e3bd3d011068a9d28</u></b></entry></row><row><entry>6</entry><entry>789012</entry><entry>marco</entry><entry><b><u>5e52768fde27503da90915a2f9d8beab1a888da0</u></b></entry></row><row><entry>7</entry><entry>789012</entry><entry>mirco</entry><entry><b><u>510e7397ee2711be94f0ecc69a6675ab11d813d6</u></b></entry></row><row><entry>8</entry><entry>Mirco</entry><entry>789012</entry><entry><b><u>9e81045405f127544ad4fb38da573f96f56c6426</u></b></entry></row></tbody></tgroup></table></tables></p><p id="p0094" num="0094">It can be appreciated that, in the considered example, the result is always a string of length equal to 40 characters, independently of the data size and of the key (rows from 1 to 8); it is also possible to note that the function always returns a different value for the same data to transfer, as the key changes (rows from 4 to 7).</p><p id="p0095" num="0095">In a practical implementation of the present invention, the user is preferably not asked to enter on the keyboard of his/her own terminal <b>115</b> all the 40 characters generated by the hash function, but rather a lower number of characters such that it is possible to assess the correctness of the generated hash. It has been demonstrated (see the document RFC4635) that the function MAC type SHA1 already contains characteristics of uniqueness of the information in the first 96 bits, or rather the first 12 bytes, and thus in the first 12 characters coded in ASCII UNICODE Standard. Such mechanism is for instance used in "IPSEC Encapsulating Security Payload" and described in the document RFC 2404. IPSEC (IP SECurity) is a standard applied for achieving secure connections on networks with IP (Internet Protocol) communication protocol, and the protocol "Encapsulating Security Payload" (known with the acronym ESP) belongs to the suite of<!-- EPO <DP n="21"> --> protocols IPSEC and has the objective of providing confidentiality and control of integrity and authenticity to the IPSEC communication using the described hash mechanism.</p><p id="p0096" num="0096">In a practical implementation of the present invention, in view of the fact that the "Challenge" <i>CLG</i> is a random sequence of bits, that, due to the random character, it is practically impossible to generate more than once a same sequence, that a generic random sequence of bits is preferably valid only for limited time, and of the fact that an algorithm of secure MAC like the SHA1 is used, it is possible to further reduce, for instance from 12 to 8, the number of characters that the user has to enter (these characters are highlighted in the preceding table as underlined) without substantially altering the security level of the general methodology.</p><p id="p0097" num="0097">It can be appreciated that the translation performed to generate the string <i>AECLG</i> is made on the encrypted "Challenge" <i>ECLG</i>, <i>i.e.</i> on the value resulting from the encryption operation of the binary "Challenge" <i>CLG</i>.</p><p id="p0098" num="0098">In the symmetrical implementation mode tof he method according to the embodiment of the present invention here described, the graphic "Challenge" <b>145</b> generated and sent by the authentication server <b>105</b>, displayed by the user terminal <b>115</b> and captured by the portable device <b>150</b>, can be defined as "in clear", since the coding performed for obtaining the string <i>B64CLG</i> is done on the original binary sequence <i>CLG</i>.</p><p id="p0099" num="0099">For the coding/decoding of the graphic "Challenge" several technologies of representation in two dimensions (2D) can be used, for instance barcodes, particularly, although not limitatively, the technologies DataMatrix, PDF417, QR-tails, Aztec Code, MaxiCode, already commercially available at low cost.</p><heading id="h0009">- Asymmetrical mode</heading><p id="p0100" num="0100">In <figref idrefs="f0003"><b>Figure 3</b></figref> there is schematically shown, in terms of the main operations performed by the different players and of the information exchanged among them, the asymmetrical mode of implementation of the authentication method. The asymmetrical mode differs from the symmetrical mode only in some phases of the authentication process (the same considerations made in the description of the symmetrical mode concerning the lengths of the sequences of bits, of the strings, their generation, the usable alphabet for the textual strings and so on apply).</p><p id="p0101" num="0101">As in the symmetrical mode, the process of authentication of the user <b>110</b> starts with an<!-- EPO <DP n="22"> --> explicit authentication request submitted by the user <b>110</b> who, declaring his/her own identity to the authentication server <b>105,</b> for instance using his/her own personal identification code <i>User_ID,</i> triggers the authentication process. Such process evolves as described herebelow.</p><p id="p0102" num="0102">Phase <b>305</b>. As in the symmetrical mode, using a suitable generator, hardware or software, the authentication server <b>105</b> generates the "Challenge" <i>CLG</i>.</p><p id="p0103" num="0103">Phase <b>310</b>. As in the symmetrical mode, the authentication server <b>105</b> then encrypts the sequence of bits making up the "Challenge" <i>CLG</i> thus generated with an encryption algorithm, for instance a symmetrical key algorithm, like the AES, using the encryption key <i>K</i> associated with the user <b>110</b> identified by the personal identification code <i>User_ID</i> that the user has provided to the authentication server with the authentication request. An encrypted sequence <i>ECLG</i> is thus obtained.</p><p id="p0104" num="0104">Phase <b>315</b>. The authentication server <b>105</b> transforms the binary sequence <i>CLG</i> forming the "Challenge" into a textual string <i>ACLG</i> of pre-determined length (for instance 10 characters), preferably using an alphabet with characteristics similar to those described in connection with the symmetrical mode (thus, differently from the symmetrical mode, it is the random sequence CLG "in clear", not the encrypted sequence <i>ECLG</i>, that is transformed into the textual string <i>ACLG</i>).</p><p id="p0105" num="0105">Phase <b>320</b>. Preferably, the authentication server <b>105</b> establishes a temporal term of validity of the textual string <i>ACLG</i>, defined as the maximum time within which the authentication server waits for the user <b>110</b> to return its answer thereto, that is the verification "Response" (also in this case, the term of validity can be for instance of some minutes, for instance 2 minutes).</p><p id="p0106" num="0106">Phase <b>325</b>. The textual "Challenge" <i>ACLG</i> and the associated temporal term of validity are stored.in a file (<b>130</b> in <figref idrefs="f0001"><b>Figure 1</b></figref>) of the authentication server <b>105</b>, waiting to be verified.</p><p id="p0107" num="0107">Phase <b>330</b>. The encrypted binary sequence <i>ECLG</i> is encoded into characters, for instance in the Base64 format or other coding, as described in connection with the symmetrical mode, obtaining a string <i>B64ECLG.</i></p><p id="p0108" num="0108">Phase <b>335</b>. Similarly to the symmetrical mode (but using the textual string derived from the encrypted sequence <i>ECLG</i>, instead of the sequence "in clear" <i>CLG</i>), the string <i>B64ECLG</i> is used by the authentication server <b>105</b> for the generation of a suitable graphic "Challenge" <b>145</b>, that is sent through the data network <b>120</b> to the terminal <b>115</b> of the user <b>110</b>.</p><p id="p0109" num="0109">Phase <b>340</b>. As in the symmetrical mode, the user <b>110</b> starts on his/her own portable device<!-- EPO <DP n="23"> --> <b>150</b> a suitable application.</p><p id="p0110" num="0110">Phase <b>345.</b> As in the symmetrical mode, through its graphic interface, the user terminal <b>115</b> displays on its screen to the user <b>110</b> an image containing the received graphic "Challenge" <b>145;</b> through the portable device <b>150</b> the user <b>110</b> captures the image containing the graphic "Challenge", for instance he/she takes a photograph of the displayed image containing the graphic "Challenge". In alternative to the display on the screen of the terminal <b>115,</b> a printout of the image on a paper support can be provided for.</p><p id="p0111" num="0111">Phase <b>350.</b> The application <b>165</b> resident on the portable device <b>150</b> analyzes and extracts from the photographed image the string <i>B64ECLG.</i></p><p id="p0112" num="0112">Phase <b>355.</b> The application <b>165</b> on the portable device <b>150</b> converts the string <i>B64ECLG</i> into the binary encrypted sequence <i>ECLG.</i></p><p id="p0113" num="0113">Phase <b>360.</b> The processing algorithm <b>170</b> on the portable device <b>150</b> decrypts the encrypted binary sequence <i>ECLG</i> using the encryption key <i>K</i> of the user (in alternative to the key <i>K</i> resident on the terminal it is also possible to use as encryption key the PIN used for starting the application on the terminal <b>115),</b> with an algorithm identical to that used by the authentication server <b>105,</b> obtaining a binary sequence <i>CLG.</i></p><p id="p0114" num="0114">Phase <b>365.</b> The portable device <b>150</b> transforms the binary sequence <i>CLG</i> into a textual string ACLG, using the same methodology and alphabet used by the authentication server <b>105.</b></p><p id="p0115" num="0115">Phase 370. Similarly to the symmetrical mode, the string <i>AECLG</i> thus obtained is displayed or vocally announced by the portable device <b>150</b> to the user <b>110.</b></p><p id="p0116" num="0116">Phase <b>375.</b> Similarly to the symmetrical mode, the user <b>110</b> communicates <b>105</b> to the authentication server his/her personal identification code <i>User-ID</i> and the value of the textual string <i>ACLG.</i></p><p id="p0117" num="0117">Phase <b>380.</b> Similarly to the symmetrical mode, the authentication server <b>105,</b> after receiving from the user terminal <b>115</b> the string <i>ACLG</i> and using as a reference the personal identification code <i>User-ID</i> of the user <b>110</b> assesses:
<ul><li>whether the user identified by the personal identification code <i>User-ID</i> had previously requested to be authenticated;</li><li>the temporal validity of the answer from the user <b>110,</b> in other words whether the answer<!-- EPO <DP n="24"> --> arrived within the set time interval;</li><li>the correctness of the string <i>ACLG</i> received from the user <b>110,</b> by comparison with the value previously stored in association with that personal identification code <i>User-ID.</i></li></ul></p><p id="p0118" num="0118">Phase <b>385.</b> Similarly to the symmetrical mode, if the result of the above checks is positive, the authentication server <b>105</b> can for instance:
<ul><li>remove the value <i>ACLG</i> stored in the support <b>130,</b> to prevent any subsequent attempt of reusing the same "Challenge";</li><li>send or redirect the user <b>110</b> to a "welcome page", to evidence the occurred authentication of the user <b>110.</b></li></ul></p><p id="p0119" num="0119">In case one or more of the checks fails, the authentication server <b>105</b> can for instance:
<ul><li>remove the value <i>ACLG</i> stored in the support <b>130,</b> to prevent any subsequent attempt of reusing the same "Challenge";</li><li>send or redirect the user to an "error page" that invites him/her to repeat the authentication process from the beginning.</li></ul></p><p id="p0120" num="0120">At every attempt of authentication failed, the authentication server can increase a failures counter; at the third consecutive failure, the user <b>110</b> can be disabled by the authentication server <b>105;</b> once disabled, the user <b>110</b> cannot start the authentication process anymore without preliminarily having been re-enabled.</p><p id="p0121" num="0121">Phase <b>390.</b> The application resident on the portable device <b>150</b> can automatically terminate, lapsed a pre-determined time, for instance one minute, from having communicated to the user the value to be returned to the authentication server <b>105.</b> The user <b>110</b> can also immediately terminate the application manually, possibly after having been redirected to the "welcome page."</p><p id="p0122" num="0122">It is pointed out that the encryption algorithm used by the authentication server <b>105</b> can be arbitrary, provided that it is congruent with that available on the portable device <b>150</b> of the user.</p><p id="p0123" num="0123">It is possible to appreciate that, differently from the symmetrical mode, in the asymmetrical mode the translation performed with the purpose of generating the verification element <i>ACLG</i> is directly performed on the value of the binary "Challenge" <i>CLG</i> obtained by decrypting the encrypted sequence <i>ECLG.</i> The graphic "Challenge" <b>145</b> generated or interpreted can be defined as sent "not<!-- EPO <DP n="25"> --> in clear" or encrypted, since the encoding performed for obtaining the string <i>B64ECLG</i> is done on the encrypted binary sequence <i>ECLG.</i></p><p id="p0124" num="0124">As in the case of the symmetrical mode, for the graphic coding/decoding different technologies of representation of barcode can be used which are already commercially available at low cost.</p><p id="p0125" num="0125">The authentication method according to the embodiments of the present invention has several advantages.</p><p id="p0126" num="0126">An advantage of the authentication method according to the present invention is that, for the acquisition of the authentication information sent by the authentication server, no physical contact is necessary with the user terminal <b>115</b> (there are no cables, radio connections or data exchange interfaces) for the acquisition of the authentication information sent by the authentication server: the acquisition is of the optical type, and there is no risk of compromising from the security viewpoint.</p><p id="p0127" num="0127">Another advantage is that on the data network <b>120</b> never transits enough information to be able to reconstruct, starting from the data possibly intercepted, the information content adapted to allow a "reverse engineering" or a "dictionary attack" with the purpose of calculating or finding the encryption key K of the user.</p><p id="p0128" num="0128">Still another advantage is that the purchase of ad-hoc devices is not required, but rather the simple use of a device, for instance portable, equipped with an image-capturing device, for instance a camera, like a cellular phone, a PDA, etc.; such devices are today already diffused on the market and at the reach of almost all the users.</p><p id="p0129" num="0129">A further advantage is that although devices can be used like cellular phones and smartphones, the coverage by a mobile telephony network is not required: it is enough to exploit the image capturing functionalities offered by such devices.</p><p id="p0130" num="0130">The coding of the "Challenge" can be encrypted for protecting the information against tampering during the transport on the network, or not encrypted, but protected by coding with a non-reversible HMAC algorithm.</p><p id="p0131" num="0131">The graphic coding of the "Challenge", in general, cannot be tampered without the complete invalidation of the transported content; this represents an intrinsic security element.<!-- EPO <DP n="26"> --></p><p id="p0132" num="0132">Moreover, as already mentioned, for the graphic coding various technologies of representation already available on the market at low cost can be used.</p><p id="p0133" num="0133">The encryption keys and the cryptography and/or MAC algorithms can be freely chosen. Such keys can be managed both by a mobile telephony operator in cooperation with the provider of the service, or directly by the latter. In other words, a generic provider of on-line services can, for the authentication of its subscribers, both rely on a specific authentication service made available by a provider of authentication services, and use a completely autonomous solution in which the authentication server is directly managed by the provider of on-line services.</p><p id="p0134" num="0134">As described previously, the keys of the encryption and/or MAC algorithms can be for instance distributed, at the subscription of the authentication service of, in optical mode, photographing, always with the portable device <b>150,</b> a suitable graphics that does not contain a "Challenge" but the encryption key of the user, or Over-The-Air (OTA), via applicative SMS messages, and they can reside on a smartcard associatable to the portable device <b>150,</b> for instance on the SIM (Subscriber Identification Module) card of the cellular phone.</p><p id="p0135" num="0135">The graphic "Challenge" <b>145</b> sent to the user can contain, in addition to the information necessary for the authentication, also other types of information, like for instance the summary of a transaction, a password or a verification code or advertisement messages.</p><p id="p0136" num="0136">The image processing software for the extraction of the "Challenge" from the captured image can be designed for different types of cellular phone and palmtops equipped with camera (for instance based on Symbian, WindowsMobile, Java Device platforms).</p><p id="p0137" num="0137">In the following of the description some examples of application of the authentication method, according, to the present invention will be presented.</p><p id="p0138" num="0138">In <figref idrefs="f0004"><b>Figure 4</b></figref> there is schematically shown, in terms of the main operations performed by the different players and of the information exchanged among them, a possible application of the authentication method according to an embodiment of the present invention, for the access to a Web application.</p><p id="p0139" num="0139">Particularly, the practical, application that will now be discussed uses the asymmetrical mode described previously with reference to <figref idrefs="f0003"><b>Figure 3</b></figref><b>.</b> The various phases of the authentication process are therefore those described in connection with the asymmetrical mode, to which reference is made, and will not be described again. However, nothing prevents from adopting the<!-- EPO <DP n="27"> --> symmetrical mode.</p><p id="p0140" num="0140">The user <i>Bob</i> has a PIN, that never transits on the data network <b>120,</b> and that can have the function both of symmetrical key for the encryption and decryption of the "Challenge" received by the authentication server <b>105,</b> and of making accessible the user's encryption key <i>K</i> during the activation of the application on the portable device <b>150,</b> for instance the cellular phone of the user Bob.</p><p id="p0141" num="0141">The user <i>Bob</i> can insert his/her PIN on the portable device <b>150</b> while he/she is in a secure location, before activating the authentication process.</p><p id="p0142" num="0142">The PIN can be provided to the user <i>Bob</i> at the subscription of the authentication service, both on a paper or electronic support, or by a third party, for instance by the mobile telephony operator of which the user <i>Bob</i> is a subscriber.</p><p id="p0143" num="0143">At the successful completion the authentication process, the user <i>Bob</i> can access the desired Web service.</p><p id="p0144" num="0144">The authentication method can be used for accessing more services, like for instance Internet banking services, access to an intranet, trading services, each of which uses a specific PIN, without the necessity of any change at the authentication server side or at the software on the cellular phone of the user <i>Bob.</i></p><p id="p0145" num="0145">In <figref idrefs="f0005"><b>Figure 5</b></figref> there is schematically shown, in terms of the main operations performed by the different players and of the information exchanged among them, a possible application of the authentication method according to an embodiment of the present invention for an "on-line" service that allows the user to impart dispositions involving the disbursement of sums of money, like for instance a bank draft, or a purchase of good or services. Particularly, in this practical application the method according to the invention is exploited for providing a countermeasure against attacks of the type "Man In The Middle" during a disposition operation.</p><p id="p0146" num="0146">The practical application considered in <figref idrefs="f0005"><b>Figure 5</b></figref> uses the asymmetrical mode described in precedence. The various phases of the authentication process are therefore those described in connection with the asymmetrical mode, to which reference is made, and they will not be described again. However, nothing prevents from adopting the symmetrical mode.</p><p id="p0147" num="0147">In phase <b>305,</b> the authentication server <b>105,</b> for instance of the bank of the user Bob, generates a summary <i>SUM</i> of the transaction (<i>e.g.</i> involving a bank draft), and such summary <i>SUM</i><!-- EPO <DP n="28"> --> contains the "Challenge" <i>CLG</i> (random sequence of bits) to be used for the authentication/verify of the authenticity of the imparted disposition. The summary of the transaction <i>SUM</i> is encrypted by the authentication server <b>105</b> using the encryption key <i>K</i> of <i>Bob,</i> the encrypted summary <i>ESUM</i> is encoded transforming it into a textual string <i>B64ESUM</i> and the string <i>B64ESUM</i> is transformed into graphic form (bidimensional barcode) and sent to the terminal (for instance a Personal Computer) of <i>Bob.</i> In the phase <b>365,</b> the application on the cellular phone <b>150</b> of Bob extracts the "Challenge" <i>CLG</i> from the summary, and in the phase <b>370,</b> through the cellular phone, the summary <i>SUM</i> of the transaction and the "Challenge" <i>CLG</i> are presented to <i>Bob.</i></p><p id="p0148" num="0148">An attacker capable of interposing between the user <i>Bob</i> and the authentication server <b>105</b> of the bank of the user <i>Bob</i> could be able to alter the information that the user <i>Bob</i> sends to the authentication server <b>105;</b> nevertheless, thanks to the fact that the information contained in the "Challenge" are sent to the user Bob together with the summary of the transaction, it is possible to guarantee an increased security level.</p><p id="p0149" num="0149">The attacker, even if able to alter the information sent by the user, is nevertheless not in condition of altering the synthetic information of the transaction contained in the graphic "Challenge" sent by the authentication server to the user, because this is encrypted.</p><p id="p0150" num="0150">The user can immediately realize if the information received by the authentication server <b>105</b> differs from that he/she has entered (for instance, in the case of a bank draft, a different beneficiary, and/or a different amount of money), and therefore he/she can deny the transaction confirmation, sending a wrong or agreed verification code, for instance the digits "0000000."</p><p id="p0151" num="0151">In order to confirm the transaction, the user has to re-send to the authentication server <b>105</b> the "Response" generated starting from the received "Challenge"; in this way, the confirmation of the transaction is protected by a univocal verification code. This strategy allows avoiding the re-use thereof by an attacker who can monitor a certain number of transactions that the user successfully concluded sending the correct verification code.</p><p id="p0152" num="0152">It is also possible that, before being able to proceed to sending to the authentication server a disposition, the user has to authenticate him/hem at the server of his/her bank, using one of the methodologies described in the foregoing.</p><p id="p0153" num="0153">In <figref idrefs="f0006"><b>Figure 6</b></figref> there is schematically shown, in terms of the main operations performed by the various players and of the information exchanged among them, a possible application of the<!-- EPO <DP n="29"> --> authentication method according to an embodiment of the present invention in the context of the distribution of multimedia contents, particularly digital television through air or cable, for instance on telephone network (IPTV).</p><p id="p0154" num="0154">This application of the authentication method according to the invention is directed to provide a solution capable of increasing the security level in connection with the access and/or the transactions performed using new services (electronic mail, box-office, surveys, electronic poll, video on-demand, etc.) offered by DTT and IPTV platforms. Such platforms are constituted by a user interface, normally represented by a television set, an apparatus installed at home of the user called "Set Top Box" (STB) or decoder by which it is possible to receive the digital signal (over the air in the DTT case, over a data line in the case Cable TV or by broadband connection for IPTV) to which a telephone line called "return channel" is connected that, through traditional (V.90) or ISDN modem or through broadband (ADSL) modem, allows the interaction of the user with a service center.</p><p id="p0155" num="0155">In this application, the symmetrical mode previously described is exploited, to which reference is made for the detailed description of the various phases, and it is assumed to use as verification algorithm the HMAC instead of the encryption. However, nothing prevents from using the asymmetrical mode.</p><p id="p0156" num="0156">The characteristics and the security level of the proposed solution are analogous to those of the application related to the access to a Web application, because on the STB of the user the standard MHP (Multimedia Home Platform) allows the implementation of interactive applications with graphic content as allowed by the HTML and JAVA for the World Wide Web.</p><p id="p0157" num="0157">In <figref idrefs="f0007"><b>Figure 7</b></figref> there is schematically shown, in terms of the main operations performed by the various players and of the information exchanged among them, a possible application of the authentication method according to an embodiment of the present invention to Automatic Teller Machines (ATMs). Particularly, the example of <figref idrefs="f0007"><b>Figure 7</b></figref> relates to the asymmetrical mode previously described.</p><p id="p0158" num="0158">ATMs are normally installed both near financial institutes (bank offices, for instance), and in malls, and they allow collecting cash or perform other low-level operations like inspecting the balance or the bank statement of account. The ATMs represent, for the financial institutes, a tool that substantially affects the "customer experience" of their customers. However, bank cards to be used in ATMs are often lost or fraudulently subtracted, and this constitutes a problem under the<!-- EPO <DP n="30"> --> profile of the security of the system, that contributes to significantly increase the risks of fraud.</p><p id="p0159" num="0159">The problems related to the use of bank cards in ATM terminals are several.</p><p id="p0160" num="0160">The PIN that is requested to the user after having introduced the bank card into the ATM or POS (Point Of Sale) terminal, even if short, has to be remembered and kept secret by the user, who however often, to facilitate his/her duty, writes it down on paper, or hides it within a telephone number in an address book, and in some cases the user communicates the PIN to third parties (this is for instance the case of elder persons who communicate the PIN to relatives, assistants or the like, whom they think to be trusted persons).</p><p id="p0161" num="0161">The PIN must manually be introduced by the user on the POS or ATM terminal, and can thus be seen by indiscreet eyes or by means of microcameras.</p><p id="p0162" num="0162">The bank card stores the PIN internally, and the PIN, even if encrypted, could be subject to "brute force" attacks, for instance through a program that forces the opening of a compressed (ZIP) file using all the possible combinations for the password, until the matching one is found.</p><p id="p0163" num="0163">The loss of the bank card is an event that involves a problem for the user and, for the entity that issued it, a series of onerous activities with the purpose to block its usage.</p><p id="p0164" num="0164">The types of frauds inherent to this service are the cloning of the card using the "skimmer" technique (duplication of the data contained in the card and simultaneous capture of the secret code entered by the user), and the capture of the card directly at the terminal (for instance through the "crocodile" technique, or by sequestration of the card owner or by pickpocketing).</p><p id="p0165" num="0165">The authentication method according to an embodiment of the present invention can be used in this context, particularly also on POS terminals with colour or monochrome graphic terminal.</p><p id="p0166" num="0166">Since in this implementation mode the user conventionally has to enter a sequence of numbers on the keyboard of the ATM, the dictionary that is used to translate the random sequence of bits that constitutes the original "Challenge" into a string can exclusively use a numerical alphabet, instead of alphanumeric.</p><p id="p0167" num="0167">According to this possible application of the method according to the invention, the user does not know a "valid code" to be entered on the keyboard of the ATM or POS terminal, and does not need to remember it, because such code will be provided thereto at the proper time by his/her<!-- EPO <DP n="31"> --> portable device, for instance his/her cellular phone.</p><p id="p0168" num="0168">The PIN used for activating the application on the user's portable device the (that could be the same PIN that nowadays has to be entered on the keyboard of the ATM or POS terminal) can be entered before the operation, and in a secure place (for instance in the car or away from the ATM or POS terminal).</p><p id="p0169" num="0169">The string of numbers that the user enters on the keyboard of the ATM or POS terminal is valid for one operation or access to the service only, and cannot be re-used, making therefore its capture useless.</p><p id="p0170" num="0170">ATM cards no longer stores the PIN of the user, and therefore its duplication, loss or captures is not critical for the user.</p><p id="p0171" num="0171">The theft or the loss of the user's portable device does not jeopardize the security of the system, because for activating and using the resident application a code needs to be entered (for instance the PIN).</p><p id="p0172" num="0172">Another possible application of the authentication method according to an embodiment of the present invention is related to electronic messaging services (e-mail).</p><p id="p0173" num="0173">Particularly, the here considered application is intended to provide a solution capable of increasing the security level of electronic mail services with the purpose of limiting the "phishing" phenomenon.</p><p id="p0174" num="0174">The "phishing" is a diffused computer fraud that involves the reception by the user of an electronic mail message, apparently coming from his/her bank or from an on-line commerce company, that invites the user to connect, through an HTML (Hyper Text Markup Language) connection ("hyperlink"), to a web page managed by the "phisher" and apparently entirely "similar" to the original of the real firm. Subsequently, inside the imitated web page the user is requested to enter sensitive information (password, credit card number, etc.) to be able to access the functionalities required in the electronic mail message (for instance, the change of personal information, the provision of the consent to the treatment of the information, the deletion of a financial operation erroneously assigned to the user etc.). The information provided by the user are captured (stolen) from the "phisher" who will use it to perform, in the name of the user, undue purchases or fraudulent transactions.</p><p id="p0175" num="0175">Normally the electronic mail messages, also those sent by banks and financial institutes,<!-- EPO <DP n="32"> --> are not protected, because the electronic mail is often simply thought to be a communication, and also the users are accustomed to consider it like this. Often, the protection is only related to the access to companies' Web sites, for which the user has to insert his/her credential whose validity is verified only at the access time. The user does not have a direct possibility of verifying the validity of the sender and the content of the electronic mail message, and he/she does not even have the possibility of verifying the validity of the accessed web page.</p><p id="p0176" num="0176">The problem therefore exists of protecting the content of electronic mail messages with a simple and effective system. The electronic mail message can be protected using the strategy described by way of example hereinafter.</p><p id="p0177" num="0177">According to an embodiment of the present invention, hypertext links usable by the user are not directly included within the text of an electronic mail message.</p><p id="p0178" num="0178">All the confidential and sensitive information are put inside a document attached to the electronic mail message, having a format such as to be modifiable only by those who created it (for instance, the attached document can be a file in PDF - Portable Document Format - format, protected against changes) and whose readability is protected by a password. In the attachment to the electronic mail message it is possible to insert, in addition to the confidential information, also links that allow the user to reach a Web site like the portal of a bank.</p><p id="p0179" num="0179">The electronic mail message contains the authentication information in graphic form (<i>i.e.,</i> the graphic "Challenge") generated by the authentication server at the time of creation of the electronic mail message.</p><p id="p0180" num="0180">To increase the security level, the graphic authentication "Challenge" can contain additional information related to the attachment, like for instance a verification code, random parts of the message, date and time of issue, the answer to a "secret question" that the user has defined at the subscription of the service.</p><p id="p0181" num="0181"><figref idrefs="f0008"><b>Figure 8A</b></figref> shows the possible aspect of an electronic mail message received by the user. <figref idrefs="f0008"><b>Figure 8B</b></figref> shows instead the possible aspect of an attachment to the electronic mail message, for instance in PDF format, containing the confidential information and a link to the site of the bank.</p><p id="p0182" num="0182"><figref idrefs="f0009"><b>Figure 9</b></figref> schematizes a process of local verification of the authenticity of the electronic mail message.</p><p id="p0183" num="0183">The user receives from the sender <b>905</b> the electronic mail message <b>910,</b> and displays it on<!-- EPO <DP n="33"> --> his/her terminal (for instance, PC) <b>115,</b> then the user activates the application on his/her portable device <b>150</b> (for instance the cellular phone), preferably using a PIN; then the user takes a photograph, with the camera <b>155</b> of the cellular phone <b>150,</b> of the image displayed on the screen of the PC <b>115</b> and reads the string displayed by the cellular phone <b>150</b> (derived by processing of the graphic "Challenge", as described in the foregoing), or he/she listens to its vocal declamation at the loudspeaker of the cellular phone.</p><p id="p0184" num="0184">The user then requests to open the attachment <b>915</b> to the electronic mail message <b>910,</b> and the request of insertion of a password <b>920</b> is presented to the user; the user inserts the password previously read on or listened from the cellular phone <b>150,</b> so that a resident application on the PC <b>115</b> can display the content of the attachment <b>915.</b> In this way, entering the correct password, the user is authenticated, and, as a result of the occurred authentication, he/she can access the informative content of the attachment.</p><p id="p0185" num="0185">Inside the attachment <b>915</b> the insertion of one or more links <b>925</b> that allow the user to safely reach the correct Web site is possible.</p><p id="p0186" num="0186">With the purpose of increasing the general security level of the methodology, the Web site reached by the user through the link present in the attached document <b>915</b> could use in turn an authentication mechanism based on a graphic "Challenge" and a "Response" from the user, as described in the foregoing. In this case, inside the attachment <b>915</b> a further graphic "Challenge" <b>930</b> will be present, from which the user can derive the credentials for accessing the service (password/PIN/ID or UserID and password/PIN).</p><p id="p0187" num="0187">In this way, all the sensitive information are contained in the file attached to the electronic mail message, and they are protected by an encrypted OTP (One Time Password) represented in graphic form and contained in the electronic mail message. The message and the attachment can be duplicated, but only for the user to which it is addressed, making therefore useless their re-use because the attachment is not readable by other users.</p><p id="p0188" num="0188">The process allows the user to immediately realize if anything is suspicious, as for instance the lack of the graphic "Challenge" or the impossibility to read it or an enclosure that does not require the password or in which the password does not work:</p><p id="p0189" num="0189">The graphic "Challenge" cannot be imitated, because for its generation, or to derive therefrom the password that the user has to enter for opening the attachment, it is necessary to<!-- EPO <DP n="34"> --> know the encryption key, shared only between the portable device of the user and the entity that sends the electronic mail message.</p><p id="p0190" num="0190">This methodology also allows to read electronic mail messages on public terminals and electronic mail services, since the portable device of the user is the only device capable of decoding the graphics and derive the codes for reading the enclosure.</p><p id="p0191" num="0191">Another possible application of the present invention in the e-mail services consists in the possibility that an e-mail message is sent to the user containing a graphic "Challenge", from which the user can derive, in the described way, a "Response" to be used as an access code to a Web site from which to get from the message sender a confirmation of the authenticity of the received e-mail message. The address (URL) of the Web site to which to connect can be contained in the same graphic "Challenge" and shown to the user by his/her portable device.</p><p id="p0192" num="0192">The use of the PDF format for the attachment allows making its content unmodifiable.</p><p id="p0193" num="0193">Moreover, no radio connectivity is required for the verification of the electronic mail message.</p><p id="p0194" num="0194">The present invention has been described here presenting some possible embodiments; nevertheless, those skilled in the art can make several changes to the embodiments described, or devise alternative embodiments, without departing from the scope of protection of the invention defined in the appended claims.</p><p id="p0195" num="0195">For instance the Base64-format coding might not be foreseen, for instance in the case in which the graphics used for encoding the "Challenge" supports the transfer of the information in binary form, that is the coding from hexadecimal to ASCII is made directly by the image processing algorithm <b>140</b> when generating the bidimensional barcode.</p></description><claims mxw-id="PCLM56984117" lang="DE" load-source="patent-office"><!-- EPO <DP n="40"> --><claim id="c-de-01-0001" num="0001"><claim-text>Verfahren zum Authentifizieren von Nutzern zur Verwendung in einem Datenverarbeitungssystem, wobei das Verfahren Folgendes umfasst:
<claim-text>bei einem Authentifizierungsserver (105):
<claim-text>- Empfangen einer Authentifizierungsanfrage, die durch einen Nutzer übertragen wird, wobei die Anfrage einen persönlichen Identifikationscode des Nutzers umfasst;</claim-text>
<claim-text>- Erzeugen einer "Challenge" (205; 305), die eindeutig mit dem persönlichen Identifikationscode des Nutzers verknüpft ist;</claim-text>
<claim-text>- Verarbeiten der "Challenge" (210-225; 310-325), um einen erwarteten Ant-wortcode zu erzeugen, der mit einem Antwortcode, den der Nutzer zu seiner/ihrer Authentifizierung bereitzustellen hat, verglichen wird;</claim-text>
<claim-text>- Kodieren der erzeugten "Challenge" (230, 235; 330, 335), um ein Bild zu erhalten, welches darstellbar ist auf einem Anzeigegerät (115, 147), welches ausgebildet ist, um das Bild dem Nutzers zu zeigen;</claim-text>
<claim-text>- Senden (235; 335) des Bildes, welches die "Challenge" enthält, zu dem Nutzer;</claim-text>
<claim-text>- bei dem Anzeigegerät des Nutzers (147), Zeigen des Bildes, welches die "Challenge" enthält, über das Anzeigegerät dem Nutzer;</claim-text>
<claim-text>- über ein Nutzergerät (150), welches mit einem Bildnehmergerät (155) bereitgestellt ist, optisches Erfassen (245; 345) des gezeigten Bildes;</claim-text>
<claim-text>- über das Nutzergerät, Verarbeiten des erfassten Bildes (250, 255; 350, 355), um von dem erfassten Bild die "Challenge" zu extrahieren und daran anschließend die erhaltene "Challenge" (260, 265; 360, 365) zur Erzeugung des Antwortcodes zu verarbeiten;</claim-text></claim-text>
<claim-text>bei dem Authentifizierungsserver (105):
<claim-text>- Empfangen des Antwortcodes von dem Nutzer und Vergleichen (280; 380) desselben mit dem erwarteten Antwortcode; und<!-- EPO <DP n="41"> --></claim-text>
<claim-text>- im Fall eines positiven Vergleichens, Authentifizieren des Nutzers,</claim-text></claim-text>
<claim-text>wobei eine der Handlungen des Erzeugens einer "Challenge" und eines erwarteten Antwortcodes und die Handlung des Verarbeitens des erfassten Bildes zur Erzeugung des Antwortcodes eine geheime Information, die eindeutig mit dem Nutzer verknüpft ist, ausnutzt, wobei die geheime Information ein Verschlüsselungsschlüssel, der von dem Datenverarbeitungsserver und dem Nutzergerät geteilt wird, ist.</claim-text></claim-text></claim><claim id="c-de-01-0002" num="0002"><claim-text>Verfahren nach Anspruch 1, wobei das Erzeugen des erwarteten Antwortcodes ein Verknüpfen eines Zeitgültigkeitsgrenzwertes mit dem erwarteten Antwortcode, und wobei das Empfangen des Antwortcodes von dem Nutzer und seines Vergleichens mit dem erwarteten Antwortcode ein Beurteilen umfasst, wenn der Antwortcode von dem Nutzer innerhalb des Gültigkeitszeitgrenzwertes empfangen wird.</claim-text></claim><claim id="c-de-01-0003" num="0003"><claim-text>Verfahren nach Anspruch 1 oder 2, wobei das Erzeugen der "Challenge" ein Erzeugen einer im Wesentlichen zufälligen Bitsequenz umfasst.</claim-text></claim><claim id="c-de-01-0004" num="0004"><claim-text>Verfahren nach Anspruch 3, wobei das Erzeugen der "Challenge" ein Kodieren der im Wesentlichen zufälligen Bitsequenz in einen ersten Datenstring von alphanumerischen Zeichen umfasst, die sie eindeutig darstellen.</claim-text></claim><claim id="c-de-01-0005" num="0005"><claim-text>Verfahren nach Anspruch 4, wobei das Kodieren der "Challenge" ein Kodieren des ersten Datenstrings von alphanumerischen Zeichen umfasst und ein Kodieren des ersten Datenstrings von alphanumerischen Zeichen umfasst, um das Bild, welches über das Anzeigegerät darstellbar ist, zu erhalten.</claim-text></claim><claim id="c-de-01-0006" num="0006"><claim-text>Verfahren nach Anspruch 5, wobei das Erzeugen des erwarteten Antwortcodes ein Verschlüsseln der im Wesentlichen zufälligen Bitsequenz mit der geheimen Information umfasst oder ein Berechnen eines Hash-Wertes für die im Wesentlichen zufälligen Bitsequenz mit der geheimen Information umfasst.<!-- EPO <DP n="42"> --></claim-text></claim><claim id="c-de-01-0007" num="0007"><claim-text>Verfahren nach Anspruch 6, wobei das Erzeugen des erwarteten Antwortcodes ein Kodieren der verschlüsselten im Wesentlichen zufälligen Bitsequenz oder des Hash-Wertes für die im Wesentlichen zufälligen Bitsequenz umfasst, um einen zweiten Datenstring von alphanumerischen Zeichen zu erhalten, und ein Speichern des erhaltenen Datenstrings umfasst.</claim-text></claim><claim id="c-de-01-0008" num="0008"><claim-text>Verfahren nach Anspruch 7, wobei das Verarbeiten des erfassten Bildes zum Extrahieren der "Challenge" von dem erfassten Bild und das Erzeugen des Antwortcodes Folgendes umfasst:
<claim-text>- Dekodieren des ersten Datenstrings von alphanumerischen Zeichen, um die im Wesentlichen zufällige Bitsequenz zu erhalten;</claim-text>
<claim-text>- Verschlüsseln der im Wesentlichen zufälligen Bitsequenz mit der geheimen Information, um eine weitere im Wesentlichen zufällige Bitsequenz verschlüsselt zu erhalten oder Berechnen eines Hash-Wertes für die im Wesentlichen zufälligen Bitsequenz mit der geheimen Information;</claim-text>
<claim-text>- Kodieren der weiteren verschlüsselten im Wesentlichen Zufallsbitsequenz oder des Hash-Wertes für die im Wesentlichen zufälligen Bitsequenz, um den zweiten Datenstring von alphanumerischen Zeichen zu erhalten, wobei der zweite Datenstring von alphanumerischen Zeichen den Antwortcode darstellt.</claim-text></claim-text></claim><claim id="c-de-01-0009" num="0009"><claim-text>Verfahren nach Anspruch 3, wobei das Erzeugen der "Challenge" ein Verschlüsseln der im Wesentlichen zufälligen Bitsequenz mit der geheimen Information umfasst.</claim-text></claim><claim id="c-de-01-0010" num="0010"><claim-text>Verfahren nach Anspruch 9, wobei das Erzeugen der "Challenge" ein Kodieren der verschlüsselten im Wesentlichen zufälligen Bitsequenz in einen ersten Datenstring von alphanumerischen Zeichen umfasst und ein Kodieren des ersten Datenstrings von alphanumerischen Zeichen umfasst, um das Bild, welches über das Anzeigegerät darstellbar ist, zu erhalten.<!-- EPO <DP n="43"> --></claim-text></claim><claim id="c-de-01-0011" num="0011"><claim-text>Verfahren nach Anspruch 10, wobei das Erzeugen des erwarteten Antwortcodes ein Kodieren der im Wesentlichen zufälligen Bitsequenz in einen zweiten Datenstring von alphanumerischen Zeichen umfasst und ein Speichern des erhaltenen zweiten Datenstrings umfasst.</claim-text></claim><claim id="c-de-01-0012" num="0012"><claim-text>Verfahren nach Anspruch 11, wobei das Verarbeiten des erfassten Bildes zum Extrahieren der "Challenge" von dem erfassten Bild und das Erzeugen des Antwort-codes Folgendes umfasst:
<claim-text>- Dekodieren des ersten Datenstrings von alphanumerischen Zeichen, um die verschlüsselte im Wesentlichen zufällige Bitsequenz zu erhalten;</claim-text>
<claim-text>- Entschlüsseln der verschlüsselten im Wesentlichen zufälligen Bitsequenz mit der geheimen Information, um die im Wesentlichen zufälligen Bitsequenz zu erhalten;</claim-text>
<claim-text>- Kodieren der im Wesentlichen zufälligen Bitsequenz, um den zweiten Datenstring von alphanumerischen Zeichen zu erhalten, wobei der zweite Datenstring von alphanumerischen Zeichen den Antwortcode darstellt.</claim-text></claim-text></claim><claim id="c-de-01-0013" num="0013"><claim-text>Verfahren nach einem der vorhergehenden Ansprüche, wobei das Kodieren der erzeugten "Challenge" zum Erhalten eines Bildes ein Erzeugen eines zweidimensionalen Barcodes umfasst.</claim-text></claim><claim id="c-de-01-0014" num="0014"><claim-text>System zum Authentifizieren von Nutzern zur Verwendung in einem Datenverarbeitungssystem, wobei das Authentifizierungssystem Folgendes umfasst:
<claim-text>einen Datenverarbeitungsterminal eines Nutzers,</claim-text>
<claim-text>ein Authentifizierungsserver (105), wobei der Authentifizierungsserver Mittel umfasst, die ausgebildet sind, um
<claim-text>- eine Authentifizierungsanfrage, die durch einen Nutzer übertragen wird, zu empfangen, wobei die Anfrage einen persönlichen Identifizierungscode des Nutzers umfasst;<!-- EPO <DP n="44"> --></claim-text>
<claim-text>- eine "Challenge" (205; 305) zu erzeugen, die eindeutig mit dem persönlichen Identifizierungscode des Nutzers verknüpft ist; und</claim-text>
<claim-text>- die "Challenge" (210-225; 310-325) zu verarbeiten, um einen erwarteten Antwortcode zu erzeugen, welcher mit einem Antwortcode, den der Nutzer für seine/ihre Authentifizierung bereitgestellt hat, zu vergleichen ist;</claim-text>
<claim-text>- die erzeugte "Challenge" (230, 235; 330, 335) zum Erhalten des Bildes zu kodieren;</claim-text>
<claim-text>- das Bild, welches die "Challenge" enthält, an das Datenverarbeitungsterminal (115) des Nutzers über das Datennetzwerk (120) zu senden; und</claim-text></claim-text>
<claim-text>wobei das Datenverarbeitungsterminal ein Anzeigegerät (147) umfasst, welches ausgebildet ist, um dem Nutzer das Bild, welches die "Challenge" enthält, zu zeigen;</claim-text>
<claim-text>wobei das System weiter Folgendes umfasst:
<claim-text>ein Nutzergerät (150), welches mit einem Bildnehmergerät (155) bereitgestellt wird und Mittel umfasst, die ausgebildet sind, um optisch ein visualisiertes Bild zu nehmen, wobei das Nutzergerät ausgebildet ist, um während der Nutzung das genommene Bild zu verarbeiten (250, 255; 350, 355), um die "Challenge" von dem genommenen Bild zu extrahieren und um die "Challenge" zu verarbeiten (260, 265; 360, 365), um ein Antwortcode zu erzeugen,</claim-text>
<claim-text>und wobei der Authentifizierungsserver Mittel umfasst, die ausgebildet sind, um:
<claim-text>den Antwortcode von dem Nutzer zu empfangen und ihn mit einem erwarteten Antwortcode zu vergleichen; und</claim-text>
<claim-text>im Fall eines positiven Vergleichs, den Nutzer zu authentifizieren,</claim-text>
<claim-text>wobei eines von den Mitteln, die ausgebildet sind, um eine "Challenge" zu erzeugen und einen erwarteten Antwortcode zu erzeugen, und die Mittel, die ausgebildet sind, um das genommene Bild zum Erzeugen des Antwortcodes zu verarbeiten, ausgebildet sind, um eine geheime Information, die eindeutig mit dem Nutzer verknüpft ist, zu nutzen, wobei die geheime Information ein Verschlüsselungsschlüssel ist, der von dem Datenverarbeitungsserver und dem Nutzergerät geteilt wird.</claim-text></claim-text></claim-text></claim-text></claim></claims><claims mxw-id="PCLM56984118" lang="EN" load-source="patent-office"><!-- EPO <DP n="35"> --><claim id="c-en-01-0001" num="0001"><claim-text>A method of authentication of users for use in a data processing system, the method comprising:
<claim-text>at an authentication server (<b>105</b>):
<claim-text>- receiving an authentication request submitted by a user, the request including a personal identification code of the user;</claim-text>
<claim-text>-generating a "Challenge" (<b>205;305</b>) univocally associated with the personal identification code of the user;</claim-text>
<claim-text>- processing the "Challenge" (<b>210-225:310-325</b>) to generate an expected answer code, to be compared to an answer code that the user has to provide for his/her authentication;</claim-text>
<claim-text>- encoding the generated "Challenge" (<b>230.235:330.335</b>) for obtaining an image displayable through a display device (<b>115,147</b>) adapted to display the image to the user;</claim-text>
<claim-text>- sending (<b>235:335</b>) the image containing the "Challenge" to the user;</claim-text>
<claim-text>- at the user's display device (<b>147</b>) to the user the image containing the "Challenge" through the display device;</claim-text>
<claim-text>- through a user device (<b>150</b>) Drovided with an image-capturing device (<b>155</b>), optically capturing (<b>245:345</b>) the displayed image;</claim-text>
<claim-text>- through the user device, processing the captured image (<b>250,255:350,355</b>) for extracting from the captured image the "Challenge", and subsequently processing the obtained "Challenge" (<b>260,265;360,365</b>) for generating the answer code;</claim-text></claim-text>
<claim-text>at the authentication server (<b>105</b>):
<claim-text>- receiving the answer code from the user and comparing it (<b>280:380</b>) to the expected answer code; and</claim-text>
<claim-text>- in case of positive comparison, authenticating the user,</claim-text></claim-text>
<claim-text>wherein one among said actions of generating a "Challenge" and an expected answer code, and said action of processing the captured image to generate said answer code exploit a secret information univocally associated with the use said secret information being an encryption key shared by the data processing server and by the user device.</claim-text><!-- EPO <DP n="36"> --></claim-text></claim><claim id="c-en-01-0002" num="0002"><claim-text>The method of claim 1, wherein said generating an expected answer code includes associating with the expected answer code a time validity limit, and receiving the answer code from the user and comparing it with the expected answer code includes assessing if the answer code from the user is received within said time validity limit.</claim-text></claim><claim id="c-en-01-0003" num="0003"><claim-text>The method of claim 1 or 2, wherein said generating the "Challenge" comprises generating a substantially random sequence of bits.</claim-text></claim><claim id="c-en-01-0004" num="0004"><claim-text>The method of claim 3, wherein said generating the "Challenge" comprises encoding the substantially random sequence of bits into a first string of alphanumeric characters that univocally represents it.</claim-text></claim><claim id="c-en-01-0005" num="0005"><claim-text>The method of claim 4, wherein said encoding the "Challenge" comprises encoding the first string of alphanumeric characters, and encoding the encoded first string of alphanumeric characters to obtain the image displayable through the display device.</claim-text></claim><claim id="c-en-01-0006" num="0006"><claim-text>The method of claim 5, wherein said generating the expected answer code includes encrypting the substantially random sequence of bits with said secret information or calculating a hash of the substantially random sequence of bits with said secret information..</claim-text></claim><claim id="c-en-01-0007" num="0007"><claim-text>The method of claim 6, wherein said generating the expected answer code includes encoding the encrypted substantially random sequence of bits, or the hash of the substantially random sequence of bits, to obtain a second string of alphanumeric characters and storing the obtained string.</claim-text></claim><claim id="c-en-01-0008" num="0008"><claim-text>The method of claim 7, wherein said processing the captured image for extracting from<!-- EPO <DP n="37"> --> the captured image the "Challenge" and generating the answer code includes:
<claim-text>- decoding the first string of alphanumeric characters to obtain the substantially random sequence of bits;</claim-text>
<claim-text>- encrypting the substantially random sequence of bits with said secret information to obtain a further encrypted substantially random sequence of bits, or calculating a hash of the substantially random sequence of bits with said secret information;</claim-text>
<claim-text>- encoding the further encrypted substantially random sequence of bits, or the hash of the substantially sequence random of bits, to obtain the second string of alphanumeric characters, said second string of alphanumeric characters constituting the answer code.</claim-text></claim-text></claim><claim id="c-en-01-0009" num="0009"><claim-text>The method of claim 3, wherein said generating the "Challenge" comprises encrypting the substantially random sequence of bits with said secret information.</claim-text></claim><claim id="c-en-01-0010" num="0010"><claim-text>The method of claim 9, wherein said generating the "Challenge" comprises encoding the encrypted substantially random sequence of bits into a first string of alphanumeric characters, and encoding the first string of alphanumeric characters to obtain the image displayable through the display device.</claim-text></claim><claim id="c-en-01-0011" num="0011"><claim-text>The method of claim 10, wherein said generating the expected answer code includes encoding the substantially random sequence of bits into a second string of alphanumeric characters and storing the obtained second string.</claim-text></claim><claim id="c-en-01-0012" num="0012"><claim-text>The method of claim 11, wherein said processing the captured image for extracting from the captured image the "Challenge" and generating the answer code includes:
<claim-text>- decoding the first string of alphanumeric characters to obtain the encrypted substantially random sequence of bits;</claim-text>
<claim-text>- decrypting the encrypted substantially random sequence of bits with said secret<!-- EPO <DP n="38"> --> information to obtain the substantially random sequence of bits;</claim-text>
<claim-text>- encoding the substantially random sequence of bits to obtain the second string of alphanumeric characters, said second string of alphanumeric characters constituting the answer code.</claim-text></claim-text></claim><claim id="c-en-01-0013" num="0013"><claim-text>The method of any one of the preceding claims, wherein said encoding the generated "Challenge" for obtaining an image comprises generating a bidimensional barcode.</claim-text></claim><claim id="c-en-01-0014" num="0014"><claim-text>A system for the authentication of users for use in a data processing system, the authentication system comprising:
<claim-text>a data processing terminal of the user an authentication server (<b>105</b>), said authentication server having means adapted to:
<claim-text>receive an authentication request submitted by a user, the request including a personal identification code of the user;<!-- EPO <DP n="39"> -->
<claim-text>- generate a "Challenge" (<b>205;305</b>) univocally associated with the personal identification code of the user;</claim-text>
<claim-text>- process the "Challenge (<b>210-225;310-325</b>) to generate an expected answer code, to be compared to an answer code that the user has to provide for his/her authentication;</claim-text>
<claim-text>- encode the generated "Challenge" (<b>230,235;330,335</b>) obtaining an image;</claim-text>
<claim-text>- send (<b>235;335</b>) the image containing the "Challenge" to the data processing terminal (<b>115</b>) of the user through a data network (<b>120</b>); and<br/>
wherein the data processing terminal comprises a display device (<b>147</b>) adapted to display to the user the image containing the "Challenge";<br/>
the system further including<br/>
a user device (<b>150</b>) provided with an image-capturing device (<b>155</b>), having means adapted to optically capture the visualized image, the user device being adapted in use to process (<b>250,255;350,355</b>) the captured image for extracting from the captured image the "Challenge" and to process (<b>260,265;360,365</b>) the "Challenge" to generate an answer code;<br/>
and wherein the authentication server has means adapted to:<br/>
receive the answer code from the user and compare it to expected answer code; and<br/>
in case of positive comparison, authenticate the user,<br/>
wherein one among said means adapted to generate a "Challenge" and generate an expected<br/>
answer code, and said means adapted to process the captured image to generate the answer code is adapted to exploit a secret information univocally associated with the user said secret information being an<br/>
encryption key shared by the data processing server and by the user device.</claim-text></claim-text></claim-text></claim-text></claim></claims><claims mxw-id="PCLM56984119" lang="FR" load-source="patent-office"><!-- EPO <DP n="45"> --><claim id="c-fr-01-0001" num="0001"><claim-text>Procédé d'authentification d'utilisateurs à utiliser dans un système de traitement de données, le procédé comprenant :
<claim-text>au niveau d'un serveur d'authentification (105) :
<claim-text>- la réception d'une demande d'authentification soumise par un utilisateur, la demande comprenant un code d'identification personnel de l'utilisateur ;</claim-text>
<claim-text>- la génération d'une « demande d'accès » (205 ; 305) associée de manière univoque au code d'identification personnel de l'utilisateur ;</claim-text>
<claim-text>- le traitement de la « demande d'accès » (210 - 225 ; 310 - 325) afin de générer un code de réponse attendu, à comparer à un code de réponse que l'utilisateur doit fournir pour son authentification ;</claim-text>
<claim-text>- l'encodage de la « demande d'accès » générée (230, 235 ; 330,335) pour obtenir une image affichable par l'intermédiaire d'un dispositif d'affichage (115, 147) adapté pour afficher l'image à l'utilisateur ;</claim-text>
<claim-text>- l'envoi (235 ; 335) de l'image contenant la « demande d'accès » à l'utilisateur ;</claim-text>
<claim-text>- au niveau du dispositif d'affichage de l'utilisateur (147), l'affichage à l'utilisateur de l'image contenant la « demande d'accès » par l'intermédiaire du dispositif d'affichage ;</claim-text>
<claim-text>- par l'intermédiaire d'un dispositif utilisateur (150) pourvu d'un dispositif de capture d'image (155), la capture optique (245 ; 345) de l'image affichée ;<!-- EPO <DP n="46"> --></claim-text>
<claim-text>- par l'intermédiaire du dispositif utilisateur, le traitement de l'image capturée (250, 255 ; 350, 355) pour extraire à partir de l'image capturée la « demande d'accès », et le traitement ultérieur de la « demande d'accès » obtenue (260, 265 ; 360, 365) pour générer le code de réponse ;</claim-text></claim-text>
<claim-text>au niveau du serveur d'authentification (105) :
<claim-text>- la réception du code de réponse provenant de l'utilisateur et sa comparaison (280 ; 380) au code de réponse attendu ; et</claim-text>
<claim-text>- en cas de comparaison positive, l'authentification de l'utilisateur,</claim-text></claim-text>
<claim-text>dans lequel l'une parmi lesdites actions de génération d'une « demande d'accès » et d'un code de réponse attendu, et ladite action de traitement de l'image capturée afin de générer ledit code de réponse exploite une information secrète associée de manière univoque à l'utilisateur, ladite information secrète étant une clé de chiffrement partagée par le serveur de traitement de données et par le dispositif utilisateur.</claim-text></claim-text></claim><claim id="c-fr-01-0002" num="0002"><claim-text>Procédé selon la revendication 1, dans lequel ladite génération d'un code de réponse attendu comprend l'association d'une limite de validité dans le temps au code de réponse attendu, et la réception du code de réponse provenant de l'utilisateur et sa comparaison au code de réponse attendu comprend le fait d'estimer si le code de réponse provenant de l'utilisateur est reçu au sein de ladite limite de validité dans le temps.</claim-text></claim><claim id="c-fr-01-0003" num="0003"><claim-text>Procédé selon la revendication 1 ou 2, dans lequel ladite génération de la « demande d'accès »<!-- EPO <DP n="47"> --> comprend la génération d'une séquence sensiblement aléatoire de bits.</claim-text></claim><claim id="c-fr-01-0004" num="0004"><claim-text>Procédé selon la revendication 3, dans lequel ladite génération de la « demande d'accès » comprend l'encodage de la séquence sensiblement aléatoire de bits en une première chaîne de caractères alphanumériques qui la représente de manière univoque.</claim-text></claim><claim id="c-fr-01-0005" num="0005"><claim-text>Procédé selon la revendication 4, dans lequel ledit encodage de la « demande d'accès » comprend l'encodage de la première chaîne de caractères alphanumériques, et l'encodage de la première chaîne codée de caractères alphanumériques pour obtenir l'image affichable par l'intermédiaire du dispositif d'affichage.</claim-text></claim><claim id="c-fr-01-0006" num="0006"><claim-text>Procédé selon la revendication 5, dans lequel ladite génération du code de réponse attendu comprend le chiffrement de la séquence sensiblement aléatoire de bits avec ladite information secrète ou le calcul d'une empreinte numérique de la séquence sensiblement aléatoire de bits avec ladite information secrète.</claim-text></claim><claim id="c-fr-01-0007" num="0007"><claim-text>Procédé selon la revendication 6, dans lequel ladite génération du code de réponse attendu comprend l'encodage de la séquence sensiblement aléatoire de bits chiffrée, ou l'empreinte numérique de la séquence sensiblement aléatoire de bits, pour obtenir une seconde chaîne de caractères alphanumériques et le stockage de la chaîne obtenue.</claim-text></claim><claim id="c-fr-01-0008" num="0008"><claim-text>Procédé selon la revendication 7, dans lequel ledit traitement de l'image capturée pour extraire la « demande d'accès » à partir de l'image capturée et la génération du code de réponse comprend :<!-- EPO <DP n="48"> -->
<claim-text>- le décodage de la première chaîne de caractères alphanumériques afin d'obtenir la séquence sensiblement aléatoire de bits ;</claim-text>
<claim-text>- le chiffrement de la séquence sensiblement aléatoire de bits avec ladite information secrète afin d'obtenir une séquence sensiblement aléatoire de bits chiffrée supplémentaire, ou le calcul d'une empreinte numérique de la séquence sensiblement aléatoire de bits avec ladite information secrète ;</claim-text>
<claim-text>- l'encodage de la séquence sensiblement aléatoire de bits chiffrée supplémentaire, ou l'empreinte numérique de la séquence sensiblement aléatoire de bits, pour obtenir la seconde chaîne de caractères alphanumériques, ladite seconde chaîne de caractères alphanumériques constituant le code de réponse.</claim-text></claim-text></claim><claim id="c-fr-01-0009" num="0009"><claim-text>Procédé selon la revendication 3, dans lequel ladite génération de la « demande d'accès » comprend le chiffrement de la séquence sensiblement aléatoire de bits avec ladite information secrète.</claim-text></claim><claim id="c-fr-01-0010" num="0010"><claim-text>Procédé selon la revendication 9, dans lequel ladite génération de la « demande d'accès » comprend l'encodage de la séquence sensiblement aléatoire de bits chiffrée en une première chaîne de caractères alphanumériques, et l'encodage de la première chaîne de caractères alphanumériques pour obtenir l'image affichable par l'intermédiaire du dispositif d'affichage.</claim-text></claim><claim id="c-fr-01-0011" num="0011"><claim-text>Procédé selon la revendication 10, dans lequel ladite génération du code de réponse attendu comprend l'encodage de la séquence sensiblement aléatoire de bits en une seconde chaîne de caractères<!-- EPO <DP n="49"> --> alphanumériques et le stockage de la seconde chaîne obtenue.</claim-text></claim><claim id="c-fr-01-0012" num="0012"><claim-text>Procédé selon la revendication 11, dans lequel ledit traitement de l'image capturée pour extraire la « demande d'accès » à partir de l'image capturée et générer le code de réponse comprend :
<claim-text>- le décodage de la première chaîne de caractères alphanumériques afin d'obtenir la séquence sensiblement aléatoire de bits chiffrée ;</claim-text>
<claim-text>- le déchiffrage de la séquence sensiblement aléatoire de bits chiffrée avec ladite information secrète afin d'obtenir la séquence sensiblement aléatoire de bits ;</claim-text>
<claim-text>- l'encodage de la séquence sensiblement aléatoire de bits afin d'obtenir la seconde chaîne de caractères alphanumériques, ladite seconde chaîne de caractères alphanumériques constituant le code de réponse.</claim-text></claim-text></claim><claim id="c-fr-01-0013" num="0013"><claim-text>Procédé selon l'une quelconque des revendications précédentes, dans lequel ledit encodage de la « demande d'accès » générée pour obtenir une image comprend la génération d'un code-barres bidimensionnel.</claim-text></claim><claim id="c-fr-01-0014" num="0014"><claim-text>Système d'authentification d'utilisateurs à utiliser dans un système de traitement de données, le système d'authentification comprenant :
<claim-text>un terminal de traitement de données de l'utilisateur,</claim-text>
<claim-text>un serveur d'authentification (105), ledit serveur d'authentification comportant des moyens adaptés pour :<!-- EPO <DP n="50"> -->
<claim-text>- recevoir une demande d'authentification soumise par un utilisateur, la demande comprenant un code d'identification personnel de l'utilisateur ;</claim-text>
<claim-text>- générer une « demande d'accès » (205 ; 305) associée de manière univoque au code d'identification personnel de l'utilisateur ;</claim-text>
<claim-text>- traiter la « demande d'accès » (210 - 225 ; 310 - 325) pour générer un code de réponse attendu, à comparer à un code de réponse que l'utilisateur doit fournir pour son authentification;</claim-text>
<claim-text>- encoder la « demande d'accès » générée (230, 235 ; 330, 335) pour obtenir une image ;</claim-text>
<claim-text>- envoyer (235 ; 335) l'image contenant la « demande d'accès » au terminal de traitement de données (115) de l'utilisateur par l'intermédiaire d'un réseau de données (120) ; et</claim-text></claim-text>
<claim-text>dans lequel le terminal de traitement de données comprend un dispositif d'affichage (147) adapté pour afficher à l'utilisateur l'image contenant la « demande d'accès » ;</claim-text>
<claim-text>le système comprenant en outre</claim-text>
<claim-text>un dispositif utilisateur (150) pourvu d'un dispositif de capture d'image (155), comportant des moyens adaptés pour capturer optiquement l'image visualisée, le dispositif utilisateur étant adapté en utilisation pour traiter (250, 255 ; 350, 355) l'image capturée pour extraire la « demande d'accès » à partir de l'image capturée et pour traiter (260, 265 ; 360, 365) la « demande d'accès » pour générer un code de réponse ;<!-- EPO <DP n="51"> --></claim-text>
<claim-text>et dans lequel le serveur d'authentification comporte des moyens adaptés pour :
<claim-text>recevoir le code de réponse provenant de l'utilisateur et le comparer au code de réponse attendu ; et</claim-text>
<claim-text>en cas de comparaison positive, authentifier l'utilisateur,</claim-text>
<claim-text>dans lequel l'un parmi lesdits moyens adaptés pour générer une « demande d'accès » et générer un code de réponse attendu, et lesdits moyens adaptés pour traiter l'image capturée pour générer le code d'accès est adapté pour exploiter une information secrète associée de manière univoque à l'utilisateur, ladite information secrète étant une clé de chiffrement partagée par le serveur de traitement de données et par le dispositif utilisateur.</claim-text></claim-text></claim-text></claim></claims><drawings mxw-id="PDW16671754" load-source="patent-office"><!-- EPO <DP n="52"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="163" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="53"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="162" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="54"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="165" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="55"> --><figure id="f0004" num="4"><img id="if0004" file="imgf0004.tif" wi="165" he="230" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="56"> --><figure id="f0005" num="5"><img id="if0005" file="imgf0005.tif" wi="160" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="57"> --><figure id="f0006" num="6"><img id="if0006" file="imgf0006.tif" wi="163" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="58"> --><figure id="f0007" num="7"><img id="if0007" file="imgf0007.tif" wi="165" he="231" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="59"> --><figure id="f0008" num="8A,8B"><img id="if0008" file="imgf0008.tif" wi="162" he="231" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="60"> --><figure id="f0009" num="9"><img id="if0009" file="imgf0009.tif" wi="160" he="233" img-content="drawing" img-format="tif"/></figure></drawings><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
