<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2087832-B1" country="EP" doc-number="2087832" kind="B1" date="20140108" family-id="39467823" file-reference-id="258396" date-produced="20180826" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146588301" ucid="EP-2087832-B1"><document-id><country>EP</country><doc-number>2087832</doc-number><kind>B1</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-07832574-A" is-representative="YES"><document-id mxw-id="PAPP154850493" load-source="docdb" format="epo"><country>EP</country><doc-number>07832574</doc-number><kind>A</kind><date>20071127</date><lang>JA</lang></document-id><document-id mxw-id="PAPP196390559" load-source="docdb" format="original"><country>EP</country><doc-number>07832574.3</doc-number><date>20071127</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140549462" ucid="JP-2006319095-A" load-source="docdb"><document-id format="epo"><country>JP</country><doc-number>2006319095</doc-number><kind>A</kind><date>20061127</date></document-id></priority-claim><priority-claim mxw-id="PPC140551398" ucid="JP-2007072849-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>JP</country><doc-number>2007072849</doc-number><kind>W</kind><date>20071127</date></document-id></priority-claim></priority-claims><dates-of-public-availability><intention-to-grant-date><date>20130125</date></intention-to-grant-date><search-report-dispatch-date><date>20110706</date></search-report-dispatch-date></dates-of-public-availability><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1989325216" load-source="docdb">A61B   1/00        20060101AFI20110630BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1989325217" load-source="docdb">A61B   5/07        20060101ALI20110630BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1989325218" load-source="docdb">G01B   7/00        20060101ALI20110630BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1844971948" load-source="docdb" scheme="CPC">A61B   5/062       20130101 LI20170223BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1976619073" load-source="docdb" scheme="CPC">A61B  34/73        20160201 LI20160201BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989624330" load-source="docdb" scheme="CPC">A61B   5/7257      20130101 LA20130914BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989625789" load-source="docdb" scheme="CPC">A61B   1/00158     20130101 LI20130914BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989627056" load-source="docdb" scheme="CPC">G01B   7/003       20130101 FI20130914BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989634861" load-source="docdb" scheme="CPC">A61B   5/7232      20130101 LA20130703BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989645718" load-source="docdb" scheme="CPC">A61B   5/06        20130101 LI20130914BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989649110" load-source="docdb" scheme="CPC">A61B   1/041       20130101 LI20130914BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989649849" load-source="docdb" scheme="CPC">G01D   5/2086      20130101 LI20130914BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132369536" lang="DE" load-source="patent-office">POSITIONSERKENNUNGSSYSTEM, FÜHRUNGSSYSTEM FÜR EINE MEDIZINISCHE VORRICHTUNG UND POSITIONSERKENNUNGSVERFAHREN</invention-title><invention-title mxw-id="PT132369537" lang="EN" load-source="patent-office">POSITION DETECTION SYSTEM, MEDICAL DEVICE GUIDANCE SYSTEM AND POSITION DETECTION METHOD</invention-title><invention-title mxw-id="PT132369538" lang="FR" load-source="patent-office">SYSTÈME DE DÉTECTION DE POSITION, SYSTÈME DE GUIDAGE DE DISPOSITIF MÉDICAL ET PROCÉDÉ DE DÉTECTION DE POSITION</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR919533049" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>OLYMPUS CORP</last-name><address><country>JP</country></address></addressbook></applicant><applicant mxw-id="PPAR919506570" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>OLYMPUS CORPORATION</last-name></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919530582" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>UCHIYAMA AKIO</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR919511221" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>UCHIYAMA, AKIO</last-name></addressbook></inventor><inventor mxw-id="PPAR919022460" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>UCHIYAMA, AKIO</last-name><address><street>Olympus Corporation 43-2, Hatagaya 2-chome</street><city>Shibuya-ku Tokyo 151-0072</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR919516624" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>SATO RYOJI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR919518956" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>SATO, RYOJI</last-name></addressbook></inventor><inventor mxw-id="PPAR919022461" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>SATO, RYOJI</last-name><address><street>Olympus Corporation 43-2, Hatagaya 2-chome</street><city>Shibuya-ku Tokyo 151-0072</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR919523605" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>KIMURA ATSUSHI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR919525776" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>KIMURA, ATSUSHI</last-name></addressbook></inventor><inventor mxw-id="PPAR919022459" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>KIMURA, ATSUSHI</last-name><address><street>Olympus Corporation 43-2, Hatagaya 2-chome</street><city>Shibuya-ku Tokyo 151-0072</city><country>JP</country></address></addressbook></inventor></inventors><assignees><assignee mxw-id="PPAR919022463" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Olympus Corporation</last-name><iid>100814816</iid><address><street>43-2, Hatagaya 2-chome Shibuya-ku</street><city>Tokyo 151-0072</city><country>JP</country></address></addressbook></assignee></assignees><agents><agent mxw-id="PPAR919022462" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>von Hellfeld, Axel</last-name><iid>100025708</iid><address><street>Wuesthoff &amp; Wuesthoff Patent- und Rechtsanwälte Schweigerstrasse 2</street><city>81541 München</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="JP-2007072849-W"><document-id><country>JP</country><doc-number>2007072849</doc-number><kind>W</kind><date>20071127</date><lang>JA</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2008066036-A1"><document-id><country>WO</country><doc-number>2008066036</doc-number><kind>A1</kind><date>20080605</date><lang>JA</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS549801487" load-source="docdb">DE</country><country mxw-id="DS549877975" load-source="docdb">FR</country><country mxw-id="DS549801488" load-source="docdb">GB</country></ep-contracting-states></designated-states></international-convention-data></bibliographic-data><description mxw-id="PDES63960726" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001">Technical Field</heading><p id="p0001" num="0001">The present invention relates to a position detection system, a medical-device guidance system, and a position detection method.</p><heading id="h0002">Background Art</heading><p id="p0002" num="0002">Position detection apparatuses that detect the position of a marker inserted into a body cavity by causing the marker to produce an alternating magnetic field by means of external power supply and then detecting, outside the body, the alternating magnetic field produced by the marker are well known (e.g., refer to Patent Document 1).</p><p id="p0003" num="0003">Position detection systems for capsule medical devices that detect the position and the orientation of a capsule medical device delivered into the body of a subject by externally producing a position-detecting magnetic field and detecting the absolute-value intensity of an induced magnetic field produced in a magnetic induction coil disposed in the<!-- EPO <DP n="2"> --> capsule medical device are also well known (e.g., refer to Non-patent Document 1).</p><p id="p0004" num="0004"><ul><li>Patent Document 1:
<ul><li>Japanese Unexamined Patent Application, Publication No. <patcit id="pcit0001" dnum="JP2000081303A"><text>2000-81303</text></patcit></li></ul></li><li>Non-patent Document 1:
<ul><li><nplcit id="ncit0001" npl-type="s"><text>Tokunaga plus 7 other authors. Precision Position-detecting System Using an LC Resonant Magnetic Marker. Journal of the Magnetics Society of Japan 2005; Vol.29, No.2:153-156</text></nplcit></li></ul></li></ul></p><p id="p0005" num="0005"><patcit id="pcit0002" dnum="US2004124105A"><text>US 2004/124105</text></patcit> discloses a system for storing preloaded introducers that contain resonating markers. The marker has a casing configured to be implanted into a patient and a resonating circuit in the casing. The markers can have the same or different frequencies. In response to an excitation magnetic field, the resonating circuit produces a target signal or a response signal that can be measured by a sensor array positioned externally with respect to the patient.</p><p id="p0006" num="0006"><patcit id="pcit0003" dnum="US2006125472A"><text>US 2006/125472</text></patcit> discloses a sensor element having two resonant circuits which respond to an excitation signal to produce induced resonant signals, which are detected by a sense coil to determine a rotation of the sensor element in the measurement direction.</p><p id="p0007" num="0007"><patcit id="pcit0004" dnum="WO2005120345A"><text>WO 2005/120345</text></patcit> discloses drive coils that generate induced magnetism in a magnetic induction coil in a capsule endoscope, wherein sense coils detect and control the alternating magnetic field formed by the drive coils.</p><heading id="h0003">Disclosure of Invention</heading><p id="p0008" num="0008">However, if a first marker which produces an alternating magnetic field by external power supply coexists with a second marker which includes a resonance circuit having a resonance frequency in the proximity of the frequency of that alternating magnetic field, then an induced magnetic field is produced from the resonance circuit of the second marker due to the alternating magnetic field produced by the first marker. As a result, because merely detecting the absolute-value intensity of the magnetic field at the frequency of the alternating magnetic field involves simultaneous detection of the induced magnetic field, the magnetic-field intensity<!-- EPO <DP n="3"> --> obtained in a case where the alternating magnetic field alone is detected. For this reason, it has been difficult to accurately calculate the position or the orientation of the first marker.</p><p id="p0009" num="0009">An object of the present invention is to provide a position detection system, a medical-device guidance system, and a position detection method capable of accurately detecting the position or the orientation of a first marker which produces an alternating magnetic field by means of external power supply even though the first marker coexists with a second marker which includes a resonance circuit having a resonance frequency the same as or close to the frequency of the alternating magnetic field.</p><p id="p0010" num="0010">Therefore, a position detection system and a position detection method according to the pending independent claims are provided.A position detection system according to a first aspect of the present invention includes a first marker that produces a first alternating magnetic field having a first position-calculating frequency by means of an external power supply; a second marker including a magnetic induction coil having a resonance frequency equal to the position-calculating frequency; a magnetic-field detection section that is disposed<!-- EPO <DP n="4"> --> outside a working region of the second marker and that detects a magnetic field at the first position-calculating frequency; an extracting section that extracts, from the magnetic field detected by the magnetic-field detection section, a first detection-magnetic-field component having the first position-calculating frequency and having a phase equal to a phase of the first alternating magnetic field; and a position/orientation analyzing section that calculates at least one of a position and an orientation of the first marker based on the intensity of the first detection-magnetic-field component extracted by the extracting section.</p><p id="p0011" num="0011">According to the first aspect of the present invention, the first marker produces the first alternating magnetic field having the first position-calculating frequency using the external power supply. The magnetic induction coil mounted in the second marker receives the first alternating magnetic field produced from the first marker. Because the resonance frequency of a circuit including the magnetic induction coil is equal to the first position-calculating frequency, the magnetic induction coil produces an induced magnetic field in response to the first alternating magnetic field. Then, the magnetic-field detection section detects the magnetic field including the first alternating magnetic field and the induced magnetic field at the first position-calculating frequency.<!-- EPO <DP n="5"> --></p><p id="p0012" num="0012">The extracting section extracts, from the magnetic field detected by the magnetic-field detection section, the first detection-magnetic-field component having the first position-calculating frequency and having the same phase as that of the first alternating magnetic field. The position/orientation analyzing section calculates at least one of the position and the orientation of the first marker based on the intensity of the first detection-magnetic-field component extracted by the extracting section.</p><p id="p0013" num="0013">The induced magnetic field produced from the magnetic induction coil in response to the first alternating magnetic field has the first position-calculating frequency and a phase shifted by π/2 relative to the phase of the first alternating magnetic field. On the other hand, the first detection-magnetic-field component is a magnetic-field component having the same frequency and phase as those of the first alternating magnetic field.</p><p id="p0014" num="0014">For this reason, of the detected magnetic field, the first detection-magnetic-field component does not include information about the induced magnetic field but includes only information about the first alternating magnetic field. Therefore, the extracting section can extract only information<!-- EPO <DP n="6"> --> about the first alternating magnetic field from the magnetic field detected by the magnetic-field detection section. Because of this, the position/orientation analyzing section can calculate at least one of the position and the orientation of the first marker using only the information about the intensity associated with the first alternating magnetic field produced from the first marker.</p><p id="p0015" num="0015">Consequently, even though the first marker that produces a magnetic field using the external power supply coexists with the second marker having the magnetic induction coil, the position or the orientation of the first marker can be calculated with high accuracy without being affected by the induced magnetic field.</p><p id="p0016" num="0016">In the above-described first aspect, the extracting section extracts, from the magnetic field detected by the magnetic-field detection section, a second detection-magnetic-field component having the first position-calculating frequency and having a phase shifted by π/2 with respect to the phase of the first alternating magnetic field, and the position/orientation analyzing section calculates at least one of a position and an orientation of the second marker based on the intensity of the second detection-magnetic-field component.<!-- EPO <DP n="7"> --></p><p id="p0017" num="0017">By doing so, the extracting section extracts the first detection-magnetic-field component and the second detection-magnetic-field component from the magnetic field detected by the magnetic-field detection section. The position/orientation analyzing section calculates at least one of the position and the orientation of the first marker based on the intensity of the first detection-magnetic-field component extracted by the extracting section, and calculates at least one of the position and the orientation of the second marker based on the intensity of the second detection-magnetic-field component extracted by the extracting section.</p><p id="p0018" num="0018">The induced magnetic field produced from the magnetic induction coil in response to the first alternating magnetic field has the same frequency as that of the first alternating magnetic field and a phase shifted by π/2 relative to the phase of the first alternating magnetic field. The second detection-magnetic-field component is also a magnetic-field component having the same frequency as that of the first alternating magnetic field and a phase shifted by π/2 relative to the phase of the first alternating magnetic field. For this reason, the second detection-magnetic-field component does not include information about the first alternating magnetic field but includes only information about the induced<!-- EPO <DP n="8"> --> magnetic field. Therefore, the extracting section can extract only information about the induced magnetic field from the magnetic field detected by the magnetic-field detection section.</p><p id="p0019" num="0019">Because of this, the position/orientation analyzing section can calculate at least one of the position and the orientation of the second marker using only the intensity information of the induced magnetic field produced from the second marker.</p><p id="p0020" num="0020">Consequently, even though the first marker that produces a magnetic field using the external power supply coexists with the second marker having the magnetic induction coil, at least one of the position and the orientation can be simultaneously calculated with high accuracy for both the first marker and the second marker.</p><p id="p0021" num="0021">Furthermore, the position detection system according to the above-described first aspect may include a magnetic-field generating unit, disposed outside a working region of the second marker, that produces a second alternating magnetic field having the first position-calculating frequency and having a phase equal to the phase of the first alternating magnetic field. The position/orientation analyzing section may calculate at least one of the position and the orientation<!-- EPO <DP n="9"> --> of the first marker based on a difference between an intensity of the first detection-magnetic-field component extracted when the first alternating magnetic field is produced and an intensity of the first detection-magnetic-field component extracted before the first alternating magnetic field is produced.</p><p id="p0022" num="0022">By doing so, the magnetic-field generating unit disposed outside the working region of the second marker produces the second alternating magnetic field. Because the first alternating magnetic field and the second alternating magnetic field have the same frequency and phase, the magnetic induction coil produces the induced magnetic field in response to the first alternating magnetic field and the second alternating magnetic field. The magnetic-field detection section detects a magnetic field including the first alternating magnetic field, the second alternating magnetic field, and the induced magnetic field at the first position-calculating frequency.</p><p id="p0023" num="0023">The first detection-magnetic-field component when the first alternating magnetic field is produced includes information about the first alternating magnetic field and the second alternating magnetic field. On the other hand, the first detection-magnetic-field component extracted before the<!-- EPO <DP n="10"> --> first alternating magnetic field is produced includes only information about the second alternating magnetic field. Therefore, only the information about the intensity of the first alternating magnetic field can be obtained by calculating the difference between them through an operation performed by the position/orientation analyzing section.</p><p id="p0024" num="0024">For the same reason as described above, the second detection-magnetic-field component does not include information about the first alternating magnetic field and the second alternating magnetic field but includes only information about the induced magnetic field. Therefore, the extracting section can extract only the information about the induced magnetic field from the magnetic field detected by the magnetic-field detection section. Because of this, the position/orientation analyzing section can calculate at least one of the position and the orientation of the first marker using only information about the intensity of the first alternating magnetic field and can calculate at least one of the position and the orientation of the second marker using only intensity information of the induced magnetic field produced from the second marker.</p><p id="p0025" num="0025">Consequently, even though the first marker that produces a magnetic field using the external power supply coexists with<!-- EPO <DP n="11"> --> the second marker having the magnetic induction coil, at least one of the position and the orientation can be simultaneously calculated with high accuracy for both the first marker and the second marker. Furthermore, because the second alternating magnetic field, in addition to the first alternating magnetic field, causes the second marker to produce the induced magnetic field, the intensity of the induced magnetic field can be increased.</p><p id="p0026" num="0026">Furthermore, the position detection system according to the above-described first aspect may include a magnetic-field generating unit, disposed outside a working region of the second marker, that produces a second alternating magnetic field having at least one set of second position-calculating frequencies that are in the proximity of the first position-calculating frequency and are separated by a predetermined frequency with respect to the first position-calculating frequency with the first position-calculating frequency interposed therebetween. The magnetic-field detection section may detect a magnetic field at the second position-calculating frequency, the extracting section may extract, from the magnetic field detected by the magnetic-field detection section, a difference between intensities of at least one set of second detection-magnetic-field components having the one set of second position-calculating frequencies, and the<!-- EPO <DP n="12"> --> position/orientation analyzing section may calculate at least one of a position and an orientation of the second marker based on the extracted difference.</p><p id="p0027" num="0027">The magnetic-field generating unit disposed outside the working region of the second marker produces the second alternating magnetic field. The magnetic induction coil produces the induced magnetic field having the first position-calculating frequency in response to the first alternating magnetic field and produces the induced magnetic field having the second position-calculating frequency in response to the second alternating magnetic field. The magnetic-field detection section detects a magnetic field including the first alternating magnetic field and the induced magnetic field produced by the first alternating magnetic field at the first position-calculating frequency and detects a magnetic field including the second alternating magnetic field and the induced magnetic field produced by the second alternating magnetic field at the second position-calculating frequency.</p><p id="p0028" num="0028">The extracting section extracts the difference between the intensity of the first detection-magnetic-field component and the intensities of at least one set of second detection-magnetic-field components from the magnetic field detected by the magnetic-field detection section. The<!-- EPO <DP n="13"> --> position/orientation analyzing section calculates at least one of the position and the orientation of the first marker based on the intensity of the first detection-magnetic-field component extracted by the extracting section and furthermore, calculates at least one of the position and the orientation of the second marker based on the difference between the intensities of the extracted at least one set of second detection-magnetic-field components.</p><p id="p0029" num="0029">The induced magnetic field produced from the magnetic induction coil in response to the second alternating magnetic field has a set of second position-calculating frequencies, and the intensities with respect to the second alternating magnetic field differ from one another at the frequencies. On the other hand, because the second detection-magnetic-field component is a magnetic-field component having the second position-calculating frequency, it has the same frequency as that of the second alternating magnetic field.</p><p id="p0030" num="0030">For this reason, the second detection-magnetic-field component does not include information about the first alternating magnetic field but includes only information about the second alternating magnetic field and the induced magnetic field produced by the second alternating magnetic field (hereinafter, referred to as the induced magnetic field<!-- EPO <DP n="14"> --> associated with the second alternating magnetic field). Therefore, through arithmetic calculation of the difference between the intensities of a set of second detection-magnetic-field components, the extracting section can extract a large amount of information about the intensity of the induced magnetic field associated with the second alternating magnetic field by subtracting the information about the intensity of the second alternating magnetic field from the magnetic field detected by the magnetic-field detection section.</p><p id="p0031" num="0031">Because of this, the position/orientation analyzing section can calculate at least one of the position and the orientation of the second marker using the information about the intensity of the induced magnetic field associated with the second alternating magnetic field. Consequently, even though the first marker that produces a magnetic field using the external power supply coexists with the second marker having the magnetic induction coil, at least one of the position and the orientation can be simultaneously calculated with high accuracy for both the first marker and the second marker.</p><p id="p0032" num="0032">In addition, in the above-described first aspect, the intensities of the second detection-magnetic-field components may be absolute-value intensities.<!-- EPO <DP n="15"> --></p><p id="p0033" num="0033">The absolute-value intensity of the second detection-magnetic-field component includes only information about the second alternating magnetic field and the induced magnetic field associated with the second alternating magnetic field. Therefore, through arithmetic operation of the difference between the intensities of a set of second detection-magnetic-field components, the extracting section can extract a large amount of information about the intensity of the induced magnetic field associated with the second alternating magnetic field by subtracting the information about the intensity of the second alternating magnetic field from the magnetic field detected by the magnetic-field detection section.</p><p id="p0034" num="0034">In addition, in the above-described first aspect, the second marker may be provided in a capsule medical device.</p><p id="p0035" num="0035">Furthermore, in the above-described first aspect of the invention, the first marker may be provided at a front end portion of an endoscope.</p><p id="p0036" num="0036">A medical-device guidance system according to a second aspect of the present invention includes one of the above-described position detection systems, the second marker further including a magnetic-field acting section; a propulsion-magnetic-field generating unit that produces a propulsion magnetic field made to act upon the magnetic-field<!-- EPO <DP n="16"> --> acting section; and a propulsion-magnetic-field control section that controls an intensity and a direction of the propulsion magnetic field based on at least one of the position and the orientation of the second marker calculated by the position/orientation analyzing section.</p><p id="p0037" num="0037">According to the second aspect of the present invention, the propulsion-magnetic-field generating unit produces the propulsion magnetic field which is made to act upon the magnetic-field acting section of the second marker. The propulsion-magnetic-field control section controls the propulsion-magnetic-field generating unit based on at least one of the position and the orientation of the second marker calculated by the position/orientation analyzing section and controls the intensity and the direction of the propulsion magnetic field. Consequently, propulsion of the second marker can be controlled based on the position or the orientation of the second marker.</p><p id="p0038" num="0038">A position detection method according to a third aspect of the present invention includes a magnetic-field generating step of causing a first marker to produce a first alternating magnetic field having a first position-calculating frequency by means of an external power supply; an induced-magnetic-field generating step of causing a second marker including a<!-- EPO <DP n="17"> --> magnetic induction coil to produce an induced magnetic field in response to the first alternating magnetic field; a magnetic-field detecting step of detecting a magnetic field at the first position-calculating frequency; an extracting step of extracting, from the detected magnetic field, a first detection-magnetic-field component having the first position-calculating frequency and having a phase equal to a phase of the first alternating magnetic field at the first position-calculating frequency; and a position/orientation analyzing step of calculating at least one of a position and an orientation of the first marker based on the intensity of the extracted first detection-magnetic-field component.</p><p id="p0039" num="0039">In the above-described third aspect, the extracting step includes a step of extracting, from the detected magnetic field, a second detection-magnetic-field component having the first position-calculating frequency and having a phase shifted by n/2 with respect to the phase of the first alternating magnetic field, and the position/orientation analyzing step includes a step of calculating at least one of a position and an orientation of the second marker based on the intensity of the extracted second detection-magnetic-field component.</p><p id="p0040" num="0040">Furthermore, in the above-described third aspect, the<!-- EPO <DP n="18"> --> magnetic-field generating step may include a step of producing a second alternating magnetic field having the first position-calculating frequency and having a phase equal to the phase of the first alternating magnetic field, the induced-magnetic-field generating step may include a step of causing the second marker to produce an induced magnetic field in response to the second alternating magnetic field, and the position/orientation analyzing step may include a step of calculating at least one of the position and the orientation of the first marker based on a difference between an intensity of the first detection-magnetic-field component extracted when the first alternating magnetic field is produced and an intensity of the first detection-magnetic-field component extracted before the first alternating magnetic field is produced.</p><p id="p0041" num="0041">In addition, in the above-described third aspect, the magnetic-field generating step may include a step of producing a second alternating magnetic field having at least one set of second position-calculating frequencies that are in the proximity of the first position-calculating frequency and are separated by a predetermined frequency with respect to the first position-calculating frequency with the first position-calculating frequency interposed therebetween, the induced-magnetic-field generating step may include a step of causing<!-- EPO <DP n="19"> --> the second marker to produce an induced magnetic field in response to the second alternating magnetic field, the magnetic-field detecting step may include a step of detecting a magnetic field at the second position-calculating frequency, the extracting step may include a step of extracting, from a detected magnetic field, a difference between intensities of at least one set of second detection-magnetic-field components having the one set of second position-calculating frequencies, and the position/orientation analyzing step may include a step of calculating at least one of a position and an orientation of the second marker based on the extracted difference.</p><p id="p0042" num="0042">The present invention affords an advantage in that, even though a first marker that produces an alternating magnetic field using an external power supply coexists with a second marker including a resonance circuit having a resonance frequency equal or close to the frequency of the alternating magnetic field, the position or the orientation of the first marker can be detected accurately.</p><heading id="h0004">Brief Description of Drawings</heading><p id="p0043" num="0043"><ul><li>[<figref idrefs="f0001">FIG. 1] Fig. 1</figref> is a block diagram depicting the overall structure of a position detection system according to a first embodiment of the present invention.<!-- EPO <DP n="20"> --></li><li>[<figref idrefs="f0002">FIG. 2] Fig. 2</figref> is a block diagram depicting the detailed structure of the position detection system shown in <figref idrefs="f0001">Fig. 1</figref>.</li><li>[<figref idrefs="f0003">FIG. 3] Fig. 3</figref> is a flowchart illustrating waveform generation by a position detection method using the position detection system shown in <figref idrefs="f0001">Fig. 1</figref>.</li><li>[<figref idrefs="f0004">FIG. 4] Fig. 4</figref> is a flowchart illustrating the first-half stage of calibration in the position detection method of <figref idrefs="f0003">Fig. 3</figref>.</li><li>[<figref idrefs="f0005">FIG. 5] Fig. 5</figref> is a flowchart illustrating the second-half stage of calibration in the position detection method of <figref idrefs="f0003">Fig. 3</figref>.</li><li>[<figref idrefs="f0006">FIG. 6] Fig. 6</figref> is a flowchart illustrating the first-half stage of actual measurement in the position detection method of <figref idrefs="f0003">Fig. 3</figref>.</li><li>[<figref idrefs="f0007">FIG. 7] Fig. 7</figref> is a flowchart illustrating actual measurement, continued from <figref idrefs="f0006">Fig. 6</figref>.</li><li>[<figref idrefs="f0008">FIG. 8] Fig. 8</figref> is a flowchart illustrating actual measurement, continued from <figref idrefs="f0007">Fig. 7</figref>.</li><li>[<figref idrefs="f0009">FIG. 9] Fig. 9</figref> is a diagram depicting the overall structure of a medical-device guidance system including a position detection system according to a second embodiment of the present invention.</li><li>[<figref idrefs="f0010">FIG. 10] Fig. 10</figref> is a longitudinal sectional view of one example of a capsule medical device used in the medical-device<!-- EPO <DP n="21"> --> guidance system shown in <figref idrefs="f0009">Fig. 9</figref>.</li><li>[<figref idrefs="f0011">FIG. 11] Fig. 11</figref> is a block diagram depicting the overall structure of the position detection system according to this embodiment, provided in the medical-device guidance system shown in <figref idrefs="f0009">Fig. 9</figref>.</li><li>[<figref idrefs="f0012">FIG. 12] Fig. 12</figref> is a block diagram depicting the detailed structure of the position detection system shown in <figref idrefs="f0011">Fig. 11</figref>.</li><li>[<figref idrefs="f0013">FIG. 13] Fig. 13</figref> is a flowchart illustrating the first-half stage of calibration by a position detection method using the position detection system shown in <figref idrefs="f0011">Fig. 11</figref>.</li><li>[<figref idrefs="f0014">FIG. 14] Fig. 14</figref> is a flowchart illustrating the second-half stage of calibration, continued from <figref idrefs="f0013">Fig. 13</figref>.</li><li>[<figref idrefs="f0015">FIG. 15] Fig. 15</figref> is a flowchart illustrating the first-half stage of actual measurement by the position detection system of <figref idrefs="f0011">Fig. 11</figref>.</li><li>[<figref idrefs="f0016">FIG. 16] Fig. 16</figref> is a flowchart illustrating actual measurement, continued from <figref idrefs="f0015">Fig. 15</figref>.</li><li>[<figref idrefs="f0017">FIG. 17] Fig. 17</figref> is a flowchart illustrating actual measurement, continued from <figref idrefs="f0016">Fig. 16</figref>.</li><li>[<figref idrefs="f0018">FIG. 18] Fig. 18</figref> is a block diagram depicting the overall structure of a position detection system according to a non-claimed example.</li><li>[<figref idrefs="f0019">FIG. 19] Fig. 19</figref> is a block diagram depicting the detailed structure of the position detection system shown in<!-- EPO <DP n="22"> --> <figref idrefs="f0018">Fig. 18</figref>.</li><li>[<figref idrefs="f0020">FIG. 20] Fig. 20</figref> is a flowchart illustrating waveform generation by a position detection method using the position detection system shown in <figref idrefs="f0018">Fig. 18</figref>.</li><li>[<figref idrefs="f0021">FIG. 21] Fig. 21</figref> is a flowchart illustrating calibration by the position detection method of <figref idrefs="f0020">Fig. 20</figref>.</li><li>[<figref idrefs="f0022">FIG. 22] Fig. 22</figref> is a flowchart illustrating the first-half stage of actual measurement by the position detection method using the position detection system shown in <figref idrefs="f0018">Fig. 18</figref>.</li><li>[<figref idrefs="f0023">FIG. 23] Fig. 23</figref> is a flowchart illustrating actual measurement, continued from <figref idrefs="f0022">Fig. 22</figref>.</li><li>[<figref idrefs="f0024">FIG. 24] Fig. 24</figref> is a flowchart illustrating actual measurement, continued from <figref idrefs="f0023">Fig. 23</figref>.</li></ul></p><heading id="h0005">Explanation of Reference Signs:</heading><p id="p0044" num="0044"><ul><li>f<sub>0</sub>: First position-calculating frequency</li><li>f<sub>1</sub>, f<sub>2</sub>: Second position-calculating frequency</li><li>1, 40, 50: Position detection system</li><li>2: Endoscope apparatus (endoscope)</li><li>2a: Inserting section</li><li>3: Capsule medical device (second marker)</li><li>3': Second capsule medical device (capsule medical device)</li><li>4, 52: Marker coil (first marker)</li><li>5: Magnetic induction coil</li><li>6: Magnetic-field detection section<!-- EPO <DP n="23"> --></li><li>21: Frequency-selecting section (extracting section)</li><li>22: Position/orientation analyzing section<br/>
41: Magnetic-field generating device (magnetic-field</li><li>generating unit)</li><li>51: First capsule medical device (capsule medical device)</li><li>71: Three-axis Helmholtz coil unit</li><li>72: Helmholtz-coil driver (propulsion-magnetic-field control section)</li><li>100: Medical-device guidance system</li><li>150: Permanent magnet (magnetic-field acting section)</li></ul></p><heading id="h0006">Best Mode for Carrying Out the Invention</heading><heading id="h0007">[First embodiment]</heading><p id="p0045" num="0045">A position detection system 1 according to a first embodiment of the present invention will now be described with reference to <figref idrefs="f0001 f0002 f0003">Figs. 1 to 3</figref>.</p><p id="p0046" num="0046">The position detection system 1 according to this embodiment is a system provided in a medical-device guidance system that includes an endoscope apparatus 2 having an inserting section 2a inserted into a body cavity and a capsule medical device 3 delivered into the body cavity. The position detection system 1 includes a marker coil (first marker) 4 disposed at a tip portion of the inserting section 2a of the endoscope apparatus 2, a magnetic induction coil (second<!-- EPO <DP n="24"> --> marker) 5 disposed in the capsule medical device 3, a position detection apparatus 6 that detects the position of the marker coil 4, a control section 7 that controls these components, and a display device 8 that displays a result of detection by the position detection apparatus 6.</p><p id="p0047" num="0047">As shown in <figref idrefs="f0002">Fig. 2</figref>, the endoscope apparatus 2 is provided with a marker-driving circuit 9 that causes the marker coil 4 to produce a first alternating magnetic field in response to a command signal from the control section 7. The marker-driving circuit 9 includes a waveform data memory 10 that stores a magnetic-field waveform of the first alternating magnetic field produced by the marker coil 4, a D/A converter 11, and an amplifier 12.</p><p id="p0048" num="0048">The above-described marker coil 4 is driven by the marker-driving circuit 9 to produce the first alternating magnetic field having a first position-calculating frequency f<sub>0</sub>.</p><p id="p0049" num="0049">The capsule medical device 3 is provided with a resonance circuit that includes the above-described magnetic induction coil 5 and that has a resonance frequency equal to the first position-calculating frequency f<sub>0</sub>. The magnetic induction coil 5 produces an induced magnetic field in response to an alternating magnetic field from outside.<!-- EPO <DP n="25"> --></p><p id="p0050" num="0050">The above-described position detection apparatus 6 is disposed outside the body of a subject into which the endoscope apparatus 2 and the capsule medical device 3 are inserted. The position detection apparatus 6 includes a magnetic-field detection section 13 that detects magnetic fields produced from the marker coil 4 and the magnetic induction coil 5 and a position-calculating section 14 that calculates the positions and the orientations of the endoscope apparatus 2 and the capsule medical device 3 based on the magnetic fields detected by the magnetic-field detection section 13.</p><p id="p0051" num="0051">The above-described magnetic-field detection section 13 includes a plurality of sense coils 13a and a receiving circuit 13b that receives an output signal from each of the sense coils 13a.</p><p id="p0052" num="0052">The sense coils 13a are each an air-core coil and are arranged in a square composed of one set of nine coils so as to face a working space of the tip of the inserting section 2a of the endoscope apparatus 2 and the capsule medical device 3.</p><p id="p0053" num="0053">The receiving circuit 13b includes low-pass filters (LPFs) 15 that remove high-frequency components of AC voltages having information about the position of the endoscope<!-- EPO <DP n="26"> --> apparatus 2, amplifiers (AMPs) 16 that amplify the AC voltages from which high-frequency components have been removed, band-pass filters (BPFs) 17 that transmit only predetermined frequency ranges of the amplified AC voltages, and A/D converters 18 that convert the AC voltages that have passed through the band-pass filters 17 into digital signals. As a result, the magnetic fields detected in the magnetic-field detection section 13 are output as magnetic-field signals composed of digital signals.</p><p id="p0054" num="0054">The above-described position-calculating section 14 includes a first memory 19 that stores the magnetic-field signals output from the receiving circuit 13b of the magnetic-field detection section 13, an FFT-processing circuit 20 that applies frequency analysis processing to the magnetic-field signals, an extracting section 21 that extracts predetermined magnetic-field information from a result of frequency analysis processing of the magnetic-field signals, a position/orientation analyzing section 22 that calculates the positions and the orientations of the endoscope apparatus 2 and the capsule medical device 3 based on the extracted magnetic-field information, and a second memory 23 that stores the calculated positions and orientations of the endoscope apparatus 2 and the capsule medical device 3.</p><p id="p0055" num="0055"><!-- EPO <DP n="27"> --> The above-described extracting section 21 includes a frequency-selecting section 24 that receives from the control section 7 the first position-calculating frequency f<sub>0</sub>, which is a frequency component of the signal produced by the marker-driving circuit 9, and that extracts magnetic-field information having the first position-calculating frequency f<sub>0</sub> from among the magnetic-field information obtained by frequency analysis of the magnetic-field signals, as well as a third memory 25 that stores the magnetic-field information at the first position-calculating frequency f<sub>0</sub> extracted by the frequency-selecting section 24.</p><p id="p0056" num="0056">The phrase "magnetic-field information at the first position-calculating frequency f<sub>0</sub>" refers to the absolute value, the real part (first detection-magnetic-field component), and the imaginary part (second detection-magnetic-field component) of the magnetic field at the first position-calculating frequency f<sub>0</sub>. The real part is a magnetic-field component that has the first position-calculating frequency f<sub>0</sub> and the same phase as that of the above-described first alternating magnetic field. The imaginary part is a magnetic-field component that has the first position-calculating frequency f<sub>0</sub> and has a phase shifted by π/2 relative to the phase of the first alternating magnetic field.</p><p id="p0057" num="0057"><!-- EPO <DP n="28"> --> From the magnetic-field information stored in the third memory 25, the above-described position/orientation analyzing section 22 calculates the position and the orientation of the capsule medical device 3 based on the imaginary parts of the magnetic fields detected by all the sense coils 13a and calculates the position and the orientation of the tip of the endoscope apparatus 2 based on the real parts and calibration values of the magnetic fields detected by all the sense coils 13a.</p><p id="p0058" num="0058">The above-described control section 7 includes an input device 26 used for various input operations, a waveform-data generator 27 that calculates a magnetic-field waveform to be produced from the marker coil 4 based on the resonance frequency of the magnetic induction coil 5 input by the relevant input device 26, and a control circuit 28 that transfers the input resonance frequency to the waveform-data generator 27. The control section 7 further includes a clock 29 that produces a predetermined clock signal, a read-out-timing generator 30 that instructs the FFT-processing circuit 20 of the position-calculating section 14 on the read-out timing of the magnetic-field signals used for frequency analysis based on the clock signal, and a trigger generator 31 that produces a trigger signal based on the clock signal.</p><p id="p0059" num="0059"><!-- EPO <DP n="29"> --> The control circuit 28 instructs the trigger generator 31 to produce a trigger signal for the read-out-timing generator 30 and the marker-driving circuit 9. In addition, the above-described waveform-data generator 27 transfers the generated magnetic-field waveform to the waveform data memory 10 of the marker-driving circuit 9.</p><p id="p0060" num="0060">A method for detecting the positions of the tip of the endoscope apparatus 2 and the capsule medical device 3 using the position detection system 1 according to this embodiment with the above-described structure will be described below.</p><p id="p0061" num="0061">In order to detect the positions and the orientations of the tip of the endoscope apparatus 2 and the capsule medical device 3 using the position detection system 1 according to this embodiment, the positions and the orientations of the marker coil 4 at the tip of the endoscope apparatus 2 and of the magnetic induction coil 5 in the capsule medical device 3 are detected.</p><p id="p0062" num="0062">First, the magnetic-field waveform is produced from the marker coil 4 and is stored in the waveform data memory 10 of the marker-driving circuit 9. Next, each of the sense coils 13a is subjected to calibration, a calibration value is acquired, and read-out timing is set. Then, based on the acquired calibration values and the set read-out timing,<!-- EPO <DP n="30"> --> actual measurement for calculating the positions and the orientations of the marker coil 4 and the magnetic induction coil 5 is carried out.</p><p id="p0063" num="0063">As shown in <figref idrefs="f0003">Fig. 3</figref>, generation of a magnetic-field waveform is started by inputting the resonance frequency of the magnetic induction coil 5 from the input device 26 (step S1) and causing the control circuit 28 to transfer the input resonance frequency to the waveform-data generator 27 (step S2). In the waveform-data generator 27, the magnetic-field waveform produced from the marker coil 4 is calculated based on the sent resonance frequency of the magnetic induction coil 5 (step S3), and the calculated waveform data is stored in the waveform data memory 10 of the marker-driving circuit 9 (step S4).</p><p id="p0064" num="0064">As shown in <figref idrefs="f0004">Figs. 4</figref> and <figref idrefs="f0005">5</figref>, calibration is started when a calibration command is input from the input device 26 while the tip of the inserting section 2a of the endoscope apparatus 2 is in the body cavity and the capsule medical device 3 is not in the body cavity (step S11). The control circuit 28 instructs the trigger generator 31 to produce a trigger signal for the marker-driving circuit 9 and the read-out-timing generator 30. As a result, a trigger signal is issued from the trigger generator 31 (step S12).<!-- EPO <DP n="31"> --></p><p id="p0065" num="0065">The marker-driving circuit 9 that has received the trigger signal sequentially generates magnetic-field-generation driving signals in synchronization with the clock signal from the clock 29 based on the waveform data stored in the waveform data memory 10 and outputs them to the marker coil 4. The marker coil 4 produces the first alternating magnetic field based on the input magnetic-field-generation driving signals (step S13).</p><p id="p0066" num="0066">The receiving circuit 13b receives a magnetic-field signal associated with the first alternating magnetic field from the marker coil 4 detected by each of the sense coils 13a; performs low-pass filtering with a low-pass filter 15, amplification with an amplifier 16, and band-pass filtering with a band-pass filter 17; and then performs A/D conversion in synchronization with the clock signal (step S14).</p><p id="p0067" num="0067">The magnetic-field signal that has been subjected to A/D conversion is stored in the first memory 19 of the position-calculating section 14 (step S15). Thereafter, it is determined whether or not a number of items of data required to perform frequency analysis processing are accumulated in the first memory 19, and if the required number of items of data are accumulated, frequency analysis processing is<!-- EPO <DP n="32"> --> performed by the FFT-processing circuit 20 (step S16).</p><p id="p0068" num="0068">Based on the result of frequency analysis processing, the frequency-selecting section 24 extracts only the magnetic-field information at the first position-calculating frequency f<sub>0</sub>, which is the frequency of the first alternating magnetic field produced from the marker coil 4, and stores it in the third memory 25 (step S17).</p><p id="p0069" num="0069">The control circuit 28 reads out the magnetic-field information stored in the third memory 25 and stores the value of the imaginary part in an internal memory (not shown in the figure) (step S18).</p><p id="p0070" num="0070">Then, the control circuit 28 sends to the read-out-timing generator 30 a command for delaying by one clock the read-out timing to be generated in the read-out-timing generator 30 (step S19).</p><p id="p0071" num="0071">Thereafter, while repeating steps S12 to S19, the control circuit 28 compares the imaginary part of the magnetic-field information stored in the third memory 25 with the imaginary part stored in the internal memory. The control circuit 28 sets, in the read-out-timing generator 30, the read-out timing that causes the value of the imaginary part in the result of the frequency analysis processing stored at step S18 to become closest to zero as the read-out timing used for<!-- EPO <DP n="33"> --> actual measurement (step S20).</p><p id="p0072" num="0072">Measurement of a calibration value is carried out while the read-out timing that causes the value of the imaginary part in the result of the frequency analysis processing to become closest to zero is set in the read-out-timing generator 30, as described above.</p><p id="p0073" num="0073">More specifically, the control circuit 28 instructs the trigger generator 31 to produce a trigger signal for the marker-driving circuit 9 and the read-out-timing generator 30 (step S21). Then, based on the waveform data stored in the waveform data memory 10, the marker-driving circuit 9 sequentially produces magnetic-field-generation driving signals in synchronization with the clock signal and outputs them to the marker coil 4. The marker coil 4 produces the first alternating magnetic field based on the input magnetic-field-generation driving signals (step S22).</p><p id="p0074" num="0074">Next, the receiving circuit 13b applies low-pass filtering, amplification, and band-pass filtering to the magnetic-field signals from the marker coil 4 received by all the sense coils 13a and performs A/D conversion in synchronization with the clock signal (step S23). The magnetic-field signals that have been subjected to A/D conversion are accumulated in the first memory 19 of the<!-- EPO <DP n="34"> --> position-calculating section 14 (step S24).</p><p id="p0075" num="0075">Thereafter, the FFT-processing circuit 20 reads out the magnetic-field signals detected by all the sense coils 13a from the first memory 19 with the above-described read-out timing and performs frequency analysis processing (step S25). The frequency-selecting section 24 extracts the real part value, the imaginary part value, and the absolute value of the magnetic-field intensity at the first position-calculating frequency f<sub>0</sub> from the magnetic-field information obtained as a result of the frequency analysis processing (step S26) and stores the extracted values in the third memory 25 as calibration values corresponding to the respective sense coils 13a (step S27). This completes calibration processing, followed by actual measurement.</p><p id="p0076" num="0076">As shown in <figref idrefs="f0006 f0007 f0008">Figs. 6 to 8</figref>, actual measurement starts when a command for starting actual measurement is entered on the input device 26 (step S32) with the endoscope apparatus 2 and the capsule medical device 3 being disposed in the body cavity (step S31). The control circuit 28 instructs the trigger generator 31 to produce a trigger signal for the marker-driving circuit 9 and the read-out-timing generator 30, and the trigger generator 31 produces a trigger signal (step S33).<!-- EPO <DP n="35"> --></p><p id="p0077" num="0077">The marker-driving circuit 9 sequentially generates magnetic-field-generation driving signals in synchronization with the clock signal based on the waveform data stored in the waveform data memory 10 and outputs them to the marker coil 4. The marker coil 4 produces the first alternating magnetic field based on the input magnetic-field-generation driving signals (step S34).</p><p id="p0078" num="0078">The receiving circuit 13b applies low-pass filtering with a low-pass filter 15, amplification with an amplifier 16, and band-pass filtering with a band-pass filter 17 to a magnetic-field signal associated with the first alternating magnetic field from the marker coil 4 detected by each of the sense coils 13a and then performs A/D conversion in synchronization with the clock signal (step S35).</p><p id="p0079" num="0079">The magnetic-field signal that has been subjected to A/D conversion is stored in the first memory 19 of the position-calculating section 14 (step S36). Then, it is determined whether or not a number of items of data required to perform frequency analysis processing are accumulated in the first memory 19, and if the required number of items of data are accumulated, frequency analysis processing is performed by the FFT-processing circuit 20 (step S37). Thereafter, it is<!-- EPO <DP n="36"> --> determined whether or not this frequency analysis processing has been applied to the data from all the sense coils 13a (step S38), and if data from all sense coils 13a have not been processed, steps S32 to S37 are repeated.</p><p id="p0080" num="0080">When the data from all the sense coils 13a have been subjected to frequency analysis processing, the frequency-selecting section 24 extracts, based on the result of processing, only the magnetic-field information at the frequency of the first alternating magnetic field produced from the marker coil 4 and stores it in the third memory 25, as shown in <figref idrefs="f0007">Fig. 7</figref> (step S39). This processing is applied to the magnetic-field signals from all the sense coils 13a (step S40).</p><p id="p0081" num="0081">From among the magnetic-field information stored in the third memory 25, the position/orientation analyzing section 22 reads out the imaginary part in the result of frequency analysis processing from the third memory 25 (step S41) and, based on the imaginary part, calculates the position and the orientation of the magnetic induction coil 5 via repeated arithmetic operations (step S42). Because the imaginary part in the result of frequency analysis processing includes only the magnetic-field signal (the second detection-magnetic-field component) of the induced magnetic field produced in the<!-- EPO <DP n="37"> --> magnetic induction coil 5, i.e., the magnetic-field signal having the first position-calculating frequency f<sub>0</sub>, which is the same as that of the first alternating magnetic field produced by the marker coil 4, and having a phase shifted by n/2 relative to the phase of the first alternating magnetic field, the position and the orientation of the magnetic induction coil 5 can be calculated with high accuracy by extracting and using this imaginary part.</p><p id="p0082" num="0082">The calculated position and orientation of the magnetic induction coil 5 are sent to the control circuit 28, displayed on the display device 8 (step S43), and stored in the second memory 23 (step S44).</p><p id="p0083" num="0083">Furthermore, the position/orientation analyzing section 22 reads out the real parts in the results of frequency analysis processing of the magnetic-field signals from all the sense coils 13a, as well as the stored calibration values (steps S45 and S46), and calculates the difference values, as shown in <figref idrefs="f0008">Fig. 8</figref> (step S47). Then, based on the calculated difference values, the position and the orientation of the marker coil 4 are calculated via repeated arithmetic operations (step S48).</p><p id="p0084" num="0084">Because the real part in the result of frequency analysis processing includes only the magnetic-field signal<!-- EPO <DP n="38"> --> (the first detection-magnetic-field component) having the first position-calculating frequency f<sub>0</sub>, which is the same as that of the first alternating magnetic field produced by the marker coil 4, and having the same phase as that of the first alternating magnetic field, the position and the orientation of the marker coil 4 can be calculated with high accuracy by extracting and using this real part, without being affected by the capsule medical device 3, even if the capsule medical device 3 is present within a range of detection of the sense coils 13a.</p><p id="p0085" num="0085">Furthermore, because the position and the orientation of the marker coil 4 are calculated based on the differences obtained by subtracting the calibration values from the real parts in the results of the frequency analysis processing, the influence of magnetic fields originating from other than the capsule medical device 3 can be eliminated, thereby making it possible to calculate the position and the orientation of the marker coil 4 with even higher accuracy.</p><p id="p0086" num="0086">The calculated position and orientation of the marker coil 4 are sent to the control circuit 28, displayed on the display device 8 (step S49), and stored in the second memory 23 (step S50).</p><p id="p0087" num="0087">Then, it is checked whether or not a command for<!-- EPO <DP n="39"> --> terminating position detection has been input on the input device 26 (step S51), and if a command has been input, generation of a trigger signal from the trigger generator 31 is terminated to stop the operation of the position detection system 1 (step S52). On the other hand, if no termination command has been input, the flow returns to step S33 to continue position detection.</p><p id="p0088" num="0088">In this case, for the initial values for repeated arithmetic operations of the positions and orientations of the magnetic induction coil 5 and the marker coil 4, the calculation results of the positions and the orientations of the magnetic induction coil 5 and the marker coil 4 that have previously been calculated and stored in the second memory 23 are used. By doing so, the convergence time of repeated arithmetic operations can be reduced to calculate the positions and the orientations in a shorter period of time.</p><p id="p0089" num="0089">In this manner, according to the position detection system 1 of this embodiment and a position detection method using the system 1, the signal from the marker coil 4 and the signal from the magnetic induction coil 5 can be completely separated from each other based on position information of both the signals. Consequently, the positions and orientations of the marker coil 4 and the magnetic induction<!-- EPO <DP n="40"> --> coil 5, namely, the positions and orientations of the tip of the inserting section 2a of the endoscope apparatus 2 and the capsule medical device 3 disposed in the body cavity, can be obtained accurately.</p><heading id="h0008">[Second embodiment]</heading><p id="p0090" num="0090">A position detection system 40 according to a second embodiment of the present invention will now be described with reference to <figref idrefs="f0009 f0010 f0011 f0012 f0013 f0014 f0015 f0016 f0017">Figs. 9 to 17</figref>.</p><p id="p0091" num="0091">In the description of this embodiment, the same components as those of the position detection system 1 according to the first embodiment are denoted by the same reference numerals, and thus an explanation thereof will be omitted.</p><p id="p0092" num="0092">As shown in <figref idrefs="f0009">Fig. 9</figref>, the position detection system 40 according to this embodiment is provided in a medical-device guidance system 100. The medical-device guidance system 100 includes the endoscope apparatus 2 and the capsule medical device 3 that are introduced, per oral or per anus, into the body cavity of a subject; the position detection system 40; a magnetic induction apparatus 101 that guides the capsule medical device 3 based on the detected position and the orientation and an operator instruction; and an image display<!-- EPO <DP n="41"> --> device 102 that displays an image signal transmitted from the capsule medical device 3.</p><p id="p0093" num="0093">As shown in <figref idrefs="f0009">Fig. 9</figref>, the magnetic induction apparatus 101 includes a three-axis Helmholtz coil unit (propulsion-magnetic-field generating unit) 71 that produces parallel external magnetic fields (rotating magnetic fields) for driving the capsule medical device 3; a Helmholtz-coil driver 72 that amplifies and controls an electrical current to be supplied to the three-axis Helmholtz coil unit 71; a magnetic field control circuit (propulsion-magnetic-field control section) 73 that controls the directions of the external magnetic fields for driving the capsule medical device 3; and an input device 74 that outputs to the magnetic field control circuit 73 the direction of movement of the capsule medical device 3 input by the operator.</p><p id="p0094" num="0094">Although the term "three-axis Helmholtz coil unit 71" is used in this embodiment, it is not necessary that Helmholtz-coil conditions be strictly satisfied. For example, the coils need not be circular but may be substantially rectangular, as shown in <figref idrefs="f0009">Fig. 9</figref>. Furthermore, the gaps between opposing coils do not need to satisfy Helmholtz-coil conditions, as long as the function of this embodiment is achieved.</p><p id="p0095" num="0095"><!-- EPO <DP n="42"> --> As shown in <figref idrefs="f0009">Fig. 9</figref>, the three-axis Helmholtz coil unit 71 is formed in a substantially rectangular shape. In addition, the three-axis Helmholtz coil unit 71 includes three-pairs of mutually opposing Helmholtz coils (electromagnets) 71X, 71Y, and 71Z, and each pair of Helmholtz coils 71X, 71Y, and 71Z is disposed so as to be substantially orthogonal to the X, Y, and Z axes in <figref idrefs="f0009">Fig. 9</figref>. The Helmholtz coils disposed substantially orthogonally with respect to the X, Y, and Z axes are denoted as the Helmholtz coils 71X, 71Y, and 71Z, respectively.</p><p id="p0096" num="0096">Furthermore, the Helmholtz coils 71X, 71Y, and 71Z are disposed so as to form a substantially rectangular space S in the interior thereof. As shown in <figref idrefs="f0009">Fig. 9</figref>, the space S serves as a working space (also referred to as the working space S) of the capsule medical device 3 and is the space in which the subject is placed.</p><p id="p0097" num="0097">The Helmholtz-coil driver 72 includes Helmholtz-coil drivers 72X, 72Y, and 72Z for controlling the Helmholtz coils 71X, 71Y, and 71Z, respectively.</p><p id="p0098" num="0098">The magnetic field control circuit 73 receives from the position detection system 40 (described later) data representing the current orientation of the capsule medical device 3 (the direction along the longitudinal axis R of the<!-- EPO <DP n="43"> --> capsule medical device 3), as well as a direction-of-movement command for the capsule medical device 3 input by the operator on the input device 74. Then, signals for controlling the Helmholtz-coil drivers 72X, 72Y, and 72Z are output from the magnetic field control circuit 73, rotational phase data of the capsule medical device 3 is output to an image display device 102, and electrical current data to be supplied to each of the Helmholtz-coil drivers 72X, 72Y, and 72Z is output.</p><p id="p0099" num="0099">Furthermore, for example, a joystick (not shown in the figure) is provided as the input device 74, so that the movement direction of the capsule medical device 3 can be specified by operating the joystick.</p><p id="p0100" num="0100">As mentioned above, for the input device 74, a joystick-type device may be used, or another type of input device may be used, such as an input device that specifies the direction of movement by pushing direction-of-movement buttons.</p><p id="p0101" num="0101">As shown in <figref idrefs="f0010">Fig. 10</figref>, the capsule medical device 3 includes an outer casing 110 accommodating various types of devices therein; an imaging section 120 that acquires an image of the internal surface of a passage in the body cavity of a subject I; a battery 130 that powers the imaging section 120; an induced-magnetic-field generating unit 140 that produces an alternating magnetic field with a magnetic-field generating<!-- EPO <DP n="44"> --> device 41 (described later); and a permanent magnet (magnetic-field acting section) 150 that drives the capsule medical device 3 in response to the external magnetic field produced by a magnetic induction apparatus 70.</p><p id="p0102" num="0102">The outer casing 110 includes an infrared-transmitting cylindrical capsule main body (hereinafter, referred to simply as the "main body") 111 whose central axis is defined by the longitudinal axis R of the capsule medical device 3; a transparent, hemispherical front end portion 112 covering the front end of the main body 111; and a hemispherical rear end portion 113 covering the rear end of the main body, to form a sealed capsule container with a watertight construction.</p><p id="p0103" num="0103">A helical part 114 made of a wire having a circular cross-section is helically wound about the longitudinal axis R over the outer circumferential surface of the main body 111 of the outer casing 110.</p><p id="p0104" num="0104">When the permanent magnet 150 is rotated in response to the rotating external magnetic field produced by the magnetic induction apparatus 70, the helical part 114 is rotated about the longitudinal axis R along with the main body 111. As a result, the rotational motion about the longitudinal axis R of the main body 111 is transformed into a linear motion in the direction along the longitudinal axis R by means of the<!-- EPO <DP n="45"> --> helical part 114, thereby making it possible to guide the capsule medical device 3 in the direction along the longitudinal axis R in the body passage.</p><p id="p0105" num="0105">The imaging section 120 includes a board 120A disposed substantially orthogonal to the longitudinal axis R; an image sensor 121 disposed on the surface of the board 120A adjacent to the front end portion 112; a lens group 122 that focuses an image of an internal surface of a passage in the body cavity of the subject at the image sensor 121; an LED (light emitting diode) 123 that emits light onto the internal surface of the passage in the body cavity; a signal processing unit 124 disposed on the surface of the board 120A adjacent to the rear end portion 113; and a radio device 125 that transmits an image signal to the image display device 102.</p><p id="p0106" num="0106">The signal processing unit 124 is electrically connected to the battery 130, the image sensor 121, and the LED 123. Also, the signal processing unit 124 compresses the image signal acquired by the image sensor 121, temporarily stores it (memory), and transmits the compressed image signal to the exterior from the radio device 125, and in addition, it controls the on/off state of the image sensor 121 and the LED 123 based on signals from a switch unit 126 to be described later.<!-- EPO <DP n="46"> --></p><p id="p0107" num="0107">The image sensor 121 converts the image formed via the front end portion 112 and the lens group 122 into an electrical signal (image signal) and outputs it to the signal processing unit 124. A CMOS (Complementary Metal Oxide Semiconductor) device or a CCD, for example, can be used as this image sensor 121.</p><p id="p0108" num="0108">Moreover, a plurality of the LEDs 123 is disposed on a support member 128 positioned towards the front end portion 112 from the board 120A such that gaps are provided therebetween in the circumferential direction around the longitudinal axis R.</p><p id="p0109" num="0109">The image display device 102 includes an image receiving circuit 81 that receives image data sent from the capsule medical device 3 and the display device 8 that displays the received image data.</p><p id="p0110" num="0110">The permanent magnet 150 is disposed towards the rear end portion 113 from the signal processing unit 124. The permanent magnet 150 is disposed or polarized so as to have a magnetization direction (magnetic pole) in a direction orthogonal to the longitudinal axis R.</p><p id="p0111" num="0111">The switch unit 126 is disposed at the side, adjacent to the rear end portion 113, of the permanent magnet 150. The switch unit 126 includes an infrared sensor 127 and is<!-- EPO <DP n="47"> --> electrically connected to the signal processing unit 124 and the battery 130.</p><p id="p0112" num="0112">Also, a plurality of the switch units 126 are disposed in the circumferential direction about the longitudinal axis R at regular intervals, and the infrared sensor 127 is disposed so as to face the outside in the diameter direction. In this embodiment, an example has been described in which four switch units 126 are disposed, but the number of switch units 126 is not limited to four; any number may be provided.</p><p id="p0113" num="0113">The induced-magnetic-field generating unit 140, which is disposed at the side adjacent to the rear end portion 113 of the radio device 125, is composed of a core member (magnetic core) 141 made of ferrite formed in the shape of a cylinder whose central axis is substantially aligned with the longitudinal axis R, the magnetic induction coil 5 disposed at the outer circumferential part of the core member 141, and a capacitor (not shown in the figure) that is electrically connected to the magnetic induction coil 5 and that constitutes the resonance circuit.</p><p id="p0114" num="0114">In addition to ferrite, magnetic materials are suitable for the core member 141; iron, nickel, permalloy, cobalt or the like may be used for the core member.</p><p id="p0115" num="0115"><!-- EPO <DP n="48"> --> As shown in <figref idrefs="f0009 f0010 f0011 f0012">Figs. 9 to 12</figref>, the position detection system 40 according to this embodiment differs from the position detection system 1 according to the above-described first embodiment in that the position detection system 40 includes the magnetic-field generating device 41 that is disposed outside a working region of the magnetic induction coil 5 and that produces a second alternating magnetic field having the above-described first position-calculating frequency f<sub>0</sub> and having the same phase as that of the above-described first alternating magnetic field, as well as a magnetic-field-generating-device driving circuit 42. The system 40 also differs from the system 1 in arithmetic operations in the position/orientation analyzing section 22. In <figref idrefs="f0012">Fig. 12</figref>, reference numeral 43 denotes a waveform data memory, reference numeral 44 denotes a D/A converter, reference numeral 45 denotes an amplifier, reference numeral 55 denotes a selector that selects the magnetic-field generating device 41, and reference numeral 56 denotes a sense-coil selector that selects the sense coils 13a.</p><p id="p0116" num="0116"><figref idrefs="f0011">Figs. 11</figref> and <figref idrefs="f0012">12</figref> depict a simplified structure of the position detection system 40 according to this embodiment.</p><p id="p0117" num="0117">In order to detect the positions and the orientations of the marker coil 4 at the tip of the endoscope apparatus 2 and the magnetic induction coil 5 in the capsule medical device 3<!-- EPO <DP n="49"> --> by using the position detection system 40 according to this embodiment, waveform data of the produced first and second alternating magnetic fields is generated in the same manner as in the first embodiment and is stored in the waveform data memories 10 and 43, and then calibration is carried out with the capsule medical device 3 being disposed outside the working region.</p><p id="p0118" num="0118">Because not only is the first alternating magnetic field produced from the marker coil 4 but also the second alternating magnetic field is produced from the magnetic-field generating device 41, the generated items of magnetic field waveform data are transferred to the waveform data memories 10 and 43 of the marker-driving circuit 9 and the magnetic-field-generating-device driving circuit 42, respectively. The first and second alternating magnetic fields produced from the marker coil 4 and the magnetic-field generating device 41 correspond in terms of the first position-calculating frequency f<sub>0</sub>, which is the resonance frequency of the magnetic induction coil 5, and have the same phase.</p><p id="p0119" num="0119">As shown in <figref idrefs="f0013">Figs. 13</figref> and <figref idrefs="f0014">14</figref>, calibration starts when a calibration command is input from the input device 26 while the tip of the inserting section 2a of the endoscope apparatus 2 is disposed in the body cavity and the capsule medical<!-- EPO <DP n="50"> --> device 3 is not disposed in the body cavity (step S41'). The control circuit 28 instructs the trigger-signal generator 31 to produce a trigger signal for the magnetic-field-generating-device driving circuit 42 and the read-out-timing generator 30. By doing so, a trigger signal is issued from the trigger-signal generator 31 (step S42').</p><p id="p0120" num="0120">Based on the waveform data stored in the waveform data memory 43, the magnetic-field-generating-device driving circuit 42 that has received the trigger signal sequentially generates magnetic-field-generation driving signals in synchronization with the clock signal from the clock 29 and outputs them to the magnetic-field generating device 41. The magnetic-field generating device 41 produces the second alternating magnetic field based on the input magnetic-field-generation driving signals (step S43').</p><p id="p0121" num="0121">The receiving circuit 13b receives a magnetic-field signal associated with the second alternating magnetic field from the magnetic-field generating device 41 detected by each of the sense coils 13a; performs low-pass filtering, amplification, and band-pass filtering; and then performs A/D conversion in synchronization with the clock signal (step S44').</p><p id="p0122" num="0122"><!-- EPO <DP n="51"> --> The magnetic-field signal that has been subjected to A/D conversion is stored in the first memory 19 of the position-calculating section 14 (step S45'). Thereafter, it is determined whether or not a number of items of data required to perform frequency analysis processing are accumulated in the first memory 19, and if the required number of items of data are accumulated, frequency analysis processing is performed by the FFT-processing circuit 20 (step S46').</p><p id="p0123" num="0123">Based on the result of frequency analysis processing, the frequency-selecting section 24 extracts only the magnetic-field information at the first position-calculating frequency f<sub>0</sub>, which is the frequency of the second alternating magnetic field produced from the magnetic-field generating device 41, and stores it in the third memory 25 (step S47').</p><p id="p0124" num="0124">The control circuit 28 reads out the magnetic-field information stored in the third memory 25 and stores the value of the imaginary part (step S48').</p><p id="p0125" num="0125">Then, the control circuit 28 sends to the read-out-timing generator 30 a command for delaying by one clock the read-out timing to be generated in the read-out-timing generator 30 (step S49').</p><p id="p0126" num="0126">Thereafter, steps S42 to S49 are repeated, and the read-out timing that causes the value of the imaginary part in the<!-- EPO <DP n="52"> --> result of frequency analysis processing stored at step S48 to become closest to zero is set in the read-out-timing generator 30 as read-out timing used for actual measurement (step S50').</p><p id="p0127" num="0127">Measurement of a calibration value is carried out while the read-out timing that causes the value of the imaginary part in the result of frequency analysis processing to become closest to zero is set in the read-out-timing generator 30 as described above.</p><p id="p0128" num="0128">More specifically, the control circuit 28 instructs the trigger generator 31 to produce a trigger signal for the magnetic-field-generating-device driving circuit 42 and the read-out-timing generator 30 (step S51), and based on the waveform data stored in the waveform data memory 43, the magnetic-field-generating-device driving circuit 42 sequentially produces magnetic-field-generation driving signals in synchronization with the clock signal and outputs them to the magnetic-field generating device 41. The magnetic-field generating device 41 produces the second alternating magnetic field based on the input magnetic-field-generation driving signals (step S52).</p><p id="p0129" num="0129">Next, the receiving circuit 13b applies low-pass filtering, amplification, and band-pass filtering to the magnetic-field signals from the magnetic-field generating<!-- EPO <DP n="53"> --> device 41 received by all the sense coils 13a and performs A/D conversion in synchronization with the clock signal (step S53'). The magnetic-field signals that have been subjected to A/D conversion are accumulated in the first memory 19 of the position-calculating section 14 (step S54).</p><p id="p0130" num="0130">Then, the magnetic-field signals detected by all the sense coils 13a are read out from the first memory 19 with the above-described read-out timing and are subjected to frequency analysis processing (step S55'). The real part value, the imaginary part value, and the absolute value of the magnetic-field intensity at the first position-calculating frequency f<sub>0</sub> are extracted from the magnetic-field information obtained as a result of frequency analysis processing (step S56'), and the extracted values are stored as calibration values corresponding to the respective sense coils 13a (step S57'). This completes calibration processing, followed by actual measurement.</p><p id="p0131" num="0131">Next, actual measurement starts when a command for starting actual measurement is entered on the input device 26 (step S62) with the endoscope apparatus 2 and the capsule medical device 3 being disposed in the body cavity (step S61).</p><p id="p0132" num="0132">The control circuit 28 instructs the trigger generator 31 to produce a trigger signal for the marker-driving circuit<!-- EPO <DP n="54"> --> 9, the magnetic-field-generating-device driving circuit 42, and the read-out-timing generator 30, and the trigger generator 31 produces a trigger signal (step S63).</p><p id="p0133" num="0133">The marker-driving circuit 9 sequentially generates magnetic-field-generation driving signals in synchronization with the clock signal based on the waveform data stored in the waveform data memory 10 and outputs them to the marker coil 4. The marker coil 4 produces the first alternating magnetic field based on the input magnetic-field-generation driving signals (step S64).</p><p id="p0134" num="0134">Furthermore, based on the waveform data stored in the waveform data memory 43, the magnetic-field-generating-device driving circuit 42 sequentially generates magnetic-field-generation driving signals in synchronization with the clock signal and outputs them to the magnetic-field generating device 41. The magnetic-field generating device 41 produces the second alternating magnetic field based on the input magnetic-field-generation driving signals (step S65).</p><p id="p0135" num="0135">The receiving circuit 13b applies low-pass filtering, amplification, and band-pass filtering to a magnetic-field signal associated with the first alternating magnetic field from the marker coil 4 and to a magnetic-field signal associated with the second alternating magnetic field from the<!-- EPO <DP n="55"> --> magnetic-field generating device 41, i.e., the magnetic-field signals detected by each of the sense coils 13a, and then performs A/D conversion in synchronization with the clock signal (step S66).</p><p id="p0136" num="0136">The magnetic-field signals that have been subjected to A/D conversion are stored in the first memory 19 of the position-calculating section 14 (step S67). Then, it is determined whether or not a number of items of data required to perform frequency analysis processing are accumulated in the first memory 19, and if the required number of items of data are accumulated, frequency analysis processing is performed by the FFT-processing circuit 20 (step S68). Thereafter, it is determined whether or not the data from all the sense coils 13a have been subjected to this frequency analysis processing (step S69). If data from all sense coils 13a have not been processed, steps S63 to S68 are repeated.</p><p id="p0137" num="0137">When the data from all the sense coils 13a have been subjected to frequency analysis processing, the frequency-selecting section 24 extracts, based on the result of processing, only the magnetic-field information at the frequency of the first alternating magnetic field produced from the marker coil 4 and the magnetic-field information at the frequency of the second alternating magnetic field<!-- EPO <DP n="56"> --> produced from the magnetic-field generating device 41, as shown in <figref idrefs="f0016">Fig. 16</figref>, and stores it in the third memory 25 (step S70). This processing is applied to the magnetic-field signals from all the sense coils 13a (step S71).</p><p id="p0138" num="0138">From among the magnetic-field information stored in the third memory 25, the position/orientation analyzing section 22 first reads out the imaginary part in the result of frequency analysis processing from the third memory 25 (step S72) and, based on the imaginary part, calculates the position and the orientation of the magnetic induction coil 5 via repeated arithmetic operations (step S73). Because the imaginary part in the result of frequency analysis processing includes only the magnetic-field signal (the second detection-magnetic-field component) of the induced magnetic field produced in the magnetic induction coil 5, i.e., the magnetic-field signal having the first position-calculating frequency f<sub>0</sub>, which is the same as that of the first and second alternating magnetic fields produced by the marker coil 4, and having a phase shifted by n/2 relative to the phase of the first and second alternating magnetic fields, the position and the orientation of the magnetic induction coil 5 can be calculated with high accuracy by extracting and using this imaginary part.</p><p id="p0139" num="0139">The calculated position and orientation of the magnetic induction coil 5 are sent to the control circuit 28, displayed<!-- EPO <DP n="57"> --> on the display device 8 (step S74), and stored in the second memory 23 (step S75).</p><p id="p0140" num="0140">Furthermore, the position/orientation analyzing section 22 reads out the real parts in the results of frequency analysis processing of the magnetic-field signals from all the sense coils 13a, as well as the real part (stored as a calibration value) in the result of frequency analysis processing of the magnetic-field signal from each of the sense coils 13a while only the second alternating magnetic field from the magnetic-field generating device 41 is present (steps S76 and S77), to calculate the difference value (step S78). Then, based on the calculated difference values, the position and the orientation of the marker coil 4 are calculated via repeated arithmetic operations (step S79).</p><p id="p0141" num="0141">Because the real part in the result of frequency analysis processing includes only the magnetic-field signal (the first detection-magnetic-field component) having the first position-calculating frequency f<sub>0</sub>, which is the same as that of the first and second alternating magnetic fields, and having the same phase as that of the first alternating magnetic field, the position and the orientation of the marker coil 4 can be calculated with high accuracy by extracting and using this real part, without being affected by the magnetic<!-- EPO <DP n="58"> --> induction coil 5 of the capsule medical device 3, even if the capsule medical device 3 is present within the range of detection of the sense coils 13a.</p><p id="p0142" num="0142">In addition, because the position and the orientation of the marker coil 4 are calculated based on the difference obtained by subtracting the real part, as a calibration value, in the result of frequency analysis processing of the magnetic-field signal from each of the sense coils 13a while only the second alternating magnetic field is acting, the position and the orientation of the marker coil 4 can be calculated with even higher accuracy by disabling the magnetic field from the magnetic-field generating device 41.</p><p id="p0143" num="0143">The calculated position and orientation of the marker coil 4 are sent to the control circuit 28, displayed on the display device 8 (step S80), and stored in the second memory 23 (step S81).</p><p id="p0144" num="0144">Then, it is checked whether or not a command for terminating position detection has been input on the input device 26 (step S82), and if a command has been input, generation of a trigger signal from the trigger generator 31 is terminated to stop the operation of the position detection system 1 (step S83). On the other hand, if no termination command has been input, the flow returns to step S63 to<!-- EPO <DP n="59"> --> continue position detection.</p><p id="p0145" num="0145">In this case, for the initial values for repeated arithmetic operations of the positions and orientations of the marker coil 4 and the magnetic induction coil 5, the calculation results of the positions and the orientations of the marker coil 4 and the magnetic induction coil 5 that have previously been calculated and stored in the second memory 23 are used. By doing so, the convergence time of repeated arithmetic operations can be reduced to calculate the positions and the orientations in a shorter period of time.</p><p id="p0146" num="0146">As described above, according to the position detection system 40 of this embodiment and the position detection method using the system 40, the positions and/or the orientations of the endoscope apparatus 2 and the capsule medical device 3 can be calculated simultaneously with high accuracy, even when the endoscope apparatus 2 having the marker coil 4 that produces a magnetic field by means of external power supply and the capsule medical device 3 having the magnetic induction coil 5 coexist. In addition to the first alternating magnetic field, the second alternating magnetic field also produces an induced magnetic field from the second marker, and therefore the intensity of the induced magnetic field can be increased.<!-- EPO <DP n="60"> --></p><heading id="h0009">[Non-claimed example]</heading><p id="p0147" num="0147">A position detection system 50 according to a non-claimed example will now be described with reference to <figref idrefs="f0018 f0019 f0020 f0021 f0022 f0023 f0024">Figs. 18 to 24</figref>.</p><p id="p0148" num="0148">In the description of this example, the same components as those of the position detection system 40 according to the second embodiment are denoted by the same reference numerals, and thus an explanation thereof will be omitted.</p><p id="p0149" num="0149">As shown in <figref idrefs="f0018">Fig. 18</figref>, the position detection system 50 according to this example differs from the position detection system 40 according to the above-described second embodiment in the following points: a marker coil 52 is disposed in a first capsule medical device 51 in place of the marker coil 4 provided at the tip of the endoscope apparatus 2; a transmission section 53 that sends a signal to the relevant first capsule medical device 51 is provided; the magnetic induction coil 5 is disposed in a second capsule medical device 3'; the second alternating magnetic field produced by the magnetic-field generating device 41 has a different frequency; and arithmetic operations in the position-calculating section 14.</p><p id="p0150" num="0150"><!-- EPO <DP n="61"> --> As shown in <figref idrefs="f0019">Fig. 19</figref>, the first capsule medical device 51 includes the marker coil 52 that produces the first alternating magnetic field having the first position-calculating frequency f<sub>0</sub>, a marker-driving circuit 54 that drives the marker coil 52, a clock 55, a PLL circuit 56, a receiving section 57, and a power supply unit (not shown in the figure). The marker-driving circuit 54 produces the first alternating magnetic field in the marker coil 52 according to a command signal that is wirelessly transmitted from the transmission section 53 and is received by the receiving section 57.</p><p id="p0151" num="0151">The above-described magnetic-field generating device 41 produces the second alternating magnetic field having at least one set of second position-calculating frequencies f<sub>1</sub> and f<sub>2</sub> that are in the proximity of the resonance frequency (first position-calculating frequency f<sub>0</sub>) of the magnetic induction coil 5 in the second capsule medical device 3' and that are separated from each other by substantially the same frequency with respect to that resonance frequency f<sub>0</sub> therebetween.</p><p id="p0152" num="0152">In order to detect the positions and the orientations of the marker coil 52 in the first capsule medical device 51 and the magnetic induction coil 5 in the second capsule medical device 3' by using the position detection system 50 according<!-- EPO <DP n="62"> --> to this example, waveform data of the produced alternating magnetic field is generated and stored in the waveform data memories 10 and 43, and then calibration is performed with the second capsule medical device 3' being disposed outside the working region.</p><p id="p0153" num="0153">The generated magnetic field waveform data is transferred to the waveform data memories 10 and 43 in the marker-driving circuit 54 of the first capsule medical device 51 and in the magnetic-field-generating-device driving circuit 42, respectively.</p><p id="p0154" num="0154">Generation of the magnetic-field waveform is started by inputting the resonance frequency f<sub>0</sub> of the magnetic induction coil 5 from the input device 26 (step S101). The control circuit 28 sets the input resonance frequency f<sub>0</sub> as the first position-calculating frequency f<sub>0</sub> of the first alternating magnetic field that is produced from the marker coil 52 in the first capsule medical device 51. Furthermore, the control circuit 28 sets the set of second position-calculating frequencies f<sub>1</sub> and f<sub>2</sub> that are separated from each other by substantially the same frequency with respect to the resonance frequency f<sub>0</sub> in between as frequencies of the second alternating magnetic field produced from the magnetic-field generating device 41 (step S102).</p><p id="p0155" num="0155"><!-- EPO <DP n="63"> --> The control circuit 28 transfers the set frequencies f<sub>0</sub>, f<sub>1</sub>, and f<sub>2</sub> to the waveform-data generator 27 (step S103).</p><p id="p0156" num="0156">In the waveform-data generator 27, a magnetic-field waveform B<sub>G</sub> of the second alternating magnetic field produced from the magnetic-field generating device 41 is calculated by the expression below based on the sent second position-calculating frequencies f<sub>1</sub> and f<sub>2</sub> (step S104): <maths id="math0001" num=""><math display="block"><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">G</mi></msub><mo>=</mo><msub><mi mathvariant="normal">B</mi><mn mathvariant="normal">1</mn></msub><mo>×</mo><mi>sin</mi><mspace width="1em"/><mfenced separators=""><mn mathvariant="normal">2</mn><mo>⁢</mo><mi mathvariant="normal">π</mi><mo>⁢</mo><msub><mi mathvariant="normal">f</mi><mn mathvariant="normal">1</mn></msub><mo>⁢</mo><mi mathvariant="normal">t</mi></mfenced><mo>+</mo><msub><mi mathvariant="normal">B</mi><mn mathvariant="normal">2</mn></msub><mo>×</mo><mi>sin</mi><mspace width="1em"/><mfenced separators=""><mn mathvariant="normal">2</mn><mo>⁢</mo><mi mathvariant="normal">π</mi><mo>⁢</mo><msub><mi mathvariant="normal">f</mi><mn mathvariant="normal">2</mn></msub><mo>⁢</mo><mi mathvariant="normal">t</mi></mfenced></math><img id="ib0001" file="imgb0001.tif" wi="73" he="4" img-content="math" img-format="tif"/></maths></p><p id="p0157" num="0157">In addition, in the waveform-data generator 27, a magnetic-field waveform B<sub>m1</sub> of the first alternating magnetic field produced from the marker coil 52 is calculated by the expression below based on the sent first position-calculating frequency f<sub>0</sub>: <maths id="math0002" num=""><math display="block"><msub><mi mathvariant="normal">B</mi><mi>ml</mi></msub><mo>=</mo><msub><mi mathvariant="normal">B</mi><mn>3</mn></msub><mo>×</mo><mi>sin</mi><mspace width="1em"/><mfenced separators=""><mn mathvariant="normal">2</mn><mo>⁢</mo><mi mathvariant="normal">π</mi><mo>⁢</mo><msub><mi mathvariant="normal">f</mi><mn>0</mn></msub><mo>⁢</mo><mi mathvariant="normal">t</mi></mfenced></math><img id="ib0002" file="imgb0002.tif" wi="40" he="4" img-content="math" img-format="tif"/></maths></p><p id="p0158" num="0158">Data for the magnetic-field waveform B<sub>m1</sub> generated in the waveform-data generator 27 is stored in the waveform data memory 43 of the magnetic-field-generating-device driving circuit 42. In addition, data for the magnetic-field waveform B<sub>G</sub> is transmitted from the transmission section 53 provided in the control section 7 to the receiving section 57 provided in the first capsule medical device 51. The magnetic-field waveform data received by the receiving section 57 is stored<!-- EPO <DP n="64"> --> in the waveform data memory 10 (step S106).</p><p id="p0159" num="0159">Calibration is started by inputting a calibration command from the input device 26 while the first capsule medical device 51 is disposed in the body cavity and the second capsule medical device 3' is not disposed in the body cavity (step S111). The control circuit 28 instructs the trigger generator 31 to produce a trigger signal for the magnetic-field-generating-device driving circuit 42 and the read-out-timing generator 30. As a result, a trigger signal is issued from the trigger generator 31 (step S112).</p><p id="p0160" num="0160">The magnetic-field-generating-device driving circuit 42 that has received the trigger signal sequentially generates magnetic-field-generation driving signals in synchronization with the clock signal based on the data for the magnetic-field waveform B<sub>m1</sub> stored in the waveform data memory 43 and outputs them to the magnetic-field generating device 41. The magnetic-field generating device 41 produces the second alternating magnetic field based on the input magnetic-field-generation driving signals (step S113).</p><p id="p0161" num="0161">The receiving circuit 13b receives a magnetic-field signal associated with the second alternating magnetic field from the magnetic-field generating device 41 detected by each<!-- EPO <DP n="65"> --> of the sense coils 13a; performs low-pass filtering, amplification, and band-pass filtering; and then performs A/D conversion in synchronization with the clock signal (step S114).</p><p id="p0162" num="0162">The magnetic-field signal that has been subjected to A/D conversion is stored in the first memory 19 of the position-calculating section 14 (step S115). Thereafter, it is determined whether or not a number of items of data required to perform frequency analysis processing are accumulated in the first memory 19, and if the required number of items of data are accumulated, frequency analysis processing is performed by the FFT-processing circuit 20 (step S116).</p><p id="p0163" num="0163">Based on the result of frequency analysis processing, the frequency-selecting section 24 extracts only the magnetic-field information at the second position-calculating frequencies f<sub>1</sub> and f<sub>2</sub>, which are the frequencies of the second alternating magnetic field produced from the magnetic-field generating device 41, and stores it in the third memory 25 (step S117).</p><p id="p0164" num="0164">Let the intensities of the magnetic-field signals at the frequencies f<sub>1</sub> and f<sub>2</sub> stored here be V<sub>0</sub><sup>f1-1</sup>, v<sub>0</sub><sup>f1-2</sup>, ..., V<sub>0</sub><sup>f1-N</sup>, V<sub>0</sub><sup>f2-1</sup>, V<sub>0</sub><sup>f2-2</sup>, ..., V<sub>0</sub><sup>f2-N</sup>, where superscripts f1 and f2 represent frequency components, and the subsequent suffixes 1,<!-- EPO <DP n="66"> --> 2, ... N represent the numbers of the sense coils 13a. The magnetic-field information in this case corresponds to information about the absolute value in the result of frequency analysis. Then, magnetic-field information of the frequencies f<sub>1</sub> and f<sub>2</sub> is stored in the third memory 25 as calibration values.</p><p id="p0165" num="0165">In this case, the magnetic-field signals at the frequency f<sub>1</sub> and the magnetic-field signals at the frequency f<sub>2</sub> detected by all the sense coils 13a may be corrected. More specifically, the sum Σ(V<sub>0</sub><sup>f1-N</sup>) of the signal components at the frequency f<sub>1</sub> detected by all the sense coils 13a and the sum Σ(V<sub>0</sub><sup>f2-N</sup>) of the signal components at the frequency f<sub>2</sub> detected by all the sense coils 13a are obtained. Then, V<sub>0</sub><sup>f2-1</sup>, V<sub>0</sub><sup>f2-2</sup>, ..., V<sub>0</sub><sup>f2-N</sup> are rewritten as follows and are overwritten in the first memory 19.<maths id="math0003" num=""><math display="block"><mtable columnalign="left"><mtr><mtd><msup><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">0</mn></msub><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>-</mo><mn mathvariant="normal">1</mn></mrow></msup><mspace width="1em"/><mi>is rewritten as</mi><mspace width="1em"/><msup><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">0</mn></msub><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>-</mo><mn mathvariant="normal">1</mn></mrow></msup><mo>×</mo><mi mathvariant="normal">Σ</mi><mo>⁢</mo><mfenced><msup><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">0</mn></msub><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">1</mn><mo>-</mo><mi mathvariant="normal">N</mi></mrow></msup></mfenced><mo>/</mo><mi mathvariant="normal">Σ</mi><mo>⁢</mo><mfenced><msup><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">0</mn></msub><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>-</mo><mi mathvariant="normal">N</mi></mrow></msup></mfenced></mtd></mtr><mtr><mtd><msup><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">0</mn></msub><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>-</mo><mn mathvariant="normal">2</mn></mrow></msup><mspace width="1em"/><mi>is rewritten as</mi><mspace width="1em"/><msup><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">0</mn></msub><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>-</mo><mn mathvariant="normal">2</mn></mrow></msup><mo>×</mo><mi mathvariant="normal">Σ</mi><mo>⁢</mo><mfenced><msup><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">0</mn></msub><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">1</mn><mo>-</mo><mi mathvariant="normal">N</mi></mrow></msup></mfenced><mo>/</mo><mi mathvariant="normal">Σ</mi><mo>⁢</mo><mfenced><msup><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">0</mn></msub><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>-</mo><mi mathvariant="normal">N</mi></mrow></msup></mfenced></mtd></mtr><mtr><mtd><mo>⋯</mo></mtd></mtr><mtr><mtd><msup><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">0</mn></msub><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>-</mo><mi mathvariant="normal">N</mi></mrow></msup><mspace width="1em"/><mi>is rewritten as</mi><mspace width="1em"/><msup><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">0</mn></msub><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>-</mo><mi mathvariant="normal">N</mi></mrow></msup><mo>×</mo><mi mathvariant="normal">Σ</mi><mo>⁢</mo><mfenced><msup><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">0</mn></msub><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">1</mn><mo>-</mo><mi mathvariant="normal">N</mi></mrow></msup></mfenced><mo>/</mo><mi mathvariant="normal">Σ</mi><mo>⁢</mo><mfenced><msup><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">0</mn></msub><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>-</mo><mi mathvariant="normal">N</mi></mrow></msup></mfenced></mtd></mtr></mtable></math><img id="ib0003" file="imgb0003.tif" wi="120" he="41" img-content="math" img-format="tif"/></maths></p><p id="p0166" num="0166">In addition, Σ(V<sub>0</sub><sup>f1-N</sup>)/Σ(V<sub>0</sub><sup>f2-N</sup>) is saved in the first memory 19. By doing so, v<sub>0</sub><sup>f1-1</sup> stored in the first memory 19<!-- EPO <DP n="67"> --> has a value substantially the same as the value of the replaced V<sub>0</sub><sup>f2-1</sup>. In other words, the gain for the signal at the frequency f<sub>1</sub> of each of the sense coils 13a can be made substantially the same as the gain for the signal at the frequency f<sub>2</sub>.</p><p id="p0167" num="0167">Furthermore, control is performed so that the clock (first clock) 55 provided in the first capsule medical device 51 is synchronized with the clock (second clock) 29 provided in the control section 7. More specifically, the synchronization signal of the second clock 29 and the trigger signal from the trigger generator 31 are transmitted from the transmission section 53 provided in the control section 7 to the receiving section 57 provided in the first capsule medical device 51. Then, the first clock 55 is phase-controlled by, for example, the PLL circuit 56 using the synchronization signal of the second clock 29. Such control is performed constantly or intermittently during calibration and actual measurement (described later).</p><p id="p0168" num="0168">Next, actual measurement is started when a command for starting actual measurement is entered on the input device 26 (step S121) with the first and second capsule medical devices 51 and 3' being disposed in the body cavity (step S120).</p><p id="p0169" num="0169">The control circuit 28 instructs the trigger generator<!-- EPO <DP n="68"> --> 31 to produce a trigger signal for the marker-driving circuit 54, the magnetic-field-generating-device driving circuit 42, and the read-out-timing generator 30, and the trigger generator 31 produces a trigger signal (step S122).</p><p id="p0170" num="0170">Based on the waveform data stored in the waveform data memory 10, the marker-driving circuit 54 sequentially generates magnetic-field-generation driving signals in synchronization with the clock signal and outputs them to the marker coil 52. The marker coil 52 produces the first alternating magnetic field based on the input magnetic-field-generation driving signals (step S123).</p><p id="p0171" num="0171">In addition, based on the waveform data stored in the waveform data memory 43, the magnetic-field-generating-device driving circuit 42 sequentially generates magnetic-field-generation driving signals in synchronization with the clock signal and outputs them to the magnetic-field generating device 41. The magnetic-field generating device 41 produces the second alternating magnetic field based on the input magnetic-field-generation driving signals (step S124).</p><p id="p0172" num="0172">The receiving circuit 13b applies low-pass filtering, amplification, and band-pass filtering to magnetic-field signals associated with the first alternating magnetic field from the marker coil 52 and associated with the second<!-- EPO <DP n="69"> --> alternating magnetic field from the magnetic-field generating device 41, i.e., the magnetic-field signals detected by each of the sense coils 13a, and then performs A/D conversion in synchronization with the clock signal (step S125).</p><p id="p0173" num="0173">The magnetic-field signals that have been subjected to A/D conversion are stored in the first memory 19 of the position-calculating section 14 (step S126). Then, it is determined whether or not a number of items of data required to perform frequency analysis processing are accumulated in the first memory 19, and if the required number of items of data are accumulated, frequency analysis processing is performed by the FFT-processing circuit 20 (step S127). Thereafter, it is determined whether or not the data from all the sense coils 13a have been subjected to this frequency analysis processing (step S128). If data from all sense coils 13a have not been processed, steps S122 to S127 are repeated.</p><p id="p0174" num="0174">When the data from all the sense coils 13a have been subjected to frequency analysis processing, the frequency-selecting section 24 extracts, based on the result of processing, the absolute value of the magnetic-field intensity of the frequency components of the magnetic field produced by the magnetic-field-generating-device driving circuit 42, namely, the second position-calculating frequencies f<sub>1</sub> and f<sub>2</sub>,<!-- EPO <DP n="70"> --> as shown in <figref idrefs="f0023">Fig. 23</figref>; associates them with the frequencies f<sub>1</sub> and f<sub>2</sub>; and stores them in the third memory 25 (step S129). This processing is applied to the magnetic-field signals from all the sense coils 13a (step S130).</p><p id="p0175" num="0175">The position/orientation analyzing section 22 uses the formulae below to calculate a signal of each of the sense coils 13a for performing position calculation of the magnetic induction coil 5 (step S131). <maths id="math0004" num=""><math display="block"><mtable columnalign="left"><mtr><mtd><msup><msub><mi mathvariant="normal">V</mi><mrow><mi mathvariant="normal">m</mi><mo>⁢</mo><mn mathvariant="normal">2</mn></mrow></msub><mn mathvariant="normal">1</mn></msup><mo>=</mo><mfenced separators=""><msup><mi mathvariant="normal">V</mi><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">1</mn><mo>-</mo><mn mathvariant="normal">1</mn></mrow></msup><mo>-</mo><msup><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">0</mn></msub><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">1</mn><mo>-</mo><mn mathvariant="normal">1</mn></mrow></msup></mfenced><mo>-</mo><mfenced separators=""><msup><mi mathvariant="normal">V</mi><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>-</mo><mn mathvariant="normal">1</mn></mrow></msup><mo>-</mo><msup><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">0</mn></msub><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>-</mo><mn mathvariant="normal">1</mn></mrow></msup></mfenced></mtd></mtr><mtr><mtd><msup><msub><mi mathvariant="normal">V</mi><mrow><mi mathvariant="normal">m</mi><mo>⁢</mo><mn mathvariant="normal">2</mn></mrow></msub><mn mathvariant="normal">2</mn></msup><mo>=</mo><mfenced separators=""><msup><mi mathvariant="normal">V</mi><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">1</mn><mo>-</mo><mn mathvariant="normal">2</mn></mrow></msup><mo>-</mo><msup><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">0</mn></msub><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">1</mn><mo>-</mo><mn mathvariant="normal">2</mn></mrow></msup></mfenced><mo>-</mo><mfenced separators=""><msup><mi mathvariant="normal">V</mi><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>-</mo><mn mathvariant="normal">2</mn></mrow></msup><mo>-</mo><msup><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">0</mn></msub><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>-</mo><mn mathvariant="normal">2</mn></mrow></msup></mfenced></mtd></mtr><mtr><mtd><mo>⋯</mo></mtd></mtr><mtr><mtd><msup><msub><mi mathvariant="normal">V</mi><mrow><mi mathvariant="normal">m</mi><mo>⁢</mo><mn mathvariant="normal">2</mn></mrow></msub><mi mathvariant="normal">N</mi></msup><mo>=</mo><mfenced separators=""><msup><mi mathvariant="normal">V</mi><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">1</mn><mo>-</mo><mi mathvariant="normal">N</mi></mrow></msup><mo>-</mo><msup><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">0</mn></msub><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">1</mn><mo>-</mo><mi mathvariant="normal">N</mi></mrow></msup></mfenced><mo>-</mo><mfenced separators=""><msup><mi mathvariant="normal">V</mi><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>-</mo><mi mathvariant="normal">N</mi></mrow></msup><mo>-</mo><msup><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">0</mn></msub><mrow><mi mathvariant="normal">f</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>-</mo><mi mathvariant="normal">N</mi></mrow></msup></mfenced></mtd></mtr></mtable></math><img id="ib0004" file="imgb0004.tif" wi="81" he="43" img-content="math" img-format="tif"/></maths></p><p id="p0176" num="0176">Then, based on the calculated V<sub>m2</sub><sup>1</sup>, V<sub>m2</sub><sup>2</sup>, ..., V<sub>m2</sub><sup>N</sup>, the position/orientation analyzing section 22 calculates the position and the orientation of the magnetic induction coil 5 through repeated arithmetic operations (step S132).</p><p id="p0177" num="0177">The calculated position and the orientation of the magnetic induction coil 5 are sent to the control circuit 28, displayed on the display device 8 (step S133), and stored in the second memory 23 (step S134).</p><p id="p0178" num="0178">In addition, based on the result of frequency analysis processing, the frequency-selecting section 24 extracts the<!-- EPO <DP n="71"> --> value of the real part of the magnetic-field intensity at the frequency component of the magnetic field produced by the marker-driving circuit 54, namely, the first position-calculating frequency f<sub>0</sub>, and stores it in the third memory 25.</p><p id="p0179" num="0179">The position/orientation analyzing section 22 calculates the position and the orientation of the marker coil 52 based on the value of the real part of the magnetic-field intensity at the first position-calculating frequency f<sub>0</sub> stored in the third memory 25 (step S135).</p><p id="p0180" num="0180">The calculated position and the orientation of the marker coil 52 are sent to the control circuit 28, displayed on the display device 8 (step S136), and stored in the second memory 23 (step S137).</p><p id="p0181" num="0181">Then, it is checked whether or not a command for terminating position detection has been input on the input device 26 (step S138), and if a command for terminating position detection has been input, generation of a trigger signal from the trigger generator 31 is terminated to stop the operation of the position detection system 50 (step S139). On the other hand, if no termination command has been input, the flow returns to step S122, where the position detection operation is continued. In this case, for the initial values<!-- EPO <DP n="72"> --> for repeated arithmetic operations of the positions and the orientations of the magnetic induction coil 5 and the marker coil 52, the calculation results of the positions and the orientations of the magnetic induction coil 5 and the marker coil 52 that have previously been calculated and stored in the second memory 23 are used. By doing so, the convergence time of repeated arithmetic operations can be reduced to calculate the positions and the orientations in a shorter period of time.</p><p id="p0182" num="0182">In this manner, according to the position detection system 50 and the position detection method of this example, the signal from the marker coil 52 and the signal from the magnetic induction coil 5 can be completely separated from each other based on the phase information of both the signals. Therefore, the position and the orientation of the marker coil 52 can be calculated accurately. Furthermore, because the position and the orientation of the magnetic induction coil 5 are obtained based on the difference between two frequency-signal intensities, they can be calculated based on a signal in the case where no induced magnetic field from the marker coil 52 is present. As a result, the position and the orientation of the magnetic induction coil 5 can be obtained accurately by suppressing the interference caused by the marker coil 52.<!-- EPO <DP n="73"> --></p><p id="p0183" num="0183">In this example, if a plurality of the marker coils 52 is provided, the plurality of marker coils 52 only need to be sequentially driven in a time-division manner to repeat steps S122 to S137.</p><p id="p0184" num="0184">The magnetic field produced by each marker coil 52 is a magnetic field having the frequency f<sub>0</sub>, which is equal to the resonance frequency of the magnetic induction coil 5. For this reason, the induced magnetic field produced as a result of the magnetic induction coil 5 responding to the magnetic field from the marker coil 52 has a phase that is shifted by n/2 with respect to the phase of the magnetic field produced by the marker coil 52.</p><p id="p0185" num="0185">Therefore, the result of frequency analysis processing of signals acquired by the sense coils 13a reveals that the signals from the magnetic fields produced by the marker coil 52 and the magnetic induction coil 5 are shifted by n/2. The phase of the magnetic field produced by the marker coil 52 can be pre-adjusted because the sampling clock of the A/D converters 18 in the receiving circuit 13b is synchronized with the sampling clock of the D/A converter 11 in the marker-coil driving circuit 54. In this example, adjustment is performed by the read-out-timing generator 30 so that any signal based on the magnetic field of the marker coil 52 is<!-- EPO <DP n="74"> --> reflected in the real part.</p><p id="p0186" num="0186">For this adjustment method, only the marker coil 52 is driven to adjust the signal produced by the read-out-timing generator 30 so that the real part in the result of the frequency analysis processing applied to the magnetic-field signals acquired by the sense coils 13a exhibits the maximum value and the imaginary part in the same result exhibits the minimum value. This adjustment is needed only once, and readjustment is not required. This procedure can be achieved in the form of the calibration procedure described in the non-claimed example in which the magnetic-field generating device 41 is replaced with the marker coil 52.</p></description><claims mxw-id="PCLM56984915" lang="DE" load-source="patent-office"><!-- EPO <DP n="79"> --><claim id="c-de-01-0001" num="0001"><claim-text>Positionserkennungssystem (1, 40, 50) mit:
<claim-text>einem ersten Marker (4, 52), der in einer ersten Vorrichtung vorgesehen ist und ein erstes alternierendes Magnetfeld mit einer ersten Positionsberechnungsfrequenz (f0) mittels einer externen Energiezufuhr (9) erzeugt;</claim-text>
<claim-text>einem zweiten Marker (3), der in einer zweiten Vorrichtung vorgesehen ist, die sich von der ersten Vorrichtung unterscheidet, und eine magnetische Induktionsspule (5) enthält, die eine Resonanzfrequenz aufweist, die gleich der ersten Positionsberechnungsfrequenz (f0) ist;</claim-text>
<claim-text>einer Magnetfelderkennungseinheit (6), die außerhalb eines Arbeitsbereichs (S) der zweiten Vorrichtung angeordnet und dazu ausgebildet ist, ein Magnetfeld auf der ersten Positionsberechnungsfrequenz (f0) zu erkennen;</claim-text>
<claim-text>einer Extraktionseinheit (21), die dazu ausgebildet ist, aus dem von der Magnetfelderkennungseinheit (6) erkannten Magnetfeld eine erste Erkennungs-Magnetfeld-Komponente zu extrahieren, die die erste Positionsberechnungsfrequenz (f0) aufweist und eine Phase hat, die gleich einer Phase des ersten alternierenden Magnetfelds ist;</claim-text>
<claim-text>einer Positions-/Orientierungs-Analyseeinheit (22), die dazu ausgebildet ist, eine Position und/oder eine Orientierung des ersten Markers (4, 52) auf der Basis der Intensität der von der Extraktionseinheit (21) extrahierten ersten Erkennungs-Magnetfeld-Komponente zu berechnen;</claim-text>
<claim-text><b>dadurch gekennzeichnet, dass</b>:
<claim-text>die Extraktionseinheit (21) dazu ausgebildet ist, aus dem von der Magnetfelderkennungseinheit (6) erkannten Magnetfeld eine zweite Erkennungs-Magnetfeld-Komponente zu extrahieren, die die erste Positionsberechnungsfrequenz (f0) aufweist und eine Phase hat, die in Bezug auf die Phase des ersten alternierenden Magnetfelds um π/2 verschoben ist; und</claim-text><claim-text>die Positions-/Orientierungs-Analyseeinheit (22) dazu ausgebildet ist, eine Position und/oder eine Orientierung des zweiten Markers (3) auf der Basis der Intensität der zweiten Erkennungs-Magnetfeld-Komponente zu berechnen.</claim-text></claim-text></claim-text></claim><claim id="c-de-01-0002" num="0002"><claim-text>Positionserkennungssystem nach Anspruch 1, mit:
<claim-text>einer Magnetfeld-Erzeugungseinheit (41), die außerhalb des Arbeitsbereichs (S) der zweiten Vorrichtung angeordnet und dazu ausgebildet ist, ein zweites alternierendes Magnetfeld zu erzeugen, das die erste Positionsberechnungsfrequenz<!-- EPO <DP n="80"> --> (f0) aufweist und eine Phase hat, die gleich der Phase des ersten alternierenden Magnetfelds ist,</claim-text>
<claim-text>wobei die Positions-/Orientierungs-Analyseeinheit (22) dazu ausgebildet ist, die Position und/oder die Orientierung des ersten Markers (4, 52) zu berechnen, auf der Basis einer Differenz zwischen einer Intensität der ersten Erkennungs-Magnetfeld-Komponente, welche extrahiert wird, wenn das erste alternierende Magnetfeld erzeugt wird, und einer Intensität der ersten Erkennungs-Magnetfeld-Komponente, welche extrahiert wird, bevor das erste alternierende Magnetfeld erzeugt wird.</claim-text></claim-text></claim><claim id="c-de-01-0003" num="0003"><claim-text>Positionserkennungssystem nach Anspruch 1, mit:
<claim-text>einer Magnetfeld-Erzeugungseinheit (41), die außerhalb des Arbeitsbereichs (S) der zweiten Vorrichtung angeordnet und dazu ausgebildet ist, ein zweites alternierendes Magnetfeld zu erzeugen, das zumindest einen Satz zweiter Positionsberechnungsfrequenzen (f1, f2) aufweist, die sich in der Nähe der ersten Positionsberechnungsfrequenz (f0) befinden und durch eine vorgegebene Frequenz in Bezug auf die erste Positionsberechnungsfrequenz (f0) getrennt sind, wobei die erste Positionsberechnungsfrequenz (f0) zwischen sie gefügt ist,</claim-text>
<claim-text>wobei die Magnetfelderkennungseinheit (6) dazu ausgebildet ist, ein Magnetfeld auf der zweiten Positionsberechnungsfrequenz (f1, f2) zu erkennen,</claim-text>
<claim-text>wobei die Extraktionseinheit (21) dazu ausgebildet ist, aus dem von der Magnetfelderkennungseinheit (6) erkannten Magnetfeld eine Differenz zwischen Intensitäten zumindest eines Satzes zweiter Erkennungs-Magnetfeld-Komponenten zu extrahieren, die den einen Satz zweiter Positionsberechnungsfrequenzen (f1, f2) aufweisen, und</claim-text>
<claim-text>die Positions-/Orientierungs-Analyseeinheit (22) dazu ausgebildet ist, eine Position und/oder eine Orientierung des zweiten Markers (4, 52) auf der Basis der extrahierten Differenz zu berechnen.</claim-text></claim-text></claim><claim id="c-de-01-0004" num="0004"><claim-text>Positionserkennungssystem nach Anspruch 3, wobei die Intensitäten der zweiten Erkennungs-Magnetfeld-Komponenten Absolutwertintensitäten sind.</claim-text></claim><claim id="c-de-01-0005" num="0005"><claim-text>Positionserkennungssystem nach einem der Ansprüche 1 bis 4, wobei die zweite Vorrichtung eine medizinische Kapselvorrichtung (3) ist.</claim-text></claim><claim id="c-de-01-0006" num="0006"><claim-text>Positionserkennungssystem nach einem der Ansprüche 1 bis 5, wobei die erste Vorrichtung ein Endoskop (2) ist und der erste Marker (4, 52) an einem vorderen Endbereich des Endoskops (2) vorgesehen ist.<!-- EPO <DP n="81"> --></claim-text></claim><claim id="c-de-01-0007" num="0007"><claim-text>System (100) zur Führung einer medizinischen Vorrichtung, mit:
<claim-text>dem Positionserkennungssystem (1, 40, 50) nach einem der Ansprüche 1 bis 6, wobei der zweite Marker ferner eine Magnetfeld-Funktionseinheit (150) einschließt;</claim-text>
<claim-text>einer Antriebsmagnetfeld-Erzeugungseinheit (72), die dazu ausgebildet ist, ein Antriebsmagnetfeld zu erzeugen, das dazu ausgeführt ist, auf die Magnetfeld-Funktionseinheit (150) einzuwirken; und</claim-text>
<claim-text>einer Antriebsmagnetfeld-Steuerungseinheit (72), die dazu ausgebildet ist, eine Intensität und eine Richtung des Antriebsmagnetfelds auf der Basis der Position und/oder der Orientierung des von der Positions-/Orientierungs-Analyseeinheit (22) berechneten zweiten Markers (3) zu steuern.</claim-text></claim-text></claim><claim id="c-de-01-0008" num="0008"><claim-text>Positionserkennungsverfahren mit:
<claim-text>einem Magnetfeld-Erzeugungsschritt zum Veranlassen, dass ein erster Marker (4, 52), der in einer ersten Vorrichtung vorgesehen ist, ein erstes alternierendes Magnetfeld, das eine erste Positionsberechnungsfrequenz (f0) aufweist, mittels einer externen Energiezufuhr (9) erzeugt;</claim-text>
<claim-text>einem Induziertes-Magnetfeld-Erzeugungsschritt zum Veranlassen, dass ein zweiter Marker (3), der in einer zweiten Vorrichtung vorgesehen ist, die sich von der ersten Vorrichtung unterscheidet, und eine magnetische Induktionsspule (5) enthält, ein induziertes Magnetfeld in Reaktion auf das erste alternierende Magnetfeld erzeugt;</claim-text>
<claim-text>einem Magnetfeld-Erkennungsschritt zum Erkennen eines Magnetfelds auf der ersten Positionsberechnungsfrequenz (f0);</claim-text>
<claim-text>einem Extrahierungsschritt zum Extrahierten einer ersten Erkennungs-Magnetfeld-Komponente aus dem erkannten Magnetfeld, die die erste Positionsberechnungsfrequenz (f0) aufweist und eine Phase hat, die gleich einer Phase des ersten alternierenden Magnetfelds auf der ersten Positionsberechnungsfrequenz (f0) ist; und</claim-text>
<claim-text>einem Positions-/Orientierungs-Analyseschritt zum Berechnen einer Position und/oder einer Orientierung des ersten Markers (4, 52) auf der Basis der Intensität der extrahierten ersten Erkennungs-Magnetfeld-Komponente;</claim-text>
<claim-text><b>dadurch gekennzeichnet, dass</b></claim-text>
<claim-text>der Extrahierungsschritt einen Schritt des Extrahierens einer zweiten Erkennungs-Magnetfeld-Komponente aus dem erkannten Magnetfeld einschließt, die die erste Positionsberechnungsfrequenz (f0) aufweist und eine Phase hat, die in<!-- EPO <DP n="82"> --> Bezug auf die Phase des ersten alternierenden Magnetfelds um π/2 verschoben ist; und</claim-text>
<claim-text>der Positions-/Orientierungs-Analyseschritt einen Schritt des Berechnens einer Position und/oder einer Orientierung des zweiten Markers (3) auf der Basis der Intensität der extrahierten zweiten Erkennungs-Magnetfeld-Komponente einschließt.</claim-text></claim-text></claim><claim id="c-de-01-0009" num="0009"><claim-text>Positionserkennungsverfahren nach 8,<br/>
wobei der Magnetfeld-Erzeugungsschritt einen Schritt des Erzeugens eines zweiten alternierenden Magnetfelds einschließt, das die erste Positionsberechnungsfrequenz (f0) aufweist und eine Phase hat, die gleich der Phase des ersten alternierenden Magnetfelds ist,<br/>
der Induziertes-Magnetfeld-Erzeugungsschritt einen Schritt des Veranlassens des zweiten Markers (3) einschließt, ein induziertes Magnetfeld in Reaktion auf das zweite alternierende Magnetfeld zu erzeugen, und<br/>
der Positions-/Orientierungs-Analyseschritt einen Schritt des Berechnens der Position und/oder der Orientierung des ersten Markers (4, 52) auf der Basis einer Differenz zwischen einer Intensität der ersten Erkennungs-Magnetfeld-Komponente, die extrahiert wird, wenn das erste alternierende Magnetfeld erzeugt wird, und einer Intensität der ersten Erkennungs-Magnetfeld-Komponente, die extrahiert wird, bevor das erste alternierende Magnetfeld erzeugt wird, einschließt.</claim-text></claim><claim id="c-de-01-0010" num="0010"><claim-text>Positionserkennungsverfahren nach 9,<br/>
wobei der Magnetfeld-Erzeugungsschritt einen Schritt des Erzeugens eines zweiten alternierenden Magnetfelds einschließt, das zumindest einen Satz zweiter Positionsberechnungsfrequenzen (f1, f2) aufweist, die sich in der Nähe der ersten Positionsberechnungsfrequenz (f0) befinden und durch eine vorbestimmte Frequenz in Bezug auf die erste Positionsberechnungsfrequenz (f0) getrennt sind, wobei die erste Positionsberechnungsfrequenz (f0) zwischen sie gefügt ist,<br/>
der Induziertes-Magnetfeld-Erzeugungsschritt einen Schritt des Veranlassens des zweiten Markers (3) einschließt, ein induziertes Magnetfeld in Reaktion auf das zweite alternierende Magnetfeld zu erzeugen,<br/>
der Magnetfeld-Erkennungsschritt einen Schritt des Erkennens eines Magnetfelds auf der zweiten Positionsberechnungsfrequenz (f1, f2) einschließt,<br/>
der Extrahierungsschritt einen Schritt des Extrahierens einer Differenz zwischen Intensitäten zumindest eines Satzes zweiter Erkennungs-Magnetfeld-Komponenten aus einem erkannten Magnetfeld einschließt, die den einen Satz zweiter Positionsberechnungsfrequenzen (f1, f2) aufweisen, und<br/>
<!-- EPO <DP n="83"> -->der Positions-/Orientierungs-Analyseschritt einen Schritt des Berechnens der Position und/oder der Orientierung des zweiten Markers (3) auf der Basis der extrahierten Differenz einschließt.</claim-text></claim></claims><claims mxw-id="PCLM56984916" lang="EN" load-source="patent-office"><!-- EPO <DP n="75"> --><claim id="c-en-01-0001" num="0001"><claim-text>A position detection system (1, 40, 50) comprising:
<claim-text>a first marker (4, 52) provided in a first device that produces a first alternating magnetic field having a first position-calculating frequency (f0) by means of an external power supply (9);</claim-text>
<claim-text>a second marker (3) provided in a second device that is different from the first device and including a magnetic induction coil (5) having a resonance frequency equal to the first position-calculating frequency(f0);</claim-text>
<claim-text>a magnetic-field detection section (6) that is disposed outside a working space (S)of the second device and that is configured to detect a magnetic field at the first position-calculating frequency (f0);</claim-text>
<claim-text>an extracting section (21) that is configured to extract, from the magnetic field detected by the magnetic-field detection section (6), a first detection-magnetic-field component having the first position-calculating frequency (f0) and having a phase equal to a phase of the first alternating magnetic field;</claim-text>
<claim-text>a position/orientation analyzing section (22) that is configured to calculate at least one of a position and an orientation of the first marker (4, 52) based on the intensity of the first detection-magnetic-field component extracted by the extracting section (21);</claim-text>
<claim-text><b>characterized in that</b>:
<claim-text>the extracting section (21) is configured to extract, from the magnetic field detected by the magnetic-field detection section (6), a second detection-magnetic-field component having the first position-calculating frequency (f0) and having a phase shifted by n/2 with respect to the phase of the first alternating magnetic field, and</claim-text><claim-text>the position/orientation analyzing section (22) is configured to calculate at least one of a position and an orientation of the second marker (3) based on the intensity of the second detection-magnetic-field component.</claim-text></claim-text></claim-text></claim><claim id="c-en-01-0002" num="0002"><claim-text>The position detection system according to claim 1, comprising:
<claim-text>a magnetic-field generating unit (41), disposed outside the working space (S)of the second device, that is configured to produce a second alternating magnetic field having the first position-calculating frequency (f0) and having a phase equal to the phase of the first alternating magnetic field,<!-- EPO <DP n="76"> --></claim-text>
<claim-text>wherein the position/orientation analyzing section (22) is configured to calculate at least one of the position and the orientation of the first marker (4, 52) based on a difference between an intensity of the first detection-magnetic-field component extracted when the first alternating magnetic field is produced and an intensity of the first detection-magnetic-field component extracted before the first alternating magnetic field is produced.</claim-text></claim-text></claim><claim id="c-en-01-0003" num="0003"><claim-text>The position detection system according to claim 1, comprising:
<claim-text>a magnetic-field generating unit (41), disposed outside the working space (S)of the second device, that is configured to produce a second alternating magnetic field having at least one set of second position-calculating frequencies (f1, f2) that are in the proximity of the first position-calculating frequency (f0) and are separated by a predetermined frequency with respect to the first position-calculating frequency (f0) with the first position-calculating frequency (f0) interposed therebetween,</claim-text>
<claim-text>wherein the magnetic-field detection section (6) is configured to detect a magnetic field at the second position-calculating frequency (f1, f2),</claim-text>
<claim-text>the extracting section (21) is configured to extract, from the magnetic field detected by the magnetic-field detection section (6), a difference between intensities of at least one set of second detection-magnetic-field components having the one set of second position-calculating frequencies(f1 f2), and</claim-text>
<claim-text>the position/orientation analyzing section (22) is configured to calculate at least one of a position and an orientation of the second marker (4, 52) based on the extracted difference.</claim-text></claim-text></claim><claim id="c-en-01-0004" num="0004"><claim-text>The position detection system according to claim 3, wherein the intensities of the second detection-magnetic-field components are absolute-value intensities.</claim-text></claim><claim id="c-en-01-0005" num="0005"><claim-text>The position detection system according to one of claims 1 to 4, wherein the second device is a capsule medical device (3).</claim-text></claim><claim id="c-en-01-0006" num="0006"><claim-text>The position detection system according to one of claims 1 to 5, wherein the first device is an endoscope (2), and the first marker (4, 52) is provided at a front end portion of the endoscope (2).</claim-text></claim><claim id="c-en-01-0007" num="0007"><claim-text>A medical-device guidance system (100) comprising:
<claim-text>the position detection system (1, 40, 50) according to one of claims 1 to 6, the second marker (3) further including a magnetic-field acting section (150);<!-- EPO <DP n="77"> --></claim-text>
<claim-text>a propulsion-magnetic-field generating unit (72) that is configured to produce a propulsion magnetic field made to act upon the magnetic-field acting section (150); and</claim-text>
<claim-text>a propulsion-magnetic-field control section (72) that is configured to control an intensity and a direction of the propulsion magnetic field based on at least one of the position and the orientation of the second marker (3) calculated by the position/orientation analyzing section (22).</claim-text></claim-text></claim><claim id="c-en-01-0008" num="0008"><claim-text>A position detection method comprising:
<claim-text>a magnetic-field generating step of causing a first marker (4, 52) provided in a first device to produce a first alternating magnetic field having a first position-calculating frequency (f0) by means of an external power supply (9);</claim-text>
<claim-text>an induced-magnetic-field generating step of causing a second marker (3) provided in a second device that is different from the first device and including a magnetic induction coil (5) to produce an induced magnetic field in response to the first alternating magnetic field;</claim-text>
<claim-text>a magnetic-field detecting step of detecting a magnetic field at the first position-calculating frequency (f0);</claim-text>
<claim-text>an extracting step of extracting, from the detected magnetic field, a first detection-magnetic-field component having the first position-calculating frequency (f0) and having a phase equal to a phase of the first alternating magnetic field at the first position-calculating frequency (f0); and</claim-text>
<claim-text>a position/orientation analyzing step of calculating at least one of a position and an orientation of the first marker (4, 52) based on the intensity of the extracted first detection-magnetic-field component;</claim-text>
<claim-text><b>characterized in that</b></claim-text>
the extracting step includes a step of extracting, from the detected magnetic field, a second detection-magnetic-field component having the first position-calculating frequency (f0) and having a phase shifted by n/2 with respect to the phase of the first alternating magnetic field; and
<claim-text>the position/orientation analyzing step includes a step of calculating at least one of a position and an orientation of the second marker (3) based on the intensity of the extracted second detection-magnetic-field component.</claim-text></claim-text></claim><claim id="c-en-01-0009" num="0009"><claim-text>The position detection method according to 8,
<claim-text>wherein the magnetic-field generating step includes a step of producing a second alternating magnetic field having the first position-calculating frequency (f0) and having a phase equal to the phase of the first alternating magnetic field,<!-- EPO <DP n="78"> --></claim-text>
<claim-text>the induced-magnetic-field generating step includes a step of causing the second marker (3) to produce an induced magnetic field in response to the second alternating magnetic field, and</claim-text>
<claim-text>the position/orientation analyzing step includes a step of calculating at least one of the position and the orientation of the first marker (4, 52) based on a difference between an intensity of the first detection-magnetic-field component extracted when the first alternating magnetic field is produced and an intensity of the first detection-magnetic-field component extracted before the first alternating magnetic field is produced.</claim-text></claim-text></claim><claim id="c-en-01-0010" num="0010"><claim-text>The position detection method according to 9,
<claim-text>wherein the magnetic-field generating step includes a step of producing a second alternating magnetic field having at least one set of second position-calculating frequencies (f1, f2) that are in the proximity of the first position-calculating frequency and are separated by a predetermined frequency with respect to the first position-calculating frequency (f0) with the first position-calculating frequency (f0) interposed therebetween,</claim-text>
<claim-text>the induced-magnetic-field generating step includes a step of causing the second marker (3) to produce an induced magnetic field in response to the second alternating magnetic field,</claim-text>
<claim-text>the magnetic-field detecting step includes a step of detecting a magnetic field at the second position-calculating frequency (f1 f2),</claim-text>
<claim-text>the extracting step includes a step of extracting, from a detected magnetic field, a difference between intensities of at least one set of second detection-magnetic-field components having the one set of second position-calculating frequencies (f1 f2), and</claim-text>
<claim-text>the position/orientation analyzing step includes a step of calculating at least one of a position and an orientation of the second marker (3) based on the extracted difference.</claim-text></claim-text></claim></claims><claims mxw-id="PCLM56984917" lang="FR" load-source="patent-office"><!-- EPO <DP n="84"> --><claim id="c-fr-01-0001" num="0001"><claim-text>Système de détection de position (1, 40, 50) comprenant :
<claim-text>un premier marqueur (4, 52) prévu dans un premier dispositif qui produit un premier champ magnétique alternatif ayant une première fréquence de calcul de position (f0) au moyen d'une alimentation externe (9) ;</claim-text>
<claim-text>un deuxième marqueur (3) prévu dans un deuxième dispositif qui est différent du premier dispositif et incluant une bobine d'induction magnétique (5) ayant une fréquence de résonance égale à la première fréquence de calcul de position (f0) ;</claim-text>
<claim-text>une section de détection de champ magnétique (6) qui est disposée à l'extérieur d'un espace de travail (S) du deuxième dispositif et qui est configurée pour détecter un champ magnétique à la première fréquence de calcul de position (f0) ;</claim-text>
<claim-text>une section d'extraction (21) qui est configurée pour extraire, à partir du champ magnétique détecté par la section de détection de champ magnétique (6), une première composante de champ magnétique de détection ayant la première fréquence de calcul de position (f0) et présentant une phase égale à une phase du premier champ magnétique alternatif ;</claim-text>
<claim-text>une section d'analyse de position/d'orientation (22) qui est configurée pour calculer au moins l'une parmi une position et une orientation du premier marqueur (4, 52) sur la base de l'intensité de la première composante de champ magnétique de détection extraite par la section d'extraction (21) ;</claim-text>
<claim-text><b>caractérisé en ce que</b> :
<claim-text>la section d'extraction (21) est configurée pour extraire, à partir du champ magnétique détecté par la section de détection de champ magnétique (6), une deuxième composante de champ magnétique de détection ayant la première fréquence de calcul de position (f0) et présentant une phase décalée de n/2 par rapport à la phase du premier champ magnétique alternatif ; et</claim-text>
<claim-text>la section d'analyse de position/d'orientation (22) est configurée pour calculer au moins l'une parmi une position et une orientation du deuxième marqueur (3) sur la base de l'intensité de la deuxième composante de champ magnétique de détection.</claim-text></claim-text></claim-text></claim><claim id="c-fr-01-0002" num="0002"><claim-text>Système de détection de position selon la revendication 1, comprenant :
<claim-text>une unité de génération de champ magnétique (41), disposée à l'extérieur de l'espace de travail (S) du deuxième dispositif, qui est configurée pour produire un<!-- EPO <DP n="85"> --> deuxième champ magnétique alternatif ayant la première fréquence de calcul de position (f0) et présentant une phase égale à la phase du premier champ magnétique alternatif,</claim-text>
<claim-text>dans lequel la section d'analyse de position/d'orientation (22) est configurée pour calculer au moins l'une parmi la position et l'orientation du premier marqueur (4, 52) sur la base d'une différence entre une intensité de la première composante de champ magnétique de détection extraite lorsque le premier champ magnétique alternatif est produit et une intensité de la première composante de champ magnétique de détection extraite avant que le premier champ magnétique alternatif soit produit.</claim-text></claim-text></claim><claim id="c-fr-01-0003" num="0003"><claim-text>Système de détection de position selon la revendication 1, comprenant :
<claim-text>une unité de génération de champ magnétique (41), disposée à l'extérieur de l'espace de travail (S) du deuxième dispositif, qui est configurée pour produire un deuxième champ magnétique alternatif ayant au moins l'une établie parmi des deuxièmes fréquences de calcul de position (f1, f2) qui se situent à proximité de la première fréquence de calcul de position (f0) et qui sont séparées d'une fréquence prédéterminée par rapport à la première fréquence de calcul de position (f0), la première fréquence de calcul de position (f0) étant interposée entre elles,</claim-text>
<claim-text>dans lequel la section de détection de champ magnétique (6) est configurée pour détecter un champ magnétique à la deuxième fréquence de calcul de position (f1, f2),</claim-text>
<claim-text>la section d'extraction (21) est configurée pour extraire, à partir du champ magnétique détecté par la section de détection de champ magnétique (6), une différence entre les intensités d'au moins l'une établie parmi des deuxième composantes de champ magnétique de détection ayant l'une établie parmi les deuxièmes fréquences de calcul de position (f1, f2), et</claim-text>
<claim-text>la section d'analyse de position/d'orientation (22) est configurée pour calculer au moins l'une parmi une position et une orientation du deuxième marqueur (3) sur la base de la différence extraite.</claim-text></claim-text></claim><claim id="c-fr-01-0004" num="0004"><claim-text>Système de détection de position selon la revendication 3, dans lequel les intensités des deuxièmes composantes de champ magnétique de détection sont des intensités en valeur absolue.</claim-text></claim><claim id="c-fr-01-0005" num="0005"><claim-text>Système de détection de position selon l'une quelconque des revendications 1 à 4, dans lequel le deuxième dispositif est un dispositif médical de type capsule (3).<!-- EPO <DP n="86"> --></claim-text></claim><claim id="c-fr-01-0006" num="0006"><claim-text>Système de détection de position selon l'une quelconque des revendications 1 à 5, dans lequel le premier dispositif est un endoscope (2), et le premier marqueur (4, 52) est prévu au niveau d'une partie d'extrémité avant de l'endoscope (2).</claim-text></claim><claim id="c-fr-01-0007" num="0007"><claim-text>Système de guidage de dispositif médical (100) comprenant :
<claim-text>le système de détection de position (1, 40, 50) selon l'une quelconque des revendications 1 à 6, le deuxième marqueur (3) comprenant en outre une section d'action de champ magnétique (150) ;</claim-text>
<claim-text>une unité de génération de champ magnétique de propulsion (72) qui est configurée pour produire un champ magnétique de propulsion réalisé pour agir sur la section d'action de champ magnétique (150) ; et</claim-text>
<claim-text>une section de commande de champ magnétique de propulsion (72) qui est configurée pour commander une intensité et une direction du champ magnétique de propulsion sur la base d'au moins l'une parmi la position et l'orientation du deuxième marqueur (3) calculée par la section d'analyse de position/d'orientation (22).</claim-text></claim-text></claim><claim id="c-fr-01-0008" num="0008"><claim-text>Procédé de détection de position comprenant :
<claim-text>une étape de génération de champ magnétique consistant à amener un premier marqueur (4, 52) prévu dans un premier dispositif à produire un premier champ magnétique alternatif ayant une première fréquence de calcul de position (f0) au moyen d'une alimentation externe (9) ;</claim-text>
<claim-text>une étape de génération de champ magnétique induit consistant à amener un deuxième marqueur (3) prévu dans un deuxième dispositif qui est différent du premier dispositif et comprenant une bobine d'induction magnétique (5) à produire un champ magnétique induit en réponse au premier champ magnétique alternatif ;</claim-text>
<claim-text>une étape de détection de champ magnétique consistant à détecter un champ magnétique à la première fréquence de calcul de position (f0) ;</claim-text>
<claim-text>une étape d'extraction consistant à extraire, à partir du champ magnétique détecté, une première composante de champ magnétique de détection ayant la première fréquence de calcul de position (f0) et présentant une phase égale à une phase du premier champ magnétique alternatif à la première fréquence de calcul de position (f0) ; et</claim-text>
<claim-text>une étape d'analyse de position/d'orientation consistant à calculer au moins l'une parmi une position et une orientation du premier marqueur (4, 52) sur la base de l'intensité de la première composante de champ magnétique de détection ;</claim-text>
<claim-text><b>caractérisé en ce que</b></claim-text>
<claim-text>l'étape d'extraction comprend une étape consistant à extraire, à partir du champ magnétique détecté, une deuxième composante de champ magnétique de<!-- EPO <DP n="87"> --> détection ayant la première fréquence de calcul de position (f0) et présentant une phase décalée de n/2 par rapport à la phase du premier champ magnétique alternatif ; et</claim-text>
<claim-text>l'étape d'analyse de position/d'orientation comprend une étape consistant à calculer au moins l'une parmi une position et une orientation du deuxième marqueur (3) sur la base de l'intensité de la deuxième composante de champ magnétique de détection extraite.</claim-text></claim-text></claim><claim id="c-fr-01-0009" num="0009"><claim-text>Procédé de détection de position selon 8,<br/>
dans lequel l'étape de génération de champ magnétique comprend une étape consistant à produire un deuxième champ magnétique alternatif ayant la première fréquence de calcul de position (f0) et présentant une phase égale à la phase du premier champ magnétique alternatif,<br/>
l'étape de génération de champ magnétique induit comprend une étape consistant à amener le deuxième marqueur (3) à produire un champ magnétique induit en réponse au deuxième champ magnétique alternatif, et<br/>
l'étape d'analyse de position/d'orientation comprend une étape consistant à calculer au moins l'une parmi la position et l'orientation du premier marqueur (4, 52) sur la base d'une différence entre une intensité de la première composante de champ magnétique de détection extraite lorsque le premier champ magnétique alternatif est produit et une intensité de la première composante de champ magnétique de détection extraite après que le premier champ magnétique alternatif soit produit.</claim-text></claim><claim id="c-fr-01-0010" num="0010"><claim-text>Procédé de détection de position selon 9,<br/>
dans lequel l'étape de génération de champ magnétique comprend une étape consistant à produire un deuxième champ magnétique alternatif ayant au moins l'une établie parmi des deuxièmes fréquences de calcul de position (f1, f2) qui se situent à proximité de la première fréquence de calcul de position et qui sont séparées d'une fréquence prédéterminée par rapport à la première fréquence de calcul de position (f0), la première fréquence de calcul de position (f0) étant interposée entre elles,<br/>
l'étape de génération de champ magnétique induit comprend une étape consistant à amener le deuxième marqueur (3) à produire un champ magnétique induit en réponse au deuxième champ magnétique alternatif,<br/>
l'étape de détection de champ magnétique comprend une étape consistant à détecter un champ magnétique à la deuxième fréquence de calcul de position (f1, f2),<br/>
l'étape d'extraction comprend une étape consistant à extraire, à partir d'un champ magnétique détecté, une différence entre les intensités d'au moins l'une<!-- EPO <DP n="88"> --> établie parmi des deuxièmes composantes de champ magnétique de détection ayant l'une établie parmi les deuxièmes fréquences de calcul de position (f1, f2), et<br/>
l'étape d'analyse de position/d'orientation comprend une étape consistant à calculer au moins l'une parmi une position et une orientation du deuxième marqueur (3) sur la base de la différence extraite.</claim-text></claim></claims><drawings mxw-id="PDW16671999" load-source="patent-office"><!-- EPO <DP n="89"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="143" he="196" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="90"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="160" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="91"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="110" he="171" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="92"> --><figure id="f0004" num="4"><img id="if0004" file="imgf0004.tif" wi="134" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="93"> --><figure id="f0005" num="5"><img id="if0005" file="imgf0005.tif" wi="121" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="94"> --><figure id="f0006" num="6"><img id="if0006" file="imgf0006.tif" wi="141" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="95"> --><figure id="f0007" num="7"><img id="if0007" file="imgf0007.tif" wi="152" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="96"> --><figure id="f0008" num="8"><img id="if0008" file="imgf0008.tif" wi="144" he="198" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="97"> --><figure id="f0009" num="9"><img id="if0009" file="imgf0009.tif" wi="164" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="98"> --><figure id="f0010" num="10"><img id="if0010" file="imgf0010.tif" wi="134" he="196" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="99"> --><figure id="f0011" num="11"><img id="if0011" file="imgf0011.tif" wi="164" he="229" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="100"> --><figure id="f0012" num="12"><img id="if0012" file="imgf0012.tif" wi="161" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="101"> --><figure id="f0013" num="13"><img id="if0013" file="imgf0013.tif" wi="133" he="219" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="102"> --><figure id="f0014" num="14"><img id="if0014" file="imgf0014.tif" wi="117" he="221" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="103"> --><figure id="f0015" num="15"><img id="if0015" file="imgf0015.tif" wi="133" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="104"> --><figure id="f0016" num="16"><img id="if0016" file="imgf0016.tif" wi="145" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="105"> --><figure id="f0017" num="17"><img id="if0017" file="imgf0017.tif" wi="143" he="197" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="106"> --><figure id="f0018" num="18"><img id="if0018" file="imgf0018.tif" wi="147" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="107"> --><figure id="f0019" num="19"><img id="if0019" file="imgf0019.tif" wi="156" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="108"> --><figure id="f0020" num="20"><img id="if0020" file="imgf0020.tif" wi="129" he="230" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="109"> --><figure id="f0021" num="21"><img id="if0021" file="imgf0021.tif" wi="136" he="211" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="110"> --><figure id="f0022" num="22"><img id="if0022" file="imgf0022.tif" wi="148" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="111"> --><figure id="f0023" num="23"><img id="if0023" file="imgf0023.tif" wi="149" he="206" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="112"> --><figure id="f0024" num="24"><img id="if0024" file="imgf0024.tif" wi="124" he="182" img-content="drawing" img-format="tif"/></figure></drawings><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
