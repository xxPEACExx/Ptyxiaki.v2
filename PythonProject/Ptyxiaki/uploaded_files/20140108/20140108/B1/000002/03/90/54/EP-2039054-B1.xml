<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2039054-B1" country="EP" doc-number="2039054" kind="B1" date="20140108" family-id="38670050" file-reference-id="318249" date-produced="20180826" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146588691" ucid="EP-2039054-B1"><document-id><country>EP</country><doc-number>2039054</doc-number><kind>B1</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-07795184-A" is-representative="NO"><document-id mxw-id="PAPP154890174" load-source="docdb" format="epo"><country>EP</country><doc-number>07795184</doc-number><kind>A</kind><date>20070518</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140555974" ucid="US-2007012197-W" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>2007012197</doc-number><kind>W</kind><date>20070518</date></document-id></priority-claim><priority-claim mxw-id="PPC140548972" ucid="US-44196906-A" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>44196906</doc-number><kind>A</kind><date>20060526</date></document-id></priority-claim></priority-claims><dates-of-public-availability><intention-to-grant-date><date>20130604</date></intention-to-grant-date></dates-of-public-availability><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1989326369" load-source="docdb">H04L   9/08        20060101ALI20130503BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1989326370" load-source="docdb">H04L  29/06        20060101ALI20130503BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1989326371" load-source="docdb">H04W  12/02        20090101AFI20130503BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1989326372" load-source="docdb">H04W  12/04        20090101ALI20130503BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1989326373" load-source="docdb">H04W  84/12        20090101ALI20130503BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-2081702616" load-source="docdb" scheme="CPC">H04L2463/062       20130101 LA20150323BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2081704366" load-source="docdb" scheme="CPC">H04L  63/0428      20130101 FI20150323BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2081705571" load-source="docdb" scheme="CPC">H04L2463/061       20130101 LA20150323BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2081705605" load-source="docdb" scheme="CPC">H04L  63/061       20130101 LI20150323BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2081705742" load-source="docdb" scheme="CPC">H04W  12/04        20130101 LI20150323BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2081707862" load-source="docdb" scheme="CPC">H04L2209/60        20130101 LA20150323BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2081709120" load-source="docdb" scheme="CPC">H04W  84/12        20130101 LA20150323BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2081709620" load-source="docdb" scheme="CPC">H04L2209/80        20130101 LA20150323BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2081711963" load-source="docdb" scheme="CPC">H04L   9/0822      20130101 LI20150323BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2081712577" load-source="docdb" scheme="CPC">H04W  12/02        20130101 LA20150323BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2083234021" load-source="docdb" scheme="CPC">H04W  12/10        20130101 LA20150320BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132370706" lang="DE" load-source="patent-office">VERSCHLÜSSELUNGSVERFAHREN FÜR SICHERE PAKETÜBERTRAGUNG</invention-title><invention-title mxw-id="PT132370707" lang="EN" load-source="patent-office">ENCRYPTION METHOD FOR SECURE PACKET TRANSMISSION</invention-title><invention-title mxw-id="PT132370708" lang="FR" load-source="patent-office">PROCÉDÉ DE CHIFFREMENT POUR LA TRANSMISSION SÉCURISÉE D'UN PAQUET</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR919545965" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ALCATEL LUCENT</last-name><address><country>FR</country></address></addressbook></applicant><applicant mxw-id="PPAR919538055" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>ALCATEL LUCENT</last-name></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919538027" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>PATEL SARVAR</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919529472" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>PATEL, SARVAR</last-name></addressbook></inventor><inventor mxw-id="PPAR919024294" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>PATEL, SARVAR</last-name><address><street>34 Millers Lane</street><city>Montville, NJ 07045</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919505202" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>SUNDARAM GANAPAHTY SUBRAMANIAN</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919541829" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>SUNDARAM, GANAPAHTY, SUBRAMANIAN</last-name></addressbook></inventor><inventor mxw-id="PPAR919024295" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>SUNDARAM, GANAPAHTY, SUBRAMANIAN</last-name><address><street>10 Hickory Hill Road</street><city>Hillsborough, NJ 08844</city><country>US</country></address></addressbook></inventor></inventors><assignees><assignee mxw-id="PPAR919024296" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Alcatel Lucent</last-name><iid>101294794</iid><address><street>3, Avenue Octave Gréard</street><city>75007 Paris</city><country>FR</country></address></addressbook></assignee></assignees><agents><agent mxw-id="PPAR919024297" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Sciaux, Edmond</last-name><suffix>et al</suffix><iid>101317085</iid><address><street>Alcatel-Lucent International Intellectual Property &amp; Standards 32 Avenue Kléber</street><city>92700 Colombes</city><country>FR</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="US-2007012197-W"><document-id><country>US</country><doc-number>2007012197</doc-number><kind>W</kind><date>20070517</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2007139794-A2"><document-id><country>WO</country><doc-number>2007139794</doc-number><kind>A2</kind><date>20071206</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS549895585" load-source="docdb">AT</country><country mxw-id="DS549925099" load-source="docdb">BE</country><country mxw-id="DS549787877" load-source="docdb">BG</country><country mxw-id="DS549879226" load-source="docdb">CH</country><country mxw-id="DS549804958" load-source="docdb">CY</country><country mxw-id="DS549895586" load-source="docdb">CZ</country><country mxw-id="DS549789338" load-source="docdb">DE</country><country mxw-id="DS549925100" load-source="docdb">DK</country><country mxw-id="DS549804959" load-source="docdb">EE</country><country mxw-id="DS549872793" load-source="docdb">ES</country><country mxw-id="DS549787878" load-source="docdb">FI</country><country mxw-id="DS549787879" load-source="docdb">FR</country><country mxw-id="DS549925101" load-source="docdb">GB</country><country mxw-id="DS549925102" load-source="docdb">GR</country><country mxw-id="DS549804964" load-source="docdb">HU</country><country mxw-id="DS549879227" load-source="docdb">IE</country><country mxw-id="DS549925103" load-source="docdb">IS</country><country mxw-id="DS549787880" load-source="docdb">IT</country><country mxw-id="DS549804965" load-source="docdb">LI</country><country mxw-id="DS549789339" load-source="docdb">LT</country><country mxw-id="DS549895587" load-source="docdb">LU</country><country mxw-id="DS549789340" load-source="docdb">LV</country><country mxw-id="DS549789349" load-source="docdb">MC</country><country mxw-id="DS549882962" load-source="docdb">MT</country><country mxw-id="DS549895588" load-source="docdb">NL</country><country mxw-id="DS549895593" load-source="docdb">PL</country><country mxw-id="DS549872798" load-source="docdb">PT</country><country mxw-id="DS549895594" load-source="docdb">RO</country><country mxw-id="DS549895595" load-source="docdb">SE</country><country mxw-id="DS549789350" load-source="docdb">SI</country><country mxw-id="DS549879228" load-source="docdb">SK</country><country mxw-id="DS549882963" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><description mxw-id="PDES63961110" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><b><u>Field of the Invention</u></b></heading><p id="p0001" num="0001">This invention relates to security and authentication in wireless systems, and more particularly to wireless systems adapted for sending and receiving packet data.</p><heading id="h0002"><b><u>Art Background</u></b></heading><p id="p0002" num="0002">Modem wireless systems, such as those of the third generation and beyond, are being adapted to send and receive packet data at transfer rates of hundreds, and even of thousands, of kilobits per second. By way of illustration, <figref idrefs="f0001">FIG. 1</figref> shows the high-level architecture of one type of third-generation wireless system, referred to as "UMTS" for "Universal Mobile Telecommunications System." As seen in the figure, mobile user terminal 10 communicates over an air interface with base station 20. A base station may also be referred to in this context as a "Node B". Base station 20 communicates with a backhaul network 30, which includes Radio Network Controller (RNC) 40, Authentication Center (AuC) 50, Mobile Switching Center (MSC) 60, and element 70, which as shown combines the functions of SGSN and GGSN.</p><p id="p0003" num="0003">The RNC controls a set of base stations that are connected to it. Its function is to manage radio resources. For example, it controls the set-up and tear-down of calls and the processing of voice and data traffic. It also manages hard and soft handoff between cells.</p><p id="p0004" num="0004">The AuC authenticates each user who tries to log onto the network. More specifically, the AuC authenticates the SIM card located in the entering user's terminal. For each subscriber, a unique secret key is shared between the subscriber and the AuC. The AuC challenges the entering subscriber by sending him a random number which is to be hashed or encrypted with the shared key, and the result returned to the AuC. If the result that has been returned matches the AuC's own result from the same operation, the user will be admitted to the network. The secret information which is shared between the AuC and the user is also used to create a ciphering key CK which provides security when the user and the base station communicate with each other over the air.<!-- EPO <DP n="2"> --></p><p id="p0005" num="0005">It should be noted in this regard that according to other standards, such as certain North American CDMA standards, the cellphone which operates as a user terminal does not include a SIM card. Instead, an electronic serial number (ESN) is inscribed in the cellphone hardware by the manufacturer. In addition, the wireless carrier may identify the cellphone by a mobile identification number (MIN). The ESN and the MIN may be used together for identification, and may be used in procedures for authentication and security. It should further be noted that according to certain standards, including certain North American standards for 3GPP2, functions similar to those of the AuC may be carried out by a network element referred to as the "AAA server", in which "AAA" stands for "Authentication, Authorization, and Accounting."</p><p id="p0006" num="0006">Turning again to <figref idrefs="f0001">FIG. 1</figref>, the MSC is a telephone exchange that supports, among other things, circuit-switched calling and mobility management for users who are roaming within its service area. Data can be delivered directly to the MSC from the wired network in digitally encoded form. As seen in the figure, the MSC connects to the public switched telephone network (PSTN). The AuC acts indirectly through the MSC to perform its authentication function.</p><p id="p0007" num="0007">The SGSN ("Serving GPRS Support Node") tracks the locations of the user terminals within its service area, supports billing and security functions, tunnels downlink packets toward the RNC, and detunnels uplink packets from the RNC. The tunneling and detunneling of packets are in accordance with the GPRS Tunneling Protocol (GTP), which among other things makes it possible for mobile users to maintain connection to the internet while moving from place to place.</p><p id="p0008" num="0008">The GGSN ("Gateway GPRS Support Node") functions as an IP router with respect to external packet data networks. As seen in the figure, for example, the GGSN connects to the "IP network." The GGSN also supports security and billing functions. In accordance with GTP, the GGSN makes the conversion between the ordinary IP packets transported on the external packet networks, and the GTP packets that are tunneled within the UMTS core network. To the external packet network, it appears as though the user, although possibly moving from place to place, is fixed at the GGSN.</p><p id="p0009" num="0009">It should be noted in this regard that according to other standards, such as certain North American CDMA standards, the RNC is connected to a PDSN instead of an SGSN.<!-- EPO <DP n="3"> --> The PDSN in turn is connected to a Home Agent (HA). Also, the tunneling protocols used for communication between the PDSN and the RNC and over to the Base Station do not involve GTP. Other systems and standards, such as the IEEE 802.16 based WiMAX system, use a different hierarchy consisting of base stations connected to an Access Gateway (AGW). Overall, the functionality is similar although the details are different.</p><p id="p0010" num="0010">The base station is typically in an exposed location, and therefore relatively insecure against physical intrusion. On the other hand, the RNC, MSC, SGSN, and GGSN are typically situated in central offices, where sensitive network information can be protected against eavesdropping, tampering, sabotage, and theft.</p><p id="p0011" num="0011">Thus, the execution of security-related functions is confined to those network elements that are physically secure, whereas the base station acts only to forward encrypted data, without decoding the encrypted messages. Because it is assumed that the physically secure network elements are interconnected by a network that is likewise secure, there are generally no mandatory requirements to additionally set up secure tunnels between those network elements.</p><p id="p0012" num="0012">Various advanced architectures have been proposed, which may lead to greater exposure, and less physical security, at certain network elements. For example, a flat IP architecture such as the BSR (Base Station Router) architecture integrates most of the functionality of the RNC, SGSN, and GGSN into the base station. (Another version of the BSR architecture relates to the SAE/LTE architecture rather than the UMTS architecture. In this second type of BSR, the eNB, MME, and UPE are integrated into the base station. The preceding abbreviations respectively stand for "enhanced Node B", "Mobility Management Entity", and "User Plane Entity.")</p><p id="p0013" num="0013">Thus, <figref idrefs="f0002">FIG. 2</figref>, for example, shows mobile user 80 in radio communication with BSR 90, which connects in turn to a backhaul network including AuC 100, SIP server 110, an IP network, and the PSTN. As seen in the figure, the IP network connects the BSR to the AuC and the SIP server. SIP ("Session Initiation Protocol") is an internet signaling protocol for VoIP ("Voice over IP") as well as other types of interactive user sessions involving multiple kinds of media. In the figure, the SIP server block is meant to represent all the support functions for VoIP and the like.<!-- EPO <DP n="4"> --></p><p id="p0014" num="0014">In the BSR and similar architectures, encryption and other security-related functions, and even keys and other sensitive information, may reside at physically exposed locations. Moreover, the BSR might make external connections through a public IP network that is vulnerable to eavesdropping and tampering. Because of such increased exposure, there is a need for new safeguards against malicious activity.</p><p id="p0015" num="0015">However, because physical protection of the backhaul network cannot be guaranteed, it is desirable for such new safeguards to be logically based, at least in part. On the other hand, a new logically based safeguard may face opposition because, e.g., it is incompatible with some wireless standards, or because while conforming to wireless standards it is incompatible with internet standards.</p><p id="p0016" num="0016">Thus one need, in particular, is for a safeguard against malicious attacks that is effective end-to-end, i.e. between a wireless user terminal and a node of the IP network, or between two wireless user terminals connected via the IP network, and which moreover can be implemented without major changes to existing IP standards.</p><heading id="h0003"><b><u>Summary of the Invention</u></b></heading><p id="p0017" num="0017">We have developed such a safeguard. Accordingly, our invention involves transmitting a packet <i>p</i> between two endpoint nodes, designated <b>A</b> and <b>B,</b> in a network of nodes interconnected by links.</p><p id="p0018" num="0018">According to a first broad example, an end-to-end key is established using extant hop-by-hop security associations. To send information "end-to-end" in this regard means to send it between any pair of network entities where there is a transition from one type of network or protocol to another, from one subscriber network to another, or from one service provider to another, or where a user terminal is situated, or where there is any other kind of endpoint for a message.</p><p id="p0019" num="0019">For example, <b>A</b> establishes an end-to-end key Packet Encryption Key (PEK) with <b>B.</b> Information needed to establish the key is securely transferred between <b>A</b> and <b>B</b> by using extant hop-by-hop security associations. The key PEK is packet-specific. The packet <i>p</i> is encrypted with the key PEK and transmitted from <b>A</b> to <b>B.</b></p><p id="p0020" num="0020">In specific examples, the key PEK is generated at <b>A</b> and transmitted through the network to <b>B.</b><!-- EPO <DP n="5"> --></p><p id="p0021" num="0021">In other specific examples, <b>A</b> establishes a session with <b>B.</b> By "session" is meant a mutual agreement for the exchange of data packets between entities having distinct IP addresses for a period of time having a beginning and an end. <b>A</b> and <b>B</b> both obtain at least one session key SEK. For example, <b>A</b> may create a session key SEK and send it to <b>B.</b> Then, <b>A</b> and <b>B</b> each independently create the packet-specific encryption key PEK from at least the session key SEK and from a unique property of the packet p using a known algorithm. The session key is securely sent from <b>A</b> to <b>B</b> using extant hop-by-hop security associations.</p><p id="p0022" num="0022">At least one hop of the network path from <b>A</b> to <b>B</b> may take place between a pair of nodes that share an integrity key. For example, <b>A</b> may be a wireless user terminal that shares an integrity key with its serving base transceiver node. Similarly, <b>B</b> may also be a wireless user terminal that shares an integrity key with its serving base transceiver node. By "base transceiver node" is meant a base station, node-B, base transceiver station, BSR, or any other element of a wireless network having a similar function.</p><p id="p0023" num="0023">A second broad example involves a method in which a packet-specific encryption key PEK is used to encrypt a packet <i>p</i>. A signature of the key PEK is independently computed at each of two nodes, using an integrity key shared by the two nodes. The signature is sent from one of the two nodes to the other in association with the packet <i>p</i>. The receiving node uses the signature to verify the packet <i>p</i>.</p><p id="p0024" num="0024">In this regard, to "verify" the packet means to verify that the originator of the packet had possession of the PEK. It should be noted that verification of a packet in this sense does not necessarily guarantee that the packet is free of unauthorized modification, as by tampering, for example.</p><p id="p0025" num="0025">In specific examples, the nodes that share an integrity key are a wireless user terminal and the base transceiver node that serves it.</p><p id="p0026" num="0026">In specific examples, the packet <i>p</i> is sent from a first wireless user <b>A</b> through a network to a second wireless user <b>B.</b> User <b>A</b> and the base transceiver node that serves it use a signature of the key PEK to verify the authenticity of the packet <i>p</i>, and likewise for User <b>B</b> and the base transceiver node that serves it.<!-- EPO <DP n="6"> --></p><heading id="h0004"><b><u>Brief Description of the Drawing</u></b></heading><p id="p0027" num="0027"><ul><li><figref idrefs="f0001">FIG. 1</figref> is a high-level block diagram of the architecture of a UMTS system of the prior art.</li><li><figref idrefs="f0002">FIG. 2</figref> is a high-level block diagram of a wireless system using a BSR.</li><li><figref idrefs="f0003">FIG. 3</figref> is a high-level block diagram in which two mobile user terminals are connected to each other through respective BSRs which communicate with each other via multiple hops through an IP network.</li><li><figref idrefs="f0004">FIG. 4</figref> is a flowchart of an exemplary procedure by which a user initiates a session and distributes a session code to the target user.</li><li><figref idrefs="f0005">FIG. 5</figref> is a flowchart of an exemplary procedure by which the initiating user sends a packet to the target user.</li><li><figref idrefs="f0006">FIG. 6</figref> is a flowchart of an exemplary procedure by which the target user and the BSR that serves it authenticate the packet sent by the initiating user.</li><li><figref idrefs="f0007">FIG. 7</figref> is a schematic diagram of a packet format that may be used in connection with certain of the methods to be described below.</li></ul></p><heading id="h0005"><b><u>Detailed Description</u></b></heading><p id="p0028" num="0028">For illustrative purposes, we will describe an example in which our new methods are applied in the context of a UMTS network. However, it should be noted that the methods to be described are more general in application. For example, they may be applied in the context of wireless services that comply with any of a broad range of standards, of which the GSM and UMTS standards are only two examples. Furthermore, they maybe applied in contexts in which the access technology is wireline, as well as those in which it is wireless. Still further, our methods are usefully applied in the context of services of various kinds, which may include, for example, conventional wireless services as well as application-level services such as Voice over IP (VoIP). Still further, the security enhancements that our methods may provide may relate to security between access terminals as hardware entities, or they may with equal advantage relate to security between users, i.e., between human beings who are identified as subscribers to a service.</p><p id="p0029" num="0029">As noted above, the Authentication Center (AuC) in a UMTS network authenticates the SIM card located in the terminal of a subscriber attempting to sign onto<!-- EPO <DP n="7"> --> the network. The authentication process relies on a secret key that is shared between the subscriber and the AuC. More specifically, a static key referred to as the "root key" is stored within the subscriber's SIM card, and is also stored within the wireless network. In typical UMTS networks, the root key is stored in the AuC, but may be stored in other network elements such as the Home Location Register (HLR). The user terminal and the network each locally generate the ciphering key CK, as well as an integrity key IK, from the root key. It should be noted that various other wireless standards, such as those for GSM, TDMA, and CDMA systems, describe similar procedures for authentication and security.</p><p id="p0030" num="0030">In an illustrative scenario, as shown in <figref idrefs="f0003">FIG. 3</figref>, user terminal 120 authenticates itself to the network as e.g. described above, via communications over the air with BSR 130. Terminal 120 then establishes a session with user terminal 140, which is served by BSR 150. The procedures by which the session is established will typically be conducted according to well-known standards, and therefore need not be described here in detail. Examples of such standards, in the broadband wireless context, are the 3GPP and 3GPP2 standards, as well as the IEEE 802.16 WiMax standard.</p><p id="p0031" num="0031">In the figure, the IP network over which the BSRs communicate with each other is represented by three servers 161, 162, 163. The figure is provided purely for pedagogical purposes, and should not be understood as limiting as to the number of nodes or servers in the IP network or the number of users or BSRs, or in any other sense.</p><p id="p0032" num="0032">Communications between user terminal 120 and BSR 130 are advantageously protected by encryption. As explained above, in a UMTS system, for example, such communications will typically be protected by encrypting them with the ciphering key CK, and by using a further key IK to assure the integrity of messages exchanged between the user terminal and the BSR. Other node pairs consisting of a wireless user terminal and the BSR that serves it will likewise have their own ciphering key and integrity key. Thus, for example, the link between terminal 120 and BSR 130 is shown in the figure as protected by key 171, which more generally may be a vector of keys. Likewise, the link between terminal 140 and BSR 150 is protected by key 172.</p><p id="p0033" num="0033">The IP network, or other network, through which BSR 130 and BSR 150 communicate, may also use encryption to protect the messages that are sent through it.<!-- EPO <DP n="8"> --> There are various IETF standards, for example, that describe the use of encryption for such purposes. For example, the IPSec (Internet Security) architecture described in IETF standards documents includes protocols such as Encapsulating Security Payload (ESP) for encrypting data within the packet payload.</p><p id="p0034" num="0034">Typically, each hop will be protected by a different ciphering key. Thus, by way of example, <figref idrefs="f0003">FIG. 3</figref> shows each link of the IP network as protected by a respective one of keys 173-176.</p><p id="p0035" num="0035">It will generally be advantageous for communication between network nodes, such as user terminals 120 and 140 of <figref idrefs="f0003">FIG. 3</figref>, to use the hop-by-hop security measures described above. We will now describe further security measures, which offer enhanced protection against eavesdropping and tampering at exposed points in the network.</p><p id="p0036" num="0036">Turning to the procedure described in <figref idrefs="f0004">FIG. 4</figref>, it will be seen that an initiating user, now denominated "User <b>A</b>," wishes to establish a session with a target user, now denominated "User <b>B</b>." More generally, the initiating and target nodes may be any nodes in the network, and are not limited to wireless user terminals or the like. At block 180, the session is established according to well-known methods. At block 190, a ciphering key CK<sub>A,BSR-A</sub> and integrity key IK<sub>A,BSR-A</sub> are established between User <b>A</b> and its serving BSR, now denominated "BSR-A," as described above. It should be noted in this regard that this procedure is described in the context of BSR networks purely for illustrative purposes and not for purposes of limitation, and that it will find useful application in various kinds of communication network.</p><p id="p0037" num="0037">A session key SEK is now generated and exchanged between User <b>A</b> and BSR-A, as indicated at block 200. More generally, the session key may be a vector of two or more keys. For example, the vector of keys may include one or more keys for encrypting sessions, and one or more other keys for authenticating packets. For simplicity, we will refer to a single session key SEK, but it should be borne in mind that in fact a vector of two or more keys may be used.</p><p id="p0038" num="0038">The session key SEK will typically be generated by User <b>A</b> and transmitted to BSR-A under the protection of the ciphering key established between them. However, other arrangements are also possible. For example, BSR-A might generate the key and send it to User <b>A,</b> or a third party might distribute the key to both User <b>A</b> and BSR-A, or<!-- EPO <DP n="9"> --> User <b>A</b> and BSR-A might each compute the key locally using a pre-arranged algorithm and a shared piece of data. In any event, algorithms for generating session keys are well known, and need not be described here in detail. For example, suitable algorithms are described in the 3GPP and 3GPP2 standards. One specific example is provided by the Enhanced Cryptographic Algorithms (ECA) described in the 3GPP2 standard.</p><p id="p0039" num="0039">As indicated at blocks 210 and 220 of <figref idrefs="f0004">FIG. 4</figref>, the session key is forwarded to BSR-B and to User <b>B</b> under the protection of hop-by-hop encryption. That is, the session key is protected on each hop by a ciphering key provided in accordance with the security associations between the endpoints of that hop. As a consequence, the session key may be decrypted at each intermediate node, such as each of nodes 161-163 of <figref idrefs="f0003">FIG. 3</figref>, and then reencrypted according to the security association between the current node and the next node. Over the last hop, from BSR-B to User <b>B,</b> the session key will typically be encrypted using the ciphering key that was established when User <b>B</b> authenticated itself to the network.</p><p id="p0040" num="0040">Turning to <figref idrefs="f0005">FIG. 5</figref>, it will be seen at block 230 that User A now generates a packet which is to be transmitted to User <b>B.</b> For each such packet that is to be transmitted, User A computes a packet encryption key PEK that is specific to that packet and no other. For example, the key PEK may be computed from inputs that include the session key and a unique property of the packet. One property of the packet that may be used is a sequence number or synchronized counter value. Thus, for example, the key PEK may be generated by performing a logical operation, such as XOR, between the counter value and the session key. In the event that there are multiple session keys, one session key in particular may be designated to be used for generating the keys PEK. As will be seen, the key PEK for each packet will also be locally computed at BSR-A, BSR-B, and User <b>B.</b></p><p id="p0041" num="0041">As indicated at block 240 of <figref idrefs="f0005">FIG. 5</figref>, User A also computes a signature of the key PEK, which we denote by SIGNATURE<sub>IK<sub2>A,BSR-A</sub2></sub> (PEK). Of course, other inputs may also be involved in the signature computation, such as random numbers, cryptographic synchronization parameters, subscriber profile ID (SPID), and the like. In particular, parameters that are not necessarily secret, but that are time-dependent, may be involved.<!-- EPO <DP n="10"> --></p><p id="p0042" num="0042">As indicated at block 250, User <b>A</b> sends the signature to BSR-A in association with the corresponding packet. The signature may be attached to the packet, e.g. as part of a header. Alternatively, the signature could be sent as an out-of-band transmission, e.g. in a control channel. As indicated at block 260, BSR-A independently performs a local computation of SIGNATURE<sub>IK<sub2>A,BSR-A</sub2></sub>(PEK).</p><p id="p0043" num="0043">As noted above, SIGNATURE<sub>IK<sub2>A,BSR-A</sub2></sub>(PEK) may be computed using the integrity key that is shared between the two nodes that are involved, which in this instance is the integrity key shared between User <b>A</b> and BSR-A. The signature SIGNATURE<sub>IKA,BSR-A</sub>(PEK) will typically be shorter than PEK. For example, it may be the result of a cryptographic compression or hash function. Such a function may take PEK as input, together with other quantities, such as random nonces and counter values, that are known to the entities that rightfully share the knowledge of PEK. Such functions are well known in the art and need not be described here in detail. One example of a function useful in this context is Secure Hash Function 1 (SHA-1), which is used in the HMAC standard of the IETF.</p><p id="p0044" num="0044">The purpose of a signature such as SIGNATURE<sub>IK<sub2>A,BSR-A</sub2></sub>(PEK) is to verify that the sender of the packet over a given link was in possession not only of the packet, but also of the key PEK and of the key used to create the signature. It would of course be possible to compute a signature of a larger block of data, such as the packet payload. However, the PEK signature is advantageous because it provides effective packet verification while significantly reducing the demand on computational resources at the user terminals and BSRs.</p><p id="p0045" num="0045">In the example network described above, the given link may be the link from User <b>A</b> to BSR-A, or as will be seen, the link from BSR-B to User <b>B.</b> Because these links are over the air, they may be particularly vulnerable to attacks in which a spurious packet is injected into a session, or an old packet is reinjected into the session, e.g. after it has been modified. Because PEK is not transmitted, it cannot be intercepted by an attacker. Instead, the attacker would have to compute it, but this is possible only in the unlikely event that the session code is intercepted, together with other information. Thus, interloping packets may be detected and rejected at the receiving end of the link.<!-- EPO <DP n="11"> --> Accordingly, as indicated at block 270, BSR-A will accept the packet as authentic only if the locally computed value of SIGNATURE<sub>IK<sub2>A,BSR-A</sub2></sub>(PEK) matches the value received from User <b>A.</b> If the packet is accepted, BSR-A then forwards the packet through the network to BSR-B, as indicated at block 280. Each pair of adjacent nodes on the path taken by the packet through the network may share a unique ciphering key. Accordingly, the packet may be decrypted after each hop, and reencrypted with the new key prior to the next hop.</p><p id="p0046" num="0046">Typically, the content of the packet will be inaccessible to all of the intermediate nodes, because it will have been encrypted by User <b>A</b> using the key PEK. That is, even if the key PEK is distributed through the network (either directly or by distributing inputs such as SEK for generating PEK), knowledge of PEK can be denied to the intermediate nodes. For example, a secure IPSec tunnel may be established between BSR-A and BSR-B, or BSR-A and BSR-B may share a Central Security Server. By those or similar means, secure key distribution is readily accomplished. Of course, IPSec tunnels and the like could be used for secure transmission of all the packets of a session. However, such intense use of cryptographic protocols could place an intolerable burden on the computational resources at the intermediate nodes. Such a burden is avoided by, for example, using an IPSec tunnel only once per session, solely for key distribution.</p><p id="p0047" num="0047">The use of a Central Security Server or IPSec tunnel as described above, is one example of key distribution using extant hop-by-hop security associations. It is noteworthy in this regard that after the key distribution is completed, the Central Security Server need not be involved in routing packets belonging to the pertinent session. Thus, only limited use is made of the Central Security Server.</p><p id="p0048" num="0048">The sequence of steps illustrated in <figref idrefs="f0006">FIG. 6</figref>, to which attention is now directed, begins at block 290 with receipt of the packet by BSR-B. The packet will typically arrive as encrypted with the ciphering key that BSR-B shares with the preceding node. Accordingly, as indicated at block 300, BSR-B decrypts the packet relative to that ciphering key.</p><p id="p0049" num="0049">As further indicated at block 300, BSR-B independently performs a local computation of SIGNATURE<sub>IK<sub2>B,BSR-B</sub2></sub>(PEK). Typically, this computation will be similar<!-- EPO <DP n="12"> --> to the computation of SIGNATURE<sub>IK<sub2>A,BSR-A</sub2></sub>(PEK). However, the integrity key between BSR-B and User <b>B</b> will be used as input instead of the integrity key between BSR-A and User <b>A.</b></p><p id="p0050" num="0050">At block 310, BSR-B reencrypts the packet using the ciphering key that it shares with User <b>B,</b> and forwards it to User B. As indicated at block 320, BSR-B also sends SIGNATURE<sub>IK<sub2>B,BSR-B</sub2></sub>(PEK) to User <b>B</b> in association with the packet, through either an in-band or an out-of-band transmission as discussed earlier in reference to the signature SIGNATURE<sub>IK<sub2>A,BSR-A</sub2></sub>(PEK). At block 330, BSR-B decrypts the packet and performs an independent, local computation of SIGNATURE<sub>IK<sub2>B,BSR-B</sub2></sub>(PEK). If the locally computed value matches the value sent by BSR-B, the packet will be accepted as verified, i.e., as a packet verified to have been originated by an entity having possession of the PEK.</p><p id="p0051" num="0051">As noted above, the PEK for each packet may be locally computed at the start and end nodes of the first hop and at the start and end nodes of the last hop. A session key is used as input for computing the PEK. The session key is transmitted through the network in encrypted form, using extant hop-by-hop security associations.</p><p id="p0052" num="0052">In other examples, however, the session key is optional, and the PEK is forwarded through the network using hop-by-hop encryption. For example, User <b>A</b> (as an example of an initiating node) encrypts the packet, or at least the packet payload, with PEK. User <b>A</b> also encrypts PEK, using the ciphering key that it shares with BSR-A (as an example of the end node of the first hop), and signs PEK using the integrity key that it shares with BSR-A. The encrypted PEK and its signature are sent from User <b>A</b> to BSR-A in association with the packet, as described above in reference to the signature SIGNATURE<sub>IK<sub2>A,BSR-A</sub2></sub>(PEK).</p><p id="p0053" num="0053">With reference to <figref idrefs="f0007">FIG. 7</figref>, for example, packet 400 includes IP header 410, payload 420, and PEK field 430. Payload 420 is encrypted end-to-end with PEK.</p><p id="p0054" num="0054">The PEK is sent through the network from BSR-A to BSR-B along with the packet, using hop-by-hop encryption. Thus, PEK may be decrypted and reencrypted at each intermediate node, but without decryption of the packet at the intermediate nodes.<!-- EPO <DP n="13"> --> In typical packets, the payload in field 420 may be 1500 bytes long, whereas the encrypted PEK in field 430 may be only 128 bits long. Thus, it will be clear that decrypting and reencrypting only the PEK saves a great deal of computational resources.</p><p id="p0055" num="0055">In the example of <figref idrefs="f0007">FIG. 7</figref>, the contents of PEK field 430 are encrypted with the ciphering key CK<sub>A,BSR-A</sub> on the first hop, i.e., the hop from User <b>A</b> to BSR-A. On each hop of the path from BSR-A to BSR-B, the contents of field 430 are encrypted with, e.g., the pertinent IPSec key. Thus, if there are two or more such hops, a chain of IPSec associations may be used to protect the PEK.</p><p id="p0056" num="0056">At BSR-B, PEK is encrypted using the ciphering key CK<sub>B,BSR-B</sub> that BSR-B shares with User <b>B,</b> and signed using the integrity key that BSR-B shares with User <b>B.</b> The encrypted PEK is sent from BSR-B to User <b>B</b> in field 430, and the PEK signature is sent from BSR-B to User <b>B</b> in association with the packet.</p><p id="p0057" num="0057">If the SEK is to be forwarded through the network, the forwarding may be carried out by any of various possible techniques. According to one such technique, the first traffic packet of a new session is sent with at least its payload encrypted with the pertinent PEK. When User <b>A</b> sends the packet to BSR-A, it attaches the SEK, as encrypted by the ciphering key which User A shares with BSR-A. BSR-A decrypts the SEK and distributes it to BSR-B using extant security associations. When BSR-B sends the packet to User <b>B,</b> it attaches the SEK, as encrypted by the ciphering key which User <b>B</b> shares with BSR-B.</p><p id="p0058" num="0058">According to one of various alternative techniques, the SEK is distributed during call set-up using the pertinent protocols. For example, SEK may be distributed along With SIP (Session Initiation Protocol) messages for setting up a VoIP call or, e.g., a service based on IMS (IP Multimedia Subsystem).</p></description><claims mxw-id="PCLM56986070" lang="DE" load-source="patent-office"><!-- EPO <DP n="19"> --><claim id="c-de-01-0001" num="0001"><claim-text>Verfahren zum Übertragen eines Pakets zwischen einem ersten (120) Endpunktknoten und einem zweiten (140) Endpunktknoten in einem Netzwerk von Knoten, welche durch Verbindungsabschnitte miteinander verbunden sind, umfassend:
<claim-text>Erstellen eines Ende-zu-Ende-Schlüssels zur sicheren Übertragung des besagten Pakets durch ein Netzwerk von dem besagten ersten Endpunkt (120) an den besagten zweiten Endpunkt (140); und</claim-text>
<claim-text>Übertragen des Pakets von dem ersten Endpunktknoten (120) an den zweiten Endpunktknoten (140) durch aufeinanderfolgende Verbindungsabschnitte über aufeinanderfolgende Zwischenknoten (130, 161-163, 150);</claim-text>
<claim-text>wobei das Erstellen des Ende-zu-Ende-Schlüssels das Übertragen von Informationen durch das Netzwerk von dem ersten Endpunktknoten (120) an den zweiten Endpunktknoten (140) unter dem Schutz von Sprung-für-Sprung-Sicherheits-Assoziationen (171-176), wobei jeder Sprung zwischen einem Paar von Zwischenknoten, welche sich einen Verschlüsselungsschlüssel teilen, stattfindet, und wobei jede Sicherheits-Assoziation einem jeden der besagten aufeinanderfolgenden Verbindungsabschnitte entspricht, und das Verwenden der besagten Informationen für die Berechnung des Ende-zu-Ende-Schlüssels umfasst.</claim-text></claim-text></claim><claim id="c-de-01-0002" num="0002"><claim-text>Verfahren nach Anspruch 1, wobei der Ende-zu-Ende-Schlüssel ein paketspezifischer Verschlüsselungsschlüssel, PEK, ist, und wobei das Erstellen des Ende-zu-Ende-Schlüssels das Übertragen eines Sitzungsverschlüsselungsschlüssels, SEK, von dem ersten Endpunkt (140) an den zweiten Endpunkt (140) unter dem Schutz der besagten Sprung-für-Sprung-Sicherheits-Assoziationen (171-176) umfasst, so dass der paketspezifische Verschlüsselungsschlüssel, PEK, aus dem Sitzungsverschlüsselungsschlüssel und den paketspezifischen Informationen berechnet werden kann.</claim-text></claim><claim id="c-de-01-0003" num="0003"><claim-text>Verfahren nach Anspruch 1, wobei das Erstellen des Ende-zu-Ende-Schlüssels das Übertragen von Informationen durch das Netzwerk als Teil eines Verkehrspakets umfasst.</claim-text></claim><claim id="c-de-01-0004" num="0004"><claim-text>Verfahren nach Anspruch 1, wobei der Ende-zu-Ende-Schlüssel ein paketspezifischer Verschlüsselungsschlüssel ist, und wobei das Verfahren weiterhin umfasst:
<claim-text>Berechnen (240) einer Signatur des paketspezifischen Verschlüsselungsschlüssels unter Verwendung eines mit einem Knoten des Netzwerks,<!-- EPO <DP n="20"> --> welcher zwischen dem ersten und dem zweiten Endpunkt angeordnet ist, geteilten Integritätsschlüssels;</claim-text>
<claim-text>Übertragen des Pakets über den Zwischenknoten von dem ersten an den zweiten Endpunkt; und</claim-text>
<claim-text>Übertragen (250) der Signatur an den Zwischenknoten zusammen mit dem übertragenden Paket.</claim-text></claim-text></claim><claim id="c-de-01-0005" num="0005"><claim-text>Verfahren nach Anspruch 2, umfassend die folgenden an einem jeden Zwischenpunkt des besagten Netzwerks durchzuführenden Schritte:
<claim-text>Empfangen des besagten Sitzungsverschlüsselungsschlüssels, SEK, von einem vorausgehenden Knoten des Netzwerks unter dem Schutz einer Sicherheits-Assoziation mit dem besagten vorausgehenden Knoten;</claim-text>
<claim-text>Empfangen, von dem besagten vorausgehenden Knoten, eines weitergeleiteten Pakets (400) mit einem Nutzdatenteil (420), welcher mit dem besagten paketspezifischen Verschlüsselungsschlüssel, PEK, verschlüsselt ist; und</claim-text>
<claim-text>lokales Berechnen des paketspezifischen Verschlüsselungsschlüssels aus Eingaben, welche den Sitzungsverschlüsselungsschlüssel und für das weitergeleitete Paket spezifische Informationen umfassen.</claim-text></claim-text></claim><claim id="c-de-01-0006" num="0006"><claim-text>Verfahren nach Anspruch 5, weiterhin umfassend das Verwenden des lokal berechneten paketspezifischen Verschlüsselungsschlüssels, um das Paket zu entschlüsseln.</claim-text></claim><claim id="c-de-01-0007" num="0007"><claim-text>Verfahren nach Anspruch 5, weiterhin umfassend das Verwenden eines mit einem anderen Knoten des Netzwerks geteilten Integritätsschlüssels, um lokal eine Signatur des paketspezifischen Verschlüsselungsschlüssels zu berechnen (260; 330).</claim-text></claim><claim id="c-de-01-0008" num="0008"><claim-text>Verfahren nach Anspruch 7, wobei der Integritätsschlüssel mit dem besagten vorausgehenden Knoten geteilt wird, und wobei das Verfahren weiterhin das Vergleichen (270; 340) der lokal berechneten paketspezifischen Verschlüsselungsschlüssel-Signatur mit einer zusammen mit dem Paket empfangenen paketspezifischen Verschlüsselungsschlüssel-Signatur umfasst, um das Paket zu überprüfen.</claim-text></claim><claim id="c-de-01-0009" num="0009"><claim-text>Verfahren nach Anspruch 7, wobei der Integritätsschlüssel mit einem nachfolgenden Knoten des Netzwerks geteilt wird, und wobei das Verfahren weiterhin umfasst:<!-- EPO <DP n="21"> -->
<claim-text>Weiterleiten des Pakets an den nachfolgenden Knoten; und</claim-text>
<claim-text>Übertragen der lokal berechneten paketspezifischen Varschlüsselungsschlüssel-Signatur an den nachfolgenden Knoten zusammen mit dem Paket, um das Paket an den nachfolgenden Knoten zu überprüfen.</claim-text></claim-text></claim><claim id="c-de-01-0010" num="0010"><claim-text>Verfahren zum Verarbeiten eines Pakets in einem Netzwerk, welches einen ersten Knoten und einen zweiten Knoten, die sich einen Integritätsschlüssel teilen, einschließt, wobei das Verfahren umfasst:
<claim-text>Übertragen des Pakets von dem ersten Knoten an den zweiten Knoten, so dass mindestens ein Nutzdatenteil des Pakets mit einem paketspazifischen Verschlüsselungsschlüssel verschlüsselt wird;</claim-text>
<claim-text>Berechnen einer Signatur des paketspezifischen Verschlüsselungsschlüssels, welche für die Überprüfung des Pakets zu verwenden ist, wobei die Berechnung der Signatur unter Verwendung des Integritätsschlüssels durchgeführt wird; und</claim-text>
<claim-text>Übertragen der paketspezifischen Verschlüsselungsschlüssel-Signatur zusammen mit dem Paket an den zweiten Knoten.</claim-text></claim-text></claim><claim id="c-de-01-0011" num="0011"><claim-text>Verfahren zum Verarbeiten eines Pakets in einem Netzwerk, welches einen ersten Knoten und einen zweiten Knoten, die sich einen Integritätsschlüssel teilen, einschließt, wobei das Verfahren umfasst:
<claim-text>Empfangen des Pakets von dem ersten Knoten, so dass mindestens ein Nutzdatenteil des Pakets mit einem paketspezifischen Verschlüsselungsschlüssel verschlüsselt wird;</claim-text>
<claim-text>Empfangen einer Signatur des paketspezifischen Verschlüsselungsschlüssels von dem ersten Knoten;</claim-text>
<claim-text>Berechnen einer Signatur des paketspezifischen Verschlüsselungsschlüssels, wobei die besagte Berechnung unter Verwendung des Integritätsschlüssels durchgeführt wird;</claim-text>
<claim-text>Vergleichen der berechneten Schlüsselsignatur mit der empfangenen Schlüsselsignatur; und</claim-text>
<claim-text>wenn die berechnete Schlüsselsignatur mit der empfangenen Schlüsselsignatur übareinstimmt, Anerkennen des Pakets als überprüft.</claim-text></claim-text></claim><claim id="c-de-01-0012" num="0012"><claim-text>Verfahren nach Anspruch 11, weiterhin umfassend das Verwenden des paketspezifischen Verschlüsselungsschlüssels zur Entschlüsselung des Pakets.<!-- EPO <DP n="22"> --></claim-text></claim><claim id="c-de-01-0013" num="0013"><claim-text>Verfahren nach Anspruch 11, weiterhin umfassend das Weiterleiten des Pakets an ein Ziel, wenn das Paket als überprüft anerkannt wurde.</claim-text></claim></claims><claims mxw-id="PCLM56986071" lang="EN" load-source="patent-office"><!-- EPO <DP n="14"> --><claim id="c-en-01-0001" num="0001"><claim-text>A method for transmitting a packet between a first (120) endpoint node and a second (140) endpoint node in a network of nodes connected by links, comprising:
<claim-text>establishing an end-to-end key for secure transmission of said packet through a network from said first endpoint (120) to said second endpoint (140); and</claim-text>
<claim-text>transmitting the packet from the first endpoint node (120) to the second endpoint node (140) through successive links via successive intermediate nodes (130, 161-163, 150);</claim-text>
<claim-text>wherein establishing the end-to-end key comprises transmitting information through the network from the first endpoint node (120) to the second endpoint node (140) under the protection of hop-by-hop security associations (171-176), each hop taking place between a pair of intermediate nodes that share a ciphering key and each security association corresponding to each of said successive links, and using said information to compute the end-to-end key.</claim-text></claim-text></claim><claim id="c-en-01-0002" num="0002"><claim-text>The method of claim 1, wherein the end-to-end key is a packet-specific encryption key, PEK, and establishing the end-to-end key comprises transmitting a session encryption key, SEK, from the first endpoint (140) to the second endpoint (140) under the protection of said hop-by-hop security associations (171-176), such that the packet-specific encryption key, PEK, can be computed from the session encryption key and packet-specific information.</claim-text></claim><claim id="c-en-01-0003" num="0003"><claim-text>The method of claim 1, wherein establishing the end-to-end key comprises transmitting information through the network as part of a traffic packet.</claim-text></claim><claim id="c-en-01-0004" num="0004"><claim-text>The method of claim 1, wherein the end-to-end key is a packet-specific encryption key, and the method further comprises:
<claim-text>computing (240) a signature of the packet-specific encryption key using an integrity key shared with a node of the network situated intermediate the first and second endpoints;<!-- EPO <DP n="15"> --></claim-text>
<claim-text>transmitting the packet from the first to the second endpoint via the intermediate node; and</claim-text>
<claim-text>transmitting (250) the signature to the intermediate node in association with the transmitted packet.</claim-text></claim-text></claim><claim id="c-en-01-0005" num="0005"><claim-text>The method of claim 2, comprising the following steps to be performed at each intermediate node of said network,:
<claim-text>receiving said session encryption key, SEK, from a prior node of the network under protection of a security association with said prior node;</claim-text>
<claim-text>receiving from said prior node a forwarded packet (400) having a payload portion (420) that is encrypted with said packet-specific encryption key, PEK; and</claim-text>
<claim-text>locally computing the packet-specific encryption key from inputs which comprise the session encryption key and information specific to the forwarded packet.</claim-text></claim-text></claim><claim id="c-en-01-0006" num="0006"><claim-text>The method of claim 5, further comprising using the locally computed packet-specific encryption key to decrypt the packet.</claim-text></claim><claim id="c-en-01-0007" num="0007"><claim-text>The method of claim 5, further comprising using an integrity key shared with another node of the network to locally compute (260; 330) a signature of the packet-specific encryption key.</claim-text></claim><claim id="c-en-01-0008" num="0008"><claim-text>The method of claim 7, wherein the integrity key is shared with said preceding node, and the method further comprises comparing (270; 340) the locally computed packet-specific encryption key signature with a packet-specific encryption key signature received in association with the packet, thereby to verify the packet.</claim-text></claim><claim id="c-en-01-0009" num="0009"><claim-text>The method of claim 7, wherein the integrity key is shared with a subsequent node of the network, and the method further comprises:
<claim-text>forwarding the packet to the subsequent node; and<!-- EPO <DP n="16"> --></claim-text>
<claim-text>transmitting the locally computed packet-specific encryption key signature to the subsequent node in association with the packet, thereby to verify the packet to the subsequent node.</claim-text><!-- EPO <DP n="17"> --></claim-text></claim><claim id="c-en-01-0010" num="0010"><claim-text>A method for processing a packet in a network which includes a first node and a second node that share an integrity key, the method comprising:
<claim-text>transmitting the packet from the first node to the second node such that at least a payload portion of the packet is encrypted with a packet-specific encryption key;</claim-text>
<claim-text>computing a signature of the packet-specific encryption key to be used for verifying the packet, wherein said signature computation is carried out using the integrity key; and<!-- EPO <DP n="18"> --></claim-text>
<claim-text>transmitting the packet-specific encryption key signature to the second node in association with the packet.</claim-text></claim-text></claim><claim id="c-en-01-0011" num="0011"><claim-text>A method for processing a packet in a network which includes a first node and a second node that share an integrity key, the method comprising, at the second node:
<claim-text>receiving the packet from the first node such that at least a payload portion of the packet is encrypted with a packet-specific encryption key;</claim-text>
<claim-text>receiving a signature of the packet-specific encryption key from the first node;</claim-text>
<claim-text>computing a signature of the packet-specific encryption key, said computation carried out using the integrity key;</claim-text>
<claim-text>comparing the computed key signature with the received key signature; and</claim-text>
<claim-text>if the computed key signature agrees with the received key signature, accepting the packet as verified.</claim-text></claim-text></claim><claim id="c-en-01-0012" num="0012"><claim-text>The method of claim 11, further comprising using the packet-specific encryption key to decrypt the packet.</claim-text></claim><claim id="c-en-01-0013" num="0013"><claim-text>The method of claim 11, further comprising forwarding the packet toward a destination if the packet was accepted as verified.</claim-text></claim></claims><claims mxw-id="PCLM56986072" lang="FR" load-source="patent-office"><!-- EPO <DP n="23"> --><claim id="c-fr-01-0001" num="0001"><claim-text>Procédé pour transmettre un paquet entre un premier noeud d'extrémité (120) et un deuxième noeud d'extrémité (140) dans un réseau de noeuds connectés par des liaisons, comprenant les étapes suivantes :
<claim-text>établir une clé de bout en bout pour la transmission sécurisée dudit paquet à travers un réseau entre ledit premier point d'extrémité (120) et ledit deuxième point d'extrémité (140) ; et</claim-text>
<claim-text>transmettre le paquet entre le premier noeud d'extrémité (120) et le deuxième noeud d'extrémité (140) à travers des liaisons successives par l'intermédiaire de noeuds intermédiaires successifs (130, 161 à 163, 150) ;</claim-text>
<claim-text>dans lequel l'établissement de la clé de bout en bout comprend la transmission d'informations à travers le réseau entre le premier noeud d'extrémité (120) et le deuxième noeud d'extrémité (140) sous la protection d'associations de sécurité bond par bond (171 à 176), chaque bond se produisant entre une paire de noeuds intermédiaires qui partagent une clé de chiffrement et chaque association de sécurité correspondant à chacune desdites liaisons successives, et l'utilisation desdites informations pour calculer la clé de bout en bout.</claim-text></claim-text></claim><claim id="c-fr-01-0002" num="0002"><claim-text>Procédé selon la revendication 1, dans lequel la clé de bout en bout est une clé de chiffrement spécifique d'un paquet, PEK, et l'établissement de la clé de bout en bout comprend la transmission d'une clé de chiffrement de session, SEK, entre le premier point d'extrémité (140) et le deuxième point d'extrémité (140) sous la protection desdites associations de sécurité bond par bond (171 à 176), de sorte que la clé de chiffrement spécifique d'un paquet, PEK, puisse être calculée à partir de la clé de chiffrement de session et des informations spécifiques d'un paquet.</claim-text></claim><claim id="c-fr-01-0003" num="0003"><claim-text>Procédé selon la revendication 1, dans lequel l'établissement de la clé de bout en bout comprend la transmission d'informations à travers le réseau comme partie d'un paquet de trafic.</claim-text></claim><claim id="c-fr-01-0004" num="0004"><claim-text>Procédé selon la revendication 1, dans lequel la clé de bout en bout est une clé de chiffrement spécifique d'un paquet, et le Procédé comprend en outre les étapes suivantes :<!-- EPO <DP n="24"> -->
<claim-text>calculer (240) une signature de la clé de chiffrement spécifique d'un paquet en utilisant une clé d'intégrité partagée avec un noeud du réseau situé entre les première et deuxième extrémités ;</claim-text>
<claim-text>transmettre le paquet entre la première et la deuxième extrémités par l'intermédiaire du noeud intermédiaire ; et</claim-text>
<claim-text>transmettre (250) la signature au noeud intermédiaire en association avec le paquet transmis.</claim-text></claim-text></claim><claim id="c-fr-01-0005" num="0005"><claim-text>Procédé selon la revendication 2, comprenant les étapes suivantes devant être exécutées à chaque noeud intermédiaire dudit réseau :
<claim-text>recevoir ladite clé de chiffrement de session, SEK, à partir d'un noeud précédent du réseau sous la protection d'une association de sécurité avec ledit noeud précédent ;</claim-text>
<claim-text>recevoir à partir dudit noeud précédent un paquet transféré (400) ayant une partie de charge utile (420) qui est chiffrée avec ladite clé de chiffrement spécifique d'un paquet, PEK ; et</claim-text>
<claim-text>calculer localement la clé de chiffrement spécifique d'un paquet à partir d'entrées qui comprennent la clé de chiffrement de session et des informations spécifiques au paquet transféré.</claim-text></claim-text></claim><claim id="c-fr-01-0006" num="0006"><claim-text>Procédé selon la revendication 5, comprenant en outre l'utilisation de la clé de chiffrement spécifique d'un paquet calculée localement pour déchiffrer le paquet.</claim-text></claim><claim id="c-fr-01-0007" num="0007"><claim-text>Procédé selon la revendication 5, comprenant en outre l'utilisation d'une clé d'intégrité partagée avec un autre noeud du réseau pour calculer localement (260 ; 330) une signature de la clé de chiffrement spécifique d'un paquet.</claim-text></claim><claim id="c-fr-01-0008" num="0008"><claim-text>Procédé selon la revendication 7, dans lequel la clé d'intégrité est partagée avec ledit noeud précédent, et le procédé comprend en outre la comparaison (270 ; 340) de la signature de la clé de chiffrement spécifique d'un paquet calculée localement avec une signature de la clé de chiffrement spécifique d'un paquet reçue en association avec le paquet, afin de vérifier le paquet.</claim-text></claim><claim id="c-fr-01-0009" num="0009"><claim-text>Procédé selon la revendication 7, dans lequel la clé d'intégrité est partagée avec un noeud suivant du réseau, et le procédé comprend en outre les étapes suivantes :
<claim-text>transférer le paquet vers le noeud suivant ; et<!-- EPO <DP n="25"> --></claim-text>
<claim-text>transmettre la signature de la clé de chiffrement spécifique d'un paquet calculée localement au noeud suivant en association avec le paquet, afin de vérifier le paquet transféré vers le noeud suivant.</claim-text></claim-text></claim><claim id="c-fr-01-0010" num="0010"><claim-text>Procédé de traitement d'un paquet dans un réseau qui comprend un premier noeud et un deuxième noeud qui partagent une clé d'intégrité, le procédé comprenant les étapes suivantes :
<claim-text>transmettre le paquet à partir du premier noeud vers le deuxième noeud de sorte qu'au moins une partie de charge utile du paquet soit chiffrée avec une clé de chiffrement spécifique d'un parquet ;</claim-text>
<claim-text>calculer une signature de la clé de chiffrement spécifique d'un paquet devant être utilisée pour vérifier le paquet, dans lequel ledit calcul de la signature est effectué en utilisant la clé d'intégrité ; et</claim-text>
<claim-text>transmettre la signature de la clé de chiffrement spécifique d'un paquet au deuxième noeud en association avec le paquet.</claim-text></claim-text></claim><claim id="c-fr-01-0011" num="0011"><claim-text>Procédé de traitement d'un paquet dans un réseau qui comprend un premier noeud et un deuxième noeud qui partagent une clé d'intégrité, le procédé comprenant, au niveau du deuxième noeud les étapes suivantes :
<claim-text>recevoir le paquet à partir du premier noeud de sorte qu'au moins une partie de charge utile du paquet soit chiffrée avec une clé de chiffrement spécifique d'un parquet ;</claim-text>
<claim-text>recevoir une signature de la clé de chiffrement spécifique d'un paquet à partir du premier noeud ;</claim-text>
<claim-text>calculer une signature de la clé de chiffrement spécifique d'un paquet, ledit calcul étant effectué en utilisant la clé d'intégrité ;</claim-text>
<claim-text>comparer la signature de la clé calculée à la signature de la clé reçue ; et</claim-text>
<claim-text>si la signature de la clé calculée correspond à la signature de la clé reçue, accepter le paquet comme étant vérifié,</claim-text></claim-text></claim><claim id="c-fr-01-0012" num="0012"><claim-text>Procédé selon la revendication 11, comprenant en outre l'utilisation de la clé de chiffrement spécifique d'un paquet pour déchiffrer le paquet.</claim-text></claim><claim id="c-fr-01-0013" num="0013"><claim-text>Procédé selon la revendication 11, comprenant en outre le transfert du paquet vers une destination si le paquet a été accepté comme étant vérifié.</claim-text></claim></claims><drawings mxw-id="PDW16672342" load-source="patent-office"><!-- EPO <DP n="26"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="165" he="99" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="27"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="134" he="106" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="28"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="165" he="182" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="29"> --><figure id="f0004" num="4"><img id="if0004" file="imgf0004.tif" wi="136" he="137" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="30"> --><figure id="f0005" num="5"><img id="if0005" file="imgf0005.tif" wi="132" he="167" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="31"> --><figure id="f0006" num="6"><img id="if0006" file="imgf0006.tif" wi="131" he="170" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="32"> --><figure id="f0007" num="7"><img id="if0007" file="imgf0007.tif" wi="112" he="70" img-content="drawing" img-format="tif"/></figure></drawings><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
