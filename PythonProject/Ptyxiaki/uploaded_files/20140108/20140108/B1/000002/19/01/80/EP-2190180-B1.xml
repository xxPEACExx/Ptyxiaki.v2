<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2190180-B1" country="EP" doc-number="2190180" kind="B1" date="20140108" family-id="41625154" file-reference-id="315041" date-produced="20180826" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146588222" ucid="EP-2190180-B1"><document-id><country>EP</country><doc-number>2190180</doc-number><kind>B1</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-09174845-A" is-representative="YES"><document-id mxw-id="PAPP154850414" load-source="docdb" format="epo"><country>EP</country><doc-number>09174845</doc-number><kind>A</kind><date>20091103</date><lang>EN</lang></document-id><document-id mxw-id="PAPP172236000" load-source="docdb" format="original"><country>EP</country><doc-number>09174845.9</doc-number><date>20091103</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140550085" ucid="JP-2008297098-A" load-source="docdb"><document-id format="epo"><country>JP</country><doc-number>2008297098</doc-number><kind>A</kind><date>20081120</date></document-id></priority-claim><priority-claim mxw-id="PPC140549620" ucid="JP-2009020743-A" load-source="docdb"><document-id format="epo"><country>JP</country><doc-number>2009020743</doc-number><kind>A</kind><date>20090130</date></document-id></priority-claim></priority-claims><dates-of-public-availability><intention-to-grant-date><date>20130527</date></intention-to-grant-date></dates-of-public-availability><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-2063023034" load-source="ipcr">H04N  19/132       20140101ALI20150402RHJP        </classification-ipcr><classification-ipcr mxw-id="PCL-2063025162" load-source="ipcr">H04N  19/186       20140101ALI20150402RHJP        </classification-ipcr><classification-ipcr mxw-id="PCL-2063027180" load-source="ipcr">H04N  19/90        20140101ALI20150402RHJP        </classification-ipcr><classification-ipcr mxw-id="PCL-2063027230" load-source="ipcr">H04N  19/134       20140101ALI20150402RHJP        </classification-ipcr><classification-ipcr mxw-id="PCL-2063027997" load-source="ipcr">H04N  19/196       20140101ALI20150402RHJP        </classification-ipcr><classification-ipcr mxw-id="PCL-2063028873" load-source="ipcr">H04N  19/59        20140101ALI20150402RHJP        </classification-ipcr><classification-ipcr mxw-id="PCL-2063031748" load-source="ipcr">H04N  19/182       20140101ALI20150402RHJP        </classification-ipcr><classification-ipcr mxw-id="PCL1989325000" load-source="ipcr">H04N   1/41        20060101AFI20120110BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL2076381294" load-source="ipcr">H04N  19/00        20140101ALI20140318RHJP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-2137594115" load-source="docdb" scheme="CPC">H04N  19/105       20141101 LI20141108BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2137596060" load-source="docdb" scheme="CPC">H04N  19/176       20130101 LI20141108BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2137600126" load-source="docdb" scheme="CPC">H04N  19/132       20141101 LI20141108BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2137602705" load-source="docdb" scheme="CPC">H04N  19/136       20141101 LI20141108BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2137605090" load-source="docdb" scheme="CPC">H04N  19/70        20130101 LI20141108BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989622157" load-source="docdb" scheme="CPC">H04N   1/41        20130101 FI20130831BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132369299" lang="DE" load-source="patent-office">Bildcodierungsvorrichtung und Steuerverfahren dafür</invention-title><invention-title mxw-id="PT132369300" lang="EN" load-source="patent-office">Image encoding apparatus and method of controlling the same</invention-title><invention-title mxw-id="PT132369301" lang="FR" load-source="patent-office">Appareil de codage d'images et son procédé de commande</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR919544978" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>CANON KK</last-name><address><country>JP</country></address></addressbook></applicant><applicant mxw-id="PPAR919529918" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>CANON KABUSHIKI KAISHA</last-name></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919545110" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>SHIRAISHI YUKI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR919528659" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>SHIRAISHI, YUKI</last-name></addressbook></inventor><inventor mxw-id="PPAR919022108" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>SHIRAISHI, YUKI</last-name><address><street>c/o CANON KABUSHIKI KAISHA 30-2, Shimomaruko 3-chome Ohta-ku</street><city>Tokyo Tokyo 146-8501</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR919505277" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>KAJIWARA HIROSHI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR919526376" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>KAJIWARA, HIROSHI</last-name></addressbook></inventor><inventor mxw-id="PPAR919022106" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>KAJIWARA, HIROSHI</last-name><address><street>c/o CANON KABUSHIKI KAISHA 30-2, Shimomaruko 3-chome Ohta-ku</street><city>Tokyo Tokyo 146-8501</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR919539989" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>ITO NAOKI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR919532394" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>ITO, NAOKI</last-name></addressbook></inventor><inventor mxw-id="PPAR919022105" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>ITO, NAOKI</last-name><address><street>c/o CANON KABUSHIKI KAISHA 30-2, Shimomaruko 3-chome Ohta-ku</street><city>Tokyo Tokyo 146-8501</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR919523893" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>TAMURA HIROKAZU</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR919530424" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>TAMURA, HIROKAZU</last-name></addressbook></inventor><inventor mxw-id="PPAR919022107" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>TAMURA, HIROKAZU</last-name><address><street>c/o CANON KABUSHIKI KAISHA 30-2, Shimomaruko 3-chome Ohta-ku</street><city>Tokyo Tokyo 146-8501</city><country>JP</country></address></addressbook></inventor></inventors><assignees><assignee mxw-id="PPAR919022109" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Canon Kabushiki Kaisha</last-name><iid>101093230</iid><address><street>30-2 Shimomaruko 3-chome Ohta-ku</street><city>Tokyo 146-8501</city><country>JP</country></address></addressbook></assignee></assignees><agents><agent mxw-id="PPAR919022110" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>TBK-Patent</last-name><iid>100061560</iid><address><street>Bavariaring 4-6</street><city>80336 München</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS549868257" load-source="docdb">AT</country><country mxw-id="DS549890547" load-source="docdb">BE</country><country mxw-id="DS549923184" load-source="docdb">BG</country><country mxw-id="DS549800142" load-source="docdb">CH</country><country mxw-id="DS549871253" load-source="docdb">CY</country><country mxw-id="DS549868266" load-source="docdb">CZ</country><country mxw-id="DS549890548" load-source="docdb">DE</country><country mxw-id="DS549871254" load-source="docdb">DK</country><country mxw-id="DS549871255" load-source="docdb">EE</country><country mxw-id="DS549783805" load-source="docdb">ES</country><country mxw-id="DS549923185" load-source="docdb">FI</country><country mxw-id="DS549923186" load-source="docdb">FR</country><country mxw-id="DS549890553" load-source="docdb">GB</country><country mxw-id="DS549871256" load-source="docdb">GR</country><country mxw-id="DS549890554" load-source="docdb">HR</country><country mxw-id="DS549868267" load-source="docdb">HU</country><country mxw-id="DS549800143" load-source="docdb">IE</country><country mxw-id="DS549871257" load-source="docdb">IS</country><country mxw-id="DS549923187" load-source="docdb">IT</country><country mxw-id="DS549871262" load-source="docdb">LI</country><country mxw-id="DS549875934" load-source="docdb">LT</country><country mxw-id="DS549868268" load-source="docdb">LU</country><country mxw-id="DS549875935" load-source="docdb">LV</country><country mxw-id="DS549875936" load-source="docdb">MC</country><country mxw-id="DS549782842" load-source="docdb">MK</country><country mxw-id="DS549782843" load-source="docdb">MT</country><country mxw-id="DS549868269" load-source="docdb">NL</country><country mxw-id="DS549890555" load-source="docdb">NO</country><country mxw-id="DS549871263" load-source="docdb">PL</country><country mxw-id="DS549875937" load-source="docdb">PT</country><country mxw-id="DS549868274" load-source="docdb">RO</country><country mxw-id="DS549871264" load-source="docdb">SE</country><country mxw-id="DS549875942" load-source="docdb">SI</country><country mxw-id="DS549890556" load-source="docdb">SK</country><country mxw-id="DS549871265" load-source="docdb">SM</country><country mxw-id="DS549782844" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data></bibliographic-data><description mxw-id="PDES63960648" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001">BACKGROUND OF THE INVENTION</heading><heading id="h0002">Field of the Invention</heading><p id="p0001" num="0001">The present invention relates to an image encoding apparatus and a method of controlling the same.</p><heading id="h0003">Description of the Related Art</heading><p id="p0002" num="0002">Image data with a high resolution and a wide color gamut has an enormous data size and also requires high memory cost and long time for image processing or data transfer. This makes data handling difficult. To solve this problem, a method has conventionally been proposed which holds, for a plurality of pixels, one piece of color information and information representing the arrangement of the color, thereby converting an original resolution image into data in a smaller size (e.g., Japanese Patent Laid-Open No. <patcit id="pcit0001" dnum="JP2001313834A"><text>2001-313834</text></patcit>).</p><p id="p0003" num="0003">Another method has also been proposed which separates image data into text image portions and photo image portions and generates reduced images thereof. These pieces of information are held. To restore the original resolution image, restoration target pixels are predicted and restored based on the pixels of a reduced image of interest and their neighboring pixels (e.g., Japanese Patent Laid-Open No. <patcit id="pcit0002" dnum="JP10173913A"><text>10-173913</text></patcit>).</p><p id="p0004" num="0004">In a method of generating interpolation data as well as reduced images generated by resolution conversion, the interpolation data requires at least color information and arrangement information for color arrangement to reproduce the original resolution image. To do this, at least one piece of arrangement information needs to be held for one pixel of the original resolution image. Hence, the effect of<!-- EPO <DP n="2"> --> decreasing the code amount of the interpolation data is limited to 1/(data amount of one pixel).</p><p id="p0005" num="0005">In a method of interpolating a restoration target image based on a predetermined rule without generating interpolation data, data to be interpolated is only an estimated value. For this reason, it is impossible to losslessly reproduce the original resolution image.</p><heading id="h0004">SUMMARY OF THE INVENTION</heading><p id="p0006" num="0006">The present invention has been made in consideration of the above problems. The present invention provides a technique of generating reduced image data from original image data and adding efficient encoded data to the reduced image data, thereby restoring the original image data from the reduced image data. The present invention provides a technique of facilitating lossless and lossy conversion by controlling interpolation data.</p><p id="p0007" num="0007">The present invention in its first aspect provides an image encoding apparatus as specified in claims 1 to 7.</p><p id="p0008" num="0008">The present invention in its second aspect provides a method of controlling an image encoding apparatus for encoding image data, as specified in claim 8.</p><p id="p0009" num="0009">The present invention in its third aspect provides a computer-readable storage medium as specified in claim 9.</p><p id="p0010" num="0010">According to the present invention, it is possible to generate efficient encoded data to restore original image data from reduced image data.</p><p id="p0011" num="0011">Further features of the present invention will become apparent from the following description of exemplary embodiments with reference to the attached drawings.</p><heading id="h0005">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p0012" num="0012"><figref idrefs="f0001">Fig. 1</figref> is a flowchart illustrating the processing<!-- EPO <DP n="3"> --> procedure of interpolation data generation according to the first embodiment;</p><p id="p0013" num="0013"><figref idrefs="f0002">Fig. 2</figref> is a block diagram of an image processing apparatus according to the first embodiment;</p><p id="p0014" num="0014"><figref idrefs="f0003">Fig. 3</figref> is a view showing the relationship between image data and block data of 2 × 2 pixels according to the embodiment;</p><p id="p0015" num="0015"><figref idrefs="f0003">Fig. 4</figref> is a view showing the array of 2 × 2 pixels in block data of interest;</p><p id="p0016" num="0016"><figref idrefs="f0004">Fig. 5</figref> is a view showing examples of code words of first, second, and third additional information according to the first embodiment;</p><p id="p0017" num="0017"><figref idrefs="f0004">Figs. 6A and 6B</figref> are views showing examples of a process target image;</p><p id="p0018" num="0018"><figref idrefs="f0005">Fig. 7</figref> is a view showing an example of the data structure of interpolation data generated according to the first embodiment;</p><p id="p0019" num="0019"><figref idrefs="f0006">Fig. 8</figref> is a block diagram of an image processing apparatus according to the second embodiment;</p><p id="p0020" num="0020"><figref idrefs="f0007">Fig. 9</figref> is a flowchart illustrating the processing procedure of an additional information integration unit according to the second embodiment;</p><p id="p0021" num="0021"><figref idrefs="f0008">Figs. 10A, 10B, and 10C</figref> are views showing an image example and a process result example so as to explain an example of processing of the additional information integration unit according to the second embodiment;</p><p id="p0022" num="0022"><figref idrefs="f0009">Fig. 11</figref> is a block diagram of an image processing apparatus according to the third embodiment;</p><p id="p0023" num="0023"><figref idrefs="f0009">Fig. 12</figref> is a block diagram of an interpolation data generator according to the third embodiment;</p><p id="p0024" num="0024"><figref idrefs="f0010">Fig. 13</figref> is a flowchart illustrating the processing procedure of a flat determination unit according to the third embodiment;<!-- EPO <DP n="4"> --></p><p id="p0025" num="0025"><figref idrefs="f0011">Fig. 14</figref> is a block diagram of a computer which implements the image processing apparatus according to the embodiment;</p><p id="p0026" num="0026"><figref idrefs="f0012">Fig. 15</figref> is a flowchart illustrating the processing procedure of a non-flat block analysis unit according to the third embodiment;</p><p id="p0027" num="0027"><figref idrefs="f0013">Fig. 16</figref> is a view showing the types of two-color arrangement patterns according to the third embodiment;</p><p id="p0028" num="0028"><figref idrefs="f0014">Figs. 17A</figref> and <figref idrefs="f0015">17B</figref> are flowcharts illustrating the processing procedure of a non-flat block analysis unit according to the fourth embodiment;</p><p id="p0029" num="0029"><figref idrefs="f0016">Fig. 18</figref> is a view showing a block of interest and neighboring pixel positions according to the sixth embodiment;</p><p id="p0030" num="0030"><figref idrefs="f0017">Fig. 19</figref> is a flowchart illustrating the processing procedure of an interpolation data code amount control method according to the seventh embodiment;</p><p id="p0031" num="0031"><figref idrefs="f0018">Fig. 20</figref> is a block diagram of lossy interpolation data generation according to the seventh embodiment; and</p><p id="p0032" num="0032"><figref idrefs="f0019">Fig. 21</figref> is a flowchart illustrating the processing procedure of an interpolation data code amount control method according to the eighth embodiment.</p><heading id="h0006">DESCRIPTION OF THE EMBODIMENTS</heading><p id="p0033" num="0033">The embodiments of the present invention will now be described in detail with reference to the accompanying drawings.</p><heading id="h0007">[First Embodiment]</heading><p id="p0034" num="0034"><figref idrefs="f0002">Fig. 2</figref> is a block diagram of an image processing apparatus according to the embodiment. As is apparent from the following explanation, an example of the image processing apparatus to be described below integrates an arrangements related to image encoding and decoding. However, these<!-- EPO <DP n="5"> --> arrangements may be formed as separate apparatuses.</p><p id="p0035" num="0035">The image processing apparatus according to this embodiment externally inputs image data to be encoded, performs resolution conversion, and generates additional information to restore the original resolution image from a reduced image. Note that the image data input source is a storage medium which stores image data as a file. However, the source may be of any other type such as an image scanner.</p><p id="p0036" num="0036">The encoding target image data of this embodiment is monochrome multi-valued image data containing only luminance components. The description will be made assuming that a luminance component has eight bits (256 tones from 0 to 255). However, these assumptions merely aim at simplifying the description of the embodiment. The image data may contain a plurality of components (e.g., RGB or CMYK) in a color space of any type. In addition, the number of bits of one component is not limited to eight. The number of bits may exceed eight. The encoding target image is assumed to include 2 × W pixels in the horizontal direction and 2 × H pixels in the vertical direction (even numbers in both directions). Note that the horizontal and vertical sizes of an actual image do not always correspond to integer multiples of 2. In such a case, processing is performed assuming that pixels having virtual fixed values exist at the ends in the horizontal and vertical directions.</p><p id="p0037" num="0037">Encoding processing of the image encoding apparatus shown in <figref idrefs="f0002">Fig. 2</figref> will be described below.</p><p id="p0038" num="0038">First, an image input unit 201 sequentially inputs encoding target image data. Process target image data of this embodiment is a PDL rendering image. The image data are input in the raster scan order. In this embodiment, one pixel is one component. A component includes eight bits. Hence, a pixel value is a nonnegative integer value within<!-- EPO <DP n="6"> --> the range of 0 to 255. Setting coordinates (0,0) at the upper left corner of an image, a pixel value at a pixel position x in the horizontal rightward direction and a pixel position y in the vertical downward direction is represented by P(x,y). For example, a pixel located at a position (x,y) = (3,4) and having a luminance value "128" is expressed as P(3,4) = 128. In the following explanation, a "pixel" at the position (x,y) will also be expressed as "P(x,y)".</p><p id="p0039" num="0039">A resolution converter 202 performs sub-sampling of extracting one pixel from block data including 2 × 2 pixel data of the input image, thereby generating a reduced image. That is, the resolution converter 202 functions as a reduced image generator which generates, from original image data, a reduced image smaller than the original image.</p><p id="p0040" num="0040"><figref idrefs="f0003">Fig. 3</figref> shows an original image and 2 × 2 pixels included in a given block B<sub>n</sub> of the original image. As shown in <figref idrefs="f0003">Fig. 3</figref>, the pixels in the block B<sub>n</sub> of interest are represented by B<sub>n</sub>(0,0), B<sub>n</sub>(0,1), B<sub>n</sub>(1,0), and B<sub>n</sub>(1,1) in the raster order from the upper left position.</p><p id="p0041" num="0041">An immediately preceding block of the block B<sub>n</sub> of interest is expressed as B<sub>n-1</sub>, and an immediately succeeding block is expressed as B<sub>n+1</sub>. In this embodiment, the pixel at the position B<sub>n</sub>(0,0) of the block B<sub>n</sub> of interest, i.e., the pixel at the upper left corner of the block of interest is extracted (sub-sampled) and used as one pixel of a reduced image. The sampling is performed for all blocks B<sub>0</sub> to B<sub>W*H-1</sub> in the image so that a reduced image having W horizontal pixels and H vertical pixels is generated from the original image data including 2W horizontal pixels and 2H vertical pixels. That is, the number of pixels included in the reduced image is 1/4 that of the original image. The generated reduced image is output to a storage unit 204 and stored.</p><p id="p0042" num="0042">An interpolation data generator 203 generates<!-- EPO <DP n="7"> --> information necessary for restoring the original image from the reduced image. Since one pixel in one block is sampled as one pixel of the reduced image, the remaining three pixels that are non-sampling targets need to be restored for restoration of the block. The interpolation data generator 203 of this embodiment generates, as encoded data, information representing the values of the remaining three non-sampling target pixels in each block and how to restore these pixels.</p><p id="p0043" num="0043"><figref idrefs="f0003">Fig. 4</figref> illustrates four pixels included in one block. The pixel X shown in <figref idrefs="f0003">Fig. 4</figref> indicates a pixel directly used as a pixel of a reduced image. Pixels Xa, Xb, and Xc indicate restoration target pixels. The pixel at the position B<sub>n</sub>(0,0) of the block B<sub>n</sub> of interest will be expressed as X, and those at the positions B<sub>n</sub>(0,1), B<sub>n</sub>(1,0), and B<sub>n</sub>(1,1) will be expressed as Xa, Xb, and Xc hereinafter.</p><p id="p0044" num="0044"><figref idrefs="f0001">Fig. 1</figref> is a flowchart illustrating the processing procedure of the interpolation data generator 203 according to this embodiment. The processing procedure of the interpolation data generator 203 according to this embodiment will be explained below with reference to the flowchart of <figref idrefs="f0001">Fig. 1</figref>.</p><p id="p0045" num="0045">First, in step S101, the interpolation data generator 203 receives the 2 × 2 pixels included in the block B<sub>n</sub> of interest and one pixel from each of three blocks adjacent to the block B<sub>n</sub> of interest. The three blocks adjacent to the block B<sub>n</sub> of interest are the block B<sub>n+1</sub> on the right side, a block B<sub>n+W</sub> immediately below, and a block B<sub>n+W+1</sub> off to the lower right. The pixels input from these blocks are a pixel B<sub>n+1</sub>(0,0) from the block on the right side, a pixel B<sub>n+W</sub>(0,0) from the block immediately below, and a pixel B<sub>n+W+1</sub>(0,0) from the block off to the lower right. Note that these three pixels are used in the reduced image.<!-- EPO <DP n="8"> --></p><p id="p0046" num="0046">In step S102, the interpolation data generator 203 initializes a parameter n to "0". The parameter n is used to specify a block.</p><p id="p0047" num="0047">In step S103, the interpolation data generator 203 determines whether the four pixels in the block of interest are identical to each other. That is, the interpolation data generator 203 determines whether <maths id="math0001" num="(1)"><math display="block"><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">n</mi></msub><mfenced><mn mathvariant="normal">0</mn><mn mathvariant="normal">0</mn></mfenced><mo>=</mo><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">n</mi></msub><mfenced><mn mathvariant="normal">0</mn><mn mathvariant="normal">1</mn></mfenced><mo>=</mo><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">n</mi></msub><mfenced><mn mathvariant="normal">1</mn><mn mathvariant="normal">0</mn></mfenced><mo>=</mo><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">n</mi></msub><mfenced><mn mathvariant="normal">1</mn><mn mathvariant="normal">1</mn></mfenced></math><img id="ib0001" file="imgb0001.tif" wi="133" he="9" img-content="math" img-format="tif"/></maths> is satisfied.</p><p id="p0048" num="0048">If Expression (1) holds in the block B<sub>n</sub> of interest (YES), the value of the pixel X in the reduced image equals the values of the restoration target pixels Xa, Xb, and Xc. In this case, the process advances to step S105.</p><p id="p0049" num="0049">On the other hand, if it is determined that Expression (1) does not hold in the block B<sub>n</sub> of interest (NO in step S103), i.e., if it is determined that all the remaining three pixels Xa, Xb, and Xc cannot be restored from the pixel X in the block of interest, the process advances to step S104.</p><p id="p0050" num="0050">In step S104, the interpolation data generator 203 compares the pixels B<sub>n+1</sub>(0,0) , B<sub>n+W</sub>(0,0), and B<sub>n+W+1</sub>(0,0) in the three blocks B<sub>n+1</sub>, B<sub>n+W</sub>, and B<sub>n+W+1</sub> adjacent to the block of interest with the pixels B<sub>n</sub>(0,1), B<sub>n</sub>(1,0), and B<sub>n</sub>(1,1) in the block of interest, and determines whether <maths id="math0002" num="(2)"><math display="block"><mtable columnalign="left"><mtr><mtd><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">n</mi></msub><mfenced><mn mathvariant="normal">0</mn><mn mathvariant="normal">1</mn></mfenced><mo>=</mo><msub><mi mathvariant="normal">B</mi><mrow><mi mathvariant="normal">n</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow></msub><mfenced><mn mathvariant="normal">0</mn><mn mathvariant="normal">0</mn></mfenced><mo>,</mo><mspace width="1em"/><mi>and</mi></mtd></mtr><mtr><mtd><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">n</mi></msub><mfenced><mn mathvariant="normal">1</mn><mn mathvariant="normal">0</mn></mfenced><mo>=</mo><msub><mi mathvariant="normal">B</mi><mrow><mi mathvariant="normal">n</mi><mo>+</mo><mi mathvariant="normal">W</mi></mrow></msub><mfenced><mn mathvariant="normal">0</mn><mn mathvariant="normal">0</mn></mfenced><mo>,</mo><mspace width="1em"/><mi>and</mi></mtd></mtr><mtr><mtd><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">n</mi></msub><mfenced><mn mathvariant="normal">1</mn><mn mathvariant="normal">1</mn></mfenced><mo>=</mo><msub><mi mathvariant="normal">B</mi><mrow><mi mathvariant="normal">n</mi><mo>+</mo><mi mathvariant="normal">W</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow></msub><mfenced><mn mathvariant="normal">0</mn><mn mathvariant="normal">0</mn></mfenced></mtd></mtr></mtable></math><img id="ib0002" file="imgb0002.tif" wi="132" he="23" img-content="math" img-format="tif"/></maths> is satisfied.</p><p id="p0051" num="0051">Note that the pixels B<sub>n+1</sub>(0,0), B<sub>n+W</sub>(0,0), and B<sub>n+W+1</sub>(0, 0) are pixels sampled from the blocks B<sub>n+1</sub>, B<sub>n+W</sub>, and B<sub>n+W+1</sub>, respectively, to generate the reduced image, as described above.</p><p id="p0052" num="0052">There is a reason to determine the<!-- EPO <DP n="9"> --> coincidence/non-coincidence of the pairs {B<sub>n</sub>(0,1), B<sub>n+1</sub>(0,0)}, {B<sub>n</sub>(1,0), B<sub>n+W</sub>(0,0)}, and {B<sub>n</sub>(1,1), B<sub>n+W+1</sub>(0,0)}, as indicated by Expression (2).</p><p id="p0053" num="0053">In general, a pixel of interest and pixels adjacent to it on the upper, lower, left, and right sides have high correlations, and this applies to many images. Hence, to predict the pixel value of a pixel of interest, adjacent pixels are often used as reference pixels for prediction. However, the determination in step S104 is not performed for a block of interest in which "the four pixels are identical to each other". Experiments have revealed that in such a case, the correlations of the pairs {B<sub>n</sub>(0,1), B<sub>n+1</sub>(0,0)}, {B<sub>n</sub>(1,0), B<sub>n+W</sub>(0,0)}, and {B<sub>n</sub>(1,1), B<sub>n+W+1</sub>(0,0)} increase at high probability.</p><p id="p0054" num="0054">For this reason, the coincidence between B<sub>n</sub>(0,1) and B<sub>n+1</sub>(0,0) is determined. The remaining pairs {B<sub>n</sub>(1,0), B<sub>n+W</sub>(0,0) } and {B<sub>n</sub>(1,1), B<sub>n+W+1</sub>(0,0)} are compared due to the same reason. If Expression (2) described above is satisfied (if the pixels of the three pairs are identical to each other), a short code word is assigned to decrease the information amount.</p><p id="p0055" num="0055">When the interpolation data generator 203 has determined in step S104 that Expression (2) holds, the pixels Xa, Xb, and Xc in the block B<sub>n</sub> of interest can be reproduced directly from the pixels of the reduced image. The pixel Xa can be reproduced using a pixel X<sub>n+1</sub> (n = 0, 1, ..., X × H - 1) of the reduced image. The pixel Xb can be reproduced using a pixel X<sub>n+W</sub> of the reduced image. The pixel Xc can be reproduced using a pixel X<sub>n+W+1</sub> of the reduced image.</p><p id="p0056" num="0056">However, when the block B<sub>n</sub> of interest is located at the right end of the image, there are no target pixels to be compared with the pixels B<sub>n</sub>(0,1) and B<sub>n</sub>(1,1). When the block B<sub>n</sub> of interest is located at the lower end of the image,<!-- EPO <DP n="10"> --> there are no target pixels to be compared with the pixels B<sub>n</sub>(1,0) and B<sub>n</sub>(1,1). Especially, when the block B<sub>n</sub> of interest is located at the lower right corner of the image, there are no target pixels to be compared with the pixels B<sub>n</sub>(0,1), B<sub>n</sub>(1,0), and B<sub>n</sub>(1,1). In these cases, comparison is done assuming that the nonexistent pixels have an appropriate value, e.g., "255". Note that this value need only be identical to that in a decoding apparatus and can be any value within the range of 0 to 255.</p><p id="p0057" num="0057">If the condition of Expression (2) is determined to hold (YES) in the above-described way, the process advances to step S106.</p><p id="p0058" num="0058">If neither Expression (1) nor Expression (2) holds for the block B<sub>n</sub> of interest, the pixels Xa, Xb, and Xc of the block of interest cannot be restored from the reduced image. In this case, the process advances to step S107.</p><p id="p0059" num="0059">In step S105, the interpolation data generator 203 outputs first additional information for the block of interest as encoded data. The first additional information need only represent that three pixels are generated from a pixel of interest of the reduced image, i.e., "simple enlargement" is performed to restore the original image. One bit having a value "1" is output as the first additional information, as shown in <figref idrefs="f0004">Fig. 5</figref>.</p><p id="p0060" num="0060">Note that to actually generate the original image by enlarging the reduced image on the decoding apparatus side, letting P(x,y) be the pixel of interest in the reduced image, the pixels X, Xa, Xb, and Xc of the enlarged block B<sub>n</sub> of interest are obtained by<maths id="math0003" num=""><math display="block"><mi mathvariant="normal">X</mi><mo>=</mo><mi>Xa</mi><mo>=</mo><mi>Xb</mi><mo>=</mo><mi>Xc</mi><mo>=</mo><mi mathvariant="normal">P</mi><mfenced><mi mathvariant="normal">x</mi><mi mathvariant="normal">y</mi></mfenced></math><img id="ib0003" file="imgb0003.tif" wi="71" he="8" img-content="math" img-format="tif"/></maths></p><p id="p0061" num="0061">In step S106, the interpolation data generator 203 outputs second additional information for the block of interest as encoded data. The second additional information<!-- EPO <DP n="11"> --> need only represent that three pixels adjacent to a pixel of interest of the reduced image are used to restore the original resolution. In this case, 2-bit data "01" is output as the second additional information (encoded data), as shown in <figref idrefs="f0004">Fig. 5</figref>.</p><p id="p0062" num="0062">To actually generate the original image by enlarging the reduced image, letting P(x,y) be the pixel of interest in the reduced image, the pixels X, Xa, Xb, and Xc of the enlarged block B<sub>n</sub> of interest are obtained by <maths id="math0004" num=""><math display="block"><mi mathvariant="normal">X</mi><mo>=</mo><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">n</mi></msub><mfenced><mn mathvariant="normal">0</mn><mn mathvariant="normal">0</mn></mfenced><mo>=</mo><mi mathvariant="normal">P</mi><mfenced><mi mathvariant="normal">x</mi><mi mathvariant="normal">y</mi></mfenced></math><img id="ib0004" file="imgb0004.tif" wi="41" he="4" img-content="math" img-format="tif"/></maths> <maths id="math0005" num=""><math display="block"><mi>Xa</mi><mo>=</mo><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">n</mi></msub><mfenced><mn mathvariant="normal">0</mn><mn>1</mn></mfenced><mo>=</mo><mi mathvariant="normal">P</mi><mo>⁢</mo><mfenced separators=""><mi mathvariant="normal">x</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi mathvariant="normal">y</mi></mfenced></math><img id="ib0005" file="imgb0005.tif" wi="50" he="4" img-content="math" img-format="tif"/></maths> <maths id="math0006" num=""><math display="block"><mi>Xb</mi><mo>=</mo><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">n</mi></msub><mfenced><mn>1</mn><mn mathvariant="normal">0</mn></mfenced><mo>=</mo><mi mathvariant="normal">P</mi><mo>⁢</mo><mfenced separators=""><mi mathvariant="normal">x</mi><mo>,</mo><mi mathvariant="normal">y</mi><mo>+</mo><mn>1</mn></mfenced></math><img id="ib0006" file="imgb0006.tif" wi="50" he="4" img-content="math" img-format="tif"/></maths> <maths id="math0007" num=""><math display="block"><mi>Xc</mi><mo>=</mo><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">n</mi></msub><mfenced><mn>1</mn><mn>1</mn></mfenced><mo>=</mo><mi mathvariant="normal">P</mi><mo>⁢</mo><mfenced separators=""><mi mathvariant="normal">x</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi mathvariant="normal">y</mi><mo>+</mo><mn>1</mn></mfenced></math><img id="ib0007" file="imgb0007.tif" wi="55" he="4" img-content="math" img-format="tif"/></maths></p><p id="p0063" num="0063">When the process advances to step S107, this indicates that the pixels Xa, Xb, and Xc of the block B<sub>n</sub> of interest cannot be reproduced from the reduced image. In the first embodiment, the interpolation data generator 203 outputs third additional information in this case. As shown in <figref idrefs="f0004">Fig. 5</figref>, the third additional information starts with two bits "00" so as to be discriminable from the first and second additional information, and subsequently outputs 24 bits representing the pixel values of the pixels B<sub>n</sub>(0,1), B<sub>n</sub>(1,0), and B<sub>n</sub>(1,1).</p><p id="p0064" num="0064">Note that in this embodiment, the first to third additional information shown in <figref idrefs="f0004">Fig. 5</figref> are used. However, these are merely examples. When the first additional information is represented by one bit, the second additional information need only be formed from two bits in which the first bit has a value different from the first additional information. The third additional information need only include two bits, in which the first bit has the same value as the first bit of the second additional information but the second bit has a different value, and data representing<!-- EPO <DP n="12"> --> three pixels.</p><p id="p0065" num="0065">According to the above-described processing procedure, the interpolation data generator 203 outputs one of the first, second, and third additional information for the block of interest.</p><p id="p0066" num="0066">In step S108, the interpolation data generator 203 determines whether the block of interest is the last block (the block at the lower right corner of the image). If NO in step S108, the variable n is incremented by "1" in step S109, and the process returns to step S103. Upon determining in step S108 that the block of interest is the final block (the block at the lower right corner of the image), the processing ends.</p><p id="p0067" num="0067">The above-described method enables to generate additional information capable of restoring the original resolution image. In other words, the interpolation data generator 203 of this embodiment is an additional information generator for generating the first to third additional information.</p><p id="p0068" num="0068">Detailed processing will be described using image examples shown in <figref idrefs="f0004">Figs. 6A and 6B</figref>.</p><p id="p0069" num="0069">In the image of <figref idrefs="f0004">Fig. 6A</figref>, place focus on a block B<sub>0</sub>. Since B<sub>0</sub>(0,0) = B<sub>0</sub>(0,1) = B<sub>0</sub>(1,0) = B<sub>0</sub>(1,1) holds, first additional information "1" is output. In blocks B<sub>1</sub>, B<sub>2</sub>, and B<sub>3</sub> as well, Expression (1) holds, like the block B<sub>0</sub>. Hence, the first additional information is output for all blocks. The stream of the additional information (interpolation data) for the four blocks is represented by four bits "1111".</p><p id="p0070" num="0070">For this reason, in the image of <figref idrefs="f0004">Fig. 6A</figref>, the reduced image includes 2 × 2 pixels, and the data size of the reduced image is 4 × 8 bits. Hence, the data amount of the reduced image and its additional information is 4 × 8 + 4 = 36 bits. Since the size of the original image is 128 bits (=<!-- EPO <DP n="13"> --> 4 × 4 × 8), the compression ratio is 36/128 = 9/32.</p><p id="p0071" num="0071">In the image of <figref idrefs="f0004">Fig. 6B</figref>, place focus on the block B<sub>0</sub>. In this case, B<sub>0</sub>(0,0) ≠ B<sub>0</sub>(0,1) ≠ B<sub>0</sub>(1,0) ≠ B<sub>0</sub>(1,1), and Expression (1) does not hold.</p><p id="p0072" num="0072">However, B<sub>0</sub>(0,1) = B<sub>1</sub>(0,0), B<sub>0</sub>(1,0) = B<sub>2</sub>(0,0), and B<sub>0</sub>(1,1) = B<sub>3</sub>(0,0) is satisfied. That is, Expression (2) holds. Hence, second additional information (two bits "01") is output for the block B<sub>0</sub> of interest.</p><p id="p0073" num="0073">Examine a case in which the block of interest moves to B<sub>1</sub>. In the block B<sub>1</sub> of interest, B<sub>1</sub>(0,0) = B<sub>1</sub>(0,1) B<sub>1</sub>(1,0) = B<sub>1</sub>(1,1). Hence, the process advances to determination of coincidence/non-coincidence of neighboring pixels. That is, Expression (2) is verified.</p><p id="p0074" num="0074">Since the block B<sub>1</sub> of interest is located at the right end of the image, comparison with a predetermined pixel value ("255" in the embodiment) is done when referring to the neighboring pixels. As a result of comparison, B<sub>1</sub>(0,1) ≠ 255, B<sub>1</sub>(1,0) = B<sub>3</sub>(0,0), and B<sub>1</sub>(1,1) ≠ 255. Since the pixels cannot be reproduced by the second additional information, the third additional information is output. More specifically, two bits "00" and, subsequently, 24-bit data representing the pixel data of the three pixels are output as the third additional information.</p><p id="p0075" num="0075">The same processing is performed for the blocks B<sub>2</sub> and B<sub>3</sub> as well. The third additional information is output for the block B<sub>2</sub> because it satisfies neither Expression (1) nor Expression (2). The first additional information is output for the block B<sub>3</sub> because it satisfies Expression (1).</p><p id="p0076" num="0076">After processing all blocks of the image in <figref idrefs="f0004">Fig. 6B</figref>, the interpolation data generator 203 outputs interpolation data having a data structure shown in <figref idrefs="f0005">Fig. 7</figref>. The data structure shown in <figref idrefs="f0005">Fig. 7</figref> is merely an example. The interpolation data need only include one of the first, second,<!-- EPO <DP n="14"> --> and third additional information for at least one block.</p><p id="p0077" num="0077">The storage unit 204 stores the reduced image data thus generated by the resolution converter 202 and the interpolation data thus generated by the interpolation data generator 203.</p><p id="p0078" num="0078">An image developing unit 205 restores the original resolution image from the reduced image data and the interpolation data stored in the storage unit 204. Image developing is done by processing reverse to the interpolation data generation processing. More specifically, the interpolation data is analyzed, and the unknown three pixels Xa, Xb, and Xc in the block are obtained from the pixel of interest of the reduced image based on the analyzed additional information by one of the following three methods:
<ol><li>(1) the pixels are obtained by simply enlarging the pixel of interest in the reduced image,</li><li>(2) the pixels are obtained from the pixels adjacent to the pixel of interest in the reduced image, and</li><li>(3) the pixels are obtained from the pixel values contained in the interpolation data.</li></ol></p><p id="p0079" num="0079">More specifically, when the additional information for the pixel P(x,y) of interest in the reduced image is "1", the pixel of interest of the reduced image is directly used as the pixels Xa, Xb, and Xc, thereby restoring the block.</p><p id="p0080" num="0080">If the additional information for the pixel P(x,y) of interest in the reduced image is "01", the pixel Xa is reproduced using the pixel P(x+1,y), the pixel Xb is reproduced using the pixel P(x,y+1), and the pixel Xc is reproduced using the pixel P(x+1,y+1). However, when the pixel P(x,y) of interest is located at the right end of the image, Xa = 255, and Xc = 255. When the pixel P(x,y) of interest is located at the lower end of the image, Xb = 255,<!-- EPO <DP n="15"> --> and Xc = 255. Especially, when the pixel P(x,y) of interest is located at the lower right corner of the image, Xa = Xb = Xc = 255.</p><p id="p0081" num="0081">If the additional information for the pixel P(x,y) of interest in the reduced image is "00", the pixels are reproduced assuming that 3-byte (24-bit) data following the additional information are arranged in the order of the pixels Xa, Xb, and Xc.</p><p id="p0082" num="0082">By repeating the above processing, the original resolution image data can be restored. The restored original resolution image is input to an image output unit 206.</p><p id="p0083" num="0083">The image output unit receives the image output from the image developing unit 205 and outputs the restored image data outside the image processing apparatus (e.g., to a printer or a display device).</p><p id="p0084" num="0084">As described above, the image processing apparatus according to this embodiment generates interpolation data for restoring the original resolution image from the reduced image simultaneously with resolution conversion of the input image. According to the encoding processing of this embodiment, it is possible to easily generate interpolation data in a smaller data amount for an office document image (an image including only characters or lines). This enables complete lossless restoration of the original resolution image.</p><p id="p0085" num="0085">In this embodiment, the present invention is applied to a single apparatus having both an image encoding function and a decoding function. However, these functions may be implemented by separate apparatuses. When applying to a single image encoding apparatus, reduced image data and interpolation data are output as one file. A single decoding apparatus first develops the reduced image from the file onto a memory and then restores (decodes) the original image based<!-- EPO <DP n="16"> --> on the interpolation data. A more detailed description will be omitted.</p><p id="p0086" num="0086">The description of the first embodiment will be finished here. In this embodiment, a reduced image having a 1/2 size in both the horizontal and vertical directions is generated from an original image by sampling. Simultaneously, interpolation data is generated. Recursively inputting the reduced image as an original image may be repeated. In this case, a first-step reduced image and first-step interpolation data of an original image are obtained. A second-step reduced image (having a size 1/4 that of the original image in both the horizontal and vertical directions) and second-step interpolation data are obtained from the first-step reduced image, ..., and an nth-step reduced image and nth-step interpolation data are obtained. Eventually, nth-step reduced image + nth-step interpolation data + (n-1)th-step interpolation data + ... + first-step interpolation data are generated. This method is noticeable because it can generate encoded data capable of losslessly reproducing images of various sizes.</p><p id="p0087" num="0087">Note that in the above-described embodiment, the sampling target for reduced image generation is the pixel at the upper left corner of each block. However, the sampling target may be set for any one of 2 × 2 pixels.</p><p id="p0088" num="0088">It may be unnecessary to explain the first additional information. Assume that when generating the second additional information, the pixel X at the lower right corner of the block of interest is set as the sampling target, and the remaining three pixels are expressed as Xa, Xb, and Xc, as described above. Let X1 be the sampling target pixel included in an adjacent block and located adjacent to the pixel Xa so as to be referred to restore the pixel Xa, X2 be the sampling target pixel included in another adjacent block<!-- EPO <DP n="17"> --> and located adjacent to the pixel Xb so as to be referred to restore the pixel Xb, and X3 be the sampling target pixel included in still another adjacent block and located adjacent to the pixel Xc so as to be referred to restore the pixel Xc. In this case, if <maths id="math0008" num=""><math display="block"><mi>Xa</mi><mo>=</mo><mi mathvariant="normal">X</mi><mo>⁢</mo><mn>1</mn><mo>,</mo></math><img id="ib0008" file="imgb0008.tif" wi="25" he="7" img-content="math" img-format="tif"/></maths><br/>
and <maths id="math0009" num=""><math display="block"><mi>Xb</mi><mo>=</mo><mi mathvariant="normal">X</mi><mo>⁢</mo><mn>2</mn><mo>,</mo></math><img id="ib0009" file="imgb0009.tif" wi="23" he="7" img-content="math" img-format="tif"/></maths><br/>
and <maths id="math0010" num=""><math display="block"><mi>Xc</mi><mo>=</mo><mi mathvariant="normal">X</mi><mo>⁢</mo><mn>3</mn></math><img id="ib0010" file="imgb0010.tif" wi="23" he="7" img-content="math" img-format="tif"/></maths><br/>
are satisfied, the second additional information is generated.</p><heading id="h0008">[Modification of First Embodiment]</heading><p id="p0089" num="0089">An example in which a computer program implements the same processing as in the first embodiment will be explained below as a modification of the first embodiment.</p><p id="p0090" num="0090"><figref idrefs="f0011">Fig. 14</figref> is a block diagram of an information processing apparatus (e.g., personal computer) according to the modification.</p><p id="p0091" num="0091">Referring to <figref idrefs="f0011">Fig. 14</figref>, a CPU 1401 controls the overall apparatus using programs and data stored in a RAM 1402 and a ROM 1403 and also executes image encoding processing and decoding processing to be described later. The RAM 1402 has an area to store programs and data downloaded from an external storage device 1407 or a storage medium drive 1408 or from an external apparatus via an I/F 1409. The RAM 1402 also has a work area to be used by the CPU 1401 to execute various kinds of processing. The ROM 1403 stores a boot program and the setting programs and data of the apparatus. A keyboard 1404 and a mouse 1405 can input various instructions to the CPU 1401.</p><p id="p0092" num="0092">A display device 1406 is formed from, e.g., a CRT or a liquid crystal screen and can display information such as an image or a text. The external storage device 1407 is a mass storage such as a hard disk drive. The external storage device 1407 stores, as files, an OS (operating system),<!-- EPO <DP n="18"> --> programs for image encoding and decoding processing to be described later, encoding target image data, encoded data of decoding target images, and the like. The CPU 1401 loads the programs and data to a predetermined area on the RAM 1402 and executes them.</p><p id="p0093" num="0093">The storage medium drive 1408 reads out programs and data from a storage medium such as a CD-ROM or a DVD-ROM and outputs them to the RAM 1402 or the external storage device 1407. Note that the storage medium may store programs for image encoding and decoding processing to be described later, encoding target image data, encoded data of decoding target images, and the like. In this case, the storage medium drive 1408 loads the programs and data to a predetermined area on the RAM 1402 under the control of the CPU 1401.</p><p id="p0094" num="0094">The I/F 1409 connects an external apparatus to this apparatus to enable data communication between them. For example, encoding target image data or encoded data of a decoding target image can be input to the RAM 1402, the external storage device 1407, or the storage medium drive 1408 of the apparatus. A bus 1410 connects the above-described units.</p><p id="p0095" num="0095">In the above arrangement, when the apparatus is powered on, the CPU 1401 loads the OS from the external storage device 1407 to the RAM 1402 in accordance with the boot program in the ROM 1403. This enables input from the keyboard 1404 or the mouse 1405 and allows the display device 1406 to display a GUI. When the user operates the keyboard 1404 or the mouse 1405 and inputs an instruction to activate an image encoding processing application program stored in the external storage device 1407, the CPU 1401 loads the program to the RAM 1402 and executes it. This makes the apparatus function as an image encoding apparatus. In this case, the encoding application performs the processing of<!-- EPO <DP n="19"> --> generating a reduced image by sampling one pixel in each above-described block of designated image data and the interpolation data generation processing (the flowchart in <figref idrefs="f0001">Fig. 1</figref>). The result is stored in a storage device such as a hard disk as a file or transferred to an external apparatus or a network.</p><heading id="h0009">[Second Embodiment]</heading><p id="p0096" num="0096">In the first embodiment, sampling is performed in each block including 2 × 2 pixels, and interpolation data is generated by selectively deciding additional information. In this case, a 1-bit code word (first additional information) is assigned to three pixels at the minimum. In the second embodiment, an example will be described in which the first embodiment is further expanded to attain a higher encoding efficiency.</p><p id="p0097" num="0097">Note that in the second embodiment as well, encoding target image data is assumed to be monochrome multi-valued image data including eight bits per pixel (256 tones), for the descriptive convenience. However, the encoding target image data may contain a plurality of color components (e.g., RGB, YMCK, or Lab). The number of bits of one component is not limited to eight. If there are a plurality of color components, the same processing is performed for each component.</p><p id="p0098" num="0098">In the second embodiment, a "block" represents 2 × 2 pixels, as in the first embodiment. A "tile" has a size corresponding to M blocks in the horizontal direction and N blocks in the vertical direction (each of M and N is an integer of 2 or more). For the descriptive convenience, M = N = 8 in one tile. That is, one tile includes 16 × 16 pixels. For the descriptive convenience, the encoding target image data is assumed to have 16W horizontal pixels × 16H vertical pixels. That is, the number of pixels is an integer multiple<!-- EPO <DP n="20"> --> of 16 in both directions.</p><p id="p0099" num="0099"><figref idrefs="f0006">Fig. 8</figref> is a block diagram of an image encoding apparatus according to the second embodiment. A tile dividing unit 801 is provided before an interpolation data generator 203, and an additional information integration unit 802 is provided after the interpolation data generator 203, unlike <figref idrefs="f0002">Fig. 2</figref>. Except those, the arrangement is the same as in the first embodiment, and a description thereof will not be repeated.</p><p id="p0100" num="0100">The tile dividing unit 801 divides image data received from an image input unit 201 into tiles each having 16 × 16 pixels, and outputs the tile image data to the interpolation data generator 203. Note that since the interpolation data generator 203 generates interpolation data of each tile by referring to the outer pixel data of the tile, the tile dividing unit 801 outputs, to the interpolation data generator 203, pixel data with an extra column on the right side of the tile and an extra line on the lower side of the tile. The pixel data of one column and one line is output from the tile dividing unit 801 as an overlap portion between tiles.</p><p id="p0101" num="0101">The interpolation data generator 203 receives every 2 × 2 pixel unit of the input tile and generates interpolation data in accordance with the procedure described in the first embodiment.</p><p id="p0102" num="0102">The additional information integration unit 802 functions as an encoded data input unit for receiving encoded data from the interpolation data generator 203. For this purpose, the additional information integration unit 802 incorporates a buffer memory. The additional information integration unit 802 receives the encoded data (interpolation data) generated by the interpolation data generator 203, temporarily stores them in the internal buffer, analyzes the<!-- EPO <DP n="21"> --> interpolation data of one tile, i.e., 8 × 8 interpolation data, and integrates them. The process contents of the additional information integration unit 802 will be described below in more detail.</p><p id="p0103" num="0103">First, the additional information integration unit 802 analyzes 8 × 8 pieces of additional information included in an input tile of interest. Based on the analysis result, the additional information integration unit 802 executes first integration processing and second integration processing to be explained below.</p><heading id="h0010">&lt;First Integration Processing&gt;</heading><p id="p0104" num="0104">This processing is performed when the 8 × 8 pieces of additional information in the tile of interest are identical to each other. There are three kinds of additional information, i.e., first, second, and third additional information, as described in the first embodiment. When 8 × 8 pieces of additional information are identical to each other, they are integrated. For example, if 8 × 8 pieces of additional information in a tile of interest are identical, the additional information integration unit 802 outputs, at the top, one identification bit "1" representing that the pieces of information are identical to each other. The additional information integration unit 802 subsequently outputs the additional information, and ends the integration processing of the tile of interest. Hence, the identification bit can also be regarded as flag information representing whether integration has succeeded.</p><p id="p0105" num="0105">If the pieces of additional information of the 8 × 8 blocks in the tile of interest are "1", i.e., the first additional information in the first embodiment, the integration result of the tile of interest is represented by two bits "11". If the pieces of additional information of the 8 × 8 blocks in the tile of interest are "01", i.e., the<!-- EPO <DP n="22"> --> second additional information in the first embodiment, the integration result of the tile of interest is represented by three bits "101". If all blocks in the tile of interest have the third additional information, the integration result of the tile of interest is represented by three bits "100".</p><p id="p0106" num="0106">When the pieces of additional information of all blocks in the tile of interest are the third additional information, the pixel value of each block is output following the three bits "100" representing the integration result (the additional information of each block is unnecessary). In this embodiment, one tile =8 × 8 blocks. Since each block has three restoration target pixels (<figref idrefs="f0003">Fig. 4</figref>), 8 × 8 × 3 pixels (bytes) follow the three bits "100" of the integration result.</p><p id="p0107" num="0107">As described above, when all pieces of additional information of the 8 × 8 blocks in the tile of interest are identical, additional information integration processing for the tile of interest is ended in the above-described way (second integration processing to be described next is not performed).</p><p id="p0108" num="0108">On the other hand, if at least one of the 8 × 8 pieces of additional information in the tile of interest is different, an identification bit "0" representing it is output, and second integration processing to be described below is performed.</p><heading id="h0011">&lt;Second Integration Processing&gt;</heading><p id="p0109" num="0109">The second integration processing is performed when at least one of all pieces of additional information in a tile is different from others. In other words, there is possibility that pieces of additional information can be integrated in a region smaller than the tile size. In the second embodiment, noting that one tile includes 8 × 8 pieces of additional information, integration processing is<!-- EPO <DP n="23"> --> performed for each line of eight pieces of additional information arrayed in the horizontal direction. The eight pieces of additional information arrayed in the horizontal direction will be referred to as line additional information hereinafter.</p><p id="p0110" num="0110">In the second integration processing, it is determined whether eight pieces of additional information included in line additional information of interest are identical to each other. If they are identical, the additional information integration unit 802 outputs one identification bit "1" to identify it and, subsequently, one piece of additional information determined to be identical. On the other hand, if at least one of the eight pieces of additional information included in the line additional information of interest is different, the additional information integration unit 802 outputs one identification bit "0" and, subsequently, the eight pieces of additional information.</p><p id="p0111" num="0111">Since the tile of interest includes eight pieces of line additional information, the above processing is executed eight times from the uppermost line to the lowermost line.</p><p id="p0112" num="0112">The processing of the additional information integration unit 802 according to the second embodiment has been described above.</p><p id="p0113" num="0113"><figref idrefs="f0007">Fig. 9</figref> is a flowchart illustrating the integration processing procedure of the additional information integration unit 802 according to the second embodiment. The processing of the additional information integration unit 802 of this embodiment will be explained below with reference to the flowchart in <figref idrefs="f0007">Fig. 9</figref>.</p><p id="p0114" num="0114">First, the additional information integration unit 802 receives 8 × 8 pieces of additional information,<!-- EPO <DP n="24"> --> included in a tile of interest, generated by the interpolation data generator 203 (step S901).</p><p id="p0115" num="0115">The additional information integration unit 802 then analyzes the received additional information and determines whether all the 8 × 8 pieces of additional information (all encoded data) are of the same type (one type) (step S902). Upon determining that all pieces of additional information are of the same type (YES), the process advances to step S903. In step S903, the additional information integration unit 802 outputs a 1-bit flag "1" representing that the pieces of additional information of the tile of interest are integrated. In step S904, the additional information integration unit 802 outputs one piece of additional information following the flag. Note that if all the pieces of additional information determined to be identical are third additional information, the additional information integration unit 802 outputs 8 × 8 × 3 pixel data following the third additional information.</p><p id="p0116" num="0116">If NO in step S902, i.e., if at least two kinds of additional information exist in the 8 × 8 pieces of additional information included in the tile of interest, the process advances to step S905. In step S905, the additional information integration unit 802 outputs a 1-bit flag "0" representing that the pieces of additional information of the tile of interest are not integrated. In steps S906 to S911, the additional information integration unit 802 executes integration processing in each region smaller than the tile of interest. Actually, this is block line integration processing for each block line including eight pieces of additional information arrayed in the horizontal direction.</p><p id="p0117" num="0117">First, the additional information integration unit 802 determines in step S906 whether all the eight pieces of additional information included in line additional<!-- EPO <DP n="25"> --> information of interest (the additional information of the uppermost line of the tile of interest at the initial stage) are identical. If they are identical, the pieces of additional information of that line can be integrated. The additional information integration unit 802 outputs, in step S907, a 1-bit flag "1" representing that they are integrated, and then in step S908, one piece of additional information determined to be identical. Note that if the pieces of additional information determined to be identical are the third additional information, 8 × 3 pixel data are output following the additional information.</p><p id="p0118" num="0118">If it is determined in step S906 that at least one of all pieces of additional information of the line of interest (the uppermost line of the tile of interest at the initial stage) is different from others, the process advances to step S909. The additional information integration unit 802 outputs, in step S909, a 1-bit flag "0" representing that the pieces of additional information of that line cannot be integrated, and then in step S910, the eight pieces of additional information (if the third additional information exists, three pixel data follow the third additional information).</p><p id="p0119" num="0119">In step S911, the additional information integration unit 802 determines whether the integration processing has been done up to the final line of the tile of interest. If NO in step S911, the process returns to step S906 to perform integration processing of the next line.</p><p id="p0120" num="0120">When the integration processing of the tile of interest has ended in the above-described manner, the additional information integration unit 802 determines in step S912 whether the integration processing has been done for all tiles. If NO in step S912, the process returns to step S901 to perform integration processing of the additional<!-- EPO <DP n="26"> --> information of the next tile.</p><p id="p0121" num="0121">An example of integration processing of the additional information of one tile will be described here with reference to <figref idrefs="f0008">Figs. 10A to 10C</figref>.</p><p id="p0122" num="0122"><figref idrefs="f0008">Fig. 10A</figref> illustrates the image data of one tile. One cell enclosed by broken lines indicates one pixel.</p><p id="p0123" num="0123">In <figref idrefs="f0008">Fig. 10A</figref>, the regions of the first to ninth lines include white pixels of the same value. The regions of the 10th and 11th lines include black pixels of the same value. The regions of the 12th to 16th lines include white pixels of the same value. The pattern illustrated in <figref idrefs="f0008">Fig. 10A</figref> is often observed in a character or line image.</p><p id="p0124" num="0124"><figref idrefs="f0008">Fig. 10B</figref> shows the values of the additional information of the respective blocks generated by the interpolation data generator 203 upon receiving the tile image data shown in <figref idrefs="f0008">Fig. 10A</figref>.</p><p id="p0125" num="0125">As shown in <figref idrefs="f0008">Fig. 10B</figref>, not all pieces of additional information in the tile are identical. Hence, the flag "0" representing that tile integration is impossible is output, as shown in <figref idrefs="f0008">Fig. 10C</figref> (step S905 in <figref idrefs="f0007">Fig. 9</figref>).</p><p id="p0126" num="0126">See the first line additional information. The eight pieces of additional information are "1". Since line integration is possible, the flag "1" is output, and then, the additional information "1" is output. This processing is repeated hereafter.</p><p id="p0127" num="0127">For the tile image shown in <figref idrefs="f0008">Fig. 10A</figref>, the additional information integration unit 802 eventually outputs an additional information integration result shown in <figref idrefs="f0008">Fig. 10C</figref>. The bit sequence is<br/>
"0;11;11;11;11;101;101;11;11"<br/>
Note that the semicolons indicate breaks of line additional information integration to give a better understanding but do not exist in fact.<!-- EPO <DP n="27"> --></p><p id="p0128" num="0128">Since the tile in <figref idrefs="f0008">Fig. 10A</figref> includes 8 × 8 blocks each having three pixels to be restored, one tile includes 8 × 8 × 3 restoration target pixels. That is, the total number of bits of the restoration target pixels in one tile is 8 × 8 × 3 × 8 bits = 1536 bits.</p><p id="p0129" num="0129">The pieces of additional information in <figref idrefs="f0008">Fig. 10B</figref> include a total of 48 pieces of 1-bit additional information and a total of 16 pieces of 2-bit additional information. Hence, the total number of bits of additional information in one tile is 48 + 16 × 2 bits = 80 bits (corresponding to the first embodiment).</p><p id="p0130" num="0130">In <figref idrefs="f0008">Fig. 10C</figref>, the total number of bits after integration of additional information in one tile according to the second embodiment is 19 bits including the flag bits. That is, it is possible to largely decrease the data amount of the interpolation data.</p><p id="p0131" num="0131">As described above, according to the second embodiment, it is determined whether the pieces of additional information generated by the interpolation data generator 203 for the blocks each having 2 × 2 pixels continue in a predetermined unit. If the pieces of additional information continue, they are integrated, thereby largely decreasing the data amount of the interpolation data. If the pieces of additional information do not continue, the continuity is determined in a smaller unit, and integration processing is performed in the same way. Since the continuity of additional information is only checked, it is unnecessary to scan the image again for integration processing. Hence, the efficiency of interpolation data generation processing does not lower.</p><p id="p0132" num="0132">Note that a computer program can also implement the same processing as in the second embodiment, as is apparent from the above-described modification of the first embodiment, and a description thereof will not be repeated.<!-- EPO <DP n="28"> --></p><heading id="h0012">[Third Embodiment]</heading><p id="p0133" num="0133">In the first and second embodiments, one of first, second, and third additional information is assigned to one block (2 × 2 pixels), thereby generating the interpolation data of the block. In the third embodiment, an example will be described in which interpolation data is generated without limiting the number of types of additional information to three.</p><p id="p0134" num="0134">Note that in the third embodiment as well, encoding process target image data is assumed to be monochrome multi-valued image data. This embodiment is also applicable to RGB image data or CMYK color image data. The image is assumed to include 16W horizontal pixels × 16H vertical pixels (the number of pixels is an integer multiple of 16 in both the horizontal and vertical directions).</p><p id="p0135" num="0135"><figref idrefs="f0009">Fig. 11</figref> is a block diagram of an image encoding apparatus according to the third embodiment. The same reference numerals as in <figref idrefs="f0001">Figs. 1</figref> and <figref idrefs="f0006">8</figref> described in the first and second embodiments denote the same blocks in <figref idrefs="f0009">Fig. 11</figref>, and a description thereof will not be repeated.</p><p id="p0136" num="0136">Parts whose operations are different from the second embodiment will be explained below.</p><p id="p0137" num="0137">In the above-described second embodiment, after generation of additional information for a block of 2 × 2 pixels, additional information integration processing is performed. In the third embodiment, a method of generating interpolation data while adaptively changing the additional information generation unit will be described. To do this, the additional information integration unit 802 in <figref idrefs="f0006">Fig. 8</figref> is removed, and an interpolation data generator 1101 of the third embodiment is provided in place of the interpolation data generator 203 of the first and second embodiments.</p><p id="p0138" num="0138"><figref idrefs="f0009">Fig. 12</figref> is a block diagram of the interpolation<!-- EPO <DP n="29"> --> data generator 1101 according to the third embodiment. The interpolation data generator 1101 includes a flat determination unit 1201 and a non-flat block analysis unit 1202.</p><p id="p0139" num="0139">In the following explanation, a block whose pixels Xa, Xb, and Xc (<figref idrefs="f0003">Fig. 4</figref>) are restorable from a pixel X in a reduced image will be referred to as a "flat block". In other words, a block whose 2 × 2 pixels have equal values (identical colors) is called a flat block. Additionally, a block in which 2 × 2 pixels include at least one pixel having a value different from the others will be referred to as a non-flat block. A tile including only flat blocks will be referred to as a flat tile. A tile having at least one non-flat block will be referred to as a non-flat tile. Eight blocks arrayed horizontally in one tile will be referred to as a block line. A block line formed from eight flat blocks will be referred to as a flat block line. A block line including at least one non-flat block will be referred to as a non-flat block line. In the third embodiment, neighboring reference target pixels outside a tile are assumed to have a pixel value "255".</p><p id="p0140" num="0140">The flat determination unit 1201 functions as a tile encoder which receives and encodes the image data of each tile formed from 2M horizontal pixels × 2N vertical pixels. For the descriptive convenience, M = N = 8. Placing focus on each block (2 × 2 pixels) of an input tile (16 × 16 pixels), the flat determination unit 1201 determines whether the pixels Xa, Xb, and Xc other than the pixel X used for the reduced image can simply be restored from the pixel X in the reduced image. The flat determination unit 1201 executes processing based on the determination result.</p><p id="p0141" num="0141">Based on the determination result of the flat determination unit 1201, the non-flat block analysis unit<!-- EPO <DP n="30"> --> 1202 generates additional information in accordance with the number and arrangement of colors in the block and outputs it.</p><p id="p0142" num="0142">The process contents of the flat determination unit 1201 and then those of the non-flat block analysis unit 1202 will be described below.</p><heading id="h0013">&lt;Description of Flat Determination Unit&gt;</heading><p id="p0143" num="0143"><figref idrefs="f0010">Fig. 13</figref> is a flowchart illustrating the processing procedure of the flat determination unit 1201.</p><p id="p0144" num="0144">In step S1301, the flat determination unit 1201 receives image data (tile data) of one tile. For each block in the received tile data, the flat determination unit 1201 then determines whether the block is a flat block or a non-flat block.</p><p id="p0145" num="0145">In step S1302, the flat determination unit 1201 determines whether the received tile of interest is a flat tile (first determination processing). That is, the flat determination unit 1201 determines whether all 8 × 8 blocks (each tile includes 2 × 2 pixels) of the received tile are flat blocks.</p><p id="p0146" num="0146">If the tile of interest is determined to be a flat tile, it means that the image data of 16 × 16 pixels can simply be generated based on the image data of 8 × 8 pixels of the reduced image. In this case, the flat determination unit 1201 advances the process to step S1303 to output, to the non-flat block analysis unit 1202, a 1-bit flag "1" representing that the tile of interest is a flat tile.</p><p id="p0147" num="0147">Upon determining in step S1302 that the tile of interest is a non-flat tile, the process advances to step S1304. The flat determination unit 1201 first outputs, to the non-flat block analysis unit 1202, a flag "0" representing that the tile of interest is a non-flat tile. From step S1305, block line encoding processing is performed for each block line in the tile of interest. Note that the encoding<!-- EPO <DP n="31"> --> processing of each block line to be described below is sequentially executed from the uppermost block line to the lowermost block line of the tile of interest.</p><p id="p0148" num="0148">In step S1305, the flat determination unit 1201 determines whether the uppermost (first) block line of the tile is a flat block line (second determination processing). That is, the flat determination unit 1201 determines whether all eight blocks arrayed in the horizontal direction are flat blocks.</p><p id="p0149" num="0149">If the block line of interest is determined to be a flat block line, it means that the image data of a rectangular region including 16 horizontal pixels × 2 vertical pixels can simply be restored from eight pixel data arrayed horizontally in the reduced image. In step S1306, the flat determination unit 1201 outputs, to the non-flat block analysis unit 1202, a flag "1" representing that the block line of interest is a flat block line.</p><p id="p0150" num="0150">Upon determining in step S1305 that the block line of interest is a non-flat block line, the process advances to step S1307. In step S1307, the flat determination unit 1201 outputs, to the non-flat block analysis unit 1202, a flag "0" representing that the block line of interest is a non-flat block line. Then, the process advances to step S1308.</p><p id="p0151" num="0151">Advancing the process to step S1308 indicates that the block line of interest includes at least one non-flat block. Hence, the flat determination unit 1201 determines in step S1308 whether the sequence of flat and non-flat blocks in the block line of interest coincides with that in a block line determined to be a non-flat block line before the block line of interest (third determination processing). Note that no preceding block line exists if the block line of interest is the first block line of the tile of interest. To indicate this, information representing that all<!-- EPO <DP n="32"> --> blocks of a block line are non-flat blocks is prepared in advance before determining the block lines of the tile of interest. More specifically, defining a flat block as "1" and a non-flat block as "0", eight bits (8-bit data) "0" are prepared as an initial value. The 8-bit data will be referred to as "reference non-flat block line information" hereinafter. The "reference non-flat block line information" is prepared in a decoding apparatus as well for restoration of one tile.</p><p id="p0152" num="0152">Assume that the block line of interest is the first block line determined to be a non-flat block line. In this case, the flat determination unit 1201 determines in step S1308 whether the sequence of the determination result of the eight flat and non-flat blocks in the block line of interest coincides with the reference non-flat block line information.</p><p id="p0153" num="0153">Upon determining that they coincide, the flat determination unit 1201 outputs, to the non-flat block analysis unit 1202 in step S1309, a 1-bit flag "1" representing that the determination result of the blocks in the block line of interest coincides with the reference non-flat block line information.</p><p id="p0154" num="0154">This will be described with reference to <figref idrefs="f0008">Fig. 10B</figref>. In the example of <figref idrefs="f0008">Fig. 10B</figref>, the block line of interest determined first to be non-flat corresponds to the fifth block line. This is because eight pieces of additional information included in the fifth block line are "01" which represents a non-flat block. All the eight blocks included in the fifth block line are non-flat blocks and therefore coincide with the reference non-flat block line information (initial 8-bit data "00000000"). For this reason, the flat determination unit 1201 outputs the 1-bit flag "1" to the non-flat block analysis unit 1202 in step S1309.</p><p id="p0155" num="0155">On the other hand, if it is determined in step<!-- EPO <DP n="33"> --> S1308 that the data do not coincide, the process advances to step S1310.</p><p id="p0156" num="0156">The transit to step S1310 occurs when the determination result of the block line of interest does not coincide with the reference non-flat block line information. The flat determination unit 1201 outputs, to the non-flat block analysis unit 1202, a 1-bit flag "0" representing the non-coincidence first, and subsequently, information representing the determination result of each of the eight (8-bit) flat and non-flat blocks of the block line of interest. In step S1311, the flat determination unit 1201 updates the reference non-flat block line information to the determination result (8-bit data) of the flat and non-flat blocks of the block line of interest.</p><p id="p0157" num="0157">After the process in step S1306, S1309, or S1311 has ended, the process advances to step S1312. In step S1312, the flat determination unit 1201 determines whether the block line of interest is the final block line of the tile of interest. If NO in step S1312, the process advances to step S1313 to move the determination target to the next block line and repeat the process from step S1305. If it is determined in step S1312 that the block line of interest is the final block line of the tile of interest, the flat determination unit 1201 ends the flat determination processing of one tile.</p><heading id="h0014">&lt;Description of Non-Flat Block Analysis Unit&gt;</heading><p id="p0158" num="0158">The non-flat block analysis unit 1202 sets "reference non-flat block line information" representing that all eight blocks of one block line are non-flat blocks at the start of processing corresponding to one tile, like the flat determination unit 1201. The non-flat block analysis unit 1202 directly passes the determination result from the flat determination unit 1201 and outputs it to a storage unit 204. At this time, upon determining that there is a block line for<!-- EPO <DP n="34"> --> which the flag "0" has been output in step S1310 of <figref idrefs="f0010">Fig. 13</figref> described above, the non-flat block analysis unit 1202 updates the reference non-flat block line information to the determination result that follows the flag to represent the flat and non-flat blocks. If the block line of interest has undergone the process in step S1309 of <figref idrefs="f0010">Fig. 13</figref>, which block is a non-flat block can be determined by referring to the reference non-flat block line. If it is determined that the block line of interest has undergone the process in step S1310 of <figref idrefs="f0010">Fig. 13</figref>, whether a block is a non-flat block can be determined by checking the 8-bit values following the flag "0" at the top. That is, the non-flat block analysis unit 1202 can determine the number and positions of all non-flat blocks in the tile of interest.</p><p id="p0159" num="0159">The non-flat block analysis unit 1202 executes non-flat block encoding processing according to the flowchart in <figref idrefs="f0012">Fig. 15</figref> for each block determined to be a non-flat block. The processing of the non-flat block analysis unit 1202 will be described below with reference to <figref idrefs="f0012">Fig. 15</figref>.</p><p id="p0160" num="0160">First, in step S1501, the non-flat block analysis unit 1202 receives 2 × 2 pixel data representing one non-flat block. In step S1502, the non-flat block analysis unit 1202 determines whether the block of interest satisfies Expression (2) of the first embodiment (fourth determination processing).</p><p id="p0161" num="0161">If it is determined that Expression (2) is satisfied, setting a pixel P(x,y) in the reduced image as the pixel X at the upper left corner of the block of interest (<figref idrefs="f0003">Fig. 4</figref>), the decoding apparatus (image developing unit 205 in this embodiment) can restore the remaining three pixels Xa, Xb, and Xc of the block of interest by <maths id="math0011" num=""><math display="block"><mi>Xa</mi><mo>=</mo><mi mathvariant="normal">P</mi><mo>⁢</mo><mfenced separators=""><mi mathvariant="normal">x</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi mathvariant="normal">y</mi></mfenced></math><img id="ib0011" file="imgb0011.tif" wi="37" he="7" img-content="math" img-format="tif"/></maths> <maths id="math0012" num=""><math display="block"><mi>Xb</mi><mo>=</mo><mi mathvariant="normal">P</mi><mo>⁢</mo><mfenced separators=""><mi mathvariant="normal">x</mi><mo>,</mo><mi mathvariant="normal">y</mi><mo>+</mo><mn>1</mn></mfenced></math><img id="ib0012" file="imgb0012.tif" wi="37" he="7" img-content="math" img-format="tif"/></maths> <maths id="math0013" num=""><math display="block"><mi>Xc</mi><mo>=</mo><mi mathvariant="normal">P</mi><mo>⁢</mo><mfenced separators=""><mi mathvariant="normal">x</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi mathvariant="normal">y</mi><mo>+</mo><mn>1</mn></mfenced></math><img id="ib0013" file="imgb0013.tif" wi="41" he="7" img-content="math" img-format="tif"/></maths><br/>
<!-- EPO <DP n="35"> -->Hence, the non-flat block analysis unit 1202 outputs a 1-bit flag "1" to the storage unit 204 in step S1503.</p><p id="p0162" num="0162">Upon determining that the block of interest does not satisfy Expression (2), the non-flat block analysis unit 1202 outputs, in step S1504, a 1-bit flag "0" representing that the condition is not satisfied to the storage unit 204.</p><p id="p0163" num="0163">The non-flat block analysis unit 1202 advances the process to step S1505 to determine whether the number of colors included in the block of interest is "2" or more (three or four) (fifth determination processing). Note that the number of colors is never "1" because the block of interest is a non-flat block.</p><p id="p0164" num="0164">If it is determined that the number of colors included in the block of interest is larger than "2" (i.e., three or four), the process advances to step S1512. For that block of interest, the non-flat block analysis unit 1202 outputs a 1-bit flag "0" to the storage unit 204. In step S1513, the non-flat block analysis unit 1202 outputs, to the storage unit 204, the three unused pixel data (8 × 3 = 24 bits) in the block of interest (first output processing).</p><p id="p0165" num="0165">On the other hand, upon determining that the number of colors included in the block of interest is "2", the non-flat block analysis unit 1202 outputs, to the storage unit 204, a 1-bit flag "1" representing that the number of appearing colors is "2" in step S1506. Then in step S1507, the non-flat block analysis unit 1202 outputs, to the storage unit 204, pixel arrangement information representing which one of patterns 1601 to 1607 shown in <figref idrefs="f0013">Fig. 16</figref> corresponds to the three pixels Xa, Xb, and Xc of the block of interest in <figref idrefs="f0003">Fig. 4</figref> except for the pixel X used in the reduced image (second output processing). As shown in <figref idrefs="f0013">Fig. 16</figref>, the total number of patterns is seven. Hence, 3-bit pixel arrangement information can specify one pattern. In the embodiment,<!-- EPO <DP n="36"> --> however, a pixel of the same color as that of the pixel used in the reduced image is represented by "1", and a pixel of a different color is represented by "0". Bits corresponding to the pixels Xa, Xb, and Xc in <figref idrefs="f0003">Fig. 4</figref> are output in this order (3 bits in this case as well). For example, the pixels Xa, Xb, and Xc which coincide with the pattern 1601 in <figref idrefs="f0013">Fig. 16</figref> have colors identical to each other but different from the color of the pixel used in the reduced image. Hence, the three bits of pixel arrangement information are "000". The three bits are "100" for the pattern 1602, "010" for the pattern 1603, and "001" for the pattern 1604. A description of the rest will be omitted.</p><p id="p0166" num="0166">Next, in step S1508, the non-flat block analysis unit 1202 determines whether there is a neighboring pixel having the same color as that of one of the pixels Xa, Xb, and Xc of the block of interest other than the pixel X used in the reduced image, which has a color different from that of the pixel X (sixth determination processing). In this embodiment, the neighboring pixels to be compared are three pixels to refer to the second additional information in the first embodiment. More specifically, the block of interest is expressed as B<sub>n</sub>, a block adjacent on the right side as B<sub>n+1</sub>, a block immediately below the block of interest as B<sub>n+W</sub>, and a block off to the lower right side of the block of interest as B<sub>n+W+1</sub>. Assume that the block of interest has the pattern 1601 in <figref idrefs="f0013">Fig. 16</figref>. In this case, the pixel Xa (also interchangeable with Xb or Xc) is sequentially compared with pixels B<sub>n</sub>(0,0), B<sub>n+1</sub>(0,0), and B<sub>n+W</sub>(0,0), thereby determining whether a coincident pixel exists. Note that all the pixels B<sub>n</sub>(0,0), B<sub>n+1</sub>(0,0), and B<sub>n+W</sub>(0,0) are directly used in the reduced image. If the block of interest has the pattern 1603, a pixel in the block of interest, which has a color different from that of the pixel used in the reduced image, is the pixel Xb, as can<!-- EPO <DP n="37"> --> be seen from <figref idrefs="f0003">Fig. 4</figref>. Hence, the pixel Xb is sequentially compared with the pixels B<sub>n</sub>(0,0), B<sub>n+1</sub>(0,0), and B<sub>n+W</sub>(0,0).</p><p id="p0167" num="0167">Upon determining that a coincident neighboring pixel exists, the non-flat block analysis unit 1202 advances the process to step S1509 to output, to the storage unit 204, information representing the relative position of the coincident pixel (third output processing). In this embodiment, the number of neighboring pixels to be compared is "3". Hence, two bits suffice to specify the relative position of a coincident pixel. In the embodiment, the non-flat block analysis unit 1202 outputs, to the storage unit 204, two bits "11" if the neighboring pixel B<sub>n</sub>(0,0) is coincident, two bits "01" for B<sub>n+1</sub>(0,0), and two bits "10" for B<sub>n+W</sub>(0,0).</p><p id="p0168" num="0168">On the other hand, upon determining in step S1508 that there is no neighboring pixel having the same color as that of one of the pixels Xa, Xb, and Xc of the block of interest other than the pixel X used in the reduced image, which has a color different from that of the pixel X, the non-flat block analysis unit 1202 advances the process to step S1510. In step S1510, the non-flat block analysis unit 1202 outputs two bits "00" to the storage unit 204. Note that the two bits "00" are not used in step S1509.</p><p id="p0169" num="0169">Next, in step S1511, the non-flat block analysis unit 1202 outputs the value (eight bits) of one of the pixels Xa, Xb, and Xc of the block of interest other than the pixel X used in the reduced image, which has a color different from that of the pixel X (fourth output processing). It would be understood that the decoding apparatus can restore the value of each pixel of the patterns 1601 to 1607 in <figref idrefs="f0013">Fig. 16</figref> by specifying one of the patterns shown in <figref idrefs="f0013">Fig. 16</figref> and knowing the value of one of the pixels Xa, Xb, and Xc of the block of interest other than the pixel X used in the reduced image,<!-- EPO <DP n="38"> --> which has a color different from that of the pixel X.</p><p id="p0170" num="0170">After that, the non-flat block analysis unit 1202 advances the process to step S1514 to determine whether the block of interest is the final non-flat block of the tile of interest. If NO in step S1514, the process advances to step S1515. The non-flat block analysis unit 1202 receives 2 × 2 pixel data representing the next non-flat block and returns the process to step S1502.</p><p id="p0171" num="0171">Upon determining in step S1514 that the block of interest is the final non-flat block of the tile of interest, the non-flat block analysis unit 1202 ends the processing of the non-flat blocks in the tile of interest.</p><p id="p0172" num="0172">As described above, according to the third embodiment, the interpolation data generator 1101 first determines whether a tile is a flat tile. If YES, the interpolation data generator 1101 generates 1-bit additional information for the tile and ends the processing. Upon determining that the tile is no flat tile, the interpolation data generator 1101 outputs 1-bit information representing a non-flat tile and verifies a block line narrower than a tile. This processing is repeated up to the final size (block). As a result, the amount of additional information to generate the original resolution image from the reduced image is expected to be smaller than in the first and second embodiments.</p><p id="p0173" num="0173">Note that an example of processing in three steps of "tile", "block line", and "block" has been described in the above embodiment. However, the number of steps may be increased.</p><p id="p0174" num="0174">In addition, it is obvious that a computer program can implement processing corresponding to the third embodiment, as in the above-described modification of the first embodiment.<!-- EPO <DP n="39"> --></p><heading id="h0015">[Fourth Embodiment]</heading><p id="p0175" num="0175">The first to third embodiments have disclosed techniques of completely restoring an original image based on a reduced image and interpolation data (encoded data). That is, the first to third embodiments have disclosed lossless encoding. In the fourth embodiment, a method of generating lossy interpolation data will be explained.</p><p id="p0176" num="0176">Note that in the fourth embodiment as well, process target image data is assumed to be monochrome multi-valued image data for the descriptive convenience. This embodiment is also applicable to RGB image data or CMYK color image data. A color space of any type is usable.</p><p id="p0177" num="0177">The fourth embodiment is the same as the third embodiment except the process contents of a non-flat block analysis unit 1202. Hence, the apparatus arrangement is the same as in <figref idrefs="f0009">Figs. 11 and 12</figref>, and a description thereof will not be repeated.</p><p id="p0178" num="0178"><figref idrefs="f0014">Figs. 17A</figref> and <figref idrefs="f0015">17B</figref> are flowcharts illustrating the processing procedure of the non-flat block analysis unit 1202 according to the fourth embodiment. It should be understood that the flowchart in <figref idrefs="f0014">Figs. 17A</figref> and <figref idrefs="f0015">17B</figref> replaces that in <figref idrefs="f0012">Fig. 15</figref>. Hence, the same step numbers denote the same process contents.</p><p id="p0179" num="0179">First, in step S1501, the non-flat block analysis unit 1202 receives the image data of 2 × 2 pixels representing a non-flat block. In step S1701, the non-flat block analysis unit 1202 determines whether, in a received block B<sub>n</sub> of interest, three pixels Xa, Xb, and Xc in <figref idrefs="f0003">Fig. 4</figref> have colors similar to those of neighboring pixels to be referred to (seventh determination processing). That is, complete matching is not required, unlike the first to third embodiment.</p><p id="p0180" num="0180">More specifically, let Th1 be a threshold<!-- EPO <DP n="40"> --> representing an allowable color difference (the user can change Th1 via, e.g., the operation unit or keyboard as needed). The non-flat block analysis unit 1202 determines that the three pixels Xa, Xb, and Xc have colors similar to those of the neighboring pixels to be referred to when they satisfy <maths id="math0014" num=""><math display="block"><mfenced open="|" close="|" separators=""><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">n</mi></msub><mfenced><mn mathvariant="normal">0</mn><mn mathvariant="normal">1</mn></mfenced><mo>-</mo><msub><mi mathvariant="normal">B</mi><mrow><mi mathvariant="normal">n</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow></msub><mfenced><mn mathvariant="normal">0</mn><mn mathvariant="normal">0</mn></mfenced></mfenced><mo>≤</mo><mi>Th</mi><mo>⁢</mo><mn mathvariant="normal">1</mn><mo>,</mo></math><img id="ib0014" file="imgb0014.tif" wi="72" he="8" img-content="math" img-format="tif"/></maths><br/>
and <maths id="math0015" num=""><math display="block"><mfenced open="|" close="|" separators=""><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">n</mi></msub><mfenced><mn>1</mn><mn>0</mn></mfenced><mo>-</mo><msub><mi mathvariant="normal">B</mi><mrow><mi mathvariant="normal">n</mi><mo>+</mo><mi mathvariant="normal">W</mi></mrow></msub><mfenced><mn mathvariant="normal">0</mn><mn mathvariant="normal">0</mn></mfenced></mfenced><mo>≤</mo><mi>Th</mi><mo>⁢</mo><mn mathvariant="normal">1</mn><mo>,</mo></math><img id="ib0015" file="imgb0015.tif" wi="71" he="7" img-content="math" img-format="tif"/></maths><br/>
and <maths id="math0016" num=""><math display="block"><mfenced open="|" close="|" separators=""><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">n</mi></msub><mfenced><mn>1</mn><mn>1</mn></mfenced><mo>-</mo><msub><mi mathvariant="normal">B</mi><mrow><mi mathvariant="normal">n</mi><mo>+</mo><mi mathvariant="normal">W</mi><mo>+</mo><mn>1</mn></mrow></msub><mfenced><mn mathvariant="normal">0</mn><mn mathvariant="normal">0</mn></mfenced></mfenced><mo>≤</mo><mi>Th</mi><mo>⁢</mo><mn mathvariant="normal">1</mn></math><img id="ib0016" file="imgb0016.tif" wi="73" he="6" img-content="math" img-format="tif"/></maths><br/>
where |zl is the absolute value of z.</p><p id="p0181" num="0181">Note that the present inventors have found that the threshold Th1 is a single-digit numerical value, and preferably, Th1 = 4.</p><p id="p0182" num="0182">If the inequalities are satisfied, the non-flat block analysis unit 1202 advances the process to step S1503 to output a flag "1" and end processing of the block B<sub>n</sub> of interest. Then, processing of the next non-flat block starts. At this time, depending on the set threshold, it is possible to maintain image quality whose degradation is hard to notice while suppressing the interpolation data amount.</p><p id="p0183" num="0183">In the third embodiment, if the number of colors that appear in the block B<sub>n</sub> of interest is three or four, the pixel values of three pixels need to be output. In the fourth embodiment, step S1702 representing determination processing is added before pixel value output (step S1513). In step S1702, the non-flat block analysis unit 1202 determines whether the three pixels Xa, Xb, and Xc in <figref idrefs="f0003">Fig. 4</figref> have values (equal to or smaller than a threshold Th2) close to the average values of adjacent pixels.</p><p id="p0184" num="0184">More specifically, the non-flat block analysis unit 1202 calculates average values Xave1 to Xave3 of four pixels used in the reduced image by<maths id="math0017" num=""><math display="block"><mi>Xave</mi><mo>⁢</mo><mn>1</mn><mo>=</mo><mfenced open="{" close="}" separators=""><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">n</mi></msub><mfenced><mn>0</mn><mn>0</mn></mfenced><mo>+</mo><msub><mi mathvariant="normal">B</mi><mrow><mi mathvariant="normal">n</mi><mo>+</mo><mn>1</mn></mrow></msub><mfenced><mn>0</mn><mn>0</mn></mfenced></mfenced><mo>/</mo><mn>2</mn></math><img id="ib0017" file="imgb0017.tif" wi="80" he="8" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="41"> --> <maths id="math0018" num=""><math display="block"><mi>Xave</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>=</mo><mfenced open="{" close="}" separators=""><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">n</mi></msub><mfenced><mn mathvariant="normal">0</mn><mn mathvariant="normal">0</mn></mfenced><mo>+</mo><msub><mi mathvariant="normal">B</mi><mrow><mi mathvariant="normal">n</mi><mo>+</mo><mi mathvariant="normal">W</mi></mrow></msub><mfenced><mn mathvariant="normal">0</mn><mn mathvariant="normal">0</mn></mfenced></mfenced><mo>/</mo><mn mathvariant="normal">2</mn></math><img id="ib0018" file="imgb0018.tif" wi="81" he="8" img-content="math" img-format="tif"/></maths> <maths id="math0019" num=""><math display="block"><mi>Xave</mi><mo>⁢</mo><mn>3</mn><mo>=</mo><mfenced open="{" close="}" separators=""><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">n</mi></msub><mfenced><mn mathvariant="normal">0</mn><mn mathvariant="normal">0</mn></mfenced><mo>+</mo><msub><mi mathvariant="normal">B</mi><mrow><mi mathvariant="normal">n</mi><mo>+</mo><mi mathvariant="normal">W</mi><mo>+</mo><mn>1</mn></mrow></msub><mfenced><mn mathvariant="normal">0</mn><mn mathvariant="normal">0</mn></mfenced></mfenced><mo>/</mo><mn mathvariant="normal">2</mn></math><img id="ib0019" file="imgb0019.tif" wi="86" he="6" img-content="math" img-format="tif"/></maths><br/>
(fractions below the decimal point are dropped).</p><p id="p0185" num="0185">When <maths id="math0020" num=""><math display="block"><mfenced open="|" close="|" separators=""><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">n</mi></msub><mfenced><mn mathvariant="normal">0</mn><mn mathvariant="normal">1</mn></mfenced><mo>-</mo><mi>Xave</mi><mo>⁢</mo><mn>1</mn></mfenced><mo>≤</mo><mi>Th</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>,</mo></math><img id="ib0020" file="imgb0020.tif" wi="63" he="7" img-content="math" img-format="tif"/></maths><br/>
and <maths id="math0021" num=""><math display="block"><mfenced open="|" close="|" separators=""><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">n</mi></msub><mfenced><mn>1</mn><mn>0</mn></mfenced><mo>-</mo><mi>Xave</mi><mo>⁢</mo><mn>2</mn></mfenced><mo>≤</mo><mi>Th</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>,</mo></math><img id="ib0021" file="imgb0021.tif" wi="63" he="8" img-content="math" img-format="tif"/></maths><br/>
and <maths id="math0022" num=""><math display="block"><mfenced open="|" close="|" separators=""><msub><mi mathvariant="normal">B</mi><mi mathvariant="normal">n</mi></msub><mfenced><mn mathvariant="normal">1</mn><mn mathvariant="normal">1</mn></mfenced><mo>-</mo><mi>Xave</mi><mo>⁢</mo><mn>3</mn></mfenced><mo>≤</mo><mi>Th</mi><mo>⁢</mo><mn mathvariant="normal">2</mn></math><img id="ib0022" file="imgb0022.tif" wi="62" he="6" img-content="math" img-format="tif"/></maths><br/>
are satisfied, the non-flat block analysis unit 1202 determines that the three pixels Xa, Xb, and Xc have values (equal to or smaller than the threshold) close to the average values of adjacent pixels.</p><p id="p0186" num="0186">The threshold Th2 is also set by the user as needed. The threshold Th2 is preferably a single-digit positive integer at maximum (threshold Th2 = 4 in this case as well).</p><p id="p0187" num="0187">Upon determining that all the pixels Xa, Xb, and Xc have small differences to the average values (YES), the non-flat block analysis unit 1202 advances to the process to step S1703 to output a flag "1" (fifth output processing). On the other hand, if all the pixels Xa, Xb, and Xc have large differences to the average values (NO), the non-flat block analysis unit 1202 advances to the process to step S1704 to output a flag "0". then, in step S1513, the non-flat block analysis unit 1202 outputs the pixel values, as in the third embodiment.</p><p id="p0188" num="0188">The above-described processing makes is possible to generate lossy interpolation data without rarely changing the processing of lossless interpolation data while controlling the errors to the pixel values of the original image data. It would easily be understood that since the pixel values have tolerances to some extent, the interpolation data amount can further be decreased as compared to the third embodiment.<!-- EPO <DP n="42"> --></p><p id="p0189" num="0189">Note that in the above-described fourth embodiment, lossy interpolation data generation is done using two determination processes in steps S1701 and S1702. However, only one of the processes may be applied.</p><heading id="h0016">[Fifth Embodiment]</heading><p id="p0190" num="0190">In the fifth embodiment, a method of controlling the code amount by switching between lossless interpolation data generation and lossy interpolation data generation will be described.</p><p id="p0191" num="0191">When the code amount of interpolation data needs to fall within a predetermined data amount range, the code amount can be controlled stepwise in consideration of the relationship between the code amount and the image quality.</p><p id="p0192" num="0192">If it is unnecessary to control the code amount because priority is given to the image quality, lossless interpolation data is generated. In this case, there is no guarantee that the data amount is always small because three restoration target pixel values are directly output in some blocks.</p><p id="p0193" num="0193">To suppress the code amount while holding the image quality, a lossy interpolation data generation method as described in the fourth embodiment is applied, which can suppress the code amount while suppressing the maximum errors of pixel values between the original image and the restored image.</p><p id="p0194" num="0194">To further suppress the code amount of interpolation data, the tone or resolution of pixels whose pixel values are directly output as interpolation data is decreased. For example, when a block of 2 × 2 pixels includes three or four colors, the number of colors is decreased to two, or the tone is decreased from eight bits to four bits. When the pixel values are output, the code amount corresponds to 3 pixels × 8 bits. Decreasing the number of colors to two<!-- EPO <DP n="43"> --> reduces the code amount to 1 pixel × 8 bits. Decreasing the tone from eight bits to four bits reduces the code amount to 3 pixels × 4 bits. This method allows to decrease the code amount of interpolation data to almost 1/2 the original image at maximum, although a new flag is added.</p><p id="p0195" num="0195">As another control method, if a block of 2 × 2 pixels includes three or four colors, the pixels whose pixel values should be output are prohibited from outputting them, thereby controlling the code amount of interpolation data. In this case, when developing the image, one pixel of the reduced image is simply enlarged. Alternatively, when a block is determined to have three or four colors, the average value of the 2 × 2 pixels is calculated. The pixels of the reduced image are replaced with the average value. In developing the image, one pixel of the reduced image replaced with the average value is simply enlarged, thereby restoring the image. In this case, the 2 × 2 pixels have one color, the resolution of the image only partially lowers. A region where a block of 2 × 2 pixels includes three or four colors is estimated to be a region of a high resolution natural image at high possibility. In such a region, degradation in the image quality is supposed to be rarely noticeable even at a lower resolution.</p><p id="p0196" num="0196">In the above description, the method is switched depending on which has priority in generating interpolation data, the image quality or the code amount. However, the code amount can also be controlled by generating lossless interpolation data and discarding part of the data. For example, when generating lossless interpolation data for a block including three or four colors, the pixel values of pixels Xa, Xb, and Xc are output. The code amount can be controlled by discarding the pixel value of the three pixels halfway through or after the interpolation data generation.<br/>
<!-- EPO <DP n="44"> -->In this case, the block whose pixel values have been discarded is simply enlarged using a pixel of the reduced image when developing the image. Generating, simultaneously with the lossless interpolation data generation, data necessary after information discarding makes it possible to switch to another information with a small code amount without redoing the interpolation data generation. For example, when generating lossless interpolation data for a block including three or four colors, the pixel values of the pixels Xa, Xb, and Xc are output. At this time, the average value of the 2 × 2 pixels is held simultaneously. If code amount control is necessary halfway through or after the interpolation data generation, the pixel values of the pixels Xa, Xb, and Xc are discarded from the interpolation data and replaced with the calculated average value. The above-described methods enable to easily control the code amount by discarding part of the interpolation data or replacing pixel values with information having a small data amount halfway through or after the interpolation data generation.</p><heading id="h0017">[Sixth Embodiment]</heading><p id="p0197" num="0197">In the first to fifth embodiments, when generating a reduced image from an original image, the pixel B<sub>n</sub>(0,0) located at the upper left position of 2 × 2 pixels is used as a pixel of the reduced image, and interpolation data of the remaining three pixels B<sub>n</sub>(1,0), B<sub>n</sub>(0,1), and B<sub>n</sub>(1,1) is generated. However, the pixel to be used for the reduced image need not always be the upper left pixel of the block of 2 × 2 pixels and can be any one of the pixels B<sub>n</sub>(1,0), B<sub>n</sub>(0,1), and B<sub>n</sub>(1,1). In the sixth embodiment, a case will be explained in which the pixel B<sub>n</sub>(1,1) located at the lower right corner of a block B<sub>n</sub> of 2 × 2 pixels is used as a pixel of the reduced image.</p><p id="p0198" num="0198">In the sixth embodiment, a pixel X' in the block<!-- EPO <DP n="45"> --> B<sub>n</sub> of interest of 2 × 2 pixels shown in <figref idrefs="f0016">Fig. 18</figref> is used as a pixel of the reduced image, and remaining three pixels Xa', Xb', and Xc' are restoration targets.</p><p id="p0199" num="0199">Basically, the reference positions when sub-sampling the lower right pixel are and those when sub-sampling the upper left pixel are symmetric with respect to a point.</p><p id="p0200" num="0200">For example, in the above-described embodiments, the pixel B<sub>n+1</sub>(0,0) is referred to for the pixel B<sub>n</sub>(0,1) in the block of interest, B<sub>n+W</sub>(0,0) for B<sub>n</sub>(1,0), and B<sub>n+W+1</sub>(0,0) for B<sub>n</sub>(1,1).</p><p id="p0201" num="0201">In the sixth embodiment, however, pixels indicated by full circles shown in <figref idrefs="f0016">Fig. 18</figref> are referred to. More specifically, a pixel B<sub>n-1</sub>(1,1) is referred to for the pixel B<sub>n</sub>(1,0), B<sub>n-W</sub>(1,1) for B<sub>n</sub>(0,1), and B<sub>n-W-1</sub>(1,1) for B<sub>n</sub>(0,0). This enables interpolation data generation in accordance with the same procedures as in the first to fifth embodiments.</p><p id="p0202" num="0202">Hence, step S1701 of the fifth embodiment is expressed in the following way.</p><p id="p0203" num="0203">The sampling target pixel in the block of interest is defined as X, and three non-sampling target pixels are defined as Xa, Xb, and Xc. A sampling target pixel which is included in a block adjacent to the block of interest and located adjacent to the pixel Xa is defined as X1. Similarly, a sampling target pixel which is included in another block adjacent to the block of interest and located adjacent to the pixel Xb is defined as X2. A sampling target pixel which is included in still another block adjacent to the block of interest and located adjacent to the pixel Xc is defined as X3. A preset positive threshold is defined as Th1. In this case, it is determined in step S1701 whether <maths id="math0023" num=""><math display="block"><mfenced open="|" close="|" separators=""><mi>Xa</mi><mo>-</mo><mi mathvariant="normal">X</mi><mo>⁢</mo><mn>1</mn></mfenced><mo>≤</mo><mi>Th</mi><mo>⁢</mo><mn>1</mn><mo>,</mo></math><img id="ib0023" file="imgb0023.tif" wi="44" he="8" img-content="math" img-format="tif"/></maths><br/>
and <maths id="math0024" num=""><math display="block"><mfenced open="|" close="|" separators=""><mi>Xb</mi><mo>-</mo><mi mathvariant="normal">X</mi><mo>⁢</mo><mn>2</mn></mfenced><mo>≤</mo><mi>Th</mi><mo>⁢</mo><mn>1</mn><mo>,</mo></math><img id="ib0024" file="imgb0024.tif" wi="43" he="7" img-content="math" img-format="tif"/></maths><br/>
and<!-- EPO <DP n="46"> --> <maths id="math0025" num=""><math display="block"><mfenced open="|" close="|" separators=""><mi>Xc</mi><mo>-</mo><mi mathvariant="normal">X</mi><mo>⁢</mo><mn>3</mn></mfenced><mo>≤</mo><mi>Th</mi><mo>⁢</mo><mn>1</mn></math><img id="ib0025" file="imgb0025.tif" wi="43" he="8" img-content="math" img-format="tif"/></maths><br/>
are satisfied. When this condition is satisfied, it is determined that the three non-sampling target pixels in the block of interest can be restored from the sampling target pixels in the three blocks adjacent to the block of interest.</p><p id="p0204" num="0204">Applying the same definitions as described above, it is determined for a threshold Th2 in step S1702 of <figref idrefs="f0015">Fig. 17B</figref> whether <maths id="math0026" num=""><math display="block"><mfenced open="|" close="|" separators=""><mi>Xa</mi><mo>-</mo><mfenced separators=""><mi mathvariant="normal">X</mi><mo>+</mo><mi mathvariant="normal">X</mi><mo>⁢</mo><mn>1</mn></mfenced><mo>/</mo><mn>2</mn></mfenced><mo>≤</mo><mi>Th</mi><mo>⁢</mo><mn>2</mn><mo>,</mo></math><img id="ib0026" file="imgb0026.tif" wi="64" he="8" img-content="math" img-format="tif"/></maths><br/>
and <maths id="math0027" num=""><math display="block"><mfenced open="|" close="|" separators=""><mi>Xb</mi><mo>-</mo><mfenced separators=""><mi mathvariant="normal">X</mi><mo>+</mo><mi mathvariant="normal">X</mi><mo>⁢</mo><mn>2</mn></mfenced><mo>/</mo><mn>2</mn></mfenced><mo>≤</mo><mi>Th</mi><mo>⁢</mo><mn>2</mn><mo>,</mo></math><img id="ib0027" file="imgb0027.tif" wi="64" he="7" img-content="math" img-format="tif"/></maths><br/>
and <maths id="math0028" num=""><math display="block"><mfenced open="|" close="|" separators=""><mi>Xc</mi><mo>-</mo><mfenced separators=""><mi mathvariant="normal">X</mi><mo>+</mo><mi mathvariant="normal">X</mi><mo>⁢</mo><mn>3</mn></mfenced><mo>/</mo><mn>2</mn></mfenced><mo>≤</mo><mi>Th</mi><mo>⁢</mo><mn>2</mn></math><img id="ib0028" file="imgb0028.tif" wi="64" he="7" img-content="math" img-format="tif"/></maths><br/>
are satisfied.</p><p id="p0205" num="0205">When the upper left pixel X is sub-sampled, and the pixels on the right and lower sides of the block of interest are referred to, as in the first to fifth embodiments, it is impossible to refer to pixels at positions where decoding processing has not been executed yet in developing the image. Only the pixels of the reduced image can be referred to. It is therefore necessary to prefetch the pixels B<sub>n+1</sub>(0,0), B<sub>n+W</sub>(0,0), and B<sub>n+W+1</sub>(0,0) corresponding to the pixels of the reduced image. According to the sixth embodiment, however, when the lower right pixel X' is sub-sampled, and the pixels on the upper and left sides of the block B<sub>n</sub> of interest are referred to, pixels other than the pixels B<sub>n-1</sub>(1,1), B<sub>n-W</sub>(1,1), and B<sub>n-W-1</sub>(1,1) (pixels indicated by the full circles in <figref idrefs="f0016">Fig. 18</figref>) corresponding to the pixels of the reduced image can also be referred to because the image has already been developed in the reference blocks. For example, to generate second additional information or determine whether there is a neighboring pixel of a color that is the same as the second color of a block including two colors, the reference pixels need not always be those indicated by the full circles in <figref idrefs="f0016">Fig. 18</figref>. Only the pixels<!-- EPO <DP n="47"> --> indicated by the full circles may be referred to, as a matter of course. Alternatively, pixels indicated by stars may be used as the reference pixels. Both the pixels indicated by the full circles and those indicated by the starts may be used as the reference pixels.</p><p id="p0206" num="0206">Changing or expanding the reference range for coincidence/non-coincidence determination can improve the encoding efficiency in interpolation data generation.</p><heading id="h0018">[Seventh Embodiment]</heading><p id="p0207" num="0207">In the seventh embodiment, a code amount control method will be described which decides a parameter in lossy interpolation data generation by using statistical information acquired upon lossless interpolation data generation, thereby efficiently suppressing the interpolation data amount to a target code amount.</p><p id="p0208" num="0208"><figref idrefs="f0017">Fig. 19</figref> is a flowchart illustrating a processing procedure according to the seventh embodiment.</p><p id="p0209" num="0209">Lossless interpolation data generation in step S1901 is the same as described above, and a description thereof will not be repeated in this embodiment. Statistical information to be acquired when generating lossless interpolation data will be explained below.</p><p id="p0210" num="0210">In lossless interpolation data generation, when interpolation target pixels cannot be reproduced from pixels of the reduced image or neighboring pixels around the block of interest, the interpolation target pixel values are output as encoded data (steps S1513 and S1511 of non-flat block processing shown in <figref idrefs="f0012">Fig. 15</figref>). If the pixel values are output, the data amount may be larger than that of the original image because of flag information other than the pixel values, as described above. For this reason, in lossy interpolation data generation, decreasing or deleting blocks whose pixel values are to be output is supposed to enhance the data amount<!-- EPO <DP n="48"> --> reduction effect.</p><p id="p0211" num="0211">To do this, the number of blocks to be subjected to the pixel value output processing is counted in generating lossless interpolation data. The counted number of blocks of the pixel value output processing is held as statistical information.</p><p id="p0212" num="0212">After the end of lossless interpolation data generation and statistical information recording, a parameter Prm for lossy encoding is cleared to zero in step S1902, and the process advances to step S1903.</p><p id="p0213" num="0213">In step S1903 (first comparison processing), the data amount of the interpolation information generated by lossless interpolation data generation is compared with a preset target data amount. If the comparison result indicates that the interpolation data amount is larger than the target value, the process advances to step S1904. If the comparison result indicates that the interpolation data amount is equal to or smaller than the target value, the process advances to step S1908 to output the lossless interpolation data.</p><p id="p0214" num="0214">In step S1904 (second comparison processing), the statistical information acquired upon lossless interpolation data generation, i.e., the number i of times of pixel value output (the number of blocks of pixel value output) is compared with a preset threshold Th3. The threshold Th3 is set at an arbitrary value. In this embodiment, the threshold Th3 is set to 30% of the number of blocks each having 2 × 2 pixels in the entire input image. For, e.g., an A4 image at 600 dpi, the image size is about 4,960 × 7,016 pixels, and the total number of blocks each including 2 × 2 pixels is 8,699,840. The threshold Th3 is 30% the number of blocks, i.e., 2,609,952. The number i of times is compared with the threshold Th3. A parameter to set the degree of tone reduction (to be described later) is decided based on the<!-- EPO <DP n="49"> --> comparison result. More specifically, if the number i of times of pixel value output is larger than the threshold Th3 (YES), the process advances to step S1905 to update the parameter Prm to be used for lossy interpolation data generation by adding Prm1. On the other hand, if the number i of times of pixel value output is equal to or smaller than the threshold Th3 (NO), the process advances to step S1906 to update the parameter Prm to be used for lossy interpolation data generation by adding Prm2. In this case, Prm1 &gt; Prm2.</p><p id="p0215" num="0215">After updating the parameter Prm in step S1905 or S1906, the process advances to step S1907 to generate lossy interpolation data. Details of the lossy interpolation data generation method of this embodiment will be described below.</p><p id="p0216" num="0216"><figref idrefs="f0018">Fig. 20</figref> is a block diagram of an arrangement which performs lossy interpolation data generation processing in step S1907. A block tone reduction processing unit 2001 first checks the pixel values in each block of 2 × 2 pixels. If the 2 × 2 pixels include at least one set of pixels having close colors, they are integrated. This processing is performed in the entire image. Then, an interpolation data generator 1101 generates interpolation data. The process contents of the interpolation data generator 1101 are the same as those described in the third embodiment, and a description thereof will not be repeated. The block tone reduction processing unit 2001 performs the processing in, e.g., the following way.</p><p id="p0217" num="0217">The block tone reduction processing unit 2001 checks the color differences between the 2 × 2 pixels of the block of interest and calculates <maths id="math0029" num=""><math display="block"><mi mathvariant="normal">F</mi><mo>⁢</mo><mn>1</mn><mo>=</mo><mfenced open="|" close="|" separators=""><mi mathvariant="normal">X</mi><mo>-</mo><mi>Xa</mi></mfenced></math><img id="ib0029" file="imgb0029.tif" wi="37" he="7" img-content="math" img-format="tif"/></maths> <maths id="math0030" num=""><math display="block"><mi mathvariant="normal">F</mi><mo>⁢</mo><mn>2</mn><mo>=</mo><mfenced open="|" close="|" separators=""><mi mathvariant="normal">X</mi><mo>-</mo><mi>Xb</mi></mfenced></math><img id="ib0030" file="imgb0030.tif" wi="38" he="7" img-content="math" img-format="tif"/></maths> <maths id="math0031" num=""><math display="block"><mi mathvariant="normal">F</mi><mo>⁢</mo><mn>3</mn><mo>=</mo><mfenced open="|" close="|" separators=""><mi mathvariant="normal">X</mi><mo>-</mo><mi>Xc</mi></mfenced></math><img id="ib0031" file="imgb0031.tif" wi="38" he="6" img-content="math" img-format="tif"/></maths> <maths id="math0032" num=""><math display="block"><mi mathvariant="normal">F</mi><mo>⁢</mo><mn>4</mn><mo>=</mo><mfenced open="|" close="|" separators=""><mi>Xa</mi><mo>-</mo><mi>Xb</mi></mfenced></math><img id="ib0032" file="imgb0032.tif" wi="40" he="8" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="50"> --> <maths id="math0033" num=""><math display="block"><mi mathvariant="normal">F</mi><mo>⁢</mo><mn>5</mn><mo>=</mo><mfenced open="|" close="|" separators=""><mi>Xa</mi><mo>-</mo><mi>Xc</mi></mfenced></math><img id="ib0033" file="imgb0033.tif" wi="41" he="8" img-content="math" img-format="tif"/></maths> <maths id="math0034" num=""><math display="block"><mi mathvariant="normal">F</mi><mo>⁢</mo><mn>6</mn><mo>=</mo><mfenced open="|" close="|" separators=""><mi>Xb</mi><mo>-</mo><mi>Xc</mi></mfenced></math><img id="ib0034" file="imgb0034.tif" wi="43" he="7" img-content="math" img-format="tif"/></maths><br/>
The colors of the 2 × 2 pixels are integrated if <maths id="math0035" num="(3)"><math display="block"><mi>Prm</mi><mo>&gt;</mo><mi>max</mi><mspace width="1em"/><mfenced separators=""><mi mathvariant="normal">F</mi><mo>⁢</mo><mn mathvariant="normal">1</mn><mo>,</mo><mspace width="1em"/><mi mathvariant="normal">F</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>,</mo><mspace width="1em"/><mi mathvariant="normal">F</mi><mo>⁢</mo><mn mathvariant="normal">3</mn><mo>,</mo><mspace width="1em"/><mi mathvariant="normal">F</mi><mo>⁢</mo><mn mathvariant="normal">4</mn><mo>,</mo><mspace width="1em"/><mi mathvariant="normal">F</mi><mo>⁢</mo><mn mathvariant="normal">5</mn><mo>,</mo><mspace width="1em"/><mi mathvariant="normal">F</mi><mo>⁢</mo><mn mathvariant="normal">6</mn></mfenced></math><img id="ib0035" file="imgb0035.tif" wi="129" he="8" img-content="math" img-format="tif"/></maths><br/>
holds, where max(A1, A2, ..., An) is a function that returns the maximum value of A1, A2, ..., An.</p><p id="p0218" num="0218">In this embodiment, color integration is correcting (replacing) the interpolation target pixels Xa, Xb, and Xc to (with) the color of the pixel X sampled for reduced image generation. That is, the block of interest is converted into a flat block. Note that since Prm1 &gt; Prm2, when Prm1 is selected, the possibility that the colors are integrated is high, and when Prm2 is selected, the possibility that the colors are integrated is low.</p><p id="p0219" num="0219">If Expression (3) does not hold, the colors of all pixels (four pixels) in the block of interest are not close to each other. Hence, integration processing is not performed. However, if two pixels in the block have not completely identical but similar colors, the pixel values may be replaced with the average value of the two colors. This is because the number of colors included in the block of interest can decrease but not increase. If the number of colors decreased from "4" to "3", the compression ratio does not rise. However, if the number of colors decreases to "1", the block of interest is a flat block, and the compression ratio is expected to be higher. If the number of colors is "2", the block corresponds to one of the patterns shown in <figref idrefs="f0013">Fig. 16</figref>, and the compression ratio is expected to be higher.</p><p id="p0220" num="0220">Another tone reduction method will be described below.</p><p id="p0221" num="0221">First, the 2 × 2 pixels are searched for two pixels having the largest color distance. The two pixels having the large color distance are defined as the<!-- EPO <DP n="51"> --> representative colors of the respective groups. Next, the color distance between each representative color and each pixel having no representative color is obtained, and the pixel is put into the group with a smaller color distance. The pixels put into each group are integrated, thereby reducing the number of colors of the 2 × 2 pixels to two. The pixels in each group are integrated by replacing the pixel values with the average value between them. However, in this embodiment, if a group includes the pixel X of the reduced image, all the pixel values in that group are replaced with X.</p><p id="p0222" num="0222">The above-described tone reduction processing is executed for the blocks each having 2 × 2 pixels in the entire image. When the tone reduction processing has ended for the blocks of the whole image, the image data that has undergone the tone reduction processing is output to the interpolation data generator and re-encoded.</p><p id="p0223" num="0223">The process contents of the interpolation data generator 1101 are the same as those of lossless interpolation data generation described in the third embodiment except that the input image data is the original image or the image that has undergone the tone reduction processing.</p><p id="p0224" num="0224">When interpolation data generation is performed after tone reduction processing by the above-described method, the number of colors in a block decreases. Since two- or three-color processing of a non-flat block can be executed, the possibility that the pixel values of three pixels are output becomes low, and the interpolation data amount can be suppressed. Additionally, adjusting the parameter in the tone reduction processing based on the number i of times of pixel value output acquired in lossless interpolation data generation, makes it possible to decrease the interpolation data amount while maintaining the image quality as high as<!-- EPO <DP n="52"> --> possible. More specifically, if the number i of times of pixel value output is large in lossless interpolation data generation, the parameter is set large to facilitate color integration and enhance the interpolation data amount suppressing effect. On the other hand, if the number i of times of pixel value output is small, the parameter is set not to be so large to minimize changes in the colors. This allows to suppress the data amount while maintaining high image quality.</p><p id="p0225" num="0225">Note that in this embodiment, only the number of times of pixel value output is counted and used. However, even if the number of times of pixel value output does not change, the interpolation data amount changes because the pixel value of one pixel is output when a block includes two colors, and the pixel values of three pixels are output when a block includes three or four colors. Hence, the information may be counted separately in pixel value output of two-color processing (one pixel value is output) and in pixel value output of four-color processing (output three pixel values are output), and the parameter setting method may be changed based on the information.</p><p id="p0226" num="0226">After the lossy interpolation data generation (step S1907), the process returns to step S1903 to compare the lossy interpolation data amount with the predetermined target amount. If the lossy interpolation data amount is smaller than the target value (NO), the process advances to step S1908 to output the interpolation data and end the processing. On the other hand, if the interpolation data amount is larger than the target value (YES), the parameter is reset, and lossy encoding is performed. The reset parameter gradually takes a larger value. In the worst case, all blocks in the image have the same color. However, the number of times of repeat is limited, and if the number of<!-- EPO <DP n="53"> --> times of repeat has exceeded an arbitrary value, a value larger than the maximum pixel value is set as the parameter. This enables to end the processing.</p><p id="p0227" num="0227">In the lossy interpolation data generation of the above-described embodiment, after block tone reduction processing is ended for the entire image, interpolation data is generated in accordance with the same procedure as in lossless interpolation data generation for the descriptive convenience. However, the lossy interpolation data generation method is not limited to this. The interpolation data of a block of interest may be generated following tone reduction in the block of interest. At this time, extracting the lower right pixel in the block as a pixel of the reduced image makes it possible to refer to the pixel values after tone reduction processing even when referring to the neighboring pixels. This allows processing of each block.</p><heading id="h0019">[Eighth Embodiment]</heading><p id="p0228" num="0228">In the above-described seventh embodiment, if the interpolation data amount has exceeded the target value in lossless interpolation data generation, the parameter to be used for re-encoding in lossy interpolation data generation is decided based on information acquired upon generating lossless interpolation data. In the eighth embodiment, a code amount control method will be explained which changes the data decreasing method itself based on information acquired upon lossless interpolation data generation.</p><p id="p0229" num="0229"><figref idrefs="f0019">Fig. 21</figref> is a flowchart illustrating a processing procedure according to the eighth embodiment. A description of the same process contents as in <figref idrefs="f0017">Fig. 19</figref> will not be repeated.</p><p id="p0230" num="0230">In the eighth embodiment, it is determined based on the amount of lossless interpolation data whether to perform re-encoding (step S1903), as in the seventh<!-- EPO <DP n="54"> --> embodiment. Upon determining to perform re-encoding, the same determination as in the seventh embodiment is performed in step S1904. In the eighth embodiment, however, the lossy processing method is switched instead of changing the parameter set value in lossy interpolation data generation. More specifically, if the number i of times of pixel value output is larger than a threshold Th3 (YES), the process advances to step S2101. If the number i of times of pixel value output is equal to or smaller than the threshold Th3 (NO), the process advances to step S1907 to generate lossy interpolation data. When the lossy interpolation data has been generated, the process returns to step S1903 to determine whether the lossy interpolation data amount is equal to or smaller than the target value. If the lossy interpolation data amount is larger than the target value, the process advances to step S1904. In this embodiment, however, when executing the determination in step S1904 for the second time, "0" is set as the threshold Th3 to always advance the process to step S2101.</p><p id="p0231" num="0231">In step S2101, the whole input image data is resolution-converted. As the resolution conversion method, the values of 2 × 2 pixels are replaced with the average value of 2 × 2 pixels in a block of interest. The average value of 2 × 2 pixels is calculated to make degradation in the image quality as unnoticeable as possible. However, the method is not limited to this. The data amount after resolution conversion is 1/4 that of the input image data. When resolution conversion has been performed, the process advances to step S1908 to output the data after the resolution conversion.</p><p id="p0232" num="0232">The above-described processing allows to decrease the data amount by lossy interpolation data generation or resolution conversion processing when the interpolation data<!-- EPO <DP n="55"> --> amount is equal to or larger than a predetermined value. Whether to generate lossy interpolation data or perform resolution conversion processing is determined based on information acquired upon lossless interpolation data generation. If the number of times of pixel value output is very large, direct resolution conversion can be performed. Since the number of times of repeat decreases, the process time shortens. Additionally, an image for which the number of times of pixel value output is very large is, at a high possibility, an image like a high resolution natural image including many changes in the pixel value. Degradation in the image quality is hardly noticeable even at a lower resolution after resolution conversion. This makes it possible to suppress the data amount while maintaining the image quality.</p><heading id="h0020">Other Embodiments</heading><p id="p0233" num="0233">Aspects of the present invention can also be realized by a computer of a system or apparatus (or devices such as a CPU or MPU) that reads out and executes a program recorded on a memory device to perform the functions of the above-described embodiment(s), and by a method, the steps of which are performed by a computer of a system or apparatus by, for example, reading out and executing a program recorded on a memory device to perform the functions of the above-described embodiment(s). For this purpose, the program is provided to the computer for example via a network or from a recording medium of various types serving as the memory device (e.g., computer-readable medium).</p><p id="p0234" num="0234">While the present invention has been described with reference to exemplary embodiments, it is to be understood that the invention is not limited to the disclosed exemplary embodiments.<!-- EPO <DP n="56"> --> This invention generates efficient encoded data to restore original image data from reduced image data. An input unit inputs block data of 2 × 2 pixels from original image data. A converter generates reduced image data having a size smaller than the original image data by sampling one pixel data at a preset position in the input block data. A generator generates encoded data to restore three non-sampling target pixel data in each block data so as to restore the original image data from the reduced image data generated by the resolution converter. To do this, the generator determines whether all non-sampling target pixels in a block of interest are restorable from a sampling target pixel in the block of interest or from sampling target pixels in three blocks adjacent to the block of interest, and generates and outputs three kinds of additional information based on the determination result.</p></description><claims mxw-id="PCLM56984681" lang="DE" load-source="patent-office"><!-- EPO <DP n="63"> --><claim id="c-de-01-0001" num="0001"><claim-text>Bildcodiervorrichtung zur Codierung von Bilddaten, mit<br/>
einer Eingabeeinrichtung (201) zur Eingabe eines Blocks von 2 mal 2 Pixeln von Originalbilddaten eines Codierziels,<br/>
einer Erzeugungseinrichtung eines reduzierten Bildes (202) zur Erzeugung und Ausgabe von reduzierten Bilddaten mit einer Größe kleiner als die Originalbilddaten durch Abtasten eines Pixeldatenelements an einer voreingestellten Position in dem eingegebenen Block, und<br/>
einer Codiereinrichtung (203) zur Erzeugung von codierten Daten, um drei Nichtabtastzielpixeldatenelemente in jedem Block wiederherzustellen, um die Originalbilddaten aus den durch die Erzeugungseinrichtung eines reduzierten Bildes (202) erzeugten reduzierten Bilddaten wiederherzustellen,<br/>
wobei die Codiereinrichtung (203) aufweist<br/>
eine Bestimmungseinrichtung (203) zur, mit X als ein Abtastzielpixel in einem Block von Interesse (Bn), und mit Xa, Xb und Xc als Nichtabtastzielpixel in dem Block von Interesse (Bn), Bestimmung,<br/>
Bedingung a: ob alle der Pixel Xa, Xb und Xc identisch mit dem Pixel X in dem Block von Interesse (Bn) sind, und<br/>
Bedingung b: ob alle der Pixel Xa, Xb und Xc identisch mit Abtastzielpixeln in drei zu dem Block von Interesse (Bn) benachbarten Blöcken sind, und<br/>
eine Zusatzinformationserzeugungseinrichtung (203) zur Erzeugung erster Zusatzinformation als codierte Daten des Blocks von Interesse (Bn), wenn die Bestimmungseinrichtung bestimmt hat, dass der Block von Interesse (Bn) die Bedingung a erfüllt,<br/>
zur Erzeugung zweiter Zusatzinformation verschieden von der ersten Zusatzinformation als die codierte Daten des Blocks von Interesse (Bn), wenn die Bestimmungseinrichtung (203) bestimmt hat, dass der<!-- EPO <DP n="64"> --> Block von Interesse (Bn) die Bedingung a nicht erfüllt aber die Bedingung b, und<br/>
zur Erzeugung dritter Zusatzinformation verschieden von der ersten Zusatzinformation und der zweiten Zusatzinformation als die codierten Daten des Blocks von Interesse (Bn), wenn die Bestimmungseinrichtung (203) bestimmt hat, dass der Block von Interesse (Bn) weder die Bedingung a noch die Bedingung b erfüllt.</claim-text></claim><claim id="c-de-01-0002" num="0002"><claim-text>Vorrichtung nach Anspruch 1, <b>dadurch gekennzeichnet, dass</b> die erste Zusatzinformation aus einem Bit gebildet ist, die zweite Zusatzinformation aus zwei Bits gebildet ist, von denen ein erstes Bit einen Wert unterschiedlich von der ersten Zusatzinformation aufweist, und die dritte Zusatzinformation aus zwei Bits, von denen ein erstes Bit identisch mit dem ersten Bit der zweiten Zusatzinformation und ein zweites Bit unterschiedlich ist, und drei Pixeldaten entsprechend den Pixeln Xa, Xb und Xc gebildet ist.</claim-text></claim><claim id="c-de-01-0003" num="0003"><claim-text>Vorrichtung nach Anspruch 1, ferner <b>gekennzeichnet durch</b><br/>
eine Eingabeeinrichtung codierter Daten (203) zur Eingabe von durch die Zusatzinformationserzeugungseinrichtung (203) erzeugter codierter Daten von M horizontalen Blöcken mal N vertikalen Blöcken, wobei jede aus M und N eine Ganzzahl nicht kleiner als 2 ist, und<br/>
eine Kachelintegrationseinrichtung (802) zur Integration der <b>durch</b> die Eingabeeinrichtung codierter Daten eingegebenen codierten Daten der M mal N Blöcke in codierte Daten einer die M mal N Blöcke enthaltenden Kachel,<br/>
wobei die Kachelintegrationseinrichtung (802) aufweist<br/>
eine erste Integrationseinrichtung zur Ausgabe von Kennzeichnungsinformation, die für eine Integration in eine Kachel stehen, und zur auf die Kennzeichnungsinformation folgenden Ausgabe der codierten Daten, wenn all die codierten Daten der M mal N Blöcke codierte Daten von nur einer Art aus der ersten Zusatzinformation, der zweiten Zusatzinformation und der dritten Zusatzinformation enthalten, und<br/>
<!-- EPO <DP n="65"> -->eine Blockzeilenintegrationseinrichtung zur Ausgabe von Kennzeichnungsinformation, die für eine Nichtintegration in eine Kachel stehen und zur Integration codierter Daten jeder Blockzeile, die aus codierten Daten von M horizontal in einer Kachel von Interesse angeordneten Blöcken gebildet ist, wenn all die codierten Daten der M mal N Blöcke codierte Daten von zumindest zwei Arten enthalten, und<br/>
wobei die Blockzeilenintegrationseinrichtung aufweist<br/>
eine zweite Integrationseinrichtung zur Ausgabe von Kennzeichnungsinformation, die für eine Integration in eine Blockzeile steht, und zur auf die Kennzeichnungsinformation folgenden Ausgabe der codierten Daten, wenn M codierte Daten einer Blockzeile von Interesse codierte Daten von nur einer Art der ersten Zusatzinformation, der zweiten Zusatzinformation und der dritten Zusatzinformation enthalten, und<br/>
eine Einrichtung zur Ausgabe von Kennzeichnungsinformation, die für eine Nichtintegration in eine Blockzeile steht, und zur Ausgabe der codierten Daten der in der Blockzeile von Interesse enthaltenen M Blöcke, wenn die M codierten Daten der Blockzeile von Interesse codierte Daten von zumindest zwei Arten enthalten.</claim-text></claim><claim id="c-de-01-0004" num="0004"><claim-text>Vorrichtung nach Anspruch 1, <b>dadurch gekennzeichnet, dass</b> die Codiereinrichtung (203) bestimmt,<br/>
dass die Bedingung a erfüllt ist, wenn X = Xa = Xb = Xc gilt, und<br/>
dass die Bedingung b erfüllt ist, wenn, mit X1 als Abtastzielpixel, das in einem benachbarten Block enthalten und benachbart zu dem Pixel Xa angeordnet ist, um zur Wiederherstellung des Pixels Xa herangezogen zu werden, mit X2 als Abtastzielpixel, das in einem anderen benachbarten Block enthalten und benachbart zu dem Pixel Xb angeordnet ist, um zur Wiederherstellung des Pixels Xb herangezogen zu werden, und mit X3 als Abtastzielpixel, das in einem weiteren anderen benachbarten Block enthalten und benachbart zu dem Pixel Xc angeordnet ist, um zur Wiederherstellung des Pixels Xc herangezogen zu werden,<maths id="math0039" num=""><math display="block"><mi>Xa</mi><mo>=</mo><mi mathvariant="normal">X</mi><mo>⁢</mo><mn>1</mn><mo>,</mo></math><img id="ib0039" file="imgb0039.tif" wi="21" he="8" img-content="math" img-format="tif"/></maths> und <maths id="math0040" num=""><math display="block"><mi mathvariant="normal">X</mi><mo>⁢</mo><mi mathvariant="normal">b</mi><mo>=</mo><mi mathvariant="normal">X</mi><mo>⁢</mo><mn>2</mn><mo>,</mo></math><img id="ib0040" file="imgb0040.tif" wi="22" he="9" img-content="math" img-format="tif"/></maths> und<!-- EPO <DP n="66"> --> <maths id="math0041" num=""><math display="block"><mi mathvariant="normal">X</mi><mo>⁢</mo><mi mathvariant="normal">c</mi><mo>=</mo><mi mathvariant="normal">X</mi><mo>⁢</mo><mn>3</mn></math><img id="ib0041" file="imgb0041.tif" wi="23" he="9" img-content="math" img-format="tif"/></maths><br/>
gilt.</claim-text></claim><claim id="c-de-01-0005" num="0005"><claim-text>Vorrichtung nach Anspruch 1, ferner <b>gekennzeichnet durch</b><br/>
eine erste Vergleichseinrichtung zum Vergleich einer Datenmenge der <b>durch</b> die Zusatzinformationserzeugungsvorrichtung (203) erhaltenen codierten Daten mit einer voreingestellten Zielcodemenge, und<br/>
einer Tonreduktionseinrichtung (2001) zur Reduktion der Anzahl von Farben, die <b>durch</b> jeden Block der <b>durch</b> die Eingabeeinrichtung eingegebenen Originalbilddaten wiedergegeben sind, <b>durch</b> Anpassung von Werten von Pixeln in jedem Block, wenn ein Vergleichsergebnis der ersten Vergleichseinrichtung darauf hinweist, dass die Datenmenge der codierten Daten die Zielcodemenge überschreitet,<br/>
wobei die Codiereinrichtung (203) eine Neucodierung des Blocks ausführt, der einer Tonreduzierung der Tonreduktionseinrichtung (2001) unterzogen wurde.</claim-text></claim><claim id="c-de-01-0006" num="0006"><claim-text>Vorrichtung nach Anspruch 5, ferner <b>gekennzeichnet durch</b><br/>
eine zweite Vergleichseinrichtung zum Vergleich der Anzahl von durch die Zusatzinformationserzeugungseinrichtung erzeugter dritter Zusatzinformation mit einem <b>durch</b> die Gesamtanzahl von in den Originalbilddaten enthaltenen Blöcken bestimmten Schwellwert, und<br/>
eine Einstelleinrichtung zur auf einem Vergleichsergebnis der zweiten Vergleichseinrichtung basierenden Einstellung eines Parameters, um einen Grad einer Tonreduktion der Tonreduktionseinrichtung einzustellen.</claim-text></claim><claim id="c-de-01-0007" num="0007"><claim-text>Vorrichtung nach Anspruch 1, ferner <b>gekennzeichnet durch</b><br/>
eine erste Vergleichseinrichtung zum Vergleich einer Datenmenge der <b>durch</b> die Zusatzinformationserzeugungseinrichtung erhaltenen codierten Daten mit einer voreingestellten Zielcodemenge,<br/>
eine zweite Vergleichseinrichtung zum Vergleich der Anzahl von durch die Zusatzinformationserzeugungseinrichtung (203) erzeugten dritten Zusatzinformation mit einem <b>durch</b> die Gesamtanzahl von in den Originalbilddaten enthaltenen Blöcken bestimmten Schwellwert, wenn ein<!-- EPO <DP n="67"> --> Vergleichsergebnis der ersten Vergleicheinrichtung darauf hinweist, dass die Datenmenge der codierten Daten die Zielcodemenge überschreitet,<br/>
eine Auflösungsumwandlungseinrichtung zur Umwandlung der Originalbilddaten in eine Auflösung geringer als die Auflösung der Originalbilddaten und Ausgabe der Daten als codierte Daten, wenn ein Vergleichsergebnis der zweiten Vergleicheinrichtung darauf hinweist, dass die Anzahl von dritter Zusatzinformation den Schwellwert überschreitet, und<br/>
eine Tonreduktionseinrichtung (2001) zur Reduktion der Anzahl von Farben, die <b>durch</b> jeden Block der <b>durch</b> die Eingabeeinrichtung eingegebenen Originalbilddaten wiedergegeben sind, <b>durch</b> Anpassung von Werten von Pixeln in jedem Block und Ausgabe des Blocks, der einer Tonreduzierung unterzogen wurde, zu der Codiereinrichtung, um eine Neucodierung auszuführen, wenn das Vergleichergebnis der zweiten Vergleichseinrichtung darauf hinweist, dass die Anzahl von dritter Zusatzinformation nicht größer als der Schwellwert ist.</claim-text></claim><claim id="c-de-01-0008" num="0008"><claim-text>Verfahren einer Steuerung einer Bildcodiervorrichtung zur Codierung von Bilddaten, mit den Schritten<br/>
Eingeben (S101) eines Blocks von 2 mal 2 Pixeln von Originalbilddaten eines Codierziels,<br/>
Erzeugen und Ausgeben von reduzierten Bilddaten mit einer Größe kleiner als die Originalbilddaten durch Abtasten eines Pixeldatenelements an einer voreingestellten Position in dem eingegebenen Block, und<br/>
Erzeugen (S103, S104) von codierten Daten, um drei Nichtabtastzielpixeldatenelemente in jedem Block wiederherzustellen, um die Originalbilddaten aus den in dem Schritt eines Erzeugens und Ausgebens der reduzierten Bilddaten erzeugten reduzierten Bilddaten wiederherzustellen,<br/>
wobei der Schritt eines Erzeugens (S103, S104) der codierten Daten die folgenden Schritte aufweist<br/>
Bestimmen, mit X als ein Abtastzielpixel in einem Block von Interesse, und mit Xa, Xb und Xc als Nichtabtastzielpixel in dem Block von Interesse,<br/>
<!-- EPO <DP n="68"> -->Bedingung a (S103): ob alle der Pixel Xa, Xb und Xc identisch mit dem Pixel X in dem Block von Interesse sind, und<br/>
Bedingung b (S104): ob alle der Pixel Xa, Xb und Xc identisch mit Abtastzielpixeln in drei zu dem Block von Interesse benachbarten Blöcken sind, und<br/>
Erzeugen (S105) erster Zusatzinformation als codierte Daten des Blocks von Interesse, wenn in dem Schritt eines Bestimmens bestimmt ist, dass der Block von Interesse die Bedingung a erfüllt,<br/>
Erzeugen (106) zweiter Zusatzinformation verschieden von der ersten Zusatzinformation als die codierte Daten des Blocks von Interesse, wenn in dem Schritt eines Bestimmens bestimmt ist, dass der Block von Interesse die Bedingung a nicht erfüllt aber die Bedingung b, und<br/>
Erzeugen (S107) dritter Zusatzinformation verschieden von der ersten Zusatzinformation und der zweiten Zusatzinformation als die codierten Daten des Blocks von Interesse, wenn in dem Schritt eines Bestimmens bestimmt ist, dass der Block von Interesse weder die Bedingung a noch die Bedingung b erfüllt.</claim-text></claim><claim id="c-de-01-0009" num="0009"><claim-text>Computer lesbares Speichermedium, das ein Computerprogramm speichert, das einen Computer dazu bringt, bei Auslesen und Ausführen des Computerprogramms das Verfahren nach Anspruch 8 durchzuführen.</claim-text></claim></claims><claims mxw-id="PCLM56984682" lang="EN" load-source="patent-office"><!-- EPO <DP n="57"> --><claim id="c-en-01-0001" num="0001"><claim-text>An image encoding apparatus for encoding image data, comprising:
<claim-text>input means (201) for inputting a block of 2 × 2 pixels from original image data of an encoding target;</claim-text>
<claim-text>reduced image generating means (202) for generating and outputting reduced image data having a size smaller than the original image data by sampling one pixel data at a preset position in the input block; and</claim-text>
<claim-text>encoding means (203) for generating encoded data to restore three non-sampling target pixel data in each block so as to restore the original image data from the reduced image data generated by said reduced image generating means (202),</claim-text>
<claim-text>wherein said encoding means (203) comprises:
<claim-text>determination means (203) for, letting X be a sampling target pixel in a block of interest (Bn), and Xa, Xb, and Xc be non-sampling target pixels in the block of interest (Bn), determining<br/>
condition a: whether all the pixels Xa, Xb, and Xc are identical to the pixel X in the block of interest (Bn), and<br/>
condition b: whether all the pixels Xa, Xb, and Xc are identical to sampling target pixels in three blocks adjacent to the block of interest (Bn); and</claim-text>
<claim-text>additional information generating means (203) for generating first additional information as encoded data of the block of interest (Bn) when said determination means has determined that the block of interest (Bn) satisfies the condition a,</claim-text>
<claim-text>generating second additional information different from the first additional information as the encoded data of the block of interest (Bn)<!-- EPO <DP n="58"> --> when said determination means (203) has determined that the block of interest (Bn) satisfies not the condition a but the condition b, and</claim-text>
<claim-text>generating third additional information different from the first additional information and the second additional information as the encoded data of the block of interest (Bn) when said determination means (203) has determined that the block of interest (Bn) satisfies neither the condition a nor the condition b.</claim-text></claim-text></claim-text></claim><claim id="c-en-01-0002" num="0002"><claim-text>The apparatus according to claim 1, <b>characterized in that</b> the first additional information is formed from one bit, the second additional information is formed from two bits of which a first bit has a value different from the first additional information, and the third additional information is formed from two bits, of which a first bit is identical to the first bit of the second additional information and a second bit is different, and three pixel data corresponding to the pixels Xa, Xb, and Xc.</claim-text></claim><claim id="c-en-01-0003" num="0003"><claim-text>The apparatus according to claim 1, <b>characterized by</b> further comprising:
<claim-text>encoded data input means (203) for inputting encoded data of M horizontal blocks × N vertical blocks generated by said additional information generating means (203), wherein each of M and N is an integer not less than 2; and</claim-text>
<claim-text>tile integration means (802) for integrating the encoded data of the M × N blocks input by said encoded data input means into encoded data of one tile including the M × N blocks,</claim-text>
<claim-text>wherein said tile integration means (802) comprising:
<claim-text>first integration means for outputting flag information representing integration to a tile and outputting the encoded data following the flag information when all the encoded data of the M × N blocks include encoded data of only one type of the first additional information, the second additional information, and the third additional information; and</claim-text>
<claim-text>block line integration means for outputting flag information representing non-integration to a tile and integrating encoded data of each block line which is formed from encoded data of M blocks arrayed<!-- EPO <DP n="59"> --> horizontally in a tile of interest when all the encoded data of the M × N blocks include encoded data of at least two types, and</claim-text>
<claim-text>wherein said block line integration means comprising:
<claim-text>second integration means for outputting flag information representing integration to a block line and outputting the encoded data following the flag information when M encoded data of a block line of interest include encoded data of only one type of the first additional information, the second additional information, and the third additional information; and</claim-text>
<claim-text>means for outputting flag information representing non-integration to a block line and outputting the encoded data of the M blocks included in the block line of interest when the M encoded data of the block line of interest include encoded data of at least two types.</claim-text></claim-text></claim-text></claim-text></claim><claim id="c-en-01-0004" num="0004"><claim-text>The apparatus according to claim 1, <b>characterized in that</b> said encoding means (203) determines<br/>
that the condition a is satisfied when X = Xa = Xb = Xc holds, and<br/>
that the condition b is satisfied when, letting X1 be a sampling target pixel included in an adjacent block and located adjacent to the pixel Xa so as to be referred to restore the pixel Xa, X2 be a sampling target pixel included in another adjacent block and located adjacent to the pixel Xb so as to be referred to restore the pixel Xb, and X3 be a sampling target pixel included in still another adjacent block and located adjacent to the pixel Xc so as to be referred to restore the pixel Xc, <maths id="math0036" num=""><math display="block"><mi>Xa</mi><mo>=</mo><mi mathvariant="normal">X</mi><mo>⁢</mo><mn>1</mn><mo>,</mo></math><img id="ib0036" file="imgb0036.tif" wi="22" he="8" img-content="math" img-format="tif"/></maths> and <maths id="math0037" num=""><math display="block"><mi mathvariant="normal">X</mi><mo>⁢</mo><mi mathvariant="normal">b</mi><mo>=</mo><mi mathvariant="normal">X</mi><mo>⁢</mo><mn>2</mn><mo>,</mo></math><img id="ib0037" file="imgb0037.tif" wi="21" he="9" img-content="math" img-format="tif"/></maths> and<maths id="math0038" num=""><math display="block"><mi mathvariant="normal">X</mi><mo>⁢</mo><mi mathvariant="normal">c</mi><mo>=</mo><mi mathvariant="normal">X</mi><mo>⁢</mo><mn>3</mn></math><img id="ib0038" file="imgb0038.tif" wi="19" he="7" img-content="math" img-format="tif"/></maths><br/>
hold.</claim-text></claim><claim id="c-en-01-0005" num="0005"><claim-text>The apparatus according to claim 1, <b>characterized by</b> further comprising:
<claim-text>first comparison means for comparing a data amount of the encoded data obtained by said additional information generating means (203) with a preset target code amount; and<!-- EPO <DP n="60"> --></claim-text>
<claim-text>tone reduction means (2001) for reducing the number of colors represented by each block of the original image data input by said input means by adjusting values of pixels in each block if a comparison result of said first comparison means indicates that the data amount of the encoded data exceeds the target code amount,</claim-text>
<claim-text>wherein said encoding means (203) executes re-encoding of the block which has undergone tone reduction of said tone reduction means (2001).</claim-text></claim-text></claim><claim id="c-en-01-0006" num="0006"><claim-text>The apparatus according to claim 5, <b>characterized by</b> further comprising:
<claim-text>second comparison means for comparing the number of third additional information generated by said additional information generating means with a threshold decided by the total number of blocks included in the original image data; and</claim-text>
<claim-text>setting means for setting, based on a comparison result of said second comparison means, a parameter to set a degree of tone reduction of said tone reduction means.</claim-text></claim-text></claim><claim id="c-en-01-0007" num="0007"><claim-text>The apparatus according to claim 1, <b>characterized by</b> further comprising:
<claim-text>first comparison means for comparing a data amount of the encoded data obtained by said additional information generating means with a preset target code amount;</claim-text>
<claim-text>second comparison means for comparing the number of third additional information generated by said additional information generating means (203) with a threshold decided by the total number of blocks included in the original image data if a comparison result of said first comparison means indicates that the data amount of the encoded data exceeds the target code amount;</claim-text>
<claim-text>resolution converting means for converting the original image data into a resolution lower than the resolution of the original image data and outputs the data as encoded data if a comparison result of said second comparison means indicates that the number of third additional information exceeds the threshold; and<!-- EPO <DP n="61"> --></claim-text>
<claim-text>tone reduction means (2001) for reducing the number of colors represented by each block of the original image data input by said input means by adjusting values of pixels in each block and outputting the block which has undergone tone reduction to said encoding means so as to execute re-encoding if the comparison result of said second comparison means indicates that the number of third additional information is not more than the threshold.</claim-text></claim-text></claim><claim id="c-en-01-0008" num="0008"><claim-text>A method of controlling an image encoding apparatus for encoding image data, comprising the steps of:
<claim-text>inputting (S101) a block of 2 × 2 pixels from original image data of an encoding target;</claim-text>
<claim-text>generating and outputting reduced image data having a size smaller than the original image data by sampling one pixel data at a preset position in the input block; and</claim-text>
<claim-text>generating (S103, S104) encoded data to restore three non-sampling target pixel data in each block so as to restore the original image data from the reduced image data generated in the step of generating and outputting the reduced image data,</claim-text>
<claim-text>wherein the step of generating (S103, S104) the encoded data comprises the steps of:
<claim-text>letting X be a sampling target pixel in a block of interest, and Xa, Xb, and Xc be non-sampling target pixels in the block of interest, determining condition a (S103): whether all the pixels Xa, Xb, and Xc are identical to the pixel X in the block of interest, and<br/>
condition b (S104): whether all the pixels Xa, Xb, and Xc are identical to sampling target pixels in three blocks adjacent to the block of interest; and</claim-text>
<claim-text>generating (S105) first additional information as encoded data of the block of interest when it is determined in the step of determining that the block of interest satisfies the condition a,</claim-text>
<claim-text>generating (S106) second additional information different from the first additional information as the encoded data of the block of interest<!-- EPO <DP n="62"> --> when it is determined in the step of determining that the block of interest satisfies not the condition a but the condition b, and</claim-text>
<claim-text>generating (S107) third additional information different from the first additional information and the second additional information as the encoded data of the block of interest when it is determined in the step of determining that the block of interest satisfies neither the condition a nor the condition b.</claim-text></claim-text></claim-text></claim><claim id="c-en-01-0009" num="0009"><claim-text>A computer-readable storage medium storing a computer program which causes a computer to perform the method of claim 8 upon reading out and executing the computer program.</claim-text></claim></claims><claims mxw-id="PCLM56984683" lang="FR" load-source="patent-office"><!-- EPO <DP n="69"> --><claim id="c-fr-01-0001" num="0001"><claim-text>Dispositif de codage d'image destiné à coder des données d'image, comprenant :
<claim-text>un moyen (201) d'entrée destiné à entrer un bloc de 2 x 2 pixels à partir de données d'image d'original d'une cible de codage ;</claim-text>
<claim-text>un moyen (202) générateur d'image réduite destiné à engendrer et à sortir des données d'image réduite ayant une taille plus petite que les données d'image d'original en échantillonnant les données d'un pixel à une position préétablie dans le bloc d'entrée ; et</claim-text>
<claim-text>un moyen (203) de codage destiné à engendrer des données codées pour restituer les données de trois pixels cibles de non-échantillonnage dans chaque bloc de façon à restituer les données d'image d'original à partir des données d'image réduite engendrées par ledit moyen (202) générateur d'image réduite,</claim-text>
<claim-text>dans lequel ledit moyen (203) de codage comprend :
<claim-text>un moyen (203) de détermination destiné, en supposant que X soit un pixel cible d'échantillonnage dans un bloc auquel on s'intéresse (Bn), et que Xa, Xb et Xc soient des pixels cibles de non-échantillonnage dans le bloc auquel on s'intéresse (Bn), à déterminer :
<claim-text>une condition a : si tous les pixels Xa, Xb et Xc sont identiques au pixel X du bloc auquel on s'intéresse (Bn), et</claim-text>
<claim-text>une condition b : si tous les pixels Xa, Xb et Xc sont identiques à des pixels cibles d'échantillonnage dans trois blocs adjacents au bloc auquel on s'intéresse (Bn) ; et<!-- EPO <DP n="70"> --></claim-text>
<claim-text>un moyen (203) générateur d'informations additionnelles destiné à engendrer une première information additionnelle en tant que données codées du bloc auquel on s'intéresse (Bn) lorsque ledit moyen de détermination a déterminé que le bloc auquel on s'intéresse (Bn) satisfait la condition a,</claim-text>
<claim-text>à engendrer une deuxième information additionnelle différente de la première information additionnelle en tant que données codées du bloc auquel on s'intéresse (Bn) lorsque ledit moyen (203) de détermination a déterminé que le bloc auquel on s'intéresse (Bn) ne satisfait pas la condition a mais la condition b, et</claim-text>
<claim-text>à engendrer une troisième information additionnelle différente de la première information additionnelle et de la deuxième information additionnelle en tant que données codées du bloc auquel on s'intéresse (Bn) lorsque ledit moyen (203) de détermination a déterminé que le bloc auquel on s'intéresse (Bn) ne satisfait ni la condition a ni la condition b.</claim-text></claim-text></claim-text></claim-text></claim><claim id="c-fr-01-0002" num="0002"><claim-text>Dispositif selon la revendication 1, <b>caractérisé en ce que</b> la première information additionnelle est formée à partir d'un seul bit, la deuxième information additionnelle est formée à partir de deux bits dont un premier bit a une valeur différente de la première information additionnelle, et la troisième information additionnelle est formée à partir de deux bits, dont un premier bit est identique au premier bit de la deuxième information additionnelle et un second bit est différent, et <b>en ce que</b> les données de trois pixels correspondent aux pixels Xa, Xb et Xc.</claim-text></claim><claim id="c-fr-01-0003" num="0003"><claim-text>Dispositif selon la revendication 1, <b>caractérisé en ce qu'</b>il comprend en outre :
<claim-text>un moyen (203) d'entrée de données codées destiné à entrer des données codées de M blocs horizontaux × N blocs verticaux engendrés par ledit moyen (203) générateur<!-- EPO <DP n="71"> --> d'informations additionnelles, dans lequel chacun de M et N est un nombre entier non inférieur à 2 ; et</claim-text>
<claim-text>un moyen (802) d'intégration en pavé destiné à intégrer les données codées des M × N blocs entrés par ledit moyen d'entrée de données codées en données codées d'un seul pavé incluant les M × N blocs,</claim-text>
<claim-text>dans lequel ledit moyen (802) d'intégration en pavé comprend :
<claim-text>un premier moyen d'intégration destiné à sortir une information d'indicateur représentant l'intégration en un pavé et à sortir les données codées suivant l'information d'indicateur lorsque toutes les données codées des M × N blocs incluent des données codées de seulement un type de la première information additionnelle, de la deuxième information additionnelle et de la troisième information additionnelle ; et</claim-text>
<claim-text>un moyen d'intégration en ligne de blocs destiné à sortir une information d'indicateur représentant la non-intégration en un pavé et à intégrer des données codées de chaque ligne de blocs qui est formée à partir des données codées de M blocs rangés horizontalement d'un pavé auquel on s'intéresse lorsque toutes les données codées des M × N blocs incluent des données codées d'au moins deux types, et</claim-text>
<claim-text>dans lequel ledit moyen d'intégration en ligne de blocs comprend :
<claim-text>un second moyen d'intégration destiné à sortir une information d'indicateur représentant l'intégration en une ligne de blocs et à sortir les données codées suivant l'information d'indicateur lorsque M données codées d'une ligne de blocs à laquelle on s'intéresse incluent des données codées de seulement un type de la première information additionnelle, de la deuxième information additionnelle et de la troisième information additionnelle ; et</claim-text>
<claim-text>un moyen destiné à sortir une information d'indicateur représentant la non-intégration en une ligne de blocs et à<!-- EPO <DP n="72"> --> sortir les données codées des M blocs inclus dans la ligne de blocs à laquelle on s'intéresse lorsque les M données codées de la ligne de blocs à laquelle on s'intéresse incluent des données codées d'au moins deux types.</claim-text></claim-text></claim-text></claim-text></claim><claim id="c-fr-01-0004" num="0004"><claim-text>Dispositif selon la revendication 1, <b>caractérisé en ce que</b> ledit moyen (203) de codage déterminé :
<claim-text>que la condition a est satisfaite lorsque X = Xa = Xb = Xc est vrai ; et</claim-text>
<claim-text>que la condition b est satisfaite lorsque, en supposant que X1 soit un pixel cible d'échantillonnage inclus dans un bloc adjacent et situé adjacent au pixel Xa de façon à s'y référer pour restituer le pixel Xa, que X2 soit un pixel cible d'échantillonnage inclus dans un autre bloc adjacent et situé adjacent au pixel Xb de façon à s'y référer pour restituer le pixel Xb, et que X3 soit un pixel cible d'échantillonnage inclus dans encore un autre bloc adjacent et situé adjacent au pixel Xc de façon à s'y référer pour restituer le pixel Xc,</claim-text>
<maths id="math0042" num=""><math display="block"><mi>Xa</mi><mo>=</mo><mi mathvariant="normal">X</mi><mo>⁢</mo><mn>1</mn><mo>,</mo></math><img id="ib0042" file="imgb0042.tif" wi="25" he="7" img-content="math" img-format="tif"/></maths> et <maths id="math0043" num=""><math display="block"><mi mathvariant="normal">X</mi><mo>⁢</mo><mi mathvariant="normal">b</mi><mo>=</mo><mi mathvariant="normal">X</mi><mo>⁢</mo><mn>2</mn><mo>,</mo></math><img id="ib0043" file="imgb0043.tif" wi="24" he="7" img-content="math" img-format="tif"/></maths> et <maths id="math0044" num=""><math display="block"><mi mathvariant="normal">X</mi><mo>⁢</mo><mi mathvariant="normal">c</mi><mo>=</mo><mi mathvariant="normal">X</mi><mo>⁢</mo><mn>3</mn></math><img id="ib0044" file="imgb0044.tif" wi="26" he="8" img-content="math" img-format="tif"/></maths><br/>
sont vrais.</claim-text></claim><claim id="c-fr-01-0005" num="0005"><claim-text>Dispositif selon la revendication 1, <b>caractérisé en ce qu'</b>il comprend en outre :
<claim-text>un premier moyen de comparaison destiné à comparer la quantité de données des données codées obtenues par ledit moyen (203) générateur d'informations additionnelles avec une quantité cible préétablie de codes ; et</claim-text>
<claim-text>un moyen (2001) de réduction de tonalité destiné à réduire le nombre de couleurs représentées par chaque bloc des données d'image d'original entrées par ledit moyen d'entrée en ajustant des valeurs de pixels dans chaque bloc si le résultat de comparaison dudit premier moyen de comparaison indique que la quantité de données des données codées excède la quantité cible de codes,<!-- EPO <DP n="73"> --></claim-text>
<claim-text>dans lequel ledit moyen (203) de codage effectue un recodage du bloc qui a subi la réduction de tonalité dudit moyen (2001) de réduction de tonalité.</claim-text></claim-text></claim><claim id="c-fr-01-0006" num="0006"><claim-text>Dispositif selon la revendication 5, <b>caractérisé en ce qu'</b>il comprend en outre :
<claim-text>un second moyen de comparaison destiné à comparer le nombre de troisièmes informations additionnelles engendrées par ledit moyen générateur d'informations additionnelles avec un seuil décidé par le nombre total de blocs inclus dans les données d'image d'original ; et</claim-text>
<claim-text>un moyen de fixation destiné à fixer, en se basant sur le résultat de comparaison dudit second moyen de comparaison, un paramètre pour fixer un degré de réduction de tonalité dudit moyen de réduction de tonalité.</claim-text></claim-text></claim><claim id="c-fr-01-0007" num="0007"><claim-text>Dispositif selon la revendication 1, <b>caractérisé en ce qu'</b>il comprend en outre :
<claim-text>un premier moyen de comparaison destiné à comparer la quantité de données des données codées obtenues par ledit moyen générateur d'informations additionnelles avec une quantité cible préétablie de codes ;</claim-text>
<claim-text>un second moyen de comparaison destiné à comparer le nombre de troisièmes informations additionnelles engendrées par ledit moyen (203) générateur d'informations additionnelles avec un seuil décidé par le nombre total de blocs inclus dans les données d'image d'original si le résultat de comparaison dudit premier moyen de comparaison indique que la quantité de données des données codées excède la quantité cible de codes ;</claim-text>
<claim-text>un moyen de conversion de définition destiné à convertir les données d'image d'original en une définition plus basse que la définition des données d'image d'original et à sortir les données en tant que données codées si le résultat de comparaison dudit second moyen de comparaison indique que le nombre de troisièmes informations additionnelles excède le seuil ; et<!-- EPO <DP n="74"> --></claim-text>
<claim-text>un moyen (2001) de réduction de tonalité destiné à réduire le nombre de couleurs représentées par chaque bloc des données d'image d'original entrées par ledit moyen d'entrée en ajustant des valeurs de pixels dans chaque bloc et à sortir le bloc qui a subi la réduction de tonalité vers ledit moyen de codage de façon à effectuer un recodage si le résultat de comparaison dudit second moyen de comparaison indique que le nombre de troisièmes informations additionnelles n'est pas plus grand que le seuil.</claim-text></claim-text></claim><claim id="c-fr-01-0008" num="0008"><claim-text>Procédé de commande d'un dispositif de codage d'image destiné à coder des données d'image, comprenant les étapes consistant :
<claim-text>à entrer (S101) un bloc de 2 × 2 pixels à partir de données d'image d'original d'une cible de codage ;</claim-text>
<claim-text>à engendrer et à sortir des données d'image réduite ayant une taille plus petite que les données d'image d'original en échantillonnant les données d'un pixel à une position préétablie dans le bloc d'entrée ; et</claim-text>
<claim-text>à engendrer (S103, S104) des données codées pour restituer les données de trois pixels cibles de non-échantillonnage dans chaque bloc de façon à restituer les données d'image d'original à partir des données d'image réduite engendrées à l'étape de génération et de sortie des données d'image réduite,</claim-text>
<claim-text>dans lequel l'étape de génération (S103, S104) des données codées comprend les étapes consistant :
<claim-text>en supposant que X soit un pixel cible d'échantillonnage dans un bloc auquel on s'intéresse, et que Xa, Xb et Xc soient des pixels cibles de non-échantillonnage dans le bloc auquel on s'intéresse, à déterminer :
<claim-text>une condition a (S103) : si tous les pixels Xa, Xb et Xc sont identiques au pixel X du bloc auquel on s'intéresse, et<!-- EPO <DP n="75"> --></claim-text>
<claim-text>une condition b (S104) : si tous les pixels Xa, Xb et Xc sont identiques à des pixels cibles d'échantillonnage dans trois blocs adjacents au bloc auquel on s'intéresse ; et</claim-text>
<claim-text>à engendrer (S105) une première information additionnelle en tant que données codées du bloc auquel on s'intéresse lorsqu'il a été déterminé à l'étape de détermination que le bloc auquel on s'intéresse satisfait la condition a,</claim-text>
<claim-text>à engendrer (S106) une deuxième information additionnelle différente de la première information additionnelle en tant que données codées du bloc auquel on s'intéresse lorsqu'il a été déterminé à l'étape de détermination que le bloc auquel on s'intéresse ne satisfait pas la condition a mais la condition b, et</claim-text>
<claim-text>à engendrer (S107) une troisième information additionnelle différente de la première information additionnelle et de la deuxième information additionnelle en tant que données codées du bloc auquel on s'intéresse lorsqu'il a été déterminé à l'étape de détermination que le bloc auquel on s'intéresse ne satisfait ni la condition a ni la condition b.</claim-text></claim-text></claim-text></claim-text></claim><claim id="c-fr-01-0009" num="0009"><claim-text>Support de mémorisation lisible par ordinateur mémorisant un programme informatique qui fait qu'un ordinateur met en oeuvre le procédé selon la revendication 8 lors de la lecture et de l'exécution du programme informatique.</claim-text></claim></claims><drawings mxw-id="PDW16671930" load-source="patent-office"><!-- EPO <DP n="76"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="165" he="210" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="77"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="107" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="78"> --><figure id="f0003" num="3,4"><img id="if0003" file="imgf0003.tif" wi="165" he="225" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="79"> --><figure id="f0004" num="5,6A,6B"><img id="if0004" file="imgf0004.tif" wi="165" he="225" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="80"> --><figure id="f0005" num="7"><img id="if0005" file="imgf0005.tif" wi="105" he="232" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="81"> --><figure id="f0006" num="8"><img id="if0006" file="imgf0006.tif" wi="110" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="82"> --><figure id="f0007" num="9"><img id="if0007" file="imgf0007.tif" wi="165" he="229" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="83"> --><figure id="f0008" num="10A,10B,10C"><img id="if0008" file="imgf0008.tif" wi="165" he="230" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="84"> --><figure id="f0009" num="11,12"><img id="if0009" file="imgf0009.tif" wi="165" he="221" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="85"> --><figure id="f0010" num="13"><img id="if0010" file="imgf0010.tif" wi="165" he="228" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="86"> --><figure id="f0011" num="14"><img id="if0011" file="imgf0011.tif" wi="162" he="186" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="87"> --><figure id="f0012" num="15"><img id="if0012" file="imgf0012.tif" wi="165" he="228" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="88"> --><figure id="f0013" num="16"><img id="if0013" file="imgf0013.tif" wi="97" he="217" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="89"> --><figure id="f0014" num="17A"><img id="if0014" file="imgf0014.tif" wi="165" he="218" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="90"> --><figure id="f0015" num="17B"><img id="if0015" file="imgf0015.tif" wi="165" he="229" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="91"> --><figure id="f0016" num="18"><img id="if0016" file="imgf0016.tif" wi="121" he="105" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="92"> --><figure id="f0017" num="19"><img id="if0017" file="imgf0017.tif" wi="165" he="226" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="93"> --><figure id="f0018" num="20"><img id="if0018" file="imgf0018.tif" wi="150" he="97" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="94"> --><figure id="f0019" num="21"><img id="if0019" file="imgf0019.tif" wi="162" he="223" img-content="drawing" img-format="tif"/></figure></drawings><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
