<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-1819092-B1" country="EP" doc-number="1819092" kind="B1" date="20140108" family-id="36601369" file-reference-id="270047" date-produced="20180826" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146588878" ucid="EP-1819092-B1"><document-id><country>EP</country><doc-number>1819092</doc-number><kind>B1</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-05808318-A" is-representative="YES"><document-id mxw-id="PAPP154851070" load-source="docdb" format="epo"><country>EP</country><doc-number>05808318</doc-number><kind>A</kind><date>20051118</date><lang>ZH</lang></document-id><document-id mxw-id="PAPP220057947" load-source="docdb" format="original"><country>EP</country><doc-number>05808318.9</doc-number><date>20051118</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140555165" ucid="CN-200410101759-A" load-source="docdb"><document-id format="epo"><country>CN</country><doc-number>200410101759</doc-number><kind>A</kind><date>20041222</date></document-id></priority-claim><priority-claim mxw-id="PPC140552328" ucid="CN-2005001950-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>CN</country><doc-number>2005001950</doc-number><kind>W</kind><date>20051118</date></document-id></priority-claim></priority-claims><dates-of-public-availability><intention-to-grant-date><date>20130711</date></intention-to-grant-date><search-report-dispatch-date><date>20080124</date></search-report-dispatch-date></dates-of-public-availability><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1989326907" load-source="docdb">H04L  29/06        20060101AFI20130610BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1989326908" load-source="docdb">H04L  12/14        20060101ALI20130610BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1989326909" load-source="docdb">H04M  15/00        20060101ALI20130610BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL1989620781" load-source="docdb" scheme="CPC">H04M  15/57        20130101 LI20130926BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989622361" load-source="docdb" scheme="CPC">H04M2215/208       20130101 LA20130926BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989623026" load-source="docdb" scheme="CPC">H04L  65/80        20130101 LI20130926BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989630849" load-source="docdb" scheme="CPC">H04L  12/14        20130101 LI20130926BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989630964" load-source="docdb" scheme="CPC">H04M2215/7833      20130101 LA20130926BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989633051" load-source="docdb" scheme="CPC">H04L  12/1446      20130101 LI20130926BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989636857" load-source="docdb" scheme="CPC">H04M2215/81        20130101 LA20130926BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989637453" load-source="docdb" scheme="CPC">H04M  15/00        20130101 LI20130926BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989637946" load-source="docdb" scheme="CPC">H04L  12/1417      20130101 LI20130926BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989638063" load-source="docdb" scheme="CPC">H04M  15/8228      20130101 LI20130926BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989638286" load-source="docdb" scheme="CPC">H04L  65/1069      20130101 LI20130926BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989638875" load-source="docdb" scheme="CPC">H04L  29/06027     20130101 FI20130926BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989640377" load-source="docdb" scheme="CPC">H04L  65/1006      20130101 LI20130917BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989645133" load-source="docdb" scheme="CPC">H04M  15/83        20130101 LI20130926BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989646601" load-source="docdb" scheme="CPC">H04M2215/82        20130101 LA20130926BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989651900" load-source="docdb" scheme="CPC">H04L  12/1403      20130101 LI20130926BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132371267" lang="DE" load-source="patent-office">VERFAHREN UND SYSTEM UM EINE SITZUNG ZU KONTROLLIEREN</invention-title><invention-title mxw-id="PT132371268" lang="EN" load-source="patent-office">METHOD AND SYSTEM FOR CONTROLLING A SESSION</invention-title><invention-title mxw-id="PT132371269" lang="FR" load-source="patent-office">PROCEDE ET SYSTEME DE COMMANDE DE SESSION</invention-title><citations><patent-citations><patcit mxw-id="PCIT370415911" load-source="docdb" ucid="WO-1995028062-A2"><document-id format="epo"><country>WO</country><doc-number>1995028062</doc-number><kind>A2</kind><date>19951019</date></document-id><sources><source name="EXA" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT370410603" load-source="docdb" ucid="WO-2000072572-A1"><document-id format="epo"><country>WO</country><doc-number>2000072572</doc-number><kind>A1</kind><date>20001130</date></document-id><sources><source name="EXA" created-by-npl="N"/></sources></patcit></patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR919542012" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>HUAWEI TECH CO LTD</last-name><address><country>CN</country></address></addressbook></applicant><applicant mxw-id="PPAR919520170" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>HUAWEI TECHNOLOGIES CO., LTD.</last-name></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919508389" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ZHU YONG</last-name><address><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR919511447" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>ZHU, YONG</last-name></addressbook></inventor><inventor mxw-id="PPAR919025218" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>ZHU, YONG</last-name><address><street>Huawei Administration Building, Bantian, Longgang District</street><city>Shenzhen, Guangdong 518129</city><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR919506653" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>HU LIXIN</last-name><address><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR919507742" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>HU, LIXIN</last-name></addressbook></inventor><inventor mxw-id="PPAR919025219" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>HU, LIXIN</last-name><address><street>Huawei Administration Building, Bantian, Longgang District</street><city>Shenzhen, Guangdong 518129</city><country>CN</country></address></addressbook></inventor></inventors><assignees><assignee mxw-id="PPAR919025220" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Huawei Technologies Co., Ltd.</last-name><iid>100970540</iid><address><street>Huawei Administration Building Bantian</street><city>Longgang District, Shenzhen Guangdong 518129</city><country>CN</country></address></addressbook></assignee></assignees><agents><agent mxw-id="PPAR919025221" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Körber, Martin Hans</last-name><suffix>et al</suffix><iid>100043311</iid><address><street>Mitscherlich &amp; Partner Patent- und Rechtsanwälte Postfach 33 06 09</street><city>80066 München</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="CN-2005001950-W"><document-id><country>CN</country><doc-number>2005001950</doc-number><kind>W</kind><date>20051118</date><lang>ZH</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2006066481-A1"><document-id><country>WO</country><doc-number>2006066481</doc-number><kind>A1</kind><date>20060629</date><lang>ZH</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS549806075" load-source="docdb">AT</country><country mxw-id="DS549790979" load-source="docdb">BE</country><country mxw-id="DS549880939" load-source="docdb">BG</country><country mxw-id="DS549897650" load-source="docdb">CH</country><country mxw-id="DS549789185" load-source="docdb">CY</country><country mxw-id="DS549806084" load-source="docdb">CZ</country><country mxw-id="DS549790980" load-source="docdb">DE</country><country mxw-id="DS549789186" load-source="docdb">DK</country><country mxw-id="DS549789187" load-source="docdb">EE</country><country mxw-id="DS549888311" load-source="docdb">ES</country><country mxw-id="DS549880940" load-source="docdb">FI</country><country mxw-id="DS549880941" load-source="docdb">FR</country><country mxw-id="DS549790989" load-source="docdb">GB</country><country mxw-id="DS549789188" load-source="docdb">GR</country><country mxw-id="DS549806085" load-source="docdb">HU</country><country mxw-id="DS549897651" load-source="docdb">IE</country><country mxw-id="DS549789193" load-source="docdb">IS</country><country mxw-id="DS549880946" load-source="docdb">IT</country><country mxw-id="DS549789194" load-source="docdb">LI</country><country mxw-id="DS549873968" load-source="docdb">LT</country><country mxw-id="DS549806086" load-source="docdb">LU</country><country mxw-id="DS549873969" load-source="docdb">LV</country><country mxw-id="DS549873974" load-source="docdb">MC</country><country mxw-id="DS549888312" load-source="docdb">NL</country><country mxw-id="DS549925649" load-source="docdb">PL</country><country mxw-id="DS549789195" load-source="docdb">PT</country><country mxw-id="DS549888313" load-source="docdb">RO</country><country mxw-id="DS549925650" load-source="docdb">SE</country><country mxw-id="DS549789196" load-source="docdb">SI</country><country mxw-id="DS549806087" load-source="docdb">SK</country><country mxw-id="DS549897652" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data></bibliographic-data><description mxw-id="PDES63961295" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><b><u>Field of the Technology</u></b></heading><p id="p0001" num="0001">The present invention relates to the field of charging in a communication system, and particularly to a method and a system for processing a session.</p><heading id="h0002"><b><u>Background of the Invention</u></b></heading><p id="p0002" num="0002">Charging processing is very important in telecommunication services. It provides a telecommunication operator with charging information so that the operator may carry out relevant account processing. Moreover, by providing the charging information to a relevant third-party service provider, the account settlement between the third-party service provider and the telecommunication operator may be done when two operators are concerned.</p><p id="p0003" num="0003">The present fixed phone services are charged mainly based on a called number, for example 800**** for free call, 0139**** for toll call, 878**** for local call, and 97**** for charged information call. A user may learn a relevant rate in advance, reckon a call by time, and figure out a fee according to the rate so as to control the call duration.</p><p id="p0004" num="0004">In a Next Generation Network (NGN), however, there are a variety of communication modes, such as message, voice, and multimedia, so it is impossible to charge according to the called number. Along with the rapid updating of services, it is difficult for a user to timely learn the rate of the new one. Furthermore, a plurality of services is provided by third-party service providers. So when a user uses a service, multiple operators and service providers may be involved, and they may all charge the user. It is difficult for the user to learn the fee each operator collects. Therefore, the user may not know how a service is charged and what a bill he will face. Even when he finishes using the service, he is still ignorant of how the bill will be like until receiving the bill from the telecommunication operator at the end of a month.</p><p id="p0005" num="0005">That is, in the NGN, it is even more difficult for the user to predict how much he has to pay for a service, so he can not control call duration beforehand according to the fee and decide whether he will use the service.<!-- EPO <DP n="2"> --></p><p id="p0006" num="0006"><patcit id="pcit0001" dnum="GB2370448A"><text>GB-A-2 370 448</text></patcit> discloses a method of controlling costs associated with Voice Over IP connections. The method includes: including a maximum charge parameter in a call connection set-up message sent over an IP network; when the connection is required to break out of the IP network into a telecommunication network, comparing the maximum charge parameter contained in the set-up message with a charge parameter associated with the break out part of the connection; if the charge parameter contained in the set-up message is less than (or equal to) the charge parameter associated with break out, the connection is completed; otherwise, the connection is not completed.</p><p id="p0007" num="0007"><patcit id="pcit0002" dnum="WO2004056079A"><text>WO 2004/056079 A</text></patcit> discloses a method of negotiating the sharing of a cost associated with a communication service between a plurality of participants. The method includes: sending a cost sharing request from a terminal used by a first of the participants to terminals used by the or each other participant; at the or each terminal, processing the request according to predefined cost sharing rules and notifying the first participant's terminal of the result; the network supporting the service being informed of the negotiated cost sharing formula, and the participants being charged by the network in accordance with the formula.</p><heading id="h0003"><b><u>Summary of the invention</u></b></heading><p id="p0008" num="0008">The embodiments of the present invention provide a method and a system for processing a session to enable a user to conveniently control the rate, duration or fee of a session.</p><p id="p0009" num="0009">A method for processing a session includes:
<ul><li>receiving, by a session server, a session request comprising first charging information from a session initiator, wherein the first charging information comprises a fee or volume desired by a calling user;</li><li>continuing processing, by the session server, the call request if the session server determines that the first charging information is reasonable according to a charging rule stored in the session server, wherein the first charging information being reasonable comprises at least one of: the fee or volume desired by the calling user in the first charging information not being less than a minimum fee or volume in the charging rule stored in the session server, and the rate desired by the calling user not<!-- EPO <DP n="3"> --></li><li>being lower than a minimum rate in the charging rule stored in the session server;</li><li>determining, by the session server, a fee or volume of the session after putting through the session, and terminating the session or prompting the calling user to resend second charging information comprising new fee or volume if the fee or volume of the session exceeds or will exceed the fee or volume desired by the calling user;</li><li>transferring charging information between a first operator and other operators, and providing, by the first operator, the calling user with charging information according to charging information provided by other operators; and</li><li>receiving, by servers of other operators, the charging information, determining whether the charging information is reasonable, and when all the servers consider the fee reasonable, establishing a session between the calling user equipment and a called user equipment; wherein</li><li>the step of transferring charging information between a first operator and other operators, and providing, by the first operator, a user with charging information according to charging information provided by other operators comprises:
<ul><li>after receiving the charging information of the calling user, figuring out, by a server A of the first operator, a maximum fee that a second operator charges, modifying content of the charging information, and sending the content of the charging information as part of the session request to a server B of the second operator; wherein</li><li>the step of figuring out, by a server A of the first operator, a maximum fee that a second operator charges comprises:
<ul><li>subtracting, by the server A of the first operator, its own rate and applying deduction from income of the second operator.</li></ul></li></ul></li></ul></p><p id="p0010" num="0010">The first charging information further includes a rate desired by the calling user; the method further includes:
<ul><li>terminating the session or prompting the calling user to resend a second charging information comprising a new rate if the other information of the session changes during the session.</li></ul></p><p id="p0011" num="0011">The first charging information being reasonable further includes:
<ul><li>if the first communication unit is a prepayment user, a balance of prepayment account of the calling not exceeding a credit line.</li></ul><!-- EPO <DP n="4"> --></p><p id="p0012" num="0012">The session initiator stores charging rules corresponding to different sessions; and<br/>
receiving the session request includes:
<ul><li>reading, by the session initiator, a charging rule corresponding to the session and generates the first charging information according to the charging rule corresponding to the session; and</li><li>receiving, by the session server, the session request comprising the first charging information from the session initiator.</li></ul></p><p id="p0013" num="0013">The charging rules corresponding to different sessions includes charging rules corresponding to different called users.</p><p id="p0014" num="0014">The first charging information includes flag information for requesting the session server to send the charging rule to the session initiator; the method further includes:
<ul><li>receiving, by the session initiator, the charging rule from the session server, taking the charging rule as the first charging information, and sending a new session request to the session server, wherein the first charging information in the new session request comprises flag information for indicating agreement on the charging rule.</li></ul></p><p id="p0015" num="0015">The method further includes:
<ul><li>prompting, by the session initiator, the calling user to resend the second charging information, and sending the second charging information to the session server after obtaining a confirmation from the calling user.</li></ul></p><p id="p0016" num="0016">The method further includes:
<ul><li>providing charging information to the session initiator to display to the</li><li>calling user during the session or after the session.</li></ul></p><p id="p0017" num="0017">A system for processing a session includes:
<ul><li>a first unit, configured to receive a session request comprising first charging information from a session initiator, wherein the first charging information comprises a fee or volume desired by a calling user;</li><li>a second unit, configured to continue processing the call request if the second unit determines that the first charging information is reasonable according to a charging rule, wherein the first charging information being reasonable comprises at least one of: the fee or volume desired by the calling user in the first charging information not being less than<!-- EPO <DP n="5"> --> a minimum fee or volume in the charging rule stored in the session server, and the rate desired by the calling user not being lower than a minimum rate in the charging rule stored in the session server;</li><li>a third unit, configured to determine a fee or volume of the session after the second unit puts through the session, and terminate the session or prompt the calling user to resend second charging information comprising new fee or volume if the fee or volume of the session exceeds or will exceed the fee or volume desired by the calling user; wherein</li><li>charging information is transferred between a first operator and other operators, and the first operator provides the calling user with charging information according to charging information provided by other operators;</li><li>servers of other operators are configured to receive the charging information, and determine whether the charging information is reasonable, and when all the servers consider the fee reasonable, a session between the calling user equipment and a called user equipment is established;</li><li>a server A of the first operator is configured to figure out a maximum fee that a second operator charges after receiving the charging information of the calling user, modify content of the charging information, and send the content of the charging information as part of the session request to a server B of the second operator; wherein</li><li>the server A of the first operator is configured to subtract its own rate and apply deduction from income of the second operator.</li></ul></p><p id="p0018" num="0018">The system further includes:
<ul><li>a fourth unit, configured to store the charging rule.</li></ul></p><p id="p0019" num="0019">As can be seen from the above technical scheme, a user may set a desired rate, fee,<!-- EPO <DP n="6"> --> or call duration, thereby implementing the management of services.</p><p id="p0020" num="0020">A transfer of charging information between a user and an operator makes it possible to transfer the charging information between operators, so as to enable the operator to provide the user with charging information according to charging information provided by other operators In addition, the fee status may be gotten in real time due to the combination of the charging and a specific session. For example, a user may get charging information before, during and after a session, and may refuse the session before initiating the session, or terminate the session during the session so as to save fees.</p><p id="p0021" num="0021">With a specific charging rule, both users and operators may do a charge calculation to check up the account. Because of setting a ceiling through repayment, and setting a<!-- EPO <DP n="7"> --> desired fee or duration, the user may better control the call fee or duration.</p><heading id="h0004"><b><u>Brief description of the drawings</u></b></heading><p id="p0022" num="0022"><ul><li><figref idrefs="f0001">FIG. 1</figref> is a structure diagram of an INVITE message according to embodiments of the present invention.</li><li><figref idrefs="f0002">FIG. 2</figref> is a simplified flowchart illustrating the session processing of charging a calling user according to an embodiment of the present invention.</li><li><figref idrefs="f0003">FIG. 3</figref> is a simplified flowchart illustrating the session processing of charging a called user according to an embodiment of the present invention.</li><li><figref idrefs="f0004">FIG. 4</figref> is a simplified flowchart illustrating the session processing of charging for an additional rate service according to an embodiment of the present invention.</li><li><figref idrefs="f0004">FIG. 5</figref> is a simplified schematic diagram illustrating a device for processing session according to an embodiment of the present invention.</li></ul></p><heading id="h0005"><b><u>Detailed description of the invention</u></b></heading><p id="p0023" num="0023">In an NGN, it is an SIP that is frequently used for communications due to its flexibility. The SIP, defined by the Internet Engineering Tasking Force (IETF), is a session control protocol with simplicity and rich expansibility, and is a basic protocol of the NGN. Embodiments of the present invention are described based on, but not limited to, the SIP.</p><p id="p0024" num="0024">The SIP, not depending on underlying layer protocols, is a text-based application layer control protocol, and is used to establish, modify and terminate two-party or multi-party multimedia sessions in an Internet Protocol (IP) network. The SIP borrows ideas from the Hyper Text Transfer Protocol (HTTP), Simple Mail Transfer Protocol (SMTP) and the like, supports such functions as agent, re-determination of direction, registering and locating users, etc., and supports user mobility. When cooperating with such protocols as Real time Transport Protocol/Real time Control Protocol (RTP/RTCP), Service Description Protocol (SDP), Real Time Streaming Protocol (RTSP) and Domain Name Service (DNS), the SIP may realize such services as voice, video, data, mail, real<!-- EPO <DP n="8"> --> time communication, chat, etc. An SIP message is based on the text mode, and typically includes a request line, a message header, a Carriage Return, Line Feed (CRLF), and a message body. For example, a structure of a request message (INVITE) based on the SIP is shown in <figref idrefs="f0001">FIG. 1</figref>.</p><p id="p0025" num="0025">In the SIP, information related to charging function has not been defined, and the account settlement mode mentioned in "Background of the invention" is still used at present when the communication is based on the SIP, so similar problems to that mentioned in "Background of the invention" still exist. The charging method according to this invention is described below in detail.</p><p id="p0026" num="0026">For realizing the charging method of this invention, the SIP is improved, namely a charging information byte, i.e., Charge (called Session Charge Protocol) is added. The charging information includes: fee information (Fee), volume information (Volume) and rate information (Rate). For example, a Charge may include zero or one Fee, zero or multiple Volume, and zero or multiple Rates. In the charging information, the fee, volume and rate are associated. The fee may be figured out according to the volume and rate, and the simplest case is volume*rate=fee. In the case of multiple rates and volume, their products are summated.</p><p id="p0027" num="0027">In detail, the Fee, Volume and Rate included in the Charge mentioned above may be finalized below.</p><p id="p0028" num="0028">Merely by way of an example, the Fee includes two parts, Currency meaning currency type and Amount meaning the amount of money, wherein the Currency is expressed by the letter format specified in International Standards Organization (ISO) 4217 and the Amount is expressed by a figure. For example, for RMB 1 yuan 1 jiao 9 fen, "CNY" for expressing RMB is filled in the Currency part and "1.19" in the Amount part. A positive fee value in a message sent may mean that a Charge message sender server pays the receiver server; and a negative one means the Charge message sender server charging the receiver server. The servers mean servers provided by different operators.</p><p id="p0029" num="0029">Merely by way of an example, the Volume includes two parts: UnitID meaning a unit used in charging and Amount meaning volume used. The UnitID is represented by a figure: 0-Undefined, 1-the number of times, 2-byte, 3-second, which may be extended to<!-- EPO <DP n="9"> --> represent other units. For example, for the volume of 100 bytes, "2" is filled in the UnitID part, and "100" in the Amount part.</p><p id="p0030" num="0030">Merely by way of an example, the Rate includes four items of information: Currency meaning currency type, Amount meaning the amount of money, UnitID meaning a unit used in charging and Amount meaning volume used. In the case of multiple Rates, charging is performed by the corresponding Rates in turn according to the Amount meaning volume used (such as time), and the last Rate is taken as a subsequent rate for the charging. For example, that the Amounts are 180, 120 and 60 respectively corresponding to Rate1, Rate2 and Rate3 means that the rate is Rate1 for the first 180 seconds, Rate2 for the subsequent 120 seconds, Rate3 for the further subsequent 60 seconds, and keeps Rate3 afterwards.</p><p id="p0031" num="0031">When carried in the SIP, the Charge may be contained in a message header through adding a header field, or in an SIP message body, as shown in <figref idrefs="f0001">FIG. 1</figref>. An INVITE message containing charging information is shown below, in which a part written in italics is the added Charge header field, and the content of charging information is filled in the part. In the INVITE message, the contained charging information means that the fee is RMB 0.32 yuan, the volume is 270 seconds, the rate is 0.20 yuan for the first 3 minutes and 0.06 fen per minute afterwards.
<img id="ib0001" file="imgb0001.tif" wi="140" he="100" img-content="program-listing" img-format="tif"/><!-- EPO <DP n="10"> -->
<img id="ib0002" file="imgb0002.tif" wi="58" he="8" img-content="program-listing" img-format="tif"/></p><p id="p0032" num="0032">Charging information also may be carried through adding three header fields, i.e., Fee, Volume and Rate, instead of the above Charge header field, and the three header fields is shown below:
<img id="ib0003" file="imgb0003.tif" wi="107" he="31" img-content="program-listing" img-format="tif"/></p><p id="p0033" num="0033">Meanings of charging information carried in the SIP are described as below.</p><p id="p0034" num="0034">INVITE is used to carry charging information when a call is requested, and means that an SIP client is willing to pay. During the call, the charging information may also be resent via an INVITE message.</p><p id="p0035" num="0035">200 OK corresponds to 200 OK of INVITE. That charging information is contained in a response message means that an SIP server has accepted the request of the SIP client, and carried the charging information in the response message. The rate and amount in the charging information are less than those in the INVITE message sent from the SIP client.</p><p id="p0036" num="0036">402 Payment Required is used to contain charging information in a payment request, and means that the SIP server does not accept the charging information in the INVITE message sent from the SIP client, and returns the charging information of the SIP server with a rate higher than that in the charging information contained in the INVITE message sent from the SIP client. The SIP client may resend an INVITE message after prompting the user.</p><p id="p0037" num="0037">BYE is used to carry actual charging information for this session after a call is over.</p><p id="p0038" num="0038">200 OK corresponds to 200 OK of BYE, and is used to carry the actual charging information of this session.</p><p id="p0039" num="0039">Charging information may be contained in other extended messages of the SIP, e.g., an extended SUBSCRIBE message in the SIMPLE protocol (SIP for Instant Messaging<!-- EPO <DP n="11"> --> and Presence Leveraging Extensions), and the illustration is no longer made.</p><p id="p0040" num="0040">Through the Charge, the charging information may be transferred between the user equipment and the server, so as to realize the control of the user on a call fee and the display of fee information to the user, and a description in detail is given below.</p><p id="p0041" num="0041">A session processing of charging a calling user according to desired charging information of the calling user is described through an example of the calling user calling the called user, referring to <figref idrefs="f0002">FIG. 2</figref>.</p><p id="p0042" num="0042">Step 201: the calling user equipment initiates a call, and sends an INVITE message to Server A. A charging information byte, i.e., Charge, is contained in the INVITE message to represent desired charging information of the calling user. In the call, the meanings of parameters included in the Charge are as follows: the Fee represents a fee the calling user is willing to pay; the Volume, desired maximum volume of the calling user for this call; the Rate, a desired rate of the calling user.</p><p id="p0043" num="0043">In the Charge, one or two of the Fee, Volume and Rate also may be included. For example, only the Fee being included represents a total fee that the calling user is willing to pay for this call and accepting the rate of the operator; only the Volume represents maximum volume that the calling user is willing to take for this call (such as duration) and accepting the rate and fee of the operator; only the Rate represents a desired rate of the calling user for this call.</p><p id="p0044" num="0044">The calling user equipment may prestore a charging rule table as shown in Table 1. When initiating an INVITE message, the calling user equipment reads the stored charging rule table, matches the charging rules to specific rules, reads charging information corresponding to the specific rules, and fills the read charging information in the INVITE message. If the calling user does not set charging rules or does not match the charging rules to the specific rules, he fills an empty Charge header field in the INVITE message instead of a specific value, e.g., Charge: Fee, to represent that the calling user is willing to accept the charging rules provided by the server.<!-- EPO <DP n="12"> -->
<tables id="tabl0001" num="0001"><table frame="all"><title>Table 1</title><tgroup cols="4"><colspec colnum="1" colname="col1" colwidth="97mm"/><colspec colnum="2" colname="col2" colwidth="18mm"/><colspec colnum="3" colname="col3" colwidth="17mm"/><colspec colnum="4" colname="col4" colwidth="29mm"/><thead><row><entry align="center" valign="middle">Rule</entry><entry align="center" valign="middle">Fee</entry><entry align="center" valign="middle">Volume</entry><entry align="center" valign="middle">Rate</entry></row></thead><tbody><row><entry align="center" valign="middle">Calling the called user tom@)jack.com</entry><entry align="center" valign="middle">2 yuan</entry><entry align="center" valign="middle">1 minute</entry><entry align="center" valign="middle">1 yuan/minute</entry></row><row><entry align="center" valign="middle">The superior operator is abc (abc is the operator trusted by the user)</entry><entry align="center" valign="middle">100 yuan</entry><entry align="center" valign="middle">1 minute</entry><entry align="center" valign="middle">100 yuan/minute</entry></row><row><entry align="center" valign="middle">Other cases</entry><entry align="center" valign="middle">0.1 yuan</entry><entry align="center" valign="middle">1 minute</entry><entry align="center" valign="middle">0.1 yuan/minute</entry></row></tbody></tgroup></table></tables></p><p id="p0045" num="0045">Certainly, the calling user equipment may provide the calling user with a dialog box to input charging information when initiating a call.</p><p id="p0046" num="0046">As shown below, an INVITE message is generated when the user Alice calls her superior operator server in Atlanta so as to call the called user bob@biloxi.com. The call meets the rule "other cases" in above Table 1, which means that the calling user is only willing to pay RMB 0.1 yuan, call for 1 minute, and only accept a rate less than RMB 0.1/minute. The INVITE message is as:
<img id="ib0004" file="imgb0004.tif" wi="125" he="39" img-content="program-listing" img-format="tif"/></p><p id="p0047" num="0047">Certainly, if the calling user equipment asks the server to provide charging information when initiating a call, in Step 201, the message sent from the calling user equipment may not include the desired charging information of the calling user but a field for asking the server to return the charging rules information to the calling user equipment. For example, 402 Payment Required may be added respectively in a Supported header field of INVITE message and a Require header field. An INVITE message with the request field is shown below.
<pre listing-type="program-listing">  .....
.
  INVITE sip:bob@biloxi.com SIP/2.0
  Supported: 402 Payment Required
  Require: 402 Payment Required
  .....</pre></p><p id="p0048" num="0048">Step 202: Server A receives the INNITE message, reads the charging information of<!-- EPO <DP n="13"> --> the calling user equipment, and determines whether the charging information is reasonable; if it is, the process proceeds to Step 204, or else, Server A returns to the calling user equipment a response message with the charging rules of Operator 1 recorded in Server A.</p><p id="p0049" num="0049">Server A determines whether the parameters of the charging information in the INVITE message (i.e., Fee, Volume and Rate) are reasonable. When only a parameter exists in the charging information, the comparison is made only for the parameter; when two or more parameters exist, comparison needs to be made for all parameters.</p><p id="p0050" num="0050">For example, when only the Rate exists in the INVITE message exists, if the fee figured out in any case of the volume according to the desired rate of the calling user is not less than that according to the rate of the operator, the rate is considered reasonable, e.g., desired 0.12 yuan/minute of the calling user and 0.1 yuan/minute provided by the operator; otherwise, the rate is unreasonable, e.g., if the calling user desires a rate of 0.12 yuan/minute and requests call duration of two minutes, while the operator provides 0.3 yuan/3 minute, the fee will be 0.24 yuan according to the rate of the calling user, and 0.3 yuan according to the rate of the operator, so the rate requested by the calling user is unreasonable.</p><p id="p0051" num="0051">. For another example, when only the Fee exists, if the fee is more than a minimum call fee requested by the operator, e.g., in the case of 0.3 yuan/3 minute, the minimum call fee is 0.3 yuan, the fee is reasonable; otherwise, the fee is unreasonable.</p><p id="p0052" num="0052">Eventually, for example, when at least two of Rate, Fee and Volume exist in the INVITE message, the rate, fee and volume all may be figured out, in this case, not only the rate but also the fee has to be compared. For example, after the desired fee of the calling user is considered reasonable, the rate is further determined whether reasonable or not. Unless both the fee and the rate are reasonable, this charging rule is not considered reasonable. Certainly, if the calling user is a prepayment user, the operator equipment still has to determine whether the fee of the calling user exceeds a credit line, and the charging information is reasonable only if the fee is within the credit line.</p><p id="p0053" num="0053">If the server determines that the charging information is unreasonable, the returned response message also contains the charging rule information whose parameters means:<!-- EPO <DP n="14"> --> the Rate represents a rate requested by the operator; the Fee and Volume represent a desired fee and volume of the calling user (according to the first user request, if there is no volume in the first user request or the volume is less than the minimum volume accepted by the operator, a minimum charging unit may be responded to the calling user equipment). The shown below is a response message returned from Server A, which includes a charging rule set by Operator 1: a rate of 0.20 yuan for the first three minutes and 0.06 fen per minutes for later, minimum call duration of 180 seconds, and a minimum fee of 0.20 yuan. SIP/2.0 402 Bad charge
<img id="ib0005" file="imgb0005.tif" wi="126" he="30" img-content="program-listing" img-format="tif"/></p><p id="p0054" num="0054">Step 203: the calling user equipment receives the response message from Server A, reads the charging information provided by the operator, and matches the charging information to preset processing rules to carry out a corresponding processing.</p><p id="p0055" num="0055">The preset processing rules may be shown as Table 2 below. The calling user equipment reads the fee, volume and rate from the response message, matches them with the processing rules in <figref idrefs="f0002">FIG. 2</figref>, and carries out a corresponding processing.
<tables id="tabl0002" num="0002"><table frame="all"><title>Table 2</title><tgroup cols="2"><colspec colnum="1" colname="col1" colwidth="54mm"/><colspec colnum="2" colname="col2" colwidth="61mm"/><thead><row><entry align="center" valign="top">Rule</entry><entry align="center" valign="top">Processing rule</entry></row></thead><tbody><row><entry align="center">Fee is more than 10 yuan</entry><entry align="center">Reject directly without reminding</entry></row><row><entry align="center">Fee is less than 0.1 yuan</entry><entry align="center">Accept directly without user confirmation</entry></row><row><entry align="center">Rate is higher than 0.1 yuan/minute</entry><entry align="center">Accept with user confirmation</entry></row><row><entry align="center">Volume is less than 1 minute</entry><entry align="center">not accept</entry></row></tbody></tgroup></table></tables></p><p id="p0056" num="0056">The rules may be set according to other conditions, e.g., a role in a session (the called or the calling) and an ID of the other party (certified through an ID, such as a friend list, password certification).</p><p id="p0057" num="0057">In addition, charging information or prompting information of the processing rules may be provided to the calling user to prompt simple information in terms of word, graphic and voice modes. For example, if the fee exceeds the one in the rules set by the calling user, user confirmation is needed. In this case, graphics flashes on the calling user<!-- EPO <DP n="15"> --> equipment with a sound and word information related to the calling user.</p><p id="p0058" num="0058">In the example, after receiving the message of Server A of the Operator 1, if the rule of "Rate is higher than 0.1 yuan/minute" is met, the calling user equipment prompts the calling user. After the calling user confirms to accept, the calling user equipment reinitiates an INVITE message. The charging information forwarded by Server A through a response message is filled in the INVITE message to represent charging information of Operator 1. The INVITE message is shown below:
<img id="ib0006" file="imgb0006.tif" wi="130" he="51" img-content="program-listing" img-format="tif"/></p><p id="p0059" num="0059">Certainly, after the calling user confirms to accept, when the calling user equipment reinitiates an INVITE message, an empty Charge header field, such as Charge: Fee, may be filled in the SIP as shown in Step 201 to express that the calling user accepts the charging rules provided by the server.</p><p id="p0060" num="0060">Step 204: in this way, after receiving the INVITE message and determining as a reasonable charging rule, the Server A continues processing the call request, establishes a session between the calling user equipment and the called user equipment, and records the Fee and Volume in the Charge provided by the calling user.</p><p id="p0061" num="0061">During the session, the charging information will be resent in the following cases:
<ol><li>1) the volume or fee for the session will exceed the recorded desired volume or fee of the calling user;</li><li>2) the fee has changed;</li><li>3) other information related to the session has changed, for example, the Quality of Service (QoS) is reduced, but the fee is unchanged, in this case, the calling user needs to<!-- EPO <DP n="16"> --> reconfirm.</li></ol></p><p id="p0062" num="0062">Both a user equipment and a server may resend to the other party charging information, which is determined whether reasonable or not by the other party. For example, when the rate, fee and volume exceed those set for the current session, the user is prompted to resend the charging information or the session is cut off automatically. Thus, the user may preset his call duration or fee before initiating a session so as to control the session.</p><p id="p0063" num="0063">For example, if the call duration exceeds three minutes, the calling user equipment prompts the calling user; after the calling user confirms, the calling user equipment reinitiates an INVITE message. The process also may be performed according to the rules set by the user: when the rate is unchanged, user confirmation is not needed, and an INVITE message is reinitiated automatically; more volume is filled in the Charge, e.g., another 10 minutes prolonged, so the "13 minutes" is filled in the Volume (3 minutes plus 10 minutes); the fee is increased accordingly, and "0.80 yuan" filled in the Fee. The INVITE message is shown below:
<img id="ib0007" file="imgb0007.tif" wi="132" he="53" img-content="program-listing" img-format="tif"/></p><p id="p0064" num="0064">After receiving the INVITE message, if the charging information is considered reasonable, Server A of Operator 1 will accept the request of the calling user, do not cut off the session and respond to the calling user equipment with 200 OK.</p><p id="p0065" num="0065">Step 205: after the session ends, the calling user equipment and Server A may calculate the fee according to the volume and rate and record it in a storage unit, in this case, the volume represents the actual volume already used up for the session, the fee represents the actual fee for the session, and the rate means the rate of the session. Server A sends the fee information of the session to the calling user equipment (e.g., contained in<!-- EPO <DP n="17"> --> 200 OK), the calling user equipment prompts the calling user with charging information, compares the charging information with that of the calling user equipment, and reserves the fee after a confirmation.</p><p id="p0066" num="0066">Only the fee processing between the calling user equipment and the server is described above. For two or more operators are involved in a session, Server A still has to modify and send the content of fee, and servers of other operators receive the charging information and determine whether it is reasonable; only when all servers consider the fee reasonable, the session between the calling user equipment and the called user equipment may be established.</p><p id="p0067" num="0067">For example, the calling user calls the called user, and the charging information sent from the calling user equipment to the Server A of Operator 1 includes: 0.2 yuan/minute, Operator 1 charging 0.06 yuan per minute and taken a 10 % deduction from the income of Operator 2. In this way, Server A, after receiving the charging information of the calling user, figures out the maximum fee that Operator 2 may charge is 0.127 yuan/minute, i.e., (0.2-0.06)/110%=0.127. In the message sent from Server A to Server B of Operator 2, "0.127 yuan/minute" is filled in the Rate, and the fee is also processed appropriately.</p><p id="p0068" num="0068">The server of Operator 2, after receiving the charging information, makes a calculation and comparison according to the charging rules set by itself, with reference to Step 202, to decide whether the charging information is reasonable. Operator 2 may return charging information to Operator 1 through the charging information, Operator 1 then makes a corresponding calculation and returns charging information figured out to the calling user. For example, the charging rate returned by Operator 2 is 0.1 yuan/minute, the charging rate returned by Operator 1 is 0.17 yuan/minute, and 0.1 +0.1×10%+0.06=0. 17.</p><p id="p0069" num="0069">Moreover, if multiple operators are concerned, the session also may be initiated by an operator server instead of a user equipment, for example, operator server initiatively initiates a session to provide services to a user.</p><p id="p0070" num="0070">As can be seen, during a charging, a user may send information such as call duration, fee information, etc., and a server controls the call duration and total fee according to the information sent by the user. In addition, it may be displayed to the user how each<!-- EPO <DP n="18"> --> operator charges.</p><p id="p0071" num="0071">According to another example with the called user charged, this invention is further described below in detail with reference to <figref idrefs="f0003">FIG. 3</figref>, wherein there is an account of the called user recorded in Server B of Operator 2. The following steps are included:
<ul><li>Step 301: the calling user equipment calls Server A of Operator 1, and the carried Charge includes: the rate is 0 yuan/minute, which means that the calling user asks to get a free call.</li><li>Step 302: Server A asks to charge 0.06 yuan/minute, so it processes the charging information, namely, changes the rate to -0.06 yuan/minute, and sends the charging information to Server B of Operator 2. The negative sign means that Operator 1 charges Operator 2.</li><li>Step 303: Server B still asks to charge 0.1 yuan/minute, so it changes the rate to -0.16 yuan/minute, which means charging the user 0.16 yuan/minute, and forwards the session request containing the charging information to the called user.</li><li>Step 304: the called user equipment displays the charging information: the called user needs to pay -0.16 fen/minute. After the charging information is confirmed by the called user, or automatically confirmed by the called user equipment according to rules preset by the called user (may be shown as Table 2 above), the called user equipment sends a response message containing -0.16 fen/minute to Server B to express an agreement on paying and accepting the rate. The volume, i.e., call duration, or the desired fee of the called user is also contained in the Charge of the response message and sent to Server B together.</li><li>Step 305: Server B responds to Server A, and Server A considers the session request of the calling user reasonable and may establish the session between the calling user and the called user.</li></ul></p><p id="p0072" num="0072">Meanwhile, Server B processes the charging according to the corresponding charging rules, makes a fee deduction from a recorded account of the called user, figures out the fee that the Operator 1 shall share, and performs the account settlement between operators.<!-- EPO <DP n="19"> --></p><p id="p0073" num="0073">In addition, when the call duration or the fee deducted by Server B is up to that in the response message from the called user equipment, the called user is prompted to resend charging information to continue session or terminate the current session.</p><p id="p0074" num="0074">A session processing of charging for an additional rate service is shown in <figref idrefs="f0004">FIG. 4</figref>. The additional rate service means a session in which the calling user needs to pay the called user. For example, the called user equipment is used for hot-wire, consultation, order programme, etc. In this embodiment, the rate may be contained in the message responded by the called user equipment (may be a Server C provided by a third operator). Operator 2 and Operator 1 summate the rates, the calling user equipment prompts the rates to the calling user, and sends the charging information about the rate until the calling user confirms. When Operator 1, Operator 2 and the called user all consider the charging reasonable, the session may be processed.</p><p id="p0075" num="0075">Correspondingly, as shown in <figref idrefs="f0004">FIG. 5</figref>, a device for processing session is also provided, which may be a user equipment or a server. The device includes: a session receiving/transmitting unit, for receiving and transmitting session information; a charging rule storage unit, for storing charging rules; an arithmetic comparing unit connected with the session receiving/transmitting unit and the charging rule storage unit, for reading and comparing the received charging information from the session receiving/transmitting unit and the charging rule storage unit; and a session processing unit connected with the arithmetic comparing unit, for processing session according to the received comparing results from the arithmetic comparing unit. A display unit is also included which connects with the session processing unit for displaying the charging information or session processing information to the user.</p><p id="p0076" num="0076">As can be seen from the embodiments, the user may conveniently control the fee, call duration, or rate of a session according to input information (such as a fee and volume), and each server may perform the fee processing respectively according to the charging information transferred between servers of various operators.</p><p id="p0077" num="0077">The user equipment and the server are differentiated above for better description. In the SIP, when the user equipment and the server communicate, the SIP operator server may serve as a client to initiate a call to another server, just as the user equipment.<!-- EPO <DP n="20"> --></p><p id="p0078" num="0078">The above descriptions are all exemplified by communications based on SIP. As shown above, charging information may also be carried in terms of an Extensible Mark-up Language (XML) format. Although all examples are based on the SIP, it is not difficult to understand that the present invention may be used in other network protocols which are not limited to the SIP protocol or SIP extended protocols, for example, this invention may be applied in a Hyper Text Transfer Protocol (HTTP) to access Web, or in a Video On Demand (VOD).</p></description><claims mxw-id="PCLM56986625" lang="DE" load-source="patent-office"><!-- EPO <DP n="25"> --><claim id="c-de-01-0001" num="0001"><claim-text>Verfahren zum Verarbeiten einer Sitzung, das Folgendes umfasst:
<claim-text>Empfangen (201) einer Sitzungsanforderung, die erste Gebührenberechnungsinformationen umfasst, durch einen Sitzungsserver von einem Sitzungsinitiator, wobei die ersten Gebührenberechnungsinformationen eine Gebühr oder ein Volumen, die/das von einem anrufenden Anwender gewünscht wird, umfasst;</claim-text>
<claim-text>Weiterführen der Verarbeitung (202, 204) der Verbindungsanforderung durch den Sitzungsserver, wenn der Sitzungsserver bestimmt, dass die ersten Gebührenberechnungsinformationen gemäß einer Gebührenberechnungsregel, die in dem Sitzungsserver gespeichert ist, plausibel sind, <b>dadurch gekennzeichnet, dass</b> die Plausibilität der ersten Gebührenberechnungsinformationen wenigstens eines des Folgenden umfasst: die Gebühr oder das Volumen, die/das von dem anrufenden Anwender in den ersten Gebührenberechnungsinformationen gewünscht ist, nicht kleiner ist als eine minimale Gebühr oder ein minimales Volumen in der Gebührenberechnungsregel, die in dem Sitzungsserver gespeichert ist, und der Tarif, der von dem anrufenden Anwender gewünscht ist, nicht niedriger ist als ein minimaler Tarif in der Gebührenberechnungsregel, die in dem Sitzungsserver gespeichert ist; wobei das Verfahren ferner Folgendes umfasst:
<claim-text>Bestimmen einer Gebühr oder eines Volumens der Sitzung nach dem Durchschalten der Sitzung und Beenden der Sitzung oder Auffordern des anrufenden Anwenders, erneut zweite Gebührenberechnungsinformationen zu senden, die eine neue Gebühr oder ein neues Volumen umfassen, wenn die Gebühr oder das Volumen der Sitzung die Gebühr oder das Volumen übersteigt, die/das von dem anrufenden Anwender gewünscht ist;</claim-text>
<claim-text>Übertragen der Gebührenberechnungsinformationen zwischen einem ersten Betreiber und</claim-text>
<claim-text>weiteren Betreibern und Versorgen des anrufenden Anwenders mit Gebührenberechnungsinformationen gemäß den Gebührenberechnungsinformationen, die von anderen Betreibern bereitgestellt werden, durch den ersten Betreiber; und</claim-text>
<claim-text>Empfangen der Gebührenberechnungsinformationen durch Server anderer Betreiber, Bestimmen, ob die Gebührenberechnungsinformationen plausibel sind, und wenn alle Server die Gebühr als plausibel betrachten, Aufbauen einer Sitzung zwischen dem Gerät des anrufenden Anwenders und einem Gerät des angerufenen Anwenders; wobei der Schritt des Übertragens der Gebührenberechnungsinformationen zwischen einem ersten Betreiber und weiteren Betreibern und des Versorgens eines Anwenders durch den ersten Betreiber mit Gebührenberechnungsinformationen gemäß den<!-- EPO <DP n="26"> --> Gebührenberechnungsinformationen, die von anderen Betreibern bereitgestellt werden,</claim-text>
<claim-text>Folgendes umfasst:
<claim-text>Berechnen durch einen Server A des ersten Betreibers einer maximalen Gebühr, die ein zweiter Betreiber erhebt, nach dem Empfangen der Gebührenberechnungsinformationen des anrufenden Anwenders, Modifizieren des Inhalts der Gebührenberechnungsinformationen und Senden des Inhalts der Gebührenberechnungsinformationen als Teil der Sitzungsanforderung zu einem Server B des zweiten Betreibers; wobei</claim-text>
<claim-text>der Schritt des Berechnens einer maximalen Gebühr, die ein zweiter Betreiber erhebt, durch einen Server A des ersten Betreibers Folgendes umfasst:
<claim-text>Subtrahieren seines eigenen Tarifs und Anwenden eines Abzugs vom Einkommen des zweiten Betreibers durch den Server A des ersten Betreibers.</claim-text></claim-text></claim-text></claim-text></claim-text></claim><claim id="c-de-01-0002" num="0002"><claim-text>Verfahren nach Anspruch 1, wobei die ersten Gebührenberechnungsinformationen ferner einen Tarif umfassen, der von dem anrufenden Anwender gewünscht wird; wobei das Verfahren ferner Folgendes umfasst:
<claim-text>Beenden der Sitzung oder Auffordern des anrufenden Anwenders, zweite Gebührenberechnungsinformationen erneut zu senden, die einen neuen Tarif umfassen,</claim-text>
<claim-text>wenn sich die anderen Informationen der Sitzung während der Sitzung ändern.</claim-text></claim-text></claim><claim id="c-de-01-0003" num="0003"><claim-text>Verfahren nach Anspruch 2, wobei die Plausibilität der ersten Gebührenberechnungsinformationen ferner Folgendes umfasst:
<claim-text>ein Guthaben des Vorauszahlungskontos des anrufenden Anwenders eine Kreditlinie nicht übersteigt, wenn die erste Kommunikationseinheit ein Anwender mit Vorauszahlung ist.</claim-text></claim-text></claim><claim id="c-de-01-0004" num="0004"><claim-text>Verfahren nach Anspruch 1, wobei der Sitzungsinitiator Gebührenberechnungsregeln speichert, die unterschiedlichen Sitzungen entsprechen; und<br/>
Empfangen der Sitzungsanforderung Folgendes umfasst:
<claim-text>Lesen einer Gebührenberechnungsregel, die der Sitzung entspricht, durch den Sitzungsinitiator und Erzeugen der ersten Gebührenberechnungsinformationen gemäß der Gebührenberechnungsregel, die der Sitzung entspricht; und</claim-text>
<claim-text>Empfangen der Sitzungsanforderung, die die ersten Gebührenberechnungsinformationen umfasst, durch den Sitzungsserver von dem Sitzungsinitiator.</claim-text></claim-text></claim><claim id="c-de-01-0005" num="0005"><claim-text>Verfahren nach Anspruch 4, wobei die Gebührenberechnungsregeln, die unterschiedlichen Sitzungen entsprechen, Gebührenberechnungsregeln umfassen, die unterschiedlichen angerufenen Anwendern entsprechen.<!-- EPO <DP n="27"> --></claim-text></claim><claim id="c-de-01-0006" num="0006"><claim-text>Verfahren nach Anspruch 1, wobei die ersten Gebührenberechnungsinformationen Kennzeicheninformationen zum Anfordern, dass der Sitzungsserver die Gebührenberechnungsregel zu dem Sitzungsinitiator sendet, umfassen; wobei das Verfahren ferner Folgendes umfasst:
<claim-text>Empfangen (203) der Gebührenberechnungsregel von dem Sitzungsserver durch den Sitzungsinitiator, Annehmen der Gebührenberechnungsregel als die ersten Gebührenberechnungsinformationen und Senden einer neuen Sitzungsanforderung zu dem Sitzungsserver, wobei die ersten Gebührenberechnungsinformationen in der neuen Sitzungsanforderung Kennzeicheninformationen zum Angeben einer Vereinbarung über die Gebührenberechnungsregel umfassen.</claim-text></claim-text></claim><claim id="c-de-01-0007" num="0007"><claim-text>Verfahren nach Anspruch 1, das ferner Folgendes umfasst:
<claim-text>Auffordern des anrufenden Anwenders durch den Sitzungsinitiator, die zweiten Gebührenberechnungsinformationen erneut zu senden, und Senden der zweiten Gebührenberechnungsinformationen zu dem Sitzungsserver nach dem Erhalten einer Bestätigung von dem anrufenden Anwender.</claim-text></claim-text></claim><claim id="c-de-01-0008" num="0008"><claim-text>Verfahren nach Anspruch 1, das ferner Folgendes umfasst:
<claim-text>Bereitstellen (205) von Gebührenberechnungsinformationen für den Sitzungsinitiator, um sie für den anrufenden Anwender während der Sitzung oder nach der Sitzung anzuzeigen.</claim-text></claim-text></claim><claim id="c-de-01-0009" num="0009"><claim-text>System zum Verarbeiten einer Sitzung, das Folgendes umfasst:
<claim-text>eine erste Einheit, die konfiguriert ist, eine Sitzungsanforderung, die erste Gebührenberechnungsinformationen umfasst, von einem Sitzungsinitiator zu empfangen,</claim-text>
<claim-text>wobei die ersten Gebührenberechnungsinformationen eine Gebühr oder ein Volumen, das von einem anrufenden Anwender gewünscht wird, umfasst;</claim-text>
<claim-text>eine zweite Einheit, die konfiguriert ist, das Verarbeiten der Verbindungsanforderung fortzusetzen, wenn die zweite Einheit bestimmt, dass die ersten Gebührenberechnungsinformationen gemäß einer Gebührenberechnungsregel plausibel sind, <b>dadurch gekennzeichnet, dass</b> die Plausibilität der ersten Gebührenberechnungsinformationen wenigstens eines aus Folgendem umfasst: die Gebühr oder das Volumen, die/das von dem anrufenden Anwender in den ersten Gebührenberechnungsinformationen gewünscht ist, nicht kleiner ist als eine minimale Gebühr oder ein minimales Volumen in der Gebührenberechnungsregel, die in dem Sitzungsserver gespeichert ist, und der Tarif, der von dem anrufenden Anwender gewünscht ist, nicht niedriger ist als ein minimaler Tarif in der Gebührenberechnungsregel, die in dem Sitzungsserver gespeichert ist; wobei das System ferner Folgendes umfasst:
<claim-text>eine dritte Einheit, die konfiguriert ist, eine Gebühr oder ein Volumen der Sitzung zu bestimmen, nachdem die zweite Einheit die Sitzung durchschaltet, und die Sitzung zu<!-- EPO <DP n="28"> --> beenden oder den anrufenden Anwender aufzufordern, erneut zweite Gebührenberechnungsinformationen zu senden, die eine neue Gebühr oder ein neues Volumen umfassen, wenn die Gebühr oder das Volumen der Sitzung die Gebühr oder das Volumen übersteigt, die/das von dem anrufenden Anwender gewünscht ist; wobei Gebührenberechnungsinformationen zwischen einem ersten Betreiber und weiteren Betreibern übertragen werden, und der rufende Anwender durch den ersten Betreiber mit Gebührenberechnungsinformationen gemäß den Gebührenberechnungsinformationen, die von anderen Betreibern bereitgestellt werden, versorgt wird;</claim-text>
<claim-text>Server anderer Betreiber konfiguriert sind, die Gebührenberechnungsinformationen zu empfangen und zu bestimmen, ob die Gebührenberechnungsinformationen plausibel sind,</claim-text>
<claim-text>und wenn alle Server annehmen, dass die Gebühren plausibel sind, eine Sitzung zwischen dem Gerät des anrufenden Anwenders und einem Gerät des angerufenen Anwenders aufgebaut wird;</claim-text>
<claim-text>ein Server A des ersten Betreibers konfiguriert ist, nach Empfangen der Gebührenberechnungsinformationen von dem anrufenden Anwender eine maximale Gebühr zu berechnen, die ein zweiter Betreiber erhebt, den Inhalt der Gebührenberechnungsinformationen zu modifizieren und den Inhalt der Gebührenberechnungsinformationen als Teil der Sitzungsanforderung zu einem Server B des zweiten Betreibers zu senden; wobei</claim-text>
<claim-text>der Server A des ersten Betreibers konfiguriert ist, seinen eigenen Tarif zu subtrahieren und Abzug von dem Einkommen des zweiten Betreibers anzuwenden.</claim-text></claim-text></claim-text></claim><claim id="c-de-01-0010" num="0010"><claim-text>System nach Anspruch 9, das ferner Folgendes umfasst:
<claim-text>eine vierte Einheit, die konfiguriert ist, die Gebührenberechnungsregel zu speichern.</claim-text></claim-text></claim></claims><claims mxw-id="PCLM56986626" lang="EN" load-source="patent-office"><!-- EPO <DP n="21"> --><claim id="c-en-01-0001" num="0001"><claim-text>A method for processing a session, comprising:
<claim-text>receiving (201), by a session server, a session request comprising first charging information from a session initiator, wherein the first charging information comprises a fee or volume desired by a calling user;</claim-text>
<claim-text>continuing processing (202, 204), by the session server, the call request if the session server determines that the first charging information is reasonable according to a charging rule stored in the session server, <b>characterized in that</b> the first charging information being reasonable comprises at least one of: the fee or volume desired by the calling user in the first charging information not being less than a minimum fee or volume in the charging rule stored in the session server, and the rate desired by the calling user not being lower than a minimum rate in the charging rule stored in the session server; the method further comprises:
<claim-text>determining a fee or volume of the session after putting through the session, and terminating the session or prompting the calling user to resend second charging information comprising new fee or volume if the fee or volume of the session exceeds the fee or volume desired by the calling user;</claim-text>
<claim-text>transferring charging information between a first operator and other operators, and providing, by the first operator, the calling user with charging information according to charging information provided by other operators; and</claim-text>
<claim-text>receiving, by servers of other operators, the charging information, determining whether the charging information is reasonable, and when all the servers consider the fee reasonable, establishing a session between the calling user equipment and a called user equipment; wherein</claim-text>
<claim-text>the step of transferring charging information between a first operator and other operators, and providing, by the first operator, a user with charging information according to charging information provided by other operators comprises:
<claim-text>after receiving the charging information of the calling user, figuring out, by a server A of the first operator, a maximum fee that a second operator charges,<!-- EPO <DP n="22"> --> modifying content of the charging information, and sending the content of the charging information as part of the session request to a server B of the second operator; wherein</claim-text>
<claim-text>the step of figuring out, by a server A of the first operator, a maximum fee that a second operator charges comprises:
<claim-text>subtracting, by the server A of the first operator, its own rate and applying deduction from income of the second operator.</claim-text></claim-text></claim-text></claim-text></claim-text></claim><claim id="c-en-01-0002" num="0002"><claim-text>The method of Claim 1, the first charging information further comprises a rate desired by the calling user; the method further comprising:
<claim-text>terminating the session or prompting the calling user to resend a second charging information comprising a new rate if the other information of the session changes during the session.</claim-text></claim-text></claim><claim id="c-en-01-0003" num="0003"><claim-text>The method of Claim 2, wherein the first charging information being reasonable further comprises:
<claim-text>if the first communication unit is a prepayment user, a balance of prepayment account of the calling not exceeding a credit line.</claim-text></claim-text></claim><claim id="c-en-01-0004" num="0004"><claim-text>The method of Claim 1, wherein the session initiator stores charging rules corresponding to different sessions; and<br/>
receiving the session request comprises:
<claim-text>reading, by the session initiator, a charging rule corresponding to the session and generates the first charging information according to the charging rule corresponding to the session; and</claim-text>
<claim-text>receiving, by the session server, the session request comprising the first charging information from the session initiator.</claim-text></claim-text></claim><claim id="c-en-01-0005" num="0005"><claim-text>The method of Claim 4, wherein the charging rules corresponding to different<br/>
sessions comprises<br/>
charging rules corresponding to different called users.<!-- EPO <DP n="23"> --></claim-text></claim><claim id="c-en-01-0006" num="0006"><claim-text>The method of Claim 1, wherein the first charging information comprises flag information for requesting the session server to send the charging rule to the session initiator; the method further comprising:
<claim-text>receiving (203), by the session initiator, the charging rule from the session server, taking the charging rule as the first charging information, and sending a new session request to the session server, wherein the first charging information in the new session request comprises flag information for indicating agreement on the charging rule.</claim-text></claim-text></claim><claim id="c-en-01-0007" num="0007"><claim-text>The method of Claim 1, further comprising:
<claim-text>prompting, by the session initiator, the calling user to resend the second charging information, and sending the second charging information to the session server after obtaining a confirmation from the calling user.</claim-text></claim-text></claim><claim id="c-en-01-0008" num="0008"><claim-text>The method of Claim 1, further comprising:
<claim-text>providing (205) charging information to the session initiator to display to the calling user during the session or after the session.</claim-text></claim-text></claim><claim id="c-en-01-0009" num="0009"><claim-text>A system for processing a session, comprising:
<claim-text>a first unit, configured to receive a session request comprising first charging information from a session initiator, wherein the first charging information comprises a fee or volume desired by a calling user;</claim-text>
<claim-text>a second unit, configured to continue processing the call request if the second unit determines that the first charging information is reasonable according to a charging rule, <b>characterized in that</b> the first charging information being reasonable comprises at least one of: the fee or volume desired by the calling user in the first charging information not being less than a minimum fee or volume in the charging rule stored in the session server, and the rate desired by the calling user not being lower than a minimum rate in the charging rule stored in the session server; the system further comprises:
<claim-text>a third unit, configured to determine a fee or volume of the session after the second unit puts through the session, and terminate the session or prompt the calling user to resend second charging information comprising new fee or volume if the fee or<!-- EPO <DP n="24"> --> volume of the session exceeds or will exceed the fee or volume desired by the calling user; wherein</claim-text>
<claim-text>charging information is transferred between a first operator and other operators, and the first operator provides the calling user with charging information according to charging information provided by other operators;</claim-text>
<claim-text>servers of other operators are configured to receive the charging information, and determine whether the charging information is reasonable, and when all the servers consider the fee reasonable, a session between the calling user equipment and a called user equipment is established;</claim-text>
<claim-text>a server A of the first operator is configured to figure out a maximum fee that a second operator charges after receiving the charging information of the calling user, modify content of the charging information, and send the content of the charging information as part of the session request to a server B of the second operator; wherein</claim-text>
<claim-text>the server A of the first operator is configured to subtract its own rate and apply deduction from income of the second operator.</claim-text></claim-text></claim-text></claim><claim id="c-en-01-0010" num="0010"><claim-text>The system of Claim 9, further comprising:
<claim-text>a fourth unit, configured to store the charging rule.</claim-text></claim-text></claim></claims><claims mxw-id="PCLM56986627" lang="FR" load-source="patent-office"><!-- EPO <DP n="29"> --><claim id="c-fr-01-0001" num="0001"><claim-text>Procédé de traitement d'une session, comprenant :
<claim-text>la réception (201), par un serveur de session, d'une demande de session comprenant des premières informations de facturation provenant d'un initiateur de session, les premières informations de facturation comprenant une redevance ou un volume souhaité par un utilisateur appelant ;</claim-text>
<claim-text>la poursuite du traitement (202, 204), par le serveur de session, de la demande d'appel si le serveur de session détermine que les premières informations de facturation sont raisonnables conformément à une règle de facturation stockée sur le serveur de session, <b>caractérisé en ce que</b> le fait que les premières informations de facturation sont raisonnables comprend au moins l'un : du fait que la redevance ou le volume souhaité par l'utilisateur appelant dans les premières informations de facturation n'est pas inférieur à une redevance ou à un volume minimum dans la règle de facturation stockée sur le serveur de session, et le fait que le tarif souhaité par l'utilisateur appelant n'est pas inférieur à un tarif minimum dans la règle de facturation stockée sur le serveur de session ; le procédé comprenant en outre :
<claim-text>la détermination d'une redevance ou d'un volume de la session après l'établissement de la session, et la terminaison de la session ou le fait d'inviter l'utilisateur appelant à renvoyer des deuxièmes informations de facturation comprenant une nouvelle redevance ou un nouveau volume si la redevance ou le volume de la session dépasse la redevance ou le volume souhaité par l'utilisateur appelant ;</claim-text>
<claim-text>le transfert d'informations de facturation entre un premier opérateur et d'autres opérateurs et la fourniture, par le premier opérateur, à l'utilisateur appelant d'informations de facturation conformes à des informations de facturation fournies par d'autres opérateurs ; et</claim-text>
<claim-text>la réception, par des serveurs d'autres opérateurs, des informations de facturation, la détermination du fait de savoir si les informations de facturation sont raisonnables et,</claim-text>
<claim-text>lorsque tous les serveurs considèrent que la redevance est raisonnable, l'établissement d'une session entre l'équipement utilisateur appelant et un équipement utilisateur appelé ; dans lequel</claim-text>
<claim-text>l'étape de transfert d'informations de facturation entre un premier opérateur et d'autres opérateurs et la fourniture, par le premier opérateur, à un utilisateur, d'informations de facturation conformes à des informations de facturation fournies par d'autres opérateurs comprend :
<claim-text>après réception des informations de facturation de l'utilisateur appelant, la<!-- EPO <DP n="30"> --> détermination, par un serveur A du premier opérateur, d'une redevance maximale facturée par un deuxième opérateur, la modification du contenu des informations de facturation et l'envoi du contenu des informations de facturation en tant que partie de la demande de session à un serveur B du deuxième opérateur ; dans lequel l'étape de détermination, par un serveur A du premier opérateur, d'une redevance maximale facturée par un deuxième opérateur comprend :
<claim-text>la soustraction, par le serveur A du premier opérateur, de son propre tarif et</claim-text>
<claim-text>l'application d'une déduction au revenu du deuxième opérateur.</claim-text></claim-text></claim-text></claim-text></claim-text></claim><claim id="c-fr-01-0002" num="0002"><claim-text>Procédé selon la revendication 1, dans lequel les premières informations de facturation comprennent en outre un tarif souhaité par l'utilisateur appelant ; le procédé comprenant en outre :
<claim-text>la terminaison de la session ou le fait d'inviter l'utilisateur appelant à renvoyer des deuxièmes informations de facturation comprenant un nouveau tarif si les autres informations de la session changent pendant la session.</claim-text></claim-text></claim><claim id="c-fr-01-0003" num="0003"><claim-text>Procédé selon la revendication 2, dans lequel le fait que les premières informations de facturation sont raisonnables comprend en outre :
<claim-text>si la première unité de communication est un utilisateur à prépaiement, le fait qu'un solde d'un compte de prépaiement de l'appelant ne dépasse pas une ligne de crédit.</claim-text></claim-text></claim><claim id="c-fr-01-0004" num="0004"><claim-text>Procédé selon la revendication 1, dans lequel l'initiateur de session stocke des règles de facturation correspondant à différentes sessions ; et<br/>
la réception de la demande de session comprend :
<claim-text>la lecture, par l'initiateur de session, d'une règle de facturation correspondant à la session et le fait qu'il génère les premières informations de facturation conformément à la règle de facturation correspondant à la session ; et</claim-text>
<claim-text>la réception, par le serveur de session, de la demande de session comprenant les premières informations de facturation en provenance de l'initiateur de session.</claim-text></claim-text></claim><claim id="c-fr-01-0005" num="0005"><claim-text>Procédé selon la revendication 4, dans lequel les règles de facturation correspondant à différentes sessions comprennent des règles de facturation correspondant à différents utilisateurs appelés.</claim-text></claim><claim id="c-fr-01-0006" num="0006"><claim-text>Procédé selon la revendication 1, dans lequel les premières informations de facturation comprennent des informations d'indicateur pour demander au serveur de session d'envoyer la règle de facturation à l'initiateur de session ; le procédé comprenant en outre :<!-- EPO <DP n="31"> -->
<claim-text>la réception (203), par l'initiateur de session, de la règle de facturation en provenance du serveur de session, le fait de considérer la règle de facturation en tant que premières informations de facturation, et l'envoi d'une nouvelle demande de session au serveur de session, les premières informations de facturation contenues dans la nouvelle demande de session comprenant des informations d'indicateur pour indiquer un accord portant sur la règle de facturation.</claim-text></claim-text></claim><claim id="c-fr-01-0007" num="0007"><claim-text>Procédé selon la revendication 1, comprenant en outre :
<claim-text>l'invitation, par l'initiateur de session, de l'utilisateur appelant à renvoyer les deuxièmes informations de facturation et l'envoi des deuxièmes informations de facturation au serveur de session après obtention d'une confirmation en provenance de l'utilisateur appelant.</claim-text></claim-text></claim><claim id="c-fr-01-0008" num="0008"><claim-text>Procédé selon la revendication 1, comprenant en outre :
<claim-text>la fourniture (205) d'informations de facturation à l'initiateur de session afin de les présenter à l'utilisateur appelant pendant la session ou après la session.</claim-text></claim-text></claim><claim id="c-fr-01-0009" num="0009"><claim-text>Système de traitement d'une session, comprenant :
<claim-text>une première unité, configurée pour recevoir une demande de session comprenant des premières informations de facturation en provenance d'un initiateur de session, les premières informations de facturation comprenant une redevance ou un volume souhaité par un utilisateur appelant ;</claim-text>
<claim-text>une deuxième unité, configurée pour poursuivre le traitement de la demande d'appel si la deuxième unité détermine que les premières informations de facturation sont raisonnables conformément à une règle de facturation, <b>caractérisé en ce que</b> le fait que les premières informations de facturation sont raisonnables comprend au moins l'un : du fait que la redevance ou le volume souhaité par l'utilisateur appelant dans les premières informations de facturation n'est pas inférieur à une redevance ou à un volume minimum dans la règle de facturation stockée sur le serveur de session, et le fait que le tarif souhaité par l'utilisateur appelant n'est pas inférieur à un tarif minimum dans la règle de facturation stockée sur le serveur de session ; le système comprenant en outre :
<claim-text>une troisième unité, configurée pour déterminer une redevance ou un volume de la session après que la deuxième unité a établi la session, et pour terminer la session ou</claim-text>
<claim-text>inviter l'utilisateur appelant à renvoyer des deuxièmes informations de facturation comprenant une nouvelle redevance ou un nouveau volume si la redevance ou le volume de la session dépasse ou va dépasser la redevance ou le volume souhaité par l'utilisateur appelant ; dans lequel<!-- EPO <DP n="32"> --></claim-text>
<claim-text>les informations de facturation sont transférées entre un premier opérateur et d'autres opérateurs, et le premier opérateur fournit à l'utilisateur appelant des informations de facturation conformes à des informations de facturation fournies par d'autres opérateurs ;</claim-text>
<claim-text>des serveurs d'autres opérateurs sont configurés pour recevoir les informations de facturation et pour déterminer si les informations de facturation sont raisonnables et,</claim-text>
<claim-text>lorsque tous les serveurs considèrent que la redevance est raisonnable, une session est établie entre l'équipement utilisateur appelant et un équipement utilisateur appelé ;</claim-text>
<claim-text>un serveur A du premier opérateur est configuré pour déterminer une redevance maximale facturée par un deuxième opérateur après réception des informations de facturation de l'utilisateur appelant, pour modifier le contenu des informations de facturation et pour envoyer le contenu des informations de facturation en tant que partie de la demande de session à un serveur B du deuxième opérateur ; dans lequel le serveur A du premier opérateur est configuré pour soustraire son propre tarif et</claim-text>
<claim-text>appliquer une déduction au revenu du deuxième opérateur.</claim-text></claim-text></claim-text></claim><claim id="c-fr-01-0010" num="0010"><claim-text>Système selon la revendication 9, comprenant en outre :
<claim-text>une quatrième unité, configurée pour stocker la règle de facturation.</claim-text></claim-text></claim></claims><drawings mxw-id="PDW16672504" load-source="patent-office"><!-- EPO <DP n="33"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="153" he="131" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="34"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="153" he="158" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="35"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="164" he="130" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="36"> --><figure id="f0004" num="4,5"><img id="if0004" file="imgf0004.tif" wi="161" he="222" img-content="drawing" img-format="tif"/></figure></drawings><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
