<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2681576-A1" country="EP" doc-number="2681576" kind="A1" date="20140108" family-id="45809348" file-reference-id="252638" date-produced="20180823" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146586218" ucid="EP-2681576-A1"><document-id><country>EP</country><doc-number>2681576</doc-number><kind>A1</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12707134-A" is-representative="NO"><document-id mxw-id="PAPP154848410" load-source="docdb" format="epo"><country>EP</country><doc-number>12707134</doc-number><kind>A</kind><date>20120203</date><lang>EN</lang></document-id><document-id mxw-id="PAPP196971938" load-source="docdb" format="original"><country>EP</country><doc-number>12707134.8</doc-number><date>20120203</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140548106" ucid="IB-2012050504-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>IB</country><doc-number>2012050504</doc-number><kind>W</kind><date>20120203</date></document-id></priority-claim><priority-claim mxw-id="PPC140551680" ucid="US-201161447732-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201161447732</doc-number><kind>P</kind><date>20110301</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1989318256" load-source="docdb">G01R  33/48        20060101AFI20120919BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1973210593" load-source="docdb" scheme="CPC">G01R  33/4814      20130101 LA20160206BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1973210604" load-source="docdb" scheme="CPC">G01R  33/4804      20130101 LI20160206BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1973211501" load-source="docdb" scheme="CPC">G01R  33/561       20130101 LA20160206BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1973212455" load-source="docdb" scheme="CPC">G01R  33/5611      20130101 LA20160206BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989639081" load-source="docdb" scheme="CPC">A61N   5/00        20130101 LI20131212BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989641539" load-source="docdb" scheme="CPC">A61N   5/0625      20130101 LI20131212BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989641885" load-source="docdb" scheme="CPC">A61N   7/02        20130101 LI20131212BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989643504" load-source="docdb" scheme="CPC">G01R  33/56        20130101 FI20131212BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989649254" load-source="docdb" scheme="CPC">A61B  18/02        20130101 LI20131212BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132363287" lang="DE" load-source="patent-office">BESCHLEUNIGTE MR-THERMOMETRIE-ABBILDUNG MIT EINER REKONSTRUKTION MIT EINGESCHRÄNKTEM SEITENVERHÄLTNIS</invention-title><invention-title mxw-id="PT132363288" lang="EN" load-source="patent-office">ACCELERATED MR THERMOMETRY MAPPING INVOLVING AN IMAGE RATIO CONSTRAINED RECONSTRUCTION</invention-title><invention-title mxw-id="PT132363289" lang="FR" load-source="patent-office">CARTOGRAPHIE THERMOMÉTRIQUE PAR RÉSONANCE MAGNÉTIQUE ACCÉLÉRÉE IMPLIQUANT UNE RECONSTRUCTION À CONTRAINTE DE RAPPORT D'IMAGE</invention-title><citations><non-patent-citations><nplcit><text>See references of WO 2012117303A1</text><sources><source mxw-id="PNPL67455855" load-source="docdb" name="SEA"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR919525786" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>KONINKL PHILIPS NV</last-name><address><country>NL</country></address></addressbook></applicant><applicant mxw-id="PPAR919522471" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>KONINKLIJKE PHILIPS N.V.</last-name></addressbook></applicant><applicant mxw-id="PPAR919018923" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Koninklijke Philips N.V.</last-name><iid>101391185</iid><address><street>High Tech Campus 5</street><city>5656 AE Eindhoven</city><country>NL</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919508545" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>HUANG FENG</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919536653" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>HUANG, FENG</last-name></addressbook></inventor><inventor mxw-id="PPAR919007347" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>HUANG, FENG</last-name><address><street>c/o PHILIPS IP&amp;S - NL High Tech Campus 44</street><city>NL-5656 AE Eindhoven</city><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919520835" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>KOHLER MAX OSKAR</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919541000" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>KOHLER, MAX OSKAR</last-name></addressbook></inventor><inventor mxw-id="PPAR919015951" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>KOHLER, MAX OSKAR</last-name><address><street>c/o PHILIPS IP&amp;S - NL High Tech campus 44</street><city>NL-5656AE Eindhoven</city><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919533933" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>TANTTU JUKKA ILMARI</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919532869" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>TANTTU, Jukka Ilmari</last-name></addressbook></inventor><inventor mxw-id="PPAR919006167" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>TANTTU, Jukka Ilmari</last-name><address><street>c/o PHILIPS IP&amp;S - NL High Tech campus 44</street><city>NL-5656AE Eindhoven</city><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919535536" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>LIN WEI</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919508527" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>LIN, WEI</last-name></addressbook></inventor><inventor mxw-id="PPAR919015879" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>LIN, WEI</last-name><address><street>c/o PHILIPS IP&amp;S - NL High Tech campus 44</street><city>NL-5656AE Eindhoven</city><country>NL</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR919019250" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Steffen, Thomas</last-name><iid>100958149</iid><address><street>Philips Intellectual Property &amp; Standards P.O. Box 220</street><city>5600 AE Eindhoven</city><country>NL</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="IB-2012050504-W"><document-id><country>IB</country><doc-number>2012050504</doc-number><kind>W</kind><date>20120203</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012117303-A1"><document-id><country>WO</country><doc-number>2012117303</doc-number><kind>A1</kind><date>20120907</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS549847449" load-source="docdb">AL</country><country mxw-id="DS549835680" load-source="docdb">AT</country><country mxw-id="DS549847478" load-source="docdb">BE</country><country mxw-id="DS549913835" load-source="docdb">BG</country><country mxw-id="DS549766967" load-source="docdb">CH</country><country mxw-id="DS549834460" load-source="docdb">CY</country><country mxw-id="DS549834461" load-source="docdb">CZ</country><country mxw-id="DS549835512" load-source="docdb">DE</country><country mxw-id="DS549847479" load-source="docdb">DK</country><country mxw-id="DS549834466" load-source="docdb">EE</country><country mxw-id="DS549758369" load-source="docdb">ES</country><country mxw-id="DS549913836" load-source="docdb">FI</country><country mxw-id="DS549913837" load-source="docdb">FR</country><country mxw-id="DS549835513" load-source="docdb">GB</country><country mxw-id="DS549847480" load-source="docdb">GR</country><country mxw-id="DS549835518" load-source="docdb">HR</country><country mxw-id="DS549834467" load-source="docdb">HU</country><country mxw-id="DS549766968" load-source="docdb">IE</country><country mxw-id="DS549847481" load-source="docdb">IS</country><country mxw-id="DS549913838" load-source="docdb">IT</country><country mxw-id="DS549847490" load-source="docdb">LI</country><country mxw-id="DS549835519" load-source="docdb">LT</country><country mxw-id="DS549835681" load-source="docdb">LU</country><country mxw-id="DS549835520" load-source="docdb">LV</country><country mxw-id="DS549835521" load-source="docdb">MC</country><country mxw-id="DS549835694" load-source="docdb">MK</country><country mxw-id="DS549835695" load-source="docdb">MT</country><country mxw-id="DS549835696" load-source="docdb">NL</country><country mxw-id="DS549834468" load-source="docdb">NO</country><country mxw-id="DS549835697" load-source="docdb">PL</country><country mxw-id="DS549847491" load-source="docdb">PT</country><country mxw-id="DS549835702" load-source="docdb">RO</country><country mxw-id="DS549847492" load-source="docdb">RS</country><country mxw-id="DS549835703" load-source="docdb">SE</country><country mxw-id="DS549835542" load-source="docdb">SI</country><country mxw-id="DS549834469" load-source="docdb">SK</country><country mxw-id="DS549834474" load-source="docdb">SM</country><country mxw-id="DS549758370" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA99835467" ref-ucid="WO-2012117303-A1" lang="EN" load-source="patent-office"><p num="0000">A medical apparatus (300, 400, 500, 600) comprising a magnetic resonance imaging system (301). The medical apparatus further comprises a memory (330) containing instructions (350, 352, 354, 456, 458, 460) for execution by a processor (324). Execution of the instructions cause the processor to acquire (102, 202) baseline magnetic resonance data (332) and reconstruct (104, 204) a first image (334) using the baseline magnetic resonance data. Execution of the instructions further cause the processor acquire (106, 212) undersampled magnetic resonance data (336), which is undersampled in k- space in comparison to the baseline magnetic resonance data. Execution of the instructions further cause the processor reconstruct (108, 214) a second image (338) using the undersampled magnetic resonance data and the first image. The second image is reconstructed using an image ratio constrained reconstruction algorithm (354) and to calculate (110, 216) a temperature map (340) using the second image.</p></abstract><abstract mxw-id="PA100331278" ref-ucid="WO-2012117303-A1" lang="EN" source="national office" load-source="docdb"><p>A medical apparatus (300, 400, 500, 600) comprising a magnetic resonance imaging system (301). The medical apparatus further comprises a memory (330) containing instructions (350, 352, 354, 456, 458, 460) for execution by a processor (324). Execution of the instructions cause the processor to acquire (102, 202) baseline magnetic resonance data (332) and reconstruct (104, 204) a first image (334) using the baseline magnetic resonance data. Execution of the instructions further cause the processor acquire (106, 212) undersampled magnetic resonance data (336), which is undersampled in k- space in comparison to the baseline magnetic resonance data. Execution of the instructions further cause the processor reconstruct (108, 214) a second image (338) using the undersampled magnetic resonance data and the first image. The second image is reconstructed using an image ratio constrained reconstruction algorithm (354) and to calculate (110, 216) a temperature map (340) using the second image.</p></abstract><abstract mxw-id="PA99835468" ref-ucid="WO-2012117303-A1" lang="FR" load-source="patent-office"><p num="0000">L'invention porte sur un appareil médical (300, 400, 500, 600) comprenant un système d'imagerie par résonance magnétique (301). L'appareil médical comprend en outre une mémoire (330) contenant des instructions (350, 352, 354, 456, 458, 460) destinées à être exécutées par un processeur (324). L'exécution des instructions amène le processeur à acquérir (102, 202) des données de résonance magnétique de base (332) et reconstruire (104, 204) une première image (334) à l'aide des données de résonance magnétique de base. L'exécution des instructions amène en outre le processeur à acquérir (106, 212) des données de résonance magnétique sous-échantillonnées (336), qui sont sous-échantillonnées dans l'espace k par comparaison aux données de résonnance magnétique de base. L'exécution des instructions amène en outre le processeur à reconstruire (108, 214) une seconde image (338) à l'aide des données de résonance magnétique sous-échantillonnées et de la première image, la seconde image étant reconstruite à l'aide d'un algorithme de reconstruction à contrainte de rapport d'image (354), et calculer (110, 216) une carte de température (340) à l'aide de la seconde image.</p></abstract><abstract mxw-id="PA100331279" ref-ucid="WO-2012117303-A1" lang="FR" source="national office" load-source="docdb"><p>L'invention porte sur un appareil médical (300, 400, 500, 600) comprenant un système d'imagerie par résonance magnétique (301). L'appareil médical comprend en outre une mémoire (330) contenant des instructions (350, 352, 354, 456, 458, 460) destinées à être exécutées par un processeur (324). L'exécution des instructions amène le processeur à acquérir (102, 202) des données de résonance magnétique de base (332) et reconstruire (104, 204) une première image (334) à l'aide des données de résonance magnétique de base. L'exécution des instructions amène en outre le processeur à acquérir (106, 212) des données de résonance magnétique sous-échantillonnées (336), qui sont sous-échantillonnées dans l'espace k par comparaison aux données de résonnance magnétique de base. L'exécution des instructions amène en outre le processeur à reconstruire (108, 214) une seconde image (338) à l'aide des données de résonance magnétique sous-échantillonnées et de la première image, la seconde image étant reconstruite à l'aide d'un algorithme de reconstruction à contrainte de rapport d'image (354), et calculer (110, 216) une carte de température (340) à l'aide de la seconde image.</p></abstract><description mxw-id="PDES51232991" ref-ucid="WO-2012117303-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="3"/>--><p id="p0001" num="0001">ACCELERATED MR THERMOMETRY MAPPING INVOLVING AN IMAGE RATIO CONSTRAINED RECONSTRUCTION </p><p id="p0002" num="0002">TECHNICAL FIELD </p><p id="p0003" num="0003"> The invention relates to magnetic resonance thermometry, in particular a means of accelerating thermal mapping by reconstructing undersampled magnetic resonance data with previously acquired magnetic resonance data. </p><p id="p0004" num="0004">BACKGROUND OF THE INVENTION </p><p id="p0005" num="0005"> In recent years magnetic resonance thermometry has been coupled with various means of heating or cooling tissue for therapy. Measuring the effect of the tissue heating or cooling allows the guiding of the therapy and also the ability to assess the effect of a therapeutic treatment on a subject. </p><p id="p0006" num="0006"> In high-intensity focused ultrasound (HIFU) therapy, reliable real-time temperature monitoring using e.g. MRI is necessary to ensure a sufficient thermal necrosis to the target while avoiding excessive heating and damage of surrounding healthy tissues. To achieve sufficient temporal and spatial resolution, fast imaging is required preferably with a high spatial resolution while maintaining a sufficient SNR for reconstruction of reliable temperature measurements. </p><p id="p0007" num="0007"> In Wlodarczyk et. al., "Three-Dimensional Monitoring of Small Temperature Changes for Therapeutic Hyperthermia Using MRI," Journal of Magnetic Resonance </p><p id="p0008" num="0008">Imaging, Vol. 8, pp. 165-174, the keyhole technique was used to accelerate magnetic resonance temperature using a pulsed diffusion gradient spin echo pulse sequence. </p><p id="p0009" num="0009">SUMMARY OF THE INVENTION </p><p id="p0010" num="0010"> The invention provides for a medical apparatus, a method, and a computer program product in the independent claims. Embodiments are given in the dependant claims. </p><p id="p0011" num="0011"> MRI (Magnetic Resonance Imaging) is often used to plan and guide HIFU as well as other thermal therapies. MR (Magnetic Resonance) has the benefit over other imaging modalities in that it is able to produce high-quality temperature images since several parameters are temperature dependent. The most commonly adopted approach is to use the proton resonance frequency (PRF) shift of water, which is linearly dependent on temperature. 
<!-- EPO <DP n="4"/>-->
 Other alternative methods of thermometry rely on the temperature dependence of the Tl, T2 or T2-star relaxation times or the proton density. However, the temperature dependence is small, and tissue-dependent, which are the main reasons why PRF thermometry is the by far most used method. Though the other thermometry techniques rely on the magnitude images, PRF thermometry relies on the measurement of the phase images. </p><p id="p0012" num="0012"> In the recently released Philips Sonalleve MR-HIFU (Magnetic Resonance High Intensity Focused Ultrasound) product for the ablation of uterine fibroids, a gradient echo multishot EPI pulse sequence is used, with TE=20 ms, and dynamic imaging time of about 3 sec for 6 slices (3 coronal target region slices, 1 sagittal monitoring the beam path, 2 coronal slices placed near sensitive structures such as the skin, and e.g. colon) and 1 coronal with a spatial resolution of 2.5 x 2.5 x 7 mm3. Although this is acceptable, ideally a larger spatial coverage with higher spatial resolution would be preferred, optimally isotropic 3D. But in order to ensure a safe ablation procedure, the temporal resolution should preferably remain on the order of a few seconds without compromising SNR (Signal to Noise Ratio) as this is directly proportional to the temperature accuracy. Therefore, there is a need for faster phase imaging. Embodiments of the invention may provide for faster phase imaging as well as other advantages. </p><p id="p0013" num="0013"> In MR-HIFU the acoustic beam path (from the transducer to the target) is preferably unobstructed. This means that conventional coil elements should not be placed in an area you wish to sonicate through. This restricts coil design significantly on the anterior side of the patient, since the patient lies on her abdomen in many uterine fibroid platforms and the ultrasound enters through the abdominal wall. Therefore, the phased array coil for MR-HIFU has only limited ability for partially parallel imaging and high acceleration factor will degrade image quality. </p><p id="p0014" num="0014"> Limited coverage of the near real-time MR monitoring methods typically used today have some disadvantages: (i) The temperature information is available on the limited volume, (ii) The size and shape of the heating focus is only partly visible, resulting incomplete information of the thermal dose and inflicted damage to the target but also of potential damage to healthy tissues (iii) Motion easily induces phase or magnitude errors in the temperature monitoring images. With true uncorrupted 3D information those errors could more easily be corrected with motion correction SW. </p><p id="p0015" num="0015"> The imaging time is a limitation of the conventional methods. Increased speed would improve the safety and monitoring capabilities in the present applications. For future applications with e.g. more moving objects improved speed may be crucial. 
<!-- EPO <DP n="5"/>-->
 In some embodiments of the invention, methods are proposed that provide high acceleration factor without significant degradation of image quality, thus addressing directly to the disadvantages of the conventional methods mentioned above. The common denominator of these methods is that they all rely on that there is relatively little change in between subsequently acquired monitoring images and only acquire part of the k-space at each dynamic. There is thus a large redundancy in the data and/or parts of the data can be inherited from previous dynamic frames. </p><p id="p0016" num="0016"> Images for temperature mapping have very similar magnitude. Actually, if there is no motion, the magnitudes of all time frames should be same except for in a heated region where signal intensity will change due to changes in relaxation times. The heated region may be considered to be a region whose temperature has changed sufficiently such that the temperature related changes in the relaxation times affects the signal intensity. In some cases the change in temperature may be caused by a change in the location of the ultrasound focus (i.e., where the temperature can increases by more than 20 degrees celsius). However, the heated region may not necessarily be limited to a directly heated region, but may also refere to other regions. For example, it is also to observe the possible (but typically smaller) temperature changes elsewhere (with smaller signal changes). </p><p id="p0017" num="0017"> Also, if there are large temperature differences within a voxel, then the induced phase differences between the spins might cause partial cancellation of the signal and affect the signal intensity. This is similar to an out-phase condition between fat and water spins. The maintenance of the signal magnitude can be utilized used in the proposed solution. </p><p id="p0018" num="0018"> In one embodiment of the invention there are two essential features of the first method proposed: </p><p id="p0019" num="0019"> 1. Image ratio constrained reconstruction (IRCR) is used to approximate the to-be reconstructed image using a baseline image and a low resolution version of the to-be reconstructed image. Using the magnitude and/or phase of the result of IRCR as a constraint, and the result (both magnitude and phase) of the IRCR as initialization, to approximate the unacquired high frequency information with the acquired low frequency information. The baseline image is more completely sampled in k-space than the low resolution of the to be reconstructed image. </p><p id="p0020" num="0020"> a. In one version, the heated region can be removed from the constraint b. In another version, the baseline drift is modeled for the current to-be reconstructed image based on that of previous reconstructed phase images 
<!-- EPO <DP n="6"/>-->
 2. Partially parallel imaging (PPI), and/or partial Fourier reconstruction, can be used to improve the acquisition speed. </p><p id="p0021" num="0021"> In a second embodiment, the data redundancy is utilized and is based on a compressed sensing approach. All methods of thermometry, not just PRF, measure the temperature related change in a parameter (directly or indirectly). The result is a phase difference image (PRF thermometry) or magnitude difference image (relaxation constant or PD thermometry) or alternatively a MR parameter map difference image (e.g., from two Look-Locker based Tl relaxation constant maps obtained at different instances in time). In the absence of motion, these difference images are sparse in image space. In fact, only the heated region that has a non-zero signal (in theory at least). Therefore, constraints of sparsity can be used to reconstruct high resolution image with only partially acquired data. </p><p id="p0022" num="0022"> Preferably, the HIFU system should utilize coil solution allowing partial imaging methods. Generally that means that there are several coil elements with essentially different spatial sensitivity within the volume of interest. These partial imaging methods can be used in combination with the methods described below further boosting the image acceleration. </p><p id="p0023" num="0023"> Embodiments of the invention may be useful for improving the temporal and spatial resolution, and spatial coverage of temperature mapping for any thermal therapy modality, including HIFU, RF, microwave, cryo, and laser therapy. Examples of thermal therapies are ablation, and hyper- or hypothermia. Hyperthermia may e.g. be used for localized drug delivery or gene therapy. </p><p id="p0024" num="0024"> A 'computer-readable storage medium' as used herein encompasses any tangible storage medium which may store instructions which are executable by a processor of a computing device. The computer-readable storage medium may be referred to as a computer- readable non-transitory storage medium. The computer-readable storage medium may also be referred to as a tangible computer readable medium. In some embodiments, a computer- readable storage medium may also be able to store data which is able to be accessed by the processor of the computing device. Examples of computer-readable storage media include, but are not limited to: a floppy disk, a magnetic hard disk drive, a solid state hard disk, flash memory, a USB thumb drive, Random Access Memory (RAM), Read Only Memory (ROM), an optical disk, a magneto -optical disk, and the register file of the processor. Examples of optical disks include Compact Disks (CD) and Digital Versatile Disks (DVD), for example CD-ROM, CD-RW, CD-R, DVD-ROM, DVD-RW, or DVD-R disks. The term computer readable-storage medium also refers to various types of recording media capable of being 
<!-- EPO <DP n="7"/>-->
 accessed by the computer device via a network or communication link. For example a data may be retrieved over a modem, over the internet, or over a local area network. </p><p id="p0025" num="0025"> 'Computer memory' or 'memory' is an example of a computer-readable storage medium. Computer memory is any memory which is directly accessible to a processor. </p><p id="p0026" num="0026">Examples of computer memory include, but are not limited to: RAM memory, registers, and register files. </p><p id="p0027" num="0027"> 'Computer storage' or 'storage' is an example of a computer-readable storage medium. Computer storage is any non- volatile computer-readable storage medium. Examples of computer storage include, but are not limited to: a hard disk drive, a USB thumb drive, a floppy drive, a smart card, a DVD, a CD-ROM, and a solid state hard drive. In some embodiments computer storage may also be computer memory or vice versa. </p><p id="p0028" num="0028"> A 'processor' as used herein encompasses an electronic component which is able to execute a program or machine executable instruction. References to the computing device comprising "a processor" should be interpreted as possibly containing more than one processor or processing core. The processor may for instance be a multi-core processor. A processor may also refer to a collection of processors within a single computer system or distributed amongst multiple computer systems. The term computing device should also be interpreted to possibly refer to a collection or network of computing devices each comprising a processor or processors. Many programs have their instructions performed by multiple processors that may be within the same computing device or which may even be distributed across multiple computing devices. </p><p id="p0029" num="0029"> A 'user interface' as used herein is an interface which allows a user or operator to interact with a computer or computer system. A 'user interface' may also be referred to as a 'human interface device.' A user interface may provide information or data to the operator and/or receive information or data from the operator. A user interface may enable input from an operator to be received by the computer and may provide output to the user from the computer. In other words, the user interface may allow an operator to control or manipulate a computer and the interface may allow the computer indicate the effects of the operator's control or manipulation. The display of data or information on a display or a graphical user interface is an example of providing information to an operator. The receiving of data through a keyboard, mouse, trackball, touchpad, pointing stick, graphics tablet, joystick, gamepad, webcam, headset, gear sticks, steering wheel, pedals, wired glove, dance pad, remote control, and accelerometer are all examples of user interface components which enable the receiving of information or data from an operator. 
<!-- EPO <DP n="8"/>-->
 A 'hardware interface' as used herein encompasses a interface which enables the processor of a computer system to interact with and/or control an external computing device and/or apparatus. A hardware interface may allow a processor to send control signals or instructions to an external computing device and/or apparatus. A hardware interface may also enable a processor to exchange data with an external computing device and/or apparatus. Examples of a hardware interface include, but are not limited to: a universal serial bus, IEEE 1394 port, parallel port, IEEE 1284 port, serial port, RS-232 port, IEEE-488 port, Bluetooth connection, Wireless local area network connection, TCP/IP connection, Ethernet </p><p id="p0030" num="0030">connection, control voltage interface, MIDI interface, analog input interface, and digital input interface. </p><p id="p0031" num="0031"> A 'display' or 'display device' as used herein encompasses an output device or a user interface adapted for displaying images or data. A display may output visual, audio, and or tactile data. Examples of a display include, but are not limited to: a computer monitor, a television screen, a touch screen, tactile electronic display, Braille screen, </p><p id="p0032" num="0032">Cathode ray tube (CRT), Storage tube, Bistable display, Electronic paper, Vector display, Flat panel display, Vacuum fluorescent display (VF), Light-emitting diode (LED) displays, Electroluminescent display (ELD), Plasma display panels (PDP), Liquid crystal display (LCD), Organic light-emitting diode displays (OLED), a projector, and Head-mounted display. </p><p id="p0033" num="0033"> Magnetic Resonance (MR) data is defined herein as being the recorded measurements of radio frequency signals emitted by atomic spins by the antenna of a </p><p id="p0034" num="0034">Magnetic resonance apparatus during a magnetic resonance imaging scan. A Magnetic Resonance Imaging (MRI) image is defined herein as being the reconstructed two or three dimensional visualization of anatomic data contained within the magnetic resonance imaging data. This visualization can be performed using a computer. </p><p id="p0035" num="0035"> Magnetic resonance data may comprise the measurements of radio frequency signals emitted by atomic spins by the antenna of a Magnetic resonance apparatus during a magnetic resonance imaging scan which contains information which may be used for magnetic resonance thermometry. Magnetic resonance thermometry functions by measuring changes in temperature sensitive parameters. Examples of parameters that may be measured during magnetic resonance thermometry are: the proton resonance frequency shift, the diffusion coefficient, or changes in the Tl and/or T2 relaxation time may be used to measure the temperature using magnetic resonance. The proton resonance frequency shift is temperature dependent, because the magnetic field that individual protons, hydrogen atoms, 
<!-- EPO <DP n="9"/>-->
 experience depends upon the surrounding molecular structure. An increase in temperature decreases molecular screening due to the temperature affecting the hydrogen bonds. This leads to a temperature dependence of the proton resonant frequency. </p><p id="p0036" num="0036"> The proton density depends linearly on the equilibrium magnetization. It is therefore possible to determine temperature changes using proton density weighted images. </p><p id="p0037" num="0037"> The relaxation times Tl, T2, and T2-star (sometimes written as T2*) are also temperature dependent. The reconstruction of Tl, T2, and T2-star weighted images can therefore be used to construct thermal or temperature maps. </p><p id="p0038" num="0038"> The temperature also affects the Brownian motion of molecules in an aqueous solution. Therefore pulse sequences which are able to measure diffusion coefficients such as a pulsed diffusion gradient spin echo may be used to measure temperature. </p><p id="p0039" num="0039"> One of the most useful methods of measuring temperature using magnetic resonance is by measuring the proton resonance frequency (PRF) shift of water protons. The resonant frequency of the protons is temperature dependent. As the temperature changes in a voxel the frequency shift will cause the measured phase of the water protons to change. The temperature change between two phase images can therefore be determined. This method of determining temperature has the advantage that it is relatively fast in comparison to the other methods. The PRF method is discussed in greater detail than other methods herein. However, the methods and techniques discussed herein are also applicable to the other methods of performing thermometry with magnetic resonance imaging. </p><p id="p0040" num="0040"> An 'ultrasound window' as used herein encompasses a window which is able to transmit ultrasonic waves or energy. Typically a thin film or membrane is used as an ultrasound window. The ultrasound window may for example be made of a thin membrane of BoPET (Biaxially-oriented polyethylene terephthalate). </p><p id="p0041" num="0041"> In one aspect the invention provides for a medical apparatus comprising a magnetic resonance imaging system for acquiring magnetic resonance data. The medical apparatus further comprises a processor for controlling the medical apparatus. The apparatus further comprises a memory containing machine-readable instructions for execution by the processor. </p><p id="p0042" num="0042"> Execution of the instructions causes the processor to acquire baseline magnetic resonance data. The processor may acquire magnetic resonance data by sending instructions or control signals to the magnetic resonance imaging system which cause it to acquire magnetic resonance data. Execution of the instructions further causes the processor to reconstruct a first image using the baseline magnetic resonance data. Execution of the 
<!-- EPO <DP n="10"/>-->
 instructions further causes the processor to acquire under-sampled magnetic resonance data. The under-sampled magnetic resonance data is under-sampled in k-space in comparison to the baseline magnetic resonance data. In other words the under-sampled magnetic resonance data does not sample as many points in k-space as was sampled for the baseline magnetic resonance data. The under-sampled magnetic resonance data may also be referred to as sparsely sampled magnetic resonance data. </p><p id="p0043" num="0043"> Execution of the instructions further causes the processor to reconstruct a second image using the under-sampled magnetic resonance data and the first image. As the under-sampled magnetic resonance data samples fewer points in k-space the first image is used to at least partially reconstruct the second image. This is advantageous because using data from the first image allows the second image to be reconstructed using the under- sampled magnetic resonance data. Because fewer points are sampled in k-space when acquiring the under-sampled magnetic resonance data it takes less time to acquire the under- sampled magnetic resonance data than the baseline magnetic resonance data. </p><p id="p0044" num="0044"> Execution of the instructions further causes the processor to calculate a temperature map using the second image. In some embodiments the temperature map is calculated using both the second image and the first image. The second image is </p><p id="p0045" num="0045">reconstructed using an image ratio constrained reconstruction algorithm. For instance the first image may be a calibration or baseline image. The temperature map may then be constructed to map a temperature change with respect to when the second image and the first image were acquired. In some embodiments the magnetic resonance data is acquired from a subject located within an imaging zone of the magnetic resonance imaging system. </p><p id="p0046" num="0046"> As used herein an image ratio constrained reconstruction (IRCR) algorithm refers to algorithms which use an image ratio for reconstruction and also magnitude and/or phase constraints. </p><p id="p0047" num="0047"> Examples of how an IRCR algorithm may be constructed are outlined below:</p><p id="p0048" num="0048">1. Acquisition </p><p id="p0049" num="0049"> a. before HIFU sonication, one or two full k-space baseline data sets are acquired.; </p><p id="p0050" num="0050"> b. during HIFU sonication, partial k-space data with a fully acquired centre </p><p id="p0051" num="0051"> region are acquired for phase imaging. Not all embodiments use HIFU sonication. </p><p id="p0052" num="0052"> 2. Reconstruction Model </p><p id="p0053" num="0053"> a. Image ratio constrained reconstruction (IRCR): 
<!-- EPO <DP n="11"/>-->
 The fully acquired -space data RK (usually the first time frame) is used as the reference data set. PK is the set (or sets) of partially acquired -space data of time frame t. With the same undersampling scheme as the one for PK, a set of partial k- space data PRK can be generated from RK. Let I<sub>PK</sub>, IRK, and I PRE be images generated with PK, RK, and PRK correspondingly. Then the reconstructed image iRec = IpK ÷ I PRK x IRK, where x and ÷ denote pixel- wise multiplication and division respectively. To avoid singularity, a specific threshold can be chosen before division. b. Magnitude and/or phase constrained reconstruction: </p><p id="p0054" num="0054">The reconstruction model is 
<img id="imgf000011_0001" he="12" wi="131" file="imgf000011_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0055" num="0055">where / is the to-be reconstructed image, 7 is the image reconstructed by IRCR, j is the coil count, Nch is the number of coil elements, k<sub>j</sub> is the partially acquired k- space data,. S^ is the sensitivity map of the j<sup>th</sup> coil element, is a positive parameter to balance these two terms, |*| is the absolute value, and ||*|| denote the L<sub>2</sub> norm. c. The fully acquired centre k-space data can be partially acquired, such as </p><p id="p0056" num="0056"> asymmetric in k-space or equally spaced with SENSE factor &gt; 1, and partial Fourier technique [5] or PPI [1 , 2] can be applied to approximate partial unacquired data. </p><p id="p0057" num="0057">d. An alternative reconstruction model could use image support reduction and sparsity constraint for reconstruction. First, the partially acquired data could subtract the result of IRCR in k-space to produce the residual partially acquired data, which corresponds to an image with sparse image support (ideally, only the region with changed phase). And the reconstruction model is </p><p id="p0058" num="0058"> _ Nch / _\ 2 — </p><p id="p0059" num="0059"> minE[7]= nm∑ , (S )- *J + <sup>2</sup>||7||<sub>ζι</sub> , [2], </p><p id="p0060" num="0060"><sup>7</sup> 7=1 
<!-- EPO <DP n="12"/>-->
 where I is the to-be reconstructed image, j is the coil count, Nch is the number of coil elements, &amp; . is the residual partially acquired k-space data. In k-space, each time frame subtract the baseline data at acquired location to produce a set of residual k-space data </p><p id="p0061" num="0061"> e. Alternatively, the heated region is removed from the magnitude/phase </p><p id="p0062" num="0062"> constraint in Eq. [1] since the phase and magnitude (although magnitude only slightly and in only a few voxels) are known to vary in this region f. If a phase constraint is used, then estimate the baseline drift of the phase in the current image based on the phase drift rate of previous images and the phase drift of the centre k-space acquired data </p><p id="p0063" num="0063"> 3. Numerical algorithm </p><p id="p0064" num="0064"> a. Eq. [1] can be numerically solved using projection onto convex set (POCS). </p><p id="p0065" num="0065"> This numerical scheme is fast, and does not need parameter . b. Eq. [1] can also be solved using conjugate gradient based method. This </p><p id="p0066" num="0066"> numerical scheme could be slightly more accurate, but takes longer reconstruction time and several carefully chosen parameters. </p><p id="p0067" num="0067"> In another embodiment the medical apparatus further comprises a temperature treatment system for treating a target volume of a subject. In some embodiments the target volume is within an imaging zone of the magnetic resonance imaging system. Execution of the instructions further causes the processor to treat the target volume during acquisition of the under-sampled magnetic resonance data. For instance the processor may treat the target volume by generating temperature treatment system commands in accordance with the temperature map. The processor may further cause the target volume to be treated by sending the temperature treatment system commands to the temperature treatment system. As used herein the temperature treatment system commands comprise instructions or control signals which the processor uses to control the temperature treatment system. A temperature treatment system as used herein comprises a system for controllably raising or lowering the temperature of the target volume within the subject. </p><p id="p0068" num="0068"> This embodiment is advantageous because the under-sampled magnetic resonance data can be acquired extremely rapidly. This facilitates the rapid calculation of the temperature map using the second image. The temperature map may be used as a feedback for controlling the temperature treatment system. 
<!-- EPO <DP n="13"/>-->
 In another embodiment execution of the instructions further causes the processor to select k-space sampled points for the acquisition of the under-sampled magnetic resonance data in accordance with the location of the target volume. For instance the k-space sample points are locations which have the strongest correlation with the location of the target volume and the second image can be selected. This is advantageous because if the target volume is either being heated or cooled then one would expect that the image data used to generate a temperature map will be changing most greatly within the target volume. </p><p id="p0069" num="0069"> The selecting of k-sample points or areas is known in literature as selecting a region of interest by using region of interest information to determine k-space trajectories which avoid the acquisition of redundant information during dynamic imaging. Likewise the use of a region of interest in selecting k-space sample trajectories is known for suppressing signals external to a region of interest in magnetic resonance imaging also. Using known techniques the k-space sample points which have the strongest correlation with the target volume in the second image can be selected. </p><p id="p0070" num="0070"> One conventional scheme is to use single value decomposition (SVD) analysis to the k-space corresponding to a region of interest or in this case the target volume. This embodiment is particularly advantageous because the k-space sample points are selected such that the region of the second image corresponding to the target volume is better reconstructed by the k-space sample points than the surrounding or remaining portion of the second image. This may aid in accelerating the acquisition of the under-sampled magnetic resonance data. </p><p id="p0071" num="0071"> In another embodiment execution of the instructions further cause the processor to repeatedly acquire the under-sampled magnetic resonance data. Execution of the instructions further causes the processor to repeatedly reconstruct the second image using the under-sampled magnetic resonance data and the first image. Execution of the instructions further causes the processor to repeatedly calculate a temperature map using the second image. In some embodiments the first image is also used to calculate the temperature map. Execution of the instructions further causes the processor to repeatedly generate temperature treatment system commands in accordance with the temperature map. Execution of the instructions further causes the processor to repeatedly send the temperature treatment system commands to the temperature treatment system. This embodiment is advantageous because the under-sampled magnetic resonance data is used to generate a temperature map which is used for feedback control of the temperature treatment system. </p><p id="p0072" num="0072"> In another embodiment the temperature treatment system is a high- intensity focused ultrasound system. 
<!-- EPO <DP n="14"/>-->
 In another embodiment the temperature treatment system is a radio-frequency tissue treating system. For instance a radio-frequency antenna may be used to heat the target volume using radio-frequency energy. Typically an additional antenna is used or placed in the vicinity of the subject to generate the radio-frequency energy that heats the target zone. </p><p id="p0073" num="0073"> In another embodiment the temperature treatment system is a microwave applicator. A microwave applicator is adapted for directing microwave energy at the target zone. This may cause an increase in temperature of the target zone. </p><p id="p0074" num="0074"> In another embodiment the temperature treatment system is a cryo-ablator. A cryo-ablator is adapted for cooling the target zone or a portion of the target zone to temperatures which cause the ablation of tissue. </p><p id="p0075" num="0075"> In another embodiment the temperature treatment system is a laser. The laser may be used to selectively ablate tissue. </p><p id="p0076" num="0076"> In another embodiment the location of the target volume is used as a constraint during reconstruction of the second image. </p><p id="p0077" num="0077"> In another embodiment the first image is a phase image. The second image is a phase image. The thermal map is calculated by determining a phase shift between voxels of the first image and voxels of the second image. In this embodiment the temperature map is constructed using a gradient-recalled echo (GRE) imaging sequence to measure the phase change resulting from the temperature change between the first image and the second image. The phase change occurs due to the temperature-dependent change in the resonant frequency. </p><p id="p0078" num="0078"> In another embodiment the first and second image are used to construct the thermal map by calculating a change in the proton density. </p><p id="p0079" num="0079"> In another embodiment the first and second image are used to construct the thermal map by calculating a change in the Tl relaxation time of water protons. </p><p id="p0080" num="0080"> In another embodiment the first and second image are used to construct the thermal map by calculating a change in the T2 relaxation time of water protons. </p><p id="p0081" num="0081"> In another embodiment the first and second image are used to construct the thermal map by calculating a change in the T2-star relaxation times of water protons. </p><p id="p0082" num="0082"> In another embodiment the first image and the second image are used to construct the thermal map by calculating a change in the change of a diffusion constant. </p><p id="p0083" num="0083"> In another embodiment the change is calculated for each voxel of the second image. </p><p id="p0084" num="0084"> in another embodiment, the image ratio constrained reconstruction algorithm comprises calculating a constraint, wherein the constraint is calculated on any one of the 
<!-- EPO <DP n="15"/>-->
 following: a magnitude image, a phase image, a complex image, and combinations thereof. The magnitude image, the phase image, the complex image, may refer to the first image and/or the second image. </p><p id="p0085" num="0085"> In another embodiment the baseline magnetic resonance data and the under- sampled magnetic resonance data is acquired and/or reconstructed using a parallel imaging technique. For instance the SENSE or GRAPPA techniques may be used. </p><p id="p0086" num="0086"> In another embodiment the baseline magnetic resonance data and the under- sampled magnetic resonance data is acquired using a two-dimensional or a three-dimensional gradient echo pulse sequence. </p><p id="p0087" num="0087"> In another embodiment the baseline magnetic resonance data and the under- sampled magnetic resonance data is acquired with a two-dimensional or a three-dimensional gradient echo EPI pulse sequence, k-space sample points for the acquisition of the under- sampled magnetic resonance data and the baseline magnetic resonance data are chosen such that the first image and the second image are acquired using similar echo times. In other words the echo times used to acquire the first image and the second image are the same duration plus or minus a predetermined amount of time. One can calculate spin frequency images from the phase images using the separate echo times. It is the different in the frequency that determines the temperature change. </p><p id="p0088" num="0088"> The baseline magnetic resonance data and the under-sampled magnetic resonance data are acquired using a two-dimensional or a three-dimensional spin echo or turbo spin echo pulse sequence. </p><p id="p0089" num="0089"> In another aspect the invention provides for a method of operating a medical apparatus. Likewise the invention also provides for a computer-implemented method. The medical apparatus comprises a magnetic resonance imaging system for acquiring magnetic resonance data. The method comprises the step of acquiring baseline magnetic resonance data. The magnetic resonance imaging system may be used for acquiring the baseline magnetic resonance data. The method further comprises the step of reconstructing a first image using the baseline magnetic resonance data. Standard image reconstruction techniques may be used for reconstructing the first image. </p><p id="p0090" num="0090"> The method further comprises the step of acquiring under-sampled magnetic resonance data. Again the magnetic resonance imaging system may be used for acquiring the under-sampled magnetic resonance data. The under-sampled magnetic resonance data is under-sampled in k-space in comparison to the baseline magnetic resonance data. The method further comprises the step of reconstructing a second image using the under-sampled 
<!-- EPO <DP n="16"/>-->
 magnetic resonance data and the first image. The second image is reconstructed using an image ratio constrained reconstruction algorithm. The method further comprises the step of calculating a temperature map using the second image. </p><p id="p0091" num="0091"> In another aspect the invention provides for a computer program product comprising machine executable instructions for execution by a processor of a medical apparatus. For instance the computer program product may be stored on a computer-readable storage medium. The medical apparatus comprises a magnetic resonance imaging system for acquiring magnetic resonance data. Execution of the instructions further causes the processor to acquire baseline magnetic resonance data. Execution of the instructions further causes the processor to reconstruct a first image using the baseline magnetic resonance data. </p><p id="p0092" num="0092"> Execution of the instructions further causes the processor to acquire under- sampled magnetic resonance data. The under-sampled magnetic resonance data is under- sampled in k-space in comparison to the baseline magnetic resonance data. Execution of the instructions further causes the processor to reconstruct a second image using the under- sampled magnetic resonance data and the first image. The second image is reconstructed using an image ratio constrained reconstruction algorithm. Execution of the instructions further causes the processor to calculate a temperature map using the second image. </p><p id="p0093" num="0093"> In one aspect the invention provides for a medical apparatus comprising a magnetic resonance imaging system for acquiring magnetic resonance data. The medical apparatus further comprises a processor for controlling the medical apparatus. The apparatus further comprises a memory containing machine-readable instructions for execution by the processor. </p><p id="p0094" num="0094"> Execution of the instructions causes the processor to acquire baseline magnetic resonance data. The processor may acquire magnetic resonance data by sending instructions or control signals to the magnetic resonance imaging system which cause it to acquire magnetic resonance data. Execution of the instructions further causes the processor to reconstruct a first image using the baseline magnetic resonance data. Execution of the instructions further causes the processor to acquire under-sampled magnetic resonance data. The under-sampled magnetic resonance data is under-sampled in k-space in comparison to the baseline magnetic resonance data. In other words the under-sampled magnetic resonance data does not sample as many points in k-space as was sampled for the baseline magnetic resonance data. The under-sampled magnetic resonance data may also be referred to as sparsely sampled magnetic resonance data. 
<!-- EPO <DP n="17"/>-->
 Execution of the instructions further causes the processor to reconstruct a second image using the under-sampled magnetic resonance data and the first image. The second image is reconstructed using compressed sensing. Embodiments may use a compressed sensing algorithm with the first image and the under-sampled magnetic resonance data as inputs for the algorithm. As the under-sampled magnetic resonance data samples fewer points in k-space the first image is used to at least partially reconstruct the second image. This is advantageous because using data from the first image allows the second image to be reconstructed using the under-sampled magnetic resonance data. Because fewer points are sampled in k-space when acquiring the under-sampled magnetic resonance data it takes less time to acquire the under-sampled magnetic resonance data than the baseline magnetic resonance data. </p><p id="p0095" num="0095"> Examples of compressed sensing algorithms are outlined below:</p><p id="p0096" num="0096">1. Acquisition </p><p id="p0097" num="0097"> a. Each dynamic level is sub-sampled using a variable density pseudo </p><p id="p0098" num="0098"> random pattern though such that each dynamic level has an equal amount of randomly distributed samples </p><p id="p0099" num="0099"> i. The samples can also be constrained as explained in Ref. 3 to </p><p id="p0100" num="0100"> further reduce aliasing </p><p id="p0101" num="0101"> 2. Reconstruction model </p><p id="p0102" num="0102"> a. Sparsity in image space is used as the regularization term. Examples of possible regularization include :total variation, wavelet transform, non- convex finite difference, trained dictionary, non-local mean, and others. b. One possible reconstruction model is: </p><p id="p0103" num="0103"> Nch _ <sub>2</sub> </p><p id="p0104" num="0104"> minE[/] = nm∑ , (S )- *J + λψ(7), </p><p id="p0105" num="0105"> / j <sub>j=i</sub> » where I is the to-be reconstructed image, j is the coil count, Nch is the number of coil elements, &amp; . is the residual partially acquired k-space data, ψ(·) is a sparsity constraint operator mentioned in a, λ is an non-negtive parameter to balance these two terms. </p><p id="p0106" num="0106"> 3. Numerical methods </p><p id="p0107" num="0107"> a. Several methods can be employed for recovering the full image from the randomly under-sampled data, such as orthogonal marching pursuit, split Bregman, and others. 
<!-- EPO <DP n="18"/>-->
 A benefit of the IRCR method as compared to compressed sensing is that it is much less computationally laborious. </p><p id="p0108" num="0108"> Execution of the instructions further causes the processor to calculate a temperature map using the second image. In some embodiments the temperature map is calculated using both the second image and the first image. For instance the first image may be a calibration or baseline image. The temperature map may then be constructed to map a temperature change with respect to when the second image and the first image were acquired. In some embodiments the magnetic resonance data is acquired from a subject located within an imaging zone of the magnetic resonance imaging system. </p><p id="p0109" num="0109"> In another embodiment the medical apparatus further comprises a temperature treatment system for treating a target volume of a subject. In some embodiments the target volume is within an imaging zone of the magnetic resonance imaging system. Execution of the instructions further causes the processor to treat the target volume during acquisition of the under-sampled magnetic resonance data. For instance the processor may treat the target volume by generating temperature treatment system commands in accordance with the temperature map. The processor may further cause the target volume to be treated by sending the temperature treatment system commands to the temperature treatment system. As used herein the temperature treatment system commands comprise instructions or control signals which the processor uses to control the temperature treatment system. A temperature treatment system as used herein comprises a system for controllably raising or lowering the temperature of the target volume within the subject. </p><p id="p0110" num="0110"> This embodiment is advantageous because the under-sampled magnetic resonance data can be acquired extremely rapidly. This facilitates the rapid calculation of the temperature map using the second image. The temperature map may be used as a feedback for controlling the temperature treatment system. </p><p id="p0111" num="0111"> In another embodiment execution of the instructions further causes the processor to select k-space sampled points for the acquisition of the under-sampled magnetic resonance data in accordance with the location of the target volume. For instance the k-space sample points are locations which have the strongest correlation with the location of the target volume and the second image can be selected. This is advantageous because if the target volume is either being heated or cooled then one would expect that the image data used to generate a temperature map will be changing most greatly within the target volume. </p><p id="p0112" num="0112"> The selecting of k-sample points or areas is known in literature as selecting a region of interest by using region of interest information to determine k-space trajectories 
<!-- EPO <DP n="19"/>-->
 which avoid the acquisition of redundant information during dynamic imaging. Likewise the use of a region of interest in selecting k-space sample trajectories is known for suppressing signals external to a region of interest in magnetic resonance imaging also. Using known techniques the k-space sample points which have the strongest correlation with the target volume in the second image can be selected. </p><p id="p0113" num="0113"> One conventional scheme is to use single value decomposition (SVD) analysis to the k-space corresponding to a region of interest or in this case the target volume. This embodiment is particularly advantageous because the k-space sample points are selected such that the region of the second image corresponding to the target volume is better reconstructed by the k-space sample points than the surrounding or remaining portion of the second image. This may aid in accelerating the acquisition of the under-sampled magnetic resonance data. </p><p id="p0114" num="0114"> In another embodiment execution of the instructions further cause the processor to repeatedly acquire the under-sampled magnetic resonance data. Execution of the instructions further causes the processor to repeatedly reconstruct the second image using the under-sampled magnetic resonance data and the first image. Execution of the instructions further causes the processor to repeatedly calculate a temperature map using the second image. In some embodiments the first image is also used to calculate the temperature map. Execution of the instructions further causes the processor to repeatedly generate temperature treatment system commands in accordance with the temperature map. Execution of the instructions further causes the processor to repeatedly send the temperature treatment system commands to the temperature treatment system. This embodiment is advantageous because the under-sampled magnetic resonance data is used to generate a temperature map which is used for essentially feedback control of the temperature treatment system. </p><p id="p0115" num="0115"> In another embodiment the temperature treatment system is a high- intensity focused ultrasound system. </p><p id="p0116" num="0116"> In another embodiment the temperature treatment system is a radio-frequency tissue treating system. For instance a radio-frequency antenna may be used to heat the target volume using radio-frequency energy. Typically an additional antenna is used or placed in the vicinity of the subject to generate the radio-frequency energy that heats the target zone. </p><p id="p0117" num="0117"> In another embodiment the temperature treatment system is a microwave applicator. A microwave applicator is adapted for directing microwave energy at the target zone. This may cause an increase in temperature of the target zone. 
<!-- EPO <DP n="20"/>-->
 In another embodiment the temperature treatment system is a cryo-ablator. A cryo-ablator is adapted for cooling the target zone or a portion of the target zone to temperatures which cause the ablation of tissue. </p><p id="p0118" num="0118"> In another embodiment the temperature treatment system is a laser. The laser may be used to selectively ablate tissue. </p><p id="p0119" num="0119"> In another embodiment a seed image for the reconstruction of the second image using compressed sensing is calculated using an image ratio constrained reconstruction algorithm. This embodiment is advantageous because this allows the compressed sensing algorithm to more rapidly converge to a solution. This speeds up the overall construction of the second image when compressed sensing is used. </p><p id="p0120" num="0120"> In another embodiment the first image is a phase image. The second image is a phase image. The thermal map is calculated by determining a phase shift between voxels of the first image and voxels of the second image. In this embodiment the temperature map is constructed using a gradient-recalled echo (GRE) imaging sequence to measure the phase change resulting from the temperature change between the first image and the second image. The phase change occurs due to the temperature-dependent change in the resonant frequency. </p><p id="p0121" num="0121"> In another embodiment the first and second image are used to construct the thermal map by calculating a change in the proton density. </p><p id="p0122" num="0122"> In another embodiment the first and second image are used to construct the thermal map by calculating a change in the Tl relaxation time of water protons. </p><p id="p0123" num="0123"> In another embodiment the first and second image are used to construct the thermal map by calculating a change in the T2 relaxation time of water protons. </p><p id="p0124" num="0124"> In another embodiment the first and second image are used to construct the thermal map by calculating a change in the T2-star relaxation times of water protons. </p><p id="p0125" num="0125"> In another embodiment the first image and the second image are used to construct the thermal map by calculating a change in the change of a diffusion constant. </p><p id="p0126" num="0126"> In another embodiment the change is calculated for each voxel of the second image. </p><p id="p0127" num="0127"> In another embodiment the baseline magnetic resonance data and the under- sampled magnetic resonance data is acquired and/or reconstructed using a parallel imaging technique. For instance the SENSE or GRAPPA techniques may be used. </p><p id="p0128" num="0128"> In another embodiment the baseline magnetic resonance data and the under- sampled magnetic resonance data is acquired using a two-dimensional or a three-dimensional gradient echo pulse sequence. 
<!-- EPO <DP n="21"/>-->
 In another embodiment the baseline magnetic resonance data and the under- sampled magnetic resonance data is acquired with a two-dimensional or a three-dimensional gradient echo EPI pulse sequence, k-space sample points for the acquisition of the under- sampled magnetic resonance data and the baseline magnetic resonance data are chosen such that the first image and the second image are acquired using a similar echo time. In other words the echo times used to acquire the first image and the second image are the same duration plus or minus a predetermined amount of time. In some embodiments the echo time of the first image and the second image are identical. One can calculate spin frequency images from the phase images using echo times which are different. It is the difference in the frequency that determines the temperature change. In some embodiments the echo time of the first image and the second image are identical. One can calculate spin frequency images from the phase images using echo times which are different. It is the difference in the frequency that determines the temperature change. </p><p id="p0129" num="0129"> The baseline magnetic resonance data and the under-sampled magnetic resonance data are acquired using a two-dimensional or a three-dimensional spin echo or turbo spin echo pulse sequence. </p><p id="p0130" num="0130"> In another aspect the invention provides for a method of operating a medical apparatus. Likewise the invention also provides for a computer-implemented method. The medical apparatus comprises a magnetic resonance imaging system for acquiring magnetic resonance data. The method comprises the step of acquiring baseline magnetic resonance data. The magnetic resonance imaging system may be used for acquiring the baseline magnetic resonance data. The method further comprises the step of reconstructing a first image using the baseline magnetic resonance data. Standard image reconstruction techniques may be used for reconstructing the first image. </p><p id="p0131" num="0131"> The method further comprises the step of acquiring under-sampled magnetic resonance data. Again the magnetic resonance imaging system may be used for acquiring the under-sampled magnetic resonance data. The under-sampled magnetic resonance data is under-sampled in k-space in comparison to the baseline magnetic resonance data. The method further comprises the step of reconstructing a second image using the under-sampled magnetic resonance data and the first image. The second image is reconstructed using compressed sensing. The method further comprises the step of calculating a temperature map using the second image. </p><p id="p0132" num="0132"> In another aspect the invention provides for a computer program product comprising machine executable instructions for execution by a processor of a medical 
<!-- EPO <DP n="22"/>-->
 apparatus. For instance the computer program product may be stored on a computer-readable storage medium. The medical apparatus comprises a magnetic resonance imaging system for acquiring magnetic resonance data. Execution of the instructions further causes the processor to acquire baseline magnetic resonance data. Execution of the instructions further causes the processor to reconstruct a first image using the baseline magnetic resonance data. </p><p id="p0133" num="0133"> Execution of the instructions further causes the processor to acquire under- sampled magnetic resonance data. The under-sampled magnetic resonance data is under- sampled in k-space in comparison to the baseline magnetic resonance data. Execution of the instructions further causes the processor to reconstruct a second image using the under- sampled magnetic resonance data and the first image. The second image is reconstructed using compressed sensing. Execution of the instructions further causes the processor to calculate a temperature map using the second image. </p><p id="p0134" num="0134"> In another aspect the invention provides for a medical apparatus comprising a magnetic resonance imaging system for acquiring magnetic resonance data. Embodiments of the previously described medical apparatus may also apply to this medical apparatus. The medical apparatus further comprises a processor for controlling the medical apparatus. The medical apparatus further comprises a memory containing machine-readable instructions for execution by the processor. Execution of the instructions causes the processor to acquire baseline magnetic resonance data. Execution of the instructions further causes the processor to reconstruct a baseline phase image using the baseline magnetic resonance data. The baseline phase image corresponds to the first image of the previously described medical apparatus. Execution of the instructions further causes the processor to acquire under- sampled magnetic resonance data. The under-sampled magnetic resonance data is under- sampled in k-space in comparison to the baseline magnetic resonance data. Execution of the instructions further causes the processor to reconstruct a phase image using the under- sampled magnetic resonance data and the baseline phase image. The phase image as herein described is equivalent to the second image of a previously described medical apparatus. Embodiments of this invention are advantageous because phase images may be acquired rapidly and used for such things as creating temperature maps or as data for a feedback loop which controls an apparatus. </p><p id="p0135" num="0135"> In another embodiment execution of the instructions further causes the processor to calculate a temperature map using the phase image. In some embodiments the baseline phase image is also used to at least partially calculate the temperature map. For 
<!-- EPO <DP n="23"/>-->
 instance the change in phase between the baseline phase image and the phase image may be used to calculate the temperature. </p><p id="p0136" num="0136"> In another embodiment the medical apparatus further comprises a temperature treatment system for treating a target volume of a subject. Execution of the instructions further causes the processor to treat the target volume during acquisition of the under- sampled magnetic resonance data. </p><p id="p0137" num="0137"> In another embodiment execution of the instructions further causes the processor to select k-space sample points for the acquisition of the under-sampled magnetic resonance data in accordance with the location of the target volume. </p><p id="p0138" num="0138"> In another embodiment execution of the instructions further cause the processor to repeatedly acquire the under-sampled magnetic resonance data. Execution of the instructions further causes the processor to reconstruct the phase image using the under- sampled magnetic resonance data and the baseline phase image. Execution of the instructions further causes the processor to repeatedly calculate a temperature map using the phase image. Execution of the instructions further causes the processor to repeatedly generate temperature treatment system commands in accordance with the temperature map. Execution of the instructions further causes the processor to repeatedly send the temperature treatment system commands to the temperature treatment system. </p><p id="p0139" num="0139"> In another embodiment the temperature treatment system is a high- intensity focused ultrasound system. </p><p id="p0140" num="0140"> In another embodiment the temperature treatment system is a radio-frequency tissue treating system. </p><p id="p0141" num="0141"> In another embodiment the temperature treatment system is a microwave applicator. </p><p id="p0142" num="0142"> In another embodiment the temperature treatment system is a cryo-ablator.</p><p id="p0143" num="0143">In another embodiment the temperature treatment system is a laser. </p><p id="p0144" num="0144"> In another embodiment the phase image is reconstructed using an image ratio constrained reconstruction algorithm. </p><p id="p0145" num="0145"> In another embodiment the phase image is reconstructed using compressed sensing. </p><p id="p0146" num="0146"> In another embodiment a seed phase image for the compressed sensing is calculated using an image ratio constrained reconstruction algorithm. </p><p id="p0147" num="0147"> In another embodiment the thermal map is reconstructed using a keyhole algorithm. 
<!-- EPO <DP n="24"/>-->
 In another embodiment the under-sampled magnetic resonance data is acquired repeatedly. The phase image is acquired repeatedly using the repeatedly acquired under-sampled magnetic resonance data. </p><p id="p0148" num="0148"> In another aspect the invention provides for a method of operating the medical apparatus. The medical apparatus comprises a magnetic resonance imaging system for acquired magnetic resonance data. The method comprises the step of acquiring the baseline magnetic resonance data. The method further comprises the step of reconstructing a baseline phase image using the baseline magnetic resonance data. The method further comprises the step of acquiring under-sampled magnetic resonance data. The under-sampled magnetic resonance data is under-sampled in k-space in comparison to the baseline magnetic resonance data. The method further comprises the step of reconstructing a phase image using the under- sampled magnetic resonance data and the baseline phase image. This method may also be implemented as a computer-implemented method. </p><p id="p0149" num="0149"> In another aspect the invention provides for a computer program product comprising machine executable instructions for execution by a processor which controls a medical apparatus. The computer program product may for instance be stored on a computer- readable storage medium. Execution of the instructions causes the processor to acquire baseline magnetic resonance data. The magnetic resonance imaging system may be used for acquiring the baseline magnetic resonance data. Execution of the instructions further causes the processor to reconstruct a baseline phase image using the baseline magnetic resonance data. Execution of the instructions further causes the processor to acquire under-sampled magnetic resonance data. The under-sampled magnetic resonance data is under-sampled in k- space in comparison to the baseline magnetic resonance data. Execution of the instructions further causes the processor to reconstruct a phase image using the under-sampled magnetic resonance data and the baseline phase image. </p><p id="p0150" num="0150">BRIEF DESCRIPTION OF THE DRAWINGS </p><p id="p0151" num="0151"> In the following preferred embodiments of the invention will be described, by way of example only, and with reference to the drawings in which: </p><p id="p0152" num="0152"> Fig. 1 shows a flowchart which illustrates an embodiment of a method according to the invention; </p><p id="p0153" num="0153"> Fig. 2shows a flowchart which illustrates a further embodiment of a method according to the invention; 
<!-- EPO <DP n="25"/>-->
 Fig 3 illustrates a medical apparatus according to an embodiment of the invention; </p><p id="p0154" num="0154"> Fig 4 illustrates a medical apparatus according to a further embodiment of the invention; </p><p id="p0155" num="0155"> Fig 5 illustrates a medical apparatus according to a further embodiment of the invention; </p><p id="p0156" num="0156"> Fig. 6 illustrates a medical apparatus according to a further embodiment of the invention; and </p><p id="p0157" num="0157"> Fig. 7 shows two plots which illustrate the effectiveness of a method according to the invention. </p><p id="p0158" num="0158">DETAILED DESCRIPTION OF THE EMBODIMENTS </p><p id="p0159" num="0159"> Like numbered elements in these figures are either equivalent elements or perform the same function. Elements which have been discussed previously will not necessarily be discussed in later figures if the function is equivalent. </p><p id="p0160" num="0160"> Fig. 1 shows a flowchart which illustrates an embodiment of a method according to the invention. In step 102 baseline magnetic resonance data is acquired. In step 104 a first image is reconstructed using the baseline magnetic resonance data. In step 106 under-sampled magnetic resonance data is acquired. In step 108 a second image is reconstructed using the under-sampled magnetic resonance data and the first image. In step 110 a temperature map is calculated using the second image. In some embodiments the temperature map is calculated using both the second image and the first image. </p><p id="p0161" num="0161"> Fig. 2 shows a flowchart which illustrates a method according to a further embodiment according to the invention. In step 200 the method starts. Next in step 202 baseline magnetic resonance data is acquired. In step 204 a first image is reconstructed using baseline magnetic resonance data. Next in step 206 k-space sample points are selected for acquisition of under-sampled magnetic resonance data. In step 208 temperature treatment commands are generated. In step 210 temperature treatment commands are sent to the temperature treatment system. This causes the temperature treatment system to begin temperature treatment of the target zone. In step 212 under-sampled magnetic resonance data is acquired. Next the second image is reconstructed using the under-sampled magnetic resonance data and the first image. Further in step 216 a temperature map is calculated using the second image and also possibly the first image. In step 218 temperature treatment commands are generated using the temperature map. 
<!-- EPO <DP n="26"/>-->
 Next in step 220 the temperature treatment commands are sent to the temperature treatment system. The temperature treatment commands were originally sent to the temperature treatment system in step 210 but now the temperature treatment commands have been modified in accordance or using the temperature map. The system then proceeds back to step 212 and acquires more under-sampled magnetic resonance data. Then the steps are proceeded through and a replacement temperature map is calculated using the second image. Steps 212-220 form a feedback loop where the temperature map is used to modify the temperature treatment commands. For instance the temperature treatment commands may be modified in accordance with a temperature map and a treatment plan. When the temperature treatment or therapy is finished then the method ends in step 222. </p><p id="p0162" num="0162"> Fig. 3 illustrates a medical apparatus 300 according to an embodiment of the invention. The medical apparatus comprises a magnetic resonance imaging system 301. The magnetic resonance imaging system comprises a cylindrical magnet 302. The magnet 302 has a bore 304 through it. The magnet 302 shown in Fig. 3 is a cylindrical type superconducting magnet. The magnet has a liquid helium cooled cryostat with superconducting coils. It is also possible to use permanent or resistive magnets. The use of different types of magnets is also possible for instance it is also possible to use both a split cylindrical magnet and a so called open magnet. A split cylindrical magnet is similar to a standard cylindrical magnet, except that the cryostat has been split into two sections to allow access to the iso-plane of the magnet, such magnets may for instance be used in conjunction with charged particle beam therapy. An open magnet has two magnet sections, one above the other with a space in- between that is large enough to receive a subject: the arrangement of the two sections area similar to that of a Helmholtz coil. Open magnets are popular, because the subject is less confined. Inside the cryostat of the cylindrical magnet there is a collection of </p><p id="p0163" num="0163">superconducting coils. Within the bore 304 of the cylindrical magnet there is an imaging zone 310 where the magnetic field is strong and uniform enough to perform magnetic resonance imaging. </p><p id="p0164" num="0164"> Inside the bore 304 is a set of magnetic field gradient coils 306. Within the bore 304 of the magnet there are magnetic field gradient coils 306 which is used for acquisition of magnetic resonance data to spatially encode magnetic spins within an imaging zone of the magnet. The magnetic field gradient coils are connected to a magnetic field gradient coil power supply 308. The magnetic field gradient coil 306 is intended to be representative. Typically magnetic field gradient coils 306 contain three separate sets of coils for spatially encoding in three orthogonal spatial directions. A magnetic field gradient power 
<!-- EPO <DP n="27"/>-->
 supply 308 supplies current to the magnetic field gradient coils 306. The current supplied to the magnetic field coils 306 is controlled as a function of time and may be ramped or pulsed. </p><p id="p0165" num="0165"> A portion of a subject 312 is within the imaging zone 310. The subject 312 is reposing on a subject support 314. Adjacent to the imaging zone 310 is a radio-frequency coil 316. Adjacent to the imaging zone 310 is a radio frequency radio -frequency coil 316 for manipulating the orientations of magnetic spins within the imaging zone 310 and for receiving radio transmissions from spins also within the imaging zone 310. The radio- frequency coil 316 may contain multiple coil elements. The radio -frequency coil may also be referred to as a channel or as a radio-frequency antenna. The radio frequency coil is connected to a radio frequency transceiver 318. The radio frequency coil 316 and radio frequency transceiver 318 may be replaced by separate transmit and receive coils and a separate transmitter and receiver. It is understood that the radio frequency coil 316 and the radio frequency transceiver 318 are simply representative. The radio-frequency coil 316 is intended to also represent a dedicated transmit antenna and a dedicated receive antenna. Likewise the transceiver may also represent a separate transmitter and receivers. </p><p id="p0166" num="0166"> The transceiver 318 and the magnetic field gradient coil power supply 308 are connected to a hardware interface 322 of a computer system 320. The hardware interface 322 is further connected to a processor 324. The processor 324 is also connected to a user interface 326, computer storage 328, and computer memory 330. </p><p id="p0167" num="0167"> The computer storage 328 is shown as containing baseline magnetic resonance data 332. The computer storage 328 is further shown as containing a first image 334 reconstructed from the baseline magnetic resonance data 332. The computer storage 328 is shown as further containing under-sampled magnetic resonance data 336. The computer storage 328 is further shown as containing a second image 338 which has been reconstructed from the under-sampled magnetic resonance data 336 and the first image 334. The computer storage 328 is shown as further containing a thermal map 340 reconstructed from the second image 338 and possibly also reconstructed at least partially using the first image 334. The computer storage 328 is shown as further containing a pulse sequence 342. The pulse sequence 342 contains commands and timing relationships which may be used by the processor 324 to control the operation of the magnetic resonance imaging system 301 for acquiring the baseline magnetic resonance data 332 and the under-sampled magnetic resonance data 336. The computer memory 330 is shown as containing a control module 350. The control module 350 contains computer executable code which allows the processor 324 to control the operation and function of the medical apparatus 300. 
<!-- EPO <DP n="28"/>-->
 The computer memory 330 is shown as further containing a reconstruction module 352. The reconstruction module contains computer executable code for </p><p id="p0168" num="0168">reconstructing the baseline magnetic resonance data 332 into the first image 334. The computer memory 330 is shown as further containing an under-sampled reconstruction module 354. The under-sampled reconstruction module 354contains executable code which uses the under-sampled magnetic resonance data 336 and the first image 334 to reconstruct the second image 338. In some embodiments the under-sampled reconstruction module 354 comprises computer executable instructions for implementing an image ratio constrained reconstruction algorithm. In some other embodiments the under-sampled reconstruction module 354 comprises computer executable instructions for implementing a compressed sensing reconstruction algorithm. </p><p id="p0169" num="0169"> The computer memory 330 is shown as further containing a thermal mapping module 356 which contains computer executable code which is used for constructing or calculating the thermal map 340 using the second image 338 and also possibly the first image 334. </p><p id="p0170" num="0170"> Fig. 4 illustrates a medical apparatus 400 according to a further embodiment of the invention. The embodiment shown in Fig. 4 comprises a temperature treatment system which is a high-intensity focused ultrasound system 402. The high-intensity focused ultrasound system comprises a fluid-filled chamber 404. Within the fluid-filled chamber 404 is an ultrasound transducer 406. Although it is not shown in this Fig. the ultrasound transducer 406 may comprise multiple ultrasound transducer elements each capable of generating an individual beam of ultrasound. This may be used to steer the location of a sonication point 418 electronically by controlling the phase and/or amplitude of alternating electrical current supplied to each of the ultrasound transducer elements. </p><p id="p0171" num="0171"> The ultrasound transducer 406 is connected to a mechanism 408 which allows the ultrasound transducer 406 to be repositioned mechanically. The mechanism 408 is connected to a mechanical actuator 410 which is adapted for actuating the mechanism 408. The mechanical actuator 410 also represents a power supply for supplying electrical power to the ultrasound transducer 406. In some embodiments the power supply may control the phase and/or amplitude of electrical power to individual ultrasound transducer elements. In some embodiments the mechanical actuator/power supply 410 is located outside of the bore 304 of the magnet 302. </p><p id="p0172" num="0172"> The ultrasound transducer 406 generates ultrasound which is shown as following the path 412. The ultrasound 412 goes through the fluid-filled chamber 408 and 
<!-- EPO <DP n="29"/>-->
 through an ultrasound window 414. In this embodiment the ultrasound then passes through a gel pad 416. The gel pad is not necessarily present in all embodiments but in this </p><p id="p0173" num="0173">embodiment there is a recess in the subject support 314 for receiving a gel pad 416. The gel pad 416 helps couple ultrasonic power between the transducer 406 and the subject 312. After passing through the gel pad 416 the ultrasound 412 passes through the subject 312 and is focused to a sonication point 418. The sonication point 418 is being focused within a target zone 420. The sonication point 418 may be moved through a combination of mechanically positioning the ultrasonic transducer 406 and electronically steering the position of the sonication point 418 to treat the entire target zone 420. </p><p id="p0174" num="0174"> The high- intensity focused ultrasound system 402 is shown as being also connected to the hardware interference 322 of the computer system 320. The computer system 320 and the contents of its storage 328 and memory 330 are equivalent to that as shown in Fig. 3. </p><p id="p0175" num="0175"> The computer storage 328 is shown as containing a treatment plan 444. The treatment plan 444 contains a description and/or instructions for treating the target zone 420 by the temperature treatment system 402. The treatment plan 444 may in some embodiments contain anatomical data which allows the processor 344 to register the target zone 420 to magnetic resonance images generated by the magnetic resonance imaging system 301. The computer storage 328 is shown as further containing k-space sample points. The computer storage 328 is shown as further containing temperature treatment system commands 448. The temperature treatment system commands when sent by the processor 324 to the high-intensity focused ultrasound system 402 causes it to sonicate the sonication zone 418 and also move the sonication point around the target zone 420. </p><p id="p0176" num="0176"> The computer memory 330 is shown as containing a pulse sequence generation module and a k-space selection module 458. The k-space selection module 458 is adapted and contains computer executable code for selecting the k-space sample points 446. The k-space sample points are selected such that the target zone 420 is well represented and reconstructed by those k-space sample points. The pulse sequence generation module 456 is adapted for using the k-space sample points for generating the pulse sequences 342. The computer memory 330 is shown as further containing a temperature treatment system control module 460. The temperature treatment system control module 460 is adapted for generating the temperature treatment system commands 448. The temperature treatment system commands 448 may be generated using the treatment plan 448 and/or the thermal map 340. 
<!-- EPO <DP n="30"/>-->
 Fig. 5 shows a medical apparatus 500 according to a further embodiment of the invention. The embodiment shown in Fig. 5 is similar to that shown in Figs. 3 and 4. The computer system 320 of Fig. 5 is equivalent to the computer system 320 shown in Figs. 3 and 4 also. The contents of the computer storage 328 and the computer memory 330 are also equivalent to the computer storage 328 and the computer memory 330 as shown in Figs. 3 and 4. In the embodiment shown in Fig. 5 a radio-frequency tissue heating system 501 is used as the temperature treatment system. The radio-frequency temperature treatment system 501 comprises an antenna 502 and a radio -frequency transmitter 504. The antenna 502 is in the vicinity of target zone 420. Radio-frequency energy generated by the transmitter 504 and radiated by the antenna 502 is used to selectively heat the target zone 420. In this </p><p id="p0177" num="0177">embodiment the radio-frequency transmitter 504 is shown as being connected to the hardware interface 322. The processor 324 and the contents of the computer storage 328 and the computer memory 330 are used to control the radio-frequency transmitter 504 in a manner equivalent to the way the high- intensity focused ultrasound system 402 of Fig. 4 is controlled by the processor 324. </p><p id="p0178" num="0178"> Fig. 6 shows a medical apparatus 600 according to a further embodiment of the invention. In this embodiment a thermal treatment system 601 is shown. There is an applicator 602 which has been inserted into the subject 312. Near the tip of the applicator 602 is the treatment zone 420. The thermal treatment system 602 here is representative and may be either a microwave applicator, a cryo-ablator, or a laser. The applicator 602 may be adapted for supplying microwave energy for delivering a cryogenic substance to the subject 312 or may be adapted for focusing laser light into the target zone 420. Likewise the supply system 604 may be a microwave power supply, a supply system with a cryogenic or cooling fluid, or it may be a laser power supply. The thermal treatment system 601 is shown as being connected to the hardware interface 322 of the computer system 330. The contents of the computer storage 328 and the computer memory 330 are equivalent to the embodiments shown in Figs. 3, 4 and 5. The instructions and computer code contained therein allow the processor 324 to control the thermal treatment system 601 in a manner equivalent to the embodiments shown in Figs. 4 and 5. </p><p id="p0179" num="0179"> Fig. 7 shows two plots 700, 702 which illustrate the effectiveness of the method. In the experiments shown in Fig. 7 a high-intensity focused ultrasound system was used to heat a target zone or region of interest of a pig. The temperature of the target zone or region of interest was imaged in a series of slices of magnetic resonance imaging data. Plot 700 shows data from slice 2 and plot 702 shows data from slice 4. The x-axis of both plots 
<!-- EPO <DP n="31"/>-->
 700, 702, is the time in seconds 704. On the y-axis the temperature 706 in degrees Celsius above normal body temperature is shown. The temperature 706 in both plots 700, 702 is an average over the entire region of interest within that slice. Data was acquired using three different methods. Data acquired using the full k- space is labeled 708 in both plots. Data labeled 710 which used a reconstruction algorithm based on an IRCR method is labeled 710 in both plots. Data acquired using a keyhole algorithm for reconstructing the second image is labeled 712 in both images. Examining both slice 2 700 and slice 4 702, we see that the IRCR method 710 performs extremely well in comparison to acquiring the full k-space data 708. </p><p id="p0180" num="0180"> In the example shown in Fig 7, the temperature at the heated region or target zone was used to compare an IRCR method and key hole method. Only single channel data were available in this example. Full k-space data acquired at t=0, and 1 were used as baseline data. The net acceleration factor was 10. </p><p id="p0181" num="0181"> While the invention has been illustrated and described in detail in the drawings and foregoing description, such illustration and description are to be considered illustrative or exemplary and not restrictive; the invention is not limited to the disclosed embodiments. </p><p id="p0182" num="0182"> Other variations to the disclosed embodiments can be understood and effected by those skilled in the art in practicing the claimed invention, from a study of the drawings, the disclosure, and the appended claims. In the claims, the word "comprising" does not exclude other elements or steps, and the indefinite article "a" or "an" does not exclude a plurality. A single processor or other unit may fulfill the functions of several items recited in the claims. The mere fact that certain measures are recited in mutually different dependent claims does not indicate that a combination of these measured cannot be used to advantage. A computer program may be stored/distributed on a suitable medium, such as an optical storage medium or a solid-state medium supplied together with or as part of other hardware, but may also be distributed in other forms, such as via the Internet or other wired or wireless telecommunication systems. Any reference signs in the claims should not be construed as limiting the scope. 
<!-- EPO <DP n="32"/>-->
 LIST OF REFERENCE NUMERALS </p><p id="p0183" num="0183"> 300 medical apparatus </p><p id="p0184" num="0184"> 301 magnetic resonance imaging system</p><p id="p0185" num="0185">302 magnet </p><p id="p0186" num="0186"> 304 bore of magnet </p><p id="p0187" num="0187"> 306 magnetic field gradient coils </p><p id="p0188" num="0188"> 308 magnetic field gradient coil power supply</p><p id="p0189" num="0189">310 imaging zone </p><p id="p0190" num="0190"> 312 subject </p><p id="p0191" num="0191"> 314 subject support </p><p id="p0192" num="0192"> 316 radio-frequency coil </p><p id="p0193" num="0193"> 318 transceiver </p><p id="p0194" num="0194"> 320 computer system </p><p id="p0195" num="0195"> 322 hardware interface </p><p id="p0196" num="0196"> 324 processor </p><p id="p0197" num="0197"> 326 user interface </p><p id="p0198" num="0198"> 328 computer storage </p><p id="p0199" num="0199"> 330 computer memory </p><p id="p0200" num="0200"> 332 baseline magnetic resonance data</p><p id="p0201" num="0201">334 first image </p><p id="p0202" num="0202"> 336 undersampled magnetic resonance data</p><p id="p0203" num="0203">338 second image </p><p id="p0204" num="0204"> 340 thermal map </p><p id="p0205" num="0205"> 342 pulse sequence </p><p id="p0206" num="0206"> 350 control module </p><p id="p0207" num="0207"> 352 reconstruction module </p><p id="p0208" num="0208"> 354 undersampled reconstruction module</p><p id="p0209" num="0209">356 thermal mapping module </p><p id="p0210" num="0210"> 400 medical apparatus </p><p id="p0211" num="0211"> 402 high intensity focused ultrasound system</p><p id="p0212" num="0212">404 fluid filled chamber </p><p id="p0213" num="0213"> 406 ultrasound transducer </p><p id="p0214" num="0214"> 408 mechanism </p><p id="p0215" num="0215"> 410 mechanical actuator/power supply 
<!-- EPO <DP n="33"/>-->
412 path of ultrasound </p><p id="p0216" num="0216"> 414 ultrasound window </p><p id="p0217" num="0217"> 416 gel pad </p><p id="p0218" num="0218"> 418 sonication po int </p><p id="p0219" num="0219"> 420 target zone </p><p id="p0220" num="0220"> 444 treatment plan </p><p id="p0221" num="0221"> 446 k-space sample points </p><p id="p0222" num="0222"> 448 temperature treatment system commands </p><p id="p0223" num="0223"> 456 pulse sequence generation module </p><p id="p0224" num="0224"> 458 k-space selection module </p><p id="p0225" num="0225"> 460 temperature treatment system control module</p><p id="p0226" num="0226">500 medical apparatus </p><p id="p0227" num="0227"> 501 radio-frequency tissue heating system </p><p id="p0228" num="0228"> 502 antenna </p><p id="p0229" num="0229"> 504 radio-frequency transmitter </p><p id="p0230" num="0230"> 600 medical apparatus </p><p id="p0231" num="0231"> 601 thermal treatment system </p><p id="p0232" num="0232"> 602 applicator </p><p id="p0233" num="0233">604 supply system </p><p id="p0234" num="0234">700 slice 2 </p><p id="p0235" num="0235"> 702 slice 4 </p><p id="p0236" num="0236"> 704 time in seconds </p><p id="p0237" num="0237"> 706 temperature in degrees Celsius above normal pig body temperature </p><p id="p0238" num="0238"> 708 data acquired using full k-space sampling </p><p id="p0239" num="0239"> 710 second image reconstructed using IRCR algorithm</p><p id="p0240" num="0240">712 second image reconstructed using keyhole algorithm 
</p></description><claims mxw-id="PCLM44852156" ref-ucid="WO-2012117303-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="34"/>--> CLAIMS: </claim-statement><claim id="clm-0001" num="1"><claim-text>1. A medical apparatus (300, 400, 500, 600) comprising: </claim-text><claim-text> a magnetic resonance imaging system (301) for acquiring magnetic resonance data; </claim-text><claim-text> a processor (324) for controlling the medical apparatus; and </claim-text><claim-text> a memory (330) containing machine readable instructions (350, 352, 354, 456,</claim-text><claim-text>458, 460) for execution by the processor, wherein execution of the instructions cause the processor to: </claim-text><claim-text> - acquire (102, 202) baseline magnetic resonance data (332); </claim-text><claim-text> - reconstruct (104, 204) a first image (334) using the baseline magnetic resonance data; </claim-text><claim-text> - acquire (106, 212) undersampled magnetic resonance data (336), wherein the undersampled magnetic resonance data is undersampled in k-space in comparison to the baseline magnetic resonance data; </claim-text><claim-text> - reconstruct (108, 214) a second image (338) using the undersampled magnetic resonance data and the first image, wherein the second image is reconstructed using an image ratio constrained reconstruction algorithm (354); and </claim-text><claim-text> - calculate (110, 216) a temperature map (340) using the second image. </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. The medical apparatus of claim 1, wherein the medical apparatus further comprises a temperature treatment system (402, 501, 601) for treating a target volume (420) of a subject, wherein execution of the instructions further causes the processor to treat (220) the target volume during acquisition of the undersampled magnetic resonance data. </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. The medical apparatus of claim 2, wherein execution of the instructions further causes the processor to select (206) k-space sample points (446) for the acquisition of the undersampled magnetic resonance data in accordance with the location of the target volume. <!-- EPO <DP n="35"/>--> </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. The medical apparatus of claim 2 or 3, wherein execution of the instructions further cause the processor to repeatedly: </claim-text><claim-text> acquire (212) the undersampled magnetic resonance data; </claim-text><claim-text> reconstruct (214) the second image using the undersampled magnetic resonance data and the first image; </claim-text><claim-text> calculate (216) the temperature map using the second image; </claim-text><claim-text> generate (218) temperature treatment system commands in accordance with the temperature map. </claim-text><claim-text> send (220) the temperature treatment system commands to the temperature treatment system. </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. The medical apparatus of claim 2, 3, or 4, wherein the temperature treatment system is any one of the following: a high intensity focused ultrasound system (402), a radio- frequency tissue treating system (501), microwave applicator (304), a cryo-ablator (304), and a laser (304). </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. The medical apparatus of any one of claims 2 through 5, wherein the location of the target volume is used in a constraint during reconstruction of the second image. </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. The medical apparatus of any one of the preceding claims, wherein the first image is a phase image, and wherein the second image is a phase image, wherein the thermal map is calculated by determining a phase shift between voxels of the first image and voxels the second image. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. The medical apparatus of any one of claims 1 though 10, wherein the first image and the second image are used to construct the thermal map by calculating a change in any one of the following: the proton density, the Tl relaxation time of water protons, the T2 relaxation time of water protons, the T2-star relaxation time of water protons, and the change of a diffusion constant. </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. The medical apparatus of any one of the preceding claims, whrein image ratio constrained reconstruction algorithm comprises a constraint, wherein the constraing is calculated on any one of the following: a magnitude image, a phase image, a complex image, and combinations thereof. <!-- EPO <DP n="36"/>--> </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. The medical apparatus of any one of the preceding claims, where the baseline magnetic resonance data and the undersampled magnetic resonance data is acquired and/or reconstructed using a parallel imaging technique. </claim-text></claim><claim id="clm-0011" num="11"><claim-text>11. The medical apparatus of any one of the preceding claims, where the baseline magnetic resonance data and the undersampled magnetic resonance data is acquired using a two-dimensional or a three-dimensional gradient echo pulse sequence. </claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. The medical apparatus of any one of claims 1 though 14, wherein the baseline magnetic resonance data and the undersampled magnetic resonance data is acquired with a two-dimensional or a three-dimensional gradient echo EPI pulse sequence, wherein k-space sample points for the acquisition of the undersampled magnetic resonance data and the baseline magnetic resonance data are chosen such that the first image and the second image are acquired using similar echo times. </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. The medical apparatus of any one of claims 1 though 13, where the baseline magnetic resonance data and the undersampled magnetic resonance data are acquired using a two-dimensional or a three-dimensional spin echo or turbo spin echo pulse sequence. </claim-text></claim><claim id="clm-0014" num="14"><claim-text>14. A method of operating a medical apparatus (300, 400, 500, 600), wherein the medical apparatus comprises a magnetic resonance imaging system (301) for acquiring magnetic resonance data; wherein the method comprises the steps of: </claim-text><claim-text> acquiring (102, 202) baseline magnetic resonance data (332); </claim-text><claim-text>- reconstructing (104, 204) a first image (334) using the baseline magnetic resonance data; </claim-text><claim-text> acquiring (106, 212) undersampled magnetic resonance data (336), wherein the undersampled magnetic resonance data is undersampled in k-space in comparison to the baseline magnetic resonance data; </claim-text><claim-text>- reconstructing (108, 214) a second image (338) using the undersampled magnetic resonance data and the first image, wherein the second image is reconstructed using an image ratio constrained reconstruction algorithm; and </claim-text><claim-text> calculating (110, 216) a temperature map (340) using the second image. <!-- EPO <DP n="37"/>--> </claim-text></claim><claim id="clm-0015" num="15"><claim-text>15. A computer program product comprising machine executable instructions</claim-text><claim-text>(350, 352, 354, 456, 458, 460) for execution by a processor (324) of a medical apparatus (300, 400, 500, 600); wherein the medical apparatus comprises a magnetic resonance imaging system (301) for acquiring magnetic resonance data; wherein execution of the instructions causes the processor to: </claim-text><claim-text> acquire (102, 202) baseline magnetic resonance data (332); </claim-text><claim-text> reconstruct (104, 204) a first image (334) using the baseline magnetic resonance data; </claim-text><claim-text> acquire (106, 212) undersampled magnetic resonance data (336), wherein the undersampled magnetic resonance data is undersampled in k-space in comparison to the baseline magnetic resonance data; </claim-text><claim-text> reconstruct (108, 214) a second image (338) using the undersampled magnetic resonance data and the first image, wherein the second image is reconstructed using an image ratio constrained reconstruction algorithm (354); and </claim-text><claim-text>- calculate (110, 216) a temperature map using the second image. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
