<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2683120-A1" country="EP" doc-number="2683120" kind="A1" date="20140108" family-id="46798066" file-reference-id="311174" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146585129" ucid="EP-2683120-A1"><document-id><country>EP</country><doc-number>2683120</doc-number><kind>A1</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12754502-A" is-representative="YES"><document-id mxw-id="PAPP154847321" load-source="docdb" format="epo"><country>EP</country><doc-number>12754502</doc-number><kind>A</kind><date>20120301</date><lang>JA</lang></document-id><document-id mxw-id="PAPP179320862" load-source="docdb" format="original"><country>EP</country><doc-number>12754502.8</doc-number><date>20120301</date><lang>JA</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140547793" ucid="JP-2011048129-A" load-source="docdb"><document-id format="epo"><country>JP</country><doc-number>2011048129</doc-number><kind>A</kind><date>20110304</date></document-id></priority-claim><priority-claim mxw-id="PPC140551974" ucid="JP-2012055221-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>JP</country><doc-number>2012055221</doc-number><kind>W</kind><date>20120301</date></document-id></priority-claim></priority-claims><technical-data><classification-ipc><edition>7</edition><main-classification>H04L  12/56</main-classification></classification-ipc><classifications-ipcr><classification-ipcr mxw-id="PCL2105175658" load-source="docdb">H04L  12/18        20060101ALI20140805BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL2105176985" load-source="docdb">H04L  12/46        20060101AFI20140805BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL2105179015" load-source="docdb">H04L  12/801       20130101ALI20140805BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL2105181875" load-source="docdb">H04L  12/761       20130101ALI20140805BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL2105182129" load-source="docdb">H04L  12/931       20130101ALI20140805BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1994220411" load-source="docdb" scheme="CPC">H04L  47/10        20130101 FI20151203BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2038165049" load-source="docdb" scheme="CPC">H04L  49/35        20130101 LI20150713BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2038166379" load-source="docdb" scheme="CPC">H04L  12/4641      20130101 LA20150713BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2038167306" load-source="docdb" scheme="CPC">H04L  12/462       20130101 LI20150713BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2038170349" load-source="docdb" scheme="CPC">H04L  12/4625      20130101 LA20150713BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2038170564" load-source="docdb" scheme="CPC">H04L  12/1886      20130101 LI20150713BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2038174853" load-source="docdb" scheme="CPC">H04L  45/16        20130101 LI20150713BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132360020" lang="DE" load-source="patent-office">NETZWERKSYSTEM, PAKETVERARBEITUNGSVERFAHREN UND SPEICHERMEDIUM</invention-title><invention-title mxw-id="PT132360021" lang="EN" load-source="patent-office">NETWORK SYSTEM, PACKET PROCESSING METHOD, AND STORAGE MEDIUM</invention-title><invention-title mxw-id="PT132360022" lang="FR" load-source="patent-office">SYSTÈME DE RÉSEAU, PROCÉDÉ DE TRAITEMENT DE PAQUETS ET SUPPORT DE STOCKAGE</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR919507927" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>NEC CORP</last-name><address><country>JP</country></address></addressbook></applicant><applicant mxw-id="PPAR919514630" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>NEC CORPORATION</last-name></addressbook></applicant><applicant mxw-id="PPAR919006174" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Nec Corporation</last-name><iid>101193625</iid><address><street>7-1, Shiba 5-chome Minato-ku</street><city>Tokyo 108-8001</city><country>JP</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919509546" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>SUEMITSU MARIKO</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR919544370" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>SUEMITSU MARIKO</last-name></addressbook></inventor><inventor mxw-id="PPAR919013097" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>SUEMITSU MARIKO</last-name><address><street>c/o NEC Corporation 7-1 Shiba 5-chome Minato-ku</street><city>Tokyo 108-8001</city><country>JP</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR919015833" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Vossius &amp; Partner</last-name><iid>100751388</iid><address><street>Siebertstrasse 4</street><city>81675 München</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="JP-2012055221-W"><document-id><country>JP</country><doc-number>2012055221</doc-number><kind>W</kind><date>20120301</date><lang>JA</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012121098-A1"><document-id><country>WO</country><doc-number>2012121098</doc-number><kind>A1</kind><date>20120913</date><lang>JA</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS549908624" load-source="docdb">AL</country><country mxw-id="DS549745117" load-source="docdb">AT</country><country mxw-id="DS549908625" load-source="docdb">BE</country><country mxw-id="DS549816840" load-source="docdb">BG</country><country mxw-id="DS549818889" load-source="docdb">CH</country><country mxw-id="DS549744835" load-source="docdb">CY</country><country mxw-id="DS549745118" load-source="docdb">CZ</country><country mxw-id="DS549908626" load-source="docdb">DE</country><country mxw-id="DS549744836" load-source="docdb">DK</country><country mxw-id="DS549744845" load-source="docdb">EE</country><country mxw-id="DS549814969" load-source="docdb">ES</country><country mxw-id="DS549816841" load-source="docdb">FI</country><country mxw-id="DS549818894" load-source="docdb">FR</country><country mxw-id="DS549908627" load-source="docdb">GB</country><country mxw-id="DS549744846" load-source="docdb">GR</country><country mxw-id="DS549908628" load-source="docdb">HR</country><country mxw-id="DS549745119" load-source="docdb">HU</country><country mxw-id="DS549814978" load-source="docdb">IE</country><country mxw-id="DS549744847" load-source="docdb">IS</country><country mxw-id="DS549818895" load-source="docdb">IT</country><country mxw-id="DS549744848" load-source="docdb">LI</country><country mxw-id="DS549816846" load-source="docdb">LT</country><country mxw-id="DS549742802" load-source="docdb">LU</country><country mxw-id="DS549816847" load-source="docdb">LV</country><country mxw-id="DS549816848" load-source="docdb">MC</country><country mxw-id="DS549742803" load-source="docdb">MK</country><country mxw-id="DS549742804" load-source="docdb">MT</country><country mxw-id="DS549814979" load-source="docdb">NL</country><country mxw-id="DS549816366" load-source="docdb">NO</country><country mxw-id="DS549814980" load-source="docdb">PL</country><country mxw-id="DS549816849" load-source="docdb">PT</country><country mxw-id="DS549745120" load-source="docdb">RO</country><country mxw-id="DS549816854" load-source="docdb">RS</country><country mxw-id="DS549814981" load-source="docdb">SE</country><country mxw-id="DS549818896" load-source="docdb">SI</country><country mxw-id="DS549816367" load-source="docdb">SK</country><country mxw-id="DS549816368" load-source="docdb">SM</country><country mxw-id="DS549742809" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128673301" lang="EN" load-source="patent-office"><p id="pa01" num="0001">In an open flow network system, a packet to be subjected to multicast transmission is transmitted to a plurality of VLANs which are different. Specifically, a packet transfer processing unit determines, when receiving a packet, whether or not the packet is for the multicast transmission. In case of the multicast transmission, whether or not the packet has been completely transmitted to ports specified for destinations is checked. When not having completely transmitted, a packet header of a packet is rewritten, and the written packet is copied and transmitted to a destination port and a network processor (NP). Through the loop-back processing, whether or not the packet received from NP is for the multicast transmission is determined. In case of the multicast transmission, it is checked whether or not the packet has been completely transmitted to the ports specified for destination. When having not been completely transmitted, the packet is rewritten in the packet header and is copied and transmitted to the destination port and the NP. When having been completely transmitted, the packet is discarded and the processing is ended.<img id="iaf01" file="imgaf001.tif" wi="78" he="99" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128737452" lang="EN" source="EPO" load-source="docdb"><p>In an open flow network system, a packet to be subjected to multicast transmission is transmitted to a plurality of VLANs which are different. Specifically, a packet transfer processing unit determines, when receiving a packet, whether or not the packet is for the multicast transmission. In case of the multicast transmission, whether or not the packet has been completely transmitted to ports specified for destinations is checked. When not having completely transmitted, a packet header of a packet is rewritten, and the written packet is copied and transmitted to a destination port and a network processor (NP). Through the loop-back processing, whether or not the packet received from NP is for the multicast transmission is determined. In case of the multicast transmission, it is checked whether or not the packet has been completely transmitted to the ports specified for destination. When having not been completely transmitted, the packet is rewritten in the packet header and is copied and transmitted to the destination port and the NP. When having been completely transmitted, the packet is discarded and the processing is ended.</p></abstract><description mxw-id="PDES63959289" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><b>Technology Field</b></heading><p id="p0001" num="0001">The present invention relates to a network system, and more particularly to a packet processing method in a network system.</p><heading id="h0002"><b>Background Art</b></heading><p id="p0002" num="0002">As one of the control systems for the network system, a CU (C: control plane/U: user plane) separation type network system is proposed in which a node apparatus (user plane) is controlled from an external control unit (control plane).</p><p id="p0003" num="0003">As an example of the CU separation type network system, an open flow network system using the open flow (Openflow) technique is known which controls switches from a controller to carry out a route control of the network. The details of the open flow technique have been described in Non-Patent Literature 1. It should be noted that the opening flow network system is an example only.</p><heading id="h0003">(Explanation of open flow network system)</heading><p id="p0004" num="0004">In the open flow network system, a controller such as an OFC (Openflow Controller) controls the conducts of the switches by operating flow tables of switches such as OFSs (Openflow switches). The controller and the switch are connected with a secure channel.</p><p id="p0005" num="0005">The switch in the open flow network system forms an open flow network and is an edge switch or a core switch, which is under the control of the controller. A series of processing to the packet from the reception (inflow) of the packet in the edge switch on the input side to the transmission (outflow)<!-- EPO <DP n="2"> --> from the edge switch on the output side in the open flow network is called a flow.</p><p id="p0006" num="0006">The packet may be read as a frame. The packet and the frame are different only in data unit of protocol (PDU: Protocol Data Unit). The packet is a PDU of "TCP/IP" (Transmission Control Protocol/Internet Protocol). On the other hand, the frame is a PDU of the "Ethernet (registered trademark)".</p><p id="p0007" num="0007">The flow table is a table in which a flow entry is registered to define a predetermined operation (action) to be carried out to the packet (communication data) which matches a predetermined match condition (rule). That is, the flow table stores a set of the flow entries.</p><p id="p0008" num="0008">The rule of the flow entry is defined based on various combinations of all or part of a destination address, a source address, a destination port, and source port, which are contained in the header field of the packet for each protocol hierarchical layer, and is identifiable. It should be noted that it is supposed that the above-mentioned address contains a MAC address (Media Access Control Address) and IP address (Internet Protocol Address). Also, data in the input port (Ingress Port) in addition to the above data is usable for the rule of the flow entry. Also, as the rule of the flow entry, the one which has expressed a part (or all) of a value of the header field of the packet which shows a flow can be set in the formation of a normal expression and wildcard "*" and so on.</p><p id="p0009" num="0009">The action of the flow entry is an operation such as "output to specific port", "discard", and "rewrite a header". For example, if identification data of the output port (output port number and so on) is shown in the action of the flow entry, the switch<!-- EPO <DP n="3"> --> outputs the packet to the port corresponding to this. The packet is discarded if the identification data of the output port is not shown. Or, the switch rewrites the header of the packet based on header data if the header data is shown in the action of the flow entry.</p><p id="p0010" num="0010">The switch in the open flow network system executes the action of the flow entry to the packet group (packets) which match the rule of the flow entry.</p><heading id="h0004">(Multicast transmission in existing open flow network system)</heading><p id="p0011" num="0011">In the open flow network system, the multicast transmission of the packet is sometimes carried out as in the conventional network system.</p><p id="p0012" num="0012">The multicast transmission is a technique for transmitting the packet to a plurality of destinations by specifying one destination. By using the multicast transmission, the same data can be transmitted to a plurality of users in the network.</p><p id="p0013" num="0013">To realize the processing for the multicast transmission by the switch of the open flow network system, the header of the received packet is rewritten and the received packet must be outputted to each destination port.</p><p id="p0014" num="0014">However, because the switch can execute the conversion action of the packet only once, when multicast transmission can be carried out in the switch, there are constraints that it is possible to transmit to a single VLAN (virtual LAN) but it is not possible to transmit to a plurality of VLANs which are different from each other.</p><heading id="h0005"><b><u>Citation List</u></b></heading><p id="p0015" num="0015">[Non-Patent Literature 1] "Openflow switch Specification, Version 1.0.0", [online], the Internet<!-- EPO <DP n="4"> --> (URL: http: //www.openflowswitch.org/documents/ openflow-spec-v1.0.0.pdf)</p><heading id="h0006"><b>Summary of the Invention</b></heading><p id="p0016" num="0016">An object of the present invention is to provide a network system, in which a network processor is installed in a switch, and in which multicast transmission and multiaction can be realized by utilizing a loop-back function.</p><p id="p0017" num="0017">The network system according to the present invention includes: a packet transfer processing unit configured to process a reception packet based on a flow entry defining a rule and an action to uniformly control packets as a flow; and a loop-back processing unit configured to realize multicast transmission and multiaction in an open flow network by executing loop-back processing to a packet when receiving the packet from the packet transfer processing unit, and transmitting the loop-backed packet to the packet transfer processing unit.</p><p id="p0018" num="0018">A switch according to the present invention includes: a packet transfer processing section configured to process a reception packet based on a flow entry defining a rule and an action to uniformly control packets as a flow; and a loop-back processing section configured to realize multicast transmission and multiaction in an open flow network by executing loop-back processing to a packet when receiving the packet from the packet transfer processing unit, and transmitting the loop-backed packet to the packet transfer processing unit.</p><p id="p0019" num="0019">A packet processing method according to the present invention executed by a switch, includes: processing a reception packet based on a flow entry defining a rule and an action to uniformly control the packets as a flow; outputting a copy of the processed packet to an output destination for loop-back<!-- EPO <DP n="5"> --> processing; receiving a loop-backed packet; and handling the loop-backed packet as the reception packet again. Thus, the packet processing method according to the present invention is executed by the switch in the open flow network. The loop-back processing may be carried out in the switch or in an external device which is possible to communicate or cooperate with the switch.</p><p id="p0020" num="0020">A program according to the present invention is for making a computer execute the processing of the packet processing method. It should be noted that the program according to the present invention can be stored in a storing device or a recording medium.</p><p id="p0021" num="0021">Thus, the identical packet can be transmitted for a plurality VLANs which are different from each other in the open flow network system.</p><heading id="h0007"><b>Brief Description of the Drawings</b></heading><p id="p0022" num="0022"><ul><li><figref idrefs="f0001">FIG. 1</figref> is a diagram showing a configuration example of a network system according to the present invention;</li><li><figref idrefs="f0002">FIG. 2</figref> is a flow chart showing an operation of the multicast transmission in the present invention; and</li><li><figref idrefs="f0003">FIG. 3</figref> is a diagram showing a configuration example of a flow table in the present invention.</li></ul></p><heading id="h0008"><b>Description of Exemplary Embodiments</b></heading><p id="p0023" num="0023">The present invention deals with a CU separation type network system. In this case, an open flow network system as one of the CU separation type network systems will be described as an example. However, actually, the present invention is not limited to the open flow network system.</p><heading id="h0009">[Exemplary Embodiments]</heading><!-- EPO <DP n="6"> --><p id="p0024" num="0024">Exemplary embodiments of the present invention will be described below with reference to the attached drawings.</p><heading id="h0010">(Basic structure)</heading><p id="p0025" num="0025">As shown in <figref idrefs="f0001">FIG. 1</figref>, the network system according to the present invention contains a switch 1, multicast distribution server 100 and clients 200 (200-i, i = 1 to n: n is the number of clients).</p><p id="p0026" num="0026">The switch 1 is a switch in the open flow network system. That is, the switch 1 carries out processing on a reception packet according to a flow entry defining a rule and an action to uniformly control packets as a flow. Although not shown, the controller in the open flow network system can set the flow entry to the switch 1.</p><p id="p0027" num="0027">The multicast distribution server 100 is a server apparatus which transmits multicast packet.</p><p id="p0028" num="0028">Each of the clients 200 (200-i, i = 1 to n) is a terminal which receives multicast packet which is transmitted from the multicast distribution server 100. The clients 200 (200-i, i = 1 to n) are grouped according to protocols to be used and each of the groups has an identical destination address. In this case, each of the clients 200 (200-i, i = 1 to n) belongs to one of identical VLAN groups.</p><p id="p0029" num="0029">Therefore, the multicast distribution server 100 can transmit a packet to all of the clients 200 (200-i, i = 1 to n) by specifying one destination.</p><heading id="h0011">[Switch]</heading><p id="p0030" num="0030">The switch 1 is composed of a packet transfer processing section 10, a network processor (NP) 20 and a flow table 30.</p><p id="p0031" num="0031">The packet transfer processing section 10 has an open flow interface, receives a packet through the open flow interface and transmits the packet according to the storage contents of the flow table 30. That<!-- EPO <DP n="7"> --> is, the packet transfer processing section 10 is equivalent to the packet transfer processing unit. The open flow interface is a communication port to transmit and receive the packet based on the open flow protocol to and from a communication device outside the switch.</p><p id="p0032" num="0032">The network processor (NP) 20 has a loop-back interface and carries out loop-back processing to the packet transferred from the packet transfer processing section 10. That is, the network processor (NP) 20 is equivalent to a loop-back processing unit. The loop-back interface is a communication port to transmit and receive the packet to and from the packet transfer processing section 10. The network processor (NP) 20 replies the packet received through the loop-back interface from the packet transfer processing section 10 to the packet transfer processing section 10 just as it is.</p><p id="p0033" num="0033">The flow table 30 is a database (DB) which stores a flow table set by the controller of the open flow network system.</p><heading id="h0012">(Multicast distribution server and clients)</heading><p id="p0034" num="0034">The description of the multicast distribution server 100 and the clients 200 (200-i, i = 1 to n) are omitted because they are the same as in the conventional system.</p><heading id="h0013">(Multicast transmission processing)</heading><p id="p0035" num="0035">Next, an operation of the multicast transmission processing in the present invention will be described with reference to <figref idrefs="f0002">FIG. 2</figref>.</p><heading id="h0014">(1) Step S101</heading><p id="p0036" num="0036">The packet transfer processing section 10 of the switch 1 receives a packet through the open flow interface. It should be noted that the flow entry which matches the received packet is supposed to be already set to the flow table 30 of the switch 1.<!-- EPO <DP n="8"> --></p><heading id="h0015">(2) Step S102</heading><p id="p0037" num="0037">The packet transfer processing section 10 of the switch 1 determines whether or not the received packet is a packet for multicast transmission. The packet transfer processing section 10 of the switch 1 checks whether or not a destination address of the received packet is multicast address, and the packet transfer processing section 10 of the switch 1 determines that the received packet is for the multicast transmission when the destination address is the multicast address.</p><heading id="h0016">(3) Step S103</heading><p id="p0038" num="0038">The packet transfer processing section 10 of the switch 1 processes the packet according to the contents of the flow table 30 when the received packet is not for the the multicast transmission. That is, the packet transfer processing section 10 of the switch 1 carries out the packet processing in the usual open flow network system.</p><heading id="h0017">(4) Step S104</heading><p id="p0039" num="0039">When the received packet is for the multicast transmission, the packet transfer processing section 10 of the switch 1 checks whether or not all the packets are completed to be transmitted to ports specified for destinations. For example, when the received packet is for the multicast transmission, the packet transfer processing section 10 of the switch 1 generates a list of ports specified for destinations and checks whether or not there is a port not used for the transmission. For the details, the "confirmation procedure of completion of transmission to all the destination ports" is described later.</p><heading id="h0018">(5) Step S105</heading><p id="p0040" num="0040">When the packet has not been completely transmitted to all the ports specified for destinations, the packet transfer processing section<!-- EPO <DP n="9"> --> 10 of the switch 1 carries out a conversion action of the received packet according to an action of the flow entry matching an original received packet, to rewrite a packet header of the received packet. In this case, the header of the packet after the conversion action is supposed to have been converted into "VLAN ID" from the header of the packet before the conversion action. The "VLAN ID" is identification data to uniquely specify a VLAN group.</p><heading id="h0019">(6) Step S106</heading><p id="p0041" num="0041">The packet transfer processing section 10 of the switch 1 copies the packet subjected to the conversion action. That is, the packet transfer processing section 10 of the switch 1 copies the packet in which the packet header has been rewritten.</p><heading id="h0020">(7) Step S107</heading><p id="p0042" num="0042">The packet transfer processing section 10 of the switch 1 outputs (transmits) the packet subjected to the conversion action to a destination port. In this case, the packet transfer processing section 10 of the switch 1 outputs one of the packets after the copy, to the destination port. For example, after outputting the packet subjected to the conversion action to a destination port written in the head of the list of ports which are specified for destination, the packet transfer processing section 10 of the switch 1 deletes the destination port from the list of ports specified for destinations. Or, the packet transfer processing section 10 of the switch 1 records data indicating that a packet has been transmitted to the destination port, in the list of ports specified for destinations.</p><heading id="h0021">(8) Step S108</heading><p id="p0043" num="0043">The packet transfer processing section 10 of the switch 1 transmits the packet subjected to the conversion action, to the loop-back interface of the<!-- EPO <DP n="10"> --> network processor (NP) 20. For example, the packet transfer processing section 10 of the switch 1 transmits the packet subjected to the conversion action to a loop-back address. In this case, the packet transfer processing section 10 of the switch 1 transmits one of the packets obtained as a result of the copy, to the loop-back interface of the network processor (NP) 20. That is, when the destination address of the received packet is multicast address, the packet transfer processing section 10 of the switch 1 transmits to the loop-back interface of the network processor (NP) 20 in addition to the output port specified in the action.</p><heading id="h0022">(9) Step S109</heading><p id="p0044" num="0044">The network processor (NP) 20 returns the packet received through the loop-back interface to the packet transfer processing section 10.</p><heading id="h0023">(10) Step S110</heading><p id="p0045" num="0045">The packet transfer processing section 10 of the switch 1 receives the packet from the loop-back interface of the network processor (NP) 20. After that, the packet transfer processing section 10 of the switch 1 determines once again whether or not the received packet is a packet to be subjected to the multicast transmission (returns to step S102). At this time, the packet transfer processing section 10 of the switch 1 may automatically determine that the packet (loop-backed packet) received from the loop-back interface of the network processor (NP) 20 is a packet to be subjected to the multicast transmission.</p><heading id="h0024">(11) Step S111</heading><p id="p0046" num="0046">When the packet has been transmitted to all the ports specified for destinations, the packet transfer processing section 10 of the switch 1 discards the packet and the processing is ended.<!-- EPO <DP n="11"> --></p><p id="p0047" num="0047">Thus, the packets to be subjected to the multicast transmission can be transmitted to a plurality of different VLANs.</p><heading id="h0025">(Check procedure of whether the packet has been transmitted to all the destination ports)</heading><p id="p0048" num="0048">The flow entry as shown in <figref idrefs="f0003">FIG. 3</figref> is supposed to be previously registered on the flow table 30 of the switch 1. Also, it is supposed that the packet transfer processing section 10 of the switch 1 is provided with a counter to check the number of flow entries for transmitted packets.</p><p id="p0049" num="0049">The packet transfer processing section 10 of the switch 1 searches the flow table 30, and when the flow entries matching the destination address are searched, the packet transfer processing section 10 of the switch 1 determines that the packet has been transmitted to all the destination ports, when the counter value reaches the number of flow entries having the matching condition identical to that of the searched flow entry.</p><p id="p0050" num="0050">When the packet has not been transmitted to all the destination ports, the packet has been transmitted for the count value of the counter. Therefore, "VLAN ID" of the packet is rewritten based on the action of the flow entry of the flow entries having the matching condition which is located at a position shifted for the counter value of the counter, and the packet is copied and transmitted to the specified port and the loop-back interface of the network processor (NP). Then, the counter is counted up by one.</p><heading id="h0026">(Supplement)</heading><p id="p0051" num="0051">It should be noted that in case of not carrying out the multicast transmission but multiaction, the "port specified for destination" is read as the "specified action", and the "execution of<!-- EPO <DP n="12"> --> conversion action (rewrite of packet header of received packet)" and the "output to destination port" are read as the "execution of specified action" in the above-mentioned explanation. The "execution of conversion action (rewrite of packet header of received packet)" is not necessary. That is, until all the specified actions are executes, loop-back processing is carried out to execute the specified actions one by one.</p><heading id="h0027">(Other exemplary embodiments)</heading><p id="p0052" num="0052">The multicast transmission and multiaction can be realized by use of the loop-back interface of the switch 1, instead of the network processor (NP) 20 in <figref idrefs="f0001">FIG. 1</figref>. That is, the apparatus which is equivalent to the network processor (NP) 20 may exist outside the switch 1. For example, the network processor (NP) 20 may be a controller in the open flow network system.</p><p id="p0053" num="0053">Also, the switch 1 may be a switching system configured by combining a plurality of units, in addition to a simple switching unit. That is, the packet transfer processing section 10, the network processor (NP) 20 and the flow table 30 may not always exist in an identical switching unit, and they may be in physically independent units. For example, a switching system obtained by combining the "packet transfer processing unit" which is equivalent to the packet transfer processing section 10 and the "loop-back processing unit" which is equivalent to the network processor (NP) 20 may be used as the switch 1.</p><p id="p0054" num="0054">Moreover, although the packet is outputted to all the ports specified for destination in the above-mentioned explanation, it is possible to set a port in such a manner that the packet is not outputted to a predetermined port of the ports specified for destination. In this case, if there is the port set at the step S107 of <figref idrefs="f0002">FIG. 2</figref>, the copied packet may be<!-- EPO <DP n="13"> --> discarded without outputting it to the destination port. Thus, it is possible to limit the transmission destination on the switching unit side even in case of the multicast transmission. Also, in the same way, it is possible to limit a specific action even in case of the multiaction.</p><heading id="h0028">(Exemplification of the hardware)</heading><p id="p0055" num="0055">An example of a specific hardware configuration to realize the network system according to the present invention will be described below.</p><p id="p0056" num="0056">As an example of the switch 1, a network switch, a router, a proxy, a gateway, a firewall, a load balancer (a load distribution apparatus), a band control apparatus (packet shaper), a security monitoring and controlling equipment (SCADA: Supervisory Control And Data Acquisition), a gatekeeper, a base station, an access point (AP), a communication satellite (CS) and a computer having a plurality of communication ports are exemplified. It should be noted that the switch 1 may be expansion cards such as a network card or a virtual switch which is realized by a virtual machine (VM)) which built on a physical machine.</p><p id="p0057" num="0057">As an example of the multicast distribution server 100 and the clients 200 (200-i, i = 1 to n), computers such as a PC (personal computer), an appliance, a workstation, a mainframe, and a supercomputer. It should be noted that the client 200 (200-i, i = 1 to n) may be a portable phone, a smart phone, a smart book, an IP telephone, a car navigation system, a mobile-type game machine, a home-use game machine, a mobile-type music player, a handy terminal, a gadget (electronic equipment), an interactive TV, a digital tuner, a digital recorder, information home electronics (information home appliance), an OA (Office Automation) equipment, a storefront terminal<!-- EPO <DP n="14"> --> and a high level copy machine, a digital signage (electronic signboard) and so on. Also, the client 200 (200-i, i = 1 to n) may be installed in movement bodies such as a vehicle a ship, and an aircraft.</p><p id="p0058" num="0058">Each of the switch 1, the multicast distribution server 100 and the clients 200 (200-i, i = 1 to n) are realized by a processor which executes predetermined processing based on the program, a memory which stores the program and various types of data, and an interface which is used for the communication with the network.</p><p id="p0059" num="0059">As an example of the above-mentioned processor, a CPU (Central Processing Unit), a network processor (NP), a microprocessor, a microcontroller or a semiconductor integrated circuit (LSI: Large Scale Integration) which has a function of exclusive use are exemplified.</p><p id="p0060" num="0060">As an example of the above-mentioned memory, a semiconductor memory device such as a RAM (Random Access Memory), a ROM (Read Only Memory), EEPROM (Electrically Erasable and Programmable Read Only Memory) and a flash memory, an auxiliary storage such as a HDD(Hard Disk Drive) and an SSD (Solid State Drive), a removable disks such as a DVD (Digital Versatile Disk), a storage media of an SD memory card (Secure Digital memory card) and so on are exemplified. Also, it may be a buffer and a register. Or, it may be a storage unit using DAS (Direct Attached Storage), FC-SAN (Fibre Channel - Storage Area network), NAS (network Attached Storage), IP-SAN (IP - Storage Area network), and so on.</p><p id="p0061" num="0061">It should be noted that the above-mentioned processor and the above-mentioned memory may be unified. For example, in recent years, a microcomputer is produced as a 1-chip device. Therefore, there is a case that the 1-chip<!-- EPO <DP n="15"> --> microcomputer which is installed into the computer is composed of a processor and a memory.</p><p id="p0062" num="0062">As an example of the above-mentioned interface, a substrate (motherboard, and I/O board) and a semiconductor integrated circuit such as a chip, which correspond to the network communication, a network adapter such as a NIC (network Interface Card) and a similar extension card, a communication device such as an antenna, a communication port such as a connection mouth (connector) and so on are exemplified.</p><p id="p0063" num="0063">Also, as an example of the network, the Internet, a LAN (Local Area The network), a wireless LAN, a WAN (Wide Area The network), a backbone, a CATV line, a fixation telephone network, a mobile phone network, WiMAX (IEEE 802.16a), 3G (3rd Generation), a dedicated line (leased line), IrDA (Infrared Data Association), a Bluetooth (registered trademark), a serial communication line, a data bus and so on are exemplified.</p><p id="p0064" num="0064">As an example of the packet transfer processing section 10, the above-mentioned interface is exemplified. It should be noted that the packet transfer processing section 10 may be a combination of the above-mentioned processor and the above-mentioned interface.</p><p id="p0065" num="0065">As an example of the network processor (NP) 20, the above-mentioned processor is exemplified. It should be noted that the network processor (NP) 20 may be a combination of the above-mentioned processor and the above-mentioned interface.</p><p id="p0066" num="0066">As an example of the flow table 30, the above-mentioned memory is exemplified. It should be noted that the flow table 30 may be a combination of the above-mentioned processor and the above-mentioned memory.<!-- EPO <DP n="16"> --></p><p id="p0067" num="0067">Also, each of the packet transfer processing section 10, the network processor (NP) 20 and the flow table 30 may be computers which are independent from each other.</p><p id="p0068" num="0068">It should be noted that the component inside the switch 1 may be a module, a component, an exclusive use device and start-up (call) programs for them.</p><p id="p0069" num="0069">However, actually, the present invention is not limited to these examples.</p><heading id="h0029">&lt;Summary&gt;</heading><p id="p0070" num="0070">As mentioned above, the present invention relates to a technique for realizing multicast transmission and multiaction in the open flow network system.</p><p id="p0071" num="0071">The present invention is characterized in that a network processor is installed on the switch in the open flow network system, and the multicast transmission and the multiaction are realized by use of the loop-back function.</p><p id="p0072" num="0072">Also, in the present invention, the loop-back interface of the switch main body can be used as a substitution of the network processor.</p><p id="p0073" num="0073">In the present invention, when receiving the packet to be subjected to the multicast transmission, a conversion action is first carried out to the received packet, and the packet after the conversion action is copied.</p><p id="p0074" num="0074">The copied packet is transmitted to the loop-back interface of the network processor and one of destination ports to be used for the multicast transmission, and a response is returned from the loop-back interface of the network processor.</p><p id="p0075" num="0075">The conversion action is carried out again to the packet received from the loop-back interface of the network processor, and a copy of the packet after<!-- EPO <DP n="17"> --> the conversion action is generated and transmitted to the destination port and the loop-back interface of the network processor.</p><p id="p0076" num="0076">By repeating this, the packet having the same contents can be transmitted to a plurality of VLANs which are different from each other.</p><heading id="h0030">(Supplement)</heading><p id="p0077" num="0077">Part or whole of the above-mentioned exemplary embodiment can be mentioned in the following supplement. However, actually, the present invention is not limited to the following specific examples.</p><heading id="h0031">(Supplemental note 1)</heading><p id="p0078" num="0078">A switch includes:
<ul><li>a packet transfer processing section configured to process a reception packet according to a flow entry defining a rule and an action to uniformly control packets as a flow; and</li><li>a loop-back processing section configured to carry out loop-back processing to the received packet, when receiving the packet (the processed packet or the processed copy and so on) from the packet transfer processing section, transmit the packet to the packet transfer processing section, and realize the multicast transmission and multiaction in the open flow network.</li></ul></p><heading id="h0032">(Supplemental note 2)</heading><p id="p0079" num="0079">The switch according to supplemental note 1, wherein the packet transfer processing section includes:
<ul><li>a functional section configured to transmit the packet to the loop-back processing section when receiving the packet for the multicast transmission; and</li><li>a functional section configured to receive the packet returned from the loop-back processing section.</li></ul></p><heading id="h0033">(Supplemental note 3)</heading><!-- EPO <DP n="18"> --><p id="p0080" num="0080">The switch according to supplemental note 2, wherein the packet transfer processing section includes:
<ul><li>a functional section configured to check whether or not the received packet is a packet for the multicast transmission;</li><li>a functional section configured to execute a conversion action of the received packet according to the flow entry and rewrite a packet header of the reception packet when the reception packet is the packet for the multicast transmission;</li><li>a functional section configured to copy the packet in which the packet header is rewritten;</li><li>a functional section configured to output one of the packets to one of ports specified as a destination;</li><li>a functional part configured to transmit the other of the packets to the loop-back processing section;</li><li>a functional section configured to check whether or not the packet has been transmitted to all ports specified for destination when receiving the packet returned from the loop-back processing section;</li><li>a functional section configured to discard the packet when having been transmitted to all the ports specified for destination; and</li><li>a functional section configured to repeat the processing until the packet has been transmitted to all the ports specified for destination, when not having been transmitted to all the ports specified for destination.</li></ul></p><heading id="h0034">(Supplemental note 4)</heading><p id="p0081" num="0081">The switch according to any of supplemental notes 1 to 3, wherein the packet transfer processing section includes:<!-- EPO <DP n="19"> -->
<ul><li>a functional section configured to check whether or not the received packet is a packet for the multiaction;</li><li>a functional section configured to copy the received packet when the received packet is the packet for the multiaction;</li><li>a functional section configured to execute one of actions which are specified according to the flow entry for one of the packets;</li><li>a functional section configured to transmit the other of the packets to the loop-back processing section;</li><li>a functional section configured to check whether or not specified actions have been all executed when receiving the packet returned from the loop-back processing section;</li><li>a functional section configured to discard the packet when all the specified actions have been executed; and</li><li>a functional section configured to repeat the above-mentioned processing until all the specified actions have been executed when all the specified actions have not been executed.</li></ul></p><heading id="h0035">&lt;Remarks&gt;</heading><p id="p0082" num="0082">As described above, the exemplary embodiments of the present invention have been described in detail, but actually, the present invention is not limited to the above-mentioned exemplary embodiments. A modification in the range which does not deviate from the scope of the present invention is contained in the present invention.</p><p id="p0083" num="0083">It should be noted that the present application claims a priority based on Japanese Patent Application No. <patcit id="pcit0001" dnum="JP2011048129A"><text>JP 2011-048129</text></patcit>. The disclosure thereof is incorporated herein by reference.</p></description><claims mxw-id="PCLM56982322" lang="EN" load-source="patent-office"><!-- EPO <DP n="20"> --><claim id="c-en-0001" num="0001"><claim-text>A network system comprising:
<claim-text>a packet transfer processing unit configured to process a reception packet based on a flow entry defining a rule and a action to uniformly control packets as a flow; and</claim-text>
<claim-text>a loop-back processing unit configured to transmit a packet to said packet transfer processing unit when receiving the packet from said packet transfer processing unit.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The network system according to claim 1, wherein said packet transfer processing unit is configured to:
<claim-text>(a) check whether or not the reception packet is a packet for multicast transmission,</claim-text>
<claim-text>(b) execute a conversion action to the reception packet based on the flow entry, to rewrite a packet header of the reception packet, in case of the packet for the multicast transmission,</claim-text>
<claim-text>(c) copy the packet, output one of the packets to one of ports specified as for destinations, and transmit another of the packets to said loop-back processing unit,</claim-text>
<claim-text>(d) check whether or not the packet has been transmitted to all ports specified for destinations, when receiving the packet returned from said loop-back processing unit,</claim-text>
<claim-text>(e) discard the packet when having been transmitted to all the ports specified for destinations, and</claim-text>
repeat processing of said (a) to said (e) until the packet has been transmitted to all the ports specified for destinations, when having not been transmitted to all the ports specified for destinations.<!-- EPO <DP n="21"> --></claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The network system according to claim 1 or 2, wherein said packet transfer processing unit is configured to:
<claim-text>(f) check whether or not the reception packet is a packet for multiaction;</claim-text>
<claim-text>(g) copy the reception packet when the reception packet is for the multiaction,</claim-text>
<claim-text>(h) execute one of actions specified based on the flow entry to one of the copied packets,</claim-text>
<claim-text>(i) transmit another of the packets to said loop-back processing unit,</claim-text>
<claim-text>(j) check whether or not all the actions have been executed when receiving a packet returned from said loop-back processing unit,</claim-text>
<claim-text>(k) discard the packet when all the specified actions have been executed, and</claim-text>
repeat processing of said (f) to said (k) until all the specified actions have been executed, when all the specified actions have not been executed.</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>A switch comprising:
<claim-text>a packet transfer processing section configured to process a reception packet based on a flow entry defining a rule and an action to uniformly control packets as a flow; and</claim-text>
<claim-text>a loop-back processing section configured to transmit a packet to said packet transfer processing section when receiving the packet from said packet transfer processing section.</claim-text></claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>The switch according to claim 4, wherein said packet transfer processing section comprises:
<claim-text>(a) means for confirming whether or not the reception packet is for the multicast transmission;</claim-text>
<claim-text>(b) means for executing a conversion action of the reception packet based on the flow entry and<!-- EPO <DP n="22"> --> rewriting a packet header of the reception packet when the reception packet is for the multicast transmission;</claim-text>
<claim-text>(c) means for copying the packet in which the packet header is rewritten;</claim-text>
<claim-text>(d) means for outputting one of the packets to one of ports specified for destinations;</claim-text>
<claim-text>(e) means for transmitting the other of the packets to said loop-back processing section;</claim-text>
<claim-text>(f) means for checking whether or not the packet has been transmitted to all ports specified for destination when receiving the packet returned from said loop-back processing section;</claim-text>
<claim-text>(g) means for discarding the packet when having transmitted to all the ports specified for destination; and</claim-text>
means for repeating processing of said (a) to said (g) until the packet has been transmitted to all the ports specified for destination when not having transmitted to all the ports specified for destination.</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>The switch according to claim 4 or 5, wherein said packet transfer processing section comprises:
<claim-text>(h) means for checking whether or not the reception packet is for multiaction;</claim-text>
<claim-text>(i) means for copying the reception packet when the reception packet is for the multiaction;</claim-text>
<claim-text>(j) means for executing one of actions specified based on the flow entry for one of the packets;</claim-text>
<claim-text>(k) means for transmitting another of the packets to said loop-back processing section;</claim-text>
<claim-text>(l) means for checking whether or not all the specified actions have been executed when receiving<!-- EPO <DP n="23"> --> the packet returned from said loop-back processing section;</claim-text>
<claim-text>(m) means for discarding the packet when having executed all the specified actions; and</claim-text>
means for repeating processing until all the specified actions have been executed when not having executed all specified actions.</claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>A packet processing method executed by a switch, comprising:
<claim-text>processing a reception packet based on a flow entry defining a rule and an action to uniformly control packets as a flow;</claim-text>
<claim-text>outputting a copy of the processed packet to an output port for loop-back processing;</claim-text>
<claim-text>receiving the loop-backed packet; and</claim-text>
<claim-text>handling the loop-backed packet as the received packet again.</claim-text></claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>The packet processing method according to claim 7, further comprising:
<claim-text>(a) checking whether or not the reception packet is a packet for multicast transmission;</claim-text>
<claim-text>(b) executing a conversion action of the reception packet based on a flow entry to rewrite a packet header of the reception packet when the reception packet is for the multicast transmission;</claim-text>
<claim-text>(c) copying the packet in which the packet header is rewritten;</claim-text>
<claim-text>(d) outputting one of the copied packets to one of ports specified for destinations;</claim-text>
<claim-text>(e) outputting another of the copied packets to an output port for loop-back processing;</claim-text>
<claim-text>(f) checking whether or not the packet has been transmitted to all the ports specified for destinations, when receiving the loop-backed packet;<!-- EPO <DP n="24"> --></claim-text>
<claim-text>(g) discarding the packet when having transmitted to all the ports specified for destinations; and</claim-text>
repeating processing of said (a) to said (g) until the packet has been transmitted to all the ports specified for destinations when not having transmitted to all the ports specified for destinations.</claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>The packet processing method according to claim 7 or 8, further comprising:
<claim-text>(h) checking whether or not the reception packet is for multiaction;</claim-text>
<claim-text>(i) copying the reception packet when the reception packet is for the multiaction;</claim-text>
<claim-text>(j) executing one of actions specified based on the flow entry, to one of the copied packets;</claim-text>
<claim-text>(k) outputting another of the copied packets to an output port for loop-back processing;</claim-text>
<claim-text>(l) checking whether or not the packet has been transmitted to all the ports specified for destinations when receiving the loop-backed packet;</claim-text>
<claim-text>(m) discarding the packet when having been transmitted to all the ports specified for destinations; and</claim-text>
repeating processing of said (h) to said (m) until the packet has been transmitted to all the ports specified for destination when not having transmitted to all the ports specified for destination.</claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>A recording medium which stores a program for making a switch execute the packet processing method according to any of claims 7 to 9.</claim-text></claim></claims><drawings mxw-id="PDW16670703" load-source="patent-office"><!-- EPO <DP n="25"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="125" he="157" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="26"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="127" he="188" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="27"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="121" he="93" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="165" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
