<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2681881-A1" country="EP" doc-number="2681881" kind="A1" date="20140108" family-id="43971364" file-reference-id="315082" date-produced="20180823" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146586407" ucid="EP-2681881-A1"><document-id><country>EP</country><doc-number>2681881</doc-number><kind>A1</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12706082-A" is-representative="NO"><document-id mxw-id="PAPP154848599" load-source="docdb" format="epo"><country>EP</country><doc-number>12706082</doc-number><kind>A</kind><date>20120223</date><lang>EN</lang></document-id><document-id mxw-id="PAPP215267275" load-source="docdb" format="original"><country>EP</country><doc-number>12706082.0</doc-number><date>20120223</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140555450" ucid="EP-11250228-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>11250228</doc-number><kind>A</kind><date>20110228</date></document-id></priority-claim><priority-claim mxw-id="PPC140554180" ucid="EP-12706082-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>12706082</doc-number><kind>A</kind><date>20120223</date></document-id></priority-claim><priority-claim mxw-id="PPC140552197" ucid="GB-2012000188-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>GB</country><doc-number>2012000188</doc-number><kind>W</kind><date>20120223</date></document-id></priority-claim></priority-claims><technical-data><classification-ipc><edition>7</edition><main-classification>H04L  12/56</main-classification></classification-ipc><classifications-ipcr><classification-ipcr mxw-id="PCL1989318578" load-source="docdb">H04L  29/06        20060101ALI20120920BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1707479144" load-source="docdb" scheme="CPC">H04L  49/60        20130101 LA20180117BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1894802336" load-source="docdb" scheme="CPC">H04L  69/166       20130101 LI20160920BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1894802528" load-source="docdb" scheme="CPC">H04L  69/22        20130101 LI20160920BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1894802988" load-source="docdb" scheme="CPC">H04L  43/028       20130101 LI20160920BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1894805780" load-source="docdb" scheme="CPC">H04L  47/36        20130101 LI20160920BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989627075" load-source="docdb" scheme="CPC">H04L  49/25        20130101 FI20131205BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132363854" lang="DE" load-source="patent-office">GEWINNUNG VON INFORMATIONEN AUS DATENELEMENTEN</invention-title><invention-title mxw-id="PT132363855" lang="EN" load-source="patent-office">OBTAINING INFORMATION FROM DATA ITEMS</invention-title><invention-title mxw-id="PT132363856" lang="FR" load-source="patent-office">OBTENTION D'INFORMATIONS À PARTIR D'ÉLÉMENTS DE DONNÉES</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR919524204" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>BRITISH TELECOMM</last-name><address><country>GB</country></address></addressbook></applicant><applicant mxw-id="PPAR919516012" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>BRITISH TELECOMMUNICATIONS PUBLIC LIMITED COMPANY</last-name></addressbook></applicant><applicant mxw-id="PPAR919010484" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>British Telecommunications Public Limited Company</last-name><iid>101189794</iid><address><street>81 Newgate Street</street><city>London EC1A 7AJ</city><country>GB</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919510145" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>BRISCOE ROBERT JOHN</last-name><address><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR919527985" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>BRISCOE, ROBERT JOHN</last-name></addressbook></inventor><inventor mxw-id="PPAR919005763" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>BRISCOE, ROBERT JOHN</last-name><address><street>PP:C5A, 81 Newgate Street</street><city>London EC1A 7AJ</city><country>GB</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR919019406" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Geffen, Nigel Paul</last-name><iid>101344871</iid><address><street>British Telecommunications plc Intellectual Property Department, PP:C5A BT Centre 81 Newgate Street</street><city>London EC1A 7AJ</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="GB-2012000188-W"><document-id><country>GB</country><doc-number>2012000188</doc-number><kind>W</kind><date>20120223</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012117215-A1"><document-id><country>WO</country><doc-number>2012117215</doc-number><kind>A1</kind><date>20120907</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS549851775" load-source="docdb">AL</country><country mxw-id="DS549837901" load-source="docdb">AT</country><country mxw-id="DS549838328" load-source="docdb">BE</country><country mxw-id="DS549770539" load-source="docdb">BG</country><country mxw-id="DS549914727" load-source="docdb">CH</country><country mxw-id="DS549838329" load-source="docdb">CY</country><country mxw-id="DS549837914" load-source="docdb">CZ</country><country mxw-id="DS549851776" load-source="docdb">DE</country><country mxw-id="DS549838334" load-source="docdb">DK</country><country mxw-id="DS549838335" load-source="docdb">EE</country><country mxw-id="DS549760208" load-source="docdb">ES</country><country mxw-id="DS549770540" load-source="docdb">FI</country><country mxw-id="DS549914728" load-source="docdb">FR</country><country mxw-id="DS549851777" load-source="docdb">GB</country><country mxw-id="DS549838336" load-source="docdb">GR</country><country mxw-id="DS549851782" load-source="docdb">HR</country><country mxw-id="DS549837915" load-source="docdb">HU</country><country mxw-id="DS549914729" load-source="docdb">IE</country><country mxw-id="DS549838337" load-source="docdb">IS</country><country mxw-id="DS549770549" load-source="docdb">IT</country><country mxw-id="DS549838358" load-source="docdb">LI</country><country mxw-id="DS549770550" load-source="docdb">LT</country><country mxw-id="DS549838431" load-source="docdb">LU</country><country mxw-id="DS549770551" load-source="docdb">LV</country><country mxw-id="DS549770552" load-source="docdb">MC</country><country mxw-id="DS549838432" load-source="docdb">MK</country><country mxw-id="DS549838433" load-source="docdb">MT</country><country mxw-id="DS549760213" load-source="docdb">NL</country><country mxw-id="DS549760590" load-source="docdb">NO</country><country mxw-id="DS549760214" load-source="docdb">PL</country><country mxw-id="DS549770561" load-source="docdb">PT</country><country mxw-id="DS549837916" load-source="docdb">RO</country><country mxw-id="DS549770562" load-source="docdb">RS</country><country mxw-id="DS549760215" load-source="docdb">SE</country><country mxw-id="DS549914730" load-source="docdb">SI</country><country mxw-id="DS549760591" load-source="docdb">SK</country><country mxw-id="DS549760592" load-source="docdb">SM</country><country mxw-id="DS549838438" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA99835733" ref-ucid="WO-2012117215-A1" lang="EN" load-source="patent-office"><p num="0000">Methods and apparatus are disclosed for obtaining information from a predetermined portion of a header of a data item such as an IP packet transmitted via a communication network such as a packet network, the portion carrying a codepoint selected from a first set of codepoints each of which has a pre-defined meaning according to a first pre-defined communication protocol. The method comprises: receiving the data item (s71); inspecting the header whereby to determine the codepoint carried by the predetermined portion thereof (s72); identifying whether the codepoint is a member of a second set of codepoints (s77, s78), the second set comprising fewer possible codepoints than the first set; and in the event that the codepoint is identified as being a member of the second set, and in dependence on such an identification being made, interpreting that codepoint according to a different pre- defined communication protocol as having a different pre-defined meaning (s80).</p></abstract><abstract mxw-id="PA100331540" ref-ucid="WO-2012117215-A1" lang="EN" source="national office" load-source="docdb"><p>Methods and apparatus are disclosed for obtaining information from a predetermined portion of a header of a data item such as an IP packet transmitted via a communication network such as a packet network, the portion carrying a codepoint selected from a first set of codepoints each of which has a pre-defined meaning according to a first pre-defined communication protocol. The method comprises: receiving the data item (s71); inspecting the header whereby to determine the codepoint carried by the predetermined portion thereof (s72); identifying whether the codepoint is a member of a second set of codepoints (s77, s78), the second set comprising fewer possible codepoints than the first set; and in the event that the codepoint is identified as being a member of the second set, and in dependence on such an identification being made, interpreting that codepoint according to a different pre- defined communication protocol as having a different pre-defined meaning (s80).</p></abstract><abstract mxw-id="PA99835734" ref-ucid="WO-2012117215-A1" lang="FR" load-source="patent-office"><p num="0000">Les procédés et l'appareil ci-décrits permettent d'obtenir des informations à partir d'une partie préétablie de l'en-tête d'un élément de données tel qu'un paquet IP transmis par le biais d'un réseau de communication, par exemple un réseau à commutation de paquets, ladite partie contenant un point de code sélectionné dans un premier ensemble de points de code ayant chacun une signification prédéfinie selon un premier protocole de communication prédéfini. Ledit procédé comprend : la réception de l'élément de données (s71) ; l'examen de l'en-tête dans le but de déterminer quel est le point de code qui est contenu dans la partie préétablie dudit en-tête (s72) ; la réalisation d'une identification indiquant si le point de code appartient à un second ensemble de points de code (s77, s78), ce second ensemble comprenant moins de points de code possibles que le premier ensemble ; et, si l'identification indique que le point de code appartient au second ensemble, et dans le cas où cette identification est réalisée, à interpréter ce point de code selon un protocole de communication prédéfini différent pour lui donner une signification prédéfinie différente (s80).</p></abstract><abstract mxw-id="PA100331541" ref-ucid="WO-2012117215-A1" lang="FR" source="national office" load-source="docdb"><p>Les procédés et l'appareil ci-décrits permettent d'obtenir des informations à partir d'une partie préétablie de l'en-tête d'un élément de données tel qu'un paquet IP transmis par le biais d'un réseau de communication, par exemple un réseau à commutation de paquets, ladite partie contenant un point de code sélectionné dans un premier ensemble de points de code ayant chacun une signification prédéfinie selon un premier protocole de communication prédéfini. Ledit procédé comprend : la réception de l'élément de données (s71) ; l'examen de l'en-tête dans le but de déterminer quel est le point de code qui est contenu dans la partie préétablie dudit en-tête (s72) ; la réalisation d'une identification indiquant si le point de code appartient à un second ensemble de points de code (s77, s78), ce second ensemble comprenant moins de points de code possibles que le premier ensemble ; et, si l'identification indique que le point de code appartient au second ensemble, et dans le cas où cette identification est réalisée, à interpréter ce point de code selon un protocole de communication prédéfini différent pour lui donner une signification prédéfinie différente (s80).</p></abstract><description mxw-id="PDES51233067" ref-ucid="WO-2012117215-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="2"/>--><p id="p0001" num="0001"> OBTAINING INFORMATION FROM DATA ITEMS </p><p id="p0002" num="0002">Technical Field </p><p id="p0003" num="0003"> The present invention relates to obtaining information from data items transmitted via a communication network. More specifically, aspects of the present invention relate to methods and apparatus for obtaining information from a predetermined portion, such as a field, in the header of a data item such as an Internet Protocol packet transmitted via a communication network such as a packet network. </p><p id="p0004" num="0004">Background to the Invention and Prior Art </p><p id="p0005" num="0005"> We start by presenting some basic concepts to facilitate the understanding of the </p><p id="p0006" num="0006">mechanisms that are presented further on. </p><p id="p0007" num="0007">Packets </p><p id="p0008" num="0008"> A data sender usually splits data to be sent into small units known as packets. Each packet consists of a header and a payload carrying the data to be delivered. The header contains fields defined by the relevant communication protocol. The great majority of packets carried by commercial networks nowadays are so-called IP packets, where "IP" is the Internet Protocol. This ensures that a network of routers can forward any packet from the source to its destination. IP is a connectionless protocol - that means that the header information in each data packet is sufficiently self-contained for routers to deliver it independently of other packets; each packet could even take a different route to reach the destination. Packet Headers </p><p id="p0009" num="0009"> The Internet Protocol has evolved through a number of versions although only two are currently used: IPv4 and IPv6, the latter currently still having relatively low uptake. The layout and names of the fields of the IPv4 header are shown in Figure 1 , which has been based principally on Internet Engineering Task Force (IETF) "Request for Comments" (RFC) document IETF RFC 791 but also reflects more recent updates (IETF RFCs 2474, 3260 and 3168). IETF RFC 791 , entitled "Internet Protocol" was published in September 1981 , and is available on the internet at http://www.ietf.org/rfc/rfc791.txt . The other IETF RFC documents are also available on the internet via http://www.ietf.org/rfc.html or elsewhere. </p><p id="p0010" num="0010"> Referring to Figure 1 , the numbers along the top, above the six rows of field-names, index each bit of the header in rows of 32 bits, numbered "00" to "31 ". Three fields which will later be referred to in particular in relation to preferred embodiments of this invention are all on the 
<!-- EPO <DP n="3"/>-->
 second row, and relate to packet fragmentation, which will be discussed below. These fields are the 'Identification', 'Flags' and 'Fragment Offset' fields. </p><p id="p0011" num="0011"> Figure 2 shows the layout and names of the fields of the header of an IPv6 packet. An obvious difference is that IPv6 has larger fields for the source and destination addresses. Also it will be noted that no fields to do with fragmentation are present in the base IPv6 header. </p><p id="p0012" num="0012">Protocol Evolution </p><p id="p0013" num="0013"> From time to time, a new requirement has to be met, and can be achieved by updating part of a communications protocol, rather than completely replacing it. Most protocols are defined so that some values of various fields are not used, but are reserved for future use. The idea is that new features can be added by bringing values into use from these "reserved" ranges.</p><p id="p0014" num="0014">When reserved values are brought into use for a new variant of a protocol, there are often problems. Existing equipment built before the protocol was updated is usually meant to take some default action if it encounters a packet carrying one of these reserved values. </p><p id="p0015" num="0015">However, when a reserved value is first used, it is generally discovered that some legacy equipment does not take the specified default action, possibly for one of two reasons: </p><p id="p0016" num="0016"> Bugs: Many manufacturers cut corners and do not test whether their equipment acts correctly when it encounters packets carrying values not in common usage at the time of implementation; </p><p id="p0017" num="0017">Precautionary security: Many manufacturers deliberately do not set their equipment to implement the standard default action when it encounters a packet carrying a reserved value. Instead, on the basis that the appearance of a previously unused value might be a symptom of some unknown security attack, they set their equipment to discard the packet as a precaution. </p><p id="p0018" num="0018">Therefore, the first adopters of a new protocol typically discover that arbitrary equipment seems to crash inexplicably, or packets carrying new values never reach their destination because some item of equipment wrongly discards such packets (termed being black-holed). Such equipment will be referred to as a "non-compliant middlebox". </p><p id="p0019" num="0019"> The outcome is often that new features often fail to be deployed, or their introduction is delayed, because no company wants to bear the cost of all the support calls that will result when their (possibly) perfectly-implemented update is taken to be the cause of numerous problems that it triggers - problems that are actually due to other incorrectly implemented equipment that has already been deployed. 
<!-- EPO <DP n="4"/>-->
 Fragmentation </p><p id="p0020" num="0020"> The three fields referred to earlier as being of particular relevance to packet fragmentation are the 'Identification', 'Flags' and 'Fragment Offset' fields. The IPv4 'Flags' field consists of three bits (shown in Figure 3), only the second and third of which are currently used, the first being reserved (RES) for future use. The other two are termed 'Don't Fragment' (DF) and 'More Fragments' (MF). Further information about this is available in IETF RFC 791 , referred to earlier. </p><p id="p0021" num="0021"> The sender of every IPv4 packet must label each packet using the 16-bit 'Identification' field. A source should cycle through the whole of the possible number space that could be written in the 'Identification' field before repeating a previously used identifier. There is no requirement to cycle through the numbers in any particular order, as long as all of the 2<sup>16</sup> available numbers are used before any are repeated. </p><p id="p0022" num="0022"> Each link in a network is characterised by a maximum size of packet it can transmit - referred to as the link's "maximum transmission unit" (MTU). If an IPv4 router needs to forward an arriving packet down a link that has an MTU smaller than the packet, the router may break the packet down into fragments. Equivalently, a source may break a packet down into fragments before sending it. </p><p id="p0023" num="0023"> The process of fragmentation involves breaking the original payload down into sufficiently small fragments that they will each fit into the link, and placing a copy of the original header on each fragment. Each header is then modified so that, once a set of fragments arrives at its destination, they contain sufficient information to allow reassembly of the original packet:</p><p id="p0024" num="0024">- Because all the fragment headers start as copies of the original packet, they contain the same value in the 'Identification' field as the original packet before fragmentation. </p><p id="p0025" num="0025"> - The 'Fragment Offset' field of each fragment is set to index where in the original payload this fragment was taken from, as a number of octets (bytes) from the start. </p><p id="p0026" num="0026"> - The 'More Fragments' (MF) flag is set to 1 on all the fragments of a packet except the last, in which it is cleared to zero. </p><p id="p0027" num="0027"> Thus, each fragment contains sufficient information for the ultimate destination to reassemble them into the original packet. </p><p id="p0028" num="0028">Note that the sender of an un-fragmented IPv4 packet should initially set the 'More </p><p id="p0029" num="0029">Fragments' flag to zero and the 'Fragment Offset' to zero. </p><p id="p0030" num="0030"> If the sender (or a router) sets the 'Don't Fragment' (DF) flag, then the packet should not be fragmented when it arrives at a subsequent router even if it is too large to fit within the MTU 
<!-- EPO <DP n="5"/>-->
 of a link. Instead, the router should discard the packet, and optionally return a control packet to the source containing an appropriate error message. </p><p id="p0031" num="0031">Modern approach to Fragmentation </p><p id="p0032" num="0032"> When IPv6 was defined, it was decided that routers would no longer do fragmentation. This allowed routers to be simplified. Instead, it was decided that the sender would become responsible for making sure its packets were small enough to fit through the link with the smallest MTU on the path (the path MTU or PMTU). The sender can do fragmentation in IPv6, but that is not relevant to this discussion. </p><p id="p0033" num="0033"> The IETF is in the process of recommending that IPv4 sources adopt a similar approach to IPv6 in this regard. To achieve this, it is being recommended that all IPv4 sources set the 'Don't Fragment' (DF) flag and clear the 'More Fragments' (MF) flag and the 'Fragment Offset' field (see: "Updated Specification of the IPv4 ID Field" (Joe Touch, 22 Oct 2010), IETF Internet Draft &lt;draft-ietf-intarea-ipv4-id-update&gt;, available on the internet at </p><p id="p0034" num="0034">http.V/to<sup>'</sup>ols. ietf.org/html/draft-ietf-intarea-ipy4-id-update-01 ). Most IPv4 sources already disable fragmentation in this way, so the IETF exercise largely documents what is essentially current best practice. </p><p id="p0035" num="0035">Prior Art </p><p id="p0036" num="0036"> Many security protocols (for instance digital signatures) require a "hash" of a combination of numbers from a large number-space to be placed in a field that only fits a much smaller number space. If the receiver of the protocol knows the same combination of numbers, it can check whether the hash it calculates matches the hash in the protocol field. Similarly, hash tables are used to reduce the look-up time when looking up a number from a large number- space without having to search the whole space. Further information on hash tables is available from standard sources on the internet and elsewhere. </p><p id="p0037" num="0037">The IPv4 'Identification' field of non-fragmented packets has been proposed to be re-used in various ways in the past, such as the following: </p><p id="p0038" num="0038"> - In a paper by Savage et al entitled: "Practical Network Support for IP Traceback" </p><p id="p0039" num="0039">(SIGCOMM Comput. Commun. Rev. 30:295-306 ACM (August 2000)), it was suggested that routers probabilistically either re-used or not the whole IP ID field in order to transmit route identification messages to a router downstream, and that a downstream router interpreted these messages using a new internal protocol. It was not made clear how the downstream router could know whether a particular packet used the new protocol, or whether the ID field in the packet had been set arbitrarily by the original source of the packet. 
<!-- EPO <DP n="6"/>-->
 It appears possible that the authors believed that un-fragmented packets on today's Internet all use some default value in the IPv4 'Identification' field such as zero, whereas in general, they in fact do not (as discussed earlier). </p><p id="p0040" num="0040"> - European patent application EP1505770 (Jones et al) refers to the possibility of using the IPv4 'ID' field for a similar purpose to "Savage et al". It offers no other information to reveal how the authors might have intended the field to be used, however. </p><p id="p0041" num="0041"> There are various cases where values not used in one protocol are commandeered for use in another protocol. For instance: </p><p id="p0042" num="0042"> - The unused values above 1500 in the proprietary Ethernet Length field were standardised by the iEEE 802 committee to have the semantic of an Ethertype. </p><p id="p0043" num="0043"> - In US patent application US 2009/0103548 (Weiss), the preamble to an Ethernet frame is said to have fallen into disuse. This document includes a proposal to insert a duplicate of another protocol field in the place where the preamble used to go in order that this duplicate value can be read fractionally sooner, rather than waiting for it to appear later in the protocol header. </p><p id="p0044" num="0044"> An IETF Internet Draft entitled "Ethernet Preamble Variation - Use Ethernet Preamble to Perform Frame's Classification and a Switching Optimization" (draft-giordano-ethpre-class- opt-00) by Daniele Giordano is similar to the proposal in the "Weiss" patent application referred to above. It proposes a variation of the Ethernet frame structure to perform a frame's classification and a switching optimisation. Using a priority field "PRI", the switch is able to change its switching modality in dependence on the priority value between a "store &amp; forward" mode and a "cut through" mode. Insofar as these different modes can be regarded as different protocols, it will be noted that the proposed codepoints used in the second mode/protocol are different from those used in the first. As a result, the frames of the second protocol can be deterministically distinguished from those of the first. In particular, the Start- Frame-Delimiter (SFD) is different. </p><p id="p0045" num="0045"> In cases such as these, it will be understood that the values used in the second or later protocol are different from those used in the first or earlier protocol. Frames sent according to the second protocol can therefore be deterministically distinguished from those sent according to the first. </p><p id="p0046" num="0046"> Similarly, there may be examples of cases where a protocol field was defined but the usage was never taken up or fell into disuse, so it was then re-defined for a different purpose. Also there may be cases where a subset of the values of a protocol field were defined but never 
<!-- EPO <DP n="7"/>-->
 used or fell into disuse, so new meanings were proposed for these values, either by "de jure" standardisation or by "de facto" usage. </p><p id="p0047" num="0047"> It will be understood that none of the prior art techniques discussed above suggest the deployment of a protocol where the semantics of a protocol field are deliberately ambiguous, but probabilistically meaningful. </p><p id="p0048" num="0048">Summary of the Invention </p><p id="p0049" num="0049"> According to a first aspect of the present invention, there is provided a method of obtaining information from a predetermined portion of a header of a data item transmitted via a communication network, said portion carrying a codepoint selected from a first set of codepoints each of which has a first pre-defined meaning according to a first pre-defined communication protocol, the method comprising: </p><p id="p0050" num="0050"> receiving the data item; </p><p id="p0051" num="0051"> inspecting the header of the data item whereby to determine the codepoint carried by the predetermined portion thereof; </p><p id="p0052" num="0052"> identifying whether the codepoint is a member of a second set of codepoints, the second set of codepoints comprising fewer possible codepoints than the first set of codepoints; and </p><p id="p0053" num="0053"> in the event that the codepoint is identified as being a member of the second set of codepoints, and in dependence on such an identification being made, interpreting that codepoint according to a second pre-defined communication protocol as having a second pre-defined meaning, said second communication protocol differing from said first communication protocol, and said second meaning differing from said first meaning. </p><p id="p0054" num="0054">By virtue of preferred embodiments of the above method, certain codepoints having a particular meaning according to an "existing" or "old" communication protocol which may still be in use (such that those codepoints might have been assigned to data items in accordance with that existing/old communication protocol, and are capable of being interpreted according to that existing/old communication protocol as having their "existing" or "old" meanings by apparatus receiving data items carrying such codepoints), may instead be interpreted, if received by suitably "enabled" receiving apparatus, according to a different, new protocol, under which those codepoints have a different, new meaning. Data items carrying such codepoints that have been set by apparatus complying with the new protocol may be indistinguishable from data items carrying such codepoints that have been set by apparatus complying with the existing/old protocol, and may therefore be treated in the same way as data items sent by apparatus complying with the existing/old protocol if received by "non- 
<!-- EPO <DP n="8"/>-->
 enabled" apparatus complying with the existing/old protocol, but if such data items are instead received by "enabled" apparatus complying with the new protocol (i.e. performing a method according to a preferred embodiment), such apparatus may treat them on the basis that they have been received from apparatus complying with the new protocol, interpret the codepoints accordingly, and obtain information from them that "non-enabled" apparatus may be unable to obtain. Due to the indistinguishable nature of the data items in question, this advantage may be obtained without the risk that their presence "arouses suspicion" and leads to them being dropped or causing problems if received by "non-enabled" apparatus. According to preferred embodiments, the communication network is a digital network such as a packet network. </p><p id="p0055" num="0055">It will be understood however that embodiments of the invention may be applicable in relation to other types of network carrying data items other than packets, provided that such data items have (or are associated with) "headers" or information-carrying portions equivalent to the "headers" of Internet Protocol packets. </p><p id="p0056" num="0056">According to preferred embodiments, the data items are Internet Protocol packets, such as IPv4 packets, but they may be packets sent according to other IP versions, or may be data items in accordance with other protocols as well. </p><p id="p0057" num="0057">The predetermined portion of the header (or the equivalent information-carrying portion thereof) from which information may be obtained may comprise one or more fields or parts of fields in or associated with the data item. </p><p id="p0058" num="0058">According to preferred embodiments, in particular embodiments such as those where the data items are Internet Protocol packets each having an 'Identification' field in their header, the predetermined portion may comprise part or all of the 'Identification' field in the header of the data items. </p><p id="p0059" num="0059">Preferred embodiments are particularly applicable in relation to scenarios where the first protocol uses the available number-space uniformly, or at least fairly uniformly. </p><p id="p0060" num="0060">According to preferred embodiments, the ratio between the number of members in the first set of codepoints and the number of members in the second set of codepoints is large, which, at least in cases where the first protocol uses the available number-space uniformly or 
<!-- EPO <DP n="9"/>-->
 fairly uniformly, ensures that the probability of a codepoint randomly selected from the first set "by chance" also being in the second set will be small. Preferably the ratio is at least 2<sup>n</sup>:1 , where n is a number such as 4, 8, 12, 13 or 14. According to preferred embodiments, the first pre-defined communication protocol may relate to the fragmentation of data items. According to such embodiments, the first pre-defined meaning of a particular codepoint may relate to the identification of fragments of a data item carrying that codepoint. According to preferred embodiments, the second pre-defined communication protocol may relate to a path or a network characteristic such as network congestion or congestion on a path in a network. According to such embodiments, the second pre-defined meaning of a particular codepoint may relate to congestion experienced or expected to be experienced by a data item carrying that codepoint. </p><p id="p0061" num="0061">It will be understood however that the information obtainable from the data items when interpreted according to the first and/or second protocol need not relate to a characteristic. It may instead or additionally relate to an instruction conveyed by the data item. The method may comprise a further step, performed in relation to one or more data items in dependence on information obtained from the data item in question or from a plurality of such data items. The further step may involve forwarding or possibly "not forwarding" (e.g. </p><p id="p0062" num="0062">dropping) the data item or data items, in a manner or on a path which may depend on the information obtained therefrom, for example. Alternatively or additionally, it may involve recording, storing or reporting information based on that obtained, in order to police a flow of which the data item or items forms a part, or to allow it to be policed, for example. </p><p id="p0063" num="0063">Alternatively or additionally, it may involve performing an action in response to an instruction conveyed by the information obtained from one or more data items, for example. Other such actions may also be performed, of course. </p><p id="p0064" num="0064">The method may further comprise interpreting the codepoint according to the first pre-defined communication protocol as having the first pre-defined meaning if the codepoint is not identified as being a member of the second set of codepoints. According to a second aspect of the present invention, there is provided apparatus for obtaining information from a predetermined portion of a header of a data item transmitted via 
<!-- EPO <DP n="10"/>-->
 a communication network, said portion carrying a codepoint selected from a first set of codepoints each of which has a first pre-defined meaning according to a first pre-defined communication protocol, the apparatus comprising: </p><p id="p0065" num="0065"> a receiver for receiving the data item; </p><p id="p0066" num="0066"> data item inspection means operable to inspect the header of the data item whereby to determine the codepoint carried by the predetermined portion thereof, and to identify whether the codepoint is a member of a second set of codepoints, the second set of codepoints comprising fewer possible codepoints than the first set of codepoints; and </p><p id="p0067" num="0067"> an interpretation means, operable, in the event that the codepoint is identified as being a member of the second set of codepoints, and in dependence on such an </p><p id="p0068" num="0068">identification being made, to interpret that codepoint according to a second pre-defined communication protocol as having a second pre-defined meaning, said second </p><p id="p0069" num="0069">communication protocol differing from said first communication protocol, and said second meaning differing from said first meaning. </p><p id="p0070" num="0070">The apparatus may comprise or be a part of a router or another such network element for receiving and/or forwarding data items such as packets. </p><p id="p0071" num="0071">According to preferred embodiments, the interpretation means may further be operable, in the event that the codepoint is not identified as being a member of the second set of codepoints, to interpret the codepoint according to the first pre-defined communication protocol as having the first pre-defined meaning. </p><p id="p0072" num="0072">The various options and preferred embodiments referred to above in relation to the first aspect are also applicable in relation to the second aspect. </p><p id="p0073" num="0073">It will be understood that preferred embodiments of the invention allow values in a protocol header field to be assigned a new protocol meaning even though the same values already have or had a meaning under an existing or old protocol. </p><p id="p0074" num="0074">Packets complying with such a new protocol may therefore be indistinguishable from packets already present on the network that were sent under the old/existing protocol. Therefore, during initial deployment, packets complying with the new protocol will not encounter the bugs and security precautions that they would have been susceptible to if the new protocol had required packets complying therewith to carry different values to those in existing packets, or to be deterministically distinguishable therefrom in any way. 
<!-- EPO <DP n="11"/>-->
 The above idea is particularly applicable where the initial protocol definition includes a relatively large field which the source may set to any of its possible values, all of which are meaningless and/or ignored but not changed by existing network equipment. Then, as new protocol fields are required, sub-ranges of the possible number space covered by this large field can be given new protocol semantics. Sending equipment that has been updated to use the new protocol will confine the codepoints it uses to the defined sub-range, and receiving equipment will recognise packets carrying codepoints in this sub-range as "very probably" set by another piece of equipment that "speaks" (i.e. "is sending packets carrying data complying with") the new protocol. </p><p id="p0075" num="0075"> Occasionally, this assumption may be incorrect, when new equipment encounters a packet from old equipment that happens by chance to have used one of the numbers/codepoints in ■ the defined sub-range as it cycles through the larger number space. However, it will often be possible to ensure that the new equipment does no harm, or minimal harm, to packets sent by old equipment that it mistakenly interprets as complying with the new protocol. </p><p id="p0076" num="0076"> A second stage of protocol evolution can be defined to remove the ambiguity of the interim stage just described. A reserved value in a second field can be set to flag that the first field should be unambiguously interpreted with its new protocol semantics. </p><p id="p0077" num="0077"> This two-stage process of "protocol evolution" may be used to remove the current "chicken- and-egg" problem where: </p><p id="p0078" num="0078"> - before a protocol is widely used, it triggers so many problems in other equipment that it can never become widely enough deployed to prove that it would be useful; </p><p id="p0079" num="0079"> - a new protocol has to be widely used before it will not trigger problems in other equipment, because only then do manufacturers make allowance for its existence by including it in their test routines and by not treating it as an unknown security risk. </p><p id="p0080" num="0080"> If data item receiving and data item forwarding equipment such as routers are configured to obtain information from data items in accordance with preferred embodiments of the invention, it becomes possible to arrange for the following when deploying a new protocol:</p><p id="p0081" num="0081">- during an interim stage of incremental deployment, individual data items complying with a new protocol do not or need not differ from individual data items complying with an earlier protocol; </p><p id="p0082" num="0082"> - but collectively, those data items complying with the new protocol all carry numbers within a small sub-range, whereas those complying with the old protocol will carry any number drawn from the whole possible range of numbers. 
<!-- EPO <DP n="12"/>-->
 The above should not be confused with what occurs when hashing techniques are used. As explained earlier, these may involve a large number space held outside the protocol and the whole of a protocol field being used for the subset of the number space used by the hash. In contrast, according to embodiments of the present invention, while a previous protocol may have used a number-space that fits within the protocol field in question, a new protocol may then re-use a subset of the larger number-space within a smaller portion of the protocol field.</p><p id="p0083" num="0083">Similarly, referring again to techniques such as those proposed in the "Savage et al" paper discussed earlier, there is no suggestion of a new protocol using only a (smaller) subset of the number space that could possibly fit within a protocol field used by an old or existing protocol, whereby to allow a receiving entity to identify packets which are highly likely to have been sent using the new protocol (while potentially being indistinguishable from packets which have been sent using the old or existing protocol), and interpret them accordingly in dependence on such an identification being made. </p><p id="p0084" num="0084">Brief Description of the Drawings </p><p id="p0085" num="0085">A preferred embodiment of the present invention will now be described with reference to the appended drawings, in which: </p><p id="p0086" num="0086"> Figure 1 shows the layout and names of the fields of an IPv4 header; </p><p id="p0087" num="0087"> Figure 2 shows the layout and names of the fields of an IPv6 header; </p><p id="p0088" num="0088"> Figure 3 shows the IPv4 'Flags' field in detail; </p><p id="p0089" num="0089">Figure 4 shows the values of the Fragmentation' fields that would indicate a so-called 'atomic' packet; </p><p id="p0090" num="0090"> Figure 5 illustrates an example of "experimental" use of bits 13 to 15 of the old 'Identification' field in the IPv4 header (i.e. use without requiring the 'Reserved' flag to be set to " ; </p><p id="p0091" num="0091"> Figure 6 shows an example Standards Registry entry defining a new protocol called "ExA"; Figure 7 is a flow-chart illustrating the probabilistic identification of use of a new protocol, and the obtaining of information from data items in accordance therewith, using a process according to a preferred embodiment of the invention; and </p><p id="p0092" num="0092"> Figure 8 illustrates the functional modules of packet forwarding equipment according to a an embodiment of the invention. 
<!-- EPO <DP n="13"/>-->
 Description of Preferred Embodiments of the Invention </p><p id="p0093" num="0093"> With reference to the accompanying figures, a method according to a preferred embodiment will be described that may be used to facilitate incremental deployment of a new protocol without causing or increasing the likelihood of the types of problems such as those described above that often occur when a new protocol is deployed. </p><p id="p0094" num="0094"> The way IPv4 was defined and the way it currently happens to be used meet all the criteria of the Old' protocol referred to above. An example first embodiment of the invention follows based on IPv4 as the initial Old' protocol, and a modification to IPv4 as the 'new' protocol, although it will be recognised that alternative embodiments of the invention apply in respect of other 'old' snd (potential) 'new' protocols. </p><p id="p0095" num="0095"> According to measurements in 1999, only 0.22% of packets were fragments. A large majority of IPv4 sources set the 'Flags' and 'Offset' fields as they are shown in Figure 4, which shows the values of the fields of relevance to 'Fragmentation' that would indicate a so-called 'atomic' packet (NB "X" means "either 1 or 0"). This indicates that the packet should not be fragmented (DF=1 ), and has not already been fragmented (MF=0, Offset=0). Such a packet is sometimes termed 'atomic', because it cannot be broken into fragments. </p><p id="p0096" num="0096"> The 'Identification' field of an atomic packet will never be needed to reassemble the packet. Therefore the 'Identification' field is of little or no importance, and is generally ignored (and not changed) by existing network equipment. In Figure 4, the value "X" shown in each bit position of the 'Identification' field indicates that the value of these bits is irrelevant to the Old' IPv4 protocol. "X" essentially means "don't care", or "doesn't matter", or "either 1 or 0". </p><p id="p0097" num="0097"> Of the large majority of IPv4 sources that disable fragmentation, a large majority still set the 16-bit 'Identification' field of each packet to any one of its 2<sup>16</sup> possible values, as if fragmentation might occur. Only a minority of those IPv4 sources that disable fragmentation set the 'Identification' field to a default value of zero. </p><p id="p0098" num="0098"> An example of an implementation that uses all 2<sup>16</sup> values is the mainline Linux </p><p id="p0099" num="0099">implementation of IP, which is in widespread use in both servers and handheld devices. In common with most implementations of network protocols, its primary application </p><p id="p0100" num="0100">programming interface (API) is an abstraction termed a 'socket'. An application programmer may craft individual packets using what is called a Yaw socket'. However, invariably programmers use the connect ( ) system call to connect to the socket in order to facilitateongoing communication with a remote destination, whether sending a stream of bytes broken up into segments (e.g. TCP) or a set of discrete datagrams (e.g. UDP). Whenever a programmer has used the connect ( ) system call, the Linux implementation of IP will 
<!-- EPO <DP n="14"/>-->
 generate packets with values in their ID fields that cycle through the whole number-space. Only in the rare cases when the connect ( ) system call has not been used does Linux default to an ID field of zero. </p><p id="p0101" num="0101"> Given that the large majority of IPv4 sources disable fragmentation, an "interim" stage of protocol evolution can be defined where values in sub-ranges of the 'Identification' field can be given new specific semantics. However, because the large majority of these sources still select packet 'ID' values from the whole number space, existing devices will already be sending numerous packets that use all the values in any sub-range of the number space.</p><p id="p0102" num="0102">For the purposes of this example embodiment, we will assume that a new protocol (termed
<img id="imgf000014_0001" he="5" wi="102" file="imgf000014_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0103" num="0103"> default value meaning that the old protocol is in use). Therefore it will need three extra bits in the IPv4 header (because 8 = 2<sup>3</sup>). </p><p id="p0104" num="0104"> The traditional way to distinguish a new version of IP from the old IPv4 would be to make the new protocol packets distinguishable from those sent under the old protocol, perhaps by setting the 'Reserved' flag (bit 0 in Figure 3 or bit 16 in Figure 4), which has previously always been cleared to zero in all packets sent using the Internet. However, some existing Internet equipment discards packets with the 'Reserved' flag set, merely because such packets are unexpected. Such behaviour (i.e. discarding packets because a 'Reserved' flag has been set) is contrary to the Internet protocol standard, but it happens, for reasons such as those set out earlier, under the heading "Protocol Evolution". </p><p id="p0105" num="0105"> Therefore, when implementing a method according to our example embodiment, our new version of IPv4 will allow the 'Reserved' flag still to be cleared to 0. The new version of IPv4 also allows the 'Reserved' flag to be set to 1 , however, which makes the new meaning of the packet header unambiguous. However, the new protocol defines the 'Reserved' flag as "either 1 or 0", which is termed "don't care" and indicated as "X" in bit 16 of Figure 4. </p><p id="p0106" num="0106"> As an example, we will assume that the required eight codepoints are defined as all the eight possible combinations of the three least significant bits of the 'Identification' field, as shown in Figure 5. Up to eight of the codepoints formed from the possible combinations of bits in this three-bit sub-field could each be assigned a new meaning under the new protocol. </p><p id="p0107" num="0107"> If the 'Reserved' flag is cleared to zero, the rest of the bits in the 'ID' field not within the newly-defined sub-field (the most-significant 13 bits) have to be set to a default value (e.g. zero). Then old IPv4 equipment cycling through all the values of the 'ID' number-space would happen to use one of the eight newly-defined values with a probability of 1 in 2<sup>13</sup> (=2<sup>( 6"3)</sup>). 
<!-- EPO <DP n="15"/>-->
 Equipment designed to comply with the new protocol would assume that packets with 13 zeros in the 13 most significant bits had been sent by other equipment complying with the new protocol and it would act on them according to the meanings assigned to the values in the 3 assigned bits. This assumption would only be wrong with a probability of 1 in 2<sup>13</sup>, or 5 about 0.01%. </p><p id="p0108" num="0108"> Sending or forwarding equipment wishing to make the new meaning unambiguous could set the 'Reserved' flag to 1 as well as using any of the eight values in the newly defined sub-field of the 'Identification' field. This allows a trade-off between: </p><p id="p0109" num="0109"> - a new protocol that is unambiguously different to the old IPv4 (Reserved = 1 ) but cannot i n rnmmi inirato thrm in h nnn_^r&gt;mnliant miHHIohnYP"; anrl </p><p id="p0110" num="0110">- a new protocol that is only probabilistically different from the old IPv4 (Reserved = 0) but will safely traverse all existing equipment on the Internet. </p><p id="p0111" num="0111"> Figure 5 illustrates an example of the "experimental" or "provisional" use of bits 13 to 15 of the old 'Identification' field in the IPv4 header (i.e. use without requiring the 'Reserved' flag to 15 be set to "1". The rows numbered 1 to 5 illustrate the stages used to define then use the new protocol, each of the rows representing an increasingly specific definition of the protocol:</p><p id="p0112" num="0112">Row 1 : Initially, only the old IPv4 protocol is defined (as shown in the first row of Figure 5 and also shown in Figure 4), with "don't care" values for the first 17 bits of the 'Fragmentation' header fields. The remaining bits are arranged to indicate that the packet is atomic, i.e. the 20 packet must not be fragmented (DF=1 ) and has not been fragmented (MF=0, Offset=0). </p><p id="p0113" num="0113"> Row 2: In a second stage (i.e. the second row of Figure 5), the three least significant bits of the old 'Identification' field have been registered as a new protocol called "ExA", on condition that the packet is atomic and the 'Reserved' flag can be either 0 or 1. For instance, a protocol standards body such as the Internet Assigned Numbers Authority (IANA) might hold a </p><p id="p0114" num="0114"> 25 registry entry defining the meaning of these new bits as shown in Figure 6. The third row of Figure 6 gives the name, "ExA" of the new protocol for the sub-field. The first two rows of Figure 6 specify which contiguous bits are allocated to the new protocol. The fourth row of Figure 6 indicates that the new protocol ExA is fully specified in request for comments (RFC) number 6789 (for example). The final, fifth row of Figure 6 indicates that the new bits should</p><p id="p0115" num="0115">30 be considered to have the meanings defined by the new ExA protocol irrespective of whether the 'Reserved' Flag is set to 0 or 1. </p><p id="p0116" num="0116"> Row 3: In a third stage (the third row of Figure 5), sending/forwarding equipment that implements the new protocol chooses to clear the 'Reserved' flag to zero in order to avoid problems with non-compliant middleboxes. It therefore also clears the remainder of the bits in 
<!-- EPO <DP n="16"/>-->
 the 'Identification' field that are not used by the new protocol ExA, i.e. the most significant 13 bits. It is then free to use the 3-bits assigned to the new protocol ExA in any combination that is valid within the new protocol specification. </p><p id="p0117" num="0117"> Row 4: In a fourth stage (the fourth row of Figure 5), sending/forwarding equipment complying with the new protocol chooses to use the codepoint "101" (for example), which will have a specific meaning defined in the relevant specification of protocol ExA. </p><p id="p0118" num="0118"> Row 5: In a fifth stage, forwarding or receiving equipment that has implemented the new protocol ExA will read the packet header and obtain information from it which may be in accordance with the new protocol. This may be done using the following sub-steps </p><p id="p0119" num="0119">(illust ated in F ! C! ϋ <sup>r</sup>2 7^ tyhifh maw ho narfr,rme&gt;rt from ' tart' nnint (stffn s70^ tn a </p><p id="p0120" num="0120"> 'Continue' point (step s81 ) in respect of each packet, by packet-receiving or packet- receiving/forwarding equipment 8 such as a router, an example of which is shown </p><p id="p0121" num="0121">symbolically in Figure 8: </p><p id="p0122" num="0122"> (a) Having received a packet at input 810 (step s71 ), the packet is inspected in an inspection module 820, which comprises a header inspection module 821 and a probabilistic codepoint identification module 822. The header inspection module 821 inspects the fragmentation fields (step s72) and checks (step s73) whether the packet is 'atomic' by testing whether bit 17 is "1" and the least significant bits (bits 18-31 ) are "0". If the packet is not atomic, the receiving equipment 8 can be certain that the packet does not come from sending equipment using the new ExA protocol (step s74), and if necessary or required, can then obtain information from the packet (step s75), interpreting the header field or fields in question according to the "old" protocol in an "old protocol" handler 831, performing other processing in respect of the packet in a processor 840 if appropriate, and passing the packet to an output 850, from which it may be forwarded, and continuing as appropriate (step s81 ). Otherwise (i.e. if the packet is atomic) the process continues via step s76, as set out in (b). </p><p id="p0123" num="0123"> (b) If the packet has been found (at step s73) to be atomic, the forwarding or receiving equipment checks (step s76) whether the 'Reserved' flag (bit 16) is "0". If so, the process continues with step s77, discussed in (c). If not, the process proceeds directly to step s78, discussed in (d) below. </p><p id="p0124" num="0124"> (c) If the 'Reserved' flag (bit 16) has been found (at step 76) to be "0", the forwarding or receiving equipment checks (step s77) whether bits 0-12 of the 'Identification' field are all zero. If they are not, the receiving equipment can be certain that the packet does not come from sending equipment using the ExA protocol, and may proceed to 
<!-- EPO <DP n="17"/>-->
 step s81 via steps s74 and s75 if appropriate, as set out above. Otherwise the process continues to step s78 as set out in (d), which involves what can be regarded as probabilistic codepoint identification, performed by functional module 822. </p><p id="p0125" num="0125"> (d) The forwarding or receiving equipment then tests (step s78) whether bits 13-15 of the 'Identification' field are all zero. If they are all zero, the receiving equipment may assume that the packet does not come from sending equipment using the ExA protocol, and may proceed to step s81 via steps s74 and s75, as set out above. If bits 13-15 are not all zero, it assumes (i.e. on probabilistic grounds) that the packet has come from sending equipment using the ExA protocol, and passes these bits (at least) to the ExA protocol handler 832 (step s79), because it is highly probable (albeit not certain) that the packet has been sent or forwarded by sending equipment using the ExA protocol. Information is then obtained from the packet (step s80), interpreting bits 13-15 (at least) according to the new protocol. As before, other processing may be performed in respect of the packet in processor 840 if appropriate, and the packet may then be passed to output 850 from which it may be forwarded, the process then continuing as appropriate (step s81 ). </p><p id="p0126" num="0126"> The step of continuing (step s81 ) may involve forwarding or possibly "not forwarding" (e.g. dropping) the packet, in a manner which may depend on the information obtained from the packet. Alternatively or additionally, it may involve recording, storing or reporting information based on that obtained, in order to police the flow of which the packet forms a part, or to allow it to be policed, for example. </p><p id="p0127" num="0127"> The process shown in Figure 7 is broken down into the above steps for illustration purposes only. In practice it may well be simpler or otherwise more appropriate to optimise the above tests into fewer process steps. Similarly, with reference to Figure 8, it will be understood that components of apparatus 8 such as the header inspection module 821 , the probabilistic codepoint identification module 822, the protocol handlers 831 and 832, the processor 840 etc., need not be separate physical components of the apparatus 80, or may be grouped in different functional modules within apparatus 8. The functions attributed to some or all of these may in fact be performed by a single processor, for example, with the results of processing to achieve the functionality attributed to one functional element being used</p><p id="p0128" num="0128">(where applicable) in a subsequent routine whereby to achieve the functionality attributed to another. </p><p id="p0129" num="0129"> Returning to the description of the technique in general, it will be understood that it is possible for multiple sub-fields of the field or fields in question (such as the 'Identification' field, in the above example) to be assigned for use by multiple new protocols. In order to 
<!-- EPO <DP n="18"/>-->
 minimise the probability of wrongly judging that a packet is using a new protocol, only one new protocol should generally be used at a time if the 'Reserved' flag is cleared to zero. However, once at least one new protocol has received widespread acceptance, everyone will have an incentive to remove or repair non-compliant middleboxes until few remain. Then the 'Reserved' flag can be set to "1 " and multiple new protocols will all be able to use sub-fields of the 'Identification' field, all at once. 
</p></description><claims mxw-id="PCLM44852235" ref-ucid="WO-2012117215-A1" lang="EN" load-source="patent-office"><claim id="clm-0001" num="0001"><!-- EPO <DP n="19"/>--><claim-text/><claim-text>CLAIMS </claim-text><claim-text> 1 ) A method of obtaining information from a predetermined portion of a header of a data item transmitted via a communication network, said portion carrying a codepoint selected from a first set of codepoints each of which has a first pre-defined meaning according to a first pre-defined communication protocol, the method comprising: </claim-text><claim-text> receiving the data item; </claim-text><claim-text> inspecting the header of the data item whereby to determine the codepoint carried by the predetermined portion thereof; </claim-text><claim-text> identifying whether the codepoint is a member of a second set of codepoints, the second set of codepoints comprising fewer possible codepoints than the first set of codepoints; and </claim-text><claim-text> in the event that the codepoint is identified as being a member of the second set of codepoints, and in dependence on such an identification being made, interpreting that codepoint according to a second pre-defined communication protocol as having a second pre-defined meaning, said second communication protocol differing from said first communication protocol, and said second meaning differing from said first meaning. </claim-text><claim-text>2) A method according to claim 1 wherein the communication network is a digital network such as a packet network. </claim-text><claim-text>3) A method according to claim 1 or 2 wherein the predetermined portion comprises one or more fields or parts of fields in the header of a data item. </claim-text><claim-text>4) A method according to any of the preceding claims, wherein the data items are Internet Protocol packets. </claim-text><claim-text>5) A method according to any of the preceding claims, wherein the predetermined portion comprises a part or all of an 'Identification' field in the header of the data items. 6) A method according to any of the preceding claims, wherein the ratio between the number of members in the first set of codepoints and the number of members in the second set of codepoints is at least 2<sup>n</sup>:1 , where n is 4, 8, 12, 13 or 14. </claim-text><claim-text>7) A method according to any of the preceding claims, wherein the first pre-defined communication protocol relates to fragmentation of data items. 
<!-- EPO <DP n="20"/>-->
 8) A method according to claim 7 wherein the first pre-defined meaning of a particular codepoint relates to identification of fragments of a data item carrying that codepoint. </claim-text><claim-text>9) A method according to any of the preceding claims, wherein the second pre-defined communication protocol relates to a path or network characteristic. </claim-text><claim-text>10) A method according to any of the preceding claims, wherein the second pre-defined communication protocol relates to path or network congestion. 1 1 ) A method according to claim 10 wherein the second pre-defined meaning of a particular codepoint relates to congestion experienced or expected to be experienced by a data item carrying that codepoint. </claim-text><claim-text>12) A method according to any of the preceding claims, the method comprising interpreting the codepoint according to the first pre-defined communication protocol as having the first pre-defined meaning in the event that the codepoint is not identified as being a member of the second set of codepoints. </claim-text><claim-text>13) Apparatus for obtaining information from a predetermined portion of a header of a data item transmitted via a communication network, said portion carrying a codepoint selected from a first set of codepoints each of which has a first pre-defined meaning according to a first pre-defined communication protocol, the apparatus comprising: </claim-text><claim-text> a receiver for receiving the data item; </claim-text><claim-text> data item inspection means operable to inspect the header of the data item whereby to determine the codepoint carried by the predetermined portion thereof, and to identify whether the codepoint is a member of a second set of codepoints, the second set of codepoints comprising fewer possible codepoints than the first set of codepoints; and </claim-text><claim-text> an interpretation means, operable, in the event that the codepoint is identified as being a member of the second set of codepoints, and in dependence on such an </claim-text><claim-text>identification being made, to interpret that codepoint according to a second pre-defined communication protocol as having a second pre-defined meaning, said second </claim-text><claim-text>communication protocol differing from said first communication protocol, and said second meaning differing from said first meaning. 4) Apparatus according to claim 13 wherein the interpretation means further being operable, in the event that the codepoint is not identified as being a member of the second 
<!-- EPO <DP n="21"/>-->
 set of codepoints, to interpret the codepoint according to the first pre-defined communication protocol as having the first pre-defined meaning. </claim-text><claim-text>15) Apparatus operable to perform a method according to any of claims 1 to 13. 
</claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
