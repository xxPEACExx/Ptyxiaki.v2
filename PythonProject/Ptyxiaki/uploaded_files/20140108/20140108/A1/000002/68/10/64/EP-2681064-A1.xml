<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2681064-A1" country="EP" doc-number="2681064" kind="A1" date="20140108" family-id="46718508" file-reference-id="286058" date-produced="20180823" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146586704" ucid="EP-2681064-A1"><document-id><country>EP</country><doc-number>2681064</doc-number><kind>A1</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12752924-A" is-representative="NO"><document-id mxw-id="PAPP154848896" load-source="docdb" format="epo"><country>EP</country><doc-number>12752924</doc-number><kind>A</kind><date>20120222</date><lang>EN</lang></document-id><document-id mxw-id="PAPP220440175" load-source="docdb" format="original"><country>EP</country><doc-number>12752924.6</doc-number><date>20120222</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140551224" ucid="US-201113170212-A" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201113170212</doc-number><kind>A</kind><date>20110628</date></document-id></priority-claim><priority-claim mxw-id="PPC140548691" ucid="US-201161447323-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201161447323</doc-number><kind>P</kind><date>20110228</date></document-id></priority-claim><priority-claim mxw-id="PPC140553951" ucid="US-2012025992-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>2012025992</doc-number><kind>W</kind><date>20120222</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1989319160" load-source="docdb">B60K   1/00        20060101AFI20120920BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1740215315" load-source="docdb" scheme="CPC">Y02T  10/643       20130101 LA20171030BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1740215316" load-source="docdb" scheme="CPC">Y02T  10/7283      20130101 LA20171030BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1740215317" load-source="docdb" scheme="CPC">Y02T  10/72        20130101 LA20171030BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1740215318" load-source="docdb" scheme="CPC">Y02T  10/645       20130101 LA20171030BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1777723596" load-source="docdb" scheme="CPC">H02P  29/50        20160201 LI20170731BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1777723597" load-source="docdb" scheme="CPC">B60L2240/529       20130101 LA20170803BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1777723598" load-source="docdb" scheme="CPC">B60L2240/425       20130101 LA20170803BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1777723599" load-source="docdb" scheme="CPC">B60L2240/423       20130101 LA20170803BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1777723600" load-source="docdb" scheme="CPC">B60L2240/421       20130101 LA20170803BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1777723601" load-source="docdb" scheme="CPC">B60L  15/2045      20130101 LI20170803BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989646650" load-source="docdb" scheme="CPC">H02P  21/04        20130101 FI20130420BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132364745" lang="DE" load-source="patent-office">VERFAHREN UND SYSTEM ZUR STEUERUNG EINES ELEKTROMOTORS UNTER STILLSTANDS- ODER FAST-STILLSTANDS-BEDINGUNGEN</invention-title><invention-title mxw-id="PT132364746" lang="EN" load-source="patent-office">METHOD AND SYSTEM FOR CONTROLLING AN ELECTRIC MOTOR AT OR NEAR STALL CONDITIONS</invention-title><invention-title mxw-id="PT132364747" lang="FR" load-source="patent-office">PROCÉDÉS ET SYSTÈMES DE RÉGULATION D'UN MOTEUR ÉLECTRIQUE À L'ÉTAT DE DÉCROCHAGE OU PROCHE D'UN TEL ÉTAT</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR919504522" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>DEERE &amp; CO</last-name><address><country>US</country></address></addressbook></applicant><applicant mxw-id="PPAR919531633" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>DEERE &amp; COMPANY</last-name></addressbook></applicant><applicant mxw-id="PPAR919009740" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Deere &amp; Company</last-name><iid>101150216</iid><address><street>One John Deere Place</street><city>Moline, IL 61265</city><country>US</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919515093" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>WU LONG</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919512161" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>WU, LONG</last-name></addressbook></inventor><inventor mxw-id="PPAR919016515" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>WU, LONG</last-name><address><street>2824 37th Avenue South</street><city>Fargo ND 58104</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919539928" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>SHAW ROBERT</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919539895" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>SHAW, ROBERT</last-name></addressbook></inventor><inventor mxw-id="PPAR919010830" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>SHAW, ROBERT</last-name><address><street>1622 42nd Avenue South</street><city>Moorhead MN 56560</city><country>US</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR919012323" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Holst, Sönke</last-name><iid>101371590</iid><address><street>John Deere GmbH &amp; Co. KG Mannheim Regional Center Global Intellectual Property Services John-Deere-Strasse 70</street><city>68163 Mannheim</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="US-2012025992-W"><document-id><country>US</country><doc-number>2012025992</doc-number><kind>W</kind><date>20120222</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012118646-A1"><document-id><country>WO</country><doc-number>2012118646</doc-number><kind>A1</kind><date>20120907</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS549763777" load-source="docdb">AL</country><country mxw-id="DS549844030" load-source="docdb">AT</country><country mxw-id="DS549763778" load-source="docdb">BE</country><country mxw-id="DS549916149" load-source="docdb">BG</country><country mxw-id="DS549775061" load-source="docdb">CH</country><country mxw-id="DS549764153" load-source="docdb">CY</country><country mxw-id="DS549844031" load-source="docdb">CZ</country><country mxw-id="DS549763779" load-source="docdb">DE</country><country mxw-id="DS549764154" load-source="docdb">DK</country><country mxw-id="DS549764155" load-source="docdb">EE</country><country mxw-id="DS549857876" load-source="docdb">ES</country><country mxw-id="DS549916150" load-source="docdb">FI</country><country mxw-id="DS549775062" load-source="docdb">FR</country><country mxw-id="DS549763780" load-source="docdb">GB</country><country mxw-id="DS549764156" load-source="docdb">GR</country><country mxw-id="DS549763789" load-source="docdb">HR</country><country mxw-id="DS549844032" load-source="docdb">HU</country><country mxw-id="DS549857877" load-source="docdb">IE</country><country mxw-id="DS549764161" load-source="docdb">IS</country><country mxw-id="DS549916151" load-source="docdb">IT</country><country mxw-id="DS549764162" load-source="docdb">LI</country><country mxw-id="DS549916152" load-source="docdb">LT</country><country mxw-id="DS549843257" load-source="docdb">LU</country><country mxw-id="DS549916153" load-source="docdb">LV</country><country mxw-id="DS549916154" load-source="docdb">MC</country><country mxw-id="DS549843262" load-source="docdb">MK</country><country mxw-id="DS549843263" load-source="docdb">MT</country><country mxw-id="DS549843264" load-source="docdb">NL</country><country mxw-id="DS549844033" load-source="docdb">NO</country><country mxw-id="DS549843265" load-source="docdb">PL</country><country mxw-id="DS549764163" load-source="docdb">PT</country><country mxw-id="DS549844870" load-source="docdb">RO</country><country mxw-id="DS549764164" load-source="docdb">RS</country><country mxw-id="DS549843278" load-source="docdb">SE</country><country mxw-id="DS549763790" load-source="docdb">SI</country><country mxw-id="DS549844038" load-source="docdb">SK</country><country mxw-id="DS549844039" load-source="docdb">SM</country><country mxw-id="DS549857894" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA99830440" ref-ucid="WO-2012118646-A1" lang="EN" load-source="patent-office"><p num="0000">A data processor determines whether a composite torque command Is larger than a preset torque threshold for a time Interval |S302). The composite torque command is convertible into a direct-axis current command and a quadrature-axis current command (S302). The data processor determines whether a rotor speed of the motor is less than a preset speed threshold for the lime interval (S3Q4), The data processor, the current adjustment module, or the current shaping module adjusts the direct-axis current command and the quadrature-axis current command to obtain a revised direct-axis current command and revised quadrature-axis current command for the time interval if the composite torque command Is larger than the preset torque threshold and If the rotor speed is less than the preset speed threshold (S308){ where the revised current commands vary by the detected rotational position of the rotor to achieve a generally constant shaft torque output.</p></abstract><abstract mxw-id="PA100327268" ref-ucid="WO-2012118646-A1" lang="EN" source="national office" load-source="docdb"><p>A data processor determines whether a composite torque command Is larger than a preset torque threshold for a time Interval |S302). The composite torque command is convertible into a direct-axis current command and a quadrature-axis current command (S302). The data processor determines whether a rotor speed of the motor is less than a preset speed threshold for the lime interval (S3Q4), The data processor, the current adjustment module, or the current shaping module adjusts the direct-axis current command and the quadrature-axis current command to obtain a revised direct-axis current command and revised quadrature-axis current command for the time interval if the composite torque command Is larger than the preset torque threshold and If the rotor speed is less than the preset speed threshold (S308){ where the revised current commands vary by the detected rotational position of the rotor to achieve a generally constant shaft torque output.</p></abstract><abstract mxw-id="PA99830441" ref-ucid="WO-2012118646-A1" lang="FR" load-source="patent-office"><p num="0000">Un processeur de données détermine si une consigne de couple composite est supérieure à un seuil de couple prédéfini pour un intervalle de temps (S302). La consigne de couple composite peut être convertie en une consigne de courant longitudinal et en une consigne de courant transversal (S302). Le processeur de données détermine si une vitesse du rotor du moteur est inférieure à un seuil de vitesse prédéfini pour l'intervalle de temps (S304). Le processeur de données, le module d'ajustement du courant ou le module de mise en forme du courant ajuste la consigne du courant longitudinal et la consigne du courant transversal de façon à obtenir une consigne de courant longitudinal révisée et une consigne de courant transversal révisée pour l'intervalle de temps si la consigne de couple composite est supérieure au seuil de couple prédéfini et si la vitesse du rotor est inférieure au seuil de vitesse prédéfini (S308), les consignes de courant révisées variant en fonction de la position rotationnelle détectée du rotor de façon à obtenir une sortie de couple de l'axe généralement constante.</p></abstract><abstract mxw-id="PA100327269" ref-ucid="WO-2012118646-A1" lang="FR" source="national office" load-source="docdb"><p>Un processeur de données détermine si une consigne de couple composite est supérieure à un seuil de couple prédéfini pour un intervalle de temps (S302). La consigne de couple composite peut être convertie en une consigne de courant longitudinal et en une consigne de courant transversal (S302). Le processeur de données détermine si une vitesse du rotor du moteur est inférieure à un seuil de vitesse prédéfini pour l'intervalle de temps (S304). Le processeur de données, le module d'ajustement du courant ou le module de mise en forme du courant ajuste la consigne du courant longitudinal et la consigne du courant transversal de façon à obtenir une consigne de courant longitudinal révisée et une consigne de courant transversal révisée pour l'intervalle de temps si la consigne de couple composite est supérieure au seuil de couple prédéfini et si la vitesse du rotor est inférieure au seuil de vitesse prédéfini (S308), les consignes de courant révisées variant en fonction de la position rotationnelle détectée du rotor de façon à obtenir une sortie de couple de l'axe généralement constante.</p></abstract><description mxw-id="PDES51232250" ref-ucid="WO-2012118646-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="3"/>--><p id="p0001" num="0001"> METHOD AND SYSTEM FOR CONTROLLING AN ELECTRIC MOTOR AT OR NEAR STALL CONDITIONS </p><p id="p0002" num="0002">This document claims priority based on U.S. provisional application serial number 61/447,323, filed on 28 February 2011 and entitled METHOD AND SYSTEM FOR CONTROLLING AN ELECTRIC MOTOR AT OR NEAR STALL CONDITIONS, under 35 U.S.C. 119(e). </p><p id="p0003" num="0003">Field of the Invention </p><p id="p0004" num="0004"> This invention relates to a method and system for controlling an electric motor at or near stall conditions. </p><p id="p0005" num="0005">Background of the Invention </p><p id="p0006" num="0006"> An electric motor may feature a rotor with permanent magnets and a stator, such as an interior permanent magnet (IPM) motor, an IPM synchronous motor, a surface mount permanent magnet motor, or another permanent magnet motor configuration. An electric motor may be used for vehicle propulsion, which often requires a wide speed range of motor control. </p><p id="p0007" num="0007"> A stall condition means that a torque load is applied to an electric motor that causes the shaft speed of the motor to become or approach zero revolutions per minute. For example, a stall condition may be experienced if a vehicle propelled by an electric motor starts from a stationary position, if the vehicle is heavily loaded, if a vehicle is pulling a trailer or implement, or if the vehicle is heading up incline. At lower operational speeds that approach a stall condition, the electric motor may experience transient torque ripple, torque output oscillation or variable torque output. The passenger or operator of a vehicle may notice or complain about oscillatory, jittery or jerky movement of a vehicle with transient or variable torque output. Thus, there is a need for a method and system for controlling an electric motor at or near stall conditions to provide a uniform or stable torque output at lower operational speeds that approach a stall condition. </p><p id="p0008" num="0008">Summary of the Invention </p><p id="p0009" num="0009"> In accordance with one embodiment, a method and system is presented for controlling an electric motor at or near stall operational conditions. A sensor 
<!-- EPO <DP n="4"/>-->
 detects a rotational position of a rotor of the electric motor. A data processor determines whether a composite torque command is larger than a preset torque threshold for a time interval. The composite torque command is convertible into a direct-axis current command and a quadrature-axis current command. The data processor determines whether a motor speed of the rotor is less than a preset speed threshold for the time interval. The data processor, the current adjustment module, or the current shaping module adjusts the direct-axis current command and the quadrature-axis current command to obtain a revised direct-axis current command and revised quadrature-axis current command for the time interval if the composite torque command is larger than the preset torque threshold and if the rotor speed is less than the preset speed threshold, where the revised current commands (or the torque stall coefficient) vary by the detected rotational position of the rotor to achieve a generally constant shaft torque output. </p><p id="p0010" num="0010">Brief Description of the Drawings </p><p id="p0011" num="0011"> FIG. 1 is a block diagram of one embodiment of a system for controlling an electric motor at or near stall conditions. </p><p id="p0012" num="0012"> FIG. 2 is a block diagram of an electronic data processing system of FIG. 1.</p><p id="p0013" num="0013">FIG. 3 is a flow chart of a first example of a method for controlling an electric motor at or near stall conditions. </p><p id="p0014" num="0014"> FIG. 4 is a flow chart of a second example of a method for controlling an electric motor at or near stall conditions. </p><p id="p0015" num="0015"> FIG. 5 is a flow chart of a third example of a method for controlling an electric motor at or near stall conditions. </p><p id="p0016" num="0016"> FIG. 6 is a cross section of an illustrative embodiment of a motor (e.g. an interior permanent magnet motor). </p><p id="p0017" num="0017">Description of the Preferred Embodiment In accordance with one embodiment, FIG. 1 discloses system for controlling a motor 117 (e.g., an interior permanent magnet (IPM) motor) or another alternating current machine. In one embodiment, the system, aside from the motor 117, may be referred to as an inverter or a motor controller. </p><p id="p0018" num="0018"> The system comprises electronic modules, software modules, or both. In one 
<!-- EPO <DP n="5"/>-->
 embodiment, the motor controller comprises an electronic data processing system 120 to support storing, processing or execution of software instructions of one or more software modules. The electronic data processing system 120 is indicated by the dashed lines in FIG. 1 and is shown in greater detail in FIG. 2. </p><p id="p0019" num="0019"> The data processing system 20 is coupled to an inverter circuit 188. The inverter circuit 188 comprises a semiconductor drive circuit that drives or controls switching semiconductors (e.g., insulated gate bipolar transistors (IGBT) or other power transistors) to output control signals for the motor 117. In turn, the inverter circuit 188 is coupled to the motor 117. The motor 117 is associated with a sensor 115 (e.g., a position sensor, a resolver or encoder position sensor) that is associated with the motor shaft 126 or the rotor. The sensor 115 and the motor 117 are coupled to the data processing system 120 to provide feedback data (e.g., current feedback data, such as i<sub>a</sub>, i<sub>b</sub>, ic), raw position signals, among other possible feedback data or signals, for example. Other possible feedback data includes, but is not limited to, winding temperature readings, semiconductor temperature readings of the inverter circuit 188, three phase voltage data, or other thermal or performance information for the motor 117. </p><p id="p0020" num="0020"> In one embodiment, the torque command generation module 105 is coupled to a d-q axis current generation manager 109 (e.g., d-q axis current generation lookup tables). D-q axis current refers to the direct axis current and the quadrature axis current as applicable in the context of vector-controlled alternating current machines, such as the motor 117. The output of the d-q axis current generation manager 109 and the output of a current adjustment module 107 (e.g., d-q axis current adjustment module 107) are fed to a summer 119. In turn, one or more outputs (e.g., direct axis current data (i<sub>d</sub>*) and quadrature axis current data (i<sub>q</sub>*)) of the summer 119 are provided or coupled to a current regulation controller 111. </p><p id="p0021" num="0021"> The current regulation controller 111 is capable of communicating with the pulse-width modulation (PWM) generation module 112 (e.g., space vector PWM generation module). The current regulation controller 111 receives respective d-q axis current commands (e.g., i<sub>d</sub>* and i<sub>q</sub>*) and actual d-q axis currents (e.g., i<sub>d</sub> and i<sub>q</sub>) and outputs corresponding d-q axis voltage commands (e.g., v<sub>d</sub>* and v<sub>q</sub>* commands) for input to the PWM generation module 112. </p><p id="p0022" num="0022"> In one embodiment, the PWM generation module 112 converts the direct axis 
<!-- EPO <DP n="6"/>-->
 voltage and quadrature axis voltage data from two phase data representations into three phase representations (e.g., three phase voltage representations, such as v<sub>a</sub>*, v<sub>b</sub>* and v<sub>c</sub>*) for control of the motor 117, for example. Outputs of the PWM generation module 112 are coupled to the inverter 188. </p><p id="p0023" num="0023"> The inverter circuit 188 comprises power electronics, such as switching semiconductors to generate, modify and control pulse-width modulated signals or other alternating current signals (e.g., pulse, square wave, sinusoidal, or other waveforms) applied to the motor 117. The PWM generation module 112 provides inputs to a driver stage within the inverter circuit 188. An output stage of the inverter circuit 188 provides a pulse-width modulated signal or other alternating current signal for control of the motor. In one embodiment, the inverter 188 is powered by a direct current (DC) voltage bus. </p><p id="p0024" num="0024"> The motor 117 is associated with a sensor 115 (e.g., a resolver, encoder, speed sensor, or another position sensor or sensors) that estimates at least one of an angular position of the motor shaft 126, a speed or velocity of the motor shaft 126, and a direction of rotation of the motor shaft 126. The sensor 115 may be mounted on or integral with the motor shaft 126. The output of the sensor 115 is capable of communication with the primary processing module 114 (e.g., position and speed processing module). In one embodiment, the sensor 115 may be coupled to an analog-to-digital converter (not shown) that converts analog position data or velocity data to digital position or velocity data, respectively. In other embodiments, the sensor 115 (e.g., digital position encoder) may provide a digital data output of position data or velocity data for the motor shaft 126 or rotor. </p><p id="p0025" num="0025"> A first output (e.g., position data and speed data for the motor 117) of the primary processing module 114 is communicated to the phase converter 113 (e.g., three-phase to two-phase current Park transformation module) that converts respective three-phase digital representations of measured current into corresponding two-phase digital representations of measured current. A second output (e.g., speed data) of the primary processing module 114 is communicated to the calculation module 110 (e.g., adjusted voltage over speed ratio module). </p><p id="p0026" num="0026"> An input of a sensing circuit 124 is coupled to terminals of the motor 117 for sensing at least the measured three-phase currents and a voltage level of the direct current (DC) bus (e.g., high voltage DC bus which may provide DC power to the 
<!-- EPO <DP n="7"/>-->
 inverter circuit 188). An output of the sensing circuit 124 is coupled to an analog-to- digital converter 122 for digitizing the output of the sensing circuit 124. In turn, the digital output of the analog-to-digital converter 122 is coupled to the secondary processing module 116 (e.g., Direct current (DC) bus and three phase current processing module). For example, the sensing circuit 124 is associated with the motor 117 for measuring three phase currents (e.g., current applied to the windings of the motor 117, back EMF induced into the windings, or both). </p><p id="p0027" num="0027"> Certain outputs of primary processing module 114 and the secondary processing module 116 feed the phase converter 113. For example, the phase converter 113 may apply a Park transformation or other conversion equations (e.g., certain conversion equations that are suitable are known to those of ordinary skill in the art) to convert the measured three-phase representations of current into two- phase representations of current based on the digital three-phase current data from the secondary processing module 116 and position data from the sensor 115. The output of the phase converter 113 module is coupled to the current regulation controller 111. </p><p id="p0028" num="0028"> Other outputs of the primary processing module 114 and the secondary processing module 116 may be coupled to inputs of the calculation module 110 (e.g., adjusted voltage over-speed ratio calculation module). For example, the primary processing module 114 may provide speed data (e.g., motor shaft 126 revolutions per minute), whereas the secondary processing module 116 may provide a measured level of direct current voltage (e.g., on the direct current (DC) bus of a vehicle). The direct current voltage level on the DC bus that supplies the inverter circuit 188 with electrical energy may fluctuate or vary because of various factors, including, but not limited to, ambient temperature, battery condition, battery charge state, battery resistance or reactance, fuel cell state (if applicable), motor load conditions, respective motor torque and corresponding operational speed, and vehicle electrical loads (e.g., electrically driven air-conditioning compressor). The calculation module 110 is connected as an intermediary between the secondary processing module 116 and the dq-axis current generation manager 109. The output of the calculation module 110 can adjust or impact current commands generated by the d-q axis current generation manager 109 to compensate for fluctuation or variation in direct current bus voltage, among other things. 
<!-- EPO <DP n="8"/>-->
 The rotor magnet temperature estimation module 104, the current shaping module 106, and the terminal voltage feedback module 108 are coupled to or are capable of communicating with the dq-axis current adjustment module 107. In turn, the d-q axis current module 107 may communicate with the dq-axis current generation manager or the summer 119. </p><p id="p0029" num="0029"> The rotor magnet temperature module 104 estimates or determines the temperature of the rotor permanent magnet or magnets. In one embodiment, the rotor magnet temperature estimation module 104 may estimate the temperature of the rotor magnets from internal control variables calculation, one or more sensors located on the stator, in thermal communication with the stator, or secured to the housing of the motor 117. </p><p id="p0030" num="0030"> In one alternate embodiment, the rotor magnet temperature estimation module 104 may be replaced by or may estimate the temperature of the rotor magnets from one or more sensors located on the stator, in thermal communication with the stator, or secured to the housing of the motor 117. </p><p id="p0031" num="0031"> In another alternative embodiment, the rotor magnet temperature estimation module 104 may be replaced with a temperature detector (e.g., a thermistor or infrared thermal detector coupled to a wireless transmitter) mounted on the rotor or the magnet, where the detector provides a signal (e.g., wireless signal) indicative of the temperature of the magnet or magnets. </p><p id="p0032" num="0032"> In one embodiment, the method or system may operate in the following manner. The torque command generation module 105 receives an input control data message, such as a speed control data message, a voltage control data message, or a torque control data message, over a vehicle data bus 118. The torque command generation module 105 converts the received input control message into torque control command data 316. </p><p id="p0033" num="0033"> The d-q axis current generation manager 109 selects or determines the direct axis current command data and the quadrature axis current command data associated with respective torque control command data and respective detected motor shaft 126 speed data. For example, the d-q axis current generation manager 109 selects or determines the direct axis current command, the quadrature axis current command by accessing one or more of the following: (1) a look-up table, database or other data structure that relates respective torque commands to 
<!-- EPO <DP n="9"/>-->
 corresponding direct and quadrature axes currents, (2) a set of quadratic equations or linear equations that relate respective torque commands to corresponding direct and quadrature axes currents, or (3) a set of rules (e.g., if-then rules) that relates respective torque commands to corresponding direct and quadrature axes currents. The sensor 115 on the motor 117 facilitates provision of the detected speed data for the motor shaft 126, where the primary processing module 114 may convert position data provided by the sensor 115 into speed data. </p><p id="p0034" num="0034"> The current adjustment module 107 (e.g., d-q axis current adjustment module) provides current adjustment data to adjust the direct axis current command data and the quadrature axis current command data based on input data from the rotor magnet temperature estimation module 104 and the current shaping module 106. </p><p id="p0035" num="0035"> The current shaping module 106 may determine a correction or preliminary adjustment of the quadrature axis (q-axis) current command and the direct axis (d- axis) current command based on one or more of the following factors: torque load on the motor 117 and speed of the motor 117, for example. The rotor magnet temperature estimation module 104 may generate a secondary adjustment of the q- axis current command and the d-axis current command based on an estimated change in rotor temperature, for example. The terminal voltage feedback module 108 may provide a third adjustment to d-axis and q-axis current based on controller voltage command versus voltage limit. The current adjustment module 107 may provide an aggregate current adjustment that considers one or more of the following adjustments: a preliminary adjustment, a secondary adjustment, and a third adjustment. </p><p id="p0036" num="0036"> The sensor 115 (e.g. , shaft or rotor speed detector) may comprise one or more of the following: a direct current motor, an optical encoder, a magnetic field sensor (e.g., Hall Effect sensor), magneto-resistive sensor, and a resolver (e.g., a brushless resolver). In one configuration, the sensor 115 comprises a position sensor, where position data and associated time data are processed to determine speed or velocity data for the motor shaft 126. In another configuration, the sensor 115 comprises a speed sensor, or the combination of a speed sensor and an integrator to determine the position of the motor shaft. </p><p id="p0037" num="0037"> In yet another configuration, the sensor 115 comprises an auxiliary, compact direct current generator that is coupled mechanically to the motor shaft 126 of the 
<!-- EPO <DP n="10"/>-->
 motor 117 to determine speed of the motor shaft 126, where the direct current generator produces an output voltage proportional to the rotational speed of the motor shaft 126. In still another configuration, the sensor 115 comprises an optical encoder with an optical source that transmits a signal toward a rotating object coupled to the shaft 126 and receives a reflected or diffracted signal at an optical detector, where the frequency of received signal pulses (e.g., square waves) may be proportional to a speed of the motor shaft 126. In an additional configuration, the sensor 115 comprises a resolver with a first winding and a second winding, where the first winding is fed with an alternating current, where the voltage induced in the second winding varies with the frequency of rotation of the rotor. </p><p id="p0038" num="0038"> In FIG. 2, the electronic data processing system 120 comprises an electronic data processor 264, a data bus 262, a data storage device 260, and one or more data ports (268, 270, 272, 274 and 276). The data processor 264, the data storage device 260 and one or more data ports are coupled to the data bus 262 to support communications of data between or among the data processor 264, the data storage device 260 and one or more data ports. </p><p id="p0039" num="0039"> In one embodiment, the data processor 264 may comprise one or more of the following electronic components: an electronic data processor, a microprocessor, a microcontroller, a programmable logic array, a field programmable gate array (FPGA), a logic circuit, an arithmetic logic unit, an application specific integrated circuit, a digital signal processor (DSP), a proportional-integral-derivative (PID) controller, or another data processing device. The above electronic components may be interconnected via one or more data buses, parallel data buses, serial data buses, or any combination of parallel and serial data buses, for example. </p><p id="p0040" num="0040"> The data storage device 260 may comprise any magnetic, electronic, or optical device for storing data. For example, the data storage device 260 may comprise an electronic data storage device, an electronic memory, non-volatile electronic random access memory, one or more electronic data registers, data latches, a magnetic disc drive, a hard disc drive, an optical disc drive, or the like. </p><p id="p0041" num="0041"> As shown in FIG. 2, the data ports comprise a first data port 268, a second data port 270, a third data port 272, a fourth data port 274 and a fifth data port 276, although any suitable number of data ports may be used. Each data port may 
<!-- EPO <DP n="11"/>-->
 comprise a transceiver and buffer memory, for example. In one embodiment, each data port may comprise any serial or parallel input/output port. </p><p id="p0042" num="0042"> In one embodiment as illustrated in FIG. 2, the first data port 268 is coupled to the vehicle data bus 118. In turn, the vehicle data bus 118 is coupled to the controller 266. In one configuration, the second data port 270 may be coupled to the inverter circuit 188; the third data port 272 may be coupled to the sensor 115; the fourth data port 274 may be coupled to the analog-to-digital converter 122; and the fifth data port 276 may be coupled to the terminal voltage feedback module 108. The analog-to-digital converter 122 is coupled to the sensing circuit 124. </p><p id="p0043" num="0043"> In one embodiment of the data processing system 120, the torque command generation module 105 is associated with or supported by the first data port 268 of the electronic data processing system 120. The first data port 268 may be coupled to a vehicle data bus 118, such as a controller area network (CAN) data bus. The vehicle data bus 118 may provide data bus messages with torque commands to the torque command generation module 105 via the first data port 268. The operator of a vehicle may generate the torque commands via a user interface, such as a throttle, a pedal, a controller 266, or other control device. </p><p id="p0044" num="0044"> In certain embodiments, the sensor 115 and the primary processing module 114 may be associated with or supported by a third data port 272 of the data processing system 120. </p><p id="p0045" num="0045"> FIG. 3 discloses a first illustrative example of a method for controlling a motor (e.g., 117) at or near stall conditions. A stall condition means that a torque load is applied to an electric motor (e.g., 117) that causes the shaft speed of the motor (e.g., 117) to become or approach zero revolutions per minute. As the electric motor (e.g., 117) operates at very low speeds (e.g., below approximately 100 revolutions per minute) that approach stall conditions the electric motor (e.g., 117) may provide an undesired oscillating torque output or an undesired torque output with ripple, without the control method set forth in FIG. 3. For example, the oscillating torque output may be described as a somewhat sinusoidal variation of the magnitude of output torque over a time period. </p><p id="p0046" num="0046"> The method of FIG. 3 begins in step S300 to reduce or eliminate oscillating torque output or an undesired torque output with ripple near or at stall conditions. 
<!-- EPO <DP n="12"/>-->
 In step S300, a sensor 115 detects a rotational position of a rotor of the electric motor (e.g., 117). For example, the sensor 115 may provide raw position signals on the rotational position of the rotor to a primary processing module 114, where the primary processing module 114 refines the detected rotational position or determines a motor (e.g., 117) speed of the rotor based on the detected rotational position versus time. The rotational position may be expressed as an angle of the rotor with respect to the stator, where the angle ranges from zero to 360 degrees, or where the angle is expressed in radians. The primary processing module 114 may comprise a clock or clock signal for determining the time between detected rotational positions for purposes of determining a motor (e.g., 117) speed of the rotor. </p><p id="p0047" num="0047"> In step S302, a data processor 264, a current adjustment module 107, or a current regulation controller 111 determines whether a composite torque command is larger than a preset torque threshold for a time interval (e.g., one or more pulse- width modulation cycles of the inverter switching circuit 188), where the composite torque is convertible into a direct-axis current command and a quadrature-axis current command. In one embodiment, the composite torque command may be expressed as a percentage, fraction, or portion of a reference torque of the motor 117. The data processor 264 may convert the composite torque command into a direct-axis current command and a quadrature-axis current command. The reference torque of the motor may be defined in accordance with one or more of the following: (1) the reference torque is equal to or approximates a maximum torque of the motor; (2) the reference torque is equal to or approximates a stall torque of the motor reduced by a tolerance margin, where the stall torque is the torque of the motor when the motor has stalled (e.g., zero revolutions per minute of shaft speed or rotor speed); or (3) the reference torque is equal to or approximates a target torque of the motor at some corresponding reference rotor speed or within a speed range of the rotor speed (e.g., lower speed or lower speed range that does not produce wheel spin for a vehicle under specified operation conditions, tire parameters, or ground parameters); (4) the reference torque is equal to or less than a torque on an operational torque versus speed output curve (e.g., motor characteristic torque curve) for the motor, based on the sensed rotor speed for the motor; (5) the reference torque is consistent with a maximum torque per ampere (MTPA) current trajectory associated with a low speed range of the motor 117; and (6) the reference 
<!-- EPO <DP n="13"/>-->
 torque is consistent with a maximum torque or peak torque for a particular corresponding application of the motor or based on the motor specifications or design. </p><p id="p0048" num="0048"> In one embodiment, the composite torque command may be used to determine an absolute torque command that is based on the composite torque in percentage multipled by the reference torque of the motor, where the absolute torque is a number expressed in newton-meters, foot-pounds, inch ounce force, or other similar units. </p><p id="p0049" num="0049"> Step S302 may be carried out in accordance with various procedures that may be applied alternately or cumulatively. Under a first procedure, the composite torque command comprises a torque command (e.g., stall torque command) expressed as a percentage of the reference torque, where the preset threshold is determined based on motor specifications, empirical tests, field tests, or a torque versus speed characteristic curve determined for the motor during a motor test and characterization process. </p><p id="p0050" num="0050"> Under a second procedure, the preset torque threshold is typically around eighty percent (80%) to eighty-five percent (85%) of the reference torque. As used in this document, "around" shall mean plus or minus ten percent of the reference torque or any other number that it modifies. The actual percentage of the preset threshold torque may depend upon the application of the motor (e.g., vehicle size, vehicle weight, among other things) and the motor design of the motor, for example. For an intemal permanent magnet motor (e.g., 117), the machine characterization at low speed generates a maximum torque per ampere (MTPA) current trajectory. Along the MTPA current trajectory, the quadrature-axis current command (lq*) is varying versus the direct-axis current command (Id*) as the composite or total torque command increases. When the composite or total torque command exceeds the preset threshold (e.g., 80%), the ratio between the quadrature-axis current command and the direct axis current command is generally fixed (e.g., for optimum performance). </p><p id="p0051" num="0051"> Under a third procedure, the preset torque threshold is around eighty to eighty-five percent of peak torque of the motor (e.g., 117). </p><p id="p0052" num="0052"> Under a fourth procedure, the preset torque threshold is approximately eighty percent of a maximum stall torque, or around eighty percent of a torque that is 
<!-- EPO <DP n="14"/>-->
 produced when the motor shaft has a rotational speed equal to zero or approaching zero. </p><p id="p0053" num="0053"> In step S304, a sensor 115, the primary processing module 114 or the data processor 264 determines whether a rotor speed of the motor is less than a preset speed threshold for the time interval (e.g., one or more pulse width modulation cycles). Under a first example, the preset speed threshold is around 50 revolutions per minute (rpm) to around 100 revolutions per minute (rpm). Under a second example, the preset speed threshold is less than or equal to approximately one- hundred revolutions per minute. As used in this document, "approximately" shall mean plus or minus five percent of the revolutions per minute, torque or any other number that it modifies. </p><p id="p0054" num="0054"> In step S306, the data processor 264, the current adjustment module 107, or the current regulation controller 111 adjusts the direct-axis current command and the quadrature-axis current command to obtain a revised direct-axis current command and revised quadrature-axis current command for the time interval if the composite torque command is larger than the preset torque threshold and if the rotor speed is less than the preset speed threshold, where the revised current commands vary by the detected rotational position of the rotor to achieve a generally constant shaft torque output. </p><p id="p0055" num="0055"> In accordance with one technique for carrying out step S306, the data processor 264 or d-q axis current generation manager 109 retrieves the d-q axis commands from one or more multi-dimensional tables or other multi-dimensional data structure in the data storage device 260. The direct-axis current command may be retrieved from a three dimensional table (e.g., first three dimensional table), database, file, or data record (in the data storage device 260) that contains relationships between torque command data 3 6, speed data (e.g., adjusted voltage- over-speed ratio data 318), and a direct-axis current command. For example, a first three dimensional table may store various combinations or permutations of associated torque command data 316, speed data, and direct-axis current commands. In one embodiment, the quadrature-axis current command may be retrieved from a three dimensional table (e.g., second three dimensional table), database, file, or data record (in the data storage device 260) that contains relationships between torque command data 316, speed data (e.g., adjusted voltage- 
<!-- EPO <DP n="15"/>-->
 over-speed ratio data), and a quadrature-axis current command. For example, the second three dimensional table may store various combinations or permutations of associated torque command data, speed data, and quadrature-axis current commands. In one illustrative example, the revised direct-axis current command and revised quadrature-axis current command may be obtained by multiplying (e.g., dynamically or in real time) the direct-axis command and the quadrature-axis command by one more stall torque coefficients, for example. Step S306 may be executed in accordance with various techniques that may be applied alternately or cumulatively. Under a first technique, the data processor 264, current adjustment module 107, the d-q axis current generation manager 109, or the current regulation controller 111 determines or applies (or is adapted to determine or adapted to apply) the revised current commands to the motor (e.g., 117) to minimize or reduce torque oscillation, where the motor (e.g., 117) comprises a permanent magnet motor (e.g., 117) with stator slots in a stator and permanent magnets associated with the rotor. Here, "adapted to determine" or "adapted to apply" means the data processor 264 is configured to execute software instructions stored on the data storage device 260, where the software instructions may be configured as a current adjustment module 107, the d-q axis current generation manager 109, or a current regulation controller 111 , for example. </p><p id="p0056" num="0056"> Under a second technique, the data processor 264, the d-q axis current generation manager, 109, the current adjustment module 107, or current regulation controller 111 determines or selects (or is adapted to determine or adapted to select) the revised current commands such that a constant shaft torque output can be obtained at every rotor position across each slot span (or stator slot span), where in the absence of the revised current commands a maximum peak stall torque would occur approximately at a radial midpoint of each slot span of a stator of the motor (e.g., 117) and a minimum peak stall torque would occur approximately at a radial midpoint of each slot opening (or slot span) of a stator of the motor. A slot span means the stator slot opening and an intervening stator portion (e.g., approximately one-half of the intervening stator portion) that adjoins each side of the stator slot opening. In one embodiment, the slot span means the stator slot opening and approximately one-half of the intervening stator portion that adjoins each side of the stator slot opening, where a radial angle (e.g., with a vertex extending from the shaft 
<!-- EPO <DP n="16"/>-->
 outward) intercepts and divides each intervening stator portion into two equal halves or radial segments. Here, "adapted to determine" or "adapted to apply" means the data processor 264 is configured to execute software instructions stored on the data storage device, where the software instructions may be configured as a current adjustment module 107 or a current regulation controller 111 , for example. </p><p id="p0057" num="0057"> Under a third technique, the data processor 264, the d-q axis current generation manager 109, the current adjustment module 107, or current regulation controller 111 determines or selects (or is adapted to determine or adapted to select) the revised current commands such that a constant shaft torque output can be obtained throughout the whole rotor periphery and the output torque is generally uniform across each slot span. Here, adapted to determine or adapted to select means the data processor 264 is configured to execute software instructions stored on the data storage device, where the software instructions may be configured as a current adjustment module 107 or a current regulation controller 111 , for example. </p><p id="p0058" num="0058"> Under a fourth technique, the data processor 264, current adjustment module 107, or current regulation controller 111 determines (or is "adapted to determine") revised quadrature-axis current command and the revised direct-axis current command are determined by multiplying a stall torque coefficient by the direct-axis current command and the quadrature-axis current command. The stall torque coefficient and corresponding rotor position may be stored in a multi-dimensional data structure or a multi-dimensional lookup table (e.g., a two dimensional lookup table), a database, a file, a lookup table or other data format stored in a data storage device 260. The look-up table with pairs of stall torque coefficients and corresponding rotor positions may be referred to as third look-up table. Here, adapted to determine means the data processor 264 is configured to execute software instructions stored on the data storage device 260, where the software instructions may be configured as a current adjustment module 107, the d-q axis current generation manager 109, or a current regulation controller 111 , for example. </p><p id="p0059" num="0059"> The method of FIG. 4 is similar to the method of FIG. 3, except the method of FIG. 4 further includes step S308. Like reference numbers indicate like steps or procedures in FIG. 3 and FIG. 4. </p><p id="p0060" num="0060"> In step S308, the data processor 264, the current adjustment module 107, the d-q axis current generation manager 109, or the current regulation controller 111 
<!-- EPO <DP n="17"/>-->
 determines the revised quadrature-axis current command and the revised direct-axis current command by multiplying a stall torque coefficient by the direct-axis current command and a quadrature-axis current command, wherein the stall torque coefficient is defined by a corresponding detected rotor position. </p><p id="p0061" num="0061"> As previously indicated, the direct-axis current command and the quadrature- axis current command are first determined and then the revised direct axis-current command and the quadrature-axis current command are determined. In one embodiment, the direct-axis current command may be retrieved from a multidimensional data structure or a multi-dimensional table (e.g., first three dimensional table), database, file, or data record that contains relationships between torque command data 316, speed data (e.g., adjusted voltage-over-speed ratio data 318), and a direct-axis current command. For example, a first three dimensional table may store various combinations or permutations of associated torque command data 316, speed data, and direct-axis current commands. In one embodiment, the quadrature- axis current command may be retrieved from a multi-dimensional data structure or a three dimensional table (e.g., second three dimensional table), database, file, or data record that contains relationships between torque command data 316, speed data (e.g., adjusted voltage- over-speed ratio data 318), and a quadrature-axis current command. For example, the second three dimensional table may store various combinations or permutations of associated torque command data 316, speed data, and quadrature-axis current commands. </p><p id="p0062" num="0062"> In one illustrative example, the revised direct-axis current command and revised quadrature-axis current command may be obtained by multiplying (e.g., dynamically or in real time) the direct-axis command and the quadrature-axis command by one more stall torque coefficients, for example. For example, the stall torque coefficient may vary based on the corresponding detected rotor position of the rotor of the motor. </p><p id="p0063" num="0063"> For an internal permanent magnet motor (e.g., 117), the machine characterization at low speed generates a maximum torque per ampere ( TPA) current trajectory. Along the MTPA current trajectory, the quadrature-axis current command (lq*) is varying versus the direct-axis current command (Id*) as the composite or total torque command increases. When the composite or total torque command exceeds the preset threshold (e.g., 80%), the ratio between the 
<!-- EPO <DP n="18"/>-->
 quadrature-axis current command and the direct axis current command is generally fixed. If the current shaping module 106 or data processor 264 multiplies the original direct-axis current command and the original quadrature-axis current command by the current shaping coefficient or a stall torque coefficient, it is still along or consistent with the best efficiency MTPA current trajectory. </p><p id="p0064" num="0064"> The method of FIG. 5 is similar to the method of FIG. 3, except the method of FIG. 5 further includes step S301 and S310. Like reference numbers indicate like steps or procedures in FIG. 3 and FIG. 5. </p><p id="p0065" num="0065"> In step S300, a sensor 115 detects a rotational position of a rotor of the electric motor (e.g., 117). For example, the sensor 115 may provide raw position signals on the rotational position of the rotor to a primary processing module 114, where the primary processing module 114 refines the detected rotational position or determines a rotor speed of the motor based on the detected rotational position versus time. The primary processing module 114 may comprise a clock or clock signal for determining the time between detected rotational positions for purposes of determining a motor (e.g., 117) speed of the rotor. </p><p id="p0066" num="0066"> In step S301 , a data processor 264 or d-q axis current generation manager 109 generates or determines a direct axis current command and a corresponding quadrature axis current command consistent with or based on the composite torque command from a data message input via a vehicle data bus. For example, the data processor 264 or the d-q axis current generation manager 109 converts the composite torque command into a direct axis current command and a corresponding quadrature axis current command. In one embodiment, the direct-axis current command is determined by accessing a first multi-dimensional data structure, such as a first look-up table, a database, a file, a data record, or other data structure stored in a data storage device 260 based on a data message input via a vehicle data bus. Similarly, the quadrature-axis current command is determined by accessing a second multi-dimensional data structure, such as a second look-up table, a database, a file, a data record, or other data structure stored in a data storage device 260 based on a data message input via a vehicle data bus. The first multi-dimensional data structure, the second multi-dimensional data structure, or both may be obtained from a motor characterization procedure, from empirical studies, motor (e.g., 117) testing, or motor (e.g., 117) specifications, for instance. 
<!-- EPO <DP n="19"/>-->
 In step S302, a data processor 264, a current adjustment module 107, or a current regulation controller 111 determines whether a composite torque command is larger than a preset torque threshold for a time interval. The composite torque command may be expressed a percentage, a fraction or a portion of a reference torque, for example. In one embodiment, the composite torque command comprises a stall torque command expressed as a percentage. Further details on step S302 were previously presented in conjunction with FIG. 3 and apply equally here to FIG. 5. </p><p id="p0067" num="0067"> In step S304, a sensor 115, the primary processing module 114 or the data processor 264 determines whether a rotor speed of the rotor is less than a preset speed threshold for the time interval. Under a first example, the preset speed threshold is around 50 revolutions per minute (rpm) to around 100 revolutions per minute (rpm). Under a second example, he preset speed threshold is less than or equal to approximately one-hundred revolutions per minute. Further details on step S304 were previously presented in conjunction with FIG. 3 and apply equally here to FIG. 5. </p><p id="p0068" num="0068"> In step S306, the data processor 264, the current adjustment module 107, or the current regulation controller 111 adjusts the direct-axis current command and the quadrature-axis current command to obtain a revised direct-axis current command and revised quadrature-axis current command for the time interval if the composite torque command is larger than the preset torque threshold and if the rotor speed is less than the preset speed threshold, where the revised current commands vary by the detected rotational position of the rotor to achieve a generally constant shaft torque output. Further details on step S306 were previously presented in conjunction with FIG. 3 and apply equally here to FIG. 5. </p><p id="p0069" num="0069"> In step S310, the data processor 264, current adjustment module 107 or current regulation controller 111 determines the revised quadrature-axis current command and the revised direct-axis current command by accessing a second lookup table stored in the data storage device. </p><p id="p0070" num="0070"> In one embodiment for executing step S310, the data processor 264, the current adjustment module 107, or the current regulation controller 111 accesses a third multi-dimensional data structure (e.g., a third look-up table) to determine a stall torque coefficient based on stored relationships between varying stall torque 
<!-- EPO <DP n="20"/>-->
 coefficients versus corresponding detected rotor positions. The stall torque coefficient provides the basis for determination of the revised quadrature-axis current command and the revised direct-axis current command. For example, the data processor 264, the current adjustment module 107, or current regulation controller 111 determines revised quadrature-axis current command and the revised direct- axis current command by multiplying a stall torque coefficient by the direct-axis current command and the quadrature-axis current command stored in a third look-up table in a data storage device. </p><p id="p0071" num="0071"> FIG. 6 shows an illustrative cross section of a motor 117 that may be used with the method and system described in this document. In the example of FIG. 6, the motor 600 is illustrated as an interior permanent magnet machine, although other configurations of motors or machines may be used and fall within the scope of the invention. The motor 600 may be used instead of motor 117 in FIG. 1 or FIG. 2, for example. </p><p id="p0072" num="0072"> The motor 600 comprises a stator 612 that encompasses or at least partially surrounds a radial periphery of the rotor 610. The rotor 610 is rotatable with respect to the stator 612. </p><p id="p0073" num="0073"> In the motor 600 of FIG. 6, the stator 612 comprises stator slot openings 602 that are radially spaced apart (e.g., uniformly) in the stator core 612. The stator slot openings 602 are separated by intervening stator portions 604 or islands in the stator core 612. In one embodiment, each of the intervening stator portions 604 may have a curved interior surface 605 that, in the aggregate, forms a generally cylindrical surface that is interrupted by the slot openings 602 at generally uniform radial spacings. </p><p id="p0074" num="0074"> As best illustrated by the dashed lines 617 extending from the axis 615 of the motor shaft 619, the stator slot span (e.g., 614) may comprise a stator slot opening 602 and approximately one-half of the intervening stator portions 604 on each side of the stator slot opening 602. For example, the stator slot span may be defined as extending over a radial angle 614 that intercepts the midpoint of the intervening stator portions 604, where a vertex of the radial angle 614 is coextensive with an axis 615 of motor shaft 619 of the motor 600. Stator windings 616 reside in one or more of the stator slot openings 602. 
<!-- EPO <DP n="21"/>-->
 In the motor 117, the rotor has rotor slots or rotor openings for receiving permanent magnets 608 (e.g., generally rectangular magnets or magnets with other geometric configurations) that are buried or embedded in the rotor 610. The poles of the magnets in the rotor 610 and the poles of the stator windings 616 are aligned to form a desired configuration and number of pole pairs. </p><p id="p0075" num="0075"> The system and method disclosed herein is well-suited for controlling an electric motor at or near stall conditions to provide a uniform or stable torque output at lower operational speeds that approach a stall condition. The system and method disclosed herein facilitates elimination or reduction of transient torque ripple, torque output oscillation or variable torque output at lower operational speeds of the motor that are at or near stall conditions. Accordingly, the system and method supports improved performance of electrically propelled motor vehicles such that passenger or operator of the vehicle avoids oscillatory, jittery or jerky movement of a vehicle with transient or variable torque output that would otherwise occur. This method applies to interior permanent magnet machines, surface mounted PM machines, and other machines or motors with permanent magnets. </p><p id="p0076" num="0076"> Having described the preferred embodiment, it will become apparent that various modifications can be made without departing from the scope of the invention as defined in the accompanying claims. 
</p></description><claims mxw-id="PCLM44851384" ref-ucid="WO-2012118646-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="22"/>-->The following is claimed: </claim-statement><claim id="clm-0001" num="1"><claim-text> 1. A method for controlling an electric motor at or near stall operational conditions, the method comprising: </claim-text><claim-text> detecting a rotational position of a rotor of the electric motor; </claim-text><claim-text> determining whether a composite torque command is larger than a preset torque threshold for a time interval, the composite torque command convertible into a direct-axis current command and a quadrature-axis current command; </claim-text><claim-text> determining whether a motor speed of the rotor is less than a preset speed threshold for the time interval; and </claim-text><claim-text> adjusting the direct-axis current command and the quadrature-axis current command to obtain a revised direct-axis current command and revised quadrature- axis current command for the time interval if the composite torque command is larger than the preset torque threshold and if the motor speed is less than the preset speed threshold, where the revised current commands vary by the detected rotational position of the rotor to achieve a generally constant shaft torque output. </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. The method according to claim 1 further comprising: </claim-text><claim-text> generating the dq-axis current commands from one or more multi-dimensional data structures or look-up tables based on the composite torque command. </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. The method according to claim 1 further comprising: </claim-text><claim-text> applying the revised current commands to the motor to minimize or reduce torque oscillation, where the motor comprises a permanent magnet motor with stator slots in a stator and permanent magnets associated with the rotor. <!-- EPO <DP n="23"/>--> </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. The method according to claim 3 wherein the revised current commands are selected such that a constant shaft torque output can be obtained at every rotor position across each slot span, where in the absence of the revised current commands a maximum peak stall torque would occur approximately at a radial midpoint of each slot of a stator of the motor and a minimum peak stall torque would occur approximately at a radial midpoint of each slot opening of a stator of the motor. </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. The method according to claim 3 wherein the revised current commands are selected such that a constant shaft torque output can be obtained throughout the whole rotor periphery and the output torque is generally uniform across each slot span. </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. The method according to claim 1 wherein the composite torque command comprises a stall torque command expressed as a percentage. </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. The method according to claim 1 wherein the revised quadrature-axis current command and the revised direct-axis current command are determined by </claim-text><claim-text>multiplying a stall torque coefficient by the direct-axis current command and a quadrature-axis current command, wherein the stall torque coefficient is defined by a corresponding detected rotor position. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. The method according to claim 1 wherein revised quadrature-axis current command and the revised direct-axis current command are determined by </claim-text><claim-text>multiplying a stall torque coefficient by the direct-axis current command and the <!-- EPO <DP n="24"/>--> quadrature-axis current command stored in one or more multi-dimensional look-up tables or data structures in a data storage device. </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. The method according to claim 1 wherein the preset torque threshold is around eighty to eighty-five percent of peak torque of the motor. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. The method according to claim 1 wherein the preset torque threshold is approximately eighty percent of a maximum stall torque. </claim-text></claim><claim id="clm-0011" num="11"><claim-text>11 . The method according to claim 1 wherein the preset speed threshold is around 50 revolutions per minute to around 100 rpm. </claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. The method according to claim 1 wherein the preset speed threshold is less than or equal to approximately one-hundred revolutions per minute. </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. A system for controlling an electric motor at or near stall operational conditions, the system comprising: </claim-text><claim-text> a sensor for detecting a rotational position of a rotor of the electric motor; a data processor for determining whether a composite torque command is larger than a preset torque threshold for a time interval, the composite torque command convertible into a direct-axis current command and a quadrature-axis current command, the data processor adapted to determine whether a motor speed of the rotor is less than a preset speed threshold for the time interval; and </claim-text><claim-text> a current adjustment module for adjusting the direct-axis current command and the quadrature-axis current command to obtain a revised direct-axis current <!-- EPO <DP n="25"/>--> command and revised quadrature-axis current command for the time interval if the composite torque command is larger than the preset torque threshold and if the motor speed is less than the preset speed threshold, where the revised current commands vary by the detected rotational position of the rotor to achieve a generally constant shaft torque output. </claim-text></claim><claim id="clm-0014" num="14"><claim-text>14. The system according to claim 13 further comprising: </claim-text><claim-text> a data storage device capable of communicating with the data processor via a data bus; </claim-text><claim-text> a first look-up table and a second look-up table for generating the direct-axis current command and the quadrature-axis current command, respectively, based on the composite torque command, the first and second look-up tables being stored in the data storage device. </claim-text></claim><claim id="clm-0015" num="15"><claim-text>15. The system according to claim 13 wherein the current adjustment module is configured to apply the revised current commands to the motor to minimize or reduce torque oscillation, where the motor comprises a permanent magnet motor with stator slots in a stator and permanent magnets associated with the rotor. </claim-text></claim><claim id="clm-0016" num="16"><claim-text>16. The system according to claim 15 wherein the current adjustment module is adapted to select revised current commands such that a constant shaft torque output can be obtained at every rotor position across each slot span, where in the absence of the revised current commands, a maximum peak stall torque would occur approximately at a radial midpoint of each slot of a stator of the motor and a <!-- EPO <DP n="26"/>--> minimum peak stall torque would occur approximately at a radial midpoint of each slot opening of a stator of the motor. </claim-text></claim><claim id="clm-0017" num="17"><claim-text>17. The system according to claim 16 wherein the current adjustment module is adapted to select revised current commands such that a constant shaft torque output can be obtained throughout the whole rotor periphery and the output torque is generally uniform across each slot span. </claim-text></claim><claim id="clm-0018" num="18"><claim-text>18. The system according to claim 13 wherein the composite torque command is expressed as a percentage of a reference torque. </claim-text></claim><claim id="clm-0019" num="19"><claim-text>19. The system according to claim 13 wherein the data processor determines the revised quadrature-axis current command and the revised direct-axis current command by multiplying a stall torque coefficient by the direct-axis current command and a quadrature-axis current command, wherein the stall torque coefficient is defined by a corresponding detected rotor position. </claim-text></claim><claim id="clm-0020" num="20"><claim-text>20. The system according to claim 13 wherein the data processor determines the revised quadrature-axis current command and the revised direct-axis current command by multiplying a stall torque coefficient by the direct-axis current command and the quadrature-axis current command stored in data structures in a data storage device. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
