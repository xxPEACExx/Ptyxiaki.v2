<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2683112-A1" country="EP" doc-number="2683112" kind="A1" date="20140108" family-id="48669895" file-reference-id="318308" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146585137" ucid="EP-2683112-A1"><document-id><country>EP</country><doc-number>2683112</doc-number><kind>A1</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12174736-A" is-representative="YES"><document-id mxw-id="PAPP154847329" load-source="docdb" format="epo"><country>EP</country><doc-number>12174736</doc-number><kind>A</kind><date>20120703</date><lang>EN</lang></document-id><document-id mxw-id="PAPP172244742" load-source="docdb" format="original"><country>EP</country><doc-number>12174736.4</doc-number><date>20120703</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140554758" ucid="EP-12174736-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>12174736</doc-number><kind>A</kind><date>20120703</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1989316578" load-source="docdb">H04L   9/06        20060101ALI20121115BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1989321574" load-source="docdb">H04L   9/32        20060101AFI20121115BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-2062985842" load-source="docdb" scheme="CPC">H04L   9/3247      20130101 FI20150501BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2062991810" load-source="docdb" scheme="CPC">H04L   9/0618      20130101 LI20150501BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2062994909" load-source="docdb" scheme="CPC">H04L   9/3242      20130101 LI20150501BHEP        </classification-cpc><classification-cpc mxw-id="PCL2003767473" load-source="docdb" scheme="CPC">Y04S  40/24        20130101 LA20140122BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132360044" lang="DE" load-source="patent-office">Sichere Nachrichtenübertragung</invention-title><invention-title mxw-id="PT132360045" lang="EN" load-source="patent-office">Secure message transmission</invention-title><invention-title mxw-id="PT132360046" lang="FR" load-source="patent-office">Transmission de messages en toute sécurité</invention-title><citations><patent-citations><patcit mxw-id="PCIT242943098" load-source="docdb" ucid="EP-1615370-A1"><document-id format="epo"><country>EP</country><doc-number>1615370</doc-number><kind>A1</kind><date>20060111</date></document-id><sources><source name="SEA" category="Y" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242943099" load-source="docdb" ucid="US-5671283-A"><document-id format="epo"><country>US</country><doc-number>5671283</doc-number><kind>A</kind><date>19970923</date></document-id><sources><source name="SEA" category="Y" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242943100" load-source="docdb" ucid="US-6697943-B1"><document-id format="epo"><country>US</country><doc-number>6697943</doc-number><kind>B1</kind><date>20040224</date></document-id><sources><source name="SEA" category="Y" created-by-npl="N"/></sources></patcit></patent-citations><non-patent-citations><nplcit><text>None</text><sources><source mxw-id="PNPL45210913" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>SMID M E: "AUTHENTICATION USING THE FEDERAL DATA ENCRYPTION STANDARD", PROCEEDINGS OF THE NATIONAL ELECTRONICS CONFERENCE, NATIONAL ENGINEERING CONSORTIUM INC. OAK BROOK, ILLINOIS, US, vol. 35, 1 October 1981 (1981-10-01), pages 296 - 301, XP002037821</text><sources><source mxw-id="PNPL70732779" load-source="docdb" name="SEA" category="A"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR919531655" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ABB RESEARCH LTD</last-name><address><country>CH</country></address></addressbook></applicant><applicant mxw-id="PPAR919507544" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>ABB RESEARCH LTD.</last-name></addressbook></applicant><applicant mxw-id="PPAR919017216" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>ABB Research Ltd.</last-name><iid>100070070</iid><address><street>Affolternstrasse 44</street><city>8050 Zürich</city><country>CH</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919537478" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>KIRRMANN HUBERT</last-name><address><country>CH</country></address></addressbook></inventor><inventor mxw-id="PPAR919532943" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>KIRRMANN, HUBERT</last-name></addressbook></inventor><inventor mxw-id="PPAR919013581" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>KIRRMANN, HUBERT</last-name><address><street>Im Rüteli 17</street><city>5405 Dättwil</city><country>CH</country></address></addressbook></inventor><inventor mxw-id="PPAR919508093" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>OENAL CAGRI</last-name><address><country>CH</country></address></addressbook></inventor><inventor mxw-id="PPAR919544287" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>OENAL, CAGRI</last-name></addressbook></inventor><inventor mxw-id="PPAR919012342" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>Önal, Cagri</last-name><address><street>Hofwiesenstrasse 378</street><city>8050 Zürich</city><country>CH</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR919011064" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>ABB Patent Attorneys</last-name><iid>100061058</iid><address><street>C/o ABB Schweiz AG Intellectual Property CH-IP Brown Boveri Strasse 6</street><city>5400 Baden</city><country>CH</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS549818955" load-source="docdb">AL</country><country mxw-id="DS549908666" load-source="docdb">AT</country><country mxw-id="DS549816936" load-source="docdb">BE</country><country mxw-id="DS549815069" load-source="docdb">BG</country><country mxw-id="DS549816460" load-source="docdb">CH</country><country mxw-id="DS549816937" load-source="docdb">CY</country><country mxw-id="DS549908667" load-source="docdb">CZ</country><country mxw-id="DS549818957" load-source="docdb">DE</country><country mxw-id="DS549816942" load-source="docdb">DK</country><country mxw-id="DS549816943" load-source="docdb">EE</country><country mxw-id="DS549742887" load-source="docdb">ES</country><country mxw-id="DS549815074" load-source="docdb">FI</country><country mxw-id="DS549816461" load-source="docdb">FR</country><country mxw-id="DS549818966" load-source="docdb">GB</country><country mxw-id="DS549816944" load-source="docdb">GR</country><country mxw-id="DS549818967" load-source="docdb">HR</country><country mxw-id="DS549908668" load-source="docdb">HU</country><country mxw-id="DS549816474" load-source="docdb">IE</country><country mxw-id="DS549816945" load-source="docdb">IS</country><country mxw-id="DS549815075" load-source="docdb">IT</country><country mxw-id="DS549816954" load-source="docdb">LI</country><country mxw-id="DS549815076" load-source="docdb">LT</country><country mxw-id="DS549744986" load-source="docdb">LU</country><country mxw-id="DS549815077" load-source="docdb">LV</country><country mxw-id="DS549815082" load-source="docdb">MC</country><country mxw-id="DS549744987" load-source="docdb">MK</country><country mxw-id="DS549744988" load-source="docdb">MT</country><country mxw-id="DS549742888" load-source="docdb">NL</country><country mxw-id="DS549745218" load-source="docdb">NO</country><country mxw-id="DS549742897" load-source="docdb">PL</country><country mxw-id="DS549815083" load-source="docdb">PT</country><country mxw-id="DS549908669" load-source="docdb">RO</country><country mxw-id="DS549815084" load-source="docdb">RS</country><country mxw-id="DS549742898" load-source="docdb">SE</country><country mxw-id="DS549816475" load-source="docdb">SI</country><country mxw-id="DS549745219" load-source="docdb">SK</country><country mxw-id="DS549745220" load-source="docdb">SM</country><country mxw-id="DS549745001" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128673309" lang="EN" load-source="patent-office"><p id="pa01" num="0001">The present invention is concerned with securing messages 100 within a communication network of an industrial process control system, in particular of a substation automation system. Specifically, the present invention relates to a method of and a system for securing messages 100. A multi-block message 100 to be transmitted via a communication network is secured by a block-based authentication, encryption and/or integrity information. Only residue of the previous block 101, 102, 103, 104, 107 in form of block based information is needed to generate the block based information of the next block 101, 102, 103, 104, 107. Therefore, the previous block 101, 102, 103, 104, 107 can already be transmitted while block based information of the next block 101, 102, 103, 104, 107 is generated. This enables on-the-fly authentication of the multi-block message 200 and authentication at an increased rate.
<img id="iaf01" file="imgaf001.tif" wi="120" he="99" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128737460" lang="EN" source="EPO" load-source="docdb"><p>The present invention is concerned with securing messages 100 within a communication network of an industrial process control system, in particular of a substation automation system. Specifically, the present invention relates to a method of and a system for securing messages 100. A multi-block message 100 to be transmitted via a communication network is secured by a block-based authentication, encryption and/or integrity information. Only residue of the previous block 101, 102, 103, 104, 107 in form of block based information is needed to generate the block based information of the next block 101, 102, 103, 104, 107. Therefore, the previous block 101, 102, 103, 104, 107 can already be transmitted while block based information of the next block 101, 102, 103, 104, 107 is generated. This enables on-the-fly authentication of the multi-block message 200 and authentication at an increased rate.</p></abstract><description mxw-id="PDES63959297" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001">FIELD OF THE INVENTION</heading><p id="p0001" num="0001">The invention relates to the field of securing messages within a communication network of an industrial process control system, in particular of a substation automation system. Specifically, the present invention relates to a method of and a system for securing messages.</p><heading id="h0002">BACKGROUND OF THE INVENTION</heading><p id="p0002" num="0002">In a communication network securing messages is of great importance for accurate and safe operation. Different levels of security are necessary depending on a potential threat to the network. In the case of malicious messages being a threat to the network, a method of message authentication may be sufficient to protect the network. In the case of eavesdropping being a threat, a more complex method such as message encryption may be needed to protect the network. Further objectives may be prevention of playback and spoofing, as well as intrusion detection.</p><p id="p0003" num="0003">However, securing messages is very time consuming and costly. According to the state of the art, securing a message requires a great amount of time compared to the time actually needed for handling the message.</p><p id="p0004" num="0004">For authentication, a sender generates, based on the message contents, a signature known in the art as message authentication code (MAC), appends the MAC to the message and finally sends the message via the network. Specifically, the sender generates the signature from an authentication algorithm and a receiver can authenticate the sender by checking the signature. The authentication algorithm may be asymmetrical or symmetrical, the latter including e.g. hashed message authentication code (HMAC), Galois field MAC (GMAC) and secure cipher block chaining MAC (XCBCMAC). Conventional implementations of the algorithms for authentication require the message to be entirely received before generating the signature authentication, which results in large processing<!-- EPO <DP n="2"> --> overhead. Accordingly, state of the art authentication causes significant delays for transmitting and forwarding of messages within the communication network. As a result although enhanced security is needed authentication is not applied as of time constraints for transmitting messages.</p><p id="p0005" num="0005">In particular in the case of substation automation according to the standard IEC 61850, the security scheme to be used is described in IEC 62351. The different security objectives include authentication of data transfer through digital signatures, ensuring authenticated access, prevention of eavesdropping, prevention of playback and spoofing, and intrusion detection. However, there are no known commercial applications to this point. Furthermore, the high overhead to security features may prevent the network from fulfilling its real-time constraints. For instance, in the case of hash and sign paradigm for digital signature creation, asymmetrical algorithms are much more time consuming than symmetrical algorithms and tend to violate the real time requirements of substation automation systems. Thus, asymmetrical encryption algorithms are rarely used, in particular in the case of substation automation.</p><p id="p0006" num="0006">Furthermore, transmitting and forwarding of a message within the communication network is delayed by performing an integrity check operation. The integrity check allows uncovering accidental or malicious modifications to the message by generating a checksum. A checksum is computed from a block of the message for detecting errors that may have been introduced during transmission or storage. The integrity of the data can be checked at any time thereafter by re-generating the checksum and comparing it with the checksum of the message received.</p><heading id="h0003">DESCRIPTION OF THE INVENTION</heading><p id="p0007" num="0007">It is therefore an objective of the invention to accelerate the process of securing a message within a communication network of an industrial process control system, in particular a substation automation system. This objective is achieved by a method for securing a multi-block message and a communication network system according to the independent claims. Preferred embodiments are evident from the dependent patent claims, wherein the claim dependency shall not be construed as excluding further meaningful claim combinations.<!-- EPO <DP n="3"> --></p><p id="p0008" num="0008">According to the invention, a plain text multi-block message including characters arranged in blocks of a single size is to be transmitted between devices over a communication network of an industrial process control system, in particular of a substation automation system, or to be forwarded to upper layers of a communication stack of a device of such system. The multi-block message is to be secured by way of a block-based authentication code processing the blocks of the message in a serial manner, wherein authentication information of a non-initial block of the message is generated based on authentication information of a previous block that was processed earlier. Thus, only residue of the previous block in form of the authentication information is needed to generate the authentication information of the next block. Therefore, the previous block can already be further processed in particular already be transmitted or forwarded respectively while authentication information of the next block is generated. This enables on-the-fly authentication of the multi-block message and authentication at an increased rate of more than 1Gbit/s. This allows further to use simplified devices for securing messages and reduces the computation costs.</p><p id="p0009" num="0009">Ultimately, authentication information of a final block specifically of the last block of the message to be processed includes a summary of the authentication information of each block of the multi-block message and may be considered a message authentication signature for the entire multi-block message. Subsequently, such signature is appended to the message preferably to the final block of the message. From the summary the authentication information of each block can be checked after the message is received by another communication network device or further layers of the same device.</p><p id="p0010" num="0010">For authentication of the received message the block-wise authentication information and finally the authentication signature is re-generated after receiving the message. The original authentication signature of the received message is cross checked with the re-generated signature. For matching signatures, the received message is considered secure and authenticated.</p><p id="p0011" num="0011">A preferred variant of the invention is the use within precision time protocols (PTP) such as IEEE 1588 for precise time distribution and clock synchronization in electrical substations, wherein the use of a chained MAC (CMAC) as authentication is particularly advantageous. Furthermore, for IEC 62439-3 (HSR) the delay caused by securing the message is well below the required 5 µs maximum residence time of the message. Detailed investigations are being published in<nplcit id="ncit0001" npl-type="s"><text> C. Önal and H. Kirrmann, International IEEE<!-- EPO <DP n="4"> --> Symposium on Precision Clock Synchronization for Measurement, Control and Communication, San Francisco, 2012</text></nplcit>.</p><p id="p0012" num="0012">In a preferred variant of the invention, the multi-block message to be secured is to be checked for integrity after being received by a communication network device. The integrity check is introduced for the purpose of detecting accidental errors that may have occurred during transmission or storage of the message. Some integrity check operations may be based on special algorithms that not only detect errors but also allow the original data to be recovered in certain cases.</p><p id="p0013" num="0013">According to this embodiment of the invention the integrity check operation is block based, wherein the blocks may be different from the blocks used for authentication. This way the algorithm for the integrity check can be optimized with respect to size of the used blocks particularly by number of characters or certain bits of the message.</p><p id="p0014" num="0014">However, the operation is carried out in parallel to the authentication of the multi-block message and in a similar fashion. An integrity check value is generated for a block of the message based on a specific residue of a previous block. Similar to the operation of authentication, this enables an on-the-fly integrity check of the multi-block message and an integrity check at an increased speed. Finally, a checksum is generated from the integrity check value of each block of the message and appended to a final block. The integrity of an incoming message can be checked by re-generating the integrity check value and ultimately the checksum and by subsequent comparison of the received and re-generated checksum. In case of matching checksums, the integrity of the incoming message is verified.</p><p id="p0015" num="0015">In an advantageous embodiment of the invention, the multi-block message is encrypted for enhanced confidentiality and further security. Standards and cryptographic software as well as hardware to perform encryption are widely available, but successfully using encryption to ensure security is challenging. According to this embodiment of the invention, encryption is carried out on-the-fly and concurrent with, or in parallel to, authentication and the integrity check operation. Preferably, a block based algorithm is used for encryption, wherein a single shared block cipher may even be used both to encrypt and to calculate an authentication signature.</p><p id="p0016" num="0016">Specifically, it may be advantageous to generate the authentication information of a block before or after encryption of said block depending on the algorithms used for each<!-- EPO <DP n="5"> --> operation, e.g. when using the same block size for authentication and encryption; authentication may also be carried out after encryption of the message blocks. In case a shared cipher or encryption engine is used, intermediate authentication signature values can be obtained from the manipulation of the encrypted input data blocks (or vice versa).</p><p id="p0017" num="0017">The present invention also relates to a communication network system of an industrial process control system, in particular of a substation automation system comprising a communication network device adapted to securing a multi-block message. The communication network device is adapted to separate the message in sorted blocks and apply a block-based security code. The block authentication information for a block of the message is generated based on residue of the block and based on block authentication information of a previous block while transmitting the previous block of the message. Each block of the message is encrypted while an encrypted previous block is transmitted. A message authentication signature is generated based on the block authentication information of a final block of the message, and ultimately the authentication signature is appended to the final block of the message or a received authentication signature appended to the message is verified.</p><p id="p0018" num="0018">Accordingly, the message is transmitted or forwarded respectively while some of the content is still processed in form of generating authentication, generating the checksum or encrypting the message. This way time delay for processing of the message is reduced to a minimum, thus, enabling on-the-fly security for the communication network at a high transmitting rate at low computation costs.</p><heading id="h0004">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p0019" num="0019">The subject matter of the invention will be explained in more detail in the following text with reference to preferred exemplary embodiments which are illustrated in the attached drawings, in which:
<dl id="dl0001"><dt>Fig.1</dt><dd>schematically shows a communication device with an incoming and an outgoing multi-block message;</dd><dt>Fig.2</dt><dd>schematically shows a process of generating an authentication to be appended to an outgoing message; and</dd><dt>Fig.3</dt><dd>schematically shows a process of authentication and encryption of an outgoing message.</dd></dl><!-- EPO <DP n="6"> --></p><p id="p0020" num="0020">The reference symbols used in the drawings, and their meanings, are listed in summary form in the list of designations. In principle, identical parts are provided with the same reference symbols in the figures.</p><heading id="h0005">DETAILED DESCRIPTION OF PREFERRED EMBODIMENTS</heading><p id="p0021" num="0021"><figref idrefs="f0001">Fig.1</figref> shows schematically securing of an multi-block message 100 using a communication network device 3. The device 3 is comprised of a message input 1 and a message output 2, a distributor 4, two signature compilers 5, 6, an authentication operator 8, and an integrity check operator 9. The multi-block message 100 is comprised of a preamble block 101, content blocks 102, 103, 104, 105, 106, 107 and a final block 109 containing an integrity checksum. The message 100 is first received by the network device 3 via the input 1, wherein the message is separated and sorted by blocks 102, 103, 104, 105, 106, 107. The final block 109 containing the integrity checksum is removed by the message input 1.</p><p id="p0022" num="0022">Subsequently, the distributor 4 is forwarding the blocks 102, 103, 104, 105, 106, 107 one by one to the authentication operator 8 and the integrity check operator 9, wherein the blocks 102, 103, 104, 105, 106, 107 can be different in size for the authentication operator 8 and the integrity check operator 9. This way the block size can be optimized to fit the respective algorithm for authentication and generation of the integrity checksum.</p><p id="p0023" num="0023">For authentication, the operator 8 receives and processes the message block by block, wherein after an authentication information is generated for one block 102, 103, 104, 105, 106, 107 by a block processor 81 the next block 102, 103, 104, 105, 106, 107 is received from the distributor 4. A post processor 82 transmits the authentication information to a shuffling unit 83 in case this is required by the authentication algorithm, wherein the shuffling unit 83 computes an authentication signature from the authentication information. In addition, residue or characters needed to calculate the authentication information of the next block 102, 103, 104, 105, 106, 107 is temporarily stored in a storage unit 84 to be redirected to the block processor 81.</p><p id="p0024" num="0024">The shuffling unit 83 sends the generated authentication signature 208, 508 to a compiler 5, where the signature 208, 508 is appended to the final block 107 of the message 100. The blocks 102, 103, 104, 105, 106, 107 are forwarded to the message output 2 of the<!-- EPO <DP n="7"> --> network device 3, where the blocks 102, 103, 104, 105, 106, 107 are transmitted on-the-fly to a further network communication device.</p><p id="p0025" num="0025">Respectively, an integrity checksum 209 is generated by an integrity check operator 91 in parallel to authentication, where the procedure is equivalent to the generation of the authentication information 502, 503, 504, and a signature 208, 508 apart from an integrity information and a checksum to be generated for each block 102, 103, 104, 105, 106, 107. A shuffling unit 93 forwards the integrity checksum to a compiler 6, which appends the integrity checksum 209 to the authentication signature 208, 508 of the message 100. For specific algorithms the authentication signature 208, 508 may be included in the generation of the integrity checksum 209, where the authentication operator 81 exchanges the necessary information such as the authentication signature 208, 508 with the integrity check operator 91 or vice versa.</p><p id="p0026" num="0026">Ultimately, the outgoing message 200 is transmitted on-the-fly and comprises general content blocks 201, 202, 203, 204, 205, 206, 207, the authentication signature block 208 and the integrity checksum 209.</p><p id="p0027" num="0027"><figref idrefs="f0002">Fig. 2</figref> shows schematically the process of securing a multi-block message 100 by authentication. A header 101 or preamble of the message is used as preparation information 501 to form the header of the outgoing message 200. For each block 102, 103, 104, 105, 106, 107 of the message 100 authentication information 502, 503, 504 is generated and stored temporarily. The authentication signature 508 is then generated from the stored authentication information 502, 503, 504. For transmitting the outgoing message 200 the preamble 201 and each block 202, 203, 204, 207 is transmitted on-the-fly while the authentication signature 508 is generated. Finally, the authentication signature 208 and the generated integrity checksum 209 are appended to the final block 207 of the message 200.</p><p id="p0028" num="0028"><figref idrefs="f0003">Fig. 3</figref> shows schematically the process of securing the multi-block message 100 by encryption and authentication. The process is carried out as described in <figref idrefs="f0002">Fig. 2</figref> aside from the blocks 102, 103, 104, 105, 106, 107 of the message 100 being encrypted before the authentication information 502, 503, 504 is generated. For encryption, encrypted blocks 401, 402, 403, 404, 407 are generated from the original blocks 101, 102, 103, 104, 107. The authentication information 502, 503, 504 is generated for each encrypted block 401, 402, 403, 404, 407. Ultimately, the authentication signature 208, 508 and the in parallel generated integrity checksum 209 are appended to the final block 207 of the message 200.<!-- EPO <DP n="8"> --></p><p id="p0029" num="0029">However, one skilled in the art will understand that the message 100 to be secured can be of indefinite length. According to the invention, a time delay for sending a message 200 is only introduced for processing the final block 207. Previous blocks 202, 203, 204 are already sent while the next block 202, 203, 204 is secured, thus not causing any time delay.</p><heading id="h0006">LIST OF DESIGNATIONS</heading><p id="p0030" num="0030"><dl id="dl0002" compact="compact"><dt>1</dt><dd>Input</dd><dt>2</dt><dd>Output</dd><dt>3</dt><dd>Device</dd><dt>4</dt><dd>Distributor</dd><dt>5, 6</dt><dd>Compiler</dd><dt>8</dt><dd>Authentication operator</dd><dt>9</dt><dd>Integrity check operator</dd><dt>81</dt><dd>Block processor</dd><dt>82</dt><dd>Post processor</dd><dt>83</dt><dd>Shuffling unit</dd><dt>84</dt><dd>Storage unit</dd><dt>91</dt><dd>Block processor</dd><dt>92</dt><dd>Post register</dd><dt>93</dt><dd>Shuffling unit</dd><dt>94</dt><dd>Storage unit</dd><dt>100</dt><dd>Multi-block message</dd><dt>101</dt><dd>Header</dd><dt>102-106</dt><dd>Block</dd><dt>107</dt><dd>Final block</dd><dt>109</dt><dd>Integrity checksum</dd><dt>200</dt><dd>Multi-block message</dd><dt>201</dt><dd>Preamble</dd><dt>202-206</dt><dd>Block</dd><dt>207</dt><dd>Final block</dd><dt>208</dt><dd>Authentication signature</dd><dt>209</dt><dd>Integrity checksum</dd><dt>401</dt><dd>Preamble information</dd><dt>402-408</dt><dd>Encrypted block</dd><dt>501</dt><dd>Preamble information</dd><dt>502-504</dt><dd>Authentication information</dd><dt>508</dt><dd>Authentication signature</dd></dl></p></description><claims mxw-id="PCLM56982330" lang="EN" load-source="patent-office"><!-- EPO <DP n="9"> --><claim id="c-en-0001" num="0001"><claim-text>A method for securing a multi-block message (100) in a communication network of an industrial process control system, in particular of a substation automation system, comprising
<claim-text>- generating block authentication information (501, 502, 503, 504) for a block of the message (100, 200) based on characters of the block (102, 103, 104, 105, 106, 107) and based on block authentication information (501, 502, 503, 504) of a previous block (102, 103, 104, 105, 106, 107) while transmitting or forwarding the previous block (201, 202, 203, 204, 205, 206, 207) of the message,</claim-text>
<claim-text>- generating a message authentication signature (208, 508) as the block authentication information (501, 502, 503, 504) of a final block (107) of the message (100), and</claim-text>
<claim-text>- appending the authentication signature (208, 508) to the final block (207) of the message (200), or verifying a received authentication signature (208) of the message (200).</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The method according to claim 1 comprising encrypting a block (102, 103, 104, 105, 106, 107) of the message (100) while transmitting an encrypted previous block (401, 402, 403, 404, 407).</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The method according to claim 2 comprising encrypting a block (102, 103, 104, 105, 106, 107) of the message (100), while generating the block authentication information (501, 502, 503, 504) of an encrypted previous block (401, 402, 403, 404, 407).<!-- EPO <DP n="10"> --></claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>The method according to the claim 1 comprising verifying the received authentication signature (208) by comparing the received authentication signature (208) with the generated authentication signature (508).</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>The method according to any of the claims 1 to 4 comprising
<claim-text>- transmitting the message (200) to a second communication network device via a communication network, or</claim-text>
<claim-text>- forwarding the message (200) to an upper layer of a communication stack of the communication network device.</claim-text></claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>The method according to any of the claims 1 to 5 comprising performing an integrity check operation comprising
<claim-text>- generating an integrity check value for a block of the message based on the characters of the block (102, 103, 104, 105, 106, 107) and based on the integrity check value of a previous block (102, 103, 104, 105, 106, 107) while transmitting the previous block (102, 103, 104, 105, 106, 107) of the message (100, 200),</claim-text>
<claim-text>- generating an integrity checksum (209) based on the integrity check value of the blocks (102, 103, 104, 105, 106, 107) of the message (100, 200), and</claim-text>
<claim-text>- appending the integrity checksum (209) to the message (100, 200) for an outgoing message, or verifying a received integrity checksum (209) of the message (100, 200) for an incoming message.</claim-text></claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>The method according to claim 6, wherein the integrity check operation is performed after appending the authentication signature (208, 508) to the message (100, 200) for outgoing messages or before removing the authentication signature (208, 508) from the message for incoming messages.<!-- EPO <DP n="11"> --></claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>The method according to any of the claims 1 to 7 comprising appending a tag to the message (100, 200) indicative of a failed authentication for forwarding the message (100, 200) to an upper layer processing unit of a communication network device (3).</claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>A communication network system of an industrial process control system, in particular of a substation automation system comprising a communication network device (3) adapted to secure a multi-block message (100) in the communication network,
<claim-text>- generating block authentication information (501, 502, 503, 504) for a block (102, 103, 104, 105, 106, 107) of the message (100) based on the characters of the block (102, 103, 104, 105, 106, 107) and based on block authentication information (501, 502, 503, 504) of a previous block (102, 103, 104, 105, 106, 107) while transmitting the previous block (202, 203, 204, 205, 206, 207) of the message (200),</claim-text>
<claim-text>- encrypting a block (102, 103, 104, 105, 106, 107) of the message (100) while transmitting an encrypted previous block (202, 203, 204, 205, 206, 207),</claim-text>
<claim-text>- generating a message authentication signature (208, 508) based on the block authentication information (501, 502, 503, 504) of a final block (207) of the message (200), and</claim-text>
<claim-text>- appending the authentication signature (208, 508) to the final block (207) of the message (200) or verifying a received authentication signature (208, 508) appended to the message (200).</claim-text></claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>A communication network system according to claim 9, wherein the communication network device (3) is located before a physical network interface, in-between two network interfaces, or before several output queues of a multiport bridging device.</claim-text></claim></claims><drawings mxw-id="PDW16670711" load-source="patent-office"><!-- EPO <DP n="12"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="165" he="205" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="13"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="120" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="14"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="111" he="233" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="156" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="161" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
