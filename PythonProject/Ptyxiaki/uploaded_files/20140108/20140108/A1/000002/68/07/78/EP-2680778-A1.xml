<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2680778-A1" country="EP" doc-number="2680778" kind="A1" date="20140108" family-id="45937463" file-reference-id="315974" date-produced="20180823" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146587074" ucid="EP-2680778-A1"><document-id><country>EP</country><doc-number>2680778</doc-number><kind>A1</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12713324-A" is-representative="NO"><document-id mxw-id="PAPP154849266" load-source="docdb" format="epo"><country>EP</country><doc-number>12713324</doc-number><kind>A</kind><date>20120302</date><lang>EN</lang></document-id><document-id mxw-id="PAPP196400011" load-source="docdb" format="original"><country>EP</country><doc-number>12713324.7</doc-number><date>20120302</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140547180" ucid="IB-2012050999-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>IB</country><doc-number>2012050999</doc-number><kind>W</kind><date>20120302</date></document-id></priority-claim><priority-claim mxw-id="PPC140557572" ucid="US-201161448714-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201161448714</doc-number><kind>P</kind><date>20110303</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1989316935" load-source="docdb">A61B  19/00        20060101AFI20120920BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1873986321" load-source="docdb" scheme="CPC">A61B   8/5261      20130101 LA20161129BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1976546202" load-source="docdb" scheme="CPC">A61B2090/367       20160201 LA20160201BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1976549278" load-source="docdb" scheme="CPC">A61B2090/378       20160201 LA20160201BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1976551065" load-source="docdb" scheme="CPC">A61B2034/2046      20160201 LA20160201BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1976552108" load-source="docdb" scheme="CPC">A61B  90/36        20160201 LI20160201BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1976553573" load-source="docdb" scheme="CPC">A61B2090/365       20160201 LA20160201BHEP        </classification-cpc><classification-cpc mxw-id="PCL2094208408" load-source="docdb" scheme="CPC">G06T   3/0068      20130101 FI20140710BHEP        </classification-cpc><classification-cpc mxw-id="PCL2094210987" load-source="docdb" scheme="CPC">G06T  11/008       20130101 LI20140710BHEP        </classification-cpc><classification-cpc mxw-id="PCL2094214942" load-source="docdb" scheme="CPC">G06T  15/08        20130101 LI20140710BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132365855" lang="DE" load-source="patent-office">SYSTEM UND VERFAHREN ZUR AUTOMATISIERTEN INITIALISIERUNG UND REGISTRIERUNG EINES NAVIGATIONSSYSTEMS</invention-title><invention-title mxw-id="PT132365856" lang="EN" load-source="patent-office">SYSTEM AND METHOD FOR AUTOMATED INITIALIZATION AND REGISTRATION OF NAVIGATION SYSTEM</invention-title><invention-title mxw-id="PT132365857" lang="FR" load-source="patent-office">SYSTÈME ET PROCÉDÉ D'INITIALISATION ET D'ENREGISTREMENT AUTOMATIQUES D'UN SYSTÈME DE NAVIGATION</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR919535734" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>KONINKL PHILIPS NV</last-name><address><country>NL</country></address></addressbook></applicant><applicant mxw-id="PPAR919541456" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>KONINKLIJKE PHILIPS N.V.</last-name></addressbook></applicant><applicant mxw-id="PPAR919017957" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Koninklijke Philips N.V.</last-name><iid>101385623</iid><address><street>High Tech Campus 5</street><city>5656 AE Eindhoven</city><country>NL</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919515250" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>KADOURY SAMUEL</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919537404" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>KADOURY, Samuel</last-name></addressbook></inventor><inventor mxw-id="PPAR919011973" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>KADOURY, Samuel</last-name><address><street>c/o High Tech Campus Building 44</street><city>NL-5656 AE Eindhoven</city><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919540487" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>KRUECKER JOCHEN</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919529732" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>KRUECKER, JOCHEN</last-name></addressbook></inventor><inventor mxw-id="PPAR919012761" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>KRUECKER, JOCHEN</last-name><address><street>c/o High Tech Campus Building 44</street><city>NL-5656 AE Eindhoven</city><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919525021" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>JAGO JAMES ROBERTSON</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919524298" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>JAGO, James, Robertson</last-name></addressbook></inventor><inventor mxw-id="PPAR919008831" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>JAGO, James, Robertson</last-name><address><street>c/o High Tech Campus Building 44</street><city>NL-5656 AE Eindhoven</city><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919509436" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>WOOD BRADFORD JOHNS</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919531932" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>WOOD, BRADFORD, JOHNS</last-name></addressbook></inventor><inventor mxw-id="PPAR919013653" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>WOOD, BRADFORD, JOHNS</last-name><address><street>c/o High Tech Campus Building 44</street><city>NL-5656 AE Eindhoven</city><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919523867" load-source="docdb" sequence="5" format="epo"><addressbook><last-name>COLLET-BILLON ANTOINE</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919526338" load-source="docdb" sequence="5" format="intermediate"><addressbook><last-name>COLLET-BILLON, ANTOINE</last-name></addressbook></inventor><inventor mxw-id="PPAR919014328" load-source="patent-office" sequence="5" format="original"><addressbook><last-name>COLLET-BILLON, ANTOINE</last-name><address><street>c/o High Tech Campus Building 44</street><city>NL-5656 AE Eindhoven</city><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919527445" load-source="docdb" sequence="6" format="epo"><addressbook><last-name>DUFOUR CECILE</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919506695" load-source="docdb" sequence="6" format="intermediate"><addressbook><last-name>DUFOUR, CECILE</last-name></addressbook></inventor><inventor mxw-id="PPAR919011462" load-source="patent-office" sequence="6" format="original"><addressbook><last-name>DUFOUR, CECILE</last-name><address><street>c/o High Tech Campus Building 44</street><city>NL-5656 AE Eindhoven</city><country>NL</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR919011125" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Steffen, Thomas</last-name><iid>100958149</iid><address><street>Philips Intellectual Property &amp; Standards P.O. Box 220</street><city>5600 AE Eindhoven</city><country>NL</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="IB-2012050999-W"><document-id><country>IB</country><doc-number>2012050999</doc-number><kind>W</kind><date>20120302</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012117381-A1"><document-id><country>WO</country><doc-number>2012117381</doc-number><kind>A1</kind><date>20120907</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS549768188" load-source="docdb">AL</country><country mxw-id="DS549781225" load-source="docdb">AT</country><country mxw-id="DS549768193" load-source="docdb">BE</country><country mxw-id="DS549850948" load-source="docdb">BG</country><country mxw-id="DS549865027" load-source="docdb">CH</country><country mxw-id="DS549768484" load-source="docdb">CY</country><country mxw-id="DS549781226" load-source="docdb">CZ</country><country mxw-id="DS549849298" load-source="docdb">DE</country><country mxw-id="DS549768194" load-source="docdb">DK</country><country mxw-id="DS549768497" load-source="docdb">EE</country><country mxw-id="DS549850495" load-source="docdb">ES</country><country mxw-id="DS549850949" load-source="docdb">FI</country><country mxw-id="DS549851038" load-source="docdb">FR</country><country mxw-id="DS549768195" load-source="docdb">GB</country><country mxw-id="DS549768196" load-source="docdb">GR</country><country mxw-id="DS549768205" load-source="docdb">HR</country><country mxw-id="DS549768498" load-source="docdb">HU</country><country mxw-id="DS549865028" load-source="docdb">IE</country><country mxw-id="DS549768206" load-source="docdb">IS</country><country mxw-id="DS549851039" load-source="docdb">IT</country><country mxw-id="DS549768499" load-source="docdb">LI</country><country mxw-id="DS549849299" load-source="docdb">LT</country><country mxw-id="DS549781227" load-source="docdb">LU</country><country mxw-id="DS549849300" load-source="docdb">LV</country><country mxw-id="DS549849301" load-source="docdb">MC</country><country mxw-id="DS549917911" load-source="docdb">MK</country><country mxw-id="DS549917912" load-source="docdb">MT</country><country mxw-id="DS549850496" load-source="docdb">NL</country><country mxw-id="DS549781228" load-source="docdb">NO</country><country mxw-id="DS549850497" load-source="docdb">PL</country><country mxw-id="DS549781237" load-source="docdb">PT</country><country mxw-id="DS549850502" load-source="docdb">RO</country><country mxw-id="DS549768500" load-source="docdb">RS</country><country mxw-id="DS549850503" load-source="docdb">SE</country><country mxw-id="DS549768509" load-source="docdb">SI</country><country mxw-id="DS549917913" load-source="docdb">SK</country><country mxw-id="DS549917914" load-source="docdb">SM</country><country mxw-id="DS549865029" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA99835236" ref-ucid="WO-2012117381-A1" lang="EN" load-source="patent-office"><p num="0000">A system and method for image registration includes tracking (508) a scanner probe in a position along a skin surface of a patient. Image planes corresponding to the position are acquired (510). A three-dimensional volume of a region of interest is reconstructed (512) from the image planes. A search of an image volume is initialized (514) to determine candidate images to register the image volume with the three-dimensional volume by employing pose information of the scanner probe during image plane acquisition, and physical constraints of a pose of the scanner probe. The image volume is registered (522) with the three-dimensional volume.</p></abstract><abstract mxw-id="PA100331070" ref-ucid="WO-2012117381-A1" lang="EN" source="national office" load-source="docdb"><p>A system and method for image registration includes tracking (508) a scanner probe in a position along a skin surface of a patient. Image planes corresponding to the position are acquired (510). A three-dimensional volume of a region of interest is reconstructed (512) from the image planes. A search of an image volume is initialized (514) to determine candidate images to register the image volume with the three-dimensional volume by employing pose information of the scanner probe during image plane acquisition, and physical constraints of a pose of the scanner probe. The image volume is registered (522) with the three-dimensional volume.</p></abstract><abstract mxw-id="PA99835237" ref-ucid="WO-2012117381-A1" lang="FR" load-source="patent-office"><p num="0000">La présente invention concerne un système et un procédé d'enregistrement d'images qui comprend le suivi (508) d'une sonde de balayage dans une position le long de la surface cutanée d'un patient. Les plans d'image correspondant à la position sont acquis (510). Un volume en trois dimensions d'une région d'intérêt est reconstruit (512) à partir des plans d'image. Une recherche d'un volume d'image est initialisée (514) pour déterminer des images candidates pour enregistrer le volume d'image avec le volume en trois dimensions en utilisant les informations d'orientation de la sonde de balayage durant l'acquisition des plans d'image, et les contraintes physiques d'une orientation de la sonde de balayage. Le volume de l'image est enregistré (522) avec le volume en trois dimensions.</p></abstract><abstract mxw-id="PA100331071" ref-ucid="WO-2012117381-A1" lang="FR" source="national office" load-source="docdb"><p>La présente invention concerne un système et un procédé d'enregistrement d'images qui comprend le suivi (508) d'une sonde de balayage dans une position le long de la surface cutanée d'un patient. Les plans d'image correspondant à la position sont acquis (510). Un volume en trois dimensions d'une région d'intérêt est reconstruit (512) à partir des plans d'image. Une recherche d'un volume d'image est initialisée (514) pour déterminer des images candidates pour enregistrer le volume d'image avec le volume en trois dimensions en utilisant les informations d'orientation de la sonde de balayage durant l'acquisition des plans d'image, et les contraintes physiques d'une orientation de la sonde de balayage. Le volume de l'image est enregistré (522) avec le volume en trois dimensions.</p></abstract><description mxw-id="PDES51232914" ref-ucid="WO-2012117381-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="3"/>--><p id="p0001" num="0001"> PATENT </p><p id="p0002" num="0002">SYSTEM AND METHOD FOR AUTOMATED INITIALIZATION AND REGISTRATION OF NAVIGATION SYSTEM </p><p id="p0003" num="0003">Government Rights: </p><p id="p0004" num="0004">This invention was made in the performance of a Cooperative Research and Development Agreement with the United States Public Health Service (CRADA No. NCI- NIHCC-01864). The Government of the United States has certain rights in the invention. </p><p id="p0005" num="0005">This application claims priority to U.S. Provisional Patent Application Serial No. 61/448,714 filed on March 3, 2011 and incorporated herein by reference in its entirety. </p><p id="p0006" num="0006">This disclosure relates to medical systems and more particularly to systems and methods for device navigation using coordinated registration between different imaging modalities. </p><p id="p0007" num="0007">Surgery and minimally invasive therapy require reliable, precise navigation along predefined paths to predetermined target points. Many kinds of interventions are guided based on pre- procedural high-resolution three-dimensional (3D) images taken from a region of interest. Typic _ i computed tomography (CT) or magnetic resonance (MR) scanner acquires images before an intervention (pre-operative images). These modalities are not realtime, at least when high resolution is required and their use for imaging during <sup>"</sup>an intervention is thus very limited. Proper spatial registration of pre-operative images in combination with a navigation system would make images much more effective during an interventional procedure. </p><p id="p0008" num="0008">Attaching fiducial markers to a patient's skin before taking a high-resolution 3D image is one widely used method to facilitate spatial registration. These markers can easily be localized in the image, i.e., their spatial coordinates in an image coordinate system can be 
<!-- EPO <DP n="4"/>-->
 determined precisely. To perform the actual intervention, the patient is placed on the intervention table. The positions of the fiducial markers in the coordinate system of the position measurement system are obtained by touching the markers with a spatially tracked pointer device. By mapping these coordinates to the coordinates of the markers localized in the image, it is possible to determine a transformation from a position measurement system coordinates to image coordinates. Provided a fixed spatial relationship between the patient and the measurement system exists, it is then possible to determine the position of a tracked device in the pre-operative image. </p><p id="p0009" num="0009"> Typically, a physician uses a live-imaging modality, like ultrasound, during the procedure to gain additional information but also as a verification of the registration to enhance reliability when using the pre-operative image information. The position of this live imaging modality is tracked as well, so the spatial coordinates of the live image in the tracking coordinate system are known. </p><p id="p0010" num="0010"> Fiducial markers, however, cannot be used in a number of situations. These include: 1) When trying to navigate on pre-procedural diagnostic images that were obtained before fiducials could be attached, and that cannot be repeated with fiducials attached (e.g., because of concerns about cost, radiation dose or contrast medium exposure, workflow, etc.). 2) When the field of view of the imaging modality is limited such that field of view cannot cover both the skin fiducials and the region of interest for the intervention. </p><p id="p0011" num="0011"> When fiducial markers are unavailable for registration, alternative means must be used to match the pre-procedural image space to the navigation system space. Currently available methods are limited to manual registration using point pair matching (e.g., finding </p><p id="p0012" num="0012">corresponding anatomical landmarks in the live intra-procedural modality such as ultrasound, and in the pre-procedural image); scan plane matching (choosing a "live" image plane in the 
<!-- EPO <DP n="5"/>-->
 region of interest, and adjusting the registration transformation to map it to a corresponding image plane in the pre-procedural image, or vice versa, selecting an image plane in the pre- procedural image, and adjusting the "live" image plane to match the pre-procedural image plane) or a combination of these. </p><p id="p0013" num="0013"> Organ motion and deformation between the pre-procedural image acquisition and the interventional procedure, as well as the difficulty in reliably identifying equivalent targets in images having very different characteristics (such as Ultrasound versus CT/MR), turn this manual registration process into a difficult task, often taking significant amounts of time, and/or leading to inaccurate registration results. </p><p id="p0014" num="0014"> It is quite challenging to determine an accurate and reliable transfer function to map image pixels from one modality to another given the inherently different image formation phenomena, as well as changing contrast and intensity levels. Respiratory phases and varying elastic deformation of the structure of interest also have an important role in determining accurate registration. Various approaches have been described including various image-based approaches to establish suitable similarity measures between US and CT or MR. However, reliable automatic segmentation of a particular structure becomes one of the main sources of error which can hinder the quality of the registration. Such methods remain highly supervised since they require either a manual initialization of the registration transformation or manual gating of the ultrasound frames acquired for registration purposes. </p><p id="p0015" num="0015"> In accordance with the present principles, systems and methods are provided which create reliable registration initialization for automatic fusion of pre-operative images to intraoperative images without relying on manual alignment or selection of processing intraoperative frames. The present embodiments include subject-specific structure shape information (e.g., a reference organ or boundary) obtained from intra-operative images to 
<!-- EPO <DP n="6"/>-->
 provide proper alignment with a corresponding pre-operative shape model. The present embodiments provide useful information on an effective search space in terms of translation and rotation parameters, as well as a starting point for an automatic image-based registration approach. </p><p id="p0016" num="0016"> An integrated framework provides an accurate and real-time updated transformation chain to connect free-hand two-dimensional (2D) ultrasound (US) images to a pre-acquired 3D reference volume from another modality. Based on this framework, an initialization of a registration matrix is obtained which links the pre-operative coordinate system with an intraoperative electromagnetic reference using 3D surface shapes acquired in tracking space. The present methods are able to first estimate an approximate registration matrix by determining the main orientation using the tracking information from a probe position taken near the patient's midline, followed by a translation adjustment which aligns recorded probe positions to a patient's skin segmentation. This avoids using US image features which may be subject to poor image quality. Once the main parameters are estimated, a patient-specific US surface model from a 3D reconstructed volume is obtained using a restricted confidence-based region growing method. The obtained accurate and subject-specific initialization can lead to better registration performance as compared with existing fiducial marker registration methods. </p><p id="p0017" num="0017"> In accordance with the present principles, a system and method for image registration includes tracking a scanner probe in a position along a skin surface of a patient. Image planes corresponding to the position are acquired. A three-dimensional volume of a region of interest is reconstructed from the image planes. A search of an image volume is initialized to determine candidate images to register the image volume with the three-dimensional volume by employing pose information of the scanner probe during image plane acquisition, and physical constraints of a pose of the scanner probe. The image volume is registered with the 
<!-- EPO <DP n="7"/>-->
 three-dimensional volume. </p><p id="p0018" num="0018"> In another embodiment, a system and method for image registration includes segmenting a reference organ and a skin surface image of a patient in an image volume; </p><p id="p0019" num="0019">tracking a scanner probe in at least one position along the skin surface of a patient; acquiring images corresponding to the at least one position and the reference organ; reconstructing a three-dimensional volume of the reference organ from the image planes; initializing a transformation matrix with initial parameter values constrained by poses and physical constraints of the scanner probe during image acquisition to determine the transformation matrix between the image volume with the three-dimensional volume; and optimizing the transformation matrix to find coordinates that register the image volume with the three- dimensional volume using a cost function. </p><p id="p0020" num="0020"> A system for image registration includes a spatial trackable scanner probe, an imaging device configured to acquire image planes corresponding to at least one position of the scanner probe; and an image processing module. The image processing module is configured to reconstruct a three-dimensional volume of a region of interest from the image planes. The image processing module is further configured to initialize a search of a stored model of the image volume to determine candidate images to register the image volume with the three- dimensional volume by employing pose information of the scanner probe during image plane acquisition, and physical constraints of the pose of the scanner probe. A registration module is configured to register the image volume with the three-dimensional volume. </p><p id="p0021" num="0021"> These and other objects, features and advantages of the present disclosure will become apparent from the following detailed description of illustrative embodiments thereof, which is to be read in connection with the accompanying drawings. </p><p id="p0022" num="0022"> This disclosure will present in detail the following description of preferred 
<!-- EPO <DP n="8"/>-->
 embodiments with reference to the following figures wherein: </p><p id="p0023" num="0023"> FIG. 1 is a block/flow diagram showing a system/method for image registration in accordance with the present principles; </p><p id="p0024" num="0024"> FIG. 2 is a schematic diagram showing a chain of transformations employed in registration of images in accordance with the present principles; </p><p id="p0025" num="0025"> FIG. 3 is a block/flow diagram showing a system/method for enabling image registration in accordance with one illustrative embodiment; </p><p id="p0026" num="0026"> FIG. 4 is a schematic diagram showing an illustrative workfiow for registering images in accordance with one illustrative embodiment; </p><p id="p0027" num="0027"> FIG. 5 is a block/flow diagram showing a system/method for performing image registration in accordance with one embodiment; </p><p id="p0028" num="0028"> FIG. 6 is a schematic diagram showing images employed in registration processes in accordance with an illustrative embodiment; and </p><p id="p0029" num="0029"> FIG. 7 is a schematic diagram illustratively showing coordinate system adjustment in accordance with one illustrative embodiment. </p><p id="p0030" num="0030"> Medical navigation systems require a registration procedure to align the coordinate systems of the navigation system and a patient. Fiducial markers attached to the patient permit semi-automatic or fully automatic registration if a roadmap image including the fiducial markers can be obtained. In many cases however, use of fiducial markers is not feasible, necessitating a potentially time consuming and inaccurate manual registration procedure. The present principles provide a system and method for rapid and accurate automatic or semiautomatic registration. In particularly useful embodiments, a prescribed set of image acquisitions are combined in standard imaging planes with subsequent image processing of pre-procedure and intra-procedure imaging. 
<!-- EPO <DP n="9"/>-->
 The present embodiments provide a system and method to automatically obtain a reliable subject-specific initialization for registration of internal organs, such as, e.g., a liver, from ultrasound (US) images to a prior pre-operative image volumes (e.g., CT or MR) during interventional or diagnostic procedures. Automatic multimodal image registration is challenging, since the final registration performance depends on the image quality from both reference and target modalities, segmentation accuracy and reliable starting point for optimizing the transformation. </p><p id="p0031" num="0031"> Existing methods rely either on manually identified fiducials which can correlate ultrasound with CT/MR or use image-based features to automatically register modalities. However, these systems require a manual initialization which can easily lead to suboptimal solutions. The present embodiments address these problems by using a framework which exploits tracked intra-operative images (e.g., US) as a multiplanar registration (MPR) selector integrated with an image-based segmentation method, which can accurately transform the obtained free-hand 2D image to a pre-acquired 3D reference volume of another modality. Based on this framework, an initialization of the rigid transformation matrix is obtained independently of image quality, and is subsequently refined via a constrained shape-matching approach from a segmented organ boundary. </p><p id="p0032" num="0032"> The improved registration results have several applications. These applications may include at least some of: (1) Verification/monitoring of current fiducial-based registration accuracy between electromagnetic (EM) tracked ultrasonic (US) images and a pre-acquired 3D image; (2) Estimation of tumor or target locations on pre-operative images; (3) Improved initialization for image-based registration of 2D ultrasound and pre-acquired 3D images; (4) Non-rigid (elastic) correction to registration of 2D ultrasound and pre-acquired 3D images; and (5) Verification of tumor existence and assessment in a diagnostic setting. 
<!-- EPO <DP n="10"/>-->
 It should be understood that the present embodiments will be described in terms of registering a pre-operative image volume with an intra-operative three-dimensional volume; however, the systems and methods in accordance with the present principles can be applied to registrations between any of pre-operative, intra-operative, and post-operative images for monitoring, interventional procedures and/or diagnostic applications. </p><p id="p0033" num="0033"> It also should be understood that the present invention will be described in terms of medical systems and instruments; however, the teachings of the present invention are much broader and are applicable to any instruments employed in tracking or analyzing complex biological or mechanical systems. In particular, the present principles are applicable to internal tracking procedures of biological systems, procedures in all areas of the body such as the lungs, gastro -intestinal tract, excretory organs, blood vessels, etc. The elements depicted in the FIGS, may be implemented in various combinations of hardware and software and provide functions which may be combined in a single element or multiple elements. The present principles may be applied for guidance of many interventional or surgical procedures that need registration of the patient with a prior medical image (e.g., biopsy, ablation, embolization, drainage, etc.). These principles may also be applied in diagnostic applications that employ multi-modality registration and may not involve interventional procedures. For example, since ultrasound and CT provide complimentary diagnostic information, it may be beneficial to register these two modalities to ensure that the same lesion is being evaluated in both images. For these non-interventional applications, it should also be clear that the multi- modality registration step, although utilizing tracking and imaging information acquired during the ultrasound exam, may actually be performed either during the ultrasound imaging exam or retrospectively, for example on an imaging workstation after the exam is completed. </p><p id="p0034" num="0034"> The functions of the various elements shown in the FIGS, can be provided through the 
<!-- EPO <DP n="11"/>-->
 use of dedicated hardware as well as hardware capable of executing software in association with appropriate software. When provided by a processor, the functions can be provided by a single dedicated processor, by a single shared processor, or by a plurality of individual processors, some of which can be shared. Moreover, explicit use of the term "processor" or "controller" should not be construed to refer exclusively to hardware capable of executing software, and can implicitly include, without limitation, digital signal processor ("DSP") hardware, read-only memory ("ROM") for storing software, random access memory </p><p id="p0035" num="0035">("RAM"), non-volatile storage, etc. </p><p id="p0036" num="0036"> Moreover, all statements herein reciting principles, aspects, and embodiments of the invention, as well as specific examples thereof, are intended to encompass both structural and functional equivalents thereof. Additionally, it is intended that such equivalents include both currently known equivalents as well as equivalents developed in the future (i.e., any elements developed that perform the same function, regardless of structure). Thus, for example, it will be appreciated by those skilled in the art that the block diagrams presented herein represent conceptual views of illustrative system components and/or circuitry embodying the principles of the invention. Similarly, it will be appreciated that any flow charts, flow diagrams and the like represent various processes which may be substantially represented in computer readable storage media and so executed by a computer or processor, whether or not such computer or processor is explicitly shown. </p><p id="p0037" num="0037"> Furthermore, embodiments of the present invention can take the form of a computer program product accessible from a computer-usable or computer-readable storage medium providing program code for use by or in connection with a computer or any instruction execution system. For the purposes of this description, a computer-usable or computer readable storage medium can be any apparatus that may include, store, communicate, 
<!-- EPO <DP n="12"/>-->
 propagate, or transport the program for use by or in connection with the instruction execution system, apparatus, or device. The medium can be an electronic, magnetic, optical, electromagnetic, infrared, or semiconductor system (or apparatus or device) or a propagation medium. Examples of a computer-readable medium include a semiconductor or solid state memory, magnetic tape, a removable computer diskette, a random access memory (RAM), a read-only memory (ROM), a rigid magnetic disk and an optical disk. Current examples of optical disks include compact disk - read only memory (CD-ROM), compact disk - read/write (CD-R/W) and DVD. </p><p id="p0038" num="0038"> Referring now to the drawings in which like numerals represent the same or similar elements and initially to FIG. 1, a system 100 for performing a medical procedure is illustratively depicted. System 100 may include a workstation or console 112 from which a procedure is supervised and managed. Workstation 112 preferably includes one or more processors 114 and memory 116 for storing programs and applications. Memory 116 may store one or more program modules employed in initializing and providing registration of images and tracking systems. </p><p id="p0039" num="0039"> System 100 includes a position tracking system 120. The workstation 112 is connected to the tracking system 120 and a scanning device 126. The workstation 112 obtains images from the scanner 126, and concurrently obtains corresponding position information from a sensor 123. The workstation 112 may also be integrated in and become part of the scanner 126 or vice versa. </p><p id="p0040" num="0040"> The position tracking system 120 may include an electromagnetic (EM), optical or other tracking technology and is employed to spatially track a real-time probe 122 of the scanning device 126. The tracking system 120 may work with a tracking module 128 in memory 116 of workstation 112 for correlating probe positions with images as will be 
<!-- EPO <DP n="13"/>-->
 explained in greater detail herein. The probe 122 includes the sensor or sensors 123 employed by the tracking system 120. In a case where the sensor 123 includes an EM sensor, a tracking field generator 125 may be employed to create a magnetic field to enable EM tracking for the tracking system 120. The field generator 125 may be placed near the patient 132 during a medical procedure. In one embodiment, the tracking sensor 123 is attached to the probe or ultrasound transducer. </p><p id="p0041" num="0041"> The scanning device 126 may include an ultrasonic (US) scanning device, although other real-time imaging system may be employed. For ease of explanation, the scanning device 126 will illustratively be described in terms of ultrasonic technology. Images gathered in real-time during a procedure will be referred to as intra-operative images. </p><p id="p0042" num="0042"> An imaging system 130 may be available in system 100 but need not be. Imaging system 130 may be provided for collecting pre-operative imaging data or real-time intraoperative imaging data. The pre-operative imaging may be performed at another facility, location, etc. in advance of any procedure. These 3D images 131 may be stored in memory 116. </p><p id="p0043" num="0043"> The imaging system 130 provides a pre-acquired medical image or volume of a patient or subject 132. These images will be referred to as pre-operative images. The imaging system may include a computed tomography (CT) system, a magnetic resonance imaging (MRI) system, a pre-operative 3D US imaging system, or other imaging systems. </p><p id="p0044" num="0044"> The memory 116 of workstation 112 includes an image and tracking data processing module 134, which is configured to process images as well as data from the tracking system 120. The processing module 134 performs a workflow which includes tracking one or several ultrasound probe poses (e.g., for axial midline images) with the ultrasound probe 122 from the scanner 126 at arbitrary positions, perpendicular to a skin surface of the subject 132. The 
<!-- EPO <DP n="14"/>-->
 processing module 134 further acquires additional image planes in an area of interest, for reconstruction into a three-dimensional (3D) US volume from scanner 126. </p><p id="p0045" num="0045"> The processing module 134 automatically initializes an intra-operative to pre-operative image registration search (e.g., US-CT) space, utilizing knowledge of an approximate pose of the ultrasound probe 122 (from tracking data) during an image plane acquisition, and utilizing physical constraints of the ultrasound probe 122 pose during the image plane and volumetric acquisition, e.g., the ultrasound probe 122 needs to be in contact with the patient's skin for imaging. </p><p id="p0046" num="0046"> The processing module 134 further provides intra-operative to pre-operative image registration optimization. The optimization is preferably based on image processing of the pre-operative medical image and the intra-operative (US) images, including automated segmentation of anatomical structures. A similarity measure is defined between the preoperative images and the intra-operative images. Using known optimization techniques such as exhaustive search, or Downhill Simplex, the similarity measure is optimized to identify a best match between images. </p><p id="p0047" num="0047"> In one embodiment, a clinical workflow records tracking data from the probe 122 at two locations (e.g., near a sternum of the patient 132) and tracking data from a location acquired during an ultrasonic liver or other organ/boundary sweep. The liver is employed in this embodiment as a reference due to its distinctive shape. Other organs or references may be employed. </p><p id="p0048" num="0048"> A segmentation module 140 segments images of organs using segmentation methods. The segmentation module 140 acquires and stores pre-operative 3D volumes and uses them for 3D segmentation of a skin surface represented by a cloud of 3D coordinate points. An alignment or registration module 142 uses the cloud of coordinates for initial alignment and 
<!-- EPO <DP n="15"/>-->
 for constraining an optimization search space. The 3D segmentation of the liver shape (or other organ shapes) represented by a triangulated mesh model may be employed for a model- based registration approach. </p><p id="p0049" num="0049"> In this embodiment, the processing module acquires and processes tracking sensor 123 coordinates in real-time, and employs them for computing an automatic image-based rigid transformation matrix between a pre-acquired 3D shape model of the liver and a segmented liver surface obtained from an intra-operative 3D US volume. A multiplanar registration (MPR) determined by the tracking sensor 123 shows corresponding pre-operative image information (from, e.g., CT or MR) at a latest acquired real-time image with liver boundary (from real-time intra-operative US image) fitting to an edge of the pre-operative image liver segmentation. </p><p id="p0050" num="0050"> In another embodiment, the workstation enables accurate multimodal registration by acquiring and processing tracking sensor 123 coordinates in real-time. The sensor 123 coordinates are employed for 3D patient-specific segmentation (e.g., of US images) in segmentation module 142 of a liver or other boundary using a confidence-based region growing which propagates through a volume. This process collects voxels which belong to an intensity interval with a dynamically adjustable standard deviation. This enables the creation of a binary volume of a surface, e.g., a liver surface. A mask is subsequently processed to extract a surface representation of a liver capsule and boundary. The resulting segmentation is employed for optimizing image alignment between modalities. The parameter search space is restricted or constrained by an area defined by a skin surface segmentation which penalizes probe transformations mapping away from the skin, such that the MPR determined by the tracking sensor shows corresponding pre-operative image information (e.g., from CT or MR) at a latest acquired real-time image with the US liver boundary fitting to the edge of the pre- 
<!-- EPO <DP n="16"/>-->
 operative liver segmentation. </p><p id="p0051" num="0051"> Workstation 112 may include a display 118 for viewing internal images of a subject. Display 118 may also permit a user to interact with the workstation 112 and its components and functions. This is further facilitated by an interface 119 which may include a keyboard, mouse, a joystick or any other peripheral or control to permit user interaction with the workstation 112. The user interface 119 guides the user through the workflow, prompts for and guides initiation of individual work steps, and permits interactive correction to any automatically computed registrations. </p><p id="p0052" num="0052"> In one embodiment, the interface 119 and display 118 permit the user to receive instructions or prompts through the work station 112 to assist the use through each stage of the registration process utilizing text, diagrams or both. The interface 119 may provide manual controls or overrides to control the image registration and initialization process as described in greater detail below by translating/rotating the intra-operative image and preoperative volumes relative to one another. The interface 119 and display 118 permit the user to start the optimization process from any manually adjusted starting pose. In addition, a user may be prompted through the interface 119 and display 118 to select from a choice of similarity measures, optimized for the specific image acquisition in the given patient. The display 118 permits visualization, in one or several cut-planes or in 3D renderings, with or without superimposition of segmentation information, the intra-operative/pre-operative (e.g., US-CT) alignment at any stage. The interface 119 enables a user to accept or reject any registration result. </p><p id="p0053" num="0053"> Referring to FIG. 2, further details for image registration are provided by illustratively showing coordinate transformations for registration of different modalities in accordance with the present principles. In one example, a chain of transformations 210 are employed to fuse a 
<!-- EPO <DP n="17"/>-->
 live ultrasound image 202 (acquired by the probe 122 tracked with tracking sensor 123) with a pre-acquired CT image 204. A one-time calibration procedure determines a transformation caiibration, which relates a coordinate system Cus of the real-time ultrasound image to a coordinate system C<sub>sen</sub>sor of the tracking sensor 123 attached to the probe 122. The real-time tracking information from the tracking system 120 provides the transformation T<sub>trac</sub>ki<sub>ng</sub>, which relates a coordinate system C<sub>senS</sub>or to a coordinate system C<sub>trac</sub>king of the tracking system 120 (e.g., from the electromagnetic field generator 125). The transformation Titration is initially unknown and needs to be established. </p><p id="p0054" num="0054"> Titration relates the coordinate system of the tracking system C<sub>trac</sub>king to a coordinate system C<sub>CT</sub> of the CT image. Once established, any pixel in the real-time ultrasound image 202 can be related to a voxel in the CT image 204 via the transformation chain 210, which permits side-by-side display, fusion, etc. of corresponding US and CT image planes. </p><p id="p0055" num="0055"> Tregistration is established by first reconstructing a 3D US volume from tracked 2D ultrasound images 202 in the coordinate system C<sub>trac</sub>king of the tracking system 120. </p><p id="p0056" num="0056">Alternatively, the 3D US volume may be obtained using a 3D capable transducer without the need for tracked 2D planes. Such 3D capable transducers include transducers which acquire a 3D volume by mechanically sweeping a ID imaging array through an arc (known as mechanical 3D transducers), and transducers which acquire a 3D volume by electronic steering of an ultrasound beam (known as 2D array or Matrix transducers). A subsequent image-based registration, determined by the optimal alignment of the 3D US with the CT image 204, provides a Titration that can then be used in the transformation chain 210 for processing of the real-time ultrasound image 202. </p><p id="p0057" num="0057"> The image-based registration of the 3D US image 202 with the CT image 204 is needed but no known methods exist, save the present principles, to provide this registration in 
<!-- EPO <DP n="18"/>-->
 a robust, accurate and quick manner for any interventional or diagnostic setting.</p><p id="p0058" num="0058">Referring to FIG. 3, the registration (T<sub>re</sub>gi<sub>st</sub>ra<sub>t</sub>io<sub>n</sub>) may be completed in two parts. In block 302, a search space is constrained based on patient positioning and physics of ultrasound imaging for potential alignments (i.e., Tit<sub>r</sub>atio<sub>n</sub>) of the 3D US with the CT. In block 304, a pre-segmentation on the CT scan is performed, and an appropriate similarity measure is defined between the 3D US and the segmented CT to optimize the alignment within the constrained search space. </p><p id="p0059" num="0059"> The unconstrained search space for rigid registration comprises six degrees of freedom (e.g., 3 rotate, 3 translate). The search space can be effectively constrained by implementing a workflow and subsequent image processing that determine the approximate positioning of the patient relative to the tracking system (120), and by assuming that all ultrasound images are obtained while the ultrasound probe is in contact with the patient's skin. </p><p id="p0060" num="0060"> In block 306, the workflow includes prompting a user to position the probe at any location near the midline of a sternum, as if to acquire an axial ultrasound plane midline on the patient, with the probe pointing exactly in the A-P (anterior-posterior) direction. In block 308, a tracking pose is obtained for the ultrasound probe (122) in this position. In block 310, the user is prompted to place the ultrasound probe at a second location (this is optional if other orientation mechanisms are employed) closer toward a lower portion (e.g., toward the legs or feet) (while maintaining probe angle). In block 312, the tracking pose is again obtained if the second position is employed. </p><p id="p0061" num="0061"> In block 314, the user may be prompted to set the ultrasound scanner to a largest depth setting (e.g., 16, 20, 24 cm) that permits meaningful image acquisition in the area of interest in the patient (e.g., the largest depth setting before electronic noise obscures any image information in the deepest part of the image) and captures as much of the outer 
<!-- EPO <DP n="19"/>-->
 boundaries of the structure of interest as possible. Then, in block 316, the user is prompted to obtain a free-hand, mechanical, or electronic 3D sweep of the organ of interest with this depth setting. </p><p id="p0062" num="0062"> In block 318, images and tracking poses are recorded during the sweep, and the acquired images are reconstructed into a 3D US volume. If supported by the ultrasound transducer, the 3D sweep may also be acquired by motorized or electronic means so that the 3D US volume is obtained automatically. </p><p id="p0063" num="0063"> Referring to FIG. 4 with continued reference to FIG. 3, transducer probe 122 locations 402 and 404 along midline and coordinate axes relative to the patient are illustratively shown. Block 310 determines the approximate rotational alignment (3 DOFs) between the tracking system space and the CT space. Block 314 resolves the ambiguity with regards to the patient's general orientation with respect to the tracking system or CT space, by determining an orientation and direction of the cranio-caudal (C-C) axis through a patient 132. Note that no ultrasound image is needed or utilized for either of the steps in blocks 310 and 314, the relevant information is derived from the tracked pose of a transducer (probe) 122 at positions 402 and 404. Both blocks 310 and 314 also determine the approximate lateral alignment (1 translational DOF) of the patient 132, by assuming the probe was positioned along a midline (L-R axis). One additional translational DOF (A-P axis alignment (Anterior to Posterior)) is determined by assuming the probe 122 was placed on the patient's skin. The skin surface can be easily extracted from the CT image ahead of time, the central midline L-R (left-right) axis can be extracted from the skin segmentations, and the A-P alignment is adjusted to map the physical probe surface during all the acquisition steps onto the skin surface. </p><p id="p0064" num="0064"> It should be understood that while the acquisition of two or more positions is one 
<!-- EPO <DP n="20"/>-->
 useful implementation, e.g., to resolve the cranio-caudal direction ambiguity, other implementations may be employed. E.g., if the tracked ultrasound probe 122 is equipped with a direction marker 408 that clearly indicates how the probe should be oriented (e.g., which side is facing the head versus the feet of a patient), then the acquisition of six degrees of freedom tracking in just one such reference pose at the patient's midline is sufficient. </p><p id="p0065" num="0065"> The remaining single unknown degree of freedom (DOF) is the translation along a cranio-caudal (C-C) axis. This translation can be approximately initialized by mapping a probe position (between positions 402 and 404 or using an orientation measure or marker 408 (e.g., probe orientation)) during a sweep acquisition to the center of the pre-segmented organ of interest in the CT, and/or by mapping the C-C axis probe position during block 310 to the pre-segmented sternum of the patient in the CT, and/or by placing the transducer probe at the position of the umbilicus in block 314 and similarly mapping this to the plane of the umbilicus in the CT. </p><p id="p0066" num="0066"> Alignment optimization in block 304 of FIG. 3 is described in greater detail. With the registration transformation initialized in block 302, the transformation needs to be optimized by maximizing an appropriate similarity measure between the 3D US and the CT, in the vicinity of the initial pose. In the context of fusing pre-operative CT images of an abdominal target (e.g., liver, kidney, prostate, or other organ) with live US images, one similarity measure may utilize a pre-segmentation of a target organ surface from CT, spatially- dependent thresholding of high-intensity pixels in the ultrasound image (likely corresponding to the surface organ at a particular distance from the probe), and minimizing a weighted sum of squared distance between thresholded ultrasound pixels and the CT organ surface. </p><p id="p0067" num="0067"> In another embodiment, a similarity measure may utilize a pre-segmentation of the target organ surface from CT, and maximize the average ultrasound pixel values that map 
<!-- EPO <DP n="21"/>-->
 onto the CT target organ surface. Another similarity measure for a target organ of interest may utilize a pre-segmentation of CT liver vessels, and minimize the average ultrasound pixel values that map onto the CT liver vessels. Another embodiment includes the alignment with a segmentation of US liver vessels maximized. A similarity measure may utilize a pre- segmentation of the target organ surface from CT, and minimize a pointset-to-pointset measure that maps a cloud of points created from ultrasound to the CT organ surface. The similarity measure may also include a weighted combination of any subset of the above or other similarity measures. </p><p id="p0068" num="0068"> In another embodiment, the registration processing is performed on one organ, which is not the same as the organ on which the clinical procedure is performed. For example, the registration can be performed on the liver, but the clinical procedure targets a kidney. </p><p id="p0069" num="0069"> In addition, tracking data is recorded from a location 406 acquired during an ultrasonic liver (or other organ or feature) sweep. As described, pre-operative images are acquired and stored, e.g., 3D CT or MR volumes. These pre-operative images are subjected to 3D segmentation of a skin surface represented by a cloud of 3D coordinate points. The skin segmentation is employed for an initial alignment and for constraining the optimization search space. A 3D segmentation of a liver shape (or other distinctive shaped organ) may be represented by a triangulated mesh model. The liver shape is employed for a model-based registration approach. </p><p id="p0070" num="0070"> During a procedure, a sensor (123) has its coordinates acquired and processed in realtime as a transducer probe 122 is positioned at positions 402 and 404. The tracked sensor coordinates are employed to compute an automatic image-based rigid transformation matrix between of the 3D shape model of the liver and a segmented liver surface obtained from an intra-operative 3D US volume taken at position 406. Registration is determined between the 
<!-- EPO <DP n="22"/>-->
 pre-operative image information (from CT, MR) for a latest acquired real-time image (intraoperative) by aligning a liver boundary to the segmented liver image. </p><p id="p0071" num="0071"> Another method for enabling accurate multimodal registration includes acquiring and processing tracking sensor coordinates in real-time, and providing 3D US patient-specific segmentation of the liver boundary using a confidence-based region growing which propagates through the volume. This process collects voxels which belong to an intensity interval with a dynamically adjustable standard deviation to enable the creation of a binary volume of the liver surface or a mask. The mask is subsequently processed to extract a surface representation of the liver capsule and boundary. The resulting segmentation may be employed for optimizing the image alignment between modalities. </p><p id="p0072" num="0072"> A parameter search space is restricted by the area defined by a skin surface segmentation which penalizes probe transformations mapping away from the skin. </p><p id="p0073" num="0073">Registration is determined between the pre-operative image information (from CT, MR) for a latest acquired real-time image (intra-operative) by aligning a liver boundary to the segmented liver image. </p><p id="p0074" num="0074"> Referring to FIG. 5, an exemplary method for aligning images is illustratively shown. In block 502, pre-operative images (e.g., CT images) are collected and stored. In block 504, an organ surface is segmented by known methods. In block 506, a skin surface is segmented. In block 508, two probe positions are determined, e.g., near a sternum or other biological reference. In block 510, 3D sweeps (e.g., US scans) of an organ of interest are performed. In block 512, a 3D volume reconstruction of the 3D sweeps is performed. </p><p id="p0075" num="0075"> In block 514, automatic initialization of rigid transformation parameters is performed. This includes computing transformation matrices and registering coordinate systems. In block 516, an optimization search space is refined by restricting degrees of freedom in images (or 
<!-- EPO <DP n="23"/>-->
 data). In block 518, updated rigid transformations are computed. In block 520, an image- based similarity metric is selected and evaluated. In block 522, alignment between images is checked. If the alignment is satisfactory, the process is ended. If the alignment is not satisfactory the rigid transformations are updated in block 518. </p><p id="p0076" num="0076"> Referring to FIG. 6, an illustrative workflow shows image data collection and processing using a CT scan for pre-operative image collection and ultrasonic image collection for real-time (intra-operative) image data. The storage and processing of image data is preferably performed in software running on a workstation (e.g., 1 12 in FIG. 1) and communicating with external hardware (tracking system, ultrasound scanner, etc.) using realtime electronic data transfer for running a custom-designed clinical workflow. </p><p id="p0077" num="0077"> Prior to the interventional procedure, a 3D volume is obtained in block 702 by using an imaging modality with 3D imaging ability (e.g., MR, CT, etc.). An integrated software tool (e.g., segmentation module 140 and/or processing module 134) is used to perform an automatic and unsupervised segmentation to get a 3D shape of the liver in the pre-operative 3D volume in block 704, as well as a segmentation of the skin surface in block 706. </p><p id="p0078" num="0078"> During the procedure, the patient for an image guided procedure (interventional, diagnostic, etc.) will be positioned on an examination table. A position sensor will be attached to an ultrasound probe. The transmitter/receiver of a tracking system will be positioned close to the patient such that the ultrasound probe with attached position sensor is in the field of view of the transmitter/receiver during the necessary ultrasound imaging for the procedure. The probe is placed at first position perpendicular to the sternum, followed by a second caudal position. A 2D US sweep scan covering the liver will be acquired to reconstruct a 3D ultrasound volume in block 708. The volume and corresponding probe position data will be transferred to the navigation workstation (112). Note that the probe positions may be 
<!-- EPO <DP n="24"/>-->
 indicated in the skin segmentation in block 706. In block 710, a liver surface may be extracted from the reconstructed 3D US volume of block 708. </p><p id="p0079" num="0079"> Registration between the pre-acquired 3D volume in block 702 and a segmented 3D reconstructed ultrasound volume in block 708 will be initialized using the information from the probe's tracking data oriented at particular scan planes, then refined using an image-based approach. The real-time 2D ultrasound tissue images and corresponding probe position data will be continuously transferred (streamed) to the workstation (112). Based on a current probe position, the location of the current image relative to the pre-acquired 3D volume of block 702 will be computed using a rigid transformation to align liver (or other organ boundaries) in block 712. On the display 118 of workstation 112, the transformed </p><p id="p0080" num="0080">corresponding intersection contour will be overlaid on the current image to start automatic image segmentation. Fused registered images with aligned liver boundaries are output in block 714. </p><p id="p0081" num="0081"> An ultrasound probe can be tracked using a tracking system such as an electromagnetic system. A position sensor compatible with the tracking system is attached to the ultrasound probe. A one-time calibration procedure is executed to determine the </p><p id="p0082" num="0082">transformation T<sub>ca</sub>ii ra<sub>t</sub>io<sub>n</sub> between a tracking sensor coordinate system and a real-time 2D ultrasound image coordinate system. The pose information T<sub>track</sub>in<sub>g</sub> from the tracking sensor is continuously acquired by a workstation. </p><p id="p0083" num="0083"> Prior to the image-guided procedure, the pre-operative image (702) is automatically segmented to obtain a 3D shape model of the liver (704). The shape model S<sub>3</sub>D<sub>P</sub>re is represented by a triangulated mesh with 3D point locations represented in the pre-operative image space coordinate system to have a correspondence to the target image volume. The same pre-operative image is then processed to extract a skin surface S<sub>3</sub>Dskin by creating a 
<!-- EPO <DP n="25"/>-->
 binary volume (706) using a region growing method with a predefined range of values. The binary volume is then filtered to obtain voxels whose neighbors are background voxels. </p><p id="p0084" num="0084"> The 3D US volume (708) can be generated by tracking a 2D probe, streaming to the workstation all 2D image frames and corresponding tracking data, obtaining a "sweep" over the liver area after, e.g., contrast injection, and reconstructing the 3D volume based on the acquired 2D images and tracking data. The reconstructed 3D US volume will be stored on the workstation along with the corresponding transformation T<sub>Tr</sub>ackingSystem -» 3DUS from tracking system coordinates to the reconstructed 3D US voxel coordinates. </p><p id="p0085" num="0085"> The 3D US volume (708) which was reconstructed from the liver organ is then processed to extract a surface (710) to be matched with the pre-acquired liver segmentation. A basic thresholding step is first applied to eliminate zero-valued pixels as well as pixels which are located at, e.g., a 5 cm distance to discard information which may be prone to high tissue deformation. A seed is then automatically determined by selecting the highest valued-pixel at a maximal distance from the US probe, located along the principal axis which was computed by a principal component analysis (PCA) of the US frames. A confidence-based region growing method may be employed and initialized from this seed and iteratively propagated until the binary segmented region converges (i.e., avoids segmentation leakage inside the hepatic tissue and maximized surface extent). A rasterization process is then applied by selecting only the pixels which first intersect an array of rays which originate from the US probe location and directed towards every binary voxel. This creates a mesh surface S<sub>3</sub>Dintra whose 3D coordinates represent the liver boundary. </p><p id="p0086" num="0086"> In block 712, an initial rigid transformation matrix JDUS-&gt; 3DPreo<sub>P</sub> which registers the 3D US volume (708) (or extracted volume (710)) to the 3D pre-operative volume (702) (or 3D model (704)), as depicted in FIG. 7, is initialized with values obtained by the following 
<!-- EPO <DP n="26"/>-->
 chain of transformations. </p><p id="p0087" num="0087"> In FIG. 7, the chain of transformations includes:
<img id="imgf000026_0001" he="5" wi="21" file="imgf000026_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 3DPreop 
<img id="imgf000026_0002" he="6" wi="111" file="imgf000026_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0088" num="0088">which first corrects the orientation by computing the inverse of an orientation matrix of probePosi, representing the tracking sensor data acquired at a first probe position near a midline. Estimation of the translation parameters in the X, Y, Z axes are determined in the following order: </p><p id="p0089" num="0089"> Tcentroidz: translation in the Z axis so to align centroids in the caudal-cranial direction of the pre-operative volume and of the US liver sweep.</p><p id="p0090" num="0090"> skinciampYProbei-2 : corrects displacement in posterior-anterior direction (Y axis) by translating in the Y direction so that both probe positions (1 and 2) intersect the skin segmentation.</p><p id="p0091" num="0091"> skinciampxusprobe: left-right displacement by translating in the X axis the US probe position obtained during the sweep so that it intersects the skin segmentation. </p><p id="p0092" num="0092"> The transformation between the coordinates of reconstructed 3D US volume and pre- acquired 3D reference volume can be computed by using an image-based registration, which may be denoted by T<sub>3D</sub>us^ 3DPreo<sub>P</sub>, initialized by the previously defined Tinit JDUS^ 3DPreo<sub>P</sub>. An illustrative cost function which we seek to minimize to optimize the parameters of T<sub>3D</sub>us^ 3DPreo<sub>P</sub>, namely t and R which are the translation and rotation parameters respectively, follows a constrained Iterative Closest Point (ICP)-like objective function which penalizes potential transformation candidates which map probe positions further away from a skin surface: </p><p id="p0093" num="0093">T 3DUS→3DPreop</p><p id="p0094" num="0094"><img id="imgf000026_0003" he="11" wi="127" file="imgf000026_0003.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/></p><p id="p0095" num="0095">The registration function implements an image similarity metric. The first term is a point-based similarity measure where for each point vertex q<sub>t</sub> included in S<sub>3DUS</sub> of the US 
<!-- EPO <DP n="27"/>-->
 mesh, the closest point in the fixed mesh model (from CT) based on a Euclidian distance, is determined and pondered with n<sub>t</sub> defined as the normal at each point coordinate of the preoperative 3D model. These distances are summed for all subsampled mesh vertices from the US surface to maximize the alignment between both segmented point sets. We then incorporate regional salient statistics as a second data related similarity term Ψ, which seeks to align corresponding sub-regions of the mesh surfaces. The target CT mesh surface is initially subdivided into smaller regions integrating the following measures: 1) variance of point vertices, 2) cross-correlation between subsets; 3) similarity in curvature. Therefore, we formulate the similarity term as: whereO is the 
<img id="imgf000027_0001" he="9" wi="107" file="imgf000027_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 standard deviation and κ is the variance. </p><p id="p0096" num="0096"> Given an updated transformed US mesh surface, these same statistics are computed in the pre-defined regions with the corresponding mesh region. Finally, a cost assigning function Φ is linked to the transformation applied to the midline and US sweep probe locations. The former is a Heaviside function which prohibits locations &amp;i<sub>;2</sub> obtained from the 2 probe locations acquired near the sternum to be mapped further than a 1 cm from the skin such that: </p><p id="p0097" num="0097"> distlskin &lt;</p><p id="p0098" num="0098"><img id="imgf000027_0002" he="13" wi="38" file="imgf000027_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 distlskin≥ </p><p id="p0099" num="0099"> For the probe location obtained at the sweep, an inversely linear function which allows the mapped location ¾us to be located between skin and liver surface to allow probe pressure during the image acquisition. First, we detect if the new probe position is outside the skin surface, then the linear Euclidian distance with an added penalizing term (+10) is assigned to the cost, while if ¾us is inside the CT liver mesh, a higher penalizing cost (+100) is assigned given the improbable scenario. If the probe position lies in between the skin and liver surface, 
<!-- EPO <DP n="28"/>-->
 we account for possible probe pressure by calculating the log distance to the closest point of the skin surface such that Φ = log (|| bus - ScT-skin ||). The closer to the skin, the more probable the solution is. In sum, the cost function can be formulated as: </p><p id="p0100" num="0100">Φ(6<sub>υ8</sub>)</p><p id="p0101" num="0101"><img id="imgf000028_0001" he="20" wi="70" file="imgf000028_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/></p><p id="p0102" num="0102">The first step to optimize the image alignment is a coarse and exhaustive translational search which is first performed to refine the displacement parameters in a group-like fashion. Here the transformation parameters are represented by a quaternion vector and converted to a 4x4 transformation matrix which is applied to the moving points. Once a minimum is obtained, a group-like exhaustive search of rotational parameters is then performed where rotation about the X, Y and Z axes. What is important in this case is that the center of rotation for the transformation is the probe position. Hence, all transformations are applied with regards to the probe's location in space and with respect to liver and skin surface. Therefore when optimizing the rotation parameters, the probe's location remains in the same location. </p><p id="p0103" num="0103"> We perform interpolation of 3D rotation in the quaternion domain, by converting the 3x3 rotational matrices into quaternions. Once the crude refinement is obtained, the 6 degrees of freedom (DOF) are simultaneously optimized using a gradient-descent, non-linear </p><p id="p0104" num="0104">Levenberg-Marquardt optimization scheme. This obtains the minima of the cost function and determines the optimal solution using the starting point provided by the coarse exhaustive search. Other optimizations may also be employed. </p><p id="p0105" num="0105"> Once the registration between the reconstructed 3D US volume 708 and the 3D preoperative volume 702 is determined after optimization, the position of the current 2D ultrasound frame within the pre-acquired reference image can be determined based on the current tracking data T<sub>trac</sub>kin<sub>g</sub> from the tracking sensor by using the transformation: 
<!-- EPO <DP n="29"/>-->
 T2DUS-&gt;3DPreop <sup>=</sup> T3DUS"&gt; 3DPreop T rackirig System 3DUS
<img id="imgf000029_0001" he="5" wi="63" file="imgf000029_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0106" num="0106"> = l 3DUS^ 3DPreop (T3DUs) T tracking (Tcalibra ion) </p><p id="p0107" num="0107"> where:</p><p id="p0108" num="0108"><img id="imgf000029_0002" he="5" wi="23" file="imgf000029_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 is the transformation from the 2D US image coordinate system to the pre-operative 3D image coordinate system,</p><p id="p0109" num="0109"><img id="imgf000029_0003" he="5" wi="30" file="imgf000029_0003.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 the transformation from the 2D US image coordinate system to the probe sensor coordinate system (which is the inverse of the so-called calibration </p><p id="p0110" num="0110">transformation Tcaiibmtion),</p><p id="p0111" num="0111"><img id="imgf000029_0004" he="5" wi="37" file="imgf000029_0004.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 is the transformation from the probe sensor coordinate system to the tracking system coordinate system, i.e., the "tracking transformation" T<sub>trac</sub>kin<sub>g</sub> of the ultrasound probe,</p><p id="p0112" num="0112"> irackingSystem -» 3Dus is an arbitrary "convenience" transformation that positions the reconstructed 3D US volume in tracking system space (and which is by definition the inverse </p><p id="p0113" num="0113">The workstation (112) will use this relationship to extract, in real-time, an initialization contour, i.e., the intersected 3D surface shape on 2D ultrasound plane that corresponds to the current pose of the 2D tissue image. The contour will be used to start tissue segmentation in this 2D ultrasound image. </p><p id="p0114" num="0114"> It should be understood that the present principles may include other tracking systems. For example, instead of an electromagnetic tracking system, tracking systems based on other physical principles can be employed, such as, optical tracking systems. An alternative embodiment may employ a 3D capable US transducer which permits the acquisition of matrix- based volumetric image data at a single probe location. This may avoid the need of manually sweeping the 2D probe. This may also avoid volume reconstruction errors which can be 
<!-- EPO <DP n="30"/>-->
 prone to interpolation and motion artifacts. </p><p id="p0115" num="0115"> In some embodiments, instead of using a single sequence of US images to create a single 3D US volume, a stitching or compounding of multiple image acquisitions may be employed to create a panoramic view representation of the liver or other organ for increased accuracy of the 3D surface segmentation. </p><p id="p0116" num="0116"> In addition, non-rigid image deformation may be accounted for. The assumption of optimizing a rigid transformation between the pre-operative shape model and the intraoperative US data remains valid and accurate if the patient's internal organs do not deform by motion or breathing artifacts. However, this cannot always be assumed as a constant parameter. To enhance the accuracy in the presence of tissue motion, image-based motion correction may be applied to the images to account for deformations. </p><p id="p0117" num="0117"> The present principles may be applied in a variety of clinical procedures in computer aided diagnosis, minimally invasive surgery, interventional radiology, etc. In particular, by using segmented contours for registration, positioning and guidance, the present embodiments can assist in improving ultrasound-based image guidance of diagnostic and therapeutic medical procedures. </p><p id="p0118" num="0118"> In interpreting the appended claims, it should be understood that: </p><p id="p0119" num="0119"> a) the word "comprising" does not exclude the presence of other elements or acts than those listed in a given claim; </p><p id="p0120" num="0120"> b) the word "a" or "an" preceding an element does not exclude the presence of a plurality of such elements; </p><p id="p0121" num="0121"> c) any reference signs in the claims do not limit their scope; </p><p id="p0122" num="0122"> d) several "means" may be represented by the same item or hardware or software implemented structure or function; and 
<!-- EPO <DP n="31"/>-->
 e) no specific sequence of acts is intended to be required unless specifically indicated. </p><p id="p0123" num="0123"> Having described preferred embodiments for systems and methods for automated initialization and registration of a navigation system (which are intended to be illustrative and not limiting), it is noted that modifications and variations can be made by persons skilled in the art in light of the above teachings. It is therefore to be understood that changes may be made in the particular embodiments of the disclosure disclosed which are within the scope of the embodiments disclosed herein as outlined by the appended claims. Having thus described the details and particularity required by the patent laws, what is claimed and desired protected by Letters Patent is set forth in the appended claims. 
</p></description><claims mxw-id="PCLM44852079" ref-ucid="WO-2012117381-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="32"/>-->CLAIMS: </claim-statement><claim id="clm-0001" num="1"><claim-text> 1. A method for image registration, comprising: </claim-text><claim-text> tracking (508) a scanner probe in at least one position along a skin surface of a patient; </claim-text><claim-text> acquiring (510) image planes corresponding to the at least one position; </claim-text><claim-text> reconstructing (512) a three-dimensional volume of a region of interest from the image planes; </claim-text><claim-text> initializing (514) a search of an image volume to determine candidate images to register the image volume with the three-dimensional volume by employing pose information of the scanner probe during image plane acquisition, and physical constraints of a pose of the scanner probe; and </claim-text><claim-text> registering (522) the image volume with the three-dimensional volume. </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. The method as recited in claim 1, wherein tracking (508) a scanner probe in at least one position along a skin surface of a patient includes tracking an ultrasonic scanner probe held substantially perpendicular to the skin surface. </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. The method as recited in claim 1 , wherein acquiring (510) image planes corresponding to the at least one position includes acquiring image planes at two positions along a midline of a sternum of the patient. </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. The method as recited in claim 1 , wherein the area of interest includes an organ. <!-- EPO <DP n="33"/>--> </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. The method as recited in claim 1, wherein reconstructing (512) a three- dimensional volume of a region of interest from the image planes includes acquiring image planes of the area of interest to capture boundaries in the area of interest. </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. The method as recited in claim 5, wherein registering (522) includes aligning the boundaries in the area of interest of the three-dimensional volume with corresponding boundaries of a segmented image volume. </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. The method as recited in claim 1, wherein initializing (514) a search of an image volume includes constraining a search space for the search by employing a patient positioning and the pose of the scanner probe. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. The method as recited in claim 1, further comprising optimizing (516) alignment between the image volume and the three-dimensional volume by selecting a similarity measure and computing the similarity measure between images. </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. The method as recited in claim 1, further comprising fusing (714) the image volume with the three-dimensional volume. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. A method for image registration, comprising: </claim-text><claim-text> segmenting (504, 506) a reference organ and a skin surface image of a patient in an image volume; </claim-text><claim-text> tracking (508) a scanner probe in at least one position along the skin surface of a patient; <!-- EPO <DP n="34"/>--> acquiring (510) images corresponding to the at least one position and the reference organ; </claim-text><claim-text> reconstructing (512) a three-dimensional volume of the reference organ from the image planes; </claim-text><claim-text> initializing (514) a transformation matrix with initial parameter values constrained by poses and physical constraints of the scanner probe during image acquisition to determine the transformation matrix between the image volume with the three-dimensional volume; and </claim-text><claim-text> optimizing (516) the transformation matrix to find coordinates that register the image volume with the three-dimensional volume using a cost function (520). </claim-text></claim><claim id="clm-0011" num="11"><claim-text>11. The method as recited in claim 10, wherein tracking (508) a scanner probe includes tracking an ultrasonic scanner probe held substantially perpendicular to the skin surface. </claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. The method as recited in claim 11, wherein acquiring (510) images includes acquiring image planes at two positions along a midline of a sternum of the patient. </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. The method as recited in claim 10, wherein the reference organ includes a liver. </claim-text></claim><claim id="clm-0014" num="14"><claim-text>14. The method as recited in claim 10, wherein reconstructing (512) an intraoperative three-dimensional volume includes acquiring images of the reference organ to capture boundaries of the reference organ. <!-- EPO <DP n="35"/>--> </claim-text></claim><claim id="clm-0015" num="15"><claim-text>15. The method as recited in claim 14, wherein optimizing (516) includes refining translation and rotation parameters and minimizing (520) the cost function for degrees of freedom between the three-dimensional volume and a segmented image volume. </claim-text></claim><claim id="clm-0016" num="16"><claim-text>16. The method as recited in claim 10, wherein initializing (514) includes constraining a search space for the search by employing a scanner positioning and the pose of the scanner probe relative to a segmented skin surface image. </claim-text></claim><claim id="clm-0017" num="17"><claim-text>17. The method as recited in claim 10, further comprising fusing (714) the image volume with the three-dimensional volume. </claim-text></claim><claim id="clm-0018" num="18"><claim-text>18. A system for image registration, comprising: </claim-text><claim-text> a spatial trackable scanner probe (122); </claim-text><claim-text> an imaging device (130) configured to acquire image planes corresponding to at least one position of the scanner probe; </claim-text><claim-text> an image processing module (134) configured to reconstruct a three- dimensional volume of a region of interest from the image planes, the image processing module further configured to initialize a search of a stored model of the image volume to determine candidate images to register the image volume with the three-dimensional volume by employing pose information of the scanner probe during image plane acquisition, and physical constraints of the pose of the scanner probe; and </claim-text><claim-text> a registration module (142) configured to register the image volume with the three-dimensional volume. <!-- EPO <DP n="36"/>--> </claim-text></claim><claim id="clm-0019" num="19"><claim-text>19. The system as recited in claim 18, wherein the scanner probe (122) includes an ultrasonic scanner probe tracked with a tracking sensor (123). </claim-text></claim><claim id="clm-0020" num="20"><claim-text>20. The system as recited in claim 18, wherein scanner probe (122) includes an ultrasonic scanner probe which acquires three-dimensional images. </claim-text></claim><claim id="clm-0021" num="21"><claim-text>21. The system as recited in claim 20, wherein the area of interest includes an organ. </claim-text></claim><claim id="clm-0022" num="22"><claim-text>22. The system as recited in claim 18, wherein organ boundaries in the three- dimensional volume are aligned with corresponding organ boundaries of a segmented image volume. </claim-text></claim><claim id="clm-0023" num="23"><claim-text>23. The system as recited in claim 18, wherein the image processing module (134) constrains a search space for the search by employing a patient positioning and the pose of the scanner probe. </claim-text></claim><claim id="clm-0024" num="24"><claim-text>24. The system as recited in claim 18, wherein the image processing module (134) optimizes alignment between the image volume and the three-dimensional volume by computing a similarity measure between images. </claim-text></claim><claim id="clm-0025" num="25"><claim-text>25. The system as recited in claim 18, wherein the scanner probe (122) includes an orientation measure (408) to define an orientation of the scanner probe to enable use of a single position of acquiring an image plane. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
