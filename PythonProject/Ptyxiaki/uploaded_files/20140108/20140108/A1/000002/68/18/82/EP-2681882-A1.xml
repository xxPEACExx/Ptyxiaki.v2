<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2681882-A1" country="EP" doc-number="2681882" kind="A1" date="20140108" family-id="46718929" file-reference-id="289024" date-produced="20180823" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146586406" ucid="EP-2681882-A1"><document-id><country>EP</country><doc-number>2681882</doc-number><kind>A1</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12708402-A" is-representative="NO"><document-id mxw-id="PAPP154848598" load-source="docdb" format="epo"><country>EP</country><doc-number>12708402</doc-number><kind>A</kind><date>20120222</date><lang>EN</lang></document-id><document-id mxw-id="PAPP220440092" load-source="docdb" format="original"><country>EP</country><doc-number>12708402.8</doc-number><date>20120222</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140557698" ucid="IB-2012050818-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>IB</country><doc-number>2012050818</doc-number><kind>W</kind><date>20120222</date></document-id></priority-claim><priority-claim mxw-id="PPC140556860" ucid="US-201113113007-A" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201113113007</doc-number><kind>A</kind><date>20110520</date></document-id></priority-claim><priority-claim mxw-id="PPC140549121" ucid="US-201161447671-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201161447671</doc-number><kind>P</kind><date>20110228</date></document-id></priority-claim><priority-claim mxw-id="PPC140546975" ucid="US-201161449696-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201161449696</doc-number><kind>P</kind><date>20110306</date></document-id></priority-claim></priority-claims><technical-data><classification-ipc><edition>7</edition><main-classification>H04L  12/56</main-classification></classification-ipc><classifications-ipcr><classification-ipcr mxw-id="PCL1989320817" load-source="patent-office">H04L  12/56        00000000AFI20120919BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL2122924316" load-source="docdb" scheme="CPC">H04L  45/507       20130101 FI20141001BHEP        </classification-cpc><classification-cpc mxw-id="PCL2122924350" load-source="docdb" scheme="CPC">H04L  45/28        20130101 LA20141001BHEP        </classification-cpc><classification-cpc mxw-id="PCL2122925821" load-source="docdb" scheme="CPC">H04L  45/22        20130101 LI20141001BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132363851" lang="DE" load-source="patent-office">SCHNELLE MPLS-NEUUMLEITUNG MIT LDP (LDP-FRR)</invention-title><invention-title mxw-id="PT132363852" lang="EN" load-source="patent-office">MPLS FAST RE-ROUTE USING LDP (LDP-FRR)</invention-title><invention-title mxw-id="PT132363853" lang="FR" load-source="patent-office">REROUTAGE RAPIDE MPLS UTILISANT LDP (LDP-FRR)</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR919505429" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ERICSSON TELEFON AB L M</last-name><address><country>SE</country></address></addressbook></applicant><applicant mxw-id="PPAR919505605" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>TELEFONAKTIEBOLAGET L M ERICSSON (PUBL)</last-name></addressbook></applicant><applicant mxw-id="PPAR919016640" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Telefonaktiebolaget L M Ericsson (PUBL)</last-name><iid>101131063</iid><address><city>164 83 Stockholm</city><country>SE</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919525464" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>KINI SRIGANESH</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919536484" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>KINI, SRIGANESH</last-name></addressbook></inventor><inventor mxw-id="PPAR919006569" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>KINI, SRIGANESH</last-name><address><street>45855 Cheyenne Pl.</street><city>Fremont, California 94539</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919529712" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>NARAYANAN SRIKANTH</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919539768" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>NARAYANAN, SRIKANTH</last-name></addressbook></inventor><inventor mxw-id="PPAR919007618" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>NARAYANAN, SRIKANTH</last-name><address><street>135 Rio Robles Unit 369</street><city>San Jose, California 95134</city><country>US</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR919015106" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>HOFFMANN EITLE</last-name><iid>100061036</iid><address><street>Patent- und Rechtsanwälte Arabellastrasse 4</street><city>81925 München</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="IB-2012050818-W"><document-id><country>IB</country><doc-number>2012050818</doc-number><kind>W</kind><date>20120222</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012117317-A1"><document-id><country>WO</country><doc-number>2012117317</doc-number><kind>A1</kind><date>20120907</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS549760198" load-source="docdb">AL</country><country mxw-id="DS549770516" load-source="docdb">AT</country><country mxw-id="DS549760199" load-source="docdb">BE</country><country mxw-id="DS549838422" load-source="docdb">BG</country><country mxw-id="DS549851769" load-source="docdb">CH</country><country mxw-id="DS549760582" load-source="docdb">CY</country><country mxw-id="DS549770525" load-source="docdb">CZ</country><country mxw-id="DS549837891" load-source="docdb">DE</country><country mxw-id="DS549760200" load-source="docdb">DK</country><country mxw-id="DS549760583" load-source="docdb">EE</country><country mxw-id="DS549838323" load-source="docdb">ES</country><country mxw-id="DS549838423" load-source="docdb">FI</country><country mxw-id="DS549838424" load-source="docdb">FR</country><country mxw-id="DS549837892" load-source="docdb">GB</country><country mxw-id="DS549760205" load-source="docdb">GR</country><country mxw-id="DS549837893" load-source="docdb">HR</country><country mxw-id="DS549760584" load-source="docdb">HU</country><country mxw-id="DS549851774" load-source="docdb">IE</country><country mxw-id="DS549760206" load-source="docdb">IS</country><country mxw-id="DS549838425" load-source="docdb">IT</country><country mxw-id="DS549760207" load-source="docdb">LI</country><country mxw-id="DS549837898" load-source="docdb">LT</country><country mxw-id="DS549770526" load-source="docdb">LU</country><country mxw-id="DS549837899" load-source="docdb">LV</country><country mxw-id="DS549837900" load-source="docdb">MC</country><country mxw-id="DS549770527" load-source="docdb">MK</country><country mxw-id="DS549770528" load-source="docdb">MT</country><country mxw-id="DS549838324" load-source="docdb">NL</country><country mxw-id="DS549914724" load-source="docdb">NO</country><country mxw-id="DS549838325" load-source="docdb">PL</country><country mxw-id="DS549770537" load-source="docdb">PT</country><country mxw-id="DS549838326" load-source="docdb">RO</country><country mxw-id="DS549770538" load-source="docdb">RS</country><country mxw-id="DS549838327" load-source="docdb">SE</country><country mxw-id="DS549760589" load-source="docdb">SI</country><country mxw-id="DS549914725" load-source="docdb">SK</country><country mxw-id="DS549914726" load-source="docdb">SM</country><country mxw-id="DS549838430" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA99835364" ref-ucid="WO-2012117317-A1" lang="EN" load-source="patent-office"><p num="0000">MPLS (Multiprotocol Label Switching) fast re-routing using LDP (Label Distribution Protocol) is described. A first network element in a MPLS network receives a first label advertised from a second network element in the MPLS network. The first network element computes a shortest path tree (SPT) to reach a destination network element under a potential failure condition. The second network element is a nexthop of the first network element in the computed SPT and is not upstream from the potential failure condition. The first network element advertises a second label to one or more third network elements for a backup LDP LSP (Label Switched Path) that will serve as a backup when the potential failure condition is realized. The third network element(s) are upstream neighbors on the computed SPT with respect to the first network element. The first network element installs a swap action from the second label to the first label.</p></abstract><abstract mxw-id="PA100331198" ref-ucid="WO-2012117317-A1" lang="EN" source="national office" load-source="docdb"><p>MPLS (Multiprotocol Label Switching) fast re-routing using LDP (Label Distribution Protocol) is described. A first network element in a MPLS network receives a first label advertised from a second network element in the MPLS network. The first network element computes a shortest path tree (SPT) to reach a destination network element under a potential failure condition. The second network element is a nexthop of the first network element in the computed SPT and is not upstream from the potential failure condition. The first network element advertises a second label to one or more third network elements for a backup LDP LSP (Label Switched Path) that will serve as a backup when the potential failure condition is realized. The third network element(s) are upstream neighbors on the computed SPT with respect to the first network element. The first network element installs a swap action from the second label to the first label.</p></abstract><abstract mxw-id="PA99835365" ref-ucid="WO-2012117317-A1" lang="FR" load-source="patent-office"><p num="0000">L'invention porte sur un reroutage rapide à commutation d'étiquette multiprotocole (MPLS) utilisant un protocole de distribution d'étiquette (LDP). Un premier élément réseau dans un réseau MPLS reçoit une première étiquette publicisée à partir d'un deuxième élément réseau dans le réseau MPLS. Le premier élément réseau calcule un arbre de trajet le plus court (SPT) pour atteindre un élément de réseau de destination sous une condition de défaillance potentielle. Le deuxième élément réseau est un saut suivant du premier élément réseau dans le SPT calculé et n'est pas en amont à partir de la condition de défaillance potentielle. Le premier élément réseau publicise une seconde étiquette à un ou plusieurs troisièmes éléments réseau pour un trajet à commutation d'étiquette (LDP LSP) de secours qui servira de secours lorsque la condition de défaillance potentielle sera réalisée. Le ou les troisièmes éléments réseau sont des voisins en amont du SPT calculé par rapport au premier élément réseau. Le premier élément réseau installe une action de permutation à partir de la seconde étiquette vers la première étiquette.</p></abstract><abstract mxw-id="PA100331199" ref-ucid="WO-2012117317-A1" lang="FR" source="national office" load-source="docdb"><p>L'invention porte sur un reroutage rapide à commutation d'étiquette multiprotocole (MPLS) utilisant un protocole de distribution d'étiquette (LDP). Un premier élément réseau dans un réseau MPLS reçoit une première étiquette publicisée à partir d'un deuxième élément réseau dans le réseau MPLS. Le premier élément réseau calcule un arbre de trajet le plus court (SPT) pour atteindre un élément de réseau de destination sous une condition de défaillance potentielle. Le deuxième élément réseau est un saut suivant du premier élément réseau dans le SPT calculé et n'est pas en amont à partir de la condition de défaillance potentielle. Le premier élément réseau publicise une seconde étiquette à un ou plusieurs troisièmes éléments réseau pour un trajet à commutation d'étiquette (LDP LSP) de secours qui servira de secours lorsque la condition de défaillance potentielle sera réalisée. Le ou les troisièmes éléments réseau sont des voisins en amont du SPT calculé par rapport au premier élément réseau. Le premier élément réseau installe une action de permutation à partir de la seconde étiquette vers la première étiquette.</p></abstract><description mxw-id="PDES51232977" ref-ucid="WO-2012117317-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="2"/>--><p id="p0001" num="0001"> MPLS FAST RE-ROUTE USING LDP (LDP-FRR) </p><p id="p0002" num="0002">CROSS-REFERENCE TO RELATED APPLICATIONS </p><p id="p0003" num="0003"> This application claims the benefit of U.S. Provisional Application No. 61/449,696, filed March 6, 2011, and U.S. Provisional Application No. 61/447,671, filed February 28, 2011, which are hereby incorporated by reference. </p><p id="p0004" num="0004">FIELD </p><p id="p0005" num="0005"> Embodiments of the invention relate to the field of networking; and more specifically, to MPLS (Multiprotocol Label Switching) Fast-Reroute. BACKGROUND </p><p id="p0006" num="0006"> Recovering traffic with minimal loss is a fundamental requirement in carrier- class networks. Fast-Reroute (FRR) is a technique to recover traffic with minimal loss under failure conditions in a network. </p><p id="p0007" num="0007"> LDP (Label Distribution Protocol), defined in RFC 5036, is a widely deployed protocol to setup Label Switched Paths (LSPs) in MPLS (Multiprotocol Label Switching) (defined in RFCs 3031 and 3032) implementations. LDP establishes LSPs along routed paths setup by IGP (Interior Gateway Protocol) (defined, for example, in RFC 2328). Thus, the convergence of LSPs established with LDP under failure conditions is gated by IGP convergence. </p><p id="p0008" num="0008"> RSVP-TE (Resource Reservation Protocol - Traffic Engineering) based FRR has been standardized (RFC 4090) and implemented in several vendors platforms. Some operators and vendors have tried to address the fast-convergence of LDP by using RSVP-TE. This feature is typically referred to as LDP-over-RSVP. </p><p id="p0009" num="0009"> Since LDP follows routed paths setup by IGP, its convergence is gated by IGP convergence. However IGP convergence has been traditionally slow. A good description of the problem is in section 4 of RFC 5714. For example, such reasons include: the time taken to detect the failure, the amount of time for the local router to react the failure, the amount of time to transmit the information about the failure to other routers in the network, the amount of time to re-compute the forwarding tables, and the amount of time to download the re-computed forwarding tables into the 
<!-- EPO <DP n="3"/>-->
 forwarding hardware. Several approaches have tried to introduce FRR in IGP to improve IGP convergence, but each of them have been plagued by several problems. For example, approaches to solving this problem such as draft-ietf-rtgwg-ipfrr-notvia- addresses-OX has deployment and implementation complexity and hence has not been adopted. Approaches such as Loop Free Alternates (described in RFC 5286) do not have full coverage, hence carriers have reservations in deploying them. </p><p id="p0010" num="0010"> Another approach to providing FRR for LDP LSPs is to use RSVP-TE as a failure-bypass mechanism (LDP-over-RSVP). However, carriers have been slow to deploy RSVP-TE due to several reasons, including the extensive configuration and maintenance experience requirements since an additional, fairly complex protocol such as RSVP-TE is used, leading to increased operating expenses. LDP-over-RSVP also requires the vendor to support many features (such as high availability and reliability) in RSVP-TE that may not be available in many implementations. </p><p id="p0011" num="0011">BRIEF DESCRIPTION OF THE DRAWINGS </p><p id="p0012" num="0012"> The invention may best be understood by referring to the following description and accompanying drawings that are used to illustrate embodiments of the invention. In the drawings: </p><p id="p0013" num="0013"> Figure 1 illustrates an exemplary MPLS network that uses LDP-FRR according to one embodiment; </p><p id="p0014" num="0014"> Figure 2 illustrates the network of Figure 1 where the network elements configure a BSP LSP to reach a given destination network element over a potential failure of a link according to one embodiment; </p><p id="p0015" num="0015"> Figure 3 is a flow diagram illustrating exemplary operations for configuring</p><p id="p0016" num="0016">LDP-FRR for a single link failure according to one embodiment; </p><p id="p0017" num="0017">Figure 4 illustrates the network of Figure 1 where the network elements configure a</p><p id="p0018" num="0018">BSP LSP to reach a given destination network element over a potential failure of a network element according to one embodiment; </p><p id="p0019" num="0019"> Figure 5 is a flow diagram illustrating exemplary operations for configuring</p><p id="p0020" num="0020">LDP-FRR for a single node failure according to one embodiment; and </p><p id="p0021" num="0021"> Figure 6 illustrates an exemplary network element that implements LDP FRR according to one embodiment. 
<!-- EPO <DP n="4"/>-->
 SUMMARY </p><p id="p0022" num="0022"> MPLS (Multiprotocol Label Switching) fast re-routing using LDP (Label Distribution Protocol) is described. An LDP LSP (Label Switched Path) to reach a destination network under a potential failure condition is computed. That computed LDP LSP is merged with a current shortest path LDP LSP at that one of the plurality of network elements that is the first network element along the computed LDP LSP that has a nexthop to the current shortest path LDP LSP. </p><p id="p0023" num="0023"> In one embodiment, a first network element in an MPLS network receives a first label advertised from a second network element in the MPLS network. The first network element computes a shortest path tree (SPT) to reach a destination network element under a potential failure condition. The second network element is a nexthop of the first network element in the computed SPT and is not upstream from the potential failure condition. The first network element advertises a second label to one or more third network elements for a backup LDP LSP that will serve as a backup when the potential failure condition is realized. The third network element(s) are upstream neighbors on the computed SPT with respect to the first network element. The first network element installs a swap action from the second label to the first label. In this embodiment, the first network element is a backup switched path merge point. </p><p id="p0024" num="0024"> In one embodiment, a first network element in an MPLS network computes an SPT to reach a destination network element under a potential failure condition. The first network element receives a label from a second network element for a backup LDP LSP that will serve as a backup when the potential failure condition is realized. The second network element is an upstream neighbor on the computed SPT with respect to the first network element. The first network element installs a failure trigger action for the potential failure condition to cause the received label to be used when sending traffic to the second network element when the potential failure condition is realized in order to re-route traffic around the failure. Responsive to detecting a failure condition that corresponds with the potential failure condition, traffic received from the second network element destined for the destination network element is rerouted back to the second network element using the received label for the backup LDP LSP. In this embodiment, the first network element is a Point of Local Repair. 
<!-- EPO <DP n="5"/>-->
 DESCRIPTION OF EMBODIMENTS </p><p id="p0025" num="0025"> In the following description, numerous specific details are set forth. However, it is understood that embodiments of the invention may be practiced without these specific details. In other instances, well-known circuits, structures and techniques have not been shown in detail in order not to obscure the understanding of this description. Those of ordinary skill in the art, with the included descriptions, will be able to implement appropriate functionality without undue experimentation. </p><p id="p0026" num="0026"> References in the specification to "one embodiment," "an embodiment," "an example embodiment," etc., indicate that the embodiment described may include a particular feature, structure, or characteristic, but every embodiment may not necessarily include the particular feature, structure, or characteristic. Moreover, such phrases are not necessarily referring to the same embodiment. Further, when a particular feature, structure, or characteristic is described in connection with an embodiment, it is submitted that it is within the knowledge of one skilled in the art to effect such feature, structure, or characteristic in connection with other embodiments whether or not explicitly described. </p><p id="p0027" num="0027"> In the following description and claims, the terms "coupled" and "connected," along with their derivatives, may be used. It should be understood that these terms are not intended as synonyms for each other. "Coupled" is used to indicate that two or more elements, which may or may not be in direct physical or electrical contact with each other, co-operate or interact with each other. "Connected" is used to indicate the establishment of communication between two or more elements that are coupled with each other. </p><p id="p0028" num="0028"> In one embodiment of the invention, fast-reroute for LDP LSPs is provided without depending on IGP fast-convergence, IP-FRR, or RSVP-TE based FRR. Since LDP has very simple and easy configuration procedures that has led to its current wide adoption, an implementation that adopts embodiments of the invention can retain the simple configuration model. In most circumstances a carrier will not have to change any operational procedures to an implementation of embodiments of this invention. Thus, embodiments of the invention retain the simplicity of operating LDP and overcomes the complexity of IP-FRR and LDP-over-RSVP while providing coverage in all fault scenarios. 
<!-- EPO <DP n="6"/>-->
 In one embodiment, a network element computes an LSP to reach the destination under a potential failure condition. This LSP is merged with the current shortest path LSP at the first node along the path where the merge is possible. This minimizes the number of extra labels required and also ensures that there is no traffic churn when IGP reconverges. </p><p id="p0029" num="0029"> The following terminology is used to describe embodiments of the invention. A PLPv (Point of Local Repair) is the head-end LSR (Label Switch router) of a backup- switched path (BSP) LSP. The PLR is the node that detects a failure and repairs the failure of the link or node by sending traffic on an alternate route (the BSP LSP). The BSP LSP is an LDP LSP that provides a backup for a specific failure entity on the shortest path LDP LSP. The failure entity may be a link, a node, or a SRLG. The BSP LSP originates from the PLR(s). A Backup Switched Path Merge Point (BSP-MP) is an LSR where the BSP LSP is label switched to a label allocated for the shortest path LDP LSP. The BSP-MP need not be downstream of the potential failure. An exclude- SPT (Shortest Path Tree) is the shortest path tree from a PLR to a FEC (Forwarding Equivalence Class) when a particular failure point is excluded from the network. </p><p id="p0030" num="0030"> For a given failure point on the shortest path tree towards a FEC, an LSR upstream of that failure point acts as a BSP-MP and advertises a label for the BSP LSP (referred herein as an alternate label since the LSP will not be taken unless the failure occurs) if that LSR is on an exclude-SPT for that FEC from a PLR of the failure point, and that LSR belongs on the shortest path LDP LSP to that FEC that does not traverse the failure point. The BSP-MP advertises the alternative label for the BSP LSP along the exclude-SPT. </p><p id="p0031" num="0031"> If the shortest path from the PLR to the BSP-MP is not contained in the Exclude-SPT, then each of the intermediate LSRs allocate an alternate label for the BSP LSP and install label swap operations in their forwarding structure(s) (e.g., their ILM (Incoming Label Map)). </p><p id="p0032" num="0032"> The PLR installs a failure action such that upon the failure occurring, the LSP is switched to the BSP LSP for that FEC. In one embodiment, preference is given to a node failure over a link failure. If a BSP LSP is not available for the FEC for the failure, but a BSP LSP to the next-hop or the next-next-hop is available, then it used by pushing the corresponding label on to the label stack. 
<!-- EPO <DP n="7"/>-->
 In one embodiment, after a failure, the BSP LSPs corresponding to the topology before the failure should be removed after a short delay. </p><p id="p0033" num="0033"> Figure 1 illustrates an exemplary MPLS network that uses LDP-FRR according to one embodiment. The network illustrated in Figure 1 includes the network elements 110A-G. Each of the network elements acts as a LS . The network element 110A is coupled with the network elements HOB, HOD, and 110E over the links 122, 121, and 120 respectively. The network element HOB is further coupled with the network element 1 IOC over the link 123. The network element 1 IOC is further coupled with the network element 110F over the link 124. The network element 11 OF is further coupled with the network elements 110E and HOG over the links 125 and 127 respectively. The links 121, 122, 123, 124, and 125 each have a cost of 1. The link 120 has a cost of 5 and the link 126 has a cost of 3. </p><p id="p0034" num="0034"> Figure 1 illustrates a number of LSP segments that have been established between the network elements. In one embodiment, the LSP segments have been established using LDP. For example, the network element 110A advertises a label L4 to the network element HOD as part of establishing the LSP segment 131. The network element HOB advertises a label L3 to the network element 11 OA as part of establishing the LSP segment 139. The network element 1 IOC advertises a label L2 to the network element HOB as part of establishing the LSP segment 138. The network element 110F advertises a label LI to the network element 1 IOC as part of establishing the LSP segment 137 and advertises a label L6 to the network element 110E as part of establishing the LSP segment 134. The network element HOG advertises a label L8 to the network element 11 OF as part of establishing the LSP segment 136, and advertises a label L7 to the network element 1 10E as part of establishing the LSP segment 135. The network element 110E advertises a label L5 to the network element 110 as part of establishing the LSP segment 133. The network element 110F advertises a label L6 to the network element 110E as part of establishing the LSP segment 134. </p><p id="p0035" num="0035"> Figure 1 also illustrates a shortest path tree. For example, traffic from the network element 110D to the network element HOG takes the following path: 110D -&gt; 110A ^ 110B ^ 1 IOC ^ 110F ^ 110G. Traffic from the network element 110D to the network element HOG does not travel through the network element 110E because the cost of the link 120 (which is 5) causes it to be a less preferred path. Thus, the link 
<!-- EPO <DP n="8"/>-->
 120 and the LSP segment 133 have been illustrated as dashed lines because they are not part of the SPT to the network element HOG. The link 126 and the LSP segment 135 are also illustrated as dashed lines because they are not part of an SPT from the network element 110E to the network element HOG. </p><p id="p0036" num="0036"> The network elements include forwarding structures to perform the label switching. For example, the network element 11 OA includes forwarding structure(s) that specify that when it receives a packet having the label L4 from the network element HOD, it is to swap the label L4 with the label L3 and transmit the packet to the network element HOB. In one embodiment, the forwarding structures include ILM (incoming label map) and NHLFE (next hop label forwarding entry) data structures. </p><p id="p0037" num="0037"> In one embodiment, the network elements illustrated in Figure 1 compute BSP LSPs for a number of potential failures in case that the failures occur. The number of BSP LSPs that are created for alternative paths is kept at a minimum as some regular LSP segments (LSP segments that are established for non-failure scenarios) can be used. For example, a network element that is acts as a BSP-MP for a particular failure can merge a BSP-LSP with an established LSP to re-route the failure. </p><p id="p0038" num="0038"> The following terminology is used to describe the operations performed by the network elements to establish the LDP FRR. </p><p id="p0039" num="0039"> 1. A directed graph is denoted by G. Nodes are denoted by S, D, N, M, O, and P. </p><p id="p0040" num="0040"> Links are denoted by L, K, J, and I. </p><p id="p0041" num="0041"> 2. All links in G have cost &gt; 0. </p><p id="p0042" num="0042"> 3. Node (G, D) denotes a node D in graph G. </p><p id="p0043" num="0043"> 4. SPT stands for shortest path tree (as computed by, for example, Dijkstra's algorithm). </p><p id="p0044" num="0044"> 5. SPT(G, S) denotes a SPT from node S (in graph G) to all other nodes in G. </p><p id="p0045" num="0045"> Note that SPT(G, D) is a directed acyclic graph (DAG) and is of course a graph.</p><p id="p0046" num="0046">6. PairSPT(G, S, D) denotes the SPT between a pair of nodes from S to D in G.</p><p id="p0047" num="0047">7. PairSPT(G, S, D, Dl, D2, ... ) denotes the shortest path from S to reach anyone of D, Dl, D2, .... </p><p id="p0048" num="0048"> 8. ToSPT(G, D) is the shortest path tree to a node D (as computed by, for example, Dijkstra's algorithm) in graph G from all other nodes in G. Note that toSPT(G, D) is also a DAG similar to SPT(G,S), and is of course a graph. 
<!-- EPO <DP n="9"/>-->
 9. Link (G, L) denotes a directed link L in graph G. </p><p id="p0049" num="0049"> 10. UpNode(G, L) denotes a node in graph G that is at the upstream end of link L.</p><p id="p0050" num="0050">11. DnNode(G, L) denotes a node in graph G that is at the downstream end of L.</p><p id="p0051" num="0051">12. Note that UpNode(toSPT(G, D), L) would be a node that would repair a fault in L by sending traffic on an alternate route. This is typically referred to as the Point of Local Repair (PLR) for repairing a fault in L. Also note that DnNode(toSPT(G, D), L) would be a node that traffic merges back when link protection is done by PLR for the directly connected LDP peer and label stacking is used. </p><p id="p0052" num="0052"> 13. Upstr(G, D, L) denotes a subtree of a G that consists of all nodes that are upstream of L in toSPT(G, D) and all links between those nodes. If L does not belong to toSPT(G, D) then it is a NULL graph. Note that upstr is a graph, but not necessarily a DAG. </p><p id="p0053" num="0053"> 14. G - L denotes the graph G without link L. </p><p id="p0054" num="0054"> 15. G - F denotes a subset of graph G. Here F is a set of links and nodes (with their attached links) from G. F is removed from G to give G - F. </p><p id="p0055" num="0055"> In a connected graph G, for any link L in the toSPT(G, D), (for any D), there exists a node in upstr(G, D, L) with a link other than L to a node in G but not in upstr(G, D, L) if there exists a path from UpNode(L) to D in G-L. If there does not exist such a node, then the link L is a cut-edge of the graph G and there is no path from UpNode(G, L) to D in G-L. The goal is to number of new LSPs created for alternative paths and keep the LDP philosophy of routing along the shortest path. </p><p id="p0056" num="0056"> In one embodiment, each of the network elements 110A-G perform the following to establish fast-routing for LDP LSPs in a single link failure case. </p><p id="p0057" num="0057"> 1. For every D in G, do the following </p><p id="p0058" num="0058"> a. Compute the toSPT(G, D) </p><p id="p0059" num="0059"> b. For every link L in toSPT(G, D), do the following: </p><p id="p0060" num="0060"> i. Compute toSPT(G - L, D); </p><p id="p0061" num="0061"> ii. If a node is in upstr(G, D, L) and belongs to pairSPT(G-L, UpNode(G, D, L), D), then allocate (and distribute) a label for D (called Alternate Label or AL) to upstream neighbors 
<!-- EPO <DP n="10"/>-->
 in pairSPT. Setup ILM (incoming label map) entries as follows: </p><p id="p0062" num="0062"> 1. If this node has a nexthop in the above-mentioned pairSPT that is not in above-mentioned upstr then it installs a swap action for the allocated AL to the label received from the peer </p><p id="p0063" num="0063"> 2. Else it allocates a swap action from the AL it has allocated to the AL received from downstream LDP peers in the pairSPT </p><p id="p0064" num="0064">3. UpNode(G, D, L) which is the PL , installs a failure trigger action for L, where if link L fails then instead of using the label allocated by DnNode(G, D, L) it uses AL and forwards the packet as indicated by ILM. </p><p id="p0065" num="0065"> 4. If AL is not received for D but has been received for the loopback address of DnNode(G, D, L) then setup the failure action to stack that label and forward packet accordingly. </p><p id="p0066" num="0066"> The complexity for the procedure described above with respect to a single link failure is 0(N<sup>A</sup>4), but is believed that it can be done in 0(N<sup>A</sup>3). </p><p id="p0067" num="0067"> Figure 2 illustrates the network of Figure 1 where the network elements configure a BSP LSP to reach the destination network element HOG over a potential failure of the link 124. Figure 2 will be described with respect to the Figure 3, which is a flow diagram illustrating exemplary operations for configuring LDP FRR according to one embodiment. In one embodiment, each of the network elements 110A-G perform the operations described in Figure 3. </p><p id="p0068" num="0068"> At operation 310, one of the nodes (one of the network elements 110A-G) is selected. With respect to Figure 2, the selected node is the network element HOG. Flow then moves to operation 315 and a SPT is computed to the selected node HOG from all other nodes in the network. Flow then moves to operation 320 and a link is selected to exclude from the computed SPT. With respect to Figure 2, the selected link to exclude is the link 124. Flow then moves to operation 325 and the SPT to the 
<!-- EPO <DP n="11"/>-->
 selected node is computed with the selected link excluded. Thus, the SPT is calculated to the selected node assuming that the selected link is not part of the network. </p><p id="p0069" num="0069"> Flow then moves to operation 330 where a determination is made whether the network element performing the calculation is upstream of the selected link and belongs to the SPT from the point of local repair (PLR) to the selected node with the selected link excluded. The SPT from the PLR to the selected node with the selected link is referred herein with respect to the operations of Figure 3 as the exclude-SPT. </p><p id="p0070" num="0070"> With reference to Figure 2, the PLR is the network element HOC. The nodes upstream of the selected link include the network elements 11 OA, HOB, and HOD. The nodes that belong to the exclude-SPT are the network elements 11 OA and HOB (network element HOD is not part of the exclude-SPT). If the network element performing the calculation is upstream of the selected link and belongs to the SPT from the PLR to the second node with the selected link excluded, then flow moves to operation 335; otherwise flow moves to operation 350. </p><p id="p0071" num="0071"> At operation 335, the network element performing the calculation allocates and distributes (e.g., using LDP) a label for a BSP-LSP to the selected node to upstream neighbors in the exclude-SPT. For example, with reference to Figure 2, the network element 110A allocates and distributes the alternative label AL1 to the network element HOB as part of establishing the BSP-LSP segment 240 and the network element HOB allocates and distributes the alternative label AL2 to the network element 1 IOC as part of establishing the BSP-LSP segment 241. Flow then moves to operation 340. </p><p id="p0072" num="0072"> At operation 340, if the network element that is performing the operations has a nexthop in the exclude-SPT that is not upstream from the selected link (the link that has been excluded), then flow moves to operation 345 (the network element is the merge point), otherwise flow moves to operation 360. To say it another way, if the network element is on the exclude-SPT and belongs on the shortest path LDP LSP to the selected node that does not traverse the failure point, then it is a merge point and flow would move to operation 345. With respect to Figure 2, the network element 110A has a nexthop in the exclude-SPT that is not upstream from the link 124 (which is the network element 110E). </p><p id="p0073" num="0073"> At operation 345, the network element installs a swap action for the alternative label it has allocated and distributed to the label received from that nexthop network 
<!-- EPO <DP n="12"/>-->
 element. For example, with respect to Figure 2, the network element 110E installs a swap action for the alternative label AL1 to the label L5 previously received from the network element 110E. Thus, the network element 110E, which is acting as the BSP- MP in this example, merges the BSP-LSP that is being established to re-route around the failure of the link 124 with the current shortest path LSP. This minimizes the number of extra alternative labels required and also ensures that there is no traffic churn when IGP reconverges. Flow moves from operation 345 to operation 365. </p><p id="p0074" num="0074"> At operation 350, if the network element that is performing the operations is the PLR, then flow moves to operation 355, otherwise flow moves to operation 365. At operation 355, the network element installs a failure trigger action for the selected link (which is excluded) to cause the alternative label that it has received from an upstream neighbor to be used. For example, with respect to Figure 2, the network element 1 IOC, which is acting as the PLR, installs a failure trigger action such that upon the failure of the link 124 occurring, the network element HOC will cause traffic arriving from the network element HOB with the label L2 to be sent along the BSP LSP segment 241 (e.g., by changing one or more entries in its forwarding structure(s)). In one embodiment, only the PLR needs to take action upon a failure occurring by causing the traffic to be sent along the BSP LSP. Flow moves from operation 355 to operation 365. </p><p id="p0075" num="0075"> At operation 360, since the network element is not the BSP-MP but is upstream of the selected link and belongs to the exclude-SPT, then it is an intermediate node along the exclude-SPT and therefore installs a swap action from the alternative label it allocated and distributed for the BSP-LSP to the alternative label for the BSP-LSP received from a downstream LDP peers in the exclude-SPT. For example, with respect to Figure 2, the network element HOB installs a swap action from the alternative label AL2 it has allocated and distributed to the network element HOC to the alternative label AL1 it has received from the network element 110A. Flow moves from operation 360 to operation 365. </p><p id="p0076" num="0076"> At operation 365, it is determined whether another link exists in the computed SPT to the selected node. If another link exists, then flow moves back to operation 320 and another link is selected to be excluded from the computed SPT. If another link does not exist, then flow moves to operation 370 where it is determined whether another node exists in the network. If another node does exist in the network, then flow 
<!-- EPO <DP n="13"/>-->
 moves back to operation 310 where another node is selected. If another node does not exist, then flow moves to operation 375 and the process exits. </p><p id="p0077" num="0077"> In one embodiment, the alternative labels are distributed not for the selected node, but for the loopback address of the node that is at the downstream end of the selected link. For example, with reference to Figure 2, the alternative labels may be distributed for the network element 11 OF, which is at the downstream end of the selected link. In such circumstances, the failure action is setup to stack that label and forward the packet accordingly. </p><p id="p0078" num="0078"> In one embodiment, a network element performs fast-reroute for LDP LSPs in a node failure case as follows: </p><p id="p0079" num="0079"> Node Failure Case: </p><p id="p0080" num="0080"> 1. For every D in G, do the following: </p><p id="p0081" num="0081"> a. Compute the toSPT(G, D) </p><p id="p0082" num="0082"> b. Let F denote a node M in G along with all its links. Let Ml, M2, ...Mn denote the directly connected nodes that are upstream to M in toSPT(G, D). Let Nl, N2, ...Nn denote the directly connected nodes that are downstream to M in toSPT(G, D). For every such F, do the following: </p><p id="p0083" num="0083"> i. Compute toSPT(G - F, D) </p><p id="p0084" num="0084"> ii. If a node is in upstr(G, D, F) and belongs to pairSPT(G-</p><p id="p0085" num="0085">F, Mi, D), for any i (1, .. ,n) then allocate (and distribute) a label for D (called Alternate Label or AL) to upstream neighbors in pairSPT. Setup ILM entries as follows: </p><p id="p0086" num="0086"> 1. If this node has a nexthop in the above-mentioned pairSPT that is not in above-mentioned Upstr then it installs a swap action for the allocated AL to the label received from the peer. </p><p id="p0087" num="0087"> 2. Else it allocates a swap action from the AL it has allocated to the AL received from downstream LDP peers in the pairSPT 
<!-- EPO <DP n="14"/>-->
 3. UpNode(G, D, F) which is the PL , installs a failure trigger action for L, where if link L fails then instead of using the label allocated by DnNode(G, D, L) it uses AL and forwards the packet as indicated by ILM. </p><p id="p0088" num="0088"> 4. If AL has not been received for D but has been received for any of the next-next-hop LSRs loop back address (next-next-hop can be deduced from toSPT) then swap the label with that allocated by the next- nexthop (signaling extension for this is defined later) and then stack the AL for the next-next-hop. </p><p id="p0089" num="0089"> Figure 4 illustrates the network of Figure 1 where the network elements configure a BSP LSP to reach the destination network element HOG over a potential failure of the network element 11 OF. Figure 4 will be described with respect to the figure 5, which is a flow diagram illustrating exemplary operations for configuring LDP FPvPv in case of a single node failure according to one embodiment. In one embodiment, each of the network elements 110A-G perform the operations described in Figure 5. </p><p id="p0090" num="0090"> At operation 510, one of the nodes (one of the network elements 110A-G) is selected. With respect to Figure 4, the selected node is the network element HOG. Flow then moves to operation 515 and a SPT is computed to the selected node HOG from all other nodes in the network. Flow then moves to operation 520 and a node is selected to exclude from the computed SPT. With respect to Figure 4, the selected node to exclude is the network element 11 OF, which is referred herein as the exclude- node. Flow then moves to operation 525 and the SPT to the selected node is computed with the exclude-node excluded. Thus, the SPT is calculated to the selected node assuming that the exclude-node is not part of the network. </p><p id="p0091" num="0091"> Flow then moves to operation 530 where a determination is made whether the network element performing the calculation is upstream of the exclude-node and belongs to the SPT from an upstream node to the selected node with the exclude-node excluded. The SPT from an upstream node to the selected node with the exclude-node excluded is referred herein with respect to the operations of Figure 5 as the exclude- 
<!-- EPO <DP n="15"/>-->
 SPT. With reference to Figure 4, an upstream node is the network element HOC. If the network element performing the calculation is such a node, then flow moves to operation 535; otherwise flow moves to operation 550. </p><p id="p0092" num="0092"> At operation 535, the network element performing the calculation allocates and distributes (e.g., using LDP) a label for a BSP-LSP to the selected node to upstream neighbors in the exclude-SPT. For example, with reference to Figure 4, the network element 110A allocates and distributes the alternative label AL1 to the network element HOB as part of establishing the BSP-LSP segment 440 and the network element HOB allocates and distributes the alternative label AL2 to the network element HOC as part of establishing the BSP-LSP segment 441. Flow then moves to operation 540. </p><p id="p0093" num="0093"> At operation 540, if the network element that is performing the operations has a nexthop in the exclude-SPT that is not upstream from the excluded node, then flow moves to operation 545 (the network element is the merge point), otherwise flow moves to operation 560. To say it another way, if the network element is on the exclude-SPT and belongs on the shortest path LDP LSP to the selected node that does not traverse the failure point, then it is a merge point and flow would move to operation 545. With respect to Figure 4, the network element 110A has a nexthop in the exclude- SPT that is not upstream from the network element 110F (which is the network element 110E). </p><p id="p0094" num="0094"> At operation 545, the network element installs a swap action for the alternative label it has allocated and distributed to the label received from that nexthop network element. For example, with respect to Figure 4, the network element 110E installs a swap action for the alternative label AL1 to the label L5 previously received from the network element 110E. Thus, the network element 110E, which is acting as the BSP- MP in this example, merges the BSP-LSP that is being established to re-route around the failure of the node 11 OF with the current shortest path LSP. This minimizes the number of extra alternative labels required and also ensures that there is no traffic churn when IGP reconverges. Flow moves from operation 545 to operation 565. </p><p id="p0095" num="0095"> At operation 550, if the network element that is performing the operations is the PL , then flow moves to operation 555, otherwise flow moves to operation 565. At operation 555, the network element installs a failure trigger action for the selected link to cause the alternative label that it has received from an upstream neighbor to be used. 
<!-- EPO <DP n="16"/>-->
 For example, with respect to Figure 4, the network element HOC, which is acting as the PLR, installs a failure trigger action such that upon the failure of the node 11 OF occurring, the network element HOC will cause traffic arriving from the network element HOB with the label L2 to be sent along the BSP LSP segment 441 (e.g., by changing one or more entries in its forwarding structure(s)). In one embodiment, only the PLR needs to take action upon a failure occurring by causing the traffic to be sent along the BSP LSP. Flow moves from operation 555 to operation 565. </p><p id="p0096" num="0096"> At operation 560, since the network element is not the BSP-MP but is upstream of the selected node and belongs to the exclude-SPT, then it is an intermediate node along the exclude-SPT and therefore installs a swap action from the alternative label it allocated and distributed for the BSP-LSP to the alternative label for the BSP-LSP received from a downstream LDP peers in the exclude-SPT. For example, with respect to Figure 4, the network element HOB installs a swap action from the alternative label AL2 it has allocated and distributed to the network element 1 IOC to the alternative label AL1 it has received from the network element 110A. Flow moves from operation 560 to operation 565. </p><p id="p0097" num="0097"> At operation 565, it is determined whether another node that can potentially fail exists in the computed SPT to the selected node. If such a node exists, then flow moves back to operation 520 and another node is selected to be excluded from the computed SPT. If another node does not exist, then flow moves to operation 570 where it is determined whether another destination node exists in the network. If another destination node does exist in the network, then flow moves back to operation 510 where another node is selected. If another destination node does not exist, then flow moves to operation 575 and the process exits. </p><p id="p0098" num="0098"> In one embodiment, the alternative labels are distributed not for the selected destination node, but for the loopback address of any of the next-next-hop LSRs. In such circumstances, the label that is allocated by that next-next-hop is swapped and the alternative label for the next-next-hop is stacked. </p><p id="p0099" num="0099"> In one embodiment, SRLG (Shared Risk Link Group) failures are addressed in a similar way as node failure. </p><p id="p0100" num="0100"> In some circumstances, there may be complex cases of links belonging to multiple SRLGs with a relationship that cannot deduce the specific SRLG that has 
<!-- EPO <DP n="17"/>-->
 failed and yet an alternate path exists but is not computed. These complex cases are not addressed by the above description. </p><p id="p0101" num="0101"> In some circumstances a heterogeneous network may exist where different LSRs may have different label forwarding table capacity limitations. In such circumstances, it is possible that some LSRs may not have enough label forwarding entries to accommodate the extra labels (ALs) needed for these procedures. In this case, the ALs are allocated only for the loopback address and label stacking is used to label-switch the packet to the nexthop. </p><p id="p0102" num="0102"> LSP setup modes </p><p id="p0103" num="0103"> 1. All nodes do the computation and allocate labels downstream- unsolicited. </p><p id="p0104" num="0104"> 2. PLR does computation of Alt-LSP and signals LSP via explicit path. </p><p id="p0105" num="0105"> Upstream on-demand mode. </p><p id="p0106" num="0106"> In one embodiment, signaling extensions are defined to establish the LDP FRR. The signaling extensions allow the BSP-MP to signal to the PLR that a BSP LSP needs to be setup and that the BSP LSP is for when a particular failure happens. Thus, the signaling extensions identify a node to which the backup LSP is to be setup and identifies a failure for which the backup LSP is setup. </p><p id="p0107" num="0107"> For example, the following signaling extensions are defined to establish the LDP FRR: </p><p id="p0108" num="0108"> 1. A new TLV is defined (MUST be enabled along with Path vector TLV). </p><p id="p0109" num="0109"> This new TLV records labels for the LSP similar to how the Path Vector TLV records LSR Ids along the path. The new TLV may be called "Label Vector TLV". </p><p id="p0110" num="0110"> 2. A new optional TLV that contains a list of prefixes (covers Links (p2p and multi-access) and Nodes) and SRLGs. This new optional TLV is used in the Label Map and Label Request messages. The new optional TLV may be called "Topology Exclude TLV". </p><p id="p0111" num="0111"> An implementation that adopts embodiments of the LDP FRR process described herein can retain the simple configuration model of LDP. Thus, embodiments of the 
<!-- EPO <DP n="18"/>-->
 invention retain the simplicity of operating LDP and overcomes the complexity of ΓΡ- F and LDP-over-RSVP while providing coverage in all fault scenarios. </p><p id="p0112" num="0112"> Figure 6 illustrates an exemplary network element that implements LDP FRR according to one embodiment. The network element 600 includes the control plane 610 and the data plane 650 (sometimes referred to as a forwarding plane or a media plane). The control plane 610 determines how data (e.g., packets) is routed (e.g., the next-hop for the data and the outgoing port for the data) and the data plane 650 is in charge of forwarding that data. The control plane 610 includes the IGP (Interior Gateway Protocol) module 615 and the LDP (Label Distribution Protocol) Module 620. The IGP module 615 may be running a link-state protocol such as OSPF (Open Shortest Path First) or IS-IS (Intermediate System to Intermediate System), or running another protocol such as RIP (Routing Information Protocol). The IGP module 615 communicates with other network elements to exchange routes and select those routes based on one or more routing metrics. The IGP routes that are selected are stored in the RIB (Routing Information Base) 625. The IGP module 615 can also cause the route entries which are not selected and stored in the RIB 625 to be stored in a local RIB (e.g., an IGP local RIB). </p><p id="p0113" num="0113"> The LDP module 620 exchanges label mapping information with its peers (LDP peers). For example, the LDP module 620 may generate label mapping messages and receive label mapping messages from its peers. The LDP module 620 relies on the underlying routing information provided by the IGP module 615 to the RIB 625 in order to forward label packets. The LDP module 620 allocates labels and stores other information related to forwarding label packets (e.g., NHLFE information, ILM (Incoming Label Map) information, FTN information) in the MPLS information base 630. The LDP module 620 includes the LDP-FRR module 622 which extends the functionality of the LDP module 620 to support the LDP-FRR process described herein. In one embodiment, the LDP-FRR module 622 performs the operations described in Figures 3 and/or 5. </p><p id="p0114" num="0114"> The control plane 610 programs the data plane 650 with route information based on the RIB 625 and the MPLS information base 630. Specifically, certain information from the RIB 625 is programmed to the FIB (Forwarding Information Base) 655 and certain information from the MPLS information base 630 is 
<!-- EPO <DP n="19"/>-->
 programmed to the ILM structure 660, the NHLFE structure 665, and the FTN structure 670. For example, the alternative labels for the BSP LSPs are programmed to one or more of the ILM structure 660 and the NHLFE structure 665 of the data plane 650 as appropriate such that if the failure occurs, the traffic can be re-routed according to the BSP LSPs quickly (e.g., at line rate). </p><p id="p0115" num="0115"> In one embodiment the network element 600 includes a set of one or more line cards (sometimes referred to as forwarding cards) and a set of one or more control cards. The set of line cards and control cards are coupled together through one or more mechanisms (e.g., a first full mesh coupling the line cards and a second full mesh coupling all of the cards). The set of line cards typically make up the data plane and may each store the FIB 655, the ILM 660, the NHLFE 665, and the FTN 670 which will be used when forwarding packets. Specifically, the FTN 670 is used for forwarding packets that are unlabeled (e.g., they are received from outside the MPLS domain at the ingress LS ) but are to be labeled before forwarding. The ILM 660 is used for forwarding labeled packets. The control cards typically run the routing protocols including the IGP module 615, the LDP module 620, and store the RIB 625 and the MPLS information base 630. </p><p id="p0116" num="0116"> As used herein, a network element (e.g., a router, switch, bridge) is a piece of networking equipment, including hardware and software, that communicatively interconnects other equipment on the network (e.g., other network elements, end stations). Some network elements are "multiple services network elements" that provide support for multiple networking functions (e.g., routing, bridging, switching, Layer 2 aggregation, session border control, Quality of Service, and/or subscriber management), and/or provide support for multiple application services (e.g., data, voice, and video). Subscriber end stations (e.g., servers, workstations, laptops, netbooks, palm tops, mobile phones, smartphones, multimedia phones, Voice Over Internet Protocol (VOIP) phones, user equipment, terminals, portable media players, GPS units, gaming systems, set-top boxes) access content/services provided over the Internet and/or content/services provided on virtual private networks (VPNs) overlaid on (e.g., tunneled through) the Internet. The content and/or services are typically provided by one or more end stations (e.g., server end stations) belonging to a service or content provider or end stations participating in a peer to peer service, and may 
<!-- EPO <DP n="20"/>-->
 include, for example, public webpages (e.g., free content, store fronts, search services), private webpages (e.g., username/password accessed webpages providing email services), and/or corporate networks over VPNs. Typically, subscriber end stations are coupled (e.g., through customer premise equipment coupled to an access network (wired or wirelessly)) to edge network elements, which are coupled (e.g., through one or more core network elements) to other edge network elements, which are coupled to other end stations (e.g., server end stations). </p><p id="p0117" num="0117"> As described herein, instructions may refer to specific configurations of hardware such as application specific integrated circuits (ASICs) configured to perform certain operations or having a predetermined functionality or software instructions stored in memory embodied in a non-transitory computer readable medium. Thus, the techniques shown in the figures can be implemented using code and data stored and executed on one or more electronic devices (e.g., an end station, a network element). Such electronic devices store and communicate (internally and/or with other electronic devices over a network) code and data using computer -readable media, such as non- transitory computer-readable storage media (e.g., magnetic disks; optical disks; random access memory; read only memory; flash memory devices; phase-change memory) and transitory computer-readable communication media (e.g., electrical, optical, acoustical or other form of propagated signals - such as carrier waves, infrared signals, digital signals). In addition, such electronic devices typically include a set of one or more processors coupled to one or more other components, such as one or more storage devices (non-transitory machine-readable storage media), user input/output devices (e.g., a keyboard, a touchscreen, and/or a display), and network connections. The coupling of the set of processors and other components is typically through one or more busses and bridges (also termed as bus controllers). Thus, the storage device of a given electronic device typically stores code and/or data for execution on the set of one or more processors of that electronic device. Of course, one or more parts of an embodiment of the invention may be implemented using different combinations of software, firmware, and/or hardware. </p><p id="p0118" num="0118"> While the invention has been described in terms of several embodiments, those skilled in the art will recognize that the invention is not limited to the embodiments described, can be practiced with modification and alteration within the spirit and scope 
<!-- EPO <DP n="21"/>-->
 of the appended claims. The description is thus to be regarded as illustrative instead of limiting. 
</p></description><claims mxw-id="PCLM44852142" ref-ucid="WO-2012117317-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="22"/>-->CLAIMS What is claimed is: </claim-statement><claim id="clm-0001" num="1"><claim-text>1. A method in a first network element for MPLS (Multiprotocol Label Switching) fast re-route using LDP (Label Distribution Protocol), wherein the first network element is one of a plurality of network elements in an MPLS network, the method comprising the steps of: </claim-text><claim-text> receiving a first label advertised from a second network element in the MPLS network; </claim-text><claim-text> computing a shortest path tree (SPT) to reach a destination network element under a potential failure condition, wherein the second network element is a nexthop of the first network element in the computed SPT and is not upstream from the potential failure condition; </claim-text><claim-text> advertising a second label to a set of one or more third network elements for a backup LDP LSP (Label Switched Path) that will serve as a backup when the potential failure condition is realized, wherein the set of third network elements are upstream neighbor network elements on the computed SPT with respect to the first network element; and installing a swap action from the second label to the first label. </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. The method of claim 1, further comprising the steps of: </claim-text><claim-text> receiving a packet from one of the set of third network elements that includes the second label; </claim-text><claim-text> swapping the second label with the first label; and </claim-text><claim-text> transmitting the packet to the second network element with the first label. </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. The method of claim 1, wherein the potential failure condition is a failure of one of a link downstream from the first network element and a network element downstream from the first network element. </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. The method of claim 1, wherein the first network element is a backup switched path merge point. <!-- EPO <DP n="23"/>--> </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. The method of claim 1, wherein the second network element is a first hop from the first network element on a current shortest path LSP that traverses the potential failure condition. </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. The method of claim 1, wherein the first label advertised from the second network element is used by the first network element when transmitting packets to the second network element irrespective of the prospective failure condition. </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. A first network element for participating in MPLS (Multiprotocol Label Switching) fast reroute using LDP (Label Distribution Protocol) in an MPLS network, comprising: </claim-text><claim-text> a set of one or more processors; and </claim-text><claim-text> a control plane that includes an LDP module, that when executed by the set of processors, cause the set of processors to perform the following: </claim-text><claim-text> receiving a first label advertised from a second network element in the MPLS network, </claim-text><claim-text> computing a shortest path tree (SPT) to reach a destination network element under a potential failure condition, wherein the second network element is a nexthop of the first network element in the computed SPT and is not upstream from the potential failure condition, </claim-text><claim-text> advertising a second label to a set of one or more third network elements for a backup LDP LSP (Label Switched Path) that will serve as a backup when the potential failure condition is realized, wherein the set of third network elements are upstream neighbor network elements on the computed SPT with respect to the first network element, and </claim-text><claim-text> installing a swap action from the second label to the first label in one or more forwarding data structures in a data plane of the first network element. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. The network element of claim 7, further comprising: <!-- EPO <DP n="24"/>--> the data plane that when executed by the set of processors, further cause the set of processors to perform the following: </claim-text><claim-text> receive a packet from one of the set of third network elements that includes the second label; </claim-text><claim-text> swap the second label with the first label using the one or more forwarding structures; and </claim-text><claim-text> transmit the packet to the second network element with the first label. </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. The network element of claim 7, wherein the potential failure condition is a failure of one of a link downstream from the first network element and a network element downstream from the first network element. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. The network element of claim 7, wherein the first network element is a backup switched path merge point. </claim-text></claim><claim id="clm-0011" num="11"><claim-text>11. The network element of claim 7, wherein the second network element is a first hop from the first network element on a current shortest path LSP that traverses the potential failure condition. </claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. The network element of claim 7, wherein the first label advertised from the second network element is used by the first network element when transmitting packets to the second network element irrespective of the prospective failure condition </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. A method in a first network element for MPLS (Multiprotocol Label Switching) fast re-route using LDP (Label Distribution Protocol), wherein the first network element is one of a plurality of network elements in an MPLS network, the method comprising the steps of: </claim-text><claim-text> computing a shortest path tree (SPT) to reach a destination network element under a potential failure condition; </claim-text><claim-text> receiving a label from a second network element for a backup LDP LSP (Label</claim-text><claim-text>Switched Path) that will serve as a backup when the potential failure condition is realized, wherein the second network element is an upstream neighbor network element on the computed SPT with respect to the first network element; and <!-- EPO <DP n="25"/>--> installing a failure trigger action for the potential failure condition to cause the received label to be used to send traffic to the second network element when the potential failure condition is realized. </claim-text></claim><claim id="clm-0014" num="14"><claim-text>14. The method of claim 13, further comprising the steps of: </claim-text><claim-text> detecting a failure condition that corresponds with the potential failure condition; </claim-text><claim-text> responsive to the step of detecting, rerouting traffic received from the second network element and destined for the destination network element to the second network element using the received label for the backup LDP LSP. </claim-text></claim><claim id="clm-0015" num="15"><claim-text>15. The method of claim 13, wherein the potential failure condition is a failure of one of a link downstream from the first network element and a network element downstream from the first network element. </claim-text></claim><claim id="clm-0016" num="16"><claim-text>16. The method of claim 13, wherein the first network element is a Point of Local Repair. </claim-text></claim><claim id="clm-0017" num="17"><claim-text>17. A first network element for participating in MPLS (Multiprotocol Label Switching) fast reroute using LDP (Label Distribution Protocol) in an MPLS network, comprising: </claim-text><claim-text> a set of one or more processors; and </claim-text><claim-text> a control plane that includes an LDP module, that when executed by the set of processors, cause the set of processors to perform the following: </claim-text><claim-text> compute a shortest path tree (SPT) to reach a destination network element under a potential failure condition; </claim-text><claim-text> receive a label from a second network element for a backup LDP LSP (Label Switched Path) that will serve as a backup when the potential failure condition is realized, wherein the second network element is an upstream neighbor network element on the computed SPT with respect to the first network element; and install a failure trigger action in a set of one or more forwarding structures in a data plane of the first network element for the <!-- EPO <DP n="26"/>--> potential failure condition to cause the received label to be used to send traffic to the second network element when the potential failure condition is realized. </claim-text></claim><claim id="clm-0018" num="18"><claim-text>18. The network element of claim 17, further comprising: </claim-text><claim-text> the data plane that when executed by the set of processors, further cause the set of processors to perform the following: </claim-text><claim-text> responsive to a detection of a failure condition that corresponds with the potential failure condition, reroute traffic received from the second network element back to the second network element using the received label for the backup LDP LSP. </claim-text></claim><claim id="clm-0019" num="19"><claim-text>19. The network element of claim 17, wherein the potential failure condition is a failure of one of a link downstream from the first network element and a network element downstream from the first network element. </claim-text></claim><claim id="clm-0020" num="20"><claim-text>20. The network element of claim 17, wherein the first network element is a Point of Local Repair. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
