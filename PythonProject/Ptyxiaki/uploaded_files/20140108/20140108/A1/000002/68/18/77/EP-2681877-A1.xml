<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2681877-A1" country="EP" doc-number="2681877" kind="A1" date="20140108" family-id="45833483" file-reference-id="318301" date-produced="20180823" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146586411" ucid="EP-2681877-A1"><document-id><country>EP</country><doc-number>2681877</doc-number><kind>A1</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12708947-A" is-representative="NO"><document-id mxw-id="PAPP154848603" load-source="docdb" format="epo"><country>EP</country><doc-number>12708947</doc-number><kind>A</kind><date>20120228</date><lang>EN</lang></document-id><document-id mxw-id="PAPP220440093" load-source="docdb" format="original"><country>EP</country><doc-number>12708947.2</doc-number><date>20120228</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140552799" ucid="EP-11305212-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>11305212</doc-number><kind>A</kind><date>20110228</date></document-id></priority-claim><priority-claim mxw-id="PPC140556655" ucid="EP-12708947-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>12708947</doc-number><kind>A</kind><date>20120228</date></document-id></priority-claim><priority-claim mxw-id="PPC140549670" ucid="IB-2012050914-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>IB</country><doc-number>2012050914</doc-number><kind>W</kind><date>20120228</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-2128529431" load-source="docdb">H04W   4/00        20090101ALI20141127BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-2128532247" load-source="docdb">H04W   4/08        20090101ALI20141127BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-2128533069" load-source="docdb">H04L  12/28        20060101AFI20141127BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-2128536851" load-source="docdb">H04L  12/46        20060101ALI20141127BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-2128537369" load-source="docdb">H04L  12/66        20060101ALI20141127BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-2128537557" load-source="docdb">H05B  37/02        20060101ALI20141127BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1645100261" load-source="docdb" scheme="CPC">H04W   4/80        20180201 LI20180504BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1723131501" load-source="docdb" scheme="CPC">H04L  12/66        20130101 LI20171211BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1723131502" load-source="docdb" scheme="CPC">H04L  12/4625      20130101 LI20171211BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1723131503" load-source="docdb" scheme="CPC">H04L  12/2818      20130101 LI20171211BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1723131504" load-source="docdb" scheme="CPC">H05B  37/0272      20130101 LI20171211BHEP        </classification-cpc><classification-cpc mxw-id="PCL1989629109" load-source="docdb" scheme="CPC">H04W   4/08        20130101 FI20131219BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132363866" lang="DE" load-source="patent-office">VERFAHREN FÜR BETRIEB UND INBETRIEBNAHME VON VORRICHTUNGEN IN EINEM EIN ZIGBEE-NETZWERK</invention-title><invention-title mxw-id="PT132363867" lang="EN" load-source="patent-office">METHOD FOR OPERATING AND COMMISSIONING DEVICES IN A ZIGBEE NETWORK</invention-title><invention-title mxw-id="PT132363868" lang="FR" load-source="patent-office">PROCÉDÉ D'EXPLOITATION ET D'APPROVISIONNEMENT DE DISPOSITIFS DANS UN RÉSEAU ZIGBEE</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR919514440" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>KONINKL PHILIPS NV</last-name><address><country>NL</country></address></addressbook></applicant><applicant mxw-id="PPAR919513332" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>KONINKLIJKE PHILIPS N.V.</last-name></addressbook></applicant><applicant mxw-id="PPAR919008842" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Koninklijke Philips N.V.</last-name><iid>101385623</iid><address><street>High Tech Campus 5</street><city>5656 AE Eindhoven</city><country>NL</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919533227" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>TOLHUIZEN MARINUS GERARDUS MARIA</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919532142" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>TOLHUIZEN, Marinus Gerardus Maria</last-name></addressbook></inventor><inventor mxw-id="PPAR919007593" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>TOLHUIZEN, Marinus Gerardus Maria</last-name><address><street>High Tech Campus 34</street><city>NL-5656 AE Eindhoven</city><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919526856" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>ERDMANN BOZENA</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919529858" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>ERDMANN, BOZENA</last-name></addressbook></inventor><inventor mxw-id="PPAR919019163" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>ERDMANN, BOZENA</last-name><address><street>High Tech Campus 34</street><city>NL-5656 AE Eindhoven</city><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919533997" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>HOUTEPEN ROBERT CORNELIS</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR919511880" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>HOUTEPEN, ROBERT CORNELIS</last-name></addressbook></inventor><inventor mxw-id="PPAR919013347" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>HOUTEPEN, ROBERT CORNELIS</last-name><address><street>High Tech Campus 34</street><city>NL-5656 AE Eindhoven</city><country>NL</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR919018311" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Van Eeuwijk, Alexander Henricus Waltherus</last-name><iid>100822969</iid><address><street>Philips Intellectual Property &amp; Standards P.O. Box 220</street><city>5600 AE Eindhoven</city><country>NL</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="IB-2012050914-W"><document-id><country>IB</country><doc-number>2012050914</doc-number><kind>W</kind><date>20120228</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012117344-A1"><document-id><country>WO</country><doc-number>2012117344</doc-number><kind>A1</kind><date>20120907</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS549770595" load-source="docdb">AL</country><country mxw-id="DS549838054" load-source="docdb">AT</country><country mxw-id="DS549851821" load-source="docdb">BE</country><country mxw-id="DS549914746" load-source="docdb">BG</country><country mxw-id="DS549760247" load-source="docdb">CH</country><country mxw-id="DS549851834" load-source="docdb">CY</country><country mxw-id="DS549838393" load-source="docdb">CZ</country><country mxw-id="DS549770596" load-source="docdb">DE</country><country mxw-id="DS549851835" load-source="docdb">DK</country><country mxw-id="DS549851836" load-source="docdb">EE</country><country mxw-id="DS549760627" load-source="docdb">ES</country><country mxw-id="DS549914747" load-source="docdb">FI</country><country mxw-id="DS549914748" load-source="docdb">FR</country><country mxw-id="DS549770605" load-source="docdb">GB</country><country mxw-id="DS549851837" load-source="docdb">GR</country><country mxw-id="DS549770606" load-source="docdb">HR</country><country mxw-id="DS549838398" load-source="docdb">HU</country><country mxw-id="DS549760248" load-source="docdb">IE</country><country mxw-id="DS549851846" load-source="docdb">IS</country><country mxw-id="DS549914749" load-source="docdb">IT</country><country mxw-id="DS549851847" load-source="docdb">LI</country><country mxw-id="DS549914750" load-source="docdb">LT</country><country mxw-id="DS549838055" load-source="docdb">LU</country><country mxw-id="DS549914751" load-source="docdb">LV</country><country mxw-id="DS549914752" load-source="docdb">MC</country><country mxw-id="DS549838056" load-source="docdb">MK</country><country mxw-id="DS549838057" load-source="docdb">MT</country><country mxw-id="DS549838062" load-source="docdb">NL</country><country mxw-id="DS549760253" load-source="docdb">NO</country><country mxw-id="DS549838063" load-source="docdb">PL</country><country mxw-id="DS549760628" load-source="docdb">PT</country><country mxw-id="DS549838504" load-source="docdb">RO</country><country mxw-id="DS549760637" load-source="docdb">RS</country><country mxw-id="DS549838064" load-source="docdb">SE</country><country mxw-id="DS549770607" load-source="docdb">SI</country><country mxw-id="DS549760254" load-source="docdb">SK</country><country mxw-id="DS549760255" load-source="docdb">SM</country><country mxw-id="DS549851848" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA99835310" ref-ucid="WO-2012117344-A1" lang="EN" load-source="patent-office"><p num="0000">The present invention relates to a Method for operating devices in a ZigBee network comprising Zig Bee Green Power (ZGP)-capable devices and non-ZGP-capable devices, both to be controlled by at least one ZGPD device, the method comprising the following steps: - the ZGPD device transmitting ZGPD command frame, - upon reception of a ZGPD command frame from said/the ZGPD device, a ZGP-capable device: - translating the received ZGPD command to a regular ZigBee command compatible with non-ZGP-capable devices, and forwarding the translated command, - tunneling the ZGPD command using ZGP tunneling mechanism, - the ZGP-capable devices controlled by the ZGPD device executing only the tunneled command, if the controlled application functionality is supported, - the non-ZGP-capable devices controlled by the ZGPD device executing only the translated command, if the controlled application functionality is supported.</p></abstract><abstract mxw-id="PA100331144" ref-ucid="WO-2012117344-A1" lang="EN" source="national office" load-source="docdb"><p>The present invention relates to a Method for operating devices in a ZigBee network comprising Zig Bee Green Power (ZGP)-capable devices and non-ZGP-capable devices, both to be controlled by at least one ZGPD device, the method comprising the following steps: - the ZGPD device transmitting ZGPD command frame, - upon reception of a ZGPD command frame from said/the ZGPD device, a ZGP-capable device: - translating the received ZGPD command to a regular ZigBee command compatible with non-ZGP-capable devices, and forwarding the translated command, - tunneling the ZGPD command using ZGP tunneling mechanism, - the ZGP-capable devices controlled by the ZGPD device executing only the tunneled command, if the controlled application functionality is supported, - the non-ZGP-capable devices controlled by the ZGPD device executing only the translated command, if the controlled application functionality is supported.</p></abstract><abstract mxw-id="PA99835311" ref-ucid="WO-2012117344-A1" lang="FR" load-source="patent-office"><p num="0000">La présente invention concerne un procédé pour exploiter des dispositifs dans un réseau ZigBee comprenant des dispositifs compatibles ZGP (Zig Bee Green Power) et des dispositifs non compatibles ZGP, les deux types de dispositifs devant être commandés par au moins un dispositif ZGPD. Ledit procédé comprend les étapes suivantes : - le dispositif ZGPD transmet une trame de commande ZGPD, - à la réception d'une trame de commande ZGPD en provenance dudit/du dispositif ZGPD, un dispositif compatible ZGP : - traduit la commande ZGPD reçue en une commande ZigBee régulière compatible avec des dispositifs non compatibles ZGP, et transmet la commande traduite, - met sous tunnel la commande ZGPD à l'aide d'un mécanisme de tunnellisation ZGP, - les dispositifs compatibles ZGP commandés par le dispositif ZGPD exécutent uniquement la commande tunnellisée, si la fonctionnalité de l'application commandée est prise en charge, - les dispositifs non compatibles ZGP commandés par le dispositif ZGPD exécutent uniquement la commande traduite, si la fonctionnalité de l'application commandée est prise en charge.</p></abstract><abstract mxw-id="PA100331145" ref-ucid="WO-2012117344-A1" lang="FR" source="national office" load-source="docdb"><p>La présente invention concerne un procédé pour exploiter des dispositifs dans un réseau ZigBee comprenant des dispositifs compatibles ZGP (Zig Bee Green Power) et des dispositifs non compatibles ZGP, les deux types de dispositifs devant être commandés par au moins un dispositif ZGPD. Ledit procédé comprend les étapes suivantes : - le dispositif ZGPD transmet une trame de commande ZGPD, - à la réception d'une trame de commande ZGPD en provenance dudit/du dispositif ZGPD, un dispositif compatible ZGP : - traduit la commande ZGPD reçue en une commande ZigBee régulière compatible avec des dispositifs non compatibles ZGP, et transmet la commande traduite, - met sous tunnel la commande ZGPD à l'aide d'un mécanisme de tunnellisation ZGP, - les dispositifs compatibles ZGP commandés par le dispositif ZGPD exécutent uniquement la commande tunnellisée, si la fonctionnalité de l'application commandée est prise en charge, - les dispositifs non compatibles ZGP commandés par le dispositif ZGPD exécutent uniquement la commande traduite, si la fonctionnalité de l'application commandée est prise en charge.</p></abstract><description mxw-id="PDES51232950" ref-ucid="WO-2012117344-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="3"/>--><p id="p0001" num="0001"> Method For Operating And Commissioning Devices In A Zigbee Network </p><p id="p0002" num="0002">FIELD OF THE INVENTION </p><p id="p0003" num="0003"> The present invention relates a method for commissioning and operating devices in a ZigBee network comprising ZigBee Green Power (ZGP) capable devices, and non-ZGP- capable devices. </p><p id="p0004" num="0004"> The ZigBee Green Power specification describes message formats and transmission protocols that allow sending control commands from very energy-limited devices, called ZigBee Green Power Devices (ZGPD. A ZGPD is, for example a self -powering device, like an energy-harvesting switch, getting the energy from the user action of operating the switch rocker. </p><p id="p0005" num="0005"> The new message formats described in this ZGP specification, as compared with the ZigBee standard, are required since conventional ZigBee messages are too bulky to be sent with the limited energy that is available at a ZGPD. Moreover, a ZGPD does not necessarily have reception capabilities, and thus the conventional ZigBee protocol exchanges (e.g. for joining, parent re-discovery, binding creation) cannot be applied; accordingly, the ZGP specification needs to describe new commissioning/configuration procedures for ZGPD. </p><p id="p0006" num="0006">BACKGROUND OF THE INVENTION </p><p id="p0007" num="0007"> Current ZigBee products cannot handle ZGP commands. As a consequence, a user with an installed base of e.g. ZigBee lamps cannot extend it with some ZGP-capable ZigBee lamps and then control any subset of the whole resulting system with e.g. a ZGPD energy- harvesting switch. </p><p id="p0008" num="0008"> Adding a single dedicated "ZGP gateway" device, translating ZGP commands into legacy commands is cumbersome for the user and not reliable (as it creates single-point-of- failure. </p><p id="p0009" num="0009"> Thus, there is a need to provide a method for performing ZGP pairing and configuration for a set of devices to be controlled by ZGPD, the set containing both ZGP- capable ZigBee devices and "legacy" ZigBee devices that do not understand ZGP commands in a robust, user-friendly way. </p><p id="p0010" num="0010"> It is the object of the present invention to provide such a method. Another object of the invention is to provide a method for operating such a mixed system after configuration, such that no duplicate command execution or other unexpected control behaviour occurs. 
<!-- EPO <DP n="4"/>-->
 SUMMARY OF THE INVENTION </p><p id="p0011" num="0011">The present invention relates to a method for operating devices in a ZigBee network comprising ZigBee Green Power (ZGP)-capable devices and non-ZGP-capable devices, both under control of at least one ZGPD device, the method comprising the following steps: </p><p id="p0012" num="0012"> the ZGPD device transmitting ZGPD command frame, </p><p id="p0013" num="0013"> upon reception of a ZGPD command frame from said/the ZGPD device , a ZGP-capable device: </p><p id="p0014" num="0014"> translating the received ZGPD command to a regular ZigBee command compatible with non-ZGP-capable devices, and forwarding the translated command, and tunneling the ZGPD command using ZGP tunneling mechanism, </p><p id="p0015" num="0015"> the ZGP-capable devices controlled by the ZGPD device executing only the tunneled command, if the controlled application functionality is supported, </p><p id="p0016" num="0016"> the non-ZGP-capable devices controlled by the ZGPD device executing only the translated command, if the controlled application functionality is supported. </p><p id="p0017" num="0017">In one embodiment, the method comprises an initial commissioning phase comprising the following steps: </p><p id="p0018" num="0018"> the commissioning device identifying the devices, ZGP-capable or non-ZGP capable, to be controlled by the ZGPD device, </p><p id="p0019" num="0019"> the commissioning device generating a first ZigBee group ID and instructing all identified devices to become members of first ZGPD group corresponding to the first group ID; </p><p id="p0020" num="0020"> all identified devices becoming members of first ZGPD group corresponding to the first group ID </p><p id="p0021" num="0021"> the commissioning device obtaining information about the ZGPD, comprising the ZGPD SrcID. </p><p id="p0022" num="0022">In one embodiment, the method comprises a pairing step, wherein pairing commands are sent from the commissioning device to the members of the first group. </p><p id="p0023" num="0023">In one embodiment, all devices under control of the ZGPD device are member of a single ZigBee group, and the translating, forwarding and tunneling a command comprises the steps of: 
<!-- EPO <DP n="5"/>-->
 upon reception of a ZGPD command frame from said ZGPD device a ZGP-capable device </p><p id="p0024" num="0024"> translating the ZGPD command into a regular ZigBee command and forwarding the translated command to devices being members of said ZigBee group, and </p><p id="p0025" num="0025"> - tunneling the non-translated ZGPD command to devices being members of the said</p><p id="p0026" num="0026">ZigBee group, </p><p id="p0027" num="0027"> and wherein the ZGP-capable devices, on reception of the translated ZGPD command sent to the ZigBee group, silently drop the command. In one embodiment, the method comprises as part of the initial commissioning phase, a step of: </p><p id="p0028" num="0028"> for any ZGP-capable device being a member of a first ZGPD group, having at least one non-ZGP-capable application endpoint being a member of the ZGPD group, upon reception of the pairing commands, of </p><p id="p0029" num="0029">- adding its ZGP endpoint to the first ZGPD group, </p><p id="p0030" num="0030"> creating a ZGP Sink Table entry for the SrcID, </p><p id="p0031" num="0031"> storing the numbers identifying the non-ZGP endpoints being a member of the first</p><p id="p0032" num="0032">ZGPD group in its ZGP Command Translation Table, </p><p id="p0033" num="0033"> and removing these non-ZGP endpoints from the first ZGPD group. </p><p id="p0034" num="0034">In one embodiment, each device under control of the ZGPD device is a member of one of two ZGPD groups, the first group consisting of ZGP-capable devices under control of the ZGPD device and the second group consisting of non-ZGP-capable devices under control of the ZGPD device, and the steps of translating, forwarding and tunneling a command comprises the steps of: </p><p id="p0035" num="0035"> upon reception of a ZGPD command frame from said ZGPD device a ZGP-capable device: </p><p id="p0036" num="0036"> translating the command and forwarding the translated command to devices members of the second of said two groups, and </p><p id="p0037" num="0037"> - tunneling the non-translated command to devices members of the second of said two groups. </p><p id="p0038" num="0038">In one embodiment, the method comprises as part of the initial commissioning phase, the step of generating a second ZigBee group ID, and having part of the network devices to be 
<!-- EPO <DP n="6"/>-->
 controlled by the ZGPD assigned to the second ZGDP group corresponding to second ZigBee group ID </p><p id="p0039" num="0039">In one embodiment, the network devices assigned to the second ZigBee group are devices, identified by the commissioning device, that are ZGP capable. </p><p id="p0040" num="0040">In one embodiment, the method comprises, as part of the initial commissioning phase, the steps of, </p><p id="p0041" num="0041"> for any ZGP-capable device (with sink capabilities) being a member of the first ZGPD group, having at least one non-ZGP-capable application endpoint being a member of the first ZGPD group, </p><p id="p0042" num="0042"> adding its ZGP endpoint to the second ZGPD group, </p><p id="p0043" num="0043"> creating a ZGP Sink Table entry for the SrcID, </p><p id="p0044" num="0044"> storing the numbers identifying the non-ZGP endpoints being a member of the first ZGPD group in its ZGP Command Translation Table, </p><p id="p0045" num="0045"> and removing these non-ZGP endpoints from the first ZGPD group. </p><p id="p0046" num="0046">In one embodiment, the method comprises the initial step, for a user, of setting the commissioning device in commissioning mode and/or performing the commissioning action on the ZGPD device. </p><p id="p0047" num="0047">In one embodiment, the method comprises the step of removing any previous group membership of any device in the network related to the ZGPD device. </p><p id="p0048" num="0048">In one embodiment, the method comprises one of the following steps: </p><p id="p0049" num="0049"> the step of the commissioning device performing an application functionality matching between the ZGPD and the devices to be controlled, </p><p id="p0050" num="0050"> the step of the commissioning device sending a command to configure the translation of ZGPD command into regular ZigBee command compatible with non-ZGP-capable devices for translation for non-ZGP-capable devices in the operational phase, and the step, for a ZGP-capable device with ZGP proxy capabilities, of locally storing translation for the ZGPD commands into regular ZigBee command compatible with non- ZGP-capable devices and the information on the group ID to forward it to. 
<!-- EPO <DP n="7"/>-->
 In one embodiment, the forwarding of the translated command uses the ZGP aliasing mechanism. </p><p id="p0051" num="0051">In one embodiment, the commissioning device role is performed by a device comprised in the group comprising: a dedicated ZigBee Commissioning Tool device, any ZGP-capable device, a regular remote control device, having also ZGP capabilities, ZigBee PAN Coordinator, ZigBee Network Manager, ZigBee Trust Center, application software on a device behind a ZigBee bridge or gateway. </p><p id="p0052" num="0052">In one embodiment, the step of identifying the devices is performed by using at least one of the following features: graphical grouping of the network devices; ZigBee device and service discovery method, ZigBee identification of devices matching clusters; use of default groups based on predetermined criteria, use of previously established control groups, explicit user action on the selected devices; use of out-of-band method. </p><p id="p0053" num="0053">BRIEF DESCRIPTION OF THE DRAWINGS </p><p id="p0054" num="0054"> The present invention will now be described in more detail, by way of example, with reference to the accompanying drawings, wherein: </p><p id="p0055" num="0055"> Fig. 1 is a network wherein devices are commissioned and operated by using a method according to the invention. </p><p id="p0056" num="0056">DETAILED DESCRIPTION OF THE INVENTION </p><p id="p0057" num="0057"> The present invention will now be described in the specific example using ZigBee Smart Light (ZSL) lamps, both ZGP-capable and non-ZGP-capable, controlled by a remote control and for a ZGPD energy harvesting switch, which is capable of sending ZGP Commissioning GPDFs. All the specific addresses, IDs, and other figures are given only on purpose of illustration, and do not restrict the scope of the invention. </p><p id="p0058" num="0058">Two different embodiments will be herein after detailed: </p><p id="p0059" num="0059"> In the first embodiment, the commissioning procedure is as follows: </p><p id="p0060" num="0060"> Step 0. A user of the network makes sure that all devices he/she wishes to control with the ZGPD switch identified by a ZGPD SrcID, for example 0x12345678, are under control of a remote control (RC) as specified in the Smart-Light specification, and that they 
<!-- EPO <DP n="8"/>-->
 form a (ZigBee) group identified by a GroupID, with Group ID equal to, for example 0x0007. </p><p id="p0061" num="0061"> Step 1. The user puts the RC commissioning mode. </p><p id="p0062" num="0062"> Step 2. The user executes the required ZGP commissioning action (as defined in the Green Power specification) or set of actions on the ZGPD, until a commissioning success indication is provided by the system. The commissioning success indication can be an out-of- band signal like a blink or an audible signal on the RC, or a blink of a/some lamps under control of this RC, or any other type of physical parameter perceivable by the user. As part of the ZGP commissioning procedure, the ZGPD switch sends a Green Power Device Frame (GPDF) containing and/or allowing for derivation of information on the ZGPD switch, including, but not limited to the ZGPD's device address (SrcID) and device type (DevicelD). </p><p id="p0063" num="0063"> Step 3. The RC executes the required ZGP commissioning action (as defined in the Green Power specification and provides commissioning success indication when it's finished, (from this time on, the ZGPD switch can be put back in operational mode). </p><p id="p0064" num="0064"> Step 4. Optionally, based on the DevicelD in the GPDF, the RC checks the application functionality matching between the ZGPD and the devices in the to-be-controlled group. The action if this check fails is application dependent (e.g. the RC can provide ZGPD command translation that would compensate for the functionality mismatch, or make this device indicate commissioning error, or indicate overall commissioning error); if the check succeeds, continue with step 5. </p><p id="p0065" num="0065"> Step 5. The RC checks among ZGP-capable devices (using a ZGP Pairing Search command for ZGPD's SrcID) if there was a previous control relationship for this ZGPD switch. If so, the RC stores the values of the commissioned group ID (say OxMMMM) and the ZGP AssignedAlias (say OxNNNN). </p><p id="p0066" num="0066"> Step 6A. If there was a previous control relationship, the RC broadcasts a ZGP</p><p id="p0067" num="0067">Pairing Command (with SrcID 0x12345678 and RemoveZGPD subfield = Obi, see [1, Sec. A.3.3.4.2]). On reception of this command, all ZGP devices remove all entries for SrcID 0x12345678 they may have in their proxy tables, and sink tables [1, Sections A.3.4.2.2 and A.3.3.2.2] by. Reception of this command will also make ZGP devices remove translations for SrcID 0x12345678. </p><p id="p0068" num="0068"> Step 6B. If there was a previous control relationship, the RC sends a standard ZigBee ZCL Groups cluster Remove Group command (OxMMMM) in groupcast to group OxMMMM. ON reception of this command, all devices, ZGP-capable and non-ZGP-capable, remove the membership of any of their endpoints in the old ZGPD switch group OxMMMM. 
<!-- EPO <DP n="9"/>-->
 Step 7. If there was a previous control relationship, the ZGP AssignedAlias for SrcID 0x12345678 (OxNNNN) will be re-used for proxy aliasing [1, Sec. A.3.6.3.3] . Otherwise, the RC generates from its pool of individual addresses a ZGP AssignedAlias (the next free from its individual address pool, say 0x0004), to be used for proxy aliasing. For convenience, we denote the ZGP AssignedAlias for SrcID 0x12345678 with OxZZZZ; so OxZZZZ equals OxNNNN if there was previous relationship, and equals 0x0004 otherwise. </p><p id="p0069" num="0069"> Step 8. If there was a previous control relationship, the commissioned group ID for SrcID 0x12345678 (OxMMMM) will be re-used for addressing the group to be controlled by the ZGPD switch. If there was no previous control relation, the RC generates from its pool of Group Addresses a new group ID (the next free, say 0x0008) for this purpose. For convenience, we denote the group ID used to address the group to be controlled by OxVWXY; so OxVWXY equals OxMMMM if there was previous relationship, and equals 0x0008 otherwise. </p><p id="p0070" num="0070"> Step 9. The RC sends a standard ZigBee ZCL Groups Cluster Add Group command (OxVWXY) in groupcast to group 0x0007. On reception of this command, all devices, ZGP- capable and non-ZGP-capable, make all their endpoints, ZGP and non-ZGP endpoints, currently being members of the RC group (with group ID 0x0007) to become members of the ZGPD group O VXWY. . </p><p id="p0071" num="0071"> Step 10. The RC sends a ZGP Configure Pairing command [1 , Sec. A.3.3.3.7] , containing pairing information, including the DevicelD, the ZGP AssignedAlias (OxZZZZ) and the commissioned group ID (OxVWXY), with Paired endpoints list set to Oxfe (indicating: all current members of this group are to be included in the Paired endpoints list) in broadcast (optionally to the EPP 242, the reserved endpoint for the ZGP Proxy cluster). On reception of this command: </p><p id="p0072" num="0072"> - Legacy devices do not understand this command and hence silently drop it.</p><p id="p0073" num="0073">- Each ZGP capable device receiving this command </p><p id="p0074" num="0074"> • with proxy capabilities considers storing the ZGPD information for forwarding (according to criteria defined in ZGP specification [ 1] , like InRange, FixedLocation and maintenance policy of the Proxy Table), and if it chooses to do so: </p><p id="p0075" num="0075"> - Creates a Proxy Table entry for SrcID and fills it using the information from the ZGP Configure Pairing command</p><p id="p0076" num="0076">- Stores the information required for forwarding translated ZGPD commands to legacy devices 
<!-- EPO <DP n="10"/>-->
 - This can have a form of a virtual end point (vEP) with a </p><p id="p0077" num="0077"> Command translation table for legacy devices; </p><p id="p0078" num="0078"> - And/or using the Proxy Table, with one of the now reserved sub-fields of the Options field of the Proxy Table entry, for storing LegacyForwarding; </p><p id="p0079" num="0079"> - Alternatively, the Sink Table and/or the Translation Table can be used </p><p id="p0080" num="0080"> Preferably, the legacy forwarding is explicitly enabled by the commissioning tool. </p><p id="p0081" num="0081"> This can be realized by having a LegacyForwarding control flag, with ObO meaning FALSE and Obi meaning TRUE. It could be realized using the now reserved bit 7 of the Options field of the ZGP Configure Pairing command [1, sec. A.3.3.2.2.1]. </p><p id="p0082" num="0082"> - Adds itself (EPP) as a member to the ZGP group (OxVWXY) (by issuing APSME-ADD-GROUP.request primitive) </p><p id="p0083" num="0083"> Checks if it has any ZSL endpoint(s) being member of group OxVWXY. If yes: </p><p id="p0084" num="0084"> - Creates a sink table entry for SrcID (alias(=0xZZZZ)). </p><p id="p0085" num="0085"> - Creates a ZGPD Command Translation Table entry [1, Sec. </p><p id="p0086" num="0086"> A.3.6.2.2] for the local translation for the local ZSL endpoints (SrcID, CommandID -&gt; ZSL endpoint, profile, cluster, c ommand/attribute ? ) </p><p id="p0087" num="0087"> - Stores the numbers of its ZSL end point(s) currently being members of OxVWXY for internal control; </p><p id="p0088" num="0088"> - Removes its ZSL EndPoint(s) from group OxVWXY (by issuing APSME-REMOVE-GROUP.request primitive) </p><p id="p0089" num="0089"> Step 11. Optionally: the RC broadcasts Translation Table Update commands [1, Sec. A.3.6.2.2.] to enable command translation for servicing legacy devices. This step is not necessary if these translations are already hard-coded in ZGP-capable devices and/or the default ZGPD command translations can be used. </p><p id="p0090" num="0090"> Step 12. The RC returns to operational mode. 
<!-- EPO <DP n="11"/>-->
 Note that the RC still controls all members of group 0x0007. If group 0x0007 changes at a later time, the set of lamps under control of the RC will differ from the set of lamps under control of the ZGP switch. In the operational mode, if a ZGP-capable device receives a ZGPD command directly from the ZGP switch, then it performs the following steps: </p><p id="p0091" num="0091"> • Translating the ZGPD command to a ZigBee ZSL command (using the translation table on a virtual EndPoint and/or the Translation Table on the Sink, as created/updated in step 10/11 above), that they then forward to the group OxVWXY under control of the ZGP switch </p><p id="p0092" num="0092"> Tunneling the ZGPD command using a ZGP Notification to the ZGP-capable lamps under control of the ZGP switch addressing the group ID OxVWXY (this is standard ZGP behavior [1], allowing for coverage of the ZGP-capable lamps out of ZGPD range) </p><p id="p0093" num="0093"> · Making a local translation for the non-ZGP endpoints if the device itself is under control of the ZGP switch (this is standard ZGP behavior, allowing for coverage of the ZGP-enabled lamps within ZGPD range). </p><p id="p0094" num="0094"> Moreover, ZGP-capable devices that are a member of group OxVWXY drop all translated commands that they receive, and only execute ZGP commands, either tunneled, or received directly </p><p id="p0095" num="0095"> In forwarding translated commands and tunneling ZGP commands, ZGP-capable devices use the assigned alias OxZZZZ for proxy aliasing [1, Sec. A.3.6.3.3]. The sequence number used for forwarding translated and tunneled ZGP commands is derived from the value of the GPDF MAC header Sequence Number field. The alias NWK sequence number they use shall be different; the sequence number used for forwarding translated commands equals the value of the GPDF MAC header Sequence Number field - k (modulo 256) for some offset k. An appropriate choice for k is, for example, 24. </p><p id="p0096" num="0096"> The second embodiment comprises common steps with the first one, which will not be detailed again herein after. In this second embodiment, two group IDs are used, instead of a single group in the first one. </p><p id="p0097" num="0097"> Steps 0-4 remain the same. The RC group of the devices to be controlled by the ZGPD switch is denoted with 0x0007. </p><p id="p0098" num="0098"> Step 5, is similar to the one of the first embodiment, except the fact that there may appear to be two control relations, corresponding to the two group IDs. 
<!-- EPO <DP n="12"/>-->
 Step 6A remains the same, while in step 6B, two Remove Groups commands are sent if there were two previous control relations. </p><p id="p0099" num="0099"> Step 7 does not change (We denote the ZGP AssignedAlias for SrcID 0x12345678 with OxZZZZ, independent of re-used or newly generated), while in Step 8, two group IDs are generated or one re -used and one generated, or two re-used, for example group IDs OxAAAA and OxBBBB, independent of re-used or newly generated. </p><p id="p0100" num="0100"> In step 9, all members of group 0x0007 are made member of group OxAAA. </p><p id="p0101" num="0101"> Step 10 from the first embodiment is replaced by two steps, 10A and 10B. A flag is used in the Configure Pairing command (e.g. using the now-reserved bit in the Options field) so that ZGP-capable devices receiving this command know to act according to step 10A or 10B. The LegacyForwarding control flag as described in the first embodiment can be used for that purpose, set to Obi it indicates step 10A, and set to ObO it indicates step 10B. </p><p id="p0102" num="0102"> In Step 10A, the RC sends a ZGP Configure Pairing command containing pairing information, including the DevicelD, the ZGP AssignedAlias (OxZZZZ) and the commissioned group ID (OxAAAA), with Paired endpoints list set to Oxfe (indicating: all current members of this group are to be included in the Paired endpoints list) in broadcast (optionally to the EPP 242, the reserved endpoint for the ZGP Proxy cluster). </p><p id="p0103" num="0103"> - Legacy devices do not understand this command and hence ignore it.</p><p id="p0104" num="0104">- Each ZGP capable device receiving this command checks if it has any ZSL endpoint(s) being member of group OxAAAA, and if so </p><p id="p0105" num="0105"> • Creates a sink table entry for SrcID (alias (=0xZZZZ)),</p><p id="p0106" num="0106">• Creates a ZGPD Command Translation Table entry [1, Sec. A.3.6.2.2] for the local translation for the local ZSL endpoints</p><p id="p0107" num="0107">• Stores the numbers identifying its ZSL end point(s) currently being members of OxAAAA for internal control in its ZGPD Command</p><p id="p0108" num="0108">Translation Table; </p><p id="p0109" num="0109"> • Removes its ZSL EndPoint(s) from group OxAAAA (by issuing the APSME-REMOVE-GROUP.request primitive) </p><p id="p0110" num="0110"> Next, in step 10B, the RC sends a ZGP Configure Pairing command, containing pairing information, including the DevicelD, the ZGP AssignedAlias (OxZZZZ) and the commissioned group ID (OxBBBB), with Paired endpoints list set to Oxfe (indicating: current members of this group are to be included in the Paired endpoints list) in broadcast (optionally to the EPP 242, the reserved endpoint for the ZGP Proxy cluster). </p><p id="p0111" num="0111"> - Legacy devices do not understand this command and hence ignore it. 
<!-- EPO <DP n="13"/>-->
 - Each ZGP capable device receiving this command </p><p id="p0112" num="0112"> Stores the information for forwarding </p><p id="p0113" num="0113"> - Creates a Proxy Table entry for SrcID and fills it using the information from the ZGP Configure Pairing command - Stores the information required for forwarding translated</p><p id="p0114" num="0114">ZGPD commands to legacy devices </p><p id="p0115" num="0115"> - This can have a form of a virtual end point (vEP) with a Command translation table for legacy devices; </p><p id="p0116" num="0116"> - And/or using the Proxy Table, with one of the now reserved sub-fields of the Options field of the Proxy</p><p id="p0117" num="0117">Table entry, for storing LegacyForwarding; </p><p id="p0118" num="0118"> - Alternatively, the Sink Table and/or the Translation Table can be used </p><p id="p0119" num="0119"> - Adds itself (EPP) as a member to the ZGP group (OxBBBB) (by issuing APSME-ADD-GROUP.request) </p><p id="p0120" num="0120"> Steps 11 and 12 are the same as in the first embodiment. </p><p id="p0121" num="0121"> The operational mode will now be described in connection with Figure 1. </p><p id="p0122" num="0122"> Let's assume the following: device 1 is a ZGP-capable device, device 4 is a ZGP- capable device under control of the ZGPD device and belonging to group OxBBBB, device 5 is a non-ZGP capable device under control of the ZGPD device and belonging to group OxAAAA, and devices 1 and 2 are devices not under control of the ZGPD device. </p><p id="p0123" num="0123"> In the operational phase, ZGPD commands are forwarded in translated form to group OxAAAA, and are tunnelled as ZGP commands to group OxBBBB, according to the following procedure: </p><p id="p0124" num="0124">Upon reception of a ZGPD command frame from a ZGPD device, device 1 : </p><p id="p0125" num="0125"> translates the command and forwarding the translated command to devices members of group OxAAAA, thus to device 5, and </p><p id="p0126" num="0126"> tunnels the non-translated command to devices members of the second of group</p><p id="p0127" num="0127">OxBBBB, thus do device 4. </p><p id="p0128" num="0128">The described embodiments of the invention have been optimized for the specific case of ZigBee Smart Light (ZSL) lamps, both ZGP-capable and non-ZGP-capable, controlled by a remote control and a ZGPD energy-harvesting switch. However, the invention also cover other embodiments, for other applications and device types than lighting, e.g. ZigBee Building Automation and ZigBee Home Automation networks containing both ZGP-capable 
<!-- EPO <DP n="14"/>-->
 and non-ZGP-capable devices, to be controlled by a ZGPD, including but not limited to Heating, Ventilation and Air Conditioning (HVAC) devices, security and access control devices (e.g. door/window controllers, etc.), safety devices, other automation devices (e.g. blinds and closures controllers), etc. </p><p id="p0129" num="0129"> The present invention can be used for controlling systems using ZigBee Green Power devices according to the ZigBee Green Power specification [1] (such as energy-harvesting electromechanical light switches, solar-powered sensors, or long-lifetime, battery-powered meters), in which some of the devices in the system to be controlled by the ZGPD do not understand ZGP. </p><p id="p0130" num="0130"> Herein after are several embodiments, described with reference to the first embodiment. </p><p id="p0131" num="0131"> • The RC group (referenced to as Group ID 0x0007) can be a group established for a different purpose, e.g. pre-existing group controlled by another device, e.g. the RC performing the commissioning operation, or a location-dependent group (e.g. per-room). It can also be a temporary helper group. Or a dedicated fixed reserved GroupID for commissioning purposes. The membership of group 0x0007 can thus persist or be resolved after the ZGP commissioning action. It can be resolved automatically or on explicit commissioning device action (e.g. remove the group). </p><p id="p0132" num="0132"> • In Step 0, according to an embodiment, the group of devices to be controlled by the ZGPD does not pre-exist, and is created during the commissioning process. </p><p id="p0133" num="0133"> It is created by using one of the following optional features: </p><p id="p0134" num="0134"> o Graphical grouping on a graphical user interface (GUI); </p><p id="p0135" num="0135"> o ZigBee device and service discovery in combination with ZigBee Identify mechanism (finding all (active) devices matching cluster(s), putting the nodes with matching clusters one by one in identify mode and selecting/deselecting them) </p><p id="p0136" num="0136"> o Default groups based on any criteria (e.g. manufacturer, radio range) </p><p id="p0137" num="0137"> o Any out-of-band method (e.g. manual operation of the user on that device) o Automated location/commissioning algorithms </p><p id="p0138" num="0138"> o Device position in the building layout, etc. </p><p id="p0139" num="0139">Anyway, the group is determined in such a way that the devices to be controlled by the ZGPD are in the same group with known group ID at the start of Step 10, i.e., when pairing information is sent to the devices to be controlled by the ZGPD. 
<!-- EPO <DP n="15"/>-->
• The role of the commissioning device can be performed by any other device than the ZGP-enabled ZSL remote control. It can e.g. be performed by a ZGP-enabled commissioning tool or any ZGP-enabled device to be controlled by the ZGPD. </p><p id="p0140" num="0140"> • The device performing the role of the commissioning tool uses the ZigBee device and service discovery mechanisms (as described by ZigBee specification) to find out the capabilities of the (relevant) devices. </p><p id="p0141" num="0141"> The relevant devices can for example be identified by out-of-band means, e.g. manual operation of the user, or the ZigBee Identify mechanism, or via some radio- communication criteria, such as limited range, (commissioning) network joining criteria, etc. </p><p id="p0142" num="0142"> The discovery can be performed for all devices in the commissioning network/defined range, or for the relevant devices only. </p><p id="p0143" num="0143"> The discovery can already use the ZGPD device and service capability information available from the ZGPD commissioning phase. The discovery can also be generic, with a subsequent step of functionality matching. </p><p id="p0144" num="0144"> • In another embodiment, the selected devices are immediately made members of the ZGPD switch group ID (OxVWXY/OxAAAA/OxBBBB), without using the group ID 0x0007 </p><p id="p0145" num="0145"> • In yet another embodiment, the device performing the role of the commissioning device may communicate with the devices to be controlled by the ZGPD in different communication modes, incl. communicating with each device individually, using unicast communication. </p><p id="p0146" num="0146"> • In yet another embodiment, instead of ZGP Configure Pairing, different command with the same effect may be used: ZCL commands for directly writing to ZGP Proxy Table and/or Sink Table, as well as ZGP Pairing command. </p><p id="p0147" num="0147"> • In another embodiment, in Step 0 and steps 7 to 10, the ZGPD switch group ID is created proactively, before the ZGPD devices are added to the system. For example, in the case where the ZigBee network is set up in an office environment, an "empty" group ID (i.e. a group not yet controlled by any device) is created for each functionally separate entity, like zone, room, workplace, floor, etc. Subsequently, a simple pushbutton-based proximity- or proxy-based pairing, as described in [1, Sec A.3.9] can be used to pair this proactively established, not yet controlled group to the controlling ZGPD - or any regular ZigBee pairing mechanisms can be used to add a regular ZigBee controlling device. 
<!-- EPO <DP n="16"/>-->
• Step 4: the functionality matching can be instead performed by the devices to be controlled by the ZGPD individually, with an individual indication of success failure.</p><p id="p0148" num="0148">• In another embodiment, in steps 2 to 4: Instead of sending the ZGPD Commissioning GPDF, a very restricted ZGPD may only be capable of sending Data GPDF with Auto- Commissioning bit set to Obi [1, Sec. A.1.4.1.2]Then, in step 4, the RC/CT/ZGP-capable device can perform the functionality matching based on the ZGPD CommandID sent by the ZGPD. The behavior of the RC-CT/ZGP-capable received when the functionality matching fails is application specific. The commissioning of this ZGPD may be abandoned. Or, the appropriate command translation between the actually sent ZGPD CommandlDs and the expected application actions can be provided. </p><p id="p0149" num="0149"> • In another embodiment, in steps 7 and 8: the previous group and alias identifiers, if any, used in relation with the ZGPD switch, are either re-used or replaced by new identifiers. </p><p id="p0150" num="0150"> • In yet another embodiment, in Step 11, a translation for some ZGP commands may not be sent, for example since the legacy devices miss the corresponding functionality. If such a command is sent by the ZGPD in the operational phase, legacy devices will not act upon it. </p><p id="p0151" num="0151"> • Further/alternative mechanisms (e.g. commands, flags) can be defined to allow for explicit enabling/disabling of both ZGP and legacy forwarding (of tunneled/translated ZGPD commands, respectively). </p><p id="p0152" num="0152"> In a commercial enviroment, like a building automation system for offices, shops, schools, hospitality, industry and institutions, the use of a commissioning tool is not uncommon. There are also home automation systems using such. The tool can be graphical or just text based, advanced or simple. An exemplary embodiment will now be described, indended for use with a commissioning tool in ZigBee Home Automation/ZigBee Building Automation system. </p><p id="p0153" num="0153"> Step 1. The user puts the commissioning tool in commissioning mode. </p><p id="p0154" num="0154"> Step 2. The user executes the required ZGP commissioning action (as defined in the ZigBee Green Power specification [1]) or set of actions on the ZGPD, until a commissioning success indication is provided by the commissioning tool. The commissioning success indication can be e.g. the icon and/or ZGPD SrcID and/or other identifier of the ZGPD device appearing of the commissioning tool's screen. </p><p id="p0155" num="0155"> The commissioning tool executes the required ZGP commissioning action(s) (as defined in the Green Power specification [1]) and provides commissioning success indication 
<!-- EPO <DP n="17"/>-->
 when it's finished. (From this time on, the ZGPD switch can be put back in operational mode). </p><p id="p0156" num="0156"> Based on information from the ZGPD commissioning phase, the commissioning tool performs the application functionality mapping of the ZGPD to the default regular ZigBee functionality. </p><p id="p0157" num="0157"> Stepn 3. Regular ZigBee devices join the commissioning tool. The order of steps 2&amp;3 is not strictly prescribed. </p><p id="p0158" num="0158"> Step 4. The user uses the ZigBee Identify mechanism to select a device to be controlled by the ZGPD. </p><p id="p0159" num="0159"> Step 5. For the identified device to be controlled by the ZGPD, the commissioning tool uses the ZigBee device and service discovery mechanisms (as described by ZigBee specification) to find out the capabilities of the joined devices. </p><p id="p0160" num="0160"> Step 6. The commissioning tool performs functionality matching between ZGPD and the identified device. If no default mapping is available, it allows for defining of the translation. </p><p id="p0161" num="0161"> The translation definition phase could e.g. be realised as drop-down menu, consisting of the ZigBee-controllable functionality (ZigBee attributes/commands) available on the identified device. </p><p id="p0162" num="0162"> Step 7. The commissioning tool sends </p><p id="p0163" num="0163"> - If the identified device is a non-ZGP capable device: </p><p id="p0164" num="0164"> o ZigBee ZCL Groups Cluster Add Group command for the appropriate</p><p id="p0165" num="0165">GroupID and appropriate endpoint(s) of this device; </p><p id="p0166" num="0166"> If the identified device is a ZGP capable device: </p><p id="p0167" num="0167"> o ZigBee ZCL Groups Cluster Add Group command for the appropriate group and endpoint(s) of this device, </p><p id="p0168" num="0168"> o ZCL Write attributes command for the Sink Table of the ZGP endpoint of this device. </p><p id="p0169" num="0169"> o The commissioning tool may explicitly enable/disable ZGP and/or legacy forwarding (of tunnelled/translated ZGPD commands, respectively). </p><p id="p0170" num="0170"> Steps 4-7 are to be repeated for all devices to be controlled by the ZGPD. Step 7 can be performed for each device individually (preferably in unicast), or can be performed jointly with step 8 (below), after the group configuration is finished. This 
<!-- EPO <DP n="18"/>-->
 could simplify fixing of e.g. functionality/translation inconsistencies at the commissioning tool, etc. </p><p id="p0171" num="0171"> Step 8. After the commissioning of the group is finished, the commissioning tool can explicitly configure ZGP and/or legacy forwarding, by addressing further, not-to-be- controlled-by-the-ZGPD, ZGP Proxy/Combo devices. </p><p id="p0172" num="0172"> Preferably, the commissioning tool will send unicast ZigBee ZCL Write command for the ZGP Proxy Table attribute or unicast ZGP Pairing command, groupcast/broadcast ZGP Pairing or ZGP Configure Pairing commands, as described in the previous embodiments, can also be used. The commissioning tool will further configure the group membership of those device, is required.</p><p id="p0173" num="0173">Step 9. Instruct the devices on the commissioning network to switch to operational network. </p><p id="p0174" num="0174"> Step 9 can be performed before step 7&amp;8, i.e. the ZGPD control configuration can be delivered on the operational network. </p><p id="p0175" num="0175"> For step 9 to be performed with success, delivery of ZigBee operational network parameters is required, as defined in the ZigBee specification. This is not specific to this procedure, and can be performed anywhere within/between step 3 and 9. </p><p id="p0176" num="0176"> In the present specification and claims the word "a" or "an" preceding an element does not exclude the presence of a plurality of such elements. Further, the word "comprising" does not exclude the presence of other elements or steps than those listed. </p><p id="p0177" num="0177"> The inclusion of reference signs in parentheses in the claims is intended to aid understanding and is not intended to be limiting. </p><p id="p0178" num="0178"> From reading the present disclosure, other modifications will be apparent to persons skilled in the art. Such modifications may involve other features which are already known in the art of communication network and which may be used instead of or in addition to features already described herein. 
</p></description><claims mxw-id="PCLM44852115" ref-ucid="WO-2012117344-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="19"/>-->CLAIMS </claim-statement><claim id="clm-0001" num="1"><claim-text>1. Method for operating devices in a ZigBee network comprising ZigBee Green Power</claim-text><claim-text>(ZGP)-capable devices and non-ZGP-capable devices, both under control of at least one ZGPD device, the method comprising the following steps : the ZGPD device transmitting ZGPD command frame, </claim-text><claim-text> upon reception of a ZGPD command frame from said/the ZGPD device , a ZGP-capable device: </claim-text><claim-text> translating the received ZGPD command to a regular ZigBee command compatible with non-ZGP-capable devices, and forwarding the translated command, and tunneling the ZGPD command using ZGP tunneling mechanism, </claim-text><claim-text> the ZGP-capable devices controlled by the ZGPD device executing only the tunneled command, if the controlled application functionality is supported, </claim-text><claim-text> the non-ZGP-capable devices controlled by the ZGPD device executing only the translated command, if the controlled application functionality is supported. </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. Method according to claim 1, comprising an initial commissioning phase comprising the following steps : </claim-text><claim-text> the commissioning device identifying the devices, ZGP-capable or non-ZGP capable, to be controlled by the ZGPD device, </claim-text><claim-text> the commissioning device generating a first ZigBee group ID and instructing all identified devices to become members of first ZGPD group corresponding to the first group ID; </claim-text><claim-text> all identified devices becoming members of first ZGPD group corresponding to the first group ID </claim-text><claim-text> the commissioning device obtaining information about the ZGPD, comprising the ZGPD SrcID. </claim-text></claim><claim id="clm-0003" num="3"><claim-text>Method according to claim 2, comprising a pairing step, wherein pairing commands are sent from the commissioning device to the members of the first group. </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. Method according to any of the preceding claims, wherein all devices under control of the ZGPD device are member of a single ZigBee group, and the translating, forwarding and tunneling a command comprises the steps of: <!-- EPO <DP n="20"/>--> upon reception of a ZGPD command frame from said ZGPD device a ZGP-capable device </claim-text><claim-text> translating the ZGPD command into a regular ZigBee command and forwarding the translated command to devices being members of said ZigBee group, and </claim-text><claim-text> tunneling the non-translated ZGPD command to devices being members of the said ZigBee group, </claim-text><claim-text> and wherein the ZGP-capable devices, on reception of the translated ZGPD command sent to the ZigBee group, silently drop the command. </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. Method according to any of the preceding claims, comprising as part of the initial commissioning phase, a step of: </claim-text><claim-text>for any ZGP-capable device being a member of a first ZGPD group, having at least one non-ZGP-capable application endpoint being a member of the ZGPD group, upon reception of the pairing commands, of </claim-text><claim-text>adding its ZGP endpoint to the first ZGPD group, </claim-text><claim-text>creating a ZGP Sink Table entry for the SrcID, </claim-text><claim-text>storing the numbers identifying the non-ZGP endpoints being a member of the first</claim-text><claim-text>ZGPD group in its ZGP Command Translation Table, </claim-text><claim-text>and removing these non-ZGP endpoints from the first ZGPD group. </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. Method according to claim 1, wherein each device under control of the ZGPD device is a member of one of two ZGPD groups, the first group consisting of ZGP- capable devices under control of the ZGPD device and the second group consisting of non-ZGP-capable devices under control of the ZGPD device , and the steps of translating, forwarding and tunneling a command comprises the steps of : </claim-text><claim-text>upon reception of a ZGPD command frame from said ZGPD device a ZGP-capable device: </claim-text><claim-text> translating the command and forwarding the translated command to devices members of the second of said two groups, and </claim-text><claim-text> tunneling the non-translated command to devices members of the second of said two groups. </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. Method according to any of claims 1 to 3 and 6, comprising as part of the initial commissioning phase, the step of generating a second ZigBee group ID, and <!-- EPO <DP n="21"/>--> having part of the network devices to be controlled by the ZGPD assigned to the second ZGDP group corresponding to second ZigBee group ID </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. Method according to claim 6 and 7, wherein the network devices assigned to the second ZigBee group are devices, identified by the commissioning device, that are ZGP capable. </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. Method according to claim 6, 7 and 8, comprising, as part of the initial commissioning phase, the steps of, for any ZGP-capable device (with sink capabilities) being a member of the first ZGPD group, having at least one non-ZGP-capable application endpoint being a member of the first ZGPD group, </claim-text><claim-text>adding its ZGP endpoint to the second ZGPD group, </claim-text><claim-text>creating a ZGP Sink Table entry for the SrcID, </claim-text><claim-text>storing the numbers identifying the non-ZGP endpoints being a member of the first</claim-text><claim-text>ZGPD group in its ZGP Command Translation Table, </claim-text><claim-text>and removing these non-ZGP endpoints from the first ZGPD group. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. Method according to claim one of the preceding claims, comprising the initial step, for a user, of setting the commissioning device in commissioning mode and/or performing the commissioning action on the ZGPD device. </claim-text></claim><claim id="clm-0011" num="11"><claim-text>11. Method according to any of the preceding claims, comprising the step of removing any previous group membership of any device in the network related to the ZGPD device. </claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. Method according to any preceding claim, comprising one of the following steps : the step of the commissioning device performing an application functionality matching between the ZGPD and the devices to be controlled, </claim-text><claim-text>the step of the commissioning device sending a command to configure the translation of ZGPD command into regular ZigBee command compatible with non-ZGP-capable devices for translation for non-ZGP-capable devices in the operational phase, and <!-- EPO <DP n="22"/>--> the step, for a ZGP-capable device with ZGP proxy capabilities, of locally storing translation for the ZGPD commands into regular ZigBee command compatible with non- ZGP-capable devices and the information on the group ID to forward it to. </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. Method according to any of the preceding claims, wherein the forwarding of the translated command uses the ZGP aliasing mechanism. </claim-text></claim><claim id="clm-0014" num="14"><claim-text>14. Method according to any of the preceding claims, where the commissioning device role is performed by a device comprised in the group comprising: a dedicated ZigBee Commissioning Tool device, any ZGP-capable device, a regular remote control device, having also ZGP capabilities, ZigBee PAN Coordinator, ZigBee Network Manager, ZigBee Trust Center, application software on a device behind a ZigBee bridge or gateway. </claim-text></claim><claim id="clm-0015" num="15"><claim-text>15. Method according to claim 14 wherein the step of identifying the devices is performed by using at least one of the following features: graphical grouping of the network devices; ZigBee device and service discovery method, ZigBee identification of devices matching clusters; use of default groups based on predetermined criteria, use of previously established control groups, explicit user action on the selected devices; use of out-of-band method. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
