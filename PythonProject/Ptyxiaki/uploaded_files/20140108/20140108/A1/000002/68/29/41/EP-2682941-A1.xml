<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2682941-A1" country="EP" doc-number="2682941" kind="A1" date="20140108" family-id="46762826" file-reference-id="302764" date-produced="20180824" status="corrected" lang="DE"><bibliographic-data><publication-reference fvid="146584811" ucid="EP-2682941-A1"><document-id><country>EP</country><doc-number>2682941</doc-number><kind>A1</kind><date>20140108</date><lang>DE</lang></document-id></publication-reference><application-reference ucid="EP-12175808-A" is-representative="YES"><document-id mxw-id="PAPP154847003" load-source="docdb" format="epo"><country>EP</country><doc-number>12175808</doc-number><kind>A</kind><date>20120710</date><lang>DE</lang></document-id><document-id mxw-id="PAPP170521194" load-source="docdb" format="original"><country>EP</country><doc-number>12175808.0</doc-number><date>20120710</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140554124" ucid="US-201261667119-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201261667119</doc-number><kind>P</kind><date>20120702</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1989319184" load-source="docdb">G10L  21/02        20130101AFI20121114BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1989319814" load-source="docdb">G10L  19/02        20130101ALN20121114BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1927414803" load-source="docdb" scheme="CPC">G10L  19/0204      20130101 LA20160615BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2068544248" load-source="docdb" scheme="CPC">G10L  21/0388      20130101 LI20150424BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2068544594" load-source="docdb" scheme="CPC">G10L  25/18        20130101 FI20150423BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2068546170" load-source="docdb" scheme="CPC">H03G   3/00        20130101 LI20150423BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132359066" lang="DE" load-source="patent-office">Vorrichtung, Verfahren und Computerprogramm für frei wählbare Frequenzverschiebungen in der Subband-Domäne</invention-title><invention-title mxw-id="PT132359067" lang="EN" load-source="patent-office">Device, method and computer program for freely selectable frequency shifts in the sub-band domain</invention-title><invention-title mxw-id="PT132359068" lang="FR" load-source="patent-office">Dispositif, procédé et programme informatique pour décalage de fréquence librement sélectif dans le domaine de sous-bande</invention-title><citations><patent-citations><patcit mxw-id="PCIT242942392" load-source="docdb" ucid="US-20120065983-A1"><document-id format="epo"><country>US</country><doc-number>20120065983</doc-number><kind>A1</kind><date>20120315</date></document-id><sources><source name="SEA" category="A" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242942391" load-source="docdb" ucid="WO-2011089029-A1"><document-id format="epo"><country>WO</country><doc-number>2011089029</doc-number><kind>A1</kind><date>20110728</date></document-id><sources><source name="SEA" category="A" created-by-npl="N"/></sources></patcit></patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR919542145" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>UNIV ILMENAU TECH</last-name><address><country>DE</country></address></addressbook></applicant><applicant mxw-id="PPAR919543256" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>TECHNISCHE UNIVERSITAET ILMENAU</last-name></addressbook></applicant><applicant mxw-id="PPAR919017432" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Technische Universität Ilmenau</last-name><iid>100951755</iid><address><street>Ehrenbergstrasse 29</street><city>98693 Ilmenau</city><country>DE</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919540924" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>NAGEL FREDERIK</last-name><address><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR919532578" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>NAGEL, FREDERIK</last-name></addressbook></inventor><inventor mxw-id="PPAR919019569" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>NAGEL, FREDERIK</last-name><address><street>Wilhelmshavener Strasse 72</street><city>90425 Nürnberg</city><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR919518195" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>SCHNABEL MICHAEL</last-name><address><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR919510456" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>SCHNABEL, MICHAEL</last-name></addressbook></inventor><inventor mxw-id="PPAR919019428" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>SCHNABEL, MICHAEL</last-name><address><street>Schneidbergweg 4a</street><city>95179 Geroldsgrün</city><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR919523469" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>NEUKAM CHRISTIAN</last-name><address><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR919526155" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>NEUKAM, CHRISTIAN</last-name></addressbook></inventor><inventor mxw-id="PPAR919015594" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>NEUKAM, CHRISTIAN</last-name><address><street>Welfenstrasse 32</street><city>88239 Wangen i.A.</city><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR919545003" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>SCHULLER GERALD</last-name><address><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR919511985" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>SCHULLER, GERALD</last-name></addressbook></inventor><inventor mxw-id="PPAR919007333" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>SCHULLER, GERALD</last-name><address><street>Rupprechtgasse 7</street><city>99094 Erfurt</city><country>DE</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR919017860" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Zinkler, Franz</last-name><suffix>et al</suffix><iid>101189957</iid><address><street>Patentanwälte Schoppe, Zimmermann, Stöckeler Zinkler &amp; Partner Postfach 246</street><city>82043 Pullach</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS549907083" load-source="docdb">AL</country><country mxw-id="DS549739665" load-source="docdb">AT</country><country mxw-id="DS549737051" load-source="docdb">BE</country><country mxw-id="DS549738978" load-source="docdb">BG</country><country mxw-id="DS549739792" load-source="docdb">CH</country><country mxw-id="DS549737052" load-source="docdb">CY</country><country mxw-id="DS549739666" load-source="docdb">CZ</country><country mxw-id="DS549907085" load-source="docdb">DE</country><country mxw-id="DS549737053" load-source="docdb">DK</country><country mxw-id="DS549737054" load-source="docdb">EE</country><country mxw-id="DS549738808" load-source="docdb">ES</country><country mxw-id="DS549738979" load-source="docdb">FI</country><country mxw-id="DS549739793" load-source="docdb">FR</country><country mxw-id="DS549907086" load-source="docdb">GB</country><country mxw-id="DS549737055" load-source="docdb">GR</country><country mxw-id="DS549907087" load-source="docdb">HR</country><country mxw-id="DS549739667" load-source="docdb">HU</country><country mxw-id="DS549739794" load-source="docdb">IE</country><country mxw-id="DS549737056" load-source="docdb">IS</country><country mxw-id="DS549738980" load-source="docdb">IT</country><country mxw-id="DS549737057" load-source="docdb">LI</country><country mxw-id="DS549738981" load-source="docdb">LT</country><country mxw-id="DS549737754" load-source="docdb">LU</country><country mxw-id="DS549738982" load-source="docdb">LV</country><country mxw-id="DS549738983" load-source="docdb">MC</country><country mxw-id="DS549737755" load-source="docdb">MK</country><country mxw-id="DS549737756" load-source="docdb">MT</country><country mxw-id="DS549738809" load-source="docdb">NL</country><country mxw-id="DS549737435" load-source="docdb">NO</country><country mxw-id="DS549738810" load-source="docdb">PL</country><country mxw-id="DS549738984" load-source="docdb">PT</country><country mxw-id="DS549739668" load-source="docdb">RO</country><country mxw-id="DS549738985" load-source="docdb">RS</country><country mxw-id="DS549738811" load-source="docdb">SE</country><country mxw-id="DS549739795" load-source="docdb">SI</country><country mxw-id="DS549737436" load-source="docdb">SK</country><country mxw-id="DS549737437" load-source="docdb">SM</country><country mxw-id="DS549737757" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128672983" lang="DE" load-source="patent-office"><p id="pa01" num="0001">Eine Vorrichtung (100) zur Erzeugung eines frequenzverschobenen Audiosignals basierend auf einem Audioeingangssignal wird bereitgestellt. Die Vorrichtung (100) umfasst eine Schnittstelle (110) und eine Frequenzverschiebungseinheit (120). Die Schnittstelle (110) ist zum Empfang des Audioeingangssignals eingerichtet. Die Frequenzverschiebungseinheit (120) ist zur Erzeugung des frequenzverschobenen Audiosignals eingerichtet. Die Frequenzverschiebungseinheit (120) ist ferner dafür eingerichtet, einen der zweiten Subband-Werte basierend auf einem der ersten Subband-Werte so zu erzeugen, dass der zweite Phasenwinkel dieses zweiten Subband-Werts sich von dem ersten Phasenwinkel dieses ersten Subband-Werts um eine Phasenwinkel-Differenz unterscheidet, wobei die Phasenwinkel-Differenz von einer Frequenzinformation abhängt, die angibt, um welche Frequenzdifferenz das Audioeingangssignal zu verschieben ist, um das frequenzverschobene Audiosignal zu erhalten, und wobei die Phasenwinkel-Differenz von einer Frequenz-Bandbreite von einem der ersten Subbänder abhängt.
<img id="iaf01" file="imgaf001.tif" wi="111" he="70" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128737128" lang="DE" source="EPO" load-source="docdb"><p>Eine Vorrichtung (100) zur Erzeugung eines frequenzverschobenen Audiosignals basierend auf einem Audioeingangssignal wird bereitgestellt. Die Vorrichtung (100) umfasst eine Schnittstelle (110) und eine Frequenzverschiebungseinheit (120). Die Schnittstelle (110) ist zum Empfang des Audioeingangssignals eingerichtet. Die Frequenzverschiebungseinheit (120) ist zur Erzeugung des frequenzverschobenen Audiosignals eingerichtet. Die Frequenzverschiebungseinheit (120) ist ferner dafür eingerichtet, einen der zweiten Subband-Werte basierend auf einem der ersten Subband-Werte so zu erzeugen, dass der zweite Phasenwinkel dieses zweiten Subband-Werts sich von dem ersten Phasenwinkel dieses ersten Subband-Werts um eine Phasenwinkel-Differenz unterscheidet, wobei die Phasenwinkel-Differenz von einer Frequenzinformation abhängt, die angibt, um welche Frequenzdifferenz das Audioeingangssignal zu verschieben ist, um das frequenzverschobene Audiosignal zu erhalten, und wobei die Phasenwinkel-Differenz von einer Frequenz-Bandbreite von einem der ersten Subbänder abhängt.</p></abstract><abstract mxw-id="PA154922178" lang="EN" source="transcript" load-source="docdb"><p>The device (100) has an interface (110) for receiving an audio input signal, and a frequency shift unit (120) is provided for generating the frequency-shifted audio signal. The audio input signal for multiple sub-bands is represented by one or multiple first sub-band values. The frequency shifted audio signal is provided for other multiple sub-bands, where each sub-band has one or multiple other sub-band values. Each former- and latter sub-band values has the information about a respective phase angle. The frequency shift unit is designed to generate one of the former sub-band values. Independent claims are included for the following: (1) a method for generating a frequency-shifted audio signal based on an audio input signal; and (2) a computer program executed on a computer or signal processor for performing the signal generation method.</p></abstract><description mxw-id="PDES63958971" lang="DE" load-source="patent-office"><!-- EPO <DP n="1"> --><p id="p0001" num="0001">Die vorliegende Erfindung bezieht sich auf Audiosignalverarbeitung und, im Speziellen, auf eine Vorrichtung, ein Verfahren und ein Computerprogramm für beliebige Frequenzverschiebungen in der Subband-Domäne.</p><p id="p0002" num="0002">In der von neuen Medien geprägten Gesellschaft sind rechnergestützte Datenverarbeitungssysteme ein fester Bestandteil des täglichen Lebens. Schon seit einiger Zeit finden sich fast in jedem Haushalt Systeme zum Konsum neuer Medien wieder. Beispiele für solche Systeme, die Daten in digitaler Form übermitteln und wiedergeben, sind Abspielgeräte für Video- und Audiodaten, wie etwa für die DVD und BluRay, für die CD und das Dateiformat mp3. Diese Wiedergabesysteme zeichnen sich durch nahezu verlustfreie Reproduktion der medialen Inhalte aus. Neben der klassischen Telekommunikation stellt das Internet ein wichtiges Portal für die Kommunikation, beispielsweise mittels VoIP, dar. Die genannten Technologien werden alle durch die zugrundeliegende digitale Signalverarbeitung verbunden. Sie ist für die Qualität der Wiedergabe und Effizienz der digitalen Technologien von entscheidender Bedeutung.</p><p id="p0003" num="0003">Audiosignalverarbeitung wird dabei immer wichtiger. Derzeit gibt es auf dem Markt eine Vielzahl an Audiocodern, z.B. realisiert durch Algorithmen zur digitalen Aufbereitung von Audiomaterial zur Speicherung oder Übertragung. Ziel jedes Codier-Verfahrens ist es, den Informationsgehalt eines Signals so zu komprimieren, dass es ein Minimum an Speicherplatz benötigt und gleichzeitig eine größtmögliche Reproduktionsqualität erhalten bleibt. Die Effizienz moderner Audiocoder richtet sich in erster Linie nach dem benötigten Speicherplatz und unter anderem nach dem benötigten Rechenaufwand des Algorithmus.</p><p id="p0004" num="0004">Ein digitaler Audiocoder ist prinzipiell ein Instrument zur Überführung von Audiosignalen in ein zur Speicherung oder Übertragung geeignetes Format. Dies geschieht auf Senderseite des Audiocoders (Encoder). Die so erzeugten Daten werden dann im Empfänger (Decoder) wieder in ihre ursprüngliche Form zurückgeführt und entsprechen im Idealfall den Originaldaten bis auf eine konstante Verzögerung (engl. Delay). Das generelle Ziel von Audiocodern ist die Minimierung der zur Repräsentation des Audiosignals benötigten Datenmenge bei gleichzeitiger Maximierung der empfundenen<!-- EPO <DP n="2"> --> Wiedergabequalität. Bei der Entwicklung von Audiocodem muss also auf eine Reihe von Faktoren wie Wiedergabetreue, Datenrate und Komplexität geachtet werden. Daneben spielt auch das durch die Bearbeitung des Signals hinzugefügte Delay (die hinzugefügt Verzögerung) eine wichtige Rolle (Bosi und Goldberg, 2003).</p><p id="p0005" num="0005">Gerade in den Anfängen der Audiocodierung war die Effizienz der Verfahren von großer Bedeutung, da nur sehr begrenzt Speicher und Rechenleistung zur Verfügung standen. Heutzutage scheint dieser Anspruch nicht mehr gegeben. Selbst Heim-PCs oder Laptops können aufwändige Algorithmen mühelos in Echtzeit berechnen und Breitband-Internetverbindungen stellen ausreichend Bandbreite für die Übertragung von codiertem Audiomaterial zur Verfügung. Dennoch ist die Weiterentwicklung von Audiocodierverfahren von besonderer Bedeutung. Im Bereich der mobilen Kommunikation und der Satellitenübertragung ist die Bandbreite stark begrenzt. Es ist wichtig, die zu übertragende Datenmenge zu reduzieren. Es wird zudem in diesen Bereichen viel Wert auf die Effizienz der verwendeten Codier-Technologie gelegt. Die zugrundeliegenden Algorithmen müssen einfach strukturiert sein, um Rechenleistung und Stromverbrauch zu minimieren.</p><p id="p0006" num="0006">Ein anderer Aspekt ist die Qualität der reproduzierten codierten Audiosignale. Viele Audiocoder reduzieren die Datenmenge über Irrelevanzreduktion. Dabei gehen in Abhängigkeit der Datenrate Signalanteile verloren. Bei niedrigen Datenraten sinkt damit die Qualität wiedergegebener Audiosignale.</p><p id="p0007" num="0007">Generell kann zwischen zwei Arten der Audiocodierung unterschieden werden, der verlustfreien und der verlustbehafteten Audiocodierung. Die verlustfreie Audiocodierung ermöglicht auf Empfängerseite eine exakte Rekonstruktion des ursprünglichen Signals. Dagegen verursacht das verlustbehaftete Verfahren über ein Modell der subjektiven Wahrnehmung irreversible Abweichungen gegenüber dem Originalsignal (Zölzer, 2005).</p><p id="p0008" num="0008">Die verlustfreie Audiocodierung basiert auf der Verminderung der Redundanz, die im zu codierenden Signal enthaltenen ist. Ein gängiges Verfahren dazu ist zum Beispiel die lineare Prädiktion (engl. Linear Predictive Coding, LPC) in Verbindung mit nachfolgender Entropiecodierung. Solche Audiocodierverfahren ermöglichen die bitgenaue Rekonstruktion des Eingangssignals aus dem codierten Bitstrom.</p><p id="p0009" num="0009">Die lineare Prädiktion nutzt statistische Abhängigkeiten zwischen aufeinanderfolgenden Abtastwerten (engl. Samples) des Signals, um zukünftige Werte vorhersagen zu können. Dem liegt die Tatsache zugrunde, dass sich aufeinanderfolgende Samples ähnlicher sind<!-- EPO <DP n="3"> --> als weiter entfernte. Die Vorhersage wird durch ein lineares Prädiktionsfilter realisiert, welches den aktuellen Abtastwert durch eine Reihe vorhergehender Samples schätzt. Es wird aber nicht diese Schätzung selbst weiterverarbeitet, sondern die Differenz zwischen diesem Wert und dem eigentlichen Abtastwert an dieser Stelle. Ziel der linearen Prädiktion ist es, die Energie dieses Fehlersignals durch optimierte Filter zu minimieren und dieses Fehlersignal, das nur eine geringe Bandbreite benötigt, zu übertragen (Weinzierl, 2008).</p><p id="p0010" num="0010">Anschließend wird das Fehlersignal entropiecodiert. Die Entropie ist ein Maß für den mittleren Informationsgehalt eines Signals und gibt das theoretische Minimum der für die Codierung benötigten Bits an. Ein typisches Verfahren dazu ist die Huffman-Codierung. Dabei werden einzelnen Abtastwerten in Abhängigkeit ihrer statistischen Auftrittswahrscheinlichkeit bestimmte Codewörter zugewiesen. Häufig auftretenden Abtastwerten werden kurze Symbolen zugewiesen und selten auftretende Signalwerte werden durch lange Codewörter repräsentiert. Im Mittel wird so das codierte Signal durch die kleinstmögliche Anzahl an Bits dargestellt (Bosi und Goldberg, 2003).</p><p id="p0011" num="0011">Sowohl die lineare Prädiktion als auch die Entropiecodierung sind reversibel und entfernen somit aus dem Signal keine Information. Es werden durch Kombination beider Verfahren lediglich Redundanzen aus dem zu codierenden Signal entfernt. Da solche verlustfreien Ansätze stark von der Signal charakteristik abhängen, ist der Codiergewinn vergleichsweise gering. Die erzielte Kompressionsrate, also das Verhältnis von Eingangsbitrate und Bitrate des codierten Signals, liegt im Bereich von 1,5 : 1 bis 3 : 1 (Weinzierl, 2008).</p><p id="p0012" num="0012">Die verlustbehaftete Audiocodierung basiert auf dem Prinzip der Irrelevanzreduktion. Diese Verfahren benötigen ein Modell der menschlichen Wahrnehmung, welches psychoakustische Phänomene des Gehörsinns bezüglich Zeit- und Frequenzauflösung beschreibt. Daher wird die verlustbehaftete Audiocodierung auch als wahrnehmungsangepasste oder psychoakustische Codierung bezeichnet. Im Bereich der Audiocodierung werden alle Signalanteile als irrelevant bezeichnet, die durch den Menschen nicht wahrgenommen werden können und somit unhörbar sind (Zölzer, 2005). Um die Funktionsweise eines wahrnehmungsangepassten Audiocoders genauer zu verstehen, ist ein fundiertes Wissen über die Psychoakustik von großer Bedeutung.</p><p id="p0013" num="0013">Das menschliche Gehör analysiert ein Schallereignis durch Zerlegung in Frequenzgruppen. Diese Frequenzgruppen werden in der Bark-Skala dargestellt und in der englischsprachigen Literatur als Critical Bands bezeichnet. Jede dieser Frequenzgruppen fasst dabei einen Frequenzbereich zusammen, der durch das Gehör gemeinsam ausgewertet wird. Dabei entspricht ein Frequenzbereich einem örtlichen Bereich auf der<!-- EPO <DP n="4"> --> Basilarmembran. Insgesamt werden 24 Critical Bands der Basilarmembran zugeordnet, deren Bandbreite mit steigender Frequenz zunimmt (Fastl und Zwicker, 2007). Verlustbehaftete Audiocoder übernehmen dieses Modell der Frequenzgruppen, um breitbandige Signale in Teilbänder zu zerlegen und jedes Band einzeln zu codieren (Zölzer, 2005). Oftmals wird dieses Modell angepasst und statt der Bark-Skala eine lineare Frequenzeinteilung mit mehr als 24 Bändern verwendet.</p><p id="p0014" num="0014">Ein weiteres wichtiges Merkmal der auditiven Wahrnehmung ist das frequenzabhängige Lautstärkeempfinden von Tönen gleichen Schalldruckpegels. Daraus ergeben sich zwei Eigenschaften des Gehörs. Zum einen werden Töne unterschiedlicher Frequenz aber mit gleichem Schalldruckpegel als unterschiedlich laut empfunden, zum anderen gibt es eine frequenzabhängige Schwelle, ab welcher Töne gerade noch wahrgenommen werden können (Fastl und Zwicker, 2007). Diese Schwelle wird auch als absolute Hörschwelle oder Ruhehörschwelle bezeichnet und ist in <figref idrefs="f0024">Fig. 22</figref> dargestellt. Für die Audiocodierung lassen sich daraus zwei Schlüsse ziehen. Signale, deren Pegel unterhalb der absoluten Hörschwelle liegen, brauchen nicht verarbeitet werden, da sie ohnehin nicht wahrgenommen werden. Daneben lässt sich die Anzahl der benötigten Quantisierungsstufen pro Frequenzband aus dem Abstand zwischen der Ruhehörschwelle und dem Signalpegel mitbestimmen (Zölzer, 2005).</p><p id="p0015" num="0015">Den größten Einfluss auf die Audiocodierung haben die Verdeckungs- oder Maskierungseffekte. Hier kann zwischen zeitlicher und frequenzabhängiger Maskierung unterschieden werden. Als Maskierer wird in beiden Fällen ein Schallereignis bezeichnet, durch das ein anderes Schallereignis verdeckt wird. Das maskierte Ereignis ist also unhörbar. Bei zeitlicher Maskierung wird ein Ereignis vor beziehungsweise nach dem Maskierer verdeckt. Vorverdeckung (engl. Premasking) ist unabhängig von der Dauer des Maskieres und verdeckt Schallereignisse bis 50ms vor der Wahrnehmung des Maskierers selbst (Yost, 1994). Dagegen ist Nachverdeckung (engl. Postmasking) abhängig von der Dauer des Maskierers. Hier werden Schallereignisse nach Verstummen des Maskierers verdeckt. In Abhängigkeit der Dauer des Maskierers können bis zu 200ms vergehen, bis das Gehör wieder für Signale im Bereich der Ruhehörschwelle empfänglich ist (Fastl und Zwicker, 2007).</p><p id="p0016" num="0016"><figref idrefs="f0023">Fig. 21</figref> zeigt eine schematische Darstellung einer zeitlichen Maskierung. Speziell zeigt <figref idrefs="f0023">Fig. 21</figref> schematisch die Bereiche des Pre- und Postmaskings und jeweils den Pegel unter welchem Signale verdeckt werden. Zeitliche Verdeckung kann in der Audiocodierung benutzt werden, um die durch den Codierprozess auftretenden Störgeräusche wie beispielsweise Quantisierungsrauschen vor Signalsequenzen mit hohem Pegel<!-- EPO <DP n="5"> --> (Transienten) zu verbergen.</p><p id="p0017" num="0017">Maskierungseffekte im Frequenzbereich spielen eine weit größere Rolle als zeitliche Verdeckungseffekte. Die frequenzabhängige Maskierung beschreibt die Veränderung der Ruhehörschwelle für Einzeltöne und Schmalbandrauschen. Diese Signale verzerren durch ihre spezifische Mithörschwelle die Ruhehörschwelle deutlich. Signale, deren Pegel kleiner als die Mithörschwelle des Maskierers ist, und die sich im Wirkbereich dieser Schwelle befinden, können nicht wahrgenommen werden (Fastl und Zwicker, 2007). In <figref idrefs="f0024">Fig. 22</figref> ist dieser Zusammenhang verdeutlicht.</p><p id="p0018" num="0018"><figref idrefs="f0024">Fig. 22</figref> zeigt eine schematische Darstellung der frequenzabhängigen Maskierung im menschlichen Gehör. Wie zu erkennen ist, liegt der maskierte Ton unterhalb der Mithörschwelle des Maskierers und ist somit unhörbar. Dieser Effekt wird bei verlustbehafteten Audiocodierverfahren ausgenutzt. Signalanteile, die unterhalb der frequenzabhängigen Mithörschwelle liegen, werden aus dem Signal entfernt und nicht weiterverarbeitet (Zölzer, 2005).</p><p id="p0019" num="0019">Der generelle Aufbau eines typischen wahrnehmungsangepassten Encoders ist in <figref idrefs="f0025">Fig. 23</figref> dargestellt. Dabei zeigt <figref idrefs="f0025">Fig. 23</figref> ein Blockschaltbild eines psychoakustischen Audioencoders. Zunächst wird das zu codierenden PCM-Signal durch die Analysefilterbank in Frequenzbänder zerlegt und dem psychoakustischen Modell zugeführt. Darin wird durch die beschriebenen psychoakustischen Eigenschaften des Gehörs eine zeitabhängige Mithörschwelle ermittelt, welche die Genauigkeit der Quantisierung für die unterschiedlichen Frequenzbänder regelt. Dabei werden wichtige, also gut wahrnehmbare, Frequenzbänder sehr hochauflösend quantisiert und unwichtige werden mit wenigen Bits Auflösung dargestellt. Anschließend wird, wie bei der verlustfreien Audiocodierung, noch eine Entropiecodierung zur Datenreduktion durchgeführt. Da durch die Analysefilterbank und das psychoakustische Modell zusätzliche Kontrollparameter übertragen werden müssen, wird durch den Bitstrommultiplexer der eigentliche Bitstrom zusammengesetzt. Der Codiergewinn bei verlustbehafteten Audiocodern wird hier durch die Kombination aus Quantisierung und Entropiecodierung erzielt (Zölzer, 2005). Die Kopressionsrate liegt hier je nach zu erzielender Qualität zwischen 4 : 1 und 50 : 1 (Weinzierl, 2008).</p><p id="p0020" num="0020">Der Decoder ist vergleichsweise einfach aufgebaut. Zunächst wird der empfangene Bitstrom durch einen Demultiplexer wieder in Signaldaten und Kontrollparameter aufgeteilt. Danach werden eine Entropiedecodierung und eine inverse Quantisierung durchgeführt. Dabei steuern die Kontrollparameter die inverse Quantisierung der<!-- EPO <DP n="6"> --> Nutzdaten. Die so gewonnenen Teilbandsignale werden nun auf die Synthesefilterbank zur Rekonstruktion des breitbandigen PCM-Signals gegeben (Zölzer, 2005). Das dazugehörende Blockschaltbild eines psychoakustischen Audiodecoders ist in <figref idrefs="f0026">Fig. 24</figref> zu sehen.</p><p id="p0021" num="0021">Nachfolgend werden auf eine Reihe von Signaltransformationen aus dem Stand der Technik eingegangen. Da die Quantisierung in vielen Audiocodern auf einem Wahrnehmungsmodell basiert, das die Wahrnehmung des Menschen im Frequenzbereich beschreibt, ist es notwendig, das zu codierende Signal ebenfalls in den Frequenzbereich zu überführen. Dafür gibt es eine große Anzahl an Transformationen mit unterschiedlichen Charakteristiken und Anwendungsbereichen. Im Folgenden werden die für die Audiocodierung relevanten Transformationen vorgestellt und der Aufbau einer Filterbank gezeigt.</p><p id="p0022" num="0022">Die Fouriertransformation ist das bedeutendste Verfahren für die Analyse der harmonischen Struktur eines Signals. Sie ist Teil der Fourieranalyse und nach dem französischen Mathematiker und Physiker Jean-Baptiste-Joseph Fourier (1768 bis 1830) benannt, der diese erstmalig einführte. Bei der Fouriertransformation handelt es sich um eine Funktion zur Überführung eines Zeitsignals in seine Repräsentation im Frequenzbereich. Sie wird unter anderem genutzt, um das Verhalten von linearen, zeitinvarianten (LTI) Systemen zu beschreiben und vorhersagen zu können (Burrus und Parks, 1985). Sie spielt daher beispielsweise eine große Rolle in der Akustik und in der Charakterisierung des menschlichen Gehörs. Das grundlegende Vorgehen der Fouriertransformation ist die Zerlegung eines Zeitsignals in eine gewichtete Summe von Sinus- und Cosinusschwingungen. Für aperiodische, kontinuierliche Signale wird sie wie folgt berechnet (Bosi und Goldberg, 2003): <maths id="math0001" num="(2.1)"><math display="block"><mi>X</mi><mfenced><mi>f</mi></mfenced><mo>=</mo><munderover><mo>∫</mo><mrow><mo>-</mo><mi>∞</mi></mrow><mi>∞</mi></munderover><mi>x</mi><mfenced><mi>t</mi></mfenced><mo>⋅</mo><msup><mi mathvariant="normal">e</mi><mrow><mo>-</mo><mi mathvariant="normal">j</mi><mo>⁢</mo><mn>2</mn><mo>⁢</mo><mi mathvariant="italic">πft</mi></mrow></msup><mo>⁢</mo><mi mathvariant="normal">d</mi><mo>⁢</mo><mi>t</mi></math><img id="ib0001" file="imgb0001.tif" wi="103" he="28" img-content="math" img-format="tif"/></maths></p><p id="p0023" num="0023">Dabei ist <i>x(t)</i> das zu analysierende Signal im Zeitbereich und <i>X(f)</i> das dazu gehörende Fourierspektrum im Frequenzbereich. Es ist zu beachten, dass das Ergebnis komplex ist, obwohl ein reelles Signal transformiert wird. Mit Hilfe der Eulerschen Relation in Gleichung 2.2 lässt sich zeigen, dass dabei der Realteil von <i>X(f)</i> den Cosinustermen von x(t) und der Imaginärteil den Sinuskomponenten entspricht. Mit Hilfe von:<!-- EPO <DP n="7"> --> <maths id="math0002" num="(2.2)"><math display="block"><msup><mi mathvariant="normal">e</mi><mrow><mo>-</mo><mi mathvariant="normal">j</mi><mo>⁢</mo><mn>2</mn><mo>⁢</mo><mi mathvariant="italic">πft</mi></mrow></msup><mo>=</mo><mi>cos</mi><mfenced separators=""><mn>2</mn><mo>⁢</mo><mi mathvariant="italic">πft</mi></mfenced><mo>-</mo><mi>j sin</mi><mfenced separators=""><mn>2</mn><mo>⁢</mo><mi mathvariant="italic">πft</mi></mfenced></math><img id="ib0002" file="imgb0002.tif" wi="114" he="19" img-content="math" img-format="tif"/></maths><br/>
folgt aus Gleichung 2.1.: <maths id="math0003" num="(2.3)"><math display="block"><mi>X</mi><mfenced><mi>f</mi></mfenced><mo>=</mo><munderover><mo>∫</mo><mrow><mo>-</mo><mi>∞</mi></mrow><mi>∞</mi></munderover><mi>x</mi><mfenced><mi>t</mi></mfenced><mo>⋅</mo><mfenced separators=""><mi>cos</mi><mfenced separators=""><mn>2</mn><mo>⁢</mo><mi mathvariant="italic">πft</mi></mfenced><mo>-</mo><mi mathvariant="normal">j</mi><mo>⁢</mo><mi>sin</mi><mfenced separators=""><mn>2</mn><mo>⁢</mo><mi mathvariant="italic">πft</mi></mfenced></mfenced><mo>⁢</mo><mi mathvariant="normal">d</mi><mo>⁢</mo><mi>t</mi></math><img id="ib0003" file="imgb0003.tif" wi="124" he="28" img-content="math" img-format="tif"/></maths> <maths id="math0004" num="(2.4)"><math display="block"><mo>=</mo><munderover><mo>∫</mo><mrow><mo>-</mo><mi>∞</mi></mrow><mi>∞</mi></munderover><mi>x</mi><mfenced><mi>t</mi></mfenced><mo>⋅</mo><mi>cos</mi><mfenced separators=""><mn>2</mn><mo>⁢</mo><mi mathvariant="italic">πft</mi></mfenced><mo>⁢</mo><mi mathvariant="normal">d</mi><mo>⁢</mo><mi>t</mi><mo>-</mo><mi mathvariant="normal">j</mi><munderover><mo>∫</mo><mrow><mo>-</mo><mi>∞</mi></mrow><mi>∞</mi></munderover><mi>x</mi><mfenced><mi>t</mi></mfenced><mo>⋅</mo><mi>sin</mi><mfenced separators=""><mn>2</mn><mo>⁢</mo><mi mathvariant="italic">πft</mi></mfenced><mo>⁢</mo><mi mathvariant="normal">d</mi><mo>⁢</mo><mi>t</mi></math><img id="ib0004" file="imgb0004.tif" wi="130" he="28" img-content="math" img-format="tif"/></maths><br/>
und daraus: <maths id="math0005" num="(2.5)"><math display="block"><mi>X</mi><mfenced><mi>f</mi></mfenced><mo>=</mo><mi>Re</mi><mfenced open="{" close="}" separators=""><mi>X</mi><mfenced><mi>f</mi></mfenced></mfenced><mo>+</mo><mi>jIm</mi><mfenced open="{" close="}" separators=""><mi>X</mi><mfenced><mi>f</mi></mfenced></mfenced></math><img id="ib0005" file="imgb0005.tif" wi="113" he="18" img-content="math" img-format="tif"/></maths></p><p id="p0024" num="0024">Da sich Sinus und Cosinus nur in ihrer Phase voneinander unterscheiden, kann aus dem Verhältnis der entsprechenden Terme auf die Phase des Signals geschlossen werden. Es gilt: <maths id="math0006" num="(2.6)"><math display="block"><mi>X</mi><mfenced><mi>f</mi></mfenced><mo>=</mo><mfenced open="|" close="|" separators=""><mi>X</mi><mfenced><mi>f</mi></mfenced></mfenced><mo>⋅</mo><msup><mi mathvariant="normal">e</mi><mrow><mo>∫</mo><mi>φ</mi><mfenced><mi>f</mi></mfenced></mrow></msup></math><img id="ib0006" file="imgb0006.tif" wi="100" he="17" img-content="math" img-format="tif"/></maths><br/>
mit: <maths id="math0007" num="(2.7)"><math display="block"><mfenced open="|" close="|" separators=""><mi>X</mi><mfenced><mi>f</mi></mfenced></mfenced><mo>=</mo><msqrt><msup><mfenced separators=""><mi>Re</mi><mfenced open="{" close="}" separators=""><mi>X</mi><mfenced><mi>f</mi></mfenced></mfenced></mfenced><mn>2</mn></msup><mo>+</mo><msup><mfenced separators=""><mi>Im</mi><mfenced open="{" close="}" separators=""><mi>X</mi><mfenced><mi>f</mi></mfenced></mfenced></mfenced><mn>2</mn></msup></msqrt></math><img id="ib0007" file="imgb0007.tif" wi="123" he="19" img-content="math" img-format="tif"/></maths> <maths id="math0008" num="(2.8)"><math display="block"><mi>φ</mi><mfenced><mi>f</mi></mfenced><mo>=</mo><mi>arctan</mi><mfenced><mfrac><mrow><mi>Im</mi><mfenced open="{" close="}" separators=""><mi>X</mi><mfenced><mi>f</mi></mfenced></mfenced></mrow><mrow><mi>Re</mi><mfenced open="{" close="}" separators=""><mi>X</mi><mfenced><mi>f</mi></mfenced></mfenced></mrow></mfrac></mfenced></math><img id="ib0008" file="imgb0008.tif" wi="119" he="18" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="8"> --></p><p id="p0025" num="0025">Dabei wird |<i>X</i>(<i>f</i>)| als Betragsfrequenzgang und <i>ϕ</i>(<i>f</i><u>)</u> als Phasenfrequenzgang oder einfach als Phase bezeichnet.</p><p id="p0026" num="0026">Durch die inverse Fouriertransformation (Gleichung 2.9) wird das transformierte Signal wieder in seine ursprüngliche Darstellung im Zeitbereich überführt. Es ist zu beachten, dass sich die Fouriertransformation und ihre Inverse durch einen konstanten Vorfaktor und dem Vorzeichen der Exponentialfunktion unterscheiden (Burrus und Parks, 1985). <maths id="math0009" num="(2.9)"><math display="block"><mi>x</mi><mfenced><mi>t</mi></mfenced><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mo>⁢</mo><mi>π</mi></mrow></mfrac><munderover><mo>∫</mo><mrow><mo>-</mo><mi>∞</mi></mrow><mi>∞</mi></munderover><mi>X</mi><mfenced><mi>f</mi></mfenced><mo>⁢</mo><msup><mi mathvariant="normal">e</mi><mrow><mi mathvariant="normal">j</mi><mo>⁢</mo><mn>2</mn><mo>⁢</mo><mi mathvariant="italic">πft</mi></mrow></msup><mo>⁢</mo><mi mathvariant="normal">d</mi><mo>⁢</mo><mi>f</mi></math><img id="ib0009" file="imgb0009.tif" wi="107" he="26" img-content="math" img-format="tif"/></maths></p><p id="p0027" num="0027">Im Folgenden wird auf die Diskrete Fouriertransformation eingegangen.</p><p id="p0028" num="0028">In der Praxis treten bei Verwendung der Fouriertransformation in Digitalrechnern Probleme auf. Zum einen liegt das daran, dass nur endlich viele Zeitwerte verarbeitet werden können, zum anderen muss neben der Zeitvariablen auch die Frequenzvariable diskret abgetastet werden. Die Lösung dieser Probleme stellt die diskrete Fouriertransformation (DFT) dar. Mit Hilfe der DFT wird ein endliches, zeitdiskretes Signal in ein diskretes, periodisches Spektrum überführt. Sie ist damit eine der wichtigsten Transformationen in der digitalen Signalverarbeitung. Der Ursprung der DFT liegt in der Fouriertransformation, eine genaue Herleitung ist in (Lochmann, 1990) zu finden. Die DFT eines zeitdiskreten Signals x[n] der Länge N ist definiert als (Burrus und Parks, 1985): <maths id="math0010" num="(2.10)"><math display="block"><mi>X</mi><mfenced open="[" close="]"><mi>k</mi></mfenced><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover></mstyle><mi>x</mi><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>⁢</mo><msup><mi>W</mi><mi mathvariant="italic">kn</mi></msup><mo>,</mo><mo>∀</mo><mi>k</mi><mo>∈</mo><mfenced open="[" close="]" separators=""><mn>0</mn><mo>,</mo><mi>N</mi><mo>-</mo><mn>1</mn></mfenced></math><img id="ib0010" file="imgb0010.tif" wi="121" he="24" img-content="math" img-format="tif"/></maths><br/>
und analog dazu die inverse diskrete Fouriertransformation (IDFT): <maths id="math0011" num="(2.11)"><math display="block"><mi>x</mi><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover></mstyle><mi>X</mi><mfenced open="[" close="]"><mi>k</mi></mfenced><mo>⁢</mo><msup><mi>W</mi><mrow><mo>-</mo><mi mathvariant="italic">kn</mi></mrow></msup><mo>,</mo><mo>∀</mo><mi>k</mi><mo>∈</mo><mfenced open="[" close="]" separators=""><mn>0</mn><mo>,</mo><mi>N</mi><mo>-</mo><mn>1</mn></mfenced></math><img id="ib0011" file="imgb0011.tif" wi="125" he="24" img-content="math" img-format="tif"/></maths><br/>
<!-- EPO <DP n="9"> -->mit dem komplexen Drehzeiger <i>W</i>: <maths id="math0012" num="(2.12)"><math display="block"><mi>W</mi><mo>=</mo><msup><mi mathvariant="normal">e</mi><mrow><mo>-</mo><mi mathvariant="normal">j</mi><mo>⁢</mo><mfrac><mrow><mn>2</mn><mo>⁢</mo><mi>π</mi></mrow><mi>N</mi></mfrac></mrow></msup></math><img id="ib0012" file="imgb0012.tif" wi="92" he="17" img-content="math" img-format="tif"/></maths></p><p id="p0029" num="0029">Dabei ist <i>X</i>[<i>k</i>] das diskrete, periodische Spektrum von x[n] mit ∀<i>k,n</i> ∈ N. Die Periodenlänge des Spektrums entspricht der Transformationslänge N und es werden normalisierte Frequenzen im Intervall [0, 2π] abgebildet.</p><p id="p0030" num="0030">Für reelle Eingangssignale weist die DFT eine wichtige Eigenschaft auf. Es werden hier nicht wie im allgemeinen Fall N unabhängige Frequenzkoeffizienten berechnet, sondern nur halb so viele. Diese Eigenschaft kann zum Beispiel für die Speicherung oder Übertragung der Daten ausgenutzt werden. Für die Reicktransformation werden dann die zweiten <i>N</i>/<i>2</i> Werte über folgenden Zusammenhang berechnet (Rao und Yip, 2001): <maths id="math0013" num="(2.13)"><math display="block"><mi>X</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mi>N</mi><mo>-</mo><mi>k</mi></mfenced><mo>=</mo><mi>X</mi><mfenced open="[" close="]"><mi>k</mi></mfenced><mo>*</mo></math><img id="ib0013" file="imgb0013.tif" wi="99" he="15" img-content="math" img-format="tif"/></maths></p><p id="p0031" num="0031">Der Operator * kennzeichnet dabei in Formel 2.13 die komplexe Konjugation. Damit ist <i>X</i>[<i>k</i>]<i>*</i> die konjugiert-komplexe Wertefolge zu <i>X</i>[<i>k</i>].</p><p id="p0032" num="0032">Der Berechnungsaufwand der DFT und IDFT liegt bei <i>N</i><sup>2</sup> komplexen Multiplikationen und Additionen. Werden Symmetrien in der Berechnung genutzt, wird die Anzahl der benötigten Rechenschritte auf <i>N</i>l<i>dN</i> reduziert und die Komplexität entspricht O (<i>N</i> log <i>N</i>). Allerdings muss bei den schnellen Verfahren die Transformationslänge <i>N</i> einer Potenz der Zahl Zwei entsprechen. Die schnelle Fouriertransformation wird als FFT bezeichnet (Kiencke und Jäkel, 2005).</p><p id="p0033" num="0033">Die diskrete Fouriertransformation hat sich nicht im Bereich der Datenkompression durchsetzen können. Die großen Nachteile der DFT sind der hohe Rechenaufwand und die im Spektrum enthaltene Redundanz. Obwohl es in Form der FFT effiziente Verfahren zur Berechnung der DFT existieren, wird immer ein komplexes Spektrum erzeugt. Es werden also aus N Transformationswerten <i>N</i> komplexe Wertepaare berechnet. Zudem beinhalten nur die ersten <i>Nl2</i> Spektralwerte neue Information.</p><p id="p0034" num="0034">Nachfolgend wird auf die Diskrete Cosinus- und Sinustransformation eingegangen.<!-- EPO <DP n="10"> --></p><p id="p0035" num="0035">Eine Lösung der oben angesprochenen Probleme der DFT stellt die diskrete Cosinustransformation (DCT) dar. Die DCT ist eine reelle, diskrete, lineare und orthogonale Transformation. Gerade durch diese Eigenschaften ist sie die meistgenutzte Transformation in der digitalen Datenkomprimierung (Britanak u. a., 2007).</p><p id="p0036" num="0036">Die DCT ist eine diskrete trigonometrische Transformation. Insgesamt wird zwischen acht DCT-Formen unterschieden. In Abhängigkeit ihrer Randfortsetzung teilen sie sich in gerade und ungerade Transformationen sowie in die Typen I, II, III und IV auf. Für die digitale Signalverarbeitung sind aber nur die geraden Typen der DCT von Bedeutung. Diese sind im Folgenden aufgeführt (Rao und Yip, 2001): <maths id="math0014" num="(2.14a)"><math display="block"><msup><mi>X</mi><mi>I</mi></msup><mfenced open="[" close="]"><mi>k</mi></mfenced><mo>=</mo><mi>ε</mi><mfenced open="[" close="]"><mi>k</mi></mfenced><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></munderover></mstyle><mi>ε</mi><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>⁢</mo><mi>x</mi><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>⁢</mo><mi>cos</mi><mfenced><mfrac><mi mathvariant="italic">πnk</mi><mi>N</mi></mfrac></mfenced><mo>,</mo><mspace width="2em"/><mo>∀</mo><mi>k</mi><mo>∈</mo><mfenced open="[" close="]" separators=""><mn>0</mn><mo>⁢</mo><mi>N</mi></mfenced></math><img id="ib0014" file="imgb0014.tif" wi="153" he="18" img-content="math" img-format="tif"/></maths> <maths id="math0015" num="(2.14b)"><math display="block"><msup><mi>X</mi><mi mathvariant="italic">II</mi></msup><mfenced open="[" close="]"><mi>k</mi></mfenced><mo>=</mo><mi>ε</mi><mfenced open="[" close="]"><mi>k</mi></mfenced><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover></mstyle><mi>x</mi><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>⁢</mo><mi>cos</mi><mfenced><mfrac><mrow><mi mathvariant="italic">π</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn></mfenced><mo>⁢</mo><mi mathvariant="italic">k</mi></mrow><mi>N</mi></mfrac></mfenced><mo>,</mo><mspace width="3em"/><mo>∀</mo><mi>k</mi><mo>∈</mo><mfenced open="[" close="]" separators=""><mn>0</mn><mo>,</mo><mi>N</mi><mo>-</mo><mn>1</mn></mfenced></math><img id="ib0015" file="imgb0015.tif" wi="155" he="23" img-content="math" img-format="tif"/></maths> <maths id="math0016" num="(2.14c)"><math display="block"><msup><mi>X</mi><mi mathvariant="italic">III</mi></msup><mfenced open="[" close="]"><mi>k</mi></mfenced><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover></mstyle><mi>ε</mi><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>⁢</mo><mi>x</mi><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>⁢</mo><mi>cos</mi><mfenced><mfrac><mrow><mi mathvariant="italic">π</mi><mo>⁢</mo><mfenced separators=""><mi>k</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn></mfenced><mo>⁢</mo><mi mathvariant="italic">n</mi></mrow><mi>N</mi></mfrac></mfenced><mo>,</mo><mspace width="2em"/><mo>∀</mo><mi>k</mi><mo>∈</mo><mfenced open="[" close="]" separators=""><mn>0</mn><mo>,</mo><mi>N</mi><mo>-</mo><mn>1</mn></mfenced></math><img id="ib0016" file="imgb0016.tif" wi="157" he="24" img-content="math" img-format="tif"/></maths> <maths id="math0017" num="(2.14d)"><math display="block"><msup><mi>X</mi><mi mathvariant="italic">IV</mi></msup><mfenced open="[" close="]"><mi>k</mi></mfenced><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover></mstyle><mi>x</mi><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>⁢</mo><mi>cos</mi><mfenced><mfrac><mrow><mi mathvariant="italic">π</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn></mfenced><mo>⁢</mo><mfenced separators=""><mi>k</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn></mfenced></mrow><mi>N</mi></mfrac></mfenced><mo>,</mo><mspace width="3em"/><mo>∀</mo><mi>k</mi><mo>∈</mo><mfenced open="[" close="]" separators=""><mn>0</mn><mo>,</mo><mi>N</mi><mo>-</mo><mn>1</mn></mfenced></math><img id="ib0017" file="imgb0017.tif" wi="157" he="24" img-content="math" img-format="tif"/></maths><br/>
mit: <maths id="math0018" num="(2.15)"><math display="block"><mi>ε</mi><mfenced open="[" close="]"><mi>p</mi></mfenced><mo>=</mo><mrow><mo>{</mo><mtable><mtr><mtd><mfrac><mn>1</mn><msqrt><mn>2</mn></msqrt></mfrac></mtd><mtd columnalign="left"><mi>wenn</mi><mspace width="1em"/><mi>p</mi><mo>=</mo><mn>0</mn><mo>∨</mo><mi>ρ</mi><mo>=</mo><mi>N</mi></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd columnalign="left"><mi>sonst</mi></mtd></mtr></mtable></mrow></math><img id="ib0018" file="imgb0018.tif" wi="114" he="31" img-content="math" img-format="tif"/></maths></p><p id="p0037" num="0037">Jede dieser Formen hat seine eigene Anwendung in der Codierung. Die DCT-II wird primär als Transformation von Bilddaten eingesetzt. In der Literatur ist sie der erste<!-- EPO <DP n="11"> --> beschriebene Typ der DCT. Daher bezeichnet allgemein der Begriff "DCT" die DCT-II (Ahmed u. a., 1974). Die DCT-III ist bis auf einen Vorfaktor die inverse Transformation zur DCT-II und umgekehrt. Für die Audiocodierung ist die DCT-IV von besonderer Bedeutung. Sie ist Grundlage der modifizierten diskreten Cosinustransformation.</p><p id="p0038" num="0038">Um wichtige Eigenschaften der DCT aufzeigen zu können, wird im Folgenden ein Zusammenhang zwischen DFT und DCT hergestellt. Wie oben dargestellt wurde, berechnet die DFT aus einem reellwertigen Signal der Länge <i>N</i> nur <i>Nl2</i> unabhängige Frequenzkoeffizienten. Umgekehrt bedeutet dies, dass 2<i>N</i> Werte im Zeitbereich benötigt werden, um N Spektralwerte zu erhalten. Stehen aber nur <i>N</i> Zeitwerte zur Verfügung, muss das Signal auf eine geeignete Art fortgesetzt werden. Hier bietet sich die symmetrische Erweiterung durch Spiegelung des gesamten Signals an. Das erweiterte Signal scheint sich somit mit einer Periodenlänge von 2<i>N</i> zu wiederholen. Das hat den Vorteil, dass der störende Leckeffekt der DFT bei beschnittenen Signalen unterdrückt wird (Kiencke und Jäkel, 2005).</p><p id="p0039" num="0039">Ein beliebiges reelles Signal x[n] der Länge <i>N</i> wird symmetrisch erweitert, so dass gilt: <maths id="math0019" num="(2.16)"><math display="block"><mover><mi>x</mi><mo> ∼</mo></mover><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>=</mo><mfenced open="[" close="]" separators=""><mi>x</mi><mfenced open="[" close="]"><mn>0</mn></mfenced><mo>,</mo><mo>…</mo><mo>,</mo><mi>x</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mi>N</mi><mo>-</mo><mn>1</mn></mfenced><mo>,</mo><mi>x</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mi>N</mi><mo>-</mo><mn>1</mn></mfenced><mo>,</mo><mo>…</mo><mo>,</mo><mi>x</mi><mfenced open="[" close="]"><mn>0</mn></mfenced></mfenced></math><img id="ib0019" file="imgb0019.tif" wi="147" he="12" img-content="math" img-format="tif"/></maths><br/>
mit 0 ≦ n ≦ 2N - 1. Die Länge von <maths id="math0020" num=""><math display="inline"><mover><mi>x</mi><mo> ∼</mo></mover><mfenced open="[" close="]"><mi>n</mi></mfenced></math><img id="ib0020" file="imgb0020.tif" wi="13" he="8" img-content="math" img-format="tif" inline="yes"/></maths> ist damit 2<i>N</i>. Auf dieses Signal wird nun die DFT aus Gleichung 2.10 mit Gleichung 2.12 angewendet und umgeformt (Rao und Yip, 2001). Eine detaillierte Herleitung ist im Anhang A.1 zu finden. Es gilt: <maths id="math0021" num="(2.17a)"><math display="block"><mover><mi>X</mi><mo> ∼</mo></mover><mfenced open="[" close="]"><mi>k</mi></mfenced><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mn>2</mn><mo>⁢</mo><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover></mstyle><mover><mi>x</mi><mo> ∼</mo></mover><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>⁢</mo><msup><mi mathvariant="normal">e</mi><mrow><mo>-</mo><mi mathvariant="normal">j</mi><mo>⁢</mo><mfrac><mrow><mn>2</mn><mo>⁢</mo><mi>π</mi></mrow><mrow><mn>2</mn><mo>⁢</mo><mi>N</mi></mrow></mfrac><mo>⁢</mo><mi mathvariant="italic">kn</mi></mrow></msup></math><img id="ib0021" file="imgb0021.tif" wi="107" he="24" img-content="math" img-format="tif"/></maths> <maths id="math0022" num="(2.17b)"><math display="block"><mo>=</mo><mn>2</mn><mo>⁢</mo><msup><mi mathvariant="normal">e</mi><mrow><mo>-</mo><mi mathvariant="normal">j</mi><mo>⁢</mo><mfrac><mi>π</mi><mrow><mn>2</mn><mo>⁢</mo><mi>N</mi></mrow></mfrac><mo>⁢</mo><mi mathvariant="italic">k</mi></mrow></msup><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover></mstyle><mover><mi>x</mi><mo> ∼</mo></mover><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>⁢</mo><mi>cos</mi><mfenced><mfrac><mrow><mi mathvariant="italic">π</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>+</mo><mn>0.5</mn></mfenced><mo>⁢</mo><mi mathvariant="italic">k</mi></mrow><mi>N</mi></mfrac></mfenced><mo>,</mo><mo>∀</mo><mi>k</mi><mo>∈</mo><mfenced open="[" close="]" separators=""><mn>0</mn><mo>,</mo><mi>N</mi><mo>-</mo><mn>1</mn></mfenced></math><img id="ib0022" file="imgb0022.tif" wi="140" he="24" img-content="math" img-format="tif"/></maths></p><p id="p0040" num="0040">Wird dieses Ergebnis mit der DCT-II in Gleichung 2.14b verglichen, fällt auf, dass sich die zwei Gleichungen nur um den Phasenterm <maths id="math0023" num=""><math display="inline"><mn mathvariant="normal">2</mn><mo>⁢</mo><msup><mi mathvariant="normal">e</mi><mrow><mi mathvariant="normal">j</mi><mo>⁢</mo><mfrac><mi mathvariant="normal">π</mi><mrow><mn mathvariant="normal">2</mn><mo>⁢</mo><mi mathvariant="normal">N</mi></mrow></mfrac><mo>⁢</mo><mi mathvariant="normal">k</mi></mrow></msup></math><img id="ib0023" file="imgb0023.tif" wi="15" he="8" img-content="math" img-format="tif" inline="yes"/></maths> unterscheiden. Da dieser signalunabhängig ist und keine Information beinhaltet, kann er für die Berechnung der DCT vernachlässigt werden (Rao und Yip, 2001). Für die DCT-I lässt sich ein ähnlicher<!-- EPO <DP n="12"> --> Zusammenhang zeigen, nur mit einer anderen Signalfortsetzung von <i>x</i>[<i>n</i>]. Die DCT-IV ergibt sich dann aus einer Phasendrehung der Basisfunktion der DCT-II. Eine detaillierte Herleitung dazu findet sich in (Rao und Yip, 2001).</p><p id="p0041" num="0041">Aus diesem Ergebnis lassen sich nun einige Schlüsse ziehen. Zunächst fällt auf, dass die DCT im Gegensatz zur DFT eine rein reelle Transformation ist. Daraus ergeben sich zwei Vorteile. Erstens müssen keine komplexen Multiplikationen und Additionen zur Berechnung durchgeführt werden und zweitens wird zur Speicherung der Daten nur die Hälfte an Speicherplatz benötigt, da keine komplexen Wertepaare vorliegen. Des Weiteren fällt auf, dass die DCT zur Berechnung von <i>N</i> unabhängigen Frequenzkoeffizienten genau N Werte für die Transformation benötigt. Die Frequenzen liegen alle im Intervall [0, π]. Im Gegensatz zur DFT ist die für reellwertige Eingangssignale im Spektrum enthaltene Redundanz verschwunden und damit die Frequenzauflösung doppelt so hoch. Von Nachteil ist allerdings, dass sich das DCT-Spektrum nicht in Betrag und Phase umwandeln lässt. Außerdem kann es vorkommen, dass im Signal Frequenzen enthalten sind, die zwar den DCT-Basisfunktionen (vgl. Gleichung 2.14a bis 2.14d) entsprechen, aber im Verhältnis dazu in ihrer Phase um 90° gedreht sind. Diese Frequenzen werden dann nicht durch die DCT dargestellt, d.h. der betreffende DCT-Koeffizient ist Null. Aus diesen Gründen eignet sich die DCT gut zur effektiven und schnellen Datenkompression, aber weniger zur Signalanalyse (Malvar, 1992).</p><p id="p0042" num="0042">Neben der diskreten Cosinustransformation existiert noch die diskrete Sinustransformation (DST). Insgesamt werden ebenfalls acht Formen der DST unterschieden. Hier ist lediglich die DST-IV von Bedeutung. Sie entspricht in ihrer Form sowie ihren Eigenschaften der DCT-IV (Rao und Yip, 2001): <maths id="math0024" num="(2.18)"><math display="block"><msubsup><mi>X</mi><mn>5</mn><mi mathvariant="italic">IV</mi></msubsup><mfenced open="[" close="]"><mi>k</mi></mfenced><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover></mstyle><mi>x</mi><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>⁢</mo><mi>sin</mi><mfenced><mfrac><mrow><mi mathvariant="italic">π</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn></mfenced><mo>⁢</mo><mfenced separators=""><mi>k</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn></mfenced></mrow><mi>N</mi></mfrac></mfenced><mo>,</mo><mo>∀</mo><mi>k</mi><mo>∈</mo><mfenced open="[" close="]" separators=""><mn>0</mn><mo>,</mo><mi>N</mi><mo>-</mo><mn>1</mn></mfenced></math><img id="ib0024" file="imgb0024.tif" wi="151" he="19" img-content="math" img-format="tif"/></maths></p><p id="p0043" num="0043">Wird ein Signal sowohl mit der DCT-IV als auch der DST-IV transformiert, enthält das durch Kombination der beiden reellen Spektren entstandene komplexe Spektrum wieder Informationen über Betrag und Phase. Die Frequenzauflösung ist dabei immer noch doppelt so groß wie bei der DFT, es werden also <i>N</i> Frequenzen im Intervall [0, π] abgebildet (Malvar, 1992).</p><p id="p0044" num="0044">Für die Signalverarbeitung langer Audiosignale ist es nicht möglich, das Signal als Ganzes zu transformieren. Zum einen steigt dabei der Berechnungsaufwand enorm, da auch für die<!-- EPO <DP n="13"> --> Berechnung der DCT <i>N</i><sup>2</sup> Rechenoperationen benötigt werden. Zum anderen ist es nicht möglich, das Signal in Echtzeit zu verarbeiten, da immer auf die Übertragung des gesamten Datenstroms gewartet werden muss, bis das Signal rekonstruiert werden kann. Folglich ist es notwendig, das Signal in Blöcke zu unterteilen. In diesem Fall wird die DCT als sogenannte Blocktransformation angewendet (Rao und Yip, 2001). Mit dem Blockindex b ∈ N ergibt sich für die DCT-IV aus Gleichung 2.14d: <maths id="math0025" num="(2.19)"><math display="block"><msubsup><mi>X</mi><mi>b</mi><mi mathvariant="italic">IV</mi></msubsup><mfenced open="[" close="]"><mi>k</mi></mfenced><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover></mstyle><mi>x</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mi>n</mi><mo>+</mo><mi mathvariant="italic">bN</mi></mfenced><mo>⁢</mo><mi>cos</mi><mfenced><mfrac><mrow><mi mathvariant="italic">π</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn></mfenced><mo>⁢</mo><mfenced separators=""><mi>k</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn></mfenced></mrow><mi>N</mi></mfrac></mfenced><mo>,</mo><mo>∀</mo><mi>k</mi><mo>∈</mo><mfenced open="[" close="]" separators=""><mn>0</mn><mo>,</mo><mi>N</mi><mo>-</mo><mn>1</mn></mfenced></math><img id="ib0025" file="imgb0025.tif" wi="156" he="26" img-content="math" img-format="tif"/></maths></p><p id="p0045" num="0045">Die Signallänge von x[n] entspricht hier <i>bN.</i> Bei Blocktransformationen treten durch die Quantisierung Blockartefakte auf. Ein bekanntes Beispiel, bei dem solche Artefakte zu erkennen sind, ist das JPEG-Kompressionsverfahren. Der Ursprung der Blockartefakte liegt in den zur Periodisierung durchzuführenden Randfortsetzungen. Sie entsprechen nicht den ursprünglich angenommenen Signalfortsetzungen (vgl. Gleichung 2.16). Das Resultat sind Sprungstellen an den Blockgrenzen, die im Frequenzbereich die Energie zu hohen Frequenzen hin verschieben (Malvar, 1992). Sprungstellen in einem Audiosignal sind als Knacken wahrnehmbar. Für solche Artefakte ist das menschliche Gehör sehr empfindlich. Sie müssen daher unbedingt vermieden werden.</p><p id="p0046" num="0046">Nachfolgend wird die modifizierte diskrete Cosinustransformation erläutert.</p><p id="p0047" num="0047">Die modifizierte diskrete Cosinustransformation (MDCT) ist die zentrale Transformation für die Audiokompression. Sie wird unter anderem bei mp3, AAC und Dolby Digital (ac-3) eingesetzt. Die MDCT ist eine reelle, diskrete, lineare und orthogonale Transformation und eine Modifikation der DCT-IV. Sie ist wie folgt definiert (Rao und Yip, 2001): <maths id="math0026" num="(2.20)"><math display="block"><msub><mi>X</mi><mi>b</mi></msub><mfenced open="[" close="]"><mi>k</mi></mfenced><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mn>2</mn><mo>⁢</mo><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover></mstyle><mi>x</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mi>n</mi><mo>+</mo><mi mathvariant="italic">bN</mi></mfenced><mo>⁢</mo><mi>cos</mi><mfenced><mfrac><mrow><mi mathvariant="italic">π</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn><mo>-</mo><mfrac><mi>N</mi><mn>2</mn></mfrac></mfenced><mo>⁢</mo><mfenced separators=""><mi>k</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn></mfenced></mrow><mi>N</mi></mfrac></mfenced><mo>,</mo><mo>∀</mo><mi>k</mi><mo>∈</mo><mfenced open="[" close="]" separators=""><mn>0</mn><mo>,</mo><mi>N</mi><mo>-</mo><mn>1</mn></mfenced></math><img id="ib0026" file="imgb0026.tif" wi="156" he="23" img-content="math" img-format="tif"/></maths></p><p id="p0048" num="0048">Ein Vorteil der MDCT gegenüber der DCT-IV liegt in der Vermeidung von Blockartefakten. Dies wird in erster Linie durch die Überlappung mehrerer aufeinanderfolgender Blöcke erreicht. Diese Art der Transformation ist auch als Lapped Orthogonal Transform (LOT) bekannt (Malvar und Staelin, 1989).<!-- EPO <DP n="14"> --></p><p id="p0049" num="0049">Die Redundanz kann durch das Overlap-Add (OLA) Verfahren wieder entfernt werden. Dabei werden bei der inversen Transformation die entstehenden Blöcke zu 50% überlagert und aufaddiert, dieses Vorgehen wird als Overlap-Add bezeichnet.</p><p id="p0050" num="0050">Die Frequenzauflösung der MDCT kann durch die Gewichtung der Eingangsfolge <i>x</i>[<i>n</i> + <i>bN</i>] mit einer Fensterfunktion weiter verbessert werden. In Gleichung 2.20 entspricht das Fenster einer Rechteckfunktion, die den aktuellen Block <i>b</i> aus dem Gesamtsignal herausschneidet. Im Frequenzbereich entspricht dies einer Faltung mit der si-Funktion. Durch Anpassen dieser Fensterfunktion kann die schlechte Sperrbanddämpfung der si-Funktion verbessert und so eine erhöhte Frequenzselektivität erreicht werden. Damit die MDCT weiterhin perfekt rekonstruiert, muss die Fensterfunktion w[<i>n</i>] der Länge 2<i>N</i> den Princen-Bradley-Bedingungen (PR-Bedingungen) genügen (Princen u. a.,1987): <maths id="math0027" num="(2.21a)"><math display="block"><mi>w</mi><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>=</mo><mi>w</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mn>2</mn><mo>⁢</mo><mi>N</mi><mo>-</mo><mn>1</mn><mo>-</mo><mi>n</mi></mfenced></math><img id="ib0027" file="imgb0027.tif" wi="100" he="9" img-content="math" img-format="tif"/></maths> <maths id="math0028" num="(2.21b)"><math display="block"><msup><mi>w</mi><mn>2</mn></msup><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>+</mo><msup><mi>w</mi><mn>2</mn></msup><mo>⁢</mo><mfenced open="[" close="]" separators=""><mi>n</mi><mo>+</mo><mi>N</mi></mfenced><mo>=</mo><mn>1</mn></math><img id="ib0028" file="imgb0028.tif" wi="103" he="12" img-content="math" img-format="tif"/></maths></p><p id="p0051" num="0051">Ein einfaches Fenster, das diesen Bedingungen genügt und ausreichend Sperrbanddämpfung besitzt, ist das Sinushalbwellenfenster. Es wird unter anderem bei mp3 und AAC eingesetzt und ist wie folgt definiert (Malvar, 1992): <maths id="math0029" num="(2.22)"><math display="block"><mi>w</mi><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>=</mo><mi>sin</mi><mfenced><mfrac><mrow><mi>π</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn></mfenced></mrow><mrow><mn>2</mn><mo>⁢</mo><mi>N</mi></mrow></mfrac></mfenced><mo>,</mo><mo>∀</mo><mi>n</mi><mo>∈</mo><mfenced open="[" close="]" separators=""><mn>0</mn><mo>,</mo><mn>2</mn><mo>⁢</mo><mi>N</mi><mo>-</mo><mn>1</mn></mfenced></math><img id="ib0029" file="imgb0029.tif" wi="125" he="17" img-content="math" img-format="tif"/></maths></p><p id="p0052" num="0052">Durch Einsetzen der Fensterfunktion w [2<i>N</i> - 1 - <i>n</i>] in Gleichung 2.20 ist eine weitere wichtige Eigenschaft der MDCT zu erkennen. Das Ergebnis entspricht der diskreten Faltung von <i>x</i>[<i>n</i> + <i>bN</i>] mit der modulierten Fensterfunktion <i>w</i>[<i>n</i>]. Damit gilt für ∀<i>k</i>∈ [0, N - 1] (Schuller und Smith, 1996): <maths id="math0030" num="(2.23)"><math display="block"><msub><mi>X</mi><mi>k</mi></msub><mfenced open="[" close="]"><mi>b</mi></mfenced><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mn>2</mn><mo>⁢</mo><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover></mstyle><mi>x</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mi>n</mi><mo>+</mo><mi mathvariant="italic">bN</mi></mfenced><mo>⁢</mo><mi>w</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mn>2</mn><mo>⁢</mo><mi>N</mi><mo>-</mo><mn>1</mn><mo>-</mo><mi>n</mi></mfenced><mo>⁢</mo><mi>cos</mi><mfenced><mfrac><mrow><mi mathvariant="italic">π</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn><mo>-</mo><mfrac><mi>N</mi><mn>2</mn></mfrac></mfenced><mo>⁢</mo><mfenced separators=""><mi>k</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn></mfenced></mrow><mi>N</mi></mfrac></mfenced></math><img id="ib0030" file="imgb0030.tif" wi="157" he="24" img-content="math" img-format="tif"/></maths></p><p id="p0053" num="0053">So kann die MDCT nicht nur als Blocktransformation, sondern auch als modulierte<!-- EPO <DP n="15"> --> Filterbank gesehen werden (Malvar, 1992). Dabei entspricht die Fensterfunktion dem Tiefpassprototyp-FIR-Filter, das mit dem Cosinus-Kernel moduliert wird und damit die Frequenzbänder der Filterbank darstellt. Daraus folgt, dass die Eingangsfolge <i>x</i>[<i>n</i> + <i>bN</i>] in genau <i>N</i> Subbänder zerlegt wird. In Zusammenhang mit der TDA-Eigenschaft erfüllt die MDCT die Voraussetzungen einer sogenannten "critically sampled Filterbank".</p><p id="p0054" num="0054">Eine solche critically sampled Filterbank ist in <figref idrefs="f0027">Fig. 25</figref> zu sehen. Im Speziellen zeigt <figref idrefs="f0027">Fig. 25</figref> eine <i>N</i>-Band critically sampled PR Filterbank mit einem Systemdelay von n<sub>d</sub> Samples. Für die Audiocodierung sind solche Filterbänke besonders wichtig, da sie ein Signal mit der geringsten Anzahl an Samples möglichst genau und komplett beschreiben (Rao und Yip, 2001).</p><p id="p0055" num="0055">Das Symbol ↓<i>N</i> entspricht einer Verringerung der Abtastrate um den Faktor 1/N und ↑<i>N</i> einer Vergrößerung um den Faktor <i>N</i>. Das Signal nach der Synthese-Filterbank <maths id="math0031" num=""><math display="inline"><mover><mi>x</mi><mo>^</mo></mover><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>=</mo><mi>x</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mi>n</mi><mo>-</mo><msub><mi>n</mi><mi>d</mi></msub></mfenced></math><img id="ib0031" file="imgb0031.tif" wi="37" he="8" img-content="math" img-format="tif" inline="yes"/></maths> ist mit dem Eingangssignal <i>x</i>[<i>n</i>] vor der Analyse-Filterbank bis auf ein konstantes Delay von n<sub>d</sub> Samples identisch. <i>h<sub>k</sub></i>[<i>n</i>] ist im Fall der MDCT die modulierte Fensterfunktion <i>w<sub>k</sub></i>[<i>n</i>]. Da W[<i>n</i>]den PR-Bedingungen genügt, sind die Analysefilter h<sub>k</sub> identisch zu den Synthesefiltern g<sub>k</sub>.</p><p id="p0056" num="0056">Aus mathematischer Sicht bietet es sich an, lineare Gleichungssysteme, darunter alle bisher genannten Transformationen, in der Vektor-Matrix-Schreibweise zu formulieren. Ein Signal <i>x</i>[<i>n</i>] der Länge <i>bN</i> wird als Spaltenvektor <maths id="math0032" num=""><math display="inline"><munder><mi mathvariant="bold">x</mi><mo>̲</mo></munder><mo>=</mo><msup><mfenced open="[" close="]" separators=""><mi>x</mi><mfenced open="[" close="]"><mn>0</mn></mfenced><mo>,</mo><mi>x</mi><mfenced open="[" close="]"><mn>1</mn></mfenced><mo>,</mo><mo>…</mo><mo>,</mo><mi>x</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mi mathvariant="italic">bN</mi><mo>-</mo><mn>1</mn></mfenced></mfenced><mi mathvariant="normal">T</mi></msup></math><img id="ib0032" file="imgb0032.tif" wi="60" he="8" img-content="math" img-format="tif" inline="yes"/></maths> angegeben. Der Operator <sup>T</sup> kennzeichnet dabei die Transposition. Die Blockbildung lässt sich als Matrix darstellen, in der jede Spalte der Matrix einen Block von x[n] enthält: <maths id="math0033" num="(2.24)"><math display="block"><munder><mi mathvariant="bold">x</mi><mo>∼</mo></munder><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><mi mathvariant="normal">x</mi><mfenced open="[" close="]"><mn mathvariant="normal">0</mn></mfenced></mtd><mtd><mi>x</mi><mfenced open="[" close="]"><mi>N</mi></mfenced></mtd><mtd><mo>…</mo></mtd><mtd><mi>x</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mfenced separators=""><mi mathvariant="italic">b</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><mi>N</mi></mfenced></mtd></mtr><mtr><mtd><mi mathvariant="normal">x</mi><mfenced open="[" close="]"><mn>1</mn></mfenced></mtd><mtd><mi>x</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mi>N</mi><mo>+</mo><mn>1</mn></mfenced></mtd><mtd><mo>…</mo></mtd><mtd><mi>x</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mfenced separators=""><mi mathvariant="italic">b</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><mi>N</mi><mo>+</mo><mn>1</mn></mfenced></mtd></mtr><mtr><mtd><mo>⋮</mo></mtd><mtd><mo>⋱</mo></mtd><mtd><mo>…</mo></mtd><mtd><mo>⋮</mo></mtd></mtr><mtr><mtd><mi>x</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mi>N</mi><mo>-</mo><mn>1</mn></mfenced></mtd><mtd><mi>x</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mi>N</mi><mo>-</mo><mn>1</mn></mfenced></mtd><mtd><mo>…</mo></mtd><mtd><mi>x</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mi mathvariant="italic">bN</mi><mo>-</mo><mn>1</mn></mfenced></mtd></mtr></mtable></mfenced></math><img id="ib0033" file="imgb0033.tif" wi="132" he="40" img-content="math" img-format="tif"/></maths></p><p id="p0057" num="0057">Die Transformationsvorschrift kann ebenfalls als Matrix dargestellt werden. Die modulierten Fensterfunktionen bilden hier die Zeilen der Matrix. Es gilt für <i>∀ k ∈</i> [0, N-1], ∀<i>n</i> ∈ [0, 2<i>N</i> -1] :<!-- EPO <DP n="16"> --> <maths id="math0034" num="(2.25)"><math display="block"><msub><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mi mathvariant="italic">MDCT</mi></msub><mfenced separators=""><mi>k</mi><mo>⁢</mo><mi>n</mi></mfenced><mo>:</mo><mo>=</mo><mi>w</mi><mfenced open="[" close="]"><mi mathvariant="italic">n</mi></mfenced><mo>⁢</mo><mi>cos</mi><mfenced><mfrac><mrow><mi mathvariant="italic">π</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn><mo>-</mo><mfrac><mi>N</mi><mn>2</mn></mfrac></mfenced><mo>⁢</mo><mfenced separators=""><mi>k</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn></mfenced></mrow><mi>N</mi></mfrac></mfenced><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>N</mi><mo>×</mo><mn>2</mn><mo>⁢</mo><mi>N</mi></mrow></msup></math><img id="ib0034" file="imgb0034.tif" wi="150" he="19" img-content="math" img-format="tif"/></maths></p><p id="p0058" num="0058">Um die MDCT von <sup><u>X</u></sup> berechnen zu können, muss die Blockstruktur von <maths id="math0035" num=""><math display="inline"><munder><mi mathvariant="bold">x</mi><mo> ∼</mo></munder></math><img id="ib0035" file="imgb0035.tif" wi="7" he="9" img-content="math" img-format="tif" inline="yes"/></maths> noch um 50% Overlap für das TDA erweitert werden. Damit kann die MDCT geschrieben werden als: <maths id="math0036" num="(2.26)"><math display="block"><munder><mi mathvariant="bold">X</mi><mo>∼</mo></munder><mo>=</mo><msub><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mi mathvariant="italic">MDCT</mi></msub><mo>⋅</mo><msub><munder><mi mathvariant="bold">x</mi><mo>∼</mo></munder><mi mathvariant="italic">TDA</mi></msub></math><img id="ib0036" file="imgb0036.tif" wi="98" he="17" img-content="math" img-format="tif"/></maths><br/>
mit: <maths id="math0037" num="(2.27)"><math display="block"><msub><munder><mi mathvariant="bold">x</mi><mo>∼</mo></munder><mi mathvariant="italic">TDA</mi></msub><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><mi mathvariant="normal">x</mi><mfenced open="[" close="]"><mn mathvariant="normal">0</mn></mfenced></mtd><mtd><mi>x</mi><mfenced open="[" close="]"><mi>N</mi></mfenced></mtd><mtd><mo>…</mo></mtd><mtd><mi>x</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mfenced separators=""><mi mathvariant="italic">b</mi><mo>-</mo><mn>2</mn></mfenced><mo>⁢</mo><mi>N</mi></mfenced></mtd></mtr><mtr><mtd><mi mathvariant="normal">x</mi><mfenced open="[" close="]"><mn>1</mn></mfenced></mtd><mtd><mi>x</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mi>N</mi><mo>+</mo><mn>1</mn></mfenced></mtd><mtd><mo>…</mo></mtd><mtd><mi>x</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mfenced separators=""><mi mathvariant="italic">b</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><mi>N</mi><mo>+</mo><mn>1</mn></mfenced></mtd></mtr><mtr><mtd><mo>⋮</mo></mtd><mtd><mo>⋮</mo></mtd><mtd><mo>⋱</mo></mtd><mtd><mo>⋮</mo></mtd></mtr><mtr><mtd><mi>x</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mn>2</mn><mo>⁢</mo><mi>N</mi><mo>-</mo><mn>1</mn></mfenced></mtd><mtd><mi>x</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mn>3</mn><mo>⁢</mo><mi>N</mi><mo>-</mo><mn>1</mn></mfenced></mtd><mtd><mo>…</mo></mtd><mtd><mi>x</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mi mathvariant="italic">bN</mi><mo>-</mo><mn>1</mn></mfenced></mtd></mtr></mtable></mfenced></math><img id="ib0037" file="imgb0037.tif" wi="140" he="40" img-content="math" img-format="tif"/></maths></p><p id="p0059" num="0059">Jede Spalte von <maths id="math0038" num=""><math display="inline"><munder><mi mathvariant="bold">x</mi><mo> ∼</mo></munder></math><img id="ib0038" file="imgb0038.tif" wi="7" he="8" img-content="math" img-format="tif" inline="yes"/></maths> bildet das MDCT-Spektrum des betreffenden Blocks mit Index <i>b</i> in <sup><u>X</u></sup>.</p><p id="p0060" num="0060">Für die Berechnung eines Blocks benötigt diese Form der MDCT 2N<sup>2</sup> Multiplikationen und Additionen. Der Berechnungsaufwand kann aber deutlich reduziert werden.</p><p id="p0061" num="0061">Dazu ist es notwendig, die Filterbank in <figref idrefs="f0027">Fig. 25</figref> in eine äquivalente Polyphasenfilterbank (siehe <figref idrefs="f0028">Fig. 26</figref>) zu überführen. Mithilfe der Polyphasendarstellung und der z-Transformation lassen sich Multiratensysteme wie die MDCT-Filterbank umfangreicher analysieren.</p><p id="p0062" num="0062">Ein FIR-Filter <i>h</i>[<i>n</i>] kann immer in <sup>M ∈ N</sup> Phasen geteilt werden, wenn die Länge des Filters einem ganzzahligen Vielfachen von <i>M</i> entspricht. Die <i>m-</i>te Phase p<sub>m</sub>[n] von h[n] wird erzeugt, indem <i>h</i>[<i>n</i>] mit z<sup>-m</sup> verzögert und die Abtastrate um den Faktor <i>M</i> verringert wird (Malvar, 1992). Es gilt:<!-- EPO <DP n="17"> --> <maths id="math0039" num="(2.28)"><math display="block"><msub><mi>p</mi><mi>m</mi></msub><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>=</mo><mi>h</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mi mathvariant="italic">nM</mi><mo>+</mo><mi>m</mi></mfenced></math><img id="ib0039" file="imgb0039.tif" wi="100" he="17" img-content="math" img-format="tif"/></maths></p><p id="p0063" num="0063">Mit dieser Zerlegung und der z-Transformation lässt sich das Filter h[n] wie folgt darstellen (Malvar, 1992): <maths id="math0040" num="(2.29)"><math display="block"><mi>H</mi><mfenced open="[" close="]"><mi>z</mi></mfenced><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi mathvariant="italic">MN</mi><mo>-</mo><mn>1</mn></mrow></munderover></mstyle><mi>h</mi><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mi>n</mi></mrow></msup></math><img id="ib0040" file="imgb0040.tif" wi="103" he="24" img-content="math" img-format="tif"/></maths> <maths id="math0041" num="(2.30)"><math display="block"><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi mathvariant="italic">M</mi><mo>-</mo><mn>1</mn></mrow></munderover></mstyle><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mi>m</mi></mrow></msup><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi mathvariant="italic">N</mi><mo>-</mo><mn>1</mn></mrow></munderover></mstyle><mi>h</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mi mathvariant="italic">nM</mi><mo>+</mo><mi>m</mi></mfenced><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mi mathvariant="italic">nM</mi></mrow></msup></math><img id="ib0041" file="imgb0041.tif" wi="111" he="24" img-content="math" img-format="tif"/></maths></p><p id="p0064" num="0064">Anstelle der Summenschreibweise wird auch hier die Vektorschreibweise bevorzugt. Gleichung 2.30 lässt sich damit als N-dimensionaler Vektor darstellen: <maths id="math0042" num="(2.31)"><math display="block"><munder><mi mathvariant="bold">H</mi><mo>̲</mo></munder><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><msub><mi>H</mi><mn>0</mn></msub><mfenced open="[" close="]"><mi mathvariant="normal">z</mi></mfenced></mtd></mtr><mtr><mtd><msub><mi>H</mi><mn>1</mn></msub><mfenced open="[" close="]"><mi mathvariant="normal">z</mi></mfenced></mtd></mtr><mtr><mtd><mo>⋮</mo></mtd></mtr><mtr><mtd><msub><mi>H</mi><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></msub><mfenced open="[" close="]"><mi mathvariant="normal">z</mi></mfenced></mtd></mtr></mtable></mfenced></math><img id="ib0042" file="imgb0042.tif" wi="97" he="40" img-content="math" img-format="tif"/></maths><br/>
mit: <maths id="math0043" num="(2.32)"><math display="block"><mo>=</mo><msub><mi>H</mi><mi>n</mi></msub><mfenced open="[" close="]"><mi mathvariant="normal">z</mi></mfenced><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>M</mi><mo>-</mo><mn>1</mn></mrow></munderover></mstyle><mi>h</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><mi mathvariant="italic">nM</mi><mo>+</mo><mi>m</mi></mfenced><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mi mathvariant="italic">nM</mi><mo>-</mo><mi>m</mi></mrow></msup></math><img id="ib0043" file="imgb0043.tif" wi="114" he="24" img-content="math" img-format="tif"/></maths></p><p id="p0065" num="0065">Diese Polyphasenzerlegung kann nun auf jedes Filter der MDCT-Filterbank angewendet werden. Das Ergebnis ist die schon erwähnte äquivalente Polyphasendarstellung der Filterbank in <figref idrefs="f0028">Fig. 26</figref> (Schuller und Smith, 1996). Dabei stellt <figref idrefs="f0028">Fig. 26</figref> eine äquivalente <i>N-</i>Band critically sampled PR Polyphasenfilterbank dar.</p><p id="p0066" num="0066">Durch Ausnutzung von Symmetrien im MDCT-Kernel und der TDA-Eigenschaft lassen<!-- EPO <DP n="18"> --> sich die Analyse- und Synthesepolyphasenfiltermatrizen <maths id="math0044" num=""><math display="inline"><msub><munder><mi mathvariant="bold">P</mi><mo> ∼</mo></munder><mi>α</mi></msub></math><img id="ib0044" file="imgb0044.tif" wi="9" he="8" img-content="math" img-format="tif" inline="yes"/></maths> und <maths id="math0045" num=""><math display="inline"><msub><munder><mi mathvariant="bold">P</mi><mo> ∼</mo></munder><mi>s</mi></msub></math><img id="ib0045" file="imgb0045.tif" wi="8" he="9" img-content="math" img-format="tif" inline="yes"/></maths>in je eine schwachbesetzte Foldingmatrix und eine Transformationsmatrix aufteilen (Schuller und Smith, 1996). Die Foldingmatrizen <maths id="math0046" num=""><math display="inline"><msub><munder><mi mathvariant="bold">F</mi><mo> ∼</mo></munder><mi>α</mi></msub></math><img id="ib0046" file="imgb0046.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> und <maths id="math0047" num=""><math display="inline"><msub><munder><mi mathvariant="bold">F</mi><mo> ∼</mo></munder><mi>s</mi></msub></math><img id="ib0047" file="imgb0047.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> haben dabei eine Diamantstruktur mit den Koeffizienten der Fensterfunktion w[n] als Polynome im z-Bereich. Sie lassen sich weiter in eine Fenstermatrix und eine Delaymatrix zerlegen: <maths id="math0048" num="(2.33a)"><math display="block"><msub><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mi>α</mi></msub><mo>=</mo><munder><mi mathvariant="bold">D</mi><mo>∼</mo></munder><mo>⋅</mo><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder></math><img id="ib0048" file="imgb0048.tif" wi="91" he="17" img-content="math" img-format="tif"/></maths> <maths id="math0049" num="(2.33b)"><math display="block"><msub><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mi mathvariant="bold">s</mi></msub><mo>=</mo><msup><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mi mathvariant="bold">T</mi></msup><mo>⋅</mo><msup><munder><mi mathvariant="bold">D</mi><mo>∼</mo></munder><mrow><mo>-</mo><mn>1</mn></mrow></msup></math><img id="ib0049" file="imgb0049.tif" wi="95" he="18" img-content="math" img-format="tif"/></maths></p><p id="p0067" num="0067">Die genaue Form und die Aufspaltung der Foldingmatrizen wird weiter unten gezeigt. Die Transformationsmatrizen entsprechen der DCT-IV Matrix: <maths id="math0050" num="(2.34a)"><math display="block"><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mfenced separators=""><mi>k</mi><mo>⁢</mo><mi>n</mi></mfenced><mo>:</mo><mo>=</mo><mi>cos</mi><mfenced><mfrac><mrow><mi mathvariant="italic">π</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn></mfenced><mo>⁢</mo><mfenced separators=""><mi>k</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn></mfenced></mrow><mi>N</mi></mfrac></mfenced><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>N</mi><mo>×</mo><mi>N</mi></mrow></msup></math><img id="ib0050" file="imgb0050.tif" wi="130" he="21" img-content="math" img-format="tif"/></maths> <maths id="math0051" num="(2.34b)"><math display="block"><msup><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>=</mo><mfrac><mn>2</mn><mi>N</mi></mfrac><mo>⋅</mo><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder></math><img id="ib0051" file="imgb0051.tif" wi="93" he="23" img-content="math" img-format="tif"/></maths></p><p id="p0068" num="0068">Mit diesen Matrizen wird das MDCT-Spektrum des in Blöcke aufgeteilten Eingangssignals <maths id="math0052" num=""><math display="inline"><munder><mi mathvariant="bold">x</mi><mo> ∼</mo></munder></math><img id="ib0052" file="imgb0052.tif" wi="7" he="8" img-content="math" img-format="tif" inline="yes"/></maths> folgendermaßen berechnet (Schuller und Smith, 1996): <maths id="math0053" num="(2.35)"><math display="block"><munder><mi mathvariant="bold">X</mi><mo>∼</mo></munder><mo>=</mo><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⋅</mo><munder><mi mathvariant="bold">D</mi><mo>∼</mo></munder><mo>⋅</mo><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mo>⋅</mo><munder><mi mathvariant="bold">x</mi><mo>∼</mo></munder></math><img id="ib0053" file="imgb0053.tif" wi="95" he="15" img-content="math" img-format="tif"/></maths><br/>
und für die inverse Transformation gilt: <maths id="math0054" num="(2.36)"><math display="block"><mover><munder><mi mathvariant="bold">x</mi><mo>∼</mo></munder><mo>^</mo></mover><mo>=</mo><msup><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mi mathvariant="normal">T</mi></msup><mo>⋅</mo><msup><munder><mi mathvariant="bold">D</mi><mo>∼</mo></munder><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⋅</mo><msup><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⋅</mo><munder><mi mathvariant="bold">X</mi><mo>∼</mo></munder></math><img id="ib0054" file="imgb0054.tif" wi="102" he="17" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="19"> --></p><p id="p0069" num="0069">Diese Lösung biete einige Vorteile gegenüber der Berechnung der MDCT nach Gleichung 2.26. Zunächst ist die Entstehung des Time Domain Aliasing leichter zu erkennen. Mit der Polyphasendarstellung der Foldingmatrix in Gleichung 2.33a kann der Vorgang als Umklappen gewichteter Signalanteile des Blocks <i>(b -</i> 1) auf den aktuellen Block b interpretiert werden. Durch die Addition dieser Signalanteile entsteht das TDA. Der größte Vorteil der Berechnung der MDCT über Polyphasen ist der deutlich reduzierte Berechnungsaufwand. Durch die Verwendung der quadratischen DCT-IV Matrix und der schwachbesetzten Foldingmatrix reduziert sich der Berechnungsaufwand auf <i>N(N</i> + 2) Multiplikationen und Additionen. Durch Verwendung schneller Implementierungen der DCT ähnlich der FFT kann die Anzahl der benötigten Operationen bis auf N(log<i>N</i> + 2) und damit die Komplexität auf O (N log N) gesenkt werden (Rao und Yip, 2001). Aus diesen Gründen wird die MDCT hier als nach dem Polyphasenansatz implementiert angesehen.</p><p id="p0070" num="0070">Im Rahmen der Audiosignalverarbeitung kann es notwendig sein, ein Signal einer geringen Frequenz in höhere Frequenzen zu verschieben, wobei diese Frequenzverschiebung frei wählbar und präzise sein soll. Dieses Problem stellt sich für Audiocoder, die die höheren Frequenzen eines Signals wiederherstellen wollen. Moderne Audiocodiertechnologien verwenden Verfahren der Bandbreitenerweiterung zur effizienteren Komprimierung von Audiodaten. Neben den psychoakustischen Eigenschaften des menschlichen Gehörs wird die Korrelation der niederfrequenten Signalanteile zu den hochfrequenten Anteilen zur Datenreduktion ausgenutzt.</p><p id="p0071" num="0071">Trotz zahlreicher Möglichkeiten zur Reduktion der Datenrate durch die Audiocodierung geraten aktuelle Audiocoder bei gewünschten niedrigen Bitraten an ihre Grenzen. Gerade die psychoakustischen Verfahren produzieren dann unerwünschte Verfälschungen des Signals. Das zeigt sich in Form von störenden Artefakten wie fehlenden Höhen, verschmierten Transienten oder künstlichem Zischeln des wiedergegebenen Audiosignals. In vielen Anwendungsfällen steht aber nur begrenzt Übertragungsbandbreite zur Verfügung. Eine Lösung dieser Probleme bietet die Bandbreitenerweiterung (engl. Bandwidth Extension, BWE). Generell vereint die Bandbreitenerweiterung eine Reihe von Verfahren, mit denen ein bandbegrenztes Audiosignal spektral ausgeweitet werden kann, um wieder die ursprüngliche Bandbreite zu erhalten. Insgesamt wird zwischen vier Kategorien von Verfahren zur Bandbreitenerweiterung unterschieden (Larsen und Aarts, 2004). Diese sind in <figref idrefs="f0029">Fig. 27</figref> grafisch dargestellt.</p><p id="p0072" num="0072"><figref idrefs="f0029">Fig. 27</figref> zeigt Kategorien der Bandbreitenerweiterung (Larsen und Aarts, 2004). In <figref idrefs="f0029">Fig. 27</figref>, oben links ist Low-frequency psychoacoustic BWE gezeigt. In <figref idrefs="f0029">Fig. 27</figref>, oben rechts ist High-frequency psychoakoustic BWE zu sehen. In <figref idrefs="f0029">Fig. 27</figref>, unten links ist Low-frequency<!-- EPO <DP n="20"> --> BWE dargestellt. Ferner ist in <figref idrefs="f0029">Fig. 27</figref>, unten rechts High-frequency BWE dargestellt. Die Energie des Bandes 'a' (gestrichelte Linie) wird in das Band 'b' (gepunktete Linie) geschoben.</p><p id="p0073" num="0073">Für die Audiocodierung ist nur die Kategorie III (unten rechts in <figref idrefs="f0029">Fig. 27</figref>) nützlich. Bei der sogenannten "High-frequency BWE" werden die im bandbegrenzten Signal vorhandenen Frequenzen genutzt, um den hochfrequenten Bereich des Spektrums zu rekonstruieren. Die Idee ein solches Verfahren zur Bandbreitenerweiterung von Audiosignalen zu benutzen ist darin begründet, dass zwischen dem hochfrequenten und niederfrequenten Anteil des Signals eine starke Korrelation vorliegt. Damit ist es möglich, die fehlenden hohen Frequenzen aus den vorhandenen tiefen Signalanteilen zu rekonstruieren (Larsen und Aarts, 2004). Im Folgenden werden aktuelle Techniken und Verfahren vorgestellt, womit ein bandbegrenztes Signal mittels Highfrequency BWE auf seine ursprüngliche Bandbreite erweitert werden kann.</p><p id="p0074" num="0074">Aus dem Stand der Technik ist dabei die Spektralbandreplikation (englisch: Spectral Band Replication; SBR) bekannt, wie sie unter anderem in HE-AAC eingesetzt wird. Bei der Spektralbandreplikation mit SBR werden Korrelationen zwischen nieder- und hochfrequenten Signalanteilen ausgenutzt, um das durch den Encoder bereitgestellte Tiefpasssignal spektral aufzuweiten. Die niedrigen Frequenzbänder der zugrundeliegenden Filterbank werden auf die fehlenden hohen Bänder kopiert und die spektrale Einhüllende angepasst. Dieser Kopierprozess verursacht, insbesondere bei niedrigen Grenzfrequenzen, wahrnehmbare Artefakte wie Rauigkeit und unerwünschte Klangfarbenänderung. Diese werden hauptsächlich durch die fehlende harmonische Fortsetzung des Spektrums an der Grenze zwischen Basisband und den algorithmisch erzeugten hohen Frequenzbändern hervorgerufen.</p><p id="p0075" num="0075">Ein SBR Audiocoder aus dem Stand der Technik verwendet eine pQMF Subbandzerlegung des Signals und gewährleistet auf diese Weise eine hohe Codiereffizienz [Ekstrand 2002]. Dies wird dadurch erreicht, dass lediglich die unteren Frequenzbänder übertragen werden, während die höheren Frequenzanteile unter Hilfe von Seiteninformation und der zuvor erwähnten Frequenzverschiebung der unteren Bänder rekonstruiert werden.</p><p id="p0076" num="0076">Die Spectralbandreplikation ist das zurzeit am weitesten verbreitete Verfahren zur Bandbreitenerweiterung. Es wird unter anderem in HE-AAC und mp3PRO eingesetzt. Entwickelt wurde SBR von dem Unternehmen. Coding Technologies mit dem Ziel, die Effizienz vorhandener Audiocoder zu erhöhen. Das wird erreicht, indem nur Frequenzen unterhalb einer bestimmten Eckfrequenz <i>f<sub>g</sub></i> von einem Encoder verarbeitet werden. In den<!-- EPO <DP n="21"> --> genannten Beispielen werden mp3- und AAC-Encoder als Core-Coder eingesetzt. Frequenzen, die über der Eckfrequenz liegen, werden nur durch wenige Parameter beschrieben. Je nach zu erreichender Qualität liegt diese zwischen 5kHz und 13kHz. Im Empfänger werden dann mit Hilfe dieser Seiteninformationen und dem decodierten bandbegrenzten Signal die hohen Frequenzanteile rekonstruiert (Ekstrand, 2002).</p><p id="p0077" num="0077"><figref idrefs="f0030">Fig. 28</figref> zeigt das Blockschaltbild eines erweiterten SBR-Encoders. Die Abtastrate des Eingangssignals wird herabgesetzt und anschließend dem eigentlichen Encoder zugeführt. Parallel dazu wird das Signal durch eine komplexe Quadrature-Mirror-Filterbank (QMF) analysiert und eine Energieberechnung durchgeführt. Die genutzte QMF besteht aus 64 Teilbändern. Daraus lassen sich dann die erforderlichen Parameter für die Schätzung der spektralen Einhüllenden ableiten. Weitere Parameter ermöglichen es, auf die speziellen Charakteristiken des Eingangssignals zu reagieren. Durch die Kenntnis des SBR-Encoders über die Erzeugung des hohen Frequenzbands kann dieser starke Unterschiede zwischen dem ursprünglichen und synthetisierten Hochfrequenzanteil (HF) erkennen.</p><p id="p0078" num="0078">Sind im Signal beispielsweise stark ausgeprägte Einzeltöne oberhalb der Grenzfrequenz vorhanden, so werden diese durch zusätzliche Parameter beschrieben und können dem rekonstruierten Signal wieder zugeführt werden. Die erzeugten Seiteninformationen wird neben den eigentlichen Audiodaten in den ausgehenden Bitstrom eingefügt (Larsen und Aarts, 2004).</p><p id="p0079" num="0079"><figref idrefs="f0031">Fig. 29</figref> zeigt das Blockschaltbild des zugehörigen, mit SBR erweiterten Decoders dargestellt. Die bandbegrenzten Audiodaten werden durch den Decoder decodiert und die Kontrollparameter aus dem Bitstrom extrahiert. Anschließend werden die Audiodaten zur Rekonstruktion der hohen Frequenzanteile wieder einer QMF-Filterbank zugeführt. Innerhalb dieser Filterbank wird das Basisband kopiert und oberhalb der Grenzfrequenz eingefügt (vgl. <figref idrefs="f0032">Fig. 30</figref>, links).</p><p id="p0080" num="0080"><figref idrefs="f0032">Fig. 30</figref> zeigt schematisch den Betragsfrequenzgang. Dabei ist <figref idrefs="f0032">Fig. 30</figref> eine schematische Darstellung der SBR-HF-Rekonstruktion. In <figref idrefs="f0032">Fig. 30</figref>, links ist ein Kopieren und Verschieben des Basisbands gezeigt. In <figref idrefs="f0032">Fig. 30</figref>, rechts ist ein Spektrum nach der Anpassung der spektralen Einhüllenden dargestellt.</p><p id="p0081" num="0081">Die im SBR-Encoder erzeugte Information über die spektrale Einhüllende wird nun verwendet, um die Hüllkurve des kopierten Spektrums an die ursprüngliche anzugleichen. Diese Adaption erfolgt anhand der übertragenen Kontrollparameter und der Energie des jeweiligen QMF-Bands. Weichen die Eigenschaften des rekonstruierten Spektrums von<!-- EPO <DP n="22"> --> den ursprünglichen ab, werden dem Signal zusätzlich tonale Komponenten oder Rauschen hinzugefügt (Larsen und Aarts, 2004). In <figref idrefs="f0032">Fig. 30</figref>, rechts ist das angepasste rekonstruierte Spektrum zu sehen.</p><p id="p0082" num="0082">Abschließend werden das bandbegrenzte Signal und das rekonstruierte hochfrequente Signal zusammengeführt und durch die Synthese-Filterbank in den Zeitbereich überführt. Auf diese Weise ist ein bandbreitenerweitertes Signal entstanden, das nun wiedergegeben werden kann.</p><p id="p0083" num="0083">Bei dieser Art der Bandbreitenerweiterung entstehen Probleme bei sehr tonalen Signalen mit einer stark ausgeprägten harmonischen Struktur. Auch wenn das SBR-Verfahren Techniken zur tonalen Anpassung des Spektrums vorsieht, reichen diese nicht aus, um eine zerstörte harmonische Struktur wiederherzustellen. Das Resultat ist eine wahrnehmbare Rauigkeit (engl. roughness) im Signal (Wilde, 2009). Dieses Artefakt ist für den Hörer sehr unangenehm. Der Ursprung liegt im Kopierprozess des SBR-Decoders. Hier wird keine Rücksicht auf die harmonische Feinstruktur des Signals gelegt und einfach das Basisband repliziert. Das Ergebnis ist in <figref idrefs="f0033">Fig. 31</figref> zu sehen.</p><p id="p0084" num="0084"><figref idrefs="f0033">Fig. 31</figref> zeigt eine Zerstörung der harmonischen Struktur bei SBR. In <figref idrefs="f0033">Fig. 31</figref>, links ist ein ursprüngliches Breitbandspektrum gezeigt. In <figref idrefs="f0033">Fig. 31</figref>, rechts ist ein Spektrum nach der SBR HF-Rekonstruktion gezeigt.</p><p id="p0085" num="0085">Es ist deutlich zu erkennen, dass im Bereich oberhalb der Grenzfrequenz die Harmonischen zum ursprünglichen Spektrum verschoben sind. Zwar ist das rekonstruierte HF-Spektrum in sich harmonisch, jedoch ist die harmonische Struktur bei der Grenzfrequenz um einen zusätzlichen Frequenzhub f<sub>lag</sub> gespreizt. Zudem werden durch die Rekonstruktion der Hüllkurve die Amplitudenverhältnisse der harmonischen Teiltöne verzerrt. Dieser Effekt tritt bei allen harmonischen Signalen auf, wie sie beispielsweise durch Musikinstrumente entstehen.</p><p id="p0086" num="0086">Für harmonische Signale, wie z.B. eine Pitch-Pipe erzeugt die SBR und äquivalente Bandbreitenerweiterungsverfahren dabei unerwünschte Artefakte, wie z.B. klangliche Rauheit und unschöne Klangfarben, da die harmonische Struktur des Signals nicht vollständig erhalten bleibt. Für Signale, die eine ausgeprägte harmonische Struktur aufweisen, treten bei Anwendung der SBR unerwünschte Artefakte wie Rauigkeit und Timbreänderungen auf.</p><p id="p0087" num="0087">Deshalb wurden zwei Zeitdomänen-Bandbreitenerweiterungsverfahren (englisch: Bandwidth Extension) entwickelt, die diese Strukturen erhalten: Die Phasen Vocoder-gesteuerte<!-- EPO <DP n="23"> --> harmonische Bandbreitenerweiterung (englisch: Harmonic Bandwidth Extension; HBE) und die kontinuierliche Modulation (Continuous Modulation; CM)-BWE, die einzelne Seitenband-Modulation verwendet [Nagel und Disch 2009], [Nagel u. a. 2010]. Besonders die CM-BWE erzielt eine gute harmonische Wiederherstellung wegen der kontinuierlichen Modulation mit frei wählbaren Frequenzen.</p><p id="p0088" num="0088">Es existieren einige alternative Bandbreitenerweiterungsverfahren, die das Problem der unharmonischen spektralen Fortsetzung vermeiden. Im Folgenden werden zwei dieser Verfahren vorgestellt. Im Wesentlichen ersetzen diese Verfahren den HF-Generator des SBR-Decoders in <figref idrefs="f0031">Fig. 29</figref> und stellen damit eine Alternative zum einfachen Kopierprozess dar. Die Anpassung der spektralen Einhüllenden und der Tonalität bleiben unverändert. Da das Eingangssignal im Zeitbereich vorliegen muss, werden diese Verfahren auch als Zeitbereichsverfahren zur Bandbreitenerweiterung bezeichnet.</p><p id="p0089" num="0089">Zunächst kann die Harmonische Bandbreitenerweiterung genannt werden. Die harmonische Bandbreitenerweiterung (engl. <i>Harmonic Bandwidth Extension,</i> HBE) nutzt einen Phasenvocoder zur Erzeugung des Hochtonbereichs. Durch die Anwendung eines Phasenvocoders wird das Spektrum gestreckt. Wie in <figref idrefs="f0034">Fig. 32</figref>, links dargestellt, wird das Basisband bis auf die maximale Signalfrequenz f<sub>max</sub> gespreizt und der Frequenzbereich zwischen der Grenzfrequenz und <i>f</i><sub><i>m</i>ax</sub>. ausgeschnitten. Das Spektrum setzt sich dann aus diesem Ausschnitt und dem Basisband zusammen (vgl. <figref idrefs="f0034">Fig. 32</figref>, rechts). Die Einhüllende wird, wie bei SBR, angepasst (Nagel und Disch, 2009).</p><p id="p0090" num="0090"><figref idrefs="f0034">Fig. 32</figref> ist eine schematische Darstellung der HBE-HF-Rekonstruktion. In <figref idrefs="f0034">Fig. 32</figref>, links ist eine Streckung des Basisbands um den Faktor 2 gezeigt. In <figref idrefs="f0034">Fig. 32</figref>, rechts ist ein Spektrum nach der Anpassung der spektralen Einhüllenden gezeigt.</p><p id="p0091" num="0091">Durch die Nutzung von ganzzahligen Streckungsfaktoren σ ∈ N<sup>+</sup> ist gewährleistet, dass an der Grenzfrequenz <i>f</i><sub>g</sub> die harmonische Struktur nicht verändert wird. Es gilt: <maths id="math0055" num="(3.1)"><math display="block"><msub><mi mathvariant="italic">f</mi><mi mathvariant="italic">max</mi></msub><mo>=</mo><mi>σ</mi><mo>⋅</mo><msub><mi>f</mi><mi>g</mi></msub></math><img id="ib0055" file="imgb0055.tif" wi="93" he="14" img-content="math" img-format="tif"/></maths></p><p id="p0092" num="0092">Von Nachteil ist, dass sich durch die Spreizung des Spektrums der Abstand zwischen den Teiltönen im HF-Bereich mit dem Streckungsfaktor ändert, wie in <figref idrefs="f0035">Fig. 33</figref> zu erkennen ist. Zudem sind aufwändige Berechnungen notwendig, um das Spektrum zu spreizen. Darunter fallen eine hochauflösende DFT, Anpassung der Phase und Abtastratenwandlung (Dolson,<!-- EPO <DP n="24"> --> 1986). Ist das Audiosignal in Blöcke unterteilt, wird zusätzlich eine Overlap-Add-Straktur benötigt, um die Phase der benachbarten Blöcke kontinuierlich fortsetzten zu können. Für sehr tonale Signale lassen sich mit der Phasenvocodertechnik sehr gute Ergebnisse erzielen, bei perkussiven Signalen verschmieren aber die Transienten und es wird notwendig, eine separate Transientenbehandlung vorzunehmen (Wilde, 2009).</p><p id="p0093" num="0093"><figref idrefs="f0035">Fig. 33</figref> zeigt eine harmonische Struktur bei HBE. In <figref idrefs="f0035">Fig. 33</figref>, links ist ein ursprüngliches Breitbandspektrum gezeigt. In <figref idrefs="f0035">Fig. 33</figref>, rechts ist Spektrum nach der HBE HF-Rekonstruktion dargestellt.</p><p id="p0094" num="0094">Im Folgenden wird die kontinuierliche Einseitenbandmodulation dargestellt.</p><p id="p0095" num="0095">Die kontinuierliche Einseitenbandmodulation (engl. Continuously Modulated Bandwidth Extension, CM-BWE) ist ein weiteres Zeitbereichsverfahren zur Bandbreitenerweiterung. Bei diesem Verfahren wird das Basisband mittels Einseitenbandmodulation mit der Frequenz <i>f <sub>mod</sub></i> moduliert und so an einen anderen spektralen Ort verschoben, wie in <figref idrefs="f0036">Fig. 34</figref> dargestellt. Durch eine variable Modulationsfrequenz kann gewährleistet werden, dass die harmonische Struktur des bandbreitenerweiterten Signals erhalten bleibt. Bei Modulationsfrequenzen, die größer sind als die Grenzfrequenz fg, muss die entstehende Lücke im Spektrum durch Rauschen gefüllt werden (Nagel u. a., 2010).</p><p id="p0096" num="0096"><figref idrefs="f0036">Fig. 34</figref> zeigt eine schematische Darstellung der CM-BWE-HF-Rekonstruktion. In <figref idrefs="f0036">Fig. 34</figref>, links ist eine Modulation des Basisbands mit der Frequenz <i>f <sub>mod</sub></i> dargestellt. In <figref idrefs="f0036">Fig. 34</figref>, rechts ist ein Spektrum nach der Anpassung der spektralen Einhüllenden gezeigt.</p><p id="p0097" num="0097">Neben dem in <figref idrefs="f0036">Fig. 34</figref> dargestellten Fall kann es auch notwendig werden, das Basisband mehrmals zu modulieren. In einem solchen Fall muss die Modulationsfrequenz für jede Modulation angepasst werden, in dem jeweils ihr nächstes ganzzahliges Vielfaches gewählt wird (Nagel u. a., 2010). Vor der Modulation muss das Basisband entsprechend der Modulationsfrequenz durch einen Tiefpass gefiltert werden, damit nach der Modulation die maximal mögliche Signalfrequenz <i>f<sub>max</sub></i> nicht überschritten wird. Ähnlich zu den bereits vorgestellten Verfahren wird anschließend die spektrale Einhüllende geformt und die Tonalität angepasst.</p><p id="p0098" num="0098">In <figref idrefs="f0037">Fig. 35</figref> ist die harmonische Struktur zu sehen, wie sie in einem mittels CM-BWE erweitertes Signal entsteht. In <figref idrefs="f0037">Fig. 35</figref>, links ist ein ursprüngliches Breitbandspektrum zu sehen. In <figref idrefs="f0037">Fig. 35</figref>, rechts ist ein Spektrum nach der CM-BWE HF-Rekonstruktion dargestellt. Wie bei dem HBE-Verfahren fehlt bei CM-BWE ein harmonischer Teilton im<!-- EPO <DP n="25"> --> Spektrum. Dies fällt aber nicht störend auf, da die harmonische Struktur an sich erhalten bleibt.</p><p id="p0099" num="0099">Nachteile dieses Verfahrens liegen in der Berechnung der Einseitenbandmodulation. Für eine korrekte Berechnung wird ein analytisches Signal benötigt, also ein Signal, das nur positive Frequenzen aufweist. Für die Berechnung eines solchen Signals ist ein Hilbert-Transformator erforderlich. Dabei handelt es sich im Wesentlichen um ein akausales Filter mit unendlicher Impulsantwort. Ein solches Filter lässt sich nicht realisieren und muss vereinfacht werden. Um dennoch bei einer minimalen Ordnung des Filters eine möglichst hohe Sperrbanddämpfung zu erreichen, wird dem Signal ein nicht vernachlässigbares Delay durch die Kausalisierung des Filters hinzugefügt (Wilde, 2009).</p><p id="p0100" num="0100">Wird die Frequenzverschiebung aber in der Zeitdomäne realisiert, kann sich dies sehr komplex darstellen. Die Realisierung der Verschiebung in der Subband-Domäne eines Subband-Audiocodierers kann dagegen dazu führen, dass die Frequenzauflösung zu grob für die benötigten Frequenzverschiebungen ist.</p><p id="p0101" num="0101">Wünschenswert ist, den durch die Codierung von Audiosignalen den benötigten Speicherbedarf der digitalen Daten, beziehungsweise die benötigte Bandbreite zur Übertragung dieser Daten, zu minimieren. Gleichzeitig soll die wahrgenommene Qualität des reproduzierten Audiosignals mit dem CD-Standard (Abtastfrequenz 44100 Hz bei 16 Bit Quantisierungstiefe) vergleichbar sein. Dabei soll bei sinkender Datenrate die Qualität maximiert werden.</p><p id="p0102" num="0102">Es ist daher eine Aufgabe der vorliegenden Erfindung, verbesserte Konzepte für frei wählbare Frequenzverschiebungen in der Subband-Domäne bereitzustellen. Die Aufgabe der vorliegenden Erfindung wird durch eine Vorrichtung nach Anspruch 1, durch ein Verfahren nach Anspruch 23 und durch ein Computerprogramm nach Anspruch 24 gelöst.</p><p id="p0103" num="0103">Eine Vorrichtung zur Erzeugung eines frequenzverschobenen Audiosignals basierend auf einem Audioeingangssignal wird bereitgestellt. Das Audioeingangssignal ist dabei für eine Mehrzahl von ersten Subbändern durch einen oder mehrere erste Subband-Werte darstellbar. Die Vorrichtung umfasst eine Schnittstelle und eine Frequenzverschiebungseinheit. Die Schnittstelle ist zum Empfang des Audioeingangssignals eingerichtet. Die Frequenzverschiebungseinheit ist zur Erzeugung des frequenzverschobenen Audiosignals eingerichtet, wobei das frequenzverschobene Audiosignal für eine Mehrzahl von zweiten Subbändern jeweils einen oder mehrere zweite Subband-Werte aufweist. Ferner weist jeder der ersten und der zweiten Subband-Werte Information über jeweils einen Phasenwinkel auf.<!-- EPO <DP n="26"> --></p><p id="p0104" num="0104">Die Frequenzverschiebungseinheit ist ferner dafür eingerichtet, einen der zweiten Subband-Werte basierend auf einem der ersten Subband-Werte so zu erzeugen, dass der zweite Phasenwinkel dieses zweiten Subband-Werts sich von dem ersten Phasenwinkel dieses ersten Subband-Werts um eine Phasenwinkel-Differenz unterscheiden kann, wobei die Phasenwinkel-Differenz von einer Frequenzinformation abhängt, die angibt, um welche Frequenzdifferenz das Audioeingangssignal zu verschieben ist, um das frequenzverschobene Audiosignal zu erhalten, und wobei die Phasenwinkel-Differenz von einer Frequenz-Bandbreite von einem der ersten Subbänder abhängt.</p><p id="p0105" num="0105">Ausführungsformen stellen verbesserte Konzepte zur Bandbreitenerweiterung bereit, wobei diese verbesserten Konzepte im Folgenden als "harmonische Spektralbanderweiterung" oder "HSBE" bezeichnet werden. Diese entwickelte harmonische Bandbreitenerweiterung im Frequenzbereich ermöglicht es, unerwünschte Artefakte zu unterdrücken. Das replizierte Spektrum wird dabei so moduliert, dass die ursprüngliche harmonische Struktur erhalten bleibt. HSBE kann dabei im Gegensatz zu anderen Verfahren auf der Signaldarstellung im MDCT-Bereich basieren, und erlaubt damit eine effiziente Implementierung. Die harmonisch korrekte Bandbreitenerweiterung wird durch einen Kopiervorgang der Spektralwerte mit anschließender Modulation erreicht.</p><p id="p0106" num="0106">Gemäß einer Ausführungsform wird die Subband-Domäne der MDCT verwendet, die üblicherweise bereits in Audiocodierern realisiert wird. Auf diese Weise führt die Transformation nicht zu zusätzlicher Komplexität oder Verzögerung.</p><p id="p0107" num="0107">In Ausführungformen werden, wenn das Signal um ein gerades ganzzahliges Vielfaches der Subband-Bandbreite verschoben wird, die Subband-Signale unterer Frequenzen in die entsprechenden höheren Frequenzbänder verschoben.</p><p id="p0108" num="0108">Wenn das Signal um ein ungerades ganzzahliges Vielfaches zu verschieben ist, wird in Ausführungsformen jeder zweite Abtastwert der Subband-Signale, die zu kopieren sind, mit umgekehrten Vorzeichen versehen (ansteigender Blockindex, in Richtung der Zeit). Auf diese Weise funktioniert die Aliasing-Kompensationseigenschaft (englisch: Alias Cancellation Property) der MDCT Filterbank auch noch für das Frequenz-verschobene und kopierte Signal.</p><p id="p0109" num="0109">Wenn die Signale unterer Frequenzen um ein nicht-ganzzahliges Vielfaches der Subband-Bandbreite verschoben werden, werden in Ausführungsformen komplexwertige Versionen der Subbänder unterer Frequenzen erzeugt, es wird eine Kopie von diesen genommen und diese werden mit einer komplexen Exponentialfunktion moduliert (multipliziert), wobei<!-- EPO <DP n="27"> --> diese komplexe Exponentialfunktion eine Frequenz hat, die der Differenz der Frequenz des nächsten ganzzahligen Vielfachen der Subband-Bandbreite entspricht (es liegt eine gebrochene Subband-Bandbreitenverschiebung vor). Hierdurch wird jedoch die Aliasing-Kompensationseigenschaft der MDCT Filterbank beeinträchtigt bzw. zerstört.</p><p id="p0110" num="0110">Um die resultierende Frequenzverzerrung zu verhindern oder zu reduzieren, wird ein faltungs-ähnliches Verarbeiten zwischen benachbarten Subband-Signalen durchgeführt, wobei eine gewichtete Version des einen Subband-Signals zu dem Subband-Signal einer in seiner Nachbarschaft befindlichen Subbands hinzuaddiert, so dass es das umgekehrte Vorzeichen der Aliasing-Komponente dort hat, und so dass das Aliasing kompensiert oder reduziert wird. In einer Ausführungsform werden die Gewichte dabei so gewählt, dass sie der gewünschten gebrochenen Frequenzverschiebung entsprechen.</p><p id="p0111" num="0111">Durch die Modulation des Spektrums wird also die TDAC-Eigenschaft der MDCT verletzt, so dass Aliasing-Komponenten auftreten. Um diese zu eliminieren, wird in Ausführungsformen eine FIR-Filterstruktur zur Aliasing-Cancelation bereitgestellt. Die dazu benötigten Filterimpulsantworten werden mittels sukzessiver Approximation optimiert und beispielsweise als Look-Up-Tabelle hinterlegt.</p><p id="p0112" num="0112">Für die Anwendbarkeit der hier vorgestellten Konzepte ist es nicht erforderlich, den Encodierungsprozess, also das Komprimieren der Daten beispielsweise über Anwendung eines psychoakustischen Modells anzupassen.</p><p id="p0113" num="0113">Die bereitgestellten Konzepte setzen auf bereits vorhandenen Bandbreitenerweiterungsverfahren auf und verbessern diese. Mit diesem neuen Verfahren ist es möglich, die Qualität des wiedergegebenen Audiomaterials bei gleichbleibendem Speicherbedarf zu erhöhen. Es wird dabei nicht der Encodierprozess beeinflusst, sondern der Decoder weiterentwickelt. Das entwickelte Verfahren realisiert eine harmonische Bandbreitenerweiterung. Es baut dabei auf der Spektralbandreplikation (SBR) auf, wie sie in der HE-AAC-Technologie verwendet wird.</p><p id="p0114" num="0114">Die bereitgestellten erfinderischen, effizienten Spektralbandreplikations-Konzepte erhalten die harmonische Struktur des ursprünglichen Spektrums und reduzieren somit die beschriebenen Artefakte der bekannten SBR Technologie.</p><p id="p0115" num="0115">Konzepte für die harmonischen Spektralbanderweiterung (HSBE) werden bereitgestellt. Da gerade die Effizienz eine entscheidende Rolle spielt, wird die zugrundeliegende Signalverarbeitung von der verwendeten Filterbank bis hin zur Unterdrückung von<!-- EPO <DP n="28"> --> Artefakten durch FIR-Filter beschrieben.</p><p id="p0116" num="0116">Die hier vorgestellte harmonische Spektralbanderweiterung schafft eine leistungsfähige und effiziente Möglichkeit, das bandbegrenzte Spektrum eines Audiosignals unter Fortsetzung der harmonischen Struktur zu erweitern.</p><p id="p0117" num="0117">Es wird gezeigt, dass bei der harmonischen Spektralbanderweiterung zahlreiche Problemstellungen zu beachten sind, damit das Spektrum korrekt harmonisch fortgesetzt werden kann. Auch wenn schon einige Verfahren zur Rekonstruktion der harmonischen Struktur des Spektrums bekannt sind, ist es dennoch sinnvoll, neue und effizientere Techniken zu entwickeln. Gerade für die Integration in moderne Audiocoder-Strukturen wie AAC oder USAC ist eine Anpassung an die dort geltenden Rahmenbedingungen unabdingbar.</p><p id="p0118" num="0118">Ein wesentlicher Bestandteil zur erfolgreichen harmonischen Spektralbanderweiterung ist die Unterdrückung auftretender Störkomponenten. Gerade deswegen liegt ein Schwerpunkt hier auf der Funktionsweise und Optimierung der dafür entworfenen Aliasing-Cancelation. Es zeigt sich, dass durch die Wahl geeigneter FIR-Filter die unerwünschten Signalanteile stark reduziert werden können. Dabei wird nicht wie bei der klassischen Filterung ein Zeitsignal mit der Filterimpulsantwort gefaltet, sondern die komplexen MDCT/MDST-Koeffizienten. Auch wenn durch dieses Verfahren nicht alle auftretenden Aliasing-Komponenten ausgelöscht werden können, so genügt es, einige dominante Störanteile zu eliminieren.</p><p id="p0119" num="0119">Daneben bildet die Transformation der MDCT-Koeffizienten in MDST-Spektralwerte ein weiteres wichtiges Element der harmonischen Spektralbanderweiterung. Moderne Audiocoder arbeiten ausschließlich im MDCT-Bereich. Zwar wird das Signal ausreichend genau in seiner spektralen Darstellung beschrieben, trotzdem reicht diese Information für die Replikation des Spektrums mit HSBE nicht aus. Der benötigte Phasenverlauf kann erst durch zusätzliche MDST-Koeffizienten modifiziert werden. Hierfür wird eine Transformation eingeführt, die es mit einem konstanten Delay ermöglicht, aus den bekannten MDCT-Werten möglichst effektiv die fehlenden MDST-Koeffizienten zu berechnen. Neben einer exakten Lösung wird eine fehlerbehaftete aber ressourcensparende Alternative vorgestellt.</p><p id="p0120" num="0120">Wichtig bei der HSBE ist die Modulation des Spektrums. Hier zeigt sich, dass zur effizienten Replikation des Spektrums zwei Schritte sinnvoll sind. Zum einen wird das Spektrum um ganzzahlige MDCT-Teilbänder verschoben und zum anderen für eine Feinauflösung<!-- EPO <DP n="29"> --> eine Modulation innerhalb der Bandbreite eines MDCT-Teilbands durchgeführt. Für Signale in CD-Qualität liegt die erzielte Auflösung mit dieser Technik bei circa 0,5 Hz. Damit kann die harmonische Struktur des Spektrums sehr genau repliziert werden.</p><p id="p0121" num="0121">Die für die Bestimmung der zur Modulation notwendigen Lag-Frequenz kann zum Beispiel durch den Encoder bereitgestellt werden.</p><p id="p0122" num="0122">In Ausführungsformen werden ein System, eine Vorrichtung oder ein Verfahren oder ein Computerprogramm bereitgestellt, um ein Frequenz-verschobenes Signal zu erzeugen, wobei Subbandzerlegung verwendet wird, wobei für gebrochene Subband-Bandbreitenverschiebungen die Subbänder durch Multiplikation mit einer komplexen Exponentialfunktion multipliziert werden.</p><p id="p0123" num="0123">In Ausfdhrungsformen werden die Aliasing-Komponenten kompensiert oder zumindest reduziert, indem eine Butterfly-Verarbeitung zwischen benachbarten Subband-Signalen durchgeführt wird.</p><p id="p0124" num="0124">Gemäß weiterer Ausführungsformen wird die Frequenzverschiebung in der Subband-Domäne eines Audiocodiersystems durchgeführt.</p><p id="p0125" num="0125">In Ausführungsformen wird die Frequenzverschiebung verwendet, um fehlende Frequenzanteile und/oder spektrale Löcher einer Frequenzdarstellung eines Signals in einem Audiocodiersystem zu erfüllen.</p><p id="p0126" num="0126">Gemäß Ausführungsformen wird die Frequenzverschiebung in Kombination mit der Abtastraten-Umwandlung verwendet, um die Abspielgeschwindigkeit zu verändern, wobei der Pitch erhalten bleibt.</p><p id="p0127" num="0127">Erhöht man beispielsweise durch Frequenzverschiebung zunächst die Frequenz und verringert man sodann die Abspielgeschwindigkeit, verlängert sich die Abspielzeit einer bestimmten Menge Audiodaten bei gleichbleibendem Pitch. Verringert man beispielsweise umgekehrt durch Frequenzverschiebung zunächst die Frequenz und erhöht man sodann die Abspielzeit der bestimmten Menge Audiodaten, so verkürzt sich die Abspielzeit bei gleichbleibendem Pitch.</p><p id="p0128" num="0128">In weiteren Ausführungsformen werden die Konzepte dafür verwendet, ein Musiksignal fein einzustellen. Die bereitgestellten Konzepte können beispielsweise besonders vorteilhaft im Rahmen von Auto Tune eingesetzt werden. Sollen zum Beispiel nur kleine Tonhöhenänderungen<!-- EPO <DP n="30"> --> eines digitalen Musiksignals realisiert werden, beispielsweise Frequenzänderungen, die kleiner als die Bandbreite eines Subbands sind, wie zum Beispiel kleiner als ein MDCT- oder ein QMF-Subband, sind die bereitgestellten Konzepte besonders vorteilhaft.</p><p id="p0129" num="0129">Gemäß Ausführungsformen werden die Konzepte verwendet, um höhere Frequenzen eines Spektrums zu erzeugen, indem geringere Frequenzanteile eines Spektrums kopiert oder Frequenz-verschoben werden.</p><p id="p0130" num="0130">In Ausführungsformen ist die Subband-Zerlegung eine modifizierte diskrete CosinusTransformation (englisch: Modified Discrete Cosine Transform; MDCT).</p><p id="p0131" num="0131">In weiteren Ausführungsformen ist die Subband-Zerlegung eine Polyphasen Quadratische Spiegelfilterbank (englisch: Quadrature Mirror Filterbank; QMF) .</p><p id="p0132" num="0132">Die in obigen Ausführungsformen bereitgestellten Konzepte können unter anderem sowohl als ein System, eine Vorrichtung oder ein Verfahren oder ein Computerprogramm realisiert werden.</p><p id="p0133" num="0133">Auf Basis der bereitgestellten entwickelten Algorithmen und Funktionsprinzipien ist eine lauffähige Implementierung der harmonischen Spektralbanderweiterung entstanden. Eine echtzeitfähige Implementierung in Matlab oder in der Programmiersprache C oder in einer anderen Programmiersprache ist möglich. Die Anwendung der bereitgestellten Konzepte in Echtzeitsystemen ist somit möglich. Es ist zu erwarten, dass sich durch diese Verfahren die Qualität des reproduzierten Signals erhöht, wie es auch bei SBR der Fall ist.</p><p id="p0134" num="0134">Die Analyse der Komplexität der Modulation des Spektrums gemäß den bereitgestellten Konzepten liefert sehr gute Werte. Dabei hängt der Rechenaufwand maßgeblich von der MDCT-MDST-Transformation ab.</p><p id="p0135" num="0135">Des Weiteren wird ein Verfahren zur Erzeugung eines frequenzverschobenen Audiosignals basierend auf einem Audioeingangssignal bereitgestellt, wobei das Audioeingangssignal für eine Mehrzahl von ersten Subbändern durch einen oder mehrere erste Subband-Werte darstellbar ist.</p><p id="p0136" num="0136">Das Verfahren umfasst:
<ul><li>Empfangen des Audioeingangssignals, und<!-- EPO <DP n="31"> --></li><li>Erzeugen des frequenzverschobenen Audiosignals, wobei das frequenzverschobene Audiosignal für eine Mehrzahl von zweiten Subbändern jeweils einen oder mehrere zweite Subband-Werte aufweisen,</li><li>wobei jeder der ersten und der zweiten Subband-Werte Information über jeweils einen Phasenwinkel aufweist, und</li><li>wobei einer der zweiten Subband-Werte basierend auf einem der ersten Subband-Werte so erzeugt wird, dass der zweite Phasenwinkel dieses zweiten Subband-Werts sich von dem ersten Phasenwinkel dieses ersten Subband-Werts um eine Phasenwinkel-Differenz unterscheiden kann, wobei die Phasenwinkel-Differenz von einer Frequenzinformation abhängt, die angibt, um welche Frequenzdifferenz das Audioeingangssignal zu verschieben ist, um das frequenzverschobene Audiosignal zu erhalten, und wobei die Phasenwinkel-Differenz von einer Frequenz-Bandbreite von einem der ersten Subbänder abhängt.</li></ul></p><p id="p0137" num="0137">Ferner wird ein Computerprogramm zur Durchführung des obigen Verfahrens, wenn das Computerprogramm auf einem Computer oder Signalprozessor ausgeführt wird, bereitgestellt.</p><p id="p0138" num="0138">Bevorzugte Ausführungsformen finden sich in den abhängigen Ansprüchen.</p><p id="p0139" num="0139">Im Folgenden werden bevorzugte Ausführungsformen unter Bezugnahme auf die Zeichnungen beschrieben, in denen:
<dl id="dl0001"><dt>Fig.1a</dt><dd>eine Vorrrichtung zur Bandbreitenerweiterung gemäß einer Ausführungsform zeigt,</dd><dt>Fig. 1b</dt><dd>eine Vorrichtung gemäß einem Ausführungsbeispiel, bei der die Vorrichtung dafür eingerichtet ist, ein frequenzverbreitertes Audiosignal zu erzeugen, zeigt,</dd><dt>Fig. 2</dt><dd>eine schematische Darstellung der HSBE-HF-Rekonstruktion gemäß einer Ausführungsform zeigt,</dd><dt>Fig. 3</dt><dd>eine Vorrichtung 300 zur Erzeugung zur Erzeugung eines frequenzverschobenen Audiosignals gemäß einer Ausführungsform zeigt,<!-- EPO <DP n="32"> --></dd><dt>Fig. 4</dt><dd>eine Abschätzung der MDCT-MDST-Transformationsmatrix gemäß einer Ausführungsform zeigt,</dd><dt>Fig. 5</dt><dd>Impulsantworten der MDCT-MDST-Transformationsmatrizen gemäß einer Ausführungsform darstellt,</dd><dt>Fig. 6</dt><dd>eine Schätzung des MDST-Spektrums für weißes Rauschen zeigt,</dd><dt>Fig. 7</dt><dd>eine harmonische Struktur bei HSBE gemäße einer Ausführungsform zeigt,</dd><dt>Fig. 8</dt><dd>ein Schema der erweiterten HSBE-HF-Rekonstruktion gemäß einer Ausführungsform darstellt,</dd><dt>Fig. 9</dt><dd>Aliasing-Komponenten für <i>ϕ</i> = 45° darstellt,</dd><dt>Fig. 10</dt><dd>eine Filterimpulsantwort eines Anti-Aliasing-Filters gemäß einem Ausführungsbeispiel für <i>ϕ</i> = 90 ° darstellt,</dd><dt>Fig. 11</dt><dd>den Einfluss der Anti-Aliasing-Filterung auf ein Sinussignal für <i>ϕ</i> = 90° gemäß einer Ausführungsform zeigt,</dd><dt>Fig. 12</dt><dd>eine Butterfly-Struktur zur Aliasing-Reduzierung gemäß einer Ausführungsform zeigt,</dd><dt>Fig. 13</dt><dd>eine HSBE-LPC-Hüllkurvenanpassung gemäß einer Ausführungsform zeigt,</dd><dt>Fig. 14</dt><dd>die Komplexität der Modulation und Anti-Aliasing-Filterung von HSBE darstellt,</dd><dt>Fig. 15</dt><dd>die Komplexität der schnellen MDCT/MDST darstellt,</dd><dt>Fig. 16</dt><dd>eine Darstellung zur Komplexität der MDCT-MDST-Transformation ist,</dd><dt>Fig. 17</dt><dd>eine Reststörung bei HSBE in Abhängigkeit der Transformationslänge ist,</dd><dt>Fig. 18</dt><dd>einen Vergleich der HSBE mit der SBR zeigt,</dd><dt>Fig. 19</dt><dd>eine schnelle universelle DCT-III/DST-III Struktur zeigt,<!-- EPO <DP n="33"> --></dd><dt>Fig. 20</dt><dd>eine schnelle DCT-IV Struktur darstellt,</dd><dt>Fig. 21</dt><dd>eine schematische Darstellung einer zeitlichen Maskierung zeigt,</dd><dt>Fig. 22</dt><dd>eine schematische Darstellung der frequenzabhängigen Maskierung im menschlichen Gehör zeigt,</dd><dt>Fig. 23</dt><dd>ein Blockschaltbild eines psychoakustischen Audioencoders zeigt,</dd><dt>Fig. 24</dt><dd>ein Blockschaltbild eines psychoakustischen Audiodecoders zeigt,</dd><dt>Fig. 25</dt><dd>eine Filterbank mit einer Systemverzögerung von n<sub>d</sub> Samples darstellt,</dd><dt>Fig. 26</dt><dd>eine Polyphasenfilterbank darstellt,</dd><dt>Fig. 27</dt><dd>Kategorien der Bandbreitenerweiterung zeigt,</dd><dt>Fig. 28</dt><dd>ein Blockschaltbild eines erweiterten SBR-Encoders zeigt,</dd><dt>Fig. 29</dt><dd>ein Blockschaltbild eines mit SBR erweiterten Decoders zeigt,</dd><dt>Fig. 30</dt><dd>eine schematische Darstellung der SBR-HF-Rekonstruktion zeigt,</dd><dt>Fig. 31</dt><dd>eine Zerstörung der harmonischen Struktur bei SBR zeigt,</dd><dt>Fig. 32</dt><dd>eine schematische Darstellung der HBE-HF-Rekonstruktion ist,</dd><dt>Fig. 33</dt><dd>eine harmonische Struktur bei HBE darstellt,</dd><dt>Fig. 34</dt><dd>eine schematische Darstellung der CM-BWE-HF-Rekonstruktion zeigt, und</dd><dt>Fig. 35</dt><dd>harmonische Struktur bei CM-BWE darstellt.</dd></dl></p><p id="p0140" num="0140"><figref idrefs="f0001">Fig. 1a</figref> zeigt eine Vorrichtung 100 zur Erzeugung eines frequenzverschobenen Audiosignals basierend auf einem Audioeingangssignal. Das Audioeingangssignal ist dabei für eine Mehrzahl von ersten Subbändern durch einen oder mehrere erste Subband-Werte darstellbar.<!-- EPO <DP n="34"> --> Die Vorrichtung umfasst eine Schnittstelle 110 und eine Frequenzverschiebungseinheit 120. Die Schnittstelle 110 ist zum Empfang des Audioeingangssignals eingerichtet. Die Frequenzverschiebungseinheit 120 ist zur Erzeugung des frequenzverschobenen Audiosignals eingerichtet, wobei das frequenzverschobene Audiosignal für eine Mehrzahl von zweiten Subbändern jeweils einen oder mehrere zweite Subband-Werte aufweist. Ferner weist jeder der ersten und der zweiten Subband-Werte Information über jeweils einen Phasenwinkel auf Die Frequenzverschiebungseinheit 120 ist ferner dafür eingerichtet, einen der zweiten Subband-Werte basierend auf einem der ersten Subband-Werte so zu erzeugen, dass der zweite Phasenwinkel dieses zweiten Subband-Werts sich von dem ersten Phasenwinkel dieses ersten Subband-Werts um eine Phasenwinkel-Differenz unterscheiden kann, wobei die Phasenwinkel-Differenz von einer Frequenzinformation abhängt, die angibt, um welche Frequenzdifferenz das Audioeingangssignal zu verschieben ist, also z.B. um welche Frequenzdifferenz die ersten Subband-Werte der Subbänder des Audioeingangssignals zu verschieben sind, um das frequenzverschobene Audiosignal zu erhalten, und wobei die Phasenwinkel-Differenz von einer Frequenz-Bandbreite von einem der ersten Subbänder abhängt.</p><p id="p0141" num="0141">In manchen Ausführungsformen kann die Schnittstelle dafür eingerichtet sein, die Frequenzinformation zu empfangen, die angibt, um welche Frequenzdifferenz die ersten Subband-Werte der Subbänder des Audioeingangssignals zu verschieben sind.</p><p id="p0142" num="0142"><figref idrefs="f0002">Fig. 1b</figref> zeigt eine Vorrichtung 150 gemäß einem Ausführungsbeispiel. Die Vorrichtung 150 ist dafür eingerichtet, ein frequenzverbreitertes Audiosignal zu erzeugen. Dabei ist die Vorrichtung 150 dafür eingerichtet, das frequenzverbreiterte Audiosignal dadurch zu erzeugen, dass die Vorrichtung 150 die zweiten Subband-Werte des frequenzverschobenen Audiosignals erzeugt, wobei das frequenzverbreiterte Audiosignal die ersten Subband-Werte des Audioeingangssignals und die zweiten Subband-Werte des frequenzverschobenen Audiosignals umfasst.</p><p id="p0143" num="0143">Im Folgenden werden Konzepte zur Bandbreitenerweiterung gemäß Ausführungsformen eingeführt, die als sogenannte harmonische Spektralbanderweiterung (engl. Harmonic Spectral Bandwidth Extension, HSBE) bezeichnet werden. Dabei handelt es sich um Konzepte, die die Vorteile von SBR mit denen der kontinuierlichen Einseitenbandmodulation verbindet. Es basiert auf der Signaldarstellung im MDCT-Bereich. Damit kann HSBE direkt in aktuellen Audiocodern wie HE-AAC oder USAC eingebunden werden, ohne wie bei SBR eine zusätzliche QMF Filterbank zu verwenden. Im Gegensatz zu den Zeitbereichsverfahren ist eine hochauflösende DFT zu berechnen und es wird kein analytisches Signal benötigt.<!-- EPO <DP n="35"> --></p><p id="p0144" num="0144">Nachfolgend wird Funktionsprinzip der harmonischen Spektralbanderweiterung erläutert. Die harmonische Spektralbanderweiterung nutzt eine Kopie des Basisbands zur Generierung des HF-Anteils. Das Basisband wird über einen Kopierprozess im hochfrequenten Bereich nachgebildet. Im Gegensatz zu CM-BWE, wo durch das Kopieren eine Lücke entsteht, in der einzelne harmonische Teiltöne fehlen, wird die Verschiebung des Basisbandes bei HSBE erweitert. Das Basisband wird zunächst ebenfalls nach oben kopiert, so dass die Frequenz von 0 Hz danach auf <i>fg</i> liegt. Die so entstandene Lücke zwischen der letzten Harmonischen der Frequenz <i>f &lt; f<sub>g</sub></i> im Basisband und der Frequenz <i>f<sub>g</sub></i> wird dann ausgeglichen, indem das kopierte Basisband wieder nach unten verschoben wird, so dass die harmonische Struktur wieder kontinuierlich verläuft. So wird eine Lücke durch Auslassen eines harmonischen Teiltons wie bei den Zeitbereichsverfahren vermieden. Der Bandbreitenerweiterungsprozess setzt sich dabei aus zwei Teilen zusammen. Der eine Teil wird durch einen Kopierprozess im MDCT-Bereich realisiert. Die tieffrequenten MDCT-Koeffizienten werden durch ein simples Kopieren repliziert. Der andere Teil der Bandbreitenerweiterung, also die Erhaltung der harmonischen Struktur, wird über eine Manipulation der Phase erreicht. Für diesen Schritt müssen daher Phaseninformationen vorhanden sein. Die harmonische Spektralbanderweiterung arbeitet grundsätzlich mit rein reellen MDCT-Koeffizienten. Zur Veränderung von Phaseninformationen findet daher eine Überführung in ein komplexes Spektrum statt. Dies wird durch die hier bereitgestellte MDCT-MDST-Transformation erreicht.</p><p id="p0145" num="0145">Damit sich während der Anpassung die hohen Frequenzen des Basisbands nicht mit den Frequenzen des replizierten Bandes überlagern, wird das HF-Band einer Hochpassfilterung unterworfen. Diese Filterung ist durch die Darstellung des Signals als MDCT-Koeffizienten sehr einfach, da die unerwünschten Koeffizienten zu Null gesetzt werden können. Diese Art der Verschiebung verursacht allerdings eine Bandbegrenzung des synthetisierten Signals. Es wird also nach der Rekonstruktion des HF-Bands nicht die ursprüngliche maximale Signalfrequenz <i>f<sub>max</sub>,</i> erreicht, sondern nur die Frequenz <i>f<sub>syn</sub>.</i> Die auftretende Lücke zwischen <i>f<sub>max</sub></i> und <i>f<sub>syn</sub></i> kann bei Bedarf mit Rauschen gefüllt werden.</p><p id="p0146" num="0146">In <figref idrefs="f0003">Fig. 2</figref> ist der Kopiervorgang inklusive der harmonischen Anpassung schematisch dargestellt. Dabei zeigt <figref idrefs="f0003">Fig. 2</figref> eine schematische Darstellung der HSBE-HF-Rekonstruktion. In <figref idrefs="f0003">Fig. 2</figref>, links ein Kopieren und Verschieben des Basisbands gezeigt. In <figref idrefs="f0003">Fig. 2</figref>, rechts ist ein Spektrum nach der Anpassung der spektralen Einhüllenden gezeigt.</p><p id="p0147" num="0147">Die notwendige Adaption der Phase verursacht zusätzliche Störkomponenten im Signal. Diese werden durch die entwickelte Anti-Aliasing-Filterung der komplexen MDCT-/MDST-Spektralwerte<!-- EPO <DP n="36"> --> unterdrückt. Abschließend wird die spektrale Einhüllende durch ein geeignetes Verfahren wieder ihrem ursprünglichen Verlauf angepasst.</p><p id="p0148" num="0148">In <figref idrefs="f0004">Fig. 3</figref> ist ein HSBE-Decoder, also ein mit HSBE erweiterten Decoder gezeigt, dass sich mit dem genannten Vorgehen ergibt.</p><p id="p0149" num="0149"><figref idrefs="f0004">Fig. 3</figref> zeigt eine Vorrichtung 300 zur Erzeugung zur Erzeugung eines frequenzverschobenen Audiosignals gemäß einer Ausführungsform. In einer Ausführungsform kann es sich beispielsweise um einen HSBE-Decoder, also einen mit HSBE erweiterten Decoder handeln.</p><p id="p0150" num="0150">Die Vorrichtung 300 weist eine Schnittstelle 310 und eine Frequenzverschiebungseinheit 320 auf.</p><p id="p0151" num="0151">Zwischen der Schnittstelle 310 und der Frequenzverschiebungseinheit 320 befindet sich eine MDCT-/MDST-Transformationseinheit 315. Ferner weist die Vorrichtung 300 eine Filtereinheit 330 auf. Des Weiteren weist die Vorrichtung 300 eine Synthese-Transformationseinheit 340, z.B. in Form einer Filterbank und eine Hüllkurvenanpassungseinheit 350 auf. Ferner umfasst die Vorrichtung 300 in dem Ausführungsbeispiel der <figref idrefs="f0004">Fig. 3</figref> eine Einheit zur Berechnung von τ und ϕ (318).</p><p id="p0152" num="0152">Die MDCT-/MDST-Transformationseinheit 315 kann dafür eingerichtet sein, einen oder mehrere erste MDCT-Koeffizienten des Audioeingangssignals zu erhalten, die Koeffizienten einer Modifizierten Diskreten Kosinustransformation des Audioeingangssignals sind. Diese ersten MDCT-Koeffizienten kann die MDCT-/MDST-Transformationseinheit 315 zum Beispiel von der Schnittstelle 310 erhalten.</p><p id="p0153" num="0153">Die MDCT-/MDST-Transformationseinheit 315 ist dafür eingerichtet, basierend auf einem oder mehreren der ersten MDCT-Koeffizienten des Audioeingangssignals einen oder mehrere erste MDST-Koeffizienten des Audioeingangssignals zu bestimmen, die Koeffizienten einer Modifizierten Diskreten Sinustransformation sind.</p><p id="p0154" num="0154">Die Frequenzverschiebungseinheit 320 kann dann dafür eingerichtet sein, zweite Subband-Werte basierend auf jeweils einem der ersten Subband-Werte zu erzeugen, wobei jeder der ersten Subband-Werte auf einem der ersten MDCT-Koeffizienten und einem der ersten MDST-Koeffizienten, der basierend auf diesem ersten MDCT-Koeffizienten bestimmt wurde, basiert.<!-- EPO <DP n="37"> --></p><p id="p0155" num="0155">Die gezeigte Struktur der Vorrichtung 300, z.B. realisiert als ein HSBE-Decoder, richtet sich nach den implementierten Algorithmen. Für die Verwendung dieses Decoders in anderen Umgebungen kann es erforderlich sein, die Hüllkurvenrekonstruktion im Frequenzbereich vorzunehmen. Der entsprechende Block befindet sich dann direkt vor der MDCT-/MDST-Synthesefilterbank. An dieser Stelle können auch weitere Komponenten eingebunden werden, wie die in SBR genutzte Tonalitätsanpassung. Auf das allgemeine Funktionsprinzip der harmonischen Spektralbanderweiterung haben diese Verfahren allerdings keine Auswirkung.</p><p id="p0156" num="0156">Aus <figref idrefs="f0004">Fig. 3</figref> ergibt sich auch der Decodierprozess eines Signals gemäß einer Ausführungsform, das in der MDCT-Domäne codiert wurde. Um einige Teile des Spektrums im gewünschten Umfang zu verschieben, werden die decodierten MDCT-Koeffizienten zunächst in eine kombinierte MDCT/MDSE Repräsentation transformiert. Dies ist hilfreich, denn die Modulation eines komplexen Spektrums wird größere Aliasing-Komponenten nur in jedem zweiten Subband erzeugen. Deshalb ist eine Kompensation nur in jedem zweiten Subband erforderlich, wobei diese Kompensation mit Hilfe des vorgeschlagenen Aliasing-Kompensationsverfahrens durchgeführt wird.</p><p id="p0157" num="0157">Der HF-Generator verschiebt die komplexen Frequenzeingaben aus der MDCT/MDST Transformations-Repräsentation entsprechend der gewünschten Verschiebung, entweder decodiert aus dem Bitstrom oder am Decodierer bestimmt oder durch externe Prozesse. Der verwendete Modulationsterm ist: <maths id="math0056" num=""><math display="block"><msup><mi>e</mi><mrow><mo>-</mo><mi mathvariant="italic">jbφ</mi></mrow></msup><mo>⁢</mo><mfrac><mi>π</mi><mrow><mn>180</mn><mo>⁢</mo><mi>°</mi></mrow></mfrac></math><img id="ib0056" file="imgb0056.tif" wi="29" he="13" img-content="math" img-format="tif"/></maths><br/>
wobei b der Blockindex ist, wobei ϕ die Frequenzverschiebung in Grad ist (eine Frequenzverschiebung um 180° entspricht einer Verschiebung in die Mitte des nächsten Subbands).</p><p id="p0158" num="0158">Danach wird die Aliasing-Reduzierung durchgeführt, und dann wird das komplexe Spektrum invers in die Zeitdomäne zurück transformiert und abgespielt.</p><p id="p0159" num="0159">Der verwendete Modulationsterm ist eine komplexe Exponentialfunktion. ϕ ist ein Winkel in Grad, der von der Frequenzdifferenz abhängt, um die die ersten Subband-Werte der Subbänder zu verschieben sind.</p><p id="p0160" num="0160">Nun wird die Überführung der MDCT zur MDST erläutert.<!-- EPO <DP n="38"> --></p><p id="p0161" num="0161">Die Einseitenbandmodulation zur Erhaltung der harmonischen Struktur wird zum Teil über eine Manipulation der Phase realisiert. Für die harmonische Spektralbanderweiterung ist daher der Phasengang von entscheidender Bedeutung. Wie bereits erläutert, arbeitet HSBE generell im reellen MDCT-Bereich.</p><p id="p0162" num="0162">Der Encoder stellt nur MDCT-Koeffizienten zur Verfügung, so dass für den Phasengang zusätzlich die MDST-Koeffizienten benötigt werden. Die Überführung der MDCT-Koeffizienten in die entsprechenden MDST-Koeffizienten ist möglich und wird nachfolgend erläutert.</p><p id="p0163" num="0163">Im Folgenden wird die exakte Berechnung der MDST erläutert.</p><p id="p0164" num="0164">Wie bei der DCT existiert bei der MDCT eine korrespondierende Funktion zur Berechnung der Sinusanteile im Signal: die diskrete modifizierte Sinustransformation (MDST). Für die MDST gelten die gleichen Eigenschaften wie für die MDCT, allerdings wird sie in der Audiocodierung kaum verwendet.</p><p id="p0165" num="0165">Für manche Anwendungen, wie beispielsweise bei HSBE, ist es aber dennoch sinnvoll, das MDST-Spektrum eines Signals zu berechnen. Durch die Kombination beider Spektren wird ein genaues Betrags- und Phasenspektrum erhalten (Cheng, 2004).</p><p id="p0166" num="0166">Die MDST wird ähnlich der MDCT in Gleichung 2.35 berechnet. Unterschiede bestehen in der Transformationsmatrix <maths id="math0057" num=""><math display="inline"><munder><mi mathvariant="bold">T</mi><mo> ∼</mo></munder></math><img id="ib0057" file="imgb0057.tif" wi="5" he="8" img-content="math" img-format="tif" inline="yes"/></maths> und der Fenstermatrix <maths id="math0058" num=""><math display="inline"><munder><mi mathvariant="bold">F</mi><mo> ∼</mo></munder><mn>.</mn></math><img id="ib0058" file="imgb0058.tif" wi="7" he="8" img-content="math" img-format="tif" inline="yes"/></maths> Die MDST-Transformationsmatrix wird mit dem Modulationskern der DST-IV (vgl. Gleichung 2.18) berechnet: <maths id="math0059" num="(4.1a)"><math display="block"><msub><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mi mathvariant="italic">DST</mi></msub><mfenced separators=""><mi>k</mi><mo>⁢</mo><mi>n</mi></mfenced><mo>:</mo><mo>=</mo><mi>sin</mi><mfenced><mfrac><mrow><mi mathvariant="italic">π</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn></mfenced><mo>⁢</mo><mfenced separators=""><mi>k</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn></mfenced></mrow><mi>N</mi></mfrac></mfenced><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>N</mi><mo>×</mo><mi>N</mi></mrow></msup></math><img id="ib0059" file="imgb0059.tif" wi="135" he="13" img-content="math" img-format="tif"/></maths> <maths id="math0060" num="(4.1b)"><math display="block"><msubsup><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mi mathvariant="italic">DST</mi><mrow><mo>-</mo><mn>1</mn></mrow></msubsup><mo>=</mo><mfrac><mn>2</mn><mi>N</mi></mfrac><mo>⋅</mo><msub><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mi mathvariant="italic">DST</mi></msub></math><img id="ib0060" file="imgb0060.tif" wi="126" he="14" img-content="math" img-format="tif"/></maths></p><p id="p0167" num="0167">Aufgrund anderer Symmetrieeigenschaften und anderer Randfortsetzungen der DST-IV im Vergleich zur DCT-IV müssen die Foldingmatrizen daran angepasst werden. Die Modifikation besteht in einem Vorzeichenwechsel des zweiten und vierten Quadranten der Fenstermatrix <maths id="math0061" num=""><math display="inline"><munder><mi mathvariant="bold">F</mi><mo> ∼</mo></munder><mo>:</mo></math><img id="ib0061" file="imgb0061.tif" wi="8" he="9" img-content="math" img-format="tif" inline="yes"/></maths><!-- EPO <DP n="39"> -->
<maths id="math0062" num=""><img id="ib0062" file="imgb0062.tif" wi="135" he="41" img-content="math" img-format="tif"/></maths></p><p id="p0168" num="0168">Mit diesen Anpassungen lässt sich die MDST eines in Blöcke unterteilten <maths id="math0063" num=""><math display="inline"><munder><mi mathvariant="bold">x</mi><mo> ∼</mo></munder></math><img id="ib0063" file="imgb0063.tif" wi="7" he="8" img-content="math" img-format="tif" inline="yes"/></maths>Signals wie folgt berechnen: <maths id="math0064" num="(4.3)"><math display="block"><msub><munder><mi mathvariant="bold">X</mi><mo>∼</mo></munder><mi mathvariant="italic">MDST</mi></msub><mo>=</mo><msub><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mi mathvariant="italic">DST</mi></msub><mo>⋅</mo><munder><mi mathvariant="bold">D</mi><mo>∼</mo></munder><mo>⋅</mo><msub><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mi mathvariant="italic">sin</mi></msub><mo>⋅</mo><munder><mi mathvariant="bold">x</mi><mo>∼</mo></munder></math><img id="ib0064" file="imgb0064.tif" wi="132" he="8" img-content="math" img-format="tif"/></maths></p><p id="p0169" num="0169">Für die inverse Transformation gilt dann: <maths id="math0065" num="(4.4)"><math display="block"><mover><munder><mi mathvariant="bold">x</mi><mo>∼</mo></munder><mo>^</mo></mover><mo>=</mo><msubsup><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mi mathvariant="italic">sin</mi><mi mathvariant="normal">T</mi></msubsup><mo>⋅</mo><msup><munder><mi mathvariant="bold">D</mi><mo>∼</mo></munder><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⋅</mo><msubsup><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mi mathvariant="italic">DST</mi><mrow><mo>-</mo><mn>1</mn></mrow></msubsup><mo>⋅</mo><munder><mi mathvariant="bold">x</mi><mo>∼</mo></munder></math><img id="ib0065" file="imgb0065.tif" wi="134" he="9" img-content="math" img-format="tif"/></maths></p><p id="p0170" num="0170">Eine aus Kombination von MDCT- und MDST-Spektren berechnete komplexe Übertragungsfunktion ist notwendig, um beispielsweise den Phasengang zu manipulieren. Im Folgenden wird das implementierte Verfahren zur Überführung des MDCT-Spektrums in MDST-Koeffizienten vorgestellt.</p><p id="p0171" num="0171">Eine triviale und rechenintensive Methode ist die Überführung des Signals im MDCT-Bereich zurück in den Zeitbereich mit anschließender MDST: <maths id="math0066" num="(4.5)"><math display="block"><msub><munder><mi mathvariant="bold">X</mi><mo>∼</mo></munder><mi mathvariant="italic">MDST</mi></msub><mo>=</mo><msub><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mi mathvariant="italic">DST</mi></msub><mo>⋅</mo><munder><mi mathvariant="bold">D</mi><mo>∼</mo></munder><mo>⋅</mo><msub><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mi mathvariant="italic">sin</mi></msub><mo>⋅</mo><msup><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mi mathvariant="normal">T</mi></msup><mo>⋅</mo><msup><munder><mi mathvariant="bold">D</mi><mo>∼</mo></munder><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⋅</mo><msup><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⋅</mo><munder><mi mathvariant="bold">X</mi><mo>∼</mo></munder></math><img id="ib0066" file="imgb0066.tif" wi="135" he="9" img-content="math" img-format="tif"/></maths></p><p id="p0172" num="0172">Diese Berechnung kann vereinfacht werden, um den benötigten Aufwand zu reduzieren. Dazu wird zunächst die Polyphasenmatrix <maths id="math0067" num=""><math display="inline"><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder></math><img id="ib0067" file="imgb0067.tif" wi="5" he="8" img-content="math" img-format="tif" inline="yes"/></maths> definiert als: <maths id="math0068" num="(4.6)"><math display="block"><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mo>=</mo><msub><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mi mathvariant="italic">DST</mi></msub><mo>⋅</mo><munder><mi mathvariant="bold">D</mi><mo>∼</mo></munder><mo>⋅</mo><msub><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mi mathvariant="italic">sin</mi></msub><mo>⋅</mo><msup><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mi mathvariant="normal">T</mi></msup><mo>⋅</mo><msup><munder><mi mathvariant="bold">D</mi><mo>∼</mo></munder><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⋅</mo><msup><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mrow><mo>-</mo><mn>1</mn></mrow></msup></math><img id="ib0068" file="imgb0068.tif" wi="135" he="9" img-content="math" img-format="tif"/></maths></p><p id="p0173" num="0173">Die Elemente der Matrix <maths id="math0069" num=""><math display="inline"><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder></math><img id="ib0069" file="imgb0069.tif" wi="5" he="9" img-content="math" img-format="tif" inline="yes"/></maths> bestehen jeweils aus Polynomen dritter Ordnung in z. Diese Eigenschaft kann genutzt werden, um <maths id="math0070" num=""><math display="inline"><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder></math><img id="ib0070" file="imgb0070.tif" wi="5" he="8" img-content="math" img-format="tif" inline="yes"/></maths> als Addition von drei Matrizen darzustellen: <maths id="math0071" num="(4.7)"><math display="block"><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mo>=</mo><msub><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>0</mn></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mn>0</mn></msup><mo>+</mo><msub><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>1</mn></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>+</mo><msub><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>2</mn></msub><mo>⁢</mo><msup><mi mathvariant="bold">z</mi><mrow><mo>-</mo><mn>2</mn></mrow></msup></math><img id="ib0071" file="imgb0071.tif" wi="135" he="9" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="40"> --></p><p id="p0174" num="0174">Die drei Teilmatrizen <maths id="math0072" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn></msub><mo>,</mo><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>1</mn></msub></math><img id="ib0072" file="imgb0072.tif" wi="15" he="9" img-content="math" img-format="tif" inline="yes"/></maths> und <maths id="math0073" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>2</mn></msub></math><img id="ib0073" file="imgb0073.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> weisen charakteristische Merkmale auf, die zu einer effizienten Berechnung Führen. Die Matrix <maths id="math0074" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>1</mn></msub></math><img id="ib0074" file="imgb0074.tif" wi="7" he="8" img-content="math" img-format="tif" inline="yes"/></maths> ist eine schwachbesetzte Matrix mit den Elementen 0,5 und -0,5. Zwischen den Matrizen <maths id="math0075" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn></msub></math><img id="ib0075" file="imgb0075.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> und <maths id="math0076" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>2</mn></msub></math><img id="ib0076" file="imgb0076.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> besteht ein direkter Zusammenhang, so dass sich die Matrix <maths id="math0077" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>2</mn></msub></math><img id="ib0077" file="imgb0077.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> als Spiegelung der Elemente von <maths id="math0078" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn></msub></math><img id="ib0078" file="imgb0078.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> an ihrer Nebendiagonalen erzeugen lässt. Die genaue Form und eine detaillierte Berechnung dieser Matrizen wird später dargestellt. Das MDST Spektrum des Blocks (<i>b</i> - 1) kann nun folgendermaßen berechnet werden: <maths id="math0079" num="(4.8)"><math display="block"><msub><munder><mi mathvariant="bold">X</mi><mo>∼</mo></munder><mi mathvariant="italic">MDST</mi></msub><mo>⁢</mo><mfenced separators=""><mi>b</mi><mo>-</mo><mn>1</mn></mfenced><mo>=</mo><msub><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>0</mn></msub><mo>⋅</mo><munder><mi mathvariant="bold">X</mi><mo>̲</mo></munder><mfenced><mi>b</mi></mfenced><mo>+</mo><msub><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>1</mn></msub><mo>⋅</mo><munder><mi mathvariant="bold">X</mi><mo>̲</mo></munder><mo>⁢</mo><mfenced separators=""><mi>b</mi><mo>-</mo><mn>1</mn></mfenced><mo>+</mo><msub><munder><mi mathvariant="bold">H</mi><mo>̲</mo></munder><mn>2</mn></msub><mo>⋅</mo><munder><mi mathvariant="bold">X</mi><mo>̲</mo></munder><mo>⁢</mo><mfenced separators=""><mi>b</mi><mo>-</mo><mn>2</mn></mfenced></math><img id="ib0079" file="imgb0079.tif" wi="146" he="9" img-content="math" img-format="tif"/></maths></p><p id="p0175" num="0175">Dabei ist <b><u>X</u></b>(<i>b</i>) die <i>b</i>-te Spalte der Matrix <maths id="math0080" num=""><math display="inline"><munder><mi mathvariant="bold">X</mi><mo> ∼</mo></munder><mn>.</mn></math><img id="ib0080" file="imgb0080.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> An dieser Gleichung ist auch zu erkennen, dass zur Berechnung des MDST-Spektrums ein Delay von einem Block eingeführt wird. Liegt das MDCT-Spektrum des Blocks b vor, so steht erst das MDST-Spektrum des vorhergegangenen Blocks zur Verfügung. Mithilfe der so erlangten MDST-Koeffizienten kann ein Phasengang aus dem komplexen MDCT-/MDST-Spektrum berechnet und zur Erhaltung der harmonischen Struktur, wie oben erläutert, über eine Phasendrehung manipuliert werden.</p><p id="p0176" num="0176">Nachfolgend wird nun eine vereinfachte Berechnung der MDST erläutert.</p><p id="p0177" num="0177">Auch wenn nach dem hergeleiteten Verfahren die Berechnung der MDST stark vereinfacht ist, ist die Berechnung dieser Transformation sehr rechenintensiv. Zudem wird viel Speicherplatz zur Speicherung der Matrix <maths id="math0081" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn></msub></math><img id="ib0081" file="imgb0081.tif" wi="8" he="7" img-content="math" img-format="tif" inline="yes"/></maths> benötigt. Eine weitere Vereinfachung der Transformation ist also gesucht.</p><p id="p0178" num="0178">Bei genauerer Untersuchung der Matrizen <maths id="math0082" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn></msub></math><img id="ib0082" file="imgb0082.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> und <maths id="math0083" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>2</mn></msub></math><img id="ib0083" file="imgb0083.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> fällt auf, dass sie sehr viele Werte enthalten, die gegen Null tendieren. Die Koeffizienten mit den betragsmäßig größten Werten konzentrieren sich auf einen engen Bereich nahe der Hauptdiagonalen der Matrizen. Es liegt daher nahe, die übrigen Koeffizienten zu Null zu setzten, um damit sowohl Rechenleistung als auch Speicherbedarf zu sparen. Des Weiteren sind sich die Werte auf den Diagonalen sehr ähnlich. Sie unterscheiden sich im Wesentlichen nur durch ihr Vorzeichen voneinander. Einzig in den Bereichen nahe den Ecken nehmen die Koeffizienten größere Werte an.</p><p id="p0179" num="0179">Zur Vereinfachung wird zudem angenommen, dass die Werte unter- und oberhalb der Hauptdiagonalen gleich sind, also dass eine Achsensymmetrie der Matrix zur<!-- EPO <DP n="41"> --> Hauptdiagonalen besteht. Es wird nun eine vereinfachte Matrix bestimmt, deren Werte aus der mittleren Spalte der Matrix <maths id="math0084" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn></msub></math><img id="ib0084" file="imgb0084.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> entnommen werden. Dazu wird aus der mittleren Spalte ein Bereich ausgeschnitten, der das Element der Hauptdiagonalen und eine beliebige Anzahl weiterer Elemente unterhalb der Hauptdiagonalen umfasst. Dieser Ausschnitt wird mit <b><u>h</u></b>[<i>n</i>] bezeichnet. Die mittlere Spalte der neuen Matrix wird nun um das aus <b><u>h</u></b>[<i>n</i>] und einer Punktspiegelung von <b><u>h</u></b>[<i>n</i>] am Hauptachsenelement <i>h<sub>i</sub>j</i> gebildet, der Rest der Spalte ist Null. Die anderen Spalten der vereinfachten Matrix werden nun durch eine zyklische Verschiebung dieser Spalte gebildet. Das Vorzeichen jeder zweiten Spalte wird angepasst. Mit diesen Methoden zur Vereinfachung der vollbesetzten Matrix <maths id="math0085" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn></msub></math><img id="ib0085" file="imgb0085.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> kann nun mit sehr wenigen Koeffizienten die schwachbesetzte Matrix <maths id="math0086" num=""><math display="inline"><msubsup><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn><mi>ʹ</mi></msubsup></math><img id="ib0086" file="imgb0086.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> erstellt werden. Eine Besonderheit dieser Matrix ist ihre symmetrische Toeplitzähnliche Struktur. Sie entsteht durch die zyklische Verschiebung der beschnittenen und an der Hauptdiagonalen gespiegelten Impulsantwort <i>h</i>[<i>n</i>] mit: <maths id="math0087" num="(4.9)"><math display="block"><mi>h</mi><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>=</mo><mfenced open="[" close="]" separators=""><msub><mi>h</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>⁢</mo><msub><mi>h</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>j</mi></mrow></msub><mo>…</mo><msub><mi>h</mi><mrow><mi>i</mi><mo>+</mo><mi>σ</mi><mo>-</mo><mn>1</mn><mo>,</mo><mi>j</mi></mrow></msub><mo>⁢</mo><msub><mi>h</mi><mrow><mi>i</mi><mo>+</mo><mi>σ</mi><mo>,</mo><mi>j</mi></mrow></msub></mfenced><mo>,</mo><mspace width="2em"/><mi>i</mi><mo>,</mo><mi>j</mi><mo>=</mo><mfrac><mi>N</mi><mn>2</mn></mfrac><mo>-</mo><mn>1</mn></math><img id="ib0087" file="imgb0087.tif" wi="120" he="14" img-content="math" img-format="tif"/></maths></p><p id="p0180" num="0180">Dabei ist <i>i</i> der Zeilen- und <i>j</i> der Spaltenindex der Matrix <maths id="math0088" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn></msub></math><img id="ib0088" file="imgb0088.tif" wi="8" he="9" img-content="math" img-format="tif" inline="yes"/></maths> und σ der Fensterindex der die Länge des Ausschnitts bestimmt. Die Länge dieses Ausschnitts ist stets 2σ +1. Für die Struktur der Matrix <maths id="math0089" num=""><math display="inline"><msubsup><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn><mi>ʹ</mi></msubsup></math><img id="ib0089" file="imgb0089.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> gilt mit σ = 1 und <i>N</i>= 6 beispielsweise: <maths id="math0090" num="(4.10)"><math display="block"><msubsup><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>0</mn><mi>ʹ</mi></msubsup><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><mo>-</mo><mi>h</mi><mfenced open="[" close="]"><mn>0</mn></mfenced></mtd><mtd><mi>h</mi><mfenced open="[" close="]"><mn>1</mn></mfenced></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mo>-</mo><mi>h</mi><mfenced open="[" close="]"><mn>1</mn></mfenced></mtd><mtd><mi>h</mi><mfenced open="[" close="]"><mn>0</mn></mfenced></mtd><mtd><mo>-</mo><mi>h</mi><mfenced open="[" close="]"><mn>1</mn></mfenced></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mi>h</mi><mfenced open="[" close="]"><mn>1</mn></mfenced></mtd><mtd><mo>-</mo><mi>h</mi><mfenced open="[" close="]"><mn>0</mn></mfenced></mtd><mtd><mi>h</mi><mfenced open="[" close="]"><mn>1</mn></mfenced></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>-</mo><mi>h</mi><mfenced open="[" close="]"><mn>1</mn></mfenced></mtd><mtd><mi>h</mi><mfenced open="[" close="]"><mn>0</mn></mfenced></mtd><mtd><mo>-</mo><mi>h</mi><mfenced open="[" close="]"><mn>1</mn></mfenced></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi>h</mi><mfenced open="[" close="]"><mn>1</mn></mfenced></mtd><mtd><mo>-</mo><mi>h</mi><mfenced open="[" close="]"><mn>0</mn></mfenced></mtd><mtd><mi>h</mi><mfenced open="[" close="]"><mn>1</mn></mfenced></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>-</mo><mi>h</mi><mfenced open="[" close="]"><mn>1</mn></mfenced></mtd><mtd><mi>h</mi><mfenced open="[" close="]"><mn>0</mn></mfenced></mtd></mtr></mtable></mfenced></math><img id="ib0090" file="imgb0090.tif" wi="123" he="39" img-content="math" img-format="tif"/></maths></p><p id="p0181" num="0181">Es ist zu beachten, dass beginnend mit der ersten Spalte jede zweite Spalte mit -1 multipliziert ist. In den folgenden Betrachtungen entspricht der Fensterindex σ circa 10% der Transformationslänge <i>N</i>, also σ = [0, <b>1</b> · <i>N</i>]. Damit ist der benötigte Speicherplatz für die Transformationsmatrix durch die Spiegelung der Werte von h[n] auf 20% gesunken.</p><p id="p0182" num="0182">Fig. 4 stellt eine Abschätzung der MDCT-MDST-Transfonnationsmatrix dar. In Fig. 4, links ist eine vollbesetzte Transformationsmatrix <maths id="math0091" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn></msub></math><img id="ib0091" file="imgb0091.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> für N = 64 gezeigt. In Fig. 4, rechts: ist eine vereinfachte Transformationsmatrix <maths id="math0092" num=""><math display="inline"><msubsup><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn><mi>ʹ</mi></msubsup></math><img id="ib0092" file="imgb0092.tif" wi="8" he="10" img-content="math" img-format="tif" inline="yes"/></maths> für <i>N</i>= 64 dargestellt.</p><p id="p0183" num="0183">In Fig. 4, links ist die vollbesetzte Matrix <maths id="math0093" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn></msub></math><img id="ib0093" file="imgb0093.tif" wi="8" he="9" img-content="math" img-format="tif" inline="yes"/></maths> zu sehen und im Vergleich dazu in Fig. 4<!-- EPO <DP n="42"> --> rechts die vereinfachte Matrix <maths id="math0094" num=""><math display="inline"><msubsup><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn><mi>ʹ</mi></msubsup></math><img id="ib0094" file="imgb0094.tif" wi="8" he="9" img-content="math" img-format="tif" inline="yes"/></maths> in symmetrischer Toeplitz-ähnlicher Struktur. Wie zu erkennen ist, ist durch die Vereinfachung ein großer Teil der Koeffizienten abseits der Hauptdiagonalen von <maths id="math0095" num=""><math display="inline"><msubsup><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn><mi>ʹ</mi></msubsup></math><img id="ib0095" file="imgb0095.tif" wi="8" he="9" img-content="math" img-format="tif" inline="yes"/></maths> gleich Null.</p><p id="p0184" num="0184"><figref idrefs="f0007">Fig. 5</figref> stellt die Impulsantworten der MDCT-MDST-Transformationsmatrizen dar. Im Speziellen ist in <figref idrefs="f0007">Fig. 5</figref> die ursprüngliche Impulsantwort der 33. Spalte der Matrix <maths id="math0096" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn></msub></math><img id="ib0096" file="imgb0096.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> dargestellt (durchgezogene Linie). Im Vergleich dazu ist zusätzlich die entsprechende durch den Kopiervorgang und Spiegelung entstandene Impulsantwort der neuen Matrix <maths id="math0097" num=""><math display="inline"><msubsup><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn><mi>ʹ</mi></msubsup></math><img id="ib0097" file="imgb0097.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> zu sehen. Das Ausschneiden der Werte erfolgt mit einem Rechteckfenster mit dem Fensterindex σ = 6.</p><p id="p0185" num="0185">Diese Art der Vereinfachung der MDCT-MDST-Transformation liefert nicht das exakte MDST-Spektrum, wie es durch die Berechnung nach Gleichung 4.8 entsteht. Durch die durchgeführten Vereinfachung der Matrizen <maths id="math0098" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn></msub></math><img id="ib0098" file="imgb0098.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> und <maths id="math0099" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>2</mn></msub></math><img id="ib0099" file="imgb0099.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> wird dem Spektrum ein Fehler hinzugefügt. Dieser bewirkt eine Reduzierung des Signal-Rausch-Abstands auf circa -70 dB, wie in <figref idrefs="f0008">Fig. 6</figref> gezeigt ist. <figref idrefs="f0008">Fig. 6</figref> zeigt eine Schätzung des MDST-Spektrums für weißes Rauschen. An den Randbereichen des Spektrums steigt der Fehler der Abschätzung des MDST-Spektrums. Dieser Effekt ist der ungenauen Abschätzung der Matrixkoeffizienten nahe den Enden der Hauptdiagonalen geschuldet. Der erzeugte Fehler wird durch die Hochpassfilterung des HSBE-Algorithmus reduziert und ist somit nur noch in hohen Frequenzen vorhanden.</p><p id="p0186" num="0186">Nun wird die Anpassung der harmonischen Struktur des Frequenzspektrums erläutert.</p><p id="p0187" num="0187">Ein Vorteil des HSBE-Verfahrens ist die Beibehaltung der harmonischen Struktur nach der Bandbreitenerweiterung. Wie bereits erwähnt, geschieht dies durch eine Phasenmanipulation im komplexen MDCT-/MDST-Bereich. Betrachtet wird dazu das kopierte Spektralband mit der Bandbreite <i>B = f<sub>max</sub> - f<sub>g</sub>.</i> Ziel ist es, das Spektrum so nach unten zu verschieben, dass die erste Harmonische in diesem Band (beispielsweise mit der Frequenz <i>f<sub>H,n</sub> &gt; f<sub>g</sub>)</i> nach der Verschiebung auf der Frequenz der höchsten Harmonischen im Basisband der Frequenz <i>f<sub>H,α</sub></i> &lt; <i>f<sub>g</sub></i> zu liegen kommt. Der Abstand der Frequenzen <i>f<sub>H</sub>,<sub>n</sub></i> und <i>f<sub>H,α</sub></i> wird als Lag-Frequenz <i>f<sub>lag</sub></i> bezeichnet.</p><p id="p0188" num="0188">Über diese Frequenz wird die Anpassung der harmonischen Struktur geregelt. Diese Frequenz kann auch als entsprechendes ganzzahliges und nichtganzzahliges Vielfaches von MDCT-Teilbändern dargestellt werden, um die das Frequenzband nach unten zu verschieben ist. Damit wird eine maximale Flexibilität des entwickelten Verfahrens<!-- EPO <DP n="43"> --> ermöglicht. Nachdem die oben genannte Bedingung erreicht ist, werden alle MDCT-Koeffizienten mit einer diskreten Frequenz kleiner <i>f<sub>g</sub></i> auf Null gesetzt, damit sich Basisband und verschobenes Band nicht überlagern.</p><p id="p0189" num="0189">In <figref idrefs="f0009">Fig. 7</figref> ist das gewünschte Ergebnis des HSBE-Verfahrens für ein tonales Signal schematisch dargestellt. <figref idrefs="f0009">Fig. 7</figref> zeigt dabei die Harmonische Struktur bei HSBE. In <figref idrefs="f0009">Fig. 7</figref>, links ist das ursprüngliches Breitbandspektrum gezeigt. In <figref idrefs="f0009">Fig. 7</figref>, rechts ist das Spektrum nach der HSBE HF-Rekonstruktion gezeigt.</p><p id="p0190" num="0190">Dabei bleibt die ursprüngliche harmonische Struktur erhalten. Durch die erläuterte Verschiebung des hochfrequenten replizierten Bandes zu Frequenzen kleiner der Grenzfrequenz <i>f<sub>g</sub></i> wird kein harmonischer Teilton ausgelassen. Die Verschiebung des Spektrums kann damit als Einseitenbandmodulation des hochpassgefilterten Basisbandsignals mit der Modulationsfrequenz <i>f<sub>mod</sub></i> interpretiert werden. Es gilt: <maths id="math0100" num="(4.11)"><math display="block"><msub><mi mathvariant="italic">f</mi><mi mathvariant="italic">mod</mi></msub><mo>=</mo><msub><mi mathvariant="italic">f</mi><mi mathvariant="italic">g</mi></msub><mo>-</mo><msub><mi mathvariant="italic">f</mi><mi mathvariant="italic">lag</mi></msub></math><img id="ib0100" file="imgb0100.tif" wi="116" he="9" img-content="math" img-format="tif"/></maths></p><p id="p0191" num="0191">Es ist dabei darauf zu achten, dass bei Frequenzen <i>f<sub>lag</sub></i> größer der halben Bandbreite eines MDCT-Bands durch die Verschiebung MDCT-Koeffizient nahe <i>f = f<sub>max</sub></i> zu Null werden. Diese können mit Rauschen aufgefüllt werden. Ist die Frequenz <i>f<sub>lag</sub></i> kleiner der halben Bandbreite eines MDCT-Bands ist dies nicht nötig, da kein MDCT-Koeffizient zu Null gesetzt wird.</p><p id="p0192" num="0192">Nachfolgend wird die Anpassung nicht-ganzzahliger Teilbänder erläutert.</p><p id="p0193" num="0193">Die Erhaltung der harmonischen Struktur ist dann kompliziert, wenn ein MDCT-Band im Vergleich zu der Frequenzdifferenz aufeinanderfolgender Teiltöne der harmonischen Struktur eine hohe Bandbreite aufweist. Wird die Modulation nur mit Frequenzen durchgeführt, die ein ganzzahliges Vielfaches der Bandbreite eines MDCT-Bandes darstellen, so ist die Auflösung der harmonischen Rekonstruktion dann stark begrenzt und eine feine harmonische Struktur kann damit folglich nicht wiederhergestellt werden. Es ist daher notwendig, eine hohe Genauigkeit der Modulation zu ermöglichen, so dass das Spektrum des Basisbands nicht nur um ganzzahlige Vielfache der MDCT-Band-Bandbreite moduliert werden kann, sondern auch um Bruchteile davon.</p><p id="p0194" num="0194">Mit dem folgenden Ansatz ist es möglich, das Spektrum innerhalb der Bandbreite eines MDCT-Teilbands zu verschieben. Das Verfahren basiert auf einer Modifizierung der Phase<!-- EPO <DP n="44"> --> des komplexen MDCT-/MDST-Spektrums. Die Phase wird dabei in Abhängigkeit des zeitlichen Verlaufs des Signals um eine normierte Frequenzverschiebung <i>ϕ</i> gedreht. Diese zeitliche Rotation des Phasenwinkels ermöglicht so eine sehr feine Verschiebung des Spektrums. Es gilt: <maths id="math0101" num="(4.12)"><math display="block"><msub><munder><mi mathvariant="bold">X</mi><mo>̲</mo></munder><mi mathvariant="italic">mod</mi></msub><mfenced><mi>b</mi></mfenced><mo>=</mo><munder><mi mathvariant="bold">X</mi><mo>̲</mo></munder><mfenced><mi>b</mi></mfenced><mo>⋅</mo><msup><mi mathvariant="normal">e</mi><mrow><mo>-</mo><mi mathvariant="normal">j</mi><mo>⋅</mo><mi>b</mi><mo>⋅</mo><mi>φ</mi><mo>⋅</mo><mfrac><mi>π</mi><mrow><mn>180</mn><mo>⁢</mo><mi>°</mi></mrow></mfrac></mrow></msup></math><img id="ib0101" file="imgb0101.tif" wi="109" he="9" img-content="math" img-format="tif"/></maths></p><p id="p0195" num="0195">Dabei ist <b><u>X</u></b>(<i>b</i>) die <i>b</i>-te Spalte der komplexen Matrix <maths id="math0102" num=""><math display="inline"><munder><mi mathvariant="bold">x</mi><mo> ∼</mo></munder><mo>=</mo><msub><munder><mi mathvariant="bold">x</mi><mo> ∼</mo></munder><mi mathvariant="italic">MDCT</mi></msub><mo>+</mo><mi mathvariant="normal">j</mi><mo>⋅</mo><msub><munder><mi mathvariant="bold">x</mi><mo> ∼</mo></munder><mi mathvariant="italic">MDST</mi></msub></math><img id="ib0102" file="imgb0102.tif" wi="35" he="8" img-content="math" img-format="tif" inline="yes"/></maths> und <i>ϕ</i> die normierte Frequenzverschiebung in Grad. Theoretisch sind für <i>ϕ</i> beliebige Winkel möglich, aber aus praktischen Gründen ist der Wertebereich stark begrenzt und liegt im Intervall [-90, 90] c Z. Es ist mit diesem Intervall möglich, Modulationen zu berechnen, die die Bandbreite eines MDCT-Bands abdecken. Durch die Festlegung der normierten Frequenzverschiebung auf das angegebene Intervall kann das Spektrum um je die halbe MDCT-Band-Bandbreite zu hohen oder zu niedrigen Frequenzen verschoben werden.</p><p id="p0196" num="0196">Für die komplexe Exponentialfunktion <maths id="math0103" num=""><math display="inline"><msup><mi mathvariant="normal">e</mi><mrow><mo>-</mo><mi mathvariant="normal">j</mi><mo>⋅</mo><mi>b</mi><mo>⋅</mo><mi mathvariant="italic">φ</mi><mo>⋅</mo><mfrac><mi mathvariant="italic">π</mi><mrow><mn mathvariant="normal">180</mn><mo>⁢</mo><mi mathvariant="normal">°</mi></mrow></mfrac></mrow></msup><mo>,</mo></math><img id="ib0103" file="imgb0103.tif" wi="30" he="9" img-content="math" img-format="tif" inline="yes"/></maths> die von b und ϕ abhängt, kann also zunächst ein Ergebniswert berechnet werden. ϕ ist ein Winkel in Grad, der von der Frequenzdifferenz abhängt, um die die ersten Subband-Werte der Subbänder zu verschieben sind. Ein zu ermittelnder zweiter Subband-Wert kann dann dadurch ermittelt werden, dass einer der ersten Subband-Werte in <b><u>X</u></b>(<i>b</i>) mit dem Ergebniswert multipliziert wird.</p><p id="p0197" num="0197">Im Folgenden wird die Anpassung ganzzahliger Teilbänder erklärt.</p><p id="p0198" num="0198">Der eingeschränkte Wertebereich des Phasenwinkels <i>ϕ</i> erlaubt mit der eingeführten Modulation nur die Verschiebung des Spektrums von maximal der Bandbreite eines MDCT-Bands. Für Verschiebungen des Spektrums größer der Bandbreite eines MDCT-Bandes wird diese Verschiebung in zwei Teile aufgeteilt, in ein ganzzahliges Vielfaches der MDCT-Band-Bandbreite und einen Bruchteil dieser Bandbreite. Es wird dann zunächst das Spektrum um die notwendige Frequenz kleiner der Bandbreite eines MDCT-Bands nach Gleichung 4.12 moduliert und anschließend das Spektrum um ganze Spektralwerte verschoben.</p><p id="p0199" num="0199">Im Folgenden wird die Verschiebung betrachtet, die genau einem Vielfachen der Bandbreite eines MDCT-Bands entspricht. In diesem Fall gibt es einen Phasenwinkel <i>ϕ</i>', der ein ganzzahliges Vielfaches von 184° ist. Damit kann die Verschiebung des Spektrums um ganze MDCT-Spektralwerte als Spezialfall des oben eingeführten Verfahrens für nichtganzzahlige Teilbänder betrachtet werden. Die Auswertung der komplexen<!-- EPO <DP n="45"> --> Modulationsfunktion in Gleichung 4.12 liefert dann folgende Ergebnisse. Ist das Produkt aus dem Blockindex <i>b</i> und <i>ϕ</i>' ein geradzahliges Vielfaches von 180°, ist das Ergebnis der Modulationsfunktion immer 1, andernfalls -1. Mit dieser Kenntnis ist es nicht notwendig, die Funktion in Gleichung 4.12 für die Anpassung ganzzahliger Teilbänder auszuwerten, es genügt eine simple Fallunterscheidung. Es gilt: <maths id="math0104" num="(4.13)"><math display="block"><msub><munder><mi mathvariant="bold">x</mi><mo>̲</mo></munder><mi mathvariant="italic">mod</mi></msub><mo>⁢</mo><mfenced separators=""><mi>b</mi><mo>,</mo><mn>0</mn><mo>:</mo><mi>N</mi><mo>-</mo><mi>τ</mi><mo>-</mo><mn>1</mn></mfenced><mo>=</mo><mrow><mo>{</mo><mtable><mtr><mtd><mo>-</mo><munder><mi mathvariant="bold">x</mi><mo>̲</mo></munder><mo>⁢</mo><mfenced separators=""><mi>b</mi><mo>,</mo><mi>τ</mi><mo>:</mo><mi>N</mi><mo>-</mo><mn>1</mn></mfenced></mtd><mtd columnalign="left"><mi>wenn</mi><mspace width="1em"/><mfenced separators=""><mi>b</mi><mo>⋅</mo><mfrac><mi mathvariant="italic">φʹ</mi><mrow><mn>180</mn><mo>⁢</mo><mi>°</mi></mrow></mfrac></mfenced><mo>∈</mo><mfenced open="[" close="]" separators=""><mn>1</mn><mo>⁢</mo><mn>3</mn><mo>⁢</mo><mn>5</mn><mo>…</mo></mfenced></mtd></mtr><mtr><mtd><munder><mi mathvariant="bold">x</mi><mo>̲</mo></munder><mo>⁢</mo><mfenced separators=""><mi>b</mi><mo>,</mo><mi>τ</mi><mo>:</mo><mi>N</mi><mo>-</mo><mn>1</mn></mfenced></mtd><mtd columnalign="left"><mi>sonst</mi></mtd></mtr></mtable></mrow></math><img id="ib0104" file="imgb0104.tif" wi="137" he="19" img-content="math" img-format="tif"/></maths><br/>
mit dem ganzzahligen Modulationsindex τ: <maths id="math0105" num="(4.14)"><math display="block"><mi>τ</mi><mo>=</mo><mfrac><mi mathvariant="italic">φʹ</mi><mrow><mn>180</mn><mo>⁢</mo><mi>°</mi></mrow></mfrac></math><img id="ib0105" file="imgb0105.tif" wi="91" he="15" img-content="math" img-format="tif"/></maths></p><p id="p0200" num="0200">Dabei ist <b><u>X</u></b>(<i>b</i>, <i>τ : N</i> - 1) wieder die <i>b-te</i> Spalte der komplexen Matrix <maths id="math0106" num=""><math display="inline"><munder><mi mathvariant="bold">x</mi><mo> ∼</mo></munder><mo>=</mo><msub><munder><mi mathvariant="bold">x</mi><mo> ∼</mo></munder><mi mathvariant="italic">MDCT</mi></msub><mo>+</mo><mi mathvariant="normal">j</mi><mo>⋅</mo><msub><munder><mi mathvariant="bold">x</mi><mo> ∼</mo></munder><mi mathvariant="italic">MDST</mi></msub></math><img id="ib0106" file="imgb0106.tif" wi="39" he="8" img-content="math" img-format="tif" inline="yes"/></maths> mit dem Unterschied, dass hier nur die Vektorelemente beginnend bei τ bis zum letzten Element N genutzt werden. Dieses Ausschneiden von Vektorelementen entspricht der oben angesprochenen Hochpassfilterung des komplexen MDCT-/MDST-Spektrums.</p><p id="p0201" num="0201">Für die Anwendung der Modulation wird die Modulationsfrequenz in Abhängigkeit von <i>f<sub>lag</sub></i> in den Modulationsindex τ und den Phasenwinkel <i>ϕ</i> überführt. Dazu wird zunächst die Frequenz <i>f<sub>lag</sub></i> auf die Hälfte der Abtastfrequenz <i>f<sub>s</sub></i> normiert. Anschließend wird die äquivalente Verschiebung in MDCT-Bändern <i>ϕ<sub>lag</sub></i> ermittelt und der Modulationsindex <i>τ</i> sowie der Phasenwinkel <i>ϕ</i> berechnet: <maths id="math0107" num="(4.15)"><math display="block"><msub><mi>ω</mi><mi mathvariant="italic">lag</mi></msub><mo>=</mo><msub><mi>f</mi><mi mathvariant="italic">lag</mi></msub><mo>⋅</mo><mn>2</mn><mo>/</mo><msub><mi>f</mi><mi>s</mi></msub></math><img id="ib0107" file="imgb0107.tif" wi="72" he="9" img-content="math" img-format="tif"/></maths> <maths id="math0108" num="(4.16)"><math display="block"><msub><mi>φ</mi><mi mathvariant="italic">lag</mi></msub><mo>=</mo><mi>N</mi><mo>⋅</mo><msub><mi>ω</mi><mi mathvariant="italic">lag</mi></msub></math><img id="ib0108" file="imgb0108.tif" wi="71" he="8" img-content="math" img-format="tif"/></maths> <maths id="math0109" num="(4.17)"><math display="block"><mi>τ</mi><mo>=</mo><mo>⌈</mo><msub><mi>φ</mi><mi mathvariant="italic">lag</mi></msub><mo>⌉</mo></math><img id="ib0109" file="imgb0109.tif" wi="71" he="9" img-content="math" img-format="tif"/></maths> <maths id="math0110" num="(4.18)"><math display="block"><mi>φ</mi><mo>=</mo><mo>⌊</mo><mfenced separators=""><msub><mi>φ</mi><mi mathvariant="italic">lag</mi></msub><mo>-</mo><mi>τ</mi></mfenced><mo>⋅</mo><mn>180</mn><mo>⁢</mo><mi>°</mi><mo>⌋</mo></math><img id="ib0110" file="imgb0110.tif" wi="72" he="10" img-content="math" img-format="tif"/></maths></p><p id="p0202" num="0202">Durch die Kombination beider Verfahren ist es möglich, variable Patchverhältnisse zu realisieren. Das Patchverhältnis ist dabei das Verhältnis der maximal möglichen Signalfrequenz <i>f</i><sub>max</sub> zur Grenzfrequenz des Basisbands <i>f<sub>g</sub></i>. Ein Patchverhältnis von 2 : 1<!-- EPO <DP n="46"> --> besagt beispielsweise, dass eine einzelne Kopie des Basisbands erstellt und moduliert wird (vgl. <figref idrefs="f0003">Fig. 2</figref>). Patchverhältnisse größer 2 : 1 treten bei niedrigen oder schwankenden Übertragungsraten auf. Solche Verhältnisse werden ähnlich wie bei der CM-BWE (siehe oben) realisiert, indem das Basisband mehrmals kopiert und moduliert wird. Hier ist auch zu beachten, dass mit jeder Kopie des Basisbands die erforderliche Lag-Frequenz um <i>f<sub>lag</sub></i> erhöht wird, wie in <figref idrefs="f0010">Fig. 8</figref> für ein Patchverhältnis von 2,5 : 1 dargestellt ist.</p><p id="p0203" num="0203"><figref idrefs="f0010">Fig. 8</figref> stellt ein Schema der erweiterten HSBE-HF-Rekonstruktion dar. In <figref idrefs="f0010">Fig. 8</figref> links ist Kopieren und Verschieben des Basisbands dargestellt. In <figref idrefs="f0010">Fig. 8</figref>, rechts ist das Spektrum nach der Anpassung der spektralen Einhüllenden zu sehen.</p><p id="p0204" num="0204">Nachfolgend werden Konzepte zur Unterdrückung auftretender Störkomponenten beschrieben. Die hier beschriebenen Konzepte können beispielsweise in der Filtereinheit 330 der <figref idrefs="f0004">Fig. 3</figref> zur Anwendung kommen.</p><p id="p0205" num="0205">Die Modulation des Spektrums im MDCT-Bereich ist nicht problemlos möglich. Durch eine Modulation des Spektrums ist eine perfekte Rekonstruktion bei der inversen MDCT nicht mehr möglich. Die Ursache liegt in den entstandenen Time-Domain-Aliasing-Komponenten. Durch die Modulation des Spektrums wird die Energie dieser Störkomponenten umverteilt. Die TDAC Eigenschaft der MDCT wird dadurch verletzt und kann diese Komponenten bei der inversen Transformation dann nicht mehr auslöschen. Bei einer Betrachtung des modulierten Signals nach der inversen MDCT zeigen sich im DFT-Betragsfrequenzgang aus diesem Grund Störkomponenten. Diese Aliasing-Komponenten weisen bei Verschiebung des Spektrums um <i>ϕ</i> = 0° und τ &gt; 0 nur eine sehr geringe Amplitude auf und liegen im ersten beziehungsweise letzten MDCT-Band. In diesem Fall ist es nicht notwendig, diese Komponenten zu reduzieren. Bei Verschiebungsfaktoren <i>ϕ</i> ≠ 0° ist die Amplitude der entstehenden Störkomponenten wesentlich größer. Sie sind dann deutlich hörbar. Eine Behandlung dieser Komponenten findet daher statt.</p><p id="p0206" num="0206"><figref idrefs="f0011">Fig. 9</figref> zeigt Aliasing-Komponenten für <i>ϕ</i> = 45°: <i>y<sub>ref</sub></i> ist dabei ein ursprünglicher Sinuston; <i>y<sub>mod</sub></i> ist ein modulierter Sinuston mit Aliasing-Komponenten,zur besseren Darstellung ist die DCT-IV Filterbank gestreckt.</p><p id="p0207" num="0207">Im Einzelnen ist in <figref idrefs="f0011">Fig. 9</figref> ist der Betragsfrequenzgang eines mit <i>ϕ</i> = 45° verschobenen Sinustons (<i>y<sub>mod</sub></i>) zu sehen. Die Frequenz des ursprünglichen Sinustons (<i>y<sub>ref</sub></i>) entspricht der Bandmitte des 12. MDCT-Bands. Das gesamte Spektrum ist durch den gewählten Phasenwinkel um ein Viertel der Bandbreite eines MDCT-Bands zu hohen Frequenzen hin moduliert. Wie zu erkennen ist, liegen die acht dominanten Aliasing-Komponenten in<!-- EPO <DP n="47"> --> jeweils jedem zweiten Band unter- und oberhalb des 12. MDCT-Bands. Diese Eigenschaft der Aliasing-Komponenten ist für jedes beliebige Signal gegeben. Das liegt daran, da sich jedes Signal in eine gewichtete Summe von Sinus- und Cosinusschwingungen zerlegen lässt (siehe oben). Für jede dieser Teilschwingungen entsteht bei der Modulation nach Gleichung 4.12 dieses spezielle Muster der Aliasing-Komponenten. Mit dieser Kenntnis lässt sich ein Verfahren entwickeln, das erlaubt, jedes beliebige Signal von den unerwünschten Störkomponenten zu befreien. Dabei genügt es, die Aliasing-Komponenten, die durch die Modulation eines Sinussignals entstehen, zu analysieren und auszulöschen.</p><p id="p0208" num="0208">Im Folgenden werden Konzepte zur Anti-Aliasing Filterung bereitgestellt.</p><p id="p0209" num="0209">Durch die zeitliche Überlappung der Blöcke für das TDA entstehen im Frequenzbereich zusätzliche Signalanteile. Diese sind als Störanteile im Spektrum des bandbreitenerweiterten Signals vorhanden, da sie bei der inversen Transformation durch die Verschiebung im Frequenzbereich nicht ausgelöscht werden. Diese als Spitzen im FFT-Spektrum erkennbaren Störer (vgl. <figref idrefs="f0011">Fig. 9</figref>) werden bei einer MDCT durch die geringe Sperrbanddämpfung der DCT-IV-Filterbank von nur circa 15 dB durch eine Summe von Anteilen in mehreren der überlappenden MDCT-Bänder dargestellt. Die Energie der Störer im hochauflösenden DFT-Spektrum kann daher als Summenbildung der Energie mehrerer MDCT-Bänder betrachtet werden.</p><p id="p0210" num="0210">Aufgrund dieses Zusammenhangs wird ein Filter zur Minderung der Störkomponenten im MDCT-Bereich bereitgestellt. Das Filter basiert dabei auf einer sequentiellen Summierung der mit den Filterkoeffizienten gewichteten Frequenzwerte. Die Ausdehnung des Filters um einen zentrierten Frequenzwert repräsentiert dabei den Frequenzbereich, in dem die Störkomponenten ausgelöscht werden. Für jede dominante Aliasing-Komponente wird ein Filterkoeffizient benötigt, der diese minimiert. Das Filter hängt von der Frequenzverschiebung <i>ϕ</i> ab. Es gilt: <maths id="math0111" num="(4.19)"><math display="block"><msub><munder><mi mathvariant="bold">X</mi><mo>̲</mo></munder><mi mathvariant="italic">AntiAlias</mi></msub><mfenced><mi>b</mi></mfenced><mo>=</mo><munder><mi mathvariant="bold">X</mi><mo>̲</mo></munder><mfenced><mi>b</mi></mfenced><mo>*</mo><munder><mi mathvariant="bold">h</mi><mo>̲</mo></munder><mfenced><mi>φ</mi></mfenced></math><img id="ib0111" file="imgb0111.tif" wi="86" he="8" img-content="math" img-format="tif"/></maths></p><p id="p0211" num="0211">Dabei ist <b><u>h</u></b>(<i>ϕ</i>) das reelle Anti-Aliasing-Filter für einen bestimmten Phasenwinkel <i>ϕ</i> und <b><u>X</u></b>(<i>b</i>) das komplexe MDCT-/MDST-Spektrum. Das Spektrum nach der Filterung (<b><u>X</u></b><i><sub>AntiAlia</sub></i>(<i>b</i>)) ist hierbei länger als das ursprüngliche Spektrum <b><u>X</u></b>(<i>b</i>). Daher ist das Spektrum zu beschneiden, damit es wieder der Transformationslänge N entspricht. Es wird der Teil des Spektrums entfernt, in dem das Filter ein- und ausschwingt. Dazu wird am<!-- EPO <DP n="48"> --> Anfang und am Ende das Faltungsprodukt im komplexen MDCT-/MDST-Bereich jeweils um die halbe Filterlänge beschnitten.</p><p id="p0212" num="0212">In <figref idrefs="f0012">Fig. 10</figref> ist die Filterimpulsantwort des Anti-Aliasing-Filters (AAF) für <i>ϕ</i> = 90° zu sehen. Am Beispiel eines einzelnen Sinustons ist es mit dem gezeigten Filter möglich, insgesamt sieben dominante Aliasing-Komponenten auszulöschen. Dabei liegen drei Komponenten unter der Frequenz des Sinustons. Diese Komponenten, die entsprechend ihrer Lage zur Frequenz des Sinustons als Komponenten bis zur dritten Ordnung bezeichnet werden, werden durch die Filterkoeffizienten (engl.: <i>filtertaps)</i> 0, 2 und 4 behandelt. Die Filtertaps 8, 10, 12 und 14 beseitigen vier Störkomponenten bei Frequenzen oberhalb des Sinustons, also der Komponenten bis zur vierten Ordnung. Insgesamt weist das Filter 15 Koeffizienten auf, wobei jeder zweite Wert Null ist. Das entspricht der Beobachtung oben, dass nur in jedem zweiten Band Aliasing-Komponenten auftreten.</p><p id="p0213" num="0213">Die Filterkoeffizienten der <figref idrefs="f0012">Fig. 10</figref> weisen somit eine geordnete Reihenfolge auf. Jeder Filterkoeffizient in dieser Reihenfolge hat, der auf einen Filterkoeffizienten folgt, der ungleich Null ist, hat den Wert Null.</p><p id="p0214" num="0214">Mit einer solchen Filterstruktur ist es generell möglich, beliebig viele Aliasing-Komponenten zu unterdrücken. Es genügt jedoch, die Komponenten bis zur vierten Ordnung auszulöschen. Damit wird ein Signalrauschabstand von mindestens 70 dB erreicht, was als ausreichend erachtet werden kann. Zudem fallen Aliasing-Komponenten hoher Ordnung nur bei sehr großen Phasenwinkeln <i>ϕ</i> auf. Die Beschränkung auf die Auslöschung bis zur vierten Ordnung ist daher ein guter Kompromiss zwischen erreichbarem SNR und Berechnungsaufwand für die Aliasing-Cancelation.</p><p id="p0215" num="0215">Nachfolgend wird die Optimierung der Anti-Aliasing-Filter erläutert.</p><p id="p0216" num="0216">Ein wichtiger Bestandteil der beschriebenen Aliasing-Cancelation sind die verwendeten Anti-Aliasing-Filter. Von der Wahl der geeigneten Filterkoeffizienten hängt die erreichbare Minderung der Amplitude der einzelnen Störkomponenten maßgeblich ab. Es ist daher notwendig, diese Filter so zu optimieren, dass eine möglichst hohe Unterdrückung gewährleistet ist. Ein bewährtes Verfahren dazu ist die numerische Optimierung der Filterkoeffizienten mittels sukzessiver Approximation.</p><p id="p0217" num="0217">Die sukzessive Approximation ist ein Iterationsverfahren der numerischen Mathematik und bezeichnet den Vorgang der schrittweisen Annäherung eines Rechenproblems an die exakte Lösung. Dabei wird ein Rechenverfahren wiederholt angewendet und das Ergebnis<!-- EPO <DP n="49"> --> eines Schritts als Ausgangswert für den jeweils nächsten Schritt verwendet. Die Folge der Ergebnisse soll konvergieren. Wenn der akzeptable Fehler zur exakten Lösung minimal ist, ist das Ergebnis hinreichend genau bestimmt (Jordan-Engeln und Reutter, 1978).</p><p id="p0218" num="0218">Zu Beginn des Optimierungsvorgangs wird ein Analysesignal mit Gleichung 4.12 um einen bestimmten Phasenwinkel <i>ϕ</i> moduliert. Das Analysesignal ist aus den oben genannten Gründen ein Sinuston. Die Frequenz des Tons liegt idealerweise bei einem Viertel der zugrundeliegenden Abtastfrequenz. Das hat den Vorteil, dass die entstehenden Aliasing-Komponenten bis zur vierten Ordnung den größtmöglichen Abstand zu den Rändern des Spektrums aufweisen und nicht mit anderen Störkomponenten interferieren. Für die Optimierung ist eine MDCT-Transformationslänge von 32 Abtastwerten ideal. Daraus ergibt sich, dass die Frequenz des Sinustons der Bandmitte des sechzehnten MDCT-Bands entspricht. Die Beschränkung auf diese Transformationslänge bietet einige Vorteile. Zu einem wird dadurch der Berechnungsaufwand der MDCT reduziert. Zum anderen werden die Aliasing-Komponenten bis zur vierten Ordnung ohne Interferenzen mit maximalem Abstand zueinander erzeugt. Das ist besonders für die notwendige Signalspitzenerkennung von Vorteil. Die Signalspitzenerkennung detektiert automatisch die zu unterdrückenden Aliasing-Komponenten im hochauflösenden DFT-Betragsfrequenzgang.</p><p id="p0219" num="0219">Nach der Modulation des Analysesignals werden nacheinander die Aliasing-Komponenten in einer alternierenden Reihenfolge optimiert. Dies ist notwendig, da sich die Störkomponenten gegenseitig beeinflussen. Dabei wird von der schwächsten Komponente vierter Ordnung bis zur dominantesten erster Ordnung vorgegangen. Damit ist sichergestellt, dass die Aliasing-Komponenten erster Ordnung die größtmögliche Dämpfung erhalten. Für die Direktkomponente, also den Spektralwert wofür die Aliasing-Komponenten ausgelöscht werden sollen, wird im Filter eine Eins gesetzt. Dieser Wert wird während der Optimierung nicht verändert.</p><p id="p0220" num="0220">Die eigentliche nummerische Optimierung erfolgt nach dem dargestellten Prinzip der sukzessiven Approximation. Dabei wird dem zu optimierenden Filterkoeffizienten ein Anfangswert zugewiesen, alle anderen Koeffizienten bis auf die Direktkomponente bleiben Null. Anschließend wird das komplexe MDCT-/MDST-Spektrum mit diesem Filter gefaltet und der Betragsfrequenzgang auf eine Reduktion der betreffenden Störkomponente untersucht. Ist dies der Fall, wird der Filterkoeffizient entsprechend der eingestellten Schrittweite erhöht. Dieses Vorgehen aus Untersuchung und Erhöhung wird so lange wiederholt, bis keine stärkere Unterdrückung dieser Aliasing-Komponente mehr möglich ist. Anschließend wird mit den folgenden Filterkoeffizienten auf gleiche Weise verfahren,<!-- EPO <DP n="50"> --> wobei bereits optimierte Filterkoeffizienten beibehalten werden.</p><p id="p0221" num="0221">Durch die Beeinflussung der Aliasing-Komponenten untereinander ist es sinnvoll, mehrere Iterationen dieses Vorgehens durchzurühren. Bei jeder Iteration wird dabei die Schrittweite verkleinert, mit der die Filterkoeffizienten erhöht werden. Damit steigt bei jedem Durchlauf die Qualität der optimierten Filter. Es zeigt sich, dass für ein optimales Filterset bestehend aus je einem Filter pro Phasenwinkel, drei Iterationen ausreichen. Damit ist es möglich, die Aliasing-Komponenten auf &lt; -90 dB zu reduzieren.</p><p id="p0222" num="0222"><figref idrefs="f0013">Fig. 11</figref> stellt den Einfluss der Anti-Aliasing-Filterung auf ein Sinussignal für <i>ϕ</i> = 90° dar. <i>X<sub>Alias</sub></i> ist dabei ein mit <i>ϕ</i> = 90° moduliertes Sinussignal; <i>X<sub>AntiAlias</sub></i> ist ein gefiltertes Signal mit unterdrückten Störkomponenten.</p><p id="p0223" num="0223">Im Speziellen, ist in <figref idrefs="f0013">Fig. 11</figref> der Einfluss der Anti-Aliasing-Filterung auf ein mit <i>ϕ</i> = 90° moduliertes Sinussignal im Betragsfrequenzgang zu sehen. <i>X<sub>Alias</sub></i> ist dabei das Spektrum des modulierten Signals und <i>X<sub>AntiAlias</sub></i> das des modulierten Signals, gefaltet mit dem optimierten Filter für den entsprechenden Phasenwinkel. Die mit <i>Peakerkennung</i> gekennzeichneten Spitzen im Spektrum sind die durch die Signalspitzenerkennung detektierten Aliasing-Komponenten inklusive der Direktkomponente (vierte erkannte Spitze von links). Die numerische Optimierung der Filter reduziert die Störkomponenten in diesem Beispiel im Schnitt auf -103 dB.</p><p id="p0224" num="0224">Es genügt, einmalig einen Satz von Filtern für jeden Phasenwinkel im Wertebereich zu erstellen. Für die Filterung des Signals kann dann das benötigte Filter aus einer Datenbank geladen werden.</p><p id="p0225" num="0225">Beispielsweise können die Filterkoeffizienten des Filters in Abhängigkeit von dem Phasenwinkel aus einer Datenbank oder einem Speicher einer Vorrichtung zur Erzeugung eines frequenzverschobenen Audiosignals ausgelesen werden.</p><p id="p0226" num="0226"><figref idrefs="f0014">Fig. 12</figref> zeigt die Butterfly-Struktur. Die Gewichte werden durch sukzessive Näherungen bestimmt. <figref idrefs="f0014">Fig. 12</figref> zeigt dabei die Aliasing-Reduzierung für das Subband X<sub>4</sub> (schwarze Linie). Dasselbe Verfahren ist für alle modifizierten Subbänder entsprechend durchzuführen. Zur Reduzierung der Aliasing-Komponente, die durch die Modulation von X<sub>4</sub> verursacht wird, ist X<sub>4</sub> mit den Gewichten wo bis w<sub>4</sub> zu multiplizieren und zu den Subband-Signalen X<sub>0</sub>, X<sub>2</sub>, X<sub>4</sub>, X<sub>6</sub> und X<sub>8</sub> zu addieren. Es ist zu beachten, dass das Gewicht w<sub>2</sub> immer 1 ist.<!-- EPO <DP n="51"> --></p><p id="p0227" num="0227">Umgekehrt bedeutet dies: Um einen gefilterten Subband-Wert eines der Subbänder zu erzeugen, ist eine Summe aus dem ungefilterten Subband-Wert dieses Subbands und weiteren Summanden zu bilden. (das Gewicht/der Filterkoeffizient w<sub>2</sub>, der auf den ungefilterten Subband-Wert dieses Subbands angewandt würde, ist w<sub>2</sub>=1). Die weiteren Summanden sind gewichtete Subband-Werte, nämlich jeweils ein Subband-Wert anderer Subbänder, die mit den anderen Gewichten/Filterkoeffizienten multipliziert bzw. gewichtet wurden.</p><p id="p0228" num="0228">Im Folgenden wird die Rekonstruktion der spektralen Einhüllenden beschrieben.</p><p id="p0229" num="0229">Die Rekonstruktion der spektralen Einhüllenden erfolgt über eine LPC-Filterung. Dabei werden im Encoder durch ein lineares Prädiktionsfilter die tonalen Anteile des Signals entfernt und als LPC-Koeffizienten separat übertragen. Die dazu benötigten Filterkoeffizienten können durch die Levinson-Durbin-Rekursion berechnet werden (Larsen und Aarts, 2004). Als Ergebnis erhält das Basisband im Decoder eine weiße Spektralcharakteristik. Nach der Bandbreitenerweiterung mittels HSBE wird eine inverse Filterung mit den LPCKoeffizienten durchgeführt und so dem Signal die ursprüngliche spektrale Einhüllende wieder aufgeprägt.</p><p id="p0230" num="0230"><figref idrefs="f0015">Fig. 13</figref> zeigt eine HSBE-LPC-Hüllkurvenanpassung. Dabei stellt <i>X</i> ein BWE-Signal vor der Hüllkurvenanpassung dar. <i>X<sub>iLPC</sub></i> ist ein BWE-Signal nach der Hüllkurvenanpassung.</p><p id="p0231" num="0231">Im Speziellen sind in <figref idrefs="f0015">Fig. 13</figref> die DFT-Betragsfrequenzgänge eines mit HSBE bandbreitenerweiterten Signals zu sehen. Vor der Rekonstruktion der spektralen Einhüllenden weist das Signal <i>X</i> die angesprochene weiße Signalcharakteristik auf. Nach der Anpassung der Einhüllenden durch die inverse LPC-Filterung entspricht die Einhüllende der ursprünglichen Spektralcharakteristik. In der <figref idrefs="f0015">Fig. 13</figref> ist zudem die Übertragungsfunktion des genutzten LPC-Filters zu sehen. Für eine hinreichend genaue Beschreibung der spektralen Einhüllenden reichen schon wenige Filterkoeffizienten aus, in diesem Beispiel werden 14 LPC-Filtertaps verwendet. Die Hüllkurvenrekonstruktion ist kein fester Bestandteil von HSBE und kann durch andere Verfahren ausgetauscht werden.</p><p id="p0232" num="0232">Im Rahmen einer Evaluation wird hier nun eine Auswertung der bereitsgestellten Konzepte durchgeführt. Dazu zählt sowohl ein Vergleich zwischen dem neuen Verfahren der harmonischen Spektralbanderweiterung und der Bandbreitenerweiterung mittels CM-BWE als auch die Untersuchung der Effizienz von HSBE bezüglich der Möglichkeiten und Grenzen sowie dem algorithmischen Berechnungsaufwand.</p><p id="p0233" num="0233">Zunächst wird hier nun ein Vergleich der Spektralbandreplikationsverfahren präsentiert.<!-- EPO <DP n="52"> --></p><p id="p0234" num="0234">Die Bandbreitenerweiterung mittels kontinuierlicher Einseitenbandmodulation ist ein Zeitbereichsverfahren. Für die Anwendung wird daher stets ein Zeitsignal benötigt. Da nach der Bandbreitenerweiterung eine Hüllkurven- und Tonalitätsanpassung stattfindet, wofür jeweils ein Signal im Spektralbereich benötigt wird, muss bei Anwendung des CM-BWE-Verfahrens das bandbreitenerweiterte Signal wieder in den Frequenzbereich transformiert werden. Diese Transformation in den Zeit- und wieder in den Frequenzbereich entfällt bei der harmonischen Spektralbanderweiterung, da sie im MDCT-/MDST-Bereich arbeitet.</p><p id="p0235" num="0235">Zusätzlich ist das Zeitsignal vor Anwendung der kontinuierlichen Einseitenbandmodulation in ein analytisches Signal umzuwandeln. Die Berechnung des benötigten analytischen Signals ist problematisch, da sie über einen Hilbert-Transformator realisiert wird. Die ideale Übertragungsfunktion der Hilbert-Transformation ist die Vorzeichenfunktion. Diese Funktion kann im Zeitbereich nur durch ein unendlich langes Filter dargestellt werden. Mit einem realisierbaren Filter mit endlicher Impulsantwort ist nur eine Annäherung des idealen Hilbert-Transformators möglich. Zudem ist das Signal nach der angenäherten Hilbert-Transformation nicht perfekt analytisch. Die Güte des berechneten pseudo-analytischen Signals hängt daher von der Länge des verwendeten Filters ab.</p><p id="p0236" num="0236">Auch für die Anwendung der harmonischen Spektralbanderweiterung ist eine zusätzliche Transformation nötig. Da HSBE im Frequenzbereich arbeitet, ist für die Berechnung der Phasenmodulation ein komplexes Spektrum erforderlich. In der Decoder-Struktur liegen vor Anwendung der Bandbreitenerweiterung jedoch nur MDCT-Koeffizienten vor. Daher ist eine Überführung der MDCT-Koeffizienten in den MDST-Bereich durchzuführen, um ein komplexes Spektrum zu erhalten und somit die benötigte Phaseninformation zu erlangen. Dies wird hier beispielhaft als über eine Matrixmultiplikation realisiert angesehen, die durch Vereinfachung einer inversen MDCT-Transformation und anschließender MDST-Transformation entstanden ist. Wie gezeigt, lässt sich der dazu benötigte Berechnungsaufwand stark minimieren und dennoch eine exakte Berechnung der MDST-Koeffizienten durchführen.</p><p id="p0237" num="0237">Wird der schematische Aufbau des Betragsfrequenzgangs nach Anwendung von CM-BWE und HSBE betrachtet, dann ist erkenntlich, dass ein Teil des Spektrums bei CM-BWE durch weißes Rauschen aufgefüllt werden muss. In diesem Bereich geht die harmonische Struktur verloren, da hier einzelne harmonische Teiltöne nicht repliziert werden können. Diese Problematik ist bei Anwendung von HSBE nicht gegeben. Die harmonische Struktur<!-- EPO <DP n="53"> --> wird ohne Lücken fortgesetzt.</p><p id="p0238" num="0238">Im Folgenden wird nun die Komplexität der harmonischen Spektralbanderweiterung betrachtet.</p><p id="p0239" num="0239">Die Effizienz der neuen harmonischen Spektralbanderweiterung hängt von dem benötigten Berechnungsaufwand und Speicherplatz ab. Die Untersuchung dieser Faktoren basiert auf der Implementierung des Algorithmus in der Programmiersprache C. Bei der algorithmischen Umsetzung wird viel Wert auf eine Minimierung der Anzahl der Berechnungsschritte gelegt. Zu den rechenintensivsten Schritten gehören dennoch die Transformation der MDCT-Koeffizienten in MDST-Spektralwerte sowie die Anti-Aliasing-Filterung. Die Modulation zur harmonisch richtigen Replikation des Spektrums ist vergleichsweise einfach, da die Verschiebung um den Modulationsindex τ nur einem Kopiervorgang entspricht und die Phasendrehung um den Winkel ϕ sich auf eine komplexe Multiplikation pro Spektralwert reduzieren lässt. Die Anpassung der spektralen Einhüllenden fließt in diese Betrachtung nicht mit ein. Da sie kein Evaluation wesentlicher Bestandteil des HSBE-Verfahrens ist, wird sie nicht algorithmisch umgesetzt.</p><p id="p0240" num="0240">In die Auswertung fließen alle relevanten Befehle wie Additionen (ADD), Multiplikationen (MULT) und die bei der Anti-Aliasing-Filterung durchgeführten Multiply-and-Accumulate (MAC) Befehle ein. In Tabelle 5.1 sind die Ergebnisse für die Modulation und Filterung des Spektrums zusammengefasst. Sie beziehen sich auf die Funktion local_HSBEpatching(), worin die entsprechenden Algorithmen implementiert sind.
<tables id="tabl0001" num="0001"><table frame="topbot"><title>Tabelle 5.1</title><tgroup cols="12" colsep="0"><colspec colnum="1" colname="col1" colwidth="14mm"/><colspec colnum="2" colname="col2" colwidth="14mm"/><colspec colnum="3" colname="col3" colwidth="14mm"/><colspec colnum="4" colname="col4" colwidth="14mm"/><colspec colnum="5" colname="col5" colwidth="14mm"/><colspec colnum="6" colname="col6" colwidth="14mm"/><colspec colnum="7" colname="col7" colwidth="14mm"/><colspec colnum="8" colname="col8" colwidth="14mm"/><colspec colnum="9" colname="col9" colwidth="14mm"/><colspec colnum="10" colname="col10" colwidth="14mm"/><colspec colnum="11" colname="col11" colwidth="14mm"/><colspec colnum="12" colname="col12" colwidth="14mm"/><thead><row><entry valign="top"><b>N</b></entry><entry valign="top">2</entry><entry valign="top">4</entry><entry valign="top">8</entry><entry valign="top">16</entry><entry valign="top">32</entry><entry valign="top">64</entry><entry valign="top">128</entry><entry valign="top">256</entry><entry valign="top">512</entry><entry valign="top">1024</entry><entry valign="top">2048</entry></row></thead><tbody><row><entry><b>ADD</b></entry><entry>4</entry><entry>8</entry><entry>16</entry><entry>32</entry><entry>64</entry><entry>128</entry><entry>256</entry><entry>512</entry><entry>1024</entry><entry>2048</entry><entry>4096</entry></row><row><entry><b>ABS</b></entry><entry>1</entry><entry>1</entry><entry>1</entry><entry>1</entry><entry>1</entry><entry>1</entry><entry>1</entry><entry>1</entry><entry>1</entry><entry>1</entry><entry>1</entry></row><row><entry><b>MULT</b></entry><entry>6</entry><entry>12</entry><entry>24</entry><entry>48</entry><entry>96</entry><entry>192</entry><entry>384</entry><entry>768</entry><entry>1536</entry><entry>3042</entry><entry>6144</entry></row><row><entry><b>MAC</b></entry><entry>16</entry><entry>32</entry><entry>64</entry><entry>128</entry><entry>256</entry><entry>512</entry><entry>1024</entry><entry>2048</entry><entry>4096</entry><entry>8192</entry><entry>16384</entry></row></tbody></tgroup></table></tables></p><p id="p0241" num="0241">Tabelle 5.1 stellt die Komplexität der Modulation und Anti-Aliasing-Filterung von HSBE tabellarisch dar. Die Auflistung beinhaltet die Anzahl der relevanten Operationen in Abhängigkeit der Transformationslänge N. Für die Modulation des Spektrums werden insgesamt 10241 Operationen für <i>N</i> = 2048 benötigt, davon 2N Additionen und 3N Multiplikationen. Wesentlich höher fällt der Aufwand für die benötigte Aliasing-Cancelation<!-- EPO <DP n="54"> --> aus. Hier werden 16384 MAC-Operationen durchgeführt. Das entspricht der Anzahl der nicht-Null Elemente des Anti-Aliasing-Filters multipliziert mit der Transformationslänge, in diesem Fall also 8N (Vergleiche die Ausführungen zur Anti-Aliasing Filterung oben). Mit diesem Ergebnis ergibt sich für den Rechenaufwand der Modulation sowie der AAF ein linearer Zusammenhang mit der Komplexität <sup>O(N)</sup>.</p><p id="p0242" num="0242">In <figref idrefs="f0016">Fig. 14</figref> ist dieser Zusammenhang grafisch dargestellt. Dabei stellt <figref idrefs="f0016">Fig. 14</figref> die Komplexität der Modulation und Anti-Aliasing-Filterung von HSBE dar.</p><p id="p0243" num="0243">Ein zentrales Element der harmonischen Spektralbanderweiterung ist die Transformation des Signals mittels MDCT und MDST. Ähnlich der schnellen Fouriertransformation wird auch für diese Transformationen ein schneller Algorithmus verwendet. Die Struktur der zugrundeliegenden schnellen DCT-IV wird weiter unten erläutert. Die Ergebnisse der Auswertung beziehen sich auf die Funktion fmdcst1d(), in der die schnelle MDCT/MDST nach dem oben beschriebenen Polyphasenansatz implementiert ist. Die Analyse der MDCT und MDST ist in Tabelle 5.2 zusammengefasst.
<tables id="tabl0002" num="0002"><table frame="topbot"><title>Tabelle 5.2 - Komplexität der schnellen MDCT/MDST</title><tgroup cols="7" colsep="0"><colspec colnum="1" colname="col1" colwidth="14mm"/><colspec colnum="2" colname="col2" colwidth="14mm"/><colspec colnum="3" colname="col3" colwidth="14mm"/><colspec colnum="4" colname="col4" colwidth="14mm"/><colspec colnum="5" colname="col5" colwidth="14mm"/><colspec colnum="6" colname="col6" colwidth="14mm"/><colspec colnum="7" colname="col7" colwidth="15mm"/><thead><row><entry valign="top"><b>N</b></entry><entry valign="top">2</entry><entry valign="top">8</entry><entry valign="top">32</entry><entry valign="top">128</entry><entry valign="top">512</entry><entry valign="top">2048</entry></row></thead><tbody><row><entry><b>ADD</b></entry><entry>5</entry><entry>106</entry><entry>1046</entry><entry>6630</entry><entry>35974</entry><entry>181094</entry></row><row><entry><b>MULT</b></entry><entry>7</entry><entry>40</entry><entry>204</entry><entry>956</entry><entry>4348</entry><entry>19452</entry></row></tbody></tgroup></table></tables></p><p id="p0244" num="0244">Die Auswertung dieser Ergebnisse zeigt, dass insgesamt circa 9·<i>N</i>|d<i>N</i> Operationen für die Berechnung einer MDCT beziehungsweise MDST benötigt werden. Bei der inversen Transformation werden N Multiplikationen mehr durchgeführt. Das liegt daran, dass hier die zur Transformation notwendige Skalierung vorgenommen wird. Die entsprechende Auswertung ist in Tabelle 5.3 zusammengefasst.
<tables id="tabl0003" num="0003"><table frame="topbot"><title>Tabelle 5.3 - Komplexität der schnellen inversen MDCT/MDST</title><tgroup cols="7" colsep="0"><colspec colnum="1" colname="col1" colwidth="14mm"/><colspec colnum="2" colname="col2" colwidth="14mm"/><colspec colnum="3" colname="col3" colwidth="14mm"/><colspec colnum="4" colname="col4" colwidth="14mm"/><colspec colnum="5" colname="col5" colwidth="14mm"/><colspec colnum="6" colname="col6" colwidth="14mm"/><colspec colnum="7" colname="col7" colwidth="15mm"/><thead><row><entry valign="top"><b>N</b></entry><entry valign="top">2</entry><entry valign="top">8</entry><entry valign="top">32</entry><entry valign="top">128</entry><entry valign="top">512</entry><entry valign="top">2048</entry></row></thead><tbody><row><entry><b>ADD</b></entry><entry>5</entry><entry>106</entry><entry>1046</entry><entry>6630</entry><entry>35974</entry><entry>181094</entry></row><row><entry><b>MULT</b></entry><entry>9</entry><entry>48</entry><entry>236</entry><entry>1084</entry><entry>4860</entry><entry>21500</entry></row><row><entry><b>DIV</b></entry><entry>1</entry><entry>1</entry><entry>1</entry><entry>1</entry><entry>1</entry><entry>1</entry></row></tbody></tgroup></table></tables><!-- EPO <DP n="55"> --></p><p id="p0245" num="0245">Daraus ergibt sich eine Komplexität von <i>O</i> (<i>N</i>log<i>N</i>) für die Vorwärts- als auch die Invers-Transformation. Der implementierte Algorithmus erfüllt damit wie erwartet die Anforderung an eine schnelle Transformation. Die Ergebnisse dieser Auswertung sind in <figref idrefs="f0017">Fig. 15</figref> gezeigt.</p><p id="p0246" num="0246"><figref idrefs="f0017">Fig. 15</figref> zeigt die Komplexität der schnellen MDCT/MDST. Es ist zu beachten, dass für die Überführung des Signals aus dem komplexen MDCT-/MDST-Bereich in den Zeitbereich zwei inverse Transformationen berechnet werden müssen. Die Anzahl der benötigten Operationen verdoppelt sich.</p><p id="p0247" num="0247">Die exakte Überführung der MDCT-Koeffizienten in MDST-Spektralwerte stellt in HSBE den rechenintensivsten Vorgang dar. Hier entsteht nicht nur ein konstantes Delay von einem Block, sondern auch die größte Rechenzeit. Auch wenn der benötigte Aufwand durch das eingeführte Verfahren verringert ist, ergeben sich hier die meisten Operationen, wie in Tabelle 5.4 zusammengefasst.
<tables id="tabl0004" num="0004"><table frame="topbot"><title>Tabelle 5.4 - Komplexität der exakten MDCT-MDST-Transformation</title><tgroup cols="7" colsep="0"><colspec colnum="1" colname="col1" colwidth="14mm"/><colspec colnum="2" colname="col2" colwidth="14mm"/><colspec colnum="3" colname="col3" colwidth="14mm"/><colspec colnum="4" colname="col4" colwidth="14mm"/><colspec colnum="5" colname="col5" colwidth="14mm"/><colspec colnum="6" colname="col6" colwidth="15mm"/><colspec colnum="7" colname="col7" colwidth="17mm"/><thead><row><entry valign="top"><b>N</b></entry><entry valign="top">2</entry><entry valign="top">8</entry><entry valign="top">32</entry><entry valign="top">128</entry><entry valign="top">512</entry><entry valign="top">2048</entry></row></thead><tbody><row><entry><b>ADD</b></entry><entry>6</entry><entry>120</entry><entry>2016</entry><entry>32640</entry><entry>523776</entry><entry>8386560</entry></row><row><entry><b>MULT</b></entry><entry>12</entry><entry>144</entry><entry>2112</entry><entry>33024</entry><entry>525312</entry><entry>8392704</entry></row></tbody></tgroup></table></tables></p><p id="p0248" num="0248">Für die Multiplikation der vollbesetzten Matrizen <maths id="math0112" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn></msub></math><img id="ib0112" file="imgb0112.tif" wi="8" he="9" img-content="math" img-format="tif" inline="yes"/></maths> und <maths id="math0113" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>2</mn></msub></math><img id="ib0113" file="imgb0113.tif" wi="9" he="9" img-content="math" img-format="tif" inline="yes"/></maths> an den Spektralvektor werden in Summe jeweils <i>N</i><sup>2</sup> Multiplikationen und <i>N</i>(N - 1) Additionen benötigt. Die schwachbesetzte Matrix <maths id="math0114" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>1</mn></msub></math><img id="ib0114" file="imgb0114.tif" wi="9" he="9" img-content="math" img-format="tif" inline="yes"/></maths> ermöglicht eine effiziente Implementierung, so dass hier 2<i>N</i> Multiplikationen und <i>N</i> Additionen durchgeführt werden müssen. Für die exakte Überführung der MDCT-Werte in MDST-Koeffizienten werden insgesamt 4<i>N</i><sup>2</sup> + <i>N</i> Additionen und Multiplikationen berechnet. Damit besteht für die Komplexität des implementierten Algorithmus eine quadratische Abhängigkeit von der Transformationslänge. Sie kann mit <i>O</i>(<i>N</i><sup>2</sup>) angegeben werden. Das vereinfachte Verfahren benötigt in etwa entsprechend dem Verhältnis 2σ+1/N weniger Operationen. Der entsprechende Zusammenhang ist in <figref idrefs="f0018">Fig. 16</figref> dargestellt. <figref idrefs="f0018">Fig. 16</figref> zeigt dabei die Komplexität der MDCT-MDST-Transformation.</p><p id="p0249" num="0249">Neben der algorithmischen Komplexität spielt die Speicherauslastung für die Betrachtung<!-- EPO <DP n="56"> --> der Effizienz eine wichtige Rolle. Je nach Endgerät, auf dem der Audiodecoder ausgeführt wird, steht unter Umständen nur sehr begrenzt Speicherplatz zur Verfügung. Es ist daher notwendig, die Auslastung des Hauptspeichers so gering wie möglich zu halten. In Tabelle 5.5 sind die verwendeten Ressourcen aufgelistet. Die Modulbeschreibung richtet sich dabei nach der gleichnamigen C-Quelldatei. Betrachtet werden dabei nur die wesentlichen Puffer, die zum Speichern und Verarbeiten von Signalvektoren und -matrizen benötigt werden.
<tables id="tabl0005" num="0005"><table frame="topbot"><title>Tabelle 5.5 - Speicherverbrauch durch HSBE:</title><tgroup cols="4" colsep="0"><colspec colnum="1" colname="col1" colwidth="26mm"/><colspec colnum="2" colname="col2" colwidth="29mm"/><colspec colnum="3" colname="col3" colwidth="33mm"/><colspec colnum="4" colname="col4" colwidth="30mm"/><thead><row><entry valign="top"><b>Modul</b></entry><entry valign="top">Elemente</entry><entry valign="top">Größe in Byte</entry><entry valign="top">Größe In KIB</entry></row></thead><tbody><row><entry><b>hsbelib</b></entry><entry>20480</entry><entry>81920</entry><entry>80</entry></row><row><entry><b>Hmatrix</b></entry><entry>4194304 (205)</entry><entry>16777216 (820)</entry><entry>16384 (0,80)</entry></row><row><entry><b>hsbeConv</b></entry><entry>15</entry><entry>60</entry><entry>0,05</entry></row><row><entry><b>fastDCSTIV</b></entry><entry>3072</entry><entry>12288</entry><entry>12</entry></row><row><entry><b>fastDCSTIII</b></entry><entry>4096</entry><entry>16384</entry><entry>16</entry></row><row><entry><b>AAF database</b></entry><entry>2715</entry><entry>10860</entry><entry>10,61</entry></row><row><entry><b>gesamt</b></entry><entry>4224682 (30583)</entry><entry>16898728 (122332)</entry><entry>16502,66 (119,46)</entry></row></tbody></tgroup></table></tables></p><heading id="h0001">Angabe in (): beinhaltet die vereinfachte Berechnung der MDCT-MDST-Transformation</heading><p id="p0250" num="0250">Die Implementierung der harmonischen Spektralbanderweiterung basiert auf der singleprecision Gleitkomma-Arithmetik (einfache Genauigkeit), eine Gleitkommazahl wird also mit 32 Bit dargestellt. Die in Tabelle 5.5 angegebene Anzahl bezieht sich damit auf die Anzahl der in diesem Modul benötigten Gleitkommazahlen. Wie der Tabelle zu entnehmen ist, fällt die Speicherauslastung für den eigentlichen HSBE-Algorithmus mit circa 109 KiB für die Modulation, Aliasing-Canelation und MDCT/MDST vergleichsweise gering aus. Die Datenbank für die Anti-Aliasing-Filter ist als Look-Up-Tabelle hinterlegt und benötigt für die insgesamt 2715 Filterkoeffizienten knapp 11 KiB. Den bestimmenden Einfluss auf den Speicherplatzbedarf bildet die Transformationsmatrix <maths id="math0115" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn></msub><mn>.</mn></math><img id="ib0115" file="imgb0115.tif" wi="9" he="8" img-content="math" img-format="tif" inline="yes"/></maths> Für diese Matrix werden ungefähr 16 MiB Arbeitsspeicher verwendet. Durch die oben vorgestellten Vereinfachungen der MDCT-/MDST-Transformation reduziert sich der benötigte Speicherbedarf der Matrix <maths id="math0116" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn></msub></math><img id="ib0116" file="imgb0116.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> sehr stark. Für behandelte Beispiel mit <sup>σ = ┌0,1·N┘</sup> werden damit gerade noch circa 0,8 KiB Arbeitsspeicher in Anspruch genommen.</p><p id="p0251" num="0251">Die hier bereitgestellte Bandbreitenerweiterung mittels harmonischer Spektralbanderweiterung ermöglicht mit den vorgestellten Techniken die harmonisch<!-- EPO <DP n="57"> --> korrekte Erweiterung des Spektrums. Nachfolgend werden die Möglichkeiten und Grenzen der bereitgestellten Konzepte aufgezeigt.</p><p id="p0252" num="0252">Generell können unterschiedlich lange Signale verarbeitet werden. Für die Berechnung der implementierten schnellen MDCT/MDST ist es jedoch zwingend erforderlich, dass die Transformationslänge N eine positive ganzzahlige Potenz der Zahl Zwei darstellt. Die maximal mögliche Blocklänge ist in Anlehnung an AAC auf 2<sup>11</sup>, also 2048, begrenzt. Bei HSBE ist es auch möglich, die Blocklänge während der Laufzeit zu variieren. Das ist insbesondere für die Transientenbehandlung in modernen Audiocodem notwendig. Der SNR wird maßgeblich durch die Blocklänge bestimmt. Dabei gilt, dass große Transformationslängen zu einem besseren Ergebnis führen, als sehr kurze Blocklängen. Das liegt an den durch die Modulation auftretenden Aliasing-Komponenten. Zwar werden durch die Anti-Aliasing-Filterung Störer bis zur vierten Ordnung unterdrückt, dennoch verbleiben einige unerwünschte Komponenten im Signal. Bei sehr kleinen Blocklängen erstrecken sich diese Aliasing-Komponenten über eine große Bandbreite und sind deutlich hörbar. Bei großen Transformationslängen wird die Bandbreite entsprechend kleiner und die Aliasing-Komponenten werden maskiert. Als Grenze hat sich in verschiedenen Versuchen eine Blocklänge von 256 herausgestellt. Ab dieser Länge werden die Artefakte kaum mehr wahrgenommen, sowie in <figref idrefs="f0019">Fig. 17</figref> gezeigt.</p><p id="p0253" num="0253"><figref idrefs="f0019">Fig. 17</figref> zeigt eine Reststörung bei HSBE in Abhängigkeit der Transformationslänge. In <figref idrefs="f0019">Fig. 17</figref> links ist ein Spektrum nach der inversen MDCT mit N = 32 und ϕ = 90 gezeigt. In <figref idrefs="f0019">Fig. 17</figref>, rechts ist ein Spektrum nach der inversen MDCT mit <i>N</i>= 256 und ϕ = 90 gezeigt.</p><p id="p0254" num="0254">Zu sehen sind die Betragsfrequenzgänge eines mit dem Phasenwinkel ϕ modulierten SinusSignals. Wie deutlich zu erkennen ist, treten bei kleinen Blockgrößen (in <figref idrefs="f0019">Fig. 17</figref>, links) auch nach der Aliasing-Cancelation deutlich Störkomponenten auf. Sie liegen im Bereich von circa -70 dB und bestimmen den SNR. Bei Blockgrößen größer 256 (in <figref idrefs="f0019">Fig. 17</figref>, rechts) werden diese Anteile durch das Nutzsignal verdeckt.</p><p id="p0255" num="0255">Insgesamt liefert die harmonische Spektralbanderweiterung eine sehr genaue Rekonstruktion der harmonischen Struktur des Signals. Für eine Transformationslänge von 256 und einer Abtastfrequenz der Audiodaten entsprechend dem CD-Standard von 44100 Hz liegt die Auflösung des entwickelten Verfahrens im Bereich von circa 0,5 Hz. Das bedeutet, dass das Spektrum bis auf ein halbes Hertz genau moduliert werden kann. Für kleinere Abtastfrequenzen oder größere Blocklängen steigt die Auflösung und die Modulation ist in noch feineren Bereichen durchführbar. Das Resultat der Anwendung von HSBE auf ein Multi-Sinussignal ist in <figref idrefs="f0020">Fig. 18</figref> dargestellt.<!-- EPO <DP n="58"> --></p><p id="p0256" num="0256"><figref idrefs="f0020">Fig. 18</figref> zeigt einen Vergleich der HSBE mit der SBR. REF FreqGang bezeichnet ein Spektrum des ursprünglichen Multi-Sinussignals. SBR FreqGang bezeichnet ein mittels SBR bandbreitenerweitertes Signal; HSBE FreqGang bezeichnet ein mittels HSBE bandbreitenerweitertes Signal.</p><p id="p0257" num="0257">Wie in den gezeigten Betragsfrequenzgängen zu erkennen ist, wird mit dem entwickelten HSBE-Verfahren das Spektrum exakt rekonstruiert. Nach der Bearbeitung des bandbegrenzten Signals mit HSBE (HSBE FreqGang) liegt das Spektrum genau über dem ursprünglichen Spektrum (REF FreqGang). Im Vergleich dazu ist das entsprechende Spektrum gezeigt, das nicht harmonisch angepasst ist (SBR FreqGang). Dieses Signal ist zwar mit dem HSBE-Algorithmus berechnet, jedoch ist die zugrundeliegende Lag-Frequenz Null. Dadurch wird eine Bandbreitenerweiterung bewirkt, die im Wesentlichen dem SBR-Verfahren entspricht. Hier ist die Verschiebung der harmonischen Struktur an der Grenzfrequenz <i>f<sub>g</sub></i> = 6400Hz und dem Doppelten dieser Frequenz deutlich zu sehen.</p><p id="p0258" num="0258">Nachfolgend werden Herleitungen bereitgestellt.</p><p id="p0259" num="0259">Zunächst erfolgt eine Herleitung der Überführung der DFT in die DCT-II. Im Speziellen wird die DCT-II aus der DFT in Gleichung 2.10 mit Gleichung 2.12 hergeleitet (siehe hierzu auch Rao und Yip, 2001). Es gilt: <maths id="math0117" num=""><math display="block"><mtable><mtr><mtd columnalign="left"><mover><mi>X</mi><mo> ∼</mo></mover><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mn>2</mn><mo>⁢</mo><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover></mstyle><mover><mi>x</mi><mo> ∼</mo></mover><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>⁢</mo><msup><mi mathvariant="normal">e</mi><mrow><mo>-</mo><mi mathvariant="normal">j</mi><mo>⁢</mo><mfrac><mrow><mn>2</mn><mo>⁢</mo><mi>π</mi></mrow><mrow><mn>2</mn><mo>⁢</mo><mi>N</mi></mrow></mfrac><mo>⁢</mo><mi mathvariant="italic">kn</mi></mrow></msup></mtd><mtd><mfenced separators=""><mi mathvariant="normal">A</mi><mn mathvariant="normal">.1</mn><mi mathvariant="normal">a</mi></mfenced></mtd></mtr><mtr><mtd columnalign="left"><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover></mstyle><mover><mi>x</mi><mo> ∼</mo></mover><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>⁢</mo><mfenced open="[" close="]" separators=""><msup><mi mathvariant="normal">e</mi><mrow><mo>-</mo><mi mathvariant="normal">j</mi><mo>⁢</mo><mfrac><mi mathvariant="normal">π</mi><mi>N</mi></mfrac><mo>⁢</mo><mi>k</mi><mo>⁢</mo><mi>n</mi></mrow></msup><mo>+</mo><msup><mi mathvariant="normal">e</mi><mrow><mo>-</mo><mi mathvariant="normal">j</mi><mo>⁢</mo><mfrac><mi>π</mi><mi>N</mi></mfrac><mo>⁢</mo><mi>k</mi><mo>⁢</mo><mfenced separators=""><mn>2</mn><mo>⁢</mo><mi>N</mi><mo>-</mo><mn>1</mn><mo>-</mo><mi>n</mi></mfenced></mrow></msup></mfenced></mtd><mtd><mfenced separators=""><mi mathvariant="normal">A</mi><mn mathvariant="normal">.1</mn><mi mathvariant="normal">b</mi></mfenced></mtd></mtr><mtr><mtd columnalign="left"><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover></mstyle><mover><mi>x</mi><mo> ∼</mo></mover><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>⁢</mo><msup><mi mathvariant="normal">e</mi><mrow><mi mathvariant="normal">j</mi><mo>⁢</mo><mfrac><mi mathvariant="normal">π</mi><mrow><mn mathvariant="normal">2</mn><mo>⁢</mo><mi>N</mi></mrow></mfrac><mo>⁢</mo><mi>k</mi></mrow></msup><mo>⁢</mo><mfenced open="[" close="]" separators=""><msup><mi mathvariant="normal">e</mi><mrow><mo>-</mo><mi mathvariant="normal">j</mi><mo>⁢</mo><mfrac><mi mathvariant="normal">π</mi><mi>N</mi></mfrac><mo>⁢</mo><mi>k</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>+</mo><mn>0.5</mn></mfenced></mrow></msup><mo>+</mo><msup><mi mathvariant="normal">e</mi><mrow><mo>-</mo><mi mathvariant="normal">j</mi><mo>⁢</mo><mfrac><mi>π</mi><mi>N</mi></mfrac><mo>⁢</mo><mi>k</mi><mo>⁢</mo><mfenced separators=""><mn>2</mn><mo>⁢</mo><mi>N</mi><mo>-</mo><mn>0</mn><mo>,</mo><mn>5</mn><mo>-</mo><mi>n</mi></mfenced></mrow></msup></mfenced></mtd><mtd><mfenced separators=""><mi mathvariant="normal">A</mi><mn mathvariant="normal">.1</mn><mi mathvariant="normal">c</mi></mfenced></mtd></mtr><mtr><mtd columnalign="left"><mo>=</mo><mn>2</mn><mo>⁢</mo><msup><mi mathvariant="normal">e</mi><mrow><mi mathvariant="normal">j</mi><mo>⁢</mo><mfrac><mi>π</mi><mrow><mn mathvariant="normal">2</mn><mo>⁢</mo><mi>N</mi></mrow></mfrac><mo>⁢</mo><mi>k</mi></mrow></msup><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>N</mi><mo>-</mo><mn>1</mn></mrow></munderover></mstyle><mover><mi>x</mi><mo> ∼</mo></mover><mfenced open="[" close="]"><mi>n</mi></mfenced><mo>⁢</mo><mi>cos</mi><mfenced><mfrac><mrow><mi>π</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>+</mo><mn>0.5</mn></mfenced><mo>⁢</mo><mi>k</mi></mrow><mi>N</mi></mfrac></mfenced><mo>,</mo><mo>∀</mo><mi>k</mi><mo>∈</mo><mfenced open="[" close="]" separators=""><mn>0</mn><mo>,</mo><mi>N</mi><mo>-</mo><mn>1</mn></mfenced></mtd><mtd><mfenced separators=""><mi mathvariant="normal">A</mi><mn mathvariant="normal">.1</mn><mi mathvariant="normal">d</mi></mfenced></mtd></mtr></mtable></math><img id="ib0117" file="imgb0117.tif" wi="151" he="83" img-content="math" img-format="tif"/></maths><br/>
mit:<!-- EPO <DP n="59"> --> <maths id="math0118" num=""><math display="block"><mtable columnalign="left"><mtr><mtd><msup><mi mathvariant="normal">e</mi><mrow><mo>-</mo><mi mathvariant="normal">j</mi><mo>⁢</mo><mfrac><mi>π</mi><mrow><mn>2</mn><mo>⁢</mo><mi>N</mi></mrow></mfrac><mo>⁢</mo><mi mathvariant="italic">k</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn></mfenced></mrow></msup><mo>+</mo><msup><mi mathvariant="normal">e</mi><mrow><mo>-</mo><mi mathvariant="normal">j</mi><mo>⁢</mo><mfrac><mi>π</mi><mi>N</mi></mfrac><mo>⁢</mo><mi mathvariant="italic">k</mi><mo>⁢</mo><mfenced separators=""><mn>2</mn><mo>⁢</mo><mi>N</mi><mo>-</mo><mn>0</mn><mo>,</mo><mn>5</mn><mo>-</mo><mi>n</mi></mfenced></mrow></msup><mo>=</mo><mo>…</mo></mtd><mtd><mspace width="1em"/></mtd></mtr><mtr><mtd><mo>=</mo><mi>cos</mi><mfenced separators=""><mfrac><mi>π</mi><mi>N</mi></mfrac><mo>⁢</mo><mi>k</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn></mfenced></mfenced><mo>-</mo><mi>jsin</mi><mo>⁢</mo><mfenced separators=""><mfrac><mi>π</mi><mi>N</mi></mfrac><mo>⁢</mo><mi>k</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn></mfenced></mfenced><mo>+</mo><mo>…</mo></mtd><mtd><mspace width="1em"/></mtd></mtr><mtr><mtd><mo>+</mo><mi>cos</mi><mfenced separators=""><mfrac><mi>π</mi><mi>N</mi></mfrac><mo>⁢</mo><mi>k</mi><mo>⁢</mo><mfenced separators=""><mn>2</mn><mo>⁢</mo><mi>n</mi><mo>-</mo><mn>0</mn><mo>,</mo><mn>5</mn><mo>-</mo><mi>n</mi></mfenced></mfenced><mo>-</mo><mi>jsin</mi><mo>⁢</mo><mfenced separators=""><mfrac><mi>π</mi><mi>N</mi></mfrac><mo>⁢</mo><mi>k</mi><mo>⁢</mo><mfenced separators=""><mn>2</mn><mo>⁢</mo><mi>N</mi><mo>-</mo><mn>0</mn><mo>,</mo><mn>5</mn><mo>-</mo><mi>n</mi></mfenced></mfenced></mtd><mtd><mfenced separators=""><mi mathvariant="normal">A</mi><mn mathvariant="normal">.2</mn><mi mathvariant="normal">a</mi></mfenced></mtd></mtr><mtr><mtd><mo>=</mo><mi>cos</mi><mfenced separators=""><mi>k</mi><mo>⁢</mo><mfenced separators=""><mfrac><mi>π</mi><mi>N</mi></mfrac><mo>⁢</mo><mi>n</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn><mo>⁢</mo><mfrac><mi>π</mi><mi>N</mi></mfrac></mfenced></mfenced><mo>+</mo><mi>cos</mi><mfenced separators=""><mo>-</mo><mi>k</mi><mo>⁢</mo><mfenced separators=""><mfrac><mi>π</mi><mi>N</mi></mfrac><mo>⁢</mo><mi>n</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn><mo>⁢</mo><mfrac><mi>π</mi><mi>N</mi></mfrac></mfenced><mo>+</mo><mn>2</mn><mo>⁢</mo><mi mathvariant="italic">πk</mi></mfenced><mo>+</mo><mo>…</mo></mtd><mtd><mspace width="1em"/></mtd></mtr><mtr><mtd><mo>-</mo><mi>jsin</mi><mo>⁢</mo><mfenced separators=""><mi>k</mi><mo>⁢</mo><mfenced separators=""><mfrac><mi>π</mi><mi>N</mi></mfrac><mo>⁢</mo><mi>n</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn><mo>⁢</mo><mfrac><mi>π</mi><mi>N</mi></mfrac></mfenced></mfenced><mo>-</mo><mi>jsin</mi><mo>⁢</mo><mfenced separators=""><mo>-</mo><mi>k</mi><mo>⁢</mo><mfenced separators=""><mfrac><mi>π</mi><mi>N</mi></mfrac><mo>⁢</mo><mi>n</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn><mo>⁢</mo><mfrac><mi>π</mi><mi>N</mi></mfrac></mfenced><mo>+</mo><mn>2</mn><mo>⁢</mo><mi mathvariant="italic">πk</mi></mfenced></mtd><mtd><mfenced separators=""><mi mathvariant="normal">A</mi><mn mathvariant="normal">.2</mn><mi mathvariant="normal">b</mi></mfenced></mtd></mtr><mtr><mtd><mo>=</mo><mn>2</mn><mo>⁢</mo><mi>cos</mi><mfenced separators=""><mfrac><mi>π</mi><mi>N</mi></mfrac><mo>⁢</mo><mi>k</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>+</mo><mn>0</mn><mo>,</mo><mn>5</mn></mfenced></mfenced></mtd><mtd><mfenced separators=""><mi mathvariant="normal">A</mi><mn mathvariant="normal">.2</mn><mi mathvariant="normal">c</mi></mfenced></mtd></mtr></mtable></math><img id="ib0118" file="imgb0118.tif" wi="150" he="82" img-content="math" img-format="tif"/></maths><br/>
und den Eigenschaften der Sinus- und Cosinusfunktion: <maths id="math0119" num="(a.3a)"><math display="block"><mi>cos</mi><mfenced separators=""><mo>-</mo><mi mathvariant="normal">x</mi></mfenced><mo>=</mo><mi>cos</mi><mfenced><mi mathvariant="normal">x</mi></mfenced></math><img id="ib0119" file="imgb0119.tif" wi="105" he="8" img-content="math" img-format="tif"/></maths> <maths id="math0120" num="(a.3b)"><math display="block"><mi>cos</mi><mfenced separators=""><mn>2</mn><mo>⁢</mo><mi mathvariant="normal">π</mi><mo>+</mo><mi mathvariant="normal">x</mi></mfenced><mo>=</mo><mi>cos</mi><mfenced><mi mathvariant="normal">x</mi></mfenced></math><img id="ib0120" file="imgb0120.tif" wi="114" he="8" img-content="math" img-format="tif"/></maths> <maths id="math0121" num="(a.3c)"><math display="block"><mi>sin</mi><mfenced separators=""><mo>-</mo><mi mathvariant="normal">x</mi></mfenced><mo>=</mo><mo>-</mo><mi>sin</mi><mfenced><mi mathvariant="normal">x</mi></mfenced></math><img id="ib0121" file="imgb0121.tif" wi="104" he="8" img-content="math" img-format="tif"/></maths> <maths id="math0122" num="(a.3d)"><math display="block"><mi>sin</mi><mfenced separators=""><mn>2</mn><mo>⁢</mo><mi mathvariant="normal">π</mi><mo>+</mo><mi mathvariant="normal">x</mi></mfenced><mo>=</mo><mi>sin</mi><mfenced><mi mathvariant="normal">x</mi></mfenced></math><img id="ib0122" file="imgb0122.tif" wi="113" he="8" img-content="math" img-format="tif"/></maths></p><p id="p0260" num="0260">Dieser Zusammenhang kann auch genutzt werden, um die DCT effektiv mit Hilfe der FFT zu berechnen (vergleiche hierzu Ahmed u. a., 1974).</p><p id="p0261" num="0261">Im Folgenden wird auf die Foldingmatrizen eingegangen.</p><p id="p0262" num="0262">Die zur Berechnung der MDCT (vgl. Gleichung 2.35) notwendigen Foldingmatrizen <maths id="math0123" num=""><math display="inline"><msub><munder><mi mathvariant="bold">F</mi><mo> ∼</mo></munder><mi>α</mi></msub><mn>.</mn></math><img id="ib0123" file="imgb0123.tif" wi="10" he="9" img-content="math" img-format="tif" inline="yes"/></maths> und <maths id="math0124" num=""><math display="inline"><msub><munder><mi mathvariant="bold">F</mi><mo> ∼</mo></munder><mi>s</mi></msub></math><img id="ib0124" file="imgb0124.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> setzten sich aus einer Delaymatrix <maths id="math0125" num=""><math display="inline"><munder><mi mathvariant="bold">D</mi><mo> ∼</mo></munder></math><img id="ib0125" file="imgb0125.tif" wi="5" he="9" img-content="math" img-format="tif" inline="yes"/></maths> und der Fenstermatrix <maths id="math0126" num=""><math display="inline"><munder><mi mathvariant="bold">F</mi><mo> ∼</mo></munder></math><img id="ib0126" file="imgb0126.tif" wi="5" he="8" img-content="math" img-format="tif" inline="yes"/></maths> zusammen. Die Fenstermatrix enthält die Koeffizienten der Fensterfunktion <sup><i>w</i>[<i>n</i>]</sup> angeordnet in Diamantstruktur. Es gilt:<!-- EPO <DP n="60"> -->
<maths id="math0127" num=""><img id="ib0127" file="imgb0127.tif" wi="153" he="58" img-content="math" img-format="tif"/></maths>
<maths id="math0128" num=""><img id="ib0128" file="imgb0128.tif" wi="156" he="54" img-content="math" img-format="tif"/></maths>
mit:
<maths id="math0129" num=""><img id="ib0129" file="imgb0129.tif" wi="148" he="49" img-content="math" img-format="tif"/></maths>
und:<!-- EPO <DP n="61"> --> <maths id="math0130" num="(a.7a)"><math display="block"><munder><mi mathvariant="bold">D</mi><mo>∼</mo></munder><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>⋱</mo></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mn>1</mn></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mo>⋱</mo></mtd><mtd><mspace width="1em"/></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="2em"/></mtd><mtd><mn>1</mn></mtd></mtr></mtable></mfenced></math><img id="ib0130" file="imgb0130.tif" wi="120" he="47" img-content="math" img-format="tif"/></maths> <maths id="math0131" num="(a.7b)"><math display="block"><msup><munder><mi mathvariant="bold">D</mi><mo>∼</mo></munder><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><mn>1</mn></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>⋱</mo></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mn>1</mn></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mo>⋱</mo></mtd><mtd><mspace width="1em"/></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="2em"/></mtd><mtd><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd></mtr></mtable></mfenced></math><img id="ib0131" file="imgb0131.tif" wi="126" he="47" img-content="math" img-format="tif"/></maths></p><p id="p0263" num="0263">Um die Kausalität zu bewahren, ist die inverse Delaymatrix <maths id="math0132" num=""><math display="inline"><msup><munder><mi mathvariant="bold">D</mi><mo> ∼</mo></munder><mrow><mo>-</mo><mn>1</mn></mrow></msup></math><img id="ib0132" file="imgb0132.tif" wi="9" he="8" img-content="math" img-format="tif" inline="yes"/></maths> mit dem Delay z<sup>-1</sup> multipliziert worden. Das Delay der MDCT-Filterbank ist darin begründet (Schuller und Smith, 1996).</p><heading id="h0002"><b>Transformationsmatrix H</b></heading><p id="p0264" num="0264">Die Transformationsmatrix <maths id="math0133" num=""><math display="inline"><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder></math><img id="ib0133" file="imgb0133.tif" wi="5" he="8" img-content="math" img-format="tif" inline="yes"/></maths> wird zur Überführung des MDCT Spektrums in das zugehörige MDST Spektrum benötigt. Es gilt: <maths id="math0134" num="(a.8)"><math display="block"><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mo>=</mo><msub><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mi mathvariant="italic">DST</mi></msub><mo>⋅</mo><munder><mi mathvariant="bold">D</mi><mo>∼</mo></munder><mo>⋅</mo><msub><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mi mathvariant="italic">sin</mi></msub><mo>⋅</mo><msup><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mi mathvariant="normal">T</mi></msup><mo>⋅</mo><msup><munder><mi mathvariant="bold">D</mi><mo>∼</mo></munder><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⋅</mo><msup><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mrow><mo>-</mo><mn>1</mn></mrow></msup></math><img id="ib0134" file="imgb0134.tif" wi="124" he="8" img-content="math" img-format="tif"/></maths></p><p id="p0265" num="0265">Die genaue Zerlegung wird nun am Beispiel von N= 4 gezeigt:<!-- EPO <DP n="62"> --> <maths id="math0135" num="(a.9a)"><math display="block"><mtable><mtr><mtd><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi>ʹ</mi></mtd><mtd columnalign="left"><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><msub><mi>a</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow><mn>1</mn><mo>,</mo><mn>3</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow><mn>1</mn><mo>,</mo><mn>4</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow><mn>2</mn><mo>,</mo><mn>2</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow><mn>2</mn><mo>,</mo><mn>3</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow><mn>2</mn><mo>,</mo><mn>4</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow><mn>3</mn><mo>,</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow><mn>3</mn><mo>,</mo><mn>2</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow><mn>3</mn><mo>,</mo><mn>3</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow><mn>3</mn><mo>,</mo><mn>4</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow><mn>4</mn><mo>,</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow><mn>4</mn><mo>,</mo><mn>2</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow><mn>4</mn><mo>,</mo><mn>3</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow><mn>4</mn><mo>,</mo><mn>4</mn></mrow></msub></mtd></mtr></mtable></mfenced><mo>⋅</mo><mfenced open="[" close="]"><mtable><mtr><mtd><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable></mfenced></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd columnalign="left"><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><msub><mi>a</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>a</mi><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>a</mi><mrow><mn>1</mn><mo>,</mo><mn>3</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow><mn>1</mn><mo>,</mo><mn>4</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>a</mi><mrow><mn>2</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>a</mi><mrow><mn>2</mn><mo>,</mo><mn>3</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow><mn>2</mn><mo>,</mo><mn>4</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow><mn>3</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>a</mi><mrow><mn>3</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>a</mi><mrow><mn>3</mn><mo>,</mo><mn>3</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow><mn>3</mn><mo>,</mo><mn>4</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>b</mi><mrow><mn>4</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>a</mi><mrow><mn>4</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>a</mi><mrow><mn>4</mn><mo>,</mo><mn>3</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow><mn>4</mn><mo>,</mo><mn>4</mn></mrow></msub></mtd></mtr></mtable></mfenced><mo>=</mo><msub><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mi mathvariant="italic">DST</mi></msub><mo>⋅</mo><munder><mi mathvariant="bold">D</mi><mo>∼</mo></munder></mtd></mtr></mtable></math><img id="ib0135" file="imgb0135.tif" wi="148" he="57" img-content="math" img-format="tif"/></maths> <maths id="math0136" num="(a.9b)"><math display="block"><mtable columnalign="left"><mtr><mtd><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mo>⁢</mo><mi>ʹ</mi></mtd><mtd><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mo>-</mo><mi>w</mi><mfenced open="[" close="]"><mn>1</mn></mfenced></mtd><mtd><mi>w</mi><mfenced open="[" close="]"><mn>2</mn></mfenced></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mo>-</mo><mi>w</mi><mfenced open="[" close="]"><mn>0</mn></mfenced></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi>w</mi><mfenced open="[" close="]"><mn>3</mn></mfenced></mtd></mtr><mtr><mtd><mi>w</mi><mfenced open="[" close="]"><mn>4</mn></mfenced></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi>w</mi><mfenced open="[" close="]"><mn>7</mn></mfenced></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mi>w</mi><mfenced open="[" close="]"><mn>5</mn></mfenced></mtd><mtd><mi>w</mi><mfenced open="[" close="]"><mn>6</mn></mfenced><mspace width="1em"/></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mfenced><mo>⋅</mo><mfenced open="[" close="]"><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mi>w</mi><mfenced open="[" close="]"><mn>0</mn></mfenced></mtd><mtd><mi>w</mi><mfenced open="[" close="]"><mn>4</mn></mfenced></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mi>w</mi><mfenced open="[" close="]"><mn>1</mn></mfenced></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi>w</mi><mfenced open="[" close="]"><mn>5</mn></mfenced></mtd></mtr><mtr><mtd><mi>w</mi><mfenced open="[" close="]"><mn>2</mn></mfenced></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>-</mo><mi>w</mi><mfenced open="[" close="]"><mn>6</mn></mfenced></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mi>w</mi><mfenced open="[" close="]"><mn>3</mn></mfenced></mtd><mtd><mo>-</mo><mi>w</mi><mfenced open="[" close="]"><mn>7</mn></mfenced><mspace width="1em"/></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mfenced></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><msubsup><mi>w</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow><mi>ʹ</mi></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><msubsup><mi>w</mi><mrow><mn>1</mn><mo>,</mo><mn>4</mn></mrow><mi>ʹ</mi></msubsup></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msubsup><mi>w</mi><mrow><mn>2</mn><mo>,</mo><mn>2</mn></mrow><mi>ʹ</mi></msubsup></mtd><mtd><msubsup><mi>w</mi><mrow><mn>2</mn><mo>,</mo><mn>3</mn></mrow><mi>ʹ</mi></msubsup></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msubsup><mi>w</mi><mrow><mn>3</mn><mo>,</mo><mn>2</mn></mrow><mi>ʹ</mi></msubsup></mtd><mtd><msubsup><mi>w</mi><mrow><mn>3</mn><mo>,</mo><mn>3</mn></mrow><mi>ʹ</mi></msubsup></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><msubsup><mi>w</mi><mrow><mn>4</mn><mo>,</mo><mn>1</mn></mrow><mi>ʹ</mi></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><msubsup><mi>w</mi><mrow><mn>4</mn><mo>,</mo><mn>4</mn></mrow><mi>ʹ</mi></msubsup></mtd></mtr></mtable></mfenced><mo>=</mo><msub><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mi mathvariant="italic">sin</mi></msub><mo>⋅</mo><msup><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mi mathvariant="normal">T</mi></msup></mtd></mtr></mtable></math><img id="ib0136" file="imgb0136.tif" wi="153" he="57" img-content="math" img-format="tif"/></maths> <maths id="math0137" num="(a.9c)"><math display="block"><mtable><mtr><mtd columnalign="left"><msup><mrow><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi>ʹ</mi></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd columnalign="left"><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd></mtr></mtable></mfenced><mo>⋅</mo><mfenced open="[" close="]"><mtable><mtr><mtd><msub><mi>b</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>1</mn><mo>,</mo><mn>3</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>1</mn><mo>,</mo><mn>4</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>b</mi><mrow><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>2</mn><mo>,</mo><mn>2</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>2</mn><mo>,</mo><mn>3</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>2</mn><mo>,</mo><mn>4</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>b</mi><mrow><mn>3</mn><mo>,</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>3</mn><mo>,</mo><mn>2</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>3</mn><mo>,</mo><mn>3</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>3</mn><mo>,</mo><mn>4</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>b</mi><mrow><mn>4</mn><mo>,</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>4</mn><mo>,</mo><mn>2</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>4</mn><mo>,</mo><mn>3</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>4</mn><mo>,</mo><mn>4</mn></mrow></msub></mtd></mtr></mtable></mfenced></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd columnalign="left"><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><msub><mi>b</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>1</mn><mo>,</mo><mn>3</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>1</mn><mo>,</mo><mn>4</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>b</mi><mrow><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>2</mn><mo>,</mo><mn>2</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>2</mn><mo>,</mo><mn>3</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>2</mn><mo>,</mo><mn>4</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>b</mi><mrow><mn>3</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>b</mi><mrow><mn>3</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>b</mi><mrow><mn>3</mn><mo>,</mo><mn>3</mn></mrow></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>b</mi><mrow><mn>3</mn><mo>,</mo><mn>4</mn></mrow></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd></mtr><mtr><mtd><msub><mi>b</mi><mrow><mn>4</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>b</mi><mrow><mn>4</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>b</mi><mrow><mn>4</mn><mo>,</mo><mn>3</mn></mrow></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>b</mi><mrow><mn>4</mn><mo>,</mo><mn>4</mn></mrow></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd></mtr></mtable></mfenced><mo>=</mo><msup><munder><mi mathvariant="bold">D</mi><mo>∼</mo></munder><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⋅</mo><msup><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd></mtr></mtable></math><img id="ib0137" file="imgb0137.tif" wi="157" he="56" img-content="math" img-format="tif"/></maths></p><p id="p0266" num="0266">Die Matrizen mit den Verzögerungsgliedern z<sup>-1</sup> können als Addition von je zwei Matrizen dargestellt werden. Damit ergibt sich:<!-- EPO <DP n="63"> --> <maths id="math0138" num="(a.10a)"><math display="block"><mtable><mtr><mtd columnalign="left"><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi>ʹ</mi><mfenced><mi mathvariant="normal">z</mi></mfenced></mtd><mtd columnalign="left"><mo>=</mo><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi>ʹ</mi><mfenced><msup><mi mathvariant="normal">z</mi><mn>0</mn></msup></mfenced><mo>+</mo><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi>ʹ</mi><mo>⁢</mo><mfenced><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mfenced></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd columnalign="left"><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><msub><mi>a</mi><mrow><mn>1</mn><mo>,</mo><mn>3</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow><mn>1</mn><mo>,</mo><mn>4</mn></mrow></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><msub><mi>a</mi><mrow><mn>2</mn><mo>,</mo><mn>3</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow><mn>2</mn><mo>,</mo><mn>4</mn></mrow></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><msub><mi>a</mi><mrow><mn>3</mn><mo>,</mo><mn>3</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow><mn>3</mn><mo>,</mo><mn>4</mn></mrow></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><msub><mi>a</mi><mrow><mn>4</mn><mo>,</mo><mn>3</mn></mrow></msub></mtd><mtd><msub><mi>a</mi><mrow><mn>4</mn><mo>,</mo><mn>4</mn></mrow></msub></mtd></mtr></mtable></mfenced><mo>+</mo><mfenced open="[" close="]"><mtable><mtr><mtd><msub><mi>a</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>⁢</mo><msup><mi>z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>a</mi><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>⁢</mo><msup><mi>z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>⁢</mo><msup><mi>z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>a</mi><mrow><mn>2</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>⁢</mo><msup><mi>z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow><mn>3</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>⁢</mo><msup><mi>z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>a</mi><mrow><mn>3</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>⁢</mo><msup><mi>z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><msub><mi>a</mi><mrow><mn>4</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>⁢</mo><msup><mi>z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>a</mi><mrow><mn>4</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>⁢</mo><msup><mi>z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mfenced></mtd></mtr></mtable></math><img id="ib0138" file="imgb0138.tif" wi="150" he="35" img-content="math" img-format="tif"/></maths> <maths id="math0139" num="(a.10b)"><math display="block"><mtable><mtr><mtd columnalign="left"><msup><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mrow><mo>-</mo><mn>1</mn></mrow></msup><mfenced><mi mathvariant="normal">z</mi></mfenced></mtd><mtd columnalign="left"><mo>=</mo><msup><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mrow><mo>-</mo><mn>1</mn></mrow></msup><mfenced><msup><mi mathvariant="normal">z</mi><mn>0</mn></msup></mfenced><mo>+</mo><msup><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><mfenced><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mfenced></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd columnalign="left"><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><msub><mi>b</mi><mrow><mn>1</mn><mo>,</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>1</mn><mo>,</mo><mn>2</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>1</mn><mo>,</mo><mn>3</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>1</mn><mo>,</mo><mn>4</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>b</mi><mrow><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>2</mn><mo>,</mo><mn>2</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>2</mn><mo>,</mo><mn>3</mn></mrow></msub></mtd><mtd><msub><mi>b</mi><mrow><mn>2</mn><mo>,</mo><mn>4</mn></mrow></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mfenced><mo>+</mo><mfenced open="[" close="]"><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><msub><mi>b</mi><mrow><mn>3</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>b</mi><mrow><mn>3</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>b</mi><mrow><mn>3</mn><mo>,</mo><mn>3</mn></mrow></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>b</mi><mrow><mn>3</mn><mo>,</mo><mn>4</mn></mrow></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd></mtr><mtr><mtd><msub><mi>b</mi><mrow><mn>4</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>⁢</mo><msup><mi>z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>b</mi><mrow><mn>4</mn><mo>,</mo><mn>2</mn></mrow></msub><mo>⁢</mo><msup><mi>z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>b</mi><mrow><mn>4</mn><mo>,</mo><mn>3</mn></mrow></msub><mo>⁢</mo><msup><mi>z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd><mtd><msub><mi>b</mi><mrow><mn>4</mn><mo>,</mo><mn>4</mn></mrow></msub><mo>⁢</mo><msup><mi>z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mtd></mtr></mtable></mfenced></mtd></mtr></mtable></math><img id="ib0139" file="imgb0139.tif" wi="155" he="41" img-content="math" img-format="tif"/></maths></p><p id="p0267" num="0267">Mit dieser Zerlegung und der Matrix <maths id="math0140" num=""><math display="inline"><munder><mi mathvariant="bold">F</mi><mo> ∼</mo></munder><mo>⁢</mo><mi>ʹ</mi></math><img id="ib0140" file="imgb0140.tif" wi="8" he="10" img-content="math" img-format="tif" inline="yes"/></maths> kann die Gleichung A.8 folgendermaßen geschrieben werden: <maths id="math0141" num=""><math display="block"><mtable columnalign="left"><mtr><mtd><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mfenced><mi mathvariant="normal">z</mi></mfenced></mtd><mtd><mo>=</mo><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi><mfenced><mi mathvariant="normal">z</mi></mfenced><mo>⋅</mo><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mo>⁢</mo><mi>ʹ</mi><mo>⋅</mo><msup><mrow><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi>ʹ</mi></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mfenced><mi mathvariant="normal">z</mi></mfenced></mtd><mtd><mfenced separators=""><mi mathvariant="normal">A</mi><mn mathvariant="normal">.11</mn><mi mathvariant="normal">a</mi></mfenced></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><mfenced separators=""><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi><mfenced><msup><mi mathvariant="normal">z</mi><mn>0</mn></msup></mfenced><mo>+</mo><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi><mo>⁢</mo><mfenced><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mfenced></mfenced><mo>⋅</mo><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi><mo>⋅</mo><mfenced separators=""><msup><mrow><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi>ʹ</mi></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mfenced><msup><mi mathvariant="normal">z</mi><mn>0</mn></msup></mfenced><mo>+</mo><msup><mrow><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi>ʹ</mi></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><mfenced><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mfenced></mfenced></mtd><mtd><mfenced separators=""><mi mathvariant="normal">A</mi><mn mathvariant="normal">.11</mn><mi mathvariant="normal">b</mi></mfenced></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><mfenced separators=""><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi><mfenced><msup><mi mathvariant="normal">z</mi><mn>0</mn></msup></mfenced><mo>⋅</mo><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi><mo>+</mo><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi><mo>⁢</mo><mfenced><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mfenced><mo>⋅</mo><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi></mfenced><mo>⋅</mo><mfenced separators=""><msup><mrow><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mfenced><msup><mi mathvariant="normal">z</mi><mn>0</mn></msup></mfenced><mo>+</mo><msup><mrow><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><mfenced><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mfenced></mfenced></mtd><mtd><mfenced separators=""><mi mathvariant="normal">A</mi><mn mathvariant="normal">.11</mn><mi mathvariant="normal">c</mi></mfenced></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi><mfenced><msup><mi mathvariant="normal">z</mi><mn>0</mn></msup></mfenced><mo>⋅</mo><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi><mo>⋅</mo><msup><mrow><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mfenced><msup><mi mathvariant="normal">z</mi><mn>0</mn></msup></mfenced><mo>+</mo><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi><mo>⁢</mo><mfenced><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mfenced><mo>⋅</mo><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi><mo>⋅</mo><msup><mrow><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mfenced><msup><mi mathvariant="normal">z</mi><mn>0</mn></msup></mfenced><mo>+</mo><mo>…</mo></mtd><mtd><mspace width="1em"/></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>+</mo><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi><mfenced><msup><mi mathvariant="normal">z</mi><mn>0</mn></msup></mfenced><mo>⋅</mo><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi><mo>⋅</mo><msup><mrow><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><mfenced><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mfenced><mo>+</mo><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi><mo>⁢</mo><mfenced><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mfenced><mo>⋅</mo><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi><mo>⋅</mo><msup><mrow><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><mfenced><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mfenced></mtd><mtd><mfenced separators=""><mi mathvariant="normal">A</mi><mn mathvariant="normal">.11</mn><mi mathvariant="normal">d</mi></mfenced></mtd></mtr></mtable></math><img id="ib0141" file="imgb0141.tif" wi="155" he="45" img-content="math" img-format="tif"/></maths></p><p id="p0268" num="0268">Die einzelnen Terme der Gleichung werden nun anhand ihrer Abhängigkeit von z substituiert: <maths id="math0142" num="(a.12a)"><math display="block"><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mfenced><msup><mi mathvariant="normal">z</mi><mn>0</mn></msup></mfenced><mo>=</mo><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi><mfenced><msup><mi mathvariant="normal">z</mi><mn>0</mn></msup></mfenced><mo>⋅</mo><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mo>⁢</mo><mi>ʹ</mi><mo>⋅</mo><msup><mrow><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi>ʹ</mi></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mfenced><msup><mi mathvariant="normal">z</mi><mn>0</mn></msup></mfenced></math><img id="ib0142" file="imgb0142.tif" wi="152" he="9" img-content="math" img-format="tif"/></maths> <maths id="math0143" num="(a.12b)"><math display="block"><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mo>⁢</mo><mfenced><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mfenced><mo>=</mo><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi><mo>⁢</mo><mfenced><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mfenced><mo>⋅</mo><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mo>⁢</mo><mi>ʹ</mi><mo>⋅</mo><msup><mrow><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi>ʹ</mi></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mfenced><msup><mi mathvariant="normal">z</mi><mn>0</mn></msup></mfenced><mo>+</mo><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi><mfenced><msup><mi mathvariant="normal">z</mi><mn>0</mn></msup></mfenced><mo>⋅</mo><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mo>⁢</mo><mi>ʹ</mi><mo>⋅</mo><msup><mrow><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi>ʹ</mi></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><mfenced><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mfenced></math><img id="ib0143" file="imgb0143.tif" wi="155" he="9" img-content="math" img-format="tif"/></maths> <maths id="math0144" num="(a.12c)"><math display="block"><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mo>⁢</mo><mfenced><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>2</mn></mrow></msup></mfenced><mo>=</mo><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mo>⁢</mo><mi mathvariant="bold">ʹ</mi><mo>⁢</mo><mfenced><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mfenced><mo>⋅</mo><munder><mi mathvariant="bold">F</mi><mo>∼</mo></munder><mo>⁢</mo><mi>ʹ</mi><mo>⋅</mo><msup><munder><mi mathvariant="bold">T</mi><mo>∼</mo></munder><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><mfenced><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup></mfenced></math><img id="ib0144" file="imgb0144.tif" wi="155" he="10" img-content="math" img-format="tif"/></maths><br/>
und in Gleichung A.11a eingesetzt: <maths id="math0145" num="(a.13)"><math display="block"><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mfenced><mi mathvariant="normal">z</mi></mfenced><mo>=</mo><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mfenced><msup><mi mathvariant="normal">z</mi><mn>0</mn></msup></mfenced><mo>+</mo><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mo>⁢</mo><mfenced separators=""><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>+</mo></mfenced><mo>⁢</mo><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mo>⁢</mo><mfenced><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>2</mn></mrow></msup></mfenced></math><img id="ib0145" file="imgb0145.tif" wi="124" he="8" img-content="math" img-format="tif"/></maths><br/>
<!-- EPO <DP n="64"> -->womit sich die vereinfachte Schreibweise aus Gleichung 4.7 ergibt: <maths id="math0146" num="(a.14)"><math display="block"><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mo>=</mo><msub><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>0</mn></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mn>0</mn></msup><mo>+</mo><msub><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>0</mn></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>+</mo><msub><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>2</mn></msub><mo>⁢</mo><msup><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn>2</mn></mrow></msup></math><img id="ib0146" file="imgb0146.tif" wi="118" he="8" img-content="math" img-format="tif"/></maths></p><p id="p0269" num="0269">Die numerische Analyse der drei Teilmatrizen <maths id="math0147" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn></msub><mo>,</mo><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>1</mn></msub></math><img id="ib0147" file="imgb0147.tif" wi="17" he="9" img-content="math" img-format="tif" inline="yes"/></maths> und <maths id="math0148" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>2</mn></msub></math><img id="ib0148" file="imgb0148.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> liefert einige wichtige Erkenntnisse, die dazu beitragen, den Berechnungsaufwand der Matrix <maths id="math0149" num=""><math display="inline"><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder></math><img id="ib0149" file="imgb0149.tif" wi="7" he="8" img-content="math" img-format="tif" inline="yes"/></maths> deutlich zu reduzieren. Zunächst fällt auf, dass <maths id="math0150" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>1</mn></msub></math><img id="ib0150" file="imgb0150.tif" wi="9" he="9" img-content="math" img-format="tif" inline="yes"/></maths>eine schwachbesetzte Matrix ist. Sie weist für unterschiedliche Transformationslängen N immer die gleiche Form auf und besitzt ausschließlich die Elemente 0, 5 und -0, 5. Es gilt: <maths id="math0151" num="(a.15)"><math display="block"><msub><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>1</mn></msub><mo>=</mo><msub><mfenced open="[" close="]"><mtable><mtr><mtd><mn>0</mn><mo>,</mo><mn>5</mn></mtd><mtd><mo>-</mo><mn>0</mn><mo>,</mo><mn>5</mn></mtd><mtd><mn>0</mn></mtd><mtd><mspace width="1em"/></mtd><mtd><mo>…</mo></mtd><mtd><mspace width="1em"/></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn><mo>,</mo><mn>5</mn></mtd><mtd><mn>0</mn><mspace width="1em"/></mtd><mtd><mo>-</mo><mn>0</mn><mo>,</mo><mn>5</mn><mspace width="1em"/></mtd><mtd><mn>0</mn></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn><mo>,</mo><mn>5</mn></mtd><mtd><mn>0</mn><mspace width="1em"/></mtd><mtd><mo>-</mo><mn>0</mn><mo>,</mo><mn>5</mn></mtd><mtd><mn>0</mn></mtd><mtd><mspace width="1em"/></mtd><mtd><mo>⋮</mo></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>⋱</mo><mspace width="1em"/></mtd><mtd><mo>⋱</mo><mspace width="1em"/></mtd><mtd><mo>⋱</mo></mtd><mtd><mo>⋱</mo></mtd><mtd><mspace width="1em"/><mo>⋱</mo></mtd><mtd><mspace width="1em"/></mtd></mtr><mtr><mtd><mo>⋮</mo></mtd><mtd><mspace width="1em"/></mtd><mtd><mn>0</mn><mspace width="1em"/></mtd><mtd><mn>0</mn><mo>,</mo><mn>5</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>-</mo><mn>0</mn><mo>,</mo><mn>5</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn><mo>,</mo><mn>5</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>-</mo><mn>0</mn><mo>,</mo><mn>5</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mspace width="1em"/></mtd><mtd><mo>⋯</mo></mtd><mtd><mspace width="1em"/></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn><mo>,</mo><mn>5</mn></mtd><mtd><mn>0</mn><mo>,</mo><mn>5</mn></mtd></mtr></mtable></mfenced><mo>,</mo></msub></math><img id="ib0151" file="imgb0151.tif" wi="146" he="52" img-content="math" img-format="tif"/></maths></p><p id="p0270" num="0270">Zwischen den Matrizen <maths id="math0152" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn></msub></math><img id="ib0152" file="imgb0152.tif" wi="9" he="9" img-content="math" img-format="tif" inline="yes"/></maths> und <maths id="math0153" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>2</mn></msub></math><img id="ib0153" file="imgb0153.tif" wi="8" he="10" img-content="math" img-format="tif" inline="yes"/></maths> besteht ein direkter Zusammenhang, so dass: <maths id="math0154" num="(a.16)"><math display="block"><msub><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>2</mn></msub><mo>=</mo><msub><munder><mi mathvariant="bold">Π</mi><mo>∼</mo></munder><mi>N</mi></msub><mo>⋅</mo><mo>+</mo><msubsup><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>0</mn><mi mathvariant="normal">T</mi></msubsup><mo>⋅</mo><msub><munder><mi mathvariant="bold">Π</mi><mo>∼</mo></munder><mi>N</mi></msub></math><img id="ib0154" file="imgb0154.tif" wi="108" he="9" img-content="math" img-format="tif"/></maths><br/>
mit:
<maths id="math0155" num=""><img id="ib0155" file="imgb0155.tif" wi="113" he="31" img-content="math" img-format="tif"/></maths></p><p id="p0271" num="0271">Dabei ist <maths id="math0156" num=""><math display="inline"><msub><munder><mi mathvariant="bold">Π</mi><mo> ∼</mo></munder><mi>N</mi></msub></math><img id="ib0156" file="imgb0156.tif" wi="7" he="8" img-content="math" img-format="tif" inline="yes"/></maths> eine <i>N</i> × <i>N</i> Matrix, die von links multipliziert die Reihenfolge der Zeilen vertauscht und von rechts multipliziert die Reihenfolge der Spalten umdreht. Damit kann Gleichung A.16 als Spiegelung der Werte von Matrix <maths id="math0157" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn></msub></math><img id="ib0157" file="imgb0157.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> an ihrer Nebendiagonalen<!-- EPO <DP n="65"> --> interpretiert werden. Mit diesen Eigenschaften lässt sich nun der Aufwand zur Berechnung <maths id="math0158" num=""><math display="inline"><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder></math><img id="ib0158" file="imgb0158.tif" wi="7" he="8" img-content="math" img-format="tif" inline="yes"/></maths>von von ursprünglich 4<i>N</i><sup>3</sup> notwendigen Operationen (vgl. Gleichung A.11d) auf ein Viertel davon reduzieren.</p><p id="p0272" num="0272">Im Folgenden wird die schnelle DCT-IV erläutert. Die Implementierung der DCT-IV richtet sich nach dem Algorithmus der schnellen DCT-IV. Der Vorteil dieser Umsetzung ist die effiziente Berechnung der Transformation und dem damit verbundenen kurzen algorithmischen Delay. Kern der DCT-IV sind zwei parallel geschaltete DCT-III Transformationen nach Gleichung 2.14c. Diese setzt sich ähnlich der FFT aus einer sogenannten Butterfly- und einer Pipeline-Struktur zusammen (Rao und Yip, 2001). Die Komplexität dieses Algorithmus liegt bei <i>O</i> (<i>N</i> log <i>N</i>) und ist vergleichbar mit dem benötigten Rechenaufwand der FFT. Der genaue Aufbau der DCT-III ist in <figref idrefs="f0021">Fig. 19</figref> dargestellt. Speziell zeigt <figref idrefs="f0021">Fig. 19</figref> eine schnelle universelle DCT-III/DST-III Struktur (Rao und Yip, 2001)</p><p id="p0273" num="0273">Die Eingangsfolge x<sub>n</sub> wird damit in die DCT-II Spektralwerte <maths id="math0159" num=""><math display="inline"><msubsup><mi>χ</mi><mi>n</mi><mi mathvariant="italic">II</mi></msubsup></math><img id="ib0159" file="imgb0159.tif" wi="8" he="10" img-content="math" img-format="tif" inline="yes"/></maths> überführt. Da die DCT-III die inverse Transformation zur DCT-II darstellt, lassen sich beide Transformationen über diese Struktur berechnen. Diese universelle Struktur zur Berechnung der DCT-III/DST-III und der zugehörigen inversen Transformationen DCT-II und DST-II bildet die Basis für die DCT-IV nach Gleichung 2.14d. In <figref idrefs="f0022">Fig. 20</figref> ist der Aufbau der implementierten DCT-IV zu sehen. Dabei zeigt <figref idrefs="f0022">Fig. 20</figref> eine schnelle DCT-IV Struktur (Rao und Yip, 2001)</p><p id="p0274" num="0274">Die gezeigten Strukturen können beispielsweise in der Programmiersprache C umgesetzt werden. Die entsprechenden Funktionen sind dct_processor() für die universelle DCT-III/DST-III (DCT-II/DST-II) sowie fdcstiv1d() für die schnelle DCT-IV/DST-IV. In Matlab ist keine schnelle Variante dieser Transformationen implementiert, da hier die Performance des Algorithmus keine Rolle spielt.</p><p id="p0275" num="0275">Der folgende Abschnitt dient zur Beschreibung Matlab Funktionen, sowie Funktionen der Programmiersprache C.</p><heading id="h0003"><b>Matlab-Funktionen:</b></heading><heading id="h0004"><b>decoder_hsbe()</b></heading><p id="p0276" num="0276">Beschreibung:<!-- EPO <DP n="66"> -->
<ul><li>decoder_hsbe() ist ein Decoder für die harmonische Spektralbanderweiterung (HSBE). Ein Tiefpasssignal im MDCT Bereich wird dabei so spektral erweitert, das die harmonische Struktur des Signals erhalten bleibt. Zur Rekonstruktion der Hüllkurve wird eine inverse LPC Filterung durchgeführt. Mittels inverser MDCT wird das Signal in den Zeitbereich überführt.</li></ul></p><p id="p0277" num="0277">Prototyp:
<ul><li>[y varargout] = decoder_hsbe(X_core, T_idct, G, sideinfo, ...</li><li>aaf_dat, b_noisefill, b_useMDST);</li></ul></p><heading id="h0005">Output:</heading><p id="p0278" num="0278"><tables id="tabl0006" num="0006"><table frame="none"><tgroup cols="2" colsep="0" rowsep="0"><colspec colnum="1" colname="col1" colwidth="23mm"/><colspec colnum="2" colname="col2" colwidth="86mm"/><tbody><row><entry>y</entry><entry>rekonstruiertes Zeitsignal</entry></row><row><entry>varargout(1)</entry><entry>erweitertes MDCT Spektrum vor der Hüllkurvenanpassung</entry></row><row><entry>varargout(2)</entry><entry>erweitertes MDST Spektrum vor der Hüllkurvenanpassung</entry></row><row><entry>varargout(3)</entry><entry>komplexes Spektrum vor der Hüllkurvenanpassung</entry></row></tbody></tgroup></table></tables></p><heading id="h0006">Input:</heading><p id="p0279" num="0279"><tables id="tabl0007" num="0007"><table frame="none"><tgroup cols="2" colsep="0" rowsep="0"><colspec colnum="1" colname="col1" colwidth="16mm"/><colspec colnum="2" colname="col2" colwidth="75mm"/><tbody><row><entry>X_core</entry><entry>Basisband des Signals im MDCT Bereich</entry></row><row><entry>T_idct</entry><entry>inverse DCT-IV Transformationsmatrix</entry></row><row><entry>G</entry><entry>inverse Foldingmatrix für die iMDCT in Diamantform</entry></row><row><entry>sideinfo</entry><entry>Seiteninformationen</entry></row><row><entry>aaf_dat</entry><entry>Datenbank mit den Anti-Aliasing-Filterkoeffizienten</entry></row></tbody></tgroup></table></tables></p><heading id="h0007">Optional:</heading><p id="p0280" num="0280"><tables id="tabl0008" num="0008"><table frame="none"><tgroup cols="2" colsep="0" rowsep="0"><colspec colnum="1" colname="col1" colwidth="22mm"/><colspec colnum="2" colname="col2" colwidth="144mm"/><tbody><row><entry>b_noisefill</entry><entry>Boolean, gibt an, ob Rauschen addiert werden soll. Standard: false</entry></row><row><entry>b_useMDST</entry><entry>Boolean, gibt an, ob vorgerechnete MDST genutzt werden soll. Falls true muss X_core komplex sein. Standard: false</entry></row></tbody></tgroup></table></tables></p><heading id="h0008"><b>AAFCreator.m</b></heading><heading id="h0009">Beschreibung:</heading><p id="p0281" num="0281">Anti-Aliasing-Filter (AAF) FIR-Filter Creation-Tool "AAFCreator": AAF FIR-Filter<!-- EPO <DP n="67"> --> Creation-Tool berechnet Anti-Aliasing-Filter die zur Aliasing-Cancelation beim Teilbandschieben des HSBE Algorithmus benötigt werden. Die Filter liegen als FIR-Filter in einer Datenbank vor. Die Datenbank wird als .mat Datei gespeichert und beinhaltet ein eindimensionales struct. Jeder Eintrag in der Datenbank besteht aus derWinkelangabe für die das FIR-Filter zu benutzen ist und den Filterkoeffizienten als Vektor.</p><heading id="h0010">Prototyp:</heading><p id="p0282" num="0282">Matlab-Script, kein Funktionsname vorhanden.</p><heading id="h0011">Output:</heading><p id="p0283" num="0283"><tables id="tabl0009" num="0009"><table frame="none"><tgroup cols="2" colsep="0" rowsep="0"><colspec colnum="1" colname="col1" colwidth="14mm"/><colspec colnum="2" colname="col2" colwidth="113mm"/><tbody><row><entry>.bmp</entry><entry>Bitmaps mit der AAF-Impulsantwort und dem Resultat der Aliasing-Cancelation</entry></row><row><entry>.mat</entry><entry>Datenbank mit den AAF-Filtern im MAT-Datei Format</entry></row><row><entry>.wav</entry><entry>AAF-Impulsantwort als RIFF-Audio-Datei</entry></row></tbody></tgroup></table></tables></p><heading id="h0012">Input:</heading><p id="p0284" num="0284"><tables id="tabl0010" num="0010"><table frame="none"><tgroup cols="2" colsep="0" rowsep="0"><colspec colnum="1" colname="col1" colwidth="23mm"/><colspec colnum="2" colname="col2" colwidth="97mm"/><tbody><row><entry>fs</entry><entry>Abtastfrequenz des Testsignals</entry></row><row><entry>NMDCT</entry><entry>Transformationslänge <i>N</i></entry></row><row><entry>sig_typ</entry><entry>Testsignaltyp</entry></row><row><entry>f</entry><entry>Frequenz des Testsignal</entry></row><row><entry>t</entry><entry>Zeitdauer des Testsignals</entry></row><row><entry>phi</entry><entry>Phasenwinkel <i>ϕ</i>, mehrere Winkel sind möglich.</entry></row><row><entry>num_opt</entry><entry>Anzahl der Optimierungsdurchgänge</entry></row><row><entry>num_alias</entry><entry>höchste Ordnung der zu unterdrückenden Aliasing-Komponenten</entry></row><row><entry>b_save_wav</entry><entry>Boolean, gibt an, ob .wav Dateien gespeichert werden sollen.</entry></row><row><entry>b_save_bmp</entry><entry>Boolean, gibt an, ob .bmp Dateien gespeichert werden sollen.</entry></row><row><entry>b_break</entry><entry>Boolean, gibt an, ob bei Zwischenergebnissen pausiert werden soll.</entry></row><row><entry>path_bmp</entry><entry>Pfad für die .bmp Dateien</entry></row><row><entry>path_wav</entry><entry>Pfad für die .wav Dateien</entry></row></tbody></tgroup></table></tables></p><heading id="h0013"><b>AADoptimizer()</b></heading><heading id="h0014">Beschreibung:</heading><p id="p0285" num="0285">AAFoptimizer() generiert einen Anti-Aliasing-Filter (AAF) als FIR-Filter. Der Algorithmus optimiert numerisch die durch eine Signalspitzenkennung detektierten<!-- EPO <DP n="68"> --> Aliasing-Komponenten mittels sukzessiver Approximation.</p><heading id="h0015">Prototyp:</heading><p id="p0286" num="0286">[fir x_antialias] = AAFoptimizer(x, X_cmpx, T_imdct, ...T_imdst, varargin);</p><heading id="h0016">Output:</heading><p id="p0287" num="0287"><tables id="tabl0011" num="0011"><table frame="none"><tgroup cols="2" colsep="0" rowsep="0"><colspec colnum="1" colname="col1" colwidth="20mm"/><colspec colnum="2" colname="col2" colwidth="86mm"/><tbody><row><entry>fir</entry><entry>Filterimpulsantwort des Anti-Aliasing-Filters im Zeitbereich</entry></row><row><entry>x_antialias</entry><entry>durch fir aliasing-befreites Eingangssignal x</entry></row></tbody></tgroup></table></tables></p><heading id="h0017">Input:</heading><p id="p0288" num="0288"><tables id="tabl0012" num="0012"><table frame="none"><tgroup cols="2" colsep="0" rowsep="0"><colspec colnum="1" colname="col1" colwidth="16mm"/><colspec colnum="2" colname="col2" colwidth="79mm"/><tbody><row><entry>X</entry><entry>mit Aliasing-Komponenten versehenes Zeitsignal</entry></row><row><entry>X_cmpx</entry><entry>komplexe Darstellung von x im MDCT/MDST-Bereich</entry></row><row><entry>T_imdct</entry><entry>inverse MDCT-Matrix</entry></row><row><entry>T_imdst</entry><entry>inverse MDST-Matrix</entry></row></tbody></tgroup></table></tables></p><heading id="h0018">Optional:</heading><p id="p0289" num="0289"><tables id="tabl0013" num="0013"><table frame="none"><tgroup cols="2" colsep="0" rowsep="0"><colspec colnum="1" colname="col1" colwidth="21mm"/><colspec colnum="2" colname="col2" colwidth="117mm"/><tbody><row><entry>varargin(1)</entry><entry>höchste Ordnung der zu unterdrückenden Aliasing-Komponenten Standard: 4</entry></row><row><entry>varargin(2)</entry><entry>Anzahl der Optimierungsdurchgänge; Standard: 3</entry></row><row><entry>varargin(3)</entry><entry>Phasenwinkel <i>ϕ</i> mit dem x moduliert wurde; Standard: 0</entry></row><row><entry>varargin(4)</entry><entry>Boolean, gibt an, ob Plots erstellt werden sollen. Standard: false</entry></row><row><entry>varargin(5)</entry><entry>Boolean, gibt an, ob die erstellten Plots gespeichert werden sollen. Standard: false</entry></row><row><entry>varargin(6)</entry><entry>Pfad für die .bmp Dateien Standard: null</entry></row></tbody></tgroup></table></tables></p><heading id="h0019"><b>C-Funktionen</b></heading><heading id="h0020"><b>HSBEprocessing()</b></heading><heading id="h0021">Beschreibung:</heading><p id="p0290" num="0290">HSBEprocessing() ist die Hauptschnittstelle der erstellten Statischen Bibliothek hsbe.lib für die Bandbreitenerweiterung mittels HSBE. In der aktuellen Version 1.0 wird ein Signalausschnitt im Zeitbereich per MDCT/MDST transformiert und spektral so<!-- EPO <DP n="69"> --> ausgeweitet, dass die harmonische Struktur erhalten bleibt. Das komplexe bandbreitenerweiterte Signal wird wieder in den Zeitbereich überführt und ausgegeben. Eine Hüllkurvenrekonstruktion wie in der Matlab-Funktion decoder_hsbe() findet nicht statt.</p><heading id="h0022">Prototyp:</heading><p id="p0291" num="0291"><ul><li>HSBE_RESULT HSBEprocessing(HSBE_HANDLE HSBEhandle,...</li><li>float *pSamplesIn, float *pSamplesOut, ...</li><li>unsigned short nSamplesIn, float frequencyOffset);</li></ul></p><heading id="h0023">Output:</heading><p id="p0292" num="0292"><tables id="tabl0014" num="0014"><table frame="none"><tgroup cols="2" colsep="0" rowsep="0"><colspec colnum="1" colname="col1" colwidth="29mm"/><colspec colnum="2" colname="col2" colwidth="85mm"/><tbody><row><entry>HSBE_RESULT</entry><entry>Fehlercode</entry></row><row><entry>pSamplesOut</entry><entry>Zeiger zum Vektor des bandbreitenerweiterten Zeitsignals</entry></row></tbody></tgroup></table></tables></p><heading id="h0024">Input:</heading><p id="p0293" num="0293"><tables id="tabl0015" num="0015"><table frame="none"><tgroup cols="2" colsep="0" rowsep="0"><colspec colnum="1" colname="col1" colwidth="27mm"/><colspec colnum="2" colname="col2" colwidth="67mm"/><tbody><row><entry>HSBEhandle</entry><entry>HSBE handle struct</entry></row><row><entry>pSamplesIn</entry><entry>Zeiger auf den Vektor des Eingangssignals</entry></row><row><entry>nSamplesIn</entry><entry>Transformationslänge <i>N</i></entry></row><row><entry>frequencyOffset</entry><entry>Lag-Frequenz <i>f<sub>lag</sub></i> als normalisierte Frequenz</entry></row></tbody></tgroup></table></tables></p><heading id="h0025"><b>HSBEinit()</b></heading><heading id="h0026">Beschreibung:</heading><p id="p0294" num="0294">HSBEinit() ist die Funktion zur Initialisierung von HSBE. Hier wird der benötigte Arbeitsspeicher reserviert, die Fensterfunktion berechnet und die MDCT-MDST-Transformationsmatrix <maths id="math0160" num=""><math display="inline"><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder></math><img id="ib0160" file="imgb0160.tif" wi="7" he="8" img-content="math" img-format="tif" inline="yes"/></maths> berechnet. Zudem werden in das Handle alle erforderlichen Parameter für HSBEprocessing() eingetragen.</p><heading id="h0027">Prototyp:</heading><p id="p0295" num="0295"><ul><li>HSBE_RESULT HSBEinit(HSBE_HANDLE *HSBEhandle, ...</li><li>unsigned short nSamplesIn, float f_core, float f_hsbe,...</li><li>unsigned char windowtype, char flags);</li></ul></p><heading id="h0028">Output:</heading><!-- EPO <DP n="70"> --><p id="p0296" num="0296"><tables id="tabl0016" num="0016"><table frame="none"><tgroup cols="2" colsep="0" rowsep="0"><colspec colnum="1" colname="col1" colwidth="28mm"/><colspec colnum="2" colname="col2" colwidth="52mm"/><tbody><row><entry>HSBE_RESULT</entry><entry>Fehlercode</entry></row><row><entry>HSBEhandle</entry><entry>Zeiger auf das HSBE handle struct</entry></row></tbody></tgroup></table></tables></p><heading id="h0029">Input:</heading><p id="p0297" num="0297"><tables id="tabl0017" num="0017"><table frame="none"><tgroup cols="2" colsep="0" rowsep="0"><colspec colnum="1" colname="col1" colwidth="23mm"/><colspec colnum="2" colname="col2" colwidth="97mm"/><tbody><row><entry>HSBEhandle</entry><entry>Zeiger auf das HSBE handle struct</entry></row><row><entry>nSamplesIn</entry><entry>Transformationslänge N</entry></row><row><entry>f_core</entry><entry>Grenzfrequenz fg des Basisbands als normalisierte Frequenz</entry></row><row><entry>f_hsbe</entry><entry>maximale zu rekonstruierende Frequenz als normalisierte Frequenz</entry></row><row><entry>windowtype</entry><entry>Typ der zu verwendenden Fensterfunktion</entry></row><row><entry>flags</entry><entry>Kontroll-Flags</entry></row></tbody></tgroup></table></tables></p><heading id="h0030"><b>HSBEfree()</b></heading><heading id="h0031">Beschreibung:</heading><p id="p0298" num="0298">HSBEfree() gibt die durch HSBEinit() angeforderten Ressourcen wieder frei.</p><heading id="h0032">Prototyp:</heading><p id="p0299" num="0299">HSBE_RESULT HSBEfree(HSBE_HANDLE *HSBEhandle);</p><heading id="h0033">Output:</heading><p id="p0300" num="0300"><tables id="tabl0018" num="0018"><table frame="none"><tgroup cols="2" colsep="0" rowsep="0"><colspec colnum="1" colname="col1" colwidth="28mm"/><colspec colnum="2" colname="col2" colwidth="52mm"/><tbody><row><entry>HSBE_RESULT</entry><entry>Fehlercode</entry></row><row><entry>HSBEhandle</entry><entry>Zeiger auf das HSBE handle struct</entry></row></tbody></tgroup></table></tables></p><heading id="h0034">Input:</heading><p id="p0301" num="0301">HSBEhandle Zeiger auf das HSBE handle struct</p><p id="p0302" num="0302">Obwohl manche Aspekte im Zusammenhang mit einer Vorrichtung beschrieben wurden, versteht es sich, dass diese Aspekte auch eine Beschreibung des entsprechenden Verfahrens darstellen, so dass ein Block oder ein Bauelement einer Vorrichtung auch als ein entsprechender Verfahrensschritt oder als ein Merkmal eines Verfahrensschrittes zu verstehen ist. Analog dazu stellen Aspekte, die im Zusammenhang mit einem oder als ein Verfahrensschritt beschrieben wurden, auch eine Beschreibung eines entsprechenden Blocks oder<!-- EPO <DP n="71"> --> Details oder Merkmals einer entsprechenden Vorrichtung dar. Einige oder alle der Verfahrensschritte können durch einen Hardware-Apparat (oder unter Verwendung eines Hardware-Apparats), wie zum Beispiel einen Mikroprozessor, einen programmierbaren Computer oder einer elektronischen Schaltung durchgeführt werden. Bei einigen Ausführungsbeispielen können einige oder mehrere der wichtigsten Verfahrensschritte durch einen solchen Apparat ausgeführt werden.</p><p id="p0303" num="0303">Je nach bestimmten Implementierungsanforderungen können Ausführungsbeispiele der Erfindung in Hardware oder in Software implementiert sein. Die Implementierung kann unter Verwendung eines digitalen Speichermediums, beispielsweise einer Floppy-Disk, einer DVD, einer Blu-ray Disc, einer CD, eines ROM, eines PROM, eines EPROM, eines EEPROM oder eines FLASH-Speichers, einer Festplatte oder eines anderen magnetischen oder optischen Speichers durchgeführt werden, auf dem elektronisch lesbare Steuersignale gespeichert sind, die mit einem programmierbaren Computersystem derart zusammenwirken können oder zusammenwirken, dass das jeweilige Verfahren durchgeführt wird. Deshalb kann das digitale Speichermedium computerlesbar sein.</p><p id="p0304" num="0304">Manche Ausführungsbeispiele gemäß der Erfindung umfassen also einen Datenträger, der elektronisch lesbare Steuersignale aufweist, die in der Lage sind, mit einem programmierbaren Computersystem derart zusammenzuwirken, dass eines der hierin beschriebenen Verfahren durchgeführt wird.</p><p id="p0305" num="0305">Allgemein können Ausführungsbeispiele der vorliegenden Erfindung als Computerprogrammprodukt mit einem Programmcode implementiert sein, wobei der Programmcode dahin gehend wirksam ist, eines der Verfahren durchzuführen, wenn das Computerprogrammprodukt auf einem Computer abläuft.</p><p id="p0306" num="0306">Der Programmcode kann beispielsweise auch auf einem maschinenlesbaren Träger gespeichert sein.</p><p id="p0307" num="0307">Andere Ausführungsbeispiele umfassen das Computerprogramm zum Durchführen eines der hierin beschriebenen Verfahren, wobei das Computerprogramm auf einem maschinenlesbaren Träger gespeichert ist. Mit anderen Worten ist ein Ausführungsbeispiel des erfindungsgemäßen Verfahrens somit ein Computerprogramm, das einen Programmcode zum Durchführen eines der hierin beschriebenen Verfahren aufweist, wenn das Computerprogramm auf einem Computer abläuft.<!-- EPO <DP n="72"> --></p><p id="p0308" num="0308">Ein weiteres Ausführungsbeispiel der erfindungsgemäßen Verfahren ist somit ein Datenträger (oder ein digitales Speichermedium oder ein computerlesbares Medium), auf dem das Computerprogramm zum Durchführen eines der hierin beschriebenen Verfahren aufgezeichnet ist.</p><p id="p0309" num="0309">Ein weiteres Ausführungsbeispiel des erfindungsgemäßen Verfahrens ist somit ein Datenstrom oder eine Sequenz von Signalen, der bzw. die das Computerprogramm zum Durchführen eines der hierin beschriebenen Verfahren darstellt bzw. darstellen. Der Datenstrom oder die Sequenz von Signalen kann bzw. können beispielsweise dahin gehend konfiguriert sein, über eine Datenkommunikationsverbindung, beispielsweise über das Internet, transferiert zu werden.</p><p id="p0310" num="0310">Ein weiteres Ausführungsbeispiel umfasst eine Verarbeitungseinrichtung, beispielsweise einen Computer oder ein programmierbares Logikbauelement, die dahin gehend konfiguriert oder angepasst ist, eines der hierin beschriebenen Verfahren durchzuführen.</p><p id="p0311" num="0311">Ein weiteres Ausführungsbeispiel umfasst einen Computer, auf dem das Computerprogramm zum Durchführen eines der hierin beschriebenen Verfahren installiert ist.</p><p id="p0312" num="0312">Ein weiteres Ausführungsbeispiel gemäß der Erfindung umfasst eine Vorrichtung oder ein System, die bzw. das ausgelegt ist, um ein Computerprogramm zur Durchführung zumindest eines der hierin beschriebenen Verfahren zu einem Empfänger zu übertragen. Die Übertragung kann beispielsweise elektronisch oder optisch erfolgen. Der Empfänger kann beispielsweise ein Computer, ein Mobilgerät, ein Speichergerät oder eine ähnliche Vorrichtung sein. Die Vorrichtung oder das System kann beispielsweise einen Datei-Server zur Übertragung des Computerprogramms zu dem Empfänger umfassen.</p><p id="p0313" num="0313">Bei manchen Ausführungsbeispielen kann ein programmierbares Logikbauelement (beispielsweise ein feldprogrammierbares Gatterarray, ein FPGA) dazu verwendet werden, manche oder alle Funktionalitäten der hierin beschriebenen Verfahren durchzuführen. Bei manchen Ausführungsbeispielen kann ein feldprogrammierbares Gatterarray mit einem Mikroprozessor zusammenwirken, um eines der hierin beschriebenen Verfahren durchzuführen. Allgemein werden die Verfahren bei einigen Ausführungsbeispielen seitens einer beliebigen Hardwarevorrichtung durchgeführt. Diese kann eine universell einsetzbare Hardware wie ein Computerprozessor (CPU) sein oder für das Verfahren spezifische Hardware, wie beispielsweise ein ASIC.<!-- EPO <DP n="73"> --></p><p id="p0314" num="0314">Die oben beschriebenen Ausführungsbeispiele stellen lediglich eine Veranschaulichung der Prinzipien der vorliegenden Erfindung dar. Es versteht sich, dass Modifikationen und Variationen der hierin beschriebenen Anordnungen und Einzelheiten anderen Fachleuten einleuchten werden. Deshalb ist beabsichtigt, dass die Erfindung lediglich durch den Schutzumfang der nachstehenden Patentansprüche und nicht durch die spezifischen Einzelheiten, die anhand der Beschreibung und der Erläuterung der Ausführungsbeispiele hierin präsentiert wurden, beschränkt sei.<!-- EPO <DP n="74"> --></p><heading id="h0035"><b>Bedeutung der Abkürzungen:</b></heading><p id="p0315" num="0315"><dl id="dl0002" compact="compact"><dt>AAC</dt><dd>Advanced Audio Coding</dd><dt>AAF</dt><dd>Anti-Aliasing-Filter</dd><dt>ac-3</dt><dd>Dolby Digital Adaptive Transform Coder 3</dd><dt>BWE</dt><dd>Bandbreitenerweiterung (engl.: Bandwidth Extension)</dd><dt>CD</dt><dd>Compact Disc</dd><dt>CM-BWE</dt><dd>Bandbreitenerweiterung mittels kontinuierlicher Modulation (engl.: Continuously Modulated Bandwidth Extension)</dd><dt>DCT</dt><dd>Diskrete Cosinustransformation</dd><dt>DFT</dt><dd>Diskrete Fouriertransformation</dd><dt>DST</dt><dd>Diskrete Sinustransformation</dd><dt>DVD</dt><dd>Digital Versatile Disc</dd><dt>FFT</dt><dd>Schnelle Fouriertransformation (engl.: Fast Fourier Transform)</dd><dt>FIR</dt><dd>Endliche Impulsantwort (engl.: Finite Impulse Response)</dd><dt>HBE</dt><dd>harmonische Bandbreitenerweiterung (engl.: Harmonic Bandwidth Extension)</dd><dt>HE-AAC</dt><dd>MPEG-4 Hoch-effizientes Advanced Audio Coding (engl.: MPEG-4 High Efficiency Advanced Audio Coding)</dd><dt>HF</dt><dd>Hochfrequenz</dd><dt>HSBE</dt><dd>Harmonische Spektralbanderweiterung (engl.: Harmonic Spectral Bandwidth Extension)</dd><dt>JPEG</dt><dd>Joint Photographic Experts Group</dd><dt>KiB</dt><dd>Kibibyte 2<sup>10</sup> Byte = 1024 Byte</dd><dt>LOT</dt><dd>Überlappende Orthogonale Transformation (engl.: Lapped Orthogonal Transform)</dd><dt>LPC</dt><dd>Lineare prädiktive Codierung (engl.: Linear Predictive Coding)</dd><dt>LTI</dt><dd>linear Zeit-invariant (engl.: linear time-invariant)</dd><dt>MDCT</dt><dd>modifizierte diskrete Cosinustransformation</dd><dt>MDST</dt><dd>modifizierte diskrete Sinustransformation</dd><dt>MiB</dt><dd>Mebibyte = 2<sup>20</sup> Byte = 1048576 Byte</dd><dt>mp3</dt><dd>MPEG-1 Audio Layer III</dd><dt>PC</dt><dd>Personal Computer</dd><dt>PCM</dt><dd>Pulse Code Modulation</dd><dt>PR</dt><dd>perfekte Rekonstruktion</dd><dt>QMF</dt><dd>Quadratur-Spiegel-Filter (engl.: Quadrature Mirror Filter)<!-- EPO <DP n="75"> --></dd><dt>SBR</dt><dd>Spektralbandreplikation (engl.: Spectral Band Replication)</dd><dt>SNR</dt><dd>Signal-Rausch-Verhältnis (engl.: Signal-To-Noise Ratio)</dd><dt>TDA</dt><dd>Zeitdomänen-Verzerrung (engl.: Time Domain Aliasing)</dd><dt>TDAC</dt><dd>Zeitdomänen-Aliasing-Kompensierung (engl.: Time Domain Aliasing Cancelation)</dd><dt>USAC</dt><dd>Unified Speech and Audio Coding</dd><dt>VoIP</dt><dd>Voice over Internet Protocol</dd></dl></p><heading id="h0036"><b>Bedeutung der verwendeten Symbole:</b></heading><p id="p0316" num="0316">e  Eulersche Zahl<br/>
j  imaginäre Einheit<br/>
Im  Imaginärteil einer Funktion<br/>
ld  Logarithmus zur Basis Zwei<br/>
log  Logarithmus zur Basis Zehn<br/>
*  konjugiert komplex<br/>
Re  Realteil einer Funktion<br/>
O  Landau-Symbol zur Komplexitätsabschätzung<br/>
T  transponiert<br/>
┌·┘  Rundungsoperator<br/>
└·┘  Rundungsoperator für Abrunden<br/>
R  Menge der reellen Zahlen<br/>
N  Menge der nicht-negativen ganzen Zahlen<br/>
N<sup>+</sup>  Menge der positiven ganzen Zahlen<br/>
Z  Menge der ganzen Zahlen<br/>
∈  Normierungsfaktor, ∈ ∈ R<br/>
σ  Streckungsfaktor, Fensterindex, σ ∈ N<sup>+</sup><br/>
τ  Modulationsindex, T ∈ N<br/>
<i>ϕ</i>  Phasenwinkel, <i>ϕ</i> ∈ R<br/>
<i>ω</i>  normierte Frequenz, ω ∈ R<br/>
<i>b</i>  Blockindex, b ∈ N<br/>
<i>B</i>  Bandbreite, <i>B</i> ∈ R<br/>
<!-- EPO <DP n="76"> --><i>f</i>  Frequenz, <i>f</i> ∈ R<br/>
<i>k</i>  diskreter Frequenzindex, k ∈ N<br/>
<i>m</i>  diskreter Phasenindex, m ∈ N<br/>
<i>M</i>  Phasenanzahl, <i>M</i> ∈ N<br/>
<i>n</i>  diskreter Zeitindex, <i>n</i> ∈ N<br/>
<i>N</i>  Transformationslänge, <i>N</i> ∈ N<br/>
<i>t</i>  Zeit, t ∈ R<br/>
<i>W</i>  komplexer Drehzeiger<br/>
<i>h[n]</i>  Impulsantwort eines FIR-Filters<br/>
<i>H</i>[z]  Übertragungsfunktion von <i>h</i>[<i>n</i>] im z-Bereich<br/>
<i>p<sub>m</sub>[n]</i>  m-te Phase eines diskreten Signals<br/>
<i>w</i>[<i>n</i>]  Fensterfunktion im diskreten Zeitbereich<br/>
<i>x</i>[<i>n</i>]  reelles Signal im diskreten Zeitbereich<br/>
<i>x</i>(<i>t</i>)  reelles Signal im kontinuierlichen Zeitbereich<br/>
<i>X</i>(<i>f</i>)  Signals im kontinuierlichen Frequenzbereich<br/>
<i>X[k]</i>  Signals im diskreten Frequenzbereich<br/>
<b><u>h</u></b>  Impulsantwort <i>h</i>[<i>n</i>] in Vektorschreibweise<br/>
<b><u>H</u></b>  <i>H</i>[z] in Vektorschreibweise<br/>
<b><u>X</u></b>  Signal ×[<i>n</i>] in Vektorschreibweise<br/>
<maths id="math0161" num=""><math display="inline"><mtable columnalign="left"><mtr><mtd><munder><mi mathvariant="bold">D</mi><mo> ∼</mo></munder></mtd></mtr><mtr><mtd><munder><mi mathvariant="bold">F</mi><mo> ∼</mo></munder></mtd></mtr></mtable></math><img id="ib0161" file="imgb0161.tif" wi="7" he="14" img-content="math" img-format="tif" inline="yes"/></maths>  Delaymatrix Fenstermatrix in Diamantform<br/>
<maths id="math0162" num=""><math display="inline"><mtable columnalign="left"><mtr><mtd><msub><munder><mi mathvariant="bold">F</mi><mo> ∼</mo></munder><mrow><mi>α</mi><mo>,</mo><mi>s</mi></mrow></msub></mtd></mtr><mtr><mtd><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder></mtd></mtr></mtable></math><img id="ib0162" file="imgb0162.tif" wi="12" he="14" img-content="math" img-format="tif" inline="yes"/></maths>  Foldingmatrix Polyphasen-Transformationsmatrix<br/>
<maths id="math0163" num=""><math display="inline"><mtable columnalign="left"><mtr><mtd><msub><munder><mi mathvariant="bold">P</mi><mo> ∼</mo></munder><mrow><mi>α</mi><mo>,</mo><mi>s</mi></mrow></msub></mtd></mtr><mtr><mtd><munder><mi mathvariant="bold">T</mi><mo> ∼</mo></munder></mtd></mtr></mtable></math><img id="ib0163" file="imgb0163.tif" wi="12" he="14" img-content="math" img-format="tif" inline="yes"/></maths>  Polyphasenmatrix Transformationsmatrix<br/>
<maths id="math0164" num=""><math display="inline"><mtable columnalign="left"><mtr><mtd><munder><mi mathvariant="bold">x</mi><mo> ∼</mo></munder></mtd></mtr><mtr><mtd><munder><mi mathvariant="bold">X</mi><mo> ∼</mo></munder></mtd></mtr></mtable></math><img id="ib0164" file="imgb0164.tif" wi="8" he="13" img-content="math" img-format="tif" inline="yes"/></maths>  Blockmatrix des Signalvektors <b><u>x</u></b> transformiertes Signal<!-- EPO <DP n="77"> --></p><heading id="h0037"><u>Literatur:</u></heading><p id="p0317" num="0317"><ul><li>[Ahmed u. a. 1974] <nplcit id="ncit0001" npl-type="s"><text>Ahmed, N. ; Natarajan, T. ; Rao, K.R.: Discrete Cosine Transform. In: Computers, IEEE Transactions on C-23 (1974), Januar, Nr. 1</text></nplcit></li><li>[Bosi und Goldberg 2003] <nplcit id="ncit0002" npl-type="b"><text>Bosi, M. ; Goldberg, R. E.: Introduction to Digital Audio Coding and Standards. 2. Auflage. Boston; Dordrecht; London : Kluwer Academic Publishers, 2003</text></nplcit></li><li>[Britanak u. a. 2007] <nplcit id="ncit0003" npl-type="b"><text>Britanak, V. ; Yip, P. C. ; Rao, K. R.: Discrete Cosine and Sine Transforms: General Properties, Fast Algorithms and Integer Approximations. Amsterdam; u.a. : Elsevier, 2007</text></nplcit></li><li>[Burrus und Parks 1985] <nplcit id="ncit0004" npl-type="b"><text>Burrus, C. S. ; Parks, T.: DFT/FFT and Convolution Algorithms: Theory and Implementation. New York : John Wiley &amp; Sons Ltd., 1985</text></nplcit></li><li>[Cheng 2004] <nplcit id="ncit0005" npl-type="s"><text>Cheng, C.: Method for Estimating Magnitude and Phase in the MDCT Domain. In: Audio Engineering Society Convention 116, Mai 2004</text></nplcit></li><li>[Dolson 1986] <nplcit id="ncit0006" npl-type="s"><text>Dolson, M: The Phase Vocoder: A Tutorial. In: Computer Music Journal 10 (1986), Nr. 4</text></nplcit></li><li>[Ekstrand 2002] <nplcit id="ncit0007" npl-type="s"><text>Ekstrand, P.: Bandwidth Extension of Audio Signals by Spectral Band Replication. In: Proceedings of 1st IEEE Benelux Workshop on MPCA, Leuven, Belgium. Bd. 1, November 2002</text></nplcit></li><li>[Fastl und Zwicker 2007] <nplcit id="ncit0008" npl-type="b"><text>Fastl, H. ; Zwicker, E.: Psychoacoustics: Facts and Models. 3. Auflage. Berlin; Heidelberg; New York : Springer, 2007</text></nplcit></li><li>[Jordan-Engeln und Reutter 1978] <nplcit id="ncit0009" npl-type="b"><text>Jordan-Engeln, G. ; Reutter, F.: Numerische Mathematik für Ingenieure. 2. überarb. Auflage. Mannheim : Bibliographisches Institut, 1978</text></nplcit></li><li>[Kiencke und Jäkel 2005] <nplcit id="ncit0010" npl-type="b"><text>Kiencke, U. ; Jäkel, H.: Signale und Systeme. 3. überarb. Auflage. München; Wien : Oldenburg Verlag, 2005</text></nplcit></li><li>[Larsen und Aarts 2004] <nplcit id="ncit0011" npl-type="b"><text>Larsen, E. ; Aarts, R. M.: Audio Bandwidth Extension: Application of Psychoacoustics, Signal Processing and Loudspeaker Design. Chichester :<!-- EPO <DP n="78"> --> John Wiley &amp; Sons Ltd., 2004</text></nplcit></li><li>[Lochmann 1990] <nplcit id="ncit0012" npl-type="b"><text>Lochmann, D.: Digitale Nachrichtentechnik: Digitale Modulation und Signalverarbeitung. Bd. 1. Berlin : VBE Verlag Technik, 1990</text></nplcit></li><li>[Malvar 1992] <nplcit id="ncit0013" npl-type="b"><text>Malvar, H. S.: Signal Processing with Lapped Transforms. Boston; London: Artech House, 1992</text></nplcit></li><li>[Malvar und Staelin 1989] <nplcit id="ncit0014" npl-type="s"><text>Malvar, H. S. ; Staelin, D. H.: The LOT: transform coding without blocking effects. In: Acoustics, Speech and Signal Processing, IEEE Transactions on 37 (1989), April, Nr. 4</text></nplcit></li><li>[Nagel und Disch 2009] <nplcit id="ncit0015" npl-type="s"><text>Nagel, F. ; Disch, S.: A harmonic bandwidth extension method for audio codecs. In: Acoustics, Speech and Signal Processing, 2009. ICASSP 2009. IEEE International Conference on, April 2009</text></nplcit></li><li>[Nagel u. a. 2010] <nplcit id="ncit0016" npl-type="s"><text>Nagel, F. ; Disch, S. ; Wilde, S.: A continuous modulated single sideband bandwidth extension. In: Acoustics Speech and Signal Processing (ICASSP), 2010 IEEE International Conference on, März 2010</text></nplcit></li><li>[Princen und Bradley 1986] <nplcit id="ncit0017" npl-type="s"><text>Princen, J. ; Bradley, A.: Analysis/Synthesis filter bank design based on time domain aliasing cancellation. In: Acoustics, Speech and Signal Processing, IEEE Transactions on 34 (1986), oct, Nr. 5</text></nplcit></li><li>[Princen u. a. 1987] <nplcit id="ncit0018" npl-type="s"><text>Princen, J. ; Johnson, A. ; Bradley, A.: Subband/Transform coding using filter bank designs based on time domain aliasing cancellation. In: Acoustics, Speech, and Signal Processing, IEEE International Conference on ICASSP '87. Bd. 12, April 1987</text></nplcit></li><li>[Rao und Yip 2001] <nplcit id="ncit0019" npl-type="b"><text>Rao, K. R. ; Yip, P. C.: The Transform and Data Compression Handbook. London; New York; Washington, D.C. : CRC Press, 2001</text></nplcit></li><li>[Schuller und Smith 1996] <nplcit id="ncit0020" npl-type="s"><text>Schuller, G. D. T. ; Smith, M. J. T.: New framework for modulated perfect reconstruction filter banks. In: Signal Processing, IEEE Transactions on 44 (1996), August, Nr. 8</text></nplcit></li><li>[Weinzierl 2008] <nplcit id="ncit0021" npl-type="b"><text>Weinzierl, S.: Handbuch der Audiotechnik Berlin; Heidelberg: Springer, 2008</text></nplcit><!-- EPO <DP n="79"> --></li><li>[Wilde 2009] <nplcit id="ncit0022" npl-type="b"><text>Wilde, Stephan: Entwicklung von Zeitbereichsverfahren zur Bandbreitenerweiterung von Audiosignalen, Friedrich-Alexander-Universität Erlangen-Nürnberg, Diplomarbeit, 2009</text></nplcit></li><li>[Yost 1994] <nplcit id="ncit0023" npl-type="b"><text>Yost,W. A.: Fundamentals of Hearing: An Introduction. 3. Auflage. San Diego; New York; Boston; London; Sydney; Tokyo : Academic Press, 1994</text></nplcit></li><li>[Zölzer 2005] <nplcit id="ncit0024" npl-type="b"><text>Zölzer, U.: Digitale Audiosignalverarbeitung. 3. überarb. und erw. Auflage. Stuttgart; Leipzig; Wiesbaden: Teubner, 2005</text></nplcit></li></ul></p></description><claims mxw-id="PCLM56981991" lang="DE" load-source="patent-office"><!-- EPO <DP n="80"> --><claim id="c-de-0001" num="0001"><claim-text>Eine Vorrichtung (100; 150; 300) zur Erzeugung eines frequenzverschobenen Audiosignals basierend auf einem Audioeingangssignal, wobei das Audioeingangssignal für eine Mehrzahl von ersten Subbändern durch einen oder mehrere erste Subband-Werte darstellbar ist, wobei die Vorrichtung (100; 150; 300) umfasst:
<claim-text>eine Schnittstelle (110; 310) zum Empfang des Audioeingangssignals, und</claim-text>
<claim-text>eine Frequenzverschiebungseinheit (120; 320) zur Erzeugung des frequenzverschobenen Audiosignals, wobei das frequenzverschobene Audiosignal für eine Mehrzahl von zweiten Subbändern jeweils einen oder mehrere zweite Subband-Werte aufweist,</claim-text>
<claim-text>wobei jeder der ersten und der zweiten Subband-Werte Information über jeweils einen Phasenwinkel aufweist, und</claim-text>
<claim-text>wobei die Frequenzverschiebungseinheit (120; 320) dafür eingerichtet ist, einen der zweiten Subband-Werte basierend auf einem der ersten Subband-Werte so zu erzeugen, dass der zweite Phasenwinkel dieses zweiten Subband-Werts sich von dem ersten Phasenwinkel dieses ersten Subband-Werts um eine Phasenwinkel-Differenz unterscheiden kann, wobei die Phasenwinkel-Differenz von einer Frequenzinformation abhängt, die angibt, um welche Frequenzdifferenz das Audioeingangssignal zu verschieben ist, um das frequenzverschobene Audiosignal zu erhalten, und wobei die Phasenwinkel-Differenz von einer Frequenz-Bandbreite von einem der ersten Subbänder abhängt.</claim-text></claim-text></claim><claim id="c-de-0002" num="0002"><claim-text>Eine Vorrichtung (100; 150; 300) nach Anspruch 1, wobei die Frequenzverschiebungseinheit (120; 320) dafür eingerichtet ist, basierend auf der Frequenzinformation für jedes der zweiten Subbänder eines der ersten Subbänder zu bestimmen, wobei die Frequenzverschiebungseinheit (120; 320) ferner dafür eingerichtet ist, die ein oder mehreren der zweiten Subband-Werte des jeweiligen zweiten Subbands basierend auf einem oder mehreren der ersten Subband-Werte des jeweils bestimmten ersten Subbands zu erzeugen, wobei die Frequenzverschiebungseinheit (120; 320) dafür eingerichtet ist, jeweils einen der zweiten Subband-Werte des jeweiligen zweiten Subbands basierend auf jeweils einem der ersten Subband-Werte des jeweils bestimmten ersten Subbands so zu erzeugen, dass die Information über den Phasenwinkel des jeweiligen zweiten Subband-Werts von der Information über den<!-- EPO <DP n="81"> --> Phasenwinkel des jeweiligen ersten Subband-Werts und von einem Verhältnis der Frequenzdifferenz, um die das Audioeingangssignal zu verschieben ist, zu der Frequenzbandbreite dieses Subbands, abhängt.</claim-text></claim><claim id="c-de-0003" num="0003"><claim-text>Eine Vorrichtung (100; 150; 300) nach Anspruch 1 oder 2,<br/>
wobei jeder ersten Subband-Werte und jeder der zweiten Subband-Werte als komplexe Zahlen darstellbar sind,<br/>
wobei die Frequenzverschiebungseinheit (120; 320) dafür eingerichtet ist, einen Ergebniswert einer komplexen Exponentialfunktion zu bestimmen, und<br/>
wobei die Frequenzverschiebungseinheit (120; 320) dafür eingerichtet ist, wenigstens einen der zweiten Subband-Werte basierend auf einem der ersten Subband-Werte dadurch zu erzeugen, dass eine erste komplexe Zahl, die den einen der ersten Subband-Werte darstellt, mit dem Ergebniswert multipliziert wird, um eine zweite komplexe Zahl zu erhalten, die den einen der zweiten Subband-Werte darstellt.</claim-text></claim><claim id="c-de-0004" num="0004"><claim-text>Eine Vorrichtung (100; 150; 300) nach Anspruch 3,<br/>
wobei die Frequenzverschiebungseinheit (120; 320) dafür eingerichtet ist, den Ergebniswert der komplexen Exponentialfunktion zu bestimmen, wobei die komplexe Exponentialfunktion die Form: <maths id="math0165" num=""><math display="block"><msup><mi mathvariant="normal">e</mi><mrow><mo>-</mo><mi mathvariant="normal">j</mi><mo>⋅</mo><mi>b</mi><mo>⋅</mo><mi>φ</mi></mrow></msup><mo>⋅</mo><mfrac><mi>π</mi><mrow><mn>180</mn><mo>⁢</mo><mi>°</mi></mrow></mfrac></math><img id="ib0165" file="imgb0165.tif" wi="24" he="8" img-content="math" img-format="tif"/></maths><br/>
aufweist,<br/>
wobei j eine imaginäre Einheit ist, wobei b ein ganzzahliger Wert ist, und wobei ϕ ein Winkel in Grad ist, der von der Frequenzdifferenz abhängt, um die die ersten Subband-Werte der Subbänder zu verschieben sind.</claim-text></claim><claim id="c-de-0005" num="0005"><claim-text>Eine Vorrichtung (100; 150; 300) nach einem der vorherigen Ansprüche,<br/>
wobei die Frequenzverschiebungseinheit (120; 320) dafür eingerichtet ist, den einen der zweiten Subband-Werte basierend auf der einem der ersten Subband-Werte zu erzeugen, und<br/>
<!-- EPO <DP n="82"> -->wobei die ersten Subband-Werte erste MDCT-Koeffizienten des Audioeingangssignals sind, die Koeffizienten einer Modifizierten Diskreten Kosinustransformation des Audioeingangssignals sind, oder wobei die ersten Subband-Werte erste QMF-Koeffizienten des Audioeingangssignals sind, die Koeffizienten einer QMF-Transformation des Audioeingangssignals sind.</claim-text></claim><claim id="c-de-0006" num="0006"><claim-text>Eine Vorrichtung (100; 150; 300) nach einem der vorherigen Ansprüche,<br/>
wobei die Vorrichtung (100; 150; 300) ferner eine MDCT-/MDST-Transformationseinheit (315) umfasst,<br/>
wobei die MDCT-/MDST-Transformationseinheit (315) dafür eingerichtet ist, einen oder mehrere erste MDCT-Koeffizienten des Audioeingangssignals zu erhalten, die Koeffizienten einer Modifizierten Diskreten Kosinustransformation des Audioeingangssignals sind,<br/>
wobei die MDCT-/MDST-Transformationseinheit (315) dafür eingerichtet ist, basierend auf einem oder mehreren der ersten MDCT-Koeffizienten des Audioeingangssignals einen oder mehrere erste MDST-Koeffizienten des Audioeingangssignals zu bestimmen, die Koeffizienten einer Modifizierten Diskreten Sinustransformation sind, und<br/>
wobei die Frequenzverschiebungseinheit (120; 320) dafür eingerichtet ist, jeden der zweiten Subband-Werte basierend auf jeweils einem der ersten Subband-Werte zu erzeugen, wobei jeder der ersten Subband-Werte auf einem der ersten MDCT-Koeffizienten und einem der ersten MDST-Koeffizienten, der basierend auf diesem ersten MDCT-Koeffizienten bestimmt wurde, basiert.</claim-text></claim><claim id="c-de-0007" num="0007"><claim-text>Eine Vorrichtung (100; 150; 300) nach Anspruch 6,<br/>
wobei die Frequenzverschiebungseinheit (120; 320) dafür eingerichtet ist, jeden der zweiten Subband-Werte basierend auf jeweils einem der ersten Subband-Werte zu erzeugen, wobei jeder der ersten MDCT-Koeffizienten und jeder der ersten MDST-Koeffizienten reellwertig ist, und wobei jeder der ersten Subband-Werte eine Summe einer der ersten MDCT-Koeffizienten und einer der mit der imaginären Einheit j multiplizierten ersten MDST-Koeffizienten, der basierend auf diesem ersten MDCT-Koeffizienten bestimmt wurde, darstellt.<!-- EPO <DP n="83"> --></claim-text></claim><claim id="c-de-0008" num="0008"><claim-text>Eine Vorrichtung (100; 150; 300) nach einem der Ansprüche 6 oder 7,<br/>
wobei die MDCT-/MDST-Transformationseinheit (315) dafür eingerichtet ist, basierend auf einem oder mehreren der ersten MDCT-Koeffizienten des Audioeingangssignals die einen oder mehreren ersten MDST-Koeffizienten des Audioeingangssignals zu bestimmen,<br/>
wobei die ersten MDCT-Koeffizienten des Audioeingangssignals als Matrix-Koeffizienten einer MDCT-Koeffizientenmatrix <maths id="math0166" num=""><math display="inline"><munder><mi mathvariant="bold">X</mi><mo> ∼</mo></munder><mo>,</mo></math><img id="ib0166" file="imgb0166.tif" wi="7" he="8" img-content="math" img-format="tif" inline="yes"/></maths> die eine oder mehrere Spalten umfasst, darstellbar sind,<br/>
wobei das Audioeingangssignal in Blöcke unterteilt ist,<br/>
wobei jeder der Spalten der MDCT-Koeffizientenmatrix <maths id="math0167" num=""><math display="inline"><munder><mi mathvariant="bold">X</mi><mo> ∼</mo></munder></math><img id="ib0167" file="imgb0167.tif" wi="5" he="10" img-content="math" img-format="tif" inline="yes"/></maths> einen der Blöcke des Audioeingangssignals darstellt,<br/>
wobei jede der Spalten der MDCT-Koeffizientenmatrix <maths id="math0168" num=""><math display="inline"><munder><mi mathvariant="bold">X</mi><mo> ∼</mo></munder></math><img id="ib0168" file="imgb0168.tif" wi="5" he="8" img-content="math" img-format="tif" inline="yes"/></maths> ein MDCT-Spektrum des jeweiligen Blocks des Audioeingangssignals bildet, und<br/>
wobei die MDCT-/MDST-Transformationseinheit (315) die Matrixkoeffizienten einer Transformationsmatrix <maths id="math0169" num=""><math display="inline"><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder></math><img id="ib0169" file="imgb0169.tif" wi="5" he="8" img-content="math" img-format="tif" inline="yes"/></maths> so zu bestimmen, dass durch Matrixmultiplikation der Transformationsmatrix <maths id="math0170" num=""><math display="inline"><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder></math><img id="ib0170" file="imgb0170.tif" wi="5" he="8" img-content="math" img-format="tif" inline="yes"/></maths> mit der MDCT-Koeffizientenmatrix <maths id="math0171" num=""><math display="inline"><munder><mi mathvariant="bold">X</mi><mo> ∼</mo></munder></math><img id="ib0171" file="imgb0171.tif" wi="4" he="8" img-content="math" img-format="tif" inline="yes"/></maths> eine MDST-Koeffizientenmatrix <maths id="math0172" num=""><math display="inline"><munder><mi mathvariant="bold">X</mi><mo> ∼</mo></munder></math><img id="ib0172" file="imgb0172.tif" wi="4" he="8" img-content="math" img-format="tif" inline="yes"/></maths>MDST erhalten wird, deren Matrix-Koeffizienten die ersten MDST-Koeffizienten darstellen.</claim-text></claim><claim id="c-de-0009" num="0009"><claim-text>Eine Vorrichtung (100; 150; 300) nach einem der Ansprüche 6 oder 7,<br/>
wobei die MDCT-/MDST-Transformationseinheit (315) dafür eingerichtet ist, basierend auf einem oder mehreren der ersten MDCT-Koeffizienten des Audioeingangssignals die einen oder mehreren ersten MDST-Koeffizienten des Audioeingangssignals zu bestimmen,<br/>
wobei die ersten MDCT-Koeffizienten des Audioeingangssignals als Matrix-Koeffizienten einer MDCT-Koeffizientenmatrix <maths id="math0173" num=""><math display="inline"><munder><mi mathvariant="bold">X</mi><mo> ∼</mo></munder><mo>,</mo></math><img id="ib0173" file="imgb0173.tif" wi="7" he="8" img-content="math" img-format="tif" inline="yes"/></maths> die eine oder mehrere Spalten umfasst, darstellbar sind,<br/>
<!-- EPO <DP n="84"> -->wobei das Audioeingangssignal in Blöcke unterteilt ist, wobei jeder der Spalten der MDCT-Koeffizientenmatrix <maths id="math0174" num=""><math display="inline"><munder><mi mathvariant="bold">X</mi><mo> ∼</mo></munder></math><img id="ib0174" file="imgb0174.tif" wi="5" he="8" img-content="math" img-format="tif" inline="yes"/></maths> einen der Blöcke des Audioeingangssignals darstellt,<br/>
und wobei die MDCT-/MDST-Transformationseinheit (315) dafür eingerichtet ist, eine Formel <maths id="math0175" num=""><math display="block"><msub><munder><mi mathvariant="bold">X</mi><mo>̲</mo></munder><mi mathvariant="italic">MDST</mi></msub><mo>⁢</mo><mfenced separators=""><mi>b</mi><mo>-</mo><mn>1</mn></mfenced><mo>=</mo><msub><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>0</mn></msub><mo>⋅</mo><munder><mi mathvariant="bold">X</mi><mo>̲</mo></munder><mfenced><mi>b</mi></mfenced><mo>+</mo><msub><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>1</mn></msub><mo>⋅</mo><munder><mi mathvariant="bold">X</mi><mo>̲</mo></munder><mo>⁢</mo><mfenced separators=""><mi>b</mi><mo>-</mo><mn>1</mn></mfenced><mo>+</mo><msub><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>2</mn></msub><mo>⋅</mo><munder><mi mathvariant="bold">X</mi><mo>̲</mo></munder><mo>⁢</mo><mfenced separators=""><mi>b</mi><mo>-</mo><mn>2</mn></mfenced></math><img id="ib0175" file="imgb0175.tif" wi="119" he="8" img-content="math" img-format="tif"/></maths><br/>
anzuwenden, um die ersten MDST-Koeffizienten zu bestimmen,<br/>
wobei <u>X</u>(b) die b-te Spalte der Matrix <maths id="math0176" num=""><math display="inline"><munder><mi mathvariant="bold">X</mi><mo> ∼</mo></munder></math><img id="ib0176" file="imgb0176.tif" wi="5" he="10" img-content="math" img-format="tif" inline="yes"/></maths> ist,<br/>
wobei X(b-1) die b-1 -te Spalte der Matrix <maths id="math0177" num=""><math display="inline"><munder><mi mathvariant="bold">X</mi><mo> ∼</mo></munder></math><img id="ib0177" file="imgb0177.tif" wi="5" he="10" img-content="math" img-format="tif" inline="yes"/></maths> ist,<br/>
wobei <u>X</u>(b-2) die b-2 -te Spalte der Matrix <maths id="math0178" num=""><math display="inline"><munder><mi mathvariant="bold">X</mi><mo> ∼</mo></munder></math><img id="ib0178" file="imgb0178.tif" wi="7" he="9" img-content="math" img-format="tif" inline="yes"/></maths> ist,<br/>
wobei <maths id="math0179" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn></msub></math><img id="ib0179" file="imgb0179.tif" wi="8" he="9" img-content="math" img-format="tif" inline="yes"/></maths> eine erste Teilmatrix ist,<br/>
wobei <maths id="math0180" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>1</mn></msub></math><img id="ib0180" file="imgb0180.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> eine zweite Teilmatrix ist,<br/>
wobei <maths id="math0181" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>2</mn></msub></math><img id="ib0181" file="imgb0181.tif" wi="8" he="9" img-content="math" img-format="tif" inline="yes"/></maths> eine dritte Teilmatrix ist, und<br/>
wobei <u>X</u><sub>MDST</sub>(b - 1) ein MDST Spektrum des Blocks b-1 darstellt, das die ersten MDST-Koeffizenten umfasst.</claim-text></claim><claim id="c-de-0010" num="0010"><claim-text>Eine Vorrichtung (100; 150; 300) nach Anspruch 9,<br/>
wobei die MDCT-/MDST-Transformationseinheit (315) dafür eingerichtet ist, die Formel <maths id="math0182" num=""><math display="block"><msub><munder><mi mathvariant="bold">X</mi><mo>̲</mo></munder><mi mathvariant="italic">MDST</mi></msub><mo>⁢</mo><mfenced separators=""><mi>b</mi><mo>-</mo><mn>1</mn></mfenced><mo>=</mo><msub><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>0</mn></msub><mo>⋅</mo><munder><mi mathvariant="bold">X</mi><mo>̲</mo></munder><mfenced><mi>b</mi></mfenced><mo>+</mo><msub><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>1</mn></msub><mo>⋅</mo><munder><mi mathvariant="bold">X</mi><mo>̲</mo></munder><mo>⁢</mo><mfenced separators=""><mi>b</mi><mo>-</mo><mn>1</mn></mfenced><mo>+</mo><msub><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>2</mn></msub><mo>⋅</mo><munder><mi mathvariant="bold">X</mi><mo>̲</mo></munder><mo>⁢</mo><mfenced separators=""><mi>b</mi><mo>-</mo><mn>2</mn></mfenced></math><img id="ib0182" file="imgb0182.tif" wi="120" he="8" img-content="math" img-format="tif"/></maths><br/>
anzuwenden, um die ersten MDST-Koeffizienten zu bestimmen,<br/>
<!-- EPO <DP n="85"> -->wobei zwei oder mehrere Matrixkoffizienten der ersten Teilmatrix <maths id="math0183" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>0</mn></msub></math><img id="ib0183" file="imgb0183.tif" wi="8" he="9" img-content="math" img-format="tif" inline="yes"/></maths> den Wert 0 haben, wobei zwei oder mehrere Matrixkoffizienten der zweiten Teilmatrix <maths id="math0184" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>1</mn></msub></math><img id="ib0184" file="imgb0184.tif" wi="7" he="8" img-content="math" img-format="tif" inline="yes"/></maths>den Wert 0 haben, und wobei zwei oder mehrere Matrixkoffizienten der dritten Teilmatrix <maths id="math0185" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>2</mn></msub></math><img id="ib0185" file="imgb0185.tif" wi="8" he="9" img-content="math" img-format="tif" inline="yes"/></maths> den Wert 0 haben.</claim-text></claim><claim id="c-de-0011" num="0011"><claim-text>Eine Vorrichtung (100; 150; 300) nach Anspruch 9 oder 10,<br/>
wobei die MDCT-/MDST-Transformationseinheit (315) dafür eingerichtet ist, die Formel <maths id="math0186" num=""><math display="block"><msub><munder><mi mathvariant="bold">X</mi><mo>̲</mo></munder><mi mathvariant="italic">MDST</mi></msub><mo>⁢</mo><mfenced separators=""><mi>b</mi><mo>-</mo><mn>1</mn></mfenced><mo>=</mo><msub><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>0</mn></msub><mo>⋅</mo><munder><mi mathvariant="bold">X</mi><mo>̲</mo></munder><mfenced><mi>b</mi></mfenced><mo>+</mo><msub><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>1</mn></msub><mo>⋅</mo><munder><mi mathvariant="bold">X</mi><mo>̲</mo></munder><mo>⁢</mo><mfenced separators=""><mi>b</mi><mo>-</mo><mn>1</mn></mfenced><mo>+</mo><msub><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>2</mn></msub><mo>⋅</mo><munder><mi mathvariant="bold">X</mi><mo>̲</mo></munder><mo>⁢</mo><mfenced separators=""><mi>b</mi><mo>-</mo><mn>2</mn></mfenced></math><img id="ib0186" file="imgb0186.tif" wi="119" he="8" img-content="math" img-format="tif"/></maths><br/>
anzuwenden, um die ersten MDST-Koeffizienten zu bestimmen,<br/>
wobei die zweite Teilmatrix <maths id="math0187" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>1</mn></msub></math><img id="ib0187" file="imgb0187.tif" wi="8" he="9" img-content="math" img-format="tif" inline="yes"/></maths> die folgende Form aufweist: <maths id="math0188" num=""><math display="block"><msub><munder><mi mathvariant="bold">H</mi><mo>∼</mo></munder><mn>1</mn></msub><mo>=</mo><msub><mfenced open="[" close="]"><mtable><mtr><mtd><mn>0</mn><mo>,</mo><mn>5</mn></mtd><mtd><mo>-</mo><mn>0</mn><mo>,</mo><mn>5</mn></mtd><mtd><mn>0</mn></mtd><mtd><mspace width="1em"/></mtd><mtd><mo>…</mo></mtd><mtd><mspace width="1em"/></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn><mo>,</mo><mn>5</mn></mtd><mtd><mn>0</mn><mspace width="1em"/></mtd><mtd><mo>-</mo><mn>0</mn><mo>,</mo><mn>5</mn><mspace width="1em"/></mtd><mtd><mn>0</mn></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn><mo>,</mo><mn>5</mn></mtd><mtd><mn>0</mn><mspace width="1em"/></mtd><mtd><mo>-</mo><mn>0</mn><mo>,</mo><mn>5</mn></mtd><mtd><mn>0</mn></mtd><mtd><mspace width="1em"/></mtd><mtd><mo>⋮</mo></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>⋱</mo><mspace width="1em"/></mtd><mtd><mo>⋱</mo><mspace width="1em"/></mtd><mtd><mo>⋱</mo></mtd><mtd><mo>⋱</mo></mtd><mtd><mspace width="1em"/><mo>⋱</mo></mtd><mtd><mspace width="1em"/></mtd></mtr><mtr><mtd><mo>⋮</mo></mtd><mtd><mspace width="1em"/></mtd><mtd><mn>0</mn><mspace width="1em"/></mtd><mtd><mn>0</mn><mo>,</mo><mn>5</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>-</mo><mn>0</mn><mo>,</mo><mn>5</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="1em"/></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn><mo>,</mo><mn>5</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>-</mo><mn>0</mn><mo>,</mo><mn>5</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mspace width="1em"/></mtd><mtd><mo>⋯</mo></mtd><mtd><mspace width="1em"/></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn><mo>,</mo><mn>5</mn></mtd><mtd><mn>0</mn><mo>,</mo><mn>5</mn></mtd></mtr></mtable></mfenced><mo>,</mo></msub></math><img id="ib0188" file="imgb0188.tif" wi="108" he="49" img-content="math" img-format="tif"/></maths><br/>
wobei" ... " bedeutet, dass dieselben Werte vorausgehender Matrixkoeffizienten der zweiten Teilmatrix <maths id="math0189" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>1</mn></msub></math><img id="ib0189" file="imgb0189.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> in nachfolgenden Matrixkoeffizienten der zweiten Teilmatrix <maths id="math0190" num=""><math display="inline"><msub><munder><mi mathvariant="bold">H</mi><mo> ∼</mo></munder><mn>1</mn></msub></math><img id="ib0190" file="imgb0190.tif" wi="8" he="9" img-content="math" img-format="tif" inline="yes"/></maths> fortgesetzt werden.</claim-text></claim><claim id="c-de-0012" num="0012"><claim-text>Eine Vorrichtung (100; 150; 300) nach einem der vorherigen Ansprüche, wobei die Vorrichtung (100; 150; 300) ferner eine Filtereinheit (330) aufweist, wobei die Filtereinheit (330) dafür ausgelegt ist, die zweiten Subband-Werte durch Anwendung eines Filters, der eine Mehrzahl von Filterkoeffizienten aufweist, derart zu filtern, dass Störkomponenten der zweiten Subband-Werte, die bei der Erzeugung der zweiten Subband-Werte basierend auf den ersten Subband-Werten entstanden sind, verringert werden.<!-- EPO <DP n="86"> --></claim-text></claim><claim id="c-de-0013" num="0013"><claim-text>Eine Vorrichtung (100; 150; 300) nach Anspruch 12,<br/>
wobei die Frequenzverschiebungseinheit (120; 320) dafür eingerichtet ist, den einen der zweiten Subband-Werte basierend auf dem einem der ersten Subband-Werte so zu erzeugen, dass der zweite Phasenwinkel dieses zweiten Subband-Werts sich von dem ersten Phasenwinkel dieses ersten Subband-Werts um die Phasenwinkel-Differenz unterscheidet,<br/>
wobei die Filtereinheit (330) dafür ausgelegt ist, die zweiten Subband-Werte durch Anwendung des Filters zu filtern, und wobei ein oder mehrere der Filterkoeffizienten von der Phasenwinkel-Differenz abhängen.</claim-text></claim><claim id="c-de-0014" num="0014"><claim-text>Eine Vorrichtung (100; 150; 300) nach Anspruch 13,<br/>
wobei die Vorrichtung (100; 150; 300) ferner einen Speicher oder eine Datenbank aufweist,<br/>
wobei ein oder mehrere der Filterkoeffizienten von der Phasenwinkel-Differenz abhängen,<br/>
wobei die Filtereinheit (330) dafür eingerichtet ist, die Filterkoeffizienten in Abhängigkeit von der Phasenwinkel-Differenz aus dem Speicher oder der Datenbank auszulesen, und<br/>
wobei die Filtereinheit (330) dafür ausgelegt ist, die zweiten Subband-Werte durch Anwendung des Filters, der die aus dem Speicher oder der Datenbank ausgelesenen Filterkoeffizienten aufweist, zu filtern.</claim-text></claim><claim id="c-de-0015" num="0015"><claim-text>Eine Vorrichtung (100; 150; 300) nach einem der Ansprüche 12 bis 14,<br/>
wobei die Filtereinheit (330) dafür eingerichtet ist, jeden der ein oder mehreren zweiten Subband-Werte jedes der zweiten Subbänder zu filtern, um ein oder mehrere gefilterte Subband-Werte für jedes der zweiten Subbänder zu erhalten,<br/>
wobei die Filtereinheit (330) dafür ausgelegt ist, jeden der gefilterten Subband-Werte dadurch zu bestimmen, dass eine Summe aus einem ersten Summanden und ein oder mehreren weiteren Summanden gebildet wird,<br/>
<!-- EPO <DP n="87"> -->wobei der erste Summand einer der zweiten Subband-Werte eines der zweiten Subbänder ist,<br/>
wobei die ein oder mehreren weiteren Summanden ein oder mehrere gewichtete Subband-Werte sind, und<br/>
wobei die Filtereinheit (330) dafür eingerichtet ist, die ein oder mehreren gewichteten Subband-Werte jeweils durch Multiplikation eines der Filterkoeffizienten mit jeweils einem weiteren Subband-Wert eines anderen der weiteren Subbänder zu bestimmen.</claim-text></claim><claim id="c-de-0016" num="0016"><claim-text>Eine Vorrichtung (100; 150; 300) nach einem der vorherigen Ansprüche 12 bis 15,<br/>
wobei die Filtereinheit (330) dafür ausgelegt ist, die zweiten Subband-Werte durch Anwendung des Filters, der die Mehrzahl von Filterkoeffizienten aufweist, derart zu filtern, dass Störkomponenten der zweiten Subband-Werte verringert werden,<br/>
wobei die Filterkoeffizienten des Filters eine geordnete Reihenfolge aufweisen, und wobei in dieser Reihenfolge auf jeden Filterkoeffizienten, der ungleich 0 ist, ein Filterkoeffizient folgt, der gleich 0 ist.</claim-text></claim><claim id="c-de-0017" num="0017"><claim-text>Eine Vorrichtung (100; 150; 300) nach einem der vorherigen Ansprüche, wobei die Schnittstelle (110; 310) dafür eingerichtet ist, die Frequenzinformation zu empfangen, die angibt, um welche Frequenzdifferenz die ersten Subband-Werte der Subbänder des Audioeingangssignals zu verschieben sind.</claim-text></claim><claim id="c-de-0018" num="0018"><claim-text>Eine Vorrichtung (100; 150; 300) nach einem der vorherigen Ansprüche,<br/>
wobei die Vorrichtung (100; 150; 300) ferner eine Synthese-Transformationseinheit (340) umfasst, und<br/>
wobei die Synthese-Transformationseinheit dafür eingerichtet ist, durch Transformation der zweiten Subband-Werte in eine Mehrzahl von Zeitdomänen-Abtastwerten das frequenzverschobene Audiosignal zu erhalten.</claim-text></claim><claim id="c-de-0019" num="0019"><claim-text>Eine Vorrichtung (150) nach einem der vorherigen Ansprüche,<br/>
<!-- EPO <DP n="88"> -->wobei die Vorrichtung (150) dafür eingerichtet ist, ein frequenzverbreitertes Audiosignal zu erzeugen,<br/>
wobei die Vorrichtung (150) dafür eingerichtet ist, das frequenzverbreiterte Audiosignal dadurch zu erzeugen, dass die Vorrichtung (150) die zweiten Subband-Werte des frequenzverschobenen Audiosignals erzeugt, wobei das frequenzverbreiterte Audiosignal die ersten Subband-Werte des Audioeingangssignals und die zweiten Subband-Werte des frequenzverschobenen Audiosignals umfasst.</claim-text></claim><claim id="c-de-0020" num="0020"><claim-text>Eine Vorrichtung (150) nach Anspruch 19,<br/>
wobei die Vorrichtung (150) ferner eine Synthese-Transformationseinheit umfasst (340), und<br/>
wobei die Synthese-Transformationseinheit dafür eingerichtet ist, durch Transformation der ersten Subband-Werte und der zweiten Subband-Werte in eine Mehrzahl von Zeitdomänen-Abtastwerten das frequenzverbreiterte Audiosignal zu erhalten.</claim-text></claim><claim id="c-de-0021" num="0021"><claim-text>Eine Vorrichtung (150) nach einem der vorherigen Anspruch 19 oder 20, wobei die Vorrichtung (150) ferner eine Hüllkurven-Anpassungseinheit (350) umfasst, die dafür eingerichtet ist, das frequenzverbreiterte Audiosignal so zu filtern, dass dem frequenzverbreiterten Signal eine spektrale Einhüllende aufgeprägt wird.</claim-text></claim><claim id="c-de-0022" num="0022"><claim-text>Eine Vorrichtung (150) nach Anspruch 21, wobei die Hüllkurven-Anpassungseinheit (350) dafür eingerichtet ist, das frequenzverbreiterte Audiosignal durch inverse Filterung mit LPC-Koeffizienten zu filtern, um dem frequenzverbreiterten Signal die spektrale Einhüllende aufzuprägen.</claim-text></claim><claim id="c-de-0023" num="0023"><claim-text>Ein Verfahren zur Erzeugung eines frequenzverschobenen Audiosignals basierend auf einem Audioeingangssignal, wobei das Audioeingangssignal für eine Mehrzahl von ersten Subbändern durch einen oder mehrere erste Subband-Werte darstellbar ist, wobei das Verfahren umfasst:
<claim-text>Empfangen des Audioeingangssignals, und</claim-text>
<claim-text>Erzeugen des frequenzverschobenen Audiosignals, wobei das frequenzverschobene Audiosignal für eine Mehrzahl von zweiten Subbändern jeweils einen oder mehrere zweite Subband-Werte aufweisen,<!-- EPO <DP n="89"> --></claim-text>
<claim-text>wobei jeder der ersten und der zweiten Subband-Werte Information über jeweils einen Phasenwinkel aufweist, und</claim-text>
<claim-text>wobei einer der zweiten Subband-Werte basierend auf einem der ersten Subband-Werte so erzeugt wird, dass der zweite Phasenwinkel dieses zweiten Subband-Werts sich von dem ersten Phasenwinkel dieses ersten Subband-Werts um eine Phasenwinkel-Differenz unterscheiden kann, wobei die Phasenwinkel-Differenz von einer Frequenzinformation abhängt, die angibt, um welche Frequenzdifferenz das Audioeingangssignal zu verschieben ist, um das frequenzverschobene Audiosignal zu erhalten, und wobei die Phasenwinkel-Differenz von einer Frequenz-Bandbreite von einem der ersten Subbänder abhängt.</claim-text></claim-text></claim><claim id="c-de-0024" num="0024"><claim-text>Computerprogramm zur Durchführung des Verfahrens nach Anspruch 23, wenn das Computerprogramm auf einem Computer oder Signalprozessor ausgeführt wird.</claim-text></claim></claims><drawings mxw-id="PDW16670386" load-source="patent-office"><!-- EPO <DP n="90"> --><figure id="f0001" num="1A"><img id="if0001" file="imgf0001.tif" wi="144" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="91"> --><figure id="f0002" num="1B"><img id="if0002" file="imgf0002.tif" wi="138" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="92"> --><figure id="f0003" num="2"><img id="if0003" file="imgf0003.tif" wi="119" he="213" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="93"> --><figure id="f0004" num="3"><img id="if0004" file="imgf0004.tif" wi="163" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="94"> --><figure id="f0005" num="5A"><img id="if0005" file="imgf0005.tif" wi="165" he="174" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="95"> --><figure id="f0006" num="5B"><img id="if0006" file="imgf0006.tif" wi="165" he="167" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="96"> --><figure id="f0007" num="5"><img id="if0007" file="imgf0007.tif" wi="141" he="218" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="97"> --><figure id="f0008" num="6"><img id="if0008" file="imgf0008.tif" wi="135" he="215" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="98"> --><figure id="f0009" num="7"><img id="if0009" file="imgf0009.tif" wi="122" he="232" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="99"> --><figure id="f0010" num="8"><img id="if0010" file="imgf0010.tif" wi="119" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="100"> --><figure id="f0011" num="9"><img id="if0011" file="imgf0011.tif" wi="139" he="224" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="101"> --><figure id="f0012" num="10"><img id="if0012" file="imgf0012.tif" wi="150" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="102"> --><figure id="f0013" num="11"><img id="if0013" file="imgf0013.tif" wi="144" he="223" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="103"> --><figure id="f0014" num="12"><img id="if0014" file="imgf0014.tif" wi="146" he="203" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="104"> --><figure id="f0015" num="13"><img id="if0015" file="imgf0015.tif" wi="155" he="231" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="105"> --><figure id="f0016" num="14"><img id="if0016" file="imgf0016.tif" wi="134" he="200" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="106"> --><figure id="f0017" num="15"><img id="if0017" file="imgf0017.tif" wi="131" he="194" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="107"> --><figure id="f0018" num="16"><img id="if0018" file="imgf0018.tif" wi="136" he="191" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="108"> --><figure id="f0019" num="17"><img id="if0019" file="imgf0019.tif" wi="136" he="199" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="109"> --><figure id="f0020" num="18"><img id="if0020" file="imgf0020.tif" wi="149" he="183" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="110"> --><figure id="f0021" num="19"><img id="if0021" file="imgf0021.tif" wi="165" he="224" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="111"> --><figure id="f0022" num="20"><img id="if0022" file="imgf0022.tif" wi="165" he="209" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="112"> --><figure id="f0023" num="21"><img id="if0023" file="imgf0023.tif" wi="124" he="224" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="113"> --><figure id="f0024" num="22"><img id="if0024" file="imgf0024.tif" wi="138" he="211" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="114"> --><figure id="f0025" num="23"><img id="if0025" file="imgf0025.tif" wi="114" he="225" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="115"> --><figure id="f0026" num="24"><img id="if0026" file="imgf0026.tif" wi="66" he="230" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="116"> --><figure id="f0027" num="25"><img id="if0027" file="imgf0027.tif" wi="91" he="218" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="117"> --><figure id="f0028" num="26"><img id="if0028" file="imgf0028.tif" wi="127" he="221" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="118"> --><figure id="f0029" num="27"><img id="if0029" file="imgf0029.tif" wi="132" he="224" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="119"> --><figure id="f0030" num="28"><img id="if0030" file="imgf0030.tif" wi="130" he="223" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="120"> --><figure id="f0031" num="29"><img id="if0031" file="imgf0031.tif" wi="126" he="223" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="121"> --><figure id="f0032" num="30"><img id="if0032" file="imgf0032.tif" wi="119" he="222" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="122"> --><figure id="f0033" num="31"><img id="if0033" file="imgf0033.tif" wi="126" he="224" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="123"> --><figure id="f0034" num="32"><img id="if0034" file="imgf0034.tif" wi="125" he="226" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="124"> --><figure id="f0035" num="33"><img id="if0035" file="imgf0035.tif" wi="120" he="213" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="125"> --><figure id="f0036" num="34"><img id="if0036" file="imgf0036.tif" wi="124" he="213" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="126"> --><figure id="f0037" num="35"><img id="if0037" file="imgf0037.tif" wi="117" he="211" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="157" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="155" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
