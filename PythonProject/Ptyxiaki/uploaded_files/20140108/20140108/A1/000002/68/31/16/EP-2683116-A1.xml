<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2683116-A1" country="EP" doc-number="2683116" kind="A1" date="20140108" family-id="48692489" file-reference-id="286786" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146585133" ucid="EP-2683116-A1"><document-id><country>EP</country><doc-number>2683116</doc-number><kind>A1</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12305790-A" is-representative="YES"><document-id mxw-id="PAPP154847325" load-source="docdb" format="epo"><country>EP</country><doc-number>12305790</doc-number><kind>A</kind><date>20120702</date><lang>EN</lang></document-id><document-id mxw-id="PAPP178958779" load-source="docdb" format="original"><country>EP</country><doc-number>12305790.3</doc-number><date>20120702</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140552156" ucid="EP-12305790-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>12305790</doc-number><kind>A</kind><date>20120702</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1989318658" load-source="docdb">H04L  12/26        20060101AFI20121010BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1989322213" load-source="docdb">H04W  24/08        20090101ALI20121010BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1989322455" load-source="docdb">H04W  84/12        20090101ALI20121010BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1734650927" load-source="docdb" scheme="CPC">H04L  43/026       20130101 LI20171104BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2040291484" load-source="docdb" scheme="CPC">H04W  24/08        20130101 FI20150710BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2040292116" load-source="docdb" scheme="CPC">H04L  43/106       20130101 LI20150709BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2040296719" load-source="docdb" scheme="CPC">H04W  84/12        20130101 LA20150710BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2040298463" load-source="docdb" scheme="CPC">H04L  43/12        20130101 LI20150710BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132360032" lang="DE" load-source="patent-office">Verfahren zur Überwachung einer drahtlosen Verbindung eines Wi-Fi-Knotens einer Teilnehmereinrichtung und Teilnehmereinrichtung hierfür</invention-title><invention-title mxw-id="PT132360033" lang="EN" load-source="patent-office">Method for monitoring a wireless link of a WI-FI node of a customer premises equipment device, and customer premises equipment device utilizing the method</invention-title><invention-title mxw-id="PT132360034" lang="FR" load-source="patent-office">Procédé de surveillance d'une liaison sans fil d'un noeud WI-FI d'un dispositif d'équipement de d'abonné locaux et dispositif d'équipement de locaux client utilisant le procédé</invention-title><citations><patent-citations><patcit mxw-id="PCIT242943093" load-source="docdb" ucid="US-20070110018-A1"><document-id format="epo"><country>US</country><doc-number>20070110018</doc-number><kind>A1</kind><date>20070517</date></document-id><sources><source name="SEA" category="A" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242943094" load-source="docdb" ucid="US-7573859-B2"><document-id format="epo"><country>US</country><doc-number>7573859</doc-number><kind>B2</kind><date>20090811</date></document-id><sources><source name="SEA" category="I" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242943095" load-source="docdb" ucid="US-8102866-B2"><document-id format="epo"><country>US</country><doc-number>8102866</doc-number><kind>B2</kind><date>20120124</date></document-id><sources><source name="APP" created-by-npl="N"/></sources></patcit></patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR919539964" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>THOMSON LICENSING</last-name><address><country>FR</country></address></addressbook></applicant><applicant mxw-id="PPAR919525275" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>THOMSON LICENSING</last-name></addressbook></applicant><applicant mxw-id="PPAR919008048" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Thomson Licensing</last-name><iid>101157220</iid><address><street>1-5, rue Jeanne d'Arc</street><city>92130 Issy-Les-Moulineaux</city><country>FR</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919531122" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>VAN OOST KOEN</last-name><address><country>BE</country></address></addressbook></inventor><inventor mxw-id="PPAR919520907" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>VAN OOST, KOEN</last-name></addressbook></inventor><inventor mxw-id="PPAR919014888" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>VAN OOST, KOEN</last-name><address><street>Eenamelaan 17</street><city>2150 Borsbeek</city><country>BE</country></address></addressbook></inventor><inventor mxw-id="PPAR919529300" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>VERWAEST FREDERIK</last-name><address><country>BE</country></address></addressbook></inventor><inventor mxw-id="PPAR919524621" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>VERWAEST, FREDERIK</last-name></addressbook></inventor><inventor mxw-id="PPAR919017875" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>VERWAEST, FREDERIK</last-name><address><street>Hemelrijkstraat 5</street><city>2400 Mol</city><country>BE</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR919010056" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Arnold, Klaus-Peter</last-name><iid>100823344</iid><address><street>Deutsche Thomson OHG European Patent Operations Karl-Wiechert-Allee 74</street><city>30625 Hannover</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS549816881" load-source="docdb">AL</country><country mxw-id="DS549744903" load-source="docdb">AT</country><country mxw-id="DS549908642" load-source="docdb">BE</country><country mxw-id="DS549818924" load-source="docdb">BG</country><country mxw-id="DS549815022" load-source="docdb">CH</country><country mxw-id="DS549908643" load-source="docdb">CY</country><country mxw-id="DS549744904" load-source="docdb">CZ</country><country mxw-id="DS549816887" load-source="docdb">DE</country><country mxw-id="DS549908644" load-source="docdb">DK</country><country mxw-id="DS549908645" load-source="docdb">EE</country><country mxw-id="DS549816420" load-source="docdb">ES</country><country mxw-id="DS549818925" load-source="docdb">FI</country><country mxw-id="DS549815023" load-source="docdb">FR</country><country mxw-id="DS549816888" load-source="docdb">GB</country><country mxw-id="DS549908646" load-source="docdb">GR</country><country mxw-id="DS549816889" load-source="docdb">HR</country><country mxw-id="DS549744917" load-source="docdb">HU</country><country mxw-id="DS549816421" load-source="docdb">IE</country><country mxw-id="DS549908647" load-source="docdb">IS</country><country mxw-id="DS549818930" load-source="docdb">IT</country><country mxw-id="DS549908648" load-source="docdb">LI</country><country mxw-id="DS549818931" load-source="docdb">LT</country><country mxw-id="DS549745174" load-source="docdb">LU</country><country mxw-id="DS549818932" load-source="docdb">LV</country><country mxw-id="DS549818933" load-source="docdb">MC</country><country mxw-id="DS549745175" load-source="docdb">MK</country><country mxw-id="DS549745176" load-source="docdb">MT</country><country mxw-id="DS549745181" load-source="docdb">NL</country><country mxw-id="DS549815024" load-source="docdb">NO</country><country mxw-id="DS549745182" load-source="docdb">PL</country><country mxw-id="DS549816426" load-source="docdb">PT</country><country mxw-id="DS549742853" load-source="docdb">RO</country><country mxw-id="DS549816427" load-source="docdb">RS</country><country mxw-id="DS549745183" load-source="docdb">SE</country><country mxw-id="DS549816911" load-source="docdb">SI</country><country mxw-id="DS549815025" load-source="docdb">SK</country><country mxw-id="DS549815030" load-source="docdb">SM</country><country mxw-id="DS549908649" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128673305" lang="EN" load-source="patent-office"><p id="pa01" num="0001">The method for monitoring a wireless link of a Wi-Fi node of a customer premises equipment device comprises the steps of replicating the packets passing through the transmit/receive buffers of a physical layer (3), and passing the replicated packets to a monitoring unit. All packets are replicated in particular by including an Rx/Tx control of the Wi-Fi software driver of the customer premises equipment device to obtain the exact packet exchange and timing of the Wi-Fi network. The customer premises equipment device comprises a Wi-Fi node including a Wi-Fi software driver (2) and a physical layer (3) with transmit/receive buffers (5, 6), a Wi-Fi monitoring application (10) for replicating the packets passing through the transmit/receive buffers, and a monitoring data path (11) for passing the replicated packets to a monitoring unit.
<img id="iaf01" file="imgaf001.tif" wi="138" he="97" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128737456" lang="EN" source="EPO" load-source="docdb"><p>The method for monitoring a wireless link of a Wi-Fi node of a customer premises equipment device comprises the steps of replicating the packets passing through the transmit/receive buffers of a physical layer (3), and passing the replicated packets to a monitoring unit. All packets are replicated in particular by including an Rx/Tx control of the Wi-Fi software driver of the customer premises equipment device to obtain the exact packet exchange and timing of the Wi-Fi network. The customer premises equipment device comprises a Wi-Fi node including a Wi-Fi software driver (2) and a physical layer (3) with transmit/receive buffers (5, 6), a Wi-Fi monitoring application (10) for replicating the packets passing through the transmit/receive buffers, and a monitoring data path (11) for passing the replicated packets to a monitoring unit.</p></abstract><description mxw-id="PDES63959293" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><b>TECHNICAL FIELD</b></heading><p id="p0001" num="0001">The invention relates to the field of customer-premises equipment devices including a Wi-Fi node coupled to an IP interface, e.g. via a digital subscriber line to a service provider.</p><heading id="h0002"><b>BACKGROUND OF THE INVENTION</b></heading><p id="p0002" num="0002">Residential gateways are widely used to connect devices in the home to the Internet or any other wide area network (WAN). Residential gateways use in particular digital subscriber line (DSL) technology that enables a high data rate transmission over copper lines or optical lines. During the years, several DSL standards have been established differing in data rates and in range, for example ADSL and VDSL, which are referred to in this context as xDSL. Also optical transmission for Internet services is well known, for example fiber-to-the-home (FTTH) and fiber-to-the premises (FTTP). Residential gateways, but also other devices such as routers, switches, telephones and set-top boxes, are understood in this context as customer premises equipment (CPE) devices.</p><p id="p0003" num="0003">Residential gateways including wireless technology have a key role in today's home and professional environments. A mechanism for connecting wireless devices to a local area network (LAN) is called Wi-Fi, which is a brand name of the Wi-Fi Alliance for devices using the IEEE 802.11 family of standards for wireless data transmission. The IEEE 802.11 standards define 2 types of wireless nodes, a<!-- EPO <DP n="2"> --> general wireless device that can connect to other devices called a station (denoted as STA) and special type of a STA that is in control of the network or BSS namely an access point (denoted AP). The IEEE 802.11b and 802.11g standards use the 2,4 GHZ ISM band, wherein the later developed 802.11g standard allows a data rate of up to 54 Mbit/s. A further improvement is the 802.11n standard, which can use both the 2,4 GHZ ISM band and the 5 GHZ U-NII band and which allows a theoretical data rate up of to 600 Mbit/s. A Wi-Fi network, often called a WLAN (wireless local area network) consists of an AP with one or several STA connected to the AP.</p><p id="p0004" num="0004">Due to its flexible and "invisible" nature, a lot of LAN applications are utilizing Wi-Fi rather than the classical wired Ethernet approach. This widespread usage of wireless LAN has exposed however a serious downside of using a shared medium technology: interference. Interference, both Wi-Fi and non-Wi-Fi related, leads to a degraded user experience due to the nature of 802.11. In its most common form, IEEE 802.11 networks apply a medium access method in which collisions are avoided by sensing that the medium is used (denoted as CSMA-CA). The medium access method is also commonly known as "listen before talk", describing the essence of the method. Interference from any nature can hence block the medium and force all nodes to remain silent.</p><p id="p0005" num="0005">Therefore, in certain circumstances, the Wi-Fi connection can suffer from poor performance and even connection loss. Some of these circumstances are obvious and easy to explain to an end user. For example, if the distance between the station and the access point is too large, then signal levels are low and performance will degrade. Other circumstances are "invisible" and not understood by the end user, e.g. a hidden node. A hidden node is<!-- EPO <DP n="3"> --> invisible to some of the nodes of a network (BSS), leading to a practical failure of the CSMA-CA method which can cause packet collision/corruption over air. In many cases, the end user is not able to diagnose the problem source and correct the issue.</p><p id="p0006" num="0006">In-home Wi-Fi network connectivity is correspondingly one of the main Internet service provider support costs and causes for help-desk calls. Today's focus for operators is mainly on Wi-Fi network install, associating a station with an access point. Internet service providers are therefore searching for ways to get a better understanding of the end-user's wireless environment including link quality and performance. Related to Wi-Fi performance, operators can use a remote management protocol such as Broadband Forum (noted BBF) TR-069 protocol, which provides access to Wi-Fi parameters as defined in the Internet Gateway Device data model BBF TR-181. But the information available via TR-069 is very limited and focused on data traffic. In some cases, an end user is faced with an issue preventing Wi-Fi connection at all, correspondingly rendering TR-069 monitoring useless. Hence, when an end-user calls a help-desk, it can be a lengthy and expensive process to describe the home topology and diagnose the issue at hand.</p><p id="p0007" num="0007">The ideal way to analyze Wi-Fi issues, e.g. connection setup, interference, throughput, ..., is by looking into the master node of the wireless LAN, namely the AP. The AP, as defined in IEEE 802.11, controls the network, hence all data and network control must be visible by the AP. The AP today can deliver statistics regarding packet transmission and signal levels, but only if a link between the AP and an STA can be established. The real issue why a link is dropped or why throughput is low,<!-- EPO <DP n="4"> --> remains hidden to the internals of the AP. Full packet inspection is not possible, hence leaving technology or protocol analyzers in the dark when it comes down to pinpointing the real issues in a wireless LAN. Today, at best an AP can deliver statistics but no view on what is actually happening in the network.</p><p id="p0008" num="0008">What a person analyzing a Wi-Fi network is really interested in, is the full packet exchange between the AP and its client STAs, including the 802.11 management and control packets. On Ethernet, this method of packet capture exists and is fairly trivial. Ethernet cards can be put in "promiscuous mode": this mode actually allows direct and transparent access to the send/receive queues of the Ethernet hardware to a 3<sup>rd</sup> party software (e.g. Wireshark) that can then analyze the packet stream. The software does however not visualize the low level Ethernet traffic but only the traffic above the physical layer. For Ethernet, this level of analysis is sufficient as the physical medium itself is stable. Nevertheless even on Ethernet one needs "more information", if the link speed negotiation or duplex detection fails. On wireless networks, the multitude of such issues is enormously larger, hence the need to specifically look at the lower layer protocol exchanges in order to understand why the reported impact on the data link is present.</p><p id="p0009" num="0009"><patcit id="pcit0001" dnum="US8102866B"><text>US 8,102,866</text></patcit> discloses a centralized system for the monitoring of remote multimedia signals which monitors and assesses the quality of services distributed over an IP packet telecommunications network comprising a plurality of customer premises equipment, one of the items of such equipment being connectable to an access gateway, such as a digital subscriber line access multiplexer, via a line susceptible of receiving multimedia content such as data, voice and video over IP;<!-- EPO <DP n="5"> --> the said content being returned directly to the access multiplexer via a return line.</p><heading id="h0003"><b>SUMMARY OF THE INVENTION</b></heading><p id="p0010" num="0010">The method for monitoring a wireless link of a Wi-Fi node of a customer premises equipment device comprises the steps of replicating the Wi-Fi packets passing through the transmit/receive buffers, and passing the replicated packets to a monitoring unit. All packets are replicated in particular by including an Rx/Tx control of the Wi-Fi software driver of the customer premises equipment device to obtain the exact packet exchange of the Wi-Fi node including the packet timing.</p><p id="p0011" num="0011">In a preferred embodiment, each packet of the replicated packet stream is encapsulated within the customer premises equipment device into a single IP-frame, before forwarded to the monitoring unit as an IP stream.</p><p id="p0012" num="0012">The customer premises equipment device comprises a Wi-Fi node including a Wi-Fi software driver and a physical layer with transmit/receive buffers, a Wi-Fi monitoring application for replicating the packets passing through the transmit/receive buffers, and a monitoring data path for passing the replicated packets via an IP stream to a monitoring unit. The customer premises equipment device is in particular a residential gateway, a router, a switch, a set-top box or any other Wi-Fi customer premises equipment device and is designed for a connection to an IP interface such as a digital subscriber line to a service provider delivering broadband services or a local area network (LAN).</p><heading id="h0004"><b>BRIEF DESCRIPTION OF THE DRAWINGS</b></heading><!-- EPO <DP n="6"> --><p id="p0013" num="0013">Preferred embodiments of the invention are explained in more detail below by way of example with reference to schematic drawings, which show:
<dl id="dl0001" compact="compact"><dt>Fig. 1</dt><dd>details of a residential gateway including a Wi-Fi node with a Wi-Fi software driver and a physical layer, and</dd><dt>Fig. 2</dt><dd>the residential gateway if <figref idrefs="f0001">Fig. 1</figref> connected via a wired Ethernet connection to a debugging terminal.</dd></dl></p><heading id="h0005"><b>Detailed Description of Preferred Embodiments</b></heading><p id="p0014" num="0014">In the following description, example methods for monitoring a wireless (Wi-Fi) link of a Wi-Fi node of a customer-premises equipment device are described. For purposes of explanation, various specific details are set forth in order to provide a thorough understanding of preferred embodiments. It will be evident, however, to one skilled in the art that the present invention may be practiced without these specific details.</p><p id="p0015" num="0015">A customer premises equipment (CPE) device includes for example a controller, e.g. a microprocessor, a nonvolatile memory, in which an operating system is stored, a volatile memory for the operation of the CPE device, a Wi-Fi node for a wireless operation and a broadband connection, e.g. an xDSL connection. The Wi-Fi node includes a complex software driver, a physical layer with data buffers and an antenna. A CPE device of this kind is for example a residential gateway, which has a central position within a wireless local area network (WLAN).</p><p id="p0016" num="0016">The Wi-Fi node is controlled by the software driver which executes a lot of background tasks during operation of the Wi-Fi node, e.g. dynamic rate adaptation, packet<!-- EPO <DP n="7"> --> aggregation, channel quality monitoring, to name some. On top of signal manipulations, the Wi-Fi driver also embeds the 802.11 protocol stack with the associated IEEE defined management and control messaging. The Wi-Fi driver will hence inject a lot of management and control packets in the data stream, making it impossible to analyze a link by transparently looking at the data frame exchange only.</p><p id="p0017" num="0017">In order to monitor the physical layer, the layer 0 of the OSI model, the traffic that is transmitted and received by the Wi-Fi node of the residential gateway, the residential gateway includes according to the invention a Wi-Fi monitoring application for delivering all received and transmitted packets to a monitoring unit which then can be accessed from anywhere in the LAN or WAN. The Wi-Fi monitoring application can be understood as a software module within the Wi-Fi driver. The Wi-Fi monitoring application uses the Tx/Rx buffers of the Wi-Fi node to replicate the actual data link in a parallel monitor stream. This stream contains the exact packet exchange and timing within the Wi-Fi network. As the AP embedded in a residential gateway is the center of the Wi-Fi network and generally connected to a WAN and multiple LAN interfaces, the monitor stream can be easily transferred to a remote monitoring unit.</p><p id="p0018" num="0018">The Wi-Fi monitoring application has access to the following blocks:
<ul><li>Transmit packet queue</li><li>Receive packet queue</li><li>Transmit / Receive signal indicator</li></ul></p><p id="p0019" num="0019">The Wi-Fi monitoring application is configured advantageously to encapsulate any Wi-Fi packet into a single IP frame. All packets present on the physical<!-- EPO <DP n="8"> --> layer queues are encapsulated regardless of their individual function or role in the network. The Wi-Fi packet as a whole is considered as a data payload of the IP frame, and the source/destination address of the IP frame is to be configured by the user requesting the Wi-Fi packet stream. The Wi-Fi packets will be placed in the monitor stream in the exact same order in which they are received or to be transmitted, hence duplicating the packets or frames on the Wi-Fi link exactly with the same inter-packet timing. This method allows therefore to transport the Wi-Fi packet stream towards the monitoring unit with a timing corresponding with the time, when the Wi-Fi packets pass through the transmit/receive buffers. Through the usage of Wireshark and a modified "packet dissector", the content and structure of the Wi-Fi packet stream can be analyzed.</p><p id="p0020" num="0020">A preferred embodiment of the invention is depicted in <figref idrefs="f0001">figure 1</figref>, which shows a Wi-Fi software driver 2, a physical layer 3 and an antenna 4 of a residential gateway 1. The physical layer 3 includes data buffers 5, 6 for the receive path and the transmit path, a switch matrix 7 controlled by the Wi-Fi software driver 2 via a Tx/Rx control 9, and a Wi-Fi hardware driver 8. According to the invention, the Wi-Fi software driver 2 includes a Wi-Fi monitoring application 10, which replicates the data traffic passing through the transmit and receive hardware buffers 5, 6 and passes this data stream via a monitor data path 11 to an external monitoring unit, e.g. a debugging terminal. The monitoring data path 11 is coupled for example to an 802.1d bridge 12, which forwards the data packets e.g. to a LAN side network 13, or via an xDSL router 14 to a wide area side network 15.</p><p id="p0021" num="0021">In a preferred embodiment, the residential gateway 1 is connected via a wired Ethernet connection 21 to a<!-- EPO <DP n="9"> --> debugging terminal 20, as shown in <figref idrefs="f0002">figure 2</figref>. The Wi-Fi monitoring application 10 delivers a replicated packet stream of the Wi-Fi packet stream passing through the hardware buffers of the physical layer 3, as described with regard to <figref idrefs="f0001">figure 1</figref>. Each packet of the replicated packet stream is encapsulated within the residential gateway 1 by the Wi-Fi software driver 2 into a single IP-frame 22, which are immediately transmitted via the 802.1d bridge 12 and the router 14 to the debugging terminal 20. Within the debugging terminal 20, the IP frames as provided by the Wi-Fi software driver 2 are captured, and then the IP frames are de-encapsulated, to provide a Wi-Fi packet stream which can be visualized then e.g. by means of Wireshark.</p><p id="p0022" num="0022">The invention allows therefore in-use debugging of wireless applications. An operator can now analyze exactly what is going on at the residential gateway 1 of an end-user without intrusive action on the network or without having to have physical access to the residential gateway 1 of the end-user. Compared to the classical « sniffer » or « capture » approaches, this is a tremendous step forward as this method does not leave room for error or uncertainty of interpretation. With the current methods, a « good view » or « best effort estimation » is all that can be guaranteed as packets are received by the analysis equipment. There is no strict guarantee that the analysis equipment receives exactly the same packet exchange as the AP or another Wi-Fi node in the network.</p><p id="p0023" num="0023">The support network of an network service operator can largely benefit from this because changes made to a remote residential gateway via known remote management systems such as TR-069 or SNMP can be directly verified without user feedback. An operator can reconfigure the<!-- EPO <DP n="10"> --> whole residential gateway 1 even in an automated way, retrieving feedback from the results seen in the monitor stream.</p><p id="p0024" num="0024">Also, developers do no longer have the need to build messy « sniffer » setups or buy expensive RF capturing equipment, because the monitor stream can be captured via the Wi-Fi node under test, e.g. the residential gateway 1, and viewed with known analysis applications. Should security be an issue, encryption can be added in the residential gateway 1 on the monitor stream, but then the monitoring unit needs to apply the corresponding deencryption.</p><p id="p0025" num="0025">The analysis is only 100% accurate when the actual link, as seen through one of the nodes of the wireless LAN, is being analyzed. This is a quite crucial item to consider. A sniffer on an external device will "look" at the RF environment differently than the actual AP/STA nodes of the network that is monitored. To some extent, such an analysis is usable, but if specific features or defects of an AP or STA device are creating an issue, e.g. beam forming resulting in better a RF signal, encryption techniques preventing accurate debugging, or physical layer features that have not been integrated in the sniffer hardware or software, ..., the usage of a sniffer is wasted effort. Analysis must be done "through the eyes and ears" of the network. As the AP is in control of the network, and usually managed by telecom operators that are the prime customers for such an advanced monitoring method, all monitoring methods must be handled by this network node. Debugging or analyzing a wireless LAN through its AP therefore is the key. With the invention, the Wi-Fi link is exactly analyzed at the physical layer level, as it is exactly there where the problems are found.<!-- EPO <DP n="11"> --></p><p id="p0026" num="0026">Also other embodiments of the invention may be utilized by one skilled in the art without departing from the scope of the present invention. The method as described may be used in particular for all kinds of CPE devices using Wi-Fi. The invention resides therefore in the claims herein after appended.</p></description><claims mxw-id="PCLM56982326" lang="EN" load-source="patent-office"><!-- EPO <DP n="12"> --><claim id="c-en-0001" num="0001"><claim-text>Method for monitoring a wireless link of a Wi-Fi node of a customer premises equipment device (1), the Wi-Fi node including a Wi-Fi software driver (2) and a physical layer (3) with transmit/receive buffers (5, 6), <b>comprising the steps of</b><br/>
replicating the packets passing through the transmit/receive buffers (5, 6), and<br/>
passing the replicated packets to a monitoring unit (20).</claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The method of claim 1, comprising the step of replicating the data packets by including the Rx/Tx control (9) of the Wi-Fi software driver (2) to obtain the exact packet exchange of the Wi-Fi node including packet timing.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The method of claim 1 or 2, comprising the step of encapsulating each packet of the replicated packet stream within the customer premises equipment device (1) into a single IP-frame (22), before they are forwarded to the monitoring unit (20).</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>Customer premises equipment device (1), utilizing a method according to one of the preceding claims.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>The customer premises equipment device of claim 4, comprising a Wi-Fi node including a Wi-Fi software driver (2) and a physical layer (3) with transmit/receive buffers (5, 6), a Wi-Fi monitoring application (10) for replicating the packets passing through the transmit/receive buffers (5, 6), and a monitoring data path (11) for passing the replicated packets to a monitoring unit (20).<!-- EPO <DP n="13"> --></claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>The customer premises equipment device of claim 4 or 5, being a residential gateway, router, switch, set-top box or any other Wi-Fi customer premises equipment device.</claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>The customer premises equipment device of claim 4, 5 or 6 , being designed for a connection to a service provider via a digital subscriber line delivering broadband services.</claim-text></claim></claims><drawings mxw-id="PDW16670707" load-source="patent-office"><!-- EPO <DP n="14"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="165" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="15"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="165" he="233" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="157" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="160" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
