<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2681662-A2" country="EP" doc-number="2681662" kind="A2" date="20140108" family-id="46754054" file-reference-id="252638" date-produced="20180822" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146586144" ucid="EP-2681662-A2"><document-id><country>EP</country><doc-number>2681662</doc-number><kind>A2</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12755478-A" is-representative="NO"><document-id mxw-id="PAPP154848336" load-source="docdb" format="epo"><country>EP</country><doc-number>12755478</doc-number><kind>A</kind><date>20120305</date><lang>EN</lang></document-id><document-id mxw-id="PAPP184034287" load-source="docdb" format="original"><country>EP</country><doc-number>12755478.0</doc-number><date>20120305</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140557891" ucid="US-201113041303-A" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201113041303</doc-number><kind>A</kind><date>20110304</date></document-id></priority-claim><priority-claim mxw-id="PPC140557097" ucid="US-2012027760-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>2012027760</doc-number><kind>W</kind><date>20120305</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-2087955648" load-source="docdb">G06F  12/14        20060101AFI20150303BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL2067973274" load-source="docdb" scheme="CPC">G06F  21/10        20130101 FI20140321BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132363065" lang="DE" load-source="patent-office">INHALTSWIEDERGABE-APIS UNTER VERWENDUNG VERSCHLÜSSELTER DATENSTRÖME</invention-title><invention-title mxw-id="PT132363066" lang="EN" load-source="patent-office">CONTENT PLAYBACK APIS USING ENCRYPTED STREAMS</invention-title><invention-title mxw-id="PT132363067" lang="FR" load-source="patent-office">API DE REPRODUCTION DE CONTENU UTILISANT DES FLUX CRYPTÉS</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR919529780" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>NETFLIX INC</last-name><address><country>US</country></address></addressbook></applicant><applicant mxw-id="PPAR919514223" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>NETFLIX, INC.</last-name></addressbook></applicant><applicant mxw-id="PPAR919018271" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Netflix, Inc.</last-name><iid>101123048</iid><address><street>100 Winchester Circle</street><city>Los Gatos, California 95032</city><country>US</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919536620" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ZOLLINGER JAMES MITCH</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919544685" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>ZOLLINGER, JAMES MITCH</last-name></addressbook></inventor><inventor mxw-id="PPAR919012244" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>ZOLLINGER, JAMES MITCH</last-name><address><street>16216 Azalea Way</street><city>Los Gatos, CA 95032-3620</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919511498" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>LAI YUNG-HSIAO</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919513253" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>LAI, YUNG-HSIAO</last-name></addressbook></inventor><inventor mxw-id="PPAR919014453" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>LAI, YUNG-HSIAO</last-name><address><street>47639 Hoyt St.</street><city>Fremont, California 94539</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919505435" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>PARK ANTHONY NEAL</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919512696" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>PARK, ANTHONY NEAL</last-name></addressbook></inventor><inventor mxw-id="PPAR919017931" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>PARK, ANTHONY NEAL</last-name><address><street>1140 Phelps Ave.</street><city>San Jose, California 95117</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919534168" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>RONCA DAVID RANDALL</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919528892" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>RONCA, DAVID RANDALL</last-name></addressbook></inventor><inventor mxw-id="PPAR919019683" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>RONCA, DAVID RANDALL</last-name><address><street>1459 McBain Ave.</street><city>Campbell, California 94008</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919507075" load-source="docdb" sequence="5" format="epo"><addressbook><last-name>KELLY SCOTT GREGORY</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919508818" load-source="docdb" sequence="5" format="intermediate"><addressbook><last-name>KELLY, Scott Gregory</last-name></addressbook></inventor><inventor mxw-id="PPAR919014949" load-source="patent-office" sequence="5" format="original"><addressbook><last-name>KELLY, Scott Gregory</last-name><address><street>2102 Payne Pl.</street><city>Santa Clara, California 95054</city><country>US</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR919019333" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Harris, Ian Richard</last-name><suffix>et al</suffix><iid>100033984</iid><address><street>D Young &amp; Co LLP 120 Holborn</street><city>London EC1N 2DY</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="US-2012027760-W"><document-id><country>US</country><doc-number>2012027760</doc-number><kind>W</kind><date>20120305</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012122117-A2"><document-id><country>WO</country><doc-number>2012122117</doc-number><kind>A2</kind><date>20120913</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS549765103" load-source="docdb">AL</country><country mxw-id="DS549756914" load-source="docdb">AT</country><country mxw-id="DS549913485" load-source="docdb">BE</country><country mxw-id="DS549845716" load-source="docdb">BG</country><country mxw-id="DS549834593" load-source="docdb">CH</country><country mxw-id="DS549913486" load-source="docdb">CY</country><country mxw-id="DS549756915" load-source="docdb">CZ</country><country mxw-id="DS549765104" load-source="docdb">DE</country><country mxw-id="DS549913487" load-source="docdb">DK</country><country mxw-id="DS549913488" load-source="docdb">EE</country><country mxw-id="DS549833841" load-source="docdb">ES</country><country mxw-id="DS549845717" load-source="docdb">FI</country><country mxw-id="DS549834598" load-source="docdb">FR</country><country mxw-id="DS549765117" load-source="docdb">GB</country><country mxw-id="DS549913489" load-source="docdb">GR</country><country mxw-id="DS549765118" load-source="docdb">HR</country><country mxw-id="DS549756916" load-source="docdb">HU</country><country mxw-id="DS549834599" load-source="docdb">IE</country><country mxw-id="DS549913490" load-source="docdb">IS</country><country mxw-id="DS549845726" load-source="docdb">IT</country><country mxw-id="DS549913491" load-source="docdb">LI</country><country mxw-id="DS549845727" load-source="docdb">LT</country><country mxw-id="DS549757550" load-source="docdb">LU</country><country mxw-id="DS549845728" load-source="docdb">LV</country><country mxw-id="DS549845729" load-source="docdb">MC</country><country mxw-id="DS549757551" load-source="docdb">MK</country><country mxw-id="DS549757552" load-source="docdb">MT</country><country mxw-id="DS549845734" load-source="docdb">NL</country><country mxw-id="DS549834600" load-source="docdb">NO</country><country mxw-id="DS549845735" load-source="docdb">PL</country><country mxw-id="DS549833846" load-source="docdb">PT</country><country mxw-id="DS549765119" load-source="docdb">RO</country><country mxw-id="DS549833847" load-source="docdb">RS</country><country mxw-id="DS549845736" load-source="docdb">SE</country><country mxw-id="DS549833494" load-source="docdb">SI</country><country mxw-id="DS549834601" load-source="docdb">SK</country><country mxw-id="DS549834610" load-source="docdb">SM</country><country mxw-id="DS549913492" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA100065860" ref-ucid="WO-2012122117-A2" lang="EN" load-source="patent-office"><p num="0000">One embodiment of the present invention sets forth a technique for decrypting digital content in a secure environment. The technique includes the steps of receiving a digital rights management (DRM) license associated with a first frame of encrypted data from a DRM server, where the DRM license includes a decryption key for decrypting the first frame of encrypted data, transmitting the DRM license to a secure content playback pipeline for storage, and transmitting the first frame of encrypted data to the secure content playback pipeline for decryption, where, in response to receiving the first frame of encrypted data, a trusted processing entity within the secure content playback pipeline decrypts the first frame of encrypted data based on the decryption key included in the DRM license to generate a first set of decrypted data and store the first set of decrypted data in a secure memory space.</p></abstract><abstract mxw-id="PA100334968" ref-ucid="WO-2012122117-A2" lang="EN" source="national office" load-source="docdb"><p>One embodiment of the present invention sets forth a technique for decrypting digital content in a secure environment. The technique includes the steps of receiving a digital rights management (DRM) license associated with a first frame of encrypted data from a DRM server, where the DRM license includes a decryption key for decrypting the first frame of encrypted data, transmitting the DRM license to a secure content playback pipeline for storage, and transmitting the first frame of encrypted data to the secure content playback pipeline for decryption, where, in response to receiving the first frame of encrypted data, a trusted processing entity within the secure content playback pipeline decrypts the first frame of encrypted data based on the decryption key included in the DRM license to generate a first set of decrypted data and store the first set of decrypted data in a secure memory space.</p></abstract><abstract mxw-id="PA100065861" ref-ucid="WO-2012122117-A2" lang="FR" load-source="patent-office"><p num="0000">La présente invention concerne, dans un de ses modes de réalisation, une technique de décryptage de contenu numérique dans un environnement sécurisé. La technique comprend les étapes consistant à : recevoir d'un serveur de DRM une licence de gestion des droits numériques (DRM) associée à une première trame de données cryptées, la licence DRM comprenant une clé de décryptage destinée à décrypter la première trame de données cryptées; envoyer la licence DRM à un pipeline sécurisé de reproduction de contenu en vue de son stockage; et envoyer la première trame de données cryptées au pipeline sécurisé de reproduction de contenu en vue de son décryptage, caractérisée en ce qu'en réaction à la réception de la première trame de données cryptées, une entité de traitement de confiance au sein du pipeline sécurisé de reproduction de contenu décrypte la première trame de données cryptées sur la base de la clé de décryptage comprise dans la licence DRM pour générer un premier ensemble de données décryptées et stocker le premier ensemble de données décryptées dans un espace mémoire sécurisé.</p></abstract><abstract mxw-id="PA100334969" ref-ucid="WO-2012122117-A2" lang="FR" source="national office" load-source="docdb"><p>La présente invention concerne, dans un de ses modes de réalisation, une technique de décryptage de contenu numérique dans un environnement sécurisé. La technique comprend les étapes consistant à : recevoir d'un serveur de DRM une licence de gestion des droits numériques (DRM) associée à une première trame de données cryptées, la licence DRM comprenant une clé de décryptage destinée à décrypter la première trame de données cryptées; envoyer la licence DRM à un pipeline sécurisé de reproduction de contenu en vue de son stockage; et envoyer la première trame de données cryptées au pipeline sécurisé de reproduction de contenu en vue de son décryptage, caractérisée en ce qu'en réaction à la réception de la première trame de données cryptées, une entité de traitement de confiance au sein du pipeline sécurisé de reproduction de contenu décrypte la première trame de données cryptées sur la base de la clé de décryptage comprise dans la licence DRM pour générer un premier ensemble de données décryptées et stocker le premier ensemble de données décryptées dans un espace mémoire sécurisé.</p></abstract><description mxw-id="PDES51372586" ref-ucid="WO-2012122117-A2" lang="EN" load-source="patent-office"><!-- EPO <DP n="3"/>--><p id="p0001" num="0001"> CONTENT PLAYBACK APIS USING ENCRYPTED STREAMS </p><p id="p0002" num="0002">CROSS-REFERENCE TO RELATED APPLICATIONS </p><p id="p0003" num="0003"> [0001] This application claims benefit of United States provisional patent application serial number 13/041 ,303, filed March 4, 201 1 , which is herein </p><p id="p0004" num="0004">incorporated by reference. </p><p id="p0005" num="0005">BACKGROUND OF THE INVENTION </p><p id="p0006" num="0006">Field of the Invention </p><p id="p0007" num="0007"> [0002] Embodiments of the present invention relate generally to digital media and, more specifically, to content playback APIs using encrypted streams. </p><p id="p0008" num="0008">Description of the Related Art </p><p id="p0009" num="0009"> [0003] Digital content distribution systems conventionally include a content server, a content player, and a communications network connecting the content server to the content player. The content server is configured to store digital content files, which can be downloaded from the content server to the content player. Each digital content file corresponds to a specific identifying title, such as "Gone with the Wind," which is familiar to a user. The digital content file typically includes sequential content data, organized according to playback chronology, and may comprise audio data, video data, or a combination thereof. [0004] The content player is configured to download and play a digital content file, in response to a user request selecting the title for playback. The process of playing the digital content file includes decoding and rendering audio and video data into an audio signal and a video signal, which may drive a display system having a speaker subsystem and a video subsystem. Playback typically involves a technique known in the art as "streaming," whereby the content server sequentially transmits the digital content file to the content player, and the content player plays the digital content file while content data is received that comprises the digital content file. </p><p id="p0010" num="0010">[0005] Content data is typically encrypted and needs to be decrypted before the data can be played. The playback process, therefore, includes four steps, (i) retrieve 
<!-- EPO <DP n="4"/>-->
 content, (ii) decrypt content, (iii) decode content and (iv) output content. For the purposes of content protection, the content is most vulnerable and step (ii). At this step, the decrypted (and, therefore, unprotected) but still compressed content data is available. Since it is not always desirable or possible to prevent execution of un- trusted code, the decrypted content at step (ii) is vulnerable to attacks from third-party applications. </p><p id="p0011" num="0011">[0006] As the foregoing illustrates, what is needed in the art is an approach for decrypting digital data in a secure environment. </p><p id="p0012" num="0012">SUMMARY OF THE INVENTION </p><p id="p0013" num="0013">[0007] One embodiment of the present invention sets forth a method for decrypting digital data within a secure execution environment. The method comprises the steps of receiving a digital rights management (DRM) license associated with a first frame of encrypted data from a DRM server, where the DRM license includes a decryption key for decrypting the first frame of encrypted data, transmitting the DRM license to a secure content playback pipeline for storage, and transmitting the first frame of encrypted data to the secure content playback pipeline for decryption, where, in response to receiving the first frame of encrypted data, a trusted processing entity within the secure content playback pipeline decrypts the first frame of encrypted data based on the decryption key included in the DRM license to generate a first set of decrypted data and store the first set of decrypted data in a secure memory space. </p><p id="p0014" num="0014">[0008] One advantage of the disclosed technique is that the encrypted digital content is decrypted in a secure environment of the trusted execution environment and, therefore, is less vulnerable to attacks from a malicious third-party application executing on the CPU. BRIEF DESCRIPTION OF THE DRAWINGS </p><p id="p0015" num="0015"> [0009] So that the manner in which the above recited features of the present invention can be understood in detail, a more particular description of the invention, briefly summarized above, may be had by reference to embodiments, some of which are illustrated in the appended drawings. It is to be noted, however, that the 
<!-- EPO <DP n="5"/>-->
 appended drawings illustrate only typical embodiments of this invention and are therefore not to be considered limiting of its scope, for the invention may admit to other equally effective embodiments. </p><p id="p0016" num="0016">[0010] Figure 1 illustrates a content distribution system configured to implement one or more aspects of the present invention; </p><p id="p0017" num="0017">[0011] Figure 2 is a more detailed view of the endpoint device of Figure 1 , according to one embodiment of the invention; and </p><p id="p0018" num="0018">[0012] Figure 3 is a flow diagram of method steps for decrypting and rendering encrypted audio/video content, according to one embodiment of the invention. DETAILED DESCRIPTION </p><p id="p0019" num="0019"> [0013] In the following description, numerous specific details are set forth to provide a more thorough understanding of the present invention. However, it will be apparent to one of skill in the art that the present invention may be practiced without one or more of these specific details. In other instances, well-known features have not been described in order to avoid obscuring the present invention. </p><p id="p0020" num="0020">[0014] Figure 1 illustrates a content distribution system 100 configured to implement one or more aspects of the invention. As shown, the content distribution system 100 includes a content distribution network (CDN) 102, a communications network 104, a digital rights management (DRM) server 106 and an endpoint device 108. </p><p id="p0021" num="0021">[0015] The communications network 104 includes a plurality of network </p><p id="p0022" num="0022">communications systems, such as routers and switches, configured to facilitate data communication between the CDN 102, the DRM server and the endpoint device 108. Persons skilled in the art will recognize that many technically feasible techniques exist for building the communications network 104, including technologies practiced in deploying the well-known internet communications network. </p><p id="p0023" num="0023">[0016] The endpoint device 108 may comprise a computer system, a set top box, a mobile device such as a mobile phone, or any other technically feasible computing 
<!-- EPO <DP n="6"/>-->
 platform that has network connectivity and is coupled to or includes a display device and speaker device for presenting video frames, and generating acoustic output, respectively. </p><p id="p0024" num="0024">[0017] The CDN 102 comprises one or more computer systems configured to serve download requests for digital content files received from the endpoint device 108. The digital content files may reside on a mass storage system accessible to the computer system. The mass storage system may include, without limitation, direct attached storage, network attached file storage, or network attached block-level storage. The digital content files may be formatted and stored on the mass storage system using any technically feasible technique. A data transfer protocol, such as the well-known hyper-text transfer protocol (HTTP), may be used to download digital content files from the CDN 102 to the endpoint device 108. </p><p id="p0025" num="0025">[0018] The DRM server 106 serves requests for licenses associated with encrypted digital content files received from the endpoint device 108. In operation, an encrypted digital content file downloaded from the CDN 102 by the endpoint device 108 must be decrypted before the digital content file can be played. The license associated with the encrypted digital content file is stored in the DRM server 106 and is transmitted to the endpoint device 108, which in turn uses the license to decrypt the digital content file. Figures 2 and 3 describe in detail a technique for securely decrypting encrypted digital content files. </p><p id="p0026" num="0026">[0019] Although, in the above description, the content distribution system 100 is shown with one endpoint device 108 and one CDN 102, persons skilled in the art will recognize that the architecture of Figure 1 contemplates only an exemplary embodiment of the invention. Other embodiments may include any number of endpoint devices 108 and/or CDNs 102. Thus, Figure 1 is in no way intended to limit the scope of the present invention in any way. </p><p id="p0027" num="0027">[0020] Figure 2 is a more detailed view of the endpoint device 108 of Figure 1 , according to one embodiment of the invention. As shown, the endpoint device 108 includes, without limitation, a central processing unit (CPU) 210, a graphics subsystem 212, an input/output (I/O) device interface 214, a network interface 218, a 
<!-- EPO <DP n="7"/>-->
 secure memory space 220, an interconnect 222, a memory subsystem 230, a trusted execution environment (TEE) 242 and an audio/video decoder 244. The endpoint device 108 may also include a mass storage unit 216. </p><p id="p0028" num="0028">[0021] The CPU 210 is configured to retrieve and execute programming </p><p id="p0029" num="0029">instructions stored in the memory subsystem 230. Similarly, the CPU 210 is configured to store and retrieve application data residing in the memory subsystem 230. The interconnect 222 is configured to facilitate transmission of data, such as programming instructions and application data, between the CPU 210, graphics subsystem 212, I/O devices interface 214, mass storage 216, network interface 218, secure memory space 220 and memory subsystem 230. </p><p id="p0030" num="0030">[0022] The graphics subsystem 212 is configured to generate frames of video data and transmit the frames of video data to display device 250. In one embodiment, the graphics subsystem 212 may be integrated into an integrated circuit, along with the CPU 210. The display device 250 may comprise any technically feasible means for generating an image for display. For example, the display device 250 may be fabricated using liquid crystal display (LCD) technology, cathode-ray technology, and light-emitting diode (LED) display technology (either organic or inorganic). An input/output (I/O) device interface 214 is configured to receive input data from user I/O devices 252 and transmit the input data to the CPU 210 via the interconnect 222. For example, user I/O devices 252 may comprise one of more buttons, a keyboard, and a mouse or other pointing device. The I/O device interface 214 also includes an audio output unit configured to generate an electrical audio output signal. User I/O devices 252 includes a speaker configured to generate an acoustic output in response to the electrical audio output signal. In alternative embodiments, the display device 250 may include the speaker. A television is an example of a device known in the art that can display video frames and generate an acoustic output. A mass storage unit 216, such as a hard disk drive or flash memory storage drive, is configured to store non-volatile data. A network interface 218 is configured to transmit and receive packets of data via the communications network 120. In one embodiment, the network interface 218 is configured to communicate using the well- known Ethernet standard. The network interface 218 is coupled to the CPU 210 via 
<!-- EPO <DP n="8"/>-->
 the interconnect 222. </p><p id="p0031" num="0031">[0023] The memory subsystem 230 includes programming instructions and data that comprise an operating system 232, a user interface 234, a playback application 236, a digital rights management (DRM) agent 238 and a playback application programming interface (API) 240. The operating system 232 performs system management functions such as managing hardware devices including the network interface 218, mass storage unit 216, I/O device interface 214, and graphics subsystem 212. The operating system 232 also provides process and memory management models for the user interface 234 and the playback application 236. The user interface 234 provides a specific structure, such as a window and object metaphor, for user interaction with endpoint device 108. Persons skilled in the art will recognize the various operating systems and user interfaces that are well-known in the art and suitable for incorporation into the endpoint device 108. </p><p id="p0032" num="0032">[0024] The playback application 236 is configured to retrieve encrypted digital content from the CDN 102 via the network interface 218. In addition, the playback application 236 is configured to interact with the DRM agent 238 via the playback API 240 so that the retrieved digital content is decrypted and rendered. In operation, the playback application 236 first retrieves the header information associated with a digital content file to be played from the CDN 102. The playback application 236 then transmits a request for a DRM challenge that includes the header information to the DRM agent 238 via the playback API 240. In response to the request, the DRM agent 238 generates a DRM challenge that is encrypted by an encryption/decryption module executing in the TEE 242. The DRM agent 238 then transmits the DRM challenge to the playback application 236. [0025] Once the playback application 236 receives the DRM challenge, a request for a DRM license that includes the DRM challenge is transmitted to the DRM server 106. As previously described herein, the DRM server 106, upon receiving the DRM challenge, transmits a DRM license associated with the digital content file to be played to the playback application 236. The DRM license includes the decryption key needed to decrypt the encrypted digital content file. Upon receipt, the playback 
<!-- EPO <DP n="9"/>-->
 application 236 transmits the DRM license to the DRM agent 238 via the playback API 240 for storage in the TEE 242. In another embodiment, the TEE 242 only stores the decryption key included in the DRM license. In addition, the playback application 236 transmits a request for a decryption context generated based on the DRM license to the DRM agent 238 via the playback API 240. Any subsequent decryption and rendering operations are performed using the decryption context generated by the DRM agent 238. </p><p id="p0033" num="0033">[0026] Again, the playback application 236 is configured to retrieve encrypted digital content from the CDN 102 via the network interface 218. Once the encrypted digital content is retrieved from the CDN 102 and the decryption context is received from the DRM agent 238, the playback application 236 transmits the encrypted digital content along with the decryption context to the DRM agent 238 for decryption and rendering. The DRM agent 238, in turn, transmits the encrypted digital content and the decryption context to the TEE 242. The TEE 242 decrypts the encrypted digital content using decryption algorithms within the TEE 242. Importantly, the TEE 242 is a secure processing environment, and a third-party application executing outside the TEE 242 cannot access the decrypted digital content. The decrypted digital content is then stored in the secure memory space 220. In an alternate embodiment, the decrypted digital content is stored in a memory space that is not secure, i.e., a standard random access memory (RAM). In such an embodiment, the same decryption and rendering processes described herein still apply. In addition, a pointer to the storage location that stores the decrypted digital content is transmitted to the DRM agent 238. </p><p id="p0034" num="0034">[0027] The DRM agent 238, in response to receiving the pointer to the storage location that stores the decrypted digital content, transmits a request to the </p><p id="p0035" num="0035">audio/video decoder 244 to render the decrypted digital content. In an alternate embodiment, the TEE 242 transmits the pointer to the storage location that stores the decrypted digital content directly to the audio/video decoder 244 to render the decrypted digital content. [0028] In the case of video data, the audio/video decoder 244 reads units of video 
<!-- EPO <DP n="10"/>-->
 data from the secure memory space 220, and renders the units of video data into a sequence of video frames corresponding in duration to the fixed span of playback time. The sequence of video frames is processed by graphics subsystem 212 and transmitted to the display device 250. In the case of audio data, the audio/video decoder 244 reads units of audio data from the secure memory space 220, and renders the units of audio data into a sequence of audio samples, generally </p><p id="p0036" num="0036">synchronized in time with the sequence of video frames. In one embodiment, the sequence of audio samples is transmitted to the I/O device interface 214, which converts the sequence of audio samples into the electrical audio signal. The electrical audio signal is transmitted to the speaker within the user I/O devices 252, which, in response, generates an acoustic output. </p><p id="p0037" num="0037">[0029] It should be noted that any combination of encrypted/unencrypted audio/video data can be processed by the system described herein. In some cases, both audio and video data are encrypted, while in other cases only one of the audio or video data is encrypted. </p><p id="p0038" num="0038">[0030] In such a manner, the encrypted digital content is decrypted in a secure environment of the TEE 242 and, therefore, is less vulnerable to attacks from a malicious third-party application executing on the CPU 210. </p><p id="p0039" num="0039">[0031] Figure 3 is a flow diagram of method steps for decrypting and rendering encrypted audio/video content, according to one embodiment of the invention. </p><p id="p0040" num="0040"> Although the method steps are described in conjunction with the systems for Figures 1 -2, persons skilled in the art will understand that any system configured to perform the method steps, in any order, is within the scope of the invention. </p><p id="p0041" num="0041">[0032] The method 300 begins at step 302, where the playback application 236 retrieves header information associated with a digital content file (audio/video data) to be played from the CDN 102. The playback application 236 then transmits a request for a DRM challenge that includes the header information to the DRM agent 238 via the playback API 240. At step 304, the DRM agent 238 generates a DRM challenge based on the header information that is then encrypted by an encryption/decryption module executing in the TEE 242. The DRM agent 238 then transmits the DRM 
<!-- EPO <DP n="11"/>-->
 challenge to the playback application 236. </p><p id="p0042" num="0042">[0033] At step 306, the playback application 236 transmits a request for a DRM license that includes the DRM challenge to the DRM server 106. As previously described herein, the DRM server 106, upon receiving the DRM challenge, transmits a DRM license associated with the digital content file to be played to the playback application 236. The DRM license includes the decryption key needed to decrypt the encrypted digital content file. At step 308, the playback application 236 transmits the DRM license to the DRM agent 238 via the playback API 240 for storage in the TEE 242. [0034] At step 310, the playback application 236 retrieves the encrypted digital content from the CDN 102 via the network interface 218. At step 312, the playback application 236 transmits the encrypted digital content to the DRM agent 238 for decryption and rendering. The DRM agent 238, in turn, transmits the encrypted digital content to the TEE 242, and the TEE 242 decrypts the encrypted digital content. The decrypted digital content is then stored in the secure memory space 220. In addition, a pointer to the storage location that stores the decrypted digital content is transmitted to the DRM agent 238. </p><p id="p0043" num="0043">[0035] At step 314, the DRM agent 238, in response to receiving the pointer to the storage location that stores the decrypted digital content, transmits a request to the audio/video decoder 244 to render the decrypted digital content. </p><p id="p0044" num="0044">[0036] One advantage of the disclosed technique is that the encrypted digital content is decrypted in a secure environment of the TEE 242 and, therefore, is less vulnerable to attacks from a malicious third-party application executing on the CPU 210. [0037] One embodiment of the invention may be implemented as a program product stored on computer-readable storage media within the endpoint device 108. In this embodiment, the endpoint device 108 comprising an embedded computer platform such as a set top box. An alternative embodiment of the invention may be implemented as a program product that is downloaded to a memory within a 
<!-- EPO <DP n="12"/>-->
 computer system, for example as executable instructions embedded within an internet web site. In this embodiment, the endpoint device 108 comprises the computer system. </p><p id="p0045" num="0045">[0038] While the forgoing is directed to embodiments of the present invention, other and further embodiments of the invention may be devised without departing from the basic scope thereof. For example, aspects of the present invention may be implemented in hardware or software or in a combination of hardware and software. One embodiment of the invention may be implemented as a program product for use with a computer system. The program(s) of the program product define functions of the embodiments (including the methods described herein) and can be contained on a variety of computer-readable storage media. Illustrative computer-readable storage media include, but are not limited to: (i) non-writable storage media (e.g., read-only memory devices within a computer such as CD-ROM disks readable by a CD-ROM drive, flash memory, ROM chips or any type of solid-state non-volatile semiconductor memory) on which information is permanently stored; and (ii) writable storage media (e.g., floppy disks within a diskette drive or hard-disk drive or any type of solid-state random-access semiconductor memory) on which alterable information is stored. Such computer-readable storage media, when carrying computer-readable </p><p id="p0046" num="0046">instructions that direct the functions of the present invention, are embodiments of the present invention. </p><p id="p0047" num="0047">[0039] In view of the foregoing, the scope of the present invention is determined by the claims that follow. 
</p></description><claims mxw-id="PCLM44997154" ref-ucid="WO-2012122117-A2" lang="EN" load-source="patent-office"><claim id="clm-0001" num="0001"><!-- EPO <DP n="13"/>--><claim-text/><claim-text>We Claim: </claim-text><claim-text>1 . A computer-implemented method for decrypting digital data within a secure execution environment, the method comprising: </claim-text><claim-text> receiving a digital rights management (DRM) license associated with a first frame of encrypted data from a DRM server, wherein the DRM license includes a decryption key for decrypting the first frame of encrypted data; </claim-text><claim-text> transmitting the DRM license to a secure content playback pipeline for storage; and </claim-text><claim-text> transmitting the first frame of encrypted data to the secure content playback pipeline for decryption, wherein, in response to receiving the first frame of encrypted data, a trusted processing entity within the secure content playback pipeline decrypts the first frame of encrypted data based on the decryption key included in the DRM license to generate a first set of decrypted data and store the first set of decrypted data in a secure memory space. </claim-text><claim-text>2. The method of claim 1 , further comprising transmitting a request to the DRM server that includes an encrypted DRM challenge associated with the first frame of encrypted data that is generated by the secure content playback pipeline, and receiving the DRM license from the DRM server in response to the request. </claim-text><claim-text>3. The method of claim 1 , wherein the first frame of encrypted data comprises encrypted video data encoded for a particular playback rate. </claim-text><claim-text>4. The method of claim 3, decoding the first set of decrypted data stored in the secure memory to generate decoded video data, and transmitting the decoded data to an output device for playback. </claim-text><claim-text>5. The method of claim 1 , wherein the first set of decrypted data cannot be accessed by a third-party application executing outside the trusted processing entity. 
<!-- EPO <DP n="14"/>-->
</claim-text><claim-text>6. The method of claim 1 , further comprising transmitting a request to a content distribution server for the first frame of encrypted data, and receiving the first frame of encrypted data from the content distribution server. 7. The method of claim 1 , wherein the secure content playback pipeline includes a DRM agent that generates a decryption context in response to receiving the DRM license. </claim-text><claim-text>8. The method of claim 7, wherein the step transmitting the first frame of encrypted data comprises transmitting the decryption context with the first frame of encrypted data to the secure content playback pipeline. </claim-text><claim-text>9. The method of claim 7, further comprising: </claim-text><claim-text> receiving a second frame of encrypted data from the content distribution </claim-text><claim-text> server; and </claim-text><claim-text> transmitting the decryption context and the second frame of encrypted data to the secure content playback pipeline for decryption, wherein, in response to receiving the second frame of encrypted data and the decryption context, the trusted processing entity decrypts the second frame of encrypted data based on the decryption key included in the</claim-text><claim-text>DRM license to generate a second set of decrypted data and store the second set of decrypted data in the secure memory space. </claim-text><claim-text>10. A computer readable storage medium storing instructions that, when executed by a processor, cause the processor to decrypt digital data within a secure execution environment, by performing the steps of: </claim-text><claim-text> receiving a digital rights management (DRM) license associated with a first frame of encrypted data from a DRM server, wherein the DRM license includes a decryption key for decrypting the first frame of encrypted data; </claim-text><claim-text> transmitting the DRM license to a secure content playback pipeline for storage; and </claim-text><claim-text> transmitting the first frame of encrypted data to the secure content playback pipeline for decryption, wherein, in response to receiving the first frame 
<!-- EPO <DP n="15"/>-->
 of encrypted data, a trusted processing entity within the secure content playback pipeline decrypts the first frame of encrypted data based on the decryption key included in the DRM license to generate a first set of decrypted data and store the first set of decrypted data in a secure memory space. </claim-text><claim-text>1 1 . The computer readable storage medium of claim 10, further comprising transmitting a request to the DRM server that includes an encrypted DRM challenge associated with the first frame of encrypted data that is generated by the secure content playback pipeline, and receiving the DRM license from the DRM server in response to the request. </claim-text><claim-text>12. The computer readable storage medium of claim 10, wherein the first frame of encrypted data comprises encrypted video data encoded for a particular playback rate. </claim-text><claim-text>13. The computer readable storage medium of claim 12, decoding the first set of decrypted data stored in the secure memory to generate decoded video data, and transmitting the decoded data to an output device for playback. </claim-text><claim-text>14. The computer readable storage medium of claim 10, wherein the first set of decrypted data cannot be accessed by a third-party application executing outside the trusted processing entity. 15. The computer readable storage medium of claim 10, further comprising transmitting a request to a content distribution server for the first frame of encrypted data, and receiving the first frame of encrypted data from the content distribution server. 16. The computer readable storage medium of claim 10, wherein the secure content playback pipeline includes a DRM agent that generates a decryption context in response to receiving the DRM license. 
<!-- EPO <DP n="16"/>-->
</claim-text><claim-text>17. The computer readable storage medium of claim 16, wherein the step transmitting the first frame of encrypted data comprises transmitting the decryption context with the first frame of encrypted data to the secure content playback pipeline. </claim-text><claim-text>The computer readable storage medium of claim 16, further comprising: </claim-text><claim-text> receiving a second frame of encrypted data from the content distribution </claim-text><claim-text> server; and </claim-text><claim-text> transmitting the decryption context and the second frame of encrypted data to the secure content playback pipeline for decryption, wherein, in response to receiving the second frame of encrypted data and the decryption context, the trusted processing entity decrypts the second frame of encrypted data based on the decryption key included in the DRM license to generate a second set of decrypted data and store the second set of decrypted data in the secure memory space. </claim-text><claim-text>A computer system, comprising: </claim-text><claim-text> a secure content playback pipeline comprising a digital rights management</claim-text><claim-text>(DRM) agent and a trusted processing entity; and </claim-text><claim-text> a processor executing a playback application configured to: </claim-text><claim-text> receive a digital rights management (DRM) license associated with a first frame of encrypted data from a DRM server, wherein the DRM license includes a decryption key for decrypting the first frame of encrypted data, </claim-text><claim-text> transmit the DRM license to the secure content playback pipeline for storage, and </claim-text><claim-text> transmit the first frame of encrypted data to the secure content playback pipeline for decryption, wherein, in response to receiving the first frame of encrypted data, the trusted processing entity within the secure content playback pipeline decrypts the first frame of encrypted data based on the decryption key included in the DRM license to generate a first set of decrypted data and store the first set of decrypted data in a secure memory space. 
<!-- EPO <DP n="17"/>-->
</claim-text><claim-text>20. The computer system of claim 19, wherein the first set of decrypted data cannot be accessed by a third-party application executing outside the trusted processing entity. 
</claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
