<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2681689-A2" country="EP" doc-number="2681689" kind="A2" date="20140108" family-id="46754046" file-reference-id="311174" date-produced="20180822" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146586117" ucid="EP-2681689-A2"><document-id><country>EP</country><doc-number>2681689</doc-number><kind>A2</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12752104-A" is-representative="NO"><document-id mxw-id="PAPP154848309" load-source="docdb" format="epo"><country>EP</country><doc-number>12752104</doc-number><kind>A</kind><date>20120301</date><lang>EN</lang></document-id><document-id mxw-id="PAPP175260724" load-source="docdb" format="original"><country>EP</country><doc-number>12752104.5</doc-number><date>20120301</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140555922" ucid="US-201113037962-A" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201113037962</doc-number><kind>A</kind><date>20110301</date></document-id></priority-claim><priority-claim mxw-id="PPC140550897" ucid="US-2012027302-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>2012027302</doc-number><kind>W</kind><date>20120301</date></document-id></priority-claim></priority-claims><technical-data><classification-ipc><edition>7</edition><main-classification>G06F  21/22</main-classification></classification-ipc><classifications-ipcr><classification-ipcr mxw-id="PCL2093540596" load-source="docdb">G06F  21/57        20130101AFI20140701BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-2050381867" load-source="docdb" scheme="CPC">G06F  21/575       20130101 FI20150523BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132362984" lang="DE" load-source="patent-office">SCHUTZ VON BETRIEBSSYSTEM-KONFIGURATIONSWERTEN</invention-title><invention-title mxw-id="PT132362985" lang="EN" load-source="patent-office">PROTECTING OPERATING SYSTEM CONFIGURATION VALUES</invention-title><invention-title mxw-id="PT132362986" lang="FR" load-source="patent-office">PROTECTION DES VALEURS DE CONFIGURATION D'UN SYSTÈME D'EXPLOITATION</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR919535194" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>MICROSOFT CORP</last-name><address><country>US</country></address></addressbook></applicant><applicant mxw-id="PPAR919528276" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>MICROSOFT CORPORATION</last-name></addressbook></applicant><applicant mxw-id="PPAR919010571" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Microsoft Corporation</last-name><iid>101214593</iid><address><street>One Microsoft Way</street><city>Redmond, Washington 98052-6399</city><country>US</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919528212" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ANDERSON SCOTT D</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919506533" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>ANDERSON, SCOTT, D.</last-name></addressbook></inventor><inventor mxw-id="PPAR919008807" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>ANDERSON, SCOTT, D.</last-name><address><street>c/o Microsoft Corporation LCA - International Patents One Microsoft Way</street><city>Redmond, WA 98052-6399</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919532612" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>LINSLEY DAVID J</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919517379" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>LINSLEY, David, J.</last-name></addressbook></inventor><inventor mxw-id="PPAR919019715" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>LINSLEY, David, J.</last-name><address><street>c/o Microsoft Corporation LCA - International Patents One Microsoft Way</street><city>Redmond, WA 98052-6399</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919533366" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>NYSTROM MAGNUS BO GUSTAF</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919544025" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>NYSTROM, Magnus, Bo Gustaf</last-name></addressbook></inventor><inventor mxw-id="PPAR919018165" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>NYSTROM, Magnus, Bo Gustaf</last-name><address><street>c/o Microsoft Corporation LCA - International Patents One Microsoft Way</street><city>Redmond, WA 98052-6399</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919511728" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>MACIVER DOUGLAS M</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919520807" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>MACIVER, Douglas, M.</last-name></addressbook></inventor><inventor mxw-id="PPAR919013521" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>MACIVER, Douglas, M.</last-name><address><street>C/o Microsoft Corporation LCA - International Patents One Microsoft Way</street><city>Remond, WA 98052-6399</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919542286" load-source="docdb" sequence="5" format="epo"><addressbook><last-name>SPIGER ROBERT KARL</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919533645" load-source="docdb" sequence="5" format="intermediate"><addressbook><last-name>SPIGER, Robert, Karl</last-name></addressbook></inventor><inventor mxw-id="PPAR919014483" load-source="patent-office" sequence="5" format="original"><addressbook><last-name>SPIGER, Robert, Karl</last-name><address><street>C/o Microsoft Corporation LCA - International Patents One Microsoft Way</street><city>Remond, WA 98052-6399</city><country>US</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR919011441" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Goddar, Heinz J.</last-name><iid>100002032</iid><address><street>Boehmert &amp; Boehmert Pettenkoferstrasse 20-22</street><city>80336 München</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="US-2012027302-W"><document-id><country>US</country><doc-number>2012027302</doc-number><kind>W</kind><date>20120301</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012118984-A2"><document-id><country>WO</country><doc-number>2012118984</doc-number><kind>A2</kind><date>20120907</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS549833372" load-source="docdb">AL</country><country mxw-id="DS549845021" load-source="docdb">AT</country><country mxw-id="DS549833373" load-source="docdb">BE</country><country mxw-id="DS549757174" load-source="docdb">BG</country><country mxw-id="DS549764495" load-source="docdb">CH</country><country mxw-id="DS549833144" load-source="docdb">CY</country><country mxw-id="DS549845054" load-source="docdb">CZ</country><country mxw-id="DS549756524" load-source="docdb">DE</country><country mxw-id="DS549833145" load-source="docdb">DK</country><country mxw-id="DS549833150" load-source="docdb">EE</country><country mxw-id="DS549913360" load-source="docdb">ES</country><country mxw-id="DS549757175" load-source="docdb">FI</country><country mxw-id="DS549757176" load-source="docdb">FR</country><country mxw-id="DS549833378" load-source="docdb">GB</country><country mxw-id="DS549833151" load-source="docdb">GR</country><country mxw-id="DS549833379" load-source="docdb">HR</country><country mxw-id="DS549845055" load-source="docdb">HU</country><country mxw-id="DS549764496" load-source="docdb">IE</country><country mxw-id="DS549833380" load-source="docdb">IS</country><country mxw-id="DS549757181" load-source="docdb">IT</country><country mxw-id="DS549833152" load-source="docdb">LI</country><country mxw-id="DS549756529" load-source="docdb">LT</country><country mxw-id="DS549845056" load-source="docdb">LU</country><country mxw-id="DS549756530" load-source="docdb">LV</country><country mxw-id="DS549756531" load-source="docdb">MC</country><country mxw-id="DS549834320" load-source="docdb">MK</country><country mxw-id="DS549834321" load-source="docdb">MT</country><country mxw-id="DS549845057" load-source="docdb">NL</country><country mxw-id="DS549913361" load-source="docdb">NO</country><country mxw-id="DS549845058" load-source="docdb">PL</country><country mxw-id="DS549756532" load-source="docdb">PT</country><country mxw-id="DS549845059" load-source="docdb">RO</country><country mxw-id="DS549756549" load-source="docdb">RS</country><country mxw-id="DS549845060" load-source="docdb">SE</country><country mxw-id="DS549756550" load-source="docdb">SI</country><country mxw-id="DS549764517" load-source="docdb">SK</country><country mxw-id="DS549764518" load-source="docdb">SM</country><country mxw-id="DS549834326" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA99830250" ref-ucid="WO-2012118984-A2" lang="EN" load-source="patent-office"><p num="0000">In a pre-operating system environment on a device prior to loading and running an operating system on the device, a policy identifying configuration settings for the operating system is obtained. The operating system itself is prevented from changing this policy, but the policy can be changed under certain circumstances by components of the pre-operating system environment. The policy is compared to configuration values used by the operating system, and the operating system is allowed to boot with the configuration values if the configuration values satisfy the policy. However, if the configuration values do not satisfy the policy, then a responsive action is taken.</p></abstract><abstract mxw-id="PA100327078" ref-ucid="WO-2012118984-A2" lang="EN" source="national office" load-source="docdb"><p>In a pre-operating system environment on a device prior to loading and running an operating system on the device, a policy identifying configuration settings for the operating system is obtained. The operating system itself is prevented from changing this policy, but the policy can be changed under certain circumstances by components of the pre-operating system environment. The policy is compared to configuration values used by the operating system, and the operating system is allowed to boot with the configuration values if the configuration values satisfy the policy. However, if the configuration values do not satisfy the policy, then a responsive action is taken.</p></abstract><abstract mxw-id="PA99830251" ref-ucid="WO-2012118984-A2" lang="FR" load-source="patent-office"><p num="0000">Dans un environnement pré-système d'exploitation sur un dispositif avant de charger et d'exécuter un système d'exploitation sur le dispositif, on obtient une politique identifiant des options de configuration pour le système d'exploitation. On empêche le système d'exploitation de changer sa politique, mais la politique peut être changée dans certaines circonstances par des composants de l'environnement pré-système d'exploitation. La politique est comparée aux valeurs de configuration utilisées par le système d'exploitation, et le système d'exploitation est autorisé à s'amorcer avec les valeurs de configuration si ces dernières sont conformes à la politique. Toutefois, si les valeurs de configuration ne sont pas conformes à la politique, une action conséquente est prise.</p></abstract><abstract mxw-id="PA100327079" ref-ucid="WO-2012118984-A2" lang="FR" source="national office" load-source="docdb"><p>Dans un environnement pré-système d'exploitation sur un dispositif avant de charger et d'exécuter un système d'exploitation sur le dispositif, on obtient une politique identifiant des options de configuration pour le système d'exploitation. On empêche le système d'exploitation de changer sa politique, mais la politique peut être changée dans certaines circonstances par des composants de l'environnement pré-système d'exploitation. La politique est comparée aux valeurs de configuration utilisées par le système d'exploitation, et le système d'exploitation est autorisé à s'amorcer avec les valeurs de configuration si ces dernières sont conformes à la politique. Toutefois, si les valeurs de configuration ne sont pas conformes à la politique, une action conséquente est prise.</p></abstract><description mxw-id="PDES51232155" ref-ucid="WO-2012118984-A2" lang="EN" load-source="patent-office"><!-- EPO <DP n="2"/>--><p id="p0001" num="0001"> PROTECTING OPERATING SYSTEM CONFIGURATION VALUES</p><p id="p0002" num="0002">Background </p><p id="p0003" num="0003"> [0001] Computers have become increasingly interconnected via various networks, such as the Internet. While such connectivity allows users to access a variety of different services and data, such connectivity is not without its problems. One such problem is that such connectivity can allow malicious programs to be run on these computers. These malicious programs can perform a variety of undesirable actions, such as launching attacks against other computers, sending private data to other users' computers, preventing a user from being able to use his or her computer, and so forth. It remains difficult to protect computers against such malicious programs. </p><p id="p0004" num="0004">Summary </p><p id="p0005" num="0005"> [0002] This Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter, nor is it intended to be used to limit the scope of the claimed subject matter. </p><p id="p0006" num="0006"> [0003] In accordance with one or more aspects, in a pre-operating system environment on a device prior to loading and running an operating system on the device, a policy identifying configuration settings for at least one operating system is obtained. The operating system is prevented from changing this policy. This policy is compared to configuration values used by the operating system, and the operating system is allowed to boot with the configuration values if the configuration values satisfy the policy. However, if the configuration values do not satisfy the policy, then a responsive action is taken. </p><p id="p0007" num="0007">[0004] In accordance with one or more aspects, a change to a policy identifying configuration settings that are to be satisfied by configuration values of the operating system in order for the operating system to be executed on the device is received. The operating system itself is prevented from changing this policy. A check is made as to whether the change to the policy is approved by an entity trusted by a pre-operating system environment, and the policy is changed only if the change to the policy is approved by the pre-operating system environment. </p><p id="p0008" num="0008">Brief Description of the Drawings </p><p id="p0009" num="0009"> [0005] The same numbers are used throughout the drawings to reference like features. </p><p id="p0010" num="0010">[0006] Fig. 1 illustrates an example device implementing the protecting operating system configuration values in accordance with one or more embodiments. 
<!-- EPO <DP n="3"/>-->
 [0007] Fig. 2 illustrates an example policy in accordance with one or more embodiments. </p><p id="p0011" num="0011"> [0008] Fig. 3 is a flowchart illustrating an example process for protecting operating system configuration values in accordance with one or more embodiments. </p><p id="p0012" num="0012">[0009] Fig. 4 is a flowchart illustrating an example process for changing policies in a device in accordance with one or more embodiments. </p><p id="p0013" num="0013"> [0010] Fig. 5 illustrates an example computing device that can be configured to implement the protecting operating system configuration values in accordance with one or more embodiments. </p><p id="p0014" num="0014">Detailed Description </p><p id="p0015" num="0015"> [0011] Protecting operating system configuration values is discussed herein. During a process of booting a device, a set of configuration values used by at least part of one or more operating systems of the device, and optionally including one or more configuration values used by components of a pre-operating system environment of the device, is checked against a policy for the device. If the configuration values satisfy the policy, then the operating system is permitted to run on the device, but if the configuration values do not satisfy the policy then one or more appropriate actions are taken (e.g., not running the operating system, changing the values, etc.). The policy is stored in a manner protecting against unauthorized modification by the operating system and other applications running on the computing device. However, one or more policy issuers can update the policy, allowing the policy to change over time. </p><p id="p0016" num="0016"> [0012] References are made herein to symmetric key cryptography, public key cryptography and public/private key pairs. Although such key cryptography is well- known to those skilled in the art, a brief overview of such cryptography is included here to assist the reader. In public key cryptography, an entity (such as a user, hardware or software component, a device, a domain, and so forth) has associated with it a public/private key pair. The public key can be made publicly available, but the entity keeps the private key a secret. Without the private key it is computationally very difficult to decrypt data that is encrypted using the public key. So, data can be encrypted by any entity with the public key and only decrypted by an entity with the corresponding private key. Additionally, a digital signature for data can be generated by using the data and the private key. Without the private key it is computationally very difficult to create a signature that can be verified using the public key. Any entity with the public key can use 
<!-- EPO <DP n="4"/>-->
 the public key to verify the digital signature by executing a suitable digital signature verification algorithm on the public key, the signature, and the data that was signed. </p><p id="p0017" num="0017">[0013] In symmetric key cryptography, on the other hand, a shared key (also referred to as a symmetric key) is known by and kept secret by the two entities. Any entity having the shared key is typically able to decrypt data encrypted with that shared key. Without the shared key it is computationally very difficult to decrypt data that is encrypted with the shared key. So, if two entities both know the shared key, each can encrypt data that can be decrypted by the other, but other entities cannot decrypt the data if the other entities do not know the shared key. Similarly, an entity with a shared key can encrypt data that can be decrypted by that same entity, but other entities cannot decrypt the data if the other entities do not know the shared key. Additionally, digital signatures can be generated based on symmetric key cryptography, such as using a keyed-hash message authentication code mechanism. Any entity with the shared key can generate and verify the digital signature. For example, a trusted third party can generate a symmetric key based on an identity of a particular entity, and then can both generate and verify digital signatures for that particular entity (e.g., by encrypting or decrypting the data using the symmetric key). </p><p id="p0018" num="0018">[0014] Fig. 1 illustrates an example device 100 implementing the protecting operating system configuration values in accordance with one or more embodiments. Device 100 includes firmware 102, operating system loader 104, and operating system kernel 106, each of which is one or more components or modules that allow device 100 to perform various operations. These components or modules include instructions and/or data that is typically stored in a nonvolatile memory or storage device (e.g., Flash memory, read only memory (ROM), magnetic disk, optical disc, remote device or storage accessed over a network, and so forth). These components or modules are loaded from the nonvolatile memory or storage device into one or more volatile memories (e.g., random access memory (RAM)) from which they are retrieved and executed by one or more processors. </p><p id="p0019" num="0019">[0015] When device 100 is powered on or otherwise reset, device 100 boots. Booting of device 100 refers to the beginning operation of device 100, typically loading and executing an operating system of device 100. The booting of device 100 typically includes at least two stages. In the first stage, components of a pre-operating system environment are loaded and run on device 100. In the pre-operating system environment, various components or modules run performing various operations including booting the operating system. In the second stage, components of the operating system environment 
<!-- EPO <DP n="5"/>-->
 are loaded and run on device 100. In the operating system environment, the operating system is running on device. 100. </p><p id="p0020" num="0020"> [0016] Loading of a component refers to copying the component into a volatile (or alternatively nonvolatile) memory, and optionally performing additional configurations to other components or data stores. Executing a component refers to the running of (execution of) the instructions of the component by a processor or controller of device 100. After device 100 is booted, various other programs can be run on device 100 by the operating system. </p><p id="p0021" num="0021"> [0017] Device 100 can be a variety of different types of physical devices. For example, device 100 can be a desktop computer, a laptop or netbook computer, a notepad or tablet computer, a mobile station, an entertainment appliance, a set-top box communicatively coupled to a display device, a television, a cellular or other wireless phone, a game console, an automotive computer, and so forth. Device 100 can also be a virtual device, such as a virtual machine running on a physical device. A virtual machine can be run on any of a variety of different types of physical devices. </p><p id="p0022" num="0022"> [0018] During the boot process, firmware 102 is loaded and executed by device 100. Firmware 102 is stored in a nonvolatile memory of device 100. Firmware 102 can be stored in a read only memory, or alternatively in writeable nonvolatile memory (such as Flash memory). In embodiments in which firmware 102 is stored in writeable nonvolatile memory, care is typically taken to ensure that such firmware 102 is not tampered with (and thus not altered by a malicious program). Such care can be taken, for example, by verifying a signature on the firmware 102 stored in writeable nonvolatile memory, storing firmware 102 in protected memory that is accessible only to firmware 102, using a variety of conventional trusted boot or secure boot techniques, and so forth. </p><p id="p0023" num="0023">[0019] Firmware 102 initiates execution of operating system loader 104. Operating system loader 104 is typically loaded and verified by firmware 102 before being executed. Operating system loader 104 can be verified in different manners, such as by verifying a digital signature (generated by an entity that firmware 102 is configured (e.g., programmed) to trust) of operating system loader 104. </p><p id="p0024" num="0024">[0020] Operating system loader 104 loads and executes operating system kernel 106. Operating system kernel 106 is typically loaded and verified by operating system loader 104 before being executed. Operating system kernel 106 can be verified in different manners, such as by verifying a digital signature (generated by an entity that operating system loader 104 is configured (e.g., programmed) to trust) of operating system kernel 
<!-- EPO <DP n="6"/>-->
 106. Operating system kernel 106 can then proceed to load and execute a variety of different operating system components and/or user mode components. These operating system components and user mode components can be executed in response to a user request to execute such a component or in response to a request from another component or module. </p><p id="p0025" num="0025"> [0021] Operating system kernel 106 obtains and operates in accordance with various operating system configuration values 112. Although illustrated as being accessed by operating system kernel 106, operating system configuration values 112 can also be accessed by operating system loader 104, and/or other components or modules of device 100. Operating system configuration values 112 can be any of a variety of different information that is used to determine how operating system kernel 106 (and/or operating system loader 104) is to operate, what components of operating system kernel 106 (and/or operating system loader 104) are to be loaded and executed, combinations thereof, and so forth. For example, operating system configuration values 112 can be an indication of whether operating system kernel 106 (and/or operating system loader 104) is to permit untrusted programs or components to execute on device 100 or whether operating system kernel 106 (and/or operating system loader 104) is to authenticate programs or components before running on device 100. By way of another example, operating system configuration values 112 can be an indication of whether an anti-malware application (or a particular anti-malware application) is to be run on device 100. By way of another example, operating system configuration values 112 can be an indication of configuration values or settings to be used for a virtual machine manager that manages virtual machines running on device 100. By way of yet another example, operating system configuration values 112 can be an indication of particular processor or processor core settings to be used (e.g., areas of memory that are to be marked as non-executable). </p><p id="p0026" num="0026"> [0022] In one or more embodiments, firmware 102 and operating system loader 104 are implemented as part of a pre-execution environment (also referred to as a pre-boot environment or pre-operating system environment), which refers to an environment running on device 100 before the operating system has finished booting and is running. In such embodiments, firmware 102 and operating system loader 104 can be stored on a component of device 100 (e.g., in read only memory (ROM) or flash memory), such as on a network interface card of device 100. Alternatively, firmware 102 and operating system loader 104 can be obtained from another device or service during the pre-execution environment. For example, firmware 102 and operating system loader 104 can be 
<!-- EPO <DP n="7"/>-->
 included as part of a boot image provided to the device 100 from another device or service. </p><p id="p0027" num="0027"> [0023] The pre-execution environment can be implemented in a variety of different manners and can be based on a variety of different conventional techniques. For example, the pre-execution environment can be implemented in accordance with the Preboot execution Environment (PXE) standard version 2.0 or other versions. By way of another example, the pre-execution environment can be implemented in accordance with the Unified Extensible Firmware Interface (UEFI) standard version 2.3 or other versions. By way of yet another example, the pre-execution environment can be implemented using a variety of different personal computer basic input/output system (BIOS) versions. </p><p id="p0028" num="0028"> [0024] During the boot process, operating system loader 104 obtains policy record 114, which is a record of one or more policies to which device 100 is to conform. This record of policies includes configuration settings or values that operating system configuration values 112 are to satisfy. Operating system loader 104 compares the one or more policies in policy record 114 to operating system configuration values 112, and proceeds with initiating execution of operating system kernel 106 components if operating system configuration values 112 satisfy the one or more policies in policy record 114. However, if one or more operating system configuration values 112 do not satisfy a policy in policy record 114 then an appropriate responsive action is taken. A variety of different responsive actions can be taken, such as not loading operating system kernel 106, changing an operating system configuration value 112, and so forth. These responsive actions are discussed in more detail below. Operating system loader 104 thus protects operating system configuration values 112, identifying situations in which operating system configuration values 112 may have been changed by a malicious program. </p><p id="p0029" num="0029">[0025] In one or more embodiments the one or more policies in policy record 114 also include configuration settings or values that one or more components of a pre-operating system environment of the device are to satisfy. These configuration settings or values to be satisfied by the pre-operating system environment can be any of a variety of different indications of how the pre-operating system environment is to operate, what components of the pre-operating system environment are to be loaded and executed, combinations thereof, and so forth. These configuration settings or values can be included as part of operating system configuration values 112, or alternatively can be other settings or values. For example, these configuration settings or values can specify that only a particular operating system is to be loaded and executed. 
<!-- EPO <DP n="8"/>-->
 [0026] Although a single operating system kernel 106 is illustrated in Fig. 1, it should be noted that alternatively multiple different operating system kernels 106 can be loaded and executed on device 100. Each of these different operating system kernels can have its own operating system configuration values 112 and its own policy record 114 (or its own policies within policy record 114), and operating system loader 104 compares the appropriate one or more policies to the appropriate operating system configuration values for the operating system kernel 106 being booted. Alternatively, two or more of these different operating system kernels can share at least part of operating system configuration values 112 and/or policy record 114 (and/or policies within policy record 114). </p><p id="p0030" num="0030">[0027] Fig. 2 illustrates an example policy 200 in accordance with one or more embodiments. Policy 200 can be included, for example, as a policy in policy record 114 of Fig. 1. Policy 200 includes a policy identifier 202, a policy ancestor list 204, and one or more configuration values and/or settings 206. A digital signature 208 over policy 200 is also generated by digitally signing one or more of policy identifier 202, policy ancestor list 204, and configuration values/settings 206. </p><p id="p0031" num="0031"> [0028] Policy identifier 202 identifies policy 200, allowing different policies to be distinguished from one another. Policy identifier 202 can be, for example, a globally unique ID (GUID) assigned to policy 200. Policy ancestor list 204 is a list of zero or more other policies which policy 200 replaces. Policy ancestor list 204 facilitates preventing certain types of attacks, as discussed in more detail below. </p><p id="p0032" num="0032"> [0029] Configuration values and/or settings 206 include the values that the operating system configuration values (e.g., values 112 of Fig. 1) are to satisfy. Configuration values and/or settings 206 can also include the responsive action to take if one or more of the configuration values in policy 200 are not satisfied by the operating system configuration values. One or more of the configuration values and/or settings 206 can optionally be set by an operating system loader component, as discussed in more detail below. </p><p id="p0033" num="0033"> [0030] Configuration values and/or settings 206 can also include references to identifiers of one or more other policies. The configuration values and/or setting in these one or more other policies are included as part of policy 200. Thus, a policy 200 can effectively incorporate or include one or more other policies. Configuration values and/or settings 206 can also include identifiers of one or more trusted policy issuers. Thus, a new policy issuer that is allowed to add policies to the policy record (e.g., policy record 114 of Fig. 1) can be identified in policy 200. 
<!-- EPO <DP n="9"/>-->
 [0031] Returning to Fig. 1, operating system loader 104 checks whether operating system configuration values 112 satisfy the one or more policies in policy record 114. Policy record 114 can include a single policy, which can be changed by one or more different policy issuers as discussed in more detail below. Alternatively, policy record 114 can include multiple policies, each of which can be changed by one or more policy issuers. Accordingly, different policy issuers can, for example, provide different policies (that they can subsequently change) for inclusion in policy record 114. </p><p id="p0034" num="0034"> [0032] The configuration values can be identified in the policies in a variety of different manners. In one or more embodiments, policies identify values in name-value pairs, including a name (or other identifier) of an operating system configuration value and one or more values that that operating system configuration value is to have in order to satisfy the policy. In other embodiments, values are included in a policy in an ordering or other structure in which the corresponding operating system configuration values are inherent. </p><p id="p0035" num="0035">[0033] The determination of whether operating system configuration values 112 satisfy the one or more policies in policy record 114 can be performed in different manners. In one or more embodiments, a mathematical operator is used to determine whether an operating system configuration value satisfies a policy. A variety of different mathematical operators can be used, such as equals, greater than, less than, and so forth. In other embodiments other operators or logical formulas are used to determine whether an operating system configuration value satisfies a policy, such as whether the operating system configuration value is included as one of a set of values in the policy. </p><p id="p0036" num="0036">[0034] In situations in which multiple policies are included in policy record 114, the determination of whether operating system configuration values 112 satisfy the policies in policy record 114 is a determination of whether operating system configuration values 112 satisfy each of the multiple polices in policy record 114. Thus, the multiple policies can be viewed as being combined for purposes of determining whether operating system configuration values 112 satisfy the policies in policy record 114. </p><p id="p0037" num="0037"> [0035] If operating system configuration values 112 satisfy policy record 114, then operating system loader 104 proceeds with initiating execution of operating system kernel 106. However, if one or more operating system configuration values 112 do not satisfy policy record 114 then an appropriate action in response to the one or more operating system configuration values 112 not satisfying policy record 114 is taken. Different responsive actions can be taken for different operating system configuration values, or the 
<!-- EPO <DP n="10"/>-->
 same responsive action can be taken for multiple operating system configuration values. These responsive actions can include actions that stop the boot process so that the operating system is not loaded and run on device 100, as well as actions that allow the boot process to continue so that the operating system is loaded and run on device 100. </p><p id="p0038" num="0038">[0036] In one or more embodiments, the responsive action to be taken is included in policy record 114. Each policy in policy record 114 can include an indication (e.g., as part of configuration values/settings 206 of Fig. 2) of the responsive action to be taken if at least part of the policy is not satisfied (e.g., a particular operating system configuration value 112 does not satisfy the policy). In other embodiments, the responsive action to be taken is included in (e.g., programmed in or set as a configuration value) or otherwise obtained by operating system loader 104. </p><p id="p0039" num="0039"> [0037] The responsive action can be to stop the boot process - operating system loader 104 does not initiate execution of operating system kernel 106 so the operating system is not loaded and run on device 100. The responsive action can alternatively be to ignore the operating system configuration value 112 that does not satisfy the policy and use another value (e.g., included in the policy) instead. The responsive action can alternatively be to overwrite the operating system configuration value 112 with the value from (or otherwise identified by) the policy, and allow the boot process to continue. The responsive action can alternatively be to use the operating system configuration value 112 and allow the boot process to continue, but report an event, such as record or send (e.g., to another component, device, or service) a notification that the operating system configuration value 112 did not satisfy the policy (an indication of the particular operating system configuration value and/or policy can be included in the notification). </p><p id="p0040" num="0040">[0038] The responsive action can alternatively be to prompt a user of device 100 (e.g., to receive user approval to proceed with the boot process). This prompting can include, for example, a prompt requesting the user to approve of a current operating system configuration value. This prompting can also include an indication of what the configuration value should be in order to satisfy the policy. The user can then provide a variety of different inputs to approve (or disapprove) proceeding with the current operating system configuration value, such as pressing a button or key, touching a particular portion of a screen, providing an audible input, providing a security token that is trusted (or can be verified by) operating system loader 104, and so forth. Operating system loader 104 takes care to verify that the input is received from a user of device 100 (e.g., received from a keyboard, touchscreen, microphone, etc. of device 100) rather than a 
<!-- EPO <DP n="11"/>-->
 remote device (e.g., verifies that the user input is received from a key press or local microphone rather than a request received from a remote device). Thus, in such situations, the boot process can continue only if a user is present at device 100 and approves of continuing the boot process - a malicious device or a malicious component of device 100 cannot approve of continuing the boot process. </p><p id="p0041" num="0041"> [0039] Policy record 114 is maintained in a secure manner in which operating system loader 104 can change policy record 114 but that components executed after operating system loader 104 (in particular operating system kernel 106 as well as other operating system components and/or user mode components) are prevented from changing policy record 114. Policy record 114 is illustrated as surrounded by a dashed line 116 to reflect this security. Policy record 114 can be maintained in this secure manner in a variety of different manners. </p><p id="p0042" num="0042"> [0040] In one or more embodiments, policy record 114 is stored in a writeable nonvolatile memory, such as nonvolatile random access memory (NVRAM). The writeable NVRAM can be accessed only under certain conditions and/or at certain times. In one or more embodiments, the writeable NVRAM is accessed via a Trusted Platform Module (TPM). Additional information regarding TPM is available from the Trusted Computing Group of Beaverton, Oregon. The TPM allows the writeable NVRAM to be read from and written to until a certain point in time or a certain event occurs, after which the TPM allows the writeable NVRAM to be read but not written. This certain point in time or event can be, for example, a request from a component to close or lock the writeable NVRAM. Accordingly, operating system loader 104 can make changes to policy record 114 in the writeable NVRAM and then have the writeable NVRAM locked. Operating system loader 104 can thus prevent a malicious program from tampering with policy record 114 because the writeable NVRAM is locked. The writeable NVRAM is not unlocked until device 100 is booted again. The writeable NVRAM is unlocked the next time device 100 is booted, but operating system loader 104 locks the writeable NVRAM again before a malicious program would be able to execute and write to the writeable NVRAM. Similarly, other types of storage devices (e.g., magnetic disk drives) can be implemented so as to be accessed only under certain conditions and/or at certain times. </p><p id="p0043" num="0043"> [0041] Alternatively, policy record 114 can be maintained in a secure manner using other techniques, such as by policy record 114 being accessible only through a protected interface (e.g., an application programming interface (API)) that permits changes to policy record 114 only if the change is signed by a trusted entity. Such a trusted entity is an 
<!-- EPO <DP n="12"/>-->
 entity that is trusted by operating system loader 104 (e.g., an entity that is known by operating system loader 104 as being trustworthy and for which operating system loader 104 has a public key). For example, policy record 114 can be stored as a UEFI authenticated variable, which can be changed only if the change is signed by a trusted entity. Any requested changes to policy record 114 are verified as being signed by a trusted entity, and such requested changes are made if signed by a trusted entity but are not made if not signed by a trusted entity. </p><p id="p0044" num="0044"> [0042] By way of another example, in situations in which device 100 is implemented as a virtual machine, policy record 1 14 can be maintained in a secure manner by a virtual machine manager that manages operation of one or more virtual machines on a device. The virtual machine manager can permit operating system loader 104, but not other components, to change the policies in policy record 114. </p><p id="p0045" num="0045"> [0043] Changes to policy record 114 include adding policies to policy record 114, removing policies from policy record 114, and/or replacing policies in policy record 114 with new policies. In one or more embodiments, changes to policy record 114 are performed by operating system loader 104 if such changes are received from a trusted policy issuer (e.g., the changes are digitally signed by a policy issuer entity that is trusted by operating system loader 104). Requests to change policies in policy record 114 can be provided to operating system loader 104 in different manners. In one or more embodiments, operating system kernel 106 or another component running on device 100 stores the change to the policy in a persistent location that is accessible to operating system loader 104 on the next boot of device 100. On the next boot of device 100, operating system loader 104 obtains the change and implements the change if appropriate. The operating system kernel 106 or other component running on device 100 can also store a request for a particular type of change along with the change (e.g., an indication that a particular policy is to be removed or is to replace another policy). Alternatively, the request for a particular type of change can be inherent (e.g., the presence of a saved policy in the persistent location is deemed by operating system loader 104 as a request to add that policy to policy record 114). </p><p id="p0046" num="0046">[0044] Operating system loader 104 can remove a policy from policy record 114 in response to a request (from a policy issuer) to remove the policy. Operating system loader 104 verifies that the request is from a policy issuer that is a trusted entity, then removes the policy if the request is from a policy issuer that is a trusted entity and does not remove the policy if the request is not from a policy issuer that is a trusted entity. 
<!-- EPO <DP n="13"/>-->
 [0045] Similarly, operating system loader 104 can add a new policy to policy record 114 in response to a request (from a policy issuer) to add the policy. Operating system loader 104 verifies that the new policy (and optionally the request) is from a policy issuer that is a trusted entity, and adds the new policy if the new policy (and optionally the request) is from a policy issuer that is a trusted entity but does not add the new policy if the new policy (and/or optionally the request) is not from a policy issuer that is a trusted entity. </p><p id="p0047" num="0047"> [0046] Additionally, operating system loader 104 can replace a policy in policy record 114 (also referred to as the current version of the policy) with a new policy (also referred to as the new version of the policy). When a new policy is received operating system loader 104 verifies that the new policy (and optionally the request) is from a policy issuer that is a trusted entity. If the new policy (and/or optionally the request) is not from a policy issuer that is a trusted entity then operating system loader 104 does not replace the current version of the policy with the new version of the policy. </p><p id="p0048" num="0048">[0047] However, if the new policy (and optionally the request) is from a policy issuer that is a trusted entity, then operating system loader 104 checks whether the new version of the policy is indeed a newer version of the current version of the policy. Operating system loader 104 can check whether the new version of the policy is indeed a newer version of the current version of the policy by checking whether the current version of the policy is included in an ancestor list of the new version of the policy. The new version of the policy includes a policy ancestor list that identifies zero or more previous policies issued by that same policy issuer that are replaced by the new version of the policy. The policy ancestor list can identify previous policies by their policy identifiers (e.g., GUIDs). If the new version of the policy is from a policy issuer that is a trusted entity, and the current version of the policy is included in the policy ancestor list of the new version of the policy, then operating system loader 104 replaces the current version of the policy with the new version of the policy. Otherwise, operating system loader 104 does not replace the current version of the policy with the new version of the policy. </p><p id="p0049" num="0049"> [0048] It should be noted that use of the policy ancestor list facilitates protecting against rollback or replay attacks by a malicious program or user. For example, a malicious program or user may attempt to replace the current version of a policy (e.g., that includes new security-related values or settings) with an older version of the policy (e.g., that included out-dated security-related values or settings that would allow the malicious program or user to gain inappropriate access to components of device 100). By replacing 
<!-- EPO <DP n="14"/>-->
 the current version of the policy with the new policy only if the current version of the policy is included in the policy ancestor list of the new version of the policy, operating system loader 104 ensures that the current version of the policy is not replaced by an older version of the policy. Even though an older version of the policy may have been made available by a policy issuer that is a trusted entity, the older version of the policy would not have an ancestor list that includes the current version of the policy, and thus operating system loader 104 would not replace the current version of the policy with the older version of the policy. </p><p id="p0050" num="0050"> [0049] Additionally, in one or more embodiments changes to policy record 114 are performed by operating system loader 104 only if such changes are approved by an entity trusted by the pre-operating system environment (e.g., trusted by operating system loader 104 and/or firmware 102), such as a user of device 100 or other trusted entity. When the entity is a user of device 100, operating system loader 104 prompts the user of device 100 for approval of the change, such as by displaying a visual prompt on a screen of (or coupled to) device 100, playing back an audible prompt on a speaker of (or coupled to) device 100, and so forth. The user can approve the change to the policy by providing a variety of different inputs, such as pressing a button or key, touching a particular portion of a screen, providing an audible input, and so forth. Operating system loader 104 takes care to verify that the input is received from a user of device 100 (e.g., received from a keyboard, touchscreen, microphone, etc. of device 100) rather than a remote device (e.g., verifies that the user input is received from a key press or local microphone rather than a request received from a remote device). Thus, in such situations, changes to policy record 114 can be performed only if a user is present at device 100 and approves of the changes - a malicious device or a malicious component of device 100 cannot approve of such changes. </p><p id="p0051" num="0051"> [0050] When the entity is another entity trusted by the pre-operating system environment (other than a user), the changes to policy record 114 are digitally signed by the entity. Operating system loader 104 verifies the digital signature and performs the changes to policy record 114 only if the digital signature is verified as being from an entity trusted by the pre-operating system environment (e.g., trusted by operating system loader 104). If the digital signature is not verified then the changes to policy record 114 are not made. </p><p id="p0052" num="0052"> [0051] In one or more embodiments, policies in policy record 114 have an associated timestamp (e.g., date and time). The timestamp associated with a policy can be included 
<!-- EPO <DP n="15"/>-->
 as part of the policy, or alternatively can be maintained separately. For example, a separate record of policy identifiers and timestamps can be maintained by operating system loader 104, and this record is maintained in a secure manner (e.g., in a variety of different secure manners analogous to those discussed above regarding policies in policy record 114 being maintained in a secure manner). </p><p id="p0053" num="0053"> [0052] Operating system loader 104 can use these timestamps in determining whether to change policy record 114 (e.g., in determining whether a new version of the policy is indeed a newer version of the current version of the policy). A policy issuer can intend to replace one version of a policy with a new version of that policy, using the same policy identifier for both versions of the policy but different timestamps. Operating system loader 104 checks whether the new version of the policy (and optionally the request to change the policy) is from a policy issuer that is a trusted entity, and whether the new version of the policy has a more recent timestamp than the current version of the policy. If the new version of the policy is from a policy issuer that is a trusted entity, and the current version of the policy has a more recent timestamp than the current version of the policy, then operating system loader 104 replaces the current version of the policy with the new version of the policy. Otherwise, operating system loader 104 does not replace the current version of the policy with the new version of the policy. As the current version of the policy and the new version of the policy have the same policy identifier, the determination of whether to replace the current version of the policy with the new version of the policy is based on the timestamps of the versions of the policy rather than an ancestor list of the new version of the policy. </p><p id="p0054" num="0054"> [0053] Similarly, policies in policy record 114 can have an associated version number that is assigned by the policy issuer. The version number of a policy is incremented (or a next version number in a set is selected) for each new version of the policy. Version numbers can be used analogously to timestamps, but are numbers (and/or other characters) other than timestamps. </p><p id="p0055" num="0055"> [0054] Alternatively, operating system loader 104 need not use timestamps and/or version numbers in determining whether to change policy record 114. In such situations, if a policy issuer intends to replace one version of a policy with a new version of that policy, the policy issuer uses different policy identifiers for the two versions of the policy, and includes the policy identifier of the version of the policy to be replaced in the ancestor list of the new version of the policy. 
<!-- EPO <DP n="16"/>-->
 [0055] In one or more embodiments, changes to policy record 114 also include values written by an operating system loader 104 during the boot process. For particular configuration settings in a policy, operating system loader 104 captures one or more current values or settings in device 100 during the boot process. These captured values or settings are saved as part of (or otherwise associated with) the policy and treated as part of the policy to be satisfied on subsequent boots of device 100. Accordingly, operating system loader 104 verifies that, on subsequent boots of device 100, these captured settings or values are satisfied by operating system configuration values 112. </p><p id="p0056" num="0056">[0056] Which settings are to have their current values or settings captured during a boot process can be identified in different manners. For example, a policy can include a setting indicating that a particular value is to be captured and saved by operating system loader 104 during the boot process. By way of another example, operating system loader 104 can be configured with (e.g., programmed with) or otherwise obtain indications of which particular values are to be captured and saved by operating system loader 104 during the boot process. By way of another example, operating system loader 104 can detect when security of device 100 gets stronger or improves (e.g., when an anti-malware program is installed, when a firewall program is installed, etc.), and capture and save a value or setting associated with that stronger or improved security (e.g., capture and save an indication of the anti-malware program). </p><p id="p0057" num="0057">[0057] As device 100 can be booted multiple times, which one of those multiple boot processes is the boot process during which the values are to be captured and saved can be identified in different manners. The values can be captured and saved during the first time device 100 is booted without the value having already been captured and saved (or if no values are found to have been already captured and saved). Alternatively, operating system loader 104 can be configured with (e.g., programmed with) or otherwise obtain indications of on which boot of device 100 the values are to be captured and saved. Alternatively, a policy in policy record 114 can include an indication of on which boot of device 100 the values are to be captured and saved. </p><p id="p0058" num="0058"> [0058] Alternatively, a user input can be received that indicates to operating system loader 104 that the values are to be captured and saved (e.g., during the current boot process or on the next boot of device 100). The user input can be provided in different manners, such as by the user pressing a button or key, touching a particular portion of a screen, providing an audible input, and so forth. Operating system loader 104 takes care to verify that the input is received from a user of device 100 rather than a remote device 
<!-- EPO <DP n="17"/>-->
 (e.g., verifies that the user input is received from a key press or local microphone rather than a request received from a remote device). Thus, in such situations, a request to capture and save the values can be performed only if a user is present at device 100 and approves of such capture and saving - a malicious device or a malicious component of device 100 cannot approve the capture and saving of such values. </p><p id="p0059" num="0059"> [0059] Fig. 3 is a flowchart illustrating an example process 300 for protecting operating system configuration values in accordance with one or more embodiments. Process 300 is carried out by a device, such as device 100 of Fig. 1, and can be implemented in software, firmware, hardware, or combinations thereof. Process 300 is performed as part of a pre-operating system environment on a device prior to running an operating system on the device. Process 300 is shown as a set of acts and is not limited to the order shown for performing the operations of the various acts. Process 300 is an example process for protecting operating system configuration values; additional discussions of protecting operating system configuration values are included herein with reference to different figures. </p><p id="p0060" num="0060"> [0060] In process 300, a policy identifying configuration settings and/or values for an operating system is obtained (act 302). The policy can be changed by an operating system loader, but the operating system is prevented from changing the policy as discussed above. </p><p id="p0061" num="0061">[0061] The policy is compared to configuration values used by the operating system (act 304), and a check is made as to whether the configuration values used by the operating system satisfy the policy (act 306). Whether the configuration values used by the operating system satisfy the policy can be determined in a variety of different manners as discussed above. </p><p id="p0062" num="0062"> [0062] If the configuration values satisfy the policy, then the operating system is allowed to boot with the configuration values (act 308). However, if the configuration values do not satisfy the policy then a responsive action is taken (act 310). A variety of different responsive actions can be taken as discussed above. </p><p id="p0063" num="0063"> [0063] Fig. 4 is a flowchart illustrating an example process 400 for changing policies in a device in accordance with one or more embodiments. Process 400 is carried out by a device, such as device 100 of Fig. 1, and can be implemented in software, firmware, hardware, or combinations thereof. Process 400 is performed as part of a pre-operating system environment on a device prior to running an operating system on the device. Process 400 is shown as a set of acts and is not limited to the order shown for performing the operations of the various acts. Process 400 is an example process for changing 
<!-- EPO <DP n="18"/>-->
 policies in a device; additional discussions of changing policies in a device are included herein with reference to different figures. </p><p id="p0064" num="0064"> [0064] In process 400, a change to a policy identifying configuration settings and/or values for an operating system that are to be satisfied by configuration values of the operating system in order for the operating system to be executed or run are received (act 402). The operating system is prevented from changing the policy, as discussed above. </p><p id="p0065" num="0065">[0065] A check is made as to whether the change to the policy is approved by a trusted entity (act 404). Such a trusted entity is an entity trusted by the pre-operating system environment (e.g., an operating system loader), and this check can be made by prompting the user to approve the change, or verifying that the change is digitally signed by a trusted entity as discussed above. If the change is not approved by a trusted entity then the policy is not changed. However, if the change is approved by a trusted entity then the policy is changed (act 406) in accordance with the change received in act 402. In addition to the trusted entity approval, various other verifications or checks can also be performed before changing the policy as discussed above, such as checking timestamps, ancestor lists, and so forth. </p><p id="p0066" num="0066"> [0066] The protecting operating system configuration values techniques discussed herein support various usage scenarios. For example, operating system configuration values and a policy can indicate that an anti-malware program from one of various manufacturers or developers is to be run on a device, and that the operating system should not be loaded and run on the device unless such an anti-malware program is running on the device. If a malicious program were to attempt to modify the operating system configuration values to indicate that an anti-malware program is not required to be running in order to load and run the operating system, then the next time the device is booted an operating system loader component will detect that the operating system configuration values do not satisfy the policy, and thus does not load and run the operating system without the anti-malware program. </p><p id="p0067" num="0067"> [0067] By way of another example, a device can be shipped from a manufacturer or distributor with a default operating system policy. A purchaser of the device can desire to use the device in an enterprise environment (e.g., as part of a corporate or home network), and have an enterprise policy that he or she desires to have used in place of the default operating system policy. This enterprise policy can have different security-related settings and so forth than the default operating system policy, and the enterprise policy has an ancestor list that includes an identifier of the default operating system policy. An 
<!-- EPO <DP n="19"/>-->
 administrator of the enterprise environment can be a trusted entity and generate a digital signature over the enterprise policy, which is provided to the operating system loader. As the enterprise policy is signed by a trusted entity, and identifies the default operating system on its ancestor list, the enterprise policy replaces the default operating system policy in the policy record. However, a subsequent default operating system policy would not accidentally replace the enterprise policy because the subsequent default operating system policy would not identify the enterprise policy on its ancestor list. </p><p id="p0068" num="0068">[0068] Fig. 5 illustrates an example computing device 500 that can be configured to implement the protecting operating system configuration values in accordance with one or more embodiments. Computing device 500 can be, for example, device 100 of Fig. 1, or run a virtual machine in which device 100 is implemented. </p><p id="p0069" num="0069"> [0069] Computing device 500 includes one or more processors or processing units 502, one or more computer readable media 504 which can include one or more memory and/or storage components 506, one or more input/output (I/O) devices 508, and a bus 510 that allows the various components and devices to communicate with one another. Computer readable media 504 and/or one or more I/O devices 508 can be included as part of, or alternatively may be coupled to, computing device 500. Bus 510 represents one or more of several types of bus structures, including a memory bus or memory controller, a peripheral bus, an accelerated graphics port, a processor or local bus, and so forth using a variety of different bus architectures. Bus 510 can include wired and/or wireless buses. </p><p id="p0070" num="0070"> [0070] Memory/storage component 506 represents one or more computer storage media. Component 506 can include volatile media (such as random access memory (RAM)) and/or nonvolatile media (such as read only memory (ROM), Flash memory, optical disks, magnetic disks, and so forth). Component 506 can include fixed media (e.g., RAM, ROM, a fixed hard drive, etc.) as well as removable media (e.g., a Flash memory drive, a removable hard drive, an optical disk, and so forth). </p><p id="p0071" num="0071"> [0071] The techniques discussed herein can be implemented in software, with instructions being executed by one or more processing units 502. It is to be appreciated that different instructions can be stored in different components of computing device 500, such as in a processing unit 502, in various cache memories of a processing unit 502, in other cache memories of device 500 (not shown), on other computer readable media, and so forth. Additionally, it is to be appreciated that the location where instructions are stored in computing device 500 can change over time. 
<!-- EPO <DP n="20"/>-->
 [0072] One or more input/output devices 508 allow a user to enter commands and information to computing device 500, and also allows information to be presented to the user and/or other components or devices. Examples of input devices include a keyboard, a cursor control device (e.g., a mouse), a microphone, a scanner, and so forth. Examples of output devices include a display device (e.g., a monitor or projector), speakers, a printer, a network card, and so forth. </p><p id="p0072" num="0072"> [0073] Various techniques may be described herein in the general context of software or program modules. Generally, software includes routines, programs, applications, objects, components, data structures, and so forth that perform particular tasks or implement particular abstract data types. An implementation of these modules and techniques may be stored on or transmitted across some form of computer readable media. Computer readable media can be any available medium or media that can be accessed by a computing device. By way of example, and not limitation, computer readable media may comprise "computer storage media" and "communications media." </p><p id="p0073" num="0073">[0074] "Computer storage media" include volatile and non-volatile, removable and non-removable media implemented in any method or technology for storage of information such as computer readable instructions, data structures, program modules, or other data. Computer storage media include, but are not limited to, RAM, ROM, EEPROM, flash memory or other memory technology, CD-ROM, digital versatile disks (DVD) or other optical storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium which can be used to store the desired information and which can be accessed by a computer. </p><p id="p0074" num="0074"> [0075] "Communication media" typically embody computer readable instructions, data structures, program modules, or other data in a modulated data signal, such as carrier wave or other transport mechanism. Communication media also include any information delivery media. The term "modulated data signal" means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example, and not limitation, communication media include wired media such as a wired network or direct-wired connection, and wireless media such as acoustic, RF, infrared, and other wireless media. Combinations of any of the above are also included within the scope of computer readable media. </p><p id="p0075" num="0075"> [0076] Generally, any of the functions or techniques described herein can be implemented using software, firmware, hardware (e.g., fixed logic circuitry), manual processing, or a combination of these implementations. The terms "module" and 
<!-- EPO <DP n="21"/>-->
 "component" as used herein generally represent software, firmware, hardware, or combinations thereof. In the case of a software implementation, the module or component represents program code that performs specified tasks when executed on a processor (e.g., CPU or CPUs). The program code can be stored in one or more computer readable memory devices, further description of which may be found with reference to Fig. 5. The features of the protecting operating system configuration values techniques described herein are platform-independent, meaning that the techniques can be implemented on a variety of commercial computing platforms having a variety of processors. </p><p id="p0076" num="0076">[0077] Although the subject matter has been described in language specific to structural features and/or methodological acts, it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described above. Rather, the specific features and acts described above are disclosed as example forms of implementing the claims. 
</p></description><claims mxw-id="PCLM44851289" ref-ucid="WO-2012118984-A2" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="22"/>-->Claims What is claimed is: </claim-statement><claim id="clm-0001" num="1"><claim-text> 1. A method comprising: </claim-text><claim-text> obtaining, in a pre-operating system environment on a device prior to running an operating system on the device, a policy identifying configuration settings for one or more operating systems, the operating system being prevented from changing the policy; </claim-text><claim-text> comparing, in the pre-operating system environment, the policy to configuration values used by the operating system; </claim-text><claim-text> allowing, in the pre-operating system environment, the operating system to boot with the configuration values if the configuration values satisfy the policy; and </claim-text><claim-text> taking, in the pre-operating system environment, a responsive action if the configuration values do not satisfy the policy. </claim-text></claim><claim id="clm-0002" num="2"><claim-text> 2. A method as recited in claim 1, the policy further identifying configuration settings that the pre-operating system environment is to satisfy in order for the operating system to be allowed to boot. </claim-text></claim><claim id="clm-0003" num="3"><claim-text> 3. A method as recited in claim 1, further comprising: </claim-text><claim-text> capturing, in the pre-operating system environment, a value for a configuration setting of the policy; </claim-text><claim-text> saving the captured value as part of the policy; and </claim-text><claim-text> using the captured value as part of the policy settings of the policy for subsequent boots of the device. </claim-text></claim><claim id="clm-0004" num="4"><claim-text> 4. A method as recited in claim 1, further comprising allowing the policy to be replaced by a new version of the policy only if the new version of the policy is from a policy issuer that is a trusted entity and if the new version of the policy is determined to be a newer version of the policy. </claim-text></claim><claim id="clm-0005" num="5"><claim-text> 5. A method as recited in claim 4, further comprising determining that the new version of the policy is a newer version of the policy if an identifier of the policy is included in an ancestor list of the new version of the policy. </claim-text></claim><claim id="clm-0006" num="6"><claim-text> 6. A method as recited in claim 1, wherein the pre-operating system environment is a pre-operating system environment of a virtual machine running on a computing device.</claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. A method as recited in claim 1, wherein the policy is maintained in a secure manner in which a component of the pre-operating system environment can change the policy but the operating system is prevented from changing the policy. <!-- EPO <DP n="23"/>--> </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. A method as recited in claim 1, the policy further identifying the responsive action.</claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. A computing device comprising: </claim-text><claim-text> one or more processors; and </claim-text><claim-text> one or more computer readable media having stored thereon multiple instructions that, when executed by the one or more processors, cause the one or more processors to implement a pre-operating system environment of the computing device performing acts comprising: </claim-text><claim-text> receiving a change to a policy identifying configuration settings that are to be satisfied by configuration values of the operating system in order for the operating system to be executed on the computing device, the operating system being prevented from changing the policy; </claim-text><claim-text> checking, at the computing device, whether the change to the policy is approved by an entity trusted by the pre-operating system environment; and </claim-text><claim-text> changing the policy only if the change to the policy is approved by the entity trusted by the pre-operating system environment. </claim-text></claim><claim id="clm-0010" num="10"><claim-text> 10. A computing device as recited in claim 9, wherein the policy is maintained in a secure manner that is inaccessible to the operating system. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
