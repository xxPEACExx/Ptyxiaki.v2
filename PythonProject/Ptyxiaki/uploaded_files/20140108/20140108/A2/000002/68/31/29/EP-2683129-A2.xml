<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2683129-A2" country="EP" doc-number="2683129" kind="A2" date="20140108" family-id="48520701" file-reference-id="318318" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146585120" ucid="EP-2683129-A2"><document-id><country>EP</country><doc-number>2683129</doc-number><kind>A2</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-13168400-A" is-representative="YES"><document-id mxw-id="PAPP154847312" load-source="docdb" format="epo"><country>EP</country><doc-number>13168400</doc-number><kind>A</kind><date>20130520</date><lang>EN</lang></document-id><document-id mxw-id="PAPP183608533" load-source="docdb" format="original"><country>EP</country><doc-number>13168400.3</doc-number><date>20130520</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140554328" ucid="US-201261667539-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201261667539</doc-number><kind>P</kind><date>20120703</date></document-id></priority-claim><priority-claim mxw-id="PPC140553863" ucid="US-201261677365-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201261677365</doc-number><kind>P</kind><date>20120730</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL2001017182" load-source="docdb">H04L  29/08        20060101ALI20140114BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL2001017183" load-source="docdb">H04L  29/06        20060101AFI20140114BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL2001017184" load-source="docdb">H04L  12/24        20060101ALI20140114BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1928753337" load-source="docdb" scheme="CPC">H04L  69/323       20130101 LI20160604BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2001294530" load-source="docdb" scheme="CPC">H04L  69/14        20130101 LI20151113BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2001295485" load-source="docdb" scheme="CPC">H04L  69/40        20130101 LI20151113BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2001300307" load-source="docdb" scheme="CPC">H04L  69/18        20130101 LI20151113BHEP        </classification-cpc><classification-cpc mxw-id="PCL1991317931" load-source="docdb" scheme="CPC">H04L  41/083       20130101 FI20140102BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132359993" lang="DE" load-source="patent-office">Schnelle Anschlussarbitrierung</invention-title><invention-title mxw-id="PT132359994" lang="EN" load-source="patent-office">Fast linkup arbitration</invention-title><invention-title mxw-id="PT132359995" lang="FR" load-source="patent-office">Arbitrage de jonction rapide</invention-title><citations><non-patent-citations><nplcit><text>None</text><sources><source mxw-id="PNPL45210885" load-source="docdb" name="APP"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR919543742" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>SOLARFLARE COMM INC</last-name><address><country>US</country></address></addressbook></applicant><applicant mxw-id="PPAR919507040" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>SOLARFLARE COMMUNICATIONS INC</last-name></addressbook></applicant><applicant mxw-id="PPAR919016168" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Solarflare Communications Inc</last-name><iid>101319250</iid><address><street>7505 Irvine Center Drive, Suite 100</street><city>Irvine, CA 92618</city><country>US</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919527386" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>POPE STEVE</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919515663" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>POPE, STEVE</last-name></addressbook></inventor><inventor mxw-id="PPAR919007671" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>POPE, STEVE</last-name><address><street>2704 Albatross Drive</street><city>Costa Mesa, CA 92626</city><country>US</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR919015803" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Style, Kelda Camilla Karen</last-name><suffix>et al</suffix><iid>100036019</iid><address><street>Page White &amp; Farrer Bedford House John Street</street><city>London, WC1N 2BF</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS549815919" load-source="docdb">AL</country><country mxw-id="DS549744698" load-source="docdb">AT</country><country mxw-id="DS549816740" load-source="docdb">BE</country><country mxw-id="DS549814862" load-source="docdb">BG</country><country mxw-id="DS549744961" load-source="docdb">CH</country><country mxw-id="DS549816741" load-source="docdb">CY</country><country mxw-id="DS549818816" load-source="docdb">CZ</country><country mxw-id="DS549815921" load-source="docdb">DE</country><country mxw-id="DS549816746" load-source="docdb">DK</country><country mxw-id="DS549816747" load-source="docdb">EE</country><country mxw-id="DS549742701" load-source="docdb">ES</country><country mxw-id="DS549814863" load-source="docdb">FI</country><country mxw-id="DS549744962" load-source="docdb">FR</country><country mxw-id="DS549815934" load-source="docdb">GB</country><country mxw-id="DS549816748" load-source="docdb">GR</country><country mxw-id="DS549815935" load-source="docdb">HR</country><country mxw-id="DS549818817" load-source="docdb">HU</country><country mxw-id="DS549744963" load-source="docdb">IE</country><country mxw-id="DS549816749" load-source="docdb">IS</country><country mxw-id="DS549814864" load-source="docdb">IT</country><country mxw-id="DS549816750" load-source="docdb">LI</country><country mxw-id="DS549814865" load-source="docdb">LT</country><country mxw-id="DS549744699" load-source="docdb">LU</country><country mxw-id="DS549814870" load-source="docdb">LV</country><country mxw-id="DS549814871" load-source="docdb">MC</country><country mxw-id="DS549744700" load-source="docdb">MK</country><country mxw-id="DS549744709" load-source="docdb">MT</country><country mxw-id="DS549742702" load-source="docdb">NL</country><country mxw-id="DS549908583" load-source="docdb">NO</country><country mxw-id="DS549742703" load-source="docdb">PL</country><country mxw-id="DS549744710" load-source="docdb">PT</country><country mxw-id="DS549744964" load-source="docdb">RO</country><country mxw-id="DS549744711" load-source="docdb">RS</country><country mxw-id="DS549742704" load-source="docdb">SE</country><country mxw-id="DS549818822" load-source="docdb">SI</country><country mxw-id="DS549908584" load-source="docdb">SK</country><country mxw-id="DS549908585" load-source="docdb">SM</country><country mxw-id="DS549814872" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128673292" lang="EN" load-source="patent-office"><p id="pa01" num="0001">A data processing system comprising: first and second network ports each operable to support a network connection configured according to one or more of a predetermined set of physical layer protocols; and a processor configured to, on a network message being formed for transmission to a network endpoint accessible over either of the first and second network ports: estimate the total time required to, for each of the predetermined set of physical layer protocols, negotiate a respective network connection and transmit the entire network message over that respective network connection; select the physical layer protocol having the lowest estimate of the total time required to negotiate a respective network connection and transmit the network message over that respective network connection; and configure at least one of the first and second network ports to use the selected physical layer protocol.
<img id="iaf01" file="imgaf001.tif" wi="165" he="54" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128737443" lang="EN" source="EPO" load-source="docdb"><p>A data processing system comprising: first and second network ports each operable to support a network connection configured according to one or more of a predetermined set of physical layer protocols; and a processor configured to, on a network message being formed for transmission to a network endpoint accessible over either of the first and second network ports: estimate the total time required to, for each of the predetermined set of physical layer protocols, negotiate a respective network connection and transmit the entire network message over that respective network connection; select the physical layer protocol having the lowest estimate of the total time required to negotiate a respective network connection and transmit the network message over that respective network connection; and configure at least one of the first and second network ports to use the selected physical layer protocol.</p></abstract><description mxw-id="PDES63959280" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001">BACKGROUND OF THE INVENTION</heading><p id="p0001" num="0001">This invention relates to improved mechanisms for the communication of network messages between two network nodes on a physical connection being established between those nodes at a physical layer switch.</p><p id="p0002" num="0002">It is common practice for the release of news bulletins relating to certain events to be tightly controlled such that the bulletins are released not before a scheduled time. This is particularly well known in finance where there can be significant value in being the first to have access to information that could affect the markets. For example, news bulletins carrying the details of governmental budgets or interest rate changes by central banks are often embargoed until a predetermined time, at which point the news agencies that have been permitted to report on the event simultaneously release their bulletins into the public domain.</p><p id="p0003" num="0003">News bulletins are typically embargoed until a predetermined time by providing press reporters with access to the news information only within a "lock-up room" that is isolated from the outside world, with no communications being permitted from the room. Within the lock-up room, the news reporters are free to draft bulletins reporting the news event on computers provided for that purpose. However, those computers are physically isolated from public communication networks by an "air gap". Network messages carrying the news bulletins are therefore queued for delivery at the transmit queues of the computers until, at the predetermined time, a switch is thrown and a physical connection to the news distribution network is established. Such press lock-ups are used by the Australian and Canadian governments so as to provide for a scheduled release of Federal Budget information (see <u>http://www2b.abc.net.au/guestbookcentral/entry.asp?GuestbooklD=389&amp;EntrylD=<!-- EPO <DP n="2"> --> 755777</u> and http://www.cbc.ca/news/background/budget2006/blog.html), as well as by the US Department of Labor.</p><p id="p0004" num="0004">On a connection being made from the computer to the news distribution network, the physical and logical links appropriate to the communication protocols in use at the computer must be established so as to permit the transmission of the queued messages onto the network. For example, when a computer in the lock-up room is reconnected to the outside world, the computer would typically establish a connection with a server located outside of the lock-up room and configured to provide a gateway onto the respective news provider's network. If the connection were an Ethernet connection, then a physical layer link must first be established between the computer and server, over which a logical data link can subsequently be established to the intended endpoint receiver of the messages from that computer. For 100BASE-T Ethernet, the time required to establish such a data link layer connection can be 100 ms or more.</p><p id="p0005" num="0005">The advent of high speed trading has meant that significant profits can be made by traders who are able to exploit microsecond advantages in the receipt of financial information. Delays of tens of milliseconds therefore represent a significant length of time. Furthermore, the physical switch by which the computers of a lock-up room are isolated from the public networks will not close all of its ports simultaneously. There is typically a random distribution in its port closure timings with millisecond order standard deviation such that the time between a given pair of ports closing can be significant. This inadvertently causes the news bulletins from the lock-up computers allocated to some news providers to be released prior to the bulletins of other providers.</p><p id="p0006" num="0006">There is therefore a need for an improved mechanism for the scheduled release of embargoed news bulletins, particularly those bulletins carrying financial news.<!-- EPO <DP n="3"> --></p><heading id="h0002">SUMMARY OF THE INVENTION</heading><p id="p0007" num="0007">According to a first aspect of the present invention there is provided a data processing system comprising:
<ul><li>first and second network ports each operable to support a network connection configured according to one or more of a predetermined set of physical layer protocols; and</li><li>a processor configured to, on a network message being formed for transmission to a network endpoint accessible over either of the first and second network ports:
<ul><li>estimate the total time required to, for each of the predetermined set of physical layer protocols, negotiate a respective network connection and transmit the network message over that respective network connection;</li><li>select the physical layer protocol having the lowest estimate of the total time required to negotiate a respective network connection and transmit the entire network message over that respective network connection; and</li><li>configure at least one of the first and second network ports to use the selected physical layer protocol.</li></ul></li></ul></p><p id="p0008" num="0008">Suitably the processor is operable to, on a physical link being made to the first and second network ports a first time, cause the data processing system to signal over each of the at least one or the first and second network ports the identity of the selected physical layer protocol for use over those respective links on those physical links being made a subsequent time.</p><p id="p0009" num="0009">Preferably the processor is further configured to enqueue the network message at a transmit queue of each of the at least one of the first and second network ports such that, on a physical link being made to the respective network ports, the network message is transmitted from each of the at least one of the first and second network ports over a network connection established according to the selected physical layer protocol.<!-- EPO <DP n="4"> --></p><p id="p0010" num="0010">Preferably the transmit queue(s) are supported in hardware at network interface device(s) providing the respective at least one of the first and second network ports.</p><p id="p0011" num="0011">Preferably the data processing system further comprises a data store comprising data from which the processor is configured to estimate the total times. Preferably the data store comprises estimates of the time required to negotiate network connections over the first and second network ports according to each of the predetermined set of physical layer protocols. Preferably estimates of the time required to negotiate network connections over the first and second network ports represent estimates of the total time required to establish physical layer and data link layer connections. Preferably the data store comprises data representing the time required to transmit the network message as a function of network message size over network connections configured according to each of the predetermined set of physical layer protocols. Preferably the time required to transmit the network message over network connections configured according to each of the predetermined set of physical layer protocols comprises the total time required to transmit the entire network message over the respective network port.</p><p id="p0012" num="0012">Preferably the processor is configured to apply the selected physical layer protocol to both the first and second network ports and enqueue copies of the network message at a transmit queue corresponding to each of the first and second network ports such that, on physical links being made to the first and second network ports, the network message is transmitted in parallel over the physical links. Suitably the at least some of the physical layer protocols of the predetermined set of physical layer protocols are of the same type of physical layer protocol but defined so as to operate at different line speeds.</p><p id="p0013" num="0013">Suitably the at least some of the physical layer protocols of the predetermined set of physical layer protocols are of the same type of physical layer protocol but defined so as to operate with different compression schemes, and the estimate of<!-- EPO <DP n="5"> --> the time required to, for each of the predetermined set of physical layer protocols, transmit the entire network message over that respective network connection includes the time required to decompress the network message were it compressed in accordance the compression scheme of the respective physical layer protocol. The compression schemes could include deflate, LZW, and no compression. Preferably the data store further comprises data from which the processor is configured to calculate the time required to decompress the network message in accordance with each of the compression schemes of the predetermined set of physical layer protocols.</p><p id="p0014" num="0014">Preferably the processor is configured to perform the selection of the physical layer protocol independently of the type of physical interfaces of the one or more physical links, the processor being operable to select any of the set of physical layer protocols for use over any of the plurality of physical links.</p><p id="p0015" num="0015">Suitably the selected physical layer protocol for a given network port is any of 100BASE-TX, 10GBASE-T and Serial RS-485, and the physical interface of that network port is Ethernet RJ45.</p><p id="p0016" num="0016">Preferably the processor is supported at a network interface device of the data processing system, the processor optionally being implemented within an FPGA.</p><p id="p0017" num="0017">According to a second aspect of the present invention there is provided a system for communicating network messages between a pair of network nodes separated by a physical layer switch, the system comprising:
<ul><li>a first network node having a first plurality of network ports connected to a physical layer switch; and</li><li>a second network node having a second plurality of network ports connected to the physical layer switch and separated from the first network node by the physical layer switch;</li></ul>
wherein each of the first and second pluralities of network ports are operable to support a network connection configured according to one or more of a<!-- EPO <DP n="6"> --> predetermined set of physical layer protocols and each of the first plurality of physical ports is arranged to correspond to one of the second plurality of physical ports such that, in a first mode, the physical layer switch is operable to simultaneously provide a physical link between each of the first plurality of physical ports and its corresponding one of the second plurality of physical ports and, in a second mode, the physical layer switch is operable to simultaneously isolate each of the first plurality of physical ports from its corresponding one of the second plurality of physical ports;<br/>
the first network node being configured to, on forming a network message for transmission to a network endpoint accessible over the plurality of physical links:
<ul><li>estimate the total time required to, for each of the predetermined set of physical layer protocols, negotiate a respective network connection and transmit the entire network message over that respective network connection;</li><li>select the physical layer protocol having the lowest estimate of the total time required to negotiate a respective network connection and transmit the entire network message over that respective network connection; and</li><li>cause the network message to, on the physical layer switch entering its first mode, be transmitted over one or more physical links configured in accordance with the selected physical layer protocol.</li></ul></p><p id="p0018" num="0018">Preferably the first network node is configured to select the one or more physical links by:
<ul><li>selecting one physical link at random;</li><li>selecting all those physical links capable of supporting a network connection configured in accordance with the select physical layer protocol; or</li><li>selecting those physical links that offer the lowest estimate of the total time required to, for the selected physical layer protocol, negotiate a respective network connection and transmit the entire network message over that respective network connection.</li></ul><!-- EPO <DP n="7"> --></p><p id="p0019" num="0019">Preferably the first network node is operable to, on the physical layer switch entering its first mode a first time, signal over the one or more physical links to the second network node the identity of the selected physical layer protocol, the first and second network nodes being configured to use the selected physical layer protocol over the one or more physical links on the physical layer switch entering its first mode made a subsequent time.</p><p id="p0020" num="0020">Preferably the first network node is further configured to enqueue the network message at a transmit queue of each of the one or more physical links such that, on the physical layer switch entering its first mode, the network message is transmitted over the one or more physical links in accordance with the selected physical layer protocol.</p><p id="p0021" num="0021">Preferably each of the transmit queue(s) is supported in hardware at a network interface device, each transmit queue being at that network interface device providing the network port corresponding to the respective one of the one or more physical links.</p><p id="p0022" num="0022">Preferably the first network node is configured to apply the selected physical layer protocol to two or more physical links and to enqueue copies of the network message at transmit queues corresponding to each of the two or more physical links such that, on the physical layer switch entering its first mode, the network message is transmitted in parallel over the physical links.</p><p id="p0023" num="0023">Preferably the second network node is configured to, on receiving copies of the network message over the two or more physical links, keep only that network message received first at the second network node and to discard all those copies of the network message that are subsequently received.</p><p id="p0024" num="0024">Preferably the first network node is configured to include a sequence number with each network message it transmits such that duplicate network messages all sharing the same sequence number, and the second network node is configured<!-- EPO <DP n="8"> --> to use the sequence number to identify duplicate network messages that are to be discarded.</p><p id="p0025" num="0025">Suitably the at least some of the physical layer protocols of the predetermined set of physical layer protocols are of the same type of physical layer protocol but defined so as to operate at different line speeds.</p><p id="p0026" num="0026">Suitably the at least some of the physical layer protocols of the predetermined set of physical layer protocols are of the same type of physical layer protocol but defined so as to operate with different compression schemes, and the estimate of the time required to, for each of the predetermined set of physical layer protocols, transmit the entire network message over that respective network connection includes the time required to decompress the network message were it compressed in accordance the compression scheme of the respective physical layer protocol. The compression schemes could include deflate, LZW, and no compression.</p><p id="p0027" num="0027">Preferably the selection of the physical layer protocol by the first network node is performed independently of the type of physical interfaces of the one or more physical links, the first network node is operable to select any of the set of physical layer protocols for use over any of the plurality of physical links.</p><p id="p0028" num="0028">Preferably the selected physical layer protocol for a given physical link is any of 100BASE-TX, 10GBASE-T and Serial RS-485, and the physical interfaces of that physical link are Ethernet RJ45.</p><p id="p0029" num="0029">Preferably the second network node further provides a link to a data network over which the destination network endpoint of the network message is accessible, the data network supporting communications according to a predetermined set of communication protocols, and the second network node is configured to convert the network message into data packets formed in accordance with the predetermined set of communication protocols.<!-- EPO <DP n="9"> --></p><p id="p0030" num="0030">Preferably the second network node is configured to store information representing headers for the data packets formed in accordance with the predetermined set of communication protocols such that the second network node is operable to convert the network message into data packets without requiring substantial generation of the headers of the data packets in accordance with the predetermined set of communication protocols.</p><p id="p0031" num="0031">Preferably the first or second network node is configured to form a first timestamp on the physical layer switch entering its first mode and the second network node is configured to form a second timestamp on the network message being received at the second network node, the first or second network node being configured to estimate from the time elapsed between the first and second timestamps the latency in the transmission of the network message. Preferably the data processing system further comprises a data store comprising data from which the first network node is configured to estimate the total times. Preferably the first network node is further operable to update data stored at its data store In response to the estimate of the latency in the transmission of the network message.</p><p id="p0032" num="0032">Preferably the first and second network nodes are configured to, on the physical layer switch entering its first mode so as to permit transmission of the network message over the one or more physical links, establish according to the selected physical layer protocol a physical layer connection over at least some of the one or more physical links without substantial re-negotiation of the link parameters of those physical links by using, for each of the at least some of the one or more physical links, a set of stored link parameters defining a previously successful physical layer connection over the respective physical link.</p><p id="p0033" num="0033">According to a third aspect of the present invention there is provided a system for communicating network messages between a pair of network nodes separated by a physical layer switch, the system comprising:<!-- EPO <DP n="10"> -->
<ul><li>a first network node having a first plurality of network ports connected to a physical layer switch; and</li><li>a second network node having a second plurality of network ports connected to the physical layer switch and separated from the first network node by the physical layer switch;</li></ul>
wherein each of the first and second pluralities of network ports are operable to support a network connection configured according to one or more of a predetermined set of physical layer protocols and each of the first plurality of physical ports is arranged to correspond to one of the second plurality of physical ports such that, in a first mode, the physical layer switch is operable to simultaneously provide a physical link between each of the first plurality of physical ports and its corresponding one of the second plurality of physical ports and, in a second mode, the physical layer switch is operable to simultaneously isolate each of the first plurality of physical ports from its corresponding one of the second plurality of physical ports;<br/>
the first network node being configured to, on the physical layer switch entering the first mode, transmit duplicate network messages over two or more of the physical links in accordance with a selected one of the predetermined set of physical layer protocols, and<br/>
the second network node being configured to, on receiving said duplicate network messages, discard all those duplicate network messages except the first received network message.</p><p id="p0034" num="0034">Preferably the first network node is configured to include a sequence number with each network message it transmits such that duplicate network messages all sharing the same sequence number, and the second network node is configured to use the sequence number to identify duplicate network messages that are to be discarded.</p><p id="p0035" num="0035">According to a fourth aspect of the present invention there is provided a system for communicating network messages between a pair of network nodes separated by a physical layer switch, the system comprising:<!-- EPO <DP n="11"> -->
<ul><li>a first network node; and</li><li>a second network node separated from the first network node by a physical layer switch;<br/>
wherein the physical layer switch is operable to switch between first and second modes: in the first mode the physical layer switch providing a physical connection between the first and second network nodes, and in the second mode the physical layer switch isolating the first network node from the second network node;<br/>
the first and second network nodes being configured to, on the physical layer switch entering the first mode for a first time:</li><li>establish one or more physical layer links between the first and second network nodes, the parameters of each link being negotiated between the first and second network nodes; and</li><li>store said parameters of each of the one or more physical layer links;<br/>
the first and second network nodes being configured to, on the physical layer switch subsequently entering the first mode from the second mode:</li><li>read the stored parameters; and</li><li>re-establish the one or more physical layer links between the first and second network nodes using the stored parameters without substantial re-negotiation of the link parameters.</li></ul></p><heading id="h0003">DESCRIPTION OF THE DRAWINGS</heading><p id="p0036" num="0036">The present invention will now be described by way of example with reference to the accompanying drawings, in which:
<ul><li><figref idrefs="f0001">Figure 1</figref> is a schematic drawing of a system configured in accordance with the present invention.</li><li><figref idrefs="f0002">Figure 2</figref> is a schematic drawing of a network node configured in accordance with the present invention.</li><li><figref idrefs="f0002">Figure 3</figref> is a graph illustrative of the variation of latency with message size for various types of physical link.</li></ul><!-- EPO <DP n="12"> --></p><heading id="h0004">DETAILED DESCRIPTION OF THE DRAWINGS</heading><p id="p0037" num="0037">The following description is presented to enable any person skilled in the art to make and use the invention, and is provided In the context of a particular application. Various modifications to the disclosed embodiments will be readily apparent to those skilled in the art.</p><p id="p0038" num="0038">The general principles defined herein may be applied to other embodiments and applications without departing from the spirit and scope of the present invention. Thus, the present invention is not intended to be limited to the embodiments shown, but is to be accorded the widest scope consistent with the principles and features disclosed herein.</p><p id="p0039" num="0039">The present invention relates to improved mechanisms by which network messages can be communicated between two network nodes when a physical connection is made between those nodes at a physical layer switch. The present Invention is described below by way of example with reference to the scheduled transmission of network messages from an isolated data processing system to a data processing system having access to a data network. However, the present invention finds general application to the communication of data between two network nodes separated by a physical layer switch. There could be additional network nodes such as other data processing systems, routers and switches between the network nodes in addition to the physical layer switch.</p><p id="p0040" num="0040">A schematic diagram of a system configured in accordance with the present invention is shown in <figref idrefs="f0001">figure 1</figref>. The system comprises a pair of network nodes 101, 102 connected to one another by means of a physical layer switch 103. One or more physical links 104, 105, 106 extend between physical ports 107, 108, 109 of network node 101 and corresponding physical ports 110, 111, 112 of network node 102. Switches 113, 114, 115 of the physical layer switch 103 are operable to physically connect and disconnect respective physical links, as shown in the<!-- EPO <DP n="13"> --> figure. When one of the switches is closed, an electrical connection is made between the corresponding ports of network nodes 101 and 102 so as to allow physical and logical layer connections to be established over the respective links. Preferably the physical layer switch is operable to open and close all of switches 113, 114 and 115 at least approximately simultaneously.</p><p id="p0041" num="0041">Network node 101 cannot transmit network messages to network node 102 when the switches of physical switch 103 are open. Node 101 therefore comprises transmit queues 120 at which its network messages can be enqueued until switch 103 connects links 104-106 between the nodes.</p><p id="p0042" num="0042">In many scenarios in which a pair of network nodes are separated by a physical switch, it is important for the network messages enqueued at node 101 to be transmitted over the links to node 102 with the lowest possible latency when that switch 103 reconnects the physical links. For example, network node 101 could be a data processing system within a press lock-up at which sensitive financial news is being prepared, with network messages representing news bulletins being enqueued at queues 120 during the lock-up. Node 101 could be configured to receive network messages from multiple press computers over a local air-gap network but typically node 101 would be just one of several press computers connected into switch 103 For instance, switch 103 could have 48 ports with each of eight news providers being assigned 6 ports at random; if each network node 101 of a given news provider supported three connections to the switch then that network provider could operate two pairs of nodes 101 and 102 (each node 101 could connect to the same node 102 or a different node 102, depending on the number of connections supported by node 102).</p><p id="p0043" num="0043">Once the scheduled time is reached and the news bulletins are to be released into the public domain, switch 103 would be closed and the enqueued network messages press computer 101 would begin to flow to network node 102, which supports a permanent link 116 to news distribution network 117. Typically network nodes 101 and 102 would both be operated by the same news provider,<!-- EPO <DP n="14"> --> with node 101 being a press computer at which one or more journalists of the news provider draft press releases and node 102 being a server providing a dedicated connection to that news provider's data network.</p><p id="p0044" num="0044">In a first embodiment of the present invention, links 104, 105 and 106 support (when connected) a network connection configured in accordance with one of a predetermined set of physical layer protocols. Each physical layer protocol of the set could differ in the type of protocol (e.g. 100BASE-TX or Serial RS-485) and/or its line speed (e.g. a 100BASE-TX physical layer could be operated at 100 Mb/s or 10Mb/s) and/or the compression scheme in use.</p><p id="p0045" num="0045">When switches 113, 114 and 115 are closed so as to complete physical links 104, 105 and 106 between the network nodes, negotiation of the parameters of the physical layer of each link begins according to the physical layer protocols in use over that link. For example, links 104, 105 and 106 could be RS-485 serial, 100BASE-TX and a 10GBASE link (such as 10GBASE-CR or 10GBASE-T), respectively. Each physical layer connection would be established according to the protocol in use of the respective link and, subsequently, any required logical links would be negotiated between endpoints served over that connection prior to network messages being transmitted between the first and second nodes.</p><p id="p0046" num="0046">Note that it is preferable that any physical layer protocol could be selected for any physical link with which it is electrically compatible. For example, 100BASE-TX 10GBASE-T and RS-485 may use twisted pair cabling and it is therefore straightforward to run any of these protocols over a twisted pair cable, irrespective of the default designation of each physical link and the type of interfaces provided at the respective network ports of the network interface device and switch (e.g. any of 100BASE-TX, 10GBASE-T and RS-485 physical layer protocols could be configured to operate over twisted pair cabling terminated by Ethernet RJ45 connectors).<!-- EPO <DP n="15"> --></p><p id="p0047" num="0047">The time required to establish physical and logical layer connections and then to transmit a network message over that link depends on several factors, including the particular protocol in use, the line speed at which that protocol is to operate, and the size of the network message to be transmitted. The time taken to establish physical and logical connections and to transmit a network message over a link for the three exemplary protocols 10Mb RS-485 serial, 100BASE-TX and 10GBASE-CR (all operating at their maximum line speeds) is shown in <figref idrefs="f0002">figure 3</figref> as a function of network message size. It can be seen from the figure that 10GBASE-CR exhibits consistently lower connection latency than 100BASE-TX, but that for small message sizes of less than around 100kB, 10Mb RS-485 serial offers lower latency. This is because the lower overhead required to establish an RS-485 link dominates at small message sizes. At larger message sizes, the greater bandwidth of 100BASE-TX and 10GBASE-CR becomes significant.</p><p id="p0048" num="0048">In accordance with the first embodiment of the present invention, network node 101 is configured to, for each network message, select between the different physical layer protocols available for transmitting the message to node 102. This selection is performed in dependence on the size of the network message and the time required to negotiate a connection according to each physical layer protocol so as to minimise the latency associated with transmitting the message when the links are connected by switch 103. For example, with reference to <figref idrefs="f0002">figure 3</figref>, it is optimal to transmit messages that are less than 100kB in size over serial link 104, and messages over 100kB in size over 10GBASE-CR link 106.</p><p id="p0049" num="0049">Network node 101 comprises a processor 118 configured to perform the selection of the physical layer protocol and cause one or more of the physical links 104-106 to be configured in accordance with that selected protocol. Processor 118 could be any suitable processor, including a general purpose processor (e.g. a CPU) of network node 101 arranged to execute suitable software, a processor dedicated to supporting network functionalities of the network node, or a combination of software supported at a general purpose processor with a dedicated processor.<!-- EPO <DP n="16"> --></p><p id="p0050" num="0050">Preferably processor 118 is at least partly supported at a hardware processor of a network interface device of the network node.</p><p id="p0051" num="0051">Some physical links may be constrained in terms of the physical layer protocols they can supported. In this case it can be advantageous to allocate network messages to those links even if they offer higher latency when the transmission of that network packet is considered In isolation. For example, if link 105 is constrained to support only 100BASE-TX, that link could be used for a network message once the transmit queues 120 at node 101 corresponding to links 104 and 106 (which have been selected to support lower latency protocols) have filled to the extent that the network message would arrive at node 102 sooner once switch 103 is closed than if the network message were queued for transmission over links 104 and 106 that on the face of it provide lower latency when that network message is considered in isolation. This could be applied as a secondary criterion when network node 101 performs the selection between available links 104-106 but would not normally be required in the case that network node 101 is located within a press lockup because typically only one or two messages are enqueued during lockup periods. In the event that the network node has multiple messages to transmit, the node is preferably configured to allocate short messages to lower latency links and long messages to high bandwidth links. For example, if the network node has multiple short messages and one long message to transmit, the node would allocate the long message to a 100BASE-TX link and the short messages to a lower latency link.</p><p id="p0052" num="0052">Switch 103 is configured to, when the two nodes are to be reconnected, simultaneously connect the physical links between the nodes. This allows the nodes to negotiate and establish the necessary physical and logical connections over each of the links and transmit the network messages in parallel over their selected links. Since each network message has been assigned to a link configured to use the physical layer protocol that will allow that message to be delivered at the optimum latency, this has the effect that the network messages at node 101 are efficiently conveyed to node 102. Only three links are shown in<!-- EPO <DP n="17"> --> <figref idrefs="f0001">figure 1</figref>, but typically physical switch 103 would support many more. For example, switch 103 could be operable to switch up to 100 links extending between pairs of nodes such as node pair 101 and 102.</p><p id="p0053" num="0053">In order to allow onward transmission of the network messages, it may be necessary to configure node 102 to convert the network messages from one protocol to another. For example, node 102 would typically have a permanent Ethernet link 116 to network 117 (e.g. the news distribution network) and network messages received at node 102 according to the RS-485 serial protocol would therefore need to be re-framed according to the relevant Ethernet protocol before onward transmission onto network 117. It is preferable that network messages sent between nodes 101 and 102 are not encapsulated for onward transmission according to the protocols in use over link 116, with the formation of the data packets being performed at node 102 by converting the network messages received in accordance with the selected protocols to data packets carrying the network messages in a form suitable for tranmission over link 116. Such conversion could be performed in hardware at a suitably programmed network interface device or other processor at node 102. In embodiments of the present invention, selection between the available physical layer protocols could be further performed in dependence on the time overhead associated with performing protocol conversion at node 102. Thus, for a given message size, the time required to perform protocol conversion would be added to the time required to establish a connection and transmit a network message to node 102.</p><p id="p0054" num="0054">In order to mitigate the time overhead associated with performing protocol conversion, it can be advantageous to arrange that node 102 store Information representing headers for data packets in accordance with the communication protocols in use over link 116. For example, if network messages are transmitted onwards over link 116 according to Ethernet/IP/UDP then information representing suitable UDP headers could be stored at node 102 ready for the moment when switch 103 connects nodes 101 and 102 together. In the example in which node 101 is a computer in a press lockup and node 102 is operated by<!-- EPO <DP n="18"> --> the owner of that press computer this can be readily arranged since the destination address of the network messages can be known to node 102. Certain fields of the headers, such as checksums, can be calculated on receiving the network message payload, as is known in the art.</p><p id="p0055" num="0055">It is advantageous if additionally or alternatively, node 101 is configured to select from a predetermined set of data compression schemes available for a given link (e.g. a deflate or LZW algorithm). Compressing a network message would typically reduce its size and hence could allow that message to be transmitted at a lower latency than would otherwise be possible once the switch connects the physical link (i.e. because there is less data to transmit and it therefore takes less time and/or because smaller messages can be selected to be sent over a connection that can be more established at a lower latency, as described above). However, the time taken to decompress each network message at node 102 must be taken into account if the net latency experienced by a given message is to be reduced. The time taken to compress a network message is not relevant since the physical link is not connected when the messages are enqueued.</p><p id="p0056" num="0056">Node 101 is therefore preferably configured to select a compression scheme (or no compression at all) in dependence on the estimated time it would take node 102 to decompress the network message. The compression scheme that is likely to allow a message to be transmitted with the lowest latency would be selected; if no compression scheme improved on the transmission latency estimated for a network message then the message would not be compressed. Most preferably, node 101 is additionally configured to perform the physical layer protocol selection of the first embodiment of the present invention so as to transmit a given network message with that selection of compression scheme and physical link that minimises the latency associated with the transmission of that message. In other words, the node 101 would be configured to select the optimum combination of physical layer protocol and compression scheme in dependence on a function of message size and decompression time.<!-- EPO <DP n="19"> --></p><p id="p0057" num="0057">Preferably node 101 stores data representing the time required to decompress network messages of varying sizes according to the available compression schemes. This data could be, for example, in the form of empirical data, algorithms or mathematical equations.</p><p id="p0058" num="0058">When the nodes are connected by switch 103, node 101 could be configured to identify the compression schemes supported by each of the links to node 102. This identification could be performed during negotiation of the connections over a link or by means of any other suitable mechanism. The data compression schemes available for a link could be determined by the communication protocols In use over that link when the link is connected. Since links 104-106 are private links with node 102 being operable to bridge the links to the wider network 117, the protocols and/or compression schemes used over the links need not adhere to the conventional set of protocols and/or compression schemes that are normally defined or used over such physical links. The protocols and/or compression schemes in use over the links could be proprietary.</p><p id="p0059" num="0059">The present invention recognises that because network messages are enqueued at the transmitting node for later (optionally scheduled) transmission, it is acceptable to perform some processing at the transmitting node so as to minimise the latency associated with transmitting network messages to the receiving node when the physical link is connected. Thus, node 101 has time to determine the best mode of transmission for each data packet. Preferably, prior to switch 103 closing and connecting the nodes together so as to allow the transmission of network messages to occur, node 101 is configured to signal to node 102 the physical layer protocol selected for each link. This can be achieved by having the switch briefly connect one or more physical links for the purpose of transmitting the selected physical layer protocol information to node 102. This allows node 101 to establish connections according to the selected protocols as soon as switch 103 closes, and without having to first wait for information identifying the selected protocols to be transmitted to node 102. Alternatively, node 101 could be configured to send a short identifier (e.g. a predetermined signal or symbol)<!-- EPO <DP n="20"> --> over each link when switch 103 closes so as to identify the selected physical layer protocol for each link to node 102.</p><p id="p0060" num="0060">It is further advantageous if, nodes 102 and 101 are configured to perform timestamping over links 104-106 so as to identify the latency associated with transmitting network messages of varying sizes between the nodes. For example, node 101 and/or 102 could be configured to form a connect timestamp when switch 103 establishes a physical link between nodes 101 and 102, and node 102 would be configured to subsequently form a receive timestamp indicating when each network message is received at node 102. This mechanism allows one or both nodes to determine the latency associated with successfully transmitting a network message of known size from node 101 to node 102 over a given link according to a given physical layer protocol. The receive timestamps could be transmitted from node 102 to node 101 so as to inform node 101 of the latency experienced by each message (this information is not latency sensitive and could be performed over any suitable link so as to not delay the communication of network messages between the nodes).</p><p id="p0061" num="0061">In the case that node 101 is configured to select between a set of compression schemes, the receive timestamp could indicate when each network message has been successfully decompressed at node 102 so as to allow node 101 to receive empirical information describing the latency experienced by the messages it has transmitted.</p><p id="p0062" num="0062">Node 101 could support a data store storing estimated latency values for eachphysical layer protocol of a predetermined set for a range of network messages sizes and optionally data compression schemes. The latency values could include, for each physical layer protocol (and optionally on a per-port basis), the time taken to establish a data connection over a link according to that protocol. The data store could also store data expressing the latency associated with message transmission - e.g. for a given line speed and protocol, the time required to transmit a network message of a given size onto the wire. The<!-- EPO <DP n="21"> --> timestamp information could be used to update the latency values at the data store, and hence can be used to inform the physical layer protocol selection (and optionally compression scheme) for each message by node 101. Alternatively or additionally, the data store could hold algorithms or mathematical equations representing estimated variation of latency values with network message size (and optionally compression scheme) for each physical layer protocol. Node 101 could be configured to form absolute values of the estimated latency for a message, or relative values expressing the relative latencies of the physical layer protocols for a given message.</p><p id="p0063" num="0063">It can be advantageous to arrange that switch 103 connect nodes 101 and 102 for the purposes of calibrating the latency values held at the data store. For example, in the case that node 101 is located in a press lock-up, switch 103 could connect nodes 101 and 102 prior to the establishment of the lock-up in order for test messages of varying sizes to be transmitted over the links 104-106 and the respective calibrated latency values to be stored at the data store. Nodes 101 and 102 could be configured to continuously update the latency values in dependence on the timestamping performed at node 102 and/or node 101.</p><p id="p0064" num="0064">Preferably node 101 is configured to enqueue the network messages in hardware, with transmit queues 120 being provided at a hardware device such as a network interface device. Such a node 101 configured in accordance with the present invention is shown in <figref idrefs="f0002">figure 2</figref>. The node comprises a data processing system 201 and a network interface device 202. The data processing system supports an operating system kernel 205 and at least one application 207. The network interface device supports a plurality of network ports 107, 108 and 109, and the transmit queues 120. Three transmit queues are shown, one for each network port, but there could be any number of queues in any suitable configuration. Typically the queues would be supported at a memory 204, which could be part of, or coupled to, an FPGA processor which could be supported at a NIC or other peripheral device. Providing the queues in hardware avoids the need for the generation of an interrupt to cause the operating system to release network<!-- EPO <DP n="22"> --> messages enqueued at software queues. This also enables the messages to be released in parallel - for example, without crossing a bus shared between network cards each supporting one or more of ports 107-109, or other devices connected to the bus.</p><p id="p0065" num="0065">Optionally, data processing system 201 supports a user-level network stack 206 configured to provide a low-latency data path to the network interface device that avoids kernel 205 (as indicated by the arrows in the figure). In alternative embodiments, transmit queues 120 could be software queues supported on the low latency data path - this at least provides a lower latency transmit path (compared to a conventional kernel-mediated transmit path) once the switch connects node 101 across air gap 203 to the network.</p><p id="p0066" num="0066">Preferably nodes 101 and 102 have a number of ports operable to support between them multiple parallel links configured according to the same physical layer protocols. It is in this case advantageous if node 101 is configured to duplicate each network message to be transmitted over a link of a given type and transmit a copy of the network message over two or more links of that type supporting the same physical layer protocol. This can be achieved by enqueueing network messages at transmit queues corresponding to multiple links. It is most preferable if the messages are queued in hardware, as described above. Duplicating messages over multiple links builds in redundancy so as to avoid lost packets causing significant delays to the time required to successfully transmit a network message between the nodes (e.g. while retransmission of the packet(s) occurs).</p><p id="p0067" num="0067">Furthermore, for scenarios in which there are multiple pairs of nodes 101 and 102 connected across switch 103 (such as the case in which node 101 is one of several press computers held in a lock-up), the variation in the time taken for a connection to be established over physical links of the same type becomes the dominant contribution to the variation in the time taken for each originating node (e.g. node 101) to transmit its message(s). The variation in the time taken for a<!-- EPO <DP n="23"> --> connection to be established over a physical link arises because the time required to negotiate the necessary physical and logical layer connections over a link of a given type when switch 103 closes displays inherent random variation. For commonly deployed physical layer switches, this variation is of the order of 1 ms. By arranging that a network node enqueue a network message for simultaneous transmission over all of the links of the selected type, this variation can be minimised because each message has the opportunity to travel over the link that first establishes the connection for that node.</p><p id="p0068" num="0068">It is generally not preferable to allow duplicate messages to be transmitted onwards from node 102. Preferably node 102 is therefore configured to remove duplicate messages that arrive after the first network message. In this manner, only the first network message to arrive is retained and transmitted onwards onto network 117. Preferably the removal of duplicate messages is performed in hardware (e.g. at a network interface device of node 102) so as to minimise the latency Introduced by the processing overhead associated with the removal of duplicate messages.</p><p id="p0069" num="0069">It can be advantageous to duplicate messages over links of different types (for example, an RS-485 serial link and a 10GBASE-CR Ethernet link) In order to reduce the possiblity of a network message being dropped. In other words, the redundancy benefits can be achieved even if the network messages are sent over different types of link. In this case, node 101 would be configured to transmit information to node 102 sufficient to allow node 102 to identify each set of duplicate messages sent over links of different types. Preferably, node 101 would be configured to encapsulate each network message with a sequence number such that when that encapsulated network message is sent over multiple links, each of the duplicated messages share that same sequence number. This allows node 102 to filter out duplicate messages without being required to reassemble each network message in order to determine whether that message has already been received. Node 102 would preferably be configured to remove the<!-- EPO <DP n="24"> --> encapsulation prior to transmitting onto network 117 the first-received of each network message.</p><p id="p0070" num="0070">In embodiments of the present invention, all of the physical links 104-106 between the nodes 101 and 102 could be arranged to support the same physical layer protocol, with each network message being sent over two or more such links. Such embodiments would provide the advantages discussed above without the requirement for the nodes to support links of different types. Node 102 would preferably be configured to remove duplicate messages that arrive after the first network message.</p><p id="p0071" num="0071">In all embodiments of the present invention it is advantageous if the transmitting and receiving nodes 101 and 102 are configured to store state of a physical layer connection so as to allow that connection to be re-established when the underlying physical link is connected by the switch without requiring initial re-negotiation of the link. If the connection cannot be reestablished the link can fall back to performing a conventional negotiation of physical parameters for the connection. For example, in the case of an Ethernet link there is an established initial negotiation of the parameters of a link to adapt the link to the physical characteristics of the communication channel (e.g. length, cable quality, bending, ambient noise). With Ethernet the negotiating nodes may also exchange parameters that should be used to assist signal processing; e.g. 10GBASE-T contains an encoding at the transmitter which requires that the receiver understand the encoding coefficients. By arranging that nodes 101 and 102 store those parameters the nodes can be enabled to more rapidly reinstate a connection when the physical link is reconnected by switch 103 because the initial negotiation of the physical parameters of the physical layer connection is not required and can be omitted.</p><p id="p0072" num="0072">When the physical link is re-connected, the nodes can attempt to re-establish the physical layer connection (assuming it remains of the same protocol) by using the set of stored parameters describing the state of the connection. Some signalling<!-- EPO <DP n="25"> --> would generally be necessary in order to re-establish a connection but there would be no need to negotiate the line speed or other physical layer protocol options. This mechanism can be further used to omit the negotiation of link speed during establishment of a physical layer connection for protocols that support mutiple link speeds. Since it can be known in advance the link speed that can be supported over links 104-106 for the various physical layer protocols, the nodes 101 and 102 can be configured to omit the negotiation of link speed during re-establishmend of a connection and instead bring up the link at a pre-determined line speed.</p><p id="p0073" num="0073">A network interface device as described herein could be any suitable device, such as a peripheral card or a LAN-on-motherboard (LOM) device. The ports of each node would typically be provided at a network interface device. For example, a NIC might provide a set of conventional 10GBASE-CR ports and be coupled to a daughterboard supporting an FPGA configured to provide a set of RS-485 serial ports.</p><p id="p0074" num="0074">The network nodes described herein could be any kind of data processing system, such as a server, personal computer, or a logical switch (e.g. a layer 2 switch).</p><p id="p0075" num="0075">The applicant hereby discloses in isolation each individual feature described herein and any combination of two or more such features, to the extent that such features or combinations are capable of being carried out based on the present specification as a whole in the light of the common general knowledge of a person skilled in the art, irrespective of whether such features or combinations of features solve any problems disclosed herein, and without limitation to the scope of the claims. The applicant indicates that aspects of the present invention may consist of any such individual feature or combination of features. In view of the foregoing description it will be evident to a person skilled in the art that various modifications may be made within the scope of the invention.<!-- EPO <DP n="26"> --></p><p id="p0076" num="0076">The present invention is further described in Annex A. The numbered paragraphs of the Annex describe the present invention in terms of exemplary combinations of features.<!-- EPO <DP n="27"> --></p><heading id="h0005"><b>ANNEX A</b></heading><p id="p0077" num="0077"><ol><li>1. A data processing system comprising:
<ul><li>first and second network ports each operable to support a network connection configured according to one or more of a predetermined set of physical layer protocols; and</li><li>a processor configured to, on a network message being formed for transmission to a network endpoint accessible over either of the first and second network ports:
<ul><li>estimate the total time required to, for each of the predetermined set of physical layer protocols, negotiate a respective network connection and transmit the network message over that respective network connection;</li><li>select the physical layer protocol having the lowest estimate of the total time required to negotiate a respective network connection and transmit the entire network message over that respective network connection; and</li><li>configure at least one of the first and second network ports to use the selected physical layer protocol.</li></ul></li></ul></li><li>2. A data processing system as in paragraph 1, wherein the processor is operable to, on a physical link being made to the first and second network ports a first time, cause the data processing system to signal over each of the at least one or the first and second network ports the identity of the selected physical layer protocol for use over those respective links on those physical links being made a subsequent time.</li><li>3. A data processing system as in paragraph 1 or 2, wherein the processor is further configured to enqueue the network message at a transmit queue of each of the at least one of the first and second network ports such that, on a physical link being made to the respective network ports, the network message is transmitted from each of the at least one of the first and second network ports<!-- EPO <DP n="28"> --> over a network connection established according to the selected physical layer protocol.</li><li>4. A data processing system as in any preceding paragraph, wherein the transmit queue(s) are supported in hardware at network interface device(s) providing the respective at least one of the first and second network ports.</li><li>5. A data processing system as in any preceding paragraph, further comprising a data store comprising data from which the processor is configured to estimate the total times.</li><li>6. A data processing system as in paragraph 5, wherein the data store comprises estimates of the time required to negotiate network connections over the first and second network ports according to each of the predetermined set of physical layer protocols.</li><li>7. A data processing system as in paragraph 6, wherein estimates of the time required to negotiate network connections over the first and second network ports represent estimates of the total time required to establish physical layer and data link layer connections.</li><li>8. A data processing system as in any of paragraphs 5 to 7, wherein the data store comprises data representing the time required to transmit the network message as a function of network message size over network connections configured according to each of the predetermined set of physical layer protocols.</li><li>9. A data processing system as in paragraph 8, wherein the time required to transmit the network message over network connections configured according to each of the predetermined set of physical layer protocols comprises the total time required to transmit the entire network message over the respective network port.<!-- EPO <DP n="29"> --></li><li>10. A data processing system as in any preceding paragraph, wherein the processor is configured to apply the selected physical layer protocol to both the first and second network ports and enqueue copies of the network message at a transmit queue corresponding to each of the first and second network ports such that, on physical links being made to the first and second network ports, the network message is transmitted in parallel over the physical links.</li><li>11. A data processing system as in any preceding paragraph, wherein the at least some of the physical layer protocols of the predetermined set of physical layer protocols are of the same type of physical layer protocol but defined so as to operate at different line speeds.</li><li>12. A data processing system as in any preceding paragraph, wherein the at least some of the physical layer protocols of the predetermined set of physical layer protocols are of the same type of physical layer protocol but defined so as to operate with different compression schemes, and the estimate of the time required to, for each of the predetermined set of physical layer protocols, transmit the entire network message over that respective network connection includes the time required to decompress the network message were it compressed in accordance the compression scheme of the respective physical layer protocol.</li><li>13. A data processing system as in paragraph 12, wherein the compression schemes include deflate, LZW, and no compression.</li><li>14. A data processing system as in paragraph 12 or 13 as dependent on paragraph 5, wherein the data store further comprises data from which the processor is configured to calculate the time required to decompress the network message in accordance with each of the compression schemes of the predetermined set of physical layer protocols.</li><li>15. A data processing system as in any preceding paragraph, wherein the processor is configured to perform the selection of the physical layer protocol<!-- EPO <DP n="30"> --> independently of the type of physical interfaces of the one or more physical links, the processor being operable to select any of the set of physical layer protocols for use over any of the plurality of physical links.</li><li>16. A data processing system as in paragraph 15, wherein the selected physical layer protocol for a given network port is any of 100BASE-TX, 10GBASE-T and Serial RS-485, and the physical interface of that network port is Ethernet RJ45.</li><li>17. A data processing system as in any preceding paragraph, wherein the processor is supported at a network interface device of the data processing system, the processor optionally being implemented within an FPGA.</li><li>18. A system for communicating network messages between a pair of network nodes separated by a physical layer switch, the system comprising:
<ul><li>a first network node having a first plurality of network ports connected to a physical layer switch; and</li><li>a second network node having a second plurality of network ports connected to the physical layer switch and separated from the first network node by the physical layer switch;<br/>
wherein each of the first and second pluralities of network ports are operable to support a network connection configured according to one or more of a predetermined set of physical layer protocols and each of the first plurality of physical ports is arranged to correspond to one of the second plurality of physical ports such that, in a first mode, the physical layer switch is operable to simultaneously provide a physical link between each of the first plurality of physical ports and its corresponding one of the second plurality of physical ports and, in a second mode, the physical layer switch is operable to simultaneously isolate each of the first plurality of physical ports from its corresponding one of the second plurality of physical ports;<br/>
the first network node being configured to, on forming a network message for transmission to a network endpoint accessible over the plurality of physical links:<!-- EPO <DP n="31"> -->
<ul><li>estimate the total time required to, for each of the predetermined set of physical layer protocols, negotiate a respective network connection and transmit the entire network message over that respective network connection;</li><li>select the physical layer protocol having the lowest estimate of the total time required to negotiate a respective network connection and transmit the entire network message over that respective network connection; and</li><li>cause the network message to, on the physical layer switch entering its first mode, be transmitted over one or more physical links configured in accordance with the selected physical layer protocol.</li></ul></li></ul></li><li>19. A data processing system as in paragraph 18, wherein the first network node is configured to select the one or more physical links by:
<ul><li>selecting one physical link at random;</li><li>selecting all those physical links capable of supporting a network connection configured in accordance with the select physical layer protocol; or</li><li>selecting those physical links that offer the lowest estimate of the total time required to, for the selected physical layer protocol, negotiate a respective network connection and transmit the entire network message over that respective network connection.</li></ul></li><li>20. A data processing system as in paragraph 18 or 19, wherein the first network node is operable to, on the physical layer switch entering its first mode a first time, signal over the one or more physical links to the second network node the identity of the selected physical layer protocol, the first and second network nodes being configured to use the selected physical layer protocol over the one or more physical links on the physical layer switch entering its first mode made a subsequent time.</li><li>21. A data processing system as in any of paragraphs 18 to 20, wherein the first network node is further configured to enqueue the network message at a transmit<!-- EPO <DP n="32"> --> queue of each of the one or more physical links such that, on the physical layer switch entering its first mode, the network message is transmitted over the one or more physical links in accordance with the selected physical layer protocol.</li><li>22. A data processing system as in any of paragraphs 18 to 21, wherein each of the transmit queue(s) is supported in hardware at a network interface device, each transmit queue being at that network interface device providing the network port corresponding to the respective one of the one or more physical links.</li><li>23. A data processing system as in any of paragraphs 18 to 22, wherein the first network node is configured to apply the selected physical layer protocol to two or more physical links and to enqueue copies of the network message at transmit queues corresponding to each of the two or more physical links such that, on the physical layer switch entering its first mode, the network message is transmitted in parallel over the physical links.</li><li>24. A data processing system as in paragraph 23, wherein the second network node is configured to, on receiving copies of the network message over the two or more physical links, keep only that network message received first at the second network node and to discard all those copies of the network message that are subsequently received.</li><li>25. A data processing system as in paragraph 24, wherein the first network node is configured to include a sequence number with each network message it transmits such that duplicate network messages all sharing the same sequence number, and the second network node is configured to use the sequence number to identify duplicate network messages that are to be discarded.</li><li>26. A data processing system as in any of paragraphs 18 to 25, wherein the at least some of the physical layer protocols of the predetermined set of physical layer protocols are of the same type of physical layer protocol but defined so as to operate at different line speeds.<!-- EPO <DP n="33"> --></li><li>27. A data processing system as in any of paragraphs 18 to 26, wherein the at least some of the physical layer protocols of the predetermined set of physical layer protocols are of the same type of physical layer protocol but defined so as to operate with different compression schemes, and the estimate of the time required to, for each of the predetermined set of physical layer protocols, transmit the entire network message over that respective network connection includes the time required to decompress the network message were it compressed in accordance the compression scheme of the respective physical layer protocol.</li><li>28. A data processing system as in paragraph 27, wherein the compression schemes include deflate, LZW, and no compression.</li><li>29. A data processing system as in any of paragraphs 18 to 28, wherein the selection of the physical layer protocol by the first network node is performed independently of the type of physical interfaces of the one or more physical links, the first network node is operable to select any of the set of physical layer protocols for use over any of the plurality of physical links.</li><li>30. A data processing system as in paragraph 29, wherein the selected physical layer protocol for a given physical link is any of 100BASE-TX, 10GBASE-T and Serial RS-485, and the physical interfaces of that physical link are Ethernet RJ45.</li><li>31. A data processing system as In any of paragraphs 18 to 30, wherein the second network node further provides a link to a data network over which the destination network endpoint of the network message is accessible, the data network supporting communications according to a predetermined set of communication protocols, and the second network node is configured to convert the network message into data packets formed in accordance with the predetermined set of communication protocols.<!-- EPO <DP n="34"> --></li><li>32. A data processing system as in paragraph 31, wherein the second network node is configured to store information representing headers for the data packets formed in accordance with the predetermined set of communication protocols such that the second network node is operable to convert the network message into data packets without requiring substantial generation of the headers of the data packets in accordance with the predetermined set of communication protocols.</li><li>33. A data processing system as in any of paragraphs 18 to 32, wherein the first or second network node is configured to form a first timestamp on the physical layer switch entering its first mode and the second network node is configured to form a second timestamp on the network message being received at the second network node, the first or second network node being configured to estimate from the time elapsed between the first and second timestamps the latency in the transmission of the network message.</li><li>34. A data processing system as in any of paragraphs 18 to 33, further comprising a data store comprising data from which the first network node is configured to estimate the total times.</li><li>35. A data processing system as in paragraph 34 as dependent on paragraph 33, wherein the first network node is further operable to update data stored at its data store in response to the estimate of the latency in the transmission of the network message.</li><li>36. A data processing system as in any of paragraphs 18 to 35, wherein the first and second network nodes are configured to, on the physical layer switch entering its first mode so as to permit transmission of the network message over the one or more physical links, establish according to the selected physical layer protocol a physical layer connection over at least some of the one or more physical links without substantial re-negotiation of the link parameters of those physical links by using, for each of the at least some of the one or more physical links, a set of<!-- EPO <DP n="35"> --> stored link parameters defining a previously successful physical layer connection over the respective physical link.</li><li>37. A system for communicating network messages between a pair of network nodes separated by a physical layer switch, the system comprising:
<ul><li>a first network node having a first plurality of network ports connected to a physical layer switch; and</li><li>a second network node having a second plurality of network ports connected to the physical layer switch and separated from the first network node by the physical layer switch;<br/>
wherein each of the first and second pluralities of network ports are operable to support a network connection configured according to one or more of a predetermined set of physical layer protocols and each of the first plurality of physical ports is arranged to correspond to one of the second plurality of physical ports such that, In a first mode, the physical layer switch is operable to simultaneously provide a physical link between each of the first plurality of physical ports and its corresponding one of the second plurality of physical ports and, in a second mode, the physical layer switch is operable to simultaneously isolate each of the first plurality of physical ports from its corresponding one of the second plurality of physical ports;</li><li>the first network node being configured to, on the physical layer switch entering the first mode, transmit duplicate network messages over two or more of the physical links in accordance with a selected one of the predetermined set of physical layer protocols, and</li><li>the second network node being configured to, on receiving said duplicate network messages, discard all those duplicate network messages except the first received network message.</li></ul></li><li>38. A system as in paragraph 37, wherein the first network node is configured to include a sequence number with each network message it transmits such that duplicate network messages all sharing the same sequence number, and the<!-- EPO <DP n="36"> --> second network node is configured to use the sequence number to identify duplicate network messages that are to be discarded.</li><li>39. A system for communicating network messages between a pair of network nodes separated by a physical layer switch, the system comprising:
<ul><li>a first network node; and</li><li>a second network node separated from the first network node by a physical layer switch;<br/>
wherein the physical layer switch is operable to switch between first and second modes: in the first mode the physical layer switch providing a physical connection between the first and second network nodes, and in the second mode the physical layer switch isolating the first network node from the second network node;<br/>
the first and second network nodes being configured to, on the physical layer switch entering the first mode for a first time:</li><li>establish one or more physical layer links between the first and second network nodes, the parameters of each link being negotiated between the first and second network nodes; and</li><li>store said parameters of each of the one or more physical layer links;<br/>
the first and second network nodes being configured to, on the physical layer switch subsequently entering the first mode from the second mode:</li><li>read the stored parameters; and</li><li>re-establish the one or more physical layer links between the first and second network nodes using the stored parameters without substantial re-negotiation of the link parameters.</li></ul></li></ol></p></description><claims mxw-id="PCLM56982312" lang="EN" load-source="patent-office"><!-- EPO <DP n="37"> --><claim id="c-en-0001" num="0001"><claim-text>A data processing system comprising:
<claim-text>first and second network ports each operable to support a network connection configured according to one or more of a predetermined set of physical layer protocols; and</claim-text>
<claim-text>a processor configured to, on a network message being formed for transmission to a network endpoint accessible over either of the first and second network ports:
<claim-text>estimate the total time required to, for each of the predetermined set of physical layer protocols, negotiate a respective network connection and transmit the network message over that respective network connection;</claim-text>
<claim-text>select the physical layer protocol having the lowest estimate of the total time required to negotiate a respective network connection and transmit the entire network message over that respective network connection; and</claim-text>
<claim-text>configure at least one of the first and second network ports to use the selected physical layer protocol.</claim-text></claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>A data processing system as claimed in claim 1, wherein the processor is operable to, on a physical link being made to the first and second network ports a first time, cause the data processing system to signal over each of the at least one or the first and second network ports the identity of the selected physical layer protocol for use over those respective links on those physical links being made a subsequent time.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>A data processing system as claimed in claim 1 or 2, wherein the processor is further configured to enqueue the network message at a transmit queue of each of the at least one of the first and second network ports such that, on a physical link being made to the respective network ports, the network message is transmitted from each of the at least one of the first and second network ports<!-- EPO <DP n="38"> --> over a network connection established according to the selected physical layer protocol.</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>A data processing system as claimed in any preceding claim, wherein the transmit queue(s) are supported in hardware at network interface device(s) providing the respective at least one of the first and second network ports.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>A data processing system as claimed in any preceding claim, further comprising a data store comprising data from which the processor is configured to estimate the total times.</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>A data processing system as claimed in claim 5, wherein the data store comprises one or both of:
<claim-text>estimates of the time required to negotiate network connections over the first and second network ports according to each of the predetermined set of physical layer protocols; and</claim-text>
<claim-text>data representing the time required to transmit the network message as a function of network message size over network connections configured according to each of the predetermined set of physical layer protocols.</claim-text></claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>A data processing system as claimed in any preceding claim, wherein the processor is configured to apply the selected physical layer protocol to both the first and second network ports and enqueue copies of the network message at a transmit queue corresponding to each of the first and second network ports such that, on physical links being made to the first and second network ports, the network message is transmitted in parallel over the physical links.</claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>A data processing system as claimed in any preceding claim, wherein the at least some of the physical layer protocols of the predetermined set of physical layer protocols are of the same type of physical layer protocol but defined so as to operate at different line speeds.<!-- EPO <DP n="39"> --></claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>A data processing system as claimed in any preceding claim, wherein the at least some of the physical layer protocols of the predetermined set of physical layer protocols are of the same type of physical layer protocol but defined so as to operate with different compression schemes, and the estimate of the time required to, for each of the predetermined set of physical layer protocols, transmit the entire network message over that respective network connection includes the time required to decompress the network message were it compressed in accordance the compression scheme of the respective physical layer protocol.</claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>A data processing system as claimed in claim 9, wherein the compression schemes include deflate, LZW, and no compression.</claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>A data processing system as claimed in claim 9 or 10 as dependent on claim 5, wherein the data store further comprises data from which the processor is configured to calculate the time required to decompress the network message in accordance with each of the compression schemes of the predetermined set of physical layer protocols.</claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>A data processing system as claimed in any preceding claim, wherein the processor is configured to perform the selection of the physical layer protocol independently of the type of physical interfaces of the one or more physical links, the processor being operable to select any of the set of physical layer protocols for use over any of the plurality of physical links.</claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>A data processing system as claimed in claim 12, wherein the selected physical layer protocol for a given network port is any of 100BASE-TX, 10GBASE-T and Serial RS-485, and the physical interface of that network port is Ethernet RJ45.</claim-text></claim><claim id="c-en-0014" num="0014"><claim-text>A data processing system as claimed in any preceding claim, wherein the processor is supported at a network interface device of the data processing system, the processor optionally being implemented within an FPGA.</claim-text></claim></claims><drawings mxw-id="PDW16670694" load-source="patent-office"><!-- EPO <DP n="40"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="109" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="41"> --><figure id="f0002" num="2,3"><img id="if0002" file="imgf0002.tif" wi="156" he="233" img-content="drawing" img-format="tif"/></figure></drawings><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
