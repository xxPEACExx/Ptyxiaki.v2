<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2681901-A2" country="EP" doc-number="2681901" kind="A2" date="20140108" family-id="46028000" file-reference-id="315082" date-produced="20180823" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146586387" ucid="EP-2681901-A2"><document-id><country>EP</country><doc-number>2681901</doc-number><kind>A2</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12719045-A" is-representative="NO"><document-id mxw-id="PAPP154848579" load-source="docdb" format="epo"><country>EP</country><doc-number>12719045</doc-number><kind>A</kind><date>20120302</date><lang>EN</lang></document-id><document-id mxw-id="PAPP197861086" load-source="docdb" format="original"><country>EP</country><doc-number>12719045.2</doc-number><date>20120302</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140552547" ucid="IB-2012000389-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>IB</country><doc-number>2012000389</doc-number><kind>W</kind><date>20120302</date></document-id></priority-claim><priority-claim mxw-id="PPC140557298" ucid="JP-2011048020-A" load-source="docdb"><document-id format="epo"><country>JP</country><doc-number>2011048020</doc-number><kind>A</kind><date>20110304</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1839983092" load-source="docdb">H04L   9/32        20060101ALI20170224BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1839984048" load-source="docdb">H04L  29/08        20060101ALI20170224BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1839988707" load-source="docdb">H04L  12/403       20060101AFI20170224BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1839989225" load-source="docdb">H04L  29/06        20060101ALI20170224BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1839989871" load-source="docdb">H04L  12/40        20060101ALI20170224BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1939983975" load-source="docdb" scheme="CPC">H04L   9/3242      20130101 LI20160507BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1939985969" load-source="docdb" scheme="CPC">H04L   9/3247      20130101 LI20160507BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1939987096" load-source="docdb" scheme="CPC">H04L  63/0869      20130101 LI20160507BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1939988202" load-source="docdb" scheme="CPC">H04L2209/84        20130101 LA20160507BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1939988203" load-source="docdb" scheme="CPC">H04L  12/403       20130101 LI20160507BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1939988631" load-source="docdb" scheme="CPC">H04L  63/123       20130101 LI20160507BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1939989551" load-source="docdb" scheme="CPC">H04L2012/40273     20130101 LA20160507BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1939990181" load-source="docdb" scheme="CPC">H04L  63/0442      20130101 LI20160507BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1939990327" load-source="docdb" scheme="CPC">H04L2012/40215     20130101 LA20160507BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1939990392" load-source="docdb" scheme="CPC">H04L  67/12        20130101 LI20160507BHEP        </classification-cpc><classification-cpc mxw-id="PCL2007296017" load-source="docdb" scheme="CPC">H04L  63/06        20130101 FI20140130BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132363794" lang="DE" load-source="patent-office">FAHRZEUGNETZWERKSYSTEM</invention-title><invention-title mxw-id="PT132363795" lang="EN" load-source="patent-office">VEHICLE NETWORK SYSTEM</invention-title><invention-title mxw-id="PT132363796" lang="FR" load-source="patent-office">SYSTÈME DE RÉSEAU POUR VÉHICULE</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR919540442" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>TOYOTA MOTOR CO LTD</last-name><address><country>JP</country></address></addressbook></applicant><applicant mxw-id="PPAR919518376" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>TOYOTA JIDOSHA KABUSHIKI KAISHA</last-name></addressbook></applicant><applicant mxw-id="PPAR919008384" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Toyota Jidosha Kabushiki Kaisha</last-name><iid>101030285</iid><address><street>1 Toyota-cho,</street><city>Toyota-shi, Aichi-ken 471-8571</city><country>JP</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919543981" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>KOIDE SHOHEI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR919510411" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>KOIDE, SHOHEI</last-name></addressbook></inventor><inventor mxw-id="PPAR919007911" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>KOIDE, SHOHEI</last-name><address><street>c/o TOYOTA JIDOSHA KABUSHIKI KAISHA of 1 Toyota-cho Toyota-shi</street><city>Aichi-ken 471 -8571</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR919536012" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>NINAGAWA YUJI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR919508537" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>NINAGAWA, YUJI</last-name></addressbook></inventor><inventor mxw-id="PPAR919017000" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>NINAGAWA, YUJI</last-name><address><street>c/o TOYOTA JIDOSHA KABUSHIKI KAISHA of 1 Toyota-cho Toyota-shi</street><city>Aichi-ken 471 -8571</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR919537541" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>INOUE NORIAKI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR919535164" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>INOUE, NORIAKI</last-name></addressbook></inventor><inventor mxw-id="PPAR919018948" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>INOUE, NORIAKI</last-name><address><street>c/o TOYOTA JIDOSHA KABUSHIKI KAISHA of 1 Toyota-cho Toyota-shi</street><city>Aichi-ken 471 -8571</city><country>JP</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR919006351" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Winter, Brandl, Fürniss, Hübner, Röss, Kaiser, Polte - Partnerschaft</last-name><iid>101349498</iid><address><street>Patent- und Rechtsanwaltskanzlei Bavariaring 10</street><city>80336 München</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="IB-2012000389-W"><document-id><country>IB</country><doc-number>2012000389</doc-number><kind>W</kind><date>20120302</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012120350-A2"><document-id><country>WO</country><doc-number>2012120350</doc-number><kind>A2</kind><date>20120913</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS549759978" load-source="docdb">AL</country><country mxw-id="DS549770257" load-source="docdb">AT</country><country mxw-id="DS549759979" load-source="docdb">BE</country><country mxw-id="DS549760331" load-source="docdb">BG</country><country mxw-id="DS549837538" load-source="docdb">CH</country><country mxw-id="DS549914634" load-source="docdb">CY</country><country mxw-id="DS549770258" load-source="docdb">CZ</country><country mxw-id="DS549759980" load-source="docdb">DE</country><country mxw-id="DS549914635" load-source="docdb">DK</country><country mxw-id="DS549914636" load-source="docdb">EE</country><country mxw-id="DS549838029" load-source="docdb">ES</country><country mxw-id="DS549760332" load-source="docdb">FI</country><country mxw-id="DS549838204" load-source="docdb">FR</country><country mxw-id="DS549759985" load-source="docdb">GB</country><country mxw-id="DS549914637" load-source="docdb">GR</country><country mxw-id="DS549759986" load-source="docdb">HR</country><country mxw-id="DS549770259" load-source="docdb">HU</country><country mxw-id="DS549837539" load-source="docdb">IE</country><country mxw-id="DS549914638" load-source="docdb">IS</country><country mxw-id="DS549838205" load-source="docdb">IT</country><country mxw-id="DS549914639" load-source="docdb">LI</country><country mxw-id="DS549760337" load-source="docdb">LT</country><country mxw-id="DS549851576" load-source="docdb">LU</country><country mxw-id="DS549760338" load-source="docdb">LV</country><country mxw-id="DS549760339" load-source="docdb">MC</country><country mxw-id="DS549851577" load-source="docdb">MK</country><country mxw-id="DS549851594" load-source="docdb">MT</country><country mxw-id="DS549838042" load-source="docdb">NL</country><country mxw-id="DS549838210" load-source="docdb">NO</country><country mxw-id="DS549851595" load-source="docdb">PL</country><country mxw-id="DS549837540" load-source="docdb">PT</country><country mxw-id="DS549838043" load-source="docdb">RO</country><country mxw-id="DS549837541" load-source="docdb">RS</country><country mxw-id="DS549851596" load-source="docdb">SE</country><country mxw-id="DS549759987" load-source="docdb">SI</country><country mxw-id="DS549838211" load-source="docdb">SK</country><country mxw-id="DS549851597" load-source="docdb">SM</country><country mxw-id="DS549914640" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA100070942" ref-ucid="WO-2012120350-A2" lang="EN" load-source="patent-office"><p num="0000">In a vehicle network system, a plurality of ECUs are network-connected. The plurality of ECUs include a first ECU (20) that has set therein a secret key (Kl) from among the secret key (K1) and a public key (K2) that form a pair and are set on the basis of initialization processing performed when the vehicle network system is created, and a second ECU (21) that has set therein the public key (K2). The second ECU (21) adds, to a transmission signal, an authentication keyword (43) created from the public key (K2) and information capable of specifying the second ECU (21) and transmits the transmission signal with the authentication keyword added thereto to the network (29). The first ECU (20) acquires the authentication keyword (43) and estimates the reliability of the communication signal on the basis of the acquired authentication key word (43) and the secret key (K1).</p></abstract><abstract mxw-id="PA100339005" ref-ucid="WO-2012120350-A2" lang="EN" source="national office" load-source="docdb"><p>In a vehicle network system, a plurality of ECUs are network-connected. The plurality of ECUs include a first ECU (20) that has set therein a secret key (Kl) from among the secret key (K1) and a public key (K2) that form a pair and are set on the basis of initialization processing performed when the vehicle network system is created, and a second ECU (21) that has set therein the public key (K2). The second ECU (21) adds, to a transmission signal, an authentication keyword (43) created from the public key (K2) and information capable of specifying the second ECU (21) and transmits the transmission signal with the authentication keyword added thereto to the network (29). The first ECU (20) acquires the authentication keyword (43) and estimates the reliability of the communication signal on the basis of the acquired authentication key word (43) and the secret key (K1).</p></abstract><abstract mxw-id="PA100070943" ref-ucid="WO-2012120350-A2" lang="FR" load-source="patent-office"><p num="0000">L'invention concerne un système de réseau pour véhicule comprenant une pluralité d'unités de commande électroniques (ECU) connectées en réseau. La pluralité d'unités de commande électroniques comprend une première unité de commande électronique (20) dans laquelle est installée une clé secrète (KI) créée à partir de la clé secrète (K1) et d'une clé publique (K2) formant une paire et établies sur la base du processus d'initialisation exécuté lorsque le système de réseau pour véhicule est crée, et une seconde unité de commande électronique (21) dans laquelle est installée la clé publique (K2). La seconde unité de commande électronique (21) ajoute à un signal de transmission un mot-clé d'authentification (43) créé à partir de la clé publique (K2) et des informations décrivant la seconde unité de commande électronique (21) puis elle transmet le signal de transmission auquel est ajouté le mot-clé d'authentification vers le réseau (29). La première unité de commande (20) obtient le mot-clé d'authentification (43) puis elle estime la fiabilité du signal de communication sur la base du mot-clé d'authentification (43) obtenu et de la clé secrète (K1).</p></abstract><abstract mxw-id="PA100339006" ref-ucid="WO-2012120350-A2" lang="FR" source="national office" load-source="docdb"><p>L'invention concerne un système de réseau pour véhicule comprenant une pluralité d'unités de commande électroniques (ECU) connectées en réseau. La pluralité d'unités de commande électroniques comprend une première unité de commande électronique (20) dans laquelle est installée une clé secrète (KI) créée à partir de la clé secrète (K1) et d'une clé publique (K2) formant une paire et établies sur la base du processus d'initialisation exécuté lorsque le système de réseau pour véhicule est crée, et une seconde unité de commande électronique (21) dans laquelle est installée la clé publique (K2). La seconde unité de commande électronique (21) ajoute à un signal de transmission un mot-clé d'authentification (43) créé à partir de la clé publique (K2) et des informations décrivant la seconde unité de commande électronique (21) puis elle transmet le signal de transmission auquel est ajouté le mot-clé d'authentification vers le réseau (29). La première unité de commande (20) obtient le mot-clé d'authentification (43) puis elle estime la fiabilité du signal de communication sur la base du mot-clé d'authentification (43) obtenu et de la clé secrète (K1).</p></abstract><description mxw-id="PDES51373329" ref-ucid="WO-2012120350-A2" lang="EN" load-source="patent-office"><!-- EPO <DP n="3"/>--><p id="p0001" num="0001"> VEHICLE NETWORK SYSTEM </p><p id="p0002" num="0002">BACKGROUND OF THE INVENTION 1. Field of the Invention </p><p id="p0003" num="0003"> [0001] The invention relates to vehicle network system in which a plurality of electronic control units installed on a vehicle are network-connected to each other and exchange information. 2. Description of Related Art </p><p id="p0004" num="0004"> [0002] By connecting a plurality of electronic control units (ECUs) installed on a vehicle to each other via network, it is possible to configure a vehicle network system that will enable the exchange of information (vehicle information) possessed by the ECUs. In such vehicle network system, vehicle information usually can be easily exchanged between the network-connected ECUs. Meanwhile, it is also easy to detach, by mistake or intentionally, a device connected to the network or attach, by mistake or intentionally, a device to the network. Thus, where a device is unexpectedly detached from the network or an unanticipated device is attached to the network, unauthorized access to the network can occur or the exchange of vehicle information can be affected. Accordingly, Japanese Patent Application Publication No. 2005-1534 (JP 2005-1534 A) describes an example of a system that can be adapted to the case where an ECU constituting a vehicle network system is removed by detachment or the like. </p><p id="p0005" num="0005"> [0003] In the system described in JP 2005-1534 A, a vehicle network system is assumed in which, for example, a communication ECU, an engine ECU, a car navigation ECU, and an air conditioner ECU are communicatively connected to each other by a network (communication lines). Because of connection recognition performed by each. ECU in such system, when connection with any ECU (installed device) is detected to be abnormal, the operation of this device or other ECU (installed device) is stopped. Thus, 
<!-- EPO <DP n="4"/>-->
 when any installed device is detached from the vehicle, other installed devices are prevented from operating normally as a device group. As a result, an unauthorized action including the detachment of devices, that is, the vehicle theft in this case, is effectively prevented. </p><p id="p0006" num="0006"> [0004] Thus, the system described in JP 2005-1534 A can be adapted to the case where a device is detached, but can not be necessarily adapted adequately to the case in which an unauthorized device is added. Therefore, the system cannot ensure security against frequent unauthorized access associated with the addition of devices, such as replay attack in which aliases generated by an unauthorized use of normal signals that have been transmitted to the network are transmitted to the network. </p><p id="p0007" num="0007"> [0005] For example, in a control area network (CAN), which is often used as a vehicle network, a transmitting device transmits signals assigned with an identifier (CAN ID) that has been allocated to the transmitting device, and a receiving device determines the device that has transmitted the signal and the contents of the signal on the basis of the identifier added to the signal. In a case where a transmission signal TD110 including an identifier "XX" and data "123... " is outputted from an ECU A110 as a transmitting device to a network 120, as shown in FIG. 12A, an ECUJB111, an ECU_C112, and an ECU_N113 are function as receiving devices usually obtain reception signals D111 to RD113 including the identifier "XX" and data "123..." that are based on the transmission signal TD110. Meanwhile, where a improper ECU A130 is connected to a network system 100, as shown in FIG. 12B, the improper ECU_A130 can output a transmission signal TD130 including improper data "999..." by using the identifier "XX" used by the ECU A110, which is a normal transmitting device. As a result, the ECU Bl l l , ECU C112, and ECU_N113 obtain reception signals RD131 to D133 including the identifier "XX" and improper data "999...". In this case, although the transmission signal is that of the improper ECU_A130, the ECUJB111, ECU_C112, and ECU_N113 determine that this signal is from the ECU_A110 and perform processing based on the improper data. Thus, by an unauthorized access to the network system 100 constituted by the CAN, the improper ECU_A130 can pretend to be the normal ECU A110, and 
<!-- EPO <DP n="5"/>-->
 following recent progress in the field of networking, this also becomes a problem for vehicles. </p><p id="p0008" num="0008"> [0006] In a system with high processing capacity of devices or high data transfer capacity of the network, an unauthorized access can be apparently prevented by using a high-level encryption protocol, such as Secure Socket Layer (SSL), that performs encryption each time a signal is transmitted and received, but since high-load computations are required for processing of the high-level encryption protocol, it is unrealistic to use a protocol requiring such high-load computations in a vehicle network system in which computation capacity and data transfer capacity are reduced a necessary minimum limit. </p><p id="p0009" num="0009">SUMMARY OF THE INVENTION </p><p id="p0010" num="0010"> [0007] The invention provides a vehicle network system that can appropriately ensure the reliability of communication signals under limited communication capacity conditions between a plurality of network-connected electronic control units. </p><p id="p0011" num="0011"> [0008] In a vehicle network system according to the first aspect of the invention, a plurality of control units are provided on a vehicle and network-connected to each other communicatively. The vehicle network system is provided with a plurality of control units that are provided on a vehicle and network-connected to each other communicatively. The plurality of control units includes a first control unit that has set therein a secret key from among the secret key and a public key that form a pair and are set by execution of initialization processing for activating the system, and a second control unit that has set therein the public key. The second control unit is configured to create authentication information from the public key and information capable of specifying the second control device, add <sub>4</sub>the authentication information to a communication signal to be transmitted to another control unit, and transmit the communication signal with the authentication information added thereto to the. network. The first control unit is configured to acquire the authentication information that has been added to the communication signal transmitted from the second control unit and estimate 
<!-- EPO <DP n="6"/>-->
 reliability of the communication signal on the basis of the acquired authentication information and the secret key. </p><p id="p0012" num="0012"> [0009] According to the above-described first aspect, since the public key is set when the initialization processing is executed, a unit that transmits the communication signal together with the authentication information is specified as a unit included in the vehicle network system when the initiation processing is executed. As a result, since the transmitted communication signal that has the authentication information added thereto is thus specified as a signal transmitted from the unit included in the vehicle network system during the initialization processing, the reliability thereof is ensured. As a result, the reliability of the communication signal can be increased. </p><p id="p0013" num="0013"> [0010] Where the authentication information that has thus been once created is stored, it is not necessary to create this authentication information again, and during subsequent transmission of communication signals, the processing capacity of the second control unit can be maintained at the conventional level, without adding a load required for creating the authentication information. </p><p id="p0014" num="0014"> [0011] Further, since the contents of the authentication information that has been encrypted by the public key are not falsified, the reliability of the communication signal having the authentication information added thereto can be also increased. </p><p id="p0015" num="0015"> [0012] In the first aspect, the second control unit may be configured to divide the authentication information into a plurality of information pieces, successively add the divided authentication information that has been obtained by division to communication signals, and transmit the communication signals with the divided authentication information added thereto. The first control unit may be configured to receive successively the communication signals, reconfigure the authentication information before the division from the divided authentication information and estimate reliability of the communication signals on the basis of the reconfigured authentication information. </p><p id="p0016" num="0016"> [0013] With the above-described configuration, since the divided authentication information is transmitted, the volume of communication data necessary to ensure the reliability can be reduced by comparison with the case in which the entire authentication 
<!-- EPO <DP n="7"/>-->
 information is added to each transmitted communication signal. In particular, in the case of a vehicle network system which is designed to have a minimal required capacity and functions, the reliability of the communication signals can be increased while suppressing the increase in cost associated with functional enhancement for increasing the reliability of the communication signals. </p><p id="p0017" num="0017"> [0014] In the above-described aspect, the first control unit may be configured to generate the secret key and the public key by execution of the initialization processing and may set the secret key to the first control unit itself and set the public key to the second control unit. </p><p id="p0018" num="0018"> [0015] With the abovementioned configuration, since the first control unit generates the secret key and the public key when the initialization processing is executed, the possibility of the information on secret key and public key leaking beforehand is eliminated. </p><p id="p0019" num="0019"> [0016] In the above-described aspect, the first control unit may set the public key to the second control unit via the network. </p><p id="p0020" num="0020"> [0017] With the abovementioned configuration, the public key can be accurately and effectively distributed to the appropriate control unit constituting the vehicle network system. </p><p id="p0021" num="0021"> [0018] In the above-described aspect, the second control unit may create the authentication information at a timing at which the public key is set. </p><p id="p0022" num="0022"> [0019] With the abovementioned configuration, since the authentication information is created when the public key is set, no processing load associated with the creation of authentication information is generated when the communication signals are transmitted and the increase in processing load in the second control unit is prevented. </p><p id="p0023" num="0023"> [0020] In the above-described aspect, after creating the authentication information, the second control unit may delete the public key that has been set. </p><p id="p0024" num="0024"> [0021] With the abovementioned configuration, since the public key itself is not necessary after the authentication information has been created, leak of the public key is prevented and the reliability of the communication signal is further increased by leaving 
<!-- EPO <DP n="8"/>-->
 the authentication information, which is used for estimating the reliability of the communication signal, and deleting the public key. </p><p id="p0025" num="0025"> [0022] In the above-described aspect, the second control unit may transmit the authentication information, to the network prior to transmitting the communication signal each time the vehicle network system is started, and the first control unit may be configured to acquire and store the authentication information that has been received prior to receiving the communication signal from the second control unit and to estimate reliability of the communication signal by comparing the stored authentication information with the authentication information added to the communication signal. </p><p id="p0026" num="0026"> [0023] With the abovementioned configuration, the first control unit can perform the reliability estimation of the communication signal by authenticating the control unit that transmits the communication signal necessary for estimating the reliability by authentication information transmitted prior to the transmission of the communication signal each time the vehicle network system is started, without being affected, for example, by changes in system configuration. Further, in this case, a control unit that transmits a communication signal for which the estimation of the reliability is necessary is not required to be registered in advance in the first control unit. Therefore, flexibility of the system is also increased. </p><p id="p0027" num="0027"> [0024] In the above-described aspect, the first control unit may be configured to prohibit use of a communication signal transmitted by the second control unit in the vehicle network system when determining that the communication signal is unreliable. </p><p id="p0028" num="0028"> [0025] With the abovementioned configuration, when a unit pretending to be the second control unit is connected to the vehicle network system and an unauthorized signal is transmitted to the vehicle network system, the effect of the unauthorized signal is eliminated from the vehicle network system. As a result, the possibility of the unauthorized signal adversely affecting the vehicle network system can be suppressed. </p><p id="p0029" num="0029"> [0026] In a vehicle network system according to the second aspect of the invention, a plurality of control units provided on a vehicle are network-connected to each other communicatively. The vehicle network system includes a plurality of control 
<!-- EPO <DP n="9"/>-->
 units provided on the vehicle and network-connected to each other communicatively, the i </p><p id="p0030" num="0030">plurality of control units includes a first control unit that has set therein a secret key from among the secret key and a public key that form a pair and are set by execution of initialization processing for activating the system, and a second control unit that has set therein the public key. The first control unit is configured to transmit a communication signal to another control unit via the network and also transmit an authentication signal created on the basis of the secret key and original authentication data generated on the basis of the communication signal, and the second control unit is configured to receive the communication signal and the authentication signal and estimate reliability of the communication signal on the basis of comparison of reproduced authentication data generated on the basis of the received communication signal and decoded authentication data decoded on the basis of the authentication signal and the public key. </p><p id="p0031" num="0031"> [0027] With the abovementioned configuration, since the public key is set when the initialization processing is executed, the first control unit that transmits the public key is specified as a device that has been included in the vehicle network system at the execution of the initialization processing. The second control unit can determine that the transmission origin of the communication signal is the first control unit and that the communication signal has not been falsified by comparing the reproduced authentication data generated from the communication signal and decoded authentication data obtained by decoding the authentication signal of the first control unit. For example, where the communication signal flowing in the network has been 'falsified, the authentication data corresponding thereto cannot be falsified. Therefore, the falsification of the communication signal can be detected. As a result, it is possible to detect a fake signal from a device pretending to be the first control device and the reliability of the communication signal can be increased. </p><p id="p0032" num="0032"> [0028] Further, since the communication signal from the first control device is itself also transmitted to the network, the other control device that does not estimate the reliability of the communication signal can be conventionally used to receive the communication signal from the first control unit.. Therefore, the system for estimating 
<!-- EPO <DP n="10"/>-->
 the reliability of the communication signals can be also easily applied to the already existing vehicle network systems. </p><p id="p0033" num="0033"> [0029] In the above-described second aspect, the first control unit may be configured to generate the authentication signal by encrypting, with the secret key, the original authentication data calculated by applying a hash function to the communication signal, and the second control unit may be configured to calculate the reproduced authentication data by applying the hash function to the received communication signal and estimate the reliability of the communication signal on the basis of comparison of the reproduced authentication data with decoded authentication data obtained by decoding the authentication signal. </p><p id="p0034" num="0034"> [0030] With the abovementioned configuration, authentication data of adequate size (intensity) can be calculated from the communication signal by using a hash function. As a result, the flexibility in designing vehicle network systems is increased. </p><p id="p0035" num="0035"> [0031] In the above-described aspect, the first control unit may be configured to generate the secret key and the public key by execution of the initialization processing and may set the secret key to the first control unit itself and set the public key to the second control unit. </p><p id="p0036" num="0036"> [0032] With the abovementioned configuration, since the first control unit generates the secret key and the public key when the initialization processing is. executed, the possibility of the information on secret key and public key leaking beforehand is eliminated. </p><p id="p0037" num="0037"> [0033] In the above-described aspect, the first control unit may set the public key to the second control unit via the network. </p><p id="p0038" num="0038"> [0034] With the abovementioned configuration, the public key can be accurately and effectively distributed to the appropriate control unit constituting the vehicle network system. </p><p id="p0039" num="0039">BRIEF DESCRIPTION OF THE DRAWINGS </p><p id="p0040" num="0040"> [0035] Features, advantages, and technical and industrial significance of 
<!-- EPO <DP n="11"/>-->
 exemplary embodiments of the invention will be described below with reference to the accompanying drawings, in which like numerals denote like elements, and wherein: </p><p id="p0041" num="0041"> FIG. 1 is a block diagram illustrating a schematic configuration of the vehicle network system according to a first embodiment of the invention; </p><p id="p0042" num="0042"> FIG. 2 is a schematic diagram illustrating schematically how an ECU of the vehicle network system generates an authentication keyword; </p><p id="p0043" num="0043"> FIGS. 3A and 3B illustrate divided authentication keywords added by the ECU of the vehicle network system to the transmission signals, FIG. 3 A being a schematic diagram illustrating schematically how an extraction keyword is extracted by dividing the authentication keyword, and FIG. 3B being a schematic diagram illustrating schematically the configuration of data format of the transmission signal having the extraction keyword added thereto; </p><p id="p0044" num="0044"> FIGS. 4A and 4B are flowcharts illustrating the step of processing performed to estimate the reliability of the communication signals in the vehicle network system, FIG. 4 A being a flowchart illustrating the step of system initialization processing, and FIG. 4B being a flowchart illustrating the step of processing performed to estimate the reliability of the communication signals; </p><p id="p0045" num="0045"> FIG. 5 is a sequence diagram illustrating the system initialization processing of the vehicle network system; </p><p id="p0046" num="0046"> FIG. 6 is a sequence diagram illustrating connection management processing of the vehicle network system; </p><p id="p0047" num="0047"> FIG. 7 is a sequence diagram illustrating data authentication processing of the vehicle network system; </p><p id="p0048" num="0048"> FIG. 8 is a block diagram illustrating a schematic configuration of the vehicle network system according to a second embodiment of the invention; </p><p id="p0049" num="0049"> FIG. 9 is a schematic diagram illustrating schematically how signals are transmitted and received in the vehicle network system; </p><p id="p0050" num="0050"> FIG. 10 is a flowchart illustrating the step of processing in which a signal is transmitted in the vehicle network system; 
<!-- EPO <DP n="12"/>-->
 FIG. 11 is a flowchart illustrating a step of processing performed to estimate the reliability of signals on the basis of signals received in the vehicle network system; and</p><p id="p0051" num="0051">FIGS. 12A and 12B illustrate schematically the configuration of the conventional vehicle network system, FIG. 12A being a schematic diagram illustrating the transmission and reception of signals in a normal state, and FIG. 12B being a schematic diagram illustrating transmission and reception of signals when an unauthorized access has occurred. </p><p id="p0052" num="0052">DETAILED DESCRIPTION OF EMBODIMENTS </p><p id="p0053" num="0053"> [0036] (First Embodiment) </p><p id="p0054" num="0054"> The first embodiment of the vehicle network system in accordance with the invention will be explained below with reference to FIGS. 1 to 3. </p><p id="p0055" num="0055"> [0037] As shown in FIG. 1 , a vehicle 10 is provided with a vehicle network system including first to fourth ECUs 20 to 23 serving as units performing electronic control of devices installed on the vehicle and a network 29 that network connects the first to fourth ECUs 20 to 23 so that the ECUs can communicate with each other. </p><p id="p0056" num="0056"> [0038] The network 29 has specifications suitable for installing the network on the vehicle 10. In the present embodiment, a control area network (CAN) for vehicles, which is a conventional network, is used as the network 29. The CAN for vehicles has a maximum communication capacity of, for example, 500 kilobits per 1 sec (time) and can include maximum. 8-byte (64-bit) data in one data frame (about 5 to 13 bytes) as specifications thereof. Further, in the present embodiment, data included in a data frame (transmission signal) that is transmitted to the network 29 is the so-called vehicle information data such as vehicle speed, engine temperature, or the results of processing performed by the ECUs. </p><p id="p0057" num="0057"> [0039] The first to fourth ECUs 20 to 23 are provided with communication units 30 that communicate with each other via the network 29. Since communication units 30 of the first to fourth ECUs 20 to 23 have the same functions, only the communication unit 30 of the first ECU 20 that functions as the first control unit will be explained in detail 
<!-- EPO <DP n="13"/>-->
 below, and the explanation of the communication units 30 of the second to fourth ECUs 21 to 23 functioning as the second control units will be omitted for the sake of convenience of explanation. </p><p id="p0058" num="0058"> [0040] The communication unit 30 of the first ECU 20 receives transmission signals serving as communication signals including vehicle information data that are transmitted from the second to fourth ECUs 21 to 23, extracts the vehicle information data contained in the transmission signal that has been received, and enables data processing of various types in the first ECU 20. For this purpose, the communication unit 30 removes data to be used for processing of network communication, such as "CAN ID", from the transmission signal constituted by the format of CAN protocol received from the network 29, thereby extracting the vehicle information data, and stores the extracted vehicle information data in a storage device of the first ECU 20 in a state in which the vehicle information data are associated with the "CAN ID". The "CAN ID" is associated in advance at a one-to-one ratio with one vehicle information data. Therefore, the first ECU 20 can determine the meaning of the extracted vehicle information data on the basis of the "CAN ID" associated therewith. Conversely, the communication unit 30 of the first ECU 20 generates a transmission signal including vehicle information data transmitted, from the first ECU 20 when the vehicle information data are transmitted and transmits the generated transmission signal to the network 29. Thus, the communication unit 30 of the first ECU 20 adds "CAN ID" or the like to the vehicle information data to be transmitted, generates a transmission signal having a CAN protocol format, and transmits the generated transmission signal to the network 29. As a result, the first to fourth ECUs 20 to 23 exchanges vehicle information data of various types with each other via the network 29. </p><p id="p0059" num="0059"> [0041] The first to fourth ECUs 20 to 23 are, for example, an engine ECU, a brake ECU, a steering ECU, and an drive aid (navigation system) ECU. The first to fourth ECUs 20 to 23 are configured around a microcomputer provided with a computation device, a storage device, a nonvolatile memory (ROM), a volatile memory (RAM), and a nonvolatile storage device (flash memory or hard disk). Information 
<!-- EPO <DP n="14"/>-->
 processing of various types that is based on data and programs stored in the storage device or memory devices is executed by the microcomputer. </p><p id="p0060" num="0060"> [0042] Further, the vehicle network system of the present embodiment is provided with a configuration for increasing the reliability of communication signals. Thus, the first ECU 20 has a function of monitoring the transmission signals flowing to the network 29 and estimating the reliability of the transmission signals, that is, an authentication master function. Meanwhile, the second to fourth ECUs 21 to 23 have a function of adding an authentication keyword or the like that is used for authentication to the transmission signal and transmitting the transmission signal with the authentication keyword added thereto in order to enable to first ECU 20 serving as the authentication master to authenticate the transmission signals from the second to fourth ECUs 21 to 23. The configuration of the second to fourth ECUs 21 to 23 will be described below. </p><p id="p0061" num="0061"> [0043] The first ECU 20 is provided with a key generation unit 31 that generates a secret key Kl and a public key K2, which form a pair, and a secret key retention unit 32 that holds the secret key Kl generated by the key generation unit 31. The first ECU 20 is also provided with a connection ECU management unit 33 that registers and manages the ECU connected to the network 29 each time the vehicle 10 is started and a keyword authentication unit 34 that performs estimation (authentication) processing of the reliability of the transmission signals on the basis of the authentication keyword encrypted by the public key K2. </p><p id="p0062" num="0062"> [0044] The key generation unit 31 generates a pair of the secret key Kl and public key K2 (key pair) that are used in a public key encryption system such as RSA encryption, which enables encryption and digital signature, and for example uses a computation method designated by the RSA encryption system to generate a key pair to be used for the RSA encryption. Thus, where the key pair is used for encryption, plain text can be encrypted with the public key K2 and the encrypted plain text can be decoded by the secret key Kl . Further, where the key pair is used for a digital signature, plain text encrypted by the secret key Kl can be decoded by the public key K2. </p><p id="p0063" num="0063"> [0045] Further, the generation of the key pair with the key generation unit 31 is 
<!-- EPO <DP n="15"/>-->
 executed on condition that initialization of the vehicle network system is executed. After the key generation unit 31 has generated a pair, of the secret key Kl and public key K2 as a key pair, the generated public key K2 is transmitted once to the network 29, that is, the public key K2 is made public once. Thus, in the present embodiment, the public key K2 is made public only once in the vehicle network system on condition that the initialization of the vehicle network system has been executed, and is not public at all times like a typical public key used in the internet. </p><p id="p0064" num="0064"> [0046] The initialization of the vehicle network system serving as a condition for the key generation unit 31 to generate a key pair is initialization processing performed with respect to the vehicle network system in order to activate the configured vehicle network system. For example, the initialization of the vehicle network system is purposefully executed, for example, only when a battery is connected to the vehicle for shipping or when vehicle preparation accompanied by reconfiguration of the vehicle network system is performed by a car dealer. In other cases, for example, when a vehicle is started by ah ignition key or the like to use the vehicle, or when the battery is replaced without any relation to the reconfiguration of the vehicle network system, the initialization of the vehicle network system is not executed and therefore, the generation of the key pair by the key generation unit 31 is not performed. </p><p id="p0065" num="0065"> [0047] The secret key retention unit 32 receives the secret key Kl , from among the pair of keys generated . by the key generation unit 31, from the key generation unit 31 when the key pair is generated and usably holds the secret key only in the first ECU 20. </p><p id="p0066" num="0066"> [0048] The connection ECU management unit 33 receives, via the network 29, an authentication keyword 43 including identification information on each ECU transmitted by the ECU each time the vehicle network system is started following the operation of starting the vehicle 10 with an ignition key or the like. The connection ECU management unit 33 then determines that the ECU specified on the basis of the identification information obtained from the received authentication keyword 43 is connected to the network 29, registers this ECU in a connection list 331, and usably manages the connection list 331 in the first ECU 20 during the operation of the vehicle 
<!-- EPO <DP n="16"/>-->
 network system. In the present embodiment, the authentication keyword 43 is encrypted by the public key K2, but decoded by the secret key Kl that has been held in the secret key retention unit 32, thereby making it possible to acquire the ECU identification information included therein. </p><p id="p0067" num="0067"> [0049] The keyword authentication unit 34 decodes, as necessary, the authentication keyword 43 encrypted by the public key K2 with the secret key Kl held in the secret key retention unit 32. Further, the keyword authentication unit 34 monitors the transmission signals flowing in the network 29 and acquires the authentication keyword 43 that has been added to the transmission signals. In the present embodiment, parts (extraction keywords) of the authentication keyword 43 are added to the transmission signals. Therefore, the parts of the authentication keyword 43 are acquired from the transmission signal, and the acquired partial authentication keywords 43 are successively connected to the transmission signals having the same "CAN ID", thereby reconfiguring a full-size reconfigured authentication keyword 341. </p><p id="p0068" num="0068"> [0050] Further, the keyword authentication unit 34 compares the full-size reconfigured authentication keyword 341 with the authentication keyword 43 held in the connection ECU management unit 33. The keyword authentication unit 34 may perform the comparison while the reconfigured authentication keyword 341 and the authentication keyword 43 are still encrypted, or may perform the comparison after decoding. As a result, it is verified whether or not the ECU that has transmitted the transmission signal is the ECU that has transmitted the authentication keyword 43 managed in the connection list 331. Thus, when the reconfigured authentication keyword 341 matches the authentication keyword 43, the ECU that has transmitted the transmission signal is verified to be the ECU that has transmitted the authentication keyword 43 managed in the connection list 331. Meanwhile, where the reconfigured authentication keyword 341 and the authentication keyword 43 do not match, it means that a improper transmission signal has been added to the network 29 because of unauthorized access or the like and it is determined that the reliability of the transmission signals cannot be ensured. 
<!-- EPO <DP n="17"/>-->
 [0051] Further, when the reconfigured authentication keyword 341 and the authentication keyword 43 do not match, the keyword authentication unit 34 determines that the reconfigured authentication keyword 341 is unauthorized and prohibits the use of the transmission signal with the "CAN ID" having the reconfigured authentication keyword 341 added thereto. For example, the keyword authentication unit 34 prohibits the use in the vehicle network system of the ECU having allocated thereto the "CAN ID" that is prohibited for use, or broadcasts (notifies) information indicating that the transmission signal is unauthorized to the network 29, thereby cutting off the ECU that is the prohibition object from the vehicle network system or causing the system to ignore the transmission signal that is the prohibition object. As a result, the transmission signal having the "CAN ID" that is the prohibition object does not flow into the network 29 or is not handled thereby. Further, where the keyword authentication unit 34 transmits the "CAN ID" that is the prohibition object to the network 29, the "CAN ID" that is the prohibition object is transferred to the second to fourth ECUs 21 to 23 and the transmission signals having the "CAN ID" that is the prohibition object are prohibited for use in the ECUs. </p><p id="p0069" num="0069"> [0052] A function relating to estimation of the reliability of the transmission signals in the second to fourth ECUs 21 to 23 will be explained below. Since the second to fourth ECUs 21 to 23 have the same function, the explanation below will be provided only with respect to the second ECU 21. For the sake of convenience of explanation, when the third and fourth ECUs 22 and 23 are explained, the same and corresponding functions are assigned with same reference numerals and detailed explanation thereof is herein omitted. </p><p id="p0070" num="0070"> [0053] The second ECU 21 is provided with a public key retention unit 41 that receives and holds the public key K2 transmitted from the first ECU 20 and an authentication keyword generation and retention unit 42 that generates and holds the authentication keyword 43 by using the public key K2. The second ECU 21 is also provided with vehicle information data 44 constituted by vehicle speed, engine temperature, or processing results obtained with the ECU and an authentication keyword 
<!-- EPO <DP n="18"/>-->
 addition unit 45 that successively adds parts of the authentication keyword 43 to the vehicle information data 44. </p><p id="p0071" num="0071"> [0054] The public key retention unit 41 acquires the public key K2 transmitted from the first ECU 20 when the initialization of the vehicle network system is executed, retains the acquired public key K2, and enables the use thereof in the second ECU 21. </p><p id="p0072" num="0072"> [0055] As shown in FIG. 2, the authentication keywords generation and retention unit 42 encrypts (214) information of at least one of, for example, an ECU name 211 or serial number 212, which is the intrinsic information capable of specifying the second ECU 21 , by using the public key K2 that has been held in the public key retention unit 41 and generates and holds the authentication keyword 43. Further, the authentication keyword generation and retention unit 42 transmits the authentication keyword 43 that has been held therein to the network 29 each time the vehicle network system is started following the start of the vehicle 10 with the ignition key. The second ECU 21 thereby registers the authentication keyword 43 of the second ECU 21 in the connection list 331 of the connection ECU management unit 33 of the first ECU 20. </p><p id="p0073" num="0073"> [0056] The vehicle information data 44 represent one of vehicle information from among the vehicle speed, engine temperature, or processing results obtained .with the ECU; one type of the vehicle information data 44 is associated in advance with one "CAN ID". As a result, in the vehicle network system, by referring to the "CAN ID", it is possible to specify correctly, provided that an unauthorized access is absent, the type of vehicle information included in the vehicle information data 44 and the ECU that has transmitted the vehicle information data 44. </p><p id="p0074" num="0074"> [0057] The authentication keyword addition unit 45 successively adds the extraction keywords as parts of the authentication keyword 43 to the vehicle information data 44 that are transmitted from the second ECU 21 and have the "CAN ID" of the same assigned thereto. More specifically, as shown in FIG. 3 A, the authentication keyword addition unit 45 sets an "extraction start point" at a random position' of the authentication keyword 43 and acquires extraction keywords 431 to 43n as n pieces of authentication information by successively extracting the keywords by a predetermined number of bits 
<!-- EPO <DP n="19"/>-->
 from the "extraction start point". In this case, the extraction (acquisition) of the "extraction keywords" is repeated till the extraction position reaches the very end of the authentication keyword 43, and at this time the extraction position is returned to the beginning of the authentication keyword 43, and the extraction (acquisition) of the "extraction keywords" is repeated till the extraction position reaches "extraction start point". The extraction keywords 431 to 43n of a predetermined number of bits are thus extracted n times (predetermined number) from the authentication keyword 43. Then, as shown in FIG. 3B, the authentication keyword addition unit 45 successively adds one extraction keywords 431 (to 43n) to the vehicle information data 44. By so adding one extraction keywords 431 (to 43n) to the vehicle information data 44, it is possible to decrease the amount of transmitted data by comparison with the case where the authentication keywords 43 itself is added. </p><p id="p0075" num="0075"> [0058] As a result, the vehicle information data 44 and the extraction keywords 431 (to 43n) are transmitted to the communication unit 30, a CAN ID 215 and a sequence number 216 are added thereto in the communication unit 30, a transmission signal constituted by data format of CAN protocol is created, and the created transmission signal is transmitted to the network 29. </p><p id="p0076" num="0076"> [0059] The above-mentioned "extraction start point" can be set randomly. For example, the adjacent bits can be successively computed by an exclusive OR(XOR) with respect to a bit row of the public key K2, and the computation result value is obtained at a point of time in which the number of bits of the computation result becomes equal to a predetermined desired number of bits. The "extraction start point" is then set to a position obtained by shifting from the head bit of the authentication keyword 43 to the computation result value that has been obtained in the above-described manner. </p><p id="p0077" num="0077"> [0060] The operation of the vehicle network system configured in the above-described manner will be explained below with reference to FIGS. 4 to 7. As shown in FIG. 4A, after the vehicle network system has been constructed, system initialization processing is executed to activate the system (step S10 in FIG. 4A). In the system initialization processing, as shown in FIG. 5, the first ECU 20, which is the 
<!-- EPO <DP n="20"/>-->
 authentication master ECU, generates a pair of the secret key Kl and the public key K2 (step Sl l in FIG. 5). The first ECU 20 holds the generated secret key Kl in the secret key retention unit 32 thereof and distributes the public key K2 to the second to fourth ECUs 21 to 23 via the network 29 (step S12 in FIG. 5). The second to fourth ECUs 21 to 23 in which the public key K2 has been set create respective authentication keywords 43 on the basis of the set public key K2 at a timing at which the public key K2 is set and hold the created authentication keywords (step S13 in FIG. 5). The execution of the system initialization processing ends when the above-described processing is completed. </p><p id="p0078" num="0078"> [0061] Where the vehicle network system is started in the usual manner after the execution of the initialization of the vehicle network system, as shown in FIG. 4B, the vehicle network system performs the connection management processing (step S20 in FIG. 4B) and then performs the data authentication processing (step S30 in FIG. 4B). </p><p id="p0079" num="0079"> [0062] In the connection management processing, as shown in FIG. 6, following the start of the vehicle network system, the authentication keywords 43 held by the second to fourth ECUs 21 to 23 are transmitted to the network 29 (step S21 in FIG. 6). The first ECU 20 receives the authentication keywords 43 of the second to fourth ECUs 21 to 23, decodes the received authentication keywords with the secret key Kl , specifies the ECU which are the transmission sources (step S22 in FIG. 6) and also associates the authentication keywords 43 with the specified ECU and registers them in the connection list 331 (step S23 in FIG. 6). As a result, an ECU for which the public key K2 could not be acquired during execution of the initialization of the vehicle network system, for example, an ECU connected after the initialization of the vehicle network system has been executed, will not be registered in the connection list 331 , thereby making it possible to distinguish an ECU that has not been authorized for connection to the network 29. </p><p id="p0080" num="0080"> [0063] In the data authentication processing, as shown in FIG. 7, the second to fourth ECUs 21 to 23 transmit transmission signals having the extraction keywords 431 (to 43n) added thereto (step S31 in FIG. 7). The first ECU 20 monitors the transmission signals having the extraction keywords added thereto, and compares the reconfigured 
<!-- EPO <DP n="21"/>-->
 authentication keywords 341 that are obtained by successive acquisition and reconfiguration of the extraction keywords 431 (to 43n) for each "CAN ID" with the authentication keyword 43 that has been held in the connection list 331 , thereby verifying </p><p id="p0081" num="0081"> ) </p><p id="p0082" num="0082">the reliability of the transmission signals (step S32 in FIG. 7). Thus, when the reconfigured authentication keyword 341 and the authentication keyword 43 match (YES in step S33 in FIG. 7), the first ECU 20 determines that the reconfigured authentication keyword 341 is appropriate and continues monitoring the transmission signals (step S34 in FIG. 7). </p><p id="p0083" num="0083"> [0064] Meanwhile, when the reconfigured authentication keyword 341 and the authentication keyword 43 do not match (NO in step S33 in FIG. 7), the first ECU 20 determines that the reconfigured authentication keyword 341 is unauthorized and cuts off the ECU having the "CAN ID" with the reconfigured authentication keyword 341 added thereto from the<sub>.</sub> vehicle network system (step S35 in FIG. 7). The first ECU 20 also prohibits the use of the transmission signal having the "CAN ID" that is the prohibition object in the second to fourth ECUs 21 to 23 (step S36 in FIG. 7). </p><p id="p0084" num="0084"> [0065] As a result, in the vehicle network system of the present embodiment, the first ECU 20 monitors as to whether or not the transmission signals transmitted to the network 29 include a transmission signal in which a "CAN ID", which is added by the second to fourth ECUs 21 to 23 to the transmission signals, has been added to improper data. When a fake transmission signal is included in the transmission signals, the first ECU 20 determines the fake signal and prohibits the use of the fake transmission signal in the network 29. </p><p id="p0085" num="0085"> [0066] As mentioned hereinabove, the below-described effects can be obtained with the vehicle network system of the present embodiment. (1) Since the public key K2 is set in the second to fourth ECUs 21 to 23 when the initialization processing of the vehicle network system is executed, the second to fourth ECUs 21 to 23 that transmit transmission signals together with the extraction keywords 431 to 43n are specified as units that have been included in the vehicle network system when the initialization processing was executed. As a result, the transmission signals transmitted upon the 
<!-- EPO <DP n="22"/>-->
 addition of the extraction keywords 431 to 43n thereto are specified as transmission signals transmitted from the second to fourth ECUs 21 to 23 that have been included in the vehicle network system when the initialization processing was executed and therefore the reliability thereof can be ensured. As a result, the reliability of the transmission signals can be increased. </p><p id="p0086" num="0086"> [0067] (2) Further, where the extraction keywords 431 to 43n (authentication keyword 43) that have once been created are stored, it is not necessary to create the extraction keywords 431 to 43n again. Therefore, during subsequent transmission of transmission signals, there is no increase in load required to create the extraction keywords 431 to 43n and the processing capacity of the second to fourth ECUs 21 to 23 can be maintained at the conventional level. </p><p id="p0087" num="0087"> [0068] (3) Furthermore, since the contents of extraction keywords 431 to 43n that have been encrypted by the public key K2 have not been falsified, the reliability of the transmission signals having the extraction words added thereto is also increased. </p><p id="p0088" num="0088"> [0069] (4) Since the extraction keywords 431 to 43n<sup>'</sup> (authentication keyword</p><p id="p0089" num="0089">43) are transmitted upon division, the amount of communication data that is considered necessary for ensuring the reliability can be reduced by comparison with the case where all of the extraction keywords 431 to 43n are added to each transmission signal to be transmitted. In particular, with a vehicle network system that is designed with minimum necessary capacity and functions, the reliability of the transmission signals can be increased, while suppressing the increase in cost associated with the enhancement of functions for increasing the reliability of the transmission signals. </p><p id="p0090" num="0090"> [0070] (5) Since the first ECU 20 generates the secret key Kl and the public key K2 during execution of the initialization processing, the secret key Kl and the public key K2 cannot leak beforehand. (6) Since the public key K2 is distributed during the initialization processing, the public key K2 can be distributed accurately and efficiently to the appropriate second to fourth ECUs 21 to 23 constituting the vehicle network system. </p><p id="p0091" num="0091"> [0071] (7) Since the extraction keywords 431 to 43n (authentication keyword 43) are created when the public key K2 is set, no processing load for creating the 
<!-- EPO <DP n="23"/>-->
 extraction keywords 431 to 43n (authentication keyword 43) is generated when the transmission signals are transmitted and the increase in processing load in the second to fourth ECUs 21 to 23 can be suppressed. </p><p id="p0092" num="0092"> [0072] (8) The first ECU 20 authenticates the second to fourth ECUs 21 to 23, which transmit transmission signals necessary to<sup>'</sup> estimate the reliability, by the authentication keyword 43, which is transmitted prior to the transmission of the transmission signals, each time the vehicle network system is started, thereby making it possible to perform the reliability estimation of the transmission signals that is not affected, for example, by changes in the system configuration. Further, in this case, the second to fourth ECUs 21 to 23 that transmit the transmission signals for which the estimation of the reliability is necessary are not required to be registered in advance in the first ECU 20. Therefore, flexibility of the system is also increased. </p><p id="p0093" num="0093"> [0073] (9) When a device pretending to be the second to fourth ECUs 21 to 23 is connected to the vehicle network system and an unauthorized signal (fake signal) is transmitted to the vehicle network system, since the unauthorized signal is prohibited for use, the unauthorized signal is prevented from affecting the vehicle network system. As a result, the unauthorized signal can be prevented from causing inconveniences in the vehicle network system. </p><p id="p0094" num="0094"> [0074] (Second Embodiment) </p><p id="p0095" num="0095"> The second embodiment of the vehicle network system according to the invention will be explained below with reference to FIGS. 8 and 9. The main difference between this embodiment and the above-described first embodiment is that an authentication signal that enables the reliability estimation of the transmission signals is transmitted, as necessary, separately from the transmission signals. Accordingly, this difference between the present embodiment and the above-described first embodiment will be mainly explained below and, for convenience of explanation, the same components will be assigned with same reference numerals and the explanation thereof will be omitted. </p><p id="p0096" num="0096"> [0075] The communication unit 30 of the first ECU 20 is similar to the communication unit 30 of the above-described first embodiment, but in the present 
<!-- EPO <DP n="24"/>-->
 embodiment, as shown in FIG. 9, "XX" is set as a value of "CAN ID" for addition to a transmission signal TD10 serving, as a communication signal and also "YY" is set as a value of "CAN ID" for addition to an encrypted signal TS10. This value "YY" is an identifier associated with the value "XX", and in the vehicle network system, the encrypted signal TS10 in which the value "YY" is set in the "CAN ID" is defined in advance as the so-called authentication signal, which is the signal for estimating the reliability of the transmission signal TD10 having the value "XX". </p><p id="p0097" num="0097"> [0076] As shown in FIG. 8, the key generation unit 31 that generates the secret key Kl and the public key K2 that form a pair and the secret key retention unit 32 that holds the secret key Kl generated by the key generation unit 31 are provided in the first ECU 20 serving as the first control unit. Further, the first ECU 20 is also provided with vehicle information data 35 constituted by vehicle speed, engine temperature, or processing results obtained with the ECU, an authentication data generation unit 36 that generated authentication data for authenticating the transmission source of the vehicle information data 35, and an encrypted data creation unit 37 that creates encrypted data serving as an authentication signal from the authentication data. </p><p id="p0098" num="0098"> [0077] The key generation unit 31 generates a pair of the secret key Kl and the public key K2 (key pair) that are used in a public key encryption system such as RSA encryption, which enables encryption and digital signature, and for example uses a computation method designated by the RSA encryption system to generate a key pair to be used for the RSA encryption, in the same manner as in the above-described first embodiment. Thus, where the key pair is used for encryption, plain text can be encrypted with the public key K2 and the encrypted plain text can be decoded by the secret key Kl . Further, where the key pair is used for a digital signature, plain text encrypted by the secret key Kl can be decoded by the public key K2. </p><p id="p0099" num="0099"> [0078] The vehicle information data 35 represent any type of vehicle information from among the vehicle speed, engine temperature, or processing results obtained with the ECU, and one "CAN ID" is associated in advance with one type of the vehicle information data 35. As a result, in the vehicle network system, by referring to 
<!-- EPO <DP n="25"/>-->
 the "CAN ID", it is possible to specify correctly, provided that an unauthorized access is absent, the type of vehicle information included in the .vehicle information data 35 and the ECU (for example, the first ECU 20) that has transmitted the vehicle information data 35. </p><p id="p0100" num="0100"> [0079] The authentication data creation unit 36 takes a hash value of the vehicle information data 35 obtained by using a predetermined hash function as authentication data for authenticating that the transmission source of the vehicle information data 35 is the first ECU 20. The hash function generates a pseudorandom number (hash number, message digest) that has been determined in advance from the vehicle information data 35. Theoretically, it is extremely difficult to generate data (for example, improper vehicle information data) having the same hash value. Therefore, the authentication data created by the hash function can be guaranteed to have been created, for example, from the vehicle information data 35. </p><p id="p0101" num="0101"> [0080] The encrypted data generation unit 37 generates encrypted data from the authentication data on the basis of the secret key Kl held in the secret key retention unit 32. Since the encrypted data can be decoded only by the public key K2, where the encrypted data can be decoded by the public key K2, these public data can be guaranteed to have been generated by the first ECU 20. </p><p id="p0102" num="0102"> [0081] A configuration relating to the function of estimating the reliability of the transmission signal TD10 that is provided in the second ECU 21 serving as the second control unit will be explained below. The third and fourth ECUs 22 and 23 differ from the second control unit in that they are not provided with the function of estimating the reliability of the transmission signals, but other functions are similar to those of the second ECU 21 and therefore the explanation thereof is herein omitted. </p><p id="p0103" num="0103"> [0082] The second ECU 21 is provided with the public key retention unit 41 that receives and holds the public key K2 transmitted from the first ECU 20. The second ECU 21 is also provided with a reception data retention unit 50 that holds the vehicle information data 35 included in the transmission signal TD10 transmitted by the first ECU 20 and an authentication data reproduction unit 51 that reproduces authentication 
<!-- EPO <DP n="26"/>-->
 data on the basis of the vehicle information data 35 held in the reception data retention unit 50. The second ECU 21 is further provided with an encrypted data retention unit 52 that retains encrypted data included in the encrypted signal TS 10 transmitted by the first ECU and a signal reliability estimation unit 53 that estimates the reliability of the transmission signal TD10 on the basis of the authentication data reproduced by the authentication data reproduction unit 51 and the authentication data decoded from the encrypted data. </p><p id="p0104" num="0104"> [0083] The reception data retention unit 50 acquires and retains vehicle information data 35 that have been taken out of the transmission signal TD10 by the communication unit 30 that has received the transmission signal TD10 transmitted by the first ECU 20. </p><p id="p0105" num="0105"> [0084] The authentication data reproduction unit 51 has a hash function identical to the hash function used by the first ECU 20 to generate the authentication data and generates the hash value (message digest) of the vehicle information data 35 held in the reception data retention unit 50 by using the hash function. Thus, the reception data retention unit 50 generates reproduced authentication data, which are authentication data reproduced on the basis of the vehicle information data 35 and the hash function used by the first ECU 20 to generate the authentication data. Usually, if there is no unauthorized access, the reception data retention unit 50 generates the reproduced authentication data identical to the authentication data generated by the first ECU 20. </p><p id="p0106" num="0106"> [0085] The encrypted data retention unit 52 acquires and retains the encrypted data that have been taken out by the communication unit 30, which has received the encrypted signal TS10 transmitted by the first ECU 20, by removing the "CAN ID", which is considered to be necessary for communication, from the encrypted signal TS10. Thus, the encrypted data generated on the basis of the authentication data generated by the first ECU 20 are held. </p><p id="p0107" num="0107"> [0086] The reliability estimation unit 53 acquires decoded authentication data, which are authentication data generated by the first ECU 20, by decoding the encrypted data held in the encrypted data retention unit 52 oii the basis of the public key K2 retained 
<!-- EPO <DP n="27"/>-->
 in the public key retention unit 41. Since the encrypted data that can be decoded by the public key K2 are only the encrypted data that have been encrypted by the secret key Kl of the first ECU 20, the encrypted data that can be adequately decoded by the public key K2 are guaranteed to be the data encrypted using the secret key Kl, that is, the data encrypted by the first ECU 20. </p><p id="p0108" num="0108"> [0087] The reliability estimation unit 53 then estimates the reliability of the transmission signal TD10 on the basis of comparison of the decoded authentication data obtained by decoding the encrypted data and the reproduced authentication data of the authentication data reproduction unit 51. As a result, where the decoded authentication data and the reproduced authentication data match, the decoded authentication data are guaranteed to have been transmitted by the first ECU 20. Therefore, the vehicle information data 35 used for reproducing the reproduced authentication data are also guaranteed to have been transmitted from the first ECU 20. Further, since the hash values serving as the authentication data match, the plain text data (vehicle information data 35) transmitted by the first ECU 20 as the transmission signal TD10 are also guaranteed not to have been falsified along the way into different data. </p><p id="p0109" num="0109"> [0088] The operation of the vehicle network system of the above-described configuration will be explained below with reference to FIGS. 10 and 11. As shown in FIG. 9, the first ECU 20 generates a pair of the secret key Kl and the public key K2 in the key generation unit 31 when the vehicle network system is initialized and holds the generated secret key Kl in the secret key retention unit 32. Meanwhile, the first ECU 20 transmits the generated public key K2 into the network 29 and sets the public key into the second ECU 21. In the present embodiment, the third and fourth ECUs 22 and 23 do not require the reliability estimation of the transmission signal transmitted from the first ECU 20. Therefore, the public key K2 generated by the first ECU 20 is not set therein. </p><p id="p0110" num="0110"> [0089] After such initialization processing has ended, the vehicle network system is started and the transmission signal TD10 that requires the reliability estimation is transmitted from the first ECU 20 to the second ECU 21. The transmission signal 
<!-- EPO <DP n="28"/>-->
 TDIO is a signal configured by the usual CAN protocol format and has the value "XX" of the CAN ID and the values "123... " of plain text data (vehicle information data 35). Where the transmission signal TDIO is transmitted to the network 29, the second to fourth ECUs 21 to 23 connected to the same network 29 receive reception signals RD11 to RD13 constituted by the value "XX" of the CAN ID and the values "123..." of plain text data. </p><p id="p0111" num="0111"> [0090] However, in the present embodiment, the first ECU 20 transmits to the network 29 the encrypted signal TS10 that is used for the reliability estimation of the transmitted signal TD10 prior to transmitting the transmission signal TD10. Thus, as shown in FIG. 10, the first ECU 20 generates a hash value (message digest) of the vehicle information data 35, which is the plain text data, as authentication data (step S40 in FIG. 10), and generates the encrypted signal TS10 including the encrypted data obtained by encrypting the generated authentication data with the secret key Kl (step S41 in FIG. 10). For example, "608..." as the authentication data are obtained by encrypting the authentication data generated from the pain text data "123...". Then, the encrypted signal TS10 is created that is configured in the format of CAN protocol having the CAN ID value "YY" and the encrypted data value "608...". Where the encrypted signal TS10 is created, the first ECU 20 transmits the created encrypted signal TS10 (step S42 in FIG. 10) and also transmits the transmission signal TD10, which is the usual signal corresponding to the encrypted signal TS10 (step S43 in FIG. 10). As a result, the transmission of the transmission signal TDIO and the transmission of the encrypted signal TS10 for estimating the reliability of the transmission signal that are performed by the first ECU 20 are ended. </p><p id="p0112" num="0112"> [0091] Meanwhile, the second ECU 21 receives the transmission signal TD10 and the encrypted signal TS10 and also estimates the reliability of the transmission signal TD10 on the basis of the received transmission signal TD10 and the encrypted signal TS10. Thus, as shown in FIG. 11, the second ECU 21 receives the encrypted signal TS10 (step S50 in FIG. 11). By receiving the encrypted signal TS10, the second ECU 21 can predict the transmission of the transmission signal TD10 having the CAN ID 
<!-- EPO <DP n="29"/>-->
 value "XX" corresponding to the CAN ID value "YY" of the encrypted signal TS10. Where the encrypted signal TS10 is received, the second ECU 21 decodes the encrypted signal TS10 and obtains the decoded authentication data (step S51 in FIG. 11). Further, the second ECU 21 obtains plain text data (vehicle information data 35) from the transmission signal TD10 corresponding to the encrypted signal TS10 (step S52 in FIG. 11) and also generates a hash value (message digest) of the plain text data (vehicle information data 35) as the reproduced authentication data (step S53 in FIG. 11). Where the decoded authentication data (message digest) and the reproduced authentication data (message digest) are obtained, the second ECU 21 compares these decoded authentication data and reproduced authentication data (step S54 in FIG. 11). When the comparison results indicate that the decoded authentication data and reproduced authentication data match (YES in step S55 in FIG. 11), the transmission signal TD10 is determined to be appropriate (step S56 in FIG. 11). Meanwhile, when the comparison results indicate that the decoded authentication data and reproduced authentication data do not match (NO in step S55 in FIG 11), the transmission signal TD10 is determined to be unauthorized (step S57 in FIG. 11). As a result, the reliability of the transmission signal TD10 is estimated. The reliability estimation of the transmission signal TD10 transmitted by the first ECU 20 is thus completed. </p><p id="p0113" num="0113"> [0092] As mentioned hereinabove, the below-described effects can be obtained with the vehicle network system of the present embodiment. </p><p id="p0114" num="0114"> [0093] (10) Since the public key 2 is set when the initialization processing is executed, the first control unit that transmits the public key K2 is specified as the unit that has been included in the vehicle network system when the initialization processing was executed. Further, by comparing the reproduced authentication data generated from the transmission signal TD10 and the decoded authentication data obtained by decoding the encrypted data of the first ECU 20 from the encrypted signal TS10, the second ECU 21 can determine that the transmission source of the transmission signal TD10 is the first ECU 20 and that no falsification have been added to the transmission signal TD10. For example, even if the transmission signal TD10 flowing in the network 29 has been 
<!-- EPO <DP n="30"/>-->
 falsified, since the authentication data (encrypted data) of the encrypted signal TS10 corresponding thereto cannot be falsified, the falsification of the transmission signal TDIO can be detected. As a result, a fake signal transmitted from a device pretending to be the first ECU 20 can be detected and the reliability of the communication signals can be increased. </p><p id="p0115" num="0115"> [0094] (11) Further, the transmission signal TD10 is itself also transmitted from the first ECU 20 to the network. Therefore, the third and fourth ECUs 22 and 23 that do not estimate the reliability of the transmission signal TD10 can receive and use the transmission signal TD10 from the first ECU 20 in the conventional manner. Therefore, the system that estimates the reliability of the transmission signal TD10 can be easily applied to the already existing vehicle network systems. </p><p id="p0116" num="0116"> [0095] (12) The hash function makes it possible to calculate authentication data of adequate size (intensity) from the transmission signal TD10, in particular from the vehicle information data 35. As a result, the flexibility in designing vehicle network systems is increased. </p><p id="p0117" num="0117"> [0096] (13) Since the first ECU 20 generates the secret key Kl and the public key K2 when the initialization processing is executed, the secret key Kl and the public key K2 are prevented from leaking beforehand. (14) Since the public key K2 is distributed during the initialization processing, the public key K2 can be distributed accurately and effectively to the appropriate second ECU 21 constituting the vehicle network system. </p><p id="p0118" num="0118"> [0097] (Other Embodiments) The above-described embodiments can be also implemented in the following modes. </p><p id="p0119" num="0119"> [0098] In the above-described embodiments, the case where the network 29 is a CAN is explained by way of example. However, such a configuration is not limiting, and conventional networks suitable for use as networks for vehicles, such as Ethernet and FlexRay <sup>M</sup>, can be also used. Further, the network can use wireless communication, wire communication, or a mixture thereof. As a result the application range of the vehicle network system is expanded and the flexibility in designing the system is 
<!-- EPO <DP n="31"/>-->
 increased. </p><p id="p0120" num="0120"> [0099] In the first embodiment, the case is explained where the authentication keyword 43 is generated at a timing at which the public key K2 is set, but such a configuration is not limiting and the authentication keyword may be generated at any timing, provided that there is surplus processing capacity in the ECU, the public key is held, and the generation timing is before the addition to the communication signal. </p><p id="p0121" num="0121"> [0100] In the above-described embodiments, the case is explained where the public key K2 is made public only once, but such a configuration is not limiting and the public key may be made public a plurality of times, provided that it is possible not to acquire a device that has been added without authorization. </p><p id="p0122" num="0122"> [0101] In the first embodiment, the case is explained where the public key K2 is held in the public key retention unit 41 , but such a configuration is not limiting and since the public key is not used after the authentication keyword has been generated, the public key may be deleted after the authentication keyword has been generated. Since the public key is thus deleted from the second ECU or the like, the public key is prevented from leaking after the public key distribution and the reliability of the communication signals can be further increased. </p><p id="p0123" num="0123"> [0102] In the first embodiment, the case is explained where the extraction keywords 431 (to 43n) are added after the vehicle information data 44 in the transmission signals, but such a configuration is not limiting, and the extraction keywords may be added before the data or at another location, provided that the format enabling communication in the network can be maintained. As a result, the flexibility in adding the extraction keywords to the transmission signal is increased, and the application range for estimating the reliability of the transmission signals is expanded. </p><p id="p0124" num="0124"> [0103] In the first embodiment, the case is explained where the first ECU 20 estimates the reliability of the transmission signals of all other ECUs (second to fourth ECUs 21 to 23) connected to the network. However, such a configuration is not limiting, and the first ECU may estimate the reliability of the communication signals of only some (one or a plurality) of other ECUs connected to the network. In this case, the flexibility 
<!-- EPO <DP n="32"/>-->
 in designing vehicle network systems is increased. For example, it is not necessary to add extraction keywords to transmission signals other than reliability estimation objects. </p><p id="p0125" num="0125"> [0104] In the second embodiment, the case is explained where the reliability of the transmission signals transmitted from the first ECU 20 is estimation by only one ECU (second ECU 21). However, such a configuration is not limiting, and the reliability of the transmission signals transmitted from the first ECU may be estimated by a plurality of</p><p id="p0126" num="0126">ECUs (second to fourth ECUs and the like). As a result, the flexibility in designing vehicle network systems is increased. </p><p id="p0127" num="0127"> [0105] In the second embodiment, the case is explained where the encrypted signal TS10 is transmitted by the first ECU 20, which is the transmitting ECU, prior to transmitting the transmission signal TDIO, and the second ECU 21, which is the receiving ECU, receives the encrypted signal TS10 prior to the transmission signal TD10.</p><p id="p0128" num="0128">However, such a configuration is not limiting, and the transmitting ECU may transmit the encrypted signal after transmitting the transmission signal and the receiving ECU may receive the encrypted signal after the transmission signal. As a result, the flexibility in designing the vehicle network system is increased. </p><p id="p0129" num="0129"> [0106] In the first embodiment, the case is explained where the RSA encryption is used as the public key encryption system, but such a configuration is not limiting, and other conventional public key encryption systems can be used, provided that the relationship is fulfilled such that the plain text encrypted by a public key can be decoded by a secret key. As a result, the flexibility in designing the vehicle network system and applicability thereof are expanded. </p><p id="p0130" num="0130"> [0107] In the second embodiment, the case is explained where the RSA encryption is used as the public key encryption system, but such a configuration is not limiting, and other conventional public key encryption systems can be used, provided that the relationship is fulfilled such that the plain text encrypted by a secret key can be decoded by a public key, that is, provided that the system can be used for digital signature.</p><p id="p0131" num="0131">As a result, the flexibility in designing the vehicle network system and applicability thereof are expanded. , 
<!-- EPO <DP n="33"/>-->
 [0108] In the first embodiment, the case is explained where the authentication master is only the first ECU 20, but such a configuration is not limiting and a plurality of authentication masters may be provided. As a result, security of the vehicle network system can be maintained at a higher level. </p><p id="p0132" num="0132"> [0109] In the first embodiment, the case is explained where the first ECU 20 continuously estimates the reliability of the transmission signals, but such a configuration is not limiting and the estimation of the reliability of the transmission signals may be performed as appropriate. For example, the reliability of the transmission signals may be estimated when the frequency of transmission signals flowing in the network changes abnormally. As a result, the transmission signals can be adequately estimated. </p><p id="p0133" num="0133"> [0110] In the second embodiment, the case is explained where the "CAN ID" value "YY" is associated with the encrypted signal TS10 corresponding to the transmission signal TD10, but such a configuration is not limiting and the "CAN ID" value used in the encryption signal corresponding to the transmission signal may be also changed according to a predetermined rule. As a result, fraudulent use of the "CAN ID" and deception using the "CAN ID" can be made more difficult. </p><p id="p0134" num="0134"> [0111] In the second embodiment^ the case is explained where the authentication data are generated by using a hash function, but such a configuration is not limiting and the authentication data may be generated according to a predetermined calculation rule. As a result, the flexibility in designing the vehicle network system is increased. </p><p id="p0135" num="0135"> [0112] In the above-described embodiments, the case is explained where a key pair is generated by the first ECU 20, but such a configuration is not limiting and a key pair generated in advance may be also used. Where a key pair generated in advance is used, it may be distributed to each ECU in advance. As a result, the flexibility in designing the vehicle network system is increased. 
</p></description><claims mxw-id="PCLM44997925" ref-ucid="WO-2012120350-A2" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="34"/>--> CLAIMS: </claim-statement><claim id="clm-0001" num="1"><claim-text>1. A vehicle network system, comprising: </claim-text><claim-text> a plurality of control units provided on a vehicle and network-connected to each other communicatively, </claim-text><claim-text> the plurality of control units including: </claim-text><claim-text> a first control unit that has set therein a secret key from among the secret key and a public key that form a pair and are set by execution of initialization processing for activating the system; and </claim-text><claim-text> a second control unit that has set therein the public key, wherein </claim-text><claim-text> the second control unit is configured to create authentication information from the public key and information capable of specifying the second control device, add the authentication information to a communication signal to be transmitted to another control unit, and transmit the communication signal with the authentication information added thereto to the network; and </claim-text><claim-text> the first control unit is configured to acquire the authentication information that has been added to the communication signal transmitted from the second control unit and estimate reliability of the communication signal on the basis of the acquired authentication information and the secret key. </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. The vehicle network system according to claim 1, wherein </claim-text><claim-text> the second control unit is configured to divide the authentication information into a plurality of information pieces, successively add the divided authentication information that has been obtained by division to communication signals, and transmit the communication signals with the divided authentication information added thereto; and the first control unit is configured to receive successively the communication signals, reconfigure the authentication information before the division from the divided authentication information and estimate reliability of the communication signals on the basis of the reconfigured authentication information. <!-- EPO <DP n="35"/>--> </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. The vehicle network system according to claim 1 , wherein </claim-text><claim-text> the first control unit is configured to generate the. secret key and the public key by execution of the initialization processing- and sets the secret key to the first control unit itself and sets the public key to the second control unit. </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. The vehicle network system according to claim 3, wherein the first control unit sets the public key to the second control unit via the network. </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. The vehicle network system according to any one of claims 1 to 4, wherein the second control unit creates the authentication information at a timing at which the public key is set. </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. The vehicle network system according to any one of claims 1 to 5, wherein after creating the authentication information, the second control unit deletes the public key that has been set. </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. The vehicle network system according to any one of claims 1 to 6, wherein the second control unit transmits the authentication information to the network prior to transmitting the communication signal each time the vehicle network system is started, and the first control unit is configured to acquire and store the authentication information that has been received prior to receiving the communication signal from the second control unit and to estimate reliability of the communication signal by comparing the stored authentication information with the authentication information added to the communication signal. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. The vehicle network system according to any one of claims 1 to 7, wherein the first control unit is configured to prohibit use of a communication signal transmitted by the second control unit in the vehicle network system when determining that the <!-- EPO <DP n="36"/>--> communication signal is unreliable. </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. A vehicle network system, comprising: </claim-text><claim-text> a plurality of control units provided on a vehicle and network-connected to each other communicatively, </claim-text><claim-text> the plurality of control units including: </claim-text><claim-text> a first control unit that has set therein a secret key from among the secret key and a public key that form a pair and are set by execution of initialization processing for activating the system; and </claim-text><claim-text> a second control unit that has set therein the public key, wherein </claim-text><claim-text> the first control unit is configured to transmit a communication signal to another control unit via the network and also transmit an authentication signal created on the basis of the secret key and original authentication data generated on the basis of the communication signal; and </claim-text><claim-text> the second control unit is configured to receive the communication signal and the authentication signal and estimate reliability of the communication signal on the basis of comparison of reproduced authentication data generated on the basis of the received communication signal and decoded authentication data decoded on the basis of the authentication signal and the public key. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. The vehicle network system according to claim 9, wherein the first control unit is configured to generate the authentication signal by encrypting, with the secret key, the original authentication data calculated by applying a hash function to the communication signal, and the second control unit is configured to calculate the reproduced authentication data by applying the hash function to the received communication signal and estimate reliability of the communication signal on the basis of comparison of the reproduced authentication data with decoded authentication data obtained by decoding the authentication signal. <!-- EPO <DP n="37"/>--> </claim-text></claim><claim id="clm-0011" num="11"><claim-text>11. The vehicle network system according to claim 9 or 10, wherein the first control unit is configured to generate the secret key and the public key by execution of the initialization processing and sets the secret key to the first control unit itself and sets the public key to the second control unit. </claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. The vehicle network system according to claim 11, wherein the first control unit sets the public key to the second control unit via the network. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
