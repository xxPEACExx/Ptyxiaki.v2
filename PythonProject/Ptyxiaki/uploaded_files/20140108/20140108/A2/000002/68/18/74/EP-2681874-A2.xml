<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2681874-A2" country="EP" doc-number="2681874" kind="A2" date="20140108" family-id="46753993" file-reference-id="261541" date-produced="20180823" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146586414" ucid="EP-2681874-A2"><document-id><country>EP</country><doc-number>2681874</doc-number><kind>A2</kind><date>20140108</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12755660-A" is-representative="NO"><document-id mxw-id="PAPP154848606" load-source="docdb" format="epo"><country>EP</country><doc-number>12755660</doc-number><kind>A</kind><date>20120302</date><lang>EN</lang></document-id><document-id mxw-id="PAPP220440095" load-source="docdb" format="original"><country>EP</country><doc-number>12755660.3</doc-number><date>20120302</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140549863" ucid="US-201113040631-A" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201113040631</doc-number><kind>A</kind><date>20110304</date></document-id></priority-claim><priority-claim mxw-id="PPC140550937" ucid="US-2012027388-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>2012027388</doc-number><kind>W</kind><date>20120302</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL2104295833" load-source="docdb">H04L  29/06        20060101AFI20140730BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-2087958340" load-source="docdb" scheme="CPC">H04L  63/104       20130101 LI20150305BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2087961866" load-source="docdb" scheme="CPC">H04L  63/164       20130101 FI20150305BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2087962540" load-source="docdb" scheme="CPC">H04L  63/0272      20130101 LI20150305BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132363875" lang="DE" load-source="patent-office">IPSEC-VERBINDUNG ZU PRIVATEN NETZWERKEN</invention-title><invention-title mxw-id="PT132363876" lang="EN" load-source="patent-office">IPSEC CONNECTION TO PRIVATE NETWORKS</invention-title><invention-title mxw-id="PT132363877" lang="FR" load-source="patent-office">CONNEXION IPSEC À DES RÉSEAUX PRIVÉS</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR919507350" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>UNISYS CORP</last-name><address><country>US</country></address></addressbook></applicant><applicant mxw-id="PPAR919515648" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>UNISYS CORPORATION</last-name></addressbook></applicant><applicant mxw-id="PPAR919015500" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Unisys Corporation</last-name><iid>101219536</iid><address><street>801 Lakeview Dr. Suite 100 M/S 2NW</street><city>Blue Bell, PA 19422</city><country>US</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR919520155" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>JOHNSON ROBERT A</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919518548" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>JOHNSON, ROBERT, A.</last-name></addressbook></inventor><inventor mxw-id="PPAR919015806" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>JOHNSON, ROBERT, A.</last-name><address><street>4070 Prospect Hill Lane</street><city>Pottstown, PA 19464</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919532616" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>SADHU AVINASH</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR919540882" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>SADHU, AVINASH</last-name></addressbook></inventor><inventor mxw-id="PPAR919007296" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>SADHU, AVINASH</last-name><address><street>27226 Delemos</street><city>Mission Viejo, CA 92692</city><country>US</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR919008450" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Harrison Goddard Foote</last-name><iid>100060979</iid><address><street>Belgrave Hall Belgrave Street</street><city>Leeds LS2 8DD</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="US-2012027388-W"><document-id><country>US</country><doc-number>2012027388</doc-number><kind>W</kind><date>20120302</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012121996-A2"><document-id><country>WO</country><doc-number>2012121996</doc-number><kind>A2</kind><date>20120913</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS549838521" load-source="docdb">AL</country><country mxw-id="DS549760277" load-source="docdb">AT</country><country mxw-id="DS549838526" load-source="docdb">BE</country><country mxw-id="DS549838419" load-source="docdb">BG</country><country mxw-id="DS549914765" load-source="docdb">CH</country><country mxw-id="DS549838080" load-source="docdb">CY</country><country mxw-id="DS549760278" load-source="docdb">CZ</country><country mxw-id="DS549851888" load-source="docdb">DE</country><country mxw-id="DS549838527" load-source="docdb">DK</country><country mxw-id="DS549838081" load-source="docdb">EE</country><country mxw-id="DS549770637" load-source="docdb">ES</country><country mxw-id="DS549838420" load-source="docdb">FI</country><country mxw-id="DS549838421" load-source="docdb">FR</country><country mxw-id="DS549851889" load-source="docdb">GB</country><country mxw-id="DS549838528" load-source="docdb">GR</country><country mxw-id="DS549838529" load-source="docdb">HR</country><country mxw-id="DS549838086" load-source="docdb">HU</country><country mxw-id="DS549914766" load-source="docdb">IE</country><country mxw-id="DS549838558" load-source="docdb">IS</country><country mxw-id="DS549838426" load-source="docdb">IT</country><country mxw-id="DS549838087" load-source="docdb">LI</country><country mxw-id="DS549851906" load-source="docdb">LT</country><country mxw-id="DS549760279" load-source="docdb">LU</country><country mxw-id="DS549851907" load-source="docdb">LV</country><country mxw-id="DS549851908" load-source="docdb">MC</country><country mxw-id="DS549760662" load-source="docdb">MK</country><country mxw-id="DS549760663" load-source="docdb">MT</country><country mxw-id="DS549838559" load-source="docdb">NL</country><country mxw-id="DS549838427" load-source="docdb">NO</country><country mxw-id="DS549838560" load-source="docdb">PL</country><country mxw-id="DS549838428" load-source="docdb">PT</country><country mxw-id="DS549838561" load-source="docdb">RO</country><country mxw-id="DS549838429" load-source="docdb">RS</country><country mxw-id="DS549838582" load-source="docdb">SE</country><country mxw-id="DS549914767" load-source="docdb">SI</country><country mxw-id="DS549851909" load-source="docdb">SK</country><country mxw-id="DS549851914" load-source="docdb">SM</country><country mxw-id="DS549838088" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA100066146" ref-ucid="WO-2012121996-A2" lang="EN" load-source="patent-office"><p num="0000">A server hosting system and method of connecting to managed servers using IPsec are disclosed. The server hosting system includes a plurality of managed servers, and first and second secure communication appliances. The first secure communication appliance is configured to connect to a tenant appliance at a first tenant using an IPsee tunnel, and further configured to route data between a first managed server of the plurality of managed servers and the tenant appliance at the first tenant. The second secure communication appliance is configured to connect to a tenant appliance at a second tenant using an IPsec tunnel, and further configured to route data between a second managed server of the plurality of managed servers and the tenant appliance at the second tenant.</p></abstract><abstract mxw-id="PA100335254" ref-ucid="WO-2012121996-A2" lang="EN" source="national office" load-source="docdb"><p>A server hosting system and method of connecting to managed servers using IPsec are disclosed. The server hosting system includes a plurality of managed servers, and first and second secure communication appliances. The first secure communication appliance is configured to connect to a tenant appliance at a first tenant using an IPsee tunnel, and further configured to route data between a first managed server of the plurality of managed servers and the tenant appliance at the first tenant. The second secure communication appliance is configured to connect to a tenant appliance at a second tenant using an IPsec tunnel, and further configured to route data between a second managed server of the plurality of managed servers and the tenant appliance at the second tenant.</p></abstract><abstract mxw-id="PA100066147" ref-ucid="WO-2012121996-A2" lang="FR" load-source="patent-office"><p num="0000">La présente invention se rapporte à un système d'hébergement de serveurs et à un procédé de connexion à des serveurs gérés au moyen de l'ensemble de protocoles IPsec. Le système d'hébergement de serveurs selon l'invention comprend une pluralité de serveurs gérés ainsi que des premier et second modules de communication sécurisée. Le premier module de communication sécurisée est configuré de façon à se connecter à un module locataire à un premier locataire au moyen d'un tunnel IPsec. Le premier module de communication sécurisée est configuré d'autre part de façon à acheminer des données entre un premier serveur géré de la pluralité de serveurs gérés et le module locataire au premier locataire. Le second module de communication sécurisée est configuré de façon à se connecter à un module locataire à un second locataire au moyen d'un tunnel IPsec. Le premier module de communication sécurisée est configuré d'autre part de façon à acheminer des données entre un second serveur géré de la pluralité de serveurs gérés et le module locataire au second locataire.</p></abstract><abstract mxw-id="PA100335255" ref-ucid="WO-2012121996-A2" lang="FR" source="national office" load-source="docdb"><p>La présente invention se rapporte à un système d'hébergement de serveurs et à un procédé de connexion à des serveurs gérés au moyen de l'ensemble de protocoles IPsec. Le système d'hébergement de serveurs selon l'invention comprend une pluralité de serveurs gérés ainsi que des premier et second modules de communication sécurisée. Le premier module de communication sécurisée est configuré de façon à se connecter à un module locataire à un premier locataire au moyen d'un tunnel IPsec. Le premier module de communication sécurisée est configuré d'autre part de façon à acheminer des données entre un premier serveur géré de la pluralité de serveurs gérés et le module locataire au premier locataire. Le second module de communication sécurisée est configuré de façon à se connecter à un module locataire à un second locataire au moyen d'un tunnel IPsec. Le premier module de communication sécurisée est configuré d'autre part de façon à acheminer des données entre un second serveur géré de la pluralité de serveurs gérés et le module locataire au second locataire.</p></abstract><description mxw-id="PDES51372729" ref-ucid="WO-2012121996-A2" lang="EN" load-source="patent-office"><!-- EPO <DP n="2"/>--><p id="p0001" num="0001"> IPSEC CONNECTION TO PRIVATE NETWORKS </p><p id="p0002" num="0002">Technical Field </p><p id="p0003" num="0003"> The present disclosure relates generally to networking systems; in particular, the present disclosure relates to integration of an IPsec connection to private networks. </p><p id="p0004" num="0004">Background </p><p id="p0005" num="0005"> A server hosting system provides servers for use by multiple customers, or tenants. Computing devices in the server hosting system are located at one or more locations remote from the tenants. For instance, the computing devices in the server hosting system can be located at a premises occupied by a vendor, or offsite from the vendor. Use of server hosting systems is growing in popularity because a server hosting system can enable a tenant to divide the cost of implementing, maintaining, and running servers with other tenants. </p><p id="p0006" num="0006"> A server provided by a server hosting system is sometimes referred to as a managed server. A server hosting system can include a dedicated computing device that exclusively provides an individual managed server for a tenant. Alternatively, the server hosting system can include a computing device that provides multiple virtual managed servers. In this alternative scenario, each of the virtual managed servers functions like a separate server, even though the virtual managed servers are provided by a single computing device. </p><p id="p0007" num="0007"> Preferably, a tenant is able to readily access a managed server in a simple manner, to allow a managed server to approximate the convenience of a local server managed by that tenant. Access, in this context, includes administration of a server hosting system and managed servers included in such a system including adding or deleting managed servers, or controlling access to those managed servers to certain individuals associated with the tenant. To do so,, a tenant should be able to </p><p id="p0008" num="0008">communicate data securely with the server hosting system, and use any off-the-shelf 
<!-- EPO <DP n="3"/>-->
 networking devices to accomplish this connection. Additionally, the tenant must be able to identify the particular managed server within the server hosting system that the tenant wishes to access. </p><p id="p0009" num="0009"> In some cases, a server hosting system can be secured internally, to protect data exchanged among managed servers. For example, in the case where the managed servers are virtual managed servers, multiple tenants may share a set of those virtual managed servers, but those tenants may not be allowed access to each other's data. One example of such a server hosting system security arrangement is provided by the Stealth data parsing technology provided by Unisys Corporation of Blue Bell, Pennsylvania. However, to integrate this data parsing technology at a tenant, the tenant is required to install specialized software or use a particular secure appliance as a gateway to gain access to a server hosting system. In some circumstances, tenants prefer an off-the-shelf networking appliance that allows them to connect to their managed servers at a server hosting system. </p><p id="p0010" num="0010"> One method by which secured communication can be provided is through use of the Internet Protocol Security (IPsec) protocol suite. IPsec is an end-to- end security scheme operating in the Internet Layer of the Internet Protocol Suite. It can be used in protecting data communicated between hosts, gateways, or some combination thereof. IPsec secures IP communication by authenticating and encrypting each IP packet of a communication session. IPsec also includes protocols for establishing mutual authentication between computing systems at the beginning of a communications session and negotiation of cryptographic keys to be used during the session. </p><p id="p0011" num="0011"> Typically, to allow tenants to access managed servers, those tenants would be assigned a set of contiguous IP addresses, such that the server hosting system receiving data packets from a variety of tenants could use subnetting to determine the specific destination managed server for data received from a tenant. However, in these situations, IP addresses can quickly become exhausted, providing an unnecessary limitation on the number of tenants able to connect to a managed server in the server hosting system. Also, because, tenants are allowed to dynamically add and delete 
<!-- EPO <DP n="4"/>-->
 servers, server IP addresses are assigned in an unpredictable fashion. This results in non-contiguous IP addresses and segmentation of the available IP address space. Furthermore, because tenants are preferably allowed to assign their own IP addresses to managed servers, those tenants may in fact assign the same IP address to different servers, resulting in the case where two tenants may desire to use two different servers with the same IP address. </p><p id="p0012" num="0012"> Other arrangements use a tag in the IPsec communication packet that identifies the managed server that is the destination of the packet from the tenant. However, this approach requires use of a proprietary addition to the data packet that must be added by a tenant device, and therefore requires that tenants obtain specialized appliances that can handle routing of data packets by applying such tags. </p><p id="p0013" num="0013"> For these and other reasons, improvements are desirable. </p><p id="p0014" num="0014">Summary </p><p id="p0015" num="0015"> In accordance with the following disclosure, the above and other issues are addressed by the following: </p><p id="p0016" num="0016"> In a first aspect, a server hosting system is disclosed. The server hosting system includes a plurality of managed servers, and first and second secure </p><p id="p0017" num="0017">communication appliances. The first secure communication appliance is configured to connect to a tenant appliance at a first tenant using an IPsec tunnel, and further configured to route data between a first managed server of the plurality of managed servers and the tenant appliance at the first tenant. The second secure communication appliance is configured to connect to a tenant appliance at a second tenant using an IPsec tunnel, and further configured to route data between a second managed server of the plurality of managed servers and the tenant appliance at the second tenant. </p><p id="p0018" num="0018"> In a second aspect, a method of securing communications between a tenant and a server hosting system includes receiving data at a first secure </p><p id="p0019" num="0019">communication appliance from a tenant appliance at a first tenant, and applying a first tag to the data at the first secure communication appliance, the tag identifying the first 
<!-- EPO <DP n="5"/>-->
 tenant as the source of the data. The method also includes forwarding the data including the first tag to a first managed server associated with the first tenant. </p><p id="p0020" num="0020"> In a third aspect, a computer storage medium is disclosed. The computer storage medium includes computer-executable instructions, which when executed on a computing device in a server hosting system cause the computing device to provide a first secure communication appliance configured to receive a request to access a managed server from a tenant appliance at a first tenant via an IPsec connection, the first managed server including at least one virtual machine, applying a tag to the data, the tag identifying a virtual secure gateway associated with a tenant, and route the data including the tag to the managed server associated with the first tenant via a virtual local area network switch and the virtual secure gateway. </p><p id="p0021" num="0021">Brief Description of the Drawings </p><p id="p0022" num="0022"> Figure 1 is a block diagram illustrating an example embodiment in which multiple tenants use managed servers provided by a server hosting system; </p><p id="p0023" num="0023"> Figure 2 is a block diagram illustrating example details of an example communication interface to a server hosting system; </p><p id="p0024" num="0024"> Figure 3 is a block diagram illustrating further example details of the server hosting system; </p><p id="p0025" num="0025"> Figure 4 is a block diagram illustrating example details of a tenant cloud within the server hosting system; </p><p id="p0026" num="0026"> Figure 5 is a block diagram illustrating an example embodiment of a server hosting system implementing an IPsec connection, according to a possible embodiment; </p><p id="p0027" num="0027"> Figure 6 is a flowchart of a method for securing communications between a tenant and a managed server, according to a possible embodiment; </p><p id="p0028" num="0028"> Figure 7 is a block diagram illustrating example physical details of an electronic computing device, with which aspects of the present disclosure can be implemented. 
<!-- EPO <DP n="6"/>-->
 Detailed Description </p><p id="p0029" num="0029"> Various embodiments of the present invention will be described in detail with reference to the drawings, wherein like reference numerals represent like parts and assemblies throughout the several views. Reference to various embodiments does not limit the scope of the invention, which is limited only by the scope of the claims attached hereto. Additionally, any examples set forth in this specification are not intended to be limiting and merely set forth some of the many possible embodiments for the claimed invention. </p><p id="p0030" num="0030"> The logical operations of the various embodiments of the disclosure described herein are implemented as: (1) a sequence of computer implemented steps, operations, or procedures running on a programmable circuit within a computer, and/or (2) a sequence of computer implemented steps, operations, or procedures running on a programmable circuit within a directory system, database, or compiler. </p><p id="p0031" num="0031"> In general, the present disclosure relates to use of an IPsec connection and tenant-dedicated secure communications appliances to route tenant data and access requests to managed servers in a server hosting system that the tenant is authorized to access. By using dedicated appliances per tenant within the server hosting system, the tenant systems are not required to specially identify the data transmitted to the server hosting system via the IPsec connection, and therefore each tenant can use industry- standard, lower cost networking equipment. This extension of the server hosting system also provides increased flexibility in methods by which tenants can access managed servers. </p><p id="p0032" num="0032"> Figure 1 is a block diagram illustrating an example embodiment in which multiple tenants 100 A, 100B use managed servers 102 provided by a server hosting system 104. The tenants 100A and 100B are also referred to herein as the tenants 100. Although the example of Figure 1 shows only two tenants 100 and two managed servers 102, it should be appreciated that additional tenants can use managed servers provided by the server hosting system 104. The server hosting system 104 can provide additional managed servers. 
<!-- EPO <DP n="7"/>-->
 Each of the tenants 100 is an entity. The tenants 100 can be various types of entities. For example, one or more of the tenants 100 can be business entities, non-profit entities, individual people, government organizations, and so on. Each of the tenants 100 is associated with at least one user 106. The tenants 100 can be associated with the users 106 in various ways. For example, one or more of the users 106 can employees, agents, users, contractors, or customers of the tenants 100. In other examples, the users 106 can have other relationships with the tenants 100. </p><p id="p0033" num="0033"> The users 106 use computing devices 108. The computing devices 108 can be a variety of different types of computing devices. For example, the computing devices 108 can be personal computers, laptop computers, handheld computers, tablet computers, smart phones, in-car computers, gaming consoles, television set-top boxes, thin-client computers, and other types of computing devices. In some embodiments, one or more of the computing devices 08 are of the types described below with regard to Figure 7. </p><p id="p0034" num="0034"> The server hosting system 104 includes one or more computing devices.</p><p id="p0035" num="0035">For example, the server hosting system 104 can include one or more standalone server devices, blade server devices, data storage devices, personal computers, mainframe computers, routers, switches, intrusion detection devices, firewall devices, bridges, and other types of computing devices. In some embodiments, one or more of the computing devices in the server hosting system 104 are of the types described below with regard to Figure 7. </p><p id="p0036" num="0036"> The computing devices of the serveT hosting system 104 operate to provide the managed servers 102. The computing devices of the server hosting system 104 can operate in various ways to provide the managed servers 102. For example, a computing device in the server hosting system 104 can execute computer-executable instructions that cause the computing device to provide one of the managed servers 102. In another example, a computing device in the server hosting system 104 can include one or more application-specific integrated circuits (ASICs) that operate to provide one of the managed servers 102. 
<!-- EPO <DP n="8"/>-->
 In some embodiments, single computing devices in the server hosting system 104 can provide multiple ones of the managed servers 102 for use by the same or different ones of the tenants 100. In this case, the multiple managed servers provided by a single computing device are "virtual" managed servers. For example, one of the computing devices in the server hosting system 104 can run VMware® software. In this example, the VMware® software provides an operating environment in which multiple virtual managed servers run. In some embodiments, a single computing device of the server hosting system 104 can provide a single one of the managed servers 102 that is dedicated for use by one of the tenants 100. In other embodiments, a single computing device of the server hosting system 104 can provide two or more of the managed servers 102, each of which is dedicated for use by the same tenant 100, or different tenants. However, it is recognized that each of the managed servers 102 is to be associated to a tenant on a one-to-one or many-to-one basis; a managed server 102 is not, according to the embodiments disclosed herein, assigned to more than one tenant 100. </p><p id="p0037" num="0037"> The computing devices 108 used by the users 106 communicate with the server hosting system 104 via a communication network 1 10. The communication network 110 can include various types of communication networks. For example, the communication network 110 can include the Internet. In another example, the communication network 110 can include one or more wide-area networks, local-area networks, or other types of networks. The communication network 110 can include one or more wired or wireless communication links between computing devices connected to the communication network 110. </p><p id="p0038" num="0038"> Figure 2 is a block diagram illustrating details of an example communication interface to a server hosting system 104. In this embodiment, each of the tenants lOOa-b includes a tenant communication appliance, shown as client IPsec appliance 202a, 202b, respectively. The client IPsec devices 202a-b can collectively be referred to herein as client IPsec appliances 202. The client IPsec appliances 202 are network appliances capable of communicating with remote systems using an IPsec communication protocol. Details regarding the IPsec communication protocol are 
<!-- EPO <DP n="9"/>-->
 described in "Security Architecture for the Internet Protocol" published as RFC 4301, and related protocols, available at www.ietf.org. The client IPsec appliances 202 can, in certain embodiments, be generally available networking devices, for example a 5500 series security appliance available from Cisco Systems of San Jose, California. Other types of appliances could be used as well. </p><p id="p0039" num="0039"> The server hosting system 104 includes a secure communication appliance, shown as cloud IPsec appliance 204, associated with each tenant 100; in the embodiment shown, a first cloud IPsec appliance 204a communicates with a first client IPsec appliance 202a via an IPsec tunnel 205a, for example over the internet. Similarly, a second cloud IPsec appliance 204b communicates with a second client IPsec appliance 202b via a separate IPsec tunnel 205b. Although additional or fewer cloud IPsec appliances 204 could be included in the server hosting system, in the various embodiments described herein at least one cloud IPsec appliance 204 exists and is dedicated to communication with each tenant 100. The cloud IPsec appliances 204 can each also be, in certain embodiments, a 5500 series security appliance available from Cisco Systems of San Jose, California. Other types of appliances could be used as well. </p><p id="p0040" num="0040"> The server hosting system 104 also includes a switch 206 communicatively connected to each of the cloud IPsec appliances 204. The switch 206 is a layer 2 switch that collects and routes data (e.g., requests for communication with one or more managed servers) into a cloud 208, which can include any of a variety' of layouts of managed servers, for example virtual server systems logically arranged into a plurality of virtual local area networks (VLANs), as discussed below in connection with Figure 3. In certain embodiments, the switch 206 can be a Catalyst 3560 series switch as provided by Cisco Systems of San Jose, California. Other types of switches could be used as well. </p><p id="p0041" num="0041"> Figure 3 is a block diagram illustrating further details of the server hosting system 104. As illustrated in the example of Figure 3, the server hosting system 104 includes tenant clouds 300A, 300B, and 300C. Tenant clouds 300A, 300B, and 300C are also referred to herein collectively as the tenant clouds 300. Each of the tenant clouds 300 is associated with one of the tenants 100. As illustrated in Figure 3, 
<!-- EPO <DP n="10"/>-->
 it is preferable that one to one mapping of tenants and tenant clouds is maintained. Although the example of Figure 3 shows the server hosting system 104 as including only three tenant clouds, it should be appreciated that the server hosting system 104 can include more or fewer tenant clouds. </p><p id="p0042" num="0042"> Each of the tenant clouds 300 includes one or more managed servers, such as managed servers 102 of Figure 1. When the server hosting system 104 receives a data packet from an external system, for example via an IPsec tunnel 205a or 205b (referred to collectively as IPsec tunnels 205) to a cloud IPsec appliance 204, the system switch 302 receives the data packet, for example from another switch (such as switch 206 of Figure 2) and routes the data packet onto the system VLAN 304. Furthermore, the system switch 302 can route data from the system VLAN 304 to outbound portions of the server hosting system 104, for example the switch 206 and cloud IPsec appliances 204a-b of Figure 2. In various embodiments, the system switch 302 can be implemented in various ways. For example, the system switch 302 can be implemented using a specialized switch device. In this example, the specialized switch device routes packets in hardware and/or firmware. In another example, the system switch 302 can be implemented using a computing device that is not a specialized switch device. In this example, the computing device routes packets using application- or utility-level software. </p><p id="p0043" num="0043"> Referring now to Figure 4, a block diagram illustrating details of a tenant cloud 300, or tenant virtual local area network ("tenant VLAN") within the server hosting system 104 is shown. As shown in Figure 4, a tenant cloud connects to the system VLAN 304, and includes a virtual secure gateway (VSG) 402. The virtual secure gateway 402 receives data packets destined for one or more managed servers 102 within the tenant cloud 300. In certain embodiments, the virtual secure gateway is assigned an identifier, and receives data packets associated with that identifier, as discussed further in connection with Figure 5, below. </p><p id="p0044" num="0044"> The virtual secure gateway 402 also forms a secure communication session between each of the managed servers 102 that are a part of the tenant cloud 300 (as opposed to other tenant clouds associated with different, unaffiliated tenants). In 
<!-- EPO <DP n="11"/>-->
 this embodiment, the one or more managed servers 102 can be virtual systems configured to represent one or more computing systems accessible to a particular tenant, with the tenant associated w ith a "community" of users capable of accessing the managed servers within the tenant cloud 300. </p><p id="p0045" num="0045"> In some embodiments, the virtual secure gateway 402 shreds and encrypts each data packet received from the system VLAN 304, and recompiles data packets received from the managed servers 104. As such, within the tenant cloud, data communication is secure, while communication on the system VLAN 304 can occur in clear text to allow inspection and routing of packets by other infrastructure within the server hosting system 104. In some embodiments, this shredding and encryption at the virtual secure gateway 402 and managed servers 102 is accomplished using the Stealth data parsing technology provided by Unisys Corporation of Blue Bell, Pennsylvania. </p><p id="p0046" num="0046"> Referring now to Figure 5, a block diagram illustrating an example embodiment of an overall network 500 including a server hosting system implementing an IPsec connection is shown, according to a possible embodiment. The network 500 illustrates one example layout of the client and server hosting system arrangements of Figures 1-4, in which usage examples of IPsec connection to a server hosting system can be discussed. The network 500 includes a plurality of tenants 1 0, shown as first and second tenants 100a and 100b, respectively. The tenants, as previously discussed, include a plurality of users 106 and computing devices 108, and at least one client IPsec appliance 202. Each tenant 100 connects to the server hosting system 104 via a network 110, which can be, in various embodiments, an Internet connection, or any other network connection. Each client IPsec appliance 202 connects to a cloud IPsec appliance 204, where there is a cloud IPsec appliance dedicated to each tenant. The client IPsec appliance can, for example, be preprogrammed to connect only to a particular cloud IPsec appliance 204 at a particular network address. The cloud IPsec appliance 204 provides an encryption key to the client IPsec appliance 202, and the appliances 202, 204 form an IPsec tunnel for secure communication between the tenant 100 and the server hosting system 04. 
<!-- EPO <DP n="12"/>-->
 A switch 502 aggregates and routes data packets passing between the respective cloud IPsec appliance 204 and a VLAN switch 504. The switch can, in certain embodiments, be a layer two IP switch. In various embodiments, the switch 502 can correspond to one or more switches, or a "switch fabric", utilized to route data between cloud IPsec appliances 204 and the VLAN switch 504. </p><p id="p0047" num="0047"> The VLAN switch 504 is connected between the switch 502 and a plurality of virtual secure gateways 402a-c, which represent access points for corresponding tenant clouds as illustrated in Figure 3. In this embodiment, the virtual secure gateways 402a-c each provide access to managed servers 102 (shown by way of example with respect to virtual secure gateway 402a), and routing of packets between clients and respective tenant clouds associated with those clients. The virtual secure gateways 402a-c are therefore in this embodiment access points to virtual machines arranged into virtual local area networks (VLANs), such that one or more managed servers 102 are provided in each VLAN. The VLAN switch 504 routes data packets forwarded from the switch 502 to one of a plurality of virtual secure gateways 402a-c, which provide an access point for data destined for a particular virtual machine. In certain embodiments, the VLAN switch 504 can correspond to the system switch 302 of Figure 3. </p><p id="p0048" num="0048"> In certain embodiments, the virtual secure gatew ays 402a-c represent an entry point into a tenant-specific secure virtual network, or "tenant cloud", for example enabled using Stealth data parsing technology provided by Unisys Corporation of Blue Bell, Pennsylvania. As previously mentioned, each virtual secure gateway 402a-c can be identified with a particular gateway identifier, which resultingly identifies the tenant VLAN or cloud accessible by a particular tenant. </p><p id="p0049" num="0049"> In certain embodiments, the VLAN switch 504 inspects each data packet received from the switch 502, in particular a tag 510 identifying the destination managed server for the data packet. The tag 510 can, in certain embodiments, be applied by the cloud IPsec appliance 204 that receives the packet from a client 100. As such, each cloud IPsec appliance 204 applies a same unique tag to each packet it receives from a client, because only one client connects to each IPsec appliance. For 
<!-- EPO <DP n="13"/>-->
 example, in the illustration of Figure 5, cloud IPsec appliance 204a does not connect to client IPsec appliance 202b, and cloud IPsec appliance 204b does not connect to client IPsec appliance 202a, respectively. In some embodiments, the switch 502 and VLAN switch 504 can be incorporated into a single device, or multiple switching devices. </p><p id="p0050" num="0050"> In an example embodiment, the tag 510 can represent an identity of a virtual secure gateway to which the data packet is destined. For example, a cloud IPsec appliance 204a could be configured to apply a tag representing "Virtual Secure Gateway 1 " (VSG 506a) to a data packet 510, such that when the packet arrives at the VLAN switch 404, the packet is routed to the VSG identified by the tag, in this case, VSG 506a, Data packets routed from the virtual secure gateway can likewise be tagged with the identity of that VSG, such that the VLAN switch 504 and switch 502 is instructed to route those packets to the correct cloud IPsec appliance 204. Continuing the above example, packets tagged "Virtual Secure Gateway 1" from VSG 506a would only be routed to IPsec appliance 204a. </p><p id="p0051" num="0051"> In some embodiments, the tag 510 can be managed by an IPsec appliance 204 and the VLAN switch 504 in accordance with IEEE specification 802.1Q, available at http://standards.ieee.org . the specification of which is hereby incorporated by reference in its entirety. </p><p id="p0052" num="0052"> In the embodiment shown, a tenant 100 will configure their client IPsec device 202 to identify a particular cloud IPsec appliance 204 to which it will connect. Additionally, the tenant will identify a specific VLAN or group of managed servers that tenant has access to at the server hosting system 104. The cloud IPsec appliance 204 will provide to the client IPsec appliance 202 a preshared encryption key used to establish the IPsec tunnel between those devices. Through use of the dedicated cloud IPsec appliance 204 for each tenant and dedicated VSGs 402 for each tenant cloud, data can be secured and routed from a tenant to a managed server that the tenant wishes to access. </p><p id="p0053" num="0053"> In one possible example data flow illustrating a data packet 510 traveling from a tenant 100 to a managed server 102 (e.g., as a request for access to data or computing resources of that managed server), a user 106 will at a computing device 108 
<!-- EPO <DP n="14"/>-->
 will request access to a server, for example based on a name of that server or an application stored on the server. Authentication of the remote endpoint of an IPsec tunnel uses configuration and a pre-shared secret (key). The computing device 108 will form a data packet 510 including a request for access, and forward that request to the client IPsec appliance, e.g. appliance 202a. Once a tunnel is established, the data packet is transmitted, in encrypted form, over the IPsec tunnel, using encryption methods such as 3DES/SHA1 or other methods. </p><p id="p0054" num="0054"> The cloud IPsec appliance 204 will receive the data packet 510, and in certain embodiments, apply a tag 512 to the data packet identifying the source (e.g., the tenant) from which the data packet was received. For example, in the embodiment of Figure 5, cloud IPsec appliance 204a will include a tag identifying tenant 1 0a, based on the fact that the data packet was received from client IPsec appliance 202a. The data packet is then forwarded to switch 502, which passes the packet (along with other aggregated, tagged data packets from other cloud IPsec appliances) to the VLAN switch 504. </p><p id="p0055" num="0055"> At the VLAN switch 504, address information in the data packet 510 is examined to determine the intended destination for the data packet. The data packet 510 is then forwarded to the VLAN associated with that tenant and which includes the managed server identified by the address in the data packet 510. </p><p id="p0056" num="0056"> Figure 6 is a flowchart of a method for communicating between a tenant and a managed server is shown, according to a possible embodiment of the present disclosure. The method 600 includes a method of securing communication between the tenant and managed server. </p><p id="p0057" num="0057"> As illustrated, the method begins at a configuration operation 602, which configures one or more client IPsec appliances 202 and cloud IPsec appliances 204 at one or more tenants 100 and the server hosting system 104, respectively. This configuration can include, for example, exchange of an encryption key useable to establish the IPsec tunnel between devices, as well as selecting an encryption algorithm and authentication algorithm for use. 
<!-- EPO <DP n="15"/>-->
 A data receipt operation 604 corresponds to initial receipt at a cloud IPsec appliance 204 from a client IPsec appliance 202 of data from a tenant 100. The data can be a data packet addressed to a particular managed server 102, for example a virtual machine included within a tenant cloud 300 as illustrated in Figure 4. </p><p id="p0058" num="0058"> A tagging operation 606 occurs at the cloud IPsec appliance 204, and applies a tag identifying a tenant within the data packet received at that appliance. The tag can take a variety of forms, but identifies the tenant within the packet. </p><p id="p0059" num="0059"> A switch forwarding operation 608 forwards the data packet to a switch (e.g., switch 402 of Figure 4), for aggregation with other traffic received from IPsec appliances, and a VLAN switch forwarding operation 610 forwards that traffic, including the data packet, to a VLAN switch, such as the switch 502 of Figure 5. </p><p id="p0060" num="0060"> A secure connection creation operation 612 creates a secure connection between a virtual secure gateway and a managed server to secure data, such as the VSG 402 and managed server 102 of Figure 4. For example, the secure connection creation operation 612 can create a Stealth-enabled tunnel between a VSG and a particular virtual machine, so data exchanged within the tenant cloud cannot be observed by other tenants using the server hosting system 104. </p><p id="p0061" num="0061"> A managed server forwarding operation 614 occurs at the VLAN switch 504, and includes examination of the data packet and tag to (1) verify the intended destination of the data packet (i.e., the managed server identified by the header address in the data packet) and the identity of the tenant attempting to access that managed server. If the managed server is in a VLAN (tenant cloud) that the tenant is able to access, the data packet forwards the data packet to the identified managed server within the authorized VLAN. </p><p id="p0062" num="0062"> Figure 7 is a block diagram illustrating an example computing device</p><p id="p0063" num="0063">700. In some embodiments, the computing devices 108 and the computing devices in the server hosting system 104 are implemented as one or more computing devices like the computing device 700. It should be appreciated that in other embodiments, the computing devices 108 and computing devices in the server hosting system 104 are 
<!-- EPO <DP n="16"/>-->
 implemented using computing devices having hardware components other than those illustrated in the example of Figure 7. </p><p id="p0064" num="0064"> The term computer readable media as used herein may include computer storage media and communication media. As used in this document, a computer storage medium is a device or article of manufacture that stores data and/or computer- executable instructions. Computer storage media may include volatile and nonvolatile, removable and non-removable devices or articles of manufacture implemented in any method or technology for storage of information, such as computer readable instructions, data structures, program modules, or other data. By way of example, and not limitation, computer storage media may include dynamic random access memory (DRAM), double data rate synchronous dynamic random access memory (DDR </p><p id="p0065" num="0065">SDRAM), reduced latency DRAM, DDR2 SDRAM, DDR3 SDRAM, solid state memory, read-only memory (ROM), electrically-erasable programmable ROM, optical discs (e.g., CD-ROMs, DVDs, etc.), magnetic disks (e.g., hard disks, floppy disks, etc.), magnetic tapes, and other types of devices and/or articles of manufacture that store data. Communication media may be embodied by computer readable instructions, data structures, program modules, or other data in a modulated data signal, such as a carrier wave or other transport mechanism, and includes any information delivery media. The term "modulated data signal" may describe a signal that has one or more characteristics set or changed in such a manner as to encode information in the signal. By way of example, and not limitation, communication media may include wired media such as a w ired network or direct-wired connection, and wireless media such as acoustic, radio frequency (RF), infrared, and other wireless media. </p><p id="p0066" num="0066"> In the example of Figure 7, the computing device 700 includes a memory 702, a processing system 704, a secondary storage device 706, a network interface card 708, a video interface 710, a display unit 712, an external component interface 714, and a communication medium 716. The memory 702 includes one or more computer storage media capable of storing data and/or instructions. In different embodiments, the memory 702 is implemented in different ways. For example, the memory 702 can be implemented using various types of computer storage media. 
<!-- EPO <DP n="17"/>-->
 The processing system 704 includes one or more processing units. A processing unit is a physical device or article of manufacture comprising one or more integrated circuits that selectively execute software instructions. In various </p><p id="p0067" num="0067">embodiments, the processing system 704 is implemented in various ways. For example, the processing system 704 can be implemented as one or more processing cores. In another example, the processing system 704 can include one or more separate microprocessors. In yet another example embodiment, the processing system 704 can include an application-specific integrated circuit (ASIC) that provides specific functionality. In yet another example, the processing system 704 provides specific functionality by using an ASIC and by executing computer-executable instructions. </p><p id="p0068" num="0068"> The secondary storage device 706 includes one or more computer storage media. The secondary storage device 706 stores data and software instructions not directly accessible by the processing system 704. In other words, the processing system 704 performs an I/O operation to retrieve data and/or software instructions from the secondary storage device 706. In various embodiments, the secondary storage device 706 includes various types of computer storage media. For example, the secondary storage device 706 can include one or more magnetic disks, magnetic tape drives, optical discs, solid state memory devices, and/or other types of computer storage media. </p><p id="p0069" num="0069"> The netw ork interface card 708 enables the computing device 700 to send data to and receive data from a communication network. In different </p><p id="p0070" num="0070">embodiments, the network interface card 708 is implemented in different ways. For example, the network interface card 708 can be implemented as an Ethernet interface, a token-ring network interface, a fiber optic network interface, a wireless network interface (e.g., WiFi, WiMax, etc.), or another type of network interface. </p><p id="p0071" num="0071"> The video interface 710 enables the computing device 700 to output video information to the display unit 712. The display unit 712 can be various types of devices for displaying video information, such as a cathode-ray tube display, an LCD display panel, a plasma screen display panel, a touch-sensitive display panel, an LED screen, or a projector. The video interface 710 can communicate with the display unit 
<!-- EPO <DP n="18"/>-->
 712 in various ways, such as via a Universal Serial Bus (USB) connector, a VGA connector, a digital visual interface (DVI) connector, an S-Video connector, a High- Definition Multimedia Interface (HDMI) interface, or a DisplayPort connector. </p><p id="p0072" num="0072"> The external component interface 714 enables the computing device 700 to communicate with external devices. For example, the external component interface 714 can be a USB interface, a Fire Wire interface, a serial port interface, a parallel port interface, a PS/2 interface, and/or another type of interface that enables the computing device 700 to communicate with external devices. In various embodiments, the external component interface 714 enables the computing device 700 to communicate with various external components, such as external storage devices, input devices, speakers, modems, media player docks, other computing devices, scanners, digital cameras, and fingerprint readers. </p><p id="p0073" num="0073"> The communications medium 716 facilitates communication among the hardware components of the computing device 700, In the example of Figure 7, the communications medium 716 facilitates communication among the memory 702, the processing system 704, the secondary storage device 706, the network interface card 708, the video interface 710, and the external component interface 714. The </p><p id="p0074" num="0074">communications medium 716 can be implemented in various ways. For example, the communications medium 716 can include a PCI bus, a PCI Express bus, an accelerated graphics port (AGP) bus, a serial Advanced Technology Attachment (ATA) </p><p id="p0075" num="0075">interconnect, a parallel ATA interconnect, a Fiber Channel interconnect, a USB bus, a Small Computing system Interface (SCSI) interface, or another type of communications medium. </p><p id="p0076" num="0076"> The memory 702 stores various types of data and/or software instructions. For instance, in the example of Figure 7, the memory 702 stores a Basic</p><p id="p0077" num="0077">Input/Output System (BIOS) 718 and an operating system 720. The BIOS 718 includes a set of computer-executable instructions that, when executed by the processing system 704, cause the computing device 700 to boot up. The operating system 720 includes a set of computer-executable instructions that, when executed by the processing system 704, cause the computing device 700 to provide an operating system that coordinates 
<!-- EPO <DP n="19"/>-->
 the activities and sharing of resources of the computing device 700. Furthermore, the memory 702 stores application software 722. The application software 722 includes computer-executable instructions, that when executed by the processing sy stem 704, cause the computing device 700 to provide one or more applications. The memory 702 also stores program data 724. The program data 724 is data used by programs that execute on the computing device 700. </p><p id="p0078" num="0078"> Overall, a number of advantages of the methods and systems of the present disclosure exist. For example, tenant systems are not required to specially identify the data transmitted to the server hosting system via the IPsec connection, and therefore each tenant can use industry -standard, lower cost networking equipment.</p><p id="p0079" num="0079">Additionally, the cloud IPsec appliances as recited herein only are required to apply a single tag to the data packets received, since they are dedicated to a particular tenant. Furthermore, use of IPsec appliances provides a further way in which tenants can access managed servers in the server hosting system, thereby providing increased flexibility in connection methods. Additional advantages exist as well. </p><p id="p0080" num="0080"> The various embodiments described above are provided by way of illustration only and should not be construed as limiting. Those skilled in the art will readily recognize various modifications and changes that may be made without following the example embodiments and applications illustrated and described herein. For example, the operations shown in the figures are merely examples. In various embodiments, similar operations can include more or fewer steps than those shown in the figures. Furthermore, in other embodiments, similar operations can include the steps of the operations shown in the figures in different orders. Although the subject matter has been described in language specific to structural features and/or </p><p id="p0081" num="0081">methodological acts, it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described above. Rather, the specific features and acts described above are disclosed as example forms of implementing the claims. 
</p></description><claims mxw-id="PCLM44997297" ref-ucid="WO-2012121996-A2" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="20"/>--> Claims: </claim-statement><claim id="clm-0001" num="1"><claim-text>1. A server hosting system comprising: </claim-text><claim-text> a plurality of managed servers; </claim-text><claim-text> a first secure communication appliance configured to connect to a tenant appliance at a first tenant using an IPsec tunnel, the first secure communication appliance further configured to route data between a first managed server of the plurality of managed servers and the tenant appliance at the first tenant, the first managed server associated with the first tenant; </claim-text><claim-text> a second secure communication appliance configured to connect to a tenant appliance at a second tenant using an IPsec tunnel, the second secure </claim-text><claim-text>communication appliance further configured to route data between a second managed server of the plurality of managed servers and the tenant appliance at the second tenant, the second managed server associated with the second tenant. </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. The server hosting system of claim 1, wherein at least one of the first and second managed servers is assigned a tenant virtual local area network (VLAN). </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. The server hosting system of claim 1, wherein the first secure communication appliance is configured to apply a first tag to data received from the tenant appliance at the first tenant identifying the first tenant, and wherein the second secure communication appliance is configured to apply a second tag to data received from the tenant appliance at the second tenant identifying the second tenant.. </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. The server hosting system of claim 3, wherein the first tag identifies a virtual secure gateway associated with the first tenant, and the second tag identifies a second virtual secure gateway associated with a second tenant. </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. The server hosting system of claim 4, wherein the first virtual secure gateway is configured to establish a secure communication connection with at least the <!-- EPO <DP n="21"/>--> first managed server, and wherein the second virtual secure gateway is configured to establish a secure communication connection with at least the second managed server. </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. The server hosting system of claim 5, wherein the secure communication session comprises a Stealth-enabled encrypted communication session. </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. The server hosting system of claim 3, further comprising a switch communicatively connected to the first and second secure communication appliances, the switch configured to route data from the first secure communication appliance to the first managed server based at least in part on the tag identifying the first tenant and to route data from the second secure communication appliance to the second managed server based at least in part of the tag identifying the second tenant. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. The server hosting system of claim 7, wherein the switch is a virtual local area network (VLAN) switch. </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. The server hosting system of claim 7, further comprising a second switch communicatively connecting the VLAN switch to the first and second secure communication appliances. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. The server hosting system of claim 3, wherein the second secure communication appliance does not communicate with the tenant appliance at the first tenant, and the first secure communication appliance does not communicate with the tenant appliance at the second tenant. </claim-text></claim><claim id="clm-0011" num="11"><claim-text>11. The server hosting system of claim 3, wherein the IPsec tunnel between the first secure communication appliance and the tenant appliance at the first tenant is created using a key shared for authentication and data is encrypted using configured encryption methods with the tenant appliance at the first tenant from the first secure communication appliance. <!-- EPO <DP n="22"/>--> </claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. The server hosting system of claim 1, wherein at least one of the first and second managed servers comprises a virtual machine. </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. The server hosting system of claim 1, wherein the first and second managed servers each comprise a different virtual machine, and wherein the first and second managed servers execute on a common computing device. </claim-text></claim><claim id="clm-0014" num="14"><claim-text>14. A method of securing communications between a tenant and a server hosting system, the method comprising: </claim-text><claim-text> receiving data at a first secure communication appliance from a tenant appliance at a first tenant; </claim-text><claim-text> applying a first tag to the data at the first secure communication appliance, the tag identifying the first tenant as the source of the data; </claim-text><claim-text> forwarding the data including the first tag to a first managed server associated with the first tenant. </claim-text></claim><claim id="clm-0015" num="15"><claim-text>15. The method of claim 14, further comprising: </claim-text><claim-text> receiving data at a second secure communication appliance from a tenant appliance at a second tenant separate from the first tenant; </claim-text><claim-text> applying a second tag to the data at the first secure communication appliance, the tag identifying the second tenant as the source of the data; </claim-text><claim-text> forwarding the data including the second tag to a second managed server associated with the second tenant. </claim-text></claim><claim id="clm-0016" num="16"><claim-text>16. The method of claim 15, wherein the first and second managed servers each comprise a different virtual machine, and wherein the first and second managed servers execute on a common computing device. </claim-text></claim><claim id="clm-0017" num="17"><claim-text>17. The method of claim 15, wherein the second secure communication appliance does not communicate with the tenant appliance at the first tenant and the first <!-- EPO <DP n="23"/>--> secure communication appliance does not communicate with the tenant appliance at the second tenant. </claim-text></claim><claim id="clm-0018" num="18"><claim-text>18. The method of claim 14, wherein one or more of the plurality of managed servers is assigned a tenant virtual local area network (VLAN). </claim-text></claim><claim id="clm-0019" num="19"><claim-text>19. The method of claim 14, further comprising sharing an encryption key generated at the first secure communication device with the tenant device at the first tenant. </claim-text></claim><claim id="clm-0020" num="20"><claim-text>20. The method of claim 14, wherein receiving data at the first secure communication appliance includes receiving a request for access to data at the first managed server. </claim-text></claim><claim id="clm-0021" num="21"><claim-text>21. The method of claim 14, wherein the first secure communication appliance resides within a server hosting system. </claim-text></claim><claim id="clm-0022" num="22"><claim-text>22. The method of claim 14, wherein the first managed server is assigned to a first tenant virtual local area network (VLAN), and wherein data including the first tag is forwarded only to the first tenant VLAN. </claim-text></claim><claim id="clm-0023" num="23"><claim-text>23. A computer storage medium comprising computer-executable instructions, which when executed on a computing device in a server hosting system cause the computing device to provide a first secure communication appliance configured to: </claim-text><claim-text> receive a request to access a managed server from a tenant appliance at a first tenant via an IPsec connection, the first managed server including at least one virtual machine; </claim-text><claim-text> applying a tag to the data, the tag identifying a virtual secure gateway associated with a tenant; <!-- EPO <DP n="24"/>--> route the data including the tag to the managed server associated with the first tenant via a virtual local area network switch and the virtual secure gateway. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
