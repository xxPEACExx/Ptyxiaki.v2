<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2678707-A2" country="EP" doc-number="2678707" kind="A2" date="20140101" family-id="46653127" file-reference-id="294555" date-produced="20180826" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146550766" ucid="EP-2678707-A2"><document-id><country>EP</country><doc-number>2678707</doc-number><kind>A2</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12749647-A" is-representative="NO"><document-id mxw-id="PAPP154824689" load-source="docdb" format="epo"><country>EP</country><doc-number>12749647</doc-number><kind>A</kind><date>20120216</date><lang>EN</lang></document-id><document-id mxw-id="PAPP220438242" load-source="docdb" format="original"><country>EP</country><doc-number>12749647.9</doc-number><date>20120216</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140450275" ucid="IB-2012050714-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>IB</country><doc-number>2012050714</doc-number><kind>W</kind><date>20120216</date></document-id></priority-claim><priority-claim mxw-id="PPC140446746" ucid="US-201161445276-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201161445276</doc-number><kind>P</kind><date>20110222</date></document-id></priority-claim><priority-claim mxw-id="PPC140449463" ucid="US-201161487355-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201161487355</doc-number><kind>P</kind><date>20110518</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988098941" load-source="docdb">G01S   7/38        20060101ALI20130912BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988112814" load-source="docdb">G01S   7/36        20060101AFI20130912BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-2142243833" load-source="docdb" scheme="CPC">H04K   3/827       20130101 LI20141029BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2142247334" load-source="docdb" scheme="CPC">H04K   3/43        20130101 FI20141029BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2142247659" load-source="docdb" scheme="CPC">H04K2203/34        20130101 LA20141029BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2142248668" load-source="docdb" scheme="CPC">H04K   3/825       20130101 LI20141029BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2142248924" load-source="docdb" scheme="CPC">H04K2203/32        20130101 LA20141029BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2142249801" load-source="docdb" scheme="CPC">H04K   3/45        20130101 LI20141029BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132184782" lang="DE" load-source="patent-office">WIRELESS-SICHERHEIT AUF PHY-EBENE</invention-title><invention-title mxw-id="PT132184783" lang="EN" load-source="patent-office">PHY-LEVEL WIRELESS SECURITY</invention-title><invention-title mxw-id="PT132184784" lang="FR" load-source="patent-office">SÉCURITÉ SANS FIL DE NIVEAU PHYSIQUE</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR918167524" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>CELENO COMM ISRAEL LTD</last-name><address><country>IL</country></address></addressbook></applicant><applicant mxw-id="PPAR918143211" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>CELENO COMMUNICATIONS (ISRAEL) LTD.</last-name></addressbook></applicant><applicant mxw-id="PPAR918981900" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Celeno Communications (Israel) Ltd.</last-name><iid>101324285</iid><address><street>26 Zarhin Street</street><city>43662 Ra'anana</city><country>IL</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918133397" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>SHANY YARON</last-name><address><country>IL</country></address></addressbook></inventor><inventor mxw-id="PPAR918144622" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>SHANY, YARON</last-name></addressbook></inventor><inventor mxw-id="PPAR918993195" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>SHANY, YARON</last-name><address><street>25B Sirkin Street</street><city>44421 Kfar Saba</city><country>IL</country></address></addressbook></inventor><inventor mxw-id="PPAR918134666" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>SHAPIRA NIR</last-name><address><country>IL</country></address></addressbook></inventor><inventor mxw-id="PPAR918157257" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>SHAPIRA, NIR</last-name></addressbook></inventor><inventor mxw-id="PPAR918983645" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>SHAPIRA, NIR</last-name><address><street>5 Gutman Street</street><city>43590 Ra'anana</city><country>IL</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918978823" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Modiano, Micaela Nadia</last-name><suffix>et al</suffix><iid>101122928</iid><address><street>Modiano &amp; Partners Thierschstrasse 11</street><city>80538 München</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="IB-2012050714-W"><document-id><country>IB</country><doc-number>2012050714</doc-number><kind>W</kind><date>20120216</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012114233-A2"><document-id><country>WO</country><doc-number>2012114233</doc-number><kind>A2</kind><date>20120830</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS548916102" load-source="docdb">AL</country><country mxw-id="DS548917461" load-source="docdb">AT</country><country mxw-id="DS548916103" load-source="docdb">BE</country><country mxw-id="DS548813377" load-source="docdb">BG</country><country mxw-id="DS548924729" load-source="docdb">CH</country><country mxw-id="DS548861501" load-source="docdb">CY</country><country mxw-id="DS548917462" load-source="docdb">CZ</country><country mxw-id="DS548901642" load-source="docdb">DE</country><country mxw-id="DS548861502" load-source="docdb">DK</country><country mxw-id="DS548861503" load-source="docdb">EE</country><country mxw-id="DS548915481" load-source="docdb">ES</country><country mxw-id="DS548813378" load-source="docdb">FI</country><country mxw-id="DS548813379" load-source="docdb">FR</country><country mxw-id="DS548916104" load-source="docdb">GB</country><country mxw-id="DS548916105" load-source="docdb">GR</country><country mxw-id="DS548916106" load-source="docdb">HR</country><country mxw-id="DS548917463" load-source="docdb">HU</country><country mxw-id="DS548924730" load-source="docdb">IE</country><country mxw-id="DS548916107" load-source="docdb">IS</country><country mxw-id="DS548813380" load-source="docdb">IT</country><country mxw-id="DS548861504" load-source="docdb">LI</country><country mxw-id="DS548901643" load-source="docdb">LT</country><country mxw-id="DS548917464" load-source="docdb">LU</country><country mxw-id="DS548901644" load-source="docdb">LV</country><country mxw-id="DS548901645" load-source="docdb">MC</country><country mxw-id="DS548833898" load-source="docdb">MK</country><country mxw-id="DS548833899" load-source="docdb">MT</country><country mxw-id="DS548916108" load-source="docdb">NL</country><country mxw-id="DS548813381" load-source="docdb">NO</country><country mxw-id="DS548916109" load-source="docdb">PL</country><country mxw-id="DS548924731" load-source="docdb">PT</country><country mxw-id="DS548916110" load-source="docdb">RO</country><country mxw-id="DS548924732" load-source="docdb">RS</country><country mxw-id="DS548916111" load-source="docdb">SE</country><country mxw-id="DS548924733" load-source="docdb">SI</country><country mxw-id="DS548901646" load-source="docdb">SK</country><country mxw-id="DS548901647" load-source="docdb">SM</country><country mxw-id="DS548861505" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA99623602" ref-ucid="WO-2012114233-A2" lang="EN" load-source="patent-office"><p num="0000">A method for communication includes generating one or more data streams for transmission to respective target receivers (28), and one or more jamming streams. At least one parameter, selected from a group of parameters consisting of power ratios for allocation to the jamming streams and Modulation and Coding Schemes (MCSs) for assigning to the data streams, is calculated based on a criterion that is set to reduce a probability of the data streams being decoded by at least one eavesdropping receiver (32). The data streams and the jamming streams are transmitted using an antenna array (34) while applying the at least one parameter.</p></abstract><abstract mxw-id="PA99822421" ref-ucid="WO-2012114233-A2" lang="EN" source="national office" load-source="docdb"><p>A method for communication includes generating one or more data streams for transmission to respective target receivers (28), and one or more jamming streams. At least one parameter, selected from a group of parameters consisting of power ratios for allocation to the jamming streams and Modulation and Coding Schemes (MCSs) for assigning to the data streams, is calculated based on a criterion that is set to reduce a probability of the data streams being decoded by at least one eavesdropping receiver (32). The data streams and the jamming streams are transmitted using an antenna array (34) while applying the at least one parameter.</p></abstract><abstract mxw-id="PA99623603" ref-ucid="WO-2012114233-A2" lang="FR" load-source="patent-office"><p num="0000">Un procédé de communication consiste à générer un ou plusieurs flux de données, qui seront transmis à des récepteurs cibles respectifs (28), et un ou plusieurs flux de brouillage. Au moins un paramètre, sélectionné parmi un groupe de paramètres comportant des taux de puissance pour une allocation aux flux de brouillage et des schémas de modulation et de codage (MCS) pour une attribution aux flux de données, est calculé sur la base d'un critère qui est défini pour réduire la probabilité que les flux de données soient décodés par au moins un récepteur d'écoute clandestine (32). Les flux de données et les flux de brouillage sont transmis à l'aide d'un réseau d'antennes (34) tout en appliquant ledit ou lesdits paramètres.</p></abstract><abstract mxw-id="PA99822422" ref-ucid="WO-2012114233-A2" lang="FR" source="national office" load-source="docdb"><p>Un procédé de communication consiste à générer un ou plusieurs flux de données, qui seront transmis à des récepteurs cibles respectifs (28), et un ou plusieurs flux de brouillage. Au moins un paramètre, sélectionné parmi un groupe de paramètres comportant des taux de puissance pour une allocation aux flux de brouillage et des schémas de modulation et de codage (MCS) pour une attribution aux flux de données, est calculé sur la base d'un critère qui est défini pour réduire la probabilité que les flux de données soient décodés par au moins un récepteur d'écoute clandestine (32). Les flux de données et les flux de brouillage sont transmis à l'aide d'un réseau d'antennes (34) tout en appliquant ledit ou lesdits paramètres.</p></abstract><description mxw-id="PDES50930903" ref-ucid="WO-2012114233-A2" lang="EN" load-source="patent-office"><!-- EPO <DP n="2"/>--><p id="p0001" num="0001"> PHY-LEVEL WIRELESS SECURITY </p><p id="p0002" num="0002">CROSS-REFERENCE TO RELATED APPLICATIONS</p><p id="p0003" num="0003">This application claims the benefit of U.S. Provisional Patent Application 61/445,276, filed February 22, 2011, and U.S. Provisional Patent Application 61/487,355, filed May 18, 2011, whose disclosures are incorporated herein by reference. </p><p id="p0004" num="0004">FIELD OF THE INVENTION </p><p id="p0005" num="0005"> The present invention relates generally to communication systems, and particularly to methods and systems for securing wireless communication. </p><p id="p0006" num="0006"> BACKGROUND OF THE INVENTION </p><p id="p0007" num="0007"> Some wireless communication systems apply physical-layer (PHY) mechanisms for securing transmissions from illegitimate eavesdropping. For example, U.S. Patent 7,672,400, whose disclosure is incorporated herein by reference, describes a method for secure communication in a wireless network using a spatial division multiple access transmission scheme. The method includes allocating transmission power to N channels to be transmitted to one or more destination stations by N antennas, such that the power to be received by each one of the one or more destination stations is not greater by more than a predefined power margin than a minimum power required for reception at a desired quality of service. </p><p id="p0008" num="0008"> As another example, U.S. Patent 7,751,353, whose disclosure is incorporated herein by reference, describes a method for securing a wireless transmission. The method includes transmitting a noise transmission to be received by one or more destinations other than an intended destination of a packet during a time period corresponding to the duration of the packet. </p><p id="p0009" num="0009"> Additional examples of secure transmission schemes are described by Goel and Negi, in "Guaranteeing Secrecy using Artificial Noise," IEEE Transactions on Wireless Communications, volume 7, no. 6, June, 2008, pages 2180-2189; and by Swindlehurst, in "Fixed SINR Solutions for the MIMO Wiretap Channel," Proceedings of the International Conference on Acoustics, Speech and Signal Processing, Taipei, Taiwan, April, 2009, pages 2437-2440, which are incorporated herein by reference. </p><p id="p0010" num="0010"> SUMMARY OF THE INVENTION </p><p id="p0011" num="0011"> A method for communication includes generating one or more data streams for transmission to respective target receivers, and one or more jamming streams. At least one parameter, selected from a group of parameters consisting of power ratios for allocation to the 
<!-- EPO <DP n="3"/>-->
 jamming streams and Modulation and Coding Schemes (MCSs) for assigning to the data streams, is calculated based on a criterion that is set to reduce a probability of the data streams being decoded by at least one eavesdropping receiver. The data streams and the jamming streams are transmitted using an antenna array while applying the at least one parameter. </p><p id="p0012" num="0012"> In some embodiments, calculating the at least one parameter includes restricting selection of an MCS for a given data stream to a partial subset of the MCSs. Restricting the selection of the MCS may include defining the partial subset of the MCSs based on the power ratios and assumed or pre-measured channel statistics of communication channels between the antenna array and the target receivers. </p><p id="p0013" num="0013"> In an embodiment, restricting the selection of the MCS includes predefining multiple partial subsets of the MCSs corresponding to respective channel types between the antenna array and the target receivers, determining an actual channel type and selecting the predefined partial subset that corresponds to the actual channel type. In another embodiment, restricting the selection of the MCS includes including in the partial subset only the MCSs having at least a selected minimum data rate. </p><p id="p0014" num="0014"> In a disclosed embodiment, calculating the at least one parameter includes setting a power ratio of a given jamming stream at a fixed value. In another embodiment, calculating the at least one parameter includes adapting the power ratios based on Channel State Information (CSI) of communication channels between the antenna array and the target receivers. </p><p id="p0015" num="0015"> There is additionally provided, in accordance with an embodiment of the present invention, a communication apparatus including data generation circuitry, jamming generation circuitry and transmission circuitry. The data generation circuitry is configured to generate one or more data streams for transmission to respective target receivers. The jamming generation circuitry is configured to generate one or more jamming streams. The control unit is configured to calculate at least one parameter selected from a group of parameters consisting of power ratios for allocation to the jamming streams and Modulation and Coding Schemes (MCSs) for assigning to the data streams, based on a criterion that is set to reduce a probability of the data streams being decoded by at least one eavesdropping receiver. The transmission circuitry is configured to transmit the data streams and the jamming streams using an antenna array while applying the at least one parameter. </p><p id="p0016" num="0016"> There is also provided, in accordance with an embodiment of the present invention, a method for communication. The method includes generating a data transmission including multiple successive parts in respective time intervals, for transmission to a target receiver. At 
<!-- EPO <DP n="4"/>-->
 least one jamming transmission is generated, having a configuration that varies over the respective time intervals corresponding to the parts of the data transmission, including at least first and second different configurations generated during respective first and second time intervals. The data transmission is transmitted to the target receiver using an antenna array, and the at least one jamming transmission is transmitted simultaneously using the antenna array. </p><p id="p0017" num="0017"> In an embodiment, generating the jamming transmission includes generating a first number of jamming streams during the first time interval, and a second number of the jamming streams, different from the first number, during the second time interval. In another embodiment, generating the jamming transmission includes beamforming the jamming transmission using a first beamforming vector during the first time interval, and beamforming the jamming transmission using a second beamforming vector, different from the first beamforming vector, during the second time interval. </p><p id="p0018" num="0018"> In yet another embodiment, generating the jamming transmission includes inhibiting the jamming transmission during the first time interval, and enabling the jamming transmission during the second time interval. In still another embodiment, generating the jamming transmission includes producing the jamming transmission at a first power level during the first time interval, and producing the jamming transmission at a second power level, different from the first power level, during the second time interval. </p><p id="p0019" num="0019"> In a disclosed embodiment, generating the data transmission includes generating a communication packet, the first time interval includes one or more fields other than a payload of the packet, and the second time interval includes the payload of the packet. In some embodiments, the first and second time intervals occur in respective different first and second communication frames, and the method includes applying in the target receiver a first receive beamforming vector during the first time interval and a second receive beamforming vector, different from the first receive beamforming vector, during the second time interval, so as to cause the configuration of the jamming transmission to vary over the respective time intervals. </p><p id="p0020" num="0020"> There is further provided, in accordance with an embodiment of the present invention, a communication apparatus including data generation circuitry, jamming generation circuitry and transmission circuitry. The data generation circuitry is configured to generate a data transmission including multiple successive parts in respective time intervals, for transmission to a target receiver. The jamming generation circuitry is configured to generate at least one jamming transmission having a configuration that varies over the respective time intervals corresponding to the parts of the data transmission, including at least first and second different 
<!-- EPO <DP n="5"/>-->
 configurations generated during respective first and second time intervals, the transmission circuitry is configured to transmit the data transmission to the target receiver using an antenna array, and to simultaneously transmit the at least one jamming transmission using the antenna array. </p><p id="p0021" num="0021"> There is additionally provided, in accordance with an embodiment of the present invention, a method for communication. The method includes generating, for transmission from multiple transmit antennas, one or more data streams for transmission to respective target receivers and one or more jamming streams. Respective beamforming vectors are calculated for the jamming streams by applying QR factorization to a conjugate of an aggregate matrix of communication channels between the transmit antennas and receive antennas of all the target receivers, to produce a Q matrix; extracting a subset of columns of the Q matrix to serve as a basis for a vector subspace that is orthogonal to the aggregate matrix of the communication channels; and calculating the beamforming vectors for the jamming streams from the basis. The jamming streams are beam-formed using the calculated beamforming vectors. The data streams are transmitted to the target receivers using the multiple transmit antennas, and the jamming streams are simultaneously transmitted using the multiple transmit antennas. </p><p id="p0022" num="0022"> In some embodiments, extracting the subset of the columns includes extracting last N-</p><p id="p0023" num="0023">NTJ columns of the Q matrix, N denoting a total number of the transmit antennas, and NTJ denoting a total number of the receive antennas of all the target receivers. In an embodiment, the aggregate matrix of communication channels is replaced by a matrix obtained from one or more Singular Value Decompositions (SVD) of matrices of the communication channels, which are produced by the target receivers. </p><p id="p0024" num="0024"> There is also provided, in accordance with an embodiment of the present invention, a communication apparatus including data generation circuitry, jamming generation circuitry and a control unit. The data generation circuitry is configured to generate one or more data streams for transmission to respective target receivers from multiple transmit antennas. The jamming generation circuitry is configured to generate one or more jamming streams. The control unit is configured to calculate respective beamforming vectors for the jamming streams by applying QR factorization to a conjugate of an aggregate matrix of communication channels between the transmit antennas and receive antennas of all the target receivers to produce a Q matrix, extracting a subset of columns of the Q matrix to serve as a basis for a vector subspace that is orthogonal to the aggregate matrix of the communication channels, and calculating the beamforming vectors for the jamming streams from the basis. The transmission 
<!-- EPO <DP n="6"/>-->
 circuitry is configured to beam-form the jamming streams using the calculated beamforming vectors, to transmit the data streams to the target receivers using the multiple transmit antennas, and to simultaneously transmit the jamming streams using the multiple transmit antennas. </p><p id="p0025" num="0025"> There is further provided, in accordance with an embodiment of the present invention, a method for communication. The method includes receiving uplink signals from one or more communication stations. Responses of downlink communication channels to the communication stations are estimated based on the received uplink signals. One or more data streams for transmission using an antenna array to the communication stations and one or more jamming streams for transmission using the antenna array are configured based on the estimated downlink communication channels. The configured data streams and jamming streams are transmitted. </p><p id="p0026" num="0026"> In some embodiments, the method includes instructing the communication stations to transmit training signals that provide channel information relating to communication channels to all receive antennas of the communication stations. In some embodiments, the method includes instructing a communication station to disable one or more receive chains in the communication station. </p><p id="p0027" num="0027"> There is additionally provided, in accordance with an embodiment of the present invention, a communication apparatus including a control unit and transmission circuitry. The control unit is configured to estimate, based on uplink signals that are received from one or more communication stations, responses of downlink communication channels to the communication stations, and to configure, based on the estimated downlink communication channels, one or more data streams for transmission using an antenna array to the communication stations and one or more jamming streams for transmission using the antenna array. The transmission circuitry is configured to transmit the data streams and jamming streams. </p><p id="p0028" num="0028"> There is further provided, in accordance with an embodiment of the present invention, a method for communication in a transmitter that transmits one or more data streams to respective target receivers and one or more jamming streams for preventing the data streams from being decoded by eavesdropping receivers. The method includes holding a definition of at least first and second transmission modes having respective, different first and second levels of security in preventing the data streams from being decoded by the eavesdropping receivers. One of the first and second transmission modes is selected for transmitting a data stream to a 
<!-- EPO <DP n="7"/>-->
 target receiver, by evaluating a selection criterion. The data stream and the jamming streams are transmitted via an antenna array using the selected transmission mode. </p><p id="p0029" num="0029"> In some embodiments, transmitting the data stream using the first transmission mode includes transmitting at least one jamming stream simultaneously with the data stream, and transmitting the data stream using the second transmission mode includes transmitting the data stream while inhibiting transmission of the jamming streams. In some embodiments, selecting the transmission mode includes selecting a data rate for the data stream using a first rule, and transmitting the data stream using the second transmission mode includes selecting the data rate using a second rule, different from the first rule. </p><p id="p0030" num="0030"> In an embodiment, transmitting the data stream using the first transmission mode includes transmitting channel sounding signals at first time intervals, and transmitting the data stream using the second transmission mode includes transmitting the channel sounding signals at second time intervals, more frequent than the first intervals. In another embodiment, selecting the transmission mode includes instructing the target receiver to respond to sounding requests prior to association with any transmitter while operating in the first transmission mode, and to respond to sounding requests only after the association while operating in the second transmission mode. </p><p id="p0031" num="0031"> In yet another embodiment, evaluating the selection criterion includes choosing between the first and second transmission mode depending on a Service Set ID (SSID) with which the target receiver is associated. In still another embodiment, transmitting the data stream using the first transmission mode includes transmitting a jamming stream during a first subset of frames of the data stream, and transmitting the data stream using the second transmission mode includes transmitting the jamming stream during a second subset of the frames of the data stream, different from the first subset. In an embodiment, selecting the transmission mode includes receiving a request from the target receiver to select the one of the first and second transmission modes, and choosing the transmission mode in response to the request. </p><p id="p0032" num="0032"> In a disclosed embodiment, selecting the transmission mode includes instructing the target receiver to disable one or more receive chains in the target receiver when operating in the first transmission mode, and to enable the one or more receive chains when operating in the second transmission mode. In another embodiment, selecting the transmission mode includes instructing the target receiver to transmit, when operating in the first transmission mode, channel feedback that is indicative of all receive antennas of the target receiver. 
<!-- EPO <DP n="8"/>-->
 In yet another embodiment, selecting the transmission mode includes extracting from the data stream a tag that indicates a requested transmission mode, and selecting the transmission mode responsively to the tag. In still another embodiment, selecting the transmission mode includes detecting an exchange of Request- To-Send/Clear- To-Send (RTS/CTS) messages that precedes the data stream, from which an identity of a target receiver intended to receive the data stream is recognizable, and initiating the transmission mode based on the detected RTS/CTS messages. </p><p id="p0033" num="0033"> There is further provided, in accordance with an embodiment of the present invention, a communication apparatus including transmission circuitry and a control unit. The transmission circuitry is configured to transmit data streams to target receivers and jamming streams for preventing the data streams from being decoded by eavesdropping receivers, the a control unit is configured to hold a definition of at least first and second transmission modes having respective, different first and second levels of security in preventing the data streams from being decoded by the eavesdropping receivers, to select one of the first and second transmission modes for transmitting a data stream to a target receiver by evaluating a selection criterion, and to control the transmission circuitry to transmit the data stream and the jamming streams via an antenna array using the selected transmission mode. </p><p id="p0034" num="0034"> The present invention will be more fully understood from the following detailed description of the embodiments thereof, taken together with the drawings in which: BRIEF DESCRIPTION OF THE DRAWINGS </p><p id="p0035" num="0035"> Fig. 1 is a block diagram that schematically illustrates a wireless communication system that uses physical-layer security, in accordance with an embodiment of the present invention; </p><p id="p0036" num="0036"> Fig. 2 is a block diagram that schematically illustrates a transmitter of a wireless Access Point (AP), in accordance with an embodiment of the present invention; </p><p id="p0037" num="0037"> Fig. 3 is a block diagram that schematically illustrates a wireless communication system that uses physical-layer security, in accordance with an alternative embodiment of the present invention; and </p><p id="p0038" num="0038"> Figs. 4-10 are flow charts that schematically illustrate methods for physical-layer security, in accordance with embodiments of the present invention. 
<!-- EPO <DP n="9"/>-->
 DETAILED DESCRIPTION OF EMBODIMENTS </p><p id="p0039" num="0039">OVERVIEW </p><p id="p0040" num="0040"> Embodiments of the present invention that are described herein provide improved methods and systems for physical-layer security. The disclosed techniques are used in a communication system in which one or more transmitters transmit data streams to legitimate receivers, e.g., using beamforming, and apply means for protecting the data streams from being decoded by at least one eavesdropping receivers. The embodiments described herein refer to beam-formed data streams that are transmitted to the legitimate receivers, but the disclosed techniques are also applicable in schemes that transmit the data streams to the legitimate receivers without beamforming. </p><p id="p0041" num="0041"> In order to protect against eavesdropping, the transmitters transmit one or more jamming streams, which are beam-formed so as to degrade the reception quality of the data streams at an eavesdropping receiver with little or no degradation at the legitimate receivers. Typically, no assumptions are made as to the location or properties of the eavesdropping receiver. The jamming streams may be transmitted by the same transmitter that transmits the data streams, or by a separate device referred to as a sentinel. </p><p id="p0042" num="0042"> Some disclosed embodiments provide techniques for adaptively selecting the fraction of transmit power allocated to the jamming streams, and/or the Modulation and Coding Scheme (MCS) to be used for transmitting the data stream, so as to maintain optimal security. Other disclosed embodiments use different jamming stream configurations, e.g., modify the number of jamming streams or their beamforming vectors, for different parts of the data stream. Other disclosed techniques compute the beamforming vectors for the jamming streams by performing QR factorization of the aggregate channel matrix between the transmitter antennas and all legitimate receiver antennas. </p><p id="p0043" num="0043"> In some embodiments, the transmitters configure the data streams and jamming streams based on implicit channel feedback. In these schemes, the transmitters assume that the uplink and downlink channels are reciprocal, and estimate the channels from uplink signals transmitted by the legitimate receivers. These schemes provide a high degree of security, relative to schemes in which the receivers send to the transmitters channel feedback that can be intercepted and exploited by the eavesdropping receiver. </p><p id="p0044" num="0044"> In other disclosed embodiments, the transmitters choose between multiple transmission modes that provide different levels of security in preventing decoding of data streams by eavesdropping receivers. Several example transmission modes and selection criteria are 
<!-- EPO <DP n="10"/>-->
 described herein. Mode selection may be decided by the transmitters or by the legitimate receivers. In some embodiments, the receivers are configured differently in each transmission mode. </p><p id="p0045" num="0045"> The methods and systems described herein improve the effectiveness of physical-layer security. At the same time, the disclosed techniques reduce the performance degradation and communication overhead that is associated with transmission of jamming streams. </p><p id="p0046" num="0046">SYSTEM DESCRIPTION </p><p id="p0047" num="0047"> Fig. 1 is a block diagram that schematically illustrates a wireless communication system 20 that uses physical-layer security, in accordance with an embodiment of the present invention. In the present example, system 20 comprises a Wireless Local Area Network (WLAN) that operates in accordance with IEEE Standard 802.11η, entitled "IEEE Standard for Information Technology - Telecommunications and Information Exchange between Systems - Local and Metropolitan Area Networks - Specific Requirements; Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications; Amendment 5: Enhancements for Higher Throughput," October, 2009, which is incorporated herein by reference. In alternative embodiments, however, system 20 may operate in accordance with any other suitable communication standard or protocol. </p><p id="p0048" num="0048"> System 20 comprises an Access Point (AP) 24, which communicates with one or more stations (STA) 28. System 20 applies PHY-level security techniques, which are described in detail below, to prevent transmissions of AP 24 from being illegitimately decoded by an eavesdropping receiver 32. Receiver 32 is referred to herein as "eavesdropper" for brevity. The figure shows a single AP, a single STA and a single eavesdropper for the sake of clarity. Real-life systems, however, typically comprise multiple APs 24 and multiple STAs 28, and may be subject to eavesdropping by multiple eavesdroppers 32. STAs 28, to which the data streams are addressed by the AP, are also referred to as legitimate STAs, legitimate receivers or target receivers. </p><p id="p0049" num="0049"> AP 24 comprises multiple antennas 34. Antennas 34 are sometimes referred to as a beamforming array, although the beamforming operation is typically performed on the signals that are provided to the antennas. The AP typically transmits one or more beam-formed data transmissions, referred to as data streams, on directional transmission beams that are directed toward the STAs intended to receive the data streams. </p><p id="p0050" num="0050"> In order to transmit a data stream to a given STA, the AP generates the signal to be transmitted, and transmits the signal simultaneously via multiple antennas 34 while applying a 
<!-- EPO <DP n="11"/>-->
 respective (complex) weight to each antenna. The set of weights, referred to as a beamforming vector, is selected so as to produce a directional beam that is directed toward the given STA. In the present example, AP 24 transmits a data stream to STA 28 using a beamforming vector that produces a beam 36. </p><p id="p0051" num="0051"> In many practical scenarios, as in the example of Fig. 1, eavesdropper 32 is positioned at a location that enables it to receive beam 36 with sufficient Signal to Noise Ratio (SNR) so as to decode the data stream successfully. In order to secure the data stream, AP 24 uses the array of antennas 34 to transmit an additional beam-formed stream, referred to as a jamming stream. The jamming stream is transmitted with appropriate power and beamforming vector, which are set so as to (i) degrade the SNR at which eavesdropper 32 receives the data stream, and (ii) cause little or no SNR degradation at STA 28. </p><p id="p0052" num="0052"> In the present context, the terms "jamming stream" and "jamming transmission" are used to describe any transmission that is not intended to convey useful data to any receiver, but rather to degrade the reception quality (e.g., SNR) at potential eavesdropping receivers. The terms SNR and Signal to Interference and Noise Ratio - SINR - are used interchangeably unless noted otherwise. Both terms refer to the power ratio between the data stream in question and the remaining signal and noise components, e.g., other data streams, jamming streams, and noise. </p><p id="p0053" num="0053"> In the present example, the jamming stream is transmitted on a beam 40. As can be seen in the figure, the beamforming vector used for the jamming stream causes a spatial null in a direction 44 from AP 24 to STA 28, meaning that STA 28 will receive the jamming stream at a low power level that will cause little or no degradation to the decoding of the data stream carried on beam 36. Eavesdropper 32, on the other hand, is located at a direction 48 from the AP. Therefore, the eavesdropper will receive the jamming stream (beam 40) at a relatively high power level, which is comparable with that of the data stream (beam 36). As a result, the SNR of the data stream at eavesdropper 32 is poor, and there is high likelihood that the eavesdropper will fail to decode it. </p><p id="p0054" num="0054"> In some embodiments, the jamming stream comprises a random or pseudorandom, noise-like signal. In other embodiments, the jamming stream comprises a sequence of modulated symbols that are selected at random from some symbol constellation, e.g., the same constellation used for modulating the data streams. In other embodiments, the jamming stream comprises a sequence of modulated symbols that are selected from a symbol constellation by Forward Error Correction Code (FEC) encoding and modulation of random bits. Further alternatively, the jamming stream may comprise any other suitable signal type. 
<!-- EPO <DP n="12"/>-->
 Fig. 1 shows only a single data stream and a single jamming stream, for the sake of clarity. In alternative embodiments, AP 24 may transmit any desired number of data streams and any desired number of jamming streams simultaneously. Further alternatively, the jamming streams may be transmitted by a transmitter other than AP 24. An embodiment of this sort is shown in Fig. 3 further below. Additional aspects of secure transmission schemes using jamming streams are addressed in U.S. Patents 7,672,400 and 7,751,353, cited above. </p><p id="p0055" num="0055"> Fig. 2 is a block diagram that schematically illustrates a transmitter 50 of AP 24, in accordance with an embodiment of the present invention. Transmitter 50 generates a total of four streams - Two data streams and two jamming streams. In the present example, data for transmission is scrambled by a scrambler 54. An encoder parser 58 parses the scrambled data into blocks, and each block is encoded with a FEC by a FEC encoder 62. </p><p id="p0056" num="0056"> A stream parser 66 parses the encoded data into two data streams. Each data stream is interleaved by a respective interleaver 70, and each interleaved data stream is mapped onto a sequence of modulated symbols by a respective constellation mapper 74. In the present example, a Cyclic Shift Diversity (CSD) module 78 applies CSD to a given data stream, i.e., spreads the signal with different cyclic shifts across multiple streams. A spatial mapping unit 82 maps each data stream onto the multiple antennas while applying the appropriate beamforming vector to the data stream. In the present example transmitter 50 comprises four transmit antennas. </p><p id="p0057" num="0057"> In the embodiment of Fig. 2, transmitter 50 comprises two jamming stream generators</p><p id="p0058" num="0058">86, which generate two respective jamming streams. Spatial mapping unit 82 applies suitable beamforming vectors to the jamming streams, in a similar manner to the mapping of the data streams. Thus, unit 82 produces four outputs corresponding to four transmit antennas. Each output of unit 82 comprises a stream of samples made-up of weighted components of each of the two data streams and each of the two jamming streams, in accordance with the beamforming vectors set for the streams. </p><p id="p0059" num="0059"> Each output of unit 82 is processed by a respective Inverse Discrete Fourier Transform (IDFT) module 90 that applies IDFT to the sample stream. A respective Guard Interval (GI) and Windowing module 94 inserts a GI into the sample stream and filters the stream with a suitable window function. A respective analog&amp;RF module 98 converts the sample stream into an analog signal, up-converts the analog signal to RF, amplifies the RF signal and transmits the RF signal via the respective transmit antenna. </p><p id="p0060" num="0060"> In the example of Fig. 2, the data streams comprise Orthogonal Frequency Division Multiplex (OFDM) signals that are multiplexed in the frequency domain. Note that, even in an 
<!-- EPO <DP n="13"/>-->
 OFDM-based system, addition of the jamming streams may alternatively be performed in the time domain. In such implementation, the coefficients of each beamforming vector of each interfering stream are, in general, Infinite Impulse Response (IIR) filters (i.e., complex rational functions in one variable D) instead of plain complex numbers. </p><p id="p0061" num="0061"> In the embodiment of Fig. 2, transmitter 50 comprises a control unit 96, which configures transmission parameters of the data streams and/or jamming streams, using techniques that are described below. For example, unit 96 may set parameters such as the fractions of transmit power to be allocated to the jamming streams, the Modulation and Coding Schemes (MCSs) to be assigned to the data streams, and/or any other suitable transmission parameter. </p><p id="p0062" num="0062"> In some of the embodiments described below, jamming stream generators 86 are referred to a jamming generation circuitry that generates the jamming streams, elements 54-78 are referred to as data generation circuitry that generates the data streams, and the remaining elements of transmitter 50 are referred to as transmission circuitry that transmits the data streams and the jamming streams. </p><p id="p0063" num="0063"> Fig. 3 is a block diagram that schematically illustrates a wireless communication system 99 that uses physical-layer security, in accordance with an alternative embodiment of the present invention. In system 99, unlike system 20 of Fig. 1 above, the jamming streams are produced by a sentinel transmitter 100 - A unit that is separate from AP 24. In the example of Fig. 3, sentinel 100 transmits a jamming stream on a beam 104. The beamforming vector selected by sentinel device 100 causes beam 104 to be directed in a direction 108 of eavesdropper 32, and to have a spatial null in a direction 112 of STA 28. Additional aspects of sentinel 100 are addressed in U.S. Patent 7,751,353, cited above. </p><p id="p0064" num="0064"> In this embodiment, the functionality of control unit 96 may be embodied in sentinel 100, in AP 24 or it may be partitioned between the AP and the sentinel in any suitable way. </p><p id="p0065" num="0065"> Generally, the number of legitimate STAs 28 is denoted K (typically K=l, but not necessarily). Each legitimate STA may comprise a single receive antenna or multiple receive antennas. AP 24 and/or sentinel device 100 produces and transmits one or more data streams and one or more jamming streams so that the legitimate STAs are able to decode the data streams but eavesdropper 32 is unable to decode them, with high likelihood. Although the description that follows refers to jamming streams transmitted by AP 24, for the sake of clarity, at least some of the disclosed techniques are similarly applicable to jamming streams transmitted by sentinel device 100. 
<!-- EPO <DP n="14"/>-->
 Let N denote the number of transmit antennas of AP 24, and let denote the number of receive antennas of the Jc ^ legitimate STA (ke { l ,. . . ,K}). The total number of receive antennas of all legitimate STAs is denoted
<img id="imgf000014_0001" he="7" wi="30" file="imgf000014_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 . In a typical application, although not necessarily, NJ &lt;N. The number of jamming streams is denoted Λ¾, where typically N<sub>D</sub>≤N-Nu. </p><p id="p0066" num="0066"> Typically although not necessarily, AP 24 selects the beamforming vectors applied to the jamming streams to be (at least approximately) orthogonal to the rows of the channel matrix between AP 24 and all receive antennas of all legitimate STAs. (Alternatively, the beamforming vectors applied to the jamming streams are chosen to be approximately orthogonal to the rows of the effective channel matrix, which considers the channels after receive-side beamforming in the legitimate STAs. In the present context, the terms "communication channel" and "channel matrix" refer to either the physical channel or to the effective channel, as appropriate.) </p><p id="p0067" num="0067"> Formally - Let G C<sup>UK N</sup> denote the channel matrix between the AP and the Jc ^ legitimate STA, and let Η<sub>Υ</sub> ≡ (Hi | ... \ H^)<sup>T</sup> G C<sup>NU N</sup> denote the overall channel matrix </p><p id="p0068" num="0068"> T </p><p id="p0069" num="0069">between the AP and all the legitimate STAs, wherein () denotes matrix transposition. The beamforming matrix B<sub>D</sub> G C<sup>N N</sup>° of the jamming streams is typically constrained to satisfy the condition HJJB<sub>Q</sub> « 0. Note, however, that generally the disclosed techniques are in no way limited to jamming streams whose beamforming vectors are orthogonal to the physical or effective channels of the data streams. </p><p id="p0070" num="0070"> The system and transmitter configurations shown in Figs. 1-3 are example configurations, which are chosen purely for the sake of conceptual clarity. In alternative embodiments, any other suitable system or transmitter configuration can also be used. Some system or transmitter elements may be implemented in hardware, e.g., in one or more Application-Specific Integrated Circuits (ASICs) or Field-Programmable Gate Arrays (FPGAs). Additionally or alternatively, some system or transmitter elements can be implemented using software, or using a combination of hardware and software elements. </p><p id="p0071" num="0071"> Some of the functions of the AP or the sentinel device, e.g., the functions of control unit 96, may be carried out using a general-purpose processor, which is programmed in software to carry out the functions described herein. The software may be downloaded to the processor in electronic form, over a network, for example, or it may, alternatively or 
<!-- EPO <DP n="15"/>-->
 additionally, be provided and/or stored on non-transitory tangible media, such as magnetic, optical, or electronic memory. </p><p id="p0072" num="0072">POWER FRACTION AND MCS SELECTION </p><p id="p0073" num="0073"> In some embodiments, control unit 96 in AP 24 controls the SNRs at which the data streams are received by legitimate STAs 28 and affects the SNRs at which the data streams are received by eavesdropper 32, by controlling the power fraction allocated to the jamming streams, and/or the Modulation and Coding Scheme (MCS) assigned to the data streams. The adaptation of the power fraction and/or MCS is performed based on some criterion that is set to reduce the probability of the data streams being decoded by eavesdropper 32, while enabling successful decoding of the data streams by the legitimate target STAs. </p><p id="p0074" num="0074"> In the following description, ae(0,l) denotes the fraction of the overall transmit power P (summed over all the data streams and the jamming streams) that is allocated to the jamming streams. Generally, increasing improves the level of security at the expense of reduced signal strength at the legitimate STAs, and vice versa. </p><p id="p0075" num="0075"> In some embodiments, AP 24 transmits each data stream using a certain MCS that is selected from a set of possible MCSs. Each MCS defines a respective combination of modulation and FEC code, and therefore a respective data rate. In the present context, the term "higher MCS" means an MCS having a higher data rate (and hence higher order modulation, higher coding rate and/or higher number of data streams). Similarly, the term "lower MCS" means an MCS having a lower data rate (and hence lower order modulation, lower coding rate and/or smaller number of data streams). For a given decoding performance (e.g., error rate or error probability), higher MCSs typically require higher SNR, and vice versa. </p><p id="p0076" num="0076"> In some embodiments, AP 24 sets the power fraction at some fixed value, e.g., a=0.5, and restricts the MCS used for transmitting a data stream to a particular legitimate STA to a partial subset of the possible MCSs. In accordance with an example criterion, the AP defines the partial subset of MCSs such that, given , the eavesdropper is expected with high probability to fail in decoding the data stream. Typically, the partial subset of MCSs is defined as the MCSs whose data rate is above a certain value (or whose index is above some minimum index, assuming the MCSs are numbered with indices that correspond to the respective data rates). This criterion restricts the choice of MCSs to those that require at least a certain SNR. With proper restriction of the MCSs, security is assured with high probability for any user that can support at least the lowest MCS in the allowed subset. 
<!-- EPO <DP n="16"/>-->
 Consider, for example, K=l, i.e., a single data stream transmitted to a single legitimate STA. Since is known, the power fraction left for the data stream is known, and the level of interference caused by the jamming stream to the legitimate STA (e.g., =0) is also known. This information is typically sufficient for finding the highest MCS that will still enable successful decoding by the legitimate STA. In some embodiments, AP 24 chooses the MCS for the data stream in question to be below this highest MCS, as long as the chosen MCS is in the partial subset described above. If the highest MCS is not in the partial subset, then the AP can in some embodiments declare that secure transmission is not possible for the legitimate STA and avoids transmission until the STA has channel conditions allowing the use of some MCS in the allowed subset. </p><p id="p0077" num="0077"> AP 24 may define the partial subset of MCSs for a given data stream, e.g., set the minimum allowed MCS index, in any suitable way. In an example embodiment, AP 24 has no information on the channel to the eavesdropper. In this example the AP regards the channel to the eavesdropper as random, drawn according to some statistical distribution depending on the propagation channel. Consequently, the SNR (denoted ) of the data stream at the eavesdropper is also random, and the statistics of are determined by a. </p><p id="p0078" num="0078"> Each single-stream MCS is associated with a respective threshold SNR denoted <sup>'</sup>, such that if y≥
<img id="imgf000016_0001" he="7" wi="13" file="imgf000016_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 the error rate (e.g., Packet Error Rate - PER) at the eavesdropper is below the minimum PER that is considered adequate for security. In an embodiment, AP 24 restricts the choice of MCS for a given data stream to the partial subset of MCSs for which γ is likely to be below YTH <sup>S '</sup>■ The AP may assume a certain channel model for this purpose, and set the Cumulative Distribution Function (CDF) of γ for this channel model. (The CDF of γ is typically calculated off-line using some assumed or measured channel model, e.g., by an external computer, and provided to the AP.) The AP may find the minimum MCS index IQ for which the probability of having γ &gt; is sufficiently low, e.g., below some probability threshold. The AP then defines the partial subset of MCSs as the MCSs whose indices are IQ or higher (higher indices correspond to higher MCS, and vice versa, in accordance with the definition above). </p><p id="p0079" num="0079"> In alternative embodiments, AP 24 may define the partial subset of MCSs (e.g., define z<sup>'</sup>o) <sup>m an</sup>Y other suitable manner, not necessarily assuming any channel model or SNR calculation. For example, the minimum MCS index may be found in advance, e.g., using 
<!-- EPO <DP n="17"/>-->
 laboratory experimentation. An example laboratory experiment may include an AP and a user STA placed in a typical environment, and a potential eavesdropper that is moved between different locations in this environment. The AP transmits to the user STA using various MCSs. In each eavesdropper location, the maximum MCS decodable by the eavesdropper is recorded. The experiment can be repeated for different AP and STA locations. </p><p id="p0080" num="0080"> In another embodiment, an ad-hoc minimum MCS index is defined. For example, if the application using the data stream is likely to require some minimum MCS index i\ for proper operation (e.g., the application may request a desired throughput at a certain Quality-of-</p><p id="p0081" num="0081">Service grade corresponding to AP 24 may use this MCS index and set iQ≡i\. </p><p id="p0082" num="0082"> As yet another example, if it is known in advance that the channel from the AP to the legitimate STAs at any point in time is one of several possible propagation channel types, then it is possible to prepare several values of IQ in advance, one for each channel type. During operation, AP 24 may assess the current channel and choose the IQ value corresponding to the current channel type. The AP may assess the channel based on, for example, the learned channel matrix or a function of the matrix, measured or assumed SNR, PER or any other suitable measure of the channel. </p><p id="p0083" num="0083"> Fig. 4 is a flow chart that schematically illustrates a method for physical-layer security, in accordance with an embodiment of the present invention. The method begins with AP 24 defining a power fraction of the total transmitted power P that is allocated to jamming streams, at a power ratio definition step 120. </p><p id="p0084" num="0084"> AP 24 defines, based on , a partial subset of the possible MCSs for transmitting the data streams to its intended legitimate STA, at a subset definition step 124. The partial subset of MCSs is defined so as to include only MCSs that are expected to be un-decodable by the eavesdropper. The AP may define the partial subset of MCSs using the methods described above, for example. The AP transmits the jamming streams using the power fraction , and the data streams using an MCS selected from the respective partial subset of MCSs. </p><p id="p0085" num="0085"> In some embodiments, unit 96 in AP 24 modifies the power fraction allocated to the jamming streams based on the channel type between the AP and the legitimate STAs. In accordance with an example criterion, based on the Channel State Information (CSI) for the channels between the AP and the legitimate STAs, AP 24 chooses such that (i) the SNR at eavesdropper 32 will prevent successful decoding of the data streams with high probability but (ii) the SNR at the legitimate STA will enable successful decoding. 
<!-- EPO <DP n="18"/>-->
 Fig. 5 is a flow chart that schematically illustrates a method for physical-layer security, in accordance with an embodiment of the present invention. The method begins with AP 24 estimating the CSI for the channels to the legitimate STAs, at a CSI estimation step 130. The AP allocates the power fraction a for the jamming streams based on the estimated CSI, at an a allocation step 134. The AP transmits the data streams and the jamming streams at the respective power levels according to the allocated a, at a transmission step 138. </p><p id="p0086" num="0086"> In some embodiments, AP 24 chooses a based on the SINR that the data streams would have, if they were allocated all the transmit power P (that is, if were set to zero). Consider, for example, the case of a single legitimate STA (i.e., K=l) and a single data stream. Based on the assumed model of the propagation channel from AP 24 to this STA, the AP may store the CDF of γ = γ(ά) for several values of a and in memory. (Typically, the CDFs are calculated off-line, e.g., by an external computer, and provided to the AP.) During operation, the AP can use its knowledge of the actual channel towards the legitimate STA to calculate g(0), the SNR (this time assuming no interference from the jamming stream) at the legitimate STA, assuming a=0. </p><p id="p0087" num="0087"> Assume, in this example, that the beamforming vectors of the jamming streams are orthogonal to the channel of the legitimate STA, so that the STA is not subject to interference. In this case, the SINR at the legitimate STA for a&gt;0, denoted g( ), is equal to the SNR and is given by (l-a)-g(O). Based on the stored CDFs of γ(α), AP 24 may find the CDFs of γ(α)/ g(cc), e.g., by a simple re-scaling of the x-axis. </p><p id="p0088" num="0088"> Then, the AP may choose the value of a for which γ(α) / g(a) is below some threshold t with a sufficiently high probability p (e.g., p=0.95). The threshold t is typically set small enough to ensure that γ(ά) is too low for successful decoding of the highest-rate MCS selected based on g( ). For example, for the set of MCSs defined in the IEEE 802.11η standard, cited above, t may be set between approximately -5 dB and -3 dB (these numbers are approximately the largest threshold difference between two consecutive MCSs), i.e., between approximately 0.3 and 0.5 in linear units. </p><p id="p0089" num="0089"> The example above makes an implicit assumption that the rate selection scheme for the legitimate STA attempts to select the MCS having the highest possible rate. After a is fixed, AP 24 may find a concrete value for g(a), and consequently choose a rate for the legitimate STA. Note that in the current example, where a is chosen dynamically based on the SINR of the data streams, there is typically no limitation on the minimum allowed MCS. 
<!-- EPO <DP n="19"/>-->
 In summary, the above-described example process of setting a and MCS, which is carried out by AP 24 based on the estimated CSI, comprises the following steps: </p><p id="p0090" num="0090"><sup>■</sup> Offline: </p><p id="p0091" num="0091"> o Find and store the CDFs of the a-dependent SINR of the data streams at the eavesdropper side, y(a), for several values of the power fraction a allocated to the jamming streams. </p><p id="p0092" num="0092"> o Choose the desired SINR threshold t, and the desired probability p for the SINR to be below t. </p><p id="p0093" num="0093"><sup>■</sup> During operation: </p><p id="p0094" num="0094"> o Find g(0), the interference-free SNR at the legitimate STA assuming a=0, for example based on the known channel towards the legitimate STA. </p><p id="p0095" num="0095"> o Using the stored CDFs of y(a), find «Q, the lowest value of a for which the probability that γ(ά) &lt; t · (1— ) · g(G) is at least p. Set a to be equal to OQ. o After choosing , the SNR γ(α) at the legitimate STA is known to be a · g(0). </p><p id="p0096" num="0096"> Choose the highest-rate MCS for which the data stream is decodable at this known SNR. </p><p id="p0097" num="0097"> After carrying out these steps, AP 24 may begin transmission of the data stream and jamming stream. </p><p id="p0098" num="0098"> The example above refers to a single data stream, for the sake of clarity. In alternative embodiments, this technique can be generalized in a straightforward manner to multiple data streams. In cases where several data streams are transmitted, one effective SNR is typically used for representing them. Effective SNR may be used in various scenarios that involve multiple data streams, such as for a multi-stream MCS. In such cases, a histogram of an effective γ can be used instead of a histogram of γ. Effective SNRs that can be used for this purpose are described, for example, by Tsai and Song, in "Effective-SNR Mapping for Modeling Frame Error Rates in Multiple-State Channels," 3GPP2-C30-20030429-010, April 29, 2003, which is incorporated herein by reference. </p><p id="p0099" num="0099">MODIFYING JAMMING STREAMS DURING TRANSMISSION </p><p id="p0100" num="0100"> In some embodiments, AP 24 modifies the jamming stream configuration during a given data transmission that is transmitted on a data stream. (The description that follows refers to AP 24 for the sake of clarity. In alternative embodiments, the disclosed techniques may be carried out by sentinel 100.) 
<!-- EPO <DP n="20"/>-->
 For example, a given data transmission (e.g., packet) may comprise multiple successive parts that are transmitted in respective time intervals. The AP may set the (one or more) jamming streams to different configurations during different parts of the data transmission. This feature provides an additional degree of trade-off between security and data throughput for the legitimate STA. </p><p id="p0101" num="0101"> In an example embodiment, a packet comprises a synchronization sequence, a training sequence used for channel estimation, a part that defines the signal parameters (e.g., MCS) and a payload that carries the packet data. Packets in IEEE 802.11η and IEEE 802.1 lac systems, for example, comprise training sequences that are referred to as Short training Fields (STFs) and Long Training Fields (LTFs). The packet part that defines the signal parameters is referred to as a SIGNAL field in IEEE 802.11η and IEEE 802.11ac systems. Generally, however, a packet or other data transmission may comprise any suitable number of parts of any suitable kind. </p><p id="p0102" num="0102"> AP 24 may modify any suitable characteristic of the jamming streams from one part of the data transmission to another, and any such modification is regarded herein as a different jamming stream configuration. For example, the AP may modify the number of jamming streams that are transmitted during different parts of the data transmission. In particular, the AP may switch off the jamming streams during one or more parts of the data transmission, and switch on one or more jamming streams during one or more other parts. </p><p id="p0103" num="0103"> When the data transmission comprises a communication packet, for example, the AP may transmit one jamming stream configuration during the packet payload, and another jamming stream configuration during packet parts other than the payload. </p><p id="p0104" num="0104"> For IEEE 802.11η or IEEE 802.1 lac packets, for example, the AP may transmit jamming streams only during the packet payload transmission, only during transmission of the payload and training sequence, or only during transmission of the payload, the training sequence and the synchronization sequence. In another example, the AP may transmit jamming streams only during the payload and the packet part used for indicating the signal parameters. Further alternatively, the AP may apply jamming selectively during any other suitable subset of the packet parts. </p><p id="p0105" num="0105"> In alternative embodiments, the AP transmits different numbers of jamming streams during different respective parts of the data transmission. Additionally or alternatively, the AP steers the jamming streams using different beamforming vectors during different respective parts of the data transmission. 
<!-- EPO <DP n="21"/>-->
 Consider, for example, an IEEE 802.11η or IEEE 802.11ac embodiment in which the beamforming vectors of the jamming streams are selected to cause substantially no interference at the legitimate STAs. In this embodiment, the AP may configure the jamming streams differently during LTF transmission and during payload transmission. During LTFs, the STAs typically do not yet have sufficient information for performing receive-side beamforming. Therefore, the jamming stream beamforming vectors should be orthogonal to the channels of all receive antennas of all legitimate STAs. During payload transmission, on the other hand, the STAs typically apply receive-side beamforming, and the jamming stream beamforming vectors may be orthogonal only to the effective, post-receive-side beamforming channels. </p><p id="p0106" num="0106"> Since the number of data streams transmitted to a legitimate STA is typically smaller than the number of STA receive antennas, the relaxed constraint of being orthogonal only to the effective channels enables a larger number of jamming streams during payload transmission, and therefore increased security. </p><p id="p0107" num="0107"> In the embodiments described above, AP 24 modifies the number of jamming streams and/or the beamforming vectors of the jamming streams for different parts of the data transmission. In alternative embodiments, the AP may modify any other suitable configuration of the jamming streams. </p><p id="p0108" num="0108"> For example, the power of the jamming streams (or the ratio a defined above) may be set to different values during different parts of a transmission (e.g., packet). In accordance with the IEEE 802.11n/ac standard, the SIGNAL field should be transmitted at the lowest possible MCS of the standard. Consequently, the SIGNAL field may be more susceptible to eavesdropping. Thus, in some embodiments, the jamming stream power (or the value of ) is increased during the SIGNAL filed. </p><p id="p0109" num="0109"> Fig. 6 is a flow chart that schematically illustrates a method for physical-layer security, in accordance with an embodiment of the present invention. The method begins with AP 24 defining different jamming stream configuration for different respective packet parts, at a definition step 140. The AP transmits a valuable data packet using one or more streams, and simultaneously transmits one or more jamming streams, at a stream transmission step 144. In transmitting the jamming streams, the AP alternates between the jamming stream configurations defined for the respective packet parts. </p><p id="p0110" num="0110"> Since in some embodiments security is achieved by using jamming beamforming vectors that are only constrained to be orthogonal to the effective channel of the legitimate receivers, there may exist eavesdropper locations for which the jamming streams are received 
<!-- EPO <DP n="22"/>-->
 at lower power than the data streams. At these locations, if the channel is static (i.e., changes slowly over time) the eavesdropper may be able to decode the data streams constantly. </p><p id="p0111" num="0111"> To overcome this problem, in some embodiments a legitimate receiver deliberately changes its RX beamforming vectors over time in order to force variations in the effective channel. While this method may somewhat degrade the achievable data rate of the legitimate receiver, it introduces a significant enhancement in security. Consider, for example, the transmission of a single data stream to a single multiple- antenna legitimate receiver. The legitimate receiver may switch between RX beamforming to the strongest and the second strongest eigenmode, and the jamming beamforming vectors will change accordingly, following the changes in the effective single-RX antenna channel. The AP may be informed of the effective channel by explicit feedback from the legitimate receiver, which reports on the effective channel (including the RX beamforming) instead of the physical channel. </p><p id="p0112" num="0112">BEAMFORMING VECTOR COMPUTATION </p><p id="p0113" num="0113"> The description that follows provides an example technique for calculating the beamforming vectors for the jamming streams. In the disclosed embodiments, control unit 96 of AP 24 (or sentinel 100) applies this scheme under the assumption that the jamming stream beamforming vectors are to cause zero interference to the legitimate STAs. In other words, as noted above, the beamforming vectors of the jamming streams are constrained to be orthogonal to the rows of HJ . </p><p id="p0114" num="0114"> In order to calculate the beamforming vectors of the jamming streams, unit 96 of AP</p><p id="p0115" num="0115">24 calculates an orthonormal basis for the vector subspace kev iu<sup>^</sup>) = {x \ HuX = 0}, a subspace that is orthogonal to the aggregate channel matrix HJJ. (For the sake of clarity, the description refers to jamming stream beamforming vectors that are orthogonal to the physical channels of the legitimate STA antennas. The disclosed technique can be used in a similar manner to calculate jamming stream beamforming vectors that are orthogonal to the effective channels following receive-side beamforming at the STAs.) </p><p id="p0116" num="0116"> In one embodiment, AP 24 finds the orthonormal basis using LQ factorization of HJJ. In such a process HJJ is written as Hy=L Q, wherein Q is a unitary matrix Q 6 C<sup>N N</sup> , and L is a lower-triangular matrix L Assuming that HJJ is of full rank, the conjugate transpose of the last N-Nj rows of Q may serve as the desired orthonormal basis. 
<!-- EPO <DP n="23"/>-->
 Alternatively, AP 24 may produce the LQ factorization of HJ by QR factorization of</p><p id="p0117" num="0117">Hy. In this process, Hy is written as Η<sub>υ</sub> = Q · R, yielding Η<sub>υ</sub> = R*Q* . The AP produces the desired basis for kev iu<sup>^</sup>) by taking the last N-Nj columns of matrix Q in the QR factorization of Η<sub>υ</sub>. AP 24 may perform the QR factorization using any suitable method. Examples of known methods that can be used for this purpose comprise the Householder method and the Givens rotations. </p><p id="p0118" num="0118"> In some embodiments, for all k, the k-t legitimate STA 28 performs a Singular Value Decomposition (SVD) of its channel matrix H<sub>k</sub> to obtain H<sub>k</sub> = U<sub>k</sub> · D<sub>k</sub> · V<sub>k</sub> (with</p><p id="p0119" num="0119">U<sub>k</sub>, D<sub>k</sub> G C<sup>Uk Uk</sup> and V<sub>k</sub> G C<sup>nkXN</sup> , where ()* denotes matrix conjugation and transposition), U<sub>k</sub> and V<sub>k</sub> have orthonormal columns, and D<sub>k</sub> is diagonal), and sends the AP only V<sub>k</sub>. If H<sub>k</sub> is full rank for all k (i.e., no zeros on the main diagonals of all matrices D<sub>k</sub>), then </p><p id="p0120" num="0120"><img id="imgf000023_0001" he="24" wi="86" file="imgf000023_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/></p><p id="p0121" num="0121"> Therefore, in embodiments where all V<sub>k</sub> are available instead of HJJ, the AP may derive the orthonormal basis using the above method from
<img id="imgf000023_0002" he="6" wi="31" file="imgf000023_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 instead of from Hu. </p><p id="p0122" num="0122"> Fig. 7 is a flow chart that schematically illustrates a method for calculating jamming stream beamforming vectors, in accordance with an embodiment of the present invention. The method begins with AP 24 determining the aggregated channel matrix HJJ, at a channel estimation step 150. The AP then determines the matrix Q of the QR factorization Η<sub>υ</sub> = Q · R, at a Q determination step 154. </p><p id="p0123" num="0123"> AP 24 forms an orthonormal basis for kev iu<sup>^</sup>) by taking the last N-NJ rows of Q, at a basis formation step 158. The AP then calculates the beamforming vectors for the jamming streams using the orthonormal basis, at a jamming vector calculation step 162. Typically, the</p><p id="p0124" num="0124">AP will use the maximum possible number of jamming streams (that is, N-NJ jamming streams). In general, however, the number of jamming streams may be smaller than N-NJ , 
<!-- EPO <DP n="24"/>-->
 and so in some cases the AP will only have to calculate less than N-Nj beamforming vectors for the jamming streams. </p><p id="p0125" num="0125">PHYSICAL-LAYER SECURITY USING IMPLICIT CHANNEL FEEDBACK</p><p id="p0126" num="0126">In the embodiments described above, AP 24 configures the parameters of the data streams and jamming streams (e.g., power levels, beamforming vectors, number of jamming streams and activation times for jamming streams) based on the estimated communication channels between the AP and the legitimate STAs. The AP typically receives from the legitimate STAs explicit feedback (e.g., CSI) regarding the channels from the AP, and uses the explicit feedback for configuring the data and jamming streams. In IEEE 802.11η systems, for example, the explicit feedback may comprise the actual channel matrices as measured by the STAs. </p><p id="p0127" num="0127"> In some scenarios, however, the explicit feedback transmitted by the STAs may be used by eavesdropping receiver 32 to mitigate the physical-layer security techniques described herein. For example, the eavesdropper may intercept the explicit feedback transmissions from the STAs, reconstruct the aggregate channel matrix HJ , and use the reconstructed channel matrix to cancel the effect of the jamming streams. </p><p id="p0128" num="0128"> In some embodiments, control unit 96 in AP 24 assumes that the channels between the AP and the legitimate STAs are reciprocal, i.e., that the channel from a given AP antenna to a given STA antenna is substantially the same as (or is otherwise indicative of) the channel in the opposite direction. Under this assumption, the AP can receive uplink signals (e.g., sounding frames carrying training signals) from the legitimate STAs, and learn the downlink channel responses from the received uplink signals. This form of channel estimation is referred to as implicit feedback. </p><p id="p0129" num="0129"> When system 20 uses implicit feedback, no channel feedback is transmitted over the air. Thus, eavesdropper 32 can only obtain the channel responses from the legitimate STAs to the eavesdropper (which are usually of no value) and not the channel responses between the AP and the STAs. AP 24 may implement any of the physical-layer security described herein using implicit feedback. </p><p id="p0130" num="0130"> Fig. 8 is a flow chart that schematically illustrates a method for physical-layer security using implicit feedback, in accordance with an embodiment of the present invention. The method begins with AP 24 receiving training signals over the uplink from legitimate STAs 28, at an uplink reception step 170. AP 24 estimates the downlink channel responses, from the AP 
<!-- EPO <DP n="25"/>-->
 to the legitimate STAs, based on the training signals received over the uplink, at a channel estimation step 174. </p><p id="p0131" num="0131"> The AP configures one or more data streams and/or one or more jamming streams based on the estimated downlink channel responses, at a stream configuration step 178. Any suitable parameter of the data streams and/or jamming streams may be configured based on the implicit feedback, such as power levels, beamforming vectors, number of jamming streams and activation times for jamming streams in accordance with the methods described above. </p><p id="p0132" num="0132"> In some embodiments, when using implicit feedback, AP 24 instructs the legitimate STAs to transmit sufficient uplink signals that enable the AP to learn the full channel matrices between the STAs and the AP. In other words, AP 24 instructs the legitimate STAs to transmit training signals that provide channel information relating to all receive antennas of the legitimate STAs. For example, the AP may instruct the legitimate STAs to transmit training signals via all their antennas. </p><p id="p0133" num="0133"> In some embodiments, AP 24 instructs a legitimate STA 28 to disable one or more of its reception chains (i.e., one or more receive antennas and associated receiver or processing circuitry) when using the physical-layer security schemes described herein with implicit feedback. This feature is useful in a number of scenarios. </p><p id="p0134" num="0134"> For example, in some embodiments the legitimate STA comprises more receive chains (and respective receive antennas) than transmit chains (and respective transmit antennas). In such a case, even if the STA transmits uplink training signals via all the transmit antennas, the AP will not be able to deduce the full downlink channel matrix from these signals. Disabling one or more of the receive chains in the STA (e.g., leaving only those receive chains that have corresponding transmit chains) enables the system to overcome this limitation. As another example, disabling one or more of the STA receive chains will typically increase the maximum possible number of jamming streams, thereby increasing the possible security level. </p><p id="p0135" num="0135">SELECTIVE APPLICATION OF SECURE TRANSMISSION </p><p id="p0136" num="0136"> In some embodiments, control unit 96 holds a definition of two or more transmission modes having different levels of physical-layer security, i.e., different levels of preventing eavesdropping receivers from decoding data streams. Unit 96 selects the appropriate transmission mode for transmitting a given data stream by evaluating a certain selection criterion. Several example criteria are described further below. </p><p id="p0137" num="0137"> This sort of multi-mode operation enables the system to offer varying levels of physical-layer security to different STAs. Moreover, this technique improves the system 
<!-- EPO <DP n="26"/>-->
 performance, since it reduces the communication overhead and performance degradation that is associated with transmission of the jamming streams. </p><p id="p0138" num="0138"> In some embodiments, the transmission modes comprise a secure mode and a normal mode. In the secure mode the AP (or sentinel) transmits the data stream simultaneously with one or more jamming streams, using any of the methods described herein. In the normal mode, the data stream is transmitted without jamming streams. </p><p id="p0139" num="0139"> In some embodiments, the transmission configuration of the data stream differs between the normal and secure modes. In one embodiment, unit 96 selects the MCS (and thus the data rate) for the data stream using different rules in the two modes. Generally, higher-rate MCSs provide a higher degree of security, since they require a higher SNR at the eavesdropping receiver for successful decoding. Thus, in some embodiments, unit 96 applies a more aggressive MCS selection rule in the secure mode, in comparison with the normal mode. </p><p id="p0140" num="0140"> Consider, for example, a rule that selects the MCS such that the Packet Error Rate (PER) is below some maximum allowed threshold t. In this embodiment, unit 96 may set t to a higher value in the secure mode and to a lower value in the normal mode. This setting enables higher security in the secure mode, at the possible expense of poorer reception at the legitimate STA. </p><p id="p0141" num="0141"> In alternative embodiments, unit 96 causes the AP (or sentinel) to transmit channel sounding signals more frequently in the secure mode, in comparison with the normal mode. Typically, the AP selects beamforming vectors for the jamming streams based on channel feedback from the legitimate STAs. The STAs typically learn the channel by performing measurements on channel sounding signals that they receive from the AP. </p><p id="p0142" num="0142"> Therefore, transmitting channel sounding signals more frequently increases the accuracy of the jamming stream beamforming vectors, especially when the channel varies over time. In an embodiment, the AP transmits channel sounding signals more frequently in the secure mode, in order to maintain the accuracy of the jamming stream beamforming. </p><p id="p0143" num="0143"> In some embodiments, unit 96 selects the appropriate transmission mode depending on the Serving Set ID (SSID) with which the legitimate STA is associated. In these embodiments, the AP supports operation in multiple SSIDs. The AP associates each legitimate STA with one of the supported SSIDs, and transmits to each legitimate STA using a transmission mode that corresponds to this SSID. This technique enables the AP to provide varying levels of physical- layer security to different STAs. </p><p id="p0144" num="0144"> In some embodiments, transmissions in one SSID are performed in a secure mode, i.e., with jamming streams, while transmission in another SSID is performed without any jamming 
<!-- EPO <DP n="27"/>-->
 streams. In other embodiments, in one SSID one subset of the frames (e.g., all the frames) are protected by jamming streams, while in another SSID a different subset of the frames is protected by jamming streams. </p><p id="p0145" num="0145"> In some embodiments, the AP associates one or more STAs that require high-level physical-layer security with a given SSID, and protects all frames (including multicast and broadcast frames) in this SSID with jamming streams. In other SSIDs the multicast and broadcast frames are not protected. This technique enables the AP to prevent even legitimate STAs outside the given SSID from decoding the data streams addressed to the STAs in this SSID. </p><p id="p0146" num="0146"> In various embodiments, transmission mode selection may be initiated by the AP or sentinel (or management application that control either of them), or by the STA. In some embodiments, frames that are to be protected by jamming streams are tagged, and the AP transmits jamming streams selectively - to protect only the tagged frames. </p><p id="p0147" num="0147"> Fig. 9 is a flow chart that schematically illustrates a method for physical-layer security, in accordance with an embodiment of the present invention. The method begins with tagging frames that are intended for secure transmission, at a tagging step 180. Tagging of this sort can be performed, for example, by the AP, by a management application or by any other suitable entity. </p><p id="p0148" num="0148"> When preparing to transmit a certain frame in a data stream, unit 96 in the AP checks whether the frame is tagged, at a frame checking step 184. If the frame is not tagged, as checked at a checking step 188, the AP transmits the frame using the normal transmission mode, at a normal transmission step 192. If, on the other hand, step 188 indicates that the frame is tagged, the AP transmits the frame using the secure transmission mode, at a secure transmission step 196. The method then loops back to step 184 above for processing the next frame. </p><p id="p0149" num="0149"> In yet another embodiment, tagging of frames may depend on the Access Category (AC) mechanism of the IEEE 802.1 ln/ac standard (or a similar mechanism in other standards). For example, packets with the highest AC may be considered as tagged. In an alternative embodiment, the MCS subset for security, as well as the jamming stream power fraction, a, may depend on the AC, thus providing different levels of security for different ACs. </p><p id="p0150" num="0150"> In some embodiments, the legitimate STA sends signaling requests to the AP, requesting to protect particular data streams or frames. These requests may signal the AP to start or stop transmission of jamming streams, or they may use any other suitable protocol. 
<!-- EPO <DP n="28"/>-->
 This mechanism enables an end-user application in the STA to select between secure and normal transmissions, e.g., in order to protect sensitive transactions. </p><p id="p0151" num="0151">SELECTIVE STA CONFIGURATION DURING SECURE AND NORMAL</p><p id="p0152" num="0152">TRANSMISSION </p><p id="p0153" num="0153"> As noted above, in order to apply effective physical-layer security, AP 24 should have complete channel information to all STA antennas. In various scenarios, it may not be possible for the AP to obtain complete CSI: </p><p id="p0154" num="0154"><sup>■</sup> The AP performs single-user explicit beamforming channel sounding for the full dimensions of the channel (number of STA antennas), as defined in the IEEE 802.11η and IEEE 802.1 lac standards, but the STA decides to return only a subset of the channel matrix. </p><p id="p0155" num="0155"><sup>■</sup> The STA has more receive antennas than the number of supported spatial streams. For example, 2T3R STA (with two transmit antennas and three receive antennas) supporting 2SS (two spatial streams). In this case, in the IEEE 802.11η standard, the AP can sound only for a maximum dimension equal to the number of supported spatial streams.</p><p id="p0156" num="0156">Moreover, the AP is typically unaware of the existence of the extra receive antennas. </p><p id="p0157" num="0157"><sup>■</sup> The STA has more receive antennas than transmit antennas, and the AP uses implicit beamforming for estimating the channel for physical-layer security. </p><p id="p0158" num="0158"><sup>■</sup> The STA uses an antenna selection/switching scheme in which different antennas are used for reception and transmission, and the AP uses implicit beamforming. </p><p id="p0159" num="0159"> In some embodiments, the last three scenarios can be mitigated by instructing the STA to use the same set of antennas for transmission and reception when communicating in the secure transmission mode. For example, in the 2T3R STA that supports 2SS, the third receive antenna can be disabled in the secure transmission mode. The disabling operation may be controlled by either the AP or the STA upon entering the secure transmission mode. When the disabling is controlled by the AP, a protocol is typically defined between the AP and the STA for controlling this feature in the STA. In some embodiments, the first scenario above can be mitigated by forcing the STA to return its full channel matrix. The control over this option can be performed by the STA or by the AP. </p><p id="p0160" num="0160"> These STA control functions above are applicable to systems in which physical-layer security is performed by an AP (e.g., Fig. 1) or by a sentinel device (e.g., Fig. 3). When using a sentinel device, the STA may be forced to reply to the sounding requests of the sentinel device. In another embodiment, the sentinel device may impersonate the AP and send the 
<!-- EPO <DP n="29"/>-->
 sounding request as if it is transmitted from the AP, e.g., using the proper SSID and data encryption for the STA. In these embodiments the STA would treat the channel sounding request as if it is transmitted by the AP and would therefore reply. In these implementations, the sentinel may be coordinated with the AP, e.g., receive the AP parameters to enable it to impersonate the AP. </p><p id="p0161" num="0161"> Another scenario in which non-standard STA configuration in the secure transmission mode is useful is when the AP or sentinel needs to employ explicit beamforming, but the STA has not yet enabled its explicit sounding feedback mechanism. One such scenario occurs in the IEEE 802.1 ln/ac standards, when the STA has not associated to the AP. In this case, a conventional STA may not respond to sounding requests, and so to enable physical-layer security, the STA must be configured to support sounding even before association. It should be noted that pre-association transactions are typically not encrypted, and therefore there is particular value in employing physical-layer security methods at this stage. </p><p id="p0162" num="0162"> Fig. 10 is a flow chart that schematically illustrates a method for physical-layer security, in accordance with an embodiment of the present invention. The method begins with the AP or STA checking whether transmission is conducted using the secure or normal transmission mode, at a mode checking step 200. If transmission is conducted using the secure transmission mode, the STA is forced to disable one or more of its receive antennas (and associated receive chain), and/or to feedback its full channel matrix, at a STA configuration step 204. Otherwise, the STA configuration is skipped. </p><p id="p0163" num="0163">SELECTIVE TRIGGERING OF SENTINEL DEVICE </p><p id="p0164" num="0164"> In some embodiments, sentinel device 100 of Fig. 3 attempts to intercept data transmissions that should be protected with one or more jamming streams. One possible way to identify a data transmission is to decode the receiver and/or sender address in the Medium Access Control (MAC) header of the frame. In this mode of operation (aspects of which are described, for example, in U.S. Patent 7,751,353, cited above) the sentinel decodes the MAC addresses in the header. When the sentinel identifies an address that should be secured, it switches from reception to transmission and starts transmitting one or more jamming streams that are orthogonal to the destination of the frames. </p><p id="p0165" num="0165"> This approach, however, is sub-optimal, for example since the MAC header is not protected by CRC and may therefore be unreliable. Moreover, the jamming streams protect only the data portion of the frame and not the preamble (since the preamble precedes the MAC 
<!-- EPO <DP n="30"/>-->
 header). It can be shown that physical-layer security is enhanced when parts of the preamble are also protected by the jamming streams. </p><p id="p0166" num="0166"> In some embodiments, sentinel 100 identifies the frames to be protected by detecting the exchange of Request-To-Send/Clear- To-Send (RTS/CTS) messages that precedes the frames in question, from which the identity of the target STA intended to receive the data stream is recognizable. The sentinel can then provide security to all frames (downlink or uplink) that are exchanged during the transaction (TXOP) in which the detected RTS/CTS took place. In these embodiments, the sentinel can transmit the jamming streams starting from the preamble, since it has no need to intercept the address in the MAC header of each frame. </p><p id="p0167" num="0167"> In an alternative embodiment, the sender of the frames can be coordinated with the sentinel and notify it in advance that certain frames should be protected (e.g. the frames that immediately follow the notification). The coordination can be done over the air or using any other suitable means. </p><p id="p0168" num="0168"> It will be appreciated that the embodiments described above are cited by way of example, and that the present invention is not limited to what has been particularly shown and described hereinabove. Rather, the scope of the present invention includes both combinations and sub-combinations of the various features described hereinabove, as well as variations and modifications thereof which would occur to persons skilled in the art upon reading the foregoing description and which are not disclosed in the prior art. Documents incorporated by reference in the present patent application are to be considered an integral part of the application except that to the extent any terms are defined in these incorporated documents in a manner that conflicts with the definitions made explicitly or implicitly in the present specification, only the definitions in the present specification should be considered. 
</p></description><claims mxw-id="PCLM44726849" ref-ucid="WO-2012114233-A2" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="31"/>-->CLAIMS </claim-statement><claim id="clm-0001" num="1"><claim-text> 1. A method for communication, comprising: </claim-text><claim-text> generating one or more data streams for transmission to respective target receivers, and one or more jamming streams; </claim-text><claim-text> calculating at least one parameter selected from a group of parameters consisting of power ratios for allocation to the jamming streams and Modulation and Coding Schemes (MCSs) for assigning to the data streams, based on a criterion that is set to reduce a probability of the data streams being decoded by at least one eavesdropping receiver; and </claim-text><claim-text> transmitting the data streams and the jamming streams using an antenna array while applying the at least one parameter. </claim-text></claim><claim id="clm-0002" num="2"><claim-text> 2. The method according to claim 1, wherein calculating the at least one parameter comprises restricting selection of an MCS for a given data stream to a partial subset of the MCSs. </claim-text></claim><claim id="clm-0003" num="3"><claim-text> 3. The method according to claim 2, wherein restricting the selection of the MCS comprises defining the partial subset of the MCSs based on the power ratios and assumed or pre-measured channel statistics of communication channels between the antenna array and the target receivers. </claim-text></claim><claim id="clm-0004" num="4"><claim-text> 4. The method according to claim 2, wherein restricting the selection of the MCS comprises predefining multiple partial subsets of the MCSs corresponding to respective channel types between the antenna array and the target receivers, determining an actual channel type and selecting the predefined partial subset that corresponds to the actual channel type. </claim-text></claim><claim id="clm-0005" num="5"><claim-text> 5. The method according to claim 2, wherein restricting the selection of the MCS comprises including in the partial subset only the MCSs having at least a selected minimum data rate. </claim-text></claim><claim id="clm-0006" num="6"><claim-text> 6. The method according to claim 1 or 2, wherein calculating the at least one parameter comprises setting a power ratio of a given jamming stream at a fixed value. </claim-text></claim><claim id="clm-0007" num="7"><claim-text> 7. The method according to claim 1 or 2, wherein calculating the at least one parameter comprises adapting the power ratios based on Channel State Information (CSI) of communication channels between the antenna array and the target receivers. <!-- EPO <DP n="32"/>--> </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. A communication apparatus, comprising: </claim-text><claim-text> data generation circuitry, which is configured to generate one or more data streams for transmission to respective target receivers; </claim-text><claim-text> jamming generation circuitry, which is configured to generate one or more jamming streams; </claim-text><claim-text> a control unit, which is configured to calculate at least one parameter selected from a group of parameters consisting of power ratios for allocation to the jamming streams and Modulation and Coding Schemes (MCSs) for assigning to the data streams, based on a criterion that is set to reduce a probability of the data streams being decoded by at least one eavesdropping receiver; and </claim-text><claim-text> transmission circuitry, which is configured to transmit the data streams and the jamming streams using an antenna array while applying the at least one parameter. </claim-text></claim><claim id="clm-0009" num="9"><claim-text> 9. The apparatus according to claim 8, wherein the control unit is configured to calculate the at least one parameter by restricting selection of an MCS for a given data stream to a partial subset of the MCSs. </claim-text></claim><claim id="clm-0010" num="10"><claim-text> 10. The apparatus according to claim 9, wherein the control unit is configured to define the partial subset of the MCSs based on the power ratios and assumed or pre-measured channel statistics of communication channels between the antenna array and the target receivers. </claim-text></claim><claim id="clm-0011" num="11"><claim-text> 11. The apparatus according to claim 9, wherein the control unit is configured to predefine multiple partial subsets of the MCSs corresponding to respective channel types between the antenna array and the target receivers, to determine an actual channel type, and to select the predefined partial subset that corresponds to the actual channel type. </claim-text></claim><claim id="clm-0012" num="12"><claim-text> 12. The apparatus according to claim 9, wherein the control unit is configured to include in the partial subset only the MCSs having at least a selected minimum data rate. </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. The apparatus according to claim 8 or 9, wherein the control unit is configured to set a power ratio of a given jamming stream at a fixed value. </claim-text></claim><claim id="clm-0014" num="14"><claim-text> 14. The apparatus according to claim 8 or 9, wherein the control unit is configured to adapt the power ratios based on Channel State Information (CSI) of communication channels between the antenna array and the target receivers. </claim-text></claim><claim id="clm-0015" num="15"><claim-text>15. A method for communication, comprising: </claim-text><claim-text> generating a data transmission comprising multiple successive parts in respective time intervals, for transmission to a target receiver; <!-- EPO <DP n="33"/>--> generating at least one jamming transmission having a configuration that varies over the respective time intervals corresponding to the parts of the data transmission, including at least first and second different configurations generated during respective first and second time intervals; and </claim-text><claim-text> transmitting the data transmission to the target receiver using an antenna array, and simultaneously transmitting the at least one jamming transmission using the antenna array.</claim-text></claim><claim id="clm-0016" num="16"><claim-text>16. The method according to claim 15, wherein generating the jamming transmission comprises generating a first number of jamming streams during the first time interval, and a second number of the jamming streams, different from the first number, during the second time interval. </claim-text></claim><claim id="clm-0017" num="17"><claim-text> 17. The method according to claim 15, wherein generating the jamming transmission comprises beamforming the jamming transmission using a first beamforming vector during the first time interval, and beamforming the jamming transmission using a second beamforming vector, different from the first beamforming vector, during the second time interval. </claim-text></claim><claim id="clm-0018" num="18"><claim-text>18. The method according to claim 15, wherein generating the jamming transmission comprises inhibiting the jamming transmission during the first time interval, and enabling the jamming transmission during the second time interval. </claim-text></claim><claim id="clm-0019" num="19"><claim-text> 19. The method according to claim 15, wherein generating the jamming transmission comprises producing the jamming transmission at a first power level during the first time interval, and producing the jamming transmission at a second power level, different from the first power level, during the second time interval. </claim-text></claim><claim id="clm-0020" num="20"><claim-text> 20. The method according to any of claims 15-19, wherein generating the data transmission comprises generating a communication packet, wherein the first time interval comprises one or more fields other than a payload of the packet and wherein the second time interval comprises the payload of the packet. </claim-text></claim><claim id="clm-0021" num="21"><claim-text> 21. The method according to any of claims 15-19, wherein the first and second time intervals occur in respective different first and second communication frames, and comprising applying in the target receiver a first receive beamforming vector during the first time interval and a second receive beamforming vector, different from the first receive beamforming vector, during the second time interval, so as to cause the configuration of the jamming transmission to vary over the respective time intervals. <!-- EPO <DP n="34"/>--> </claim-text></claim><claim id="clm-0022" num="22"><claim-text>22. A communication apparatus, comprising: </claim-text><claim-text> data generation circuitry, which is configured to generate a data transmission comprising multiple successive parts in respective time intervals, for transmission to a target receiver; </claim-text><claim-text> jamming generation circuitry, which is configured to generate at least one jamming transmission having a configuration that varies over the respective time intervals corresponding to the parts of the data transmission, including at least first and second different configurations generated during respective first and second time intervals; and </claim-text><claim-text> transmission circuitry, which is configured to transmit the data transmission to the target receiver using an antenna array, and simultaneously transmitting the at least one jamming transmission using the antenna array. </claim-text></claim><claim id="clm-0023" num="23"><claim-text> 23. The apparatus according to claim 22, wherein the jamming generation circuitry is configured to generate a first number of jamming streams during the first time interval, and a second number of the jamming streams, different from the first number, during the second time interval. </claim-text></claim><claim id="clm-0024" num="24"><claim-text> 24. The apparatus according to claim 22, wherein the jamming generation circuitry is configured to beam-form the jamming transmission using a first beamforming vector during the first time interval, and to beam-form the jamming transmission using a second beamforming vector, different from the first beamforming vector, during the second time interval. </claim-text></claim><claim id="clm-0025" num="25"><claim-text> 25. The apparatus according to claim 22, wherein the jamming generation circuitry is configured to inhibit the jamming transmission during the first time interval, and to enable the jamming transmission during the second time interval. </claim-text></claim><claim id="clm-0026" num="26"><claim-text> 26. The apparatus according to claim 22, wherein the jamming generation circuitry is configured to generate the jamming transmission at a first power level during the first time interval, and to generate the jamming transmission at a second power level, different from the first power level, during the second time interval. </claim-text></claim><claim id="clm-0027" num="27"><claim-text> 27. The apparatus according to any of claims 22-26, wherein the data transmission comprises a communication packet, wherein the first time interval comprises one or more fields other than a payload of the packet and wherein the second time interval comprises the payload of the packet. <!-- EPO <DP n="35"/>--> </claim-text></claim><claim id="clm-0028" num="28"><claim-text>28. The apparatus according to any of claims 22-26, wherein the first and second time intervals occur in respective different first and second communication frames, wherein the target receiver applies a first receive beamforming vector during the first time interval and a second receive beamforming vector, different from the first receive beamforming vector, during the second time interval, and wherein the jamming generation circuitry is configured to vary the configuration of the jamming transmission over the respective time intervals in response to the first and second receive beamforming vectors. </claim-text></claim><claim id="clm-0029" num="29"><claim-text> 29. A method for communication, comprising: </claim-text><claim-text> generating, for transmission from multiple transmit antennas, one or more data streams for transmission to respective target receivers and one or more jamming streams; </claim-text><claim-text> calculating respective beamforming vectors for the jamming streams by: </claim-text><claim-text> applying QR factorization to a conjugate of an aggregate matrix of communication channels between the transmit antennas and receive antennas of all the target receivers, to produce a Q matrix; </claim-text><claim-text> extracting a subset of columns of the Q matrix to serve as a basis for a vector subspace that is orthogonal to the aggregate matrix of the communication channels; and </claim-text><claim-text> calculating the beamforming vectors for the jamming streams from the basis; beamforming the jamming streams using the calculated beamforming vectors; and transmitting the data streams to the target receivers using the multiple transmit antennas, and simultaneously transmitting the jamming streams using the multiple transmit antennas. </claim-text></claim><claim id="clm-0030" num="30"><claim-text> 30. The method according to claim 29, wherein extracting the subset of the columns comprises extracting last N-NTJ columns of the Q matrix, N denoting a total number of the transmit antennas, and NTJ denoting a total number of the receive antennas of all the target receivers. </claim-text></claim><claim id="clm-0031" num="31"><claim-text> 31. The method according to claim 29, wherein the aggregate matrix of communication channels is replaced by a matrix obtained from one or more Singular Value Decompositions (SVD) of matrices of the communication channels, which are produced by the target receivers. </claim-text></claim><claim id="clm-0032" num="32"><claim-text>32. A communication apparatus, comprising: </claim-text><claim-text> data generation circuitry, which is configured to generate one or more data streams for transmission to respective target receivers from multiple transmit antennas; <!-- EPO <DP n="36"/>--> jamming generation circuitry, which is configured to generate one or more jamming streams; </claim-text><claim-text> a control unit, which is configured to calculate respective beamforming vectors for the jamming streams by applying QR factorization to a conjugate of an aggregate matrix of communication channels between the transmit antennas and receive antennas of all the target receivers to produce a Q matrix, extracting a subset of columns of the Q matrix to serve as a basis for a vector subspace that is orthogonal to the aggregate matrix of the communication channels, and calculating the beamforming vectors for the jamming streams from the basis; and </claim-text><claim-text> transmission circuitry, which is configured to beam-form the jamming streams using the calculated beamforming vectors, to transmit the data streams to the target receivers using the multiple transmit antennas, and to simultaneously transmit the jamming streams using the multiple transmit antennas. </claim-text></claim><claim id="clm-0033" num="33"><claim-text> 33. The apparatus according to claim 32, wherein the control unit is configured to extract last N-NTJ columns of the Q matrix to serve as the basis, N denoting a total number of the transmit antennas, and NTJ denoting a total number of the receive antennas of all the target receivers. </claim-text></claim><claim id="clm-0034" num="34"><claim-text> 34. The apparatus according to claim 32, wherein the aggregate matrix of communication channels is replaced by a matrix obtained from one or more Singular Value Decompositions (SVD) of matrices of the communication channels, which are produced by the target receivers.</claim-text></claim><claim id="clm-0035" num="35"><claim-text>35. A method for communication, comprising: </claim-text><claim-text> receiving uplink signals from one or more communication stations; </claim-text><claim-text> estimating, based on the received uplink signals, responses of downlink communication channels to the communication stations; </claim-text><claim-text> configuring, based on the estimated downlink communication channels, one or more data streams for transmission using an antenna array to the communication stations and one or more jamming streams for transmission using the antenna array; and </claim-text><claim-text> transmitting the configured data streams and jamming streams. </claim-text></claim><claim id="clm-0036" num="36"><claim-text> 36. The method according to claim 35, and comprising instructing the communication stations to transmit training signals that provide channel information relating to communication channels to all receive antennas of the communication stations. <!-- EPO <DP n="37"/>--> </claim-text></claim><claim id="clm-0037" num="37"><claim-text>37. The method according to claim 35, and comprising instructing a communication station to disable one or more receive chains in the communication station. </claim-text></claim><claim id="clm-0038" num="38"><claim-text> 38. A communication apparatus, comprising: </claim-text><claim-text> a control unit, which is configured to estimate, based on uplink signals that are received from one or more communication stations, responses of downlink communication channels to the communication stations, and to configure, based on the estimated downlink communication channels, one or more data streams for transmission using an antenna array to the communication stations and one or more jamming streams for transmission using the antenna array; and </claim-text><claim-text> transmission circuitry, which is configured to transmit the data streams and jamming streams. </claim-text></claim><claim id="clm-0039" num="39"><claim-text> 39. The apparatus according to claim 38, wherein the control unit is configured to instruct the communication stations to transmit training signals that provide channel information relating to communication channels to all receive antennas of the communication stations. </claim-text></claim><claim id="clm-0040" num="40"><claim-text>40. The apparatus according to claim 38, wherein the control unit is configured to instruct a communication station to disable one or more receive chains in the communication station.</claim-text></claim><claim id="clm-0041" num="41"><claim-text>41. A method for communication, comprising: </claim-text><claim-text> in a transmitter that transmits one or more data streams to respective target receivers and one or more jamming streams for preventing the data streams from being decoded by eavesdropping receivers, holding a definition of at least first and second transmission modes having respective, different first and second levels of security in preventing the data streams from being decoded by the eavesdropping receivers; </claim-text><claim-text> selecting one of the first and second transmission modes for transmitting a data stream to a target receiver by evaluating a selection criterion; and </claim-text><claim-text> transmitting the data stream and the jamming streams via an antenna array using the selected transmission mode. </claim-text></claim><claim id="clm-0042" num="42"><claim-text> 42. The method according to claim 41, wherein transmitting the data stream using the first transmission mode comprises transmitting at least one jamming stream simultaneously with the data stream, and wherein transmitting the data stream using the second transmission mode comprises transmitting the data stream while inhibiting transmission of the jamming streams.</claim-text></claim><claim id="clm-0043" num="43"><claim-text>43. The method according to claim 41, wherein selecting the transmission mode comprises selecting a data rate for the data stream using a first rule, and wherein transmitting the data <!-- EPO <DP n="38"/>--> stream using the second transmission mode comprises selecting the data rate using a second rule, different from the first rule. </claim-text></claim><claim id="clm-0044" num="44"><claim-text> 44. The method according to claim 41, wherein transmitting the data stream using the first transmission mode comprises transmitting channel sounding signals at first time intervals, and wherein transmitting the data stream using the second transmission mode comprises transmitting the channel sounding signals at second time intervals, more frequent than the first intervals. </claim-text></claim><claim id="clm-0045" num="45"><claim-text> 45. The method according to claim 41, wherein selecting the transmission mode comprises instructing the target receiver to respond to sounding requests prior to association with any transmitter while operating in the first transmission mode, and to respond to sounding requests only after the association while operating in the second transmission mode. </claim-text></claim><claim id="clm-0046" num="46"><claim-text> 46. The method according to claim 41, wherein evaluating the selection criterion comprises choosing between the first and second transmission mode depending on a Service Set ID (SSID) with which the target receiver is associated. </claim-text></claim><claim id="clm-0047" num="47"><claim-text>47. The method according to claim 41, wherein transmitting the data stream using the first transmission mode comprises transmitting a jamming stream during a first subset of frames of the data stream, and wherein transmitting the data stream using the second transmission mode comprises transmitting the jamming stream during a second subset of the frames of the data stream, different from the first subset. </claim-text></claim><claim id="clm-0048" num="48"><claim-text>48. The method according to any of claims 41-47, wherein selecting the transmission mode comprises receiving a request from the target receiver to select the one of the first and second transmission modes, and choosing the transmission mode in response to the request. </claim-text></claim><claim id="clm-0049" num="49"><claim-text> 49. The method according to any of claims 41-47, wherein selecting the transmission mode comprises instructing the target receiver to disable one or more receive chains in the target receiver when operating in the first transmission mode, and to enable the one or more receive chains when operating in the second transmission mode. </claim-text></claim><claim id="clm-0050" num="50"><claim-text> 50. The method according to any of claims 41-47, wherein selecting the transmission mode comprises instructing the target receiver to transmit, when operating in the first transmission mode, channel feedback that is indicative of all receive antennas of the target receiver. <!-- EPO <DP n="39"/>--> </claim-text></claim><claim id="clm-0051" num="51"><claim-text>51. The method according to any of claims 41-47, wherein selecting the transmission mode comprises extracting from the data stream a tag that indicates a requested transmission mode, and selecting the transmission mode responsively to the tag. </claim-text></claim><claim id="clm-0052" num="52"><claim-text> 52. The method according to any of claims 41-47, wherein selecting the transmission mode comprises detecting an exchange of Request- To-Send/Clear- To-Send (RTS/CTS) messages that precedes the data stream, from which an identity of a target receiver intended to receive the data stream is recognizable, and initiating the transmission mode based on the detected RTS/CTS messages. </claim-text></claim><claim id="clm-0053" num="53"><claim-text> 53. A communication apparatus, comprising: </claim-text><claim-text> transmission circuitry, which is configured to transmit data streams to target receivers and jamming streams for preventing the data streams from being decoded by eavesdropping receivers; and </claim-text><claim-text> a control unit, which is configured to hold a definition of at least first and second transmission modes having respective, different first and second levels of security in preventing the data streams from being decoded by the eavesdropping receivers, to select one of the first and second transmission modes for transmitting a data stream to a target receiver by evaluating a selection criterion, and to control the transmission circuitry to transmit the data stream and the jamming streams via an antenna array using the selected transmission mode.</claim-text></claim><claim id="clm-0054" num="54"><claim-text>54. The apparatus according to claim 53, wherein the control unit is configured to control the transmission circuitry to transmit at least one jamming stream simultaneously with the data stream in the first transmission mode, and to transmit the data stream while inhibiting transmission of the jamming streams in the second transmission mode. </claim-text></claim><claim id="clm-0055" num="55"><claim-text> 55. The apparatus according to claim 53, wherein the control unit is configured to select a data rate for the data stream using a first rule in the first transmission mode, and to select the data rate using a second rule, different from the first rule, in the second transmission mode.</claim-text></claim><claim id="clm-0056" num="56"><claim-text>56. The apparatus according to claim 53, wherein the control unit is configured to control the transmission circuitry to transmit channel sounding signals at first time intervals in the first transmission mode, and to transmit the channel sounding signals at second time intervals, more frequent than the first intervals, in the second transmission mode. </claim-text></claim><claim id="clm-0057" num="57"><claim-text>57. The apparatus according to claim 53, wherein the control unit is configured to instruct the target receiver to respond to sounding requests prior to association with any transmitter <!-- EPO <DP n="40"/>--> while operating in the first transmission mode, and to respond to sounding requests only after the association while operating in the second transmission mode. </claim-text></claim><claim id="clm-0058" num="58"><claim-text> 58. The apparatus according to claim 53, wherein the control unit is configured to choose between the first and second transmission mode depending on a Basic Service Set ID (SSID) with which the target receiver is associated. </claim-text></claim><claim id="clm-0059" num="59"><claim-text> 59. The apparatus according to claim 53, wherein the control unit is configured to control the transmission circuitry to transmit a jamming stream during a first subset of frames of the data stream in the first transmission mode, and to transmit the jamming stream during a second subset of the frames of the data stream, different from the first subset, in the second transmission mode. </claim-text></claim><claim id="clm-0060" num="60"><claim-text> 60. The apparatus according to any of claims 53-59, wherein the control unit is configured to receive a request from the target receiver to select the one of the first and second transmission modes, and to choose the transmission mode in response to the request. </claim-text></claim><claim id="clm-0061" num="61"><claim-text> 61. The apparatus according to any of claims 53-59, wherein the control unit is configured to instruct the target receiver to disable one or more receive chains in the target receiver when operating in the first transmission mode, and to enable the one or more receive chains when operating in the second transmission mode. </claim-text></claim><claim id="clm-0062" num="62"><claim-text> 62. The apparatus according to any of claims 53-59, wherein the control unit is configured to instruct the target receiver to transmit, when operating in the first transmission mode, channel feedback that is indicative of all receive antennas of the target receiver. </claim-text></claim><claim id="clm-0063" num="63"><claim-text> 63. The apparatus according to any of claims 53-59, wherein the control unit is configured to extract from the data stream a tag that indicates a requested transmission mode, and to select the transmission mode responsively to the tag. </claim-text></claim><claim id="clm-0064" num="64"><claim-text> 64. The apparatus according to any of claims 53-59, wherein the control unit is configured to detect an exchange of Request-To-Send/Clear- To-Send (RTS/CTS) messages that precedes the data stream, from which an identity of a target receiver intended to receive the data stream is recognizable, and to initiate the selected transmission mode based on the detected RTS/CTS messages. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
