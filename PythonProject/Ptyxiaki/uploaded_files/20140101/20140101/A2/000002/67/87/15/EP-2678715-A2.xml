<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2678715-A2" country="EP" doc-number="2678715" kind="A2" date="20140101" family-id="46932355" file-reference-id="241958" date-produced="20180826" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146550758" ucid="EP-2678715-A2"><document-id><country>EP</country><doc-number>2678715</doc-number><kind>A2</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12763922-A" is-representative="NO"><document-id mxw-id="PAPP154824681" load-source="docdb" format="epo"><country>EP</country><doc-number>12763922</doc-number><kind>A</kind><date>20120330</date><lang>EN</lang></document-id><document-id mxw-id="PAPP186168075" load-source="docdb" format="original"><country>EP</country><doc-number>12763922.7</doc-number><date>20120330</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140447413" ucid="US-201161469925-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201161469925</doc-number><kind>P</kind><date>20110331</date></document-id></priority-claim><priority-claim mxw-id="PPC140449762" ucid="US-2012031378-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>2012031378</doc-number><kind>W</kind><date>20120330</date></document-id></priority-claim><priority-claim mxw-id="PPC140449289" ucid="US-201213434579-A" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201213434579</doc-number><kind>A</kind><date>20120329</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-2010936841" load-source="docdb">G01V   1/30        20060101AFI20151016BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1915454720" load-source="docdb" scheme="CPC">G01V   1/303       20130101 LI20160726BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2090241582" load-source="docdb" scheme="CPC">G01V2210/671       20130101 LA20150227BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2090245766" load-source="docdb" scheme="CPC">G01V   1/28        20130101 LI20150227BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2090246007" load-source="docdb" scheme="CPC">G01V   1/301       20130101 FI20150227BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132184758" lang="DE" load-source="patent-office">FREQUENZABHÄNGIGE STRAHLVERFOLGUNG ÜBER EINE SCHNITTSTELLE</invention-title><invention-title mxw-id="PT132184759" lang="EN" load-source="patent-office">FREQUENCY-DEPENDENT RAY TRACING THROUGH AN INTERFACE</invention-title><invention-title mxw-id="PT132184760" lang="FR" load-source="patent-office">TRAÇAGE DE RAYON DÉPENDANT DE LA FRÉQUENCE À TRAVERS UNE INTERFACE</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR918138476" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>GECO TECHNOLOGY BV</last-name><address><country>NL</country></address></addressbook></applicant><applicant mxw-id="PPAR918152304" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>GECO TECHNOLOGY B.V.</last-name></addressbook></applicant><applicant mxw-id="PPAR918985354" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Geco Technology B.V.</last-name><iid>101018389</iid><address><street>Gevers Deynootweg 61</street><city>2586 BJ S'Gravenhage</city><country>NL</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918153165" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>PROTASOV MAXIM</last-name><address><country>RU</country></address></addressbook></inventor><inventor mxw-id="PPAR918164452" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>PROTASOV, Maxim</last-name></addressbook></inventor><inventor mxw-id="PPAR918993505" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>PROTASOV, Maxim</last-name><address><street>2g Komsomolskaya St. Apt. 15</street><city>Berdsk 633011</city><country>RU</country></address></addressbook></inventor><inventor mxw-id="PPAR918154547" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>OSYPOV KONSTANTIN</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918150634" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>OSYPOV, KONSTANTIN</last-name></addressbook></inventor><inventor mxw-id="PPAR918987464" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>OSYPOV, KONSTANTIN</last-name><address><street>14402 Kingston Cove Lane</street><city>Houston, Texas 77077</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918146818" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>NICHOLS DAVID</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918136344" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>NICHOLS, DAVID</last-name></addressbook></inventor><inventor mxw-id="PPAR918982599" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>NICHOLS, DAVID</last-name><address><street>1181 Harriet Street</street><city>Palo Alto, California 94301</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR991279523" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>YARMAN CAN E</last-name><address><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR918144412" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>YARMAN, Can, E.</last-name></addressbook></inventor><inventor mxw-id="PPAR918982498" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>YARMAN, Can, E.</last-name><address><street>3660 Richmond Ave. Apt. 341</street><city>Houston, Texas 77047</city><country>US</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918982077" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Ford, Michael Frederick</last-name><iid>101020297</iid><address><street>Schlumberger Cambridge Research Limited High Cross Madingley Road</street><city>Cambridge CB3 0EL</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="US-2012031378-W"><document-id><country>US</country><doc-number>2012031378</doc-number><kind>W</kind><date>20120330</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012135580-A2"><document-id><country>WO</country><doc-number>2012135580</doc-number><kind>A2</kind><date>20121004</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS548917390" load-source="docdb">AL</country><country mxw-id="DS548915194" load-source="docdb">AT</country><country mxw-id="DS548917391" load-source="docdb">BE</country><country mxw-id="DS548916048" load-source="docdb">BG</country><country mxw-id="DS548901242" load-source="docdb">CH</country><country mxw-id="DS548833870" load-source="docdb">CY</country><country mxw-id="DS548915195" load-source="docdb">CZ</country><country mxw-id="DS548861395" load-source="docdb">DE</country><country mxw-id="DS548917392" load-source="docdb">DK</country><country mxw-id="DS548833871" load-source="docdb">EE</country><country mxw-id="DS548813339" load-source="docdb">ES</country><country mxw-id="DS548916049" load-source="docdb">FI</country><country mxw-id="DS548916054" load-source="docdb">FR</country><country mxw-id="DS548861396" load-source="docdb">GB</country><country mxw-id="DS548917393" load-source="docdb">GR</country><country mxw-id="DS548917394" load-source="docdb">HR</country><country mxw-id="DS548833872" load-source="docdb">HU</country><country mxw-id="DS548901243" load-source="docdb">IE</country><country mxw-id="DS548917395" load-source="docdb">IS</country><country mxw-id="DS548916055" load-source="docdb">IT</country><country mxw-id="DS548833873" load-source="docdb">LI</country><country mxw-id="DS548861397" load-source="docdb">LT</country><country mxw-id="DS548915196" load-source="docdb">LU</country><country mxw-id="DS548861398" load-source="docdb">LV</country><country mxw-id="DS548861399" load-source="docdb">MC</country><country mxw-id="DS548924215" load-source="docdb">MK</country><country mxw-id="DS548924216" load-source="docdb">MT</country><country mxw-id="DS548813340" load-source="docdb">NL</country><country mxw-id="DS548915197" load-source="docdb">NO</country><country mxw-id="DS548813341" load-source="docdb">PL</country><country mxw-id="DS548915198" load-source="docdb">PT</country><country mxw-id="DS548813342" load-source="docdb">RO</country><country mxw-id="DS548915199" load-source="docdb">RS</country><country mxw-id="DS548813343" load-source="docdb">SE</country><country mxw-id="DS548833874" load-source="docdb">SI</country><country mxw-id="DS548924217" load-source="docdb">SK</country><country mxw-id="DS548924218" load-source="docdb">SM</country><country mxw-id="DS548901244" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA100631092" ref-ucid="WO-2012135580-A2" lang="EN" load-source="patent-office"><p num="0000">Computing systems and methods for improving processing of collected data are disclosed. In one embodiment, while ray-tracing through a sub-surface region, a frequency-dependent outgoing ray direction is computed from a point on an interface disposed in the sub-surface region when the ray tracing is at the interface.</p></abstract><abstract mxw-id="PA100962776" ref-ucid="WO-2012135580-A2" lang="EN" source="national office" load-source="docdb"><p>Computing systems and methods for improving processing of collected data are disclosed. In one embodiment, while ray-tracing through a sub-surface region, a frequency-dependent outgoing ray direction is computed from a point on an interface disposed in the sub-surface region when the ray tracing is at the interface.</p></abstract><abstract mxw-id="PA100631093" ref-ucid="WO-2012135580-A2" lang="FR" load-source="patent-office"><p num="0000">L'invention porte sur des systèmes et sur des procédés informatiques pour améliorer le traitement de données collectées. Dans un mode de réalisation, pendant le traçage de rayon à travers une région sous la surface, une direction de rayon sortant dépendant de la fréquence est calculée à partir d'un point sur une interface disposé dans la région sous la surface lorsque le traçage de rayon se trouve à l'interface.</p></abstract><abstract mxw-id="PA100962777" ref-ucid="WO-2012135580-A2" lang="FR" source="national office" load-source="docdb"><p>L'invention porte sur des systèmes et sur des procédés informatiques pour améliorer le traitement de données collectées. Dans un mode de réalisation, pendant le traçage de rayon à travers une région sous la surface, une direction de rayon sortant dépendant de la fréquence est calculée à partir d'un point sur une interface disposé dans la région sous la surface lorsque le traçage de rayon se trouve à l'interface.</p></abstract><description mxw-id="PDES51675024" ref-ucid="WO-2012135580-A2" lang="EN" load-source="patent-office"><!-- EPO <DP n="2"/>--><p id="p0001" num="0001"> FREQUENCY-DEPENDENT RAY TRACING THROUGH AN INTERFACE </p><p id="p0002" num="0002">TECHNICAL FIELD </p><p id="p0003" num="0003">[0001] The embodiments of methods and computing systems discussed herein are related to processing of collected data, and some embodiments are more particularly related to data processing for imaging collected data corresponding to a sub-surface region. </p><p id="p0004" num="0004">BACKGROUND </p><p id="p0005" num="0005">[0002] Ray tracing is a popular seismic data processing method for approximating wave propagation for small wavelengths, or, equivalently, high frequencies. Furthermore, ray tracing results are still valid when medium parameters and the wavefields are smooth on the scale-length of the width of the Fresnel volume. In some instances, conventional ray-tracing validity conditions can break down in the vicinity of an interface when there is high contrast between the two sides of the interface and/or when the interface has a complex structure. One example of this concern is with respect to velocity models that include salt with rugose boundaries that are used in Kirchhoff prestack depth migration. In practice, model smoothing in one of its various forms can be used to stabilize geometric ray results. </p><p id="p0006" num="0006">[0003] Alternatively, finite-difference methods propagate band-limited waves, without requiring smoothness constraints on the medium parameters. But they are computationally demanding. </p><p id="p0007" num="0007">[0004] Accordingly, there is a need for methods and computing systems that can employ more effective and accurate methods for data processing of collected data that corresponds to a sub-surface region, including techniques that allow capturing a band-limited wave propagation property of finite-difference methods by employing frequency-dependent ray- tracing. 
<!-- EPO <DP n="3"/>-->
 SUMMARY </p><p id="p0008" num="0008">[0005] The computing systems, methods, processing procedures, techniques and workflows disclosed herein are more efficient and/or effective methods for data processing of collected data that corresponds to a sub-surface region. </p><p id="p0009" num="0009">[0006] In accordance with some embodiments, a method for ray tracing through a subsurface region that includes an interface is performed that includes: when the ray tracing is before the interface, performing conventional ray tracing through the sub-surface region; when the ray tracing is at the interface, computing a frequency-dependent outgoing ray direction from a point on the interface, wherein the computation is based at least in part on: an incoming ray direction, one or more surface normals, and a computed boundary integral that is based at least in part on the incoming ray direction and a frequency parameter. </p><p id="p0010" num="0010">[0007] In accordance with some embodiments, a computing system for ray tracing through a sub-surface region that includes an interface is provided that includes at least one processor, at least one memory, and one or more programs stored in the at least one memory, wherein the one or more programs are configured to be executed by the one or more processors, the one or more programs including instructions for: when the ray tracing is before the interface, performing conventional ray tracing through the sub-surface region; when the ray tracing is at the interface, computing a frequency-dependent outgoing ray direction from a point on the interface, wherein the computation is based at least in part on: an incoming ray direction, one or more surface normals, and a computed boundary integral that is based at least in part on the incoming ray direction and a frequency parameter. </p><p id="p0011" num="0011">[0008] In accordance with some embodiments, a computer readable storage medium for ray tracing through a sub-surface region that includes an interface is provided, the medium having a set of one or more programs including instructions that when executed by a computing system cause the computing system to: when the ray tracing is before the interface, perform conventional ray tracing through the sub-surface region; when the ray tracing is at the interface, compute a frequency-dependent outgoing ray direction from a point on the interface, wherein the computation is based at least in part on: an incoming ray direction, one 
<!-- EPO <DP n="4"/>-->
 or more surface normals, and a computed boundary integral that is based at least in part on the incoming ray direction and a frequency parameter. </p><p id="p0012" num="0012">[0009] In accordance with some embodiments, a computing system for ray tracing through a sub-surface region that includes an interface is provided that includes at least one processor, at least one memory, and one or more programs stored in the at least one memory; and when the ray tracing is before the interface, means for performing conventional ray tracing through the sub-surface region; when the ray tracing is at the interface, means for computing a frequency-dependent outgoing ray direction from a point on the interface, wherein the computation is based at least in part on: an incoming ray direction, one or more surface normals, and a computed boundary integral that is based at least in part on the incoming ray direction and a frequency parameter. </p><p id="p0013" num="0013">[0010] In accordance with some embodiments, an information processing apparatus for use in a computing system is provided for ray tracing through a sub-surface region that includes an interface, and includes the following: when the ray tracing is before the interface, means for performing conventional ray tracing through the sub-surface region; when the ray tracing is at the interface, means for computing a frequency-dependent outgoing ray direction from a point on the interface, wherein the computation is based at least in part on: an incoming ray direction, one or more surface normals, and a computed boundary integral that is based at least in part on the incoming ray direction and a frequency parameter. </p><p id="p0014" num="0014">[0011] In accordance with some embodiments, a method for ray tracing through a subsurface region that includes an interface is performed that includes: computing a frequency- dependent outgoing ray direction from a point on the interface when the ray tracing is at the interface, wherein the computation is based at least in part on: an incoming ray direction, one or more surface normals, and a computed boundary integral that is based at least in part on the incoming ray direction and a frequency parameter. </p><p id="p0015" num="0015">[0012] In accordance with some embodiments, a computing system for ray tracing through a sub-surface region that includes an interface is provided that includes at least one processor, at least one memory, and one or more programs stored in the at least one memory, wherein the one or more programs are configured to be executed by the one or more 
<!-- EPO <DP n="5"/>-->
 processors, the one or more programs including instructions for: computing a frequency- dependent outgoing ray direction from a point on the interface when the ray tracing is at the interface, wherein the computation is based at least in part on: an incoming ray direction, one or more surface normals, and a computed boundary integral that is based at least in part on the incoming ray direction and a frequency parameter. </p><p id="p0016" num="0016">[0013] In accordance with some embodiments, a computer readable storage medium for ray tracing through a sub-surface region that includes an interface is provided, the medium having a set of one or more programs including instructions that when executed by a computing system cause the computing system to: compute a frequency-dependent outgoing ray direction from a point on the interface when the ray tracing is at the interface, wherein the computation is based at least in part on: an incoming ray direction, one or more surface normals, and a computed boundary integral that is based at least in part on the incoming ray direction and a frequency parameter </p><p id="p0017" num="0017">[0014] In accordance with some embodiments, a computing system for ray tracing through a sub-surface region that includes an interface is provided that includes at least one processor, at least one memory, and one or more programs stored in the at least one memory; and means for computing a frequency-dependent outgoing ray direction from a point on the interface when the ray tracing is at the interface, wherein the computation is based at least in part on: an incoming ray direction, one or more surface normals, and a computed boundary integral that is based at least in part on the incoming ray direction and a frequency parameter. </p><p id="p0018" num="0018">[0015] In accordance with some embodiments, an information processing apparatus for use in a computing system is provided for ray tracing through a sub-surface region that includes an interface, and includes means for computing a frequency-dependent outgoing ray direction from a point on the interface when the ray tracing is at the interface, wherein the computation is based at least in part on: an incoming ray direction, one or more surface normals, and a computed boundary integral that is based at least in part on the incoming ray direction and a frequency parameter. </p><p id="p0019" num="0019">[0016] In accordance with some embodiments, a method is performed that includes: computing a frequency-dependent outgoing ray direction departing from a point at an 
<!-- EPO <DP n="6"/>-->
 interface disposed in a sub-surface region, wherein the computation is based at least in part on an incoming ray direction, one or more surface normals, and a computed boundary integral that is based at least in part on the incoming ray direction and a frequency parameter. </p><p id="p0020" num="0020">[0017] In accordance with some embodiments, a computing system is provided that includes at least one processor, at least one memory, and one or more programs stored in the at least one memory, wherein the one or more programs are configured to be executed by the one or more processors, the one or more programs including instructions for computing a frequency-dependent outgoing ray direction departing from a point at an interface disposed in a sub-surface region, wherein the computation is based at least in part on an incoming ray direction, one or more surface normals, and a computed boundary integral that is based at least in part on the incoming ray direction and a frequency parameter. </p><p id="p0021" num="0021">[0018] In accordance with some embodiments, a computer readable storage medium is provided, the medium having a set of one or more programs including instructions that when executed by a computing system cause the computing system to: compute a frequency- dependent outgoing ray direction departing from a point at an interface disposed in a subsurface region, wherein the computation is based at least in part on an incoming ray direction, one or more surface normals, and a computed boundary integral that is based at least in part on the incoming ray direction and a frequency parameter. </p><p id="p0022" num="0022">[0019] In accordance with some embodiments, a computing system is provided that includes at least one processor, at least one memory, and one or more programs stored in the at least one memory; and means for computing a frequency-dependent outgoing ray direction departing from a point at an interface disposed in a sub-surface region, wherein the computation is based at least in part on an incoming ray direction, one or more surface normals, and a computed boundary integral that is based at least in part on the incoming ray direction and a frequency parameter. </p><p id="p0023" num="0023">[0020] In accordance with some embodiments, an information processing apparatus for use in a computing system is provided, and includes means for computing a frequency- dependent outgoing ray direction departing from a point at an interface disposed in a subsurface region, wherein the computation is based at least in part on an incoming ray direction, 
<!-- EPO <DP n="7"/>-->
 one or more surface normals, and a computed boundary integral that is based at least in part on the incoming ray direction and a frequency parameter. </p><p id="p0024" num="0024">[0021] In some embodiments, an aspect of the invention involves computing an outgoing traveltime from the point on the interface. </p><p id="p0025" num="0025">[0022] In some embodiments, an aspect of the invention involves computing an outgoing amplitude from the point on the interface. </p><p id="p0026" num="0026">[0023] In some embodiments, an aspect of the invention involves using the computed boundary integral as a cost function to find the frequency-dependent outgoing ray direction. </p><p id="p0027" num="0027">[0024] In some embodiments, an aspect of the invention involves computing a Fresnel volume for a trial outgoing direction within the vicinity of the point on the interface; computing an intersection of the Fresnel volume with the interface within the vicinity of the point on the interface; computing an approximation of a Green's function within the intersection of the Fresnel volume with the interface within the vicinity of the point on the interface; computing a Kirchhoff-like integral based cost function within the intersection of the Fresnel volume with the interface within the vicinity of the point on the interface using the approximated Green's function; and varying the trial outgoing direction until the cost function is maximized (or in some embodiments, until the cost function is increased). </p><p id="p0028" num="0028">[0025] In some embodiments, an aspect of the invention involves using the boundary integral to find one or more local averaging properties substantially within the vicinity of the point on the interface. </p><p id="p0029" num="0029">[0026] In some embodiments, an aspect of the invention involves computing a Fresnel volume for a fixed outgoing direction within the vicinity of the point on the interface; computing the intersection of the Fresnel volume with the interface within the vicinity of the point on the interface; computing an approximation to a Green's function for a plurality of points within the intersection of the Fresnel volume with the interface within the vicinity of the point on the interface; at respective points in the plurality of points, using the approximated Green's function to compute respective incoming directions, respective surface normals and their respective contributions to a cost function; for the point on the interface, 
<!-- EPO <DP n="8"/>-->
 computing: an effective incoming direction as a weighted sum of the respective incoming directions of the plurality of points, and an effective normal as a weighted sum of the respective normals of the plurality of points; and applying Snell's law to the effective incoming direction and effective normal to compute an effective outgoing direction as the outgoing direction. </p><p id="p0030" num="0030">[0027] In some embodiments, an aspect of the invention involves performing conventional ray tracing through the sub-surface region when the ray tracing is after the interface. </p><p id="p0031" num="0031">[0028] In some embodiments, an aspect of the invention involves forming an image of the sub-surface region based at least in part on the ray-tracing. </p><p id="p0032" num="0032">[0029] In some embodiments, an aspect of the invention includes that the computation of the frequency-dependent outgoing ray direction is also based on a travel time from an edge of the sub-surface region to the point of interest. </p><p id="p0033" num="0033">[0030] In some embodiments, an aspect of the invention includes that the incoming ray direction is a weighted average of a plurality of incoming directions corresponding to a propagating wave. </p><p id="p0034" num="0034">[0031] In some embodiments, an aspect of the invention includes that the computation of the frequency-dependent outgoing ray direction includes localization of a Kirchoff integral corresponding to a region of a Fresnel volume corresponding to the vicinity of the point of interest. </p><p id="p0035" num="0035">[0032] In some embodiments, an aspect of the invention involves forming an image of the sub-surface region based at least in part on the frequency-dependent outgoing ray direction. </p><p id="p0036" num="0036">[0033] In some embodiments, an aspect of the invention includes that the sub-surface region is a subterranean region with one or more geologic regions of interest. </p><p id="p0037" num="0037">[0034] Thus, the computing systems, methods, processing procedures, techniques, and workflows disclosed herein are more efficient and/or effective methods for data processing of collected data that corresponds to a sub-surface region. These computing systems and 
<!-- EPO <DP n="9"/>-->
 methods increase data processing effectiveness, efficiency, and accuracy. Such methods and computing systems may complement or replace conventional methods for processing of collected data that corresponds to a sub-surface region. </p><p id="p0038" num="0038">BRIEF DESCRIPTION OF THE DRAWINGS </p><p id="p0039" num="0039">[0035] A better understanding of the computing systems, methods, processing procedures, techniques, and workflows disclosed herein can be had when the following detailed description is considered in conjunction with the following drawings, in which: </p><p id="p0040" num="0040">[0036] Figure 1 illustrates a computing system in accordance with some embodiments. </p><p id="p0041" num="0041">[0037] Figs. 2A-2E and Figs. 3A-3C illustrate aspects of ray tracing, Snell's law, and the effects of an interface on ray tracing in accordance with some embodiments. </p><p id="p0042" num="0042">[0038] Figs. 4-7 are flow diagrams illustrating processing methods in accordance with some embodiments. </p><p id="p0043" num="0043">DETAILED DESCRIPTION </p><p id="p0044" num="0044">[0039] Reference will now be made in detail to embodiments, examples of which are illustrated in the accompanying drawings and figures. In the following detailed description, numerous specific details are set forth in order to provide a thorough understanding of the invention. However, it will be apparent to one of ordinary skill in the art that the invention may be practiced without these specific details. In other instances, well-known methods, procedures, components and systems have not been described in detail so as not to unnecessarily obscure aspects of the embodiments. </p><p id="p0045" num="0045">[0040] It will also be understood that, although the terms first, second, etc. may be used herein to describe various elements, these elements should not be limited by these terms. These terms are only used to distinguish one element from another. For example, a first object or step could be termed a second object or step, and, similarly, a second object or step could be termed a first object or step, without departing from the scope of the invention. The first object or step, and the second object or step, are both objects or steps, respectively, but they are not to be considered the same object or step. 
<!-- EPO <DP n="10"/>-->
 [0041] The terminology used in the description of the invention herein is for the purpose of describing particular embodiments only and is not intended to be limiting of the invention. As used in the description of the invention and the appended claims, the singular forms "a," "an" and "the" are intended to include the plural forms as well, unless the context clearly indicates otherwise. It will also be understood that the term "and/or" as used herein refers to and encompasses any and all possible combinations of one or more of the associated listed items. It will be further understood that the terms "includes," "including," "comprises," and/or "comprising," when used in this specification, specify the presence of stated features, integers, steps, operations, elements, and/or components, but do not preclude the presence or addition of one or more other features, integers, steps, operations, elements, components, and/or groups thereof. </p><p id="p0046" num="0046">[0042] As used herein, the term "if may be construed to mean "when" or "upon" or "in response to determining" or "in response to detecting," depending on the context. Similarly, the phrase "if it is determined" or "if [a stated condition or event] is detected" may be construed to mean "upon determining" or "in response to determining" or "upon detecting [the stated condition or event]" or "in response to detecting [the stated condition or event]," depending on the context. </p><p id="p0047" num="0047">[0043] Attention is now directed to Fig. 1, which depicts an example computing system 100 in accordance with some embodiments. The computing system 100 can be an individual computer system 101 A or an arrangement of distributed computer systems. The computer system 101 A includes one or more analysis modules 102 that are configured to perform various tasks according to some embodiments, such as the methods illustrated in Figs. 4, 5, 6 and 7. To perform these various tasks, analysis module 102 executes independently, or in coordination with, one or more processors 104, which is (or are) connected to one or more storage media 106. The processor(s) 104 is (or are) also connected to a network interface 108 to allow the computer system 101 A to communicate over a data network 110 with one or more additional computer systems and/or computing systems, such as 101B, 101C, and/or 101D (note that computer systems 101B, 101C and/or 101D may or may not share the same architecture as computer system 101 A, and may be located in different physical locations, e.g. computer systems 101 A and 10 IB may be on a ship underway on the ocean, while in 
<!-- EPO <DP n="11"/>-->
 communication with one or more computer systems such as 101C and/or 10 ID that are located in one or more data centers on shore, other ships, and/or located in varying countries on different continents). </p><p id="p0048" num="0048">[0044] A processor can include a microprocessor, microcontroller, processor module or subsystem, programmable integrated circuit, programmable gate array, or another control or computing device. </p><p id="p0049" num="0049">[0045] The storage media 106 can be implemented as one or more computer-readable or machine-readable storage media. Note that while in the example embodiment of Fig. 1 storage media 106 is depicted as within computer system 101 A, in some embodiments, storage media 106 may be distributed within and/or across multiple internal and/or external enclosures of computing system 101 A and/or additional computing systems. Storage media 106 may include one or more different forms of memory including semiconductor memory devices such as dynamic or static random access memories (DRAMs or SRAMs), erasable and programmable read-only memories (EPROMs), electrically erasable and programmable read-only memories (EEPROMs) and flash memories; magnetic disks such as fixed, floppy and removable disks; other magnetic media including tape; optical media such as compact disks (CDs) or digital video disks (DVDs); or other types of storage devices. Note that the instructions discussed above can be provided on one computer-readable or machine-readable storage medium, or alternatively, can be provided on multiple computer-readable or machine- readable storage media distributed in a large system having possibly plural nodes. Such computer-readable or machine-readable storage medium or media is (are) considered to be part of an article (or article of manufacture). An article or article of manufacture can refer to any manufactured single component or multiple components. The storage medium or media can be located either in the machine running the machine-readable instructions, or located at a remote site from which machine-readable instructions can be downloaded over a network for execution. </p><p id="p0050" num="0050">[0046] It should be appreciated that computing system 100 is only one example of a computing system, and that computing system 100 may have more or fewer components than shown, may combine additional components not depicted in the example embodiment of 
<!-- EPO <DP n="12"/>-->
 Figure 1 , and/or computing system 100 may have a different configuration or arrangement of the components depicted in Figure 1. The various components shown in Fig. 1 may be implemented in hardware, software, or a combination of both hardware and software, including one or more signal processing and/or application specific integrated circuits. </p><p id="p0051" num="0051">[0047] Attention is now directed to aspects of ray tracing, Snell's law, and the effects of an interface on ray tracing in accordance with some embodiments. Figs. 2A-2E and Figs. 3A- 3C will be used in conjunction with this disclosure to illustrate and explain various aspects of one or more embodiments disclosed herein. </p><p id="p0052" num="0052">[0048] When signal bandwidth is large (e.g., practically unlimited) or when the boundaries of sub-surface structures are smooth, then conventional ray tracing is an efficient way of approximating a wave propagation. In some circumstances, a single ray may adequately describe the wave propagation. The behavior of a wave around an interface, as described by a ray, is characterized by Snell's law, as illustrated by Fig. 2A. An incoming ray (201) with an incoming direction i hits the interface Γ (202) at location x<sub>0</sub> (203) and normal n (204) crosses through the interface towards an outgoing direction p<sub>2</sub> (205). Snell's law dictates the relationship that a singular incoming ray generates a unique outgoing ray under the infinite frequency or bandwidth assumption. For complex, non-flat or rugose interfaces, however, band-limited wave propagation behavior is not adequately characterized using such a high frequency assumption. As illustrated in Fig. 2B, one needs to consider more than one incoming direction within the intersection of a Fresnel volume 207 and an interface, FZ<sub>x</sub>o (208), that is within the Fresnel volume 207. In these circumstances, a frequency-dependent ray-tracing method in accordance with some embodiments can be defined using a frequency- dependent Snell's law, which provides that in some circumstances, there is a relationship between the incoming directions that are incident to Γ<sub>χ</sub>ο and the most energetic outgoing direction. As illustrated in Fig. 2C, there are a plurality of incoming directions i (209-1 through 209-6, not all labeled in Fig. 2C) that are incident to Γ<sub>χ</sub>ο, and there is an energetic outgoing direction 210 among a plurality of outgoing directions p<sub>2</sub> (21 1-1 through 21 1-7, not all labeled in Fig. 2C). 
<!-- EPO <DP n="13"/>-->
 [0049] In this application, some methods and computing systems for performing frequency-dependent ray-tracing in the presence of sharp discontinuities across non-flat or rugose interfaces are presented. In some use cases, such as when performing ray tracing at a particularly steep interface, ray theory may break down, but there is still physical ray propagation where these rays are not high frequency rays and/or these rays depend on frequencies. In some embodiments disclosed herein, methods and computing systems for performing frequency-dependent ray-tracing are based on the usage of boundary integrals, which can improve frequency-dependent ray-tracing at (or substantially adjacent to) the interface where conventional ray tracing may provide less accurate results. </p><p id="p0053" num="0053">Localization of Kirchhoff Integral </p><p id="p0054" num="0054">[0050] Referring to Fig. 2D, let Γ be the interface (214) between two mediums Ci and C<sub>2</sub> (216 and 218, respectively), not necessarily homogeneous, whose Green's functions are denoted by Gia. The source X<sub>s</sub> is frequency band-limited (e.g. in some circumstances, it may be a Gaussian beam 212 as depicted in Fig. 2). The transmitted wavefield into the second medium C<sub>2</sub> due to a source X<sub>s</sub> wavefield in the first medium Ci may be given by the Kirchhoff integral formula as follows: </p><p id="p0055" num="0055">&lt;¾ (x, r<sub>;</sub> (ø} d<sub>n</sub> / ( s, x , (0 )</p><p id="p0056" num="0056"><img id="imgf000013_0001" he="15" wi="47" file="imgf000013_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/></p><p id="p0057" num="0057"> T{x)e<sup>~i2</sup>* ds<sub>r</sub>(x.) dG&gt;. (1 ) where n is the unit normal of the surface, d<sub>n</sub> = n<sup>■</sup> V<sub>x</sub> is the directional derivative along the normal, s and r denote source and receiver locations, x is a point on the surface Γ, u<sub>t</sub> is the incident wavefield on the interface given by </p><p id="p0058" num="0058">(2) where F(co) is the source waveform and T(x) is the transmission coefficient at x. 
<!-- EPO <DP n="14"/>-->
 [0051] F(co) is the Fourier transform of a band-limited real waveform, i.e., F(co) = F (-co), and F(co) is zero outside of the interval 
<img id="imgf000014_0001" he="5" wi="10" file="imgf000014_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 co<sub>max</sub>], for some maximum and minimum frequencies co<sub>max</sub>, co<sub>m</sub>i<sub>n</sub> respectively. Without loss of generality, we take F(co) equal to one for 0 &lt; co<sub>m</sub>i<sub>n</sub> &lt; co &lt; co<sub>max</sub> and zero otherwise. </p><p id="p0059" num="0059">[0052] In some embodiments, one can use ray theory/geometric optics approximations of the Green's functions and write </p><p id="p0060" num="0060">G 1.2 (x , y<sup>■</sup> <sub>}</sub> ω ) ?¾ Λ 1 ( x , y ) e <sup>2jr ω r</sup>&gt; ^<sup>x?y }</sup> <sub>}</sub> (3 ) where A<sub>lj2</sub>(x,y) and x<sub>lj2</sub>(x,y) are the amplitude and the traveltime respectively. Assuming that the traveltimes are real values and do not change within the close vicinity of the interface, we simplify Eq. (1) as: ii ' (s, r,i ) ¾ 4</p><p id="p0061" num="0061"><img id="imgf000014_0002" he="15" wi="107" file="imgf000014_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/></p><p id="p0062" num="0062"> x sine (2JI [ T (x, s, r)— if]} ds^ (x ), (4) where co<sub>c</sub> = (ro<sub>m</sub>i<sub>n</sub> + ro<sub>max</sub>)/2, ο¾ = (ro<sub>max</sub> - ro<sub>m</sub>i<sub>n</sub>)/2 are referred as central frequency and bandwidth, respectively, </p><p id="p0063" num="0063">A(x,s,r) = A<sub>2</sub>(x,r) d<sub>n</sub>Ai(s,x) - Ai(s,x) 9<sub>n</sub>A<sub>2</sub>(x,r), </p><p id="p0064" num="0064"> Ti<sub>,2</sub>(x,s,r) = TI(S,X) + x<sub>2</sub>(x,r), and sinc(t) = sin(t)/t. </p><p id="p0065" num="0065">Although we assumed real traveltimes in this example, these techniques can be extended to complex-valued traveltimes. </p><p id="p0066" num="0066">[0053] Because ο¾≤ co<sub>c</sub>, the main lobe of sinc(2nc0<sub>h</sub>t) is always wider than that of cos(2nco<sub>c</sub>t). Thus, we approximate an integral in Eq. (4) by restricting the domain of integration to the main lobe of the cosine function. Because the first zero crossings of the 
<!-- EPO <DP n="15"/>-->
 cosine function are at π/2 and -π/2, the points x that lie within the main lobe of the cosine function should satisfy 
<img id="imgf000015_0001" he="15" wi="102" file="imgf000015_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0067" num="0067">[0054] Condition Eq. (5) defines the first Fresnel zone for wavelength l/(2co<sub>c</sub>) and, hence, the wave path around the ray that connect s to xo and xo to r. </p><p id="p0068" num="0068">[0055] For the sake of simplicity, we will assume ο¾ = co<sub>c</sub> = B/2 and use FZ(t), which we refer to as the first Fresnel zone, to denote the points that are on the interface and satisfy condition Eq (5): 
<img id="imgf000015_0002" he="16" wi="134" file="imgf000015_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0069" num="0069">[0056] We localize the Kirchhoff integral around Xo by means of the first Frensel zone. In this regard, let us define a localization of the Kirchhoff integral w(s, r, x<sub>0</sub>) by WT(S, r, τ(χο, s, r)): u(s, r, o) « 4 .4(x, s, r) T(x) siiic(2"/r ΒΔτίχ, XQ , S, r)) dx 
<img id="imgf000015_0003" he="17" wi="17" file="imgf000015_0003.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0070" num="0070">(7) where FZ<sub>Xo</sub> = FZ (T {X$ &lt; S, r)) with Δτίχ, XQ , S, r) = τ(χ, s, r) </p><p id="p0071" num="0071">[0057] We approximate τ(χο, s, r) with paraxial approximation and write: 
<!-- EPO <DP n="16"/>-->
 
<img id="imgf000016_0001" he="18" wi="92" file="imgf000016_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0072" num="0072">(8) </p><p id="p0073" num="0073">where p<sub>lj2</sub> (x„) = p<sub>lj2</sub> (x<sub>0</sub>) + ½ M<sub>lj2</sub> (x<sub>0</sub>) (x„ - x<sub>0</sub>). We refer pi(x) and p<sub>2</sub>(x) as the incoming and outgoing ray directions at x, respectively, and M<sub>lj2</sub>(x<sub>0</sub>) are the second time derivative operators. Substituting the approximations in Eq. (8) into Eq. (7), we replaced the dependency of the localized Kirchhoff integral u(s, r, xo) on the receiver location with the dependency on the outgoing direction p<sub>2</sub>(xo) and M<sub>2</sub> (x<sub>0</sub>). As in the example of Fig. 2D, the outgoing direction 222 is p<sub>2</sub>(x<sub>0</sub>). </p><p id="p0074" num="0074">Snell's Law and Frequency-Dependent Snell's Law </p><p id="p0075" num="0075">[0058] As shown in Fig. 2A, for Snell's law, for a ray 201 or a wave 200 with unlimited bandwidth, at a location xo (203) on an interface Γ (202) with a tangent plane <sup>x</sup>« (203-1) and normal n (204), there is an incoming ray direction pi(xo) (shown as 201 in Fig. 2A) and an unique outgoing ray direction p<sub>2</sub>(xo) (shown as 205 in Fig. 2A). For band-limited, frequency-dependent wave propagation, Snell's law can fail or be inaccurate, but we can establish a frequency-dependent relationship in the form of Snell's law as illustrated shown in Fig. 2B. </p><p id="p0076" num="0076">[0059] The frequency-dependent Snell's law is defined as the relationship between the incoming ray direction pi(xo) and the outgoing ray direction p<sub>2</sub>(xo) that maximizes (or in some cases, enhances) the amplitude of the localized Kirchhoff integral u( , r, x<sub>0</sub>): max \ u ( s . r . XQ } 1 = max u is. r. XQ ) . (9 ) </p><p id="p0077" num="0077"> Pi P2 where || p<sub>2</sub>||<sup>2</sup> = 1. We present an illustration of a frequency-dependent Snell's law relationship in Fig. 2C, which was discussed above, and can be used to find an outgoing ray direction of a 
<!-- EPO <DP n="17"/>-->
 propagating wave within a Fresnel volume based on many incoming ray directions associated with that propagating wave. </p><p id="p0078" num="0078">[0060] If we assume that the incoming and outgoing waves are plane waves, i.e. l<sub>j2</sub> (xo) = 0, for a flat interface separating two homogeneous media, A(x, s, r) and Γ(χ) become constants, say A and T. Then equation (7) is maximized when following condition is satisfied </p><p id="p0079" num="0079"><img id="imgf000017_0001" he="16" wi="105" file="imgf000017_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 for any point on the interface. With the constraint ||p<sub>2</sub>||<sup>2</sup> = 1 and Eq. 10 gives us Snell's law written in terms of the tangent plane of the surface, instead of the normal of the surface. </p><p id="p0080" num="0080">Effective Tangent Plane, Normal, Boundary Location </p><p id="p0081" num="0081">[0061] When one enhances a frequency ray tracing problem by incorporating use of a frequency-dependent Snell's law at an interface as discussed above, the frequency-dependent ray tracing problem is essentially reduced to a conventional ray tracing problem, as shown in the example of Fig. 11. </p><p id="p0082" num="0082">[0062] An effective tangent plane, VP <sup>x</sup>^ , is the plane in which ray-tracing using Snell's law through this plane is equivalent to ray-tracing using frequency-dependent Snell's law in the original model. As a consequence, the effective tangent plane is dependent on frequency, incoming wavefront, and interface. In other words, we would like to find a planar surface such that when we replace the incoming wave with a plane wave, the outgoing direction obtained by maximizing Eq. (7) is equivalent to the outgoing direction obtained by Snell's law applied to the incoming direction. In this regard, we characterize the effective tangent plane by effective normal n(x<sub>e</sub>) and effective surface location x<sub>e</sub>. </p><p id="p0083" num="0083">[0063] As illustrated in the example of Fig. 2E, let x<sub>e</sub> be a point 230 that lies on the effective tangent plane VP <sup>Xc</sup>- (232) and n(x<sub>e</sub>) be the normal 234 to the plane. Let pi(x<sub>e</sub>) be 
<!-- EPO <DP n="18"/>-->
 the incoming ray direction at point x<sub>e</sub> (230) and p<sub>2e</sub> be the corresponding outgoing ray direction 236 that is obtained from maximization of equation Eq. (7). Then we can compute n(x<sub>e</sub>) by applying an inverse of Snell's law to i and <sub>2</sub>. Then the effective surface location x<sub>e</sub> is defined by the point that maximizes the amplitude difference between u(s,r,x<sub>0</sub>) and ί , x<sub>0</sub>. s, r)])
<img id="imgf000018_0001" he="16" wi="128" file="imgf000018_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0084" num="0084">(1 1) where 
<img id="imgf000018_0002" he="13" wi="122" file="imgf000018_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0085" num="0085">(12) </p><p id="p0086" num="0086">[0064] Using the Kirchhoff integral as in Eq. 11 or 7, we can find the effective surface location x<sub>e</sub>, and other effective properties, including effective incoming direction, outgoing direction, and effective tangent plane. Figs. 3A-3C illustrate an example of these effective properties and the actual rays around the interface. In Fig. 3A, the effective incoming direction pi<sub>e</sub> (302) is shown, which in some embodiments is a weighted average of incoming directions (304-1 through 304-14, though not all are illustrated in Fig. 3A) associated with a propagating wave 306 within Fresnel volume 308; Fig. 3B illustrates the corresponding effective normal n<sub>e</sub> (312), which in some embodiments is a weighted average of normals within the Fresnel volume; and Fig. 3C illustrates an effective boundary location x<sub>e</sub> (320), which in some embodiments is a weighted average of the boundary within the Fresnel volume. Other properties, such as outgoing direction as illustrated in Fig. 2E, can be derived using conventional ray tracing. </p><p id="p0087" num="0087">Fresnel Zone Based Averaging Method 
<!-- EPO <DP n="19"/>-->
 [0065] Since FZ<sub>x0</sub> can depend on Δτ(χ, xo, s, r), which can depend on p<sub>lj2</sub> (x<sub>0</sub>) and M<sub>lj2</sub>(x<sub>0</sub>), maximization of Eq. (9) over p<sub>2</sub> can be a nonlinear process. Consequently, maximization of the amplitude of u<sub>e</sub> with respect to x<sub>e</sub> can also be nonlinear. In this regard, in the computation of FZ<sub>x0</sub>, one way to approximate p<sub>2</sub>(x0) and M<sub>2</sub>(x<sub>0</sub>) is by pi(xO) and Mi(x<sub>0</sub>). </p><p id="p0088" num="0088">[0066] In accordance with some embodiments, one may compute a suboptimal approximation to x<sub>e</sub> by first discretizing the Kirchhoff integral (or any other integrals used), then minimizing (or reducing) the difference between u(s, r, x<sub>0</sub>) and u<sub>e</sub> (s, r, x<sub>0</sub>) . </p><p id="p0089" num="0089">Au(s, r, XQ ) = (s. r, XQ ) — <sub>e</sub>(s, r, XQ ) ~ 0 </p><p id="p0090" num="0090"> (13) </p><p id="p0091" num="0091">[0067] Assuming that the transmission coefficient Γ(χ) is constant, the sum can be approximated by the dominant contribution of each point x„ (or one or more points x„) within the Fresnel zone by: </p><p id="p0092" num="0092">&gt; IV ^ ) |^i^7 (^Χ,<sub>'</sub>ΐι &gt;, XQ I<sup>*</sup>) i^7<sup>~</sup> <sub>^</sub> ^ . -^-O <sub>?</sub> ^<sup>*</sup> ] I ^*"<sup>1</sup> ^ x<sub>n</sub>€ Z<sub>X0</sub> </p><p id="p0093" num="0093">(14a) where w(x) = 4 <sub>^</sub> (x, s, r) (x) 8πιο<sup>;</sup>(2π £&gt; [Δτ(χ, XQ , S, r)]) </p><p id="p0094" num="0094"> (14b) and we compute x<sub>e</sub> by minimizing (14). for all <sup>" n</sup> - " <sup>(ί</sup> where w<sub>n</sub> = w x<sub>n</sub>) . Thus the weighted least square approximation to Eq. (14) can be given by weighted averaging of the travel times, which can effectively be approximated by weighted averaging of the surface within the Fresnel zone, i.e., 
<!-- EPO <DP n="20"/>-->
 
<img id="imgf000020_0001" he="23" wi="135" file="imgf000020_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0095" num="0095"> [0068] Since, in some embodiments, p<sub>2</sub> is related to pi(x<sub>e</sub>) and n(x<sub>e</sub>) via Snell's law by construction, we can rewrite the maximization problem in Eq. (9) with respect to pi(x<sub>e</sub>) and n(x<sub>e</sub>). Similar to an average surface location, one can discretize Eq. (7) and approximate the interface at every x„ with the tangent plane <sup>Xf</sup>- at x„. Then a suboptimal weighted least- square solution to the incoming direction and the normal that solves the Snell's law at each tangent plane is given by the weighted average of incoming ray directions and surface normals, i.e., </p><p id="p0096" num="0096"><img id="imgf000020_0002" he="21" wi="94" file="imgf000020_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 and </p><p id="p0097" num="0097"><img id="imgf000020_0003" he="23" wi="125" file="imgf000020_0003.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 where n(x„) denotes the normal to the interface at x„. Thus the effective incoming direction pi(x<sub>e</sub>), the effective normal n(x<sub>e</sub>) and effective surface location x<sub>e</sub> are obtained, as illustrated in Figs. 3A-3C. They can be interpreted as the weighted average of all rays within the Fresnel's zone that contributed to the outgoing ray. Ray tracing across the non-flat interface is completed. 
<!-- EPO <DP n="21"/>-->
 [0069] In short, conventional ray racing methods can fail or be less effective than desired at an interface when a boundary problem is encountered. The disclosed methods and computing systems can enable a ray to transit an interface associated with the boundary problem. Before and after the interface, or outside the boundary region, conventional ray tracing can be used. Therefore, by using the methods and computing systems disclosed herein, ray tracing can now be used for many complex structures that may have proven problematic in the past. </p><p id="p0098" num="0098">[0070] In some embodiments, a method for frequency-dependent ray tracing for processing and imaging collected data may be summarized as follows: </p><p id="p0099" num="0099">• use conventional ray tracing outside the boundary region, e.g. before and/or after crossing an interface; and </p><p id="p0100" num="0100"> • for a given frequency and/or frequency band width, and for a given incident direction, one or more effective properties are computed by means of a boundary integral. </p><p id="p0101" num="0101">[0071] Effective properties may include an effective boundary location, an effective normal, and one or more effective outgoing directions. They may also include one or more effective outgoing traveltimes, and an effective outgoing amplitude, which can be transmitted, reflected or converted. Effective properties can also be inhomogeneous or anisotropic. In some embodiments, a Kirchhoff-like integral can be used without scattering coefficient. </p><p id="p0102" num="0102">[0072] As discussed above, the computation of effective properties can be performed in at least two ways, which will be discussed in additional detail below with reference to Figs. 4 and 5. </p><p id="p0103" num="0103">[0073] Attention is now directed to Figure 4, which is a flow diagram illustrating a method 400 of processing and imaging collected data in accordance with some embodiments. Some operations in method 400 may be combined and/or the order of some operations may be changed. Further, some operations in method 400 may be combined with aspects of methods 500, 600, and 700, and/or the order of some operations in method 400 may be changed to account for incorporation of aspects of methods 500, 600, and/or 700. 
<!-- EPO <DP n="22"/>-->
 [0074] As described in Fig. 4 which illustrates method 400, a boundary integral is used as a cost function for computing an effective outgoing direction. And in some embodiments, therefore, effective outgoing traveltimes and amplitudes can be established as well. </p><p id="p0104" num="0104">[0075] In method 400, for a given point of interest, an incoming ray direction, a carrier frequency and a bandwidth, the method includes computing (402) a Fresnel volume for a trial outgoing direction within the vicinity of a point of interest; the method also includes computing (404) the intersection of the Fresnel volume with an interface within the vicinity of a point of interest; the method includes computing (406) an approximation to a Green's function within the intersection of the Fresnel volume with the interface within the vicinity of the point of interest; the method includes computing (408) a Kirchhoff-like integral based cost function within the intersection of the Fresnel volume with the interface within the vicinity of point of interest using the approximation of the Green's function; the method includes varying (410) the trial outgoing direction until the cost function is maximized (or in some embodiments, increased above a pre-defined threshold). The trial outgoing direction that maximizes the cost function (or increases the cost function above the pre-defined threshold) is the effective outgoing direction. </p><p id="p0105" num="0105">[0076] In some embodiments, additional quantities/relationships can be obtained, e.g., computing an effective Snell's law by inverting effective outgoing direction(s); and computing effective reflection/transmission coefficients and a dynamic propagator matrix based on the computed effective Snell's law. </p><p id="p0106" num="0106">[0077] Attention is now directed to Figure 5, which is a flow diagram illustrating a method 500 of processing and imaging collected data in accordance with some embodiments. Some operations in method 500 may be combined and/or the order of some operations may be changed. Further, some operations in method 500 may be combined with aspects of methods 400, 600, and 700 and/or the order of some operations in method 500 may be changed to account for incorporation of aspects of methods 400, 600 and/or 700. </p><p id="p0107" num="0107">[0078] As described in Fig. 5, which illustrates method 500, a boundary integral, including without limitation, a local averaging property, can be used to compute effective 
<!-- EPO <DP n="23"/>-->
 outgoing directions. And in some embodiments, therefore, effective outgoing traveltimes and amplitudes can be established as well. </p><p id="p0108" num="0108">[0079] In method 500, for a given point of interest, an incoming ray direction, a carrier frequency, and a bandwidth, the method includes computing (502) a Fresnel volume within the vicinity of a point of interest that is independent of outgoing direction; the method includes computing (504) the intersection of the Fresnel volume with an interface within the vicinity of the point of interest; the method includes computing (506) an approximation to a Green's function within the intersection of the Fresnel volume with the interface within the vicinity of the point of interest; the method includes using (508) the approximation of the Green's function to compute at one or more points (e.g., x„) within the intersection: an incoming direction, a surface normal and a contribution to the Kirchhoff-like integral based cost function; the method includes computing for the point of interest (510) : an effective incoming direction as a weighted sum of incoming direction of these points (e.g., x„), an effective normal as a weighted sum of these points (e.g., x„) and an effective boundary location as a weighted sum of these points (e.g., x„); the method includes applying (512) Snell's law on the effective incoming direction and the effective normal to compute an effective outgoing direction; the method includes using (514) the effective boundary location to compute an effective traveltime correction. </p><p id="p0109" num="0109">[0080] The effective traveltime correction is to correct the traveltime due to the differences between the effective boundary location and the point of interest on the interface. In addition, other quantities, such as effective reflection/transmission coefficients and dynamic propagator matrix can be computed. </p><p id="p0110" num="0110">[0081] Attention is now directed to Figure 6, which is a flow diagram illustrating a method 600 of processing and imaging collected data in accordance with some embodiments. Some operations in method 600 may be combined and/or the order of some operations may be changed. Further, some operations in method 600 may be combined with aspects of method 400, 500 and/or 700, and/or the order of some operations in method 600 may be changed to account for incorporation of aspects of method 400, 500 and/or 700. 
<!-- EPO <DP n="24"/>-->
 [0082] The method 600 is performed at a computing device (e.g., computing system 100, Figure 1), and involves performing (602) ray tracing through a sub-surface region that includes an interface. </p><p id="p0111" num="0111">[0083] In some embodiments, when the ray tracing is before the interface, method 600 includes performing conventional ray tracing through the sub-surface region (604). </p><p id="p0112" num="0112">[0084] When the ray tracing is at the interface, method 600 includes computing a frequency-dependent outgoing ray direction from a point on the interface, wherein the computation is based at least in part an incoming ray direction (or in some embodiments, one or more incoming ray directions), one or more surface normals, and a computed boundary integral (606). In some embodiments, the computed boundary integral is based at least in part on the incoming ray direction and a frequency parameter. </p><p id="p0113" num="0113">[0085] In some embodiments, method 600 includes using the computed boundary integral as a cost function to find the frequency-dependent outgoing ray direction (608). </p><p id="p0114" num="0114">[0086] In some embodiments, the computation of the frequency-dependent outgoing ray direction is also based on a travel time from an edge of the sub-surface region to the point of interest (610). </p><p id="p0115" num="0115">[0087] In some embodiments, the incoming ray direction is a weighted average of a plurality of incoming directions corresponding to a propagating wave (612). </p><p id="p0116" num="0116">[0088] In some embodiments, the computation of the frequency-dependent outgoing ray direction includes localization of a Kirchoff integral corresponding to a region of a Fresnel volume corresponding to the vicinity of the point of interest (614). </p><p id="p0117" num="0117">[0089] In some embodiments, method 600 includes computing an outgoing traveltime from the point on the interface (616). </p><p id="p0118" num="0118">[0090] In some embodiments, method 600 includes computing an outgoing amplitude from the point on the interface (618). 
<!-- EPO <DP n="25"/>-->
 [0091] In some embodiments, method 600 includes using the boundary integral to find one or more local averaging properties substantially within the vicinity of the point on the interface (620). </p><p id="p0119" num="0119">[0092] In some embodiments, when the ray tracing is after the interface, method 600 includes performing conventional ray tracing through the sub-surface region (622). </p><p id="p0120" num="0120">[0093] In some embodiments, method 600 includes forming an image of the sub-surface region based at least in part on the ray-tracing (624). </p><p id="p0121" num="0121">[0094] Attention is now directed to Figure 7, which is a flow diagram illustrating a method 700 of processing and imaging collected data in accordance with some embodiments. Some operations in method 700 may be combined and/or the order of some operations may be changed. Further, some operations in method 700 may be combined with aspects of method 400, 500 and/or 600, and/or the order of some operations in method 700 may be changed to account for incorporation of aspects of method 400, 500 and/or 600. </p><p id="p0122" num="0122">[0095] The method 700 is performed at a computing device (e.g., computing system 100, Figure 1), and includes computing (702) a frequency-dependent outgoing ray direction departing from a point at (or substantially at) an interface disposed in a sub-surface region, wherein the computation is based at least in part on: an incoming ray direction, one or more surface normals, and a computed boundary integral that is based at least in part on the incoming ray direction and a frequency parameter. </p><p id="p0123" num="0123">[0096] In some embodiments, the sub-surface region is a subterranean region with one or more geologic regions of interest (704). </p><p id="p0124" num="0124">[0100] In some embodiments, method 700 includes forming an image of the sub-surface region based at least in part on the frequency-dependent outgoing ray direction (706). </p><p id="p0125" num="0125">[0101] As those with skill in the art will understand, one or more of the steps of methods discussed above may be combined and/or the order of some operations may be changed. Further, some operations in methods may be combined with aspects of other example embodiments disclosed herein, and/or the order of some operations may be changed. It is 
<!-- EPO <DP n="26"/>-->
 important to recognize that geologic interpretations and imaging may be refined in an iterative fashion; this concept is applicable to the methods discussed herein. Finally, these methods may be performed by any suitable techniques, including on an automated or semi-automated basis on computing system 100 in Fig. 1. </p><p id="p0126" num="0126">[0102] Further, the steps in the processing methods described above may be implemented by running one or more functional modules in information processing apparatus such as general purpose processors or application specific chips, such as ASICs, FPGAs, PLDs or other appropriate devices. These modules, combinations of these modules, and/or their combination with general hardware are all included within the scope of protection of the invention. </p><p id="p0127" num="0127">[0103] The foregoing description, for purpose of explanation, has been described with reference to specific embodiments. However, the illustrative discussions above are not intended to be exhaustive or to limit the invention to the precise forms disclosed. Many modifications and variations are possible in view of the above teachings. The embodiments were chosen and described in order to best explain the principles of the invention and its practical applications, to thereby enable others skilled in the art to best utilize the invention and various embodiments with various modifications as are suited to the particular use contemplated. 
</p></description><claims mxw-id="PCLM45314384" ref-ucid="WO-2012135580-A2" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="27"/>-->CLAIMS We claim: </claim-statement><claim id="clm-0001" num="1"><claim-text>1. A method for ray tracing through a sub-surface region that includes an interface, comprising: </claim-text><claim-text> when the ray tracing is before the interface, performing conventional ray tracing through the sub-surface region; and </claim-text><claim-text> when the ray tracing is at the interface, computing a frequency-dependent outgoing ray direction from a point on the interface, wherein the computation is based at least in part on: </claim-text><claim-text> an incoming ray direction, </claim-text><claim-text> one or more surface normals, and </claim-text><claim-text> a computed boundary integral that is based at least in part on the incoming ray direction and a frequency parameter. </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. The method of claim 1, further comprising: </claim-text><claim-text> computing an outgoing traveltime from the point on the interface. </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. The method of claim 1, further comprising: </claim-text><claim-text> computing an outgoing amplitude from the point on the interface. </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. The method of claim 1, further comprising using the computed boundary integral as a cost function to find the frequency-dependent outgoing ray direction. </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. The method of claim 4, further comprising: </claim-text><claim-text> computing a Fresnel volume for a trial outgoing direction within the vicinity of the point on the interface; </claim-text><claim-text> computing an intersection of the Fresnel volume with the interface within the vicinity of the point on the interface; </claim-text><claim-text> computing an approximation of a Green's function within the intersection of the Fresnel volume with the interface within the vicinity of the point on the interface; </claim-text><claim-text> computing a Kirchhoff-like integral based cost function within the intersection of the Fresnel volume with the interface within the vicinity of the point on the interface using the approximated Green's function; and <!-- EPO <DP n="28"/>--> varying the trial outgoing direction until the cost function is maximized. </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. The method of claim 1, further comprising using the boundary integral to find one or more local averaging properties substantially within the vicinity of the point on the interface. </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. The method of claim 6, further comprising: </claim-text><claim-text> computing a Fresnel volume for a fixed outgoing direction within the vicinity of the point on the interface; computing the intersection of the Fresnel volume with the interface within the vicinity of the point on the interface; </claim-text><claim-text> computing an approximation to a Green's function for a plurality of points within the intersection of the Fresnel volume with the interface within the vicinity of the point on the interface; </claim-text><claim-text> at respective points in the plurality of points, using the approximated Green's function to compute respective incoming directions, respective surface normals and their respective contributions to a cost function; </claim-text><claim-text> for the point on the interface, computing: </claim-text><claim-text> an effective incoming direction as a weighted sum of the respective incoming directions of the plurality of points, and </claim-text><claim-text> an effective normal as a weighted sum of the respective normals of the plurality of points; and </claim-text><claim-text> applying Snell's law to the effective incoming direction and effective normal to compute an effective outgoing direction as the outgoing direction. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. The method of claim 1 , further comprising performing conventional ray tracing through the sub-surface region when the ray tracing is after the interface. </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. The method of claim 1, further comprising forming an image of the sub-surface region based at least in part on the ray-tracing. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. The method of claim 1, wherein the computation of the frequency-dependent outgoing ray direction is also based on a travel time from an edge of the sub-surface region to the point of interest. <!-- EPO <DP n="29"/>--> </claim-text></claim><claim id="clm-0011" num="11"><claim-text>11. The method of claim 1 , wherein the incoming ray direction is a weighted average of a plurality of incoming directions corresponding to a propagating wave. </claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. The method of claim 1, wherein the computation of the frequency-dependent outgoing ray direction includes localization of a Kirchoff integral corresponding to a region of a Fresnel volume corresponding to the vicinity of the point of interest. </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. A computing system for ray tracing through a sub-surface region that includes an interface, comprising: </claim-text><claim-text> at least one processor, </claim-text><claim-text> at least one memory, and </claim-text><claim-text> one or more programs stored in the at least one memory, </claim-text><claim-text> wherein the programs comprise instructions, which when executed by the at least one processor, are configured for: </claim-text><claim-text> computing a frequency-dependent outgoing ray direction from a point on the interface when the ray tracing is at the interface, wherein the computation is based at least in part on: </claim-text><claim-text> an incoming ray direction, </claim-text><claim-text> one or more surface normals, and </claim-text><claim-text> a computed boundary integral that is based at least in part on the incoming ray direction and a frequency parameter. </claim-text></claim><claim id="clm-0014" num="14"><claim-text>14. The computing system of claim 13, further comprising forming an image of the subsurface region based at least in part on the ray-tracing. </claim-text></claim><claim id="clm-0015" num="15"><claim-text>15. The computing system of claim 13, wherein the computation of the frequency- dependent outgoing ray direction is also based on a travel time from an edge of the subsurface region to the point of interest. </claim-text></claim><claim id="clm-0016" num="16"><claim-text>16. The computing system of claim 13, wherein the incoming ray direction is a weighted average of a plurality of incoming directions corresponding to a propagating wave. <!-- EPO <DP n="30"/>--> </claim-text></claim><claim id="clm-0017" num="17"><claim-text>17. The computing system of claim 13, wherein the computation of the frequency- dependent outgoing ray direction includes localization of a Kirchoff integral corresponding to a region of a Fresnel volume corresponding to the vicinity of the point of interest. </claim-text></claim><claim id="clm-0018" num="18"><claim-text>18. A method, comprising : </claim-text><claim-text> computing a frequency-dependent outgoing ray direction departing from a point at an interface disposed in a sub-surface region, </claim-text><claim-text> wherein the computation is based at least in part on: </claim-text><claim-text> an incoming ray direction, </claim-text><claim-text> one or more surface normals, and </claim-text><claim-text> a computed boundary integral that is based at least in part on the incoming ray direction and a frequency parameter. </claim-text></claim><claim id="clm-0019" num="19"><claim-text>19. The method of claim 18, further comprising forming an image of the sub-surface region based at least in part on the frequency-dependent outgoing ray direction. </claim-text></claim><claim id="clm-0020" num="20"><claim-text>20. The method of claim 18, wherein the sub-surface region is a subterranean region with one or more geologic regions of interest. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
