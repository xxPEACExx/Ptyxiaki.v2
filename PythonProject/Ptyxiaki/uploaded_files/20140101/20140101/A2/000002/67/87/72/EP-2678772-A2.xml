<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2678772-A2" country="EP" doc-number="2678772" kind="A2" date="20140101" family-id="45876700" file-reference-id="318301" date-produced="20180826" status="corrected" lang="DE"><bibliographic-data><publication-reference fvid="146551297" ucid="EP-2678772-A2"><document-id><country>EP</country><doc-number>2678772</doc-number><kind>A2</kind><date>20140101</date><lang>DE</lang></document-id></publication-reference><application-reference ucid="EP-12710176-A" is-representative="NO"><document-id mxw-id="PAPP154825220" load-source="docdb" format="epo"><country>EP</country><doc-number>12710176</doc-number><kind>A</kind><date>20120224</date><lang>DE</lang></document-id><document-id mxw-id="PAPP220438364" load-source="docdb" format="original"><country>EP</country><doc-number>12710176.4</doc-number><date>20120224</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140452681" ucid="DE-102011012328-A" load-source="docdb"><document-id format="epo"><country>DE</country><doc-number>102011012328</doc-number><kind>A</kind><date>20110224</date></document-id></priority-claim><priority-claim mxw-id="PPC140445741" ucid="EP-2012053165-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>2012053165</doc-number><kind>W</kind><date>20120224</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988135670" load-source="docdb">G06F   7/00        20060101AFI20120914BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1821554910" load-source="docdb" scheme="CPC">G06F  21/72        20130101 LI20170428BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988124096" load-source="docdb" scheme="CPC">H04L   9/008       20130101 LI20131121BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988134448" load-source="docdb" scheme="CPC">G06F   7/00        20130101 FI20131121BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132186375" lang="DE" load-source="patent-office">VERSCHLÜSSELTES RECHNEN</invention-title><invention-title mxw-id="PT132186376" lang="EN" load-source="patent-office">ENCRYPTED COMPUTING</invention-title><invention-title mxw-id="PT132186377" lang="FR" load-source="patent-office">CALCUL CRYPTÉ</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR918133705" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>UNIV HANNOVER</last-name><address><country>DE</country></address></addressbook></applicant><applicant mxw-id="PPAR918171197" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>GOTTFRIED WILHELM LEIBNIZ UNIVERSITAET HANNOVER</last-name></addressbook></applicant><applicant mxw-id="PPAR918987496" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Gottfried Wilhelm Leibniz Universität Hannover</last-name><iid>101026309</iid><address><street>Welfengarten 1</street><city>30167 Hannover</city><country>DE</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918142898" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>BRENNER MICHAEL</last-name><address><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918137296" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>BRENNER, MICHAEL</last-name></addressbook></inventor><inventor mxw-id="PPAR918989389" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>BRENNER, MICHAEL</last-name><address><street>Ringendahl 3</street><city>31535 Neustadt a. Rbge.</city><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918170439" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>SMITH MATTHEW</last-name><address><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918150799" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>SMITH, MATTHEW</last-name></addressbook></inventor><inventor mxw-id="PPAR918978956" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>SMITH, MATTHEW</last-name><address><street>Meffertstraße 20</street><city>30659 Hannover</city><country>DE</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918992734" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Aisch, Sebastian</last-name><iid>101212411</iid><address><street>Gramm, Lins &amp; Partner Patent- und Rechtsanwaltssozietät Freundallee 13 a</street><city>30173 Hannover</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="EP-2012053165-W"><document-id><country>EP</country><doc-number>2012053165</doc-number><kind>W</kind><date>20120224</date><lang>DE</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012113908-A2"><document-id><country>WO</country><doc-number>2012113908</doc-number><kind>A2</kind><date>20120830</date><lang>DE</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS548914324" load-source="docdb">AL</country><country mxw-id="DS548934883" load-source="docdb">AT</country><country mxw-id="DS548914325" load-source="docdb">BE</country><country mxw-id="DS548865802" load-source="docdb">BG</country><country mxw-id="DS548931309" load-source="docdb">CH</country><country mxw-id="DS548816186" load-source="docdb">CY</country><country mxw-id="DS548934884" load-source="docdb">CZ</country><country mxw-id="DS548929706" load-source="docdb">DE</country><country mxw-id="DS548914330" load-source="docdb">DK</country><country mxw-id="DS548816187" load-source="docdb">EE</country><country mxw-id="DS548837596" load-source="docdb">ES</country><country mxw-id="DS548865803" load-source="docdb">FI</country><country mxw-id="DS548865804" load-source="docdb">FR</country><country mxw-id="DS548929707" load-source="docdb">GB</country><country mxw-id="DS548914331" load-source="docdb">GR</country><country mxw-id="DS548914332" load-source="docdb">HR</country><country mxw-id="DS548816188" load-source="docdb">HU</country><country mxw-id="DS548931426" load-source="docdb">IE</country><country mxw-id="DS548914333" load-source="docdb">IS</country><country mxw-id="DS548865805" load-source="docdb">IT</country><country mxw-id="DS548816189" load-source="docdb">LI</country><country mxw-id="DS548929708" load-source="docdb">LT</country><country mxw-id="DS548934885" load-source="docdb">LU</country><country mxw-id="DS548929709" load-source="docdb">LV</country><country mxw-id="DS548929710" load-source="docdb">MC</country><country mxw-id="DS548927251" load-source="docdb">MK</country><country mxw-id="DS548927252" load-source="docdb">MT</country><country mxw-id="DS548934886" load-source="docdb">NL</country><country mxw-id="DS548837597" load-source="docdb">NO</country><country mxw-id="DS548934887" load-source="docdb">PL</country><country mxw-id="DS548837598" load-source="docdb">PT</country><country mxw-id="DS548934888" load-source="docdb">RO</country><country mxw-id="DS548837599" load-source="docdb">RS</country><country mxw-id="DS548934889" load-source="docdb">SE</country><country mxw-id="DS548929711" load-source="docdb">SI</country><country mxw-id="DS548931427" load-source="docdb">SK</country><country mxw-id="DS548931428" load-source="docdb">SM</country><country mxw-id="DS548927253" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA99625390" ref-ucid="WO-2012113908-A2" lang="DE" load-source="patent-office"><p num="0000">Die vorliegende Erfindung betrifft ein Verfahren zum Ausführen eines bitweise homomorph verschlüsselten Maschinencodes durch eine auf einer Datenverarbeitungsanlage angeordneten Ausführungseinheit, wobei der verschlüsselte Maschinencode Instruktionen enthält, die von der Ausführungseinheit ausführbar sind, mit Bereitstellung von arithmetischen Funktionen, bei denen die Operanden und das daraus resultierende Ergebnis einer booleschen Logikfunktion entspricht, und Ausführung der in dem verschlüsselten Maschinencode enthaltenen Instruktionen durch die Ausführungseinheit unter Anwendung boolescher Logikoperationen, deren Berechnung durch die der jeweiligen booleschen Logikoperation entsprechenden arithmetischen Funktion unter Zugrundelegung der verschlüsselten Bits im Verschlüsselungsraum erfolgt.</p></abstract><abstract mxw-id="PA99823909" ref-ucid="WO-2012113908-A2" lang="DE" source="national office" load-source="docdb"><p>Die vorliegende Erfindung betrifft ein Verfahren zum Ausführen eines bitweise homomorph verschlüsselten Maschinencodes durch eine auf einer Datenverarbeitungsanlage angeordneten Ausführungseinheit, wobei der verschlüsselte Maschinencode Instruktionen enthält, die von der Ausführungseinheit ausführbar sind, mit Bereitstellung von arithmetischen Funktionen, bei denen die Operanden und das daraus resultierende Ergebnis einer booleschen Logikfunktion entspricht, und Ausführung der in dem verschlüsselten Maschinencode enthaltenen Instruktionen durch die Ausführungseinheit unter Anwendung boolescher Logikoperationen, deren Berechnung durch die der jeweiligen booleschen Logikoperation entsprechenden arithmetischen Funktion unter Zugrundelegung der verschlüsselten Bits im Verschlüsselungsraum erfolgt.</p></abstract><abstract mxw-id="PA99625391" ref-ucid="WO-2012113908-A2" lang="EN" load-source="patent-office"><p num="0000">The invention relates to a method for executing a bit-by-bit homomorphically encrypted machine code by means of an execution unit arranged on a data processing system, wherein the encrypted machine code contains instructions which can be executed by the execution unit, comprising the provision of arithmetic functions in which the operands and the ensuing result correspond to a Boolean logic function, and the execution of the instructions contained in the encrypted machine code by the execution unit using Boolean logic operations, the computation of which is carried out by the arithmetic function corresponding to the respective Boolean logic operation on the basis of the encrypted bits in the encryption space.</p></abstract><abstract mxw-id="PA99823910" ref-ucid="WO-2012113908-A2" lang="EN" source="national office" load-source="docdb"><p>The invention relates to a method for executing a bit-by-bit homomorphically encrypted machine code by means of an execution unit arranged on a data processing system, wherein the encrypted machine code contains instructions which can be executed by the execution unit, comprising the provision of arithmetic functions in which the operands and the ensuing result correspond to a Boolean logic function, and the execution of the instructions contained in the encrypted machine code by the execution unit using Boolean logic operations, the computation of which is carried out by the arithmetic function corresponding to the respective Boolean logic operation on the basis of the encrypted bits in the encryption space.</p></abstract><abstract mxw-id="PA99625392" ref-ucid="WO-2012113908-A2" lang="FR" load-source="patent-office"><p num="0000">L'invention concerne un procédé pour exécuter un code machine crypté de manière homomorphe binairement par une unité d'exécution montée dans l'installation de traitement de données, ledit code machine crypté contenant des instructions qui peuvent être exécutées par l'unité d'exécution, par mise à disposition de fonctions arithmétiques. Ledit procédé comprend les étapes suivantes: disposer de fonctions arithmétiques dans lesquelles les opérandes et le résultat qui en découle correspondent à une fonction de logique booléenne et exécuter les instructions contenues dans le code machine crypté, au moyen d'une unité d'exécution à l'aide d'opérations de logique booléenne dont le calcul est effectué dans l'espace de cryptage par la fonction arithmétique correspondant à l'opération de logique booléenne respective, sur la base des bits cryptés.</p></abstract><abstract mxw-id="PA99823911" ref-ucid="WO-2012113908-A2" lang="FR" source="national office" load-source="docdb"><p>L'invention concerne un procédé pour exécuter un code machine crypté de manière homomorphe binairement par une unité d'exécution montée dans l'installation de traitement de données, ledit code machine crypté contenant des instructions qui peuvent être exécutées par l'unité d'exécution, par mise à disposition de fonctions arithmétiques. Ledit procédé comprend les étapes suivantes: disposer de fonctions arithmétiques dans lesquelles les opérandes et le résultat qui en découle correspondent à une fonction de logique booléenne et exécuter les instructions contenues dans le code machine crypté, au moyen d'une unité d'exécution à l'aide d'opérations de logique booléenne dont le calcul est effectué dans l'espace de cryptage par la fonction arithmétique correspondant à l'opération de logique booléenne respective, sur la base des bits cryptés.</p></abstract><description mxw-id="PDES50931227" ref-ucid="WO-2012113908-A2" lang="DE" load-source="patent-office"><!-- EPO <DP n="3"/>--><p id="p0001" num="0001"> Verschlüsseltes Rechnen </p><p id="p0002" num="0002">Die Erfindung betrifft ein Verfahren zum Ausführen eines verschlüsselten Maschinencodes. Die Erfindung betrifft auch ein Computerprogramm und eine Vorrichtung hierzu sowie ein Verfahren und ein Computerprogramm zum Verschlüsseln von Maschinencodes. </p><p id="p0003" num="0003">Einleitung </p><p id="p0004" num="0004">Mit der fortschreitenden Vernetzung von technischen Geräten rücken mit zunehmendem Maße auch die Sicherheitsaspekte mehr und mehr in den Vordergrund. Dabei ist ein wesentlicher Punkt der Wunsch des Benutzers, dass seine Daten auf dem jeweiligen technischen Gerät, wie beispielsweise ein Computer, Laptop oder Smartphone zu jeder Zeit sicher sind, so dass beispielsweise Fremde bzw. Nichtberechtigte nicht ohne weiteres Zugriff auf die persönlichen Daten des Benutzers haben. </p><p id="p0005" num="0005">Darüber hinaus erfordert die immens gestiegene Verbreitung mobiler, digitaler Endgeräte, dass Programm und Daten gerade auf Systemen ohne physikalischen Zugriffschutz sicher sind und auch bei Abhandenkommen oder Diebstahl des Gerätes weiterhin geschützt bleiben. Es ist zu beobachten, dass aufgrund der gestiegenen Leistungsfähigkeit der mobilen Geräte anspruchsvolle Anwendungen zum Einsatz kommen, die ihrerseits wiederum Zugang zu sicherheitsrelevanten Datenbeständen bieten (bspw. Bankgeschäfte, Social Networks, etc). Auch in diesen Fällen muss sichergestellt werden, dass Unberechtigte nicht 
<!-- EPO <DP n="4"/>-->
 ohne weiteres Zugriff auf die sicherheitsrelevanten Datenbestände haben. </p><p id="p0006" num="0006">Neben der Frage der Datensicherheit der persönlichen Daten auf den eigenen Geräten rückt ein weiteres Problem aufgrund der zunehmenden Vernetzung in den Fokus, dass gerade im Bereich des sogenannten Cloud-Computing auftritt. Zum einen stellen gro ße Grid- bzw. Cloud-Provider über ein Netzwerk bzw. das Internet Speicherplatz zur Verfügung, auf denen die Benutzer Daten hochladen können. Unter anderem werden verstärkt Rechenkapazitäten von Dritten angeboten, mit denen Rechen- bzw. Speicherressourcen gegen Entgelt zur Verfügung gestellt werden. So kann beispielsweise die Rechenleistung eines großen Rechenzentrums für eine begrenzte Zeit gegen Entgelt benutzt werden, um darauf beispielsweise komplexe Simulationen oder dergleichen ablaufen zu lassen. </p><p id="p0007" num="0007">Das Auslagern solcher Rechen- bzw. Speicherdienstleistungen an Dritte hat für die Unternehmen dabei den Vorteil, dass sie selber keine gro ßen Rechenzentren unterhalten müssen, die erhebliche Kosten an Wartung und Instandsetzungen verursachen. Vielmehr kann bei Bedarf von entsprechenden </p><p id="p0008" num="0008">Dienstleistern gegen eine Gebühr die benötigte Ressource gemietet werden. Es können dann entsprechende Programme und die dafür erforderlichen Daten auf die Datenverarbeitungsanlagen des Dienstanbieters hochgeladen und dann ausgeführt werden. </p><p id="p0009" num="0009">Der erhebliche Nachteil besteht jedoch darin, dass die Programme und die Daten in der Regel den Herrschaftsbereich des Unternehmens oder des Benutzers verlassen und in die Verfügungsgewalt des Dienstanbieters meist unbeschränkt geraten. Je höher dabei der Verteilungsgrad der Infrastruktur ist, desto schwieriger ist es für den Auftraggeber nachweisbar festzustellen, in wessen Einflussbereich die Algorithmen und Daten verarbeitet werden. So ist es durchaus für viele Unternehmen wichtig zu wissen, in welchem Einflussbereich welcher Gesetzgebung die Verarbeitung und Ausführung der Algorithmen und Da- 
<!-- EPO <DP n="5"/>-->
 ten nun tatsächlich stattfindet. </p><p id="p0010" num="0010">Zwar können mit herkömmlichen Mitteln die Wegstrecken der Programme und Daten verschlüsselt werden. Zum Zeitpunkt der Verarbeitung jedoch liegen die erforderlichen Daten- und Programmbestandteile unverschlüsselt und praktisch durch den Ressourcenbetreiber einsehbar vor, so dass eine sichere Verarbeitung der Programme und Daten zum Ausführungszeitpunkt nicht sichergestellt werden kann. Gerade für sicherheitssensible Daten, wie bspw. Bankdaten, ist es jedoch für alle Beteiligten wichtig sicherzustellen, dass sowohl die Programme als auch die Daten weder von dem Ressourcenbetreiber noch von eventuellen staatlichen Institutionen der betreffenden Länder einsehbar sind. </p><p id="p0011" num="0011">Stand der Technik </p><p id="p0012" num="0012">Aus der US 201 0/01 22095 A1 ist eine Hardware-Einheit bekannt, die sowohl einen CPU-Kern als auch eine Encryption Management Unit (EMU) auf ein und demselben Halbleiterchip vereint. Die Encryption Management Unit erhält verschlüsselte Instruktionen und Daten aus einem Speicher und kann diese mit Hilfe entsprechender geheimer Schlüssel entschlüsseln, wobei die Abarbeitung der Instruktionen bzw. die Bearbeitung der Daten letztendlich im Klartext, d. h. unverschlüsselt, in der CPU ausgeführt werden. </p><p id="p0013" num="0013">Die US 7,296, 1 63 B2 offenbart beispielsweise ein Verfahren zum Ausführen eines verschlüsselten Programms, bei dem das Programm durch eine Matrix und einen entsprechenden Datenstring durch einen Vector verschlüsselt wird. Die Ausführung des Computerprogramms wird dann durch eine Matrixmultiplikation des verschlüsselten Computerprogramms mit dem Datenstring realisiert. </p><p id="p0014" num="0014">Die US 201 0/0037066 A1 offenbart schlie ßlich ein Informationsbearbeitungsge- rät, dessen Speicher ein verschlüsseltes Programm vorliegt. Erhält eine Entschlüsselungseinheit, die mit dem Speicher verbunden ist, ein entsprechendes 
<!-- EPO <DP n="6"/>-->
 Signal, so entschlüsselt sie das verschlüsselte Programm und schreibt es in einem entsprechenden Speicherbereich ein, so dass es von einer CPU- oder Zentral-Einheit ausgeführt werden kann. </p><p id="p0015" num="0015">Aufgabe </p><p id="p0016" num="0016">Es besteht somit die Aufgabe, ein verbessertes Verfahren anzugeben, bei dem die erforderlichen Daten und Programmbestandteile auf der Zielmaschine jederzeit verschlüsselt und somit uneinsehbar vorgehalten werden. </p><p id="p0017" num="0017">Lösung </p><p id="p0018" num="0018">Gelöst wird die Aufgabe erfindungsgemäß durch das eingangs genannte Verfahren zum Ausführen eines bitweise homomorph verschlüsselten Maschinencodes durch eine auf einer Datenverarbeitungsanlage angeordnete Ausführungseinheit, wobei der verschlüsselte Maschinencode Instruktionen enthält, die von der Ausführungseinheit ausführbar sind, mit Bereitstellung von arithmetischen Funktionen, bei denen die Operanden und das daraus resultierende Ergebnis einer booleschen Logikfunktion entspricht, und Ausführen der in dem verschlüsselten Maschinencode enthaltenen Instruktionen durch die Ausführungseinheit unter Anwendung boolescher Logikoperationen, deren Berechnung durch die der jeweiligen booleschen Logikoperation entsprechenden a- rithmetischen Funktion unter Zugrundelegung der verschlüsselten Bits im Verschlüsselungsraum erfolgt. </p><p id="p0019" num="0019">Dadurch wird es möglich, dass ein verschlüsseltes Computerprogramm bzw. dessen Maschinencode, der in der Regel die auszuführenden Befehle bzw. Instruktionen und Daten enthält, auf der Zielmaschine nicht mehr entschlüsselt werden muss, um das Programm ablaufen zu lassen. Vielmehr erfolgt die Ausführung des Computerprogramms in der verschlüsselten Form, wobei alle für die Ausführung notwendigen booleschen Logikoperationen, wie beispielsweise 
<!-- EPO <DP n="7"/>-->
 AND, XOR, OR oder NOT, innerhalb des Verschlüsselungsraumes ausgeführt werden, wobei das Ergebnis dieser Operationen ebenfalls im Verschlüsselungsraum verbleibt und somit für die Zielmaschine nicht sichtbar ist. Die Ausführung der booleschen Logikoperationen im Verschlüsselungsraum erfolgt dabei durch arithmetische Funktionen, die bezüglich einer booleschen Logikoperation äquivalent sind. </p><p id="p0020" num="0020">Die CPU oder auch Zentraleinheit einer Datenverarbeitungsanlage ist in der Regel dazu eingerichtet, entsprechende Instruktionen oder Maschinenbefehle auszuführen, wie beispielsweise das Laden von Daten in eines der Register oder das Addieren zweier binärer Zahlen mit Hilfe einer arithmetic-logical-unit. Alle Berechnungen einer CPU- bzw. Zentraleinheit werden dabei auf binärer Ebene durchgeführt. Die kleinste binäre Informationseinheit,„bit" genannt, kann dabei die Werte logisch„0" und logisch„1 " haben, was in der mathematischen Logik wahr und falsch und umgangssprachlich auch oft mit Strom an oder Strom aus bezeichnet wird. </p><p id="p0021" num="0021">Alle Operationen, die eine CPU- bzw. Zentraleinheit nun ausführt, werden aufgrund der binären Grundlage der Daten mit Hilfe von booleschen Logikoperationen und einer entsprechenden Schaltkreisimplementierung realisiert. In der Regel sind dies die booleschen Logikoperationen„XOR",„AND",„OR" und „NOT", wobei andere boolesche Logikoperationen, wie beispielsweise„NAND" durch die vorhergehenden Logikoperationen abgebildet werden können. Dabei ist es allgemein bekannt, dass beispielsweise die booleschen Logikoperationen „XOR" und„AND" für einmal das exklusive Oder und die Konjunktion ausreichen, um alle anderen booleschen Logikoperationen realisieren zu können, da sich alle Logikoperationen auf diese beiden zurückführen lassen. </p><p id="p0022" num="0022">Nun wurde erkannt, dass arithmetische Funktionen, wie beispielsweise die Addition oder Multiplikation, hinsichtlich der binären Werte oder der Paritäten der Operanden und Ergebnisse äquivalent sind zu den booleschen Logikoperatio- 
<!-- EPO <DP n="8"/>-->
 nen. Dies wird anhand der nachfolgenden Tabelle bezüglich der booleschen Logikoperationen„XOR" und der arithmetischen Funktion„Addition", die insbesondere bezüglich der Paritäten zu der Logikoperation„XOR" äquivalent ist, dargelegt: </p><p id="p0023" num="0023"><img id="imgf000008_0001" he="24" wi="67" file="imgf000008_0001.tif" img-format="tif" img-content="table" orientation="portrait" inline="no"/><img id="imgf000008_0002" he="24" wi="78" file="imgf000008_0002.tif" img-format="tif" img-content="table" orientation="portrait" inline="no"/></p><p id="p0024" num="0024">Die linke Tabelle ist eine Übersicht über die Ergebnisse der booleschen Logikoperation„XOR". Es ist zu erkennen, dass das Ergebnis der Operation„XOR" logisch 1 ist, wenn einer der Operanden den Wert logisch 1 und der andere Operand den Wert logisch 0 hat. Sind beide Operanden jedoch vom Wert her gleich, d. h. entweder beide logisch 0 oder logisch 1 , so liefert die XOR- Operation den Wert logisch 0. Somit wird eine exklusives Oder realisiert, das umgangssprachlich auch häufig mit„entweder-oder" bezeichnet wird. </p><p id="p0025" num="0025">Die Funktionstabelle der binären Addition ohne Übertrag ist deckungsgleich mit der dargestellten Funktionstabelle XOR, so dass eine unmittelbare Abbildung zwischen den beiden Operationen durchführbar ist. </p><p id="p0026" num="0026">Auf der rechten Seite ist die Tabelle für die arithmetische Funktion„Addition" in Bezug auf ihre Paritäten dargestellt. Demnach ist die Parität des Ergebnisses der Addition dann gerade, wenn die beiden Operanden der Additionsfunktion entweder eine gerade oder eine ungerade Parität aufweisen. Mit anderen Worten, das Ergebnis der Addition weist immer dann eine gerade Parität auf, wenn die beiden Operanden entweder gerade Zahlen sind oder beide ungerade Zahlen sind. Wird hingegen eine gerade mit einer ungeraden Zahl addiert, so weist das Ergebnis immer eine ungerade Parität auf. </p><p id="p0027" num="0027">Wird nun die Parität„gerade" als logisch 0 und die Parität„ungerade" als lo- 
<!-- EPO <DP n="9"/>-->
 gisch 1 interpretiert, so lässt sich die boolesche Logikfunktion„XOR" mit Hilfe der arithmetischen Funktion„Addition" abbilden und ist zu dieser äquivalent. </p><p id="p0028" num="0028">Ein ähnliches Äquivalenzverhalten ist auch zwischen der booleschen Logikoperation„AND" und der arithmetischen Funktion„Multiplikation" zu erkennen, wie die nachfolgende Tabelle dies darstellt. </p><p id="p0029" num="0029"><img id="imgf000009_0001" he="25" wi="67" file="imgf000009_0001.tif" img-format="tif" img-content="table" orientation="portrait" inline="no"/><img id="imgf000009_0002" he="25" wi="78" file="imgf000009_0002.tif" img-format="tif" img-content="table" orientation="portrait" inline="no"/></p><p id="p0030" num="0030">Die boolesche Logikoperation„AND", auch Konjunktion genannt, weist als Ergebnis immer dann den Wert logisch 1 auf, wenn beide Operanden, oder im Falle einer mehrfachen Konjunktion, alle Operanden den Wert logisch 1 aufweisen. In allen anderen Fällen hat das Ergebnis der AND-Operation den Wert logisch 0. </p><p id="p0031" num="0031">Die Funktionstabelle der binären Multiplikation ist deckungsgleich mit der dargestellten Funktionstabelle AND, so dass eine unmittelbare Abbildung zwischen den beiden Operationen durchführbar ist. </p><p id="p0032" num="0032">Wie nun die rechte Tabelle für die Paritäten der Multiplikation zeigt, ist die arithmetische Funktion„Multiplikation" hinsichtlich der Paritäten der Operanden und Ergebnisse zu der booleschen Logikoperation„AND" äquivalent. Denn das Ergebnis der Multiplikation hat immer dann eine ungerade Parität, wenn die Paritäten der beiden Operanden vorher ebenfalls ungerade war. In allen anderen Konstellationen hat das Ergebnis der Multiplikation eine gerade Parität. </p><p id="p0033" num="0033">Erfindungsgemäß wird nun dieses Äquivalenzverhalten dazu verwendet, boolesche Logikoperationen innerhalb eines homomorphen Verschlüsselungsraumes 
<!-- EPO <DP n="10"/>-->
 auszuführen, ohne dass dabei die Zielmaschinen den Wert der Operanden und den Wert des Ergebnisses der booleschen Logikoperation kennt. Denn ein Homomorphismus, so wie er einer homomorphen Verschlüsselung zugrunde liegt, ist eine strukturerhaltende Transformation zwischen zwei Mengen, wobei die Operationen auf der ersten Menge bei der Transformation in die zweite Menge erhalten bleiben. Dies bedeutet konkret, dass bei einer homomorphen Verschlüsselung zweier Operanden es möglich ist, beispielsweise eine Addition durchzuführen, bei dem das Ergebnis nach der Entschlüsselung dem korrekten Ergebnis der Operation im Klartext entspricht. Mit anderen Worten, werden zwei homomorph verschlüsselte Zahlen addiert und wird das Ergebnis dieser Addition dann wieder entschlüsselt, so entspricht das Ergebnis dieser Verschlüsselung exakt dem Ergebnis der Addition der beiden unverschlüsselten Klartextzahlen. So lassen sich letztendlich mit einer homomorphen Verschlüsselung Zahlen verschlüsseln, wobei diese Verschlüsselungen nunmehr weiterhin bestimmten arithmetischen Funktionen zugänglich sind und mit diesen auch ganz normal gerechnet werden kann, ohne dass derjenige, der die Berechnung durchführt, die Werte der Operanden und Ergebnisse kennt. Erst nach der Entschlüsselung kann das exakte Ergebnis festgestellt werden. Ein entsprechendes Beispiel hierfür wird später noch in der Figurenbeschreibung erläutert. </p><p id="p0034" num="0034">Unter Anwendung einer derartigen homomorphen Verschlüsselung und der Ä- quivalenz von booleschen Logikoperationen mit entsprechenden arithmetischen Funktionen lassen sich somit binäre Darstellungen bitweise in Ganzzahlen oder andere geeignete Darstellungen repräsentieren, auf denen dann boolesche Logikoperationen im Verschlüsselungsraum mit Hilfe der arithmetischen Funktionen durchgeführt werden können, ohne dass die Zielmaschine den Wert der Operanden sowie das Ergebnis kennt. Da bei den arithmetischen Funktionen der binäre Werte bzw. die Parität der Operanden und Ergebnisse im Verschlüsselungsraum erhalten bleibt, was selbstverständlich für das Chiffrate nicht bedeuten muss, kann nach der Entschlüsselung das Ergebnis als logisch 0 oder logisch 1 interpretiert werden, was wieder zu einer binären Darstellung 
<!-- EPO <DP n="11"/>-->
 des Ergebnisses führt. </p><p id="p0035" num="0035">Auf Grundlage dieser Erkenntnis lassen sich nun boolesche Logikoperationen, wie sie von einer CPU oder Zentraleinheit ausgeführt werden, in einem homo- morphen Verschlüsselungsraum ausführen, wobei alle booleschen Logikoperationen, die von der Zielmaschine ausgeführt werden müssen, auf die entsprechenden arithmetischen Funktionen abgebildet werden. Da die Arbeitsweise einer CPU letztendlich auf Grundlage solcher booleschen Logikoperationen basiert, lässt sich mit Hilf einer Ausführungseinheit ein CPU-Modell abbilden, welches anstelle der boolesche Logikoperationen die entsprechenden arithmetischen Funktionen aufweist und somit ein homomorph verschlüsseltes Computerprogramm inklusive der enthaltenen Daten ausführen kann, ohne dass die Maschine zu irgendeinem Zeitpunkt wei ß, welche Berechnungsschritte tatsächlich durchgeführt werden. Denn die gesamte Berechnung erfolgt auf boolescher Ebene innerhalb des homomorphen Verschlüsselungsraumes, wobei die Korrektheit zum einen aufgrund der Äquivalenz zu den arithmetischen Funktionen und zum anderen aufgrund der strukturerhaltene Transformation des Homomorphismus gewährleistet werden kann. </p><p id="p0036" num="0036">Vorteilhafterweise lässt sich die boolesche Logikoperation„OR" durch die insbesondere hinsichtlich der binären Werte bzw. der Paritäten äquivalente arithmetische Funktion : r = (a + b) + (a · b) abbilden, wobei r das Ergebnis der Operation ist, a der erste Operand und b der zweite Operand als homomorph verschlüsselte Repräsentation ist. Diese arithmetische Funktion lässt sich dabei aus dem Zusammenhang herleiten, dass die boolesche Logikoperation„OR" sich durch die boolesche Logikoperationen„XOR" und„AND" abbilden lässt. 
<!-- EPO <DP n="12"/>-->
 Des Weiteren ist es besonders vorteilhaft, wenn die boolesche Logikoperation „NOT" als logische Negation durch die insbesondere hinsichtlich der binären Werte bzw. der Paritäten äquivalente arithmetische Funktion r = a + 1 mit a als einen Operand und r als dem Ergebnis der Funktion abgebildet wird. Denn durch die Addition der Zahl 1 zu einer wie auch immer gearteten Ganzzahl bzw. einer übertragslosen binären Addition mit dem Wert 1 wird schließlich immer die Parität bzw. der binäre Wert gewechselt, was letztendlich in der booleschen Logik ebenfalls einem Wertewechsel von logisch 0 zu logisch 1 oder andersherum entspricht. </p><p id="p0037" num="0037">Die Aufgabe wird im Übrigen auch mit einem Computerprogramm mit Programmcodemitteln, eingerichtet zur Durchführung des vorstehenden Verfahrens, gelöst, wenn das Computerprogramm auf einer Datenverarbeitungsanlage ausgeführt wird. </p><p id="p0038" num="0038">So ist es denkbar, dass ein Computerprogramm auf einer herkömmlichen Datenverarbeitungsanlage ausgeführt wird, wobei das Computerprogramm die Ausführung des verschlüsselten Maschinencodes unter Zugrundelegung der arithmetischen Funktionen durchführt. Somit können auf herkömmlichen Datenverarbeitungsanlagen verschlüsselte Maschinencodes ausgeführt werden, ohne dass die Datenverarbeitung selber Kenntnis davon hat, wie und was gerechnet wird. </p><p id="p0039" num="0039">Unter Maschinencode wird im Sinne dieser Erfindung eine Anzahl von Instruktionen verstanden, die direkt und ohne weitere Zwischenschritte von einer CPU oder, wie in diesem Fall, von einem Computerprogramm, das die Funktionsweise einer CPU emuliert, ausgeführt werden kann. Somit ist der Maschinencode letztendlich von Programmiersprachen, wie beispielsweise Assembler oder an- 
<!-- EPO <DP n="13"/>-->
 deren Hochsprachen abzugrenzen. </p><p id="p0040" num="0040">Darüber hinaus wird die Erfindung auch mit Hilfe einer Vorrichtung zum Ausführen eines homomorph verschlüsselten Maschinencodes mit Hilfe des vorstehend genannten Verfahrens gelöst, wobei die Vorrichtung eine Ausführeinheit aufweist, die zur Ausführung, wie vorstehend genannt, eingerichtet ist. So lässt sich das auf arithmetische Grundfunktionen abgebildete CPU-Modell neben einer reinen Softwareimplementierung auch in Hardware implementieren, was die Verarbeitungsgeschwindigkeit erheblich erhöht. </p><p id="p0041" num="0041">Die Aufgabe wird im Übrigen auch gelöst durch ein Verfahren zum Verschlüsseln eines Maschinencodes mit Verschlüsseln jedes Bits des Maschinencodes unter Verwendung eines homomorphen Verschlüsselungsverfahrens derart, dass jedes Bit des Maschinencodes durch einen Verschlüsselungscode repräsentiert wird. </p><p id="p0042" num="0042">Der Verschlüsselungscode kann dabei bspw. eine Ganzzahl oder eine andere geeignete Darstellung sein. </p><p id="p0043" num="0043">Jedes Bit, das letztendlich die kleinste Informationseinheit im Binärsystem darstellt, wird mit Hilfe eines homomorphen Verschlüsselungsverfahrens in einen Verschlüsselungscode verschlüsselt. Aufgrund der oben beschriebenen Äquivalenz von booleschen Logikoperationen zu ihren entsprechend arithmetischen Funktionen lässt sich somit eine boolesche Logikoperation mit Hilfe der entsprechend arithmetischen Funktion auf den verschlüsselten Verschlüsselungscodes durchführen, wobei der binäre Wert im Verschlüsselungsraum bei den Operationen erhalten bleibt. </p><p id="p0044" num="0044">So lässt sich beispielsweise mit Hilfe der Formel a<sup>"</sup> = q · a + (r · p) 
<!-- EPO <DP n="14"/>-->
 jedes Bit eines Maschinencodes in einer Ganzzahl verschlüsseln, wobei a das zu verschlüsselnde Bit darstellt, p der geheime Schlüssel zum Ver- und Entschlüsseln ist und r eine beliebige Zufallszahl darstellt. Das Ergebnis der Verschlüsselung, das hei ßt die Ganzzahl, ist dann a\ </p><p id="p0045" num="0045">Neben der oben angeführten Verschlüsselungsart, bei der auf die Paritäten abgestellt wird, können auch komplexere Verschlüsselungsverfahren verwendet werden, um die Verschlüsselungssicherheit zu erhöhen. So können bspw. auch Verfahren nach Gentry (vgl. C. Gentry,„Fully homomorphic encryption using ideal lattices", Proceedings of the 41 st annual ACM Symposium on Symposium on theory of Computing - STOC '09, 2009, p. 1 69), nach Smart (vgl. N. P. Smart and F. Vercauteren, "Fully Homomorphic Encryption with Relatively Small Key and Ciphertext Sizes", Public Key Cryptography-PKC 201 0: 1 3<sup>th</sup> International Conference on Practice and Theory in Public Key Cryptography) oder nach van Dijk (vgl. M.v. Dijk, C. Gentry, S. Halevi, and V. Vaikuntanathan, "Fully Homomorphic Encryption over the Integers", Advances in Cryptology - EUROCRYPT 201 0, Lecture Notes in Computer Science, 201 0, Volume </p><p id="p0046" num="0046">61 1 0/201 0, 24-43, DOI : 1 0.1 007/978-3-642-1 31 90-5_2) verwendet werden. </p><p id="p0047" num="0047">Diese voll homomorphen Verschlüsselungsverfahren codieren die binären Werte 0 und 1 in der Regel nicht direkt in die verschlüsselten Repräsentanten (wie bspw. die Paritäten in den oben gezeigten Ausführungsformen). Bei Gentry werden die Werte 0 und 1 als Eigenschaft von Matrizen und Vektoren verschlüsselt, wobei sich bei den geometrischen Verknüpfungen zweier Vektoren, die als Addition und Multiplikation interpretiert werden können, neue Vektoren ergeben, deren Eigenschaft sich wiederum auf die Werte 0 und 1 reduzieren lassen. Das Verschlüsselungsschema von Smart verwendet im Gegensatz dazu zur Darstellung der binären Werte Ganzzahlen und Polynome, die bestimmte, unterscheidbare Eigenschaften aufweisen. Anders als im vorgestellten Modellverfahren mit dem Klartextwertebereich der natürlichen Zahlen ist der Wer- 
<!-- EPO <DP n="15"/>-->
 tebereich der Klartextdarstellung bei Gentry, Smart und van Dijk gegeben als {0, 1 }. Zur Vereinfachung ist daher im Sinne dieser Erfindung stets von binären Werten oder Paritäten die Rede, da diese Darstellungen äquivalent sind. Die Erfindung ist jedoch nicht auf eine der genannten homomorphen Verschlüsselungsverfahren beschränkt. 
<!-- EPO <DP n="16"/>-->
</p><p id="p0048" num="0048">Die vorliegende Erfindung wird anhand der beigefügten Zeichnungen beispielhaft näher erläutert. Es zeigen : </p><p id="p0049" num="0049">Figur 1 schematische Darstellung eines Schaltkreises zum verschlüsselten Speicherzugriffs; </p><p id="p0050" num="0050">Figur 2 schematische Darstellung eines Schaltkreises einer verschlüsselten Arithmetic-Logic-Unit (ALU); </p><p id="p0051" num="0051">Figur 3 schematische Darstellung eines CPU-Modells; </p><p id="p0052" num="0052">Figur 4 schematische Darstellung des verteilten Rechners. </p><p id="p0053" num="0053">Bevor die Figuren näher erläutert werden, soll anhand einiger Beispiele die Funktionsweise der homomorphen Verschlüsselung und die darauf ausführbaren Operationen näher erläutert werden. Hierfür wird ein einfaches, auf Paritäten beruhendes Verschlüsselungsverfahren gewählt. Die Erfindung ist jedoch nicht darauf beschränkt. </p><p id="p0054" num="0054">Seien a und b beliebige natürliche Zahlen, beispielsweise a = 3 und b = 5. Diese beiden Zahlen werden nun mit Hilfe eines homomorphen Verschlüsselungsverfahrens, beispielsweise mit Hilfe der Funktion: a<sup>x</sup> = a + (r · p) in eine beliebig große Ganzzahl verschlüsselt. Als geheimen Schlüssel p wird die Primzahl 23 gewählt. Für jede Verschlüsselung wird für r eine unterschiedliche, beliebige Zufallszahl gewählt, beispielsweise n = 7 und r<sub>2</sub> = 1 1 . </p><p id="p0055" num="0055">Dann ergibt sich für die Zahlen a und b folgende Verschlüsselung: 
<!-- EPO <DP n="17"/>-->
 a = a + (r<sub>1</sub> · p) a = 3 + (7 · 23) a = 1 64 b = b + (r<sub>2</sub> · p) b<sup>x</sup> = 5 + (1 1 · 23) b<sup>x</sup> = 258 </p><p id="p0056" num="0056">Wie in diesem einfachen, homomorphen Verschlüsselungsverfahren ersichtlich, ergibt sich die Entschlüsselung durch die Restdivision mit dem geheimen Schlüssel p („mod" entspricht der Modulo-Operation) a = a<sup>x</sup> mod p </p><p id="p0057" num="0057">Der Klartext ist in diesem Verschlüsselungsverfahren somit der Rest des Schlüsselvielfachen. Selbstverständlich sind aber auch andere homomorphen Verschlüsselungsverfahren denkbar, die eine höhere Sicherheit oder eine geringere Ungenauigkeit bei höheren Zahlendarstellungen haben, beispielsweise die genannten Verfahren nach Gentry, Smart und van Dijk. </p><p id="p0058" num="0058">Ziel der homomorphen Verschlüsselung ist es, dass Operationen der Schlüsselzahlen des exakt selbe Ergebnis der in den Schlüsselzahlen verschlüsselten geheimen Klartextzahlen entspricht. Mit anderen Worten, werden zwei verschlüsselte Ganzzahlen miteinander addiert, so muss bei der Entschlüsselung des Ergebnisses diese Addition das Ergebnis der Addition der beiden Klartextzahlen stehen. 
<!-- EPO <DP n="18"/>-->
 Anhand des oben genannten Beispieles von a und b soll dies demonstriert werden. Die Addition von a = 3 und b = 5 ist r = 8. Dieses Ergebnis muss bei einer homomorphen Verschlüsselung auch herauskommen, wenn die beiden Schlüsselzahlen a<sup>x</sup> und b<sup>x</sup> miteinander addiert werden und das Ergebnis anschlie ßend mit Hilfe des geheimen Schlüssels p entschlüsselt wird. r<sup>x</sup> = a<sup>x</sup> + b<sup>"</sup> r = 164 + 258 r = 422 r = r<sup>x</sup> mod p r = 422 mod 23 r = 8 </p><p id="p0059" num="0059">Das gleiche gilt auch für die arithmetische Funktion der Multiplikation. Werden die Zahlen a = 3 und b = 5 miteinander multipliziert, so ergibt sich r = 15. Werden die Schlüsselzahlen a<sup>x</sup> und b<sup>"</sup> miteinander multipliziert, so ergibt sich r = 42312 </p><p id="p0060" num="0060">Wird r<sup>x</sup> nun unter Verwendung des geheimen Schlüssels p = 23 entschlüsselt, so ergibt sich r = 42312 mod 23 r = 15. 
<!-- EPO <DP n="19"/>-->
 Mit Hilfe einer homomorphen Verschlüsselung lassen sich somit Zahlen verschlüsseln, wobei weiterhin arithmetische Funktionen auf die Schlüsselzahlen derart anwendbar sind, dass in den verschlüsselten Repräsentationen der Ergebnisse das eigentliche Ergebnis der Klartext-Operation enthalten ist. </p><p id="p0061" num="0061">Diese mathematische Eigenart von homomorphen Verschlüsselungen kann nun dazu verwendet werden, boolesche Schaltkreise unter Anwendung der Äquivalenz zur Binärarithmetik bzw. der Paritäts-Äquivalenz zu verschlüsseln. Denn wie bereits einleitend gezeigt, entsprechen die binären Ergebnisse bzw. Paritäten der Additions-Funktion der booleschen Logikoperation„ XOR" und die Multiplikations-Funktion der booleschen Logikoperation„AND". Damit lässt sich ausgehend von einer (verschlüsselten) Ganzzahlrepräsentation oder einer anderen geeigneten Darstellung eines Bits eine Kette von Operationen ausführen, an deren Ende der (verschlüsselte) Repräsentant des Ergebnisbits steht. Dies soll anhand eines Beispieles kurz erläutert werden. </p><p id="p0062" num="0062">Seien a und b zwei Bits, die entweder den Wert logisch 0 oder den Wert logisch 1 annehmen können. Für das folgende Beispiel wird angenommen, dass a = 1 und b = 0 ist. Unter Verwendung des bereits zuvor verwendeten geheimen Schlüssels p = 23 und der beliebigen Zufallszahlen r = 7 und r<sub>2</sub> = 1 1 lassen sich die beiden Bits a und b wie folgt in eine Ganzzahlrepräsentation a<sup>x</sup> und b<sup>"</sup> unter Verwendung des einfachen homomorphen Verschlüsselungsverfahrens verschlüsseln: a<sup>x</sup> = a + (n · p) a = 1 + (7 · 23) a = 1 62 
<!-- EPO <DP n="20"/>-->
 f = b + (r<sub>2</sub> · p) b<sup>x</sup> = 0 + (1 1 · 23) b<sup>x</sup> = 253 </p><p id="p0063" num="0063">Zu beachten ist, dass aufgrund der Paritätsannahme die Bits mit dem binären Wert 0 durch jede gerade natürliche Zahl repräsentiert werden können, Bits mit dem binären Wert 1 dagegen durch jede ungerade natürliche Zahl. </p><p id="p0064" num="0064">Durch die Verschlüsselung der einzelnen Bits in eine beliebig große Ganzzahlrepräsentation lassen sich somit herkömmliche boolesche Logikoperationen, beispielsweise XOR, nicht mehr anwenden. Stattdessen wird nunmehr eine a- rithmetische Funktion auf die verschlüsselten Ganzzahlrepräsentationen angewendet, die zu der jeweiligen booleschen Logikoperation hinsichtlich der Paritäten der Operanden und des Ergebnisses äquivalent ist. Dies gilt auch für andere als das dargestellte, einfache Verschlüsselungsverfahren. Da bei einer homomorphen Verschlüsselung mathematische Funktionen im Verschlüsselungsraum derart ausgeführt werden, dass auch das eigentliche Klartextergebnis korrekt ist, lassen sich so boolesche Operationen im Verschlüsselungsraum mit Hilfe dieser mathematischen Repräsentationen abbilden. </p><p id="p0065" num="0065">Dies soll am Beispiel der booleschen Logikoperation XOR kurz gezeigt werden. Wie offensichtlich, hat die Operation a XOR b den Wert logisch 1 , da einer der Operanten (a) den Wert logisch 1 hat und der andere Operand (b) den Wert logisch 0. In der Verschlüsselung beziehungsweise im Verschlüsselungsraum lässt diese Operation wie folgt abbilden : r<sup>x</sup> = a<sup>x</sup> + b<sup>x</sup> r = 1 62 + 253 
<!-- EPO <DP n="21"/>-->
 r = 41 5 r<sup>x</sup> enthält nunmehr das logische Ergebnis der XOR Operation derart, dass auf den logischen Wert des Ergebnisses anhand der Parität der Klartextzahlen geschlossen werden kann. Unter Zugrundelegung des geheimen Schlüssels p = 23 ergibt sich bei der Entschlüsselung r = r<sup>x</sup> mod p r = 41 5 mod 23 r = 1 </p><p id="p0066" num="0066">Da das Ergebnis der Entschlüsselung eine ungerade Zahl ist, kann somit auf den Wert logisch 1 geschlossen werden, was der oberen Klartextberechnung von a XOR b entspricht. </p><p id="p0067" num="0067">Selbstverständlich lässt sich so auch die boolesche Logikoperation„AND" mit der arithmetischen Funktion„Multiplikation" im Verschlüsselungsraum abbilden, so dass sich auch dieser boolesche Schaltkreis damit im Verschlüsselungsraum abbilden lässt. Andere boolesche Logikoperationen lassen sich dabei durch die Anwendung von XOR und AND abbilden, beispielsweise die boolesche Logikoperation OR mit r = (a + b) + (a · b) was der zusammengesetzten booleschen Logikoperation r = (a XOR b) XOR (a AND b) 
<!-- EPO <DP n="22"/>-->
 entspricht. Die Negation als boolesche Logikoperation lässt sich bei diesem Ausführungsbeispiel anhand der Addition einer 1 realisieren, da sich dadurch immer die Parität sowohl bei der verschlüsselten Ganzzahlrepräsentation, was an und für sich unwichtig ist, als auch bei der verschlüsselten Klartextzahl ändert. Diese Auswirkung auf den Klartext gilt dabei auch für andere homomor- phe Verschlüsselungsverfahren. </p><p id="p0068" num="0068">Wird nun jedes Bit eines Maschinencodes mit Hilfe einer derartigen homomor- phen Verschlüsselung durch eine entsprechende Darstellung (bspw. Ganzzahl) repräsentiert, so lassen sich die ansonsten ausgeführten Bitweisen booleschen Logikoperationen durch die entsprechenden arithmetischen Funktionen ersetzen, so dass die booleschen Logikoperationen innerhalb des Verschlüsselungsraumes ausgeführt werden können. </p><p id="p0069" num="0069">Bei Anwendung dieses Schemas lässt sich nun ein entsprechend verschlüsselter Maschinencode ausführen. Figur 1 zeigt hierzu beispielhaft einen Datenselektor, der einen verschlüsselten Speicherzugriff realisiert. Gegeben seien die Speicherleitungen mO bis m3. Der Inhalt einer dieser Speicherleitungen mO bis m3 soll mit Hilfe einer entsprechenden Adressierung aO bis a1 letztlich ausgegeben werden. Hierfür ist jede der Speicherleitungen mO bis m3 jeweils mit einem booleschen Logikoperator„AND" verbunden, deren Ausgänge wiederum die Eingänge eines booleschen Logikoperators„OR" sind. Die in diesem Beispiel beiden Adressleitungen aO und a1 sind ebenfalls mit den Logikoperatoren „AND" verbunden. Je nach dem, welche Adresse aO und a1 angelegt ist, wird der entsprechende Logikoperator„AND" auf die Datenleitung geschaltet. </p><p id="p0070" num="0070">Für diese in Figur 1 gezeigten vier Speicher beziehungsweise Datenleitungen und den beiden Adressleitungen lässt sich der Zugriff durch die folgende boolesche Logik abbilden : c = (-i a<sub>0</sub> AND iai AND m<sub>0</sub>) OR 
<!-- EPO <DP n="23"/>-->
 
<img id="imgf000023_0001" he="5" wi="52" file="imgf000023_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0071" num="0071"> (^a<sub>0</sub> AND a^ AND m<sub>2</sub>) OR</p><p id="p0072" num="0072"><img id="imgf000023_0002" he="5" wi="44" file="imgf000023_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/></p><p id="p0073" num="0073">Durch die Verschlüsselung der einzelnen Bits lassen sich für die einzelnen booleschen Logikoperationen nunmehr die bereits gezeigten, entsprechend äquivalenten arithmetischen Funktionen ersetzen, so dass sich für diese boolesche Logik folgende äquivalente Arithmetik ergibt: c = ((a<sub>0</sub> + 1 ) · (ai + 1 ) · m<sub>0</sub>) o</p><p id="p0074" num="0074"><img id="imgf000023_0003" he="13" wi="40" file="imgf000023_0003.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/></p><p id="p0075" num="0075"> (a<sub>0</sub> · a · m<sub>3</sub>) </p><p id="p0076" num="0076">Wobei der Operator o der arithmetischen Funktion für die boolesche Logikoperation„OR" wie folgt entspricht: a o b = (a + b) + (a · b) </p><p id="p0077" num="0077">Aufgrund der Übersichtlichkeit wird hier auf das Ausformulieren der Arithmetik „OR" verzichtet. Anhand eines Ausführungsbeispieles, welches ebenfalls auf dem vereinfachten Verschlüsselungsverfahren beruht, soll die Arbeitsweise kurz erläutert werden. Seien m<sub>0</sub> bis m<sub>3</sub> die Elemente der zufälligen Bitreihe </p><p id="p0078" num="0078">[1 ,0,1 ,0] mit hinsichtlich der Paritäten äquivalenten Ganzzahl-Repräsentation </p><p id="p0079" num="0079">[5,4,9,6] und seien a<sub>0</sub> bis a^ die Elemente der Reihe [8,3] als Repräsentation der Adresse 2 in Binärform. Die homomorphe Verschlüsselung in diesem Fall wurde so gewählt, dass die Klartextparitäten der zu verschlüsselnden Daten auch in dem Verschlüsselungstext selber erhalten bleibt, so dass Klartext und Verschlüsselungstext immer dieselbe Parität haben. Dies erleichtert die Darstellung der Funktionsweise und dient lediglich zu Anschauungszwecken. Konkret wurde hier der Zufallsparameter r mit dem Wert 0 gewählt, wodurch die 
<!-- EPO <DP n="24"/>-->
 Klartextparitäten auch in der Verschlüsselung ablesbar bleiben. </p><p id="p0080" num="0080">Nach Einsetzen aller Parameter ergibt sich folgende Ganzzahl-Arithmetik für den Speicherzugriff: c= ((8 + 1 ) · (3 + 1 ) · 5) o </p><p id="p0081" num="0081"> (8 · (3 + 1 ) · 4) o </p><p id="p0082" num="0082"> ((8 + 1 ) · 3 · 9) o </p><p id="p0083" num="0083"> (8 · 3 · 6) </p><p id="p0084" num="0084">C = 1 80 o 1 28 o 243 o 1 44 c = 82608761 9 </p><p id="p0085" num="0085">Da wie bereits erwähnt, in diesem Beispiel die Klartextparität bei der Verschlüsselung erhalten bleibt, lässt sich das Klartext-Ergebnis dieser Operation direkt aus der Parität des Verschlüsselungstextes ableiten, ohne dass der Verschlüsselungstext hierfür noch einmal entschlüsselt werden muss. Aufgrund der Tatsache, dass das Ergebnis dieser oben durchgeführten Arithmetik eine ungerade Zahl ist, ergibt sich der Wert logisch 1 , was dem Inhalt der Speicheradresse m<sub>2</sub> entspricht. </p><p id="p0086" num="0086">Bei dem schreibenden Speicherzugriff wird einer Schreibfunktion die Repräsentation des neuen Wertes als Eingabe übergeben. Dabei wird über alle Speicherreihen iteriert und entweder der neue Input in die selektierte Speicherreihe geschrieben oder der alte Wert übernommen. In jedem Fall wird jede Speicherreihe neu beschrieben. </p><p id="p0087" num="0087">Nach diesem Schema eines Datenselektors, wie er in Figur 1 dargestellt ist, lassen sich nun auch alle anderen Operationen einer CPU, wie beispielsweise die ALU, verschlüsselte Sprünge und dergleichen abbilden. Ein einfacher ALU- 
<!-- EPO <DP n="25"/>-->
 Schaltkreis, der mit den oben gezeigten Mitteln in eine verschlüsselte Repräsentation überführt werden kann, zeigt hierbei beispielsweise Figur 2. </p><p id="p0088" num="0088">Die in Figur 2 gezeigte ALU erhält als Eingabe zwei Operanden a und b, die je eine verschlüsselte Repräsentation von Bits darstellen. Über ein Operationssignal Oo und Oi lässt sich darüber hinaus die ALU entsprechend ansteuern, so dass die ALU letztendlich das Ergebnis ausgibt, das der Berechnung entspricht, welches mit den Operationssignalen an und a^ adressiert wurde. Die Auswahl erfolgt letztendlich bei dieser verschlüsselten ALU auch über die boolesche Logikoperation„AND", deren Ausgänge der Eingang zu einer booleschen Logikoperation OR sind. Je nach dem, welche Operation durch die Adressen ao und ai adressiert wurden, wird die entsprechende AND-Operation geschaltet. </p><p id="p0089" num="0089">Die hier beispielhaft dargestellte verschlüsselbare, arithmetische Repräsentation einer ALU kann dabei die folgenden Funktionen ausführen: </p><p id="p0090" num="0090">Cadd = fulladder (a, b) </p><p id="p0091" num="0091">Cand = a AND b </p><p id="p0092" num="0092">CXOR = a XOR b </p><p id="p0093" num="0093">Cnot = <sup>~</sup>! a </p><p id="p0094" num="0094">Wobei die Funktion "fulladder" der übertragsbehafteten Addition zweier Binärzahlen entspricht. </p><p id="p0095" num="0095">Durch die Verwendung der homomorphen Verschlüsselung und der hierfür notwendigen Arithmetik ergibt sich für die verschlüsselte ALU folgende, arithmetisch äquivalente Repräsentation: </p><p id="p0096" num="0096">C = (Cadd · ((o<sub>0</sub> + 1 ) · (Ol + a))) o </p><p id="p0097" num="0097"> (Cand * (O<sub>0</sub> * (O l + 1 ))) O 
<!-- EPO <DP n="26"/>-->
 (CXOR · ((o<sub>0</sub> +1 ) · Ol )) o </p><p id="p0098" num="0098"> (Cnot <sup>*</sup> (Oo <sup>*</sup> Ol )) </p><p id="p0099" num="0099">Somit lässt sich die komplette Funktionalität einer arithmetic-logical-unit mit Hilfe der vorstehend genannten arithmetischen Funktion abbilden, wobei die gesamte Berechnung innerhalb des Verschlüsselungsraumes derart erfolgt, dass das Ergebnis im Verschlüsselungsraum korrekt ist, bedingt durch die ho- momorphe Verschlüsselung. Somit werden letztendlich alle Funktionen der verschlüsselten ALU mit den anliegenden Werten der Operanden a und b ausgeführt, wobei das Ergebnis schlussendlich dann in Abhängigkeit der anliegenden Adressen o<sub>0</sub> und Oi ausgewählt wird. Unter Zugrundelegung der in den Figuren 1 und 2 gezeigten Prinzipien lässt sich somit ein vollständiges CPU- Modell, wie es in Figur 3 gezeigt ist, sowohl hardwaretechnisch als auch in Software implementieren. Dabei werden genau die gleichen Abarbeitungsschritte durchgeführt, wie sie auch bei einer herkömmlichen CPU zu finden sind. Allerdings werden anstelle der bei einer CPU verwendeten booleschen Logikoperationen die hierzu äquivalenten arithmetischen Funktionen verwendet, so dass boolesche Logikoperationen innerhalb des Verschlüsselungsraumes ausgeführt werden können. Bei einer reinen Softwareimplementierung würde dies bedeuten, dass die Zielmaschine, auf der die CPU-Simulation zur Ausführung eines verschlüsselten Maschinencodes abläuft, nur die arithmetischen Funktionen mit den verschlüsselten Repräsentanten ausführt. Zu jedem Zeitpunkt liegt der Maschinencode verschlüsselt vor und kann somit von der Zielmaschine nicht eingesehen werden. Auch lassen sich keine Rückschlüsse aus den Bearbeitungsabläufen der Zielmaschine auf den Inhalt des Programms sowie der Daten ziehen. </p><p id="p0100" num="0100">Somit lassen sich auch entsprechende verschlüsselte Sprunganweisungen beziehungsweise Sprünge implementieren. </p><p id="p0101" num="0101">Die Figur 3 zeigt, ist das Ergebnis einer Sprunganweisung nicht das allgemeine 
<!-- EPO <DP n="27"/>-->
 Register (Akkumulator), sondern das Programmzählregister. Mit den bisher beschriebenen Konstrukten zur Schaltungsbildung können somit auch verschlüsselte Sprünge realisiert werden. </p><p id="p0102" num="0102">Anders als der unbedingte Sprung (jmp) hängen die bedingten Sprünge vom Systemzustand ab. Dies könne beispielsweise der Additionsübertrag (Carry) und das O-Ergebnis beziehungsweise Gleichheit von Operanden sein. Die Systemzustände werden durch Flags repräsentiert. </p><p id="p0103" num="0103">Sei F die Menge der Systemflags, PC, das Programmzählregister, DR das Datenregister und CR das Befehlsregister. Die Funktionen jmp (CR), bcc (CR) und beq (CR) werden analog des Speicherzugriffs als Datenselektoren implementiert und liefern den Wert logisch 1 , wenn der entsprechende Befehl ausgeführt werden soll. Die Adresse des nächsten Befehls im Programm ist dann </p><p id="p0104" num="0104">V x : x e {0 ... wordsize -1 }, </p><p id="p0105" num="0105">PC<sub>X</sub> = (jmp (CR) AND DR<sub>X</sub>) OR </p><p id="p0106" num="0106">(bcc (CR) AND DR<sub>X</sub> AND -. F<sub>carry</sub>) OR </p><p id="p0107" num="0107">(beq (CR) AND DR<sub>X</sub> AND F<sub>zero</sub>) OR </p><p id="p0108" num="0108">Hmp (CR) AND -. bcc (CR) AND -. beq (CR) AND (PC+1 )<sub>X</sub>) </p><p id="p0109" num="0109">Die Abarbeitung der Befehle beziehungsweise Instruktionen kann dabei derart erfolgen, dass zunächst mit den Argumenten des Befehls zunächst alle Befehle ausgeführt werden und dass Ergebnis dann wieder, wie bereits bei den vorstehend beschriebenen Datenselektoren, hinsichtlich der enthaltenen Instruktionen ausgewählt wird. 
<!-- EPO <DP n="28"/>-->
 In einer Prototypimplementierung wurde ein System mit einer Wortlänge von 1 3 Bit implementiert, wobei ein Wort dabei 8 Bit Daten und 5 Bit Befehlsanteil enthält. Dadurch kann der Prototyp mit eintaktigem Speicherzugriff einfach gehalten werden. Der Speicher umfasst 256 Worte mit wahlfreiem Zugriff, wobei bei Speicherzugriffen nur der Datenbestandteil eines Speicherwortes modifiziert wird. Der Befehlssatz, der in dem Maschinencode enthalten sein kann und von der Ausführungseinheit ausführbar ist, bietet die Adressierungsmodelle„unmittelbar" und„direkt". </p><p id="p0110" num="0110">Bei einer Beispielimplementierung des Sortierprogramms„Bubble sort", das die Zahlen [5,4,9,5] sortieren soll, wurden insgesamt 239 Taktzyklen gemessen, die ausreichen, um die Folge zu sortieren. Die nachfolgende Tabelle zeigt die Anzahl von booleschen Operationen beziehungsweise deren Repräsentationen in verschlüsselter Arithmetik, die hierfür benötigt wurden. </p><p id="p0111" num="0111"><img id="imgf000028_0001" he="25" wi="162" file="imgf000028_0001.tif" img-format="tif" img-content="table" orientation="portrait" inline="yes"/></p><p id="p0112" num="0112">Figur 4 zeigt den übergeordneten Ablauf, wenn ein sicherheitskritisches Computerprogramm von einem fremden Zielsystem ausgeführt werden soll. Dazu wird das Computerprogramm zunächst mit Hilfe eines entsprechenden Compilers im Maschinencode 1 übersetzt. Anschlie ßend wird dieser Maschinencode mit Hilfe eines beliebigen homomorphen Verschlüsselungsverfahrens und eines dafür geeigneten Schlüssels p verschlüsselt, und zwar derart, dass jedes Bit einzeln homomorph verschlüsselt wird. Das Ergebnis ist der verschlüsselte Maschinencode 2, bei dem jedes Bit durch eine geeignete Darstellung (bspw. Ganzzahl) repräsentiert ist. Dieser Maschinencode 2 wird nun beispielsweise über das Internet zu einem Zielsystem 3 übermittelt, von dem der verschlüsselte Maschinencode 2 unter Zugrundelegung des vorgestellten Verfahrens aus- 
<!-- EPO <DP n="29"/>-->
 geführt werden soll. Am Ende der Berechnung durch das Zielsystem 3 wird der Maschinencode 4, der zwar immer noch verschlüsselt ist, nunmehr aber das Ergebnis der Berechnung enthält, an den Absender zurückgesendet. Unter Zugrundelegung des Schlüssels p wird der verschlüsselte Maschinencode 4 wieder in Klartext 5 übersetzt, woraus nun das Ergebnis im Klartext ablesbar ist. </p><p id="p0113" num="0113">Aufgrund der Tatsache, dass eine binäre Repräsentation durch die Werte logisch 0 und logisch 1 beispielsweise auch als Ganzzahlen mit entsprechenden Paritätswerten interpretiert werden können, lassen sich selbstverständlich auch Daten dynamisch während des Programmablaufes im Klartext hinzufügen. Diese Daten werden dann schlicht als unverschlüsselte Daten mit in die Berechnung einbezogen. Diese Daten werden im einfachen Verschlüsselungsverfahren schlicht als unverschlüsselte Parameter mit in die Berechnung einbezogen. Im Falle von asymmetrischen Verschlüsselungsverfahren (Gentry, van Dijk, Smart) werden die Klartextdaten zunächst mit dem geeigneten, öffentlichen Schlüsselteil verschlüsselt und dann in die Verarbeitung eingebracht. 
</p></description><claims mxw-id="PCLM44727180" ref-ucid="WO-2012113908-A2" lang="DE" load-source="patent-office"><claim-statement><!-- EPO <DP n="30"/>-->Patentansprüche: </claim-statement><claim id="clm-0001" num="1"><claim-text>1 . Verfahren zum Ausführen eines bitweise homomorph verschlüsselten Maschinencodes durch eine auf einer Datenverarbeitungsanlage angeordneten Ausführungseinheit, wobei der verschlüsselte Maschinencode Instruktionen enthält, die von der Ausführungseinheit ausführbar sind, mit Bereitstellung von arithmetischen Funktionen, bei denen die Operanden und das daraus resultierende Ergebnis einer booleschen Logikfunktion entspricht, und Ausführen der in dem verschlüsselten Maschinencode enthaltenen Instruktionen durch die Ausführungseinheit unter Anwendung boolescher Logikoperationen, deren Berechnung durch die der jeweiligen booleschen Logikoperation entsprechenden arithmetischen Funktion unter Zugrundelegung der verschlüsselten Bits im Verschlüsselungsraum erfolgt. </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. Verfahren nach Anspruch 1 , gekennzeichnet durch Bereitstellen der a- rithmetischen Funktionen derart, dass jeweils der binäre Wert oder die Parität der Operanden und des daraus resultierenden Ergebnisses einer booleschen Logikoperation entspricht. </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. Verfahren nach Anspruch 1 oder 2, dadurch gekennzeichnet, dass die Addition als arithmetische Funktion der booleschen Logikfunktion XOR und/oder die Multiplikation als arithmetische Funktion der booleschen Logikoperation AND entspricht. </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. Verfahren nach einem der vorhergehenden Ansprüche, dadurch gekennzeichnet, dass die arithmetische Funktion : r = (a + b) + (a · b) mit r als Ergebnis der Funktion, a als ein erster Operand und b als ein zweiter Operand der booleschen Logikoperation OR entspricht. <!-- EPO <DP n="31"/>--> </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. Verfahren nach einem der vorhergehenden Ansprüche, dadurch gekennzeichnet, dass die arithmetische Funktion : r = a + 1 mit r als Ergebnis der Funktion und a als Operand der booleschen Logikfunktion NOT als logische Negation entspricht. </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. Computerprogramm mit Programmcodemitteln, eingerichtet zur Durchführung des Verfahrens nach einem der vorherigen Ansprüche, wenn das Computerprogramm auf einer Datenverarbeitungsanlage ausgeführt wird. </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. Vorrichtung zum Ausführen eines bitweise homomorph verschlüsselten Maschinencodes mit einer Ausführungseinheit, eingerichtet zur Durchführung des Verfahrens nach einem der Ansprüche 1 bis 5, wobei der verschlüsselte Maschinencode Instruktionen enthält und die Ausführungseinheit zum Ausführen der in dem verschlüsselten Maschinencode enthaltenen Instruktionen unter Anwendung boolescher Logikoperationen derart eingerichtet ist, dass die Berechnung der booleschen Logikoperationen durch arithmetische Funktionen unter Zugrundelegung der verschlüsselten Bits im Verschlüsselungsraum erfolgt, deren Operanden und des daraus resultierenden Ergebnisses der jeweiligen booleschen Logikfunktion entspricht. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. Verfahren zum Verschlüsseln eines Maschinencodes mit Verschlüsseln jedes Bits des Maschinencodes unter Verwendung eines homomorphen Verschlüsselungsverfahrens derart, dass jedes Bit des Maschinencodes durch einen Verschlüsselungscode repräsentiert wird. <!-- EPO <DP n="32"/>--> </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. Verfahren nach Anspruch 8, dadurch gekennzeichnet, dass ein homo- morphes Verschlüsselungsverfahren die Funktion a<sup>x</sup> = q · a + (r · p) mit a als dem zu verschlüsselnden Bit, q als weiterem Faktor, p als Schlüssel, r als einer beliebigen Zufallszahl und a<sup>x</sup> als dem Ganzzahl- Ergebnis der Verschlüsselung auf jedes Bit des Maschinencodes angewendet wird. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>1 0. Computerprogramm mit Programmcodemitteln, eingerichtete Durchführung des Verfahrens nach einem der Ansprüche 8 oder 9, wenn das Computerprogramm auf eine Datenverarbeitungsanlage ausgeführt wird. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
