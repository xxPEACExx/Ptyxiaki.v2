<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2680468-A2" country="EP" doc-number="2680468" kind="A2" date="20140101" family-id="48613485" file-reference-id="316855" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146549220" ucid="EP-2680468-A2"><document-id><country>EP</country><doc-number>2680468</doc-number><kind>A2</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-13171578-A" is-representative="YES"><document-id mxw-id="PAPP154823143" load-source="docdb" format="epo"><country>EP</country><doc-number>13171578</doc-number><kind>A</kind><date>20130612</date><lang>EN</lang></document-id><document-id mxw-id="PAPP181745958" load-source="docdb" format="original"><country>EP</country><doc-number>13171578.1</doc-number><date>20130612</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140452246" ucid="FI-20125742-A" load-source="docdb"><document-id format="epo"><country>FI</country><doc-number>20125742</doc-number><kind>A</kind><date>20120628</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988103920" load-source="docdb">H04J   3/06        20060101AFI20130625BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-2027179011" load-source="docdb" scheme="CPC">H04L  43/026       20130101 LI20150822BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2027179907" load-source="docdb" scheme="CPC">H04J   3/0697      20130101 LI20150822BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2027182138" load-source="docdb" scheme="CPC">H04J   3/0667      20130101 LA20150822BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2117098260" load-source="docdb" scheme="CPC">G06F   1/12        20130101 FI20131226BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132180144" lang="DE" load-source="patent-office">Verfahren und Vorrichtung zur Reglung eines Taktsignalgenerators</invention-title><invention-title mxw-id="PT132180145" lang="EN" load-source="patent-office">A method and a device for controlling a clock signal generator</invention-title><invention-title mxw-id="PT132180146" lang="FR" load-source="patent-office">Methode et dispositif de controle d'un generateur d'horloge</invention-title><citations><non-patent-citations><nplcit><text>None</text><sources><source mxw-id="PNPL45130874" load-source="docdb" name="APP"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR918135218" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>TELLABS OY</last-name><address><country>FI</country></address></addressbook></applicant><applicant mxw-id="PPAR918163956" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>TELLABS OY</last-name></addressbook></applicant><applicant mxw-id="PPAR918994424" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Tellabs Oy</last-name><iid>100234271</iid><address><street>Sinikalliontie 7</street><city>02630 Espoo</city><country>FI</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918133006" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>HANN KENNETH</last-name><address><country>FI</country></address></addressbook></inventor><inventor mxw-id="PPAR918146722" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>HANN, KENNETH</last-name></addressbook></inventor><inventor mxw-id="PPAR918984046" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>HANN, KENNETH</last-name><address><street>Hösmärinkuja 4 B 9</street><city>02760 Espoo</city><country>FI</country></address></addressbook></inventor><inventor mxw-id="PPAR918139899" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>LUNDQVIST JONAS</last-name><address><country>FI</country></address></addressbook></inventor><inventor mxw-id="PPAR918135118" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>Lundqvist, Jonas</last-name></addressbook></inventor><inventor mxw-id="PPAR918991024" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>Lundqvist, Jonas</last-name><address><street>Rauhalanpuisto 4 A 16</street><city>02230 Espoo</city><country>FI</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918993263" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Berggren Oy Ab</last-name><iid>101377942</iid><address><street>P.O. Box 16 Antinkatu 3 C</street><city>00101 Helsinki</city><country>FI</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS548855374" load-source="docdb">AL</country><country mxw-id="DS548849589" load-source="docdb">AT</country><country mxw-id="DS548855376" load-source="docdb">BE</country><country mxw-id="DS548855404" load-source="docdb">BG</country><country mxw-id="DS548851658" load-source="docdb">CH</country><country mxw-id="DS548802096" load-source="docdb">CY</country><country mxw-id="DS548849590" load-source="docdb">CZ</country><country mxw-id="DS548873065" load-source="docdb">DE</country><country mxw-id="DS548802097" load-source="docdb">DK</country><country mxw-id="DS548802106" load-source="docdb">EE</country><country mxw-id="DS548803482" load-source="docdb">ES</country><country mxw-id="DS548855405" load-source="docdb">FI</country><country mxw-id="DS548855406" load-source="docdb">FR</country><country mxw-id="DS548855377" load-source="docdb">GB</country><country mxw-id="DS548802107" load-source="docdb">GR</country><country mxw-id="DS548855378" load-source="docdb">HR</country><country mxw-id="DS548849591" load-source="docdb">HU</country><country mxw-id="DS548851659" load-source="docdb">IE</country><country mxw-id="DS548855379" load-source="docdb">IS</country><country mxw-id="DS548855407" load-source="docdb">IT</country><country mxw-id="DS548802108" load-source="docdb">LI</country><country mxw-id="DS548873066" load-source="docdb">LT</country><country mxw-id="DS548849592" load-source="docdb">LU</country><country mxw-id="DS548873067" load-source="docdb">LV</country><country mxw-id="DS548873068" load-source="docdb">MC</country><country mxw-id="DS548838515" load-source="docdb">MK</country><country mxw-id="DS548838516" load-source="docdb">MT</country><country mxw-id="DS548803483" load-source="docdb">NL</country><country mxw-id="DS548849593" load-source="docdb">NO</country><country mxw-id="DS548803484" load-source="docdb">PL</country><country mxw-id="DS548802109" load-source="docdb">PT</country><country mxw-id="DS548803485" load-source="docdb">RO</country><country mxw-id="DS548802114" load-source="docdb">RS</country><country mxw-id="DS548803490" load-source="docdb">SE</country><country mxw-id="DS548802115" load-source="docdb">SI</country><country mxw-id="DS548838517" load-source="docdb">SK</country><country mxw-id="DS548838518" load-source="docdb">SM</country><country mxw-id="DS548851660" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128669890" lang="EN" load-source="patent-office"><p id="pa01" num="0001">A device (104) for controlling a clock signal generator comprises a processing system configured to form a control quantity at least partly on the basis of reception moments of data frames belonging to a given flow, the reception moments being time values based on a clock signal prevailing at a receiver. The processing system controls the clock signal generator with the control quantity so as to achieve synchronization between the clock signal and another clock signal in accordance of which the data frames have been transmitted. In order to identify data frames belonging to the relevant flow, the processing system checks whether pre-determined bits of a received data frame constitute a bit pattern that occurs when the data frame belongs to the relevant flow. Therefore, the reception moments of data frames belonging to the relevant flow are obtainable without deep inspection of the received data frames.
<img id="iaf01" file="imgaf001.tif" wi="78" he="122" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128499263" lang="EN" source="EPO" load-source="docdb"><p>A device (104) for controlling a clock signal generator comprises a processing system configured to form a control quantity at least partly on the basis of reception moments of data frames belonging to a given flow, the reception moments being time values based on a clock signal prevailing at a receiver. The processing system controls the clock signal generator with the control quantity so as to achieve synchronization between the clock signal and another clock signal in accordance of which the data frames have been transmitted. In order to identify data frames belonging to the relevant flow, the processing system checks whether pre-determined bits of a received data frame constitute a bit pattern that occurs when the data frame belongs to the relevant flow. Therefore, the reception moments of data frames belonging to the relevant flow are obtainable without deep inspection of the received data frames.</p></abstract><description mxw-id="PDES63955320" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><b>Field of the invention</b></heading><p id="p0001" num="0001">The invention relates to a method and a control device for controlling a clock signal generator so as to generate a clock signal that is synchronized with another clock signal. Furthermore, the invention relates to a computer program for controlling a clock signal generator. Furthermore, the invention relates to network element, e.g. a router or a switch, of a data transfer network.</p><heading id="h0002"><b>Background</b></heading><p id="p0002" num="0002">Data transfer networks include network elements such as, for example, routers, switches, and terminal devices which communicate with each other via data transfer links between the network elements. In many data transfer networks, there is a need to achieve phase- or at least frequency-synchronization between clock signals prevailing at various network elements. Furthermore, in some data transfer networks, there can be a need to achieve time-synchronization between different network elements in such a way that not only phases and/or frequencies of clock signals but also time values maintained in these network elements are sufficiently close to each other. In other words, each of the network elements should maintain a time value that is common to all network elements under consideration. The common time value is usually called as "wall clock time" or "universal time". In this document, the term "synchronization" means frequency-synchronization, phase-synchronization, time-synchronization, or any combination of them.</p><p id="p0003" num="0003">Network elements can be configured to constitute master-slave pairs in order to distribute timing information within a data transfer network. For example, a slave network element may be configured to control its clock signal generator so that a reference clock signal prevailing at the corresponding master network element is regenerated in the slave network element at least partly on the basis of reception moments of timing messages transferred from the master network element to the slave network element, where the reception moments are expressed as time values<!-- EPO <DP n="2"> --> based on the clock signal prevailing at the slave network element. The timing messages can be, for example, time-stamps contained by data frames that can be, for example, Internet Protocol "IP" data packets or Ethernet data frames. Each time-stamp indicates the instantaneous time value at the transmission moment of the respective data frame containing the time-stamp under consideration, where the time value is based on the reference clock signal available at the master network element. For another example, the timing messages can be timing data frames that are transmitted so that the time interval between transmission moments of two successive timing data frames is constant, or otherwise known, when being measured with the reference clock signal available at the master network element. It is also possible that one or more time-stamps indicating the transmission moments of one or more timing messages are transferred in one or more data frames transmitted after the one or more timing messages. In cases where the time-synchronization is needed, the timing information is not only transferred from the master network element to the slave network element but also in the opposite direction from the slave network element to the master network element. A way of achieving the time-synchronization is presented, for example, in the specification 1588 issued by the Institute of Electrical and Electronics Engineers, "IEEE 1588".</p><p id="p0004" num="0004">In many cases, the reception moment of a data frame carrying or representing a timing message should be stored immediately after the arrival of the data frame at the network element because subsequent processing actions directed to the received data frame may take a stochastic amount of time, and thus storing the reception moment after these processing actions would cause a stochastic component on the stored value of the reception moment. Stochastic components of the kind mentioned above in the stored reception moments destroy or at least weaken the quality of the synchronization. An inherent inconvenience related to storing the reception moments before the above-mentioned processing actions is that, just after reception of a data frame, it is typically difficult to find out whether the received data frame belongs to those data frames whose reception moments needs to be stored. For example, a network element may receive an aggregate flow which consists of several flows of data frames, and only a small portion of the flows may be such flows that the reception moments of data frames belonging to<!-- EPO <DP n="3"> --> these flows needs to be stored. The flow recognition is typically based on inspection of the received data frames, but there can be a complex encapsulation so that many data transfer protocols are involved in each data frame. This makes it difficult to carry out the inspection within a sufficiently short and deterministic time. A straightforward brute-force solution would be to store the reception moments of all the received data frames together with e.g. copies of at least parts of the data frames and settle later which of the stored reception moments are needed in the synchronization. This straightforward brute-force solution requires, however, a lot of memory and processing capacity.</p><heading id="h0003"><b>Summary</b></heading><p id="p0005" num="0005">The following presents a simplified summary in order to provide a basic understanding of some aspects of various invention embodiments. The summary is not an extensive overview of the invention. It is neither intended to identify key or critical elements of the invention nor to delineate the scope of the invention. The following summary merely presents some concepts of the invention in a simplified form as a prelude to a more detailed description of exemplifying embodiments of the invention.</p><p id="p0006" num="0006">In accordance with the first aspect of the invention there is provided a new method for controlling a clock signal generator. The method comprises:
<ul><li>checking whether pre-determined bits of a received data frame of an aggregate flow constitute a first bit pattern, the first bit pattern occurring when the received data frame belongs to a first flow that is a part of the aggregate flow,</li><li>in response to a situation in which the first bit pattern occurs, storing the reception moment of the received data frame so that the stored reception moment is associated with the first flow, the reception moment being a time value based on a first clock signal and the received data frame being transmitted in accordance with a second clock signal,<!-- EPO <DP n="4"> --></li><li>forming a control quantity at least partly on the basis of the stored reception moment of the received data frame, and</li><li>controlling the clock signal generator with the control quantity so as to achieve synchronization between the first clock signal and the second clock signal.</li></ul></p><p id="p0007" num="0007">The checking whether the pre-determined bits of the received data frame constitute the first bit pattern can be carried out, for example, using a mask that is compared to the data frame so as to determine whether the data frame belongs to the above-mentioned first flow. The checking whether the pre-determined bits of the received data frame constitute the first bit pattern is a quick operation to be done immediately on the arrival of the data frame. Hence, there is neither a need for inspections that infringe the encapsulation structure of the received data frames nor a need for storing the reception moments of all of the received data frames.</p><p id="p0008" num="0008">In a method according an exemplifying embodiment of the invention, the clock signal generator generates the first clock signal, and the control of the clock signal generator comprises control of the frequency of the first clock signal. In this case, the first clock signal prevailing at a place of reception of the first flow is a controllable clock signal which is synchronized with the second clock signal prevailing at a place of transmission of the first flow.</p><p id="p0009" num="0009">In a method according another exemplifying embodiment of the invention, the clock signal generator generates the second clock signal, and thus the control of the clock signal generator comprises control of the frequency of the second clock signal. In this exemplifying method, information based on the reception moment and needed for controlling the clock signal generator is transferred from the place of reception of the first flow to the place of transmission of the first flow. In this case, the second clock signal prevailing at the place of transmission of the first flow is the controllable clock signal which is synchronized with the first clock signal prevailing at the place of reception of the first flow.<!-- EPO <DP n="5"> --></p><p id="p0010" num="0010">In accordance with the second aspect of the invention there is provided a new control device for controlling a clock signal generator. The control device comprises a processing system configured to:
<ul><li>check whether pre-determined bits of a received data frame of an aggregate flow constitute a first bit pattern, the first bit pattern occurring when the received data frame belongs to a first flow that is a part of the aggregate flow,</li><li>in response to a situation in which the first bit pattern occurs, store the reception moment of the received data frame so that the stored reception moment is associated with the first flow, the reception moment being a time value based on a first clock signal and the received data frame being transmitted in accordance with a second clock signal,</li><li>form a control quantity at least partly on the basis of the stored reception moment of the received data frame, and</li><li>control the clock signal generator with the control quantity so as to achieve synchronization between the first clock signal and the second clock signal.</li></ul></p><p id="p0011" num="0011">The control device can be a part of a network element, e.g. a router or a switch, of a data transfer network. It is also possible that the control device is a separate apparatus that is connected to a network element.</p><p id="p0012" num="0012">In conjunction with a control device according to an exemplifying embodiment of the invention, the clock signal generator generates the first clock signal and the control of the clock signal generator comprises control of the frequency of the first clock signal. In this case, the first clock signal prevailing at the place of reception of the first flow is the controllable clock signal which is synchronized with the second clock signal prevailing at the place of transmission of the first flow.</p><p id="p0013" num="0013">In conjunction with a control device according to another exemplifying embodiment of the invention, the clock signal generator generates the second clock signal and the control of the clock signal generator comprises control of the frequency of the second clock signal. In this case, the processing system is located in a distributed<!-- EPO <DP n="6"> --> manner so that a first part of the processing system is located at the place of reception of the first flow and a second part of the processing system is located at the place of transmission of the first flow. The first part of the processing system is configured to check whether the pre-determined bits of a received data frame constitute the first bit pattern and store the reception moment of the received data frame if the first bit pattern occurs. The second part of the processing system is configured to control the clock signal generator on the basis of the control quantity formed either by the first or second part of the processing system. Either the control quantity or information needed for forming the control quantity is transferred from the first part of the processing system to the second part of the processing system.</p><p id="p0014" num="0014">In accordance with the third aspect of the invention there is provided a new network element that comprises at least one ingress port for connecting to a data transfer network, a controllable clock signal generator for generating a first clock signal, and a processing system configured to:
<ul><li>check whether pre-determined bits of a received data frame of an aggregate flow constitute a first bit pattern, the first bit pattern occurring when the received data frame belongs to a first flow that is a part of the aggregate flow,</li><li>in response to a situation in which the first bit pattern occurs, store the reception moment of the received data frame so that the stored reception moment is associated with the first flow, the reception moment being a time value based on the first clock signal and the received data frame being transmitted in accordance with a second clock signal,</li><li>form a control quantity at least partly on the basis of the stored reception moment of the received data frame, and</li><li>control the clock signal generator with the control quantity so as to achieve synchronization between the first clock signal and the second clock signal.</li></ul><!-- EPO <DP n="7"> --></p><p id="p0015" num="0015">In accordance with the fourth aspect of the invention there is provided a new computer program for controlling a clock signal generator. The computer program comprises computer executable instructions for controlling a programmable processor to:
<ul><li>check whether pre-determined bits of a received data frame of an aggregate flow constitute a first bit pattern, the first bit pattern occurring when the received data frame belongs to a first flow that is a part of the aggregate flow,</li><li>in response to a situation in which the first bit pattern occurs, store the reception moment of the received data frame so that the stored reception moment is associated with the first flow, the reception moment being a time value based on a first clock signal and the received data frame being transmitted in accordance with a second clock signal,</li><li>form a control quantity at least partly on the basis of the stored reception moment of the received data frame, and</li><li>control the clock signal generator with the control quantity so as to achieve synchronization between the first clock signal and the second clock signal.</li></ul></p><p id="p0016" num="0016">A computer program product according to the invention comprises a non-volatile computer readable medium, e.g. a compact disc ("CD"), encoded with a computer program according to the invention.</p><p id="p0017" num="0017">A number of non-limiting exemplifying embodiments of the invention are described in accompanied dependent claims.</p><p id="p0018" num="0018">Various non-limiting exemplifying embodiments of the invention both as to constructions and to methods of operation, together with additional objects and advantages thereof, will be best understood from the following description of specific exemplifying embodiments when read in connection with the accompanying drawings.<!-- EPO <DP n="8"> --></p><p id="p0019" num="0019">The verbs "to comprise" and "to include" are used in this document as open limitations that neither exclude nor require the existence of unrecited features. The features recited in depending claims are mutually freely combinable unless otherwise explicitly stated.</p><heading id="h0004"><b>Brief description of figures</b></heading><p id="p0020" num="0020">The exemplifying embodiments of the invention and their advantages are explained in greater detail below in the sense of examples and with reference to the accompanying drawings, in which:
<ul><li><figref idrefs="f0001">figure 1</figref> shows a schematic illustration of an exemplifying data transfer system comprising a network element which is provided with a control device according to an exemplifying embodiment of the invention for controlling a clock signal generator,</li><li><figref idrefs="f0002">figure 2</figref> shows a schematic illustration of an exemplifying data transfer system comprising a network element which is provided with a control device according to an exemplifying embodiment of the invention for controlling a clock signal generator, and</li><li><figref idrefs="f0003">figure 3</figref> shows a flow chart of a method according to an exemplifying embodiment of the invention for controlling a clock signal generator.</li></ul></p><heading id="h0005"><b>Description of exemplifying embodiments</b></heading><p id="p0021" num="0021"><figref idrefs="f0001">Figure 1</figref> shows a schematic illustration of an exemplifying data transfer system that comprises a network element 101 and a network element 102. The network elements 101 and 102 are connected to each other via a data transfer network 103 that may comprise several other network elements interconnected to each other via data transfer links. Each network element can be, for example but not necessarily, an Internet Protocol ("IP") router, an Ethernet switch, and/or a Multi-Protocol Label Switching ("MPLS") switch. The network element 101 comprises a controllable clock signal generator 110 arranged to generate a first clock signal 111. The network element 101 comprises a counter 112 arranged to generate a signal 113 that represents the clock time prevailing at the network element 101.<!-- EPO <DP n="9"> --></p><p id="p0022" num="0022">The network element 101 comprises a processing system 114 for performing control- and forwarding-plane operations related to data transfer protocols being used, e.g. IP, Ethernet, and/or MPLS. Furthermore, the network element 101 comprises at least one ingress port 109 and at least one egress port 108 for connecting to the data transfer network 103. The network element 102 comprises a clock signal generator 120 arranged to generate a second clock signal 121. The network element 102 comprises a counter 122 arranged to generate a signal 123 that represents the clock time prevailing at the network element 102. The network element 102 comprises a processing system 124 for performing control- and forwarding-plane operations related to the data transfer protocols being used. Furthermore, the network element 102 comprises at least one ingress port 129 and at least one egress port 128 for connecting to the data transfer network 103.</p><p id="p0023" num="0023">In the exemplifying situation shown in <figref idrefs="f0001">figure 1</figref>, the network element 102 transmits a first flow 130 to the network element 101. The first flow 130 is assumed to comprise data frames which represent timing messages with the aid of which the network element 101 synchronizes the operation of the clock signal generator 110 to the operation of the clock signal generator 120. These data frames of the first flow are transmitted in accordance with the second clock signal 121. The first flow 130 is a part of an aggregate flow constituted by the whole data traffic which is received at the ingress port 109. The network element 101 transmits a second flow 131 to the network element 102. The second flow 131 is a part of the whole data traffic which is received at the ingress port 129.</p><p id="p0024" num="0024">The network element 101 comprises a control device 104 according to an exemplifying embodiment of the invention for controlling the clock signal generator 110. The control device 104 comprises a processing system configured to implement functional blocks 105, 106 and 107. The functional block 107 is configured to check whether pre-determined bits of a received data frame received at the ingress port 109 constitute a first bit pattern that occurs when the received data frame belongs to the first flow 130. The checking whether the pre-determined bits of the received data frame constitute the first bit pattern can be carried out, for example, using a mask that that is compared to the data frame so as to determine whether the data frame belongs to the first flow. If the first bit pattern occurs, the<!-- EPO <DP n="10"> --> reception moment of the received data frame is stored so that the stored reception moment is associated with the first flow. In the exemplifying embodiment of the invention illustrated in <figref idrefs="f0001">figure 1</figref>, the functional block 106 of the processing system is configured to identify overwriteable bits from the received data frame on the basis of stored frame structure information related to the first flow, and overwrite the reception moment of the received data frame to the identified overwriteable bits. Hence, the overwriteable bits are set to carry a reception time-stamp of the received data frame. The overwriteable bits are such bits of the received data frame which can be overwritten without disturbing operation of processes, e.g. control-and forwarding-plane processes, in which data frames belonging to the first flow 130 are involved. The above-mentioned frame structure information expresses the locations of the overwriteable bits within the received data frame.</p><p id="p0025" num="0025">The functional block 105 of the processing system is configured to form a control quantity 115 at least partly on the basis of stored reception moments of data frames belonging to the first flow 130. The functional block 105 is configured to control the clock signal generator 110 with the control quantity 115 so as to achieve synchronization between the first clock signal 111 and the second clock signal 121.</p><p id="p0026" num="0026">In a control device according to an exemplifying embodiment of the invention, the functional block 105 of the processing system is configured to form the control quantity 115 according to the formula: <maths id="math0001" num="(1)"><math display="block"><mi mathvariant="normal">C</mi><mo>×</mo><mfenced open="[" close="]" separators=""><mfenced separators=""><mi mathvariant="normal">T</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>-</mo><mi mathvariant="normal">T</mi><mo>⁢</mo><mn mathvariant="normal">1</mn></mfenced><mo>-</mo><mfenced separators=""><mi mathvariant="normal">T</mi><mo>⁢</mo><mn mathvariant="normal">4</mn><mo>-</mo><mi mathvariant="normal">T</mi><mo>⁢</mo><mn mathvariant="normal">3</mn></mfenced></mfenced><mo>,</mo></math><img id="ib0001" file="imgb0001.tif" wi="165" he="13" img-content="math" img-format="tif"/></maths><br/>
where T1 is a transmission moment of a data frame of the first flow 130 from the network element 102, T2 is a reception moment of the above-mentioned data frame of the first flow at the network element 101, T3 is a transmission moment of a data frame of the second flow 131 from the network element 101, T4 is a reception moment of the above-mentioned data frame of the second flow at the network element 102, and C is a constant. T1 and T4 can be expressed as time values indicated by the signal 123 that represents the clock time prevailing at the network element 102, and T2 and T3 can be expressed as time values indicated by the signal 113 that represents the clock time prevailing at the network element 101. In<!-- EPO <DP n="11"> --> this exemplifying embodiment of the invention, the control device 104 can be configured to provide time-synchronization between the network elements 101 and 102 so that the signals 113 and 123 representing the clock times are controlled to be close to each other. The principle is described below.</p><p id="p0027" num="0027">The time difference T2 - T1 in formula (1) includes two components which are the difference of the time values ΔT1 represented by the signals 123 and 113 at the transmission moment of the data frame of the first flow 130 and the transfer delay S1 of this data frame from the network element 102 to the network element 101. Therefore, T2 - T1 = ΔT1 + S1, where the transfer delay S1 is assumed to be indicated as a change of the signal 113. Correspondingly, the time difference T4 - T3 in formula (1) includes two components which are the difference of the time values ΔT2 represented by the signals 113 and 123 at the transmission moment of the data frame of the second flow 131 and the transfer delay S2 of this data frame from the network element 101 to the network element 102. Therefore, T4 - T3 = ΔT2 + S2, where the transfer delay S2 is assumed to be indicated as a change of the signal 123. In a case where the transfer delays S1 and S2 are mutually equal and the difference between the signals 113 and 123 does not change during the transfer of the data frame of the first flow 130 and the data frame of the second flow 131, we have S1 = S2 and ΔT2 = - ΔT1. In this case we get: <maths id="math0002" num="(2)"><math display="block"><mi mathvariant="normal">ΔT</mi><mo>⁢</mo><mn mathvariant="normal">1</mn><mo>=</mo><mfenced open="[" close="]" separators=""><mfenced separators=""><mi mathvariant="normal">T</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>-</mo><mi mathvariant="normal">T</mi><mo>⁢</mo><mn mathvariant="normal">1</mn></mfenced><mo>-</mo><mfenced separators=""><mi mathvariant="normal">T</mi><mo>⁢</mo><mn mathvariant="normal">4</mn><mo>-</mo><mi mathvariant="normal">T</mi><mo>⁢</mo><mn mathvariant="normal">3</mn></mfenced></mfenced><mo>/</mo><mn>2.</mn></math><img id="ib0002" file="imgb0002.tif" wi="165" he="9" img-content="math" img-format="tif"/></maths></p><p id="p0028" num="0028">Therefore, the difference of the time values represented by the signals 123 and 113 is [(T2 - T1) - (T4 - T3)] / 2. Thus, the result of formula (1) can be used as an input quantity of a regulator configured to control the clock signal generator 110. The regulator can be, for example, a proportional-integrative "PI" regulator, or a proportional-integrative-derivative "PID" regulator.</p><p id="p0029" num="0029">The time-synchronization presented in the specification 1588 issued by the Institute of Electrical and Electronics Engineers, "IEEE 1588", is based on the above-presented equation (2). It is to be, however, noted that the synchronization related to embodiments of the present invention is not necessarily time-synchronization of clock times prevailing at separate network elements. The synchronization can also<!-- EPO <DP n="12"> --> be frequency- or phase-synchronization of clock signals, such as the clock signals 111 and 121, prevailing at separate network elements.</p><p id="p0030" num="0030">In a control device according to an exemplifying embodiment of the invention, the functional block 105 of the processing system is configured to identify, from received data frames, bit patterns each of which being specific to a flow represented by data frames containing the bit pattern. Each identified bit pattern is capable of distinguishing data frames belonging to the corresponding flow from among all data frames of the aggregate flow received at the ingress port 109. The first bit pattern which has been mentioned earlier in this document is the particular one of the identified bit patterns which relates to the first flow 130. The functional block 105 is preferably configured to create, for each identified bit pattern, a mask with the aid of which it is fast and straightforward to determine whether relevant bits of an arbitrary data frame constitute the bit pattern under consideration. Each mask contains '1'-bits and/or '0'-bits and/or 'do not care'-bits. The masks are preferably delivered or otherwise made available to the functional block 107 so as to enable the functional block 107 to classify the received data frames by using the masks.</p><p id="p0031" num="0031">In a control device according to an exemplifying embodiment of the invention, the functional block 105 of the processing system is configured to identify from received data frames belonging to a given flow, e.g. the first flow 130, such bits which are, in each data frame of this flow, overwriteable without disturbing operation of processes, e.g. control- and forwarding-plane processes, in which the received data frames belonging to the this flow are involved. The functional block 105 is further configured to form, on the basis of the identification, flow-specific frame structure information which expresses the locations of the overwriteable bits within data frames belonging to the flow under consideration. The frame structure information is preferably delivered or otherwise made available to the functional block 106 so as to enable the functional block 106 to identify those bits of a received data frame which can be used for carrying the value of the reception moment, i.e. the reception time-stamp, of the received data frame.</p><p id="p0032" num="0032">The processing system which comprises the functional blocks 105-107 shown in <figref idrefs="f0001">figure 1</figref> can be implemented with one or more programmable processor circuits,<!-- EPO <DP n="13"> --> one or more dedicated hardware circuits such as an application specific integrated circuit "ASIC", one or more field programmable logic circuits such as a field programmable gate array "FPGA", or a combination of these.</p><p id="p0033" num="0033"><figref idrefs="f0002">Figure 2</figref> shows a schematic illustration of an exemplifying data transfer system that comprises a network element 201 and a network element 202. The network elements 201 and 202 are connected to each other via a data transfer network 203 that may comprise several other network elements interconnected to each other via data transfer links. The network element 201 comprises a controllable clock signal generator 210 arranged to generate a first clock signal 211. The network element 201 comprises a counter 212 arranged to generate a signal 213 that represents the clock time prevailing at the network element 201. The network element 201 comprises a processing system 214 for performing control- and forwarding-plane operations related to data transfer protocols being used. Furthermore, the network element 201 comprises at least one ingress port 209 and at least one egress port 208 for connecting to the data transfer network 203. The network element 202 comprises a clock signal generator 220 arranged to generate a second clock signal 221. The network element 202 comprises a counter 222 arranged to generate a signal 223 that represents the clock time prevailing at the network element 202. The network element 202 comprises a processing system 224 for performing control- and forwarding-plane operations related to the data transfer protocols being used. Furthermore, the network element 202 comprises at least one ingress port 229 and at least one egress port 228 for connecting to the data transfer network 203.</p><p id="p0034" num="0034">In the exemplifying situation shown in <figref idrefs="f0002">figure 2</figref>, the network element 202 transmits a first flow 230 to the network element 201. The first flow 230 is assumed to comprise data frames which represent timing messages with the aid of which the network element 201 synchronizes the operation of the clock signal generator 210 to the operation of the clock signal generator 220. These data frames of the first flow are transmitted in accordance with the second clock signal 221. The first flow 230 is a part of an aggregate flow constituted by the whole data traffic which is received at the ingress port 209. The network element 201 transmits a second flow<!-- EPO <DP n="14"> --> 231 to the network element 202. The second flow 231 is a part of the whole data traffic which is received at the ingress port 229.</p><p id="p0035" num="0035">The network element 201 comprises a control device 204 according to an exemplifying embodiment of the invention for controlling the clock signal generator 210. The control device 204 comprises a processing system configured to implement functional blocks 205, 206 and 207. The functional block 207 is configured to check whether pre-determined bits of a received data frame received at the ingress port 209 constitute a first bit pattern that occurs when the received data frame belongs to the first flow 230. If the first bit pattern occurs, the reception moment of the received data frame is stored so that the stored reception moment is logically associated with the first flow. In the exemplifying embodiment of the invention illustrated by <figref idrefs="f0002">figure 2</figref>, the functional block 206 of the processing system is configured to write the reception moment of the received data frame to a timing data item which is separate with respect to the received data frame and which is logically associated with the first flow. The timing data item is made available to the functional block 205 which is configured to form a control quantity 215 at least partly on the basis of stored reception moments of data frames belonging to the first flow 230. The functional block 205 is further configured to control the clock signal generator 210 with the control quantity 215 so as to achieve synchronization between the first clock signal 211 and the second clock signal 221. Timing data items containing values of reception moments related to successively received data frames of the first flow 230 can be stored in a memory according to the first-in-first-out "fifo" discipline so that the timing data items can be read out by the functional block 205 in the same temporal order in which the corresponding data frames have been received and are processed in the processing system 214. Therefore, in this exemplifying embodiment of the invention, there is formed a by-pass lane via which the values of the reception moments can by-pass the processing system 214. Thus, the values of the reception moments do not need to be written to the respective data frames and, as a corollary, there is no need to identify any overwriteable bits from the data frames.<!-- EPO <DP n="15"> --></p><p id="p0036" num="0036">The logical association between each timing data item indicating the reception moment of a data frame and a flow represented by the said data frame can be implemented in many ways. Few examples are given below.</p><p id="p0037" num="0037">In a control device according to an exemplifying embodiment of the invention, the functional block 206 is configured to provide each timing data item with a flow identifier which associates the timing data item with the corresponding flow. For example, each timing data item indicating the reception moment of a data frame belonging to the first flow 230 is provided with a flow identifier related to the first flow.</p><p id="p0038" num="0038">In a control device according to another exemplifying embodiment of the invention, the functional block 206 is configured to write each timing data item into a flow specific memory area that has been allocated for only such timing data items which relate to a same flow. For example, each timing data item indicating the reception moment of a data frame belonging to the first flow 230 is written into a memory area allocated for only such timing data items which relate to the first flow.</p><p id="p0039" num="0039">The functional block 206 can be further configured to provide each timing data item with a data frame identifier which associates the timing data item with the received data frame. In this case, there is no need to apply fifo or other disciplines when storing the timing data items in order to enable the functional block 205 to know which one of the received data frames corresponds to each timing data item. The data frame identifier may comprise for example: a sequence number of the received data frame, a result of a hash function directed to the received data frame, a copy of at least a part of the received data frame, and/or a copy of at least a part of control data of the received data frame.</p><p id="p0040" num="0040">It is to be noted that in some embodiments of the invention there is no need to enable the functional block 205 to know which one of the received data frames corresponds to each timing data item. For example, the first flow 230 may consist of data frames that are transmitted from the network element 202 so that the time interval between transmission moments of two successive data frames is constant, or follows a pre-determined temporal pattern, when being measured with the signal 223. In this case, the functional block 205 can be configured to control the<!-- EPO <DP n="16"> --> clock signal generator 210 so that time interval between reception moments of two successive data frames is constant, or follows the temporal pre-determined pattern, when being measured with the signal 213. In this case, there is no need to know which one of the received data frames corresponds to each timing data item, i.e. which one of the received data frames corresponds to each stored reception moment value.</p><p id="p0041" num="0041">The processing system which comprises the functional blocks 205-207 shown in <figref idrefs="f0002">figure 2</figref> can be implemented with one or more programmable processor circuits, one or more dedicated hardware circuits such as an application specific integrated circuit "ASIC", one or more field programmable logic circuits such as a field programmable gate array "FPGA", or a combination of these.</p><p id="p0042" num="0042"><figref idrefs="f0003">Figure 3</figref> shows a flow chart of a method according to an exemplifying embodiment of the invention for controlling a clock signal generator. The method comprises the following actions:
<ul><li>action 301: checking whether pre-determined bits of a received data frame of an aggregate flow constitute a first bit pattern, the first bit pattern occurring when the received data frame belongs to a first flow that is a part of the aggregate flow, and<br/>
in response to a situation in which the first bit pattern occurs, the following actions are carried out:</li><li>action 302: storing the reception moment of the received data frame so that the stored reception moment is associated with the first flow, the reception moment being a time value based on a first clock signal and the received data frame being transmitted in accordance with a second clock signal,</li><li>action 303: forming a control quantity at least partly on the basis of the stored reception moment of the received data frame, and</li><li>action 304: controlling the clock signal generator with the control quantity so as to achieve synchronization between the first clock signal and the second clock signal.</li></ul><!-- EPO <DP n="17"> --></p><p id="p0043" num="0043">In a method according to an exemplifying embodiment of the invention, the clock signal generator generates the first clock signal and the control of the clock signal generator comprises control of a frequency of the first clock signal.</p><p id="p0044" num="0044">In a method according to an exemplifying embodiment of the invention, the clock signal generator generates the second clock signal, the control of the clock signal generator comprises control of a frequency of the second clock signal, and information based on the reception moments of the data frames belonging to the first flow is transferred from a place of reception of the first flow to a place of transmission of the first flow.</p><p id="p0045" num="0045">A method according to an exemplifying embodiment of the invention comprises identifying overwriteable bits from the received data frame on the basis of stored frame structure information related to the first flow, and overwriting the reception moment of the received data frame to the identified overwriteable bits of the received data frame.</p><p id="p0046" num="0046">A method according to another exemplifying embodiment of the invention comprises writing the reception moment of the received data frame to a timing data item which is separate with respect to the received data frame and associated with the first flow. The timing data item can be provided with a flow identifier which associates the timing data item with the first flow, or the timing data item can be stored into a memory area allocated for only such timing data items which relate to the first flow. The timing data item can be provided with a data frame identifier which associates the timing data item with the received data frame. The data frame identifier may comprise for example: a sequence number of the received data frame, a result of a hash function directed to the received data frame, a copy of at least a part of the received data frame, and/or a copy of at least a part of control data of the received data frame.</p><p id="p0047" num="0047">A method according to an exemplifying embodiment of the invention comprises identifying, from received data frames of the aggregate flow, bit patterns each of which being specific to a flow represented by data frames containing the bit pattern and capable of distinguishing data frames belonging to this flow from among all data frames of the aggregate flow. The above-mentioned first bit pattern is the<!-- EPO <DP n="18"> --> particular one of the identified bit patterns which relates to the first flow of the aggregate flow.</p><p id="p0048" num="0048">A method according to an exemplifying embodiment of the invention comprises identifying from the received data frames belonging to the first flow such bits which are, in each data frame of the first flow, overwriteable without disturbing operation of processes in which the received data frames belonging to the first flow are involved. The method according to this exemplifying embodiment of the invention comprises forming, on the basis of the identification, the frame structure information which expresses the locations of the overwriteable bits within each received data frame belonging to the first flow.</p><p id="p0049" num="0049">A method according to an exemplifying embodiment of the invention comprises forming the control quantity according to the formula: <maths id="math0003" num=""><math display="block"><mi mathvariant="normal">C</mi><mo>×</mo><mfenced open="[" close="]" separators=""><mfenced separators=""><mi mathvariant="normal">T</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>-</mo><mi mathvariant="normal">T</mi><mo>⁢</mo><mn mathvariant="normal">1</mn></mfenced><mo>-</mo><mfenced separators=""><mi mathvariant="normal">T</mi><mo>⁢</mo><mn mathvariant="normal">4</mn><mo>-</mo><mi mathvariant="normal">T</mi><mo>⁢</mo><mn mathvariant="normal">3</mn></mfenced></mfenced><mo>,</mo></math><img id="ib0003" file="imgb0003.tif" wi="65" he="12" img-content="math" img-format="tif"/></maths><br/>
where T1 is a transmission moment of the received data frame expressed as a time value based on the second clock signal, T2 is the stored reception moment of the received data frame, T3 is a transmission moment of another data frame expressed as a time value based on the first clock signal, T2 is a reception moment of the other data frame expressed as a time value based on the second clock signal, and C is a constant, the other data frame being transmitted from a place of reception of the first flow and received at a place of transmission of the first flow.</p><p id="p0050" num="0050">A computer program according to an exemplifying embodiment of the invention comprises software modules for controlling a programmable processor to control a clock signal generator. The software modules comprise computer executable instructions for controlling the programmable processor to:
<ul><li>check whether pre-determined bits of a received data frame of an aggregate flow constitute a first bit pattern, the first bit pattern occurring when the received data frame belongs to a first flow that is a part of the aggregate flow,<!-- EPO <DP n="19"> --></li><li>in response to a situation in which the first bit pattern occurs, store the reception moment of the received data frame so that the stored reception moment is associated with the first flow, the reception moment being a time value based on a first clock signal and the received data frame being transmitted in accordance with a second clock signal,</li><li>form a control quantity at least partly on the basis of the stored reception moment of the received data frame, and</li><li>control the clock signal generator with the control quantity so as to achieve synchronization between the first clock signal and the second clock signal.</li></ul></p><p id="p0051" num="0051">The software modules can be, for example, subroutines and functions generated with a suitable programming language.</p><p id="p0052" num="0052">A computer program product according to an exemplifying embodiment of the invention comprises a non-volatile computer readable medium, e.g. a compact disc ("CD"), encoded with the above-mentioned software modules.</p><p id="p0053" num="0053">A signal according to an exemplifying embodiment of the invention is encoded to carry information defining a computer program according to an embodiment of the invention.</p><p id="p0054" num="0054">The specific examples provided in the description given above should not be construed as limiting the applicability and/or the interpretation of the appended claims.</p></description><claims mxw-id="PCLM56976236" lang="EN" load-source="patent-office"><!-- EPO <DP n="20"> --><claim id="c-en-0001" num="0001"><claim-text>A control device (104, 204) for controlling a clock signal generator, the control device comprising a processing system (105-107, 205-207) configured to:
<claim-text>- form a control quantity at least partly on the basis of stored reception moments of data frames belonging to a first flow that is a part of an aggregate flow, the reception moments being time values based on a first clock signal and the data frames belonging to the first flow being transmitted in accordance with a second clock signal, and</claim-text>
<claim-text>- control the clock signal generator with the control quantity so as to achieve synchronization between the first clock signal and the second clock signal,</claim-text>
<b>characterized in that</b> the processing system is further configured to:
<claim-text>- check whether pre-determined bits of a received data frame of the aggregate flow constitute a first bit pattern, the first bit pattern occurring when the received data frame belongs to the first flow, and</claim-text>
<claim-text>- in response to a situation in which the first bit pattern occurs, store the reception moment of the received data frame so that the stored reception moment is associated with the first flow.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>A control device according to claim 1, wherein the processing system is configured to identify overwriteable bits from the received data frame on the basis of stored frame structure information related to the first flow, and to write the reception moment of the received data frame to the identified overwriteable bits of the received data frame.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>A control device according to claim 1, wherein the processing system is configured to write the reception moment of the received data frame to a timing data item which is separate with respect to the received data frame and associated with the first flow.<!-- EPO <DP n="21"> --></claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>A control device according to claim 3, wherein the processing system is configured to provide the timing data item with a flow identifier which associates the timing data item with the first flow.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>A control device according to claim 3, wherein the processing system is configured to write the timing data item into a memory area allocated for only such timing data items which relate to the first flow.</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>A control device according to any of claims 3-5, wherein the processing system is configured to provide the timing data item with a data frame identifier which associates the timing data item with the received data frame.</claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>A control device according to claim 6, wherein the data frame identifier comprises at least one of the following: a sequence number of the received data frame, a result of a hash function directed to the received data frame, a copy of at least a part of the received data frame, a copy of at least a part of control data of the received data frame.</claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>A control device according to any of claims 1-7, wherein the processing system is configured to identify, from received data frames of the aggregate flow, bit patterns each of which being specific to a flow represented by data frames containing the bit pattern and capable of distinguishing data frames belonging to this flow from among all data frames of the aggregate flow, the first bit pattern being the one of the identified bit patterns which relates to the first flow of the aggregate flow.</claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>A control device according to claim 2 or 8, wherein the processing system is configured to identify from received data frames belonging to the first flow such bits which are, in each data frame of the first flow, overwriteable without disturbing operation of processes in which the received data frames belonging to the first flow are involved, and form the frame structure information on the basis of the identification.</claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>A control device according to any of claims 1-9, wherein the processing system is configured to form the control quantity according to the formula:<!-- EPO <DP n="22"> --> <maths id="math0004" num=""><math display="block"><mi mathvariant="normal">C</mi><mo>×</mo><mfenced open="[" close="]" separators=""><mfenced separators=""><mi mathvariant="normal">T</mi><mo>⁢</mo><mn mathvariant="normal">2</mn><mo>-</mo><mi mathvariant="normal">T</mi><mo>⁢</mo><mn mathvariant="normal">1</mn></mfenced><mo>-</mo><mfenced separators=""><mi mathvariant="normal">T</mi><mo>⁢</mo><mn mathvariant="normal">4</mn><mo>-</mo><mi mathvariant="normal">T</mi><mo>⁢</mo><mn mathvariant="normal">3</mn></mfenced></mfenced><mo>,</mo></math><img id="ib0004" file="imgb0004.tif" wi="56" he="11" img-content="math" img-format="tif"/></maths><br/>
where T1 is a transmission moment of the received data frame expressed as a time value based on the second clock signal, T2 is the stored reception moment of the received data frame, T3 is a transmission moment of another data frame expressed as a time value based on the first clock signal, T2 is a reception moment of the other data frame expressed as a time value based on the second clock signal, and C is a constant, the other data frame being transmitted from a place of reception of the first flow and received at a place of transmission of the first flow.</claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>A network element (101, 201) comprising:
<claim-text>- at least one ingress port (109, 209) for connecting to a data transfer network,</claim-text>
<claim-text>- a controllable clock signal generator (110, 210) for generating a first clock signal, and</claim-text>
<claim-text>- a control device (104, 204) according to any of claims 1-10 for controlling the clock signal generator.</claim-text></claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>A network element according to claims 11, wherein the network element is at least one of the following: an Internet Protocol ("IP") router, an Ethernet switch, a MuItiProtocol Label Switching ("MPLS") switch.</claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>A method for controlling a clock signal generator, the method comprising:
<claim-text>- forming (303) a control quantity at least partly on the basis of stored reception moments of data frames belonging to a first flow that is a part of an aggregate flow, the reception moments being time values based on a first clock signal and the data frames belonging to a first flow being transmitted in accordance with a second clock signal, and</claim-text>
<claim-text>- controlling (304) the clock signal generator with the control quantity so as to achieve synchronization between the first clock signal and the second clock signal,</claim-text><!-- EPO <DP n="23"> -->
<b>characterized in that</b> the method further comprises:
<claim-text>- checking (301) whether pre-determined bits of a received data frame of the aggregate flow constitute a first bit pattern, the first bit pattern occurring when the received data frame belongs to the first flow, and</claim-text>
<claim-text>- in response to a situation in which the first bit pattern occurs, storing (302) the reception moment of the received data frame so that the stored reception moment is associated with the first flow.</claim-text></claim-text></claim><claim id="c-en-0014" num="0014"><claim-text>A method according to claim 13, wherein the clock signal generator generates the first clock signal and the controlling (304) the clock signal generator comprises controlling a frequency of the first clock signal.</claim-text></claim><claim id="c-en-0015" num="0015"><claim-text>A computer program for controlling a clock signal generator, the computer program comprising computer executable instructions for controlling a programmable processor to:
<claim-text>- form a control quantity at least partly on the basis of stored reception moments of data frames belonging to a first flow that is a part of an aggregate flow, the reception moments being expressed as time values based on a first clock signal and the data frames belonging to a first flow being transmitted in accordance with a second clock signal, and</claim-text>
<claim-text>- control the clock signal generator with the control quantity so as to achieve synchronization between the first clock signal and the second clock signal,</claim-text>
<b>characterized in that</b> the computer program further comprises computer executable instructions for controlling a programmable processor to:
<claim-text>- check whether pre-determined bits of a received data frame of the aggregate flow constitute a first bit pattern, the first bit pattern occurring when the received data frame belongs to the first flow, and</claim-text>
<claim-text>- in response to a situation in which the first bit pattern occurs, store the reception moment of the received data frame so that the stored reception moment is associated with the first flow.</claim-text></claim-text></claim></claims><drawings mxw-id="PDW16667018" load-source="patent-office"><!-- EPO <DP n="24"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="160" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="25"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="164" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="26"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="165" he="220" img-content="drawing" img-format="tif"/></figure></drawings><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
