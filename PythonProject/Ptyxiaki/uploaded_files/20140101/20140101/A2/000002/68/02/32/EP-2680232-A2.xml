<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2680232-A2" country="EP" doc-number="2680232" kind="A2" date="20140101" family-id="48628580" file-reference-id="294237" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146549372" ucid="EP-2680232-A2"><document-id><country>EP</country><doc-number>2680232</doc-number><kind>A2</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-13173361-A" is-representative="NO"><document-id mxw-id="PAPP154823295" load-source="docdb" format="epo"><country>EP</country><doc-number>13173361</doc-number><kind>A</kind><date>20130624</date><lang>EN</lang></document-id><document-id mxw-id="PAPP220439688" load-source="docdb" format="original"><country>EP</country><doc-number>13173361.0</doc-number><date>20130624</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140446008" ucid="EP-12173469-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>12173469</doc-number><kind>A</kind><date>20120625</date></document-id></priority-claim><priority-claim mxw-id="PPC140450999" ucid="EP-13173361-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>13173361</doc-number><kind>A</kind><date>20130624</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL2100272908" load-source="docdb">G06T  17/20        20060101AFI20140716BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL2100275855" load-source="docdb">G06F   9/50        20060101ALI20140716BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL2100276274" load-source="docdb">G06T  17/00        20060101ALI20140716BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL2100276476" load-source="docdb">G06F   9/46        20060101ALI20140716BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL2100277288" load-source="docdb">G06F  17/50        20060101ALI20140716BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL2100277673" load-source="docdb">G06F   9/48        20060101ALI20140716BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1710182305" load-source="docdb" scheme="CPC">G06T2219/2008      20130101 LA20180106BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1710182306" load-source="docdb" scheme="CPC">G06T  19/20        20130101 LI20180106BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1710182307" load-source="docdb" scheme="CPC">G06T  17/20        20130101 LI20180106BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1710182308" load-source="docdb" scheme="CPC">G06T  17/005       20130101 LI20180106BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1710182309" load-source="docdb" scheme="CPC">G06F  17/5095      20130101 LI20180106BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1710182310" load-source="docdb" scheme="CPC">G06F  17/5018      20130101 LI20180106BHEP        </classification-cpc><classification-cpc mxw-id="PCL2007295656" load-source="docdb" scheme="CPC">G06F   9/4881      20130101 LI20140207BHEP        </classification-cpc><classification-cpc mxw-id="PCL2007295657" load-source="docdb" scheme="CPC">G06F  17/50        20130101 FI20140207BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132180600" lang="DE" load-source="patent-office">Entkoppeltes Parallelmaschenwerk in computergestütztem Design</invention-title><invention-title mxw-id="PT132180601" lang="EN" load-source="patent-office">Decoupled parallel meshing in computer aided design</invention-title><invention-title mxw-id="PT132180602" lang="FR" load-source="patent-office">Maillage parallèle découplé pour conception assistée par ordinateur</invention-title><citations><patent-citations><patcit mxw-id="PCIT242652346" load-source="docdb" ucid="US-20070011646-A1"><document-id format="epo"><country>US</country><doc-number>20070011646</doc-number><kind>A1</kind><date>20070111</date></document-id><sources><source name="APP" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242652347" load-source="docdb" ucid="US-20100134498-A1"><document-id format="epo"><country>US</country><doc-number>20100134498</doc-number><kind>A1</kind><date>20100603</date></document-id><sources><source name="APP" created-by-npl="N"/></sources></patcit></patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR918137642" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>FUJITSU LTD</last-name><address><country>JP</country></address></addressbook></applicant><applicant mxw-id="PPAR918142921" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>FUJITSU LIMITED</last-name></addressbook></applicant><applicant mxw-id="PPAR918985146" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>FUJITSU LIMITED</last-name><iid>100126510</iid><address><street>1-1, Kamikodanaka 4-chome, Nakahara-ku</street><city>Kawasaki-shi, Kanagawa 211-8588</city><country>JP</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918146052" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>GEORGESCU SERBAN</last-name><address><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR918156174" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>GEORGESCU, Serban</last-name></addressbook></inventor><inventor mxw-id="PPAR918981543" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>GEORGESCU, Serban</last-name><address><street>Flat 3 14 Grange Park</street><city>London, W5 3PL</city><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR918162668" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>CHOW PETER</last-name><address><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR918155847" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>CHOW, PETER</last-name></addressbook></inventor><inventor mxw-id="PPAR918980888" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>CHOW, PETER</last-name><address><street>101 Darland Avenue Darland</street><city>Gillingham, Kent ME7 3AH</city><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR918169833" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>SAKAIRI MAKOTO</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918150949" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>SAKAIRI, MAKOTO</last-name></addressbook></inventor><inventor mxw-id="PPAR918992921" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>SAKAIRI, MAKOTO</last-name><address><street>c/o Fujitsu Advanced Technologies Limied 1-1, Kamikodanaka 4-chome, Nakahara-ku,</street><city>Kawasaki-shi, Kanagawa 211-8588</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918149185" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>SAKAI HIDEHISA</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918164816" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>SAKAI, HIDEHISA</last-name></addressbook></inventor><inventor mxw-id="PPAR918985973" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>SAKAI, HIDEHISA</last-name><address><street>1-1, Kamikodanaka 4-chome, Nakahara-ku,</street><city>Kawasaki-shi, Kanagawa 211-8588</city><country>JP</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918993219" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Fenlon, Christine Lesley</last-name><iid>100029810</iid><address><street>Haseltine Lake LLP Lincoln House, 5th Floor 300 High Holborn</street><city>London WC1V 7JH</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS548840675" load-source="docdb">AL</country><country mxw-id="DS548863490" load-source="docdb">AT</country><country mxw-id="DS548804569" load-source="docdb">BE</country><country mxw-id="DS548857638" load-source="docdb">BG</country><country mxw-id="DS548803388" load-source="docdb">CH</country><country mxw-id="DS548804570" load-source="docdb">CY</country><country mxw-id="DS548860670" load-source="docdb">CZ</country><country mxw-id="DS548840677" load-source="docdb">DE</country><country mxw-id="DS548804571" load-source="docdb">DK</country><country mxw-id="DS548804572" load-source="docdb">EE</country><country mxw-id="DS548877348" load-source="docdb">ES</country><country mxw-id="DS548857639" load-source="docdb">FI</country><country mxw-id="DS548857640" load-source="docdb">FR</country><country mxw-id="DS548840678" load-source="docdb">GB</country><country mxw-id="DS548804573" load-source="docdb">GR</country><country mxw-id="DS548840679" load-source="docdb">HR</country><country mxw-id="DS548860671" load-source="docdb">HU</country><country mxw-id="DS548803389" load-source="docdb">IE</country><country mxw-id="DS548804574" load-source="docdb">IS</country><country mxw-id="DS548857641" load-source="docdb">IT</country><country mxw-id="DS548804575" load-source="docdb">LI</country><country mxw-id="DS548857642" load-source="docdb">LT</country><country mxw-id="DS548863491" load-source="docdb">LU</country><country mxw-id="DS548857643" load-source="docdb">LV</country><country mxw-id="DS548857644" load-source="docdb">MC</country><country mxw-id="DS548863492" load-source="docdb">MK</country><country mxw-id="DS548863493" load-source="docdb">MT</country><country mxw-id="DS548877349" load-source="docdb">NL</country><country mxw-id="DS548889485" load-source="docdb">NO</country><country mxw-id="DS548877350" load-source="docdb">PL</country><country mxw-id="DS548863494" load-source="docdb">PT</country><country mxw-id="DS548803394" load-source="docdb">RO</country><country mxw-id="DS548863495" load-source="docdb">RS</country><country mxw-id="DS548877351" load-source="docdb">SE</country><country mxw-id="DS548860672" load-source="docdb">SI</country><country mxw-id="DS548889486" load-source="docdb">SK</country><country mxw-id="DS548889487" load-source="docdb">SM</country><country mxw-id="DS548857645" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128670042" lang="EN" load-source="patent-office"><p id="pa01" num="0001">In a meshing method for use in a computer-aided design (CAD) or computer-aided engineering (CAE) system, in which one or more serial meshing units are used to carry out a decoupled parallel meshing process in respect of all parts of a CAD assembly model, input parameters for the meshing process automatically, for each part to be processed, are set using live runtime information about the meshing process for the part concerned, such as information about the outcome of previous attempts to carry out the meshing process of the part. In a scheduling method for managing the execution of tasks in a decoupled parallel meshing process, in which the execution of one or more tasks is dependent upon the execution result of at least one other task, and each task is scheduled for execution after the execution result of at least one of the tasks upon which it depends is known and processing resources for the task are available, execution of one or more tasks is prioritised over one or more other tasks in accordance with a prioritisation criterion, the prioritisation criterion being, depending on a characteristic of the task, either that, on the basis of information relating to one or more previous attempts to execute the task or similar tasks, the task is deemed to be more likely to succeed than other tasks to be executed, or that, on the basis of information relating to one or more previous attempts to execute the task or similar tasks, the task is deemed to be more likely to fail than other tasks to be executed.
<img id="iaf01" file="imgaf001.tif" wi="124" he="55" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128499415" lang="EN" source="EPO" load-source="docdb"><p>In a meshing method for use in a computer-aided design (CAD) or computer-aided engineering (CAE) system, in which one or more serial meshing units are used to carry out a decoupled parallel meshing process in respect of all parts of a CAD assembly model, input parameters for the meshing process automatically, for each part to be processed, are set using live runtime information about the meshing process for the part concerned, such as information about the outcome of previous attempts to carry out the meshing process of the part. In a scheduling method for managing the execution of tasks in a decoupled parallel meshing process, in which the execution of one or more tasks is dependent upon the execution result of at least one other task, and each task is scheduled for execution after the execution result of at least one of the tasks upon which it depends is known and processing resources for the task are available, execution of one or more tasks is prioritised over one or more other tasks in accordance with a prioritisation criterion, the prioritisation criterion being, depending on a characteristic of the task, either that, on the basis of information relating to one or more previous attempts to execute the task or similar tasks, the task is deemed to be more likely to succeed than other tasks to be executed, or that, on the basis of information relating to one or more previous attempts to execute the task or similar tasks, the task is deemed to be more likely to fail than other tasks to be executed.</p></abstract><description mxw-id="PDES63955472" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><p id="p0001" num="0001">The present invention relates to decoupled parallel meshing in computer-aided design (CAD), and in particular to methods, apparatus and programs for use at different stages of a decoupled parallel meshing process.</p><p id="p0002" num="0002">Computed Aided Engineering (CAE), the use of computer software for the purpose of modelling and simulating the behaviour of products in order to improve their quality, has become nearly ubiquitous in the manufacturing industry. Areas covered by CAE include, but are not limited to, stress and thermal analysis, fluid dynamics and kinematics.</p><p id="p0003" num="0003">As shown in <figref idrefs="f0001">Figure 1</figref> of the accompanying drawings, a typical CAE process starts with a Computer Aided Design (CAD) file which represents the geometrical model of the object that is analyzed (step 1). The CAD file, created using specialized CAD software, passes first through a stage at which boundary conditions are set (step 2) and then through a pre-processing step (step 3) where the geometry is partitioned (<i>meshed</i>) by a mesher into a very large number of <i>elements</i>, which form what is called a <i>mesh.</i> The mesh, accompanied by the boundary conditions, is then sent to a <i>solver</i> which uses standard numerical techniques, like the Finite Element Method, to compute the effect (e.g. deformation) of the boundary conditions on the object (step 4). Finally, the results are visualized in a post-processing step (step 5). Although the solver step used to be the most time consuming step of the analysis, with the improvement in processing power that has happened in the last few decades, the balance has shifted in the direction of the pre-processing operations, like CAD model preparation, the setting of boundary conditions and meshing. One of the main reasons for this shift is that, for complex CAD models, like the ones found in industry, a certain amount of user intervention is still required. As the processor performance is expected to follow this trend at least in the near future, pre-processing is set to become a bigger and bigger bottleneck in the analysis. Additionally, much less effort has hitherto been spent in automating and parallelizing these tasks than it was in the case of solvers. However, accelerating the pre-processing stage of the CAE process would be an important step towards achieving a faster and more efficient product development cycle and the development of better quality products.</p><p id="p0004" num="0004">Currently available meshers can be divided into two categories, <i>serial</i> and <i>parallel</i>.<!-- EPO <DP n="2"> --> Serial meshers are restricted to the computational power of only one processor and to the memory attached to it. With a mesh of the order of 1 million elements requiring in the order of 1GB of memory to create, it is clear that memory is a severe limitation for such codes. Moreover, with all modern processors having multiple cores, serial meshers are able to use less and less of the peak performance of the processor. However, most meshing software available today and, in particular, all those that are freely available (e.g. Netgen<sup>™</sup>, TetGen<sup>™</sup>, Gmsh<sup>™</sup>), fall into the serial mesher category.</p><p id="p0005" num="0005">Parallel meshers are able to create much larger meshes, and in a much shorter time, by distributing the workload to a number of processors found either in one computer or, more often, in a number of computers connected by a network. By the amount of communication performed between the processors while meshing, parallel mesh generators can be further divided into three categories: <i>tightly coupled, loosely coupled</i> and <i>decoupled</i>. From these three subcategories, only decoupled meshers (which require no communication or synchronization between different processing parts) can achieve 100% reuse of the serial meshing code. This is achieved by partitioning the domain that is to be meshed into a number of disjoint sub-domains, which are then independently meshed.</p><p id="p0006" num="0006">Two types of parallel-decoupled meshers have been proposed in the prior art. The first and most popular type, such as that disclosed in <patcit id="pcit0001" dnum="US2010134498A1"><text>US2010134498A1</text></patcit>, starts with a coarse two-dimensional (2D) surface mesh, created in serial. This initial mesh is partitioned into a number of sub-domains, with a three-dimensional (3D) volume mesh for each sub-domain being computed independently and in parallel on different nodes. The main drawback of this approach is that, for complex geometries, coarse meshes are in general more difficult to create than fine ones, since the small features of the geometry are more easily approximated by small elements rather than large ones. Hence, for complex geometries, the initial 2D mesh will need to be fine rather than coarse, which will become a major bottleneck of the algorithm. The second type, mentioned in <patcit id="pcit0002" dnum="US2007011646A1"><text>US2007011646A1</text></patcit>, works by starting with the partitioning of a single solid directly at the geometry level. However, this document describes the operation at an abstract level and does not give any way in which it can be actually implemented.</p><p id="p0007" num="0007">Another important issue which has not been addressed in any prior art so far is the fact that many CAD models which need to be meshed are not one single solid, but actually<!-- EPO <DP n="3"> --> an assembly of multiple solids, ranging from a few tens (e.g., for a mobile phone) to hundreds (e.g. for a laptop computer) and to thousands (e.g. for a complete server). High-end commercial CAE packages like ABAQUS/CAE<sup>™</sup> extract the parts from the assembly structure then mesh them, in sequence, as independent solids. As such, many opportunities for parallelism are lost. For example, the partitioning of the CAD model for one of the parts, a serial operation if considering that part in isolation, could be computed in parallel with the partitioning or meshing of other parts, which would reduce the overall time needed to mesh the assembly model.</p><p id="p0008" num="0008">Finally, most standard off-the-shelf meshers and in special free open-source ones, while able to generate high quality meshes, lack many automation features, in the sense that it is the user that must set certain key parameters, like the maximum element size. Meshing complex models is thus a time consuming trial-and-error process, with the user trying various values for the parameters (e.g. reducing the maximum element size) until the mesh is successfully obtained.</p><p id="p0009" num="0009">Accordingly it is desirable to provide a system that, in combination with an unmodified off-the-shelf serial meshing program and an unmodified off-the-shelf CAD kernel, can serve as a fast and scalable tool capable of meshing complex CAD models, like the ones used in industry, with relatively little or no user intervention.</p><p id="p0010" num="0010">According to an embodiment of a first aspect of the present invention there is provided a meshing method for use in a computer-aided design (CAD) or computer-aided engineering (CAE) system, in which one or more serial meshing units are used to carry out a decoupled parallel meshing process in respect of all parts of a CAD assembly model, characterised by setting input parameters for the meshing process automatically, for each part to be processed, using live runtime information about the meshing process for the part concerned.</p><p id="p0011" num="0011">The live runtime information preferably comprises information about the outcome of previous attempts to carry out the meshing process of the part.</p><p id="p0012" num="0012">Automatically setting the input parameters may comprise provisionally selecting the parameters for each part using live runtime information about the meshing process for the part concerned and subsequently, for each part for which there is a known dependency requirement between an input parameter for the part and an input<!-- EPO <DP n="4"> --> parameter for at least one other part of the assembly model, determining if a provisionally selected parameter for the part or a provisionally selected parameter for the at least one other part is inconsistent with the dependency requirement and, if so, adjusting the provisionally selected parameter for the part and/or the provisionally selected parameter for the at least one other part to meet the dependency requirement.</p><p id="p0013" num="0013">In such a method where a part of an assembly model is split into sections prior to undergoing a CAD meshing process, wherein a volume of each section obtained must not exceed a maximum permitted volume, the method may further comprise, if the volume of the part exceeds the maximum permitted volume, considering the part to be the first section and then carrying out the steps of: (a) determining the principal axis of inertia A of the section; (b) determining the centre of gravity of the section; (c) defining first and second solid boxes whose intersection is one face that passes through the centre of gravity and is perpendicular to A and whose union is the entire bounding box of the section; (d) performing a CAD Boolean operation of the section and the first box, and a CAD Boolean operation of the section and the second box, to obtain respective intermediate sections; and (e) if the volume of a section obtained in step (d) exceeds the maximum permitted volume, repeating steps (b) to (d) for each of the sections obtained in step (d) until final sections having volumes which do not exceed the maximum permitted volume are obtained.</p><p id="p0014" num="0014">In this case the method preferably comprises carrying out, after a part of a CAD assembly model has been split into a desired number DN of final sections, a modification process, for all final sections Si of a part, where i=2 to DN, which modification process comprises: setting C=Si and, for all sections Sj≠Si which have an interface with section Si, performing CAD Boolean operation F=Fuse(C, Sj) and CAD Boolean operation C=Common(F, Si), whereby opposing surfaces at interfaces between adjoining sections are modified so as to have identical geometry.</p><p id="p0015" num="0015">A method embodying the first aspect of the present invention may further comprise modifying a two dimensional (2D) mesh at a surface of a section obtained in a computer-aided design process in which an assembly model which is the subject of the CAD process has been separated into different parts each of which is split into sections which are then subjected to 2D meshing such that each surface of the section is defined by a set of 2D elements produced using a meshing method which generates the same one dimensional (1D) edge mesh at every surface, in which method the<!-- EPO <DP n="5"> --> modifying comprises for all sections for which the method has not already been carried out and which have an interface with another section: matching nodes of elements along edges of a surface of a section on one side of the interface with nodes of elements along edges of an opposing surface of a section on the other side of the interface; and replacing the elements on the surface on one side of the interface with the elements on the surface on the other side of the interface.</p><p id="p0016" num="0016">In a method in which a part of a CAD assembly model is split into a desired number DN of sections prior to undergoing a CAD meshing process, the method may further comprise the steps of: (a) determining (i) the number of split points Nx in an X direction, (ii) the number of split points Ny in a Y direction and (iii) the number of split points Nz in a Z direction, where the X, Y and Z directions are mutually parallel and (Nx+1)(Ny+1)(Nz+1)≥DN; (b) recursively bisecting the part in the X direction until (Nx+1) sections are obtained; (c) for all sections obtained in step (b), recursively bisecting the sections in the Y direction until (Nx+1)(Ny+1) sections are obtained; and (d) for all sections obtained in step (c), recursively bisecting the sections in the Z direction until (Nx+1)(Ny+1)(Nz+1) sections are obtained.</p><p id="p0017" num="0017">In this case the method may further comprise modifying a two dimensional (2D) mesh at a surface of a section obtained in a computer-aided design process in which an assembly model which is the subject of the CAD process has been separated into different parts each of which is split into sections which are then subjected to 2D meshing such that each surface of the section is defined by a set of 2D elements produced using a meshing method which generates the same one dimensional (1D) edge mesh at every surface, in which method the modifying comprises: allocating all the sections of the part to either a first set or a second set according to the location of the section in the part such that all the sections which have an interface with the sections in the first set are allocated to the second set; for each of the sections in the first set, matching nodes of elements along edges of a surface of a section in the first set with nodes of elements along edges of an opposing surface of a section in the second set; and replacing the elements on the surface of the first set section with the elements on the surface on the second set section.</p><p id="p0018" num="0018">According to an embodiment of a second aspect of the present invention there is provided meshing apparatus for use in a computer-aided design (CAD) or computer-aided engineering (CAE) system, which apparatus is configured to use one or more<!-- EPO <DP n="6"> --> serial meshing units to carry out a decoupled parallel meshing process in respect of all parts of a CAD assembly model, characterised by a meshing parameter setting unit configured to set input parameters for the meshing process automatically, for each part to be processed, the meshing parameter setting unit being operable to use live runtime information about the meshing process for the part concerned to determine one or more input parameters.</p><p id="p0019" num="0019">The live runtime information comprises information about the outcome of previous attempts to carry out the meshing process of the part.</p><p id="p0020" num="0020">Apparatus embodying the second aspect of the present invention may further comprise a CAD splitting module configured to split a part of an assembly model into sections prior to CAD meshing of the sections, such that a volume of each section obtained does not exceed a maximum permitted volume, the CAD splitting module being operable, if the volume of the first section exceeds the maximum permitted volume, to consider the part to be the first section and then to carry out the steps of: (a) determining the principal axis of inertia A of the section; (b) determining the centre of gravity of the section; (c) defining first and second solid boxes whose intersection is one face that passes through the centre of gravity and is perpendicular to A and whose union is the entire bounding box of the section; (d) performing a CAD Boolean operation of the section and the first box, and a CAD Boolean operation of the section and the second box, to obtain respective intermediate sections; and (e) if the volume of a section obtained in step (d) exceeds the maximum permitted volume, repeating steps (b) to (d) for each of the sections obtained in step (d) until final sections having volumes which do not exceed the maximum permitted volume are obtained.</p><p id="p0021" num="0021">In such apparatus the CAD splitting module may be operable, after a part of a CAD assembly model has been split into a desired number DN of final sections, to carry out a modification process, for all final sections Si of a part, where i=2 to DN, comprising setting C=Si and, for all sections Sj≠Si which have an interface with section Si, performing CAD Boolean operation F=Fuse(C, Sj) and CAD Boolean operation C=Common(F, Si), whereby opposing surfaces at interfaces between adjoining sections are modified so as to have identical geometry.</p><p id="p0022" num="0022">Apparatus embodying the second aspect of the present invention may further comprise a mesh modification module configured to modify a two dimensional (2D) mesh at a<!-- EPO <DP n="7"> --> surface of a section obtained in a computer-aided design process, where an assembly model which is the subject of the CAD process has been separated into different parts each of which is split into sections which are then subjected to 2D meshing such that each surface of the section is defined by a set of 2D elements produced using a meshing method which generates the same one dimensional (1D) edge mesh at every surface, the module being operable to carry out a method, for all sections for which the method has not already been carried out and which have an interface with another section, in which nodes of elements along edges of a surface of a section on one side of the interface are matched with nodes of elements along edges of an opposing surface of a section on the other side of the interface, and the elements on the surface on one side of the interface are replaced with the elements on the surface on the other side of the interface.</p><p id="p0023" num="0023">Apparatus embodying the second aspect of the present invention may further comprise a CAD splitting module configured to split a part of an assembly model into a desired number DN of sections prior to meshing of the sections, which module is operable to carry out the steps of: (a) determining (i) the number of split points Nx in an X direction, (ii) the number of split points Ny in a Y direction and (iii) the number of split points Nz in a Z direction, where the X, Y and Z directions are mutually parallel and (Nx+1)(Ny+1)(Nz+1)≥DN; (b) recursively bisecting the part in the X direction until (Nx+1) sections are obtained; (c) for all sections obtained in step (b), recursively bisecting the sections in the Y direction until (Nx+1)(Ny+1) sections are obtained; and (d) for all sections obtained in step (c), recursively bisecting the sections in the Z direction until (Nx+1)(Ny+1)(Nz+1) sections are obtained.</p><p id="p0024" num="0024">Such apparatus may further comprise a mesh modification module configured to modify a two dimensional (2D) mesh at a surface of a section obtained in a computer-aided design process, where an assembly model which is the subject of the CAD process has been separated into different parts each of which is split into sections which are then subjected to 2D meshing such that each surface of the section is defined by a set of 2D elements produced using a meshing method which generates the same one dimensional (1D) edge mesh at every surface, the module being operable to carry out a method in which: all the sections of the part are allocated to either a first set or a second set according to the location of the section in the part such that all the sections which have an interface with the sections in the first set are allocated to the second set; for each of the sections in the first set, nodes of elements<!-- EPO <DP n="8"> --> along edges of a surface of a section in the first set are matched with nodes of elements along edges of an opposing surface of a section in the second set; and the elements on the surface of the first set section are replaced with the elements on the surface on the second set section.</p><p id="p0025" num="0025">According to an embodiment of a third aspect of the present invention there is provided a scheduling method for managing the execution of tasks in a decoupled parallel meshing process, in which the execution of one or more tasks may be dependent upon the execution result of at least one other task, and each task is scheduled for execution after the execution result of at least one of the tasks upon which it depends is known and processing resources for the task are available, wherein execution of one or more tasks is prioritised over one or more other tasks in accordance with a prioritisation criterion, the prioritisation criterion being, depending on a characteristic of the task, either that, on the basis of information relating to one or more previous attempts to execute the task or similar tasks, the task is deemed to be more likely to succeed than other tasks to be executed, or that, on the basis of information relating to one or more previous attempts to execute the task or similar tasks, the task is deemed to be more likely to fail than other tasks to be executed.</p><p id="p0026" num="0026">According to an embodiment of a fourth aspect of the present invention there is provided scheduling apparatus configured to manage the execution of tasks in a decoupled parallel meshing process, in which the execution of one or more tasks may be dependent upon the execution result of at least one other task, and each task is scheduled for execution after the execution result of at least one of the tasks upon which it depends is known and processing resources for the task are available, which apparatus is operable to prioritise execution of one or more tasks over one or more other tasks in accordance with a prioritisation criterion, the prioritisation criterion being, depending on a characteristic of the task, either that, on the basis of information relating to one or more previous attempts to execute the task or similar tasks, the task is deemed to be more likely to succeed than other tasks to be executed, or that, on the basis of information relating to one or more previous attempts to execute the task or similar tasks, the task is deemed to be more likely to fail than other tasks to be executed.</p><p id="p0027" num="0027">According to an embodiment of a fifth aspect of the present invention there is provided a recursive bisection method for use in computer-aided design (CAD), in which method<!-- EPO <DP n="9"> --> a part of an assembly model is split into sections prior to undergoing a CAD meshing process, wherein a volume of each section obtained must not exceed a maximum permitted volume, <b>characterised in that</b> the method comprises, if the volume of the first section exceeds the maximum permitted volume, considering the part to be the first section and then carrying out the steps of: (a) determining the principal axis of inertia A of the section; (b) determining the centre of gravity of the section; (c) defining first and second solid boxes whose intersection is one face that passes through the centre of gravity and is perpendicular to A and whose union is the entire bounding box of the section; (d) performing a CAD Boolean operation of the section and the first box, and a CAD Boolean operation of the section and the second box, to obtain respective intermediate sections; and (e) if the volume of a section obtained in step (d) exceeds the maximum permitted volume, repeating steps (b) to (d) for each of the sections obtained in step (d) until final sections having volumes which do not exceed the maximum permitted volume are obtained.</p><p id="p0028" num="0028">According to an embodiment of a sixth aspect of the present invention there is provided apparatus for use in a computer-aided design (CAD) system, in which a recursive bisection method is used to split a part of an assembly model into sections prior to undergoing a CAD meshing process, such that a volume of each section obtained must not exceed a maximum permitted volume, wherein the apparatus is operable, if the volume of the first section exceeds the maximum permitted volume, to consider the part to be first section and to carry out the steps of: (a) determining the principal axis of inertia A of the section; (b) determining the centre of gravity of the section; (c) defining first and second solid boxes whose intersection is one face that passes through the centre of gravity and is perpendicular to A and whose union is the entire bounding box of the section; (d) performing a CAD Boolean operation of the section and the first box, and a CAD Boolean operation of the section and the second box, to obtain respective intermediate sections; and (e) if the volume of a section obtained in step (d) exceeds the maximum permitted volume, repeating steps (b) to (d) for each of the sections obtained in step (d) until final sections having volumes which do not exceed the maximum permitted volume are obtained.</p><p id="p0029" num="0029">According to an embodiment of a seventh aspect of the present invention there is provided a method for use in a computer-aided design (CAD) system, after a part of a CAD assembly model has been split into a desired number DN of final sections using a recursive bisection method, the method comprising carrying out, for all final sections Si<!-- EPO <DP n="10"> --> of a part, where i=2 to DN: setting C=Si and, for all sections Sj≠Si which have an interface with section Si, performing CAD Boolean operation F=Fuse(C, Sj) and CAD Boolean operation C=Common(F, Si), whereby opposing surfaces at interfaces between adjoining sections are modified so as to have identical geometry.</p><p id="p0030" num="0030">According to an embodiment of an eighth aspect of the present invention there is provided apparatus for use in a computer-aided design (CAD) system, which module is characterised by being operable, after a part of a CAD assembly model has been split into a desired number DN of final sections using a recursive bisection method, to carry out a modification process, for all final sections Si of a part, where i=2 to DN, comprising: setting C=Si and, for all sections Sj≠Si which have an interface with section Si, performing CAD Boolean operation F=Fuse(C, Sj) and CAD Boolean operation C=Common(F, Si), whereby opposing surfaces at interfaces between adjoining sections are modified so as to have identical geometry.</p><p id="p0031" num="0031">According to an embodiment of a ninth aspect of the present invention there is provided a method of modifying a two dimensional (2D) mesh at a surface of a section obtained in a computer-aided design (CAD) process, where an assembly model which is the subject of the CAD process has been separated into different parts each of which is split into sections which are then subjected to 2D meshing such that each surface of the section is defined by a set of 2D elements produced using a meshing method which generates the same one dimensional (1D) edge mesh at every surface, the method being characterised by: for all sections for which the method has not already been carried out and which have an interface with another section: matching nodes of elements along edges of a surface of a section on one side of the interface with nodes of elements along edges of an opposing surface of a section on the other side of the interface; and replacing the elements on the surface on one side of the interface with the elements on the surface on the other side of the interface.</p><p id="p0032" num="0032">According to an embodiment of a tenth aspect of the present invention there is provided apparatus for modifying a two dimensional (2D) mesh at a surface of a section obtained in a computer-aided design (CAD) process, where an assembly model which is the subject of the CAD process has been separated into different parts each of which is split into sections which are then subjected to 2D meshing such that each surface of the section is defined by a set of 2D elements produced using a meshing method which generates the same one dimensional (1D) edge mesh at every surface,<!-- EPO <DP n="11"> --> <b>characterised in that</b> the apparatus is operable to perform a method, for all sections for which the method has not already been carried out and which have an interface with another section, in which: nodes of elements along edges of a surface of a section on one side of the interface are matched with nodes of elements along edges of an opposing surface of a section on the other side of the interface; and the elements on the surface on one side of the interface are replaced with the elements on the surface on the other side of the interface.</p><p id="p0033" num="0033">According to an embodiment of an eleventh aspect of the present invention there is provided a recursive bisection method for use in a computer-aided design (CAD) process, in which method a part of a CAD assembly model is split into a desired number DN of sections prior to undergoing a CAD meshing process, characterised by the steps of: (a) determining (i) the number of split points Nx in an X direction, (ii) the number of split points Ny in a Y direction and (iii) the number of split points Nz in a Z direction, where the X, Y and Z directions are mutually parallel and (Nx+1)(Ny+1)(Nz+1)≥DN; (b) recursively bisecting the part in the X direction until (Nx+1) sections are obtained; (c) for all sections obtained in step (b), recursively bisecting the sections in the Y direction until (Nx+1)(Ny+1) sections are obtained; and (d) for all sections obtained in step (c), recursively bisecting the sections in the Z direction until (Nx+1)(Ny+1)(Nz+1) sections are obtained.</p><p id="p0034" num="0034">According to an embodiment of a twelfth aspect of the present invention there is provided apparatus for use in a computer-aided design (CAD) process, in which a recursive bisection method is used to split a part of a CAD assembly model into a desired number DN of sections prior to undergoing a CAD meshing process, wherein the apparatus is operable to perform the steps of: (a) determining (i) the number of split points Nx in an X direction, (ii) the number of split points Ny in a Y direction and (iii) the number of split points Nz in a Z direction, where the X, Y and Z directions are mutually parallel and (Nx+1)(Ny+1)(Nz+1)≥DN; (b) recursively bisecting the part in the X direction until (Nx+1) sections are obtained; (c) for all sections obtained in step (b), recursively bisecting the sections in the Y direction until (Nx+1)(Ny+1) sections are obtained; and (d) for all sections obtained in step (c), recursively bisecting the sections in the Z direction until (Nx+1)(Ny+1)(Nz+1) sections are obtained.</p><p id="p0035" num="0035">According to an embodiment of a thirteenth aspect of the present invention there is provided a method of modifying a two dimensional (2D) mesh at a surface of a section<!-- EPO <DP n="12"> --> obtained in a computer-aided design (CAD) process, where an assembly model which is the subject of the CAD process has been separated into different parts each of which is split into sections which are then subjected to 2D meshing such that each surface of the section is defined by a set of 2D elements produced using a meshing method which generates the same one dimensional (1D) edge mesh at every surface, the method being characterised by: allocating all the sections of the part to either a first set or a second set according to the location of the section in the part such that all the sections which have an interface with the sections in the first set are allocated to the second set; for each of the sections in the first set, matching nodes of elements along edges of a surface of a section in the first set with nodes of elements along edges of an opposing surface of a section in the second set; and replacing the elements on the surface of the first set section with the elements on the surface on the second set section.</p><p id="p0036" num="0036">According to an embodiment of a fourteenth aspect of the present invention there is provided apparatus for modifying a two dimensional (2D) mesh at a surface of a section obtained in a computer-aided design (CAD) process, where an assembly model which is the subject of the CAD process has been separated into different parts each of which is split into sections which are then subjected to 2D meshing such that each surface of the section is defined by a set of 2D elements produced using a meshing method which generates the same one dimensional (1D) edge mesh at every surface, <b>characterised in that</b> the apparatus is operable to: allocate all the sections of the part to either a first set or a second set according to the location of the section in the part such that all the sections which have an interface with the sections in the first set are allocated to the second set; for each of the sections in the first set, match nodes of elements along edges of a surface of a section in the first set with nodes of elements along edges of an opposing surface of a section in the second set; and replace the elements on the surface of the first set section with the elements on the surface on the second set section.</p><p id="p0037" num="0037">According to a fifteenth aspect of the present invention, there is provided a computer-readable medium carrying instructions which, when carried out on a computer, cause that computer to carry out a method embodying the first, third, fifth, seventh, ninth, eleventh or thirteenth aspect of the present invention or to become apparatus embodying the second, fourth, sixth, eighth, tenth, twelfth or fourteenth aspect of the present invention.<!-- EPO <DP n="13"> --></p><p id="p0038" num="0038">As compared to the technology described in <patcit id="pcit0003" dnum="US2007011646A1"><text>US2007011646A1</text></patcit>, which consists of a way of achieving parallel meshing based on the domain decomposition approach, aspects of the present invention provide a feasible implementation of the decoupled domain decomposition method based on CAD operations (which in <patcit id="pcit0004" dnum="US2007011646A1"><text>US2007011646A1</text></patcit> is only described at an abstract level), extension to assembly models and the added level of parallelism resulting from dealing with such models, and automation for finding the best meshing parameters.</p><p id="p0039" num="0039">As compared to the parallelization approach applied in all parallel meshers presently available on the market, which are the same as or similar to that described in <patcit id="pcit0005" dnum="US2010134498A1"><text>US2010134498A1</text></patcit>, in aspects of the present invention the domain decomposition starts directly from the CAD and not from an initial coarse 2D surface mesh of the model. Starting from a 2D mesh is not scalable for complex CAD models such as the ones found in industry because of the difficulty in creating the initial 2D mesh. The approach offered by aspects of the present invention offers a much better scalability. Moreover, aspects of the present invention can allow an extension to assembly models and the added level of parallelism resulting from dealing with such models, while the prior art, although able to support assembly models, only deals with one single solid at a time</p><p id="p0040" num="0040">The applicant is not aware of any free mesher available in the public domain which is parallel and which has automation features. By combining an embodiment of the present invention with such a free mesher (e.g. Gmsh<sup>™</sup>, Netgen<sup>™</sup>) and a free CAD Engine (e.g. Open Cascade<sup>™</sup>), it is possible to obtain a low-cost system with the following added advantages:
<ul><li>Support for meshing assembly models, which are not supported by such meshers</li><li>Automation, for example the automatic setting of meshing parameters such as the maximum element size</li><li>Faster meshing time, since more processing units are used at the same time</li><li>Lower memory usage, since large CAD models are first split into smaller sections that require much less memory to mesh. This allows very large meshes (e.g. hundreds of millions of elements or even more) to be created on machines with limited resources (e.g. desktop computers and even laptops)</li></ul></p><p id="p0041" num="0041">Moreover, as compared to commercial meshers, an embodiment of the present invention can provide the following advantages:<!-- EPO <DP n="14"> -->
<ul><li>More efficient meshing of assembly models, since a system embodying the present invention is able to mix and overlap the execution of the meshing operations for the whole assembly model, which is much more efficient than meshing each part in isolation as it is done by current technology</li><li>Reduced cost since much of the functionality of complex commercial meshers can be obtained using free components</li><li>Increased scalability, owing to use of the CAD-based domain decomposition proposed in the embodiment (as described above, current technologies start with creating a coarse 2D mesh which, for complex models as the one found in industry, quickly becomes a bottleneck)</li><li>Lower memory usage, since large CAD models are first split into smaller sections that require much less memory to mesh. This allows very large meshes (e.g. hundreds of millions of elements or even more) to be created on machines with limited resources (e.g. desktop computers and even laptops)</li></ul></p><p id="p0042" num="0042">Reference will now be made, by way of example, to the accompanying drawings in which:
<ul><li><figref idrefs="f0001">Figure 1</figref> (described above) is a flowchart of a CAE process;</li><li><figref idrefs="f0001">Figure 2</figref> illustrates an example of an assembly model;</li><li><figref idrefs="f0002">Figure 3</figref> illustrates a CAD split operation;</li><li><figref idrefs="f0002">Figure 4</figref> illustrates a 2D meshing operation;</li><li><figref idrefs="f0002">Figure 5</figref> illustrates a 3D meshing operation;</li><li><figref idrefs="f0003">Figure 6</figref> illustrates a mesh merging operation;</li><li><figref idrefs="f0003">Figure 7</figref> illustrates a mesh assembly operation;</li><li><figref idrefs="f0004">Figure 8</figref> is a flowchart showing where a meshing method embodying the present invention can be used in a CAD system;</li><li><figref idrefs="f0004">Figure 9</figref> is a flowchart of a meshing method embodying the present invention;</li><li><figref idrefs="f0005">Figure 10</figref> illustrates a CAD Disassemble module;</li><li><figref idrefs="f0005">Figure 11A</figref> illustrates a Mesh Parameter Setting module, and <figref idrefs="f0006">Figures 11B to 11F</figref> illustrate meshing operations;</li><li><figref idrefs="f0007">Figure 12</figref> illustrates a CAD Split module;</li><li><figref idrefs="f0007">Figure 13</figref> illustrates a CAD splitting operation carried using a recursive bisection technique;</li><li><figref idrefs="f0008">Figure 14</figref> illustrates a face modification technique;</li><li><figref idrefs="f0008">Figure 15</figref> illustrates another CAD splitting operation carried out using an alternative recursive bisection technique;<!-- EPO <DP n="15"> --></li><li><figref idrefs="f0009">Figure 16</figref> illustrates a 2D Meshing module;</li><li><figref idrefs="f0009">Figure 17</figref> illustrates sections obtained using a CAD splitting operation;</li><li><figref idrefs="f0010">Figure 18</figref> illustrates a 2D Mesh Modification module;</li><li><figref idrefs="f0010">Figure 19</figref> illustrates a 3D Meshing module;</li><li><figref idrefs="f0011">Figure 20</figref> illustrates a 3D mesh merging operation; and</li><li><figref idrefs="f0011">Figure 21</figref> illustrates a Parallel Task Scheduling module.</li></ul></p><p id="p0043" num="0043">Before describing an embodiment which brings together the different aspects of the present invention, the terms used in the present application will now be defined.</p><heading id="h0001"><b>Assembly model</b></heading><p id="p0044" num="0044">An <i>assembly model</i> is a CAD model consisting of multiple solids, which may or may not be in physical contact with each other. A simple assembly model consisting of seven parts, labelled Parts#1 to #7, is shown in <figref idrefs="f0001">Figure 2</figref>. Real-world assembly models used in industry, which this invention targets, can have hundreds or thousands of parts, of different shapes and sizes. Throughout the present application, the term <i>part</i> will have the meaning of a single solid component of an assembly model. For the sake of consistency, if the input CAD file consists of a single solid, we will refer to it as an assembly with one part.</p><heading id="h0002"><b>CAD Splitting (cutting, partitioning)</b></heading><p id="p0045" num="0045">In the present application <i>CAD splitting</i> is defined as the operation of splitting/cutting/partitioning a solid into a number of <i>sections.</i> For example, in <figref idrefs="f0002">Figure 3</figref>, Part #4 of the assembly model is split into 6 sections (thus 6 individual solids).</p><heading id="h0003"><b>2D Meshing</b></heading><p id="p0046" num="0046">A <i>2D meshing</i> operation is the discretization of the faces of a solid by 2D elements such as triangles or quadrilaterials. As an example, <figref idrefs="f0002">Figure 4</figref> shows a 2D triangular mesh of one of the sections of Part #4.</p><heading id="h0004"><b>3D Meshing</b></heading><p id="p0047" num="0047">A <i>3D meshing</i> operation is the discretization of the entire volume of a solid by 3D elements such as tetrahedrals or hexahedrals. As an example, <figref idrefs="f0002">Figure 5</figref> shows a 3D mesh of one of the sections of Part #4 shown in <figref idrefs="f0002">Figure 4</figref>.<!-- EPO <DP n="16"> --></p><heading id="h0005"><b>Mesh merge operation</b></heading><p id="p0048" num="0048">A <i>mesh merge</i> operation is the combining of the 3D meshes of the individual sections of a part into one coherent 3D mesh for that part. A coherent mesh is defined as one single connected mesh, without duplicate nodes on the interfaces between sections. As an example, <figref idrefs="f0003">Figure 6</figref> shows how the 3D mesh for Part #4 is built by merging the 3D meshes of the 6 individual sections the part was previously split into (as shown in <figref idrefs="f0002">Figure 3</figref>).</p><heading id="h0006"><b>Mesh assembly</b></heading><p id="p0049" num="0049">A <i>mesh assembly</i> operation is the putting together of the meshes for one or more individual parts into one single mesh for the assembly model. The difference between mesh assembly and mesh merging is that an assembled mesh does not become one single connected mesh. In other words, even if the meshes of two parts are in physical contact, the interface will contain two sets of nodes and elements, one set for each mesh. More formally, there is no element in the assembled mesh which has nodes belonging to the meshes of more than one part. As an example, <figref idrefs="f0003">Figure 7</figref> shows how the meshes for the 7 parts of the assembly model are assembled into the final mesh.</p><p id="p0050" num="0050"><figref idrefs="f0004">Figure 8</figref> shows where a meshing method embodying the present invention can be utilized in a CAD system, and the flowchart of <figref idrefs="f0004">Figure 9</figref> shows how a meshing method embodying the present invention can be regarded as being built from one or more individual processes or modules 1 to 8, depicted in <figref idrefs="f0004">Figure 9</figref> as rectangular blocks. These modules, which are described later, are used in sequence, starting with the reading of the CAD file that is to be meshed and ending, in the case the meshing is successful, with a 3D mesh of the CAD file.</p><p id="p0051" num="0051">Module 1 is a CAD Disassemble module, module 2 is a Mesh Parameter Setting module, module 3 is a CAD Split module, module 4 is a 2D Meshing module, module 5 is a 2D Mesh Modification module, module 6 is a 3D Meshing module, module 7 is a 3D Mesh Merging module, and module 8 is a Mesh Assemble module.</p><p id="p0052" num="0052">Module 1 (CAD Disassemble) and module 8 (Mesh Assemble) each consist of one large operation, namely disassembling the initial CAD file into individual components and assembling the final mesh from individual parts, respectively. On the other hand, the other modules consist of a possibly large number of individual operations. From<!-- EPO <DP n="17"> --> these, modules 2 (Mesh Parameter Setting), 3 (CAD Split), 5 (2D Mesh Modification) and 7 (3D Mesh Merging) result in as many tasks as parts to be meshed. Modules 4 (2D Meshing) and 6 (3D Meshing) can potentially allow the opportunity for a much higher degree of parallelism, since each part that needs to be meshed can be further split (partitioned) into a number of sections.</p><p id="p0053" num="0053">All tasks that need to be executed are queued in a parallel task scheduler (module 9 in <figref idrefs="f0004">Figure 9</figref>) which executes them following the chain of dependencies associated with the tasks. For example, a 2D meshing operation for all sections of one part is dependent only on the successful completion of the previous CAD split operation for that part. In other words, as soon as the CAD split operation has finished for one part, the 2D meshing of all resulting sections can begin. In the same way, if the 2D meshing of one section of a part fails, the 2D meshing of all other parts will be aborted and the process will be restarted from module 2, where new meshing parameters will be automatically set.</p><p id="p0054" num="0054">For traditional parallel meshers, which start with one solid and mesh one solid (thus one part) at a time, modules 3, 6 and 7 are performed serially and hence become a bottleneck. On the other hand, in an embodiment of the present invention, which starts with an entire assembly model, these steps are executed in parallel with other operations. Moreover, there is a very high probability that the input/output (I/O) intensive operations involved in modules 6 and 7, which do not scale well with the number of cores, are overlapped with compute intensive operations like 2D and 3D meshing (modules 4 and 6), hence making more efficient use of the computing environment.</p><p id="p0055" num="0055">The modules 1 to 9 will now be described in more detail with reference to <figref idrefs="f0005 f0006 f0007 f0008 f0009 f0010 f0011 f0012">Figures 10 to 22</figref>.</p><heading id="h0007"><b>CAD Disassemble module</b></heading><p id="p0056" num="0056">The CAD Disassemble module 1, shown in <figref idrefs="f0005">Figure 10</figref>, takes as input one assembly CAD file and outputs the following:
<ul><li>A folder with the individual parts of the assembly, one CAD file per part<!-- EPO <DP n="18"> --></li><li>One file containing the assembly tree, for later reference. The assembly tree contains information about how individual parts are organized in the assembly hierarchy.</li><li>One file containing high level geometrical information about each part. For each part, such information might be the size of the bounding box, total surface or total volume. This information will be used later to decide meshing parameters like the maximum element size and are extracted at this stage to avoid re-loading the geometry later.</li></ul></p><p id="p0057" num="0057">This module is capable of reading/writing CAD files and extracting additional information like total surface and total volume via a CAD Engine. Examples of such CAD engines are Open Cascade<sup>™</sup> (free and open source) and ACIS<sup>™</sup> (commercial).</p><p id="p0058" num="0058">Functions from the CAD engine are used to read the initial CAD file and the assembly tree structure. The tree is then traversed from the root to the leaves and all individual components are written as separate files in the destination folder, again using specialized functions from the CAD engine. After writing each part, additional information like bounding box size, total surface and total volume are computed using functions from the CAD engine and written to the "part information file". At the same time, the structure of the assembly tree is written to the "assembly tree file".</p><heading id="h0008"><b>Mesh Parameter Setting module</b></heading><p id="p0059" num="0059">The Mesh Parameter Setting module 2, shown in <figref idrefs="f0005">Figure 11A</figref>, is responsible for setting input parameters for the meshing operation. Examples of such parameters are the type of element, the order of the elements, maximum element size, 2D and 3D meshing algorithms, whether to use optimization, and so on.</p><p id="p0060" num="0060">A meshing method embodying the present invention, for use in a CAD system, in which one or more serial meshing units are used to carry out a decoupled parallel meshing process in respect of all parts of a CAD assembly model, comprises setting input parameters for the meshing process automatically, for each part to be processed, using live runtime information about the meshing process for the part concerned.</p><p id="p0061" num="0061">According to an embodiment of this aspect of the invention meshing parameters are automatically set as a function of default settings, the geometrical properties of the object to be meshed and dynamical runtime information.<!-- EPO <DP n="19"> --></p><p id="p0062" num="0062">That is, meshing parameters are decided independently for each part to be meshed and are provisionally selected using information from three sources:
<ul><li>The mesher configuration file. This contains meshing parameters that remain unchanged throughout the meshing process, like the type of elements to use (e.g. tetrahedral or hexahedral) and their order (e.g. 1<sup>st</sup> order or 2<sup>nd</sup> order)</li><li>The part information file. This file, generated by the CAD Disassemble module, provides geometrical information on the part that is to be meshed, like the size of the bounding box or the total volume</li><li>Runtime information. This is live information about the meshing process, for example the fact that this is the i<sup>th</sup> time this part is being meshed (because previously the meshing had failed). Runtime information is used in order to recover from meshing failures, for example to restart meshing a part, which previously could not be meshed, using a different set of parameters (e.g., a smaller maximum element size).</li></ul></p><p id="p0063" num="0063">Preferably the same meshing parameters are used for meshing all sections of a part, since this makes implementation of modules 5 (2D Mesh Modification) and 7 (3D Mesh Merging) much easier.</p><p id="p0064" num="0064">In an embodiment of the Mesh Parameter Setting module 2, the module reads the type and order of the elements together with the initial maximum element size (<i>initial max_element_size</i>) from the <i>mesher configuration file.</i> The module also reads the size of the bounding box (<i>size_of_bounding_box</i>) of the part from the <i>part information file</i>. Finally, the module uses runtime information consisting of whether the meshing of this part has previously failed and, if so, the previous meshing parameters (e.g. <i>previous_max_elem_size</i>). The module then sets the maximum element size for the current meshing operation in the following way:
<ul><li><i>Min(size_of_bounding_box</i> /<i>factor1, initial_max_element_size</i>), if this is the first attempt to mesh the part</li><li><i>Min(previous_max_elem_size</i> /<i>factor2, initial_max_elemenLsize),</i> if this is not the first attempt,</li></ul>
where operation Min finds the minimum value satisfying the equation and <i>factor1</i> and <i>factor2</i> are two parameters read from the <i>mesher configuration file.</i> For example, in one embodiment the value of <i>factor1</i> may be 10 while the value of <i>factor2</i> may be 2.</p><p id="p0065" num="0065">There are cases where the meshing process needs to take into account the relation between the components in an assembly model. For example, it is sometimes<!-- EPO <DP n="20"> --> beneficial to have components found in close physical proximity meshed using the same element size. An example of such a case is shown in <figref idrefs="f0006">Figures 11B to 11D</figref>, where two components - a cylindrical axle and a cube with a cylindrical hole - are considered. <figref idrefs="f0006">Figures 11B and 11C</figref> respectively show the axle component with a low resolution mesh and a high resolution mesh, while <figref idrefs="f0006">Figure 11D</figref> shows the cylindrical hole component with a low resolution mesh. When the components in <figref idrefs="f0006">Figure 11B/11C and 11D</figref> are used together for simulation, it is preferable to have both components meshed at the same resolution (low resolution in this case, as shown in <figref idrefs="f0006">Figure 11E</figref>). If that is not the case, the meshes of the components could overlap, as shown in <figref idrefs="f0006">Figure 11F</figref> where the axle component has been meshed at a higher resolution than the cube component.</p><p id="p0066" num="0066">Cases such as the ones above can be handled using input information indicating dependencies (relations) between meshing parameters (e.g., the maximum element size) for different parts. For example, one such dependency might be that the maximum element size for both parts should be the same. A more advanced case is when the method requires the meshes for the interface to be the same. In this case, as in the previous one, the same meshing parameters have to be used for the both parts in the assembly model. As described below with reference to the Mesh Merge Module 7, the procedure used in the Mesh Merge module 7 is also used to ensure the interface surface meshes are consistent.</p><p id="p0067" num="0067">In a Mesh Parameter Setting module embodying the present invention, automatically setting the input parameters may therefore advantageously comprise provisionally selecting the parameters for each part using live runtime information about the meshing process for the part concerned and subsequently, for each part for which there is a known dependency requirement between an input parameter for the part and an input parameter for at least one other part of the assembly model, determining if a provisionally selected parameter for the part or a provisionally selected parameter for the at least one other part is inconsistent with the dependency requirement and, if so, adjusting the provisionally selected parameter for the part and/or the provisionally selected parameter for the at least one other part to meet the dependency requirement.</p><p id="p0068" num="0068">In one embodiment of the invention a Mesh Parameter Setting module 2 may be operable, after the meshing parameters have been decided independently and provisionally selected for each part to be meshed, to use information from an assembly information file to confirm or adjust the parameter selected for each part.<!-- EPO <DP n="21"> --> The assembly information file contains information about any dependencies between parts of the assembly model which is used to ensure that meshing parameters between dependent parts are mutually consistent. For example, if there is a dependency between two or more parts of the assembly model which requires the element size for those parts to be the same then, after the element size for each part has been computed independently, the Mesh Parameter Setting module 2 is operable to adjust the provisionally-selected element sizes so that the minimum element size of all the parts concerned is used for all of those parts.</p><heading id="h0009"><b>CAD Split module</b></heading><p id="p0069" num="0069">The CAD split module 3, shown in <figref idrefs="f0007">Figure 12</figref>, is responsible for partitioning a CAD part into a number of sections. The number of sections is computed so that the maximum number of elements in the resulting 3D mesh is approximately a specified value, denoted here as "Elements_per_section".</p><p id="p0070" num="0070">In an embodiment of the present invention the desired number of sections DN is computed in the following way:
<ol><li>1. The maximum element size obtained from the meshing parameters computed by the Mesh Parameter Setting module 2 is used to approximate the volume VE of an element in the mesh using the mathematical formula associated with the geometric shape of that element.</li><li>2. The total number of elements for the entire part is approximated as NE = VP/VE, where VP represents the volume of a part obtained from the <i>part information file</i> generated by the CAD Disassemble module 1.</li><li>3. The desired number of sections will then be DN = Ceil(NE/ Elements_per_section), where the Ceil function performs rounding to the closest larger integer.</li></ol></p><p id="p0071" num="0071">After computing DN, the CAD Split module 3 proceeds to generate the sections. In the present embodiment this operation is performed by recursive bisection and two ways of achieving this are described below.</p><heading id="h0010"><b>Recursive bisection technique (a)</b></heading><p id="p0072" num="0072">A recursive bisection method embodying the present invention, in which method a part of an assembly model is split into sections prior to undergoing a CAD meshing process, and a volume of each section obtained must not exceed a maximum permitted volume,<!-- EPO <DP n="22"> --> comprises, if the volume of the first section exceeds the maximum permitted volume, considering the part to be the first section and then carrying out the steps of:
<ol><li>(a) determining the principal axis of inertia A of the section;</li><li>(b) determining the centre of gravity of the section;</li><li>(c) defining first and second solid boxes whose intersection is one face that passes through the centre of gravity and is perpendicular to A and whose union is the entire bounding box of the section;</li><li>(d) performing a CAD Boolean operation of the section and the first box, and a CAD Boolean operation of the section and the second box, to obtain respective intermediate sections; and</li><li>(e) if the volume of a section obtained in step (d) exceeds the maximum permitted volume, repeating steps (b) to (d) for each of the sections obtained in step (d) until final sections whose volumes do not exceed the maximum permitted volume are obtained.</li></ol></p><p id="p0073" num="0073">Depending upon the CAD engine employed, the Boolean operation used in step (d) to obtain the first sub-section need not be the same as that used to obtain the second sub-section at the same stage, nor may it be necessary to use the same Boolean operation(s) on each occasion that step (d) is carried out.</p><p id="p0074" num="0074">In one embodiment, firstly the maximum volume per section MVS = VE * Elements_per_section is computed.</p><p id="p0075" num="0075">The method of recursive bisection then proceeds as follows:
<ol><li>1. Set the 1<sup>st</sup> section to be the entire part</li><li>2. If the volume of the section is smaller than VE, write section to file, using functions provided by the CAD engine.</li><li>3. Else
<ol><li>a. Compute the matrix of inertia, using functions provided by the CAD engine, and from here compute the principal axis of inertia A (this will minimize the area of the cut section).</li><li>b. Compute the center of gravity of the section, using functions provided by the CAD engine.</li><li>c. Use the CAD engine to create two solid boxes, whose intersection is one face that passes through the center of gravity and is perpendicular to A, and whose union is the entire bounding box of the section.<!-- EPO <DP n="23"> --></li><li>d. Compute the two sub-sections of the original section as the Common or Cut of the initial section and the first, then the second box, where the Common and Cut operations are the Boolean operations with the same name provided by the CAD library</li><li>e. For each of the two sub-sections, start at step b and continue until the volume of each sub-section is equal to or smaller than MVS.</li></ol></li></ol></p><p id="p0076" num="0076">An example of how this procedure works is shown in <figref idrefs="f0007">Figure 13</figref>, where the procedure is used on Part #4 (car body) from <figref idrefs="f0001">Figure 2</figref>. The part is first split in the Y direction, since that is its principal axis. The resulting sub-sections have the same principal axis, so both are split again in the Y direction, resulting in four sections. Then, the first and the last are cut again in the X direction while the two middle ones are cut in the Z direction. The final eight sections, whose volume is equal to or smaller than the specified maximum volume, are saved to files.</p><p id="p0077" num="0077">An efficient and easy to implement way of storing the information needed later in order to reconstruct the final mesh is to append, after each cut, at the current name of the section the direction of the cut and the number "1" for the first sub-section and the number "2" for the second sub-section. For example, after the first cut in the Y direction, the two sub-sections in <figref idrefs="f0007">Figure 13</figref> will be called Y1 and Y2 respectively, while the four sub-sections generated after the second cut in the Y direction will be named Y1_Y1, Y1_Y2, Y2_Y1 and Y2_Y2, respectively. The names of the final eight sections are shown at the bottom of the figure. As the information contained in these names full.y describes the splitting tree, all the necessary information for merging the sections is available.</p><p id="p0078" num="0078">The recursive-bisection method for CAD splitting is very efficient in the sense that the area of the interface between the sections is minimized. Moreover, the size of the sections is relatively balanced, since the cut is made through the centre of gravity. However, the fact that sections which are in contact with each other can be cut in different places and on different directions may lead to a problem, in that the geometry on the opposing faces of the interface between parts may be different. This problem is illustrated in <figref idrefs="f0008">Figure 14</figref>, where the opposing faces of two adjacent sections have one horizontal line (left) and one vertical line (right), respectively. The geometry on these faces needs to be the same in order to allow a more efficient implementation of the mesh merging algorithm (modules 5 and 7 in the flowchart shown in <figref idrefs="f0004">Figure 9</figref>).<!-- EPO <DP n="24"> --></p><p id="p0079" num="0079">In order to make adjacent faces have the same geometry, this invention proposes the following method:
<ul><li>For all sections Si of a part (the final ones, the leaves in the splitting tree)
<ul><li>○ LetC=Si</li><li>○ For all sections Sj≠Si that are in physical contact with Si
<ul><li>■ Perform CAD operation F = Fuse(C,Sj)</li><li>■ Perform CAD operation C = Common(F,Si)</li></ul></li></ul></li></ul></p><p id="p0080" num="0080">Here Fuse and Common represent the Boolean operations with the same name provided by the CAD Engine. Boolean operation Fuse creates a shape from two shapes. Boolean operation Common transforms the common part of two objects into an independent object.</p><p id="p0081" num="0081">The effect of applying such a method is the modification of the opposing faces of the interfaces between sections such that their geometry becomes the same. This result can be seen at the bottom of <figref idrefs="f0008">Figure 14</figref>, where both opposing faces now have identical geometry (both the vertical line and the horizontal line are present).</p><p id="p0082" num="0082">Thus, a module embodying the present invention is operable, after a part of a CAD assembly model has been split into a desired number DN of final sections using a recursive bisection method, to carry out a modification process, for all final sections Si of a part, where i=2 to DN, comprising: setting C=Si and, for all sections Sj≠Si which have an interface with section Si, performing CAD Boolean operation F=Fuse(C, Sj) and CAD Boolean operation C=Common(F, Si), whereby opposing surfaces at interfaces between adjoining sections are modified so as to have identical geometry.</p><p id="p0083" num="0083">Splitting based on recursive bisection technique (a) is the most efficient, however the applicability of the technique depends on the quality of CAD data (the presence of CAD errors) and on the implementation of the Boolean operations provided by the CAD engine. More specifically, if the CAD model contains errors, as it is often the case in industry, and/or if the Boolean operations are not mature enough, the sequence of Fuse/Common operations that needs to be applied in order to make the geometry of the adjacent faces match might fail due to CAD engine error. In such cases, a fallback technique, which is less efficient but more robust, may be used. This technique is described below as recursive bisection technique (b) and is sometimes referred to in the present application as the grid-aligned recursive bisection method.<!-- EPO <DP n="25"> --></p><heading id="h0011"><b>Recursive bisection technique (b) - grid-aligned</b></heading><p id="p0084" num="0084">An alternative recursive bisection method embodying the present invention, in which method a part of a CAD assembly model is split into a desired number DN of sections prior to undergoing a CAD meshing process, comprises the steps of:
<ol><li>(a) determining (i) the number of split points Nx in an X direction, (ii) the number of split points Ny in a Y direction and (iii) the number of split points Nz in a Z direction, where the X, Y and Z directions are mutually parallel and (Nx+1)(Ny+1)(Nz+1)≥DN;</li><li>(b) recursively bisecting the part in the X direction until (Nx+1) sections are obtained;</li><li>(c) for all sections obtained in step (b), recursively bisecting the sections in the Y direction until (Nx+1)(Ny+1) sections are obtained; and</li><li>(d) for all sections obtained in step (c), recursively bisecting the sections in the Z direction until (Nx+1)(Ny+1)(Nz+1) sections are obtained.</li></ol></p><p id="p0085" num="0085">In such a grid-aligned recursive bisection method the input geometry is cut along a Cartesian grid. The grid need not be uniform, in the sense that cuts can be denser at certain places as compared to the rest. If Nx, Ny and Nz are the number of cuts in the X,Y,Z directions, respectively, then the input geometry will be partitioned into (Nx+1)*(Ny+1)*(Nz+1) sections.</p><p id="p0086" num="0086">An embodiment of the technique proceeds as follows:
<ol><li>1. Considering the geometry of the input CAD file (e.g., aspect ratio of the bounding box), derive cut points in X, Y and Z directions such that (Nx+1)*(Ny+1)*(Nz+1) ≥ DN</li><li>2. Recursively cut the geometry along the X direction in half and then in half again, and so on until Nx+1 slabs are obtained.</li><li>3. For all slabs generated at step 2, recursively cut the geometry along the Y direction in half and half again, until (Nx+1)*(Ny+1) pencils are obtained.</li><li>4. For all pencils generated at step 3, recursively cut the geometry along the Z direction in half and half again, until (Nx+1)*(Ny+1)*(Nz+1) sections are obtained.</li><li>5. All sections are written to files.</li></ol></p><p id="p0087" num="0087">The cutting of the geometry is done in the same way as it was done for the previously-described recursive bisection technique (a), with the difference that the point of the cut is not the center of mass but the coordinate of the cut point being chosen. If none of the cut points are placed at the middle of the geometry being cut, the cut point closest to it<!-- EPO <DP n="26"> --> will be chosen. Sections may be named according to their position in space, starting from X0_Y0_20, X1_Y0_20 and ending with X(Nx+1)_Y(Ny+1)_Z(Nz+1).</p><p id="p0088" num="0088">An illustration of how this technique works is shown in <figref idrefs="f0008">Figure 15</figref>, where a 3D object is cut into 12 sections, on the basis of Nx=2, Ny=3 and Nz=0. Cut points spaced uniformly in all directions are chosen in this example. First, the input object is split in the X direction. Since there is no cut point in the middle, the first cut splits the solid in a ratio of 1/3 to 2/3. In the next step, the 1/3 part is kept unmodified while the 2/3 part is halved. After this second step both cuts in the X direction have been completed, so cutting in the Y direction is carried out. The four cuts are performed in two steps, resulting in 12 sections.</p><p id="p0089" num="0089">Since geometry cutting was done in a consistent way and resulting sections are aligned, the geometry of the opposing faces of the interfaces between sections will be the same by construction. Hence, unlike after recursive bisection technique (a), there is no need for further processing of the faces at this stage.</p><p id="p0090" num="0090">In summary a CAD split module 3 embodying the present invention can provide:
<ul><li>an automated way to compute the number of sections</li><li>a domain partitioning method for CAD objects based on Boolean operations</li><li>a naming convention which stores the partitioning information</li><li>a method of grid-aligned recursive bisection</li><li>For CAD solids split based on recursive bisection, an efficient way to ensure that the geometries on the interfaces match</li></ul></p><heading id="h0012"><b>2D Meshing module</b></heading><p id="p0091" num="0091">The function of the 2D Meshing module 4 is to create a 2D (surface) mesh starting from CAD geometry. The layout of the module is shown in <figref idrefs="f0009">Figure 16</figref>. The module 4 can use any off-the-shelf unmodified mesher to create the 2D surface mesh of the CAD file given as input and using the specified meshing parameters. The CAD file is a section of a part, generated by the CAD split module, while the meshing parameters are computed by the Meshing Parameter Setting module 2.</p><heading id="h0013"><b>2D Mesh Modification module</b></heading><p id="p0092" num="0092">The function of the 2D Mesh Modification module 5 is to modify the surface meshes for all the sections of one part such that the meshes of sections which have an interface<!-- EPO <DP n="27"> --> with one another are the same. This is important when using meshers which use randomized meshing algorithms, for which there is no guarantee that the same geometry will be meshed in the same way every time. Actually, for meshers like Gmsh<sup>™</sup> or Netgen<sup>™</sup>, which are currently two of the most widely-used pieces of open source meshing software, the 2D and 3D meshes generated for the same input CAD file are different almost every single time the program is run. This issue is illustrated in <figref idrefs="f0003">Figure 7</figref>, where the meshes of the two adjacent sections cannot be combined because the 2D meshes on the common face are different. However, the two meshes match on the 1D contour of this face. Thus an embodiment of the present invention recognizes that the restriction imposed on serial meshers used as bases for parallel meshing in the prior art, that they should always generate the same 2D surface mesh, may advantageously be relaxed, and proposes that the mesher only be required to generate the same 1D edge mesh.</p><p id="p0093" num="0093">An embodiment of the present invention provides a method of modifying a 2D mesh at a surface of a section obtained in a CAD process, where an assembly model which is the subject of the CAD process has been separated into different parts each of which is split into sections which are then subjected to 2D meshing such that each surface of the section is defined by a set of 2D elements produced using a meshing method which generates the same 1D edge mesh at every surface, the method comprising, for all sections for which the method has not already been carried out and which have an interface with another section:
<ul><li>matching nodes of elements along edges of a surface of a section on one side of the interface with nodes of elements along edges of an opposing surface of a section on the other side of the interface; and</li><li>replacing the elements on the surface on one side of the interface with the elements on the surface on the other side of the interface.</li></ul></p><p id="p0094" num="0094"><figref idrefs="f0010">Figure 18</figref> shows such a 2D Mesh Modification Module 5, which performs an in-place modification of the 2D meshes found in a specified folder. It is assumed that these meshes are the ones resulting from the 2D meshing (for example, using the 2D Meshing module 4) of all the sections for one part.</p><p id="p0095" num="0095">An embodiment of the modification method is as follows:
<ul><li>For all sections of the part:<!-- EPO <DP n="28"> -->
<ol><li>1. Compute list of neighbouring parts, for example using the name of the file to find the position in the bisection tree and bounding box information</li><li>2. Remove from the list neighbours with which the 2D mesh modification operation has already been performed</li><li>3. For the neighbours still in the list:
<ol><li>a. Find the elements on the common face</li><li>b. Choose who is the source and who is the destination (e.g., the neighbour is the source)</li><li>c. Match the nodes on the 1D edges, for example using Euclidian distance</li><li>d. Replace the elements on the source face with the ones from the destination face, considering the match between the nodes when performing the renumbering</li></ol></li></ol></li></ul></p><p id="p0096" num="0096">The method listed above can be applied in the case when the CAD Split module 3 uses the recursive bisection technique (a). If the grid-aligned recursive bisection technique (b) is used, then an alternative, more optimized method is preferably used.</p><p id="p0097" num="0097">That is, an alternative embodiment provides a method of modifying a 2D mesh at a surface of a section obtained in a computer-aided design CAD process, where an assembly model which is the subject of the CAD process has been separated into different parts each of which is split into sections which are then subjected to 2D meshing such that each surface of the section is defined by a set of 2D elements produced using a meshing method which generates the same 1D edge mesh at every surface, the method comprising:
<ul><li>allocating all the sections of the part to either a first set or a second set according to the location of the section in the part such that all the sections which have an interface with the sections in the first set are allocated to the second set;</li><li>for each of the sections in the first set, matching nodes of elements along edges of a surface of a section in the first set with nodes of elements along edges of an opposing surface of a section in the second set; and<br/>
replacing the elements on the surface of the first set section with the elements on the surface on the second set section.</li></ul></p><p id="p0098" num="0098">For example, where the sections have been numbered as previously discussed, such a method can be implemented in the following way:<!-- EPO <DP n="29"> -->
<ol><li>1. Divide sections into a <i>red</i> set and a <i>black</i> set, where the sections in the red set are the ones for which the sum of the indices is odd and the sections in the black set are the ones for which it is even. For example, the section named X0_Y0_20 will be in the black set since 0+0+0=0 is even while the one named X1_Y0_20 will be in the red one since 1+0+0=1 is odd.</li><li>2. For all sections in the red set, do
<ol><li>a. Use file name information and bounding box information to establish a list of neighbours (all of which will be from the black set)</li><li>b. For each neighbouring section, do
<ol><li>i. Find the elements on the common face</li><li>ii. Save these elements to a file or to memory</li></ol></li></ol></li><li>3. Wait until the processing of sections in the red set has finished</li><li>4. For all sections in the black set, do
<ol><li>a. Use file name information and bounding box information to establish a list of neighbours (all of which will be from the red set)</li><li>b. For each neighbouring section, do
<ol><li>i. Find the elements on the common face</li><li>ii. Load the new elements for that face from file or from memory</li><li>iii. Match the nodes on the 1D edges using Euclidian distance</li><li>iv. Replace the old elements with the new ones, considering the match between the nodes when performing the renumbering</li></ol></li></ol></li></ol></p><p id="p0099" num="0099">By waiting at step 3 for the processing of all sections in the red set to finish before beginning to process the sections in the black set, all the data required for the modification stage is available, making implementation easier. However, using a dynamic scheduler such as the one discussed later, a destination (a section in the black set) could be processed immediately following the extraction of data from all sources in the red set that it depends on, i.e. sections in the red set and sections in the black set can be processed in parallel.</p><heading id="h0014"><b>3D Meshing module</b></heading><p id="p0100" num="0100">The function of the 3D Meshing module 6 is to create a 3D (volume) mesh starting from 2D surface geometry. The layout of the module is shown in <figref idrefs="f0010">Figure 19</figref>. The module 6 can use an off-the-shelf unmodified mesher to create a 3D volume mesh from the 2D<!-- EPO <DP n="30"> --> surface mesh file given as input and using the specified meshing parameters. The 2D surface mesh file is the 2D mesh of a section of a part, generated by the 2D Meshing module 4 and modified by the 2D Mesh modification module 5, while the meshing parameters are computed by the Meshing Parameter Setting module 2. The only restriction imposed on the 3D Mesher is that it does not add any new nodes on the 2D surface. One example of a meshing algorithm with this property is the Frontal method, used in meshers like Gmsh<sup>™</sup> and Netgen<sup>™</sup>.</p><heading id="h0015"><b>3D Mesh Merging module</b></heading><p id="p0101" num="0101">The function of the 3D Mesh Merging module 7 is to combine the 3D meshes corresponding to all the sections of a part into one single coherent mesh (i.e. two meshes connected on the interfaces between sections from which duplicate nodes have been removed).</p><p id="p0102" num="0102">The 3D Mesh Merging module 7, whose layout is shown in <figref idrefs="f0011">Figure 20</figref>, takes as input a folder containing the 3D meshes for all the sections of a part and outputs one mesh file for the entire part. Because of the previously applied 2D Mesh Modification module 5 and because of the fact that the 3D Meshing module 6 is required not to add any new nodes on the surface mesh, the nodes and elements on the interface between sections are guaranteed to match perfectly. The merging is then done by finding the pairs of duplicate nodes on the interfaces between sections, removing one of the two and renumbering accordingly.</p><heading id="h0016"><b>Mesh Assembly module</b></heading><p id="p0103" num="0103">The function of the Mesh Assembly module 8 is to combine the 3D meshes for all of the parts of the assembly module into one assembly mesh. Note that "assembly" is different from "merging", since in the former case, even for meshes which have interfaces with other meshes, these meshes remain independent and duplicate nodes are not removed.</p><p id="p0104" num="0104">The Mesh Assembly module 8, whose layout is shown in <figref idrefs="f0011">Figure 21</figref>, takes as input a folder containing the meshes of all parts in the assembly and the assembly tree and outputs one assembly mesh file.</p><heading id="h0017"><b>Parallel Task Scheduler module</b></heading><p id="p0105" num="0105">The function of the Parallel Task Scheduler module 9 is to manage the execution of the previously described modules 1 to 8 on the processing elements assigned to it, which<!-- EPO <DP n="31"> --> can range from cores in the same machine or multiple machines in a cluster. The execution of tasks is done based on a list of dependencies, with a task being scheduled for execution as soon as all the tasks it depends on have been completed and a free processing element is available.</p><p id="p0106" num="0106">A module embodying the present invention, for managing the execution of tasks in a decoupled parallel meshing process, in which the execution of one or more tasks may be dependent upon the execution result of at least one other task, and each task is scheduled for execution after the execution result of at least one of the tasks upon which it depends is known and processing resources for the task are available, prioritises execution of one or more tasks over one or more other tasks in accordance with a prioritisation criterion, the prioritisation criterion being, depending on a characteristic of the task, either that, on the basis of information relating to one or more previous attempts to execute the task or similar tasks, the task is deemed to be more likely to succeed than other tasks to be executed, or that, on the basis of information relating to one or more previous attempts to execute the task or similar tasks, the task is deemed to be more likely to fail than other tasks to be executed.</p><p id="p0107" num="0107">An embodiment of the present invention can manage the execution of modules needed for parallel meshing, abort tasks that have become obsolete (e.g., abort the meshing of the rest of the sections if the meshing of one of the sections has failed), and keep a history of successful and failed tasks and use it in order to schedule as early as possible tasks more likely to succeed or more to likely to fail, depending on characteristics of the tasks.</p><p id="p0108" num="0108">A Parallel Task Scheduler module 9 embodying the present invention, whose layout is shown in <figref idrefs="f0012">Figure 22</figref>, has a multi-layered structure. The module 9 executes units of works called <i>tasks.</i> A task represents the execution of one of the previously described modules, for example running CAD split on the CAD file representing one part of the assembly or the 3D meshing of a section of a part. Each task, besides input data, can have zero, one or more <i>conditions</i> that needs to be satisfied in order for the task to be able to execute. For example, a 3D meshing task will have a dependency on the 2D mesh modification module being executed on the sections of that part.</p><p id="p0109" num="0109">Tasks are added to the <i>task queue</i> and stay there until all their conditions are satisfied. When this happens, they are moved to another queue containing <i>tasks ready for<!-- EPO <DP n="32"> --> execution.</i> The scheduler then chooses for execution as many tasks as free processing units, which are then executed on <i>computational elements.</i> After the execution is finished, if the execution is successful, the conditions of the tasks in the tasks queue are updated, so now some new tasks can become ready for execution. Additionally, following a successful execution, new tasks can be added to the queue. For example, following the successful execution of the CAD split module, new tasks corresponding to the 2D meshing, 2D mesh modification, 3D meshing and 3D mesh merging will be added to the queue.</p><p id="p0110" num="0110">If a task fails to execute correctly (e.g. an error is encountered during meshing), some tasks from the queue might be removed. For example, if the 2D meshing of one section of a part has failed, the 2D meshing operations for all remaining sections from the same part will be removed from the queue. This type of dependency between tasks is defined in the form of a <i>task group,</i> where all tasks added to the group share the same conditions for execution and the failure of one task will cause the failure of the rest. For example, the 2D meshing tasks for all the sections of one part will make one task group. The module 9 keeps a history of tasks that have failed and prioritises, depending on one or more characteristics of the task (for example, type, level, timing, speed and/or complexity), some or all tasks in the group which are more likely to fail. The module 9 may also keep a history of tasks that have succeeded and, depending on one or more characteristics of the task, prioritise some or all tasks in the group which are more likely to succeed.</p><p id="p0111" num="0111">For example, consider a simple scenario like the meshing of the car model, which has 7 parts, where the parts may be meshed using two different meshing algorithms X and Y. If in the example each part is split into four sections, for parallel meshing, there will be 7x2 = 14 initial (higher level) tasks to mesh the parts, e.g. "mesh part 1 using algorithm X", ... "mesh part 7 using algorithm X" and "mesh part 1 using algorithm Y", ... "mesh part 7 using algorithm Y". Each task generates a number of sub (lower level) tasks, such as "mesh section 1 of part 1 with algorithm X", "mesh section 2 of part 1 with algorithm X" and so on. Preferably the initial tasks, for the parts, are arranged so that the ones that are more likely to succeed have priority since this can save processing time. For example, if the meshing is more likely to succeed using algorithm X, high level meshing tasks using algorithm X are prioritised in the expectation that it will not be necessary to repeat the processing based on algorithm Y and time will thus be saved. In this example, the order of processing the subtasks is arranged such that<!-- EPO <DP n="33"> --> the ones that are more likely to fail have priority. If the meshing of one section of the part fails, then the entire part has to be re-meshed, so the sooner the "bad" section is found the better. Thus, in this example, depending on a characteristic of the task (in this case, the level of the task), the prioritisation criterion used by the module when deciding whether to prioritise execution of a task is whether the task is more likely to succeed or is more likely to fail than other tasks to be executed.</p><p id="p0112" num="0112">Although described above as part of a meshing system, modules embodying the present invention may also advantageously be used independently of any other of the modules or in any feasible combination with one or more others of the modules.</p><p id="p0113" num="0113">Embodiments of the present invention may be implemented in hardware, or as software modules running on one or more processors, or on a combination thereof. That is, those skilled in the art will appreciate that a microprocessor or digital signal processor (DSP) may be used in practice to implement some or all of the functionality described above.</p><p id="p0114" num="0114">The invention may also be embodied as one or more device or apparatus programs (e.g. computer programs and computer program products) for carrying out part or all of the methods described herein. Such programs embodying the present invention may be stored on computer-readable media, or could, for example, be in the form of one or more signals. Such signals may be data signals downloadable from an Internet website, or provided on a carrier signal, or in any other form.</p></description><claims mxw-id="PCLM56976389" lang="EN" load-source="patent-office"><!-- EPO <DP n="34"> --><claim id="c-en-0001" num="0001"><claim-text>A meshing method for use in a computer-aided design (CAD) or computer-aided engineering (CAE) system, in which one or more serial meshing units are used to carry out a decoupled parallel meshing process in respect of all parts of a CAD assembly model,<br/>
<b>characterised by</b> setting input parameters for the meshing process automatically, for each part to be processed, using live runtime information about the meshing process for the part concerned by provisionally selecting the parameters for each part using live runtime information about the meshing process for the part concerned and subsequently, for each part for which there is a known dependency requirement between an input parameter for the part and an input parameter for at least one other part of the assembly model, determining if a provisionally selected parameter for the part or a provisionally selected parameter for the at least one other part is inconsistent with the dependency requirement and, if so, adjusting the provisionally selected parameter for the part and/or the provisionally selected parameter for the at least one other part to meet the dependency requirement.</claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>A method as claimed in claim 1, wherein the live runtime information comprises information about the outcome of previous attempts to carry out the meshing process of the part.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>A method as claimed in claim 1 or 2, in which a part of an assembly model is split into sections prior to undergoing a CAD meshing process, wherein a volume of each section obtained must not exceed a maximum permitted volume, the method further comprising, if the volume of the part exceeds the maximum permitted volume, considering the part to be the first section and then carrying out the steps of:
<claim-text>(a) determining the principal axis of inertia A of the section;</claim-text>
<claim-text>(b) determining the centre of gravity of the section;</claim-text>
<claim-text>(c) defining first and second solid boxes whose intersection is one face that passes through the centre of gravity and is perpendicular to A and whose union is the entire bounding box of the section;</claim-text>
<claim-text>(d) performing a CAD Boolean operation of the section and the first box, and a CAD Boolean operation of the section and the second box, to obtain respective intermediate sections; and<!-- EPO <DP n="35"> --></claim-text>
<claim-text>(e) if the volume of a section obtained in step (d) exceeds the maximum permitted volume, repeating steps (b) to (d) for each of the sections obtained in step (d) until final sections having volumes which do not exceed the maximum permitted volume are obtained.</claim-text></claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>A method as claimed in claim 3, wherein, after a part of a CAD assembly model has been split into a desired number DN of final sections, a modification process is carried out, for all final sections Si of a part, where i=2 to DN, which modification process comprises:
<claim-text>setting C=Si and, for all sections Sj≠Si which have an interface with section Si, performing CAD Boolean operation F=Fuse(C, Sj) and CAD Boolean operation C=Common(F, Si), whereby opposing surfaces at interfaces between adjoining sections are modified so as to have identical geometry.</claim-text></claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>A method as claimed in any preceding claim, further comprising modifying a two dimensional (2D) mesh at a surface of a section obtained in a computer-aided design process in which an assembly model which is the subject of the CAD process has been separated into different parts each of which is split into sections which are then subjected to 2D meshing such that each surface of the section is defined by a set of 2D elements produced using a meshing method which generates the same one dimensional (1D) edge mesh at every surface, in which method the modifying comprises<br/>
for all sections for which the method has not already been carried out and which have an interface with another section:
<claim-text>matching nodes of elements along edges of a surface of a section on one side of the interface with nodes of elements along edges of an opposing surface of a section on the other side of the interface; and</claim-text>
<claim-text>replacing the elements on the surface on one side of the interface with the elements on the surface on the other side of the interface.</claim-text></claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>A method as claimed in claim 1 or 2, in which a part of a CAD assembly model is split into a desired number DN of sections prior to undergoing a CAD meshing process, further comprising the steps of:
<claim-text>(a) determining (i) the number of split points Nx in an X direction, (ii) the number of split points Ny in a Y direction and (iii) the number of split points Nz in a Z direction, where the X, Y and Z directions are mutually parallel and (Nx+1)(Ny+1)(Nz+1)≥DN;<!-- EPO <DP n="36"> --></claim-text>
<claim-text>(b) recursively bisecting the part in the X direction until (Nx+1) sections are obtained;</claim-text>
<claim-text>(c) for all sections obtained in step (b), recursively bisecting the sections in the Y direction until (Nx+1)(Ny+1) sections are obtained; and</claim-text>
<claim-text>(d) for all sections obtained in step (c), recursively bisecting the sections in the Z direction until (Nx+1)(Ny+1)(Nz+1) sections are obtained.</claim-text></claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>A method as claimed in claim 6, further comprising modifying a two dimensional (2D) mesh at a surface of a section obtained in a computer-aided design process in which an assembly model which is the subject of the CAD process has been separated into different parts each of which is split into sections which are then subjected to 2D meshing such that each surface of the section is defined by a set of 2D elements produced using a meshing method which generates the same one dimensional (1D) edge mesh at every surface, in which method the modifying comprises<br/>
allocating all the sections of the part to either a first set or a second set according to the location of the section in the part such that all the sections which have an interface with the sections in the first set are allocated to the second set;<br/>
for each of the sections in the first set, matching nodes of elements along edges of a surface of a section in the first set with nodes of elements along edges of an opposing surface of a section in the second set; and<br/>
replacing the elements on the surface of the first set section with the elements on the surface on the second set section.</claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>Meshing apparatus for use in a computer-aided design (CAD) or computer-aided engineering (CAE) system, which apparatus is configured to use one or more serial meshing units to carry out a decoupled parallel meshing process in respect of all parts of a CAD assembly model,<br/>
<b>characterised by</b> a meshing parameter setting unit configured to set input parameters for the meshing process automatically, for each part to be processed, the meshing parameter setting unit being operable to use live runtime information about the meshing process for the part concerned to determine one or more input parameters.</claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>Apparatus as claimed in claim 8, wherein the live runtime information comprises information about the outcome of previous attempts to carry out the meshing process of the part.<!-- EPO <DP n="37"> --></claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>Apparatus as claimed in claim 8 or 9, further comprising a CAD splitting module configured to split a part of an assembly model into sections prior to CAD meshing of the sections, such that a volume of each section obtained does not exceed a maximum permitted volume, the CAD splitting module being operable, if the volume of the part exceeds the maximum permitted volume, to consider the part to be the first section and then to carry out the steps of:
<claim-text>(a) determining the principal axis of inertia A of the section;</claim-text>
<claim-text>(b) determining the centre of gravity of the section;</claim-text>
<claim-text>(c) defining first and second solid boxes whose intersection is one face that passes through the centre of gravity and is perpendicular to A and whose union is the entire bounding box of the section;</claim-text>
<claim-text>(d) performing a CAD Boolean operation of the section and the first box, and a CAD Boolean operation of the section and the second box, to obtain respective intermediate sections; and</claim-text>
<claim-text>(e) if the volume of a section obtained in step (d) exceeds the maximum permitted volume, repeating steps (b) to (d) for each of the sections obtained in step (d) until final sections having volumes which do not exceed the maximum permitted volume are obtained.</claim-text></claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>Apparatus as claimed in claim 10, wherein the CAD splitting module is operable, after a part of a CAD assembly model has been split into a desired number DN of final sections, to carry out a modification process, for all final sections Si of a part, where i=2 to DN, comprising setting C=Si and, for all sections Sj≠Si which have an interface with section Si, performing CAD Boolean operation F=Fuse(C, Sj) and CAD Boolean operation C=Common(F, Si), whereby opposing surfaces at interfaces between adjoining sections are modified so as to have identical geometry.</claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>Apparatus as claimed in any one of claims 8 to 11, further comprising a mesh modification module configured to modify a two dimensional (2D) mesh at a surface of a section obtained in a computer-aided design process, where an assembly model which is the subject of the CAD process has been separated into different parts each of which is split into sections which are then subjected to 2D meshing such that each surface of the section is defined by a set of 2D elements produced using a meshing method which generates the same one dimensional (1D) edge mesh at every surface, the module being operable to carry out a method, for all sections for which the method<!-- EPO <DP n="38"> --> has not already been carried out and which have an interface with another section, in which nodes of elements along edges of a surface of a section on one side of the interface are matched with nodes of elements along edges of an opposing surface of a section on the other side of the interface, and the elements on the surface on one side of the interface are replaced with the elements on the surface on the other side of the interface.</claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>Apparatus as claimed in claim 8 or 9, further comprising a CAD splitting module configured to split a part of an assembly model into a desired number DN of sections prior to meshing of the sections, which module is operable to carry out the steps of:
<claim-text>(a) determining (i) the number of split points Nx in an X direction, (ii) the number of split points Ny in a Y direction and (iii) the number of split points Nz in a Z direction, where the X, Y and Z directions are mutually parallel and (Nx+1)(Ny+1)(Nz+1)≥DN;</claim-text>
<claim-text>(b) recursively bisecting the part in the X direction until (Nx+1) sections are obtained;</claim-text>
<claim-text>(c) for all sections obtained in step (b), recursively bisecting the sections in the Y direction until (Nx+1)(Ny+1) sections are obtained; and</claim-text>
<claim-text>(d) for all sections obtained in step (c), recursively bisecting the sections in the Z direction until (Nx+1)(Ny+1)(Nz+1) sections are obtained.</claim-text></claim-text></claim><claim id="c-en-0014" num="0014"><claim-text>Apparatus as claimed in claim 13, further comprising a mesh modification module configured to modify a two dimensional (2D) mesh at a surface of a section obtained in a computer-aided design process, where an assembly model which is the subject of the CAD process has been separated into different parts each of which is split into sections which are then subjected to 2D meshing such that each surface of the section is defined by a set of 2D elements produced using a meshing method which generates the same one dimensional (1D) edge mesh at every surface, the module being operable to carry out a method in which:
<claim-text>all the sections of the part are allocated to either a first set or a second set according to the location of the section in the part such that all the sections which have an interface with the sections in the first set are allocated to the second set;</claim-text>
<claim-text>for each of the sections in the first set, nodes of elements along edges of a surface of a section in the first set are matched with nodes of elements along edges of an opposing surface of a section in the second set; and</claim-text>
<claim-text>the elements on the surface of the first set section are replaced with the elements on the surface on the second set section.</claim-text><!-- EPO <DP n="39"> --></claim-text></claim><claim id="c-en-0015" num="0015"><claim-text>A scheduling method for managing the execution of tasks in a decoupled parallel meshing process, in which the execution of one or more tasks is dependent upon the execution result of at least one other task, and each task is scheduled for execution after the execution result of at least one of the tasks upon which it depends is known and processing resources for the task are available, wherein execution of one or more tasks is prioritised over one or more other tasks in accordance with a prioritisation criterion, the prioritisation criterion being, depending on a characteristic of the task, either that, on the basis of information relating to one or more previous attempts to execute the task or similar tasks, the task is deemed to be more likely to succeed than other tasks to be executed, or that, on the basis of information relating to one or more previous attempts to execute the task or similar tasks, the task is deemed to be more likely to fail than other tasks to be executed.</claim-text></claim></claims><drawings mxw-id="PDW16667170" load-source="patent-office"><!-- EPO <DP n="40"> --><figure id="f0001" num="1,2"><img id="if0001" file="imgf0001.tif" wi="165" he="206" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="41"> --><figure id="f0002" num="3,4,5"><img id="if0002" file="imgf0002.tif" wi="165" he="225" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="42"> --><figure id="f0003" num="6,7"><img id="if0003" file="imgf0003.tif" wi="165" he="189" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="43"> --><figure id="f0004" num="8,9"><img id="if0004" file="imgf0004.tif" wi="165" he="224" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="44"> --><figure id="f0005" num="10,11A"><img id="if0005" file="imgf0005.tif" wi="165" he="193" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="45"> --><figure id="f0006" num="11B,11C,11D,11E,11F"><img id="if0006" file="imgf0006.tif" wi="165" he="210" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="46"> --><figure id="f0007" num="12,13"><img id="if0007" file="imgf0007.tif" wi="165" he="225" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="47"> --><figure id="f0008" num="14,15"><img id="if0008" file="imgf0008.tif" wi="165" he="180" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="48"> --><figure id="f0009" num="16,17"><img id="if0009" file="imgf0009.tif" wi="148" he="225" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="49"> --><figure id="f0010" num="18,19"><img id="if0010" file="imgf0010.tif" wi="165" he="181" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="50"> --><figure id="f0011" num="20,21"><img id="if0011" file="imgf0011.tif" wi="165" he="159" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="51"> --><figure id="f0012" num="22"><img id="if0012" file="imgf0012.tif" wi="165" he="152" img-content="drawing" img-format="tif"/></figure></drawings><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
