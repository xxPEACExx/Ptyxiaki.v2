<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2678995-A1" country="EP" doc-number="2678995" kind="A1" date="20140101" family-id="45771836" file-reference-id="293884" date-produced="20180823" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146550502" ucid="EP-2678995-A1"><document-id><country>EP</country><doc-number>2678995</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12706298-A" is-representative="NO"><document-id mxw-id="PAPP154824425" load-source="docdb" format="epo"><country>EP</country><doc-number>12706298</doc-number><kind>A</kind><date>20120223</date><lang>EN</lang></document-id><document-id mxw-id="PAPP214535157" load-source="docdb" format="original"><country>EP</country><doc-number>12706298.2</doc-number><date>20120223</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140452111" ucid="EP-11250301-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>11250301</doc-number><kind>A</kind><date>20110314</date></document-id></priority-claim><priority-claim mxw-id="PPC140453509" ucid="EP-12706298-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>12706298</doc-number><kind>A</kind><date>20120223</date></document-id></priority-claim><priority-claim mxw-id="PPC140454747" ucid="GB-201103422-A" load-source="docdb"><document-id format="epo"><country>GB</country><doc-number>201103422</doc-number><kind>A</kind><date>20110226</date></document-id></priority-claim><priority-claim mxw-id="PPC140450712" ucid="GB-201103687-A" load-source="docdb"><document-id format="epo"><country>GB</country><doc-number>201103687</doc-number><kind>A</kind><date>20110303</date></document-id></priority-claim><priority-claim mxw-id="PPC140447569" ucid="GB-2012000187-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>GB</country><doc-number>2012000187</doc-number><kind>W</kind><date>20120223</date></document-id></priority-claim></priority-claims><technical-data><classification-ipc><edition>7</edition><main-classification>H04L  12/56</main-classification></classification-ipc><classifications-ipcr><classification-ipcr mxw-id="PCL1988095640" load-source="docdb">H04L  29/08        20060101AFI20120914BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988106702" load-source="docdb">H04L  12/28        20060101ALI20120914BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1898982762" load-source="docdb" scheme="CPC">H04L  67/322       20130101 LI20160907BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1898983500" load-source="docdb" scheme="CPC">H04L  12/14        20130101 LI20160906BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988125993" load-source="docdb" scheme="CPC">H04L  29/0845      20130101 FI20131212BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132183990" lang="DE" load-source="patent-office">RESSOURCENMANAGEMENT FÜR EINE DIENSTLEISTUNGSSITZUNG</invention-title><invention-title mxw-id="PT132183991" lang="EN" load-source="patent-office">SERVICE SESSION RESOURCE MANAGEMENT</invention-title><invention-title mxw-id="PT132183992" lang="FR" load-source="patent-office">GESTION DE RESSOURCE DE SESSION DE SERVICE</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR918144548" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>BRITISH TELECOMM</last-name><address><country>GB</country></address></addressbook></applicant><applicant mxw-id="PPAR918145809" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>BRITISH TELECOMMUNICATIONS PUBLIC LIMITED COMPANY</last-name></addressbook></applicant><applicant mxw-id="PPAR918980365" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>British Telecommunications Public Limited Company</last-name><iid>101189794</iid><address><street>81 Newgate Street</street><city>London EC1A 7AJ</city><country>GB</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918151823" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>RIZZO MICHAEL</last-name><address><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR918161559" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>RIZZO, MICHAEL</last-name></addressbook></inventor><inventor mxw-id="PPAR918986086" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>RIZZO, MICHAEL</last-name><address><street>PP: C5A 81 Newgate Street</street><city>London EC1A 7AJ</city><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR918133570" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>RUDKIN STEVEN</last-name><address><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR918146275" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>RUDKIN, STEVEN</last-name></addressbook></inventor><inventor mxw-id="PPAR918992091" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>RUDKIN, STEVEN</last-name><address><street>PP: C5A 81 Newgate Street</street><city>London EC1A 7AJ</city><country>GB</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918984700" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Lidbetter, Timothy Guy Edwin</last-name><iid>100037106</iid><address><street>British Telecommunications plc Intellectual Property Department PPC5A, BT Centre 81 Newgate Street</street><city>London EC1A 7AJ</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="GB-2012000187-W"><document-id><country>GB</country><doc-number>2012000187</doc-number><kind>W</kind><date>20120223</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012114073-A1"><document-id><country>WO</country><doc-number>2012114073</doc-number><kind>A1</kind><date>20120830</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS548894419" load-source="docdb">AL</country><country mxw-id="DS548858573" load-source="docdb">AT</country><country mxw-id="DS548894420" load-source="docdb">BE</country><country mxw-id="DS548917580" load-source="docdb">BG</country><country mxw-id="DS548907824" load-source="docdb">CH</country><country mxw-id="DS548911596" load-source="docdb">CY</country><country mxw-id="DS548858578" load-source="docdb">CZ</country><country mxw-id="DS548894421" load-source="docdb">DE</country><country mxw-id="DS548911597" load-source="docdb">DK</country><country mxw-id="DS548911602" load-source="docdb">EE</country><country mxw-id="DS548830858" load-source="docdb">ES</country><country mxw-id="DS548917581" load-source="docdb">FI</country><country mxw-id="DS548917586" load-source="docdb">FR</country><country mxw-id="DS548894422" load-source="docdb">GB</country><country mxw-id="DS548911603" load-source="docdb">GR</country><country mxw-id="DS548894423" load-source="docdb">HR</country><country mxw-id="DS548858579" load-source="docdb">HU</country><country mxw-id="DS548907825" load-source="docdb">IE</country><country mxw-id="DS548911604" load-source="docdb">IS</country><country mxw-id="DS548917587" load-source="docdb">IT</country><country mxw-id="DS548911605" load-source="docdb">LI</country><country mxw-id="DS548811748" load-source="docdb">LT</country><country mxw-id="DS548858580" load-source="docdb">LU</country><country mxw-id="DS548811749" load-source="docdb">LV</country><country mxw-id="DS548811750" load-source="docdb">MC</country><country mxw-id="DS548909822" load-source="docdb">MK</country><country mxw-id="DS548909823" load-source="docdb">MT</country><country mxw-id="DS548858581" load-source="docdb">NL</country><country mxw-id="DS548894424" load-source="docdb">NO</country><country mxw-id="DS548911610" load-source="docdb">PL</country><country mxw-id="DS548811751" load-source="docdb">PT</country><country mxw-id="DS548858714" load-source="docdb">RO</country><country mxw-id="DS548811752" load-source="docdb">RS</country><country mxw-id="DS548911611" load-source="docdb">SE</country><country mxw-id="DS548811753" load-source="docdb">SI</country><country mxw-id="DS548894425" load-source="docdb">SK</country><country mxw-id="DS548911612" load-source="docdb">SM</country><country mxw-id="DS548909824" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA99624629" ref-ucid="WO-2012114073-A1" lang="EN" load-source="patent-office"><p num="0000">A service session resource manager (72) for use in a router (18) capable of routing a plurality of at least partially contemporaneous service sessions over a communications line is described which mediates between services competing for bandwidth. The service session manager (72) updates its internal state based on both mediation enabled (22b) and mediation non-enabled (22a) devices. The resource manager (72) comprises memory arranged to store a current resource utilisation indicator for a resource of said communications line, a service request processor arranged to process a new service session request from a client terminal to determine a required resource for said new service session over said communications line and to determine if the required resource is available in dependence on an available line rate and said current utilisation indicator, means to reserve the required resource, means to update said current utilisation indicator to indicate the allowed resource reservation; and means to respond to said requesting client that said resources have been reserved, wherein said current resource utilisation indicator is also updated by said service request processor to indicate a resource used by one or more service sessions established by one or more client terminals configured to send service requests over said communications line without requesting access to the service from said service session manager.</p></abstract><abstract mxw-id="PA99823213" ref-ucid="WO-2012114073-A1" lang="EN" source="national office" load-source="docdb"><p>A service session resource manager (72) for use in a router (18) capable of routing a plurality of at least partially contemporaneous service sessions over a communications line is described which mediates between services competing for bandwidth. The service session manager (72) updates its internal state based on both mediation enabled (22b) and mediation non-enabled (22a) devices. The resource manager (72) comprises memory arranged to store a current resource utilisation indicator for a resource of said communications line, a service request processor arranged to process a new service session request from a client terminal to determine a required resource for said new service session over said communications line and to determine if the required resource is available in dependence on an available line rate and said current utilisation indicator, means to reserve the required resource, means to update said current utilisation indicator to indicate the allowed resource reservation; and means to respond to said requesting client that said resources have been reserved, wherein said current resource utilisation indicator is also updated by said service request processor to indicate a resource used by one or more service sessions established by one or more client terminals configured to send service requests over said communications line without requesting access to the service from said service session manager.</p></abstract><abstract mxw-id="PA99624630" ref-ucid="WO-2012114073-A1" lang="FR" load-source="patent-office"><p num="0000">La présente invention se rapporte à un gestionnaire de ressource de session de service (72) adapté pour être utilisé dans un routeur (18) qui est apte à router une pluralité de sessions de service au moins partiellement concomitantes sur une ligne de communication. Le gestionnaire de ressource de sessions de service selon l'invention a pour objectif d'assurer une médiation entre des services qui sont en concurrence pour une bande passante. Le gestionnaire de session de service (72) met à jour son statut interne sur la base à la fois de dispositifs pouvant assurer une médiation (22b) et de dispositifs ne pouvant pas assurer une médiation (22a). Le gestionnaire de ressource (72) comprend une mémoire, configurée de façon à enregistrer un indicateur d'utilisation de ressource actuelle en rapport avec une ressource de ladite ligne de communication. Il comprend d'autre part un dispositif de traitement de demande de service, qui est configuré de façon à traiter une demande de nouvelle session de service transmise par un terminal client, dans le but de déterminer une ressource requise pour ladite nouvelle session de service sur ladite ligne de communication, et de déterminer si la ressource requise est disponible, sur la base d'un débit disponible de la ligne et dudit indicateur d'utilisation de ressource actuelle. Le gestionnaire de ressource de session de service comprend également : des moyens pour réserver la ressource requise ; des moyens pour mettre à jour ledit indicateur d'utilisation actuelle, dans le but d'indiquer que la réservation de ressource a été autorisée ; et des moyens pour répondre audit client ayant fait la demande que lesdites ressources ont été réservées. Selon la présente invention, ledit indicateur d'utilisation de ressource actuelle est lui aussi mis à jour par ledit dispositif de traitement de demande de service, dans le but d'indiquer une ressource utilisée par une ou plusieurs sessions de service établies par un ou plusieurs terminaux clients qui sont configurés de façon à envoyer des demandes de service sur ladite ligne de communication sans solliciter l'accès au service auprès dudit gestionnaire de session de service.</p></abstract><abstract mxw-id="PA99823214" ref-ucid="WO-2012114073-A1" lang="FR" source="national office" load-source="docdb"><p>La présente invention se rapporte à un gestionnaire de ressource de session de service (72) adapté pour être utilisé dans un routeur (18) qui est apte à router une pluralité de sessions de service au moins partiellement concomitantes sur une ligne de communication. Le gestionnaire de ressource de sessions de service selon l'invention a pour objectif d'assurer une médiation entre des services qui sont en concurrence pour une bande passante. Le gestionnaire de session de service (72) met à jour son statut interne sur la base à la fois de dispositifs pouvant assurer une médiation (22b) et de dispositifs ne pouvant pas assurer une médiation (22a). Le gestionnaire de ressource (72) comprend une mémoire, configurée de façon à enregistrer un indicateur d'utilisation de ressource actuelle en rapport avec une ressource de ladite ligne de communication. Il comprend d'autre part un dispositif de traitement de demande de service, qui est configuré de façon à traiter une demande de nouvelle session de service transmise par un terminal client, dans le but de déterminer une ressource requise pour ladite nouvelle session de service sur ladite ligne de communication, et de déterminer si la ressource requise est disponible, sur la base d'un débit disponible de la ligne et dudit indicateur d'utilisation de ressource actuelle. Le gestionnaire de ressource de session de service comprend également : des moyens pour réserver la ressource requise ; des moyens pour mettre à jour ledit indicateur d'utilisation actuelle, dans le but d'indiquer que la réservation de ressource a été autorisée ; et des moyens pour répondre audit client ayant fait la demande que lesdites ressources ont été réservées. Selon la présente invention, ledit indicateur d'utilisation de ressource actuelle est lui aussi mis à jour par ledit dispositif de traitement de demande de service, dans le but d'indiquer une ressource utilisée par une ou plusieurs sessions de service établies par un ou plusieurs terminaux clients qui sont configurés de façon à envoyer des demandes de service sur ladite ligne de communication sans solliciter l'accès au service auprès dudit gestionnaire de session de service.</p></abstract><description mxw-id="PDES50931033" ref-ucid="WO-2012114073-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="2"/>--><p id="p0001" num="0001"> SERVICE SESSION RESOURCE MANAGEMENT </p><p id="p0002" num="0002">This invention relates to service session resource management, in particular but not exclusively, to the management of bandwidth for concurrent use by multiple services in a local area network of devices. An example of such a local area network is one on the premises of a subscriber to a broadband communications access service, for example, one provided as part of a domestic or small business network installation to enable a plurality of devices to access services over a single broadband-enabled communications line. </p><p id="p0003" num="0003">There is expected to be a growing demand for simultaneous use of multiple services by devices located within the same local area network (LAN), which require concurrent use of a single broadband access line. This demand is driven by factors such as the availability of higher broadband speeds, the proliferation of multiple internet-enabled devices in the home, multi-user households, and an increasing amount of content available on the Internet, in particular the proliferation of video services. Managing the simultaneous use of a single broadband line for access to multiple services requires careful management of the available bandwidth over the access network as well as within the home network located on the service subscriber premises. </p><p id="p0004" num="0004">Generally, it is not possible for a broadband access service provider to determine what combination of services will be available to a customer at the point-of-sale of the broadband access service, nor even at the point-of-sale of any services predicated on having broadband access. For example, if a customer has two digital television decoders (often known as set-top boxes (STBs), although rarely actually placed on top of a television set), a broadband line rate of 10Mbps would allow both STBs to display a different streamed content channel simultaneously if each streamed content channel comprises a standard definition (SD) television (TV) channel, but if a high definition (HD) TV channel stream is required, the extra bandwidth it requires would preclude streaming of a second channel (SD or HD) over the broadband line. To implement an appropriate mediation service between multiple devices, real-time decisions must be made, at the point-of-use, about what can be done, without compromising access to services and the quality of service(QoS) of the services accessed. 
<!-- EPO <DP n="3"/>-->
 Figure 1 of the accompanying drawings show part of a communications system 10 in which data from one or more external data sources 12 is streamed via a Multi-Service Access Node (MSAN) 14 over a broadband access line 16 to an access point/router device 18 which provides broadband access to a plurality of user terminals 22, 24 located in a local area network 20 provided at the broadband access line service subscriber's premises. As shown in Figure 1 , the access point/router 18 also provides router support to the user terminals 22, 24 enabling multiple simultaneous internal sessions to occur over wired communications link(s) 26 (for example, Powerline and/or Ethernet links) and/or wireless communications links 28 (for example, WLAN or WIFI links) as well as supporting external sessions over access line 16 between the user terminals 22, 24 and external content source 16. An example of such an integrated access point/router 18 known in the art is the BT HomeHub™. Examples of user terminals include data consuming client devices 22, for example, devices which consume content data such as STBs, Internet Protocol (IP) enabled TVs, media streamers, tablet devices, audio/video players, computer devices and mobile/fixed telephone devices. Examples of user terminals also include data source devices 24 located within LAN 20. Data source devices 24 are connected to the router 18 internally by a wired or wireless communications link 26, 28 to distribute data such as content to data consuming devices 22. Examples of internal data source devices 24 include, for example, content source devices such as Personal Video Recorder (PVR) content storing devices, as well as any other device storing content such as computers, mobile telephones, and network attached storage (NAS) devices. The terms content and the equivalent term content data are well-known in the art and generally refer to data representing audio or video content which is played back on a content consuming device, for example, films, television programs, music files, games etc., and may have a multi-media data format. </p><p id="p0005" num="0005">Content data usually places a high demand for bandwidth resources to playback user terminals as well as processing resources on the playback user terminals. The need to reserve resources for a new service session to access a content delivery service has to be balanced against the need to maintain the quality of service experienced by established service sessions over which content is currently being delivered. In practice, unless the bandwidth available over both the access link 16 to the router 18 and over the internal links 26, 28 between the client devices 22, 24 with the router 18 is unlimited, some mediation process must be deployed. 
<!-- EPO <DP n="4"/>-->
 There are various methods for managing bandwidth over the access line to ensure that an appropriate balance between the above competing demands to access content and to maintain the QoS of the content delivered. </p><p id="p0006" num="0006">It is known, for example from International Patent specification WO 2007/081 171 , to obtain information to determine the correct amount of bandwidth to be reserved when streaming content from a server outside the home network. In this reference, an "external server" (in practice an external network comprising a plurality of servers) is model to determine the capacity required. United States Patent 6,738,819 describes a method for performing admission control based on network load monitoring. However, in both cases, the method is operated by the individual client devices, and does not provide support for any client devices that are unable to make direct use of this capability. The allocation process would be compromised for all the client devices unless the admission control is invoked by all of them. </p><p id="p0007" num="0007">Local bandwidth management techniques known in the art include those which implement Universal Plug and Play (UPnP) Quality of Service (QoS) architectures such as that described in "UPnP-QoS Architecture: 3, for UPnP Version 1 .0", adopted as a standardized DCP by the Steering Committee of the UPnP forum and dated: November 30<sup>th</sup> 2008, the contents of which are incorporated herein in their entirety by reference. This document describes a session management device which is suitable for providing a local bandwidth management capability to enable a video streaming client to determine whether or not it is safe to start a new video-on-demand (VoD) or linear TV stream (non-VoD IPTV) without adversely impacting any existing streams. This decision can be made on the basis of knowledge of the current broadband line rate, and associated limits, and knowledge of other VoD and linear TV services running on the same line, including how much bandwidth each is consuming. UPnP QoS enabled user terminals 22, 24 in such architectures are able to negotiate with a UPnP QoS enabled router 18 for bandwidth. The UPnP QoS router 18 mediates simultaneous use of multiple services over the same broadband line 16 and within the same network 20. For example, if a user is already using one service and an attempt is made to use a second service, and the combined bandwidth requirements of the two services exceeds the capacity either of the customer's broadband connection or of the 
<!-- EPO <DP n="5"/>-->
 local network 20 (e.g. if operating under the IEEE 802.1 1 wireless protocol known as "WiFi" then either the second attempt should be blocked or the existing connection must be suspended to allow the second one to be connected). The most effective mediation solution requires all of the user devices 22, 24 and router 18 to fully co-operate in the mediation process. However, this will be difficult to achieve unless all the user terminals 22, 24 connected to the router 18 support the mediation capability. </p><p id="p0008" num="0008">Figure 2 retains the numbering scheme of Figure 1 for like elements and shows how a UPnP quality of service (QoS) Service Manager receiving a request from a UPnP QoS user terminal 22 for a new session (step 30) would implement such a bandwidth mediation process. The UPnP QoS Service Manager determines the available line rate over the broadband access line (either by querying this or by retrieving a stored value) and determines from its internal state awareness of the broadband access lines resources it has currently reserved for use by existing sessions if sufficient resources are available to support the new service session (step 34). If the required resources are not available, for example, if providing the resources required to support the new service session would adversely impact the QoS of the services already being provided over the one or more other sessions, an appropriate response is sent to the requesting UPnP QoS client terminal denying access to the requested service (step 46). If the resources are available, however, then the UPnP QoS Service Manager reserves the resources (step 38) and updates its internal state (step 40) so that it retains knowledge of the resources reserved for future request management. The UPnP QoS Service Manager then sends a response to the requesting UPnP QoS client terminal indicating the session resources have been reserved (step 42) and the UPnP QoS client terminal 22 then starts the new session (step 44). </p><p id="p0009" num="0009">Figure 3 retains the numbering scheme of Figure 1 for like elements and shows schematically what might happen when a client terminal 22 without the UPnP capabilities and unable to co-operate in this way with the UPnP QoS Service Manager also requests a service over access line 16. In Figure 3, after a new session request is generated by a non-UPnP QoS enabled client terminal 22 (step 60) the new session starts to use resources over the broadband access line without prior reservation (step 62) (alternatively, it may reserve resources over the access line without reference to 
<!-- EPO <DP n="6"/>-->
 the UPnP QoS Service Manager). The consequent bandwidth utilisation means that existing sessions may have less bandwidth and so potentially experience a drop in their quality of service or even premature termination. As Figure 3 shows schematically, this use of the access line (62) affects the operation f UPnP QoS Service Manager, as its internal state is no longer accurate (64) described in Figure 2 in two ways. Firstly, as the new session uses resources not reserved by the UPnP QoS Service Manager and, in consequence, step (34) in Figure 2 will not retrieve the actual bandwidth utilised over the access line. Secondly, any sudden drop or termination of bandwidth utilisation by existing sessions impacted by the resource reservation (56) may also fail to be communicated to the UPnP QoS Service Manager. These effects mean that the UPnP QoS Service Manager will no longer have the correct internal state stored for the actual resource utilisation over the broadband access line. As a result, the on-going performance of the UPnP QoS Service Manager whilst the non-UPnP QoS client terminal 22 service session exists will be compromised as the QoS Service Manager will make decisions based on there being more bandwidth than is actually available for any given line rate over the broadband communications access line 16. Accordingly, depending on circumstances and the way the router 18 mediates data requests from client terminals, non-UPnP QoS client terminals may seize all the bandwidth they require without regard to any competing requirements, or be unable to get the bandwidth they require, or abruptly lose connections during a session without warning. Similarly, UPnP QoS service management supporting client terminals will suffer due to the UPnP QoS Service Manager lacking any knowledge of the bandwidth the non-UPnP QoS client terminal sessions are consuming over the access line. None of these outcomes result in a good experience for the user. </p><p id="p0010" num="0010">It is therefore desirable to provide a request mediation system which will operate on data requests from all terminals connected to a router without requiring any special capabilities in the individual terminals. </p><p id="p0011" num="0011">A first aspect of the invention seeks to provide a service session request interceptor arranged to intercept requests for data services generated by client terminals in a communications network, the interceptor comprising: means to receive service request 
<!-- EPO <DP n="7"/>-->
 generated by said plurality of client terminals; means to determine a destination address of a received service request; means to intercept a service request for content from a destination address determined to match one or more predetermined intercept- triggering destination addresses; means to determine for each said intercepted service request, a resource requirement for said requested service; means to forward a resource reservation request for the required resource to a resource manager, and means to forward the received request to said destination address in dependence on receiving an indication from said resource manager that the required resource has been reserved. </p><p id="p0012" num="0012">The required resource for the requested service may be derived from the destination address, and specifically from the universal resource locator addressed by said service request. Alternatively, the required resource may be indicated by the format and/or content of the universal resource locator. </p><p id="p0013" num="0013">The resource may comprise bandwidth over a wired or wireless communications link. </p><p id="p0014" num="0014">The service request interceptor may further comprise means arranged to process a reject request message from said resource manager, to extract information enabling concurrent service sessions for which resources have been reserved to be identified. </p><p id="p0015" num="0015">The service request interceptor may further comprise: </p><p id="p0016" num="0016"> means to intercept a service session request generated by a service requesting client terminal; </p><p id="p0017" num="0017"> means to determine at least one session resource required for fulfilment of said service session request to maintain one or more predetermined delivery criteria; means to determine at least one required session resource is not available; means to reject said service request; and </p><p id="p0018" num="0018"> means to provide information to said service requesting user terminal on at least one other service session utilising said at least one service session resource, whereby a user of said client terminal is able to receive said information and in dependence thereon selectively modifying said at least one of said at least one other service sessions. The service request interceptor may further comprise: 
<!-- EPO <DP n="8"/>-->
 means to generate an information identifier for the extracted information; means to generate a re-direct message including said information identifier; means to send said re-direct message including said information identifier to a client terminal from which the rejected service request originated; and </p><p id="p0019" num="0019"> means to provide to a requesting data server said extracted information responsive to receiving an message requesting said extracted information from the requesting data server, the message identifying the information requested using said information identifier. </p><p id="p0020" num="0020">The invention also extends to a system comprising a service request interceptor as defined above, in combination with a data-server, the data server comprising: </p><p id="p0021" num="0021"> means arranged to receive a message from a client terminal; </p><p id="p0022" num="0022"> means to extract a said information identifier from a said received message; means to generate said message to request information from said service request interceptor, the message including said information identifier, </p><p id="p0023" num="0023"> whereby, responsive to receiving said information from said service request interceptor, said data-server provides said information to said client terminal. </p><p id="p0024" num="0024">The invention also extends to a router for a local area network, the router being capable of routing a plurality of at least partially contemporaneous service sessions over a communications link, and including a service request interceptor as defined above, and further comprising a resource manager having: </p><p id="p0025" num="0025"> means to store a current resource utilisation indicator for a resource of said communications link; </p><p id="p0026" num="0026"> means to receive service session requests requiring resource reservation over said communications link; </p><p id="p0027" num="0027"> means to process received requests and to reserve a required resource if available over said communications link in dependence on said current resource utilisation indicator and a determination of the maximum resource availability over said communications link, </p><p id="p0028" num="0028"> wherein said current resource utilisation indicator is updated by said service request processor responsive to requests being received from said service request interceptor to indicate a resource used by one or more service sessions established by one or more client terminals configured to send service requests over said 
<!-- EPO <DP n="9"/>-->
 communications line without requesting access to the service from said service session manager. </p><p id="p0029" num="0029">The router may further comprise: </p><p id="p0030" num="0030"> a plurality of user ports, each port for connection to a said client terminal, an external connection port; </p><p id="p0031" num="0031"> switching means for transmitting data, and requests for data, between the ports, and said external connection port; </p><p id="p0032" num="0032"> a line speed checker; </p><p id="p0033" num="0033"> one or more data processors arranged to implement said service session resource manager and arranged for processing service session data requests received at each port and to select which service session requests are to be forwarded to the external connection port. Alternatively, the interception is performed on the router but all other functionality required to establish the resource reservation requirement, make the resource reservation request, and make a decision on the request may be implemented outside the router component, for example, on a PC, STB, NAS or another component adjunct to the router, or in a central network location. </p><p id="p0034" num="0034">According to a further aspect, the invention provides a method of service session resource management in which requests for data services generated by client terminals in a communications network are intercepted; </p><p id="p0035" num="0035"> a destination address of each received service request is determined; </p><p id="p0036" num="0036"> identifying service requests for content to be retrieved from destination addresses determined to match one or more predetermined intercept-triggering destination addresses; </p><p id="p0037" num="0037"> determining for each said intercepted service request, a required resource for said requested service; </p><p id="p0038" num="0038"> generating a resource reservation request for the required resource, and determining if the required resource is available </p><p id="p0039" num="0039"> if the required resource is available, reserving the required resource, forwarding the received request to said destination address if the required resource has been reserved. 
<!-- EPO <DP n="10"/>-->
 The method may further comprise updating a current resource utilisation indicator to indicate a resource used by one or more service sessions established by one or more client terminals configured to send service requests over said communications line without requesting access to the service from said service session manager. </p><p id="p0040" num="0040">The method may further comprise intercepting a service session request generated by a service requesting client terminal; determining at least one session resource required for fulfilment of said service session request to maintain one or more predetermined delivery criteria; determining at least one required session resource is not available; rejecting said service request; and providing information to said service requesting user terminal on at least one other service session utilising said at least one service session resource, whereby a user of said client terminal is able to receive said information and in dependence thereon selectively modifying said at least one of said at least one other service sessions. </p><p id="p0041" num="0041">In this way, when a client terminal which does not support UPnP QoS Service Management attempts to request a service which will use "premium" bandwidth over a access network communications link, for example by requesting a service which uses bandwidth reserved for packets forming data streams which have priority levels above a best effort forwarding class, other services also using the premium bandwidth are less likely to be unexpectedly or adversely impacted, as the UPnP QoS Service Manager can now monitor such client terminal bandwidth utilisation. </p><p id="p0042" num="0042">The resource manager is preferably a Universal Plug and Play (UPnP) Quality of Service (QoS) Service Manager of the type specified in a UPnP QoS Service Management Architecture standards, such as version three of the standard. </p><p id="p0043" num="0043">The communications link may comprise a line hosting a broadband access link such as an Asynchronous Digital Subscriber Line (ADSL) link or other type of DSL link, and the resource over said communications line may comprise the bandwidth available using said broadband access link. Alternatively, the communications link may comprise an internal link with a plurality of devices within a local area network connected via a router on which said service session resource manager is located. 
<!-- EPO <DP n="11"/>-->
 The communications link may comprise wireless or wired communications channels and may be internal to other client devices or external to the LAN. </p><p id="p0044" num="0044">Where appropriate, a router device is configured to hold an estimate of the capacity of the available bandwidth (or equivalently data rate) over the communications channel and makes this available to the QoS Service Session Manager. The value indicated to the QoS Service Session Manager (or used by the QoS Service Session Manager) is preferably slightly less than the theoretical bandwidth or data rate available. For example, when the router makes a value of the bandwidth available over a wireless channel, this can be reduced (either by the router or by the QoS Service Manager) by, for example, anything from 10% below to 10% of the theoretical rate available. Similarly, embodiments in which an electrical power-line is used as a communications link, for example, a connection between a device and an Ethernet interface on the router device 18, may require adjustment of the actual bandwidth to a lower value to allow for a safety margin. </p><p id="p0045" num="0045">A broadband access link may be provided using a copper, cable, optical, or wireless (e.g. 3G, WiMax, etc,) link. A new service session request may be intercepted by a service request interceptor to determine its resource requirement, whereby the determined resource requirement is forwarded by the service request interceptor in a service session resource reservation request to said service request processor. The service session resource manager may further comprise means to cause an error message to be sent to one of said one or more clients if it is determined from said resource utilisation indicator there is insufficient resource for a new service session requested by said one of said one or more clients. If it is determined from said resource utilisation indicator that there is sufficient resource for the new service session requested by one of said one or more client terminals configured to send service requests over said communications line without requesting access to the service from said service session manager, said service session resource manager may reserve resources for said new service session. 
<!-- EPO <DP n="12"/>-->
 The error message may indicate one or more existing sessions using said resource over said communications line. </p><p id="p0046" num="0046">The client terminal receiving said error message may further request session preference information to be provided by a user of the terminal to indicate if the new service session or one or more indicated existing service sessions is preferred by the user, wherein responsive to said session preference information being communicated to said service session resource manager, said service session resource manager reserves resources in accordance with said session preference information. </p><p id="p0047" num="0047">If said session preference information indicates a user preference for the new service session over an existing service session, session preference information identifying said existing service session may be communicated to a router or to an external data source or remote access server at the server end of said communications line, wherein said router or external data source or remote access server modifies the existing service session and/or terminates said service session in accordance with said user preference information. </p><p id="p0048" num="0048">The existing service session may be modified to increase or reduce a reserved resource used by the existing service session identified in said session preference information. </p><p id="p0049" num="0049">The existing service session identified in said session preference information may be terminated. The resource may comprise bandwidth over said communications line. </p><p id="p0050" num="0050">A service session may be for a data stream. The data stream may comprise audio and/or video content data. In principle this could be extended to non-audio/video traffic e.g. VPN traffic in a homeworker environment. The service session manager may comprise a UPnP-enabled quality of service (QoS) service manager and said current resource utilisation indicator may be updated by said service request processor to indicate a resource used by one or more service sessions established by one or more client terminals not supporting UPnP quality of service service management which are configured to send service requests over said 
<!-- EPO <DP n="13"/>-->
 communications line without requesting access to the service from said UPnP-enabled quality of service service manager. </p><p id="p0051" num="0051">Another aspect of the invention comprises a method of service session resource management in a router capable of routing a plurality of service sessions between a plurality of client terminals over a communications line, the method comprising: storing a current resource utilisation indicator for a resource of said communications line; processing a new service session request from one of said plurality of client terminals to determine a required resource for said new service session over said communications line; determining if resources are available for said requested service session in dependence on an available line rate and said current utilisation indicator; reserving the required resource; updating said current utilisation indicator to indicate the allowed resource reservation; and responding to said client that said resources have been reserved, wherein the method further comprises: updating said current resource utilisation indicator to indicate a resource used by one or more service sessions established by one or more client terminals configured to send service requests over said communications line without requesting access to the service from said service session manager. Another aspect of the invention comprises a router for a local communications network comprising a plurality of client terminals, the router including a service session resource manager according to an above aspect of the invention. </p><p id="p0052" num="0052">The router may further comprise: a plurality of user ports, each port for connection to a said client terminal, an external connection port; switching means for transmitting data, and requests for data, between the ports, and said external connection port; a line speed checker; and one or more data processors arranged to implement said service session resource manager and arranged for processing service session data requests received at each port and to select which service session requests are to be forwarded to the external connection port. </p><p id="p0053" num="0053">One or more of the user ports may have an associated service request interceptor, the associated service request interceptor having: terminal identification means for identifying a user terminal attached to a respective one of said one or more user ports; interception means for intercepting service session data requests received at said one 
<!-- EPO <DP n="14"/>-->
 or more user ports and any response data generated by the service session resource manager; data adaptation means for adapting any said response data generated by the service session resource manager; transmission means to forward the adapted response data to the user terminal connected to the port, wherein the router is further configured to update said current resource utilisation indicator of said service session resource manager to indicate a resource used by one or more intercepted service session data requests. </p><p id="p0054" num="0054">Another aspect of the invention relates to: a router for a local communications network having: a plurality of user ports for connection to a plurality of user terminals, switching means for transmitting data, and requests for data, between the ports and an external connection port, and a mediation processor having: a request processor to process data requests received at each port and select which data requests are to be forwarded to the external connection port, and </p><p id="p0055" num="0055"> a response processor to return response data relating to the data requests to the respective port from which the request was received; wherein one or more of the user ports has an associated service request interceptor, the associated service request interceptor having: terminal identification means for identifying a user terminal attached to the user port, interception means for intercepting data requests received at the port, and response data generated by the mediation processor, data adaptation means for generating response data adapted to the user terminal connected to the port. </p><p id="p0056" num="0056">The associated service request interceptor acts as a proxy, allowing "legacy" user terminals not equipped with the mediation tools to co-operate in the negotiation for bandwidth. In particular, it may allow the router to be informed of the bandwidth required by the device, or of any priority it should be given (for example by identification of the data requested, or by a user-generated password allowing one user to be given priority in mediating requests for data. The service request interceptor may also generate data in a form suitable for display on the user device, for example to inform the user why a data request has been refused or an existing data stream is to be terminated, to cause any necessary disconnection to take place in a "graceful" manner. </p><p id="p0057" num="0057">The service request interceptor may also be arranged to resubmit a request that has been previously refused or interrupted when demand for bandwidth reduces to a level where the request can be accommodated, for example, by prompting the client to 
<!-- EPO <DP n="15"/>-->
 resubmit a previously rejected request which the SRI then intercepts and forwards to the QoS service manager. </p><p id="p0058" num="0058">Another aspect of the invention seeks to provide a service session resource mediator for a communications line used by both resource mediation enabled client terminals and resource mediation non-enabled client terminals, the resource mediator comprising: means to receive service session resource requests; means to determine availability of a requested resource; means to respond to a received service session resource request to indicate said request is granted; wherein said means to determine availability of a requested resource includes a determination of the resource utilisation by services requested by both resource mediation enabled and non-resource mediation enabled client terminals. </p><p id="p0059" num="0059">The invention therefore is capable of providing a non-UPnP QoS Service Management supporting client terminal with information on other service sessions using resources which have prevented an service request from the client terminal from being accepted, the method by intercepting the service request from the client terminal; generating a request identifier for the service request; and generating a traffic descriptor for said requested service; forwarding said traffic descriptor for the service request to an extended UPnP QoS Service Manager; receiving a reject message from said extended UPnP QoS Service Manager which includes error information including information identifying said other service sessions and said traffic descriptor; determining the request identifier for said reject request from said traffic descriptor; storing the error information in association with the determined request identifier; generating a redirect message including said request identifier and the address of a web-server arranged to dynamically generate error information; sending the redirect message to said client terminal. At the client terminal, in response to receipt of a said redirect message, an HTTP request is directed to said web-server which includes said request identifier. The web-server which receives said HTTP request, including said request identifier, processes the HTTP request: by extracting said request identifier; generating a request for error information including the extracted request identifier; sending said request to said service request interceptor; receiving error information retrieved by said service request interceptor locating said error information using said request identifier; and generating a web-page containing said error information, whereby the client terminal displays said web-page so generated. 
<!-- EPO <DP n="16"/>-->
 The aspects and embodiments of the invention are as set out herein above and in the accompanying independent and dependent claims, which may be combined in any manner apparent to one of ordinary skill in the art. </p><p id="p0060" num="0060">A quality of service condition may comprise one or more of: a predetermined range of latency, variable delay, encoding quality, colour saturation, perceived mean opinion score on image quality or the like. The resource may comprise one or more of the following: bandwidth over a broadband access line to an access point via which the client terminal is provided with access to said broadband line; bandwidth over a communications channel to the service requesting device on a wired or wireless path between the service requesting device and an access point via which the client terminal is provided with access to a broadband line; bandwidth over a communications channel to the service requesting device on a wired or wireless path between the service requesting device and a service-providing one of said plurality of client terminals arranged to provide said requested service; bandwidth over a communications channel to a service providing device on a wired or wireless path between the service requesting device and said service-providing device. </p><p id="p0061" num="0061">Embodiments of the invention will now be described with reference to the accompanying figures which are by way of example only and in which: Figure 1 is a schematic depiction of a communications system in which content data is consumed by a plurality of different devices within a local area network; </p><p id="p0062" num="0062">Figure 2 is a flow diagram showing steps in a method of implementing UPnP QoS Service Management in a router shown in the local area network of Figure 1 ; </p><p id="p0063" num="0063">Figure 3 is a schematic depiction of the impact of a session generated by a client terminal not supporting UPnP QoS Service Management on the method shown in Figure 2; 
<!-- EPO <DP n="17"/>-->
 Figure 4 is a schematic depiction of a router including a service session resource manager according to an embodiment of the invention together with a plurality of user devices co-operating therewith; Figure 5a is a flow diagram showing steps in a method of implementing service session resource management according to an embodiment of the invention; </p><p id="p0064" num="0064">Figure 5b is a flow diagram showing steps in a method of implementing service session resource management according to an alternative embodiment of the invention; </p><p id="p0065" num="0065">Figure 6 is a flow diagram showing the additional steps in performed in a method of implementing service session resource management according to another embodiment of the invention; Figure 7 is a flow diagram showing the steps in performed by a method of implementing service session resource management according to yet another embodiment of the invention; </p><p id="p0066" num="0066">Figure 8 shows in more detail how an HTTP redirect is implemented to communicate a service request being denied access by the UPnP QoS service manager in the embodiment of the invention shown in Figure 5b; </p><p id="p0067" num="0067">Figure 9 shows the flow of messages for resource reservation and subsequent refresh for an embodiment of the invention; </p><p id="p0068" num="0068">Figure 10a shows how the QoS Service Manager is informed when an IGMP service session terminates according to an embodiment of the invention; and </p><p id="p0069" num="0069">Figure 10b shows how the QoS Service Manager is informed when an HTTP service session terminates according to an embodiment of the invention; </p><p id="p0070" num="0070">Figure 1 1 shows how resource requirements are determined for HTTP and IGMP intercepted service requests; and 
<!-- EPO <DP n="18"/>-->
 Figure 12 shows an alternative way of determining resource requirements for HTTP and IGMP service requests. </p><p id="p0071" num="0071">The best mode of the invention as currently contemplated by the inventors will now be described with reference to the accompanying drawings. </p><p id="p0072" num="0072">Figure 4 shows an access point/router 18 according to an embodiment of the invention in which the functionality of a router is associated with the functionality provided by an access point to a broadband access line 16 as shown in Figure 1. Alternatively, a separate access point and router may be used to implement the invention. The access point/router functionality shall be referred to herein by the term "router" hereinafter unless the context indicates otherwise. </p><p id="p0073" num="0073">As shown in Figure 4, router 18 includes a root device 70 comprising means to reserve resources for maintaining the QoS of service sessions established over an external port (not shown) connected to broadband access line 16. Root device 70 includes a number of embedded devices 72, 74 configured to support various services and bandwidth mediator means arranged to mediate between concurrent service session requests competing for bandwidth over the access line to manage the quality of service of the requested service sessions. The mediator means is implemented by using a service session resource or Quality of Service (QoS) manager 72, for example, a service session resource manager such as an UPnP QoS service manager as shown in Figure 4. QoS Manager 72 (also referred to herein equivalently as a resource manager or QoS service Manager or UQoSM) conventionally comprises components generally conforming to the Third Version of the UPnP QoS Manager Device Control Protocol (DCP) standards entitled UnP QoSManager:3 Service Template Version 1.01 for UPnP Version 1.0, dated November 30, 2008, the contents of which are incorporated in their entirety by reference into this description, and which, at the time of writing, is available to download from http://www.upnp.org/specs/qos/UPnP-qos-QosManaqer-v3- Service.pdf which is conventionally deployed in an architecture conforming to the Third Version of the UPnP QoS Architecture DCP standards entitled "UPnP-QoS Architecture^ For UPnP Version 1 .0", Status: Standardized DCP, Date: November 30, 2008, the contents of which are incorporated in their entirety by reference into this 
<!-- EPO <DP n="19"/>-->
 description, and which, at the time of writing, is available to download from http://www.upnp.org/specs/qos/UPnP-qos-Architecture-v3.pdf . </p><p id="p0074" num="0074">According to the invention the UQoSM 72 is arranged to receive QoS service requests from a service request interceptor (SRI) 76 also using standard UPnP QoS v3 protocol information in addition to or instead of receiving requests from UPnP QoS service management enabled client terminals 22b. The SRI 76 intercepts service requests generated by client terminals 22a (or 24a if such data-provided terminals are at this point functioning as a client terminal receiving data) which have no capability of using the UPnP QoS Service Management protocol generally (or specifically version 3 if the client terminal is to receive information back on competing service sessions). The SRI processes intercepted requests to determine sufficient information to generate a service request compliant with the version of the UPnP QoS Service Management communications protocol the UQoSM 72 is operating under in order to ensure the requirement for one or more predetermined delivery conditions are met, for example, for a predetermined level of QoS to be provided according to the invention when fulfilling the service request. </p><p id="p0075" num="0075">The SRI 76 determines the resources which are required, such as bandwidth, and by providing this information to the UQoSM 76, the state of resource utilisation internally stored by the UQoSM 72, for example, the bandwidth resource utilisation over broadband communications access 16 line (or any internal channel) is updated by the UQoSM 72. In this way, UQoSM 72 updates its internal state both as a result of the UQoSM 72 receiving service requests from any UPnP QoS service management supporting client terminals 22b (also referred to herein as "mediating client terminals") for which it reserves resources such as bandwidth, and, as a result of the service request interceptor (SRI) 76 generating requests for non-mediating client terminals 22a. SRI 76 does this by monitoring a plurality of ports (not shown) on router 18 which face client terminals 22, 24 and by intercepting service requests which conform to predetermined interception criteria (which may change dynamically in certain circumstances, see later herein belowO. The requests intercepted are from client terminals 22a which do not support the UPnP QoS Service Management provided by QoS Service Manager 72. Client terminals 22a not supporting UPnP QoS Service Management is also referred to 
<!-- EPO <DP n="20"/>-->
 herein as "non-UPnP QoS Service Management supporting client terminals" or non- mediating client terminals. </p><p id="p0076" num="0076">As mentioned above, although reference is made herein to client terminals 22a, b comprising user terminals which consume content, the internal content source devices 24 shown in Figure 1 may also comprise such content consuming devices 22a, b. </p><p id="p0077" num="0077">The SRI is preferably configured to only intercept requests for so called premium content services which comprise services for which the packets in the data stream provided in response to the service request being accepted would have a packet priority class above best efforts for data forwarding purposes. Such services are also known as "premium bandwidth" service, as they use bandwidth resolvable for packets which have a priority class above best efforts for data forwarding purposes. Some non-premium bandwidth requests are eliminated from the intercept process by virtue of not having a destination IP address which matches a destination IP address for a premium bandwidth service server. Where a destination IP address is recognised, the HTTP request carried as payload within the TCP packet is also examined using some suitable mechanism, for example, through deep-packet inspection. If the HTTP request contains a universal resource locator for the data requested which corresponds to a premium bandwidth service the HTTP request is intercepted by the SRI 76. If, however, the HTTP request relates to another service available from the same destination address which is not a premium bandwidth service in that it requires merely best-efforts packet forwarding for the data requested, the service request intercepted is released by the SRI to be forwarded on to its destination. </p><p id="p0078" num="0078">As shown in Figure 4, QoS Service Manager 72 is arranged to invoke a QoS Device Service 80 in an Internet Gateway Embedded Device 74 in response to receiving a service session request from a client terminal 22b which supports UPnP QoS service management. </p><p id="p0079" num="0079">The service request interceptor (SRI) 76 monitors a plurality of ports on the router 18 which face local network 20 from which client terminals 22a, b generate service requests. Service requests from a client terminal 22b pass through SRI 76 without interception to be processed by QoS Service Manager 72. However, when a service 
<!-- EPO <DP n="21"/>-->
 request from a client terminal 22a is received on a port monitored by the SRI 76, the service request is intercepted. If it is determined that the request for a service that will be delivered using premium bandwidth, the SRI 76 does not allow the intercepted service request to be forwarded out over the port which externally faces broadband access line 16 until the QoS Service Manger 72 has indicated sufficient resources are available and has updated its internally stored state of resource utilisation with the resources that the required for the intercepted service request. </p><p id="p0080" num="0080">The amount of resource utilisation which the QoS Service Manager 72 updates its internal stored state of resource utilisation over broadband access line 16 is determined by the SRI 76 in one embodiment, but may be determined by QoS Service Manager 72 in others. For example, each intercepted service request for a content stream generated by client terminal 22a is analysed to determine its resource requirements (such as, for example, it's forwarding class, priority, and bandwidth requirements). One way of determining resource requirements is to identify the type of media characteristics associated with a requested content stream. If the content stream requested comprises a standard definition or high definition television channel, for example, the SRI 76 generates a service resource request for that amount of bandwidth from QoS Service Manager 72. This enables QoS Service Manager to determine if the relevant amount of bandwidth is available and if so, to reserve this over the communications line 16. Examples of the types of client terminals 22a which do not support the UPnP QoS Service Management at the present time of writing include, for example, client terminals running a BBC iPlayer, iTunes, Apple™ TV content consuming applications. </p><p id="p0081" num="0081">In one embodiment of the invention, when a client terminal 22a is first connected to a port on router 18, a client control module identifies the device and generates a service request interceptor application. The role of each SRI application is to intercept HyperText Transport Protocol (HTTP) service requests and Internet Group Management Protocol (IGMP) service requests from client devices 22a not having the mediation capability, such as those which do not support UPnP QoS Service Management if the QoS service session manager 72 comprises a UQoSM 72. </p><p id="p0082" num="0082">As mentioned above, the HTTP and IGMP service requests are analysed by the SRI application to determine the resources the data delivered in response to the service 
<!-- EPO <DP n="22"/>-->
 request from external data source 12 will require over broadband access line 16. Once the broadband access line resource(s) required to fulfil a requested service has been analysed the SRI application invokes the QoS Service Manager 72 with a request to reserve the required resources. QoS Service Manager 72 processes the request to determine if the required resources are available and if so, sends a response to the SRI 76 to allow the service request to be forwarded to its destination. QoS Service Manager 72 then updates its internal data store indicator to indicate the resources which the service request will use over the broadband access line. For non-UPnP QoS Service Management Supporting client terminals 22a, the SRI 76 must provide details of the bandwidth required to fulfil a given delivery condition to UQoSM 72, so that the UQoSM 72 can reserve resources to maintain a predetermined quality of service, for example, a QoS specified in a delivery or service policy in terms of a requested service being provided within predetermined range of variable delay or latency in the data stream to be delivered to the client terminal. </p><p id="p0083" num="0083"> UQoSM 72 determines if sufficient bandwidth resource is available to fulfil the service request by retrieving the current available line speed over the broadband access line 16 either from memory or by dynamically querying a line speed checker 82. The UQoSM 72 functions as a QoS and resource manager in that it determines if the available line speed can support the additional bandwidth resource required to fulfil the service request by determining if the additional bandwidth resource required exceeds the bandwidth resource available as determined by subtracting the total resource utilisation indicator for utilisation of bandwidth over the broadband access line stored in its internal memory from the line currently available line rate. </p><p id="p0084" num="0084">If sufficient bandwidth is available, the service request is granted. The UQoSM 72 reserves the required resources so that a level of QoS in accordance with the resource requirement sent by the SRI 76 can be maintained. The UQoSM 72 updates its internal state and sends a response back to the client terminal 22b or SRI 76 as appropriate. </p><p id="p0085" num="0085">If sufficient bandwidth is not available, the service request is denied. The UQoSM 76 sends a response back indicating the request is rejected. The SRI 76 then processes the request and generates an appropriate error message in the communications protocol used by client terminal 22a to generate the service request (e.g. an HTTP 
<!-- EPO <DP n="23"/>-->
 error message is sent to the client terminal if this has used HTTP to generate the service request, and an IG P error message is sent if this communications protocol was used to generate the service request). The cause of the service request rejection by the QoS Service Manager 72 may be indicated in the reject message it generates. The service denial may be indicated as due to the line rate being insufficient or due to other services on the line. The SRI 76 may include this information in the error message it generates for transmission to the client in a format appropriate to the device type. If bandwidth is unavailable, the QoS Service Manager supplies details of on-going sessions so that the client terminals 22a and/or client terminals 22b can display an appropriate message to users in one embodiment of the embodiment. </p><p id="p0086" num="0086">In this way, by providing a SRI 76 to intercepts IMGP and HTTP service requests from client terminals 22a which themselves do not have the capability to negotiate resources to fulfil the service requests they generate, QoS Service Manager 72 is able to successfully monitor bandwidth utilisation of the broadband access line and is able to mediate between the bandwidth requirements of data streams over broadband access line 16 to both types of client terminals 22a, b located within local network 20. This means that even when a plurality of service sessions having the same data forwarding class (i.e., whose packets have the same priority level over the broadband access line) are running at least in part contemporaneously, a bandwidth resource mediation policy can be implemented by the UQoSM 72 to maintain a relatively good QoS for all service sessions allowed. </p><p id="p0087" num="0087">Turning now to Figure 5a, steps in a method of service session resource management according to an embodiment of the invention are shown in which non-mediation enabled client terminal 22a, shown here as a client terminal 22a which does not support UPnP QoS service management, generates a service session request (step 90). The request is generated using HTTP or IGMP or some other suitable communications protocol in order for client terminal 22a to receive a data stream over broadband access line 16. SRI 92 intercepts the service session request (step 92). </p><p id="p0088" num="0088">Turning now briefly to Figure 8 of the accompanying drawings, the criteria used by the SRI 76 to intercept the service session request message will now be described. Figure 
<!-- EPO <DP n="24"/>-->
 8 shows how error messages are handled for the embodiment of the invention shown in Figure 5b where a HTTP redirect is generated to enable the client terminal to receive some error information when its service request is dropped at the point after interception by the Service request interceptor (SRI) 76. As shown in Figure 8, client terminal 22a generates a service request. Packets which have an IP destination address known to be a particular content source server address are intercepted by the SRI 76. The SRI 76 then examines the contents of the packets to determine they comprise and HTTP request for a particular Universal Resource Locator (URL). The resource requirements are determined using the URL which conforms to a naming convention so that the URL itself is associated with bandwidth requirements or alternatively, can be determined using meta-data or tagged information such as Figure 12 describes. The information on bandwidth required to satisfy one or more levels of QoS for a given URL is stored either locally on the router 18 so it can be locally retrieved by SRI 76 or, if stored remotely on some suitable data server, SRI 76 is configured to remotely retrieve the bandwidth (and any other information providing the resource requirements needed to maintain a given QoS for the content to be delivered) from the relevant data server. A basic data retrieval operation uses the URL from the request (or the multicast address of an IGMP request) as a search index, for example, a look-up operation, which then retrieve the resource requirements for the given URL from the corresponding data record/entry. </p><p id="p0089" num="0089">As mentioned above, this requires the URL to correspond to naming convention in which the URL itself indicates the relevant resource requirement for the traffic stream requested (or from which the requirements can be determined by reference to data record using the URL). Whilst the resources are likely to be retrieved, in some instances it may be possible for the SRI 76 to calculate them based on information retrieved. For example, if the URL corresponds to a content stream for a high definition VoD or a high definition linear TV service, the SRI can calculate the required bandwidth to maintain an agreed QoS for the high-priority packet forwarding class associated with that stream over the broadband access line to the router 18 (and also internally, if the session is from an internal content source for which an IP address has been allocated which triggers the interception process). </p><p id="p0090" num="0090">A means to subsequently identify the traffic stream to be delivered in response to the service request being accepted in the form of a session identifier or the like is also 
<!-- EPO <DP n="25"/>-->
 generated by the SRI in order to be included in the service resource request it sends to the QoS Service Manager 72. A session identifier may comprise a RequestTrafficQoSO conforming to the required UPnP QoS Service Management standard format. A RequestTrafficQoSO message has one parameter which is an InitialTrafficDescriptor. The InitialTrafficDescriptor includes a Trafficld (which comprises Source address, source port, Destination address, destination port and IP protocol) and an AvailableOrderedTspecList (which contains one or more Traffic Specifications (Tspecs), A Tspec specifies the bandwidth required. Thus, by generating a Tspec for the non-UPNP QoS client terminal 22a, which the QoS Service Manager can then use, the SRI effectively ensures that the UQoSM operates more efficiently for UPnP Service supporting client terminals as well as for enabling non QoS client terminals to experience a level of QoS as determined by the parameters passed to the service request interceptor 76 based on the multi-cast IGMP address used or the specific URL from which a content stream is being requested. Advantageously, this means that content distributors can provide a QoS maintained service to all devices, and not just those devices which are preconfigured to implement UPnP QoS Service Management. </p><p id="p0091" num="0091">Returning now to Figure 5a, the SRI 76 analyses the resources required to send the requested data stream over the broadband access line 16 (step 94) as described in more detail herein below. The SRI 76 will determine from the resources required a suitable session identifier which is communicated to the QoS Manager 72, and in some embodiments will also generate a RequestID to facilitate reporting error information to the client terminal if the request is rejected by a QoS Manager 72. The SRI 76 then queries the QoS Manager 72 with the relevant session information, having created a data record associating the session identifier (or alternatively traffic stream characteristics) with the request identifier by generating a service session resource reservation request. A QoS Manager 72 comprises here a resource mediating service session resource manager 72, shown here as a UPnP QoS Service Manager (also referred to as a UPnP QoS Manager (UQoSM)) (step 96), preferably of the type which implements the latest UPnP QoS service management standard, currently version three. The service session resource reservation request preferably comprises a QM: RequestExtendedTrafficQosQ type of message which includes means to identify the 
<!-- EPO <DP n="26"/>-->
 traffic stream of the service request. For example, a</p><p id="p0092" num="0092">QM:RequestExtendedTrafficQos() nc\u6es a Trafficld (which may include a source address, source port, destination address, and destination port), and one or more traffic specification (TSpecs) which specify bandwidth preferences for the traffic stream requested. </p><p id="p0093" num="0093">In step 94, the SRI determines the bandwidth required and includes this in the traffic specification in the service session resource reservation request which is sent to the UPnP QoS Manager (UQoSM) 72. UQoSM 72 receives the service session resource reservation request and processes it to determine if the resource required, for example, the bandwidth required is available (step 30) and any other information to be returned to SRI 76. </p><p id="p0094" num="0094">The UQoSM 72 invokes a UPnP Service QoS Device 80 to determine the current line rate, for example, the Qos Device 80 may query a line speed checker 82 dynamically or retrieve a previously stored value from memory to which the line speed checker may push line speed updates (step 32). The UQoSM 72 then determines the current resource utilisation of the line from its internal state record (step 34), and determines the bandwidth available of the line is sufficient by comparing the bandwidth requested with the line speed less the current resource utilisation indicated by its internal state data record. If there is not enough bandwidth, the UQoSM 72 sends a UPnP reject message to the SRI 76 (step 102), which then adapts the reject message contents to a form suitable for returning to the service requesting client terminal 22a (step 104a), and the service request is dropped. If the original service request comprised an IGMP service request, no error message is communicated back to the client terminal. </p><p id="p0095" num="0095">Figure 5b shows an alternative way of communicating error information to a client terminal in which an HTTP service request was originally generated by a client terminal in which the SRI 76 sends an HTTP redirect message back to the requesting client terminal (step 104b) when it drops the client's service request. This enables the client terminal to determine information on other service sessions using resources over said access line and/or internally within LAN 20. </p><p id="p0096" num="0096">If, however, the UQoSM 72 determines there are sufficient bandwidth resources for the service session requested to not adversely impact any existing service sessions, it 
<!-- EPO <DP n="27"/>-->
 reserves the resources (step 38). The UPnP QoS service Manager 72 will normally consider the impact the new service will have on sessions having the same data forwarding class and/or packet prioritisation level, so that, for example, competing sessions in the same data forwarding class and/or having the same packet prioritisation level are appropriately mediated as these otherwise have equivalent ranking for the resource. The UQoSM then updates its internal state to indicate the new resource utilisation (step 40), and indicates to the SRI that the resource is available (step 98) so that the SRI 76 forwards the service session request to its external destination (step 100). </p><p id="p0097" num="0097">Such a resource manager requires the ICT 76 to send a service session resource request in the form of a RequestTrafficQoSExtended() message (i.e., one which conforms to the V3 standard). This has the same parameter value as the RequestTrafficQosO message of earlier standards, which is an InitialTrafficDescriptor, but more information is generated and returned by the QoS Manager in response, for example, a list of blocking sessions may be returned if the request is rejected. The InitialTrafficDescriptor includes a TrafficID (which comprises Source Address (SA), source port (on the router 18), Destination Address, destination port (on the router 18) and IP protocol), a AvailableOrderedTspecList (which contains one or more TSpecs), A Tspec will specify the bandwidth required. Whilst all traffic identifying fields are optional, where the SRI 76 is aware of the information it is preferably to include the information in the TrafficID passed to the QoS Manager 72. The trafficID is created by looking at the relevant flow parameters. The Tspec is created by looking up the bandwidth associated with certain terms in the URL or associated with certain multicast addresses. The lookup may be local if this information has been configured into the router 18 or remote. </p><p id="p0098" num="0098">The embodiments of the invention thus enable a UQoSM 72 to receive an indication of resource requirements such as the required bandwidth for a traffic stream which is requested by a non-UPnP QoS Service Management supporting client terminals as the SRI 76 determines the bandwidth from the URL structure. </p><p id="p0099" num="0099">Figure 6 shows an extension of the method shown in Figure 5b which follows on from steps 102, and 104 In Figure 6, responsive to an HTTP redirect message being received (step 104)the client terminal 22a sends a query to a remote web-server 103 
<!-- EPO <DP n="28"/>-->
 (step 106) and receives information from a remote web-server 103 (see Figure 8) identifying other service sessions which are using resources and blocking service request generated by the client terminal 22a (step 108). As shown in Figure 6, this information is displayed on the service requesting client terminal 22a to enable input from a user of the client terminal 22a to indicate a preference for the new service over any of the existing services. If the user indicates negatively, not further action is taken (step 114). Accordingly, building on from step 104b in Figure 5b, a list of blocking sessions is returned and presents the user with the option of terminating one of those sessions. There is then an interaction between the user and the web server 103 and the client terminal 22a uses a web browser to enable these HTTP interactions to be supporting and so can remain non QoS-aware. For client terminals such as STBs, TVs etc, a web-browser may have limited functionality and comprise a basic application (rather than a web-browser such as, for example, Internet Explorer™ such as would be familiar from a personal computer context). </p><p id="p0100" num="0100">If, however, the user indicates there is a preference for the new service, the client terminal 22a responds to the web-server 103, which is configured to generate preferred session information which is sent to the SRI 76 which identifies which session is to be terminated and/or which session is to be retained. The SRI then responds to the UQoSM 72 which can then terminate any unwanted session(s) (step 1 10). Alternatively, the web-server 103 may display sufficient information on the alternative sessions for the client terminal or a user of the client terminal to send a request to another device receiving a data stream in a non-preferred service session to terminate that service session or to a remote data source or to the broadband remote access server to terminate the stream. Either way, after a suitable time during which the unwanted service session terminates, the client device 22a regenerates the service session request for the preferred service (step 1 12). </p><p id="p0101" num="0101">Accordingly, by providing an SRI which generates a redirect messages responsive to HTTP service requests being rejected, a list of blocking sessions can be returned to the client terminal whose request has been rejected so that a user of the client terminal can be provided with the option of terminating one of the blocking sessions. To support this interaction between the user and the web server 103, the client terminal must provide suitable means for the interaction to be supported, such as a web browser which can 
<!-- EPO <DP n="29"/>-->
 support the HTTP interaction. This enables the client terminal 22a to remain non QoS- aware. </p><p id="p0102" num="0102">The pre-emption mechanism supported by the uPnP QoS v3 communications protocol is for the UQpS 72 to terminate an existing session as part of the processing of a new request, based on some policy which may or may not involve interaction with the end- user. However, such a policy based approach is not suitable for non-uPnP QoS clients and so a web page approach using the above HTTP redirect which needs the client terminal 22a to re-request a new session once the user has terminated the existing session is required. </p><p id="p0103" num="0103">This can be implemented by re-directing the client terminal back to the original URL following the session termination list page. Or alternatively to display a prompt the user to try again. The client would need to be provided a sufficiently flexible browser to support all the above interactions for this to work. </p><p id="p0104" num="0104">The Requestld is embedded in redirected HTTP service request by using an agreed convention for the structure of URLs for re-directs, for example, one which includes the Requestld as a parameter. As it is the SRI that both generates the URL and subsequently processes it (as a delegate of the webserver), the convention is established as part of the SRI design. </p><p id="p0105" num="0105">Figure 7 of the accompanying drawings shows another embodiment of a method of managing service sessions according to an embodiment of the invention in which a mediating service session resource manager 72, shown as a UPnP QoS Service Manager receives a service session request from a mediation enabled client terminal 22b, shown as a UPnP QoS-enabled client terminal (step 30). The UPnP QoS Service Manager (UQoSM) 72 determines the available line rate either by retrieving this from a data store or by querying a line speed checker (step 32). The UPnP QoS Service Manager 72 has awareness of the current resource utilisation of the broadband access line (step 34) and the UQoSM 72 determines if sufficient resources are available for said service request based on the current available line rate and its awareness of the current resource utilisation rate of the line (Step 36). If resources are available, the method proceeds to reserve resources (step 38) and update the internal awareness state of the UQoSM 72 regarding the bandwidth utilisation (step 40), and a suitable 
<!-- EPO <DP n="30"/>-->
 response is sent to UPnP QoS-enabled client terminal 22b (step 42) after which the session starts 9step 44). If, however, resources are not available, a UPnP service reject message is sent to client terminal 22b (step 46) which includes details of the existing services using resources over the access line 16 concurrent with its receipt of the service request. The client terminal 22b in this embodiment is configured to display the other existing sessions and to prompt the user for a preference between the new and/or existing service sessions (step 48). If response indicates the new service takes preference over an existing service session, the preference information is sent to the UQoSM 72 so that this can terminate the non-preferred service session and/or a request is sent to an external data server and/or traffic marker to modify the existing traffic stream's traffic characteristics (for example, to lower its forwarding class and/or packet prioritisation level). The client terminal 22a then waits an appropriate amount of time to allow the non-preferred service session to terminate and then regenerates a service session request for the preferred service. </p><p id="p0106" num="0106">Returning now to Figure 8 if the resource manager 72 rejects the service request, it will generate a reject message which is returned to the SRI 76 which identifies the traffic stream rejected using a traffic descriptor. The reject message may contain error information which the SRI 76 is configured to communicate to the client terminal, for example, if the rejected request was an extended QoS request then the response may list the traffic streams which are currently occupying resources. </p><p id="p0107" num="0107">In this case, the SRI generates a redirect message which includes some means of identifying the error information relating to the rejected service session. Examples of an error information identifier include a RequestID to associate the information with the request received which can be generated by the SRI 76 or, alternatively, when a reject message is retrieved a RequestReject ID may be generated by the SRI and used instead. In either case, the SRI 76 includes the information identifier when it generates the redirect message for sending to the client terminal so that error information can be subsequently provided to the client terminal. This means that when the SRI drops the service request, a client terminal acting on the redirect message it receives contacts a data server 103 as indicated in the redirect. When the data server (or equivalently web-server) 103 receives the redirected HTTP request from client terminal 22a it dynamically generates a web-page providing details of other sessions which have blocked the request. The information is provided by the error information retrieved by 
<!-- EPO <DP n="31"/>-->
 querying the SRI 76 using the information identifier provided by the client terminal in the redirect. </p><p id="p0108" num="0108">In this case, the SRI generates a redirect message which includes some means of identifying the rejected service session. Although the UPnP QoS Management traffic descriptor could be used for identifying the request to the UQoSM 72, could be used, it is preferable if a simpler data structure is utilised instead. As the request has been rejected, no traffic handle has been generated yet of the kind used for the lease refresh, and so the RequestID stored when the request was generated by the SRI 76 is retrieved using the SessionID (i.e., using a Traffic descriptor) and the RequestID is then sent to the client as part of the redirect message, so that when the SRI drops the service request from the client, the client can be provided with information indicating why the request has been rejected from a web-server 103 which is provided with error information by the SRI 76. </p><p id="p0109" num="0109">Accordingly, when SRI 76 receives a request reject message, it extracts the relevant error information, such as a list of the blocking traffic streams currently utilising resources over the broadband access line 16 (or if internally, which are occupying internal resources of LAN 20) and stores this in association with the Request ID. SRI 76 then generates a redirect message which is sent to the client terminal 22a which includes the RequestID. The client terminal 22a then generates a new service request to the redirect URL at web-server 103 which includes the service request's RequestID which the SRI generated. The web-server 103 extracts the RequestID, and dynamically generates the web-page requested by querying the SRI 76 with the requestlD. The SRI 76 processes the request for error information from the Web Server 103, extracts the RequestID, and retrieves the relevant error information. The error information in the response sent to the Web Server 103 enables the Web Server 103 to dynamically generate the relevant error information in a web-page which is then displayed on the client terminal. </p><p id="p0110" num="0110">Figure 9 of the attached drawings shows how bandwidth reserved by a QoS Manager 72 for a traffic stream requested by a non-QoS supporting client terminal 22a is maintained for the duration of the relevant traffic stream. As shown in Figure 9, SRI 76 intercepts an HTTP or IGMP service request from a non-UPnP QoS Service Management supporting client terminal 22a. The appropriate amount of resource 
<!-- EPO <DP n="32"/>-->
 required to fulfil the request with a predetermined level of QoS, for example, the bandwidth required for the traffic stream to receive by the client terminal 22a with a particular QoS (which may be dependent on the packet priority and/or forwarding class as well as the specific multi-cast address of an IGMP request or URL of an HTTP request) is determined by the SRI 76. The SRI 76 then includes the resource requirements for the required QoS for the requested service when it generates a service session resource request in a conventional UPnP QoS Service Management format. The request generate by SRI 76 also includes means of subsequently identifying the traffic stream requested, for example, it may generate a UPnP QoS Traffic Identifier which comprises a Traffic Descriptor including a traffic specifier (TSpec). </p><p id="p0111" num="0111">If the QoS Manager 72 accepts the request, it reserves bandwidth, updates its internal state and generates an accept message of the appropriate type which will include a TrafficHandle to allow the resource reservation to be maintained over a period of time exceeding the default lease period after which the QoS manager 72 would automatically release the resources required (a lease may be as short as a few minutes, so that the QoS manager can tidy up on a relatively rapid scale if there are any problems). This Traffic Handle is returned together with the TrafficID and Tspec data and stored locally by the Service Request Interceptor 76. </p><p id="p0112" num="0112">Once accepted, the SRI 76 forwards the service request to the remote data server 12 which responds with the requested traffic stream. Whilst traffic is streamed to client terminal 22a, the SRI 76 monitors the flow of packets which are routed {out over a monitored ?} towards the service requesting client terminal which have a source IP address for the data server known to be associated with a particular traffic stream. The monitoring can be performed using any suitable flow monitoring technique known in the art, such as counting packets. SRI 76 generates refresh messages which identify each monitored traffic stream (as more than one may be monitored at any given time if a plurality of streams is being received by devices within LAN 20). The refresh resource reservation messages sent to QoS Service Manager 72 comprise UpdateTrafficQoSExtendedQ messages in accordance with the current version of the UPnP QoS Service Management standards which include the Traffic Handle which is returned by the QoS Manager in response to 
<!-- EPO <DP n="33"/>-->
 the original RequestTrafficQoSQ message being accepted. This is necessary as reservations in UPnP-QoS v3 results in finite network resource(s) being allocated for a particular traffic stream, which if no longer required must be freed so other streams or applications can use the resources. If a timer expires with no explicit release of the reservation having been received with the lease period of time, it is assumed that the reservation is no longer needed and the reservation and resources are released. To extend the lease period of time, the UpdateTrafficQoSExtendedQ message is sent to the QoS Service Manager 72. Figure 10A shows how resources are released when an IGMP multicast session terminates. In Figure 10A, which continues from Figure 9, the SRI 76 continues to monitor the flow until an IGMP leave message is generated, at which point it sends a specific release message in accordance with the relevant UPnP QoS standard to which the UQoSM 76 conforms, which may then release the reservation and resources. An alternative is to simply cease to send UpdateTrafficQoS message for a flow for which a IGMP leave message has been received but this would not be a preferred solution. Figure 10B shows how Figure 9 would continue until a HTTP monitored traffic stream ceases to be received by client terminal 22a. In this case, the SRI 76 monitor the connection and intercept a TCP close connection message, which then would result in either a specific release message being sent to the QoS Service Manager 72, or, as mentioned above, another option although less tidy, would to just not send a refresh message. </p><p id="p0113" num="0113">Figure 1 1 shows in more detail how for non-uPnP clients the SRI 76 needs to determine resource requirements from the URL (http) or the multicast address (IGMP). In the case of http we have the option of embedding meta-data tags in the HTTP request (this is shown separately in Figure 12). </p><p id="p0114" num="0114">As shown in Figure 1 1 , the SRI 76 monitors all packets received on a client terminal facing port on router 18 and if it determines they are IGMP packets directed to a known multi-cast source or if the packets have a destination IP address for which a data record exists in a resource reservation data store (step 92a) it intercepts them. </p><p id="p0115" num="0115">The data store may comprise a database or just a file in which IP Addresses are listed which correspond to an IP address for a remote data store 12 (or alternatively, internal data sources 20a). 
<!-- EPO <DP n="34"/>-->
 All non-intercepted traffic is simply allowed to proceed towards its destination (101 ). If, however, the SRI intercepts an IGMP packet, the multi-cast destination address is used to retrieve the resource requirements for the stream requested (94a). If the SRI intercepts a packet which matches a IP address which the SRI is configured to filter on, the payload of the intercepted packet is inspected (94b) to determine if it comprises an HTTP request (94b) including a URL for a data server (12, 24). The remote data servers 12 may require resources to be reserved over the access link for the sessions established with the data consuming client terminal 22a. If a data consuming client terminal 22a has requested content from an internal data source 24, such as one which is distributing data in accordance with the Digital Live Network Alliance, the session resource requirements are internal within LAN 20. </p><p id="p0116" num="0116">The URL is then extracted and used by the SRI to perform a lookup operation to determine the resource requirements, if any, it will need to indicate to the QoS Service Manager (94c). Once the resources are known, the SRI queries the QoS Service Manager to request reservation of the required resources (96). </p><p id="p0117" num="0117">Rather than perform a look-up, the URL itself may convey sufficient information about the resource required to enable the SRI to directly determine resources it needs QoS Service Manager to reserve for the requested service. For example, part of the URL path can identify the type of content associated with that URL e.g. http://sd . cdd . bt. net/toy story3-sd . avi for a standard definition traffic stream service request and http://hd.cdd.bt.net/toy storv3-hd.avi for a high definition traffic stream service request. A lookup is needed to determine for each standard definition or high definition channel identifiable from the service request the required bandwidth unless a URL is provided which indicates this and any other essential parameters of the traffic specification (Tspec), (including whether premium bandwidth is required at all) that the SRI 76 needs to provide to the UQoSM 72. By recognising the definition required from the URL itself, the SRI 76 use the corresponding bandwidth requirements for the relevant broadband access line 16 to request sufficient resources from the QoS Service Manager 72. </p><p id="p0118" num="0118">Figure 12 shows an alternative in which rather than the URL indicate the bandwidth, when a user selects a content item (step 89a) using a client application, the client 
<!-- EPO <DP n="35"/>-->
 application is configured to capture meta-data associated with the selected content item which is then included as a tag in the service request for that content item (step 89b). In this case, if the client terminal hosting the client application does not support UPnP QoS Service Management, the SRI 76 when it intercepts the service request for the selected content item (92), it extracts the meta-data provided in the form of a tag embedded within the service request) (94d) and determines the resource requirements (94e) from the meta-data tag. The resource requirements are then used in the traffic descriptor the SRI generates to provide to the UQoSM to reserve appropriate resources for the traffic stream corresponding to the requested content item (96). </p><p id="p0119" num="0119">All of the Figures described herein retain the numbering scheme for like elements unless specifically distinguished in the description. </p><p id="p0120" num="0120">Thus a Service Request Interceptor (SRI) 76 according to the invention is configured to apply a filter to traffic passing through ports facing client terminals in LAN 20 and filters out requests from non-UPnP QoS capable client devices so that the QoS Service Manager functions correctly and so that such clients can still receive a QoS managed service. The SRI 76 generates sufficient information to emulate the type of information that the UPnP Control Point would generate and include in a traffic descriptor to be included in a QoS Service Request. </p><p id="p0121" num="0121">In systems implementing the invention where adaptive bit rate is used which enables the encoded version a data stream received to be changed, repeat HTTP requests may be generated for different encoded versions. In such embodiments, the SRI 76 must perform an additional look up operation for each new HTTP request received after it has determined the source address, destination address and port facing the client terminal 22a and port facing the data server 12,24 to see the same ports are already being used to receive an existing traffic stream. If they are, the HTTP request is determined to relate to an earlier request at a different adaptive bit rate ;i.e., to a different encoded version. Alternatively, the same determination can be made from the URL of the HTTP request if this conforms to a suitable naming convention. If the request received is a repeat HTTP request for a reservation which is to be maintained, the new HTTP request is linked to the earlier request and no additional request is forwarded to UQoSM 76 unless a change in the resource reservation requirements is determined and the original data stream is maintained. One way of managing this is at 
<!-- EPO <DP n="36"/>-->
 the Transmission Control Protocol (TCP) level as multiple HTTP requests can be serviced over the same TCP connection. As long as HTTP requests are capable of being seen to be occurring as part of the same TCP connection, they do not need to be processed any further. </p><p id="p0122" num="0122">There is a danger that delaying intermediate HTTP requests will lead to jittery VideoOnDemand services. One way of limiting jitter is if a criterion for a first level of intercept (either at the IP layer or the application layer) is updated whenever a new HTTP reservation is in place. This prevents blocking of subsequent HTTP requests in the same flow as. the interception criteria changes from intercept all IP packets to known VoD IP addresses to all IP packets to known VoD addresses except packets with a specific source address (or more preferably with a specific source and destination port. In this way, the SRI applies a dynamically variable level of service request interception. </p><p id="p0123" num="0123">The client may also be configured to repeat service requests to the SRI 76, and the SRI 76 may be configured, instead of forwarding a reject from UQoSM 72 to the client terminal, to redirect the client terminal and wait for input from a user to be received by said web-server 103 regarding whether a user has a preference for the current session over another on-going session. If the user selects another on-going session, then the SRI 76 may send a repeat service session resource reservation request to the UQoSM 72 after a predetermined period of time has elapsed or in response to a suitable trigger event indicating another service session has been terminated. The service request interceptor may also be arranged to prompt a client terminal to resubmit a request that has been previously refused or interrupted when demand for bandwidth reduces to a level where the request can be accommodated </p><p id="p0124" num="0124">The text of the abstract repeated below forms part of the description: A service session resource manager for use in a router capable of routing a plurality of at least partially contemporaneous service sessions over a communications line is described which mediates between services competing for bandwidth. The service session manager updates its internal state based on both mediation enabled and mediation non-enabled devices. The resource manager comprises memory arranged to store a current resource utilisation indicator for a resource of said communications line, a service 
<!-- EPO <DP n="37"/>-->
 request processor arranged to process a new service session request from a client terminal to determine a required resource for said new service session over said communications line and to determine if the required resource is available in dependence on an available line rate and said current utilisation indicator, means to reserve the required resource, means to update said current utilisation indicator to indicate the allowed resource reservation; and means to respond to said requesting client that said resources have been reserved, wherein said current resource utilisation indicator is also updated by said service request processor to indicate a resource used by one or more service sessions established by one or more client terminals configured to send service requests over said communications line without requesting access to the service from said service session manager. </p><p id="p0125" num="0125">Persons of ordinary skill in the art will be aware of modifications and/or functional alternatives to one or more of the features described in the above embodiments and that features may have been omitted from the detailed description for the sake of brevity where their inclusion as a feature of the invention is apparent. The scope of the claimed invention should accordingly be determined from the accompanying claims when construed appropriately using the description in accordance with the knowledge of such persons of ordinary skill in the art and not limited to the literal examples. described herein. 
</p></description><claims mxw-id="PCLM44726981" ref-ucid="WO-2012114073-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="38"/>-->CLAIMS </claim-statement><claim id="clm-0001" num="1"><claim-text>1. A service request interceptor arranged to intercept requests for data services generated by client terminals in a communications network, the interceptor comprising: means to receive service requests generated by said plurality of client terminals; </claim-text><claim-text> means to determine a destination address of a received service request; </claim-text><claim-text> means to intercept a service request for content from a destination address determined to match one or more predetermined intercept-triggering destination addresses; </claim-text><claim-text> means to determine for each said intercepted service request, a required resource for said requested service; </claim-text><claim-text> means to forward a resource reservation request for the required resource to a resource manager, and </claim-text><claim-text> means to forward the received request to said destination address in dependence on receiving an indication from said resource manager that the required resource has been reserved. </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. A service request interceptor as claimed in claim 1 , wherein the required resource for the requested service is derived from the destination address. </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. A service request interceptor as claimed in claim 1 , wherein the required resource for the requested service is derived from a universal resource locator addressed by said service request. </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. A service request interceptor as claimed in claim 3, wherein the required resource is indicated by the format and/or content of the universal resource locator. </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. A service request interceptor as claimed in any previous claim, wherein the required </claim-text><claim-text>resource comprises bandwidth over a wired or wireless communications link. <!-- EPO <DP n="39"/>--> </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. A service request interceptor as claimed in any previous claim, further comprising: </claim-text><claim-text> means arranged to process a reject request message from said resource manager to </claim-text><claim-text>extract information enabling concurrent service sessions for which resources have been </claim-text><claim-text>reserved to be identified. </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. A service request interceptor according to claim 6, comprising: </claim-text><claim-text> means to intercept a service session request generated by a service requesting client terminal; </claim-text><claim-text> means to determine at least one session resource required for fulfilment of said service session request to maintain one or more predetermined delivery criteria; means to determine at least one required session resource is not available; means to reject said service request; and </claim-text><claim-text> means to provide information to said service requesting user terminal on at least one other service session utilising said at least one service session resource, whereby a user of said client terminal is able to receive said information and in dependence thereon selectively modifying said at least one of said at least one other service sessions. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. A service request interceptor as claimed in claim 6, further comprising: </claim-text><claim-text> means to generate an information identifier for the extracted information; means to generate a re-direct message including said information identifier; means to send said re-direct message including said information identifier to a client terminal from which the rejected service request originated; and </claim-text><claim-text> means to provide to a requesting data server said extracted information <!-- EPO <DP n="40"/>--> responsive to receiving an message requesting said extracted information from the requesting data server, the message identifying the information requested using said information identifier. </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9, A service request interceptor system comprising: </claim-text><claim-text> a service request interceptor as claimed in claim 8; and </claim-text><claim-text> a data-server, the data server comprising: </claim-text><claim-text> means arranged to receive a message from a client terminal; </claim-text><claim-text> means to extract a said information identifier from a said received message; means to generate said message to request information from said service request interceptor, the message including said information identifier, </claim-text><claim-text> whereby, responsive to receiving said information from said service request interceptor, said data-server provides said information to said client terminal. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. A router for a local area network, the router capable of routing a plurality of at least partially contemporaneous service sessions over a communications link, the router including a service request interceptor as claimed in any one of previous claims 1 to 8 and further comprising: </claim-text><claim-text> a resource manager comprising: </claim-text><claim-text> means to store a current resource utilisation indicator for a resource of said communications link; </claim-text><claim-text> means to receive service session requests requiring resource reservation over said communications link; </claim-text><claim-text> means to process received requests and to reserve a required resource if <!-- EPO <DP n="41"/>--> available over said communications link in dependence on said current resource utilisation indicator and a determination of the maximum resource availability over said communications link, </claim-text><claim-text> wherein said current resource utilisation indicator is updated by said service request processor responsive to requests being received from said service request interceptor to indicate a resource used by one or more service sessions established by one or more client terminals configured to send service requests over said communications line without requesting access to the service from said service session manager. </claim-text></claim><claim id="clm-0011" num="11"><claim-text>11. A router for a local communications network according to claim 10, the router comprising: </claim-text><claim-text> a plurality of user ports, each port for connection to a said client terminal, an external connection port; </claim-text><claim-text> switching means for transmitting data, and requests for data, between the ports, and said external connection port; </claim-text><claim-text> a line speed checker; </claim-text><claim-text> one or more data processors arranged to implement said service session resource manager and arranged for processing service session data requests received at each port and to select which service session requests are to be forwarded to the external connection port. </claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. A method of service session resource management in which requests for data services generated by client terminals in a communications network are intercepted: a destination address of each received service request is determined; </claim-text><claim-text> identifying service requests for content to be retrieved from destination addresses determined to match one or more predetermined intercept-triggering destination addresses; </claim-text><claim-text> determining for each said intercepted service request, a required resource for said requested service; </claim-text><claim-text> generating a resource reservation request for the required resource, and determining if the required resource is available </claim-text><claim-text> if the required resource is available, reserving the required resource, <!-- EPO <DP n="42"/>--> forwarding the received request to said destination address if the required resource has been reserved. </claim-text><claim-text>13 A method according to claim 12, wherein the method further comprises: </claim-text><claim-text> updating a current resource utilisation indicator to indicate a resource used by one or more service sessions established by one or more client terminals configured to send service requests over said communications line without requesting access to the service from said service session manager. 14. A method according to claim 12 or claim 13, the method further comprising: intercepting a service session request generated by a service requesting client terminal; </claim-text><claim-text> determining at least one session resource required for fulfilment of said service session request to maintain one or more predetermined delivery criteria; </claim-text><claim-text> determining at least one required session resource is not available; </claim-text><claim-text> rejecting said service request; and </claim-text><claim-text> providing information to said service requesting user terminal on at least one other service session utilising said at least one service session resource, whereby a user of said client terminal is able to receive said information and in dependence thereon selectively modifying said at least one of said at least one other service sessions. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
