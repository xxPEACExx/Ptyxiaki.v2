<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2677927-A1" country="EP" doc-number="2677927" kind="A1" date="20140101" family-id="43881460" file-reference-id="306794" date-produced="20180826" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146551710" ucid="EP-2677927-A1"><document-id><country>EP</country><doc-number>2677927</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12701265-A" is-representative="NO"><document-id mxw-id="PAPP154825633" load-source="docdb" format="epo"><country>EP</country><doc-number>12701265</doc-number><kind>A</kind><date>20120123</date><lang>EN</lang></document-id><document-id mxw-id="PAPP196210804" load-source="docdb" format="original"><country>EP</country><doc-number>12701265.6</doc-number><date>20120123</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140447031" ucid="GB-201103008-A" load-source="docdb"><document-id format="epo"><country>GB</country><doc-number>201103008</doc-number><kind>A</kind><date>20110222</date></document-id></priority-claim><priority-claim mxw-id="PPC140454436" ucid="GB-2012050134-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>GB</country><doc-number>2012050134</doc-number><kind>W</kind><date>20120123</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988125142" load-source="docdb">A61B   5/08        20060101AFI20120911BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL1988096496" load-source="docdb" scheme="CPC">A61B   5/7203      20130101 LA20131214BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988108516" load-source="docdb" scheme="CPC">A61B   5/0004      20130101 LI20131205BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988119639" load-source="docdb" scheme="CPC">A61B   5/6801      20130101 LI20131205BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988122148" load-source="docdb" scheme="CPC">A61B   5/0809      20130101 LI20131205BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988123453" load-source="docdb" scheme="CPC">A61B   5/7207      20130101 LI20131214BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988131108" load-source="docdb" scheme="CPC">A61B   5/0816      20130101 FI20131214BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988133473" load-source="docdb" scheme="CPC">A61B   5/053       20130101 LI20131205BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132187614" lang="DE" load-source="patent-office">ATMUNGSÜBERWACHUNGSVERFAHREN UND -SYSTEM</invention-title><invention-title mxw-id="PT132187615" lang="EN" load-source="patent-office">RESPIRATION MONITORING METHOD AND SYSTEM</invention-title><invention-title mxw-id="PT132187616" lang="FR" load-source="patent-office">PROCÉDÉ ET SYSTÈME DE SURVEILLANCE RESPIRATOIRE</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR918139932" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>TOUMAZ UK LTD</last-name><address><country>GB</country></address></addressbook></applicant><applicant mxw-id="PPAR918168328" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>TOUMAZ UK LIMITED</last-name></addressbook></applicant><applicant mxw-id="PPAR918991663" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Toumaz UK Limited</last-name><iid>101388407</iid><address><street>115 Olympic Avenue, Building 3</street><city>Milton Park Abingdon, Oxfordshire OX14 4SA</city><country>GB</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918151939" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>HERNANDEZ-SILVEIRA MIGUEL</last-name><address><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR918136652" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>HERNANDEZ-SILVEIRA, Miguel</last-name></addressbook></inventor><inventor mxw-id="PPAR918980970" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>HERNANDEZ-SILVEIRA, Miguel</last-name><address><street>c/o Toumaz UK Limited 115 Olympic Avenue, Building 3 Milton Park Abingdon</street><city>Oxfordshire OX14 4SA</city><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR918165113" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>ANG SU-SHIN</last-name><address><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR918155420" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>ANG, Su-Shin</last-name></addressbook></inventor><inventor mxw-id="PPAR918994367" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>ANG, Su-Shin</last-name><address><street>c/o Toumaz UK Limited 115 Olympic Avenue, Building 3 Milton Park Abingdon</street><city>Oxfordshire OX14 4SA</city><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR918145121" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>BURDETT ALISON</last-name><address><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR918171008" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>BURDETT, ALISON</last-name></addressbook></inventor><inventor mxw-id="PPAR918990803" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>BURDETT, ALISON</last-name><address><street>27 East Street</street><city>Oxford Oxfordshire OX2 0AU</city><country>GB</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918986921" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Lind, Robert</last-name><iid>100038618</iid><address><street>Marks &amp; Clerk LLP Fletcher House Heatley Road The Oxford Science Park</street><city>Oxford OX4 4GE</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="GB-2012050134-W"><document-id><country>GB</country><doc-number>2012050134</doc-number><kind>W</kind><date>20120123</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012114080-A1"><document-id><country>WO</country><doc-number>2012114080</doc-number><kind>A1</kind><date>20120830</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS548818205" load-source="docdb">AL</country><country mxw-id="DS548947530" load-source="docdb">AT</country><country mxw-id="DS548818206" load-source="docdb">BE</country><country mxw-id="DS548935740" load-source="docdb">BG</country><country mxw-id="DS548841366" load-source="docdb">CH</country><country mxw-id="DS548923880" load-source="docdb">CY</country><country mxw-id="DS548947531" load-source="docdb">CZ</country><country mxw-id="DS548818207" load-source="docdb">DE</country><country mxw-id="DS548923881" load-source="docdb">DK</country><country mxw-id="DS548923882" load-source="docdb">EE</country><country mxw-id="DS548939489" load-source="docdb">ES</country><country mxw-id="DS548935741" load-source="docdb">FI</country><country mxw-id="DS548935746" load-source="docdb">FR</country><country mxw-id="DS548818208" load-source="docdb">GB</country><country mxw-id="DS548923883" load-source="docdb">GR</country><country mxw-id="DS548818209" load-source="docdb">HR</country><country mxw-id="DS548947532" load-source="docdb">HU</country><country mxw-id="DS548841367" load-source="docdb">IE</country><country mxw-id="DS548818210" load-source="docdb">IS</country><country mxw-id="DS548935747" load-source="docdb">IT</country><country mxw-id="DS548923884" load-source="docdb">LI</country><country mxw-id="DS548938100" load-source="docdb">LT</country><country mxw-id="DS548947533" load-source="docdb">LU</country><country mxw-id="DS548938101" load-source="docdb">LV</country><country mxw-id="DS548938102" load-source="docdb">MC</country><country mxw-id="DS548869382" load-source="docdb">MK</country><country mxw-id="DS548869383" load-source="docdb">MT</country><country mxw-id="DS548939490" load-source="docdb">NL</country><country mxw-id="DS548947538" load-source="docdb">NO</country><country mxw-id="DS548869384" load-source="docdb">PL</country><country mxw-id="DS548923885" load-source="docdb">PT</country><country mxw-id="DS548939491" load-source="docdb">RO</country><country mxw-id="DS548923886" load-source="docdb">RS</country><country mxw-id="DS548939492" load-source="docdb">SE</country><country mxw-id="DS548923887" load-source="docdb">SI</country><country mxw-id="DS548869385" load-source="docdb">SK</country><country mxw-id="DS548869386" load-source="docdb">SM</country><country mxw-id="DS548841368" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA99624615" ref-ucid="WO-2012114080-A1" lang="EN" load-source="patent-office"><p num="0000">A method of determining a respiration rate from a signal representative of a recorded respiration episode comprises identifying two or more uncorrupted segments within the signal, the uncorrupted segments being separated by corrupted segments, identifying the longest of the uncorrupted segments or the segment with a lowest average absolute deviation (AAD) between respiration peaks or troughs, and determining a respiration rate from the longest uncorrupted segment or the segment with the lowest AAD.</p></abstract><abstract mxw-id="PA99823201" ref-ucid="WO-2012114080-A1" lang="EN" source="national office" load-source="docdb"><p>A method of determining a respiration rate from a signal representative of a recorded respiration episode comprises identifying two or more uncorrupted segments within the signal, the uncorrupted segments being separated by corrupted segments, identifying the longest of the uncorrupted segments or the segment with a lowest average absolute deviation (AAD) between respiration peaks or troughs, and determining a respiration rate from the longest uncorrupted segment or the segment with the lowest AAD.</p></abstract><abstract mxw-id="PA99624616" ref-ucid="WO-2012114080-A1" lang="FR" load-source="patent-office"><p num="0000">La présente invention concerne un procédé de détermination d'une fréquence respiratoire à partir d'un signal représentatif d'un épisode de respiration enregistré qui comprend l'identification de deux segments non corrompus ou plus dans le signal, les segments non corrompus étant séparés par des segments corrompus, l'identification du plus long des segments non corrompus ou du segment avec le plus faible écart absolu moyen (AAD) entre les pics ou vallées de respiration, et la détermination d'une fréquence de respiration à partir du plus long segment non corrompu ou du segment avec le plus faible AAD.</p></abstract><abstract mxw-id="PA99823202" ref-ucid="WO-2012114080-A1" lang="FR" source="national office" load-source="docdb"><p>La présente invention concerne un procédé de détermination d'une fréquence respiratoire à partir d'un signal représentatif d'un épisode de respiration enregistré qui comprend l'identification de deux segments non corrompus ou plus dans le signal, les segments non corrompus étant séparés par des segments corrompus, l'identification du plus long des segments non corrompus ou du segment avec le plus faible écart absolu moyen (AAD) entre les pics ou vallées de respiration, et la détermination d'une fréquence de respiration à partir du plus long segment non corrompu ou du segment avec le plus faible AAD.</p></abstract><description mxw-id="PDES50931026" ref-ucid="WO-2012114080-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="2"/>--><p id="p0001" num="0001"> Respiration Monitoring Method and System </p><p id="p0002" num="0002">Field of the Invention </p><p id="p0003" num="0003"> This invention relates to a respiration monitoring method and a system for carrying out the same. Aspects of the invention also relate to a processor for a respiration monitoring system. </p><p id="p0004" num="0004">Background to the Invention </p><p id="p0005" num="0005"> Many systems for processing respiration signals and extracting patient respiration rates involve techniques that demand high computational power due their mathematical complexity and/or require multiple sensors for the simultaneous acquisition of reference signals used to reduce noise levels in the signals of interest. However, because such systems require long processing times and large memories, they are unsuitable for use in low-cost wearable wireless devices which are battery-operated and therefore require low power consumption. </p><p id="p0006" num="0006">It is also known to determine respiration rates by employing simple frequency or time- domain analysis based on zero-crossing and/or threshold-based peak detectors. While these techniques can be employed in relatively accurate devices with low computational cost, they rely on a history of continuously acquired correct breath detections for adjusting threshold levels and other variables so as to permit future correct breath detections. In addition, these simple time-domain algorithms are incapable of identifying either those signals corrupted by patient motion or those that are erratic and clinically irrelevant such as those resulting from talking, coughing or swallowing. </p><p id="p0007" num="0007">It is therefore an aim of the present invention to provide a respiration monitoring method and system that addresses at least some of the aforementioned problems. Summary of the Invention </p><p id="p0008" num="0008"> According to a first aspect of the present invention there is provided a method of determining a respiration rate from a signal representative of a recorded respiration episode, the method comprising identifying two or more uncorrupted segments within said signal, the uncorrupted segments being separated by corrupted segments, identifying the longest of the uncorrupted segments or the segment with a lowest 
<!-- EPO <DP n="3"/>-->
 average absolute deviation (AAD) between respiration peaks or troughs, and determining a respiration rate from the longest uncorrupted segment or the segment with the lowest AAD. Embodiments of the present invention therefore provide a method capable of selecting and processing only good quality sections of data from a respiratory waveform. This not only reduces the computational and power requirements for the system but also ensures that the respiration rate is not inadvertently affected by data that may have been corrupted, for example, by motion, talking, coughing or swallowing. </p><p id="p0009" num="0009">The present invention provides two alternative methods for obtaining a respiration rate from the uncorrupted signals. In both cases, the calculation of the respiration rate is based solely upon uncorrupted segments of data. In the case where the longest uncorrupted segment is used, the method will be less computationally intensive and in the case where the segment with the lowest AAD is used, the calculated respiration rate may be more representative of the actual respiration rate. </p><p id="p0010" num="0010">It will be understood that in the method of the present invention the respiration rate is calculated as a single value number obtained from an epoch of data. </p><p id="p0011" num="0011">The method may comprise the step of a user selecting, within that epoch of data, whether the longest uncorrupted segment will be used to calculate the respiration rate or whether the segment with the lowest AAD will be used to calculate the respiration rate. </p><p id="p0012" num="0012">Where more than one segment is identified as having the same longest length, the earliest identified segment may be chosen as the longest uncorrupted segment. </p><p id="p0013" num="0013">Where more than one segment is identified as having the same lowest AAD, the earliest identified segment may be chosen as the segment with the lowest AAD. </p><p id="p0014" num="0014">The uncorrupted segments may be identified dynamically or retrospectively. 
<!-- EPO <DP n="4"/>-->
 The method may further comprise deriving at least one threshold from said signal and/or said uncorrupted segments and using the at least one threshold in any or all of the steps above. The method may further comprise the step of communicating the respiration rate to a base station. The respiration rate may be wirelessly communicated to the base station. </p><p id="p0015" num="0015">The step of identifying the uncorrupted segments may comprise checking whether a gradient and/or amplitude of the signal does not exceed a pre-determined threshold. </p><p id="p0016" num="0016">The step of identifying the uncorrupted segments may comprise identifying peaks and/or troughs in the signal, obtaining intervals between adjacent peaks and/or adjacent troughs, computing changes in said intervals and determining whether such changes exceed a pre-determined threshold. </p><p id="p0017" num="0017">The step of identifying the uncorrupted segments may comprise calculating a first average absolute deviation between adjacent peaks and a second average absolute deviation between adjacent troughs, combining the first and second average absolute deviations to obtain a normalised threshold and determining whether either of the first or second average absolute deviations exceeds the normalised threshold. The first average absolute deviation may be calculated by identifying peaks in the signal, obtaining intervals between adjacent peaks, calculating a mean peak interval, and computing the average absolute deviation of said intervals. The second average absolute deviation may be calculated by identifying troughs in the signal, obtaining intervals between adjacent troughs, calculating a mean trough interval, and computing the average absolute deviation of said intervals. The step of combining the first and second average absolute deviations may comprise multiplying the sum of the first and second average absolute deviations by a weighting factor. The method may further comprise pre-processing the uncorrupted segments prior to determining the respiration rate. </p><p id="p0018" num="0018">The step of pre-processing may comprise one or more of: </p><p id="p0019" num="0019"> (i) data centring; </p><p id="p0020" num="0020"> (ii) gain adjustment; 
<!-- EPO <DP n="5"/>-->
 passing the segments through a self-tunable filter; </p><p id="p0021" num="0021"> passing the segments through a low and/or high pass filter. </p><p id="p0022" num="0022">The self-tunable filter may be configured to cancel noise produced by dynamic changes in the impedance of a monitored heart as it expands and contracts. The self-tunable filter may use heart rate information to adjust a cut-off frequency in accordance with a frequency of concurrent cardiogenic contaminants. </p><p id="p0023" num="0023">The method may further comprise the step of respiration event checking comprising one or more of: </p><p id="p0024" num="0024"> (i) identifying peaks and/or troughs outside a noise margin window; </p><p id="p0025" num="0025"> (ii) classifying a peak as an inhalation event only if it is preceded by an exhalation trough; </p><p id="p0026" num="0026"> (iii) classifying a trough as an exhalation event only if it is preceded by an inhalation peak; </p><p id="p0027" num="0027"> (iv) discarding an inhalation and/or exhalation event if it would result in a respiration rate exceeding an expected maximum; </p><p id="p0028" num="0028"> (v) discarding an inhalation and/or exhalation event if its amplitude is less than any one of 20%, 30%, 40% or 50% of the previous inhalation/exhalation event. </p><p id="p0029" num="0029">Advantageously, the method may comprise determining whether an inhalation and/or exhalation event has an amplitude which is at least a preset percentage of the amplitude of the previous inhalation/exhalation event. The method may therefore not comprise use of any average amplitude values. </p><p id="p0030" num="0030">The method may further comprise performing a periodicity check, after the step of respiration event checking, to determine whether the variability in intervals between two adjacent peaks and/or two adjacent troughs exceeds a pre-determined threshold. </p><p id="p0031" num="0031">The method may further comprise the step of validity checking comprising calculating the number of valid peaks and/or troughs detected and evaluating whether the number is greater than or equal to a pre-determined minimum required to calculate a valid respiration rate. 
<!-- EPO <DP n="6"/>-->
 The method may further comprise verifying whether an average absolute deviation for the interval between adjacent valid peaks does not exceed a preset value and/or an average absolute deviation for the interval between adjacent valid troughs does not exceed a preset value. </p><p id="p0032" num="0032">The respiration rate may be calculated as the mean or median respiratory rate obtained using valid inhalation and/or exhalation events obtained from said identified uncorrupted segment. The method may further comprise generating an error signal when the signal representing the respiration episode does not contain at least two segments of contiguous uncorrupted data and/or when any calculated values exceed their respective thresholds. According to a second aspect of the present invention there is provided a respiration monitoring system for monitoring respiration to determine a respiration rate from a signal representative of a recorded respiration episode, the system comprising: </p><p id="p0033" num="0033"> a sensor for generating a signal representative of a recorded respiration episode; and </p><p id="p0034" num="0034"> a processor configured for: </p><p id="p0035" num="0035"> identifying two or more uncorrupted segments within said signal, the uncorrupted segments being separated by corrupted segments, </p><p id="p0036" num="0036"> identifying the longest of the uncorrupted segments or the segment with a lowest average absolute deviation (AAD) between respiration peaks or troughs, and </p><p id="p0037" num="0037"> determining a respiration rate from the longest uncorrupted segment or the segment with the lowest AAD. </p><p id="p0038" num="0038">The sensor may comprise an impedance pneumography device configured to generate said signal. </p><p id="p0039" num="0039">The system may be configured as a wearable wireless device. </p><p id="p0040" num="0040">The system may be configured a low-power battery-operated disposable device. 
<!-- EPO <DP n="7"/>-->
 According to a third aspect of the present invention there is provided a processor for a respiration monitoring system for monitoring respiration to determine a respiration rate from a signal representative of a recorded respiration episode, said processor configured for: </p><p id="p0041" num="0041"> identifying two or more uncorrupted segments within said signal, the uncorrupted segments being separated by corrupted segments, </p><p id="p0042" num="0042"> identifying the longest of the uncorrupted segments or the segment with a lowest average absolute deviation (AAD) between respiration peaks or troughs, and </p><p id="p0043" num="0043"> determining a respiration rate from the longest uncorrupted segment or the segment with the lowest AAD. </p><p id="p0044" num="0044">The features described above in relation to one aspect of the invention may equally be applied to other aspects of the invention and vice versa. Brief Description of the Drawings </p><p id="p0045" num="0045"> The various aspects of the invention will now be described in relation to the accompanying drawings in which: </p><p id="p0046" num="0046"> Figure 1 shows flow diagram for a method of monitoring respiration to determine a respiration rate according to an embodiment of the present invention; </p><p id="p0047" num="0047">Figure 2 shows a block diagram of a respiration monitoring system for carrying out the method illustrated in Figure 1 in accordance with an embodiment of the present invention; </p><p id="p0048" num="0048"> Figure 3 illustrates a more specific embodiment of the general method shown in Figure 1 , in accordance with another embodiment of the present invention; and </p><p id="p0049" num="0049">Figure 4 illustrates a signal representing a respiration episode and how this is analysed in accordance with embodiments of the invention. </p><p id="p0050" num="0050">Detailed Description of Certain Embodiments </p><p id="p0051" num="0051"> Figure 1 shows a flow diagram for a method 10 of determining a respiration rate from a signal representative of a recorded respiration episode, according to an embodiment of the present invention. </p><p id="p0052" num="0052">The method 10 comprises a first step 12 of obtaining a signal representative of a respiration episode. A second step 14 of identifying two or more uncorrupted segments within the signal, the uncorrupted segments being separated by corrupted 
<!-- EPO <DP n="8"/>-->
 segments, follows. A third step 16 is then undertaken which comprises identifying the longest of the uncorrupted segments or the segment with a lowest average absolute deviation (AAD) between respiration peaks or troughs before a fourth step 18 of determining a respiration rate from the longest uncorrupted segment or the segment with the lowest AAD is carried out. </p><p id="p0053" num="0053">Accordingly, the method 10 can be used to determine whether a signal representing a respiration episode (e.g. of 10 minutes duration) comprises two or more segments of continuous uncorrupted data, which can be extracted, conditioned (e.g. pre-processed) and compared with other similarly obtained data segments to calculate a respiration rate from the longest or most consistent (i.e. cleanest) segment. This embodiment therefore provides a method 10 which is capable of selecting and processing only good quality sections of data from a respiratory waveform. This has advantages in reducing the computational and power requirements for a system carrying out the method, as well as ensuring that the respiration rate is more accurately calculated since corrupted data (e.g. affected by motion, talking, coughing or swallowing) is reduced or eliminated prior to the calculation of the respiration rate. In addition, there is no requirement to wait until a complete uncorrupted episode of a specific length (e.g. 1 min) has been obtained before a respiration rate can be calculated because usable parts of corrupted episodes can be extracted to provide a respiration rate within a shorter period of time. </p><p id="p0054" num="0054">Figure 2 illustrates a respiration monitoring system 20 for carrying out the method 10 of Figure 1 in accordance with an embodiment of the present invention. The system 20 comprises a sensor 22 for generating a signal representing a respiration episode and a processor 24. The processor 24 is configured for identifying at least two uncorrupted segments within the signal, the uncorrupted segments being separated by corrupted segments. The processor 24 is also configured for identifying the longest of the uncorrupted segments or the segment with a lowest average absolute deviation (AAD) between respiration peaks or troughs before determining a respiration rate from the longest uncorrupted segment or the segment with the lowest AAD. </p><p id="p0055" num="0055">In the embodiment shown in Figure 2, the system 20 is configured as a low-power battery-operated wearable device having a transceiver 26 configured for wireless communication with a base station 30 (which may be constituted by a remote 
<!-- EPO <DP n="9"/>-->
 computer). In other embodiments, other communication methods may be employed such as those operated over fixed lines, for example, in local area networks. </p><p id="p0056" num="0056">The sensor 22 comprises a single-lead electrode impedance pneumography device configured to generate the signal to be processed by the processor 24. The respiration rate calculated by the processor 24 is then transmitted via the transceiver 26 to the base station 30. Local processing of the respiratory data (by the sensor 22) allows less data to be transmitted to the base station 30, extending the battery life of the sensor 22. It will be understood that a plurality of systems 20 may be configured to communicate with the base station 30 so that, for example, the base station 30 can provide respiration rates for a number of patients wearing the systems 20 on their chests. </p><p id="p0057" num="0057">The system 20 may be configured to record the patient's respiratory activity in a discontinuous but cyclical fashion. For example, the system may record a full respiration episode of 1 minute duration and begin processing this to determine if it contains any segments of continuous uncorrupted data for at least 10 seconds. In other embodiments the minimum period of uncorrupted data required to calculate a valid respiration rate from the segment may be 1 minute. If the processor does not obtain at least the minimum period (in this case, 10 seconds) of continuous uncorrupted data from a single respiration episode the sensor 22 will record another respiration episode and the above process will be repeated until at least the minimum period of uncorrupted data is obtained. Once an uncorrupted segment has been so obtained, it will be further processed before being used to calculate the respiration rate. </p><p id="p0058" num="0058">The processor 24 may be configured to periodically transmit to the base station 30 a result for the respiration rate. If a suitable period of uncorrupted data has been obtained the result will be a valid respiration rate in breaths per minute (BrPM). In all other circumstances, the result may take the form of a message code indicating that the signal was erratic or invalid and so no valid respiration rate could be obtained. </p><p id="p0059" num="0059">Figure 3 illustrates a more specific embodiment of the general method shown in Figure 1 , in accordance with a particular embodiment of the present invention. The method 40 shown in Figure 3 includes a number of rules which are checked at different stages of the process in order to reject data segments either severely corrupted by motion or not 
<!-- EPO <DP n="10"/>-->
 clinically relevant. The method 40 is started 42 as soon as a signal for a 1 minute respiration episode has been obtained from the sensor 22 and stored in a buffer (not shown). This data is first passed through a step 44 of determining whether the signal comprises at least one segment of continuous uncorrupted data for at least 10 seconds (as specified in a stored value representing the pre-determined minimum segment duration). In other embodiments, the minimum segment duration may be set to 5, 15, 20 or 30 seconds. Similarly, the respiration episode need not be limited to 1 minute and may, for example, last 30 seconds, 2 minutes, 3 minutes or 5 minutes. Furthermore, the respiration episode may or may not have a duration equivalent to the minimum period of uncorrupted data. </p><p id="p0060" num="0060">In some embodiments, step 44 may comprise checking whether the signal is severely distorted and/or fragmented by motion. Accordingly, step 44 may be carried out by a motion detector and/or discriminator module. As well as being able to distinguish between entirely severely corrupted and clean respiration signals, this module is also capable of partially recovering uncorrupted segments of genuine respiration data. Thus, the module evaluates whether the respiration episode contains at least one 10 second segment of continuous (or contiguous) uncorrupted data. This step 44 can be carried out by analysing the slope and amplitude characteristics of the waveform, rejecting entire corrupted episodes and accepting segments of data from which a reliable respiration rate could potentially be extracted. The accepted episodes and segments of usable data are then stored in a memory (e.g. in an array) for further processing and verification as will be explained in more detail below. More specifically, the motion detector and discriminator module according to the present embodiment of the invention operates as follows in order to carry out step 44. Firstly, a start pointer and an end pointer are used to initially point to a start position and an end position of a data buffer, which is initially loaded with signal data representing the whole of a respiration episode. The motion (artefact) detector module then carries out the following stages in order to update the start and end pointers so that they encompass only uncorrupted segments of the data: </p><p id="p0061" num="0061"> 1 ) Gradient and amplitude check; </p><p id="p0062" num="0062"> 2) Analysis of step changes in periodicity; </p><p id="p0063" num="0063"> 3) Calculation of Average Absolute Deviation (AAD) in the periodicity of the waveform. 
<!-- EPO <DP n="11"/>-->
 Stage 1 - Gradient and amplitude check </p><p id="p0064" num="0064"> The gradient of the signal is checked to ensure that it does not exceed a predetermined gradient threshold. In this embodiment, the gradient threshold is stored in memory and is set to correspond to that of a perfect sinusoidal wave having a frequency of 2Hz. If any portions of the signal have a gradient that is steeper than the gradient threshold, such portions are rejected and the start and end pointers are updated to encompass only data that does not exceed the gradient threshold. Similarly, the amplitude of the signal is checked to ensure that it does not exceed a pre-determined amplitude threshold. In this embodiment, the amplitude threshold is stored in memory and is set to correspond to two thirds of a maximum possible amplitude value. If any portions of the signal have an amplitude that exceeds the amplitude threshold, such portions are rejected and the start and end pointers are updated to encompass only data that does not exceed the amplitude threshold. </p><p id="p0065" num="0065">Stage 2 - Analysis of step changes in periodicity </p><p id="p0066" num="0066"> A peak detector (as described in the prior art) is next run through the segment of data identified in the previous stage rather than the original 60 seconds worth of data in order to save processing time and battery life. The output from the peak detector is a set of peak and trough locations. Changes in the peak to peak (and/or trough to trough) intervals are then computed and are deemed to be motion artefacts if they exceed a threshold S calculated in accordance with equation 1 below, in which 7<sup>"</sup>, represents a peak to peak (or trough to trough) interval, subscript /<sup>'</sup> represents a particular interval in time, and max(7 , 7 ^ ) represents the maximum difference between adjacent peak to peak (or trough to trough) intervals. </p><p id="p0067" num="0067">__! \_T<sup>&lt;</sup>. -T ' I_ &lt; s (1 ) </p><p id="p0068" num="0068"> max(r<sub>;</sub>, T^ ) </p><p id="p0069" num="0069"> The start and end pointers are then updated to exclude data not falling within the threshold limit. </p><p id="p0070" num="0070">If, during either of the above two stages, the start and end pointers are adjusted to encompass less than 10 seconds of data, the module will generate a signal to indicate that a valid respiration rate cannot be calculated and the sensor 22 may be instructed to obtain a signal for a further 1 minute respiration episode. 
<!-- EPO <DP n="12"/>-->
 Stage 3 - Calculation of Average Absolute Deviation (AAD) </p><p id="p0071" num="0071"> If, however, more than 10 seconds of data is encompassed by the start and end pointers at the end of the above two stages, the Average Absolute Deviation (AAD) of the peak to peak (and trough to trough) intervals will be computed using equation (2), where N is the total number of peak to peak (or trough to trough) intervals in the data set and μ is the mean interval value. 
<img id="imgf000012_0001" he="12" wi="69" file="imgf000012_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0072" num="0072"> A normalized threshold value L is then determined in accordance with equation (3) by multiplying the sum of the AAD values for the peaks and the troughs by a weighting factor of 0.15. (In other embodiments, a different weighting fact may be used.) </p><p id="p0073" num="0073"> L = 0.l5(AAD<sub>peaks</sub> + AAD<sub>trou</sub>^ ) (3) </p><p id="p0074" num="0074"> An invalid signal is generated if either of the AAD<sub>peaks</sub> or AAD<sub>troughs</sub> values exceeds the normalised threshold value L calculated in equation (3). </p><p id="p0075" num="0075">In addition, if during this stage, the start and end pointers are adjusted to encompass less than 10 seconds of data, the module will generate a signal to indicate that a valid respiration rate cannot be calculated and the sensor 22 may be instructed to obtain a signal for a further 1 minute respiration episode. However, if after all three stages described above, the start and end pointers still encompass at least 10 seconds of uncorrupted data, this segment is further processed as will be described below in order to calculate a respiratory rate. </p><p id="p0076" num="0076">The next step of the method 40 is to perform a conditioning stage 46 on the data encompassed between the start and end pointers. Note, depending on the levels of corruption in the original respiration signal, this process may be applied to the whole of the episode (which has passed through the above stages) or only on a segment of the original signal which has survived the above stages. The conditioning stage 46 comprises data centring (to remove any offset associated with the signal) and gain adjustment 48. It is noted that data centring is important not only because subsequent processes (which will be described below) require positive and negative values but also because it provides a solution for dealing with input offset errors which can vary across devices. 
<!-- EPO <DP n="13"/>-->
 The conditioning stage 46 also comprises passing the signal through a self-tunable digital notch filter 50 to cancel in-band noise produced by dynamic changes in the impedance of the heart as it contracts and expands. Such a filter can be described as a 'heat-bump' filter which uses heart rate information to adjust its cut-off frequency in accordance with the frequency of concurrent cardiogenic contaminants. Analogue hardware filters of this type are known and have been adapted as software digital filters for use in embodiments of the present invention. Once heart artifacts have been removed, the signal is further processed by first-order recursive low and high pass filters 52, whose coefficients are calculated for a sampling rate of 25Hz and cut-off frequencies of 2Hz and 0.1 Hz respectively. Thus, other sources of contamination outside of the respiration bandwidth (e.g. from muscle and mains noise) are successfully removed, allowing the method to accurately detect respiration activity within 4 and 120 BrPM. </p><p id="p0077" num="0077">The next step is to pass the signal through the respiration events detection module 54 once more. In embodiments of the invention, this module 54 comprises a three-point sliding window peak/trough detector and a routine that identifies respiration events (i.e. inhalation peaks and exhalation troughs) based on a number of rules and static thresholds associated with typical amplitude and time domain features of impedance pneumography respiration signals 60, as illustrated in Figure 4. More specifically, the module searches for peaks and troughs outside of a noise margin window (delimited by hysteresis borders na_th and nb_th in Figure 4). As illustrated, inhalation to inhalation (l-l) and exhalation to exhalation (E-E) intervals are calculated as the distances between adjacent maximum peak values and adjacent minimum trough values, respectively. These intervals are stored in buffers and used later for the calculation of the respiration rate from either the mean or median values of the l-l and E-E intervals. In addition to the artefact and other noise checks described above, this module considers further possible existence of undetected and unfiltered noise. Accordingly, the module 54 implements a number of conditions or rules to avoid misdetection and false detection of respiration events. These rules are listed below (in no particular order): 
<!-- EPO <DP n="14"/>-->
 1 . A peak is classified as an inhalation event only if it is preceded by an exhalation trough. </p><p id="p0078" num="0078"> 2. A trough is classified as an exhalation event only if it is preceded by an inhalation peak. </p><p id="p0079" num="0079"> 3. An inhalation or exhalation event is regarded as genuine and stored in its respective buffer if it has not occurred quicker than a time limit threshold corresponding to that which would occur for a maximum expected respiration rate (e.g. 120 BrPM). </p><p id="p0080" num="0080"> 4. An inhalation event or exhalation event is regarded as valid if its amplitude is at least 20% of the previous one and it is outside of the preset noise hysteresis borders (na_th and nb_th). Some existing methods employ average amplitude values calculated over significantly longer time periods (i.e. including many inhalation and exhalation events) in order to classify respiration events. Such techniques are often therefore unable to handle sudden mean level changes in amplitude (as can be experienced when analysing relatively small isolated segments of data in accordance with the present invention) and so missed breath detections can occur with these standard methods. On the contrary, the condition employed here permits rapid adaptation of the system to changes in amplitude which can occur particularly when using discontinuous segments of data from which successive respiration rates can be calculated. </p><p id="p0081" num="0081">In relation to the above, it is clear from Figure 4 that some local peaks and local troughs may be identified during the analysis of the signal but as these peaks and troughs do not meet all of the requirements listed above, they will not be classified as inhalation peaks or exhalation troughs and will therefore be discounted from any calculation of a respiration rate. </p><p id="p0082" num="0082">After the respiration events detection module stage 54, the signal undergoes a periodicity check 56 where remainder noise is searched for, which is only identifiable by its non-periodic behaviour. During this stage 56, the system makes use of the inhalation and exhalation events identified by the respiration events detection module 54. During the periodicity check 56, the system searches for periodicity irregularities in inhalation to inhalation (l-l) and exhalation to exhalation (E-E) intervals. The periodicity module essentially looks for substantial variability between signal peaks (or troughs). 
<!-- EPO <DP n="15"/>-->
 More specifically, the periodicity module checks whether the absolute difference between every two adjacent signal peak to peak (or trough to trough) intervals (normalised by the position of the furthest one) exceeds a preset threshold, in accordance with equation (1 ) above. </p><p id="p0083" num="0083">If the signal (or segment) does not pass the periodicity check 56, an invalid signal 58 is generated and the sensor 22 may be instructed to obtain a signal for a further 1 minute respiration episode for processing as described above. If, however, the signal (or segment) passes the periodicity check 56 it proceeds to the next stage. The uncorrupted segments of data are therefore first identified by step 44, before conditioning in step 46, and are once again analysed during the periodicity check 56 to ensure that the data is still in a suitable condition for calculating a respiration rate. The size of each segment is reduced accordingly at each stage in order to filter out unwanted or erroneous parts of the signal. </p><p id="p0084" num="0084">The signal is then passed through a statistical validity check 62 to determine whether enough respiration peaks and troughs have been detected (i.e. whether the segment is still of a sufficiently long length) in order to calculate a breath rate per minute (BrPM). In addition, this step 62 may verify whether the average absolute deviation (AAD) between neighbouring inhalation events and/or neighbouring exhalation events is reasonable (i.e. does not exceed a preset threshold). The use of AADs in this step is advantageous because it can provide an indication that is close to a standard Gaussian deviation (e.g. within about 80% of standard deviation) but with significant computational efficiency. This is because commonly used statistical measures such as variance or standard deviation involve compute and energy intensive arithmetic (e.g. power and square root) calculations whereas the AAD can be implemented using only sums and multiplications. In addition, the AAD is not as sensitive to outliers and is more efficient as an estimate of a population parameter in real-life situations where the data is not distributed normally. Accordingly, it is believed that the use of AAD values is important in the assessment of the signal integrity. It is also advantageous that AAD calculations can be easily implemented in fixed-point microcontroller processors as employed in systems like that shown in Figure 2. 
<!-- EPO <DP n="16"/>-->
 If the signal does not pass the statistical validity check 62, an invalid signal 58 is generated and the sensor 22 may be instructed to obtain a signal for a further 1 minute respiration episode for processing as described above. If the signal passes the statistical validity check 62, the system will then calculate the mean (or median) respiratory rate in step 64. This is performed using the stored l-l and E-E intervals obtained from either the longest uncorrupted segment or the segment with the lowest AAD, which is stored in the buffer after completion of the above steps. The respiration rate may then be transmitted to a base station as described above. </p><p id="p0085" num="0085">Advantages of the present invention are that computational savings, cost savings, power savings and time savings may be realised since the method is largely only required to analyse uncorrupted segments of data of a useful size. At any point, if at least a minimum duration (e.g. 10 seconds) of uncorrupted data is not available, the algorithm will terminate and the sensor 22 may be instructed to obtain a further set of data for processing. </p><p id="p0086" num="0086">It should be noted that all of the thresholds and limits employed in the embodiments described above were determined from simulations and from experimental evaluation of a statistically acceptable number of respiration episodes obtained from healthy individuals and patients. In other embodiments, other threshold levels may be set as appropriate. </p><p id="p0087" num="0087">It will also be appreciated by persons skilled in the art that various modifications may be made to the above embodiments without departing from the scope of the present invention. For example, features described in relation to one embodiment may be incorporated into another embodiment or vice versa. 
</p></description><claims mxw-id="PCLM44726974" ref-ucid="WO-2012114080-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="17"/>-->CLAIMS: </claim-statement><claim id="clm-0001" num="1"><claim-text>1 . A method of determining a respiration rate from a signal representative of a recorded respiration episode, the method comprising providing a starter pointer and an end pointer to point to a start position and an end position of the signal representative of the episode, updating the start and end pointers to identify the start and end positions of two or more uncorrupted segments within said signal, the uncorrupted segments being separated by corrupted segments, identifying the longest of the uncorrupted segments or the segment with a lowest average absolute deviation (AAD) between respiration peaks or troughs, and determining a respiration rate from the longest uncorrupted segment or the segment with the lowest AAD. </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. The method according to claim 1 further comprising the step of a user selecting whether the longest uncorrupted segment will be used to calculate the respiration rate or whether the segment with the lowest AAD will be used to calculate the respiration rate </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. The method according to claim 1 wherein the uncorrupted segments are identified dynamically. </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. The method according to claim 1 wherein the uncorrupted segments are identified retrospectively. </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. The method according to any preceding claim wherein the step of identifying the uncorrupted segments comprises checking whether a gradient and/or amplitude of the signal does not exceed a pre-determined threshold. </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. The method according to any preceding claim wherein the step of identifying the uncorrupted segments comprises identifying peaks and/or troughs in the signal, obtaining intervals between adjacent peaks and/or adjacent troughs, computing changes in said intervals and determining whether such changes exceed a pre-determined threshold. </claim-text></claim><claim id="clm-0007" num="7"><claim-text><!-- EPO <DP n="18"/>--> The method according to any preceding claim wherein the step of identifying the uncorrupted segments comprises calculating a first average absolute deviation between adjacent peaks and a second average absolute deviation between adjacent troughs, combining the first and second average absolute deviations to obtain a normalised threshold and determining whether either of the first or second average absolute deviations exceeds the normalised threshold. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>The method according to claim 7 wherein the step of combining the first and second average absolute deviations comprises multiplying the sum of the first and second average absolute deviations by a weighting factor. </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. The method according to any preceding claim further comprising preprocessing the uncorrupted segments prior to determining the respiration rate. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. The method according to claim 9 wherein the pre-processing comprises one or more of: </claim-text><claim-text> (v) data centring; </claim-text><claim-text> (vi) gain adjustment; </claim-text><claim-text> (vii) passing the segments through a self-tunable filter; </claim-text><claim-text> (viii) passing the segments through a low and/or high pass filter. </claim-text></claim><claim id="clm-0011" num="11"><claim-text>1 1 . The method according to any preceding claim comprising the step of respiration event checking comprising one or more of: </claim-text><claim-text> (i) identifying peaks and/or troughs outside a noise margin window; </claim-text><claim-text> (ii) classifying a peak as an inhalation event only if it is preceded by an exhalation trough; </claim-text><claim-text> (iii) classifying a trough as an exhalation event only if it is preceded by an inhalation peak; </claim-text><claim-text> (iv) discarding an inhalation and/or exhalation event if it would result in a respiration rate exceeding an expected maximum; </claim-text><claim-text> (v) discarding an inhalation and/or exhalation event if its amplitude is less than any one of 20%, 30%, 40% or 50% of the previous inhalation/exhalation event. <!-- EPO <DP n="19"/>--> </claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. The method according to claim 1 1 further comprising performing a periodicity check to determine whether the variability in intervals between two adjacent peaks and/or two adjacent troughs exceeds a pre-determined threshold. </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. The method according to any preceding claim further comprising the step of validity checking comprising calculating a number of valid peaks and/or troughs detected and evaluating whether the number is greater than or equal to a predetermined minimum required to calculate the valid respiration rate. </claim-text></claim><claim id="clm-0014" num="14"><claim-text>14. The method according to any preceding claim further comprising verifying whether an average absolute deviation for an interval between adjacent valid peaks does not exceed a preset threshold and/or an average absolute deviation for an interval between adjacent valid troughs does not exceed a preset threshold. </claim-text></claim><claim id="clm-0015" num="15"><claim-text>15. The method according to any preceding claim wherein the respiration rate is calculated as the mean or median respiratory rate obtained using inhalation and/or exhalation events obtained from said identified uncorrupted segment. </claim-text></claim><claim id="clm-0016" num="16"><claim-text>16. The method according to any preceding claim further comprising generating an error signal when the signal representing the respiration episode does not contain at least two segments of contiguous uncorrupted data and/or when any calculated values exceed their respective thresholds. </claim-text></claim><claim id="clm-0017" num="17"><claim-text>17. A respiration monitoring system for monitoring respiration to determine a respiration rate from a signal representative of a recorded respiration episode, the system comprising: </claim-text><claim-text> a sensor for generating a signal representative of a recorded respiration episode; and </claim-text><claim-text> a processor configured for: </claim-text><claim-text> providing a starter pointer and an end pointer to point to a start position and an end position of the signal representative of a recorded respiration episode, <!-- EPO <DP n="20"/>--> updating the start and end pointers to identify the start and end positions of two or more uncorrupted segments within said signal, the uncorrupted segments being separated by corrupted segments, identifying the longest of the uncorrupted segments or the segment with a lowest average absolute deviation (AAD) between respiration peaks or troughs, and </claim-text><claim-text> determining a respiration rate from the longest uncorrupted segment or the segment with the lowest AAD. </claim-text></claim><claim id="clm-0018" num="18"><claim-text>18. The system according to claim 17 wherein the sensor comprises an impedance pneumography device configured to generate said signal. </claim-text></claim><claim id="clm-0019" num="19"><claim-text>19. The system according to claim 17 or claim 18 configured as a wearable wireless device. </claim-text></claim><claim id="clm-0020" num="20"><claim-text>20. The system according to any one of claims 17 to 19 configured a low-power battery-operated disposable device. </claim-text></claim><claim id="clm-0021" num="21"><claim-text>21 . A processor for a respiration monitoring system for monitoring respiration to determine a respiration rate from a signal representative of a recorded respiration episode, said processor configured for: </claim-text><claim-text> providing a starter pointer and an end pointer to point to a start position and an end position of the signal representative of a recorded respiration episode, </claim-text><claim-text> updating the start and end pointers to identify the start and end positions of two or more uncorrupted segments within said signal, the uncorrupted segments being separated by corrupted segments, </claim-text><claim-text> identifying the longest of the uncorrupted segments or the segment with a lowest average absolute deviation (AAD) between respiration peaks or troughs, and </claim-text><claim-text> determining a respiration rate from the longest uncorrupted segment or the segment with the lowest AAD. </claim-text></claim><claim id="clm-0022" num="22"><claim-text>22. A method of monitoring respiration substantially as hereinbefore described with reference to the accompanying drawings. <!-- EPO <DP n="21"/>--> </claim-text></claim><claim id="clm-0023" num="23"><claim-text>23. A respiration monitoring system substantially as hereinbefore described with reference to the accompanying drawings. </claim-text></claim><claim id="clm-0024" num="24"><claim-text>24. A processor for a respiration monitoring system substantially as hereinbefore described with reference to the accompanying drawings. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
