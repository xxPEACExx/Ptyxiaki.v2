<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2678975-A1" country="EP" doc-number="2678975" kind="A1" date="20140101" family-id="44033791" file-reference-id="290070" date-produced="20180823" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146550522" ucid="EP-2678975-A1"><document-id><country>EP</country><doc-number>2678975</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12749062-A" is-representative="NO"><document-id mxw-id="PAPP154824445" load-source="docdb" format="epo"><country>EP</country><doc-number>12749062</doc-number><kind>A</kind><date>20120222</date><lang>EN</lang></document-id><document-id mxw-id="PAPP177814761" load-source="docdb" format="original"><country>EP</country><doc-number>12749062.1</doc-number><date>20120222</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140447817" ucid="CN-201110042521-A" load-source="docdb"><document-id format="epo"><country>CN</country><doc-number>201110042521</doc-number><kind>A</kind><date>20110222</date></document-id></priority-claim><priority-claim mxw-id="PPC140453380" ucid="CN-2012071427-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>CN</country><doc-number>2012071427</doc-number><kind>W</kind><date>20120222</date></document-id></priority-claim></priority-claims><technical-data><classification-ipc><edition>7</edition><main-classification>H04L  12/56</main-classification></classification-ipc><classifications-ipcr><classification-ipcr mxw-id="PCL2100271663" load-source="docdb">H04L  12/761       20130101ALN20140707BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL2100274300" load-source="docdb">H04L  12/18        20060101AFI20140707BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL1988121197" load-source="docdb" scheme="CPC">H04L  45/16        20130101 LI20131004BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988128625" load-source="docdb" scheme="CPC">H04L  12/1836      20130101 LI20131004BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988134446" load-source="docdb" scheme="CPC">H04L  12/185       20130101 LI20131004BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988136083" load-source="docdb" scheme="CPC">H04L  12/18        20130101 FI20130926BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132184050" lang="DE" load-source="patent-office">MULTICAST-PAKETÜBERTRAGUNG</invention-title><invention-title mxw-id="PT132184051" lang="EN" load-source="patent-office">MULTICAST PACKET TRANSMISSION</invention-title><invention-title mxw-id="PT132184052" lang="FR" load-source="patent-office">TRANSMISSION DE PAQUETS EN MULTIDIFFUSION</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR918144634" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>HANGZHOU H3C TECH CO LTD</last-name><address><country>CN</country></address></addressbook></applicant><applicant mxw-id="PPAR918155927" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>HANGZHOU H3C TECHNOLOGIES CO., LTD.</last-name></addressbook></applicant><applicant mxw-id="PPAR918989946" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Hangzhou H3C Technologies Co., Ltd.</last-name><iid>100994503</iid><address><street>Huawei Hangzhou Manufacturing Base 310 Liuhe Road, Zhijiang Hi-Tech Park Hangzhou Hi-Tech Industry Development Zone</street><city>Hangzhou, Zhejiang 310053</city><country>CN</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918170080" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>SONG XIAOHENG</last-name><address><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR918167218" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>SONG, XIAOHENG</last-name></addressbook></inventor><inventor mxw-id="PPAR918991830" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>SONG, XIAOHENG</last-name><address><street>Room 730 Oriental Electronic BLD. NO.2 Chuangye Road Shangdi Information Industry Base Haidian District</street><city>Beijing 100085</city><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR918137683" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>WANG CHAOQUN</last-name><address><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR918165931" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>WANG, Chaoqun</last-name></addressbook></inventor><inventor mxw-id="PPAR918989150" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>WANG, Chaoqun</last-name><address><street>Room 730 Oriental Electronic BLD. NO.2 Chuangye Road Shangdi Information Industry Base Haidian District</street><city>Beijing 100085</city><country>CN</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918990246" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Rees, Simon John Lewis</last-name><iid>100819336</iid><address><street>Haseltine Lake LLP Redcliff Quay 120 Redcliff Street</street><city>Bristol BS1 6HU</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="CN-2012071427-W"><document-id><country>CN</country><doc-number>2012071427</doc-number><kind>W</kind><date>20120222</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012113326-A1"><document-id><country>WO</country><doc-number>2012113326</doc-number><kind>A1</kind><date>20120830</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS548910165" load-source="docdb">AL</country><country mxw-id="DS548908285" load-source="docdb">AT</country><country mxw-id="DS548910166" load-source="docdb">BE</country><country mxw-id="DS548858868" load-source="docdb">BG</country><country mxw-id="DS548894571" load-source="docdb">CH</country><country mxw-id="DS548830967" load-source="docdb">CY</country><country mxw-id="DS548908294" load-source="docdb">CZ</country><country mxw-id="DS548910167" load-source="docdb">DE</country><country mxw-id="DS548830968" load-source="docdb">DK</country><country mxw-id="DS548830969" load-source="docdb">EE</country><country mxw-id="DS548811874" load-source="docdb">ES</country><country mxw-id="DS548858869" load-source="docdb">FI</country><country mxw-id="DS548912164" load-source="docdb">FR</country><country mxw-id="DS548910168" load-source="docdb">GB</country><country mxw-id="DS548830970" load-source="docdb">GR</country><country mxw-id="DS548910169" load-source="docdb">HR</country><country mxw-id="DS548908295" load-source="docdb">HU</country><country mxw-id="DS548894572" load-source="docdb">IE</country><country mxw-id="DS548830971" load-source="docdb">IS</country><country mxw-id="DS548912165" load-source="docdb">IT</country><country mxw-id="DS548830972" load-source="docdb">LI</country><country mxw-id="DS548858870" load-source="docdb">LT</country><country mxw-id="DS548918014" load-source="docdb">LU</country><country mxw-id="DS548858871" load-source="docdb">LV</country><country mxw-id="DS548858872" load-source="docdb">MC</country><country mxw-id="DS548918015" load-source="docdb">MK</country><country mxw-id="DS548918016" load-source="docdb">MT</country><country mxw-id="DS548811875" load-source="docdb">NL</country><country mxw-id="DS548908296" load-source="docdb">NO</country><country mxw-id="DS548918017" load-source="docdb">PL</country><country mxw-id="DS548830973" load-source="docdb">PT</country><country mxw-id="DS548811876" load-source="docdb">RO</country><country mxw-id="DS548830974" load-source="docdb">RS</country><country mxw-id="DS548918022" load-source="docdb">SE</country><country mxw-id="DS548910174" load-source="docdb">SI</country><country mxw-id="DS548908297" load-source="docdb">SK</country><country mxw-id="DS548918023" load-source="docdb">SM</country><country mxw-id="DS548894573" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA99627554" ref-ucid="WO-2012113326-A1" lang="EN" load-source="patent-office"><p num="0000">A method for multicast packet transmission by a first provider edge device in a virtual switching instance, in which the first provider edge device transmits, to a second provider edge device in the virtual switching instance, a packet having an address of a private network multicast group and an address of a public network multicast group associated with the private network multicast group. The first provider edge device receives, from the second provider edge device, a join request packet to join the public network multicast group. The first provider edge device stores forwarding information for the public network multicast group, wherein the forwarding information relates to an interface over which the join request packet is received by the first provider edge device. The first provider edge device encapsulates a multicast packet for the private network multicast group with the address of the public network multicast group. The first provider edge device transmits the encapsulated multicast packet according to the address of the public network multicast group and forwarding information.</p></abstract><abstract mxw-id="PA99826025" ref-ucid="WO-2012113326-A1" lang="EN" source="national office" load-source="docdb"><p>A method for multicast packet transmission by a first provider edge device in a virtual switching instance, in which the first provider edge device transmits, to a second provider edge device in the virtual switching instance, a packet having an address of a private network multicast group and an address of a public network multicast group associated with the private network multicast group. The first provider edge device receives, from the second provider edge device, a join request packet to join the public network multicast group. The first provider edge device stores forwarding information for the public network multicast group, wherein the forwarding information relates to an interface over which the join request packet is received by the first provider edge device. The first provider edge device encapsulates a multicast packet for the private network multicast group with the address of the public network multicast group. The first provider edge device transmits the encapsulated multicast packet according to the address of the public network multicast group and forwarding information.</p></abstract><abstract mxw-id="PA99627555" ref-ucid="WO-2012113326-A1" lang="FR" load-source="patent-office"><p num="0000">L'invention concerne un procédé de transmission de paquets en multidiffusion par un premier dispositif côté fournisseur dans une instance de commutation virtuelle, dans lequel le premier dispositif côté fournisseur transmet à un deuxième dispositif côté fournisseur, dans l'instance de commutation virtuelle, un paquet comportant une adresse d'un groupe de multidiffusion de réseau privé et une adresse d'un groupe de multidiffusion de réseau public, associé au groupe de multidiffusion de réseau privé. Le premier dispositif côté fournisseur reçoit du deuxième dispositif côté fournisseur un paquet de demande de rattachement au groupe de multidiffusion de réseau public. Le premier dispositif côté fournisseur stocke des données d'acheminement relatives au groupe de multidiffusion de réseau public, lesdites données d'acheminement concernant une interface au moyen de laquelle le paquet de demande de rattachement est reçu par le premier dispositif côté fournisseur. Le premier dispositif côté fournisseur encapsule un paquet de multidiffusion destiné au groupe de multidiffusion de réseau privé avec l'adresse du groupe de multidiffusion de réseau public. Le premier dispositif côté fournisseur transmet le paquet de multidiffusion encapsulé selon l'adresse du groupe de multidiffusion de réseau public et les données d'acheminement.</p></abstract><abstract mxw-id="PA99826026" ref-ucid="WO-2012113326-A1" lang="FR" source="national office" load-source="docdb"><p>L'invention concerne un procédé de transmission de paquets en multidiffusion par un premier dispositif côté fournisseur dans une instance de commutation virtuelle, dans lequel le premier dispositif côté fournisseur transmet à un deuxième dispositif côté fournisseur, dans l'instance de commutation virtuelle, un paquet comportant une adresse d'un groupe de multidiffusion de réseau privé et une adresse d'un groupe de multidiffusion de réseau public, associé au groupe de multidiffusion de réseau privé. Le premier dispositif côté fournisseur reçoit du deuxième dispositif côté fournisseur un paquet de demande de rattachement au groupe de multidiffusion de réseau public. Le premier dispositif côté fournisseur stocke des données d'acheminement relatives au groupe de multidiffusion de réseau public, lesdites données d'acheminement concernant une interface au moyen de laquelle le paquet de demande de rattachement est reçu par le premier dispositif côté fournisseur. Le premier dispositif côté fournisseur encapsule un paquet de multidiffusion destiné au groupe de multidiffusion de réseau privé avec l'adresse du groupe de multidiffusion de réseau public. Le premier dispositif côté fournisseur transmet le paquet de multidiffusion encapsulé selon l'adresse du groupe de multidiffusion de réseau public et les données d'acheminement.</p></abstract><description mxw-id="PDES50931890" ref-ucid="WO-2012113326-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="3"/>--><p id="p0001" num="0001"> Multicast Packet Transmission </p><p id="p0002" num="0002">Background </p><p id="p0003" num="0003"> Virtual private local area network service (VPLS) is a transparent LAN service that interconnects geographically dispersed LAN segments across a multiprotocol label switching (MPLS) network. The LAN segments are interconnected via a public network backbone, such as a metropolitan area network (MAN) or wide area network (WAN). The LAN segments in a VPLS appear to be on the same LAN regardless of their locations, and can function as a single virtual LAN. </p><p id="p0004" num="0004">Multicast refers to a point-to-multipoint communication where information is delivered to a group of destination devices, and is useful in many applications, such as Internet Protocol Television (IPTV), video conferencing, video on demand, e-learning and web casts. In a VPLS network, when a multicast source provider edge (PE) device transmits multicast packets to peer PE devices, the packets are replicated at the multicast source and transmitted to each peer PE device via a public network in a broadcast or unicast manner. </p><p id="p0005" num="0005">Brief Description of Drawings </p><p id="p0006" num="0006">By way of non-limiting examples, multicast packet transmission will be described with reference to the following drawings, in which: </p><p id="p0007" num="0007"> Fig. 1 is a schematic diagram of an example of a VPLS network in which multicast packets are transmitted; </p><p id="p0008" num="0008"> Fig. 2 is a flowchart of an example method of a provider edge (PE) device joining a private network multicast group in a VPLS network; </p><p id="p0009" num="0009"> Fig. 3 is a schematic diagram illustrating an example method of a PE device joining a private network multicast group in the VPLS network in Fig.l; </p><p id="p0010" num="0010"> Fig. 4(a) is a diagram of an example packet structure of an extended IGMP packet for joining or leaving a private network multicast group; </p><p id="p0011" num="0011"> Fig. 4(b) is a diagram of an example packet structure of an encapsulated Internet</p><p id="p0012" num="0012">Group Management Protocol (IGMP) packet; </p><p id="p0013" num="0013"> Fig. 4(c) is a diagram of an example packet structure of an encapsulated multicast domain (MD) packet; </p><p id="p0014" num="0014"> Fig. 5 is a flowchart of an example method of a multicast source triggering PE devices to join a public network multicast group in a VPLS network; 
<!-- EPO <DP n="4"/>-->
 Fig. 6 is a schematic diagram illustrating an example method of a multicast source triggering PE devices to join a public network multicast group in the VPLS network in Fig. l; </p><p id="p0015" num="0015"> Fig. 7 is a flowchart of an example method of forwarding multicast packets; Fig. 8 is a schematic diagram of an example VPLS network having a different topology to that of the VPLS network in Fig. 1; </p><p id="p0016" num="0016"> Fig. 9 is a flowchart of an example method of a provider edge (PE) device leaving a private network multicast group in a VPLS network; </p><p id="p0017" num="0017"> Fig. 10 is a schematic diagram illustrating an example method of a PE device leaving a private network multicast group in the VPLS network in Fig.1 ; </p><p id="p0018" num="0018"> Fig. 11 is a schematic diagram illustrating an example method of a PE device leaving a public network multicast group in the VPLS network in Fig.l; and </p><p id="p0019" num="0019"> Fig. 12 is a block diagram of an example structure of a network device. </p><p id="p0020" num="0020">Detailed Description </p><p id="p0021" num="0021"> Referring first to Fig. 1, an example VPLS network 10 is shown where geographically dispersed customer sites 12a, 12b, 12c and 12d are connected over a service provider network 14. The service provider network 14 may be a packet-switched network using multiprotocol label switching protocol (MPLS) etc. </p><p id="p0022" num="0022">The example VPLS network 10 comprises network devices capable of acting as provider edge (PE) devices, intermediate provider (P) devices and customer edge (CE) devices. In this example, PE devices PE1, PE2, PE3 and PE4 at the edge of the service provider network 14 have functionality to interface with respective CE devices CEIO, CE20, CE30 and CE40. P devices PI, P2 and P3 forward traffic between PE devices. The PE and P devices may be routers, bridges, switches, or hosts etc. </p><p id="p0023" num="0023">The PE devices are each connected to the respective CE device via an attachment circuit (AC) 16a, 16b, 16c and 16d. An AC may be a logical or physical circuit, such as an RS-232 serial line or an ATM virtual circuit etc. The CE devices may be routers, bridges, switches, or hosts etc. </p><p id="p0024" num="0024">A set of virtual circuits (VCs) 18, termed pseudo wires (PWs), are established between the PE devices to provide forwarding paths. Construction of a PW involves the configuration of a pair of uni-directional label switched paths (LSPs) between the PE devices. Once this LSP tunnel is established, a PW is assigned to a pair of LSPs and 
<!-- EPO <DP n="5"/>-->
 the tunnel provides connectivity to transport packets across the network from one PE to another. </p><p id="p0025" num="0025">At the customer sites 12a, 12b, 12c and 12d, network devices U10, U20, U30, and U40 are connected to respective CE devices CE10, CE20, CE30 and CE40. The network devices U10, U20, U30 and U40 may each be a desktop computer, laptop computer, mobile communications equipment, tablet computer, digital television, set-top box, router, bridge, switch, or host etc. All CE devices participating in a single VPLS instance appear to be on the same LAN, forming a virtual private network (VPN) across the service provider's network. To implement a VPLS instance, a virtual switching instance (VSI) is created on the PE devices. The VSI is a logical entity in a PE device that operates as a switch between one or more ACs and PWs. Each VSI is associated with an identification number, VSI- ID. For example, PE devices PE1, PE2, PE3 and PE4 in Fig. 1 are associated with a single VSI having VSI-ID = VSI1. </p><p id="p0026" num="0026">In the examples below, PE2 serves as a multicast source (also referred to as "first PE device"), and PE1, PE3 and PE4 are peer PE devices (also referred to as "second PE devices"). In particular, in the examples, a second PE device (PE1, PE4) joins a private network multicast group. To facilitate multicast packet transmission, the first PE device (PE2) transmits, to the second PE device (PE1, PE4), a packet having an address of a private network multicast group and an address of a public network multicast group associated with the private network multicast group. In response, the second PE device (PE1, PE4) transmits a join request packet to the first PE device (PE2) to join the public network multicast group. The first PE device (PE2) stores forwarding information relating an interface over which the join request packet is received. The first PE device (PE2) then encapsulates a multicast packet for the private network multicast group with the address of the public network multicast group, and sends the multicast packet according to the address of the public network multicast group and forwarding information. A second PE device (PE1, PE4) may leave the private network multicast group and public network multicast group at any time. Examples of these processes are described in more detail below. 
<!-- EPO <DP n="6"/>-->
 Private Network Multicast Group </p><p id="p0027" num="0027"> An example method of joining a private network multicast group in the VPLS network 10 will be explained with reference to Fig. 2 and Fig. 3. Any suitable communications protocol for managing group membership may be used, such as the Internet Group Management Protocol (IGMP) exemplified below. </p><p id="p0028" num="0028">A PE device receives a request packet from a connecting CE device to join a private network multicast group; see block 21. If IGMP is enabled on the AC between the PE device and CE device, the request packet may be in the form of an IGMP request packet etc. In the example in Fig. 3, PE1 receives an IGMP request packet from CE10 to join private network multicast group 239.1.1.1 ; see 32. </p><p id="p0029" num="0029">In this case, it should be understood that either the CE device, or a user device connected to the CE device (such as U10, U20, U30 and U40 in Fig. 1), wishes to receive multicast packets for the private network multicast group. Throughout this disclosure, a CE device is referred to as a "receiver" of the private network multicast group if the end destination of the multicast packets is either (i) the CE device itself or (ii) a device connected to the CE device. In the latter case (ii), the CE device is also a "receiver" of the first private network multicast group because it receives and forwards the multicast packets to the connecting device. Also, from the perspective of the PE device, the CE device is a receiver of the private network multicast group because the multicast packets should be forwarded to the CE device. </p><p id="p0030" num="0030">The PE device updates local forwarding information relating to the private network multicast group; see block 22 in Fig. 2. Specifically, the PE device determines whether the private network multicast group already exists in the VSI. If not, the PE device updates local forwarding information relating to the private network multicast group. The local forwarding information may be in the form of an entry in a forwarding table, which stores the CE device as receiver of the private network multicast group. </p><p id="p0031" num="0031">Otherwise, if a forwarding table entry for the private network multicast group already exists, the PE device adds an entry to the forwarding table stating the CE device is a receiver of the private network multicast group. In the example in Fig. 3, PE1 creates an entry in a local forwarding table for 239.1.1.1 in VSI1, with CE10 as an outgoing interface of 239.1.1.1; see 34. 
<!-- EPO <DP n="7"/>-->
 The PE device then extends the IGMP request packet to include an identifier VSI-ID of the VSI; see block 23 in Fig. 2. An example structure of an extended IGMPv2 request packet is shown in Fig. 4(a), where: </p><p id="p0032" num="0032"> 'Type' identifies the IGMP packet type, such as 0x11 for a query packet; 0x16 for a report packet; and 0x26 for an extended request packet; </p><p id="p0033" num="0033"> 'Max Response Time' identifies a maximum time to wait before responding to a query packet; </p><p id="p0034" num="0034"> 'VSI-ID' is the ID of the VSI, identifying the instance number to which the IGMP request packet belongs; </p><p id="p0035" num="0035"> 'Checksum' is a check sum for the IGMP packet; and </p><p id="p0036" num="0036"> 'Multicast Address' is an address of the private network multicast group, such as 239.1.1.1 used in this example. </p><p id="p0037" num="0037">The packet extension allows receiving PE devices to distinguish the IGMP request packets from data packets and process the IGMP request packets differently. After the extension, the PE device transmits the extended request packet to peer PE devices in the VSI; see block 24 in Fig. 2. </p><p id="p0038" num="0038">The transmission of the extended request packet is performed in a broadcast manner. Fig. 3 illustrates an IGMP request packet flooding process, where PE1 transmits the extended IGMP request packet 36 to peer PE devices PE2, PE3 and PE4. An example structure of the extended IGMP packet broadcasted by PE1 is shown in Fig. 4(b) where the packet is encapsulated with a public network Layer 2 header, a VPLS label tunnel header, and a VC label. </p><p id="p0039" num="0039">Once the extended IGMP request packet 36 is received, the packet is analysed by the peer PE devices PE2, PE3 and PE4 within VSIl; see blocks 25 and 26 in Fig. 2. From the analysis, the PE devices then store the information relating to the VSI-ID, private network multicast group and PW information contained in the packet at block 27. </p><p id="p0040" num="0040">The PW information relates to the connection between the sender of the request packet (PE1) and receiving PE devices (PE2, PE3 or PE4). In VPLS, the PW information may be the IP address of the sender of the request packet etc. In the example in Fig. 3, each PE device within VSIl stores the following membership information 38: 
<!-- EPO <DP n="8"/>-->
 VSI-ID: VSI1; </p><p id="p0041" num="0041"> Private network multicast group address: 239.1.1.1; and </p><p id="p0042" num="0042"> PW information: IP address of PEl . In the example in Fig. 3, the membership information 38 is useful for peer PE devices PE2, PE3 and PE4 to learn that a CE device connected to PEl is a receiver of private network multicast group 239.1.1.1. For a multicast source, say PE2, the information is useful when determining whether private network multicast group 239.1.1.1 has any member. If not, it is not necessary to transmit any multicast packet to this group. </p><p id="p0043" num="0043">Similarly, when PE4 receives an IGMP request packet from CE40 to join private network multicast group 239.1.1.1, PE4 will perform blocks 21 to 24 in Fig. 2 to add CE40 as an outgoing interface for 239.1.1.1, extend the IGMP request packet to carry the VSI-ID and transmit the extended packet within the VSI1 domain. </p><p id="p0044" num="0044">Peer PE devices PEl, PE2 and PE3 will process the extended IGMP request packet according to blocks 25 to 27 in Fig. 2, after which the following membership information is stored: </p><p id="p0045" num="0045"> VSI-ID: VSI1; </p><p id="p0046" num="0046"> Private network multicast group address: 239.1.1.1 ; and </p><p id="p0047" num="0047"> PW information: IP address of PE4. </p><p id="p0048" num="0048">Public Network Multicast Group </p><p id="p0049" num="0049"> To facilitate transmission of multicast packets by a multicast source over a public network, PE devices join a public network multicast group associated with the private network multicast group. An example method of joining a public network multicast group will be explained with reference to the flowchart in Fig. 5 and schematic diagram in Fig. 6. At block 51 in Fig. 5, a multicast source PE device receives a multicast packet from a connecting CE device for transmission to a private network multicast group. </p><p id="p0050" num="0050">At block 52, the multicast source PE device assigns a public network multicast group address for the private network multicast group. The public network multicast group address represents an address of a public network tunnel assigned for the private 
<!-- EPO <DP n="9"/>-->
 network multicast group. The multicast source PE device also adds a public network tunnel interface to the private network multicast group. </p><p id="p0051" num="0051">At block 53, the multicast source PE device transmits a packet having an address of the private network multicast group and an address of the public network multicast group within the VSI domain. The packet may be in the form of a multicast domain (MD) packet etc. Prior to transmitting the MD packet within the VSI domain, the multicast source PE device encapsulates the packet with a VC label, a LSP tunnel label, and a public network layer 2 header. An example of the encapsulated MD packet is shown in Fig. 4(c). </p><p id="p0052" num="0052">For example, in the schematic diagram in Fig. 6, after receiving a multicast packet transmitted by CE20, multicast source PE2 assigns public network multicast group address 224.1.1.1 for the private network multicast group 239.1.1.1. In one example, the public network multicast group address is assigned once, in which case blocks 52 and 53 are triggered when a first packet of a multicast transmission is received by the multicast source PE device at block 51. </p><p id="p0053" num="0053">At block 54, a peer PE device receives and analyses the packet transmitted by the multicast source. In the example in Fig. 6, the MD packet 62 carrying addresses 239.1.1.1 and 224.1.1.1 transmitted by PE2 is received by PE devices PE1, PE3 and PE4. </p><p id="p0054" num="0054">At block 55, based on the address information in the packet, the peer PE device stores mapping information relating to the association between the address of the private network multicast group and the address of the public network multicast group. In the example in Fig. 6, PE1, PE3 and PE4 each stores mapping information between 239.1.1.1 and 224.1.1.1. At block 56, the peer PE device determines whether any local CE device connected to the peer PE device is a receiver of the private network multicast group; see block 56. The determination is based on the local forwarding information relating to the private network multicast group stored at block 22 in Fig. 2. If there is a local CE device that is a receiver of the private network multicast group, the peer PE device will transmit a join request packet within the VSI domain to join the 
<!-- EPO <DP n="10"/>-->
 public network multicast group; see block 57. The join request packet may be in the form of a protocol independent multicast (PIM) packet etc. Variants such as PIM sparse mode (PIM-SM) and PIM dense mode (PIM-DM) etc may be used. In the example in Fig. 6, CE10 (connected to PE1) and CE40 (connected to PE4) are both receivers of 239.1.1.1, and should receive any multicast packets addressed to 239.1.1.1. In other words, PE1 and PE4 have the private network multicast group address 239.1.1.1 locally. As such, PE1 and PE4 each transmit a PIM packet 64 to join 224.1.1.1 in the service provider network. </p><p id="p0055" num="0055">The PIM join packet transmitted by PE1 is forwarded upstream via intermediate P devices PI and P3 before reaching multicast source PE2. The PIM join packet transmitted by PE4 is forwarded upstream to reach multicast source PE2 via PE3. The upstream route is determined from a unicast routing table of PE1 and PE4, which transmitted the PIM j oin packet. </p><p id="p0056" num="0056">In one implementation of block 53, the MD packet is broadcasted within the whole VSIl domain such that PE3 also stores mapping information between the public network multicast group address 224.1.1.1 and private network multicast group address 239.1.1.1. Advantageously, when PE3 receives an IGMP join packet from CE30 to join 239.1.1.1, PE3 can proceed to transmit a PIM packet to join 224.1.1.1 instead of waiting for an MD packet from PE2. </p><p id="p0057" num="0057">In another example of block 53, the MD packet is only be transmitted to peer PE devices that are connected to at least one receiver of the private network multicast group. In the example in Fig. 5, since PE2 has information that PE1 and PE4 have joined 239.1.1.1 , the MD packet is only sent to PE 1 and PE4. </p><p id="p0058" num="0058">Since PE3 does not have any connecting CE devices that are receivers of private network multicast group 239.1.1.1, PE3 proceeds to do nothing according to block 58 in Fig. 5. 
<!-- EPO <DP n="11"/>-->
 Forwarding Information for the Public Network Multicast Group </p><p id="p0059" num="0059"> When the join request packet transmitted by a PE device is received, the receiving device stores forwarding information relating to the public network multicast group; see blocks 71 and 72 in Fig. 7. </p><p id="p0060" num="0060">The forwarding information may be in the form of a forwarding table created for the public network multicast group. An entry in the table includes the address of the public network multicast group and an interface over which the join request packet is received by the device. The interface, which may be a port of the device etc, serves an outgoing interface for the public network multicast group at the device. </p><p id="p0061" num="0061">Referring to the example in Fig. 6 again, when the PIM join packet from PE1 is received, the following forwarding information is stored for the public network multicast group address 224.1.1.1 : </p><p id="p0062" num="0062"> 66a at PI : 224.1.1.1 -&gt; Interface between PI and PE1; </p><p id="p0063" num="0063"> 66b at P3 : 224.1.1.1 -&gt; Interface between P3 and P 1 ; and </p><p id="p0064" num="0064"> 66c at PE2: 224.1.1.1 -&gt; Interface between PE2 and P3. </p><p id="p0065" num="0065">When the PIM join packet from PE4 is received, the following forwarding information for the public network multicast group address 224.1.1.1 is stored: </p><p id="p0066" num="0066"> 68 at PE3 : 224.1.1.1 -&gt; Interface between PE3 and PE4; and </p><p id="p0067" num="0067"> 66c at PE2: 224.1.1.1 -&gt; Interface between PE2 and PE3. </p><p id="p0068" num="0068">As such, the forwarding table for 224.1.1.1 at multicast source PE2 has two entries: </p><p id="p0069" num="0069"> 66c at PE2 : 224.1.1.1 -&gt; Interface between PE2 and P3 ; and </p><p id="p0070" num="0070"> 224.1.1.1 -&gt; Interface between PE2 and PE3. </p><p id="p0071" num="0071">Forwarding Multicast Packets </p><p id="p0072" num="0072"> Based on the forwarding information stored for the public network multicast group, multicast packets for the private network multicast group may then be forwarded in a multicast manner. </p><p id="p0073" num="0073">Referring to Fig. 7 again, at block 73, the multicast source PE device encapsulates a multicast packet received from a CE device with the address of the public network multicast group. In one example, the address is in a public network tunnel header of the packet. 
<!-- EPO <DP n="12"/>-->
 At block 74, the PE then multicasts the multicast packet in the VSI according to the address of the public network multicast group in the public network tunnel header and the forwarding information stored at block 72 in Fig. 7. </p><p id="p0074" num="0074">At block 75, any device that receives the encapsulated multicast packet also forwards the packet according to the address and its own forwarding table for the public network multicast group. At block 76, if a PE device receiving the encapsulated packet is connected to a local CE device which is a receiver of the private network multicast group, the PE device will forward the multicast packet to the local CE device. </p><p id="p0075" num="0075">Referring to the example in Fig. 6 again, PE2 forwards multicast packets from CE20 according to the forwarding table for public network multicast group 224.1.1.1, which is associated with the following outgoing interfaces. </p><p id="p0076" num="0076">(i) The first outgoing interface for 224.1.1.1 in the forwarding table at PE2 is the interface between PE2 and P3, in which case the multicast packet is forwarded by PE2 to P3. </p><p id="p0077" num="0077">Based on the header of the multicast packet, P3 determines that the multicast packet is for public network multicast group address 224.1.1.1. In its forwarding table for 224.1.1.1, the outgoing interface for 224.1.1.1 is the interface between P3 and PI . As such, P3 forwards the multicast packet to PI . </p><p id="p0078" num="0078">Upon receiving the multicast packet from P3, PI analyses the header of the multicast packet. Based on the packet header and its forwarding table for 224.1.1.1, the outgoing interface for 224.1.1.1 is the interface between PI and PEL As such, PI forwards the multicast packet to PE1. </p><p id="p0079" num="0079">After receiving the multicast packet from PI, PE1 analyses the header of the multicast packet to learn that it is addressed to 224.1.1.1. Since PE1 stores information relating to the mapping between 224.1.1.1 and 239.1.1.1 and information relating to the local receiver of 239.1.1.1, PE1 determines that the multicast packet is for CE10. As such, PE1 forwards the multicast packet to CE10. 
<!-- EPO <DP n="13"/>-->
 (ii) The second outgoing interface for 224.1.1.1 at PE2 is the interface between PE2 and PE3, in which case the multicast packet is forwarded to PE3. Based on the header of the multicast packet, PE3 determines that the multicast packet is for public network multicast group address 224.1.1.1. In its forwarding table, the outgoing interface for 224.1.1.1 is the interface between PE3 and PE4. As such, PE4 forwards the multicast packet to PE4. Upon receiving the multicast packet from PE3, PE4 analyses the header of the multicast packet to learn that it is addressed to 224.1.1.1. Since PE4 stores information relating to the mapping between 224.1.1.1 and 239.1.1.1 and information relating to the local receiver of 239.1.1.1, PE4 determines that the multicast packet is for CE40. As such, PE4 forwards the multicast packet to CE40. </p><p id="p0080" num="0080">In one example, multicast packets are forwarded in the VPLS network in a broadcast manner followed by a multicast manner. Prior to storing the forwarding information and encapsulating the multicast packet with the address of the public network multicast group, the multicast source PE device encapsulates the multicast packet with an VPLS label and broadcast it within the VSI1 domain. At this stage, multicast traffic is broadcasted within the VPLS network. </p><p id="p0081" num="0081">After the forwarding information for the public network multicast group is available and multicast packets are encapsulated with its address, multicast packets are forwarded over the public network in a multicast manner. Since a multicast source PE device triggers and transmits an MD packet after receiving a multicast packet, each peer PE device stores forwarding information for the public network multicast address fairly shortly after receiving the MD packet. Compared to broadcasting or unicasting of multicast packets, forwarding the multicast packets in a multicast manner reduces wastage of network bandwidth, and improves network utilisation. </p><p id="p0082" num="0082">After encapsulating the multicast packets with a public network multicast tunnel header having the address of the public network multicast group, if any other CE device connected to a PE device joins the private network multicast group, the PE device may transmit a PIM join packet and updates local information that the CE device is now a receiver of the private network multicast group. 
<!-- EPO <DP n="14"/>-->
 For example, consider the situation where PE3 receives an IGMP request packet transmitted by CE30 to join private network multicast group 239.1.1.1. Since PE3 has previously received an MD packet sent by PE2 and stores the mapping information between the private network multicast group address 239.1.1.1 and public network multicast address 224.1.1.1, PE3 adds CE30 as a receiver for the private network multicast address, and broadcasts the IGMP request packet to join 239.1.1.1 and PIM join packet to join 224.1.1.1 within the network. As such, multicast traffic is directed to PE3. To retain synchronisation of private network multicast information, IGMP and PIM packet flooding is performed within the VPLS network. </p><p id="p0083" num="0083">In another example, Fig. 8 shows a variation of the VPLS network topology in Fig. 6. In this case, PE4 is connected to multicast source PE2 via PE3 and P3 instead of via PE3 only. Similarly, PE1 and PE4 join the private network multicast group 239.1.1.1 and the public network multicast group 224.1.1.1 according to the blocks in Fig. 2 and Fig. 5. </p><p id="p0084" num="0084">After the blocks in Fig. 7, the forwarding information stored at devices upstream of the multicast source PE2 and at PE2 are as follows: </p><p id="p0085" num="0085"> 82a at PI: 224.1.1.1 -&gt; Interface between PI and PE1; </p><p id="p0086" num="0086"> 82b at P3 : 224.1.1.1 -&gt; Interface between P3 and P 1 , and </p><p id="p0087" num="0087"> 224.1.1.1 -&gt; Interface between P3 and PE3; </p><p id="p0088" num="0088"> 82c at PE3 : 224.1.1.1 -&gt; Interface between PE3 and PE4. </p><p id="p0089" num="0089"> 82d at PE2: 224.1.1.1 -&gt; Interface between PE2 and P3. </p><p id="p0090" num="0090">Although multicast packets have to be transmitted to PE1 and PE3, the forwarding table at PE2 only has one outgoing interface, i.e. the interface between PE2 and P3, over which the multicast packets are delivered. When PE2 encapsulates a multicast packet received from CE20 with address 224.1.1.1, PE2 will forward the multicast packet 84 to the interface between PE2 and P3. As such, based on the forwarding information, replication of multicast packets is not performed if they are transmitted on a shared link in the public network connecting the multicast source with the receiving PE devices. This improves bandwidth utilisation and reduces wasteful over- provisioning to deliver unnecessary replicated traffic. 
<!-- EPO <DP n="15"/>-->
 The multicast packet 84 then arrives at P3, which learns from the header and its forwarding table that the packet should be forwarded to two outgoing interfaces. Specifically, the multicast packet 84 is forwarded to PI via the interface between P3 and PI, and another copy 86 of the multicast packet is forwarded to PE3 via the interface between P3 and PE3. PE3 and PI then forward the multicast packets 84 and 86 to PE1 and PE4 respectively. </p><p id="p0091" num="0091">Leaving the Private and Public Network Multicast Groups </p><p id="p0092" num="0092"> An example method of leaving a private network multicast group in the VPLS network will be explained with reference to Fig. 9 and Fig. 10. Any suitable communications protocol for managing group membership may be used, such as the Internet Group Management Protocol (IGMP) exemplified below. </p><p id="p0093" num="0093">At block 91, a PE device receives a leave request packet from a CE device to leave a private network multicast group. For example, the leave request packet may be in the form of an IGMP notification packet. In general, ACs connecting the PE and CE devices are IGMP-enabled to facilitate sending and receiving of IGMP packets. The example process described at blocks 92 to 97 below is also performed when the status of the VSI changes from UP to DOWN. </p><p id="p0094" num="0094">At block 92, the PE device updates its local forwarding information for the private network multicast group. More specifically, the PE device uses its local forwarding information to determine whether there is more than one outgoing interface for the private network multicast group. If yes, the PE device deletes the CE device that transmitted the leave request packet as an outgoing interface. Otherwise, if the CE device is the only outgoing interface for the private network multicast group, the private network multicast group is deleted from its local forwarding information. </p><p id="p0095" num="0095">In the example in Fig. 10, CE10 wishes to leave the private network multicast group 239.1.1.1 and sends an IGMP notification packet to PEL After receiving the IGMP notification packet, PE1 determines whether there is any other CE device that is an outgoing interface for the private network multicast group. In this case, CE10 is the only outgoing interface, and PE1 deletes its local forwarding information of private network multicast group 239.1.1.1; see 102 in Fig. 10. 
<!-- EPO <DP n="16"/>-->
 At block 93, the PE device extends the leave request packet to include the VSI-ID of the VSI. An example structure of an extended IGMP notification packet is similar to the structure shown in Fig. 4(a). In this case, </p><p id="p0096" num="0096"> 'Type' identifies the IGMP packet type, such as 0x11 for a query packet; 0x16 for a report packet; and 0x27 for an extended leave request packet; </p><p id="p0097" num="0097"> 'Max Response Time' identifies a maximum time to wait before responding to a query packet; </p><p id="p0098" num="0098"> 'VSI-ID' is the ID of the VSI, identifying the instance number to which the IGMP request packet belongs; </p><p id="p0099" num="0099"> 'Checksum' is a check sum for the IGMP packet; and </p><p id="p0100" num="0100"> 'Multicast Address' is an address of the private network multicast group, such as 239.1.1.1 used in this example. </p><p id="p0101" num="0101">At block 94, the PE device transmits the extended leave request packet to peer PE devices within the VSI domain. In the example in Fig. 10, the extended packet 94 is broadcasted to reach peer PE devices PE2, PE3 and PE4. </p><p id="p0102" num="0102">At blocks 95 and 96, after receiving and analysing the extended packet, each peer PE device proceeds to updates the membership information relating to VSI-ID, by deleting the VSI-ID, private network multicast group address and PW information associated with the PE device that transmitted the extended packet. </p><p id="p0103" num="0103">Referring to block 92 again, if the private network multicast group is removed from the PE device, the PE device also sends a PIM notification packet to upstream devices to notify its exit from the public network multicast group address associated with the private network multicast group. The upstream devices then update its forwarding information for the public network multicast group address to delete the outgoing interface associated with the PE device. In the example in Fig. 11, a PIM notification packet 112 from PE1 reaches PI and P3 before arriving at multicast source PE2. PE1 updates its forwarding information 114 to remove the interface between PI and PE1 as an outgoing interface for 224.1.1.1 and P3 updates its forwarding information 116 to remove the interface between P3 and PI as an outgoing interface for 224.1.1.1. Similarly, the multicast source PE2 also updates its forwarding information 118 to remove the interface between PE2 and P3 as an 
<!-- EPO <DP n="17"/>-->
 outgoing interface for 224.1.1.1. Multicast traffic from PE2 to 239.1.1.1 will no longer be forwarded to PE3. </p><p id="p0104" num="0104">Network Device </p><p id="p0105" num="0105">The above examples can be implemented by hardware, software or firmware or a combination thereof. Referring to Fig. 12, an example structure of a network device capable of acting as a PE device is shown. The example network device 120 includes a processor 122, a memory 124 and a network interface device 128 that communicate with each other via bus 126. The processor 122 implements functional units in the form of a transmission unit 122a, a receiving unit 122b, and a processing unit 122c. Information may be transmitted and received via the network interface device 128, which may include one or more logical or physical ports that connect the network device 120 to another network device. In the case of the network device 120 acting as a first PE device: </p><p id="p0106" num="0106"> The transmission unit 122a is to transmit, to a second provider edge device in the virtual switching instance, a packet having an address of a private network multicast group and an address of a public network multicast group associated with the private network multicast group. </p><p id="p0107" num="0107"> The receiving unit 122b is to receive, from the second provider edge device, a join request packet to join the public network multicast group. </p><p id="p0108" num="0108"> The processing unit 122c is to store forwarding information 124a for the public network multicast group in the memory 124b. The forwarding information 124a relates to an interface over which the join request packet is received by the first provider edge device. </p><p id="p0109" num="0109"> The processing unit 122c is further to encapsulate a multicast packet for the private network multicast group with the address of the public network multicast group. </p><p id="p0110" num="0110"> The transmission unit 122a is further to transmit the encapsulated multicast packet according to the address of the public network multicast group and forwarding information. case of the network device 120 acting as a second PE device: </p><p id="p0111" num="0111"> The receiving unit 122b is to receive, from a first provider edge device in the virtual switching instance, a packet having an address of a private network 
<!-- EPO <DP n="18"/>-->
 multicast group and an address of a public network multicast group associated with the private network multicast group. </p><p id="p0112" num="0112"> The processing unit 122c is to determine whether a customer edge device connected to the second provider edge device is a receiver of a private network multicast group. </p><p id="p0113" num="0113"> The transmission unit 122a is to, if the determination is affirmative, transmit a join request packet to join the public network multicast group to receive a multicast packet from the first device, but otherwise, not transmit the join request packet. </p><p id="p0114" num="0114"> In this example, the multicast packet is encapsulated with the address of the public network multicast group and transmitted by the first provider edge device according to the address of the public network multicast group and forwarding information 124a relating to an interface over which the join request packet is received by the first provider edge device. </p><p id="p0115" num="0115">A network device acting as P device or a CE device may have a structure similar to the example in Fig. 12. Similarly, the network device acting as a P device or CE device has a processor 122, memory 124 and a network interface device 128 communicating with each other via a bus 126. </p><p id="p0116" num="0116">For example, the various methods, processes and functional units described herein may be implemented by the processor 122. The term 'processor' is to be interpreted broadly to include a CPU, processing unit, ASIC, logic unit, or programmable gate array etc. The processes, methods and functional units may all be performed by a single processor 120 or split between several processors (not shown in Fig. 12 for simplicity); reference in this disclosure or the claims to a 'processor' should thus be interpreted to mean 'one or more processors'. Although one network interface device 128 is shown in Fig. 12, processes performed by the network interface device 128 may be split between several network interface devices. As such, reference in this disclosure to a 'network interface device' should be interpreted to mean 'one or more network interface devices". </p><p id="p0117" num="0117">The processes, methods and functional units may be implemented as machine-readable instructions executable by one or more processors, hardware logic circuitry of the one or more processors or a combination thereof. In the example in Fig. 12, the machine- readable instructions 124b are stored in the memory 124. 
<!-- EPO <DP n="19"/>-->
 Further, the processes, methods and functional units described in this disclosure may be implemented in the form of a computer software product. The computer software product is stored in a storage medium and comprises a plurality of instructions for making a computer device (which can be a personal computer, a server or a network device such as a router, switch, bridge, host, access point etc.) implement the methods recited in the examples of the present disclosure. </p><p id="p0118" num="0118">The figures are only illustrations of an example, wherein the units or procedure shown in the figures are not necessarily essential for implementing the present disclosure. Those skilled in the art will understand that the units in the device in the example can be arranged in the device in the examples as described, or can be alternatively located in one or more devices different from that in the examples. The units in the examples described can be combined into one module or further divided into a plurality of sub- units. </p><p id="p0119" num="0119">Although the flowcharts described show a specific order of execution, the order of execution may differ from that which is depicted. For example, the order of execution of two or more blocks may be changed relative to the order shown. Also, two or more blocks shown in succession may be executed concurrently or with partial concurrence. All such variations are within the scope of the present disclosure. </p><p id="p0120" num="0120">It will be appreciated that numerous variations and/or modifications may be made to the processes, methods and functional units as shown in the examples without departing from the scope of the disclosure as broadly described. The examples are, therefore, to be considered in all respects as illustrative and not restrictive. 
</p></description><claims mxw-id="PCLM44727856" ref-ucid="WO-2012113326-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="20"/>-->Claims </claim-statement><claim id="clm-0001" num="1"><claim-text>1. A method for multicast packet transmission by a first provider edge device in a virtual switching instance, the method comprising: </claim-text><claim-text> the first provider edge device transmitting, to a second provider edge device in the virtual switching instance, a packet having an address of a private network multicast group and an address of a public network multicast group associated with the private network multicast group; </claim-text><claim-text> the first provider edge device receiving, from the second provider edge device, a join request packet to join the public network multicast group; </claim-text><claim-text> the first provider edge device storing forwarding information for the public network multicast group, wherein the forwarding information relates to an interface over which the join request packet is received by the first provider edge device; </claim-text><claim-text> the first provider edge device encapsulating a multicast packet for the private network multicast group with the address of the public network multicast group; and the first provider edge device transmitting the encapsulated multicast packet according to the address of the public network multicast group and forwarding information. </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. The method of claim 1, wherein the first and second provider edge devices are connected via an intermediate device, and the encapsulated multicast packet is forwarded, by the intermediate device from the first device to the second provider edge device, based on forwarding information relating to an interface over which the join request packet is received by the intermediate device. </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. The method of claim 1, further comprising prior to the second provider edge device joining the private network multicast group, </claim-text><claim-text> receiving an extended request packet transmitted by the second provider edge device to join the private network multicast group, wherein the extended request packet includes an identifier of the virtual switching instance; and </claim-text><claim-text> storing membership information relating to the identifier of the virtual switching instance, the address of the private network multicast group and an address of the second provider edge device. </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. The method of claim 3, further comprising, prior to encapsulating and transmitting the multicast packet: <!-- EPO <DP n="21"/>--> determining, from the membership information, whether the private network multicast group associated with the identifier of the virtual switching instance has at least one member; </claim-text><claim-text> if the determination is affirmative, encapsulating and transmitting the multicast packet, but otherwise, not encapsulating and transmitting the multicast packet. </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. The method of claim 1, further comprising: </claim-text><claim-text> receiving an extended leave request packet to leave the private network multicast group, wherein the extended request packet is transmitted by the second provider edge device and includes an identifier of the virtual switching instance; and updating membership information relating to the identifier of the virtual switching instance, the address of the private network multicast group and an address of the second provider edge device. </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. The method of claim 1, wherein transmitting the packet having the address of a private network multicast group and the address of a public network multicast group is triggered by a first multicast packet received from a customer edge device connected to the first provider edge device. </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. A method for multicast packet transmission by a second provider edge device in a virtual switching instance, the method comprising: </claim-text><claim-text> the second provider edge device receiving, from a first provider edge device in the virtual switching instance, a packet having an address of a private network multicast group and an address of a public network multicast group associated with the private network multicast group; </claim-text><claim-text> the second provider edge device determining whether a customer edge device connected to the second provider edge device is a receiver of a private network multicast group; and </claim-text><claim-text> if the determination is affirmative, the second provider edge device transmitting a join request packet to the first device to join the public network multicast group to receive a multicast packet from the first device, but otherwise, not transmitting the join request packet; </claim-text><claim-text> wherein the multicast packet is encapsulated with the address of the public network multicast group and transmitted by the first provider edge device according to the address of the public network multicast group and forwarding information relating <!-- EPO <DP n="22"/>--> to an interface over which the join request packet is received by the first provider edge device. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. The method of claim 7, wherein the first and second provider edge devices are connected via an intermediate device; and the multicast packet is forwarded, by the intermediate device from the first device to the second provider edge device, based on forwarding information relating to an interface over which the join request packet is received by the intermediate device. </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. The method of claim 7, further comprising storing mapping information relating to the address of a private network multicast group and the address of a public network multicast group. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. The method of claim 9, further comprising: </claim-text><claim-text> receiving a multicast packet transmitted by the first provider edge device, the multicast packet being encapsulated with the address of the public network multicast group; </claim-text><claim-text> determining, from the mapping information, the address of the private network multicast group associated with the public network multicast group; and </claim-text><claim-text> transmitting the multicast packet to the customer edge device that is a receiver of the private network multicast group. </claim-text></claim><claim id="clm-0011" num="11"><claim-text>11. The method of claim 9, further comprising: </claim-text><claim-text> receiving a request packet from the customer edge device to leave the private network multicast group, wherein the customer edge device is the only receiver of the private network multicast group; and </claim-text><claim-text> determining, from the mapping information, the address of the public network multicast group associated with the private network multicast group; and </claim-text><claim-text> transmitting a leave request packet to leave the public network multicast group, wherein the first provider edge device receiving the leave request packet updates forwarding information for the public network multicast group. </claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. The method of claim 7, further comprising, prior to the second provider edge device joining the private network multicast group: </claim-text><claim-text> receiving a request packet from the customer edge device to join the private network multicast group; <!-- EPO <DP n="23"/>--> extending the request packet to include an identifier of the virtual switching instance; and </claim-text><claim-text> transmitting the extended request packet, wherein the first provider edge device receiving the extended request packet stores information relating to the identifier of the virtual switching instance, the address of the private network multicast group and the second provider edge device. </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. The method of claim 8, further comprising when (i) a request packet from the customer edge device to leave the private network multicast group, wherein the customer edge device is the only receiver of the private network multicast group at the second provider edge device, or (ii) a status of the virtual switching instance changing from UP to DOWN: </claim-text><claim-text> extending the leave request packet to include an identifier of the virtual switching instance; and </claim-text><claim-text> transmitting the extended leave request packet, wherein the first provider edge device receiving the extended leave request packet removes information relating to the identifier of the virtual switching instance, the address of the private network multicast group and the second provider edge device. </claim-text></claim><claim id="clm-0014" num="14"><claim-text>14. A network device for multicast packet transmission, the network device being capable of acting as a first provider edge device and comprising a transmission unit, a receiving unit and a processing unit, wherein: </claim-text><claim-text> the transmission unit is to transmit, to a second provider edge device in the virtual switching instance, a packet having an address of a private network multicast group and an address of a public network multicast group associated with the private network multicast group; </claim-text><claim-text> the receiving unit is to receive, from the second provider edge device, a join request packet to join the public network multicast group; </claim-text><claim-text> the processing unit is to store forwarding information for the public network multicast group, wherein the forwarding information relates to an interface over which the join request packet is received by the first provider edge device and is stored in a memory; </claim-text><claim-text> the processing unit is further to encapsulate a multicast packet for the private network multicast group with the address of the public network multicast group; and <!-- EPO <DP n="24"/>--> the transmission unit is further to transmit the encapsulated multicast packet according to the address of the public network multicast group and forwarding information. </claim-text></claim><claim id="clm-0015" num="15"><claim-text>15. A network device for multicast packet transmission, the network device being capable of acting as a second provider edge device and comprising a receiving unit, a processing unit and a transmission unit, wherein: </claim-text><claim-text> the receiving unit is to receive, from a first provider edge device in the virtual switching instance, a packet having an address of a private network multicast group and an address of a public network multicast group associated with the private network multicast group; </claim-text><claim-text> the processing unit is to determine whether a customer edge device connected to the second provider edge device is a receiver of a private network multicast group; and the transmission unit is to, if the determination is affirmative, transmit a join request packet to join the public network multicast group to receive a multicast packet from the first device, but otherwise, not transmit the join request packet; </claim-text><claim-text> wherein the multicast packet is encapsulated with the address of the public network multicast group and transmitted by the first provider edge device according to the address of the public network multicast group and forwarding information relating to an interface over which the join request packet is received by the first provider edge device. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
