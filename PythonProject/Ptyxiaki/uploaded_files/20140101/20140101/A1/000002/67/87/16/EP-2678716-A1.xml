<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2678716-A1" country="EP" doc-number="2678716" kind="A1" date="20140101" family-id="46718922" file-reference-id="288061" date-produced="20180826" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146550757" ucid="EP-2678716-A1"><document-id><country>EP</country><doc-number>2678716</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12749070-A" is-representative="NO"><document-id mxw-id="PAPP154824680" load-source="docdb" format="epo"><country>EP</country><doc-number>12749070</doc-number><kind>A</kind><date>20120223</date><lang>EN</lang></document-id><document-id mxw-id="PAPP220438238" load-source="docdb" format="original"><country>EP</country><doc-number>12749070.4</doc-number><date>20120223</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140446873" ucid="US-201113033768-A" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201113033768</doc-number><kind>A</kind><date>20110224</date></document-id></priority-claim><priority-claim mxw-id="PPC140449962" ucid="US-2012026243-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>2012026243</doc-number><kind>W</kind><date>20120223</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988133864" load-source="docdb">G01V   1/30        20060101AFI20120914BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1765415770" load-source="docdb" scheme="CPC">G01V2210/64        20130101 LA20170911BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1765415771" load-source="docdb" scheme="CPC">G01V2210/626       20130101 LA20170911BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1765415772" load-source="docdb" scheme="CPC">G01V2210/6222      20130101 LA20170911BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1765415773" load-source="docdb" scheme="CPC">G01V2210/47        20130101 LA20170911BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1765415774" load-source="docdb" scheme="CPC">G01V   1/301       20130101 LA20170911BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988097859" load-source="docdb" scheme="CPC">G01V2210/51        20130101 LA20130307BHEP        </classification-cpc><classification-cpc mxw-id="PCL2112533823" load-source="docdb" scheme="CPC">G01V   1/282       20130101 FI20140909BHEP        </classification-cpc><classification-cpc mxw-id="PCL2112536993" load-source="docdb" scheme="CPC">G01V  11/00        20130101 LA20140909BHEP        </classification-cpc><classification-cpc mxw-id="PCL2112539707" load-source="docdb" scheme="CPC">G01V   1/303       20130101 LI20140910BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132184755" lang="DE" load-source="patent-office">KERNELBASIERTE EMPFINDLICHE MIGRATIONSGESCHWINDIGKEITSANALYSE IN ANISOTROPEN 3D-MEDIEN</invention-title><invention-title mxw-id="PT132184756" lang="EN" load-source="patent-office">SENSITIVITY KERNEL-BASED MIGRATION VELOCITY ANALYSIS IN 3D ANISOTROPIC MEDIA</invention-title><invention-title mxw-id="PT132184757" lang="FR" load-source="patent-office">ANALYSE DE VITESSE DE MIGRATION FONDÉE SUR NOYAU DE SENSIBILITÉ DANS MILIEUX ANISOTROPES 3D</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR918156844" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>LANDMARK GRAPHICS CORP</last-name><address><country>US</country></address></addressbook></applicant><applicant mxw-id="PPAR918140320" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>LANDMARK GRAPHICS CORPORATION</last-name></addressbook></applicant><applicant mxw-id="PPAR918981929" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Landmark Graphics Corporation</last-name><iid>101398115</iid><address><street>2147 City West Blvd. Bldg. 2</street><city>Houston, Texas 77042</city><country>US</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918169879" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>XIA FAN</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918158385" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>XIA, Fan</last-name></addressbook></inventor><inventor mxw-id="PPAR918988062" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>XIA, Fan</last-name><address><street>10925 Briar Forest Dr. 2125</street><city>Houston, TX 77042</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918164439" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>REN YIQING</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918170269" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>REN, YIQING</last-name></addressbook></inventor><inventor mxw-id="PPAR918978727" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>REN, YIQING</last-name><address><street>1800 Austin Parkway Apt. 906</street><city>Sugar Land, TX 77479</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918136057" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>JIN SHENGWEN</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918142947" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>JIN, SHENGWEN</last-name></addressbook></inventor><inventor mxw-id="PPAR918991081" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>JIN, SHENGWEN</last-name><address><street>5226 Harvest Bend Ct</street><city>Sugar Land, TX 77479</city><country>US</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918983602" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Jennings, Michael John</last-name><suffix>et al</suffix><iid>101044567</iid><address><street>A.A. Thornton &amp; Co. 235 High Holborn</street><city>London, WC1V 7LE</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="US-2012026243-W"><document-id><country>US</country><doc-number>2012026243</doc-number><kind>W</kind><date>20120223</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012116134-A1"><document-id><country>WO</country><doc-number>2012116134</doc-number><kind>A1</kind><date>20120830</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS548813333" load-source="docdb">AL</country><country mxw-id="DS548915190" load-source="docdb">AT</country><country mxw-id="DS548813334" load-source="docdb">BE</country><country mxw-id="DS548916038" load-source="docdb">BG</country><country mxw-id="DS548861390" load-source="docdb">CH</country><country mxw-id="DS548924209" load-source="docdb">CY</country><country mxw-id="DS548915191" load-source="docdb">CZ</country><country mxw-id="DS548813335" load-source="docdb">DE</country><country mxw-id="DS548924210" load-source="docdb">DK</country><country mxw-id="DS548924211" load-source="docdb">EE</country><country mxw-id="DS548917387" load-source="docdb">ES</country><country mxw-id="DS548916039" load-source="docdb">FI</country><country mxw-id="DS548916040" load-source="docdb">FR</country><country mxw-id="DS548813336" load-source="docdb">GB</country><country mxw-id="DS548924212" load-source="docdb">GR</country><country mxw-id="DS548813337" load-source="docdb">HR</country><country mxw-id="DS548915192" load-source="docdb">HU</country><country mxw-id="DS548861391" load-source="docdb">IE</country><country mxw-id="DS548813338" load-source="docdb">IS</country><country mxw-id="DS548916041" load-source="docdb">IT</country><country mxw-id="DS548924213" load-source="docdb">LI</country><country mxw-id="DS548901239" load-source="docdb">LT</country><country mxw-id="DS548915193" load-source="docdb">LU</country><country mxw-id="DS548901240" load-source="docdb">LV</country><country mxw-id="DS548901241" load-source="docdb">MC</country><country mxw-id="DS548833865" load-source="docdb">MK</country><country mxw-id="DS548833866" load-source="docdb">MT</country><country mxw-id="DS548917388" load-source="docdb">NL</country><country mxw-id="DS548916046" load-source="docdb">NO</country><country mxw-id="DS548833867" load-source="docdb">PL</country><country mxw-id="DS548861392" load-source="docdb">PT</country><country mxw-id="DS548917389" load-source="docdb">RO</country><country mxw-id="DS548861393" load-source="docdb">RS</country><country mxw-id="DS548833868" load-source="docdb">SE</country><country mxw-id="DS548861394" load-source="docdb">SI</country><country mxw-id="DS548916047" load-source="docdb">SK</country><country mxw-id="DS548833869" load-source="docdb">SM</country><country mxw-id="DS548924214" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA99618766" ref-ucid="WO-2012116134-A1" lang="EN" load-source="patent-office"><p num="0000">Seismic imaging systems and methods that employ sensitivity kernel-based migration velocity analysis in 3D anisotropic media may demonstrate increased stability and accuracy. Survey data analysts employing the disclosed systems and methods are expected to provide better images of the subsurface and be better able to identify reservoirs and deposits for commercial exploitation. Certain embodiments migrate seismic survey data with an anisotropic velocity model to obtain common angle image gathers. These gathers are processed to obtain depth residuals along one or more horizons. Angle-domain sensitivity kernels are used to convert the depth residuals into velocity errors, which are then used to refine the velocity model. A user is then able to view a representation of the subsurface structure determined in part from the refined velocity model. Multiple iterations may be needed for the velocity model to converge. The velocity model may be a layered to have constant velocity values between formation boundaries.</p></abstract><abstract mxw-id="PA99818453" ref-ucid="WO-2012116134-A1" lang="EN" source="national office" load-source="docdb"><p>Seismic imaging systems and methods that employ sensitivity kernel-based migration velocity analysis in 3D anisotropic media may demonstrate increased stability and accuracy. Survey data analysts employing the disclosed systems and methods are expected to provide better images of the subsurface and be better able to identify reservoirs and deposits for commercial exploitation. Certain embodiments migrate seismic survey data with an anisotropic velocity model to obtain common angle image gathers. These gathers are processed to obtain depth residuals along one or more horizons. Angle-domain sensitivity kernels are used to convert the depth residuals into velocity errors, which are then used to refine the velocity model. A user is then able to view a representation of the subsurface structure determined in part from the refined velocity model. Multiple iterations may be needed for the velocity model to converge. The velocity model may be a layered to have constant velocity values between formation boundaries.</p></abstract><abstract mxw-id="PA99618767" ref-ucid="WO-2012116134-A1" lang="FR" load-source="patent-office"><p num="0000">Selon l'invention, des systèmes et des procédés d'imagerie sismique, qui emploient une analyse de vitesse de migration fondée sur un noyau de sensibilité dans des milieux anisotropes en 3D, peuvent faire preuve d'une stabilité et d'une précision accrues. Des analyses de données d'étude, employant les systèmes et les procédés décrits, devraient fournir de meilleures images du sous-sol et être mieux capables d'identifier des réservoirs et des gisements en vue d'une exploitation commerciale. Certains modes de réalisation effectuent une migration de données d'étude sismique à l'aide d'un modèle de vitesse anisotrope pour obtenir des films avec traces en position miroir d'image à angle commun. Ces films sont traités afin d'obtenir des résidus de profondeur le long d'un ou de plusieurs horizons. Des noyaux de sensibilité dans le domaine des angles sont utilisés pour convertir les résidus de profondeur en erreurs de vitesse, qui sont ensuite utilisées pour affiner le modèle de vitesse. Un utilisateur est alors en mesure de visualiser une représentation de la structure souterraine, déterminée en partie par le modèle de vitesse affiné. De multiples itérations peuvent être nécessaires pour que le modèle de vitesse converge. Le modèle de vitesse peut être en couches pour avoir des valeurs de vitesse constantes entre des limites de formation.</p></abstract><abstract mxw-id="PA99818454" ref-ucid="WO-2012116134-A1" lang="FR" source="national office" load-source="docdb"><p>Selon l'invention, des systèmes et des procédés d'imagerie sismique, qui emploient une analyse de vitesse de migration fondée sur un noyau de sensibilité dans des milieux anisotropes en 3D, peuvent faire preuve d'une stabilité et d'une précision accrues. Des analyses de données d'étude, employant les systèmes et les procédés décrits, devraient fournir de meilleures images du sous-sol et être mieux capables d'identifier des réservoirs et des gisements en vue d'une exploitation commerciale. Certains modes de réalisation effectuent une migration de données d'étude sismique à l'aide d'un modèle de vitesse anisotrope pour obtenir des films avec traces en position miroir d'image à angle commun. Ces films sont traités afin d'obtenir des résidus de profondeur le long d'un ou de plusieurs horizons. Des noyaux de sensibilité dans le domaine des angles sont utilisés pour convertir les résidus de profondeur en erreurs de vitesse, qui sont ensuite utilisées pour affiner le modèle de vitesse. Un utilisateur est alors en mesure de visualiser une représentation de la structure souterraine, déterminée en partie par le modèle de vitesse affiné. De multiples itérations peuvent être nécessaires pour que le modèle de vitesse converge. Le modèle de vitesse peut être en couches pour avoir des valeurs de vitesse constantes entre des limites de formation.</p></abstract><description mxw-id="PDES50929929" ref-ucid="WO-2012116134-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="2"/>--><p id="p0001" num="0001"> SENSITIVITY KERNEL-BASED MIGRATION VELOCITY ANALYSIS IN 3D </p><p id="p0002" num="0002"> ANISOTROPIC MEDIA </p><p id="p0003" num="0003">Cross-Reference to Related Application </p><p id="p0004" num="0004"> The present application claims priority to U.S. Patent Application No. 13/033,768, titled "Sensitivity Kernel-Based Migration Velocity Analysis in 3D Anisotropic Media" and filed February 24, 2011 by inventors Fan Xia, Yiqing Ren and Shengwen Jin which is hereby incorporated herein by reference. </p><p id="p0005" num="0005"> BACKGROUND </p><p id="p0006" num="0006"> Seismology is used for exploration, archaeological studies, and engineering projects that require geological information. Exploration seismology provides data that, when used in conjunction with other available geophysical, borehole, and geological data, provides information about the structure and distribution of rock types and their contents. Such information greatly aids searches for water, geothermal reservoirs, and mineral deposits such as hydrocarbons and ores. Most oil companies rely on exploration seismology to select sites in which to drill exploratory oil wells. </p><p id="p0007" num="0007"> Traditional seismology employs artificially-generated seismic waves to map subsurface structures. The seismic waves propagate from a source down into the earth and reflect from boundaries between subsurface structures. Surface receivers detect and record reflected seismic waves for later analysis. Though some large-scale structures can often be perceived from a direct examination of the recorded signals, the recorded signals must be processed to remove distortion and reveal finer detail in the subsurface image. Because this processing includes migration (a conversion of the measured time-dependent waveforms into position-dependent seismic information), the quality of the resulting subsurface image is highly dependent on the accuracy of the estimated seismic wave propagation speeds. A 
<!-- EPO <DP n="3"/>-->
 subsurface velocity model is used during the migration step to specify how this propagation speed varies as a function of position, </p><p id="p0008" num="0008"> "Velocity analysis" is the term used to describe the act of extracting velocity information from seismic data. One way to perform velocity analysis is to begin with an assumed velocity model, to migrate the seismic data based on this model, and to analyze the residual curvature ("residual moveout") of the migrated seismic data to determine errors in the assumed velocity model. The velocity model can then be updated and the process repeated until the model converges. This approach to velocity analysis is called "migration velocity analysis" or "MVA". </p><p id="p0009" num="0009"> The residual curvature at a given position is a function not only of the local velocity error at that position, but also of the velocity errors all along the path traversed by the seismic waves. To separate out the individual contributions to the residual curvatures, the subsurface structure can be analyzed from a tomographic perspective. See, e.g.: </p><p id="p0010" num="0010"> Stork, C, and R. W. Clayton, 1991, Linear aspects of tomographic velocity analysis: </p><p id="p0011" num="0011"> Geophysics, 56, 483^195. </p><p id="p0012" num="0012"> Stork, C, 1992, Reflection tomography in the postmigrated domain: Geophysics, 57, 680-692. </p><p id="p0013" num="0013"> Liu, Z., 1997, An analytical approach to migration velocity analysis: Geophysics, 62, 1238-1249. </p><p id="p0014" num="0014"> Meng, Z., N. Bleistein, and K. D. Wyatt, 1999, 3D analytical migration velocity analysis I: Two-step velocity estimation by reflector-normal update: 69th Annual</p><p id="p0015" num="0015">International Meeting, SEG, Expanded Abstracts, 1727-1730. </p><p id="p0016" num="0016"> Meng, Z., P. A. Valasek, S. A. Whitney, C. B. Sigler, B. K. Macy, and N. Dan Whitmore, 2004, 3D global tomographic velocity model building: 74th Annual International Meeting, SEG, Expanded Abstracts, 2379-2382. </p><p id="p0017" num="0017"> Mosher, C. C, S. Jin, and D. J. Foster, 2001, Migration velocity analysis using common angle image gathers: 71st Annual International Meeting, SEG, Expanded Abstracts, 889-892. </p><p id="p0018" num="0018"> Zhou, H., S. H. Gray, J. Young, D. Pham, and Y. Zhang, 2003, Tomographic residual curvature analysis: The process and its components: 73rd Annual International Meeting, SEG, Expanded Abstracts, 666-669. </p><p id="p0019" num="0019"> For the most part, existing MVA techniques rely on ray-based tomography to convert the residual curvature into updates for the velocity model. The assumptions inherent in ray- 
<!-- EPO <DP n="4"/>-->
 based tomography cause excessive smoothing in the velocity updates, thereby limiting resolution of the resulting velocity model. To address this issue, a recent paper (Xie, X., and H. Yang, 2008, The finite-frequency sensitivity kernel for migration residual moveout: Geophysics, 73, S241-249) proposes the use of a sensitivity kernel to determine velocity model updates from relative residual moveout values. However, the velocity models produced by the method described in the paper also have limited resolution and in many cases they fail to match accepted geophysical principles. </p><p id="p0020" num="0020">BRIEF DESCRIPTION OF THE DRAWINGS </p><p id="p0021" num="0021"> A better understanding of the various disclosed embodiments can be obtained when the following detailed description is considered in conjunction with the attached drawings, in which: </p><p id="p0022" num="0022"> Fig. 1 shows an illustrative seismic survey environment; </p><p id="p0023" num="0023"> Fig. 2 shows an illustrative seismic source and receiver geometry; </p><p id="p0024" num="0024"> Fig, 3 shows an illustrative seismic survey recording system; </p><p id="p0025" num="0025"> Fig. 4 shows illustrative seismic traces; </p><p id="p0026" num="0026"> Fig. 5 shows an illustrative data volume in three dimensions; </p><p id="p0027" num="0027"> Fig. 6 shows an illustrative shot geometry; </p><p id="p0028" num="0028"> Fig. 7 shows a flowchart of an illustrative seismic imaging method; </p><p id="p0029" num="0029"> Figs. 8a-8d show illustrative velocity models; </p><p id="p0030" num="0030"> Figs. 9a-9g show illustrative data volumes produced at different stages of one example; and </p><p id="p0031" num="0031"> Fig. 10 shows an illustrative imaging system. </p><p id="p0032" num="0032"> While the disclosed embodiments susceptible to various modifications and alternative forms, specific implementations are shown by way of example in the drawings and will be 
<!-- EPO <DP n="5"/>-->
 described herein in detail. It should be understood, however, that the drawings and detailed description are not intended to limit the disclosed embodiments to the particular form shown, but on the contrary, the intention is to cover all modifications, equivalents and alternatives falling within the scope of the appended claims. </p><p id="p0033" num="0033">DETAILED DESCRIPTION </p><p id="p0034" num="0034"> The issues identified in the background above are at least in part addressed by seismic imaging systems and methods that employ sensitivity kernel-based migration velocity analysis in 3D anisotropic media. Relative to existing methods, the disclosed systems and methods demonstrate increased stability and accuracy. Survey data analysts employing the disclosed systems and methods are expected to provide better images of the subsurface and be better able to identify reservoirs and deposits for commercial exploitation. Certain method embodiments migrate seismic survey data with an anisotropic velocity model to obtain common angle image gathers. These gathers are processed to obtain depth residuals along one or more horizons. Angle-domain sensitivity kernels are used to convert the depth residuals into velocity errors, which are then used to refine the velocity model. A user is then able to view a representation of the subsurface structure determined in part from the refined velocity model. Multiple iterations may be needed for the velocity model to converge. In some instances the velocity model is constrained or converted to a layered model having constant velocity values between formation boundaries. </p><p id="p0035" num="0035"> The disclosed systems and methods are best understood when described in an illustrative usage context. Accordingly, Fig. 1 shows an illustrative seismic survey environment, in which surveyors position an array of seismic receivers 102 in a spaced-apart arrangement on the earth's surface 104 to detect seismic waves. (The array typically extends for a couple of kilometers in each direction, and may be moved after each series of shots until 
<!-- EPO <DP n="6"/>-->
 the whole survey region has been covered.) The receivers 102 communicate wirelessly or via cable to a data acquisition unit 106 that receives, processes, and stores the seismic signal data collected by the receivers. The surveyors trigger a seismic energy source 108 (e.g., a vibrator truck) at multiple positions ("shot locations") to generate seismic energy waves that propagate through the earth 110. Such waves reflect from acoustic impedance discontinuities to reach the receivers 102. Illustrative discontinuities include faults, boundaries between formation beds, and boundaries between formation fluids. The discontinuities appear as bright spots in the subsurface structure representation that is derived from the seismic signal data. </p><p id="p0036" num="0036"> Fig. 1 further shows an illustrative subsurface structure. In this figure, the earth has three relatively flat formation layers and two dipping formation layers of varying composition and hence varying speeds of sound. Within each formation, the speed of sound can be isotropic (i.e., the same in every direction) or anisotropic. Due to the manner in which rocks are formed, nearly all anisotropic formations are transversely isotropic. In other words the speed of sound in anisotropic formations is the same in every "horizontal" direction, but is different for sound traveling in the "vertical" direction. Note, however, that geological activity can change formation orientations, turning a vertical transversely isotropic ("VTI") formation into a tilted transversely isotropic ("TTI") formation. In Fig. 1 shows the third flat layer as being VTI, while the first dipping formation layer is TTI. </p><p id="p0037" num="0037"> Fig. 2 shows an illustrative geometry for source positions 202 and receiver positions 204, as they might be seen from an overhead view. Viable seismic survey geometries are infinite in variety, and can be gathered on a sector-by-sector basis, a rolling geometry basis, a moving-array basis, and various combinations thereof. The main message here is that the number of receiver signals acquired in response to each firing of the seismic source is fairly 
<!-- EPO <DP n="7"/>-->
 large, and when the number of source firings is taken into account, the resulting number of traces can easily reach into the millions. </p><p id="p0038" num="0038"> Fig. 3 shows an illustrative seismic survey recording system having the receivers 102 coupled to a bus 302 to communicate digital signals to data recording circuitry 306. Position information sensors 304 (and optionally sensors for other parameters) are also coupled to the data recording circuitry 306 to enable the data recording circuitry to store additional information useful for interpreting the recorded data. Illustratively, such additional information can include the precise locations of the receivers and source firings, source waveform characteristics, digitization settings, detected faults in the system, etc. </p><p id="p0039" num="0039"> The seismic sensors 102 may each include multi-axis accelerometers and/or geophones and, in some environments, hydrophones, each of which may take high-resolution samples (e.g., 16 to 32 bits) at a programmable sampling rate (e.g., 400 Hz to 1 kHz). Recording circuitry 306 acquires the data streams from receivers 102 onto a nonvolatile storage medium such as a storage array of optical or magnetic disks. The data is stored in the form of (possibly compressed) seismic traces, each trace being the signal detected and sampled by a given receiver in response to a given shot. (The associated shot and receiver positions are also stored.) Illustrative seismic signals are shown in Fig. 4. The signals indicate some measure of seismic wave energy as a function of time (e.g., displacement, velocity, acceleration, pressure). </p><p id="p0040" num="0040"> The signal data can be partitioned in different ways to make processing and analysis more feasible. When partitioned based on a given parameter, each data partition is called a "gather". For example, a "shot gather" is the group of traces recorded for a single firing of the seismic source. A "common midpoint gather" is the group of traces that have a midpoint within a defined region. "Image gathers" are partitions of the migrated ("image") data based on the given parameter. Thus "common offset image gathers" constitute partitions of the 
<!-- EPO <DP n="8"/>-->
 image data according to the distance between source and receiver, while "common angle image gathers" are partitioned according to the incidence (or reflection) angle of seismic energy at the image point. At one or more points in the image formation process, the gathers may be added together ("stacked") to obtain a combined data set, e.g., a final image of the subsurface structure. </p><p id="p0041" num="0041"> A general purpose data processing system 308 receives the acquired seismic survey data from the data recording circuitry 306. In some cases the general purpose data processing system 308 is physically coupled to the data recording circuitry and provides a way to configure the recording circuitry and perform preliminary processing in the field. More typically, however, the general purpose data processing system is located at a central computing facility with adequate computing resources for intensive processing. The survey data can be transported to the central facility on physical media or communicated via a computer network. Processing system 308 includes a user interface having a graphical display and a keyboard or other method of accepting user input, enabling users to view and analyze the subsurface structure images derived from the seismic survey data. </p><p id="p0042" num="0042"> The recorded seismic survey data is of little use when maintained in the format of Fig. 4. Although it is possible to plot the various recorded waveforms side by side in a plot that reveals large scale subsurface structures, such structures are distorted and finer structures cannot even be seen. Accordingly, the data is processed to create a data volume, i.e., a three dimensional array of data values such as that shown in Fig. 5. The data volume represents some seismic attribute throughout the survey region. The three-dimensional array comprises uniformly-sized cells, each cell having a data value representing the seismic attribute for that cell. Various seismic attributes may be represented, and in some embodiments, each cell has multiple data values to represent multiple seismic attributes. Examples of suitable seismic attributes include reflectivity, acoustic impedance, acoustic velocity, and density. The 
<!-- EPO <DP n="9"/>-->
 volumetric data format readily lends itself to computational analysis and visual rendering, and for this reason, the data volume may be termed a "three-dimensional image" of the survey region. </p><p id="p0043" num="0043"> To explain how the seismic data is often partitioned and processed, it is helpful to define a notation for certain parameters. Fig. 6 shows some of the parameters relating to the geometry of an illustrative shot. Seismic energy propagates along ray 602 from a seismic source at location r<sub>S</sub> to a point r<sub>T</sub> on a target interface 604, from which it partially reflects upward along ray 606 towards a receiver at location r<sub>R</sub>. At the reflection point r<sub>T</sub>, the interface 604 has a normal vector n. In a predefined coordinate system having the x- and y- axes in a horizontal plane and an upward-pointing z-axis, the normal vector n forms an angle with each axis. The angle between the normal vector n and the x-axis is the angle between 
<img id="imgf000009_0002" he="9" wi="7" file="imgf000009_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0044" num="0044"> the normal vector n and the y-axis is and the angle between the z-axis and the normal 
<img id="imgf000009_0001" he="10" wi="7" file="imgf000009_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0045" num="0045"> vector n is The incoming ray 602 and reflected ray 606 are at equal (but opposite) "opening" angles relative to the normal vector. Relative to the z-axis, the incoming ray 602 
<img id="imgf000009_0003" he="9" wi="6" file="imgf000009_0003.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0046" num="0046"> forms incident angle and the reflected ray forms a reflection (aka scattering) angle g. The 
<img id="imgf000009_0004" he="8" wi="5" file="imgf000009_0004.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 
<img id="imgf000009_0005" he="8" wi="5" file="imgf000009_0005.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 incident and scattering angle pair can be converted to a normal and opening angle pair 
<img id="imgf000009_0006" he="9" wi="13" file="imgf000009_0006.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
</p><p id="p0047" num="0047"><img id="imgf000009_0007" he="7" wi="16" file="imgf000009_0007.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 according to the relationships: 
<img id="imgf000009_0008" he="12" wi="156" file="imgf000009_0008.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0048" num="0048"> With this understanding of the shot geometry, we now turn the illustrative seismic data processing method of Fig. 7, which begins in block 702 with the obtaining of seismic survey data. The survey data is typically in a trace format, e.g., pressure field data as a function of shot location, receiver location, and time Traditionally a change of 
<img id="imgf000009_0011" he="9" wi="20" file="imgf000009_0011.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0049" num="0049"> variable is performed to place this data in the midpoint-offset-time domain, i.e., P(m,h,t), where midpoint and offset Observing that this data represents the 
<img id="imgf000009_0010" he="10" wi="24" file="imgf000009_0010.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 
<img id="imgf000009_0009" he="8" wi="20" file="imgf000009_0009.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 
<!-- EPO <DP n="10"/>-->
 pressure field observed at the surface (2=0), the wavefield equation is employed to extrapolate the subsurface wavefield, a process known as migrating the data. The fundamentals for this process are described in Chapter 1 of Jon F. Claerbout, Imaging the Earth's Interior, Blackwell Scientific Publications, Oxford, 1985. </p><p id="p0050" num="0050"> Among other things, migration requires a velocity model v(r), which specifies a wave propagation speed for every point r in the subsurface volume V. Accordingly, an initial velocity model is postulated in block 704. An initial velocity model can be postulated based on any one of a number of approaches including: a constant velocity, a velocity that increases linearly with depth, a velocity derived from theoretical models of rock compaction, and measured values from sonic logs of an exploratory borehole. Fig. 8a shows an illustrative velocity model having a velocity that increases linearly with depth starting at 3500 m/s. This model will be used as the initial velocity model in the example that follows. </p><p id="p0051" num="0051"> In block 706 (Fig. 7), the velocity model is used to migrate the survey data. Any one of the existing wave-equation based migration techniques can be employed to obtain the subsurface data volume. One such migration technique is described in Marie L. Prucha, Biondo L Biondi, and William W. Symes, "Angle-domain common image gathers by wave- equation migration", Stanford Exploration Project, Report 100, April 20, 1999, pp. 101-113, and can be summarized as follows: </p><p id="p0052" num="0052"><img id="imgf000010_0001" he="42" wi="153" file="imgf000010_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/></p><p id="p0053" num="0053"> Equation (2) represents a Fourier transform of the data set to convert the data acquired at the surface (z=0) into the midpoint-offset-frequency domain. Equation (3) represents the migration of the data set using the well-known double square root (DSR) equation for 
<!-- EPO <DP n="11"/>-->
 extrapolating a wavefield. (See, e.g., Biondi and Palacharla, 1996, 3-D prestack migration of common-azimuth data: Geophysics, 61, 1822-1832), Equation (4) represents a Radon transform, which is also termed a "slant stack" operation, of the data into the midpoint-p<sub>h</sub>-tau domain (see e.g., U.S. Pat. 4779238). Offset ray parameters p<sub>h</sub> and tau represent slope and intercept of slant lines used to stack the data. </p><p id="p0054" num="0054"> As indicated by equation (5), setting tau equal to zero provides a set of angle-domain common-image gathers, which can be viewed as a set of images P(m,p<sub>h</sub>,z), each image being derived from seismic energy impacting the reflector at a different angle. The offset ray parameter p<sub>h</sub> is related to the local dip
<img id="imgf000011_0003" he="9" wi="6" file="imgf000011_0003.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 and opening angle by the equation:</p><p id="p0055" num="0055"><img id="imgf000011_0002" he="10" wi="5" file="imgf000011_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/></p><p id="p0056" num="0056"><img id="imgf000011_0001" he="11" wi="150" file="imgf000011_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/></p><p id="p0057" num="0057">where S(m,z) is the slowness (the inverse of acoustic velocity V(m,z)) in the neighborhood of the reflector. (Because velocity and slowness have a one-to-one relationship, these terms are sometimes used interchangeably.) </p><p id="p0058" num="0058"> As previously mentioned, other migration techniques can be employed. Such alternative techniques may result in different image gathers, e.g., shot index gathers as described in Xie, X., and H. Yang, 2008, The finite-frequency sensitivity kernel for migration residual moveout: Geophysics, 73, S241-249. </p><p id="p0059" num="0059"> In block 708, the gathers are stacked to obtain a combined image of the structure in the subsurface volume. Note that the individual gathers are not yet discarded, but are stored for later use in block 712. Figs. 9a and 9b show an example of a combined image obtained from shot index gathers migrated based on the initial velocity model of Fig. 8a. Fig. 9a shows pixels as a function of a vertical axis (depth) and horizontal axis (inline- or x-axis). The pixel brightness represents the field intensity at the corresponding point. Fig. 9b shows pixels as a function of a vertical axis (depth) and horizontal axis (shot index), with the pixel brightness representing field intensity as a function of depth and shot index. 
<!-- EPO <DP n="12"/>-->
 Even though the velocity model is in error, one can nevertheless perceive significant structure in the stacked image data. The velocity model error is made most evident by the residual curvature present in Fig. 9b, though smearing and ghosting of the structures in Fig. 9a also suggests that the velocity model is inaccurate. Nevertheless, the structure is clear enough to permit horizon picking as indicated in Fig. 9c. This operation is represented in Fig. 7 as block 710. Horizon picking can be performed manually, or it can be performed automatically with the use of standard image processing algorithms. These horizons will be used as constraints to improve the accuracy of subsequent processing operations. </p><p id="p0060" num="0060"> In block 712, the depth residuals are determined at each grid point on the picked horizons. To determine the depth residual, the system begins by scanning through a range of velocity error values. The error values are expressed as
<img id="imgf000012_0005" he="8" wi="6" file="imgf000012_0005.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 a ratio of the model velocity to the actual velocity, where the values are measured by averaging the velocities from the surface to the selected point on the horizon. The range over which
<img id="imgf000012_0004" he="7" wi="5" file="imgf000012_0004.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 is tested will vary, but in some implementations will be 0.5 to 1.5. For each value of
<img id="imgf000012_0006" he="8" wi="7" file="imgf000012_0006.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 the corresponding depth shift for each image gather is determined. For shot-indexed image gathers, the depth shift is 
<img id="imgf000012_0002" he="20" wi="156" file="imgf000012_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0061" num="0061">where z<sub>0</sub> is the depth of the selected point, is the structural dip angle, is the opening 
<img id="imgf000012_0007" he="8" wi="6" file="imgf000012_0007.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 
<img id="imgf000012_0008" he="8" wi="7" file="imgf000012_0008.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0062" num="0062">angle, is the incident angle and is the scattering angle. For slowness angle image 
<img id="imgf000012_0003" he="11" wi="6" file="imgf000012_0003.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0063" num="0063">gathers, the depth shift is </p><p id="p0064" num="0064"><img id="imgf000012_0001" he="33" wi="151" file="imgf000012_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/></p><p id="p0065" num="0065">where v is the local velocity from the velocity model. 
<!-- EPO <DP n="13"/>-->
 For each value of □, the system applies the appropriate depth shift to the image gathers and calculates their semblance in the neighborhood of the selected point. Fig. 9d shows illustrative semblance values as a function of a vertical axis
<img id="imgf000013_0005" he="8" wi="7" file="imgf000013_0005.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 and a horizontal axis (inline- or x-axis position on the current horizon). The value of
<img id="imgf000013_0006" he="7" wi="6" file="imgf000013_0006.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 that maximizes the semblance at each given position is identified and used in equation (7) or (8) to determine the corresponding depth residual for that horizon grid point in each image gather. These depth residuals are hereafter referenced as where vindicates an image gather (e.g., an 
<img id="imgf000013_0004" he="10" wi="18" file="imgf000013_0004.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0066" num="0066">index value for a shot-index image gather, or an offset ray parameter value for a common angle image gather) and r<sub>I</sub> is an image point in that gather. In Fig. 9d, the position of the semblance maximum varies with position, but for the most part is just above the horizontal centerline of the figure, indicating that
<img id="imgf000013_0007" he="8" wi="4" file="imgf000013_0007.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 is generally slightly greater than one. Fig. 9e shows the resulting depth residuals that will be employed in a later step. </p><p id="p0067" num="0067"> In block 716, sensitivity kernels are determined. These kernels will be the basis of the conversion of relative residual moveouts into velocity model updates. The system of equations to be solved is: 
<img id="imgf000013_0001" he="14" wi="158" file="imgf000013_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0068" num="0068">where the summation is over a grid of points r<sub>i</sub> in the image volume, the integral is over a rectangular cell corresponding to the grid point r<sub>i</sub> m(r,) is the normalized local velocity perturbation
<img id="imgf000013_0002" he="9" wi="20" file="imgf000013_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 (which is the unknown variable in this equation), and represent 
<img id="imgf000013_0008" he="8" wi="5" file="imgf000013_0008.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 
<img id="imgf000013_0009" he="8" wi="5" file="imgf000013_0009.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 different image gathers, and is a combination of the broadband sensitivity 
<img id="imgf000013_0003" he="11" wi="28" file="imgf000013_0003.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0069" num="0069">kernels for the different image gathers. For the shot-indexed image gathers, the combined broadband sensitivity kernel is: 
<!-- EPO <DP n="14"/>-->
 
<img id="imgf000014_0001" he="33" wi="162" file="imgf000014_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="yes"/>
 </p><p id="p0070" num="0070">where Cl ri,rs) is the opening angle, and the broadband kernel components are </p><p id="p0071" num="0071"><img id="imgf000014_0002" he="35" wi="153" file="imgf000014_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/></p><p id="p0072" num="0072">where
<img id="imgf000014_0005" he="7" wi="37" file="imgf000014_0005.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 s the Green's function from the scatter point r to the image point 17, GD and Gu are Green's functions for down- and up-going waves, respectively, and the weighting function is based on the power spectrum of a source (or other 
<img id="imgf000014_0006" he="9" wi="11" file="imgf000014_0006.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 
<img id="imgf000014_0007" he="8" wi="11" file="imgf000014_0007.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0073" num="0073">reference) signal: 
<img id="imgf000014_0003" he="17" wi="158" file="imgf000014_0003.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0074" num="0074"> Xie, X. and H. Yang, 2008, "A wave-equation velocity analysis approach based on the finite-frequency sensitivity kernel", 78<sup>th</sup> SEG Expanded Abstracts, discloses an interpolation method that reduces storage requirements for the broadband kernels of equation (9). With this method, the grid of image points can be partitioned into a relatively small number of cells whose size depends on the required accuracy. As outlined by Xie and Yang, each of the integrals in equation (9) becomes (for 2D cells) the matrix equation: </p><p id="p0075" num="0075"><img id="imgf000014_0004" he="28" wi="176" file="imgf000014_0004.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="yes"/></p><p id="p0076" num="0076">where r<sub>ls</sub> r<sub>2</sub>, Γ3, and r<sub>4</sub> are the four corners of the cell, with ri being the origin (r<sub>;</sub>), r<sub>2</sub> being found along the x-axis (r, +X), r<sub>3</sub> being found along the y-axis (r<sub>;</sub>- +Y), and r<sub>4</sub> being the far 
<!-- EPO <DP n="15"/>-->
 corner. The partitioned kernels are: </p><p id="p0077" num="0077"><img id="imgf000015_0001" he="52" wi="157" file="imgf000015_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/></p><p id="p0078" num="0078">Equations (13) and (14) are for two dimensions, but can be readily extended to three dimensions. </p><p id="p0079" num="0079"> For the common angle image gathers, the combined broadband sensitivity kernel of equation (10) is replaced by </p><p id="p0080" num="0080"><img id="imgf000015_0002" he="34" wi="151" file="imgf000015_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/></p><p id="p0081" num="0081">where the broadband kernel components are </p><p id="p0082" num="0082"><img id="imgf000015_0003" he="35" wi="150" file="imgf000015_0003.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/></p><p id="p0083" num="0083">where and
<img id="imgf000015_0004" he="9" wi="7" file="imgf000015_0004.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 are plane wave components of the Green's functions for down- and up- going waves. </p><p id="p0084" num="0084"> Accordingly, to determine the sensitivity kernels, the system begins by finding the Green's functions (or plane wave components of the Green's functions) for the various down- going waves, up-going waves, and scattering waves. Note that the Green's function can be viewed as the wave field that is produced in response to an impulse in time and space. 
<!-- EPO <DP n="16"/>-->
 making it possible to find these functions by applying wave propagation to an appropriately positioned impulse. The chosen wave propagation method can be any one of the existing wave propagation methods. For example, the operations represented by equations (2) and (3) above can be used. Alternatively, the system can employ any one of the various time migration approaches for anisotropic media outlined in PCT application PCT/US09/62911, "Seismic Imaging Systems and Methods Employing 3D Reverse Time Migration with Tilted Transverse Isotropy", filed Nov. 2, 2009 by Fan Jiang and Shengwen Jin. </p><p id="p0085" num="0085"> The Green's functions can then be used in various combinations according to equations 9-14 or equations 9 and 12-16 to obtain the partitioned broadband sensitivity kernels. These kernels, in combination with the depth residuals, define the system of equations given by equation (9) above. In block 718, the system assembles these values in preparation for solving. In block 720, the system applies a linear least squares solution method to obtain the normalized local velocity perturbations m(r<sub>i</sub>). The system of equations may be ill-conditioned, and if so, the inversion process can employ a classical regularization method to ensure first-order derivative smoothness or second-order derivative smoothness in both horizontal and vertical directions. Fig. 9f shows an illustrative set of velocity update values as a function of a vertical axis (depth) and a horizontal axis (inline- or x-axis) derived from the depth residuals in Fig. 9e. </p><p id="p0086" num="0086"> In block 722, the system applies the velocity updates to the velocity model. Fig. 8b shows an illustrative updated velocity model that results from adding the updates of Fig. 9f to the initial velocity model of Fig. 8a. </p><p id="p0087" num="0087"> In block 724, the system determines whether the velocity model is satisfactory. One possible test is whether convergence has been achieved, i.e., whether the velocity updates are below some predetermined threshold. Another possible test is whether the residual moveout has been largely eliminated from the image gathers or whether the stacked image data 
<!-- EPO <DP n="17"/>-->
 appears reasonably clear and free of ghosting or smearing. If the velocity model is not satisfactory, the blocks 706-724 are repeated until the velocity model is deemed satisfactory. The system displays the final results to a user in block 726. Fig. 9f is an illustrative example of a final image once the velocity model has converged. </p><p id="p0088" num="0088"> Figs. 8a-8d show an illustrative progression of a velocity model from an initial velocity model in Fig. 8a, to the updated model after one iteration in Fig. 8b, to the velocity model after convergence has been achieved in Fig. 8c. The lines in Figs. 8b and 8c are the true horizon lines, and are displayed for reference purposes. Note that the velocity models do not closely track the formation boundaries as would normally be expected. However, the horizon information extracted in block 710 can be used to convert the velocity model into a layered velocity model having consistent velocities throughout each formation layer as would be expected by most geophysicists. </p><p id="p0089" num="0089"> To convert an existing velocity model into a layered velocity model, the root mean square velocity is calculated for each point in the image volume for seismic energy propagating vertically from the surface. The horizons are used to define the layers of the layered velocity model. The velocity for the top layer is set to the root mean squared value extracted along the topmost horizon (HI). The velocity for the remaining layers is set to the difference between the root mean square velocities of the upper and lower horizons (e.g., HI and H2 for layer 2). Fig. 8d shows the layered velocity model derived from Fig. 8c. </p><p id="p0090" num="0090"> It is contemplated that the operations shown in Fig. 7 may be implemented in the form of software, which can be stored in computer memory, in long-term storage media, and in portable information storage media. It should be noted that illustrative method of Fig. 7 is provided as an explanatory aid. In practice, the various operations shown in Fig. 7 may be performed in different orders and need not even be sequential. Seismic data processing can benefit substantially from parallelism. In some processing method embodiments, data from 
<!-- EPO <DP n="18"/>-->
 different survey regions may be processed independently. In other embodiments, the operations may be "pipelined" or otherwise performed concurrently. Additional operations may be added to the illustrative method and/or several of the operations shown may be omitted. </p><p id="p0091" num="0091"> Fig. 10 shows an illustrative computer system 900 for performing seismic data processing including seismic imaging using tomographic migration- velocity analysis of common angle image gathers. A personal workstation 902 is coupled via a local area network (LAN) 904 to one or more multi-processor computers 906, which are in turn coupled via the LAN to one or more shared storage units 908. LAN 904 provides high-speed communication between multi-processor computers 906 and with personal workstation 902. The LAN 904 may take the form of an Ethernet network. </p><p id="p0092" num="0092"> Personal workstation 902 serves as a user interface to the processing system, enabling a user to load survey data into the system, to retrieve and view image data from the system, and to configure and monitor the operation of the processing system. Personal workstation 902 may take the form of a desktop computer with a graphical display that graphically shows survey data and 3D images of the survey region, and with a keyboard that enables the user to move files and execute processing software. </p><p id="p0093" num="0093"> Multi-processor computer(s) 906 provide parallel processing capability to enable suitably prompt conversion of seismic trace signals into a survey region image. Each computer 906 includes multiple processors 912, distributed memory 914, an internal bus 916, and a LAN interface 920. Each processor 912 operates on an allocated portion of the input data to produce a partial image of the seismic survey region. Associated with each processor 912 is a distributed memory module 914 that stores conversion software and a working data set for the processor's use. Internal bus 916 provides inter-processor communication and 
<!-- EPO <DP n="19"/>-->
 communication to the LAN networks via interface 920. Communication between processors in different computers 906 can be provided by LAN 904, </p><p id="p0094" num="0094"> Shared storage units 908 may be large, stand-alone information storage units that employ magnetic disk media for nonvolatile data storage. To improve data access speed and reliability, the shared storage units 908 may be configured as a redundant disk array. Shared storage units 908 initially store a initial velocity data volume and shot gathers from a seismic survey. The (iteratively-updated) common angle image gathers can be temporarily stored on shared storage units 908 for later processing. In response to a request from the workstation 902, the image volume data can be retrieved by computers 906 and supplied to workstation for conversion to a graphical image to be displayed to a user. </p><p id="p0095" num="0095"> Numerous variations and modifications will become apparent to those skilled in the art once the above disclosure is fully appreciated. It is intended that the following claims be interpreted to embrace all such variations and modifications. 
</p></description><claims mxw-id="PCLM44725846" ref-ucid="WO-2012116134-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="20"/>-->CLAIMS WHAT IS CLAIMED IS: </claim-statement><claim id="clm-0001" num="1"><claim-text> 1. A seismic imaging method that comprises: </claim-text><claim-text> migrating seismic survey data with an anisotropic velocity model to obtain common angle image gathers; </claim-text><claim-text> processing the common angle image gathers to obtain depth residuals along one or more horizons; </claim-text><claim-text> determining angle-domain sensitivity kernels for the horizons based on the anisotropic velocity model; </claim-text><claim-text> inverting the depth residuals using sensitivity kernels to obtain velocity errors; </claim-text><claim-text> applying the updates to the velocity model; and </claim-text><claim-text> displaying a representation of the survey region to a user based at least in part on the updated velocity model. </claim-text></claim><claim id="clm-0002" num="2"><claim-text> 2. The method of claim 1, further comprising re-migrating the seismic survey data using the updated velocity model. </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. The method of claim 2, further comprising repeating said processing, determining, inverting, applying, and re-migrating operations until a velocity model convergence is achieved. </claim-text></claim><claim id="clm-0004" num="4"><claim-text> 4. The method of claim 1, wherein said processing comprises: </claim-text><claim-text> stacking the common image gathers to identify said one or more horizons; and </claim-text><claim-text> determining local dip angles based on the one or more horizons. </claim-text></claim><claim id="clm-0005" num="5"><claim-text> 5. The method of claim 4, wherein said processing further comprises: </claim-text><claim-text> measuring similarity between image gathers at different assumed velocity errors to obtain the depth residuals .</claim-text><claim-text> <img id="imgf000020_0001" he="12" wi="6" file="imgf000020_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/> <!-- EPO <DP n="21"/>--> </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. The method of claim 5, wherein said measuring similarity comprises determining semblance of the gathers, and wherein the depth residuals correspond to the assumed velocity error that yields the highest semblance. </claim-text></claim><claim id="clm-0007" num="7"><claim-text> 7. The method of claim 1, wherein said displaying includes determining a layered velocity model having constant velocity values between horizons. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. A seismic imaging system that comprises: </claim-text><claim-text> at least one storage device that stores traces from a seismic survey of a given survey region; a memory that stores seismic imaging software; and </claim-text><claim-text> at least one processor coupled to the memory to execute the seismic imaging software, wherein the software causes the at least one processor to: </claim-text><claim-text> migrate seismic survey data with a velocity model to obtain image gathers; </claim-text><claim-text> process the image gathers to obtain depth residuals along one or more horizons; </claim-text><claim-text> invert the depth residuals using angle-domain sensitivity kernels to obtain velocity errors; </claim-text><claim-text> apply the updates to the velocity model; and </claim-text><claim-text> display a representation of the survey region to a user based at least in part on the updated velocity model. </claim-text></claim><claim id="clm-0009" num="9"><claim-text> 9. The system of claim 8, wherein the software further causes the at least one processor to re- migrate the seismic survey data using the updated velocity model. </claim-text></claim><claim id="clm-0010" num="10"><claim-text> 10. The system of claim 9, wherein the software further causes the at least one processor to repeat said processing, inverting, applying, and re-migrating operations until a velocity model convergence is achieved. </claim-text></claim><claim id="clm-0011" num="11"><claim-text> 11. The system of claim 8, wherein as part of said processing operation, the software causes the at least one processor to: <!-- EPO <DP n="22"/>--> stack the image gathers to identify said one or more horizons; and </claim-text><claim-text> determine local dip angles based on the one or more horizons, </claim-text></claim><claim id="clm-0012" num="12"><claim-text> 12. The system of claim 11, wherein as part of said processing operation, the software further causes the at least one processor to: </claim-text><claim-text> measure similarity between image gathers at different assumed velocity errors to obtain the depth residuals <img id="imgf000022_0001" he="8" wi="6" file="imgf000022_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/> . </claim-text></claim><claim id="clm-0013" num="13"><claim-text> 13. The system of claim 12, wherein as part of said measuring, the software causes the processor to determine semblance of the image gathers, and wherein said depth residuals correspond to the assumed velocity error that yields the highest semblance. </claim-text></claim><claim id="clm-0014" num="14"><claim-text> 14. The system of claim 8, wherein the software further causes the processor to determine a layered velocity model having constant velocity values between horizons. </claim-text></claim><claim id="clm-0015" num="15"><claim-text> 15. The system of claim 8, wherein the velocity model is anisotropic. </claim-text></claim><claim id="clm-0016" num="16"><claim-text>16. A seismic imaging method that comprises: </claim-text><claim-text> migrating seismic data with a velocity model to obtain image gathers; </claim-text><claim-text> processing the image gathers to obtain depth residuals along one or more horizons; </claim-text><claim-text> employing angle domain sensitivity kernels to convert the depth residuals into velocity errors; </claim-text><claim-text> applying the updates to the velocity model; and </claim-text><claim-text> displaying a representation of the survey region to a user based at least in part on the updated velocity model. </claim-text></claim><claim id="clm-0017" num="17"><claim-text> 17. The method of claim 16, wherein the velocity model is anisotropic. </claim-text></claim><claim id="clm-0018" num="18"><claim-text> 18. The method of claim 16, wherein said processing comprises: </claim-text><claim-text> stacking the common image gathers to identify said one or more horizons; and </claim-text><claim-text> determining local dip angles based on the one or more horizons. <!-- EPO <DP n="23"/>--> </claim-text></claim><claim id="clm-0019" num="19"><claim-text>19. The method of claim 18, wherein said processing further comprises: </claim-text><claim-text> measuring similarity between image gathers at different assumed velocity errors to obtain the depth residuals <img id="imgf000023_0001" he="6" wi="7" file="imgf000023_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/> </claim-text></claim><claim id="clm-0020" num="20"><claim-text> 20. The method of claim 16, further comprising determining a layered velocity model having constant velocity values between horizons. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
