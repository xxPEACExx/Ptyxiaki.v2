<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2678991-A1" country="EP" doc-number="2678991" kind="A1" date="20140101" family-id="45771958" file-reference-id="312918" date-produced="20180823" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146550506" ucid="EP-2678991-A1"><document-id><country>EP</country><doc-number>2678991</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12706424-A" is-representative="NO"><document-id mxw-id="PAPP154824429" load-source="docdb" format="epo"><country>EP</country><doc-number>12706424</doc-number><kind>A</kind><date>20120222</date><lang>EN</lang></document-id><document-id mxw-id="PAPP175460586" load-source="docdb" format="original"><country>EP</country><doc-number>12706424.4</doc-number><date>20120222</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140446358" ucid="US-201113032851-A" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201113032851</doc-number><kind>A</kind><date>20110223</date></document-id></priority-claim><priority-claim mxw-id="PPC140451233" ucid="US-2012026169-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>2012026169</doc-number><kind>W</kind><date>20120222</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988123265" load-source="docdb">H04L  29/06        20060101AFI20120914BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1769472546" load-source="docdb" scheme="CPC">H04L  63/102       20130101 LI20170830BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987649190" load-source="docdb" scheme="CPC">H04L  67/146       20130101 LI20151217BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987649474" load-source="docdb" scheme="CPC">H04L  63/0254      20130101 LI20151219BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987651030" load-source="docdb" scheme="CPC">H04L  47/125       20130101 LI20151217BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987655921" load-source="docdb" scheme="CPC">H04L  63/20        20130101 LI20151217BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1987657802" load-source="docdb" scheme="CPC">H04L  63/0245      20130101 FI20151217BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2049527589" load-source="docdb" scheme="CPC">H04L  63/0218      20130101 LA20150604BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2049528232" load-source="docdb" scheme="CPC">H04L  63/029       20130101 LI20150604BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132184002" lang="DE" load-source="patent-office">SYSTEM UND VERFAHREN ZUR VERNETZUNG EINES HOSTS MIT EINEM GATEWAY</invention-title><invention-title mxw-id="PT132184003" lang="EN" load-source="patent-office">SYSTEM AND METHOD FOR INTERLOCKING A HOST AND A GATEWAY</invention-title><invention-title mxw-id="PT132184004" lang="FR" load-source="patent-office">SYSTÈME ET PROCÉDÉ POUR RENDRE SOLIDAIRES UN HÔTE ET UNE PASSERELLE</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR918136824" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>MCAFEE INC</last-name><address><country>US</country></address></addressbook></applicant><applicant mxw-id="PPAR918143824" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>MCAFEE, INC.</last-name></addressbook></applicant><applicant mxw-id="PPAR918983472" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>McAfee, Inc.</last-name><iid>101324089</iid><address><street>2821 Mission College Blvd.</street><city>Santa Clara, CA 95054</city><country>US</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918166929" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>MAHADIK VINAY A</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918172500" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>MAHADIK, VINAY A.</last-name></addressbook></inventor><inventor mxw-id="PPAR918990058" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>MAHADIK, VINAY A.</last-name><address><street>368 Belshaw Drive</street><city>Milpitas, California 95035</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918162160" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>COOPER GEOFFREY HOWARD</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918142102" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>COOPER, GEOFFREY HOWARD</last-name></addressbook></inventor><inventor mxw-id="PPAR918978714" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>COOPER, GEOFFREY HOWARD</last-name><address><street>2542 Webster St.</street><city>Palo Alto, California 94301</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918162228" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>DIEHL DAVID FREDERICK</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918146660" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>DIEHL, David Frederick</last-name></addressbook></inventor><inventor mxw-id="PPAR918988120" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>DIEHL, David Frederick</last-name><address><street>5324 Elliot Ave. S</street><city>Minneapolis, Minnesota 55417</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918133542" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>VENUGOPALAN RAMNATH</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918135443" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>VENUGOPALAN, RAMNATH</last-name></addressbook></inventor><inventor mxw-id="PPAR918994229" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>VENUGOPALAN, RAMNATH</last-name><address><street>14 D'Angelo Drive</street><city>Webster, New York 14580</city><country>US</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918989862" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Goddar, Heinz J.</last-name><iid>100002032</iid><address><street>Boehmert &amp; Boehmert Pettenkoferstrasse 20-22</street><city>80336 München</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="US-2012026169-W"><document-id><country>US</country><doc-number>2012026169</doc-number><kind>W</kind><date>20120222</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012116098-A1"><document-id><country>WO</country><doc-number>2012116098</doc-number><kind>A1</kind><date>20120830</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS548811768" load-source="docdb">AL</country><country mxw-id="DS548911634" load-source="docdb">AT</country><country mxw-id="DS548811769" load-source="docdb">BE</country><country mxw-id="DS548907861" load-source="docdb">BG</country><country mxw-id="DS548830870" load-source="docdb">CH</country><country mxw-id="DS548894485" load-source="docdb">CY</country><country mxw-id="DS548911635" load-source="docdb">CZ</country><country mxw-id="DS548811770" load-source="docdb">DE</country><country mxw-id="DS548894486" load-source="docdb">DK</country><country mxw-id="DS548894487" load-source="docdb">EE</country><country mxw-id="DS548909894" load-source="docdb">ES</country><country mxw-id="DS548907954" load-source="docdb">FI</country><country mxw-id="DS548907955" load-source="docdb">FR</country><country mxw-id="DS548811771" load-source="docdb">GB</country><country mxw-id="DS548894488" load-source="docdb">GR</country><country mxw-id="DS548811772" load-source="docdb">HR</country><country mxw-id="DS548911636" load-source="docdb">HU</country><country mxw-id="DS548830871" load-source="docdb">IE</country><country mxw-id="DS548894489" load-source="docdb">IS</country><country mxw-id="DS548907956" load-source="docdb">IT</country><country mxw-id="DS548894490" load-source="docdb">LI</country><country mxw-id="DS548917665" load-source="docdb">LT</country><country mxw-id="DS548911637" load-source="docdb">LU</country><country mxw-id="DS548917666" load-source="docdb">LV</country><country mxw-id="DS548917667" load-source="docdb">MC</country><country mxw-id="DS548858731" load-source="docdb">MK</country><country mxw-id="DS548858732" load-source="docdb">MT</country><country mxw-id="DS548909895" load-source="docdb">NL</country><country mxw-id="DS548911990" load-source="docdb">NO</country><country mxw-id="DS548858733" load-source="docdb">PL</country><country mxw-id="DS548894491" load-source="docdb">PT</country><country mxw-id="DS548909896" load-source="docdb">RO</country><country mxw-id="DS548894492" load-source="docdb">RS</country><country mxw-id="DS548858734" load-source="docdb">SE</country><country mxw-id="DS548894493" load-source="docdb">SI</country><country mxw-id="DS548911991" load-source="docdb">SK</country><country mxw-id="DS548858735" load-source="docdb">SM</country><country mxw-id="DS548830872" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA99618838" ref-ucid="WO-2012116098-A1" lang="EN" load-source="patent-office"><p num="0000">A method is provided in one example embodiment and includes exchanging a session descriptor associated with a network connection and an application on a host, correlating the session descriptor with a network policy, and applying the network policy to the network connection. In alternative embodiments, the session descriptor may be exchanged through an out-of-band communication channel or an in-band communication channel.</p></abstract><abstract mxw-id="PA99818523" ref-ucid="WO-2012116098-A1" lang="EN" source="national office" load-source="docdb"><p>A method is provided in one example embodiment and includes exchanging a session descriptor associated with a network connection and an application on a host, correlating the session descriptor with a network policy, and applying the network policy to the network connection. In alternative embodiments, the session descriptor may be exchanged through an out-of-band communication channel or an in-band communication channel.</p></abstract><abstract mxw-id="PA99618839" ref-ucid="WO-2012116098-A1" lang="FR" load-source="patent-office"><p num="0000">Un mode de réalisation à titre d'exemple de l'invention porte sur un procédé qui consiste à échanger un descripteur de session associé à une connexion à un réseau et une application sur un hôte, corréler le descripteur de session à une politique de réseau, et appliquer la politique de réseau à la connexion au réseau. Selon des variantes, le descripteur de session peut être échangé par un canal de communication hors bande ou un canal de communication dans la bande.</p></abstract><abstract mxw-id="PA99818524" ref-ucid="WO-2012116098-A1" lang="FR" source="national office" load-source="docdb"><p>Un mode de réalisation à titre d'exemple de l'invention porte sur un procédé qui consiste à échanger un descripteur de session associé à une connexion à un réseau et une application sur un hôte, corréler le descripteur de session à une politique de réseau, et appliquer la politique de réseau à la connexion au réseau. Selon des variantes, le descripteur de session peut être échangé par un canal de communication hors bande ou un canal de communication dans la bande.</p></abstract><description mxw-id="PDES50929965" ref-ucid="WO-2012116098-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="3"/>--><p id="p0001" num="0001"> SYSTEM AND METHOD FOR INTERLOCKING A HOST AND A GATEWAY TECHNICAL FIELD </p><p id="p0002" num="0002"> [0001] This disclosure relates in general to the field of network security, and more particularly, to a system and a method for interlocking a host and a gateway through information sharing. </p><p id="p0003" num="0003">BACKGROUND </p><p id="p0004" num="0004"> [0002] The field of network security has become increasingly important in today's society. The Internet has enabled interconnection of different computer networks all over the world. However, the Internet has also presented many opportunities for malicious operators to exploit these networks. Once malicious software has infected a host computer, a malicious operator may issue commands from a remote computer to control the malicious software. The software can be instructed to perform any number of malicious actions, such as sending out spam or malicious emails from the host computer, stealing sensitive information from a business or individual associated with the host computer, propagating to other host computers, and/or assisting with distributed denial of service attacks. In addition, the malicious operator can sell or otherwise give access to other malicious operators, thereby escalating the exploitation of the host computers. Thus, the ability to effectively protect and maintain stable computers and systems continues to present significant challenges for component manufacturers, system designers, and network operators. </p><p id="p0005" num="0005">BRIEF DESCRIPTION OF THE DRAWINGS </p><p id="p0006" num="0006"> [0003] To provide a more complete understanding of the present disclosure and features and advantages thereof, reference is made to the following description, taken in conjunction with the accompanying figures, wherein like reference numerals represent like parts, in which: 
<!-- EPO <DP n="4"/>-->
 [0004] FIGURE 1 is a simplified block diagram illustrating an example embodiment of a network environment in which information may be shared between a host and a network gateway for network protection in accordance with this specification; </p><p id="p0007" num="0007"> [0005] FIGURE 2 is a simplified block diagram illustrating additional details associated with one potential embodiment of the network environment, in accordance with this specification; </p><p id="p0008" num="0008"> [0006] FIGURE 3 is a simplified block diagram illustrating example operations associated with one embodiment of a network environment in accordance with this specification; </p><p id="p0009" num="0009"> [0007] FIGURE 4 is a simplified block diagram illustrating example operations associated with another embodiment of a network environment in accordance with this specification; and </p><p id="p0010" num="0010"> [0008] FIGURE 5 is a simplified flowchart illustrating example operations associated with another embodiment of a network environment in accordance with this specification. </p><p id="p0011" num="0011">DETAILED DESCRIPTION OF EXAMPLE EMBODIMENTS OVERVIEW </p><p id="p0012" num="0012"> [0009] A method is provided in one example embodiment and includes exchanging a session descriptor between a host and a network gateway, wherein the session descriptor is associated with a network connection and an application on a host, correlating the session descriptor with a network policy, and applying the network policy to the network connection. In alternative embodiments, the session descriptor may be exchanged through an out-of-band communication channel or an in-band communication channel. </p><p id="p0013" num="0013"> [0010] In yet more particular embodiments, the network policy may be applied to restrict or rate-limit communication over the network connection based on an identification of the application in the session descriptor. In other embodiments, the session descriptor may include a universally unique identifier associated with the host. 
<!-- EPO <DP n="5"/>-->
 EXAMPLE EMBODIMENTS </p><p id="p0014" num="0014"> [0011] Turning to FIGURE 1, FIGURE 1 is a simplified block diagram of an example embodiment of a network environment 10 in which a host and a network gateway may be interlocked through information sharing. In the embodiment illustrated in Figure 1, network environment 10 can include Internet 15, a user host 20a and 20b, a network gateway 25, a policy server 30, a mail server 35, and a web server 40. In general, user hosts 20a-b may be any type of termination point in a network connection, including but not limited to a desktop computer, a server, a laptop, a mobile telephone, or any other type of device that can receive or establish a connection with a remote node, such as mail server 35 or web server 40. Gateway 25 may control communications between user hosts 20a-b and other network nodes attached to Internet 15, and may include a firewall to block unauthorized access while permitting authorized communications. Policy server 20 may be used to manage user hosts 20a-b and to administer and distribute network policies. Thus, in this example embodiment, user hosts 20a-b may communicate with servers attached to Internet 15, such as mail server 35 or web server 40, only by establishing a connection through the network gateway 25 if permitted by policies implemented in gateway 25. </p><p id="p0015" num="0015"> [0012] Each of the elements of FIGURE 1 may couple to one another through simple interfaces or through any other suitable connection (wired or wireless), which provides a viable pathway for network communications. Additionally, any one or more of these elements may be combined or removed from the architecture based on particular configuration needs. Network environment 10 may include a configuration capable of transmission control protocol/Internet protocol (TCP/IP) communications for the transmission or reception of packets in a network. Network environment 10 may also operate in conjunction with a user datagram protocol/IP (UDP/IP) or any other suitable protocol where appropriate and based on particular needs. </p><p id="p0016" num="0016"> [0013] For purposes of illustrating the techniques for providing network security in example embodiments, it is important to understand the activities occurring within a given network. The following foundational information may be viewed as a basis from which the present disclosure may be properly explained. Such information is offered earnestly for 
<!-- EPO <DP n="6"/>-->
 purposes of explanation only and, accordingly, should not be construed in any way to limit the broad scope of the present disclosure and its potential applications. </p><p id="p0017" num="0017"> [0014] Typical network environments used in organizations and by individuals include the ability to communicate electronically with other networks using the Internet, for example, to access web pages hosted on servers connected to the Internet, to send or receive electronic mail (i.e., email) messages, or to exchange files. Malicious users are continuously developing new tactics for using the Internet to spread malware and to gain access to confidential information. Malware generally includes any software designed to access and/or control a computer without the informed consent of the computer owner, and is most commonly used as a label for any hostile, intrusive, or annoying software such as a computer virus, bot, spyware, adware, etc. Once compromised, malware may subvert a host and use it for malicious activity, such as spamming or information theft. Malware also typically includes one or more propagation vectors that enable it to spread within an organization's network or across other networks to other organizations or individuals. Common propagation vectors include exploiting known vulnerabilities on hosts within the local network and sending malicious emails having a malicious program attached or providing malicious links within the emails. </p><p id="p0018" num="0018"> [0015] One way in which malware may operate is to deceive a user by using a different network protocol exchange than the user expects. The malware may be packaged so as to convince the user to allow access to run it in some innocuous way, thus allowing it access to the network, which often may require passing through a firewall or other security measure. The malware may then exploit the access to engage in alternative or additional activities not contemplated by the user. For example, a game may send email messages or a word processor may open a web connection. At the same time, the malware may also use standard protocols to deceive the firewall into permitting the malware to establish remote connections. </p><p id="p0019" num="0019"> [0016] Botnets, for example, use malware and are an increasing threat to computer security. In many cases they employ sophisticated attack schemes that include a combination of well-known and new vulnerabilities. Botnets generally use a client-server architecture where a type of malicious software (i.e., a bot) is placed on a host computer 
<!-- EPO <DP n="7"/>-->
 and communicates with a command and control (C&amp;C) server, which may be controlled by a malicious user (e.g., a botnet operator). Usually, a botnet is composed of a large number of bots that are controlled by the operator using a C&amp;C protocol through various channels, including Internet Relay Chat (IRC) and peer-to-peer (P2P) communication. The bot may receive commands from the C&amp;C server to perform particular malicious activities and, accordingly, may execute such commands. The bot may also send any results or pilfered information back to the C&amp;C server. A bot is often designed to initiate communication with the C&amp;C server and to masquerade as normal web browser traffic. For example, a bot may use a port typically used to communicate with a web server. Such bots, therefore, may not be detected by existing technologies without performing more detailed packet inspection of the web traffic. Moreover, once a bot is discovered, the botnet operator may simply find another way to masquerade network traffic by the bot to continue to present as normal web traffic. More recently, botnet operators have crafted bots to use encryption protocols such as, for example, secure socket layer (SSL), thereby encrypting malicious network traffic. Such encrypted traffic may use a Hypertext Transfer Protocol Secure (HTTPS) port such that only the endpoints involved in the encrypted session can decrypt the data. Thus, existing firewalls and other network intrusion prevention technologies may be unable to perform any meaningful inspection of the web traffic and bots continue to infect host computers within networks. </p><p id="p0020" num="0020"> [0017] Other software security technology focused on preventing unauthorized program files from executing on a host computer may have undesirable side effects for end users or employees of a business or other organizational entity. Network or Information Technology (IT) administrators may be charged with crafting extensive policies relevant to all facets of the business entity to enable employees to obtain software and other electronic data from desirable and trusted network resources. Without extensive policies in place, employees may be prevented from downloading software and other electronic data from network resources that are not specifically authorized, even if such software and other data facilitate legitimate and necessary business activities. Such systems may be so restrictive that if unauthorized software is found on a host computer, any host computer activities may be suspended pending network administrator intervention. Moreover, at the network level 
<!-- EPO <DP n="8"/>-->
 there may simply be too many applications to effectively track and incorporate into policies. Large whitelists or blacklists can be difficult to maintain and may degrade network performance, and some applications may not be susceptible to easy identification. </p><p id="p0021" num="0021"> [0018] In accordance with one embodiment, network environment 10 can overcome these shortcomings (and others) by sharing information between a host and a network gateway. Information may be shared, for example, through an in-band or out-of- band protocol that allows a host agent to communicate with a network gateway to collectively and mutually achieve better security. The host agent may understand an application on the host as an executable file that is running a process with specific authentication, for example, while the network gateway may understand the application as a protocol in a TCP connection, which may also be correlated to a particular user authentication. The host agent may share session descriptors with the network gateway, and the network gateway may share network policy with the host agent as needed to correlate application activities with expected network behavior. Network policy may include elements of security policy as well as other network specific parameters, such as quality of service (QoS) and routing. A host agent may also be associated with a universally unique identifier (UUID), which can be used to correlate connections and activities originating behind network address translators. </p><p id="p0022" num="0022"> [0019] Session descriptors generally include information about a host and an application associated with a given network session. For example, a session descriptor may include a UUID associated with the host and the user credentials of a process owner. Since a user can run separate processes with different user credentials, such information may be particularly advantageous for Citrix and terminal services. A session descriptor may additionally include a filename, pathname or other unique identifier of an application file (e.g., C:\... \WINWORD.EXE) that is running the process attempting to establish a network connection. For example, in some embodiments the application may be identified by a hash function of the application's executable file, so as to make it more difficult for a malicious user to spoof the application name. A gateway may correlate this information with an application identifier or protocol to ensure that the application is performing as expected. A session descriptor may also contain information about the host environment, such as 
<!-- EPO <DP n="9"/>-->
 software installed on the host and the current configuration and state of the software, permitting the gateway to act as a network access control device. For example, a session descriptor may indicate whether the local anti-virus system is up to date and running. If Host-based Data Loss Prevention (HDLP) software is available, a session descriptor may also include file typing information for file transfer. HDLP normally determines the type of file being transmitted out of the network (e.g., PDF, Word, etc.). The gateway may have additional policies about certain file types being transmitted over particular protocols, which may not be visible directly to an HDLP program. </p><p id="p0023" num="0023"> [0020] A host agent may also notify the gateway of additional network connections to the host. If a host has both wireless and wired connections active simultaneously, for example, there may be a risk of data received on one connection being transmitted on the other, so it may be desirable to restrict access to sensitive data. A host agent may also notify the gateway if the connection is associated with a virtual machine. A host agent may also notify the gateway if the host has mountable read/write media, such as a USB stick attached. </p><p id="p0024" num="0024"> [0021] Dynamic information sharing may be provided in network environment 10. Communications between a user host and a network gateway may be encoded in routine network traffic [e.g., IP or TCP options fields, packet padding locations, or trailers on DNS packets), or transmitted in a separate network packet from the host to the network gateway as each connection starts. In some embodiments, a network gateway may send a UDP packet containing a randomly chosen sequence number or nonce to a user host on the user host's first egress. On each TCP open of a permitted connection, the user host agent may format a hash of the current nonce and sequence ID, place it in the packet along with other session descriptors. A hash of packet contents may also be included in certain embodiments. The network gateway may receive the UDP packet and save the session descriptors to use in applying network policy to the TCP stream. The network gateway may send a new nonce periodically to discourage replay attacks. </p><p id="p0025" num="0025"> [0022] In some embodiments of network environment 10, host 20a may include multiple attachment points, causing it to have multiple IP addresses. In other embodiments, host 20a may use the IP version 6 (IPv6), perhaps including Privacy Extensions (RFC4941), 
<!-- EPO <DP n="10"/>-->
 s causing it to have one or more registered and known IPv6 addresses and one or more hidden or private IPv6 addresses. In these embodiments, gateway 25 may readily use dynamic information sharing to discover the user to host mapping for all the addresses on host 20a. </p><p id="p0026" num="0026"> [0023] This dynamic information sharing in network environment 10 may provide several benefits over conventional architectures. For example, by coordinating firewall policy with a host agent, a gateway can allow or deny traffic differently, depending on which of mulitple users on a host agent is attempting to establish a connection. Moreover, only applications that need to be granularly controlled need to be controlled by the firewall. Thus, the gateway may control arbitrary or evasive applications, provide higher effective throughput, and control mobile-user traffic. In addition, traffic that does not need to be completely allowed or denied can be rate-limited. Arbitrary or evasive applications can also be rate-limited with process information available on a gateway, and differentiated services can be provided for managed and unmanaged hosts. </p><p id="p0027" num="0027"> [0024] Turning to FIGURE 2, FIGURE 2 is a simplified block diagram illustrating additional details associated with one potential embodiment of network environment 10. FIGURE 2 includes Internet 15, user host 20a, network gateway 25, policy server 30, and mail server 35. Each of user host 20a, network gateway 25, and policy server 30 may include a respective processor 50a-c, a respective memory element 55a-c, and various software elements. More particularly, user host 20a may include a mail client 60, a network stack 65, a policy agent 70, and a firewall agent 75. Gateway 25 may include a firewall module 80, and policy server 30 may include a firewall connector module 85. </p><p id="p0028" num="0028"> [0025] In one example implementation, user host 20a, network gateway 25, and/or policy server 30 are network elements, which are meant to encompass network appliances, servers, routers, switches, gateways, bridges, loadbalancers, firewalls, processors, modules, or any other suitable device, component, element, or object operable to exchange information in a network environment. Network elements may include any suitable hardware, software, components, modules, interfaces, or objects that facilitate the operations thereof. This may be inclusive of appropriate algorithms and communication protocols that allow for the effective exchange of data or information. However, user host 
<!-- EPO <DP n="11"/>-->
 20a may be distinguished from other network elements as it tends to serve as a terminal point for a network connection, in contrast to a gateway or router. User host 20 may also be representative of a wireless network endpoint, such as an i-Phone, i-Pad, Android phone, or other similar telecommunications devices. </p><p id="p0029" num="0029"> [0026] In regards to the internal structure associated with network environment 10, each of user host 20a, network gateway 25, and/or policy server 30 can include memory elements (as shown in FIGURE 2) for storing information to be used in the operations outlined herein. Additionally, each of these devices may include a processor that can execute software or an algorithm to perform activities as discussed herein. These devices may further keep information in any suitable memory element [random access memory (RAM), ROM, EPROM, EEPROM, ASIC, etc.], software, hardware, or in any other suitable component, device, element, or object where appropriate and based on particular needs. Any of the memory items discussed herein should be construed as being encompassed within the broad term 'memory element.' The information being tracked or sent by user host 20a, network gateway 25, and/or policy server 30 could be provided in any database, register, control list, or storage structure, all of which can be referenced at any suitable timeframe. Any such storage options may be included within the broad term 'memory element' as used herein. Similarly, any of the potential processing elements, modules, and machines described herein should be construed as being encompassed within the broad term 'processor.' Each of the network elements can also include suitable interfaces for receiving, transmitting, and/or otherwise communicating data or information in a network environment. </p><p id="p0030" num="0030"> [0027] In one example implementation, user host 20a, network gateway 25, and/or policy server 30 include software (e.g., firewall agent 75, etc.) to achieve, or to foster, operations as outlined herein. In other embodiments, such operations may be carried out by hardware, implemented externally to these elements, or included in some other network device to achieve the intended functionality. Alternatively, these elements may include software (or reciprocating software) that can coordinate in order to achieve the operations, as outlined herein. In still other embodiments, one or all of these devices may 
<!-- EPO <DP n="12"/>-->
</p><p id="p0031" num="0031">.g., .g., 
<!-- EPO <DP n="13"/>-->
</p><p id="p0032" num="0032">request for a session descriptor. A HELLO packet may include, for example, a KEY value, a SEQNUM, and a MASM value. The SEQNUM may be used both as a nonce and a sequence number. The HASH value is generally a suitable crypto hash, such as SHA-1, on data in the message. Firewall agent 75 may then decrypt the request from firewall module 80, obtain information from network stack 65, and send a sequenced, hashed, encrypted packet containing a session descriptor to firewall module SO at 1.3. For example, if a user has been authenticated with an identification of "auser" and is using Microsoft Outlook as a mail client, then the session descriptor may contain: auser, Outlook, session info. This may be encrypted and transmitted along with a sequence number and has, as Enc[KEY](SEQNUM++, session descriptor, HASH). Firewall module 80 may apply network policies at 1.4 to determine if the connection to mail server 35 should be allowed. Additional session descriptor packets may be sent at 1.5 without the need for firewall module 80 to send a HELLO packet, as in 1.2. </p><p id="p0033" num="0033"> [0030] FIGURE 4 is a simplified block diagram illustrating example operations associated with another embodiment of network environment 10. In FIGURE 4, network environment 10 includes user hosts 20a-b, a network address translator 100, an intrusion prevention system (IPS) 105, and Internet 15. Host 20a is associated with a first UUID (UUID1) and host 20b is associated with a second UUID (UUID2). A session descriptor may be transmitted out-of-band or in-band through network address translator 100, or alternatively, a session identifier may be transmitted in-band, while a session descriptor is transmitted out-of-band. In such an embodiment, the session descriptor can also include the session identifier for correlating the in-band and out-of-band communication. Although network address translator 100 may alter the IP addresses of hosts20a-b, IPS 105 may use the UUIDs of hosts 20a-b to correlate traffic so that network policy can be applied to a host based on all network addresses associated with the host. </p><p id="p0034" num="0034"> [0031] Note further that host 20a may by used concurrently by multiple users in certain embodiments, as in a timesharing system, Microsoft Windows "Switch Users" capability, Citrix, or Microsoft Terminal Services. Firewall module 80 may use information in the session descriptor to pair each network connection with the user that established it, 
<!-- EPO <DP n="14"/>-->
</p><p id="p0035" num="0035">permitting policy to be implemented differently by user rather than singly for all users of host 20a. </p><p id="p0036" num="0036"> [0032] FIGURE 5 is a simplified flowchart 500 illustrating example operations that may be associated with an embodiment of network environment 10 having in-band communication. At 505, a user may run an application such as a Skype client, for example. Session descriptors may then be embedded in redundant areas of relevant network protocols, such as TCP, UDP, or Internet Control Message Protocol (ICMP). For example, a firewall agent can embed session descriptors in TCP options during the TCP handshake, enabling action even on the first packet of a session. In another embodiment, session descriptors may be embedded in IP options, which applies to TCP, UDP, and ICMP traffic. In yet another embodiment, additional "probe" packets may be generated within the network session that are redundant for the communication but may be used by a network gateway to extract useful information. For example, a host agent can send TCP Acknowledgements (ACKs) that are duplicates of previous ACKs already sent, which are harmless. Information may be embedded in fields of these ACKs that are meaningless for ACK packets, such as Checksum, Urgent Pointer, or Reserved fields. ICMP notifications that appear legitimate may also be used, but may be ignored by the other end. TCP packets with invalid sequence numbers may also be used so that the packets are ignored by the destination. </p><p id="p0037" num="0037"> [0033] To illustrate further, consider the example in which the user runs a Skype client on user host 20a. A firewall agent on user host 20a may obtain a process ID of "skype.exe," a vendor ID of "Skype, Inc.," a username of "jdoe" and a uuid of "f81d<sub>4</sub>fae- 7dec-lldo-a765-00a0c91e6bf6," and embed this information as a session descriptor in IP options fields at 510. The packet may be signed and encrypted at 515, and stegonographically hidden at 520 before being sent to network gateway 25. At 525, network gateway 25 may detect and extract the embedded session descriptor. At 530, the authenticity of the session descriptor may be validated. Network policies may be applied to the connection at 535 based on the session descriptor, and allowed, denied, rate-limited, etc. </p><p id="p0038" num="0038"> [0034] Thus, in an embodiment such as the embodiment of FIGURE 5, a user host and a network gateway may communicate with each other without generating any 
<!-- EPO <DP n="15"/>-->
 additional network sessions, which can provide significant benefits. For example, if encryption and steganography are applied, normal users and perhaps even administrators may not know exactly how the user host and the network gateway are cooperating, which may eliminate or minimize attempts to subvert the communications. Additionally, the network gateway may be able to take immediate action on the traffic without the need to wait for an out-of-band communication, since each network session may carry all of the host-level session description. </p><p id="p0039" num="0039"> [0035] In operation, the principles described above have many practical applications. For example, a firewall in certain embodiments of network environment 10 may be programmed to allow certain protocols to be used only by specific applications. Thus, for example, a database protocol may be restricted to use only a specific database client program, and other database client programs can be blocked at the firewall. Additionally or alternatively, an identified application using an unexpected protocol can be prevented from connecting to malicious sites. Thus, for example, a Trojan horse program that masquerades as a game may be prevented from sending private data to an Internet site. An application may also be denied network access without proper antivirus measures on a host. Intrusion prevention system signatures may also be enhanced to detect false positives based on the application that generated the outbound connection. These embodiments may also be equally applicable if a firewall provides virtual private network (VPN) access to a host, in which case the firewall is the network access control (NAC) for the host. The firewall can communicate with a policy server to determine the status of antivirus measures, and request the policy server to scan the host. The firewall may then quarantine the host if the host security is insufficient. </p><p id="p0040" num="0040"> [0036] In another example operation, network environment 10 may also allow a firewall to use a separate channel to notify a host if a connection has been denied, along with an explanation that can be used to alert a user and/or administrator of the action. Thus, a user may be able to report the alert to a help desk or administrator, rather than trying to work around the firewall without being aware of the potential implications, and greatly simplify network management. 
<!-- EPO <DP n="16"/>-->
 [0037] In yet another example operation, if a firewall is unable to interpret a particular protocol, such as a custom protocol, a host agent can identify the application generating the traffic and send the identity to the firewall, thereby enabling the firewall to properly apply policy at the application level. Protocols can also be correlated with applications based on certain network behavior that is expected or acceptable from the applications. Using a whitelist that includes both applications and permitted protocols, the firewall may block malware that exploits an otherwise benign application. For example, Adobe Reader is not typically expected to generate traffic using SMTP. If malware were able to compromise Adobe Reader and attempt to use it for sending messages with SMTP, the firewall could read the whitelist, determine that Adobe Reader is not permitted to use SMTP, and block the malware connection. Moreover, the firewall can inform a policy server that the Adobe Reader program may be compromised by malware. The policy server can inform the user and instruct the policy agent on the user host to disable Adobe Reader. In yet another example, a database administrator may want to provide custom applications for accessing a database. Although the custom applications may use the same protocol as generic applications, a whitelist that associates the custom applications with the protocol can effectively limit access to those applications since the host may share information about the applications with the network gateway. </p><p id="p0041" num="0041"> [0038] Note that with the examples provided above, as well as numerous other potential examples, interaction may be described in terms of two, three, or four network elements. However, this has been done for purposes of clarity and example only. In certain cases, it may be easier to describe one or more of the functionalities of a given set of operations by only referencing a limited number of network elements. It should be appreciated that network environment 10 is readily scalable and can accommodate a large number of components, as well as more complicated/sophisticated arrangements and configurations. Accordingly, the examples provided should not limit the scope or inhibit the broad teachings of network environment 10 as potentially applied to a myriad of other architectures. Additionally, although described with reference to particular scenarios, where a particular module, such as an analyzer module, is provided within a network element, these modules can be provided externally, or consolidated and/or combined in any 
<!-- EPO <DP n="17"/>-->
 suitable fashion. In certain instances, such modules may be provided in a single proprietary unit. </p><p id="p0042" num="0042"> [0039] It is also important to note that the steps in the appended diagrams illustrate only some of the possible scenarios and patterns that may be executed by, or within, network environment 10. Some of these steps may be deleted or removed where appropriate, or these steps may be modified or changed considerably without departing from the scope of teachings provided herein. In addition, a number of these operations have been described as being executed concurrently with, or in parallel to, one or more additional operations. However, the timing of these operations may be altered considerably. The preceding operational flows have been offered for purposes of example and discussion. Substantial flexibility is provided by network environment 10 in that any suitable arrangements, chronologies, configurations, and timing mechanisms may be provided without departing from the teachings provided herein. </p><p id="p0043" num="0043"> [0040] Numerous other changes, substitutions, variations, alterations, and modifications may be ascertained to one skilled in the art and it is intended that the present disclosure encompass all such changes, substitutions, variations, alterations, and modifications as falling within the scope of the appended claims. In order to assist the United States Patent and Trademark Office (USPTO) and, additionally, any readers of any patent issued on this application in interpreting the claims appended hereto, Applicant wishes to note that the Applicant: (a) does not intend any of the appended claims to invoke paragraph six (6) of 35 U.S.C. section 112 as it exists on the date of the filing hereof unless the words "means for" or "step for" are specifically used in the particular claims; and (b) does not intend, by any statement in the specification, to limit this disclosure in any way that is not otherwise reflected in the appended claims. 
</p></description><claims mxw-id="PCLM44725882" ref-ucid="WO-2012116098-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="18"/>-->WHAT IS CLAIMED IS: </claim-statement><claim id="clm-0001" num="1"><claim-text> 1. A method, comprising: </claim-text><claim-text> exchanging a session descriptor between a host and a network gateway, wherein the session descriptor is associated with a network connection and an application on the host; correlating the session descriptor with a network policy; and </claim-text><claim-text> applying the network policy to the network connection. </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. The method of Claim 1, wherein the session descriptor is exchanged through an out-of-band communication channel. </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. The method of Claim 1, wherein the session descriptor is exchanged through an in-band communication channel. </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. The method of Claim 1, wherein the session descriptor is stegonographically embedded in an in-band communication channel. </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. The method of Claim \, wherein the network policy is applied to restrict communication over the network connection based on an identification of the application in the session descriptor. </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. The method of Claim 1, wherein the network policy is applied to rate-limit communication over the network connection based on an identification of the application in the session descriptor. </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. The method of Claim 1, wherein the network policy is applied to restrict protocols that may be used by the application. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. The method of Claim 1, wherein the network policy is associated with a whitelist that restricts protocols that may be used by the application. <!-- EPO <DP n="19"/>--> </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. The method of Claim 1, further comprising alerting a user of the network policy if communication through the network connection is restricted. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. The method of Claim 1, wherein the session descriptor includes a universally unique identifier associated with the host. </claim-text></claim><claim id="clm-0011" num="11"><claim-text>11. The method of Claim 1, wherein the host communicates through a network address translator and the session descriptor includes a universally unique identifier associated with the host. </claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. The method of Claim 1, wherein the session descriptor comprises information about a user executing the application and a filename associated with the application. </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. The method of Claim 1, wherein the session descriptor identifies a user executing the application and network policy is applied based on the user. </claim-text></claim><claim id="clm-0014" num="14"><claim-text>14. Logic encoded in one or more tangible media that includes code for execution and when executed by one or more processors is operable to perform operations comprising: </claim-text><claim-text> exchanging a session descriptor between a host and a network gateway, wherein the session descriptor is associated with a network connection and an application on the host; correlating the session descriptor with a network policy; and </claim-text><claim-text> applying the network policy to the network connection. </claim-text></claim><claim id="clm-0015" num="15"><claim-text>15. The logic of Claim 14, wherein the session descriptor is exchanged through an out-of-band communication channel. </claim-text></claim><claim id="clm-0016" num="16"><claim-text>16. The logic of Claim 14, wherein the session descriptor is exchanged through an in-band communication channel. <!-- EPO <DP n="20"/>--> </claim-text></claim><claim id="clm-0017" num="17"><claim-text>17. The logic of Claim 14, wherein the session descriptor is stegonographicalfy embedded in an in-band communication channel. </claim-text></claim><claim id="clm-0018" num="18"><claim-text>18. The logic of Claim 14, wherein the network policy is applied to restrict communication over the network connection based on an identification of the application in the session descriptor. </claim-text></claim><claim id="clm-0019" num="19"><claim-text>19. The logic of Claim 14, wherein the network policy is applied to rate-limit communication over the network connection based on an identification of the application in the session descriptor. </claim-text></claim><claim id="clm-0020" num="20"><claim-text>20. The logic of Claim 14, wherein the network policy is applied to restrict protocols that may be used by the application. </claim-text></claim><claim id="clm-0021" num="21"><claim-text>21. The logic of Claim 14, wherein the network policy is associated with a whitelist that restricts protocols that may be used by the application. </claim-text></claim><claim id="clm-0022" num="22"><claim-text>22. The logic of Claim 14, further comprising alerting a user of the network policy if communication through the network connection is restricted. </claim-text></claim><claim id="clm-0023" num="23"><claim-text>23. The logic of Claim 14, wherein the session descriptor includes a universally unique identifier associated with the host. </claim-text></claim><claim id="clm-0024" num="24"><claim-text>24. The logic of Claim 14, wherein the host communicates through a network address translator and the session descriptor includes a universally unique identifier associated with the host. </claim-text></claim><claim id="clm-0025" num="25"><claim-text>25. The logic of Claim 14, wherein the session descriptor comprises information about a user executing the application and a filename associated with the application. <!-- EPO <DP n="21"/>--> </claim-text></claim><claim id="clm-0026" num="26"><claim-text>26. The logic of Claim 14, wherein the session descriptor identifies a user executing the application and network policy is applied based on the user. </claim-text></claim><claim id="clm-0027" num="27"><claim-text>27. An apparatus, comprising: </claim-text><claim-text> a firewall module; </claim-text><claim-text> one or more processors operable to execute instructions associated with the firewall module, the one or more processors being operable to perform operations comprising: </claim-text><claim-text> exchanging a session descriptor with a host, wherein the session descriptor is associated with a network connection and an application on the host; </claim-text><claim-text> correlating the session descriptor with a network policy; and </claim-text><claim-text> applying the network policy to the network connection. </claim-text></claim><claim id="clm-0028" num="28"><claim-text>28. The apparatus of Claim 27, wherein the session descriptor is exchanged through an out-of-band communication channel. </claim-text></claim><claim id="clm-0029" num="29"><claim-text>29. The apparatus of Claim 27, wherein the session descriptor is exchanged through an in-band communication channel. </claim-text></claim><claim id="clm-0030" num="30"><claim-text>30. The apparatus of Claim 27, wherein the session descriptor is stegonographicaily embedded in an in-band communication channel. </claim-text></claim><claim id="clm-0031" num="31"><claim-text>31. The apparatus of Claim 27, wherein the network policy is applied to restrict communication over the network connection based on an identification of the application in the session descriptor. </claim-text></claim><claim id="clm-0032" num="32"><claim-text>32. The apparatus of Claim 27, wherein the network policy is applied to rate-limit communication over the network connection based on an identification of the application in the session descriptor. </claim-text></claim><claim id="clm-0033" num="33"><claim-text>33. The apparatus of Claim 27, wherein the network policy is applied to restrict protocols that may be used by the application. <!-- EPO <DP n="22"/>--> </claim-text></claim><claim id="clm-0034" num="34"><claim-text>34. The apparatus of Claim 27, wherein the network policy is associated with a whitelist that restricts protocols that may be used by the application. </claim-text></claim><claim id="clm-0035" num="35"><claim-text>35. The apparatus of Claim 27, further comprising alerting a user of the network policy if communication through the network connection is restricted. </claim-text></claim><claim id="clm-0036" num="36"><claim-text>36. The apparatus of Claim 27, wherein the session descriptor includes a universally unique identifier associated with the host. </claim-text></claim><claim id="clm-0037" num="37"><claim-text>37. The apparatus of Claim 27, wherein the host communicates through a network address translator and the session descriptor includes a universally unique identifier associated with the host. </claim-text></claim><claim id="clm-0038" num="38"><claim-text>38. The apparatus of Claim 27, wherein the session descriptor comprises information about a user executing the application and a filename associated with the application. </claim-text></claim><claim id="clm-0039" num="39"><claim-text>39. The apparatus of Claim 27, wherein the session descriptor identifies a user executing the application and network policy is applied based on the user. </claim-text></claim><claim id="clm-0040" num="40"><claim-text>40. The apparatus of Claim 27, wherein more than one network address is associated with the host, the session descriptor comprises information about a user associated with one of the network addresses, and network policy is applied based on the user. </claim-text></claim><claim id="clm-0041" num="41"><claim-text>41. The apparatus of Claim 27, wherein the session descriptor identifies a user executing the application and includes a hash of an executable file associated with the application. <!-- EPO <DP n="23"/>--> </claim-text></claim><claim id="clm-0042" num="42"><claim-text>42. The apparatus of Claim 27, wherein the session descriptor comprises information about the configuration and state of software installed on the host. </claim-text></claim><claim id="clm-0043" num="43"><claim-text>43. The apparatus of Claim 27, wherein the session descriptor identifies network addresses associated with the host and network policy is applied based on the network addresses. </claim-text></claim><claim id="clm-0044" num="44"><claim-text>44. A method, comprising: </claim-text><claim-text> applying network policy to restrict communication through a network connection; and </claim-text><claim-text> sending an alert to a user notifying the user of the network policy that restricted communication. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
