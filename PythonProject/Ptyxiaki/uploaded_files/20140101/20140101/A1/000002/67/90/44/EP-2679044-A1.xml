<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2679044-A1" country="EP" doc-number="2679044" kind="A1" date="20140101" family-id="44625225" file-reference-id="306785" date-produced="20180826" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146551025" ucid="EP-2679044-A1"><document-id><country>EP</country><doc-number>2679044</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-11705513-A" is-representative="NO"><document-id mxw-id="PAPP154824948" load-source="docdb" format="epo"><country>EP</country><doc-number>11705513</doc-number><kind>A</kind><date>20110221</date><lang>EN</lang></document-id><document-id mxw-id="PAPP200056411" load-source="docdb" format="original"><country>EP</country><doc-number>11705513.7</doc-number><date>20110221</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140449008" ucid="EP-2011052486-W" linkage-type="A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>2011052486</doc-number><kind>W</kind><date>20110221</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988100347" load-source="docdb">H04L  12/24        20060101ALI20120910BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988132756" load-source="docdb">H04W  24/08        20090101AFI20120910BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1820254766" load-source="docdb" scheme="CPC">H04L  41/5035      20130101 LA20170502BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1957303530" load-source="docdb" scheme="CPC">H04L  41/142       20130101 LA20160325BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1957307137" load-source="docdb" scheme="CPC">H04L  43/08        20130101 LI20160324BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1957308163" load-source="docdb" scheme="CPC">H04L  41/064       20130101 LA20160325BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1957308596" load-source="docdb" scheme="CPC">H04L  41/0677      20130101 LI20160325BHEP        </classification-cpc><classification-cpc mxw-id="PCL2032328317" load-source="docdb" scheme="CPC">H04W  24/08        20130101 FI20140215BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132185559" lang="DE" load-source="patent-office">DIENSTPROBLEMDIAGNOSE FÜR MOBILE DRAHTLOSNETZE</invention-title><invention-title mxw-id="PT132185560" lang="EN" load-source="patent-office">SERVICE PROBLEM DIAGNOSIS FOR MOBILE WIRELESS NETWORKS</invention-title><invention-title mxw-id="PT132185561" lang="FR" load-source="patent-office">DIAGNOSTIC DE PROBLÈMES DE SERVICE POUR DES RÉSEAUX SANS FIL MOBILES</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR918132113" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ERICSSON TELEFON AB L M</last-name><address><country>SE</country></address></addressbook></applicant><applicant mxw-id="PPAR918135797" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>TELEFONAKTIEBOLAGET LM ERICSSON (PUBL)</last-name></addressbook></applicant><applicant mxw-id="PPAR918992810" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Telefonaktiebolaget LM Ericsson (PUBL)</last-name><iid>101314911</iid><address><city>164 83 Stockholm</city><country>SE</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918161982" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>HUANG YANGCHENG</last-name><address><country>IE</country></address></addressbook></inventor><inventor mxw-id="PPAR918166098" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>HUANG, YANGCHENG</last-name></addressbook></inventor><inventor mxw-id="PPAR918981894" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>HUANG, YANGCHENG</last-name><address><street>16 Galey House ARD RI Brideswell Street</street><city>Athlone</city><country>IE</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918989831" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Stasiewski, Piotr Grzegorz</last-name><suffix>et al</suffix><iid>101369287</iid><address><street>Ericsson Limited Patent Unit UK Unit 4 Midleton Gate Guildford Business Park</street><city>Guildford, Surrey GU2 8SG</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="EP-2011052486-W"><document-id><country>EP</country><doc-number>2011052486</doc-number><kind>W</kind><date>20110221</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012113436-A1"><document-id><country>WO</country><doc-number>2012113436</doc-number><kind>A1</kind><date>20120830</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS548814732" load-source="docdb">AL</country><country mxw-id="DS548920793" load-source="docdb">AT</country><country mxw-id="DS548814733" load-source="docdb">BE</country><country mxw-id="DS548922934" load-source="docdb">BG</country><country mxw-id="DS548863654" load-source="docdb">CH</country><country mxw-id="DS548931413" load-source="docdb">CY</country><country mxw-id="DS548920794" load-source="docdb">CZ</country><country mxw-id="DS548909396" load-source="docdb">DE</country><country mxw-id="DS548931414" load-source="docdb">DK</country><country mxw-id="DS548931415" load-source="docdb">EE</country><country mxw-id="DS548924360" load-source="docdb">ES</country><country mxw-id="DS548922935" load-source="docdb">FI</country><country mxw-id="DS548922936" load-source="docdb">FR</country><country mxw-id="DS548814734" load-source="docdb">GB</country><country mxw-id="DS548931416" load-source="docdb">GR</country><country mxw-id="DS548814735" load-source="docdb">HR</country><country mxw-id="DS548920795" load-source="docdb">HU</country><country mxw-id="DS548863655" load-source="docdb">IE</country><country mxw-id="DS548814736" load-source="docdb">IS</country><country mxw-id="DS548922937" load-source="docdb">IT</country><country mxw-id="DS548931417" load-source="docdb">LI</country><country mxw-id="DS548909397" load-source="docdb">LT</country><country mxw-id="DS548920796" load-source="docdb">LU</country><country mxw-id="DS548909402" load-source="docdb">LV</country><country mxw-id="DS548909403" load-source="docdb">MC</country><country mxw-id="DS548835453" load-source="docdb">MK</country><country mxw-id="DS548835454" load-source="docdb">MT</country><country mxw-id="DS548924361" load-source="docdb">NL</country><country mxw-id="DS548922938" load-source="docdb">NO</country><country mxw-id="DS548924366" load-source="docdb">PL</country><country mxw-id="DS548863656" load-source="docdb">PT</country><country mxw-id="DS548924367" load-source="docdb">RO</country><country mxw-id="DS548863657" load-source="docdb">RS</country><country mxw-id="DS548924368" load-source="docdb">SE</country><country mxw-id="DS548863658" load-source="docdb">SI</country><country mxw-id="DS548835455" load-source="docdb">SK</country><country mxw-id="DS548835456" load-source="docdb">SM</country><country mxw-id="DS548931418" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA99626797" ref-ucid="WO-2012113436-A1" lang="EN" load-source="patent-office"><p num="0000">A method for determining location of a failure causing degradation of a service in a mobile communications network is disclosed. Service trajectories for the mobile terminals are determined (104) by correlating earlier obtained movement trajectories (102) of individual mobile terminals with service session records of the mobile terminals. In the next step distributions of the service trajectories of mobile terminals with degraded service are determined and then a network element around which the service trajectories converge is identified (108) as the location of the failure. An apparatus, a communications network and a computer program product are also disclosed.</p></abstract><abstract mxw-id="PA99825313" ref-ucid="WO-2012113436-A1" lang="EN" source="national office" load-source="docdb"><p>A method for determining location of a failure causing degradation of a service in a mobile communications network is disclosed. Service trajectories for the mobile terminals are determined (104) by correlating earlier obtained movement trajectories (102) of individual mobile terminals with service session records of the mobile terminals. In the next step distributions of the service trajectories of mobile terminals with degraded service are determined and then a network element around which the service trajectories converge is identified (108) as the location of the failure. An apparatus, a communications network and a computer program product are also disclosed.</p></abstract><abstract mxw-id="PA99626798" ref-ucid="WO-2012113436-A1" lang="FR" load-source="patent-office"><p num="0000">L'invention concerne un procédé de détermination de la position d'une panne provoquant la dégradation d'un service sur un réseau de communication mobile. Des trajectoires de services de terminaux mobiles sont déterminées (104) en corrélant des trajectoires de déplacement précédemment obtenues (102) de terminaux mobiles individuels avec des enregistrements de sessions de services des terminaux mobiles. Lors de l'étape suivante, des distributions de trajectoires de services des terminaux mobiles subissant une dégradation du service sont déterminées et un élément de réseau vers lequel convergent les trajectoires de services est identifié (108) comme étant la position de la panne. L'invention concerne un appareil, un réseau de communication et un produit de programme informatique.</p></abstract><abstract mxw-id="PA99825314" ref-ucid="WO-2012113436-A1" lang="FR" source="national office" load-source="docdb"><p>L'invention concerne un procédé de détermination de la position d'une panne provoquant la dégradation d'un service sur un réseau de communication mobile. Des trajectoires de services de terminaux mobiles sont déterminées (104) en corrélant des trajectoires de déplacement précédemment obtenues (102) de terminaux mobiles individuels avec des enregistrements de sessions de services des terminaux mobiles. Lors de l'étape suivante, des distributions de trajectoires de services des terminaux mobiles subissant une dégradation du service sont déterminées et un élément de réseau vers lequel convergent les trajectoires de services est identifié (108) comme étant la position de la panne. L'invention concerne un appareil, un réseau de communication et un produit de programme informatique.</p></abstract><description mxw-id="PDES50931699" ref-ucid="WO-2012113436-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="3"/>--><p id="p0001" num="0001"> SERVICE PROBLEM DIAGNOSIS FOR MOBILE WIRELESS NETWORKS </p><p id="p0002" num="0002">Technical Field </p><p id="p0003" num="0003"> The present invention relates to mobile communications networks, in general, and in particular to determining location of a failure or failures causing degradation of a service or multiple services in a mobile communications network. </p><p id="p0004" num="0004">Background </p><p id="p0005" num="0005"> In networks providing communications services one of primary responsibilities of service providers is to ensure that their services provide a level of performance and robustness that satisfies the commitments specified in their service level agreements (SLAs) with customers, and at the same time maintain efficient use of resources. A well known approach is to monitor quality and behaviour of the services, identify unusual or anomalous activity that either directly indicates or indirectly implies that the service is no longer behaving satisfactorily, and analyse root causes of service performance degradations. </p><p id="p0006" num="0006">In general, there are two types of causes for service problems: hard failure and soft failure. Hard failure refers to a failure event such as a link breakage or a node going down, which is well observable through network alarms or other notifications in</p><p id="p0007" num="0007">Operation And Maintenance (O&amp;M) systems. Compared to hard failure events, a soft failure is less noticeable but recurring network condition. For example, the term soft failure refers to service degradations which are short in duration and are caused by performance impairing events that occur intermittently over an extended period of time. Problems may have disappeared before a network operator can react to them. Such problems may recur and keep reappearing, and can cause repeated service degradation to user services. In some cases, such conditions develop slowly and can aggregate over time before it eventually turns into a serious hard failure. For example, repeated wireless flaps may be observed over time before the link completely fails. Even if the 
<!-- EPO <DP n="4"/>-->
 problem does not result in any hard failure, the performance degradation caused can add up to significant impact to user services and system services and affect user satisfaction with service quality. Undoubtedly, the necessity of discovering the underlying root causes of such soft failures is at least as critical as hard failures before the conditions can be permanently eliminated from the network. It is essential to troubleshoot and repair such network conditions in a timely fashion in order to ensure high reliability and performance in large mobile networks. </p><p id="p0008" num="0008">Existing O&amp;M solutions are designed to diagnose hard failures, especially alarm based Fault Management and Performance Management systems. In contrast, the solution to be disclosed is designed to detect and localize service problems caused by soft failures in mobile wireless infrastructures. </p><p id="p0009" num="0009">Diagnosis of such soft-failure service problems in wireless infrastructures, like for example 3G/LTE networks with thousands of access nodes where normal service behaviour is highly dynamic, presents serious challenges. </p><p id="p0010" num="0010">(1) Changing network topology. User Equipment (UEs) may frequently change their point of attachment and accordingly network or service paths. It is difficult to build causal relations (or inference graphs) between service problems and network events to pinpoint the causes of performance problems. Existing network fault diagnosis systems, either passive or active (i.e. probing), implicitly assume that the fundamental structure of the network is either static or changes slowly. This assumption allows these systems to build inference graphs to pinpoint the causes of performance problems. However, these approaches cannot be applied to mobile networks. </p><p id="p0011" num="0011">(2) Absence of full-scale continuous probing or monitoring points. As discussed earlier, soft failures are unpredictable and therefore require full-scale measurements. However, in a network primarily consisting of roaming users, full-scale 
<!-- EPO <DP n="5"/>-->
 network- wide probing or monitoring infrastructure is impractical and expensive to deploy. </p><p id="p0012" num="0012">(3) Difficulties in reproduction of the problematic conditions. The problems may not be detected based on probing solutions if the problematic conditions are not reproducible. </p><p id="p0013" num="0013">Service performance monitoring is one known diagnosis solution. It uses terminal reports, or passively collected packet traces, to calculate service performance metrics (e.g. round-trip times). Terminal reports refers to Quality of Service (QoS) reports (e.g. RTCP reports for RTP streams; throughput, packet loss, latency and jitter) and Quality of Experience (QoE) reports (e.g. 3GPP TS 26.234; based on HTTP or RTSP). Packet traces can be used to analyze service-level quality. Service quality alarms can be obtained from service quality monitors deployed within the service provider network. The monitors gather statistics such as packet loss, packet delay and service outage durations. These statistics are then used as quality indicators for services. </p><p id="p0014" num="0014">Using network events and/or counters is another known solution. Network events and/or counters are defined and configured for network events or any other data sources (such as terminal types) to calculate statistics. The data analysis is normally based on simple statistical methodologies, typically highest-failure-rate style analysis using Business Intelligence tools. For example, this approach can calculate percentage of attach success ratio or Packet Data Protocol (PDP) context activation success ratio for a particular mobile device type based on subscriber session analysis. This may enable the operator to identify service problems caused by, for example, designs of mobile devices. </p><p id="p0015" num="0015">However, neither service performance monitoring nor network events or counters are capable of accurately identifying root causes of soft failure service 
<!-- EPO <DP n="6"/>-->
 problems. Service performance monitoring may only disclose symptoms of service problems and fail to determine their causes. On the other hand, network counters/events are usually unaware of services or applications. In the best case, failure events can only be associated with PDP sessions. </p><p id="p0016" num="0016">Summary </p><p id="p0017" num="0017"> It is the object of the present invention to obviate at least some of the above disadvantages and provide an improved determining location of a failure causing degradation of a service in a mobile communications network. </p><p id="p0018" num="0018">Accordingly, the invention seeks to preferably mitigate, alleviate or eliminate one or more of the disadvantages mentioned above singly or in any combination. </p><p id="p0019" num="0019">According to a first aspect of the present invention there is provided a method of determining location of a failure causing degradation of a service in a mobile communications network. The method comprises obtaining movement trajectories of mobile terminals operating in the network and determining service trajectories for the mobile terminals by correlating the movement trajectories of individual mobile terminals with service session records of the mobile terminals. In the next step distribution of the service trajectories of mobile terminals with degraded service is determined and then a network element around which the service trajectories converge is identified as the location of the failure. </p><p id="p0020" num="0020">According to a second aspect of the present invention there is provided an apparatus for determining location of a failure causing degradation of a service in a mobile communications network. The apparatus comprises a mobility monitor module adapted to obtain movement trajectories of mobile terminals operating in the network, a service monitor module adapted to determine service trajectories of the mobile terminals. The service trajectories are determined by correlating the movement 
<!-- EPO <DP n="7"/>-->
 trajectories of individual mobile terminals with service session records of the mobile terminals. The apparatus also comprises an analyser module adapted to determine distribution of the service trajectories of mobile terminals with degraded service and to identify a network element around which the service trajectories converge as the location of the failure. </p><p id="p0021" num="0021">According to a third aspect of the present invention there is provided a mobile communications network comprising a plurality of network elements, at least part of the network elements being in communication with a second plurality of wireless mobile terminals operating in the network. The network further comprises an apparatus for determining location of a failure causing degradation of a service in the mobile communications network. The apparatus comprises a mobility monitor module adapted to obtain movement trajectories of mobile terminals operating in the network, a service monitor module adapted to determine service trajectories of the mobile terminals. The service trajectories are determined by correlating the movement trajectories of individual mobile terminals with service session records of the mobile terminals. The apparatus also comprises an analyser module adapted to determine distribution of the service trajectories of mobile terminals with degraded service and to identify a network element around which the service trajectories converge as the location of the failure. </p><p id="p0022" num="0022">According to a fourth aspect of the present invention there is provided a computer program product adapted to perform, when executed on a computer, a method of determining location of a failure causing degradation of a service in a mobile communications network. The method comprises obtaining movement trajectories of mobile terminals operating in the network and determining service trajectories for the mobile terminals by correlating the movement trajectories of individual mobile terminals with service session records of the mobile terminals. In the next step distribution of the service trajectories of mobile terminals with degraded service is 
<!-- EPO <DP n="8"/>-->
 determined and then a network element around which the service trajectories converge is identified as the location of the failure. </p><p id="p0023" num="0023">Further features of the present invention are as claimed in the dependent claims. </p><p id="p0024" num="0024">Brief description of the drawings </p><p id="p0025" num="0025"> The present invention will be understood and appreciated more fully from the following detailed description taken in conjunction with the drawings in which: FIG. 1 is a diagram illustrating a method of determining location of a failure in one embodiment of the present invention; </p><p id="p0026" num="0026">FIG. 2 and Fig. 3 are diagrams illustrating a step of determining distribution of service trajectories in embodiments of the present invention; </p><p id="p0027" num="0027">FIG. 4 illustrates merging service trajectories in one embodiment of the present invention; </p><p id="p0028" num="0028">FIG. 5 and Fig. 6 illustrate creating service trajectories in embodiments of the present invention; </p><p id="p0029" num="0029">FIG. 7 illustrates movement trajectories determined based on GPS data and handover data for use in embodiments of the present invention; FIG. 8 illustrates spatial and temporal clusters used in embodiments of the present invention; </p><p id="p0030" num="0030">FIG. 9 illustrates creating temporal cluster in one embodiment of the present invention; 
<!-- EPO <DP n="9"/>-->
 FIG. 10 and Fig. 11 illustrate apparatus in embodiments of the present invention; </p><p id="p0031" num="0031">FIG. 12 illustrate wireless communications network in one embodiment of the present invention; </p><p id="p0032" num="0032">FIG. 13 illustrates pseudocode for implementing temporal clustering in embodiments of the present invention. </p><p id="p0033" num="0033">Detailed description </p><p id="p0034" num="0034"> Mobility of mobile terminals (also known as user equipment) receiving services from the communications network is a factor that affects quality of the service as perceived by individual users. When the user with his or her mobile terminal roams the network the conditions in which the service is received change. The user may move away from a base station that serves the mobile terminal and the signal strength drops together with bit rate. Moving to a cell with much higher density of other mobile terminals using the same base station or even the same service may also has impact on the quality of the service. Mobility of the terminals also brings challenges to using terminal reports to pinpoint service problems. Since user terminals may be attached to different access nodes when a service is delivered, it is difficult to localize problematic network elements simply based on terminal reports. </p><p id="p0035" num="0035">To simplify understanding of embodiments of the present invention two terms are introduced: movement trajectory and service trajectory. </p><p id="p0036" num="0036">A movement trajectory is the path a moving object follows through space as a function of time. </p><p id="p0037" num="0037">A service trajectory is defined as segments of the movement trajectory where a specified service is consumed by a moving user. For a particular service, service 
<!-- EPO <DP n="10"/>-->
 trajectory of a mobile user is computed by correlating its service records with its movement trajectories, based on temporal co-occurrence. The length of service trajectory includes both temporal factor (e.g. the duration of service access) and spatial factor (e.g. location, direction and/or distance of movement). A movement trajectory may be correlated with one or multiple service records, when two or more services are used at the same time (e.g. mobile TV and email), or even with no service records (when the mobile terminal does not use any service). Service trajectory describes service access during mobile terminal movements. Service trajectory has a temporal dimension, in addition to movement trajectory. The user may not move, but still may be using services provided by the network. </p><p id="p0038" num="0038">Fig. 5 and Fig. 6 illustrate how the service trajectories are determined. In a most basic embodiment, Fig. 5, the movement trajectory is defined by roaming records, i.e. straight lines connecting base stations serving the mobile terminal as it roams through the network (illustrated on the lower plane of Fig. 5). The upper plane of Fig. 5 illustrates various services accessed by the user of the roaming mobile terminal. Starting from time tl the mobile terminal used a music service until time t2. Between tl and t3 the mobile terminal used pull email services. It can bee seen that using the two services partially overlapped in time. Between t2 and t4 VoIP service has been used and between t3 and t4 the terminal was used to access the Internet. Again internet browsing and VoIP service partially overlapped. From t4 to t5 the mobile terminal was used for gaming. When this information is correlated with the movement trajectory a service trajectory is created. Fig. 6 illustrates similar process, but here, in addition to roaming records GPS tracking data is also available (the bottom plane in Fig. 6). Combining GPS data with the roaming records allows for precise locating the base stations in relation to the actual path followed by the mobile terminal. This is then correlated with the service records in the same way as in the embodiment illustrated in Fig. 5 and described above. 
<!-- EPO <DP n="11"/>-->
 Fig. 7 illustrates the difference between movement trajectory obtained based on GPS tracking (solid line) and based on roaming data (dashed line). In the case of roaming data (handover events) we only know which base station the mobile terminal was attached to and not its exact location and this is why the trajectory connects the centres of the cells. </p><p id="p0039" num="0039">Very broadly, in embodiments of the present invention movement trajectories of a mobile terminal are correlated with service records in order to compute service trajectories. To identify where in the network a failure is located (i.e. to identify network element responsible for the failure or service degradation) service trajectories of users with degraded service quality are clustered (grouped). Clustering allows for grouping of elements that are characterised by a defined degree of similarity. If a service accessed by users suffers degradation of quality and this degradation has the same root cause then their service trajectories can be grouped/clustered based on this similarity. Even if the root cause is not easy to identify by analysing service logs of an individual mobile terminal or a single service trajectory the way it manifests to a number of mobile terminals (location, time, type of service) gives enough information to group/cluster the service trajectories based on their similarity. Such cluster of service trajectories points to a network element shared by the mobile terminals and in this way it indicates location of the fault in the network. </p><p id="p0040" num="0040">In it suggested in embodiments of the present invention to analyse movements of mobile terminals together with services used by these mobile terminals. The correlation based on temporal co-occurrences in order to be successfully used to identify location of a fault must take into account at least the following problems and limitations. </p><p id="p0041" num="0041">Inaccurate timestamps of terminal reports may result in violation of causality. For all types of terminal reports latency often exists between the time when a failure 
<!-- EPO <DP n="12"/>-->
 occurs and the time when it shows up in the terminal reports. The latency may be introduced by buffering and caching in streaming services, periodic measurement latency, propagation delays and unsynchronized clocks. In a network primarily consisting of roaming users, it is highly possible that the attached access node when the terminal report is received is not the access node(s) when performance problem actually occurs. Therefore it is crucial to make service problem analysis robust to inaccurate report timestamps. </p><p id="p0042" num="0042">Traffic overhead. Introducing real-time or near-real-time terminal reporting not feasible as this would cause undesired traffic overhead consuming bandwidth available to mobile terminal accessing services. This, in turn, would also have a negative impact on user's perception of the service quality. </p><p id="p0043" num="0043">With reference to Fig. 1 a method of determining location of a failure causing degradation of a service in a mobile communications network is disclosed. As mentioned earlier, the method used in various embodiments of the present invention requires determining service trajectories. To achieve this, in the first step, movement trajectories of mobile terminals operating in the network are obtained, 102. For all mobile terminals the network knows their roaming records and this roaming records can be used to produce movement trajectories. Depending on individual mobile terminals and their configuration the movement trajectory may also contain GPS tracking data. Although the modern mobile terminals are often equipped with GPS modules they are not constantly used because they consume battery power. Even if the GPS data are logged by a mobile terminal they do not necessarily have to be reported to the network. In situations where a GPS receiver in a mobile terminal is running and the mobile terminal is configured to report the GPS logs to the communications network a more accurate movement trajectory is calculated. From a plurality of mobile terminals a mixture of movement trajectories will be obtained and most likely majority of them will be based on roaming data. 
<!-- EPO <DP n="13"/>-->
 In the next step service trajectories for mobile terminals are determined, 104. As explained above the service trajectories are computed by correlating the movement trajectories of individual mobile terminals with their corresponding service session records. </p><p id="p0044" num="0044">It is important to understand that in the embodiments of the present invention timestamps from the service records do not have to be accurate because the correlated results are not directly used to pinpoint the problems. The fact that the present invention in its embodiments does not require accurate timestamps is an important advantage. By accepting the inaccurate timestamps of service quality feedbacks and relaxing the requirements on granularity of terminal reporting the invention makes full use of existing data sources such as customer care records and mobility records. </p><p id="p0045" num="0045">Service session records of a particular service can be obtained for example from service detail records (SDRs), Quality of Experience (QoE) reports and customer trouble tickets. </p><p id="p0046" num="0046">Service detail records are computer records produced by nodes of the service and contain details of the service data sessions. Depending on implementation the SDR includes timestamp, service type, duration of the session, network element ID, etc.</p><p id="p0047" num="0047">SDRs can be collected for example from a content billing system of the data network.</p><p id="p0048" num="0048">They may also be collected from the service layer, for example, the Charging Details</p><p id="p0049" num="0049">Records (CDRs) in the on-line and off-line charging support of, for example, Ericsson Content Delivery System. The CDRs are generated at completion of each streaming session. One example of information fields comprised in such CDR is presented in table</p><p id="p0050" num="0050">1 below. 
<!-- EPO <DP n="14"/>-->
 Table 1 </p><p id="p0051" num="0051"><img id="imgf000014_0001" he="57" wi="123" file="imgf000014_0001.tif" img-format="tif" img-content="table" orientation="portrait" inline="no"/></p><p id="p0052" num="0052">QoE reports. QoE reporting mechanisms of 3GPP TS 26.234 defines that the QoE metrics are reported after the service session via the reception reporting procedure using HTTP in a single TCP session. Therefore, session details like session duration are available from such QoE reports. </p><p id="p0053" num="0053">Customer trouble tickets are generated when a customer calls the network operator regarding service disruptions. The trouble tickets are associated with different types of performance issues, the starting and ending time periods, the customer account number, etc. </p><p id="p0054" num="0054">As a result of correlation between movement trajectory and service records a service trajectory is produced. An example of such a service trajectory is presented in table 2 below. </p><p id="p0055" num="0055">Table 2 </p><p id="p0056" num="0056">Field Value </p><p id="p0057" num="0057"> Service type Web browsing </p><p id="p0058" num="0058"> Application type Web video (HTTP progressive downloading) 
<!-- EPO <DP n="15"/>-->
 Starting point {GPS INFO} (put cell ID here if there is no </p><p id="p0059" num="0059"> GPS information) </p><p id="p0060" num="0060"> Starting timestamp 2010-08-18 17:50 </p><p id="p0061" num="0061"> Waypoint 1 {GPS INFO} (put cell ID here if there is no </p><p id="p0062" num="0062"> GPS information) </p><p id="p0063" num="0063"> Waypointl timestamp 2010-08-18 17:55 </p><p id="p0064" num="0064">Waypoint n {GPS INFO} (put cell ID here if there is no </p><p id="p0065" num="0065"> GPS information) </p><p id="p0066" num="0066"> Waypoint n timestamp 2010-08-18 18:50 </p><p id="p0067" num="0067"> Ending point {GPS INFO} (put cell ID here if there is no </p><p id="p0068" num="0068"> GPS information) </p><p id="p0069" num="0069"> Ending timestamp 2010-08-18 18:59 </p><p id="p0070" num="0070">In the illustrated embodiment the service trajectory specifies the service and application which accesses the service. This is followed by a series of points defining spatial position of the mobile terminal. Preferably, the spatial position is defined using GPS data, but if this is not available then Cell ID from handover events is used. </p><p id="p0071" num="0071">In the next step distributions of the service trajectories of mobile terminals with degraded service are determined, 106. To determine how the service trajectories are distributed in one embodiment these service trajectories are grouped or assigned into subsets, using clustering analysis methods. The clustering is performed to explore similarities of service trajectories of users with degraded service performance. Service trajectories in the same cluster show similarities in certain aspect(s). In a preferred embodiment only service trajectories of users with degraded service performance are clustered in order to reduce resource requirements for processing these service trajectories. It is possible, however, in an alternative embodiment to perform clustering 
<!-- EPO <DP n="16"/>-->
 of all available service trajectories. This is, however, less preferred because it would require substantially increased processing resources. Especially if one realises that in a normally operating network a vast majority of users receives service at appropriate level. </p><p id="p0072" num="0072">Therefore, in a preferred embodiment, in order to reduce requirement for processing resources in the step of determining service trajectories, 104, only service trajectories of mobile terminals with degraded service are determined. Once the clustering is carried out the distribution of the service trajectories can be examined. Service trajectories that are similar are grouped in clusters. If the failure is related to a particular network element, e.g. a base station (NodeB or eNodeB, etc.) then terminal servers using this particular base station for accessing the service will have similar service trajectories (they have problems with the service and they used the same base station), i.e. will be clustered, and in graphical representation these trajectories will converge around the same base station. In one embodiment of the method of the present invention the network element around which the service trajectories converge is identified as the location of the failure, 108. Further details of processing the service trajectories that improve accuracy of identification of the location of the fault and reduce processing overhead are discussed below in description of various embodiments. </p><p id="p0073" num="0073">It is understood that in accessing a particular service there may be idle periods which appear as if the service is not used. For example, if the user is browsing the</p><p id="p0074" num="0074">Internet the browsing may stop for a while because the user is reading the content of the web page he just found. However, after he finished reading the page, he starts browsing the internet once again. On the other hand, when the service accessed is a video streaming session one would not expect breaks. Therefore, in a preferred embodiment, 
<!-- EPO <DP n="17"/>-->
 if the gap between two successive service records, from the same mobile terminal, of the same service is shorter that a defined observation window then these two service records are merged into one and the gap between them is ignored. The length of the observation window is, preferably, defined for the different types of services. In one embodiment the observation window for browsing internet is longer than the observation window for streaming services. On the other hand, if the gap between two successive records of the same service is longer than the observation window, the records are treated as separate service accesses and be mapped onto movement trajectories separately. This is illustrated in Fig. 4, where reference 402 shows three service records Rl, R2 and R3, and an observation window. The gap between service records Rl and R2 is shorter than the observation window and the gap between service records R2 and R3 is longer that the observation window. In consequence, the service records Rl and R2 are merged into service record Rl ' and the service record R3 remains separate, 404. </p><p id="p0075" num="0075">An important advantage of this approach is that merging service records allows for significant reduction of the calculation overhead while not affecting the accuracy of problem diagnosis. </p><p id="p0076" num="0076">In another, alternative embodiment the length of the observation window is determined dynamically using statistical methods (based on historical gap values between service records) and methods known as machine learning. </p><p id="p0077" num="0077">The operation of clustering the service trajectories used in the step of determining distributions 106 of the service trajectories with degraded service can be done using one of a number of known clustering techniques, including classical clustering methods such as K-means and DBSCAN. This disclosure presents a preferred embodiment in the paragraphs below. 
<!-- EPO <DP n="18"/>-->
 Preferably the embodiment of the step of determining distribution of service trajectories, 106, has two stages: spatial clustering, 202, (on its own it allows for heavy hitter identification), and temporal trajectory cluster analysis, 204, as illustrated in Fig. 2. Combining the spatial clustering with the temporal clustering improves accuracy of the method. However, even the spatial clustering leading to identification of a heavy hitter is a good method of identifying a failed network element. </p><p id="p0078" num="0078">The objective of spatial clustering, 202, is to provide spatial distribution of service trajectories to identify locations, 108, where service degradation of a given service is potentially prevalent and prune the remaining locations, in order to reduce the complexity for the subsequent analysis. In this way the heavy hitter is identified. </p><p id="p0079" num="0079">Temporal clustering, 204, further analyses the service trajectories to discover service trajectory clusters based on temporal distribution. For example, without temporal clustering the results may show a cluster of service trajectories converged around a specific base station. This indicates that the service degradation is caused by the base station. If, however, the temporal clustering is performed it may show that the service trajectories are clustered in a specific time period, for example between 8:00 and 9:00. This is additional information that helps identify the root cause of the failure. Analysis of operations carried out by the base station and on the base station in this time period helps isolate the process that caused the failure. </p><p id="p0080" num="0080">In determining heavy hitters, counting trajectories of an area or a node may not be useful, since users or groups of users may exhibit quite different movement patterns. Some users, such as taxi drivers, may have much more frequent movements than ordinary users. So, if heavy hitter is analysed based on trajectories or even trajectory segments, it is possible that they are from very few users or few trajectories, which may not represent problematic status of nodes. 
<!-- EPO <DP n="19"/>-->
 The nodes inside areas most visited by users having service problems may, however, operate error- free, because the corresponding service trajectories may not be those representing service quality problems and also because some areas are heavy hitter in nature due to a large number of mobile terminals operating therein, e.g. </p><p id="p0081" num="0081">shopping centres, busy train stations and airports, etc. Probability of finding users with service problems in such densely populated areas is higher than in other areas. </p><p id="p0082" num="0082">The objective of the operation of spatial clustering, 202, is to identify suspicious nodes or areas that may cause the service problems. In a preferred embodiment, a further analysis helps eliminate false positive results and identify the cause(s) of the service degradation. </p><p id="p0083" num="0083">Detecting heavy hitters (e.g. locations that manifest significant occurrences of the problem symptoms) of a given service is typically based on appropriately selected thresholds. For example, if mobile TV video quality impairment (such as picture freezing or no picture) is the symptom event, then heavy hitter access nodes can be defined to be those which more than k users with such service performance impairment visit in an observation window. However, considering the intrinsic nature of a mobile wireless network, a proper definition of heavy hitter should cover not only the occurrence frequency but also the density concentration. For example, in the same period, a cell with 10 problematic users among 100 visitors is more significant than a cell with 10 problematic users among 1000 visitors. </p><p id="p0084" num="0084">Bearing these considerations in mind, the following paragraphs present a preferred embodiment of the present invention including identifying heavy hitter locations using statistical significance test. By applying the statistical significance test the preferred embodiment eliminates false positive indications and in this way improves accuracy of the method. 
<!-- EPO <DP n="20"/>-->
 In statistics, a result is called statistically significant if it is unlikely to have occurred by chance. The number of users with impaired service performance attached to a failed cell is expected to be statistically significant. Suppose that in the mobile wireless network being studied, there are n moving users within an observation window (for example, one week). Let x<sub>;</sub>(i=l,2,...n) be the variable describing whether or not there is a service failure (per service or mix-service) with user i. if user i experiences service problem(s);</p><p id="p0085" num="0085"><img id="imgf000020_0001" he="12" wi="9" file="imgf000020_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 if user i doesn't experience any service problem(s); </p><p id="p0086" num="0086">Obviously, x<sub>l</sub> , ... ,x<sub>n</sub> are independent. The values of x<sub>l</sub> , ... ,x<sub>n</sub> can be obtained from service quality feedbacks. The mean μ and population variance σ<sup>2</sup> for x<sub>;</sub> can be approximated respectively using the following equations: 
<img id="imgf000020_0002" he="11" wi="56" file="imgf000020_0002.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0087" num="0087"> Σ^ - μ)<sup>2</sup> (2) </p><p id="p0088" num="0088">Consider a particular cell having a total number of visitors equal m and which has k visitors with service problems. Now it is necessary to determine whether this cell has a significant number of visitors for the given service problems, i.e. to test whether k is significant. </p><p id="p0089" num="0089">Under the null hypothesis that the m visitors are drawn independently and uniformly at random from n moving users: 
<!-- EPO <DP n="21"/>-->
 k =∑ , (3) </p><p id="p0090" num="0090"> i=l </p><p id="p0091" num="0091"> E[k]=m * μ (4) </p><p id="p0092" num="0092"> Var[^] = m * CT<sup>2</sup> (5) </p><p id="p0093" num="0093"> Where E[k] is an expected value of k from all possible values k can take on. </p><p id="p0094" num="0094">In a large mobile wireless network, visitors of a cell over the observation window (e.g. one week) are reasonably large (»30). So k is well-approximated by a normal distribution. Therefore, k is considered significant if </p><p id="p0095" num="0095">k </p><p id="p0096" num="0096"> — μ </p><p id="p0097" num="0097"> — ≥ z<sub>0</sub>, where z<sub>0</sub> is the threshold. (6)</p><p id="p0098" num="0098"><img id="imgf000021_0001" he="6" wi="8" file="imgf000021_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 For standard normal distribution, using values of z<sub>0</sub> as 1.64 and 1.96 provides confidence levels of 95% and 97.5%. </p><p id="p0099" num="0099">The following paragraphs give a detailed example. Suppose that in a particular mobile network, the mean of user service failure ratio is 0.02 (e.g. 2% users experience service problems), and standard deviation is 0.141. In a particular cell with 400 visitors during a week's window, there are 16 users experiencing service problems. So the question is whether this ratio (4%) is </p><p id="p0100" num="0100">significantly higher than the mean in the network. That is, are users in this particular cell experiencing much higher service problem compared to a simple random sample of 400 moving users in the network as a whole? </p><p id="p0101" num="0101">First, the standard error of the mean is calculated as follows: 
<!-- EPO <DP n="22"/>-->
 
<img id="imgf000022_0001" he="11" wi="76" file="imgf000022_0001.tif" img-format="tif" img-content="drawing" orientation="portrait" inline="no"/>
 </p><p id="p0102" num="0102">Then, z-score is calculated, which is the distance from the sample mean to the population mean in units of the standard error: k </p><p id="p0103" num="0103"> m <sup>μ</sup> _ 0.04 - 0.02 </p><p id="p0104" num="0104"> σ <sup>~</sup> 0.00705 </p><p id="p0105" num="0105">According to the standard normal (Z) table, the confidence level is 0.9954. Users in this particular cell are experiencing much more severe service problem compared to a simple random sample of 400 moving users in the network as a whole (with 99.54% probability). In other words, it can be said that with probability of 99.54% the 16 users experiencing problems in this particular cell is a statistically significant result (i.e. did not occur by chance). In a practical implementation a threshold is defined as the value ZQ in equation (6) and if the confidence level produced in the significance test is equal or above this threshold it is assumed that the test is passed. If the confidence level is below the threshold then the significance test failed, 114, and the cell is filtered out, 116, from further consideration. Depending on implementation, type of service, cell location, etc. the threshold can be defined at different level. For example, it may be relatively low for emergency calls to make sure that any failure to connect to emergency phone number is properly investigated. For other services the threshold may be set at higher levels. </p><p id="p0106" num="0106">Determining specific values of the threshold is not part of the present invention and would be determined for example by the network operator. </p><p id="p0107" num="0107">Significance test helps removing false indications pointing to the base stations located in popular areas. This is because in popular areas, not just users with service problems use the service. Majority of users in such areas would not experience service 
<!-- EPO <DP n="23"/>-->
 degradation. In this way, although this area has a large number of visiting users with service problems, the significance of such visitors is still low compared with the total number of visitors in this cell. Although statistical significance test is used in this proposal to improve accuracy of identifying heavy hitters by filtering out false indications, this invention doesn't exclude other methods allowing for filtering out false indications, including but not limited to data mining techniques such as PCA, simple smoothing techniques (e.g., exponential averaging), Box- Jenkins ARIMA modeling, and wavelet-based methods, and machine learning. </p><p id="p0108" num="0108">It may happen that the clustering analysis shows that the service trajectories converge around more than one base station, 1 10. This may indicate that the two or more base stations developed failures that affect service performance. In a preferred embodiment the statistical significance test helps to determine if indeed more than one base station causes degradation of the service. If the significance test confirms that two or more base stations cause the service degradation the method in a preferred embodiment comprises identifying a network element shared by the nodes in providing the service as the location of the failure, 112. For example, a RNC (radio network controller) failure may trigger service failure for users within multiple cells of the RNC. By correlating with configuration information (such as network topologies), the identified cells can be aggregated into network segments covered by any nodes in the network, such as RNC(s), SGSN(s), GGSN(s) and DNS servers. As explained above the failed network element causing degradation of a service received by mobile terminals may not necessarily be a base station. The spatial clustering, 202, described above helps identifying base stations that cause service degradation experienced by the mobile terminals. This is because the mobile terminals are directly connected during the service to a particular base station and the correlation 
<!-- EPO <DP n="24"/>-->
 between the service records and the movement trajectories clearly point to base stations used by the mobile terminal. This may not be enough, as explained above, to identify the network element that really causes the service degradation if the service degradation spreads across more than one cell. </p><p id="p0109" num="0109">Therefore in a preferred embodiment of the present invention, illustrated in Fig. 3, cluster analysis is used to determine logical distributions of the service trajectories 302, wherein logical distribution takes into account topology of the network. By using network topology data in the clustering operation it is possible to detect that service trajectories of mobile terminals using the three NodeBs 1218 converge around radio network controller (R C) 1216 as illustrated in Fig. 12. </p><p id="p0110" num="0110">As mentioned in the background section service degradation may be caused by the soft failures which are short in duration. The symptoms and also the soft failure may disappear after this short period of time and then re-appear causing repeated service degradation. Because the soft failure may disappear it is very difficult to determine which network element failed and is responsible for the service degradation because when network operator receives terminal reports indicating service problem it may be too late to investigate as the soft failure disappeared and the mobile terminal is attached to another base station. </p><p id="p0111" num="0111">In order to solve the problem of identifying location of the disappearing soft failures the present invention in one embodiment introduces clustering analysis of the service trajectories in time domain (or temporal clustering), 204. </p><p id="p0112" num="0112">In this step service trajectories identifying a particular network element (e.g. base station, RNC, SGSN, etc) are clustered based on their temporal occurrence. If the service degradation is caused by common causes and is not continuous, it is expected that the trajectories would be clustered in temporal space and the occurrence of the 
<!-- EPO <DP n="25"/>-->
 clusters (in time domain) would accompany or follow the occurrence of network or nodal problems. </p><p id="p0113" num="0113">Clustering of the service trajectories may be caused by other factors, like user movement habits or the rhythm of the day. For example, users may use access to certain services, like web browsing or web TV, between 8:00 am and 9:00 am when they commute to work. Therefore, preferably, the clustered results shall be evaluated in the next step using statistical significance test to ensure that the temporal cluster(s) did not occur by chance. The test in this case is very similar to the previously described and a person skilled in the art would have no problem with implementing it based on the earlier description, and therefore for the sake of brevity the description of the statistical significance test will not be repeated here. The basic idea of evaluating a service trajectory cluster, if the clustering is not caused by a common failure, is that the clustered trajectories, which are from users with service quality problems, would be statistically insignificant among all trajectories of the cell or network element. On the other hand, if the clustering is caused by common failure, most of the trajectories would be affected and therefore, the clustered trajectories are expected to be statistically significant. Directly applying existing the clustering algorithms like DBSCAN or K-means to this problem is not possible because the existing clustering approaches are designed to cluster "point" data (such as measurement samples) and not "range" data, the distance required for existing clustering algorithms is hard to define in this scenario - a time gap between two trajectories is not useful in cause analysis. </p><p id="p0114" num="0114">In a preferred embodiment a service trajectory cluster is a subset of the service trajectories of a heavy hitter cell (or any other failed network element causing service degradation). The definition of a service trajectory cluster in time domain is based on density of trajectory overlaps and is explained with reference to Fig. 9. Service 
<!-- EPO <DP n="26"/>-->
 trajectory si has overlaps at a time point (between T l s and T_2_t, or between T_3_s and T_4_t) with sufficiently many other service trajectories (e.g. s2 s3 s4) that si is considered to be part of a trajectory cluster. MinOverlaps is a threshold, defining a minimum number of overlaps a trajectory may have with other trajectories in order to be considered a cluster. </p><p id="p0115" num="0115">If any other trajectories in the cluster have at least MinOverlaps overlaps with other trajectories (not limited to those already inside the cluster), the original cluster is expanded (e.g. expandCluster() function in the pseudo code illustrated in Fig. 13) by merging new clusters. For example, in FIG. 9, after cl is identified for trajectory si, cl is further expanded by merging c2 with cl when trajectories overlapping with s4 are examined. </p><p id="p0116" num="0116">The pseudo code of the proposed algorithm is illustrated in Fig. 13. To further highlight the difference between this clustering algorithm and other clustering algorithms like DBSCAN, the pseudo code is deliberately written using similar functions. Similar to DBSCAN, the temporal clustering algorithm used in embodiments of the present invention is density based. Therefore, the algorithm follows the same rule, e.g. first identifying a cluster and then expanding the cluster. </p><p id="p0117" num="0117">In particular, the characteristic features of the algorithm are: </p><p id="p0118" num="0118">(1) It is based on density of overlaps. If the service degradation is caused by common causes, it is expected that the trajectories of the same cell would be clustered in time domain. </p><p id="p0119" num="0119">(2) Clustering range data, not point data, by analyzing overlaps between trajectories and calculating maximum overlapped trajectory sets. 
<!-- EPO <DP n="27"/>-->
 (3) Only one parameter (MinOverlaps) needs to be pre-defined, as compared to two parameters in DBSCA (eps and minPts). This significantly increases the accuracy of the clustering algorithm. Where MinOverlaps define a minimum number of overlapping service trajectories in order to be classified as cluster. </p><p id="p0120" num="0120">In one embodiment the proposed temporal clustering may be applied to a particular service, like web browsing or mobile TV and in alternative embodiments it may also be applied to a group of services to analyze failure patterns between services with similar characteristics. </p><p id="p0121" num="0121">The temporal clustering is illustrated in Fig. 8, where first a spatial or logical distribution has been determined 802. This cluster of service trajectories clearly converges around a particular location (when a spatial distribution is analysed) and points at a particular base station as the location of cause of the service degradation. If a logical distribution is analysed and the topology of the network is considered the cluster 802 converges around a specific network element, e.g. R C or SGSN and points at this network element as the location of cause of the service degradation. </p><p id="p0122" num="0122">When temporal distribution of the service trajectories identified as cluster 802 is analysed it can be seen that they are distributed along the whole time line, but clearly there is a much denser population between hours 8:00 and 9:00. By examining temporal overlapping of the service trajectories it is found that the MinOverlaps threshold has been crossed and a cluster 804 exists. In a preferred embodiment, if the cluster 804 passes the statistical significance test, 114, and is not considered occurring by chance then it provides further vital information necessary to perform the root cause analysis. The cluster 804 indicates that between 8:00 and 9:00 specific conditions existed in the network element identified by cluster 802, which caused the service degradation. Analysis of configuration data, 
<!-- EPO <DP n="28"/>-->
 various logs from the network element in this specific time period dramatically simplifies and speeds up the process of determining the root cause of the service degradation. Using the temporal clustering gives the present invention an important advantage over the known solutions. It allows for very precise identification of place and time of the problem occurrence that caused the service degradation. In this way the short living soft failures can be identified and in consequence appropriate measures can be taken to address them. </p><p id="p0123" num="0123">In a preferred embodiment a temporal cluster (or temporal clusters) determined in step 204 is correlated with failure events of the network element around which the service trajectories converge. The correlation is carried out to improve accuracy of identifying root causes of the service failures. A preferred embodiment of correlating the service trajectories with failure events is discussed below. Correlating information relating to service problems across the network advantageously allows for more accurate and faster root cause analysis. </p><p id="p0124" num="0124">Assume that during a defined time period the total number of service trajectory clusters (temporal clustering) is N . During the same time period the number of times that the same, or the same type, failure event (event e<sub>x</sub> ) occur before the temporal clusters within a pre-defined observation window w<sub>e</sub> (30 seconds by default) is also determined ( N )· The number of events ei may refer to the same event occurring repeatedly (for example overloaded CPU of a particular GGSN node), i.e. exactly the same event, or to the same type of event, for example congestion at different base stations. In this way it is assumed that if a temporal cluster of service trajectories is formed within 30 seconds after event e\ then the temporal cluster of service trajectories is caused by the event e\. If the time period between the event and temporal cluster is 
<!-- EPO <DP n="29"/>-->
 bigger than 30 seconds then there is no causal relationship between these two. The causal probability between the network failure event and the service quality degradation P<sub>e &gt;s</sub> is calculated by dividing the number of occurrences N<sub>ei</sub>_<sub>&gt;¾</sub> by the total number of service trajectory clusters identified in the defined time period N<sub>s</sub> . </p><p id="p0125" num="0125">(9) </p><p id="p0126" num="0126"> N. </p><p id="p0127" num="0127">If the calculated causal probability P<sub>e &gt;s</sub> is above a defined threshold, the causal relation is ascertained. </p><p id="p0128" num="0128">The present invention in its embodiments is applicable to determining location of a failure that causes degradation of more than one service. Additionally it is also applicable to determining location of multiple failures causing degradation of one service. </p><p id="p0129" num="0129">With reference to Fig. 10 and Fig. 11 several embodiments of an apparatus, 1100, for determining location of a failure causing degradation of a service in a mobile communications network in accordance with the present invention are presented. The apparatus may be implemented as a stand alone device or as an additional functionality in a network management/OSS (Operational Support System). The apparatus comprises a mobility monitor module, 1102, which obtains movement trajectories of mobile terminals operating in the network. The movement trajectories are obtained from mobility records stored in the wireless communications network and can be in a form of GPS data or roaming data. If a mobile terminal is equipped with a GPS receiver and records the GPS data and then provides this data to the network then the apparatus according to a preferred embodiment of the present invention uses the GPS data to determine movement trajectories of the mobile terminal. It is understood, however, that 
<!-- EPO <DP n="30"/>-->
 not all mobile terminal are equipped with GPS circuitry and even those mobile terminals having built-in GPS receivers may not keep the GPS receivers switched on all the time as this consumes battery. Moreover, even if such GPS data are collected by a mobile terminal the user may not agree to report them to the network. All these clearly suggest that GPS data is not always available to the mobility monitor module 1102. Therefore in a preferred embodiment the mobility monitor module 1102 accesses roaming data to determine movement trajectory of the mobile terminal. The difference between GPS based and roaming based movement trajectories is illustrated in Fig. 7 and discussed earlier in the accompanying description. </p><p id="p0130" num="0130">The apparatus, 1100, further comprises a service monitor module, 1104, adapted to determine service trajectories of the mobile terminals. The service monitor module, 1104, determines the service trajectories by correlating the movement trajectories of individual mobile terminals with service session records of the mobile terminals. </p><p id="p0131" num="0131">Specific details of this operation are illustrated in Fig. 5 and Fig. 6 and discussed earlier in the accompanying description. </p><p id="p0132" num="0132">The apparatus further comprises an analyser module, 1106, adapted to determine distributions (spatial, logical and/or temporal) of the service trajectories of mobile terminals with degraded service. The analyser module, 1106, is further adapted to identify a network element around which the service trajectories converge as the location of the failure. </p><p id="p0133" num="0133">In one embodiment the mobility monitor, 1102, service monitor, 1104 and analyser, 1106, modules are implemented as discrete components and in an alternative embodiment they are parts of one or more processor units 1108. </p><p id="p0134" num="0134">In one embodiment the apparatus, 1100, comprises a first database, 1110, storing mobility records of the mobile terminals operating in the network and/or a second 
<!-- EPO <DP n="31"/>-->
 database, 1112, storing service records of the mobile terminals. In an alternative embodiment, however, the mobility and service records are stored in the </p><p id="p0135" num="0135">communications network and the apparatus, 1100, only accesses these records when necessary. </p><p id="p0136" num="0136">Preferably the apparatus, 1100, is also configured to access network topology data and/or failure events data of the network elements. </p><p id="p0137" num="0137">In various embodiments the analyser module, 1106, performs a cluster analysis to determine spatial distribution of the service trajectories and/or logical distribution of the service trajectories, wherein for the spatial distribution the mobility records are used and for the logical distribution the mobility records are used together with the topology data. The analyser module 1106 is also adapted to perform cluster analysis to determine temporal distributions of the service trajectories as described earlier in embodiments of the method of the present invention. </p><p id="p0138" num="0138">The apparatus, 1100, obtains mobility records from roaming data provided by SGSN, 1206, illustrated in Fig. 12. The GPS data used as mobility records of mobile terminals may be records of Assisted GPS (A-GPS) measurements. Service records, in turn, are from various QoS measurements carried out by service quality monitoring systems, from QoS and/or QoE reports directly from the mobile terminals 1224 or from customer care tickets. </p><p id="p0139" num="0139">Other operations performed by the analyser module 1106 in various </p><p id="p0140" num="0140">embodiments include carrying out statistical significance tests, 114, and statistical correlation between network elements identified as location of failures and failure event occurrence relevant to the identified elements. 
<!-- EPO <DP n="32"/>-->
 With reference to Fig. 12 a mobile communications network, 1200, in one embodiment of the present invention is disclosed. The illustrated network includes various parts that operate in accordance with different wireless technologies and standards. Mobile terminals 1222 and 1224 connect to the network via 2G, 3G or LTE wireless access the networks, where in 2G network the wireless terminals connect to a Base Transceiver Station (BTS), 1214, which is controlled by a Base Station Controller (BSC) 1212. In 3G network a wireless connection is established between the mobile terminals and a NodeB, 1218 controlled by a Radio Network Controller (RNC), 1216. When the wireless terminals operate in LTE network they connect to eNodeB 1220, which in LTE network also performs radio control functions. The mobile </p><p id="p0141" num="0141">communications network 1200 comprising parts operating in these three different technologies is a very likely real life scenario because the networks currently deployed evolved from the second generation, 2G, networks through networks of the 3<sup>rd</sup> generation, 3G, to Long Term Evolution (LTE) networks. In the process of upgrading the network to a higher generation one the old one in majority of cases was left in place and now the wireless access is provided within one network by different access technologies. As illustrated in Fig. 12 the network 1200 comprises a number of network elements 1202 - 1220, where at least part of the network elements is in direct communication with the mobile terminals 1222, 1224. The basic topology of the network illustrated in Fig. 12 is clear and would be understood by a person skilled in the art. The network 1200 further comprises an apparatus 1100 that is configured to determine location of a failure causing degradation of a service in the mobile communications network. The apparatus 1100 comprises a mobility monitor module, 1102, which is configured to obtain movement trajectories of mobile terminals operating in the network. The movement trajectories are obtained from mobility records, 1232, stored in the wireless communications network and can be in a form of GPS data or roaming data. The apparatus, 1100, further comprises a service monitor module, 1104, adapted to determine service trajectories of the mobile terminals by correlating the movement trajectories of individual mobile terminals with service 
<!-- EPO <DP n="33"/>-->
 session records, 1234, of the mobile terminals. The apparatus further comprises an analyser module, 1106, which is adapted to determine distributions (spatial, logical and/or temporal) of the service trajectories of mobile terminals with degraded service. The analyser module, 1106, is further adapted to identify a network element around which the service trajectories converge as the location of the failure. </p><p id="p0142" num="0142">In a preferred embodiment the network 1200 comprises a network management system 1226 storing topology information 1228 which is accessed by the apparatus 1100 in the process of determining logical distribution of the service trajectories. </p><p id="p0143" num="0143">Although the description above disclosed embodiments of the invention in the context of mobile communications network based on specific technologies, in particular 2G, 3G and LTE networks the invention is also applicable to other types of wireless mobile networks, e.g. WiMax, illustrated in Fig. 12 as Non-3GPP access 1230. </p><p id="p0144" num="0144">In yet another embodiment of the present invention a computer program product is disclosed. The computer program product, stored on a computer readable medium, when executed on a computer is adapted to perform the steps of the method described earlier. </p><p id="p0145" num="0145">It is important to appreciate that the present invention in its described </p><p id="p0146" num="0146">embodiments may be implemented in a large wireless network, which may contain thousands of radio base stations, a large number of controllers and a number of core nodes, and this is not possible with the methods known in the art. Implementing a full- scale monitoring solution based on the known in the art probing methods is not feasible. The present invention, however, helps localise problematic network segments or network elements and then more detailed analysis of the suspected network element can be carried out. Alternatively the results produced by the present invention can be used to determine measurement points for the known probing methods. Additional advantage of 
<!-- EPO <DP n="34"/>-->
 the present invention over the probing methods is that it is a passive analysis that does not affect user traffic or any existing systems, as compared to active probing solutions. 
</p></description><claims mxw-id="PCLM44727659" ref-ucid="WO-2012113436-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="35"/>-->CLAIMS </claim-statement><claim id="clm-0001" num="1"><claim-text>1. A method of determining location of a failure causing degradation of a service in a mobile communications network comprising: </claim-text><claim-text> obtaining movement trajectories of mobile terminals operating in the network; determining service trajectories for the mobile terminals by correlating the movement trajectories of individual mobile terminals with service session records of the mobile terminals; </claim-text><claim-text> determining distribution of the service trajectories of mobile terminals with degraded service; </claim-text><claim-text> identifying a network element around which the service trajectories converge as the location of the failure. </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. The method according to claim 1, wherein in the step of determining service trajectories only service trajectories of mobile terminals with degraded service are determined. </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. The method according to any one of claims 1 to 2, wherein if there is more than one node around which the service trajectories converge the method comprises identifying a network element shared by the nodes in providing the service as the location of the failure. </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. The method according to any one of the preceding claims, wherein cluster analysis is used to determine spatial distribution of the service trajectories. </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. The method according to any one of the preceding claims, wherein cluster analysis is used to determine logical distribution of the service trajectories. </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. The method according to any claim 4 or 5 further comprising using cluster analysis to determine temporal distribution of the service trajectories. <!-- EPO <DP n="36"/>--> </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. The method according to any one of the preceding claims further comprising merging two service session records of the same service, from the same mobile terminal, if a time gap between the two service session records is not longer than an observation window. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. The method according to claim 4 or claim 5 comprising: </claim-text><claim-text> clustering service trajectories in time domain, wherein service trajectories are part of the same cluster if the service trajectories at least partially overlap in the time domain and a number of overlapping service trajectories is equal or above a threshold; and </claim-text><claim-text> in the step of identifying a location of the failure identifying the network element as the location of the failure only if the service trajectories converge around the network element and a cluster of service trajectories in time domain is formed. </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. The method according to any one of preceding claims further comprising carrying out a statistical significance test based on service trajectories clustered around a network element and identifying the network element as location of the failure; and filtering out the network element from further consideration if the statistical significance test failed. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. The method according to claim 6 or 7, further comprising carrying out a test of statistical correlation between a temporal cluster and failure event occurence. </claim-text></claim><claim id="clm-0011" num="11"><claim-text>11. The method according to any one of preceding claims wherein the failure causes degradation of more than one service. </claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. The method according to any one of preceding claims wherein the service degradation is caused by more than one failure. <!-- EPO <DP n="37"/>--> </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. An apparatus for determining location of a failure causing degradation of a service in a mobile communications network comprising a mobility monitor module adapted to obtain movement trajectories of mobile terminals operating in the network, a service monitor module adapted to determine service trajectories of the mobile terminals by correlating the movement trajectories of individual mobile terminals with service session records of the mobile terminals and an analyser module adapted to determine distribution of the service trajectories of mobile terminals with degraded service and to identify a network element around which the service trajectories converge as the location of the failure. </claim-text></claim><claim id="clm-0014" num="14"><claim-text>14. The apparatus according to claim 13 configured to access network topology data. </claim-text></claim><claim id="clm-0015" num="15"><claim-text>15. The apparatus according to claim 13 or 14 configured to access failure events data of the network elements. </claim-text></claim><claim id="clm-0016" num="16"><claim-text>16. The apparatus according to any one of claims 13 to 15, wherein the analyser module is adapted to perform a cluster analysis to determine spatial distribution of the service trajectories. </claim-text></claim><claim id="clm-0017" num="17"><claim-text>17. The apparatus according to any one of claims 13 - 16, wherein the analyser module is adapted to perform a cluster analysis to determine logical distribution of the service trajectories. </claim-text></claim><claim id="clm-0018" num="18"><claim-text>18. The apparatus according to claim 16 or claim 17, wherein the analyser module is adapted to perform a cluster analysis to determine temporal distribution of the service trajectories. <!-- EPO <DP n="38"/>--> </claim-text></claim><claim id="clm-0019" num="19"><claim-text>19. The apparatus according to any one of claims 13 - 18, wherein the analyser module is adapted to perform a statistical significance test based on service trajectories of the monitored network identifying the network element as location of the failure; and to filter out the network element from further consideration if the statistical significance test failed. </claim-text></claim><claim id="clm-0020" num="20"><claim-text>20. The apparatus according to any one of claims 13 - 19, wherein the analyser module is adapted to merge two service session records of the same service, from the same mobile terminal, if a time gap between the two service session records is not longer than an observation window. </claim-text></claim><claim id="clm-0021" num="21"><claim-text>21. The apparatus according to claim 16 or claim 17, wherein the analyser module is adapted to cluster service trajectories in time domain, wherein service trajectories are part of the same cluster if the service trajectories at least partially overlap in the time domain and a number of overlapping service trajectories is equal or above a threshold; and to identify the network element as the location of the failure only if the service trajectories converge around the network element and a cluster of service trajectories in time domain is formed. </claim-text></claim><claim id="clm-0022" num="22"><claim-text>22. The apparatus according to claim 21, wherein the analyser module is adapted to carry out a statistical significance test based on data related to distributions of the service trajectories; and to filter out the service trajectory from further consideration if the statistical significance test failed. </claim-text></claim><claim id="clm-0023" num="23"><claim-text>23. The apparatus according to any one of claims 13 - 22, wherein the analyser module is adapted to carry out statistical correlation between network element identified as location of failure and failure event occurrence relevant to the identified elements. </claim-text></claim><claim id="clm-0024" num="24"><claim-text>24. A mobile communications network comprising a plurality of network elements, at least part of the network elements being in communication with a second plurality of <!-- EPO <DP n="39"/>--> wireless mobile terminals operating in the network and the network further comprising an apparatus for determining location of a failure causing degradation of a service in the mobile communications network; the apparatus comprising a mobility monitor module adapted to obtain movement trajectories of mobile terminals operating in the network, a service monitor module adapted to determine service trajectories of the mobile terminals by correlating the movement trajectories of individual mobile terminals with service session records of the mobile terminals and an analyser module adapted to determine distribution of the service trajectories of mobile terminals with degraded service and to identify a network element around which the service trajectories converge as the location of the failure. </claim-text></claim><claim id="clm-0025" num="25"><claim-text>25. A computer program product adapted to perform, when executed on a computer, a method of determining location of a failure causing degradation of a service in a mobile communications network comprising the steps of: </claim-text><claim-text> obtaining movement trajectories of mobile terminals operating in the network; determining service trajectories for the mobile terminals by correlating the movement trajectories of individual mobile terminals with service session records of the mobile terminals; </claim-text><claim-text> determining distribution of the service trajectories of mobile terminals with degraded service; </claim-text><claim-text> identifying a network element around which the service trajectories converge as the location of the failure. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
