<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2679954-A1" country="EP" doc-number="2679954" kind="A1" date="20140101" family-id="46650347" file-reference-id="317508" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146549614" ucid="EP-2679954-A1"><document-id><country>EP</country><doc-number>2679954</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12173532-A" is-representative="YES"><document-id mxw-id="PAPP154823537" load-source="docdb" format="epo"><country>EP</country><doc-number>12173532</doc-number><kind>A</kind><date>20120626</date><lang>EN</lang></document-id><document-id mxw-id="PAPP175868112" load-source="docdb" format="original"><country>EP</country><doc-number>12173532.8</doc-number><date>20120626</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140445286" ucid="EP-12173532-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>12173532</doc-number><kind>A</kind><date>20120626</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988098834" load-source="docdb">G01S  19/49        20100101ALI20121129BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988126113" load-source="docdb">G01S   5/02        20100101ALI20121129BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988129822" load-source="docdb">G01C  21/16        20060101AFI20121129BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-2048002973" load-source="docdb" scheme="CPC">G01C  21/165       20130101 LI20150606BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2048003734" load-source="docdb" scheme="CPC">G01C  21/00        20130101 LI20150604BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2048008432" load-source="docdb" scheme="CPC">G01S  19/49        20130101 FI20150606BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988926449" load-source="docdb" scheme="CPC">G01S   5/0294      20130101 LI20140103BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132181326" lang="DE" load-source="patent-office">Sequenzielle Schätzung in einem Echtzeitortungssystem oder einem Echtzeitnavigationssystem mit Verwendung historischer Zustände</invention-title><invention-title mxw-id="PT132181327" lang="EN" load-source="patent-office">Sequential estimation in a real-time positioning or navigation system using historical states</invention-title><invention-title mxw-id="PT132181328" lang="FR" load-source="patent-office">Estimation séquentielle dans un système de positionnement ou navigation en temps réel par utilisation d'états historiques</invention-title><citations><patent-citations><patcit mxw-id="PCIT420872884" load-source="docdb" ucid="US-20050251328-A1"><document-id format="epo"><country>US</country><doc-number>20050251328</doc-number><kind>A1</kind><date>20051110</date></document-id><sources><source name="SEA" category="XI" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT420872885" load-source="docdb" ucid="US-20100318292-A1"><document-id format="epo"><country>US</country><doc-number>20100318292</doc-number><kind>A1</kind><date>20101216</date></document-id><sources><source name="SEA" category="XI" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242652974" load-source="docdb" ucid="US-20110004404-A1"><document-id format="epo"><country>US</country><doc-number>20110004404</doc-number><kind>A1</kind><date>20110106</date></document-id><sources><source name="APP" created-by-npl="N"/></sources></patcit></patent-citations><non-patent-citations><nplcit><text>AJIT GOPALAKRISHNAN ET AL: "Incorporating delayed and infrequent measurements in Extended Kalman Filter based nonlinear state estimation", JOURNAL OF PROCESS CONTROL, vol. 21, no. 1, 1 January 2011 (2011-01-01), pages 119 - 129, XP055014415, ISSN: 0959-1524, DOI: 10.1016/j.jprocont.2010.10.013</text><sources><source mxw-id="PNPL80178158" load-source="docdb" name="SEA" category="XI"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR918150837" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ST ERICSSON SA</last-name><address><country>CH</country></address></addressbook></applicant><applicant mxw-id="PPAR918162690" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>ST-ERICSSON SA</last-name></addressbook></applicant><applicant mxw-id="PPAR918986194" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>ST-Ericsson SA</last-name><iid>101265257</iid><address><street>Chemin du Champ-des-Filles 39</street><city>1228 Plan-les-Ouates</city><country>CH</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918141161" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>FLEMING PETER</last-name><address><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR918164876" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>FLEMING, PETER</last-name></addressbook></inventor><inventor mxw-id="PPAR918987252" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>FLEMING, PETER</last-name><address><street>Stream Cottage, Westbrook</street><city>Newbury, RG20 8DN</city><country>GB</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918987656" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>O'Connell, David Christopher</last-name><iid>100030418</iid><address><street>Haseltine Lake LLP Redcliff Quay 120 Redcliff Street</street><city>Bristol BS1 6HU</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS548878164" load-source="docdb">AL</country><country mxw-id="DS548805984" load-source="docdb">AT</country><country mxw-id="DS548878165" load-source="docdb">BE</country><country mxw-id="DS548892548" load-source="docdb">BG</country><country mxw-id="DS548846025" load-source="docdb">CH</country><country mxw-id="DS548878166" load-source="docdb">CY</country><country mxw-id="DS548898902" load-source="docdb">CZ</country><country mxw-id="DS548807991" load-source="docdb">DE</country><country mxw-id="DS548878167" load-source="docdb">DK</country><country mxw-id="DS548878168" load-source="docdb">EE</country><country mxw-id="DS548877315" load-source="docdb">ES</country><country mxw-id="DS548892549" load-source="docdb">FI</country><country mxw-id="DS548892558" load-source="docdb">FR</country><country mxw-id="DS548807992" load-source="docdb">GB</country><country mxw-id="DS548878169" load-source="docdb">GR</country><country mxw-id="DS548807993" load-source="docdb">HR</country><country mxw-id="DS548898903" load-source="docdb">HU</country><country mxw-id="DS548846026" load-source="docdb">IE</country><country mxw-id="DS548878170" load-source="docdb">IS</country><country mxw-id="DS548892559" load-source="docdb">IT</country><country mxw-id="DS548878171" load-source="docdb">LI</country><country mxw-id="DS548807994" load-source="docdb">LT</country><country mxw-id="DS548805985" load-source="docdb">LU</country><country mxw-id="DS548892560" load-source="docdb">LV</country><country mxw-id="DS548807995" load-source="docdb">MC</country><country mxw-id="DS548805986" load-source="docdb">MK</country><country mxw-id="DS548805987" load-source="docdb">MT</country><country mxw-id="DS548878172" load-source="docdb">NL</country><country mxw-id="DS548807997" load-source="docdb">NO</country><country mxw-id="DS548878173" load-source="docdb">PL</country><country mxw-id="DS548892561" load-source="docdb">PT</country><country mxw-id="DS548898904" load-source="docdb">RO</country><country mxw-id="DS548892570" load-source="docdb">RS</country><country mxw-id="DS548878174" load-source="docdb">SE</country><country mxw-id="DS548846027" load-source="docdb">SI</country><country mxw-id="DS548807998" load-source="docdb">SK</country><country mxw-id="DS548807999" load-source="docdb">SM</country><country mxw-id="DS548805988" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128670283" lang="EN" load-source="patent-office"><p id="pa01" num="0001">A sequential estimation method for real-time positioning or navigation systems is performed by, at each iteration: propagating a first state estimate into a state prediction, and then forming a second state estimate, by updating the state prediction using state measurements. The first state estimate is valid at a first time and comprises estimated values of a plurality of state parameters, the plurality of state parameters including at least one state parameter referring to a time earlier than the first time. The second state estimate is valid at a second time and comprises estimated values of said plurality of state parameters, the plurality of state parameters including at least one state parameter referring to a time earlier than the second time. The state measurements comprise measurements relating to state parameters at the second time and measurements relating to state parameters at the time earlier than the second time.
<img id="iaf01" file="imgaf001.tif" wi="78" he="144" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128499656" lang="EN" source="EPO" load-source="docdb"><p>A sequential estimation method for real-time positioning or navigation systems is performed by, at each iteration: propagating a first state estimate into a state prediction, and then forming a second state estimate, by updating the state prediction using state measurements. The first state estimate is valid at a first time and comprises estimated values of a plurality of state parameters, the plurality of state parameters including at least one state parameter referring to a time earlier than the first time. The second state estimate is valid at a second time and comprises estimated values of said plurality of state parameters, the plurality of state parameters including at least one state parameter referring to a time earlier than the second time. The state measurements comprise measurements relating to state parameters at the second time and measurements relating to state parameters at the time earlier than the second time.</p></abstract><description mxw-id="PDES63955713" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><p id="p0001" num="0001">This invention relates to a method and system for performing sequential estimation, and in particular for performing sequential estimation in a real-time positioning or navigation system.</p><p id="p0002" num="0002">Real-time navigation systems typically employ an Extended Kalman Filter (EKF) or other least-squares sequential estimation technique. Variations of the standard EKF exist, such as the Unscented Kalman filter.</p><p id="p0003" num="0003">In general terms, these techniques operate by estimating time-varying parameters (such as the position, speed and direction of motion in a navigation system) using various measurements, such as measurements from a Global Navigation Satellite System (GNSS) and/or the outputs from accelerometer and gyroscope sensors. These measurements are combined with deterministic and stochastic models and with assumptions about the errors in the measurements and the time-varying nature of the parameters being estimated.</p><p id="p0004" num="0004">For a real-time navigation system, the estimation process is sequential in nature. That is, at any one instant it is desired to make the best estimate of the current values of the time-varying parameters, based on all current and previous information available at that time. The parameters which describe the current state of the system are incrementally updated in time as new measurements and information become available.</p><p id="p0005" num="0005">For real-time navigation applications it is usually only the current state of the system which is required. For example, a car driver navigating to a target destination using a satellite navigation device would only want to know the best estimate of the position, speed and direction of motion at the current instant. There would be no advantage in their being provided with an updated estimate of the state some seconds ago. (By contrast, a tracking device provides information about where the device is and where it has been in the past.)</p><p id="p0006" num="0006">The EKF (and similar algorithms) is a computationally-efficient means of performing sequential estimation in order to generate an optimal, or near-optimal, estimate of the current state of a system, and is commonly and widely used in real-time navigation systems and devices.<!-- EPO <DP n="2"> --></p><p id="p0007" num="0007">The computational efficiency of the Kalman filter and similar algorithms arises at least in part because all received information is, in effect, stored within the system in a very efficient, compressed, form, and propagated forward in time from its actual time of applicability to the current state time.</p><p id="p0008" num="0008">However, this has disadvantages. Firstly, if information (e.g. a GNSS measurement) is added to the system at one time, but it subsequently becomes apparent that that information was erroneous and should not have been added, then the standard formulations of the algorithms make it very difficult to remove the effect of that erroneous information. Consequently, the erroneous information contaminates the state estimates at the current and all future epochs.</p><p id="p0009" num="0009">Secondly, if any information is delayed, and only becomes available at a time significantly beyond the current state time, then the standard formulations of the algorithms make it very difficult for that old information to be used. That is, in standard sequential estimation techniques, all the information is required in (close to) real-time. In practice, this is not always achievable, in that some measurements, or information, might be provided to the system with too great a latency. By the time this information is received, the system has already propagated the sequential estimation process beyond the time-of-applicability of this newly-received but old information, and so cannot make use of the information.</p><p id="p0010" num="0010">One specific example of these disadvantages arises in the case of processing Zero Velocity Updates (ZUPTs) in inertial navigation. In standard inertial navigation, a ZUPT occurs at a time when the user is stationary. Knowledge that the unit is stationary means that the specific force sensed by the accelerometers is due solely to gravity, and the output of the gyroscopes is due solely to earth rotation. This information allows the performance of the navigation system to be improved. Even for non-inertial systems, the knowledge that the user is stationary is often beneficial for the system performance. However, an initial determination that the unit is stationary might be highly uncertain, and knowledge that the unit is stationary may only be obtained after a delay that is greater than the period of the estimation.</p><p id="p0011" num="0011">One way to mitigate this problem is to delay the estimation process itself. That is, rather than estimating the current state, the system can instead provide estimates of<!-- EPO <DP n="3"> --> the state a few seconds previously. Besides the fact that this will require the storage of the measurement information not yet processed, the fact that the output is always old is obviously a major limitation of this approach. As an alternative way to mitigate the problem, all the measurements which have already been processed can be stored in memory. Then, if old information subsequently becomes available, the estimation process can be run backwards in time to the time-of-applicability of this newly-acquired but old information, the old information can be incorporated (or erroneous data can be removed), and the estimation process can then be run forward in time again. The disadvantages of this approach are that it requires the storage of a relatively large number of measurements, in case the process needs to be run in reverse, and it creates bursts of CPU activity.</p><p id="p0012" num="0012"><patcit id="pcit0001" dnum="US20110004404A"><text>US Patent Application 2011/0004404</text></patcit> discloses a technique that addresses only the problem of processing erroneous ZUPTs in an inertial navigation system. In this technique, multiple Kalman filters are executed, with different filters having processed, or not processed, ZUPTs at different times in the recent past. If it subsequently becomes apparent that a ZUPT processed by the primary filter was actually incorrect, the system can switch to one of the filters that did not process the erroneous ZUPT.</p><p id="p0013" num="0013">According to the present invention, there is provided a method of performing a sequential estimation, the method comprising, at each iteration:
<ul><li>propagating a first state estimate into a state prediction,</li><li>wherein the first state estimate is valid at a first time and comprises estimated values of a plurality of state parameters, the plurality of state parameters including at least one state parameter referring to a time earlier than the first time; and</li><li>forming a second state estimate, by updating the state prediction using state measurements,</li><li>wherein the second state estimate is valid at a second time and comprises estimated values of said plurality of state parameters, the plurality of state parameters including at least one state parameter referring to a time earlier than the second time, and</li></ul>
wherein the state measurements comprise:
<ul><li>measurements relating to state parameters at the second time; and</li><li>measurements relating to state parameters at the time earlier than the second time.</li></ul><!-- EPO <DP n="4"> --></p><p id="p0014" num="0014">This has the advantage that the sequential estimation can then make use of information that only becomes available after a predictable latency, or of information that can be used to correct previously received information.</p><p id="p0015" num="0015">According to other aspects of the invention, there are provided an estimation system, and a computer program product for performing the method.</p><heading id="h0001"><u>Brief description of drawinas</u></heading><p id="p0016" num="0016"><ul><li><figref idrefs="f0001">Figure 1</figref> is a block schematic diagram of a navigation system according to an aspect of the invention.</li><li><figref idrefs="f0001">Figure 2</figref> is a flow chart, illustrating a method according to an aspect of the invention.</li><li><figref idrefs="f0002">Figure 3</figref> schematically illustrates the method of <figref idrefs="f0001">Figure 2</figref>.</li></ul></p><heading id="h0002"><b><u>Detailed description</u></b></heading><p id="p0017" num="0017">The invention relates to a method of sequential estimation, and to a system for performing such sequential estimation. In one embodiment, the sequential estimation is the sequential estimation of a position of a device. <figref idrefs="f0001">Figure 1</figref> shows a navigation system 10 as an example of a navigation system in accordance with an aspect of the present invention.</p><p id="p0018" num="0018">The navigation system 10 includes a position calculating unit 12. In this illustrative embodiment, the position calculating unit 12 receives input signals from a Global Navigation Satellite System (GNSS) receiver 14, connected to an antenna 16. The position calculating unit 12 also receives input signals from accelerometers 18 and gyroscopes 20. The position calculating unit 12 includes a sequential estimation unit 22 and a processor 24. An output from the position calculating unit 12 is supplied to a display device 26.</p><p id="p0019" num="0019">As is generally conventional, the position calculating unit 12 receives input signals from the GNSS receiver 14, accelerometers 18 and gyroscopes 20. These can be pre-processed if required, and are then supplied as inputs to the sequential estimation unit<!-- EPO <DP n="5"> --> 22, which performs a sequential estimation to generate an output signal representing the position of the device. The output signal is supplied to the display 26 where it can be seen by the user of the device.</p><p id="p0020" num="0020">In the case of a navigation system, the input signals can represent measured values relating to parameters such as the position, velocity and acceleration of the unit, which will of each course have a degree of uncertainty associated therewith, and the output signal can represent a current estimate of the position of the unit. The output signal might also represent the current velocity of the unit. In this illustrated example, the invention will be described with reference to a navigation system that is concerned with the position of the unit within a horizontal plane. However, in other examples, the system is concerned with the position of the unit in three-dimensional space.</p><p id="p0021" num="0021">As mentioned above, the use of the invention in a navigation system is only one embodiment of the invention. In other embodiments, the sequential estimation unit can receive input signals representing other variable parameters, and can then generate an output signal representing the value of the parameter whose value is to be estimated.</p><p id="p0022" num="0022"><figref idrefs="f0001">Figure 2</figref> is a flow chart, illustrating the method performed by the sequential estimation unit. As is conventional in sequential estimation, the method is performed in an iterative fashion, and <figref idrefs="f0001">Figure 2</figref> illustrates the steps performed in one iteration.</p><p id="p0023" num="0023"><figref idrefs="f0002">Figure 3</figref> is a schematic representation of the method.</p><p id="p0024" num="0024">The method is related to a standard Kalman filter, or other sequential estimation techniques, including Extended Kalman filters, Unscented Kalman filters and Information filters. In a standard Kalman filter the state of the system is represented by a vector of variables describing the current state of the system. The Kalman filter is then essentially a predictor-corrector algorithm. The equations which constitute the filter are of two types, namely the prediction, or time update, equations and the corrector, or measurement update, equations. From the estimate of the state at time (i), the Kalman filter first predicts the state at time (i+1) by using a dynamic model of the system, and then corrects, or updates, this estimate by using measurements relating to time (i+1) or, more generally, relating to the interval (i) to (i+1). After each prediction-correction step, the process is repeated. That is, the algorithm works recursively.<!-- EPO <DP n="6"> --></p><p id="p0025" num="0025">By contrast, in the present invention the state vector relates not only to the current state of the system but also to the state, or partial state, of the system at one or more previous update times. That is, some or all of the variables are included in the state vector multiple times, with values relating to the current time and to a number of previous, or historical, times. The prediction step can be thought of as consisting of two parts. In one part, some or all of the variables are propagated forward in time, whereas in the other part some of the variables are simply carried forward (i.e. without being changed). The correction step can also be thought of as consisting of two parts. In one part, the measurements or other information relating to the current state time are used to update the filter (i.e. with this part essentially being the same as in a standard Kalman filter). In the other part, measurements or other information relating to an earlier state time can be removed or added to the filter.</p><p id="p0026" num="0026">Thus, at time <i>(i)</i>, the current estimate of the state vector 50 has been obtained from a previous iteration. As shown in <figref idrefs="f0002">Figure 3</figref>, in this embodiment of the invention, the current state vector 50 contains an estimate of the state of the system, i.e. estimates of the current values of certain parameters. The parameters may include a first set of one or more parameters 52, and a second set of one or more parameters 54. Both of these sets of parameters 52, 54 are estimates of the current values of the respective parameters, and thus have the current time i as their time of applicability (toa).</p><p id="p0027" num="0027">As shown in <figref idrefs="f0002">Figure 3</figref>, the current estimate of the state vector also contains estimates of the historic values of certain parameters, namely the parameters of the second set. Specifically, the values making up the current estimate of the state vector include parameters 56 that are estimates of the values of the respective parameters during the immediately preceding iteration, and thus have the time <i>(i - 1)</i> as their time of applicability (toa). In addition, the values making up the current estimate of the state vector include parameters 58 that are estimates of the values of the respective parameters during the iteration preceding that one, and thus have the time <i>(i - 2)</i> as their time of applicability (toa).</p><p id="p0028" num="0028">It is noted that it is not a requirement of the invention that the number of duplicated states is the same for all the historical update times. If we denote the number of current states (that is, the number of parameters in the first set plus the number of parameters in the second set) by <i>N(0)</i>, and the number of states from k updates previously by <i>N(k),</i><!-- EPO <DP n="7"> --> and if we have historical states at m update times, then the only requirements relating to the number of each type of state variable are: <maths id="math0001" num=""><math display="block"><mi>m</mi><mo>&gt;</mo><mn>0</mn></math><img id="ib0001" file="imgb0001.tif" wi="28" he="8" img-content="math" img-format="tif"/></maths> <maths id="math0002" num=""><math display="block"><mi mathvariant="italic">N</mi><mfenced><mn mathvariant="italic">0</mn></mfenced><mo>&gt;</mo><mn>0</mn></math><img id="ib0002" file="imgb0002.tif" wi="28" he="8" img-content="math" img-format="tif"/></maths> <maths id="math0003" num=""><math display="block"><mi mathvariant="italic">N</mi><mfenced><mi>k</mi></mfenced><mo>&gt;</mo><mn>0</mn><mspace width="2em"/><mi>for all</mi><mspace width="1em"/><mi>k</mi><mspace width="1em"/><mi>from</mi><mspace width="1em"/><mn>1..</mn><mo>⁢</mo><mi>m</mi></math><img id="ib0003" file="imgb0003.tif" wi="71" he="8" img-content="math" img-format="tif"/></maths> <maths id="math0004" num=""><math display="block"><mi mathvariant="italic">N</mi><mfenced><mi>k</mi></mfenced><mo>≥</mo><mi>N</mi><mo>⁢</mo><mfenced separators=""><mi mathvariant="italic">k</mi><mo>-</mo><mn mathvariant="italic">1</mn></mfenced><mspace width="2em"/><mi>for all</mi><mspace width="1em"/><mi>k</mi><mspace width="1em"/><mi>from</mi><mspace width="1em"/><mn>1..</mn><mo>⁢</mo><mi>m</mi></math><img id="ib0004" file="imgb0004.tif" wi="71" he="9" img-content="math" img-format="tif"/></maths></p><p id="p0029" num="0029">It is also noted that it is not a requirement that the state variables are ordered or grouped within the state vector in the way illustrated in <figref idrefs="f0002">Figure 3</figref>, that is, with those variables that are duplicated appearing last in the state vector. There are no requirements on the ordering or grouping of the state variables. It will be clear to anyone familiar with Kalman filter implementations, however, that the way in which the variables are ordered and grouped will have a significant effect on how efficiently the processing can be performed.</p><p id="p0030" num="0030">As shown at step 100 of <figref idrefs="f0001">Figure 2</figref>, the current estimate of the state of the system is propagated forwards in time, by means of a state transition matrix, to form a prediction of the state of the system in the next time period (i + 1).</p><p id="p0031" num="0031">The estimate of the state vector at the time i can be denoted: <maths id="math0005" num=""><math display="block"><mover><mi>X</mi><mo>^</mo></mover><mo>⁢</mo><msub><mi>ʹ</mi><mi>i</mi></msub></math><img id="ib0005" file="imgb0005.tif" wi="15" he="14" img-content="math" img-format="tif"/></maths></p><p id="p0032" num="0032">The uncertainty, or accuracy, of this estimate is expressed through its associated covariance matrix, denoted: <maths id="math0006" num=""><math display="block"><msub><mi>C</mi><mrow><mover><mi>X</mi><mo>^</mo></mover><mo>⁢</mo><msub><mi>ʹ</mi><mi>i</mi></msub></mrow></msub></math><img id="ib0006" file="imgb0006.tif" wi="19" he="12" img-content="math" img-format="tif"/></maths></p><p id="p0033" num="0033">The prediction of the state vector, and its associated covariance matrix, are thus given by: <maths id="math0007" num=""><math display="block"><msub><mover><mi>X</mi><mo>˜</mo></mover><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>M</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>•</mo><mover><mi>X</mi><mo>^</mo></mover><mo>⁢</mo><msub><mi>ʹ</mi><mi>i</mi></msub></math><img id="ib0007" file="imgb0007.tif" wi="45" he="12" img-content="math" img-format="tif"/></maths><br/>
and <maths id="math0008" num=""><math display="block"><msub><mi>C</mi><msub><mover><mi>X</mi><mo>˜</mo></mover><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></msub><mo>=</mo><msub><mi>M</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>•</mo><msub><mi>C</mi><mrow><mover><mi>X</mi><mo>^</mo></mover><mo>⁢</mo><msub><mi>ʹ</mi><mi>i</mi></msub></mrow></msub><mo>•</mo><msup><msub><mi>M</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mi>T</mi></msup><mo>+</mo><msub><mi>Q</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></math><img id="ib0008" file="imgb0008.tif" wi="78" he="14" img-content="math" img-format="tif"/></maths><br/>
where:<!-- EPO <DP n="8"> -->
<ul><li><i>M</i><sub><i>i</i>+1</sub> is the transition matrix, namely the functional model of how the state parameters vary in time, and</li><li><i>Q</i><sub><i>i</i>+1</sub> is the process noise covariance matrix, which reflects the accuracy of the above functional model.</li></ul></p><p id="p0034" num="0034">As regards the current values of the parameters of the first set 52 and the second set 54, the state transition matrix operates as in a conventional Kalman filter. That is, knowledge about the system dynamics is used to predict the respective values 62, 64 of those same parameters at the time (<i>i</i> + 1). For example, given estimates of the velocity and acceleration of a unit at time <i>i</i>, it is possible to predict a value for the velocity of the unit at time (<i>i</i> + 1).</p><p id="p0035" num="0035">The prediction 60 of the state vector at time (<i>i</i> + 1) also includes predicted values 66 for the parameters of the second set during the preceding iteration. That is, these parameters 66 in the prediction 60 at the time (<i>i</i> + 1) have the previous time <i>i</i> as their time of applicability (toa). The prediction 60 of the state vector at time (<i>i</i> + 1) also includes predicted values 68 for the parameters of the second set during the iteration before the immediately preceding iteration. That is, these parameters 68 in the prediction 60 at the time (<i>i</i> + 1) have the time (<i>i</i> - 1) as their time of applicability (toa). Thus, the operation of the state transition matrix is simply to set the parameter values 66 equal to the parameter values 54, and to set the parameter values 68 equal to the parameter values 56. The parameter values 58 in the estimate 50 are discarded.</p><p id="p0036" num="0036">Although the propagation forwards of the parameters of the second set is described here as being carried out by means of a state transition matrix, it will be apparent that the same result can be achieved in other mathematically equivalent ways, such as simply copying some values from the estimate 50 of the state vector at time i into the prediction 60 of the state vector at time (<i>i</i> + 1).</p><p id="p0037" num="0037">As shown at step 102 of <figref idrefs="f0001">Figure 2</figref>, the prediction of the state of the system at the time (<i>i</i> + 1) is then updated with current measurements, as shown by the arrow 70 in <figref idrefs="f0002">Figure 3</figref>, to form an intermediate estimate 72 of the state of the system at the time (<i>i</i> + 1). This updating is carried out in the same manner as in a conventional Kalman filter or the like, and thus is not described in detail. In summary, measurements are received from<!-- EPO <DP n="9"> --> the external devices such as the GNSS receiver 14, the accelerometers 18 and gyroscopes 20, though it is recognised that these measurements are inevitably subject to uncertainty.</p><p id="p0038" num="0038">These measurements are used to obtain values for the state parameters, with the measured parameters being related to the state parameters by means of an observation equation design matrix. Thus: <maths id="math0009" num=""><math display="block"><msub><mi>A</mi><mi>i</mi></msub><mo>⋅</mo><msub><mover><mi>x</mi><mo>‾</mo></mover><mi>i</mi></msub><mo>=</mo><msub><mi>b</mi><mi>i</mi></msub><mo>+</mo><msub><mi>v</mi><mi>i</mi></msub></math><img id="ib0009" file="imgb0009.tif" wi="36" he="9" img-content="math" img-format="tif"/></maths><br/>
Where:
<dl id="dl0001" compact="compact"><dt><i>A<sub>i</sub></i></dt><dd>is the design matrix.</dd><dt><i><o>x</o><sub>i</sub></i></dt><dd>is the true values of the state parameters</dd><dt><i>b<sub>i</sub></i></dt><dd>is the observed (or measured) value</dd><dt><i>v<sub>i</sub></i></dt><dd>is the measurement residual (or error).</dd></dl></p><p id="p0039" num="0039">The design matrix, then, relates the measured quantities with the (true values of the) state parameters (although the true values of the state parameters and the measurement errors can never be known exactly.)<br/>
We also specify the variance measurement error, which reflects the accuracy of the measurement:
<ul><li><img id="ib0010" file="imgb0010.tif" wi="8" he="10" img-content="character" img-format="tif" inline="yes"/> variance of the measurement error</li></ul></p><p id="p0040" num="0040">The measurement is added to the filter, to give a new estimate of the state vector and its associated covariance matrix, as follows: <maths id="math0010" num=""><math display="block"><msubsup><mover><mi>x</mi><mo>^</mo></mover><mi>i</mi><mi>ʹ</mi></msubsup><mo>=</mo><msub><mover><mi>x</mi><mo>˜</mo></mover><mi>i</mi></msub><mo>+</mo><msub><mi>G</mi><mi>i</mi></msub><mo>⋅</mo><mfenced separators=""><msub><mi>b</mi><mi>i</mi></msub><mo>-</mo><msub><mi>A</mi><mi>i</mi></msub><mo>⋅</mo><msub><mover><mi>x</mi><mo>˜</mo></mover><mi>i</mi></msub></mfenced></math><img id="ib0011" file="imgb0011.tif" wi="60" he="10" img-content="math" img-format="tif"/></maths> <maths id="math0011" num=""><math display="block"><msub><mi>C</mi><msubsup><mover><mi>x</mi><mo>^</mo></mover><mi>i</mi><mi>ʹ</mi></msubsup></msub><mo>=</mo><msub><mi>C</mi><msub><mover><mi>x</mi><mo>˜</mo></mover><mi>i</mi></msub></msub><mo>-</mo><msub><mi>G</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>A</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>C</mi><msub><mover><mi>x</mi><mo>˜</mo></mover><mi>i</mi></msub></msub></math><img id="ib0012" file="imgb0012.tif" wi="60" he="10" img-content="math" img-format="tif"/></maths><br/>
where the Gain Matrix G<sub>i</sub> is given by: <maths id="math0012" num=""><math display="block"><msub><mi>G</mi><mi>i</mi></msub><mo>=</mo><msub><mi>C</mi><msub><mover><mi>x</mi><mo>˜</mo></mover><mi>i</mi></msub></msub><mo>⋅</mo><msub><mi>A</mi><mi>i</mi></msub><mo>⋅</mo><msup><mfenced separators=""><mfrac><mn>1</mn><msubsup><mi>σ</mi><mi>i</mi><mn>2</mn></msubsup></mfrac><mo>+</mo><msub><mi>A</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>C</mi><msub><mover><mi>x</mi><mo>˜</mo></mover><mi>i</mi></msub></msub><mo>⋅</mo><msubsup><mi>A</mi><mi>i</mi><mi>T</mi></msubsup></mfenced><mrow><mo>-</mo><mn>1</mn></mrow></msup></math><img id="ib0013" file="imgb0013.tif" wi="88" he="25" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="10"> --></p><p id="p0041" num="0041">In the above, (b - Ax) is the difference between the measured value and the value predicted from the current estimate of the state vector. The Gain Matrix defines how much of this discrepancy is used to adjust the estimated state vector. That is, it defines how much the measurement is allowed to modify the estimated state parameters. For example, if we have a measurement which we think is of very high quality (i.e. it has a very small variance) then the Gain matrix will be "large", and the estimated state vector after having included the measurement will be driven by the measurement rather than the propagated value. Conversely, if we think the measurement is very low quality (i.e. it has a very large variance) then the Gain matrix will be "small", and the estimated state vector after having included the measurement will be very little different from that before including the measurement.</p><p id="p0042" num="0042">The algorithm outlined above is thus used to form intermediate estimates 74, 76 of the first and second sets of parameters, based on the predicted values 62, 64 that were obtained based on the previous estimates and the knowledge of the system dynamics, and based on the newly input measurements. Similarly, this algorithm generates intermediate estimates 78, 80 of the historical parameter values in the state vector.</p><p id="p0043" num="0043">If more than one current measurement is received, the updating described above can be performed multiple times. Equivalently, a suitable updating can be used to include multiple measurements.</p><p id="p0044" num="0044">At step 104 of <figref idrefs="f0001">Figure 2</figref>, the provisional estimate 72 is further updated based on newly input historical measurements. This applies when a measurement value only becomes available after its time of applicability. For example, calculation might be required in order to obtain a measurement value, or the measurement value might only be known with a sufficiently high degree of precision after a period of latency that allows for confirmation.</p><p id="p0045" num="0045">The same algorithm as described above with reference to step 102 is thus used to form new estimates 82, 84 of the first and second sets of parameters, based on the intermediate estimates 74, 76, and based on the newly input historical measurements. Similarly, this algorithm generates new estimates 86, 88 of the historical parameter values in the state vector.<!-- EPO <DP n="11"> --></p><p id="p0046" num="0046">If more than one historical measurement is received, the updating described above can be performed multiple times. Equivalently, a suitable updating can be used to include multiple measurements.</p><p id="p0047" num="0047">While reference is made here to updating the estimate based on newly received measurements, it will be apparent that the estimate can be similarly updated by removing previously received measurements, in an exactly analogous procedure.</p><p id="p0048" num="0048">Thus, as shown by the arrow 89 in <figref idrefs="f0002">Figure 3</figref>, a new estimate 90 of the state of the system at the time (i + 1) is formed from the intermediate estimate 72.</p><p id="p0049" num="0049">Updating the filter with a measurement, whether the measurement is current or historical, and whether the measurement is being added or removed, will, in general, affect the current estimate of all the states, both current and historical.</p><p id="p0050" num="0050">Although steps 102 and 104 are shown separately here, it will be understood that there is no requirement to add the newly input current measurements before the newly input historical measurements. The newly input historical measurements can be added before the newly input current measurements, or the individual newly input historical measurements and newly input current measurements can be added in any convenient order.</p><p id="p0051" num="0051">There is therefore obtained an estimate 90 of the state vector at the time (i + 1), made up of the estimate of the state of the system comprising the estimates 74, 76 of the values of the parameters of the first and second sets, plus the updated historical values 82, 84.</p><p id="p0052" num="0052">As shown at step 106 of <figref idrefs="f0001">Figure 2</figref>, this estimate 90, and in particular the estimates 74, 76 of the values of the parameters of the first and second sets, can then be used as the output of the system, as shown at step 108 of <figref idrefs="f0001">Figure 2</figref>.</p><p id="p0053" num="0053">As described above, the process then proceeds to the next iteration, with the estimate 90 being used as the basis for forming the prediction of the state of the system at the next time (<i>i</i> + 2).<!-- EPO <DP n="12"> --></p><p id="p0054" num="0054">The invention will now be illustrated in more detail with reference to a first example implementation, which relates to a Global Positioning System (GPS) or other GNSS navigation system, in which it is desired to use Zero Velocity Updates (ZUPT) in order to improve the accuracy of the estimation of the GPS receiver's oscillator frequency offset.</p><p id="p0055" num="0055">In some inertial navigation systems, a ZUPT occurs at a time when the user is stationary (usually deliberately so). The fact that the unit is stationary means that the specific force sensed by the accelerometers is due solely to gravity, and the true output of the gyroscopes is due solely to earth rotation. This information allows the performance of the navigation system to be improved. Even for non-inertial systems, the knowledge that the user is stationary is often beneficial for the system performance. For example, in difficult GNSS environments the knowledge that the user is stationary can be used to improve the accuracy of the estimate of the oscillator frequency offset, which can result in improved navigation performance.</p><p id="p0056" num="0056">In automotive navigation systems intended for mass market use, it is not acceptable to require the introduction of deliberate periods during which the user is stationary. Hence, in order to get the best possible performance from the system, use of natural or opportunistic periods of being stationary, such as when the vehicle is waiting at traffic lights, is highly beneficial. Clearly, then, it is important that these natural periods of being stationary can be detected. It is common for the output of accelerometers and gyroscopes to be used to detect such stationary periods. Techniques for detecting when the user is stationary usually rely on the use of some sort of threshold test. Clearly, two forms of mistake can be made in such cases. One form of mistake is where the user actually was stationary but the algorithm failed to recognise this fact. The other is where the user was actually in motion but the algorithm identified this as being a stationary period. In the former case, the performance of the system will be lower than it could have been because not all possible information was utilised. In the latter case, incorrect information has been processed, which will degrade the performance of the system.</p><p id="p0057" num="0057">The performance of the stationary detection algorithm is compromised by the presence of vehicle vibrations (e.g. vibrations from the engine, air conditioning unit, and audio-system speakers). The detection of when the vehicle was, and was not, stationary can often be achieved more reliably if a latency of a few seconds is introduced into the<!-- EPO <DP n="13"> --> system. That is, the motion state can be more reliably determined some time after the event, since it can make use of data which is forward in time of the period under consideration. The use of such delayed information is usually not possible in a standard sequential estimation process.</p><p id="p0058" num="0058">In this particular example, we assume that the reliable detection of a ZUPT might require a latency of up to 4 seconds, whereas the measurement updates occur once every second. In this case, the complete state vector (i.e. including both current and historical states) is assumed to consist of the following twenty parameters, that is, eight current state variables, three of which are repeated over four iterations:
<dl id="dl0002"><dt><i>E</i></dt><dd>which is the Easting at the current update</dd><dt><i>N</i></dt><dd>which is the Northing at the current update</dd><dt><i>A</i></dt><dd>which is the Altitude at the current update</dd><dt><i>B</i></dt><dd>which is the GPS receiver clock bias at the current update</dd><dt><i>F</i></dt><dd>which is the GPS receiver clock frequency offset at the current update</dd><dt><i>SE</i></dt><dd>which is the Easting Speed at the current update</dd><dt><i>SN</i></dt><dd>which is the Northing Speed at the current update</dd><dt><i>SA</i></dt><dd>which is the Altitude Speed at the current update</dd><dt><i>SE</i><sub>-1</sub></dt><dd>which is the Easting Speed one second previously</dd><dt><i>SN</i><sub>-1</sub></dt><dd>which is the Northing Speed one second previously</dd><dt><i>SA</i><sub>-1</sub></dt><dd>which is the Altitude Speed one second previously</dd><dt><i>SE</i><sub>-2</sub></dt><dd>which is the Easting Speed 2 seconds previously</dd><dt><i>SN</i><sub>-2</sub></dt><dd>which is the Northing Speed 2 seconds previously</dd><dt><i>SA</i><sub>-2</sub></dt><dd>which is the Altitude Speed 2 seconds previously</dd><dt><i>SE</i><sub>-3</sub></dt><dd>which is the Easting Speed 3 seconds previously</dd><dt><i>SN</i><sub>-3</sub></dt><dd>which is the Northing Speed 3 seconds previously</dd><dt><i>SA</i><sub>-3</sub></dt><dd>which is the Altitude Speed 3 seconds previously</dd><dt><i>SE</i><sub>-4</sub></dt><dd>which is the Easting Speed 4 seconds previously</dd><dt><i>SN</i><sub>-4</sub></dt><dd>which is the Northing Speed 4 seconds previously</dd><dt><i>SA</i><sub>-4</sub></dt><dd>which is the Altitude Speed 4 seconds previously</dd></dl><!-- EPO <DP n="14"> --></p><p id="p0059" num="0059">In a standard Kalman filter implementation in this example, the state vector would consist of just the first 8 parameters, that is, just the current state variables. If we denote the (8x8) state transition matrix in the standard case by <i>S</i>, and we partition this matrix as: <maths id="math0013" num=""><math display="block"><mi>S</mi><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><msub><mi>S</mi><mn>55</mn></msub></mtd><mtd><msub><mi>S</mi><mn>53</mn></msub></mtd></mtr><mtr><mtd><msub><mi>S</mi><mn>35</mn></msub></mtd><mtd><msub><mi>S</mi><mn>33</mn></msub></mtd></mtr></mtable></mfenced></math><img id="ib0014" file="imgb0014.tif" wi="35" he="19" img-content="math" img-format="tif"/></maths><br/>
then the (20x20) state transition matrix for the modified filter, which we denote by P, may be written as follows, where / denotes a (3x3) identity matrix and 0 a null matrix: <maths id="math0014" num=""><math display="block"><mi>P</mi><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><msub><mi>S</mi><mn>55</mn></msub></mtd><mtd><msub><mi>S</mi><mn>53</mn></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><msub><mi>S</mi><mn>35</mn></msub></mtd><mtd><msub><mi>S</mi><mn>33</mn></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mi>I</mi></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi>I</mi></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi>I</mi></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi>I</mi></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mfenced><mn>.</mn></math><img id="ib0015" file="imgb0015.tif" wi="67" he="49" img-content="math" img-format="tif"/></maths></p><p id="p0060" num="0060">Clearly, compared with the standard transition matrix, the modified transition matrix is extremely sparse. Furthermore, all the additional non-zero elements are unity. This means that matrix multiplication and other mathematical operations and manipulations can be performed much more efficiently than by simple element-by-element multiplication or operation. For example, multiplication of the state vector and associated covariance matrix by the modified transition matrix can be achieved simply by copying elements, or blocks of elements, from one memory location to another, rather than by actually performing any direct multiplication operations.</p><p id="p0061" num="0061">In this example, the three state variables that are repeated from previous iterations appear as the last three of the eight current state variables, but this is not a requirement. However, there is an advantage in ordering the state variables in such a way that the transition matrix allows the most efficient processing and memory resource requirements.</p><p id="p0062" num="0062">Thus, in this example, if, at a particular measurement update time, it becomes known that the user had been stationary a few seconds previously (say, 3 seconds, in this<!-- EPO <DP n="15"> --> example), then this allows for that information to be added to the filter retrospectively. This can be achieved by adding a set of three 'pseudo-observations' to the filter, either before, after or at the same time as the measurement update, constraining, or limiting, the speed 3 seconds previously to zero in all three axes. In this example, the observation equation design matrix, describing the relationship between the measured parameters and the state parameters, would be: <maths id="math0015" num=""><math display="block"><mi>A</mi><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mfenced></math><img id="ib0016" file="imgb0016.tif" wi="131" he="25" img-content="math" img-format="tif"/></maths></p><p id="p0063" num="0063">A very similar example can be given for a system incorporating some elements of an inertial measurement unit (IMU). The only difference in this case would be the exact definition of the state variables.</p><p id="p0064" num="0064">There are also many situations in which information that does not cause any significant concern as to its validity is added to the filter, but which is actually erroneous. In such cases, whether or not information was actually valid can be determined more reliably and powerfully some time after the fact. The current invention provides a means whereby information which was thought to be valid at its time of applicability can be removed from the filter, in a rigorous fashion, if it is subsequently identified as having been invalid. Of course, this does not alter the fact that the erroneous data would have had a detrimental effect on the system performance during the time that it was included in the filter, but the important point is that that degradation can be halted immediately and cleanly.</p><p id="p0065" num="0065">A second example of the invention thus relates to a GNSS navigation system in which the filter had been updated with a Doppler measurement 2 seconds previously which now is believed to have been erroneous.</p><p id="p0066" num="0066">In order to allow the replacement of erroneous data received up to 2 seconds previously, when the measurement updates occur once every second, the complete state vector (i.e. including both current and historical states) consists of the following sixteen parameters, that is, eight current state variables, four of which are repeated over two iterations:
<dl id="dl0003"><dt><i>E</i></dt><dd>which is the Easting at the current update<!-- EPO <DP n="16"> --></dd><dt><i>N</i></dt><dd>which is the Northing at the current update</dd><dt><i>A</i></dt><dd>which is the Altitude at the current update</dd><dt><i>B</i></dt><dd>which is the GPS receiver clock bias at the current update</dd><dt><i>F</i></dt><dd>which is the GPS receiver clock frequency offset at the current update</dd><dt><i>SE</i></dt><dd>which is the Easting Speed at the current update</dd><dt><i>SN</i></dt><dd>which is the Northing Speed at the current update</dd><dt><i>SA</i></dt><dd>which is the Altitude Speed at the current update</dd><dt><i>F</i><sub>-1</sub></dt><dd>which is the GPS receiver clock frequency offset one second previously</dd><dt><i>SE</i><sub>-1</sub></dt><dd>which is the Easting Speed one second previously</dd><dt><i>SN</i><sub>-1</sub></dt><dd>which is the Northing Speed one second previously</dd><dt><i>SA</i><sub><i>-</i>1</sub></dt><dd>which is the Altitude Speed one second previously</dd><dt><i>F</i><sub>-2</sub></dt><dd>which is the GPS receiver clock frequency offset 2 seconds previously</dd><dt><i>SE</i><sub>-2</sub></dt><dd>which is the Easting Speed 2 seconds previously</dd><dt><i>SN</i><sub>-2</sub></dt><dd>which is the Northing Speed 2 seconds previously</dd><dt><i>SA</i><sub>-2</sub></dt><dd>which is the Altitude Speed 2 seconds previously</dd></dl></p><p id="p0067" num="0067">The observation equation design matrix for the measurement in question at the time it was added to the filter is denoted by: <maths id="math0016" num=""><math display="block"><msubsup><mi>A</mi><mi>i</mi><mi>o</mi></msubsup><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><msubsup><mi>a</mi><mi mathvariant="italic">Ei</mi><mi>o</mi></msubsup></mtd><mtd><msubsup><mi>a</mi><mi mathvariant="italic">Ni</mi><mi>o</mi></msubsup></mtd><mtd><msubsup><mi>a</mi><mi mathvariant="italic">Ai</mi><mi>o</mi></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mfenced></math><img id="ib0017" file="imgb0017.tif" wi="119" he="9" img-content="math" img-format="tif"/></maths><br/>
The corresponding weight of the observation is denoted<img id="ib0018" file="imgb0018.tif" wi="12" he="8" img-content="character" img-format="tif" inline="yes"/></p><p id="p0068" num="0068">If now, 2 seconds after the measurement had been added to the filter, it is believed that the measurement was erroneous and it is required to remove its effect, then this can be achieved by adding [sic] a measurement to the filter with the following observation equation design matrix and corresponding weight: <maths id="math0017" num=""><math display="block"><mi>A</mi><mo>=</mo><mo>⌊</mo><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><msubsup><mi>a</mi><mi mathvariant="italic">Ei</mi><mi>o</mi></msubsup></mtd><mtd><msubsup><mi>a</mi><mi mathvariant="italic">Ni</mi><mi>o</mi></msubsup></mtd><mtd><msubsup><mi>a</mi><mi mathvariant="italic">Ai</mi><mi>o</mi></msubsup></mtd></mtr></mtable><mo>⌋</mo></math><img id="ib0019" file="imgb0019.tif" wi="118" he="12" img-content="math" img-format="tif"/></maths> <maths id="math0018" num=""><math display="block"><mi>W</mi><mo>=</mo><mo>-</mo><msubsup><mi>W</mi><mi>i</mi><mi>o</mi></msubsup><mn>.</mn></math><img id="ib0020" file="imgb0020.tif" wi="29" he="12" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="17"> --></p><p id="p0069" num="0069">A third example implementation of the invention relates for example to a heading filter using both GNSS and gyroscope measurements. Typically, for mass-market real-time navigation devices, the navigation update interval is one second. For systems which attempt to make use of measurements from accelerometer or gyroscope sensors, the measurement interval can be of the order of 10 ms or less. In principle, it would be possible to perform the sequential estimation at 100 Hz or faster, and for the state vector to be augmented with so-called nuisance variables to model better the effect of various factors which influence the output of the sensors (such as engine vibrations and road noise, for example). For high-end systems, such an approach would be desirable, but for low-cost, mass-market systems this approach would probably be prohibitive in terms of the processing and memory resource requirements of the device and because the low-cost sensors used in such devices would probably be insufficiently robust in terms of the navigation performance of the system.</p><p id="p0070" num="0070">Usually, therefore, measurements which are available at relatively high rate are often pre-processed before being used in the primary filter, with the actual measurements used to update the filter (typically at 1 Hz) being derived from the higher-rate raw measurements. In this case, it is often the case that the quality of the derived measurements available in, or close to, real-time is lower than the quality that can be obtained by delaying the generation of the derived measurements by a short time. The present invention provides a method whereby it is possible to make maximum use of information as and when it becomes available. That is, different, higher quality, versions of the same derived measurement can be added to the filter in a rigorous fashion, so that the amount of information available from the measurement is, in effect, increased incrementally. Hence, the current invention in effect allows some of the benefits of the high-end approach to be achieved, but without the same level of cost in terms of processing and memory resource requirements and reduced robustness.</p><p id="p0071" num="0071">Thus, in this example, the raw gyroscope measurements are pre-processed, in order to derive measurements which can be used to update the filter at 1 Hz and which can be considered to relate to the horizontal plane. Each gyroscope derived measurement is available in two versions: a first in (close to) real-time, which is of relatively low quality, and a second, which is of higher quality but which only becomes available with a one-second delay. Thus, in this example the state vector includes 2 seconds of history, and the complete state vector (i.e. including both current and historical states) consists of<!-- EPO <DP n="18"> --> the following nine parameters, that is, five current state variables, two of which are repeated over two iterations:
<dl id="dl0004" compact="compact"><dt><i>F</i></dt><dd>which is the GNSS receiver clock frequency offset at the current update</dd><dt><i>H</i></dt><dd>which is the Heading at the current update</dd><dt><i>S</i></dt><dd>which is the forward Speed at the current update</dd><dt><i>SA</i></dt><dd>which is the Altitude Speed at the current update</dd><dt><i>G</i></dt><dd>which is the gyroscope offset at the current update</dd><dt><i>H</i><sub>-1</sub></dt><dd>which is the Heading one second previously</dd><dt><i>G</i><sub>-1</sub></dt><dd>which is the gyroscope offset one second previously</dd><dt><i>H</i><sub>-2</sub></dt><dd>which is the Heading one second previously</dd><dt><i>G</i><sub>-2</sub></dt><dd>which is the gyroscope offset one second previously</dd></dl></p><p id="p0072" num="0072">If, at time <i>t(i)</i>, we have a derived gyroscope measurement available, which is a biased measurement of the change in heading over the one-second period just ended, we can write the full observation equation as: <maths id="math0019" num=""><math display="block"><msup><mi>A</mi><mn>1</mn></msup><mo>⋅</mo><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>b</mi><mi>i</mi><mn>1</mn></msubsup><mo>+</mo><msubsup><mi>v</mi><mi>i</mi><mn>1</mn></msubsup></math><img id="ib0021" file="imgb0021.tif" wi="35" he="10" img-content="math" img-format="tif"/></maths><br/>
where<br/>
<i>A</i><sup>1</sup>  is the design matrix, given by:<br/>
<i>A</i><sup>1</sup>  = [0 1 0 0 1 -1 0 0 0]<br/>
<i>x<sub>i</sub></i>  is the state vector at the current time, i.e. at time <i>t(i)</i><br/>
<img id="ib0022" file="imgb0022.tif" wi="7" he="9" img-content="character" img-format="tif" inline="yes"/>   is the gyroscope measurement<br/>
<img id="ib0023" file="imgb0023.tif" wi="8" he="8" img-content="character" img-format="tif" inline="yes"/>   is the gyroscope measurement residual with a corresponding measurement weight denoted<img id="ib0024" file="imgb0024.tif" wi="9" he="9" img-content="character" img-format="tif" inline="yes"/></p><p id="p0073" num="0073">This is the measurement that would be used to update the filter at the current time. At the next measurement update, i.e. at time <i>t(i+1)</i>, 1 second later, we not only have another derived gyroscope measurement available which is a biased measurement of the change in heading over the one-second period just ended, but we also have an improved version of the measurement we added to the filter at the previous update. The invention now allows us to update the filter with the new, current, measurement<!-- EPO <DP n="19"> --> and also with the new, improved but delayed, measurement. One way of denoting the process to achieve this (but which can be implemented more efficiently in practice) is to add the following three measurements to the filter at the current update time <i>t(i+1)</i>: <maths id="math0020" num=""><math display="block"><msup><mi>A</mi><mn>1</mn></msup><mo>⋅</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msubsup><mi>b</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mo>+</mo><msubsup><mi>v</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mn>1</mn></msubsup><mspace width="1em"/><mi>with weight</mi><mspace width="1em"/><msubsup><mi>W</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mn>1</mn></msubsup></math><img id="ib0025" file="imgb0025.tif" wi="83" he="13" img-content="math" img-format="tif"/></maths> <maths id="math0021" num=""><math display="block"><msup><mi>A</mi><mn>2</mn></msup><mo>⋅</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msubsup><mi>b</mi><mi>i</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>v</mi><mi>i</mi><mn>2</mn></msubsup><mspace width="1em"/><mi>with weight</mi><mspace width="1em"/><msubsup><mi>W</mi><mi>i</mi><mn>2</mn></msubsup></math><img id="ib0026" file="imgb0026.tif" wi="83" he="10" img-content="math" img-format="tif"/></maths> <maths id="math0022" num=""><math display="block"><msup><mi>A</mi><mn>2</mn></msup><mo>⋅</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msubsup><mi>b</mi><mi>i</mi><mn>1</mn></msubsup><mo>+</mo><msubsup><mi mathvariant="italic">vʹ</mi><mi>i</mi><mn>1</mn></msubsup><mspace width="1em"/><mi>with weight</mi><mspace width="1em"/><mo>-</mo><msubsup><mi>W</mi><mi>i</mi><mn>1</mn></msubsup></math><img id="ib0027" file="imgb0027.tif" wi="83" he="10" img-content="math" img-format="tif"/></maths><br/>
where<br/>
<i>A</i><sup>2</sup>  is the design matrix relating to the 'old' measurements, given by:<br/>
<i>A</i><sup>2</sup>  = [0 0 0 0 0 1 1 -1 0]<br/>
<i>x</i><sub><i>i</i>+1</sub>  is the state vector at the current time (i.e. at time <i>t[i+1]</i>)<br/>
<img id="ib0028" file="imgb0028.tif" wi="8" he="8" img-content="character" img-format="tif" inline="yes"/>   is the current gyroscope measurement<br/>
<img id="ib0029" file="imgb0029.tif" wi="7" he="9" img-content="character" img-format="tif" inline="yes"/>   is the improved gyroscope measurement relating to the previous update.</p><p id="p0074" num="0074">That is, the first measurement above is the addition of the first version of the gyroscope measurement relating to the one-second period just ended, the second measurement is the addition of the improved version of the gyroscope measurement relating to the previous one-second period, and the third measurement is the removal of the first version measurement relating to the previous one-second period which was added at the previous update but which has now been superseded.</p><p id="p0075" num="0075">Another example of this situation is in the case of a GNSS application in an urban environment, where problems can be caused by the effect of satellite signals being reflected off nearby buildings. Clearly, if a signal is received after being reflected, then the measured or derived distance between the user and the satellite will be longer than the true distance. In some cases, the fact that a signal was reflected only becomes apparent some seconds after the event. Often, this is too late, in that the bad measurement has already been included in the system, and the state has already been propagated forward in time. Thus, as above, the inaccurate measurement can be removed and the more accurate measurement can be inserted when the inaccuracy becomes apparent.</p><p id="p0076" num="0076">A further use of the present invention allows the inclusion, in a rigorous manner, of measurements that relate to a difference in the state of the system over a period of<!-- EPO <DP n="20"> --> time which is significant compared to the update interval of the filter. Similarly, it allows measurements which cannot be considered to be instantaneous to be added to the filter in a way which can improve accuracy. In the case of a GNSS system, examples of such measurements include "delta range" measurements derived by taking the difference between the carrier phase measurements at two epochs (typically 1 second apart). Other examples include biased measurements of changes in heading derived from gyroscope measurements, and Doppler measurements from attenuated signals which have been obtained by integrating the signals over time periods that are significant relative to the length of one epoch, such that the measurements are best considered as relating to some sort of average state between two or more epochs.</p><p id="p0077" num="0077">Thus the invention can be further illustrated by a fourth example implementation relating to a filter similar to those described above, but where we are concerned with the use of GNSS Doppler measurements which might be regarded as "smeared" over time, rather than being considered always as relating to an instant of time. In this example, the complete state vector (i.e. including both current and historical states) consists of the following ten parameters that is, five current state variables, all of which are repeated over one iteration:
<dl id="dl0005"><dt><i>F</i></dt><dd>which is the GNSS receiver clock frequency offset at the current update</dd><dt><i>H</i></dt><dd>which is the Heading at the current update</dd><dt><i>S</i></dt><dd>which is the forward Speed at the current update</dd><dt><i>SA</i></dt><dd>which is the Altitude Speed at the current update</dd><dt><i>G</i></dt><dd>which is the gyroscope offset at the current update</dd><dt><i>F</i><sub>-1</sub></dt><dd>which is the GNSS receiver clock frequency offset one second previously</dd><dt><i>H</i><sub>-1</sub></dt><dd>which is the Heading one second previously</dd><dt><i>S</i><sub>-1</sub></dt><dd>which is the forward Speed one second previously</dd><dt><i>SA</i><sub>-1</sub></dt><dd>which is the Altitude Speed one second previously</dd><dt><i>G</i><sub>-1</sub></dt><dd>which is the gyroscope offset one second previously</dd></dl></p><p id="p0078" num="0078">If we can consider the measurement as being instantaneous, we might write the observation equation design matrix in the form: <maths id="math0023" num=""><math display="block"><mi>A</mi><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><mn>1</mn></mtd><mtd><msub><mi>a</mi><mi>H</mi></msub></mtd><mtd><msub><mi>a</mi><mi>S</mi></msub></mtd><mtd><msub><mi>a</mi><mi>A</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mfenced></math><img id="ib0030" file="imgb0030.tif" wi="83" he="12" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="21"> --></p><p id="p0079" num="0079">However, if, for example, the GNSS Doppler measurement has been achieved by integrating the GNSS signal over an appreciable period of time, such that it is better considered as being a measurement of some sort of average state of the system over a preceding period, rather than as being a measurement of some elements of the current, instantaneous state, then this invention allows us to write the observation equation design matrix in the form: <maths id="math0024" num=""><math display="block"><mi>A</mi><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><mfenced separators=""><mn>1</mn><mo>-</mo><mi>k</mi></mfenced></mtd><mtd><mfenced separators=""><mn>1</mn><mo>-</mo><mi>k</mi></mfenced><mo>⋅</mo><msub><mi>a</mi><mi>H</mi></msub></mtd><mtd><mfenced separators=""><mn>1</mn><mo>-</mo><mi>k</mi></mfenced><mo>⋅</mo><msub><mi>a</mi><mi>S</mi></msub></mtd><mtd><mfenced separators=""><mn>1</mn><mo>-</mo><mi>k</mi></mfenced><mo>⋅</mo><msub><mi>a</mi><mi>A</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><mi>k</mi></mtd><mtd><mi>k</mi><mo>⋅</mo><msubsup><mi>a</mi><mi>H</mi><mi>ʹ</mi></msubsup></mtd><mtd><mi>k</mi><mo>⋅</mo><msubsup><mi>a</mi><mi>S</mi><mi>ʹ</mi></msubsup></mtd><mtd><mi>k</mi><mo>⋅</mo><msubsup><mi>a</mi><mi>A</mi><mi>ʹ</mi></msubsup></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mfenced></math><img id="ib0031" file="imgb0031.tif" wi="144" he="14" img-content="math" img-format="tif"/></maths></p><p id="p0080" num="0080">Typically, but not necessarily, k would be in the range 0 to 1.</p><p id="p0081" num="0081">There are two special cases that we note. Clearly, k = 0 relates to the standard case, where the measurement is an instantaneous measurement of elements of the current state). Equally clearly, k = 1 relates to a special case, where the measurement is an instantaneous measurement of elements of the state at the previous update time (that is, each measurement is a delayed measurement of the form described above).</p><p id="p0082" num="0082">In general, this form of implementation allows us to make use of measurements which are smeared over time. For example, if, in this case, we had a GNSS Doppler measurement which was best considered as being some sort of average value over the preceding one-second update interval, then the observation equation design matrix would be: <maths id="math0025" num=""><math display="block"><mi>A</mi><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><mn>0.5</mn></mtd><mtd><mn>0.5</mn><mo>⋅</mo><msub><mi>a</mi><mi>H</mi></msub></mtd><mtd><mn>0.5</mn><mo>⋅</mo><msub><mi>a</mi><mi>S</mi></msub></mtd><mtd><mn>0.5</mn><mo>⋅</mo><msub><mi>a</mi><mi>A</mi></msub></mtd><mtd><mn>0</mn></mtd><mtd><mn>0.5</mn></mtd><mtd><mn>0.5</mn><mo>⋅</mo><msubsup><mi>a</mi><mi>H</mi><mi>ʹ</mi></msubsup></mtd><mtd><mn>0.5</mn><mo>⋅</mo><msubsup><mi>a</mi><mi>S</mi><mi>ʹ</mi></msubsup></mtd><mtd><mn>0.5</mn><mo>⋅</mo><msubsup><mi>a</mi><mi>A</mi><mi>ʹ</mi></msubsup></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mfenced></math><img id="ib0032" file="imgb0032.tif" wi="141" he="10" img-content="math" img-format="tif"/></maths></p><p id="p0083" num="0083">There is thus described a method of performing a sequential estimation.</p></description><claims mxw-id="PCLM56976633" lang="EN" load-source="patent-office"><!-- EPO <DP n="22"> --><claim id="c-en-0001" num="0001"><claim-text>A method of performing a sequential estimation, the method comprising, at each iteration:
<claim-text>propagating a first state estimate into a state prediction,</claim-text>
<claim-text>wherein the first state estimate is valid at a first time and comprises estimated values of a plurality of state parameters, the plurality of state parameters including at least one state parameter referring to a time earlier than the first time; and</claim-text>
<claim-text>forming a second state estimate, by updating the state prediction using state measurements,</claim-text>
<claim-text>wherein the second state estimate is valid at a second time and comprises estimated values of said plurality of state parameters, the plurality of state parameters including at least one state parameter referring to a time earlier than the second time, and</claim-text>
wherein the state measurements comprise:
<claim-text>measurements relating to state parameters at the second time; and</claim-text>
<claim-text>measurements relating to state parameters at the time earlier than the second time.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>A method as claimed in claim 1, comprising propagating the first state estimate into the state prediction by means of a state transition matrix.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>A method as claimed in claim 2, wherein the state transition matrix is such that, in the second state estimate, an estimated value of at least one state parameter referring to a time earlier than the second time is derived from an estimated value of a state parameter referring to the first time in the first state estimate.</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>A method as claimed in any preceding claim, wherein at least one state parameter in the state prediction is obtained by copying a value of a state parameter in the first state estimate.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>A method as claimed in any preceding claim, wherein the first state estimate comprises at least one respective state parameter referring to each of a plurality of times earlier than the first time.<!-- EPO <DP n="23"> --></claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>A method as claimed in any preceding claim, wherein the first state estimate comprises a number of state parameters referring to a time earlier than the first time that is smaller than the number of state parameters referring to the first time.</claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>A method as claimed in any preceding claim, wherein the measurements relating to state parameters at the time earlier than the second time comprise a measurement that can be obtained only with a latency.</claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>A method as claimed in any preceding claim, wherein the measurements relating to state parameters at the time earlier than the second time comprise a correction and replacement of a measurement previously used for updating the state prediction.</claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>A method as claimed in any preceding claim, wherein the measurements relating to state parameters at the time earlier than the second time comprise a refinement of a measurement previously used for updating the state prediction.</claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>A method as claimed in any preceding claim, wherein the measurements relating to state parameters at the time earlier than the second time comprise a measurement relating to a time period between the first time and the second time.</claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>A method as claimed in any preceding claim, comprising a method of positioning, wherein the state measurements are obtained from a GNSS system.</claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>A method as claimed in any preceding claim, comprising a method of inertial navigation, wherein the measurements relating to state parameters at the time earlier than the second time comprise Zero Velocity Updates.</claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>An estimation system, configured to perform a sequential estimation according to the method as claimed in any of claims 1 to 10.</claim-text></claim><claim id="c-en-0014" num="0014"><claim-text>An estimation system as claimed in claim 13, comprising a positioning system, configured to receive state measurements from a GNSS receiver.</claim-text></claim><claim id="c-en-0015" num="0015"><claim-text>A computer program product, comprising computer-readable instructions for performing the method as claimed in any of claims 1 to 12.</claim-text></claim></claims><drawings mxw-id="PDW16667411" load-source="patent-office"><!-- EPO <DP n="24"> --><figure id="f0001" num="1,2"><img id="if0001" file="imgf0001.tif" wi="165" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="25"> --><figure id="f0002" num="3"><img id="if0002" file="imgf0002.tif" wi="165" he="177" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="161" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="157" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
