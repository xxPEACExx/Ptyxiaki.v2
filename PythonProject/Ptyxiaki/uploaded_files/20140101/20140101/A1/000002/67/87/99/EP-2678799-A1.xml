<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2678799-A1" country="EP" doc-number="2678799" kind="A1" date="20140101" family-id="46719823" file-reference-id="307894" date-produced="20180826" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146551270" ucid="EP-2678799-A1"><document-id><country>EP</country><doc-number>2678799</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12712428-A" is-representative="NO"><document-id mxw-id="PAPP154825193" load-source="docdb" format="epo"><country>EP</country><doc-number>12712428</doc-number><kind>A</kind><date>20120224</date><lang>EN</lang></document-id><document-id mxw-id="PAPP186634478" load-source="docdb" format="original"><country>EP</country><doc-number>12712428.7</doc-number><date>20120224</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140453717" ucid="US-201161446779-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201161446779</doc-number><kind>P</kind><date>20110225</date></document-id></priority-claim><priority-claim mxw-id="PPC140452169" ucid="US-2012026588-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>2012026588</doc-number><kind>W</kind><date>20120224</date></document-id></priority-claim><priority-claim mxw-id="PPC140449149" ucid="US-201213403206-A" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201213403206</doc-number><kind>A</kind><date>20120223</date></document-id></priority-claim></priority-claims><technical-data><classification-ipc><edition>7</edition><main-classification>G06F  21/20</main-classification></classification-ipc><classifications-ipcr><classification-ipcr mxw-id="PCL1989312762" load-source="patent-office">G06F  21/20        00000000AFI20120914BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-2081670977" load-source="docdb" scheme="CPC">G06F2221/2153      20130101 LA20150326BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2081672025" load-source="docdb" scheme="CPC">G06F2221/2103      20130101 LA20150326BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2081674972" load-source="docdb" scheme="CPC">G06F  21/34        20130101 FI20150326BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132186294" lang="DE" load-source="patent-office">VERFAHREN UND VORRICHTUNG ZUR KODIERUNG UND DEKODIERUNG VON AN EINEN AUTHENTIFIZIERUNGSTOKEN ÜBERTRAGENEN DATEN</invention-title><invention-title mxw-id="PT132186295" lang="EN" load-source="patent-office">METHOD AND APPARATUS FOR ENCODING AND DECODING DATA TRANSMITTED TO AN AUTHENTICATION TOKEN</invention-title><invention-title mxw-id="PT132186296" lang="FR" load-source="patent-office">PROCÉDÉ ET APPAREIL PERMETTANT DE CODER ET DE DÉCODER DES DONNÉES TRANSMISES À UN JETON D'AUTHENTIFICATION</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR1161600030" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>VASCO DATA SECURITY INT GMBH</last-name><address><country>CH</country></address></addressbook></applicant><applicant mxw-id="PPAR918154423" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>VASCO DATA SECURITY INTERNATIONAL GMBH</last-name></addressbook></applicant><applicant mxw-id="PPAR918988665" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Vasco Data Security International GmbH</last-name><iid>101334845</iid><address><street>World-Wide Business Center Balsberg Balz-Zimmermannstrasse 7</street><city>8152 Glattbrugg</city><country>CH</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918145352" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>HOORNAERT FRANK</last-name><address><country>BE</country></address></addressbook></inventor><inventor mxw-id="PPAR918168403" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>HOORNAERT, FRANK</last-name></addressbook></inventor><inventor mxw-id="PPAR918990248" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>HOORNAERT, FRANK</last-name><address><street>Korbeekstraat 56</street><city>B-3061 Bertem</city><country>BE</country></address></addressbook></inventor><inventor mxw-id="PPAR918138708" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>MARIEN DIRK</last-name><address><country>BE</country></address></addressbook></inventor><inventor mxw-id="PPAR918156900" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>MARIEN, DIRK</last-name></addressbook></inventor><inventor mxw-id="PPAR918980546" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>MARIEN, DIRK</last-name><address><street>Broddestraat 9</street><city>B-2520 Ranst</city><country>BE</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918992947" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Beck, Michaël Andries T.</last-name><iid>101378998</iid><address><street>IPLodge bvba Technologielaan 9</street><city>3001 Heverlee</city><country>BE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="US-2012026588-W"><document-id><country>US</country><doc-number>2012026588</doc-number><kind>W</kind><date>20120224</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012116312-A1"><document-id><country>WO</country><doc-number>2012116312</doc-number><kind>A1</kind><date>20120830</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS548913921" load-source="docdb">AL</country><country mxw-id="DS548865578" load-source="docdb">AT</country><country mxw-id="DS548913922" load-source="docdb">BE</country><country mxw-id="DS548816060" load-source="docdb">BG</country><country mxw-id="DS548926933" load-source="docdb">CH</country><country mxw-id="DS548929204" load-source="docdb">CY</country><country mxw-id="DS548865579" load-source="docdb">CZ</country><country mxw-id="DS548913923" load-source="docdb">DE</country><country mxw-id="DS548929205" load-source="docdb">DK</country><country mxw-id="DS548929210" load-source="docdb">EE</country><country mxw-id="DS548837076" load-source="docdb">ES</country><country mxw-id="DS548816061" load-source="docdb">FI</country><country mxw-id="DS548934637" load-source="docdb">FR</country><country mxw-id="DS548913924" load-source="docdb">GB</country><country mxw-id="DS548929211" load-source="docdb">GR</country><country mxw-id="DS548913925" load-source="docdb">HR</country><country mxw-id="DS548865580" load-source="docdb">HU</country><country mxw-id="DS548926934" load-source="docdb">IE</country><country mxw-id="DS548929212" load-source="docdb">IS</country><country mxw-id="DS548934638" load-source="docdb">IT</country><country mxw-id="DS548929213" load-source="docdb">LI</country><country mxw-id="DS548816062" load-source="docdb">LT</country><country mxw-id="DS548930484" load-source="docdb">LU</country><country mxw-id="DS548816063" load-source="docdb">LV</country><country mxw-id="DS548816064" load-source="docdb">MC</country><country mxw-id="DS548930485" load-source="docdb">MK</country><country mxw-id="DS548930490" load-source="docdb">MT</country><country mxw-id="DS548865581" load-source="docdb">NL</country><country mxw-id="DS548913926" load-source="docdb">NO</country><country mxw-id="DS548929218" load-source="docdb">PL</country><country mxw-id="DS548816065" load-source="docdb">PT</country><country mxw-id="DS548865582" load-source="docdb">RO</country><country mxw-id="DS548816066" load-source="docdb">RS</country><country mxw-id="DS548929219" load-source="docdb">SE</country><country mxw-id="DS548934639" load-source="docdb">SI</country><country mxw-id="DS548913927" load-source="docdb">SK</country><country mxw-id="DS548929220" load-source="docdb">SM</country><country mxw-id="DS548930491" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA99619298" ref-ucid="WO-2012116312-A1" lang="EN" load-source="patent-office"><p num="0000">Methods and apparatus for encoding and decoding data transmitted acoustically and/or optically to strong authentication tokens to generate dynamic security values are disclosed. The tokens may also include a selection mechanism to select either an acoustical or an optical input interface to receive data. A communication interface may be provided to communicate with a removable security device such as a smart card and the token may be adapted to generate dynamic security values in cooperation with the removable security device.</p></abstract><abstract mxw-id="PA99818979" ref-ucid="WO-2012116312-A1" lang="EN" source="national office" load-source="docdb"><p>Methods and apparatus for encoding and decoding data transmitted acoustically and/or optically to strong authentication tokens to generate dynamic security values are disclosed. The tokens may also include a selection mechanism to select either an acoustical or an optical input interface to receive data. A communication interface may be provided to communicate with a removable security device such as a smart card and the token may be adapted to generate dynamic security values in cooperation with the removable security device.</p></abstract><abstract mxw-id="PA99619299" ref-ucid="WO-2012116312-A1" lang="FR" load-source="patent-office"><p num="0000">L'invention concerne des procédés et un appareil permettant de coder et de décoder des données transmises acoustiquement et/ou optiquement à des jetons d'authentification forte afin de générer des valeurs de sécurité dynamiques. Les jetons peuvent également comprendre un mécanisme de sélection destiné à sélectionner une interface d'entrée acoustique ou optique pour recevoir des données. Une interface de communication peut être fournie afin de communiquer avec un dispositif de sécurité amovible tel qu'une carte à puce, et le jeton peut être conçu pour générer des valeurs de sécurité dynamiques en coopération avec le dispositif de sécurité amovible.</p></abstract><abstract mxw-id="PA99818980" ref-ucid="WO-2012116312-A1" lang="FR" source="national office" load-source="docdb"><p>L'invention concerne des procédés et un appareil permettant de coder et de décoder des données transmises acoustiquement et/ou optiquement à des jetons d'authentification forte afin de générer des valeurs de sécurité dynamiques. Les jetons peuvent également comprendre un mécanisme de sélection destiné à sélectionner une interface d'entrée acoustique ou optique pour recevoir des données. Une interface de communication peut être fournie afin de communiquer avec un dispositif de sécurité amovible tel qu'une carte à puce, et le jeton peut être conçu pour générer des valeurs de sécurité dynamiques en coopération avec le dispositif de sécurité amovible.</p></abstract><description mxw-id="PDES50930193" ref-ucid="WO-2012116312-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="3"/>--><p id="p0001" num="0001"> Method and apparatus for encoding and decoding data transmitted to an authentication token. </p><p id="p0002" num="0002">Field of the invention </p><p id="p0003" num="0003"> [0001] The invention relates to strong authentication tokens for securing remote access to computers and applications and remote transactions over computer networks. More specifically, the invention relates to methods and apparatus for encoding and decoding data transmitted to strong authentication tokens that are adapted to acoustically or optically receive input data. </p><p id="p0004" num="0004"> Background of the invention </p><p id="p0005" num="0005"> [0002] As remote access of computer systems and applications grows in popularity, the number and variety of transactions which are accessed remotely over public networks such as the Internet has increased dramatically. This popularity has underlined a need for security; in particular: how to ensure that people who are remotely accessing an application are who they claim they are, how to ensure that transactions being conducted remotely are initiated by legitimate </p><p id="p0006" num="0006"> individuals, and how to ensure that transaction data has not been altered before being received at an application server. </p><p id="p0007" num="0007"> [0003] In the past, application providers have relied on static passwords to provide the security for remote applications. In recent years it has become evident that static passwords are not sufficient and that more advanced security technology is required. </p><p id="p0008" num="0008"> [0004] One way of solving the security problems associated with remote access to </p><p id="p0009" num="0009"> computer systems and applications over public networks is provided by a Public Key Infrastructure (PKI). Using a Public Key Infrastructure one associates a public-private key pair with each user. The key pair is associated with a certificate (issued by a trustworthy Certificate Authority) that binds that public- private key pair to a specific user. By means of asymmetric cryptography this public-private key pair can be used to authenticate the user, sign transactions, and set-up encrypted communications. </p><p id="p0010" num="0010"> [0005] To guarantee an adequate level of security it is mandatory that each user's </p><p id="p0011" num="0011"> private key remains secret and can only be accessed to create a signature or to decrypt a message by the legitimate user associated with that key. It is common to rely on a smart card or a dedicated Universal Serial Bus (USB) device </p><p id="p0012" num="0012"> (sometimes referred to as a USB key or a USB token) to store the public-private key pair and the certificate and to carry out the cryptographic calculations involving the private key. 
<!-- EPO <DP n="4"/>-->
 [0006] There are some disadvantages associated with PKI and the smart cards carrying the PKI keys and certificates: </p><p id="p0013" num="0013"> 1. Building a Public Key Infrastructure is generally complicated and therefore expensive when compared to competing security technologies.</p><p id="p0014" num="0014">2. PKI is inherently limited to environments and applications where there is a digital connection between clients and servers, because PKI cryptograms and signatures are bulky and not easily transformed into human-readable form. In other words it is unsuitable for telephone banking or other delivery channels where it is not possible to provide a digital connection between the container of the PKI certificate and private key on the one hand and an application server on the other hand. </p><p id="p0015" num="0015"> 3. PKI smart cards and USB tokens do not have a built-in power supply or a user interface. PKI smart cards and USB tokens therefore rely on the presence of an interfacing system that provides electrical power to the card, that is capable of digitally exchanging data with the card, and that is capable of interacting with the user (e.g. capturing the card's personal identification number (PIN) and presenting the data that should be signed). USB tokens are usually plugged into a built-in USB port of a PC, where the USB port supplies power to the USB token and the human interface devices connected to the PC provide the user interaction capabilities (connected USB token model). PKI smart cards are usually operated by means of a PC equipped with a simple smart card reader, where the reader only supplies power to the smart card and enables communication between an application on the PC and the inserted smart card, and whereby the human interface devices connected to the PC provide the user interaction capabilities. Such a reader, which has no trustworthy user interface of its own, is often referred to as transparent card reader. These typical usage models reduce the mobility of the user, as most PCs are not pre-equipped with smart card readers, and ad-hoc installation of drivers for the readers of USB tokens proves too cumbersome. It also presents a security problem: all user interaction (such as approving a signature or capturing the card's PIN) is done on the inherently insecure PC. </p><p id="p0016" num="0016"> [0007] Another approach consists of adding software applications offering security </p><p id="p0017" num="0017"> functions to general purpose devices such as a user's PC, or mobile device (e.g., mobile phone or PDA). The main problem associated with this approach is that general purpose devices have an inherently open architecture which makes them susceptible to all kinds of malicious software such as viruses and Trojans 
<!-- EPO <DP n="5"/>-->
 that could present fake messages to the user, or capture whatever the user enters on the keypad, or read in memory sensitive data associated with a security application, or alter data before they are being signed. Therefore general purpose devices cannot be considered to have a trustworthy user interface and don't have secure means to store secrets such as PIN values and cryptographic keys. Furthermore, known solutions for mobile devices rely on wireless subscriber networks for the reception and/or transmission of transaction data. Such networks have inherent security and end point authentication mechanisms in place, which cannot be assumed to be present when the Internet is used for all transmissions. </p><p id="p0018" num="0018">An alternative technology for authentication and transaction signature capabilities, which avoids the security issues of solutions based on general purpose devices and the security, installation and interconnection problems of PKI smart cards and USB tokens, is offered by 'strong authentication token devices'. Typical examples of strong authentication tokens are the products of the DIGIPASS® line, commercialized by Vasco Data Security Inc. of Chicago, Illinois (see the website http://www.vasco.com). A strong authentication token is an autonomous battery-powered device, dedicated to providing authentication and/or transaction signature functions, usually pocket-size, with its own display and keypad. In some cases the keypad is reduced to a single button or even completely omitted, in other cases the keypad can be a full keyboard. The display and keypad of a typical strong authentication token are non-removable and not user-serviceable, fully controlled by the token, and immune for interference by malicious software on a host computer. Therefore strong authentication tokens are considered to have a trustworthy user interface in contrast to, for example, PCs where there is always the possibility that malicious software such as a virus or a Trojan presents fake messages to the user, or captures whatever the user enters on the keypad, or reads in memory sensitive data associated with a security application or alters data before they are being signed. The main purpose of a strong authentication token is to generate dynamic security values which are usually referred to as One-Time Passwords' (OTPs) or dynamic passwords. Typically these OTPs are generated by </p><p id="p0019" num="0019">cryptographically combining a secret that is shared between the token and a verification server with a dynamic value such as a time value, a counter value or a server challenge that is provided to the token, or a combination of these. Some strong authentication tokens can also use data (such as transaction data) that have been provided to the token as dynamic value or in combination with 
<!-- EPO <DP n="6"/>-->
 any of the dynamic values mentioned above to generate a security value. In these cases the resulting security value is meant to indicate the user's approval of the data and the security value is usually referred to as an electronic signature or Message Authentication Code (MAC). Some strong authentication tokens consist of a device with a display and a keypad that is capable of communicating with an inserted smart card whereby the generation of the OTPs or MACs is partly done by the device itself and partly by the inserted smart card. </p><p id="p0020" num="0020"> [0009] A typical way to provide data to a strong authentication token is by letting the user enter the data manually on the token's keypad. When the amount of data that has to be entered in this way exceeds a few dozen characters, the process is often perceived by users as too cumbersome. Another disadvantage is that tokens that support manual data input usually have a keypad which usually makes the token considerably larger than it could be if no such keypad were present. To relieve the user, solutions have been devised whereby the input of data doesn't require the manual entry of said data by the user on the token's keypad. One example are solutions whereby the token includes receiving means to receive data sent over an out-of-band channel such as for example a radio network or mobile telephony network (see US Patent No. 5,668,876 issued on September 16, 1997). The disadvantage of such out-of-band solutions is the extra complexity and cost associated with supporting the technology of said out- of-band channel, and the dependence on the availability and the cost of usage of said out-of-band channel. Another solution consists of tokens that allow for data input by means of an optical interface, whereby the user holds the token close to a computer screen that displays a varying optical pattern. Examples of such optical tokens are Digipass 700 and Digipass 300 offered by VASCO Data Security Inc. of Chicago, Illinois and the tokens described in European Patent Specification Number 1211841 published June 5, 2002, European Patent Specification Number 1788509 published May 23, 2007, US Patent No. </p><p id="p0021" num="0021"> 5,136,644 issued on August 4, 1992 . </p><p id="p0022" num="0022"> [0010] A general problem of tokens with an optical data input interface is that relatively expensive components are required to build an interface that can take in data at a high data rate. This is a consequence of the requirement to work reliably in a very broad range of computer screen qualities and environmental lighting conditions, combined with the relatively low refresh rates of typical computer screens. Another, more cost-effective, alternative is to use a low-speed optical interface. The disadvantage of a low-speed optical interface is that either it 
<!-- EPO <DP n="7"/>-->
 limits the transaction data that are effectively submitted to the token to a small number of values, or that the transmission time is inconveniently high. </p><p id="p0023" num="0023">[0011] What is needed is an alternative cost-effective data input mechanism for strong authentication tokens that allows reliable input of data at relatively high data rates and that is convenient for the user. </p><p id="p0024" num="0024">Disclosure of the invention </p><p id="p0025" num="0025"> [0012] The present invention is based on the insight by the inventors that many </p><p id="p0026" num="0026"> applications that are secured by means of strong authentication tokens are accessed by the applications' users by means of a PC (personal computer) or similar computing device most of which have the capability of generating and emitting sounds in the human audible frequency range with a bandwidth that is typically in the order of 10 kilohertz, and that by judiciously modulating sound output by these computing devices it is possible to transmit data at a relatively high data rate to a strong authentication token equipped with means to receive and demodulate the sound thus emitted by these computing devices. The present invention is further based on the insight by the inventors that in such a set-up (i.e. whereby data is exchanged by sound waves in the human audible frequency range, data is transmitted by an audio speaker, data is received by an audio microphone, the transmission medium is the air between speaker and microphone, the medium/room has a certain reverberation and there is usually some amount of background noise in the room) a major source of transmission errors is due to reflections (e.g . at the walls of the room where the transmission takes place) of the sound signal which arrive at the token's receiver with a significant delay, i.e. giving rise to multipath reception of the acoustical signal, and that typically the power of a reflected signal will be smaller than the power of a directly received signal. Other significant sources of transmission errors may include background noises. It is a further insight by the inventors that typically the power of background noises will be stochastically spread over a relatively wide bandwidth. The present invention is furthermore based on the insight by the inventors that non-linear distortion of the acoustic signal, giving rise to harmonics of the frequencies present in the signal, in general does not contribute significantly to the power of the noise on the received signal . </p><p id="p0027" num="0027"> [0013] The present invention is furthermore based on the insight by the inventors that by a judicious encoding and decoding of the data to be transmitted via a unidirectional optical or acoustical interface, the transfer can be made more reliable and efficient. 
<!-- EPO <DP n="8"/>-->
 [0014] In a typical embodiment the input data for the token is transmitted as modulated sound that is emitted and input to the token by means of an acoustical interface. In one embodiment the token's acoustical interface includes a microphone and a demodulation circuit. The microphone is for receiving an acoustical signal and for converting the acoustical signal into an analog electrical signal. The microphone is connected to a demodulation circuit which converts the analog electrical signal into a digital signal. In one embodiment the demodulation circuit is connected to a data processing means which is adapted to extract and treat input data coded in the digital signal. </p><p id="p0028" num="0028"> [0015] In one embodiment the sending side includes a computing device with which the user interacts (e.g. to access an internet based application). In some </p><p id="p0029" num="0029"> embodiments the user's computing device may include a Personal Computer (PC), or a Tablet Computer, or a Smartphone, or some other similar computing device with which the user interacts (e.g. to access an internet based </p><p id="p0030" num="0030"> application). In some embodiments the user's computing device is equipped with speakers capable of emitting sounds in the human audible frequency range. In a particular embodiment the speakers of the user's computing device emit the sound output of a software application running on the PC. In one </p><p id="p0031" num="0031"> embodiment the software application running on the user's computing device includes a browser running an applet or plug-in embedded in a web page. In one embodiment the applet includes a flash application. In some embodiments the web page is associated with the application to be secured by the strong authentication token. </p><p id="p0032" num="0032"> [0016] In some embodiments the receiving token includes a microphone to receive the acoustic signal and to transform it into an electrical signal. The token may also include a demodulation circuit connected to the microphone to demodulate the microphone's electrical signal. </p><p id="p0033" num="0033"> [0017] In some embodiments the input data are encoded at the sending side as a </p><p id="p0034" num="0034"> digital data string. In some embodiments the digital data string is emitted as an acoustical signal using a frequency-shift keying (FSK) modulation scheme whereby each of the frequencies used to code the acoustical signal (in the remainder of the text referred to as 'coding frequencies') is an integer multiple of a common base frequency. Although in some embodiments the modulation is such that the acoustic signal being emitted at all times only contains one of the coding frequencies, because of noise, reflections and distortions the acoustical signal that is received by the token may contain several of the coding </p><p id="p0035" num="0035"> frequencies at the same time. In some embodiments the demodulation circuit 
<!-- EPO <DP n="9"/>-->
 detects the power of each coding frequency present in the signal and compares the relative power of each coding frequency. The coding frequency with the relatively strongest power is assumed to be the coding frequency emitted at the sending side. </p><p id="p0036" num="0036"> [0018] In some embodiments the coding frequencies are each an integer multiple of a common base frequency and the demodulation circuit includes a phase-locked loop (PLL) tuned to the common base frequency of the coding frequencies. In some embodiments the PLL is a narrow-band PLL. Because it is tuned to the common base frequency of the coding frequencies it will also synchronize on each of the coding frequencies itself as well. </p><p id="p0037" num="0037"> [0019] In some embodiments the demodulation circuit includes a pre-amplifying </p><p id="p0038" num="0038"> component for selectively amplifying the microphone's electrical signal prior to actual demodulation. In some embodiments the pre-amplifying component includes a band-pass filter which suppresses frequencies lower than the lowest coding frequency and suppresses frequencies higher than the higher coding frequency. </p><p id="p0039" num="0039"> [0020] In some embodiments the demodulation circuit includes for each supported coding frequency a power detection sub-circuit. Each power detection sub- circuit outputs an electrical signal the level of which is indicative of the power in the received acoustical signal of the coding frequency associated with that power detection sub-circuit. The power detection sub-circuits may be connected to a ratio-detector sub-circuit which compares the output levels of the power detection sub-circuits and which outputs a signal that indicates which power detection sub-circuit has the most extreme output level and hence which coding frequency has the highest power in the received acoustical signal. In some embodiments only two coding frequencies are being used and the output signal of the ratio-detector sub-circuit is a sequence of bits with '0' indicating that one coding frequency has most power and <sup>λ</sup>1' indicating that the other coding frequency has most power. In some particular embodiments the ratio-detector sub-circuit may include a comparator with as inputs the outputs of two power detection sub-circuits. </p><p id="p0040" num="0040"> [0021] In some embodiments the power detection sub-circuits include a demodulator component and a low-pass filter whereby the demodulator component's output is the input to the low-pass filter and whereby each demodulator component takes as input the received input signal (optionally conditioned by selective amplification) and a reference signal generated by the phase-locked loop. 
<!-- EPO <DP n="10"/>-->
 [0022] In some embodiments the token may have additional data input mechanisms besides the acoustical input interface to receive input data. Said additional data input mechanisms may include a manual user input interface allowing the user to manually enter data into the token. This manual user input interface may include a keypad or a keyboard. It may also include alternative mechanisms to manually enter data such as joysticks, jog dials, track balls, turn wheels, or similar devices. The additional input interfaces may also include communication mechanisms and protocols such as electrical personal area networks such as USB or Firewire, or optical connections, or wireless personal area networks using radio transmission such as Bluetooth or infrared transmission such as IRDA (Infrared data association). </p><p id="p0041" num="0041"> [0023] In some embodiments the token has no keypad resulting in a compact design. </p><p id="p0042" num="0042"> In other embodiments the token has a compact manual user input interface adapted to allow a user to manually enter input data such as a PIN. The compact user input interface may comprise a keypad with no more than three or four keys, or a wheel to scroll through a set of options (such as a list of digits) in combination with no more than two buttons, or even only a wheel to scroll through a set of options whereby the wheel can also function as a push button to confirm the currently selected option. In some embodiments the compact manual user input interface may consist of a navigation mechanism and a confirmation mechanism, whereby the navigation mechanism permits the user navigation through a list of options and/or selection of an item of a list of options, and the confirmation mechanism permits the user to give a </p><p id="p0043" num="0043"> confirmation to the token e.g . to confirm a currently selected item such as an option or data element or to confirm information presented by the token to the user or to confirm a suggestion by the token. In some embodiments the compact manual user input interface may also comprise a cancelation </p><p id="p0044" num="0044"> mechanism that permits the user to indicate to the token that the user disapproves or cancels something presented to the user. In some embodiments the navigation mechanism comprises a turn wheel or a jog dial. In some embodiments the navigation mechanism may comprise one, two or more than two navigation buttons. In some embodiments the confirmation mechanism may comprise an OK button. In some embodiments the cancelation mechanism may comprise a cancel button. In some embodiments the data input means of the token may consist of only an acoustical input interface and a compact manual user input interface. 
<!-- EPO <DP n="11"/>-->
 [0024] In one set of embodiments of the invention the token includes a keypad. In one embodiment this keypad allows entry of at least the decimal digits. In another embodiment said keypad also allows entry of hexadecimal digits or </p><p id="p0045" num="0045"> alphanumerical characters. In some embodiments said keypad includes control buttons to indicate user approval or rejection of information or options presented by the token, or navigation buttons to navigate through menu options or through information presented by the token. In other embodiments said keypad includes a full keyboard. In some embodiments, both a keypad and an optical interface may be present besides the acoustical input interface, where the keypad could serve as a back-up input means in case the optical and/or acoustical input means fail. </p><p id="p0046" num="0046"> [0025] In some embodiments the manual user input interface is adapted to permit the user to indicate approval of, e.g. data to be signed, or to indicate preferences such as whether an optical or acoustical interface should be used to receive input data. In some embodiments the manual user input interface is adapted to permit the user to provide values to the token. These values may include transaction data to be signed or a PIN value. </p><p id="p0047" num="0047"> [0026] In some embodiments the token includes a user output interface by means of which the token can output or present information to the user. In some embodiments the information output to the user may include security values such as one-time or dynamic passwords and/or signatures on e.g. transaction related data. In some embodiments the information presented to the user may include data to be signed by the token for prior approval by the user. In some embodiments the information presented to the user may include information about the data to be signed such as the meaning of certain data elements or information about a transaction context such as a reference or name to an application owner. </p><p id="p0048" num="0048"> [0027] In some embodiments of the invention the token's output means include a </p><p id="p0049" num="0049"> display such as for example a Liquid Crystal Display (LCD) and/or one or more Light Emitting Diodes (LEDs) for example to indicate certain security statuses or conditions. In one embodiment the token can display texts on the display. In an embodiment said texts can be displayed as a sequence of characters. On another embodiment the token can display icons or pictograms on the display. In some other embodiment the token's output means include audio output means such as for example a loudspeaker, earphones, or means to attach such loudspeaker or headphones such as for example a 1/8" audio socket or an RCA audio socket, to convey information to the user by means of generated sounds. 
<!-- EPO <DP n="12"/>-->
 In one embodiment the generated sounds are sequences of tones. In another embodiment the generated sounds consist of synthesized speech. In another embodiment the generated sounds are reproductions of stored sound fragments. </p><p id="p0050" num="0050"> [0028] In some embodiments the token may have been adapted to have a trustworthy user input interface. In some embodiments this includes the token's input interface being adapted so that the token can always distinguish between data manually input by a user physically interacting with the token and data that is provided to the token but that is not manually entered by some user physically interacting with the token. In some embodiments the manual user input interface may be non-removable and not user-serviceable, fully controlled by the token, and immune for interference by malicious software on a host computer. In some embodiments the token may be adapted to resist </p><p id="p0051" num="0051"> unauthorised changes to the token firmware. In some embodiments the token's firmware may be stored in unalterable memory such as ROM. In some embodiments the token supports firmware updates but the firmware can only be updated by means of cryptographically protected secure firmware update protocols. In some embodiments the token may have tamper resistance and/or tamper detection mechanisms which may include mechanisms to detect opening of the token's housing. </p><p id="p0052" num="0052"> [0029] In some embodiments the token may have been adapted to have a trustworthy user output interface. In some embodiments this includes the token's user output interface being adapted so that the token fully controls any output the token presents to the user. In some embodiments the user output interface may be non-removable and not user-serviceable, fully controlled by the token, and immune for interference by malicious software on a host computer. In some embodiments the token may be adapted to resist unauthorised changes to the token firmware. In some embodiments the token's firmware may be stored in unalterable memory such as ROM. In some embodiments the token supports firmware updates but the firmware can only be updated by means of </p><p id="p0053" num="0053"> cryptographically protected secure firmware update protocols. In some embodiments the token may have tamper resistance and/or tamper detection mechanisms which may include mechanisms to detect opening of the token's housing. </p><p id="p0054" num="0054"> [0030] In a particular embodiment of the invention the token includes data processing means such as a microprocessor to perform cryptographic operations and data storage means such as RAM, ROM or EEPROM memory to store one or more secret values such as one or more PIN values or cryptographic secret keys. In 
<!-- EPO <DP n="13"/>-->
 some embodiments the token is adapted to prevent unauthorized reading of these secret values. For example the token may have tamper resistance and/or tamper detection mechanisms which may include mechanisms to detect opening of the token's housing. </p><p id="p0055" num="0055"> [0031] In one embodiment of the invention the input data can include a challenge (e.g., a random number or hash of transaction data that may be processed for authentication/validation purposes). In another embodiment of the invention the input data includes transaction related data including transaction values or transaction context information. In some embodiments the transaction context information may include transaction data labels and/or information regarding the meaning of the transaction related data. In some embodiments the input data includes application flow related information. In some embodiments the application flow related information may include information regarding the type of transaction. In some embodiments the application flow related information may guide the token with respect to the way that the token should handle the received transaction related data and/or how the token should handle the user interaction flow, for example which data should be presented to the user for review and/or approval and whether the user should be asked or given the opportunity to correct data or manually provide extra data and/or which messages should be presented to the user. </p><p id="p0056" num="0056"> [0032] In some embodiments the input data may include a server credential that has been cryptographically generated by a server. In some embodiments the server has generated the server credential using a symmetric cryptographic and secret key that is shared with the token or a second security device that the token communicates with. In some embodiments the token is adapted to verify the server credential. In some embodiments the token is adapted to verify the server credential in cooperation with a second security device. In some embodiments the verification of the server credential is done using a symmetric cryptographic algorithm that uses a secret key shared with the server. In some embodiments the server credential comprises a server one-time password. In some embodiments the server credential comprises a data signature. In some embodiments the server credential comprises a Message Authentication Code (MAC). In some embodiments the server credential comprises encrypted input data. In some embodiments the purpose of the server credential is to authenticate a server or server application. In some embodiments the purpose of the server credential is to authenticate input data received by the token from a server. In some embodiments the purpose of the server credential is to 
<!-- EPO <DP n="14"/>-->
 protect the integrity of input data received by the token from a server. In some embodiments the purpose of the server credential is to protect the </p><p id="p0057" num="0057"> confidentiality of input data received by the token from a server. In some embodiments the generation of dynamic security credentials by the token may be conditional on successful verification of the server credential. </p><p id="p0058" num="0058"> [0033] In one particular embodiment the input data are encoded as a binary data string including a sequence of bits. The binary data string is emitted as an acoustical signal using two coding frequencies, one coding frequency being the double of the other frequency. </p><p id="p0059" num="0059"> [0034] Generation of dynamic security values. </p><p id="p0060" num="0060"> [0035] In some embodiments the token is adapted to generate dynamic security </p><p id="p0061" num="0061"> values. In some embodiments the generated dynamic security values may comprise one-time or dynamic passwords, and/or responses to challenges and/or electronic signatures on transaction data. In some embodiments the token is adapted to present generated dynamic security values to the user. In some embodiments the dynamic security values are generated by </p><p id="p0062" num="0062"> cryptographically combining at least one secret value (such as a cryptographic key) with at least one dynamic value (such as a time value and/or a counter value and/or a challenge and/or transaction related data). In some </p><p id="p0063" num="0063"> embodiments the cryptographically combining comprises performing a cryptographic algorithm. In some embodiments the cryptographic algorithm may comprise a symmetric encryption or decryption algorithm such as DES, 3DES or AES. In some embodiments the cryptographic algorithm may comprise a hashing or keyed hashing algorithm such as SHA-1. </p><p id="p0064" num="0064"> [0036] In some embodiments the token comprises a data processing component that is adapted to perform a cryptographic algorithm that is used in the generation by the token of dynamic security values. In some embodiments the token comprises a memory component for storing one or more cryptographic secrets that are used in the generation by the token of dynamic security values. In some embodiments the stored cryptographic secrets are symmetric keys shared with an authentication server. In some embodiments the stored cryptographic secrets are stored in the token in a non-volatile memory and used for multiple generations of dynamic security values. In some embodiments the stored cryptographic secrets are used for only one generation of a dynamic security value and may in some embodiments be stored in volatile memory and/or actively erased from memory after the dynamic security value has been generated. 
<!-- EPO <DP n="15"/>-->
 [0037] In some embodiments the token is adapted to communicate with a second security device and the dynamic security values are generated by the token in conjunction or cooperation with that second security device. In some </p><p id="p0065" num="0065"> embodiments the token is adapted to send a command to the second security device, to receive a response from the second security device and to derive a dynamic security value from that response. In some embodiments the second security device stores a secret key and the token instructs the second security device to use that secret key in a cryptographic calculation and to return a result of that cryptographic calculation to the token. In some embodiments the second security device cryptographically combines the secret key that it stores with one or more data elements that it has received from the token such as for example a challenge or transaction data. In some embodiments the second security device cryptographically combines the secret key that it stores with one or more data elements that it stores and maintains internally such as for example a counter. In some embodiments the token uses the response of the second security device to derive a secret key that it cryptographically combines with a dynamic variable to generate a dynamic security value. In some embodiments the dynamic variable may be derived from data input (such as for example a challenge or one or more transaction related data elements) into the token through the acoustical input interface of the token. In some embodiments the second security device comprises a smart card. In some embodiment the smart card comprises a financial smart card that is compliant with the Europay, MasterCard, Visa (EMV) standard and the token is adapted to communicate with EMV compliant smart cards. </p><p id="p0066" num="0066"> [0038] PIN handling. </p><p id="p0067" num="0067"> [0039] In some embodiments the token is adapted to receive a PIN value provided by the user. In some embodiments the token is adapted to pass on a PIN value provided by the user to a second security device (such as a smart card) for verification. In some embodiments the token is adapted to remove from its memory any copy in any format of such a PIN value once that PIN value has been verified. In some embodiments the token has been adapted to actively erase or overwrite the memory locations where such a PIN value has been temporarily stored after the PIN value has been verified. </p><p id="p0068" num="0068"> [0040] Co-existence in the same token of an acoustical and an optical input interface. </p><p id="p0069" num="0069"> [0041] In some embodiments the application on the user's computing device (which may include e.g. a PC, a Tablet computer or a Smartphone) emits an acoustical signal that encodes input data destined to be received by the user's token. In 
<!-- EPO <DP n="16"/>-->
 some embodiments the user's computing device has a display that displays optically encoded input data destined to be received by the user's token. The optically encoded data may, for example, be encoded in a flashing pattern. In some embodiments the user's computing device both emits an acoustical signal that encodes input data destined to be received by the user's token and it has a display that displays a flashing pattern that also encodes input data destined to be received by the user's token. In some embodiments the data that the user's computing device emits acoustically and the data that it encodes optically encode substantially the same information. In some embodiments the data that the user's computing device emits acoustically is different from the data that it encodes optically. In some embodiments the data that the user's computing device emits acoustically is complementary to the data that it encodes optically. </p><p id="p0070" num="0070"> [0042] In some embodiments the token has both an acoustical and an optical input interface and may optionally also have a manual user input interface. </p><p id="p0071" num="0071"> [0043] In some embodiments the token is adapted to receive from the user an </p><p id="p0072" num="0072"> indication whether the token should receive input data via its optical input interface of via its acoustical input interface. In some embodiments when the user has indicated that the optical input interface should be used to input data the token enables the optical input interface and may disable the acoustical input interface. In some embodiments when the user has indicated that the acoustical input interface should be used to input data the token enables the acoustical input interface and may disable the optical input interface. </p><p id="p0073" num="0073"> [0044] In some embodiments the acoustical and optical input interface may be both enabled at the same time. In some embodiments the acoustical and optical input interface are both enabled by default. In some embodiments, when the acoustical and optical input interface are both enabled at the same time, the token is adapted to receive data concurrently through both the acoustical and optical input interface. In some embodiments the token is adapted to assemble or combine the data that it received through the optical input interface with the data that it received through the acoustical input interface. For example, if a message to be received by the token consists of multiple data blocks, the token may receive some data blocks of the message through the optical input interface and other data blocks of the message through the acoustical input interface and the token may combine these data blocks to assemble the full message. This may for example be the case when the user's computing device sends the same message via the acoustical and the optical input interfaces but due to </p><p id="p0074" num="0074"> transmission errors in both the optical and the acoustical channel some data 
<!-- EPO <DP n="17"/>-->
 blocks may not have been correctly received via the acoustical input interface while other data blocks may not have been correctly received via the optical input interface. In some embodiments the token is adapted to receive data through both the acoustical and optical input interfaces concurrently and to assume that the same message is sent through both the acoustical and optical input interfaces. In some embodiments the token is adapted to receive data through both the acoustical and optical input interfaces concurrently and to consider message reception successful as soon as it has successfully received a message via either of the optical or acoustical input interface. </p><p id="p0075" num="0075">[0045] In some embodiments the token is adapted to select one of the optical or </p><p id="p0076" num="0076"> acoustical input interfaces to receive data without receiving an indication of the user. </p><p id="p0077" num="0077"> [0046] In some embodiments the token comprises an input interface selection </p><p id="p0078" num="0078"> mechanism to select one of the optical or acoustical input interfaces. In some embodiments the input interface selection mechanism may be implemented using a data processing component such as a microprocessor or a logical circuit. </p><p id="p0079" num="0079"> [0047] In some embodiments the input interface selection mechanism decides by </p><p id="p0080" num="0080"> means of heuristic rules on the basis of certain characteristics of the signals received through the acoustic and optical input interfaces which input interface is preferred to receive data. In some embodiments the token analyses the signals of both the acoustical and optical input interface concurrently and based on the outcome of this analysis decides whether to perform further processing on the signal of either the optical or the acoustical input interface to try to demodulate data and receive a message. In some embodiments this analysis comprises analysing the energy and/or the frequency content of the optical and/or acoustical signals. In some embodiments the analysis comprises comparing the energy in a specific frequency range of the received signal to a reference value. </p><p id="p0081" num="0081"> [0048] In some embodiments the token is adapted to select one of the optical or </p><p id="p0082" num="0082"> acoustical input interfaces to receive data in the following way. Initially the token tries for a certain period (for example a second or even less than a second) to receive at least some data through a first one of the optical or input acoustical interface. If that is successful then the token selects this input interface and continues receiving data through the selected input interface. If it fails then the token repeats the selection process with the other input interface. This selection process may continue until the token is successful in receiving data through one of the input interfaces. 
<!-- EPO <DP n="18"/>-->
 [0049] In some embodiments the token is adapted to detect transmission problems when it is receiving data throug h the selected input interface. In some embodiments the token may be adapted, in case of transmission proble ms with the selected input interface, to return to the interface selection phase. In some embodiments the decision to return to the interface selection phase may depend on pre-defined criteria . In some embodiments these pre-defined criteria may take into account characteristics of the detected transmission errors. In some embodiments the token may for example decide to return to the interface selection phase when a predefined threshold of the nu mber of transmission errors per time unit has been exceeded . </p><p id="p0083" num="0083"> [0050] In accordance with one aspect of the present invention, a strong authentication token generates dynamic secu rity va lues by receivi ng an acoustical sig nal from a remote computer system at the authentication token, obtaining the input data by demodulating the acoustic signa l ; and generating the dynamic secu rity value at the authentication token by recovering input data from the acoustical sig nal and processing the recovered input data . The authentication token may include a communication interface for communicating with a removable security device and the generating step may include generating the dyna m ic security value with the authentication token in cooperation with the removable secu rity device. The method may additional ly include receiving an optical signal including add itional input data and the generating step may include combin ing the recovered input data and the additional input data . </p><p id="p0084" num="0084"> [0051] Yet another aspect of the invention comprises a method to secu re a remote server-based application being accessed by a user throug h a computing device communicati ng with the application server e.g . over the internet. The method may comprise the following steps. </p><p id="p0085" num="0085"> [0052] - Making available to a user an authentication token comprising an acoustica l input interface. The authentication token may be one of the authentication tokens described in any of the preceding paragraphs. In some embodiments also a second security device such as a sma rt card is made available to the user to be used in conjunction with the authentication token to generate a dynamic secu rity value. </p><p id="p0086" num="0086"> [0053] - Assembling input data to be input into said authentication token . These input data may comprise for example a challenge, or transaction related data, or transaction context related data . In some embodiments the input data may comprise a server credential . To obtain the server credential the server may optionally first generate a server credential . The server may generate the 
<!-- EPO <DP n="19"/>-->
 server credential using a secret key and a cryptographic algorithm. The cryptographic algorithm may be a symmetric cryptographic algorithm. In some embodiments the secret key for generating the server credential may be shared with the user's authentication token. </p><p id="p0087" num="0087"> [0054] - Sending the input data to the user's computing device. The user's computing device may be running a computer application such as a web browser. The input data may be embedded in one or more web pages that the server-based application serves to the computing device's browser. </p><p id="p0088" num="0088"> [0055] - Emitting at the user's computing device a modulated acoustical signal </p><p id="p0089" num="0089"> encoding for the input data to be received and demodulated by the </p><p id="p0090" num="0090"> authentication token for the authentication token to recover the input data. The authentication token may receive and demodulate the acoustical signal and recover the input data from the demodulated acoustical signal as described in the preceding paragraphs. In some embodiments also an optical signal may be emitted at the user's computing device. In some embodiments the optical signal may encode data comprising part or all of the input data. </p><p id="p0091" num="0091"> [0056] - Receiving from the user a dynamic security value that has been generated by the authentication token. The authentication token may generate the dynamic security value as described in the preceding paragraphs. In some embodiments the authentication token comprises a communication interface to communicate with a removable second security device and the authentication token generates the dynamic security value in cooperation with the removable second security device. In some embodiments the authentication token processes the input data to generate a dynamic security value. In some embodiments the dynamic security value is generated by cryptographically combining a dynamic variable with a secret key. In some embodiments the cryptographically combining comprises using of a symmetric cryptographic algorithm. In some embodiments the dynamic variable comprises a challenge. In some embodiments the dynamic variable comprises transaction related data. In some embodiments the dynamic variable comprises a time related value. In some embodiments the dynamic variable comprises a counter. In some embodiments the dynamic variable comprises a data element comprised in the input data received from the server- based application. In some embodiments the dynamic security value is generated using a key that is shared with the server-based application. In some embodiments the input data comprises a server credential and the </p><p id="p0092" num="0092"> authentication token verifies the server credential prior to generating the dynamic security value. In some embodiments the authentication token uses a 
<!-- EPO <DP n="20"/>-->
 symmetric cryptographic algorithm with a secret key that is shared with the application server to verify the server credential. In some embodiments the authentication token generates the dynamic security value on condition that verification of the server credential was successful. In some embodiments the authentication token comprises a secure user output interface and uses that secure user output interface to output the dynamic security value to the user. In some embodiments the user receives the dynamic security value and enters the dynamic security value on a web page related to the server-based application. </p><p id="p0093" num="0093"> [0057] - Verifying the received dynamic security value. The application server may verify the received dynamic security value using a cryptographic algorithm. In some embodiments the application server cryptographically combines a reference dynamic variable with a reference secret key to verify the received dynamic security value. In some embodiments the application server generates a reference security value and compares the reference security value with the received dynamic security value. In some embodiments the application server computes the reference security value by cryptographically combining a reference dynamic variable with a reference secret key. In some embodiments the cryptographically combining comprises performing a symmetric </p><p id="p0094" num="0094"> cryptographic algorithm. In some embodiments the secret key comprises a secret key that the application server shares with the authentication token or with a removable second security device the user's authentication token has cooperated with to generate the dynamic security value. </p><p id="p0095" num="0095"> [0058] - Taking appropriate action depending on the outcome of the verification of the dynamic security value. In some embodiments this may comprise that the user is granted access to the server-based application in case the verification was successful and is refused access in case the verification was not successful. In some embodiments this may comprise that a transaction request submitted by the user is performed if the verification was successful and is not performed if the verification was not successful. </p><p id="p0096" num="0096"> [0059] In some embodiments the application server may comprise one or more server computers running one or more software applications. In some embodiments the application server may comprise one or more web servers. In some embodiments the application server may comprise one or more databases for storing data. In some embodiments the application server may use and/or store user related data. In some embodiments the application server may use and/or store data related to the authentication token. In some embodiments the data 
<!-- EPO <DP n="21"/>-->
 related to the user or the authentication token comprise one or more secret keys. In some embodiments one or more of these secret keys may be shared with the user's authentication token or with a removable second security device the user's authentication token has cooperated with to generate the dynamic security value. </p><p id="p0097" num="0097">[0060] Emission cycles and encoding schemes. </p><p id="p0098" num="0098"> [0061] In most embodiments the authentication tokens with an acoustical and/or </p><p id="p0099" num="0099"> optical input interface are not adapted to communicate some kind of feedback to the computing device that emits the acoustical and/or optical signal i.e. the acoustical or optical communication is one-way or unidirectional communication. As a consequence these authentication tokens are not capable of informing that they have started receiving the optical or acoustical signal, or when they have successfully received the data, or whether at the contrary the reception failed. In some embodiments the computing device therefore sends the data several times to give the authentication token ample opportunity to receive the signal . In some embodiments the computing device continues sending the data until some condition is fulfilled, for example until the user explicitly or implicitly indicates that the authentication token has received the data e.g. by entering on the computing device a security value that is the result of the authentication token's processing of the data sent by the computing device. In some embodiments the computing device repeats a number of emission cycles whereby in each emission cycle the computing device emits an acoustical and/or optical signal encoding data to be sent to the authentication token. In some embodiments the computing device emits both an optical and an acoustical signal and the emission cycles of the optical and acoustical signal are </p><p id="p0100" num="0100"> synchronised. In some embodiments the computing device emits both an optical and an acoustical signal and the emission cycles of the optical and acoustical signal are independent and not synchronised. In some embodiments the data in each emission cycle of the optical or acoustical signal is encoded in the same way. In some embodiments the computing device may apply different encoding schemes for different emission cycles. </p><p id="p0101" num="0101"> [0062] In most embodiments the authentication token and the computing device are not adapted to synchronise the authentication token's reception with the computing device's emission. As a consequence in many cases the </p><p id="p0102" num="0102"> authentication token starts receiving and decoding the optical and/or acoustical signal at some random point in an emission cycle. To allow the authentication token to detect the boundaries of an emission cycle, in some embodiments the 
<!-- EPO <DP n="22"/>-->
 data may be encoded such that the authentication token may detect the start and/or the end of an emission cycle. In some embodiments the data may be encoded using some start sequence or start symbol. In some embodiments the data may be encoded using some end or stop sequence or end or stop symbol. In some embodiments the data sent in one emission cycle is separated from the data sent in a preceding or a following emission cycle by a separation sequence or a separation symbol. In some embodiments the data encoding may comprise a length or size indication of the data. In some embodiments the authentication token discards any data that it receives before it detects the start of an emission cycle. In some embodiments the authentication token buffers any data that it receives before the end of one emission cycle and combines it with data that it receives after the beginning of a following emission cycle to reconstruct the data sent in a complete emission cycle. </p><p id="p0103" num="0103"> [0063] For example, in some embodiments the data is encoded in a message that starts with a fixed start sequence, ends with a fixed end sequence and may contain an indication of the length of the message (for example at the beginning or at the end of the message) . The computing device may emit in each emission cycle the same message. The authentication token may be adapted to decode the received signal as soon as it has begun receiving the signal and may buffer the decoded data. In general the authentication token may start receiving somewhere at a random point in the emission cycle and may therefore receive the last part of the message starting from some random point in the message. When the authentication token has reached the end of the message in one cycle, it may continue receiving the first part of the message in the following emission cycle. Once the authentication token has received the indication of the length or size of the data to be received, it may deduce from that length indication and from the size of the data already received in the last part of the first emission cycle and the size of the data received thereafter in the first part of the following emission cycle how much data it still has to receive before it has received all data of the message. Once the authentication token has deduced that it has received all data of the message either in the last part of the first emission cycle or in the first part of the following emission cycle, it may stop the receiving and combine the data received in the last part of the first emission cycle with the data received in the first part of the following emission cycle to reconstruct the full message. </p><p id="p0104" num="0104"> [0064] In some cases the optical and/or acoustical signal received by the authentication token may be more or less corrupted and the decoded data may comprise 
<!-- EPO <DP n="23"/>-->
 erroneous data. In some embodiments the data may be encoded such that the authentication token may detect at least some transmission errors. For example the message containing the encoded data may comprise an error detection code over the encoded data. In some embodiments the message containing the encoded data may comprise a Cyclic Redundancy Code (CRC). In some embodiments the message containing the encoded data may comprise a check sum. In some embodiments the message containing the encoded data may comprise a Luhn check digit. In some embodiments the message containing the encoded data may comprise a Longitudinal Redundancy Check (LRC) code. In some embodiments when the token detects that the received message or a part of the received message contains an error, it discards a part or all of the received message and may continue receiving the optical and/or acoustical signal for example until the token has received a message that seems to be error free or until the token has received sufficient message parts that seem to be error free and from which the token can construct the entire message. </p><p id="p0105" num="0105">In some embodiments the data to be sent are divided into a number of original data blocks and the message sent in an emission cycle comprises a combination of all the original data blocks. In some embodiments the order of the original data blocks in the message is the same in each emission cycle. In some embodiments the order of the original data blocks in the message may vary from one emission cycle to the next. In some embodiments each original data block appears exactly once in the message of each emission cycle. In some embodiments some original data blocks may appear more than once in the messages of some emission cycles. In some embodiments the number of original data blocks is fixed. In some embodiments the size of the original data blocks may vary as a function of the total size of the data to be sent and encoded in the message. In some embodiments the maximum size of the original data blocks is fixed. In some embodiments all but one of the original data blocks have the same size. In some embodiments all the original data blocks have the same size and at least one original data block (e.g . the block comprising the last part of the data) may comprise padding. In some embodiments the number of original data blocks may vary as a function of the total size of the data to be sent and encoded in the message. In some embodiments different data blocks may be identified implicitly from the order in which they are being sent in an emission cycle. In some embodiments different data blocks may be identified explicitly from some identification element like an identification tag associated with the data block or a block number. To allow the 
<!-- EPO <DP n="24"/>-->
 authentication token to detect the boundaries of data blocks, in some embodiments at least some of the data blocks may be encoded such that the authentication token may detect the start and/or the end of these data blocks. In some embodiments data blocks may be encoded using some start sequence or start symbol. In some embodiments data blocks may be encoded using some end or stop sequence or end or stop symbol. In some embodiments data blocks are separated from a preceding or a following data block by a separation sequence or a separation symbol. In some embodiments at least some data blocks may comprise a length or size indication of the data block. </p><p id="p0106" num="0106"> [0066] In some embodiments the message sent in an emission cycle comprises multiple blocks and the message may be encoded such that the token may for each block separately detect at least some transmission errors. For example, each block may comprise an error detection code (such as a C C or checksum or a Luhn check digit or an LRC) that has been computed over the data comprised in that block. In some embodiments the blocks in the message may be labelled with an identifier such as a unique number. In some embodiments the token discards received blocks that are apparently affected by transmission errors and buffers received blocks that have apparently been received free from transmission errors. In some embodiments the token continues receiving messages or data blocks until it has received from all the blocks that together make up the message a version that is apparently free from transmission errors. In some embodiments the token continues receiving data blocks until it has received sufficient data blocks that seem to be error free and from which the token can construct the entire message. </p><p id="p0107" num="0107"> [0067] In some embodiments the original data (optionally expanded with padding) to be sent to the authentication token by means of the optical or acoustical input interface is encoded and divided in a number (N+l) of blocks such that the authentication can reconstruct the original data from any combination of N of the N+l blocks. In other words the authentication token can reconstruct the original data as long as not more than one of the N+l blocks is missing. In some embodiments the original data is divided in N original data blocks (which in the remainder of the text may also be referred to as ordinary payload blocks) and an extra redundancy block is added to the message whereby the extra redundancy block is calculated from the N original data (or ordinary payload) blocks such that with the extra redundancy block and any combination of N-l of the original data (or ordinary payload) blocks the authentication token can reconstruct the N original data (or ordinary payload) blocks. In some 
<!-- EPO <DP n="25"/>-->
 embodiments the extra redundancy block is calculated by applying exclusive-or operations and/or modulo additions on the N original data blocks. In some embodiments the original data is divided in N original data blocks whereby each original data block is encoded as a sequence of symbols from a certain set of symbols (which may be bits but which may also be another set of symbols such as a ternary or quaternary set of symbols) and whereby each original data block is further divided in an equal number of symbol groups and whereby an extra redundancy block comprising the same number of symbol groups is calculated whereby each symbol group of the extra redundancy block is calculated from the N corresponding symbol groups of the N original data blocks in such a way that the authentication token can reconstruct any of the symbol groups of any of the N original data blocks from the N-l corresponding symbol groups of the N-l other original data blocks in combination with the corresponding symbol group of the extra redundancy block. In some embodiments the calculations of the symbol groups of the extra redundancy block comprise modulo-additions. In some embodiments the calculations of the symbol groups of the extra redundancy block comprise exclusive-or (XOR) operations. In some </p><p id="p0108" num="0108">embodiments the symbol groups all have the same size. In some embodiments the symbol groups may have different sizes. In some embodiments the calculations of the symbol groups of the extra redundancy block are done in the same way for all symbol groups of the extra redundancy block. In some the calculations of the symbol groups of the extra redundancy block may be done in different ways for different symbol groups of the extra redundancy block. In some embodiments the symbol groups all have the same size. In some embodiments symbol groups may have different sizes. For example, in some embodiments the original data is divided in N original data blocks of equal size (whereby one or more blocks may comprise padding bits) and an extra redundancy block of the same size is calculated whereby each bit of the extra redundancy block is calculated as the exclusive-or (XOR) of the N bits in the corresponding position of the N original data blocks. In some embodiments the original data is divided in N original data blocks of an equal number of nibbles (whereby one or more blocks may comprise padding bits) and an extra redundancy block of the same number of nibbles is calculated whereby each nibble of the extra redundancy block is calculated as the modulo-16 addition of the N nibbles in the corresponding position of the N original data blocks. In some embodiments the original data is divided in N original data blocks of an equal number of bytes (whereby one or more blocks may comprise padding bits) 
<!-- EPO <DP n="26"/>-->
 and an extra redundancy block of the same number of bytes is calculated whereby each byte of the extra redundancy block is calculated as the modulo- 256 addition of the N bytes in the corresponding position of the N original data blocks. In some embodiments the extra redundancy block may comprise bits that are calculated as an exclusive-or operation over the corresponding bits of the original data blocks, and/or may comprise nibbles that are calculated as a modulo-16 addition of the corresponding nibbles in the original data blocks, and/or may comprise bytes that are calculated as the modulo-256 addition of the corresponding bytes in the original data blocks. </p><p id="p0109" num="0109"> [0068] In some embodiments a message emitted in an emission cycle may comprise more than one extra redundancy blocks. In some embodiments the original data (or ordinary payload) blocks are divided into groups and an extra redundancy block is calculated and added to the message for each group of original data (or ordinary payload) blocks. </p><p id="p0110" num="0110"> [0069] In some embodiments the individual original data blocks (which may contain different payloads comprising different parts of the original data) and the individual extra redundancy block(s) (which may differ from one another as they may have been calculated from the contents of different groups of original data blocks) may be implicitly identified from the order in which they appear in an emission cycle. In some embodiments the different original data blocks and the extra redundancy block(s) may be identified explicitly from some identification element like an identification tag associated with a data block or a block number. In some embodiments the extra redundancy block(s) may have a special identifier such a specific place in the order of emission (e.g . an extra redundancy block may be the first or last block to be emitted in an emission cycle), or the extra redundancy block(s) may have a special identification tag or number (e.g. number 0). In some embodiments the block identifying elements of the original data blocks are not taken into account when calculating the contents of the extra redundancy block(s). </p><p id="p0111" num="0111"> [0070] To allow the authentication token to detect the boundaries of the different </p><p id="p0112" num="0112"> original data blocks (or ordinary payload blocks) and the extra redundancy block, in some embodiments at least some of the blocks may be encoded such that the authentication token may detect the start and/or the end of these blocks. In some embodiments the different original data blocks and/or the extra redundancy block may be encoded using some start sequence or start symbol. In some embodiments the different original data blocks and/or the extra redundancy block may be encoded using some end or stop sequence or end or 
<!-- EPO <DP n="27"/>-->
 stop symbol. In some embodiments the different original data blocks and/or the extra redundancy block are separated from a preceding or a following block by a separation sequence or a separation symbol. In some embodiments at least some of the original data blocks and the extra redundancy block may comprise a length or size indication of the block and/or the entire message. </p><p id="p0113" num="0113">[0071] In some embodiments the original data blocks (or ordinary payload blocks) and/or the extra redundancy data blocks may be encoded such that the receiving authentication token can detect at least some transmission errors in at least some blocks. In some embodiments at least some of the original data blocks (or ordinary payload blocks) and/or the extra redundancy data blocks may comprise an error detection code (such as a CRC or checksum or a Luhn check digit or an LRC) that has been computed over the data comprised in that block. In some embodiments the error detection codes of the original data blocks are not taken into account when calculating the contents of the extra redundancy block(s). </p><p id="p0114" num="0114"> [0072] In some embodiments the authentication token comprises an acoustic and/or optical input interface and is adapted to receive and decode an acoustical and/or optical signal emitted by a computing device whereby the signal may be encoded and emitted as in any of the embodiments described in the preceding paragraphs. For example, in some embodiments the authentication token is adapted to receive and decode an acoustical or optical signal emitted by a computing device wherein the computing device repeats a number of emission cycles whereby in each emission cycle the computing device emits an acoustical and/or optical signal encoding the original data to be sent to the authentication token. In many embodiments these acoustic and/or optical input interfaces are unidirectional and allow only one-way communication i.e. permit the </p><p id="p0115" num="0115"> authentication token only reception of data but not emission of data. </p><p id="p0116" num="0116"> [0073] In some embodiments the authentication token is adapted to perform (for </p><p id="p0117" num="0117"> example by means of an appropriately adapted signal receiving circuit and/or data processing component), when it starts receiving the signal at some random point after the beginning of an emission cycle, a signal reception and decoding method comprising the steps of: starting to decode the signal being received of the current emission cycle without waiting for the beginning of the next emission cycle, buffering (for example by storing in a memory component) at least some of the decoded data of the current emission cycle, combining the buffered data of the current emission cycle with data decoded from the signal being received in the next emission cycle, detecting whether the combined data retrieved from 
<!-- EPO <DP n="28"/>-->
 the first and the subsequent emission cycle comprise all the original data to be received, and, after having thus detected that it has received all the original data, stopping to receive and/or decode a signal and starting to process the received data. </p><p id="p0118" num="0118"> [0074] In some embodiments the authentication token is adapted to perform (for </p><p id="p0119" num="0119"> example by means of an appropriately adapted signal receiving circuit and/or data processing component) a signal reception and decoding method comprising the steps of: decoding an optical and/or acoustical signal encoding original data to be received by the token and emitted by a computing device in multiple emission cycles, buffering (for example by storing in a memory component) parts of the data received in more than one emission cycle, detecting whether the combination of the buffered data comprises all the original data to be received, and, after having thus detected that all the original data to be received have been received, stopping to receive and decode a signal and retrieving the original data by combining in an appropriate way the buffered data and starting to process the original data. </p><p id="p0120" num="0120"> [0075] In some embodiments the authentication token is adapted to receive and </p><p id="p0121" num="0121"> decode an acoustical or optical signal emitted by a computing device whereby the computing device repeats a number of emission cycles whereby in each emission cycle the computing device emits an acoustical and/or optical signal encoding a message comprising the original data to be sent to the </p><p id="p0122" num="0122"> authentication token whereby the message is divided in a number of data blocks. In some embodiments the authentication token may be adapted to detect the boundaries of these data blocks. In some embodiments the authentication token may buffer data blocks received in different emission cycles. In some embodiments the authentication token is adapted to detect whether the combination of buffered data blocks permits to retrieve all the original data. In some embodiments the authentication token is adapted to perform (for example by means of an appropriately adapted signal receiving circuit and/or data processing component) a signal reception and decoding method comprising the steps of: decoding an optical and/or acoustical signal encoding a message comprising original data to be received by the token and emitted by a computing device in multiple emission cycles, whereby the message comprises multiple data blocks, detecting in the decoded signal data blocks, buffering (for example by storing in a memory component) message data blocks received in more than one emission cycle, detecting whether the combination of the buffered data blocks permits to retrieve all the original data 
<!-- EPO <DP n="29"/>-->
 to be received, and, after having thus detected that all the original data to be received can be retrieved from the buffered data blocks, stopping to receive and decode a signal and retrieving the original data by combining in an appropriate way the buffered data blocks and starting to process the original data. </p><p id="p0123" num="0123">In some embodiments the authentication token is adapted to receive and decode an acoustical or optical signal emitted by a computing device wherein the computing device repeats a number of emission cycles whereby in each emission cycle the computing device emits an acoustical and/or optical signal encoding a message comprising the original data to be sent to the </p><p id="p0124" num="0124">authentication token whereby the message is divided in a number of data blocks and whereby at least some of the data blocks comprise an error detection code. In some embodiments the authentication token may be adapted to detect the boundaries of these data blocks. In some embodiments the authentication token may be adapted to verify error detection codes of received data blocks. In some embodiments the authentication token may buffer data blocks received in different emission cycles. In some embodiments the authentication token buffers a data block only on condition that verification of an error detection code associated with that data block doesn't indicate that the data block contains a transmission error. In some embodiments the authentication token is adapted to detect whether the combination of buffered data blocks permits to retrieve all the original data. In some embodiments the authentication token is adapted to perform (for example by means of an appropriately adapted signal receiving circuit and/or data processing component) a signal reception and decoding method comprising the steps of: decoding an optical and/or acoustical signal encoding a message comprising original data to be received by the token and emitted by a computing device in multiple emission cycles, whereby the message comprises multiple data blocks, detecting data blocks in the decoded signal, verifying the error detection codes associated with any received message data block, buffering (for example by storing in a memory component) message data blocks received in more than one emission cycle on condition that the verification of the error detection codes associated with these data blocks doesn't indicate a transmission error in these data blocks, detecting whether the combination of the buffered data blocks permits to retrieve all the original data to be received, and, after having thus detected that all the original data to be received can be retrieved from the buffered data blocks, stopping to receive and decode a signal and retrieving the original data by combining the contents of the buffered data blocks and starting to process the original data. 
<!-- EPO <DP n="30"/>-->
 In some embodiments the authentication token is adapted to receive and decode an acoustical or optical signal emitted by a computing device wherein the computing device repeats a number of emission cycles whereby in each emission cycle the computing device emits an acoustical and/or optical signal encoding a message comprising the original data to be sent to the </p><p id="p0125" num="0125">authentication token whereby the message is divided in a number of data blocks comprising at least two original data (or ordinary payload) blocks and one or more extra redundancy blocks whereby each redundancy block is calculated from a group of original data blocks as described in the preceding paragraphs. In some embodiments the authentication token may be adapted to detect the boundaries of these data blocks. In some embodiments the authentication token may buffer data blocks received in different emission cycles. In some embodiments the authentication token is adapted to detect whether the combination of buffered data blocks permits to retrieve all the original data. In some embodiments the authentication token is adapted to detect whether any missing original data block can be calculated from the combination of one or more extra redundancy blocks and one or more original data blocks that have already been received. In some embodiments the authentication token is adapted to perform (for example by means of an appropriately adapted signal receiving circuit and/or data processing component) a signal reception and decoding method comprising the steps of: decoding an optical and/or acoustical signal encoding a message comprising original data to be received by the token and emitted by a computing device in multiple emission cycles, whereby the message comprises multiple data blocks, detecting data blocks in the decoded signal, buffering (for example by storing in a memory component) message data blocks received in more than one emission cycle, detecting whether a buffered data block is an original data block or an extra redundancy data block, detecting whether the combination of the buffered data blocks permits to retrieve all the original data to be received, and, after having thus detected that all the original data to be received can be retrieved from the buffered data blocks, stopping to receive and decode a signal and retrieving the origina l data by combining in an appropriate way the buffered data blocks and starting to process the original data; whereby the step of detecting whether the combination of the buffered data blocks permits to retrieve all the original data to be received comprises detecting whether the buffered data blocks comprise all different original data blocks or whether any missing original data block can be calculated from one or more of the buffered original data blocks and one or more of the buffered extra 
<!-- EPO <DP n="31"/>-->
 redundancy blocks; and whereby retrieving the original data by combining in an appropriate way the buffered data blocks comprises, in case at least one of the original data blocks is not present among the buffered data blocks but it has been detected that it can be calculated from the buffered data blocks, calculating the one at least one missing original data block from one or more of the buffered original data blocks and one or more of the buffered extra redundancy blocks. </p><p id="p0126" num="0126"> In some embodiments the authentication token is adapted to receive and decode an acoustical or optical signal emitted by a computing device wherein the computing device repeats a number of emission cycles whereby in each emission cycle the computing device emits an acoustical and/or optical signal encoding a message comprising the original data to be sent to the </p><p id="p0127" num="0127">authentication token whereby the message is divided in a number of data blocks comprising at least two original data (or ordinary payload) blocks and one or more extra redundancy blocks whereby each redundancy block is calculated from a group of original data blocks as described in the preceding paragraphs and whereby at least some of the data blocks comprise an error detection code. In some embodiments the authentication token may be adapted to detect the boundaries of these data blocks. In some embodiments the authentication token may be adapted to verify error detection codes of received data blocks. In some embodiments the authentication token may buffer data blocks received in different emission cycles. In some embodiments the authentication token may be adapted to buffer received data blocks on condition that verification of error detection codes associated with these received data blocks doesn't indicate that these data blocks contain transmission errors. In some embodiments the authentication token is adapted to detect whether the combination of buffered data blocks permits to retrieve all the original data. In some embodiments the authentication token is adapted to detect whether any missing original data block can be calculated from the combination of one or more extra redundancy blocks and one or more original data blocks that have already been received. In some embodiments the authentication token is adapted to perform (for example by means of an appropriately adapted signal receiving circuit and/or data processing component) a signal reception and decoding method comprising the steps of: decoding an optical and/or acoustical signal encoding a message comprising original data to be received by the token and emitted by a computing device in multiple emission cycles, whereby the message comprises multiple data blocks, detecting data blocks in the decoded signal, verifying the error 
<!-- EPO <DP n="32"/>-->
 detection codes associated with any received message data block, buffering (for example by storing in a memory component) message data blocks received in more than one emission cycle on condition that the verification of the error detection codes associated with these data blocks doesn't indicate a </p><p id="p0128" num="0128"> transmission error in these data blocks, detecting whether a buffered data block is an orig inal data block or an extra redundancy data block, detecting whether the combination of the buffered data blocks permits to retrieve all the orig inal data to be received, and, after having thus detected that all the original data to be received can be retrieved from the buffered data blocks, stopping to receive and decode a sig nal and retrieving the origina l data by combining in an appropriate way the buffered data blocks and starting to process the original data ; whereby the step of detecting whether the combination of the buffered data blocks permits to retrieve all the orig inal data to be received comprises detecting whether the buffered data blocks comprise all d ifferent original data blocks or whether any missing original data block can be calcu lated from one or more of the buffered original data blocks and one or more of the buffered extra redu ndancy blocks; and whereby retrieving the origina l data by combining in an appropriate way the buffered data blocks comprises, in case at least one of the original data blocks is not present among the buffered data blocks but it has been detected that it ca n be calcu lated from the buffered data blocks, calcu lating the one at least one missing orig inal data block from one or more of the buffered original data blocks and one or more of the buffered extra redu ndancy blocks. </p><p id="p0129" num="0129"> [0079] In some embodiments a n authentication token may be adapted to calculate a missing orig inal data block from an extra redundancy block (that was calculated on the sending side by using the orig inal data block that is missing on the receiving side) that the token received and buffered and from the other origina l data blocks that were used to calculate the extra redundancy block and that have been received and buffered by the authentication token . In some embodiments the token may be adapted to calcu late the missi ng original data blocks by applying a method that is compl imentary to the method that was used to calculate the extra redundancy block. </p><p id="p0130" num="0130"> [0080] In some embodiments the token may be adapted to calculate the missing </p><p id="p0131" num="0131"> orig inal data blocks by applying the same method that was used to calcu late the extra redu ndancy block but substituting in the calcu lations the extra red u ndancy block for the missing orig inal data block. For example, in some embodiments the contents of an extra redundancy block may have been calculated as the 
<!-- EPO <DP n="33"/>-->
 bitwise exclusive-or'ing of a the contents of a number of original data blocks and the token may have been adapted to calculate the contents of one of these original data blocks if and when the other original data blocks and the extra redundancy block have been received by performing a bitwise exclusive-or'ing on the contents of the received extra redundancy data block and the received other original data blocks. </p><p id="p0132" num="0132"> [0081] In some embodiments the token may be adapted to calculate the missing </p><p id="p0133" num="0133"> original data blocks by applying the same method that was used to calculate the extra redundancy block but substituting in the calculations the extra redundancy block for the missing original data block and substituting transformed versions of the received original data blocks for the other original data blocks. For example, in some embodiments subgroups of the contents of an extra redundancy block may have been calculated by adding the numeric values of corresponding subgroups of the contents of a number of original data blocks (e.g. calculating the nibbles of the extra redundancy block by doing a modulo-16 addition of the corresponding nibbles of the original data blocks), and the token may have been adapted to calculate the contents of one of these original data blocks (if and when the other original data blocks and the extra redundancy block have been received) by performing per subgroup of the missing original data block an addition of the numeric value of the corresponding subgroup of the contents of the received extra redundancy data block and the inverse of the numeric values of the corresponding subgroups of the contents of the received other original data blocks (whereby the inverse of a value in this context means the value multiplied by minus one). </p><p id="p0134" num="0134"> Advantageous effects </p><p id="p0135" num="0135"> [0082] An important advantage of the present invention is that a strong authentication token equipped with an acoustic interface including a relatively small number of low-cost components can receive input data at a considerably higher rate than a strong authentication token equipped with an optical interface of similar cost. </p><p id="p0136" num="0136"> [0083] Another advantage of the present invention is that a strong authentication token with an acoustical interface but without a keypad (or with a keypad with only a reduced set of keys) can still receive data input in a way that is convenient for the user while having considerably reduced dimensions in comparison to a token that is equipped with a keypad with a full set of at least numerical keys. </p><p id="p0137" num="0137"> [0084] Another distinct advantage of the present invention is that a strong </p><p id="p0138" num="0138"> authentication token equipped with an acoustic interface including a </p><p id="p0139" num="0139"> demodulation circuit according to some of the embodiments of the invention 
<!-- EPO <DP n="34"/>-->
 allows for robust and reliable demodulation of an acoustic signal even in the presence of background noise and multi-path reception reflections. </p><p id="p0140" num="0140"> [0085] Yet another advantage of the present invention is that a judicious encoding and decoding of the data to be transmitted according to some of the embodiments of the invention makes the transfer of the data over a unidirectional optical or acoustical interface more reliable and efficient. </p><p id="p0141" num="0141"> Brief Description of the Drawings </p><p id="p0142" num="0142"> [0086] The foregoing and other features and advantages of the invention will be </p><p id="p0143" num="0143"> apparent from the following, more particular description of an embodiment of the invention, as illustrated in the accompanying drawings. </p><p id="p0144" num="0144"> [0087] Figure 1 illustrates a typical implementation of the invention. </p><p id="p0145" num="0145"> [0088] Figure 2 schematically illustrates another typical implementation of the </p><p id="p0146" num="0146"> invention. </p><p id="p0147" num="0147"> [0089] Figure 3 schematically illustrates a demodulation circuit according to an aspect of the invention. </p><p id="p0148" num="0148"> [0090] Figure 4 is a flow chart depicting a strong authentication method for use with an authentication token according to an aspect of the present invention. </p><p id="p0149" num="0149">[0091] Figure 5 is a flow chart depicting a method according to an aspect of the </p><p id="p0150" num="0150"> invention to secure a user's access to a remote application. </p><p id="p0151" num="0151">[0092] Figure 6 illustrates the format of a message encoding data to be sent to an authentication token over an acoustical and/or optical interface according to an aspect of the present invention. </p><p id="p0152" num="0152">[0093] Figure 7 is a flow chart depicting a method according to an aspect of the </p><p id="p0153" num="0153"> invention to encode a message comprising data to be sent to an authentication token over an acoustical and/or optical interface according to an aspect of the present invention. </p><p id="p0154" num="0154"> [0094] Figure 8 is a flow chart depicting a method according to an aspect of the </p><p id="p0155" num="0155"> invention to decode a message comprising data received by an authentication token via the token's acoustical and/or optical interface according to an aspect of the present invention. </p><p id="p0156" num="0156"> Detailed description </p><p id="p0157" num="0157"> [0095] Some implementations of the present invention are discussed below. While </p><p id="p0158" num="0158"> specific implementations are discussed, it should be understood that this is done for illustration purposes only. A person skilled in the relevant art will recognize that other components and configurations may be used without parting from the spirit and scope of the invention. 
<!-- EPO <DP n="35"/>-->
 [0096] Figure 1 illustrates a typical implementation of the invention consisting of a token ( 100) for generating secu rity values such as one-time passwords to authenticate a user or transaction signatures to indicate the user's approval of a transaction, including : </p><p id="p0159" num="0159"> • an acoustical interface ( 110) for receiving acoustica l signals transmitting input data for the token ; </p><p id="p0160" num="0160"> • a trustworthy output interface ( 130), such as for exa mple a display or an aud io output interface, to communicate information, such as said security values or transaction data to be approved, to the user; </p><p id="p0161" num="0161"> • (optionally) one or more additional data input interfaces, such as a manual user data input interface ( 120) comprising for example a keypad and/or an optical data input interface ( 140) comprising for example one or more photosensitive elements such as an array of photosensitive elements, for receiving input data (which may include a challenge and/or transaction data) and/or to captu re the user's approval of transaction data ; </p><p id="p0162" num="0162"> • a data processing component ( 150), such as a microprocessor, a controller, an FPGA ( Field Prog ram mable Gate Array) or a n ASIC (Application Specific Integrated Circu it), capable of cryptog raphic operations, for generating security values (such as dynamic passwords and/or electronic signatu res) and/or verifying server credentials, using secrets shared with a server; </p><p id="p0163" num="0163"> • a data storage component ( 160), such as a ROM, EEPROM, or battery- backed RAM, for storing configu ration data and/or storing secrets which may include an access code to the token (e.g . a PIN) and/or secrets shared with a server and used for generating security values and/or verifying server credentials; </p><p id="p0164" num="0164"> • a clock ( 170) to provide a time value that can be used in the verification of a server credential or in the generation of a security value. </p><p id="p0165" num="0165"> In some embod iments the keypad ( 120) may comprise less keys then the keys shown on figure 1. In some embod iments the keypad ( 120) may comprise more keys then the keys shown on figure 1. </p><p id="p0166" num="0166"> In one embodiment the acoustical interface ( 110) includes a microphone and a demodulation circuit. </p><p id="p0167" num="0167"> [0097] In some embodiments, the data processing component ( 150) implements an in put interface selection mechanism to select either the optical ( 140) or the acoustical ( 110) input interface to receive input data. </p><p id="p0168" num="0168"> [0098] In some embod iments the token ( 100) is a handheld device. In some </p><p id="p0169" num="0169"> embodiments the hand held device is compact and has a thickness of less than 1 
<!-- EPO <DP n="36"/>-->
 centimetre and a length less than 150% of the length of a standard credit card and a width less than 150% of the width of a standard credit card. In some embodiments the handheld device weighs less than 70 grams. In some embodiments the handheld device comprises one or more batteries. In some embodiments the handheld device comprises one or more replaceable batteries. In some embodiments the handheld device's sole power supply consists of one or more batteries. </p><p id="p0170" num="0170"> Figure 2 schematically illustrates another typical implementation of the invention consisting of a first security device (101) for generating security values such as one-time passwords to authenticate a user or transaction signatures to indicate the user's approval of a transaction, and capable of communicating with a removable second security device (102), such as for example a smart card, to which for example some cryptographic operations can be delegated, including : </p><p id="p0171" num="0171"> • an acoustical interface ( 111) for receiving acoustical signals transmitting input data; </p><p id="p0172" num="0172"> • a trustworthy output interface (131), such as for example a display or an audio output interface, to communicate information, such as said security values or transaction data to be approved, to the user; </p><p id="p0173" num="0173"> • (optionally) additional data input interfaces, such as a manual user data input interface (121) comprising for example a keypad and/or an optical data input interface (141) comprising for example one or more </p><p id="p0174" num="0174"> photosensitive elements such as an array of photosensitive elements, for receiving input data (which may include a challenge and/or transaction data) and/or to capture the user's approval of transaction data; </p><p id="p0175" num="0175"> • a data processing component (151), such as a microprocessor, a controller, an FPGA (Field Programmable Gate Array) or an ASIC (Application Specific Integrated Circuit), that may be capable of cryptographic operations, for generating security values (such as dynamic passwords and/or electronic signatures) and/or verifying server credentials, whereby secrets maybe used that are shared with a server and whereby the generating and/or verifying may be done in cooperation with the removable security device; </p><p id="p0176" num="0176"> • a data storage component (161), such as a ROM, EEPROM, or battery- backed RAM, e.g. for storing configuration data and/or secrets which may include secrets shared with a server and used for generating security values and/or verifying server credentials; 
<!-- EPO <DP n="37"/>-->
 • an interface ( 181), including for example a smart card connector (182), to interact with a removable security device ( 102). </p><p id="p0177" num="0177"> In some embodiments the keypad (121) may comprise less keys then the keys shown on figure 2. In some embodiments the keypad (121) may comprise more keys then the keys shown on figure 2. </p><p id="p0178" num="0178"> In one embodiment the acoustical interface (111) includes a microphone and a demodulation circuit. </p><p id="p0179" num="0179"> [0100] In some embodiments, the data processing component (151) implements an input interface selection mechanism to select either the optical ( 141) or the acoustical ( 111) input interface to receive input data. </p><p id="p0180" num="0180"> [0101] In some embodiments the interface (181) comprises a data communication interface to exchange data with the removable security device. In some embodiments the removable security device (102) is a smart card and the data communication interface comprises a smart card reader for exchanging smart card commands and responses with the smart card. In some embodiments the removable security device (102) is adapted to generate a cryptogram and the data communication interface (181) of the first security device (101) is adapted to send a command to the second security device (102) to generate a cryptogram and to obtain from the second security device (102) the cryptogram generated in response to that command. In some embodiments the second security device (102) generates the cryptogram using a symmetric </p><p id="p0181" num="0181"> cryptographic algorithm and a secret key. In some embodiments the first security device (101) uses a cryptogram obtained from the second security device (102) when generating the security values. In some embodiments the first security device's (101) generating a security value comprises selecting bits from data obtained from the second security device (102). In some </p><p id="p0182" num="0182"> embodiments selecting bits from data obtained from the second security device (102) comprises selecting bits from a cryptogram generated by the second security device (102) and obtained by the first security device (101). In some embodiments the data processing component (151) is adapted to perform cryptographic operations when generating the security values, whereby the cryptographic operations involve a cryptographic key that is derived from data generated by the second security device (102) and obtained by the first security device (101). In some embodiments these cryptographic operations comprise generating a MAC (Message Authentication Code) over transaction data input into the first security device (101). 
<!-- EPO <DP n="38"/>-->
 [0102] In some embodiments the first security device ( 101) is adapted to: </p><p id="p0183" num="0183"> communicate with a smart card (102), to send a smart card command to the smart card (102) instructing the smart card (102) to generate a cryptogram using a symmetric cryptographic algorithm with a secret key stored on the smart card (102) and a counter stored and maintained on the smart card </p><p id="p0184" num="0184"> (102), to receive from the smart card (102) that cryptogram generated by the smart card (102), to derive a symmetric key from that received cryptogram, to use that derived symmetric key to generate a MAC over a set of transaction related data, to transform the MAC into a dynamic security value and to present that dynamic security value to the user by means of output interface (131). In some embodiments the first security device (101) receives at least one of the set of transaction related data through the acoustical input interface (111). </p><p id="p0185" num="0185"> [0103] In some embodiments the first security device ( 101) is a handheld device. In some embodiments the handheld device is compact and has a thickness of less than 1 centimetre and a length less than 150% of the length of a standard credit card and a width less than 150% of the width of a standard credit card. In some embodiments the handheld device weighs less than 70 grams. In some embodiments the handheld device comprises one or more batteries. In some embodiments the handheld device comprises one or more replaceable batteries. In some embodiments the handheld device's sole power supply consists of one or more batteries. </p><p id="p0186" num="0186"> [0104] Figure 3 schematically illustrates a demodulation circuit (300) according to an aspect of the invention. </p><p id="p0187" num="0187"> [0105] In one embodiment an input node (310) of the demodulation circuit (300) is connected to a microphone that receives an acoustical signal. Optionally the demodulation circuit (300) includes a pre-amplifying component (320) which selectively amplifies the input signal at input node (310). The optionally selectively amplified input signal is fed to on the one hand the phase-locked loop (330) and on the other hand to each of the demodulator components (340 &amp; 341). The phase-locked loop (330) is tuned to a base frequency and generates a number of reference signals. Each reference signal is at a specific frequency that is an exact integer multiple of the base frequency that the phase-locked loop (330) is synchronising to. The frequencies of the reference signals correspond to the coding frequencies that are assumed to have been used to modulate the acoustic input signal. The phase-locked loop (330) provides to each of the demodulator components (340 &amp; 341) one of these reference 
<!-- EPO <DP n="39"/>-->
 signals. Each demodulator component (340, 341) combines the input signal with the reference signal it receives from the phase-locked loop (330) and outputs a signal with a low frequency component that is indicative of the power in the input signal at the frequency of the reference signal that the demodulator component (340, 341) receives from the phase-locked loop (330). The output signals of each demodulator component (340, 341) is filtered by a low pass filter (350, 351) and the output of each low-pass filter (350, 351) is fed to a ratio detector (360) which compares the signals of the low pass filters (350, 351) and outputs at output terminal (370) a digital signal that indicates at which coding frequency the input signal has the most power. Given that in general a directly received signal has higher power than a reflected (and delayed) signal, distortions of the input signal due to reflections will be efficiently suppressed. While in figure 3 only two sets of demodulator component and corresponding low-pass filter have been illustrated, it shall be clear that the number of demodulator components and corresponding low-pass filters, and thus the number of coding frequencies, can in some embodiments be larger. </p><p id="p0188" num="0188"> [0106] In some embodiments a data processing component is connected to the output terminal (370) of the demodulation circuit (300) to further process the digital output signal and to recover and process the input data. In some embodiments the data processing component may include a microprocessor or a </p><p id="p0189" num="0189"> microcontroller or a field-programmable gate array (FPGA) or an application specific integrated circuit (ASIC). </p><p id="p0190" num="0190"> [0107] In some embodiments the pre-amplifying component (320) includes a bandpass filter which suppresses frequencies lower than the lowest coding frequency and suppresses frequencies higher than the highest coding frequency. Given that any power in the input signal at frequencies outside this range can only be due to background noise, this contributes to cancellation of background noise. In some embodiments the pre-amplifying component (320) includes an auto- gain control functionality. </p><p id="p0191" num="0191"> [0108] In some embodiments the cut-off frequency of the low-pass filters (350, 351) is more or less at the assumed baud rate of the input signal. In some particular embodiments the cut-off frequency of the low-pass filters (350, 351) is less than twice the assumed baud rate of the input signal. </p><p id="p0192" num="0192"> [0109] In some embodiments the phase-locked loop (330) has a very small capture range. It works on a more or less fixed base frequency and only very small 
<!-- EPO <DP n="40"/>-->
 deviations are possible to ensure phase lock to that base frequency. It should be noted that the phase-locked loop (330) is also capable to lock on integer multiples of the base frequency. </p><p id="p0193" num="0193"> [01 10] In some embodiments the phase-locked loop includes a digital phase-locked loop. In some embodiments the phase-locked loop includes a numerical controlled oscillator. </p><p id="p0194" num="0194"> [011 ] In some embodiments the demodulator components include a synchronous AM (amplitude modulation) demodulator. In some embodiments the demodulator components include a product detector. In some embodiments each </p><p id="p0195" num="0195"> demodulator component effectively multiplies the input signal with the reference signal at frequency fx that it receives from the phase-locked loop (330). I.e. their output signal has a low-frequency component Mow = fx - fx = DC and a high frequency component f_high = f x + fx = 2*fx. The latter high frequency is removed or at least attenuated by the low pass filter connected to that demodulator component. As a consequence most of the background noise in the received input signal is minimized by this low pass filter. In some embodiments the demodulator components may include a conditional inverter. In some embodiments the demodulator components may include a double balanced mixer. </p><p id="p0196" num="0196"> [01 12] In some embodiments the lowest coding frequency is equal to the base </p><p id="p0197" num="0197"> frequency. </p><p id="p0198" num="0198"> [01 13] In other embodiments there are two coding frequencies. </p><p id="p0199" num="0199"> [01 14] In yet other embodiments the coding frequencies are integer multiples of the lowest coding frequency. </p><p id="p0200" num="0200"> [01 5] FIG. 4 depicts a flowchart 400 of steps for use with a strong authentication token ( 100/101) to generate strong security values. Although, the steps of flow chart 400 are described below with reference to the apparatus of FIGs. 1- 3, it will be understood by one of skill in the art from the description herein that the method may be performed using other apparatus without departing from the scope of the present invention. </p><p id="p0201" num="0201"> [01 6] At block 402, an acoustical signal including input data is received from a remote computer system . The acoustical signal may be received at an authentication token 100/101 from a computer system such as a PC, a Tablet Computer, or a Smartphone, or some other computing/processing device with which the user interacts. The authentication token (100/101) may be one of the </p><p id="p0202" num="0202"> authentication tokens with an acoustical input interface (111) described in any 
<!-- EPO <DP n="41"/>-->
 of the preceding paragraphs. The input data may include data used for authentication/validation such as a challenge, transaction data, or server credentials. </p><p id="p0203" num="0203"> [0117] At block 404, input data is obtained by demodulating the acoustic signal. The acoustical signal may be demodulated using demodulation circuit 300. </p><p id="p0204" num="0204"> [0118] At block 404, the dynamic security values are generated. The dynamic security values may be generated at the authentication token (100/101) as described in any of the preceding paragraphs. The dynamic security value may be generated at the authentication token 100/101 by recovering input data from the demodulated acoustical signal and processing the recovered input data with data processing component 150/151. The authentication token 100/101 may include a communication interface (182) for communicating with a removable security device (102) such as a smart card and the generating step may include generating the dynamic security value with the authentication token (100/101) in cooperation with the removable security device (102). The authentication method may additionally include receiving an optical signal including additional input data and the generating step may include combining the recovered input data and the additional input data. </p><p id="p0205" num="0205"> [0119] Figure 5 illustrates various steps of a method (500) according to an aspect of the invention to secure a user's access to a remote application. In some embodiments some steps may be performed in a different order than described here. In some embodiments some steps may be omitted. In some </p><p id="p0206" num="0206"> embodiments extra steps may be performed. </p><p id="p0207" num="0207"> [0120] In step 501 an authentication token with an acoustical input interface (such as one of the authentication tokens (100/101) described in any of the preceding paragraphs) is made available to a user. In (optional) step 502 also a removable second security device ( 102) such as a smart card (which may be a financial card compliant with the EMV standard) is made available to the user e.g. to be used in conjunction with the authentication token (100/101) (in which case the authentication token (100/101) may comprise a communication interface to communicate with the second security device (102)). </p><p id="p0208" num="0208"> [0121] In step 505 the user is accessing the remote application (hosted by an </p><p id="p0209" num="0209"> application server) from a computing device (such as a PC, Tablet Computer or Smartphone) e.g. over a communication network which may comprise for example a (computer) network such as the internet or a (mobile) telephone network and using for example a web browser running on the computing device. 
<!-- EPO <DP n="42"/>-->
 [0122] In step 510 an application or application server assembles input data. The input data may for example comprise a challenge or transaction related data or transaction context related data or a server credential. In the (optional) sub- step 511 the application or application server generates the server credential. </p><p id="p0210" num="0210"> [0123] In step 520 the application or application server sends the input data (for </p><p id="p0211" num="0211"> example embedded in one or more web pages) to the user's computing device that the user is using to access the remote application e.g. over the internet. </p><p id="p0212" num="0212"> [0124] In step 525 the user's computing device is made to emit a modulated acoustical signal that encodes the input data. In (optional) step 526 the user's computing device is made to emit an optical signal that encodes data. In some </p><p id="p0213" num="0213"> embodiments the data encoded in the optical signal comprises part or all of the data encoded in the acoustical signal. </p><p id="p0214" num="0214"> [0125] In step 530 the acoustical token (100/101) receives the acoustical and/or the optical signal and recovers the data encoded in the acoustical and/or optical signal. </p><p id="p0215" num="0215"> [0126] In step 535 the acoustical token (100/101) generates a dynamic security </p><p id="p0216" num="0216"> value. The authentication token (100/101) may generate the dynamic security value as described in any of the preceding paragraphs. In some embodiments the acoustical token ( 100/101) may use data recovered from the acoustical and/or the optical signal for the generation of the dynamic security value. In step 536 the authentication token ( 100/101) verifies a server credential comprised in the data recovered from the acoustical and/or the optical signal. In some embodiments the generation of the dynamic security value is conditional on the successful verification of the server credential. In step 537 the authentication token ( 100/101) outputs the generated dynamic security value to the user. </p><p id="p0217" num="0217"> [0127] In step 540 the user sends the generated dynamic security value to the </p><p id="p0218" num="0218"> application or application server, for example by typing the digits making up the dynamic security value into a form field of a web page of the application . </p><p id="p0219" num="0219"> [0128] In step 550 the application or application server receives the dynamic security value. In step 551 the application or application server verifies the received dynamic security value. This verification may happen as described in some of the preceding paragraphs. </p><p id="p0220" num="0220"> [0129] In step 560 the application or application server takes appropriate action which depends on the outcome of the verification of the received dynamic security value, as described in some of the preceding paragraphs. 
<!-- EPO <DP n="43"/>-->
 Figure 6 illustrates the format of a message encoding data to be sent to an authentication token (such as a token 100/101 illustrated in figure 1 or 2) over an acoustical and/or optical interface according to an aspect of the present invention. The message (600) may comprise a one or more of data blocks (610, 630, 650). While figure 6 illustrates three data blocks (610, 630, 650), in some embodiments the message (600) may comprise only a single data block (610) or only two data blocks (610 and 630 or 650). While figure 6 illustrates for clarity a message (600) with only three data blocks, in some embodiments the message (600) may actually comprise more than three data blocks, as symbolized by the dots in between the illustrated data blocks (610, 630, 650). Some of the data blocks in the message (600) may be ordinary payload blocks (610, 630) that comprise at least a part of the original payload data to be sent to the authentication token (100/101). While figure 6 illustrates two ordinary payload blocks (610 and 630), in some embodiments the message (600) may comprise only one ordinary payload block while in other embodiments the message (600) may comprise more than two payload blocks. Some of the payload blocks may comprise padding (not illustrated). Some of the data blocks may be extra redundancy blocks (650) that are each calculated from the contents of a number of the ordinary payload blocks as described in some of the preceding and following paragraphs. I.e. for the purpose of calculating the extra redundancy blocks the ordinary payload blocks may be grouped, or in other words the contents of some ordinary payload blocks may have been used to calculate one extra redundancy block, while the contents of some other ordinary payload blocks may have been used to calculate another extra redundancy block. While figure 6 illustrates one extra redundancy clock (650), in some embodiments the message (600) doesn't contain any extra redundancy block and in other embodiments the message (600) may comprise more than one redundancy blocks. Some of the extra redundancy blocks may comprise padding (not illustrated). In some embodiments at least some of the ordinary payload blocks and/or the extra redundancy blocks may comprise an </p><p id="p0221" num="0221">identification element (611, 631, 651) such as for example a tag or a number. In some embodiments at least some of the ordinary payload blocks and/or the extra redundancy blocks may comprise a start sequence or symbol (612, 632, 652). In some embodiments at least some of the ordinary payload blocks and/or the extra redundancy blocks may comprise an end sequence or symbol (613, 633, 653). In some embodiments at least some of the ordinary payload blocks and/or the extra redundancy blocks may comprise a length indicator 
<!-- EPO <DP n="44"/>-->
 (614, 634, 654). In some embodiments the extra redundancy blocks (650) may comprise one or more sub-blocks (656 and 657) which have been calculated from corresponding sub-blocks (respectively 616, 636 and 617, 637) in ordinary payload blocks (610 and 630). In some embodiments corresponding sub-blocks have the same size. In some embodiments corresponding sub-blocks may have different sizes (in which case the calculation of the corresponding sub-block of an extra redundancy block may comprise adding padding to one or more sub- blocks). In some embodiments sub-blocks of the same data block have the same size. In some embodiments sub-blocks of the same data block may have different sizes. While in figure 6 each data block has two sub-blocks, in some embodiments data blocks may have one sub-block and in other embodiments data blocks may have more than two sub-blocks. </p><p id="p0222" num="0222">Figure 7 is a flow chart depicting a method according to an aspect of the invention to encode a message comprising data to be sent to an authentication token over an acoustical and/or optical interface according to an aspect of the present invention. The method 700 comprises the steps of: </p><p id="p0223" num="0223"> a. assembling (710) the payload data; </p><p id="p0224" num="0224"> b. (optionally) adding (711) padding to the payload data; </p><p id="p0225" num="0225"> c. creating (720) one or more payload blocks each containing at least some of the (optionally padded) payload whereby in some embodiments the one or more payload blocks together comprise at least all the payload data; d. (optionally) adding (721) padding to at least some of the payload blocks; e. (optionally) calculating (730) one or more extra redundancy blocks; </p><p id="p0226" num="0226"> f. (optionally) adding (740) an identification element (such as a tag or a number) to at least some of the payload and/or extra redundancy blocks; g. (optionally) adding (750) a start sequence or symbol to at least some of the payload and/or extra redundancy blocks; </p><p id="p0227" num="0227"> h. (optionally) adding (751) an end sequence or symbol to at least some of the payload and/or extra redundancy blocks; </p><p id="p0228" num="0228"> i. (optionally) adding (752) a separation sequence or symbol between at least some of the payload and/or extra redundancy blocks; </p><p id="p0229" num="0229"> j. (optionally) adding (753) a length indication to at least some of the </p><p id="p0230" num="0230"> payload and/or extra redundancy blocks; </p><p id="p0231" num="0231"> k. (optionally) adding (760) an error detection code to at least some of the payload and/or extra redundancy blocks; </p><p id="p0232" num="0232"> I. Combining (770) the data blocks (i.e. the payload and, if applicable, the extra redundancy blocks) in an appropriate order into a message, whereby 
<!-- EPO <DP n="45"/>-->
 in some embodiments extra elements (such as protocol version numbers) may also be added to the message. In some embodiments the data blocks comprise an explicit identification element and the order of the data blocks in the message is arbitrary and may even vary from one emission cycle to another. In some embodiments at least some of the data blocks may lack an explicit identification element and the blocks are ordered in the message in a specific well-defined order so that the identity of the blocks is implicitly indicated by the order in which they appear in the message. For example in some embodiments the payload blocks are ordered in the message according to the order that their payload data appears in the original data string and the payload blocks are followed by exactly one extra redundancy block. </p><p id="p0233" num="0233">[00132] In some embodiments the calculation of an extra redundancy block comprises combining data from a group of payload blocks. In some embodiments there is exactly one extra redundancy block which is calculated from the contents of all the payload blocks. In some embodiments there are two extra redundancy blocks and the contents of each payload block is used for the calculation of either one or the other extra redundancy block. For example, in some embodiments there are two extra redundancy blocks and the contents of the odd numbered payload blocks is used for the calculation of the first extra redundancy block and the contents of the even numbered payload blocks is used for the calculation of the second extra redundancy block. In some embodiments there are more than two extra redundancy blocks and the contents of each payload block is used once in the calculation of one of the extra redundancy block. In some embodiments the groups of payload blocks for calculating the extra redundancy blocks may overlap i.e. the contents of some payload blocks may be used in the calculation of more than one extra redundancy block. </p><p id="p0234" num="0234">[00133] In some embodiments the calculation of an extra redundancy block comprises calculating a number of extra-redundancy sub-blocks by combining for each extra-redundancy sub-block corresponding sub-blocks from payload blocks from a group of payload blocks and then combining (e.g. by concatenation) the calculated extra-redundancy sub-blocks into the extra redundancy block. For example, in some embodiments the sub-blocks have the size of a single bit and each bit of the extra redundancy block is calculated by performing an exclusive or operation on the corresponding bits of the payload blocks from which the extra redundancy block is calculated. In some embodiments some extra redundancy sub-blocks may be byte-sized and calculating these byte-sized extra 
<!-- EPO <DP n="46"/>-->
 redundancy sub-blocks may comprise performing a modulo 256 addition of corresponding bytes of the contents of the payload blocks from which the extra redundancy block that comprises the extra redundancy sub-blocks is calculated. In some embodiments the sub-blocks of an extra redundancy block all have the same size. In some embodiments the sub-blocks of an extra redundancy block may have different sizes. In some embodiments the sub-blocks of an extra redundancy block are all calculated in the same way. In some embodiments some of the sub-blocks of an extra redundancy block may be calculated in a different way then others. In some embodiments extra redundancy sub-blocks and the corresponding sub-blocks of the payload blocks they are calculated have the same size. In some embodiments the sub-blocks of payload blocks from which an extra redundancy block is calculated may have a different size. In some embodiments calculating an extra redundancy sub-block from the corresponding sub-blocks of payload blocks may comprise adding padding to at least some of these corresponding sub-blocks. . </p><p id="p0235" num="0235"> [00134] In some embodiments all data blocks have the same size and there is one extra redundancy block that is calculated by combining the (optionally padded) payload of all payload blocks. In some embodiments calculating the extra redundancy block comprises doing a bitwise exclusive-or operation on the payloads of all payload blocks. In some embodiments the start, end and separation sequences are the same. In some embodiments the error detection code comprises a CRC-12. In some embodiments the data blocks are numbered and the numbers of the original data blocks indicate the order of their payload in the original data string. In some embodiments the data blocks also comprise an element indicating the total number of blocks. In some embodiments the message may comprise one extra redundancy block and a specific value (for example <sup>Λ</sup>0') is reserved for numbering this extra redundancy data block. </p><p id="p0236" num="0236"> [00135] In some embodiments the steps of the method of figure 7 are performed in the order as described. In some embodiments some of the steps of the method of figure 7 may be performed in another order than described. </p><p id="p0237" num="0237"> [00136] In some embodiments at least some of the steps of the method of figure 7 may be performed by a server. In some embodiments at least some of the steps of the method of figure 7 may be performed by a user's computing device. In some embodiments a user's computing device may be made to modulate an acoustic or optical signal with a message constructed according to a method as illustrated by figure 7 and to emit the modulated acoustic or optical signal to be 
<!-- EPO <DP n="47"/>-->
 received by an authentication token comprising an acoustical and/or optical input interface. </p><p id="p0238" num="0238"> [0137] Figure 8 is a flow chart depicting a method according to an aspect of the </p><p id="p0239" num="0239"> invention to decode a message comprising data received by an authentication token via the token's acoustical and/or optical interface according to an aspect of the present invention. In some embodiments the message may have been encoded according to a method as described in connection to figure 7. In some embodiments the message may have a format as described in connection to figure 6. </p><p id="p0240" num="0240"> [0138] The method 800 comprises the steps of: </p><p id="p0241" num="0241"> a. Detecting (810) the beginning of one or more data blocks comprised in a (demodulated) acoustical or optical signal. This may comprise detecting a start or separation sequence or symbol. </p><p id="p0242" num="0242"> b. Detecting (815) the end of one or more data blocks. This may comprise detecting an end or separation sequence or symbol or by detecting a length indicator and comparing the detected length indicator with the length of received data. </p><p id="p0243" num="0243"> c. (optionally) Verifying (820) for one or more received data blocks whether the data blocks may contain a transmission error. This may comprise verifying for one or more of the received data blocks an error detection code. </p><p id="p0244" num="0244"> d. (optionally) Detecting (830) the identity of a received data block and </p><p id="p0245" num="0245"> verifying whether the same data block has already been received and buffered. </p><p id="p0246" num="0246"> e. (optionally) Buffering (840) a received data block. This may comprise storing the received data block (in part or in its entirety) or its contents in a memory component of the authentication token. In some embodiments this may be conditional on a transmission error verification for the data block not indicating the presence of a transmission error. In some embodiments this may be conditional on the outcome of verifying (830) whether the same data block has already been buffered. </p><p id="p0247" num="0247"> f. (optionally) Detecting (850) how many payload blocks should be received. g. (optionally) Detecting (860) whether a received data block is an ordinary payload block or an extra redundancy block. </p><p id="p0248" num="0248"> h. (optionally) Verifying (870) whether sufficient data blocks have been </p><p id="p0249" num="0249"> received and/or buffered to retrieve the complete original data to be received. In some embodiments this may comprise verifying (871) 
<!-- EPO <DP n="48"/>-->
 whether all payload blocks comprising parts of the original data to be received have been received and/or buffered. In some embodiments this may comprise verifying (872), in case that if has been detected that not all payload blocks comprising parts of the original data to be received have been received and/or buffered, whether the original data comprised in the payload of the missing payload blocks can be constructed from the payload block(s) and the extra redundancy block(s) that have already been received and/or buffered. In some embodiments verifying whether all payload blocks comprising parts of the original data to be received have been received and/or buffered comprises comparing the number of received and/or buffered payload blocks with an expected number of (different) payload blocks to receive. In some embodiments this number is a fixed parameter known to the authentication token. In some embodiments this number is implicitly or explicitly indicated in the data being received by the authentication token. </p><p id="p0250" num="0250"> i. Retrieving (880) the complete original data from the received and/or buffered data blocks. In some embodiments this may comprise calculating (881) the payload contents of any missing payload blocks from the relevant payload block(s) and the extra redundancy block(s) that have already been received and/or buffered. In some embodiments this calculation is done as has been described in other paragraphs. </p><p id="p0251" num="0251"> j. Processing (890) the retrieved complete original data. In some embodiments the processing of the retrieved original data may already partially start before all original data have been completely received. </p><p id="p0252" num="0252"> [0139] In some embodiments the data blocks received by the authentication token may have been sent by the user's computing device in more than one emission cycle. </p><p id="p0253" num="0253"> [0140] In some exemplary embodiments the original data to be received is contained in a message that is repeatedly sent in a number of emission cycles as an optical and/or acoustical signal. The message may comprise a number of payload blocks that each comprises a different part of the original data and whereby the combination of the payloads of all payload blocks of a message comprises the complete original data. The payloads of one or more of the payload blocks may be padded to ensure that the payloads of all payload blocks have the same size. The message may also comprise an extra redundancy block the contents of which may have been calculated from the contents of all the payload blocks; for example the bits of the contents of the extra redundancy blocks may have been 
<!-- EPO <DP n="49"/>-->
 calculated as a bitwise exclusive-or operation of the corresponding bits of the payloads of the payload blocks. All blocks of the message may furthermore comprise a block number. The message may also comprise an indication of the total number of blocks. A specific value (e.g. zero) may be reserved for the block number of the extra redundancy block. The message may comprise start and/or end and/or separation sequences or symbols to indicate the boundaries of the message and/or the data blocks in the message. The data blocks in the message may comprise an error detection code. The authentication token receiving and demodulating the optical and/or acoustical signal may be adapted to decode the message and retrieving the data comprised in the message by performing the following steps: detecting the boundaries of the data blocks; verifying the error detection codes of the received data blocks; in case a received data block seems error free, verifying the identity of the received data block and verifying whether the received data block has already been buffered; buffering the received data block on condition that it appears error free and not yet buffered; verifying whether all payload blocks of the message have already been buffered; if not all payload blocks of the message have yet been buffered verifying whether all but one of the payload blocks and the extra redundancy block have already been buffered, and if that is the case calculating the contents of the missing payload block by performing a bitwise exclusive-or operation on the contents of the buffered payload blocks and extra redundancy block; </p><p id="p0254" num="0254"> retrieving the original data from the contents of the buffered payload blocks and/or (if applicable) from the calculated contents of the missing payload block. </p><p id="p0255" num="0255"> [0141] In some embodiments the steps of the method of figure 8 are performed in the order as described. In some embodiments some of the steps of the method of figure 8 may be performed in another order than described. </p><p id="p0256" num="0256"> [0142] In some embodiments a strong authentication token (100/101) as described in conjunction to figure 1 or to figure 2 is further adapted to receive and decode signals containing messages (600) having a format as described in conjunction to figure 6. </p><p id="p0257" num="0257"> [0143] In some embodiments a strong authentication token (100/101) as described in conjunction to figure 1 or to figure 2 is further adapted to perform a method (800) for decoding signals and messages as described in conjunction to figure 8. In some embodiments the authentication token (100/101) is adapted to perform all the steps of the method (800) described in figure 8. In some embodiments the authentication token (100/101) is adapted to perform some of the steps of 
<!-- EPO <DP n="50"/>-->
 the method (800) of figure 8. In some embodiments the data processing component (150/151) of the authentication token (100/101) is adapted to perform some of the steps of the method (800) of figure 8. </p><p id="p0258" num="0258"> [0144] An aspect of the invention comprises a method that comprises at least some of the steps of a method described in connection to figure 5 and at least some of the steps of a method described in connection to figure 7. </p><p id="p0259" num="0259"> [0145] An aspect of the invention comprises a strong authentication token (100/101) as described in conjunction to figure 1 or to figure 2 that is further adapted to perform at least some of the steps of a method described in connection to figure 4 and at least some of the steps of a method described in connection to figure 8. </p><p id="p0260" num="0260"> [0146] A number of implementations have been described. Nevertheless, it will be </p><p id="p0261" num="0261"> understood that various modifications may be made. For example, elements of one or more implementations may be combined, deleted, modified, or supplemented to form further implementations. Accordingly, other </p><p id="p0262" num="0262"> implementations are within the scope of the appended claims. In addition, while a particular feature of the present invention may have been disclosed with respect to only one of several implementations, such feature may be combined with one or more other features of the other implementations as may be desired and advantageous for any given or particular application. While various embodiments of the present invention have been described above, it should be understood that they have been presented by way of example only, and not limitation. In particular, it is, of course, not possible to describe every conceivable combination of components or methodologies for purposes of describing the claimed subject matter, but one of ordinary skill in the art may recognize that many further combinations and permutations of the present invention are possible. Thus, the breadth and scope of the present invention should not be limited by any of the above described exemplary embodiments but should be defined only in accordance with the following claims and their equivalents. 
</p></description><claims mxw-id="PCLM44726113" ref-ucid="WO-2012116312-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="51"/>--> Claims </claim-statement><claim id="clm-0001" num="1"><claim-text> 1. A handheld strong authentication token for generating dynamic security values </claim-text><claim-text> comprising : </claim-text><claim-text> a trustworthy user output interface for communicating generated dynamic security values to a user; </claim-text><claim-text> a data storage component for storing data; </claim-text><claim-text> at least one of an acoustical input interface for acoustically receiving input data and an optical input interface for optically receiving input data, the acoustical interface , if present, comprising a microphone and a demodulation circuit connected to the microphone adapted to demodulate an acoustical signal received by the microphone, and the optical input interface, if present, comprising at least one or more optical detectors for receiving an optical signal; and </claim-text><claim-text> a data processing component connected to the at least one of the acoustical input interface and the optical input interface, the data processing component adapted to recover input data transmitted in the acoustical or optical signal received by the at least one of an acoustical input interface and optical input interface, to process the recovered input data, and to generate the dynamic security values; </claim-text><claim-text> wherein the data processing component is further adapted to decode a message comprising at least two data blocks and comprising at least the input data and transmitted in the acoustical or optical signal received by the at least one of the acoustical input interface and the optical input interface by: </claim-text><claim-text> detecting the boundaries of a received data block within the message; </claim-text><claim-text> detecting whether the received data block has already been buffered in the data storage component; </claim-text><claim-text> buffering the received data block in the data storage component if it had not yet been buffered; </claim-text><claim-text> detecting whether the received data block comprises an ordinary payload block comprising at least a part of the input data or an extra redundancy block; </claim-text><claim-text> determining whether the complete input data can be recovered from the buffered ordinary payload blocks; </claim-text><claim-text> determining whether any missing input data can be calculated from the buffered ordinary payload blocks and the buffered extra redundancy blocks; </claim-text><claim-text> calculating at least part of the missing input data from the contents of at least some of the buffered ordinary payload blocks and the contents of at least some of the buffered extra redundancy blocks; </claim-text><claim-text> recovering the complete input data from the buffered ordinary payload blocks or from the buffered ordinary payload blocks and the calculated missing input data. <!-- EPO <DP n="52"/>--> </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. The token of claim 1 wherein the data processing component is further adapted to: detect at least some types of transmission errors in received data blocks; and wherein the buffering of a received data block is further dependent on no transmission errors having been detected for that received data block. </claim-text></claim><claim id="clm-0003" num="3"><claim-text> 3. The token of claim 1 wherein the detecting of the boundaries of a received data block comprises the detection of a start sequence or start symbol or the detection of an end sequence or end symbol or the detection of a separation sequence or separation symbol. </claim-text></claim><claim id="clm-0004" num="4"><claim-text> 4. The token of claim 1 wherein the detecting of the boundaries of a received data block comprises detecting a data length indication and comparing the detected data length indication to the amount of data already received. </claim-text></claim><claim id="clm-0005" num="5"><claim-text> 5. The token of claim 1 wherein the data processing component is further adapted to: determine the number of ordinary payload blocks that should be received; and wherein determining whether the complete input data can be recovered from the buffered ordinary payload blocks comprises comparing the number of buffered ordinary payload blocks to the number of ordinary payload blocks that should be received. </claim-text></claim><claim id="clm-0006" num="6"><claim-text> 6. The token of claim 1 wherein calculating at least part of the missing input data from the contents of at least some of the buffered ordinary payload blocks and the contents of at least some of the buffered extra redundancy blocks comprises calculating sub-blocks of the contents of a missing ordinary payload block by combining corresponding sub-blocks of the at least some of the buffered ordinary payload blocks and corresponding sub-blocks of the at least some of the buffered extra redundancy blocks. </claim-text></claim><claim id="clm-0007" num="7"><claim-text> 7. The token of claim 1 wherein calculating at least part of the missing input data from the contents of at least some of the buffered ordinary payload blocks and the contents of at least some of the buffered extra redundancy blocks comprises performing a bitwise exclusive-or operation over the corresponding bits of contents of the at least some of the buffered ordinary payload blocks and corresponding bits of contents of the at least some of the buffered extra redundancy blocks. </claim-text></claim><claim id="clm-0008" num="8"><claim-text> 8. The token of claim 6 wherein the calculating sub-blocks of the contents of a missing ordinary payload block comprises doing a modulo addition of inverse numeric values of corresponding sub-blocks of the at least some of the buffered ordinary payload blocks and numeric values of corresponding sub-blocks of the at least some of the buffered extra redundancy blocks. </claim-text></claim><claim id="clm-0009" num="9"><claim-text> 9. The token of claim 1, wherein the data storage component is adapted to store </claim-text><claim-text> secrets shared with a server and wherein said data processing component is further adapted to generate said security values using at least one of said secrets. <!-- EPO <DP n="53"/>--> </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. The token of claim 9, wherein the data processing component is further adapted to generate said security values by cryptographically combining at least one of said secrets with a dynamic variable. </claim-text></claim><claim id="clm-0011" num="11"><claim-text> 11. The token of claim 10, wherein the cryptographically combining comprises </claim-text><claim-text> performing a symmetric cryptographic algorithm. </claim-text></claim><claim id="clm-0012" num="12"><claim-text> 12. The token of claim 10, wherein the dynamic variable comprises a time value. </claim-text></claim><claim id="clm-0013" num="13"><claim-text> 13. The token of claim 10, wherein the dynamic variable comprises a counter value.</claim-text></claim><claim id="clm-0014" num="14"><claim-text>14. The token of claim 10, wherein the dynamic variable comprises a challenge value.</claim-text></claim><claim id="clm-0015" num="15"><claim-text>15. The token of claim 10, wherein the dynamic variable comprises a transaction data related value. </claim-text></claim><claim id="clm-0016" num="16"><claim-text> 16. The token of claim 1, wherein the token is a first security device and wherein the token further comprises a communication interface adapted to communicate with a removable second security device and wherein the token is adapted to generate the dynamic security values in cooperation with the second security device. </claim-text></claim><claim id="clm-0017" num="17"><claim-text> 17. The token of claim 16, in which the removable second security device comprises a smart card. </claim-text></claim><claim id="clm-0018" num="18"><claim-text> 18. The token of claim 16, wherein the token is adapted to generate at least one of the dynamic security values by sending a command to the second security device and deriving the at least one dynamic security value from the response of the second security device to said command. </claim-text></claim><claim id="clm-0019" num="19"><claim-text> 19. The token of claim 18, wherein the token is adapted to include a challenge in said command and wherein the response of the second security device is calculated by the second security device as a function of said challenge. </claim-text></claim><claim id="clm-0020" num="20"><claim-text> 20. The token of claim 18, wherein the response by the second security device </claim-text><claim-text> comprises a cryptogram that is calculated by the second security device by cryptographically combining a secret stored by the second security device with a counter value stored and maintained by the second security device using a symmetric cryptographic algorithm. </claim-text></claim><claim id="clm-0021" num="21"><claim-text> 21. The token of claim 20, wherein the token is further adapted to derive a cryptographic key from the response of the second security device and to generate the at least one dynamic security value by cryptographically combining said cryptographic key with at least one transaction data related value. </claim-text></claim><claim id="clm-0022" num="22"><claim-text> 22. The token of claim 1, comprising both the optical and the acoustical input interface.</claim-text></claim><claim id="clm-0023" num="23"><claim-text>23. The token of claim 22, further comprising an interface selection mechanism to select either the acoustical input interface or the optical input interface to receive input data. <!-- EPO <DP n="54"/>--> </claim-text></claim><claim id="clm-0024" num="24"><claim-text>24. The token of claim 23, wherein the token is further adapted to receive from the user an indication which of the acoustical input interface or the optical input interface the token should use. </claim-text></claim><claim id="clm-0025" num="25"><claim-text> 25. The token of claim 23, wherein the interface selection mechanism is adapted to </claim-text><claim-text> determine by means of heuristic rules on the basis of certain characteristics of the signals received through the acoustic input interface and the optical input interface which input interface to select to receive data. </claim-text></claim><claim id="clm-0026" num="26"><claim-text> 26. The token of claim 23, wherein the token is adapted to apply a selection process which comprises trying for a first period of time to receive at least some data through a first one of the optical input interface or the acoustical input interface, and if the trying to receive at least some data during the first period of time is successful selecting the input interface being tried and continue receiving data through the selected input interface, and if the trying to receive at least some data during the first period of time is unsuccessful repeating the selection process with the other of the optical input interface or the acoustical input interface for a second period of time. </claim-text></claim><claim id="clm-0027" num="27"><claim-text> 27. The token of claim 23, in which the token is further adapted to detect transmission errors in the data received through the currently selected input interface and to return to selecting either the acoustical input interface or the optical input interface in case one or more pre-defined criteria concerning the detected transmission errors are met. </claim-text></claim><claim id="clm-0028" num="28"><claim-text> 28. The token of claim 23, adapted to concurrently receive data through both the optical input interface and the acoustical input interface. </claim-text></claim><claim id="clm-0029" num="29"><claim-text> 29. The token of claim 23, further adapted to combine data received through the optical input interface with data received through the acoustical input interface. </claim-text></claim><claim id="clm-0030" num="30"><claim-text> 30. The token of claim 1, further comprising an optical user interface and a smart card interface to communicate with a standard credit card sized smart card, whereby the data processing component is further adapted to generate transaction data signatures by generating a message authentication code (MAC) over transaction data input into the token through the acoustical input or optical input interface, whereby the data processing component generates the MAC using a symmetric cryptographic algorithm with a secret key that is derived from a cryptogram generated by the smart card . </claim-text></claim><claim id="clm-0031" num="31"><claim-text> 31. The token of claim 30, further comprising a manual user data input interface adapted for the user to input a personal identification number (PIN) value and wherein the token is further adapted to submit said PIN value to the smart card for verification prior to the smart card generating said cryptogram and to erase from memory any <!-- EPO <DP n="55"/>--> copy of the PIN value after the token has submitted said PIN value to the smart card for verification. </claim-text></claim><claim id="clm-0032" num="32"><claim-text> 32. The token of claim 31, further comprising an interface selection mechanism to select either the acoustical or the optical input interface to receive input data. </claim-text></claim><claim id="clm-0033" num="33"><claim-text> 33. The token of claim 1, wherein the input data comprise a server credential and </claim-text><claim-text> wherein processing the token is further adapted to verify said server credential.</claim-text></claim><claim id="clm-0034" num="34"><claim-text>34. The token of claim 33, wherein said generating of the dynamic security values is conditional upon said verifying of said server credential being successful. </claim-text></claim><claim id="clm-0035" num="35"><claim-text> 35. The token of claim 33, further comprising a data storage component for storing </claim-text><claim-text> secrets shared with a server and wherein said data processing component is further adapted to verify said server credential using at least one of said secrets and a symmetric cryptographic algorithm. </claim-text></claim><claim id="clm-0036" num="36"><claim-text> 36. A strong authentication method for use with an authentication token comprising at least one of an acoustical input interface or an optical input interface, the method comprising : </claim-text><claim-text> receiving at the authentication token at least one of an acoustical signal or an optical signal including a message comprising input data from a remote computer system; </claim-text><claim-text> decoding the message to recover the input data; and </claim-text><claim-text> generating a dynamic security value at the authentication token by processing the recovered input data by combining at least some of the recovered input data with a symmetric cryptographic algorithm and a secret shared with a security value verification server; and whereby decoding the message to recover the input data comprises the steps of: </claim-text><claim-text> detecting the boundaries of a received data block comprised in the message; detecting whether the received data block has already been buffered; </claim-text><claim-text> buffering the received data block if it had not yet been buffered; </claim-text><claim-text> detecting whether the received data block comprises an ordinary payload block comprising at least a part of the input data or an extra redundancy block; </claim-text><claim-text> determining whether the complete input data can be recovered from the buffered ordinary payload blocks; </claim-text><claim-text> determining whether any missing input data can be calculated from the buffered ordinary payload blocks and the buffered extra redundancy blocks; </claim-text><claim-text> calculating at least part of the missing input data from the contents of at least some of the buffered ordinary payload blocks and the contents of at least some of the buffered extra redundancy blocks; <!-- EPO <DP n="56"/>--> recovering the complete input data from the buffered ordinary payload blocks or from the buffered ordinary payload blocks and the calculated missing input data.</claim-text></claim><claim id="clm-0037" num="37"><claim-text>37. The method of claim 36, wherein decoding the message to recover the input data further comprises detecting at least some types of transmission errors in received data blocks, and wherein the buffering of a received data block is further dependent on no transmission errors having been detected for that received data block. </claim-text></claim><claim id="clm-0038" num="38"><claim-text> 38. The method of claim 36, wherein the authentication token comprises a </claim-text><claim-text> communication interface for communicating with a removable security device and the generating step comprises: </claim-text><claim-text> generating the dynamic security value with the authentication token in cooperation with the removable security device. </claim-text></claim><claim id="clm-0039" num="39"><claim-text> 39. A method for securing access by a user to a remote application, the method </claim-text><claim-text> comprising : </claim-text><claim-text> making available to the user an authentication token according to claim 1; </claim-text><claim-text> assembling input data; </claim-text><claim-text> sending the input data to a user's computing device ; </claim-text><claim-text> formatting a message comprising the input data; </claim-text><claim-text> emitting at the user's computing device in multiple emission cycles and for reception by the user's authentication token at least one of a modulated acoustical signal or a modulated optical signal whereby the at least one of a modulated acoustical signal or a modulated optical signal is modulated to transmit the message comprising the input data; </claim-text><claim-text> receiving from the user a dynamic security value generated by the user's </claim-text><claim-text> authentication token wherein the authentication token generates and outputs to the user the dynamic security value after receiving and demodulating the acoustical signal and recovering the input data; </claim-text><claim-text> verifying the received dynamic security value; </claim-text><claim-text> taking action depending on the outcome of verifying the received dynamic security value; and </claim-text><claim-text> wherein formatting of the message comprises: </claim-text><claim-text> creating at least two payload blocks each containing at least some of the input data whereby the two or more payload blocks together comprise at least all the input data and adding the at least two payload blocks to the message; </claim-text><claim-text> calculating one or more extra redundancy blocks and adding the one or more extra redundancy blocks to the message; </claim-text><claim-text> adding encoding elements to the message to allow the receiving authentication token to detect the boundaries of the payload blocks and the extra redundancy blocks; and <!-- EPO <DP n="57"/>--> wherein calculating an extra redundancy blocks comprises calculating a number of extra-redundancy sub-blocks by combining for each extra-redundancy sub-block corresponding sub-blocks from payload blocks from a group of payload blocks comprised in the message and then combining the calculated extra-redundancy sub- blocks into the extra redundancy block. </claim-text></claim><claim id="clm-0040" num="40"><claim-text> 40. The method of claim 39, wherein formatting the message further comprises adding encoding elements to the message or the payload and extra redundancy blocks to allow the receiving authentication token to detect whether a block comprised in the message is a payload or an extra redundancy block. </claim-text></claim><claim id="clm-0041" num="41"><claim-text> 41. The method of claim 39, wherein formatting the message further comprises adding an error detection code to the message or to at least some of the payload and extra redundancy blocks. </claim-text></claim><claim id="clm-0042" num="42"><claim-text> 42. The method of claim 39, wherein the sub-blocks of at least one extra redundancy block have the size of a single bit and each bit of the extra redundancy block is calculated by performing an exclusive or operation on the corresponding bits of the payload blocks from which the extra redundancy block is calculated. </claim-text></claim><claim id="clm-0043" num="43"><claim-text> 43. The method of claim 39, wherein calculating at least some sub-blocks of at least one extra redundancy block comprises adding the numeric values of the corresponding sub-blocks of the payload blocks from which the extra redundancy block that comprises the extra redundancy sub-blocks is calculated </claim-text></claim><claim id="clm-0044" num="44"><claim-text> 44. The method of claim 39, wherein formatting the message further comprises adding a block identification element to at least some of the payload and extra redundancy blocks. </claim-text></claim><claim id="clm-0045" num="45"><claim-text> 45. The method of claim 39, wherein the encoding elements to allow the receiving </claim-text><claim-text> authentication token to detect the boundaries of the payload blocks and the extra redundancy blocks comprise a start sequence or symbol or an end sequence or symbol or a separation sequence or symbol. </claim-text></claim><claim id="clm-0046" num="46"><claim-text> 46. The method of claim 39, wherein the encoding elements to allow the receiving </claim-text><claim-text> authentication token to detect the boundaries of the payload blocks and the extra redundancy blocks comprise a data length indicating element. </claim-text></claim><claim id="clm-0047" num="47"><claim-text> 47. The method of claim 39, wherein at least some of the payload blocks may comprise padding. </claim-text></claim><claim id="clm-0048" num="48"><claim-text> 48. The method of claim 39, wherein all the payload blocks and the extra redundancy blocks have the same length. </claim-text></claim><claim id="clm-0049" num="49"><claim-text> 49. The method of claim 39, further comprising the steps of obtaining a server credential and including the server credential in the input data, and wherein the server <!-- EPO <DP n="58"/>--> credential is being verified by the authentication token and wherein the generation of the dynamic security value is dependent on the verification of the server credential. </claim-text></claim><claim id="clm-0050" num="50"><claim-text>50. The method of claim 39, further comprising making available to the user a second security device, and wherein the authentication token comprises a communication interface to communicate with the second security device and wherein the </claim-text><claim-text> authentication token generates the dynamic security device in cooperation with the second security device. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
