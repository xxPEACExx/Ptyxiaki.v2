<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2678976-A1" country="EP" doc-number="2678976" kind="A1" date="20140101" family-id="46652707" file-reference-id="238329" date-produced="20180823" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146550521" ucid="EP-2678976-A1"><document-id><country>EP</country><doc-number>2678976</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12749473-A" is-representative="NO"><document-id mxw-id="PAPP154824444" load-source="docdb" format="epo"><country>EP</country><doc-number>12749473</doc-number><kind>A</kind><date>20120214</date><lang>EN</lang></document-id><document-id mxw-id="PAPP172244704" load-source="docdb" format="original"><country>EP</country><doc-number>12749473.0</doc-number><date>20120214</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140446188" ucid="CA-2012050079-W" load-source="docdb"><document-id format="epo"><country>CA</country><doc-number>2012050079</doc-number><kind>W</kind><date>20120214</date></document-id></priority-claim><priority-claim mxw-id="PPC140445645" ucid="US-201113032298-A" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201113032298</doc-number><kind>A</kind><date>20110222</date></document-id></priority-claim></priority-claims><technical-data><classification-ipc><edition>7</edition><main-classification>H04L  12/56</main-classification></classification-ipc><classifications-ipcr><classification-ipcr mxw-id="PCL-2059337331" load-source="ipcr">H04L  12/771       20130101ALI20150429BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-2059338948" load-source="ipcr">H04L  12/46        20060101AFI20150429BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-2059340465" load-source="ipcr">H04L  12/761       20130101ALI20150429BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-2050377794" load-source="docdb" scheme="CPC">H04L  49/201       20130101 LI20150529BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2050384246" load-source="docdb" scheme="CPC">H04L  12/4641      20130101 FI20150501BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132184047" lang="DE" load-source="patent-office">EFFIZIENTES MULTICASTING IN EINER VERTEILTEN SYSTEMARCHITEKTUR</invention-title><invention-title mxw-id="PT132184048" lang="EN" load-source="patent-office">EFFICIENT MULTICASTING IN A DISTRIBUTED SYSTEM ARCHITECTURE</invention-title><invention-title mxw-id="PT132184049" lang="FR" load-source="patent-office">MULTIDIFFUSION EFFICACE DANS UNE ARCHITECTURE DE SYSTÈME RÉPARTIE</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR918133611" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ALCATEL LUCENT</last-name><address><country>FR</country></address></addressbook></applicant><applicant mxw-id="PPAR918146723" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>ALCATEL LUCENT</last-name></addressbook></applicant><applicant mxw-id="PPAR918994068" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Alcatel-Lucent</last-name><iid>101311164</iid><address><street>3, Avenue Octave Gréard</street><city>75007 Paris</city><country>FR</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918144182" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ORTACDAG EREL</last-name><address><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918145610" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>ORTACDAG, EREL</last-name></addressbook></inventor><inventor mxw-id="PPAR918978590" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>ORTACDAG, EREL</last-name><address><street>2772 Springland Drive</street><city>Ottawa, Ontario K1V 6M4</city><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918165324" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>PATEL NIRMESH</last-name><address><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918156026" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>PATEL, NIRMESH</last-name></addressbook></inventor><inventor mxw-id="PPAR918981620" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>PATEL, NIRMESH</last-name><address><street>85 Shirleys Brooks Drive</street><city>Kanata, Ontario K2K 3M8</city><country>CA</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918994529" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Zinsinger, Norbert</last-name><iid>100040850</iid><address><street>Louis Pöhlau Lohrentz P.O. Box 30 55</street><city>90014 Nürnberg</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="CA-2012050079-W"><document-id><country>CA</country><doc-number>2012050079</doc-number><kind>W</kind><date>20120214</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012113075-A1"><document-id><country>WO</country><doc-number>2012113075</doc-number><kind>A1</kind><date>20120830</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS548811869" load-source="docdb">AL</country><country mxw-id="DS548830960" load-source="docdb">AT</country><country mxw-id="DS548917998" load-source="docdb">BE</country><country mxw-id="DS548894564" load-source="docdb">BG</country><country mxw-id="DS548912159" load-source="docdb">CH</country><country mxw-id="DS548917999" load-source="docdb">CY</country><country mxw-id="DS548908283" load-source="docdb">CZ</country><country mxw-id="DS548811870" load-source="docdb">DE</country><country mxw-id="DS548918000" load-source="docdb">DK</country><country mxw-id="DS548918001" load-source="docdb">EE</country><country mxw-id="DS548858865" load-source="docdb">ES</country><country mxw-id="DS548894565" load-source="docdb">FI</country><country mxw-id="DS548894566" load-source="docdb">FR</country><country mxw-id="DS548811871" load-source="docdb">GB</country><country mxw-id="DS548918006" load-source="docdb">GR</country><country mxw-id="DS548811872" load-source="docdb">HR</country><country mxw-id="DS548908284" load-source="docdb">HU</country><country mxw-id="DS548912160" load-source="docdb">IE</country><country mxw-id="DS548918007" load-source="docdb">IS</country><country mxw-id="DS548894567" load-source="docdb">IT</country><country mxw-id="DS548918008" load-source="docdb">LI</country><country mxw-id="DS548894568" load-source="docdb">LT</country><country mxw-id="DS548830961" load-source="docdb">LU</country><country mxw-id="DS548894569" load-source="docdb">LV</country><country mxw-id="DS548894570" load-source="docdb">MC</country><country mxw-id="DS548830962" load-source="docdb">MK</country><country mxw-id="DS548830963" load-source="docdb">MT</country><country mxw-id="DS548830964" load-source="docdb">NL</country><country mxw-id="DS548912161" load-source="docdb">NO</country><country mxw-id="DS548830965" load-source="docdb">PL</country><country mxw-id="DS548858866" load-source="docdb">PT</country><country mxw-id="DS548910164" load-source="docdb">RO</country><country mxw-id="DS548858867" load-source="docdb">RS</country><country mxw-id="DS548830966" load-source="docdb">SE</country><country mxw-id="DS548811873" load-source="docdb">SI</country><country mxw-id="DS548912162" load-source="docdb">SK</country><country mxw-id="DS548912163" load-source="docdb">SM</country><country mxw-id="DS548918009" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA99627047" ref-ucid="WO-2012113075-A1" lang="EN" load-source="patent-office"><p num="0000">Embodiments of the invention are directed to multicasting packets in a system such as a data packet switch or router having a distributed architecture. A first device such as a line card receiving a packet that requires multicasting forwards the packet to a fabric switch where the packet is replicated to obtain one respective packet for each line card of the system. Each line card receives its respective packet from the fabric switch and further duplicates the packet to obtain a duplicate packet for each egress endpoint of a service associated with the packet that is eligible to receive such a duplicate packet. Replication and duplication of packets requiring multicasting performed in this manner efficiently uses bandwidth of the fabric switch and links connecting it to the line cards.</p></abstract><abstract mxw-id="PA99825554" ref-ucid="WO-2012113075-A1" lang="EN" source="national office" load-source="docdb"><p>Embodiments of the invention are directed to multicasting packets in a system such as a data packet switch or router having a distributed architecture. A first device such as a line card receiving a packet that requires multicasting forwards the packet to a fabric switch where the packet is replicated to obtain one respective packet for each line card of the system. Each line card receives its respective packet from the fabric switch and further duplicates the packet to obtain a duplicate packet for each egress endpoint of a service associated with the packet that is eligible to receive such a duplicate packet. Replication and duplication of packets requiring multicasting performed in this manner efficiently uses bandwidth of the fabric switch and links connecting it to the line cards.</p></abstract><abstract mxw-id="PA99627048" ref-ucid="WO-2012113075-A1" lang="FR" load-source="patent-office"><p num="0000">Les modes de réalisation de l'invention concernent la multidiffusion de paquets dans un système tel qu'un commutateur de paquets de données ou un routeur ayant une architecture répartie. Un premier dispositif tel qu'une carte de ligne recevant un paquet qui doit faire l'objet de la multidiffusion envoie ledit paquet à un commutateur matriciel où le paquet est répliqué dans le but d'obtenir un paquet pour chaque carte de ligne du système. Chaque carte de ligne reçoit son propre paquet en provenance du commutateur matriciel et duplique encore ce paquet afin d'obtenir un paquet dupliqué pour chaque point d'extrémité de sortie d'un service associé au paquet qui peut recevoir un paquet dupliqué. Ainsi, la réalisation d'une réplication et d'une duplication des paquets devant faire l'objet de la multidiffusion permet une utilisation efficace de la bande passante du commutateur matriciel et des liaisons qui le relient aux cartes de ligne.</p></abstract><abstract mxw-id="PA99825555" ref-ucid="WO-2012113075-A1" lang="FR" source="national office" load-source="docdb"><p>Les modes de réalisation de l'invention concernent la multidiffusion de paquets dans un système tel qu'un commutateur de paquets de données ou un routeur ayant une architecture répartie. Un premier dispositif tel qu'une carte de ligne recevant un paquet qui doit faire l'objet de la multidiffusion envoie ledit paquet à un commutateur matriciel où le paquet est répliqué dans le but d'obtenir un paquet pour chaque carte de ligne du système. Chaque carte de ligne reçoit son propre paquet en provenance du commutateur matriciel et duplique encore ce paquet afin d'obtenir un paquet dupliqué pour chaque point d'extrémité de sortie d'un service associé au paquet qui peut recevoir un paquet dupliqué. Ainsi, la réalisation d'une réplication et d'une duplication des paquets devant faire l'objet de la multidiffusion permet une utilisation efficace de la bande passante du commutateur matriciel et des liaisons qui le relient aux cartes de ligne.</p></abstract><description mxw-id="PDES50931750" ref-ucid="WO-2012113075-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="2"/>--><p id="p0001" num="0001"> EFFICIENT MULTICASTING IN A DISTRIBUTED SYSTEM </p><p id="p0002" num="0002"> ARCHITECTURE </p><p id="p0003" num="0003">Field of the Invention </p><p id="p0004" num="0004">[001 ] The invention is directed to multicasting data packets in a communications network, particularly to efficiently multicasting such packets in a switch or router having a distributed architecture. </p><p id="p0005" num="0005">Background of the Invention </p><p id="p0006" num="0006">[002] Virtual Private Local Area Network (LAN) Service (VPLS) is a Virtual Private Network technology that provides multipoint communication over Ethernet networks and is described in Internet Engineering Task Force (IETF) RFC 4761 and RFC 4762. When an Ethernet packet is received (ingress direction), its destination Media Access Control (MAC) address is looked up in a forwarding database. If there is no match for a unicast packet or if the packet has a multicast or a broadcast destination address then this packet needs to be duplicated and sent to every endpoint that is configured in the VPLS service. While the duplication is being done, two requirements of the VPLS service need to be met. The first requirement is called source suppression in which the incoming packet must not be sent back to where it is coming from. The second requirement is called split horizon and relates to split horizon groups. Split horizon is a loop prevention technique used among multiple endpoints that have loops amongst them which can be configured using split horizon groups. </p><p id="p0007" num="0007">[003] In typical routers and switches having a distributed architecture, every line card is connected to each other line card via a fabric switch and fabric links connecting each line card to the fabric switch. The bandwidth among the line cards and the fabric switch is limited to the capacity of the fabric switch and fabric links. Packets requiring duplication, i.e. multicasting, can use a significant portion of that bandwidth. Therefore, an efficient way of multicasting packets in a system having a distributed architecture is desired. 
<!-- EPO <DP n="3"/>-->
 Summary </p><p id="p0008" num="0008"> [004] According to an aspect of the invention a method of multicasting a packet is provided. The method comprises: receiving the packet at a line card of a plurality of line cards in a system; determining if the packet requires multicasting; sending, responsive to the packet requiring multicasting, the packet with a multicast header to a fabric switch of the system; replicating, by the fabric switch, the packet to obtain a replicated packet; sending, by the fabric switch, the replicated packet to one or more line cards of the plurality of line cards; determining if any egress endpoints of a service associated with the packet are ineligible to receive a duplicate packet of the replicated packet; and providing the duplicate packet to each egress endpoint of the service except any such egress endpoint determined to be ineligible to receive the duplicate packet. </p><p id="p0009" num="0009">[005] In some embodiments of the method the packet is a VPLS packet, the egress endpoints are VPLS egress endpoints, and the service is a VPLS service. Further, in some embodiments determining if the packet requires multicasting comprises performing, on a destination MAC address of the packet, a lookup operation in a forwarding database; and determining that the packet requires multicast forwarding responsive to the lookup operation failing to find the destination MAC address in the forwarding database or a result of the lookup operation indicating that the packet is a multicast or broadcast packet. </p><p id="p0010" num="0010">[006] In some embodiments of the method determining if any VPLS egress endpoints of the VPLS service are ineligible to receive the duplicate packet comprises: determining that a first VPLS egress endpoint of the VPLS service matches a destination endpoint identifier of the VPLS packet and a source endpoint identifier of the VPLS packet, thereby making the first VPLS egress endpoint ineligible to receive the duplicate packet. </p><p id="p0011" num="0011">[007] In some embodiments of the method determining if any VPLS egress endpoints of the VPLS service are ineligible to receive the duplicate packet 
<!-- EPO <DP n="4"/>-->
 further comprises: determining that a second VPLS egress endpoint matches a destination endpoint identifier of the VPLS packet; and determining that the destination endpoint identifier and a source endpoint identifier of the VPLS packet are in a same split horizon group, thereby making the second VPLS egress endpoint ineligible to receive the duplicate packet. </p><p id="p0012" num="0012">[008] According to another aspect of the invention an apparatus for multicasting a packet is provided. The apparatus comprises: a first device operable to receive the packet; and a fabric switch coupled to the first device via a first fabric link, the fabric switch being operable to receive the packet from the first device and to replicate the packet to obtain a replicated packet. The first device is further operable to: determine if the packet requires multicasting; send, responsive to the packet requiring multicasting, the packet with a multicast header to the fabric switch; receive the replicated packet from the fabric switch; determine that an egress endpoint of a service associated with the packet and that corresponds to the first device is ineligible to receive a duplicate packet of the replicated packet; and provide the duplicate packet to egress endpoints of the service that correspond to the first device except such egress endpoints determined to be ineligible. </p><p id="p0013" num="0013">[009] In some embodiments of the apparatus the packet is a Virtual Private Local Area Network (LAN) Service (VPLS) packet, the egress endpoints are VPLS egress endpoints, and the service is a VPLS service. Additionally or alternatively, in some embodiments the apparatus further comprises a second device coupled to the fabric switch via a second fabric link, the second device being operable to: receive the replicated packet from the fabric switch, determine that an egress endpoint of a service associated with the packet and that corresponds to the second device is ineligible to receive a duplicate packet of the replicated packet, and provide the duplicate packet to egress endpoints of the service that correspond to the second device except such egress endpoints determined to be ineligible. </p><p id="p0014" num="0014">[0010] Additionally or alternatively, in some embodiments the first and second devices are each further operable to: determine, for each VPLS egress 
<!-- EPO <DP n="5"/>-->
 endpoint associated with the respective device, if a destination endpoint identifier of the VPLS packet matches the VPLS egress endpoint; determine, responsive to a first VPLS egress endpoint matching the destination endpoint identifier, if the destination endpoint identifier matches a source endpoint identifier of the VPLS packet; and determine that the first VPLS egress endpoint is ineligible to receive the duplicate packet responsive to the destination endpoint identifier matching the source endpoint identifier. </p><p id="p0015" num="0015">[0011]Additionally or alternatively, in some embodiments the first and second devices are each further operable to: determine, for each VPLS egress endpoint associated with the respective device, if a destination endpoint identifier of the VPLS packet matches the VPLS egress endpoint; determine, responsive to a second VPLS egress endpoint matching the destination endpoint identifier if the destination endpoint identifier and a source endpoint identifier of the VPLS packet belong to a same split horizon group; and determine that the second VPLS egress endpoint is ineligible to receive the duplicate packet responsive to the destination endpoint identifier and the source endpoint identifier belonging to the same split horizon group. </p><p id="p0016" num="0016">Brief Description of the Drawings </p><p id="p0017" num="0017">[0012] The foregoing and other objects, features and advantages of the invention will be apparent from the following more particular description of the preferred embodiments, as illustrated in the appended drawings, where: </p><p id="p0018" num="0018">Figure 1 depicts an apparatus for multicasting data packets in a system having a distributed architecture according to an embodiment of the invention. </p><p id="p0019" num="0019">Figure 2 depicts a method of multicasting data packets in a system having a distributed architecture according to another embodiment of the invention. </p><p id="p0020" num="0020">In the figures like features are denoted by like reference characters. 
<!-- EPO <DP n="6"/>-->
 Detailed Description </p><p id="p0021" num="0021">[0013] Figure 1 depicts an apparatus 10 for multicasting data packets in a system such as a data packet switch or router having a distributed architecture. The apparatus 10 includes a plurality of line cards 12. Each line card 12 has a device 14 for processing packets and is coupled to a fabric switch 18 via one or more respective fabric links 16. The device 14 for processing packets could be implemented as a network processor, field programmable gate array (FPGA), application specific integrated circuit (ASIC), microprocessor or any combination thereof. Likewise the fabric switch could be implemented in any of the aforementioned ways. The fabric switch 18 receives packet traffic from the line cards 12 via the fabric links 16 and forwards the packet traffic to the line cards 12 via the fabric links 16 in accordance with multicasting or unicasting requirements of the traffic and source suppression and split horizon requirements of VPLS service. The apparatus 10 pushes duplication of packets to the fabric switch 18 and the line cards 12 where VPLS egress endpoints 20 are configured. This way fabric bandwidth usage of the line card 12 at which traffic ingresses the apparatus (e.g. line card 1 ) is not affected by the number of endpoints 20 in the VPLS service. </p><p id="p0022" num="0022">[0014] To summarize operation of the apparatus 10, a packet 22 received at a line card 12 (e.g. line card 1 ) is sent to the fabric switch 18 as a single packet, the fabric switch 18 replicates just one packet per line card 12 and sends a respective replicated packet to each line card 12. The device 14 for processing packets on each line card 12 receives the replicated packet, duplicates the packet and sends one such duplicate packet towards each egress endpoint 20 on their respective line card 12 after performing source suppression and the split horizon group validation 30. </p><p id="p0023" num="0023">[0015] In more detail, an Ethernet packet 22 is received by the device 14 for processing packets of a line card 12 (e.g. line card 1 ). Destination MAC address of the incoming packet 22 is looked up in the VPLS forwarding 
<!-- EPO <DP n="7"/>-->
 database by the device 14 for processing packets, such as a network processor. If the packet 22 is a unicast packet and there is no match in the forwarding database or the packet is a multicast or a broadcast packet, then the packet 22 is sent towards the fabric switch 18 with a multicast fabric header. The multicast fabric header contains a VPLS service identifier, a VPLS source endpoint identifier and a source split horizon group identifier. The fabric switch 18 uses the multicast fabric header to replicate only one packet towards each line card 12 that the VPLS endpoints are configured on. When the respective device 14 for processing packets in each the line cards 12 receives the replicated packet, it starts to duplicate the packet towards each VPLS egress endpoint 20 as long as the destination endpoint identifier is not same as the source endpoint identifier (source suppression) and the source and the destination endpoints do not belong to the same split horizon group. </p><p id="p0024" num="0024">[0016] Figure 2 depicts a method 200 of multicasting data packets in a system having a distributed architecture such as a packet switch or router. The method 200 starts by receiving 202 the packet at a first line card of a plurality of line cards in a system. Next a determination 204 if the packet requires multicasting is made. This determination 204 is made by performing, on a destination MAC address of the packet, a lookup operation in a forwarding database. If the lookup operation fails to find the destination MAC address in the forwarding database or a result of the lookup operation indicates that the packet is a multicast or broadcast packet; then the packet is deemed to require multicasting. If the packet does not require multicasting it is processed 206 as a unicast packet and the method ends 208. Otherwise the packet is sent 210 with a multicast header to a fabric switch of the system. The fabric switch replicates 212 the packet to obtain one replicated packet for each line card of the plurality of line cards. The fabric switch then sends 214 a respective replicated packet to each of the line cards. The method 200 then determines 216 if any egress endpoints of a service associated with the packet are ineligible to receive a duplicate packet of the replicated packet. This determination 216 is made by each line card for egress endpoints that are configured on, or otherwise correspond to, the line card. Next, a 
<!-- EPO <DP n="8"/>-->
 respective duplicate packet is provided 218 to each egress endpoint of the service except any such egress endpoint determined to be ineligible to receive the duplicate packet, after which the method 200 ends 208. The providing 218 of a respective duplicate packet to each eligible egress endpoint is done by each line card for egress endpoints that are configured on, or otherwise correspond to, the line card. </p><p id="p0025" num="0025">[0017] In a preferred embodiment the packet is a VPLS packet, the egress endpoints are VPLS egress endpoints, and the service is a VPLS service. However, embodiments of the invention are not restricted to those relating to a VPLS service. </p><p id="p0026" num="0026">[0018] In the case where the method 200 relates to a VPLS service, determining 216 if any VPLS egress endpoints are ineligible to receive the duplicate packet includes determining, for each VPLS egress endpoint, if a destination endpoint identifier of the VPLS packet matches the VPLS egress endpoint. If a given VPLS egress endpoint matches the destination endpoint identifier, a determination whether the destination endpoint identifier matches a source endpoint identifier of the VPLS packet or not is made. If the destination endpoint identifier matches the source endpoint identifier then the given VPLS egress endpoint is deemed ineligible to receive the duplicate packet. In this manner the method 200 meets the source suppression requirement of the VPLS service. </p><p id="p0027" num="0027">[0019] Furthermore, in the case where the method 200 relates to a VPLS service, determining 216 if any VPLS egress endpoints are ineligible to receive the duplicate packet includes determining, for each VPLS egress endpoint, if a destination endpoint identifier of the VPLS packet matches the VPLS egress endpoint. If a given VPLS egress endpoint matches the destination endpoint identifier, a determination is made whether or not the destination endpoint identifier and the source endpoint identifier belong to the same split horizon group. If the destination endpoint identifier and the source endpoint identifier belong to the same split horizon group then the given VPLS egress endpoint is deemed ineligible to receive the duplicate packet. In this 
<!-- EPO <DP n="9"/>-->
 manner the method 200 meets the aforementioned split horizon group requirement of the VPLS service. </p><p id="p0028" num="0028">[0020] Advantageously, bandwidth usage between the line cards and the fabric switch are optimized for multicasting. </p><p id="p0029" num="0029">[0021] Numerous modifications, variations and adaptations may be made to the embodiments of the invention described above without departing from the scope of the invention, which is defined in the claims. 
</p></description><claims mxw-id="PCLM44727711" ref-ucid="WO-2012113075-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="10"/>-->WHAT IS CLAIMED IS: </claim-statement><claim id="clm-0001" num="1"><claim-text> 1 . A method of multicasting a packet comprising: </claim-text><claim-text> receiving (202) the packet at a line card (12) of a plurality of line cards (12) in a system; </claim-text><claim-text> determining (204) if the packet requires multicasting; </claim-text><claim-text> sending (210), responsive to the packet requiring multicasting, the packet with a multicast header to a fabric switch (18) of the system; </claim-text><claim-text> replicating (212), by the fabric switch (18), the packet to obtain a replicated packet; </claim-text><claim-text> sending (214), by the fabric switch (18), the replicated packet to one or more line cards (12) of the plurality of line cards (12); </claim-text><claim-text> determining (216) if any egress endpoints of a service associated with the packet are ineligible to receive a duplicate packet of the replicated packet; and </claim-text><claim-text> providing (218) the duplicate packet to each egress endpoint of the service except any such egress endpoint determined to be ineligible to receive the duplicate packet. </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. The method of claim 1 wherein the packet is a Virtual Private Local Area Network (LAN) Service (VPLS) packet, the egress endpoints are VPLS egress endpoints, and the service is a VPLS service. </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. The method of claim 2 wherein determining if any VPLS egress endpoints are ineligible to receive the duplicate packet comprises: </claim-text><claim-text> determining, for each VPLS egress endpoint, if a destination endpoint identifier of the VPLS packet matches the VPLS egress endpoint; </claim-text><claim-text> determining, responsive to a first VPLS egress endpoint matching the destination endpoint identifier, if the destination endpoint identifier matches a source endpoint identifier of the VPLS packet; and </claim-text><claim-text> determining that the first VPLS egress endpoint is ineligible to receive the duplicate packet responsive to the destination endpoint identifier matching the source endpoint identifier. <!-- EPO <DP n="11"/>--> </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. The method of claim 2 wherein determining if any VPLS egress endpoints are ineligible to receive the duplicate packet comprises: </claim-text><claim-text> determining, for each VPLS egress endpoint, if a destination endpoint identifier of the VPLS packet matches the VPLS egress endpoint; </claim-text><claim-text> determining, responsive to a first VPLS egress endpoint matching the destination endpoint identifier, if the destination endpoint identifier and a source endpoint identifier of the VPLS packet belong to a same split horizon group; and </claim-text><claim-text> determining that the first VPLS egress endpoint is ineligible to receive the duplicate packet responsive to the destination endpoint identifier and the source endpoint identifier belonging to the same split horizon group. </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. The method of claim 3 wherein determining if any VPLS egress endpoints are ineligible to receive the duplicate packet further comprises: determining, for each VPLS egress endpoint, if a destination endpoint identifier of the VPLS packet matches the VPLS egress endpoint; </claim-text><claim-text> determining, responsive to a second VPLS egress endpoint matching the destination endpoint identifier, if the destination endpoint identifier and a source endpoint identifier of the VPLS packet belong to a same split horizon group; and </claim-text><claim-text> determining that the VPLS second egress endpoint is ineligible to receive the duplicate packet responsive to the destination endpoint identifier and the source endpoint identifier belonging to the same split horizon group. </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. The method of claim 2 wherein determining if any VPLS egress endpoints of the VPLS service are ineligible to receive the duplicate packet comprises: </claim-text><claim-text> determining that a first VPLS egress endpoint of the VPLS service matches a destination endpoint identifier of the VPLS packet and a source endpoint identifier of the VPLS packet, thereby making the first VPLS egress endpoint ineligible to receive the duplicate packet. </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. The method of claim 2 wherein determining if any VPLS egress endpoints of the VPLS service are ineligible to receive the duplicate packet <!-- EPO <DP n="12"/>--> comprises: </claim-text><claim-text> determining that a second VPLS egress endpoint matches a destination endpoint identifier of the VPLS packet; and </claim-text><claim-text> determining that the destination endpoint identifier and a source endpoint identifier of the VPLS packet are in a same split horizon group, thereby making the second VPLS egress endpoint ineligible to receive the duplicate packet. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. The method of claim 6 wherein determining if any VPLS egress endpoints of the VPLS service are ineligible to receive the duplicate packet further comprises: </claim-text><claim-text> determining that a second VPLS egress endpoint matches the destination endpoint identifier of the VPLS packet; and </claim-text><claim-text> determining that the destination endpoint identifier and the source endpoint identifier are in a same split horizon group, thereby making the second VPLS egress endpoint ineligible to receive the duplicate packet. </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. The method of any one of claims 1 to 8 wherein determining if the packet requires multicasting comprises: </claim-text><claim-text> performing, on a destination Media Access Control (MAC) address of the packet, a lookup operation in a forwarding database; and </claim-text><claim-text> determining that the packet requires multicast forwarding responsive to the lookup operation failing to find the destination MAC address in the forwarding database or a result of the lookup operation indicating that the packet is a multicast or broadcast packet. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. An apparatus for multicasting a packet comprising: </claim-text><claim-text> a first device (12) operable to receive (202) the packet; and </claim-text><claim-text> a fabric switch (18) coupled to the first device (12) via a first fabric link, the fabric switch (18) being operable to receive the packet from the first device (12) and to replicate the packet to obtain a replicated packet, </claim-text><claim-text> wherein the first device (12) is further operable to: </claim-text><claim-text> determine (204) if the packet requires multicasting, send (210), responsive to the packet requiring multicasting, the <!-- EPO <DP n="13"/>--> packet with a multicast header to the fabric switch (18), </claim-text><claim-text> receive the replicated packet from the fabric switch (18) determine (214) that an egress endpoint of a service associated with the packet and that corresponds to the first device (12) is ineligible to receive a duplicate packet of the replicated packet, and </claim-text><claim-text> provide (218) the duplicate packet to egress endpoints of the service that correspond to the first device (12) except such egress endpoints determined to be ineligible. </claim-text></claim><claim id="clm-0011" num="11"><claim-text>1 1 . The apparatus of claim 10 further comprising: </claim-text><claim-text> a second device (12) coupled to the fabric switch (18) via a second fabric link, the second device (12) being operable to: </claim-text><claim-text> receive the replicated packet from the fabric switch (18), </claim-text><claim-text> determine (216) an egress endpoint of a service associated with the packet and that corresponds to the second device (12) is ineligible to receive the duplicate packet, and </claim-text><claim-text> provide (218) the duplicate packet to egress endpoints of the service that correspond to the second device (12) except such egress endpoints determined to be ineligible. </claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. The apparatus of claim 1 1 wherein the packet is a Virtual Private Local Area Network (LAN) Service (VPLS) packet, the egress endpoints are VPLS egress endpoints, the service is a VPLS service, and the first device (12) and the second device (12) are each further operable to: </claim-text><claim-text> determine, for each VPLS egress endpoint, if a destination endpoint identifier of the VPLS packet matches the VPLS egress endpoint; </claim-text><claim-text> determine, responsive to a first VPLS egress endpoint matching the destination endpoint identifier, if the destination endpoint identifier matches a source endpoint identifier of the VPLS packet; and </claim-text><claim-text> determine that the first VPLS egress endpoint is ineligible to receive the duplicate packet responsive to the destination endpoint identifier matching the source endpoint identifier. </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. The apparatus of claim 1 1 wherein the packet is a Virtual Private Local <!-- EPO <DP n="14"/>--> Area Network (LAN) Service (VPLS) packet, the egress endpoints are VPLS egress endpoints, the service is a VPLS service, and the first device (12) and the second device (12) are each further operable to: </claim-text><claim-text> determine, for each VPLS egress endpoint, if a destination endpoint identifier of the VPLS packet matches the VPLS egress endpoint; </claim-text><claim-text> determine, responsive to a first VPLS egress endpoint matching the destination endpoint identifier, if the destination endpoint identifier and a source endpoint identifier of the VPLS packet belong to a same split horizon group; and </claim-text><claim-text> determine that the first VPLS egress endpoint is ineligible to receive the duplicate packet responsive to the destination endpoint identifier and the source endpoint identifier belonging to the same split horizon group. </claim-text></claim><claim id="clm-0014" num="14"><claim-text>14. The apparatus of claim 12 wherein the first device (12) and the second device (12) are each further operable to: </claim-text><claim-text> determine, responsive to a second VPLS egress endpoint matching the destination endpoint identifier, if the destination endpoint identifier and the source endpoint identifier of the VPLS packet belong to a same split horizon group; and </claim-text><claim-text> determine that the second VPLS egress endpoint is ineligible to receive the duplicate packet responsive to the destination endpoint identifier and the source endpoint identifier belonging to the same split horizon group. </claim-text></claim><claim id="clm-0015" num="15"><claim-text>15. The apparatus of any one of claims 10 to 14, wherein the first device (12) is further operable to: </claim-text><claim-text> perform on a destination Media Access Control (MAC) address of the packet a lookup operation in a forwarding database; and </claim-text><claim-text> determine that the packet requires multicast forwarding responsive to the lookup operation failing to find the destination MAC address in the forwarding database or a result of the lookup operation indicating that the packet is a multicast or broadcast packet. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
