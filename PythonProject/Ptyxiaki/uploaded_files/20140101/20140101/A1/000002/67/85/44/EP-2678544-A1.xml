<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2678544-A1" country="EP" doc-number="2678544" kind="A1" date="20140101" family-id="45722671" file-reference-id="252637" date-produced="20180826" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146551118" ucid="EP-2678544-A1"><document-id><country>EP</country><doc-number>2678544</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12705162-A" is-representative="NO"><document-id mxw-id="PAPP154825041" load-source="docdb" format="epo"><country>EP</country><doc-number>12705162</doc-number><kind>A</kind><date>20120131</date><lang>EN</lang></document-id><document-id mxw-id="PAPP183608519" load-source="docdb" format="original"><country>EP</country><doc-number>12705162.1</doc-number><date>20120131</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140447182" ucid="IB-2012000138-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>IB</country><doc-number>2012000138</doc-number><kind>W</kind><date>20120131</date></document-id></priority-claim><priority-claim mxw-id="PPC140454708" ucid="JP-2011038580-A" load-source="docdb"><document-id format="epo"><country>JP</country><doc-number>2011038580</doc-number><kind>A</kind><date>20110224</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988097643" load-source="docdb">F02D  43/02        20060101ALI20120911BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988111314" load-source="docdb">F02B  37/18        20060101ALI20120911BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988113502" load-source="docdb">F02D  41/00        20060101AFI20120911BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988133350" load-source="docdb">F02D  41/14        20060101ALI20120911BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-2019228533" load-source="docdb" scheme="CPC">F02D  41/2441      20130101 LI20150929BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2019229885" load-source="docdb" scheme="CPC">F02D2200/021       20130101 LA20150929BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2019230332" load-source="docdb" scheme="CPC">F02D  41/2454      20130101 LI20150929BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2019230506" load-source="docdb" scheme="CPC">F02B  37/00        20130101 LA20150929BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2019233222" load-source="docdb" scheme="CPC">F02D  41/1454      20130101 LI20150929BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2019233483" load-source="docdb" scheme="CPC">F02D  41/0007      20130101 LI20150929BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2019234119" load-source="docdb" scheme="CPC">Y02T  10/144       20130101 LA20150929BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988135182" load-source="docdb" scheme="CPC">F02D  41/0235      20130101 FI20131205BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132185838" lang="DE" load-source="patent-office">STEUERGERÄT UND STEUERVERFAHREN FÜR EINEN VERBRENNUNGSMOTOR</invention-title><invention-title mxw-id="PT132185839" lang="EN" load-source="patent-office">CONTROLLER AND CONTROL METHOD FOR INTERNAL COMBUSTION ENGINE</invention-title><invention-title mxw-id="PT132185840" lang="FR" load-source="patent-office">RÉGULATEUR ET PROCÉDÉ DE RÉGULATION POUR MOTEUR À COMBUSTION INTERNE</invention-title><citations><non-patent-citations><nplcit><text>See references of WO 2012114170A1</text><sources><source mxw-id="PNPL67451826" load-source="docdb" name="SEA"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR918166027" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>TOYOTA MOTOR CO LTD</last-name><address><country>JP</country></address></addressbook></applicant><applicant mxw-id="PPAR918148845" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>TOYOTA JIDOSHA KABUSHIKI KAISHA</last-name></addressbook></applicant><applicant mxw-id="PPAR918984653" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>TOYOTA JIDOSHA KABUSHIKI KAISHA</last-name><iid>101357811</iid><address><street>1, Toyota-cho,</street><city>Toyota-shi, Aichi-ken, 471-8571</city><country>JP</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918160245" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>FUKUI WATARU</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918143353" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>FUKUI, WATARU</last-name></addressbook></inventor><inventor mxw-id="PPAR918986427" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>FUKUI, WATARU</last-name><address><street>c/o TOYOTA JIDOSHA KABUSHIKI KAISHA, 1, Toyota-cho, Toyota-shi</street><city>Aichi-ken 471 -8571</city><country>JP</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918986571" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Kuhnen &amp; Wacker</last-name><iid>101158360</iid><address><street>Patent- und Rechtsanwaltsbüro Prinz-Ludwig-Strasse 40A</street><city>85354 Freising</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="IB-2012000138-W"><document-id><country>IB</country><doc-number>2012000138</doc-number><kind>W</kind><date>20120131</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012114170-A1"><document-id><country>WO</country><doc-number>2012114170</doc-number><kind>A1</kind><date>20120830</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS548922607" load-source="docdb">AL</country><country mxw-id="DS548815170" load-source="docdb">AT</country><country mxw-id="DS548922608" load-source="docdb">BE</country><country mxw-id="DS548926806" load-source="docdb">BG</country><country mxw-id="DS548864248" load-source="docdb">CH</country><country mxw-id="DS548922609" load-source="docdb">CY</country><country mxw-id="DS548933017" load-source="docdb">CZ</country><country mxw-id="DS548836345" load-source="docdb">DE</country><country mxw-id="DS548922610" load-source="docdb">DK</country><country mxw-id="DS548922611" load-source="docdb">EE</country><country mxw-id="DS548924654" load-source="docdb">ES</country><country mxw-id="DS548926807" load-source="docdb">FI</country><country mxw-id="DS548926808" load-source="docdb">FR</country><country mxw-id="DS548836346" load-source="docdb">GB</country><country mxw-id="DS548922612" load-source="docdb">GR</country><country mxw-id="DS548836347" load-source="docdb">HR</country><country mxw-id="DS548933018" load-source="docdb">HU</country><country mxw-id="DS548864249" load-source="docdb">IE</country><country mxw-id="DS548922613" load-source="docdb">IS</country><country mxw-id="DS548926809" load-source="docdb">IT</country><country mxw-id="DS548922614" load-source="docdb">LI</country><country mxw-id="DS548836348" load-source="docdb">LT</country><country mxw-id="DS548815171" load-source="docdb">LU</country><country mxw-id="DS548926946" load-source="docdb">LV</country><country mxw-id="DS548836349" load-source="docdb">MC</country><country mxw-id="DS548815172" load-source="docdb">MK</country><country mxw-id="DS548815173" load-source="docdb">MT</country><country mxw-id="DS548922615" load-source="docdb">NL</country><country mxw-id="DS548836350" load-source="docdb">NO</country><country mxw-id="DS548922616" load-source="docdb">PL</country><country mxw-id="DS548926947" load-source="docdb">PT</country><country mxw-id="DS548933019" load-source="docdb">RO</country><country mxw-id="DS548926948" load-source="docdb">RS</country><country mxw-id="DS548922617" load-source="docdb">SE</country><country mxw-id="DS548864346" load-source="docdb">SI</country><country mxw-id="DS548836351" load-source="docdb">SK</country><country mxw-id="DS548836352" load-source="docdb">SM</country><country mxw-id="DS548815174" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA99625230" ref-ucid="WO-2012114170-A1" lang="EN" load-source="patent-office"><p num="0000">An ECU determines whether or not an engine water temperature has exceeded a predetermined value (A) (step S100); and actively opens and closes a waste gate valve, and calculates a shift in a learning value amount (step S102). The ECRU (30) determines whether or not the learning value shift amount is sufficiently large to surpass a predetermined value (C) (step S104) and when the determination result is Yes (when the condition is fulfilled), takes in the learning value shift (step S106). The ECRU determines whether or not the engine water temperature is sufficiently low to be below a predetermined value (B) (step S108) and reflects the learning value shift in the air-fuel ratio learning value (step S 110).</p></abstract><abstract mxw-id="PA99823751" ref-ucid="WO-2012114170-A1" lang="EN" source="national office" load-source="docdb"><p>An ECU determines whether or not an engine water temperature has exceeded a predetermined value (A) (step S100); and actively opens and closes a waste gate valve, and calculates a shift in a learning value amount (step S102). The ECRU (30) determines whether or not the learning value shift amount is sufficiently large to surpass a predetermined value (C) (step S104) and when the determination result is Yes (when the condition is fulfilled), takes in the learning value shift (step S106). The ECRU determines whether or not the engine water temperature is sufficiently low to be below a predetermined value (B) (step S108) and reflects the learning value shift in the air-fuel ratio learning value (step S 110).</p></abstract><abstract mxw-id="PA99625231" ref-ucid="WO-2012114170-A1" lang="FR" load-source="patent-office"><p num="0000">L'invention concerne une ECU qui détermine si la température d'eau d'un moteur a dépassé ou non une valeur prédéterminée (A) (étape S100) ; et qui ouvre et ferme activement une soupape de décharge, et calcule un décalage d'une valeur quantitative d'apprentissage (étape S102). L'ECRU (30) détermine si la quantité de décalage de la valeur d'apprentissage est ou non suffisamment importante pour dépasser une valeur prédéterminée (C) (étape S104) et, lorsque le résultat de la détermination est affirmatif (lorsque la condition est remplie), reçoit le décalage de la valeur d'apprentissage (étape S106). L'ECRU détermine si la température d'eau du moteur est ou non suffisamment basse pour être inférieure à une valeur prédéterminée (B) (étape S108) et reflète le décalage de la valeur d'apprentissage dans la valeur d'apprentissage du rapport air-carburant (étape S 110).</p></abstract><abstract mxw-id="PA99823752" ref-ucid="WO-2012114170-A1" lang="FR" source="national office" load-source="docdb"><p>L'invention concerne une ECU qui détermine si la température d'eau d'un moteur a dépassé ou non une valeur prédéterminée (A) (étape S100) ; et qui ouvre et ferme activement une soupape de décharge, et calcule un décalage d'une valeur quantitative d'apprentissage (étape S102). L'ECRU (30) détermine si la quantité de décalage de la valeur d'apprentissage est ou non suffisamment importante pour dépasser une valeur prédéterminée (C) (étape S104) et, lorsque le résultat de la détermination est affirmatif (lorsque la condition est remplie), reçoit le décalage de la valeur d'apprentissage (étape S106). L'ECRU détermine si la température d'eau du moteur est ou non suffisamment basse pour être inférieure à une valeur prédéterminée (B) (étape S108) et reflète le décalage de la valeur d'apprentissage dans la valeur d'apprentissage du rapport air-carburant (étape S 110).</p></abstract><description mxw-id="PDES50931182" ref-ucid="WO-2012114170-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="3"/>--><p id="p0001" num="0001"> CONTROLLER AND CONTROL METHOD FOR INTERNAL COMBUSTION </p><p id="p0002" num="0002">ENGINE </p><p id="p0003" num="0003">BACKGROUND OF THE INVENTION </p><p id="p0004" num="0004">1. Field of the Invention </p><p id="p0005" num="0005"> [0001] The invention relates to a controller and a control method for an internal combustion engine. </p><p id="p0006" num="0006">2. Description of Related Art </p><p id="p0007" num="0007"> [0002] A variety of techniques relating to air-fuel ratio learning in internal combustion engines have been disclosed. For example, Japanese Patent Application Publication No. 9-88665 (JP-A-9-88665) describes an internal combustion engine equipped with a controller that executes computational processing for air-fuel ratio learning. The air-fuel ratio learning according to the technique described in JP-A-9-88665 makes it possible to learn a spread in air-fuel ratio caused by a spread occurring during the production of intake air measuring systems such as intake air amount sensors or fuel supply systems such as injectors, or by changes in these systems with time. The results of air-fuel ratio learning are stored as a map in a predetermined storage device, and the air-fuel ratio learning map is referred to, the learning values are retrieved, and the air-fuel ratio learning correction coefficients are set by interpolation in the subsequent control routine performed in the internal combustion engine. The results of air-fuel ratio learning can be reflected in the control of the internal combustion engine by executing such a procedure. </p><p id="p0008" num="0008"> [0003] With a configuration in which an air-fuel ratio sensor is mounted on an exhaust passage of an internal combustion engine, the air-fuel ratio of the exhaust gas can be detected with good accuracy from the output signal of the air-fuel ratio sensor, and the output signal of the air-fuel ratio sensor is used for air-fuel ratio learning. However, in the case of a supercharged internal combustion engine having a wastegate valve, the state of the exhaust gas passing through a position where the air-fuel ratio sensor is installed 
<!-- EPO <DP n="4"/>-->
 differs between when the wastegate valve is open and when it is closed, and this difference can adversely affect the results of air-fuel ratio learning. </p><p id="p0009" num="0009">SUMMARY OF THE INVENTION </p><p id="p0010" num="0010"> [0004] The invention provides a controller and a control method for an internal combustion engine equipped with a wastegate valve that is capable of inhibiting the decrease in accuracy of air-fuel ratio learning. More specifically, the invention provides a controller and a control method for an internal combustion engine in which the effect produced on air-fuel ratio learning by the difference between the open and closed states of the air-fuel ratio sensor is taken into account when the output signals of the air-fuel ratio sensor are used for air-fuel ratio learning. </p><p id="p0011" num="0011"> [0005] . The first aspect of the invention relates to a controller for an internal combustion engine. The controller for an internal combustion engine includes: a supercharger provided in the internal combustion engine and having a wastegate valve; an air-fuel ratio sensor provided downstream of a turbine of the supercharger in an exhaust passage of the internal combustion engine; learning means for learning a learning value by performing air-fuel ratio learning in the internal combustion engine on the basis of an output of the air-fuel ratio sensor; and shift reflection means for: a) including in a result of the air-fuel ratio learning, a difference between the learning value in an open state of the wastegate valve and the learning value in a closed state of the wastegate valve, or b) including in contents of air-fuel ratio control of the internal combustion engine using the learning value, a difference between the learning value in an open state of the wastegate valve and the learning value in a closed state of the wastegate valve. </p><p id="p0012" num="0012"> [0006] According to the abovementioned aspect, the difference in learning values occurring between the open state of the wastegate valve and the closed state of the wastegate valve is reflected in air-fuel ratio learning. As a result, the air-fuel ratio learning can be performed with good accuracy. </p><p id="p0013" num="0013"> [0007] In the abovementioned aspect, the controller for an internal combustion engine may further include wastegate valve control means for controlling the wastegate 
<!-- EPO <DP n="5"/>-->
 valve to any one state from among the closed state and open state during a cold operation of the internal combustion engine. When the wastegate valve has been controlled to one of the closed state and open state during the cold operation, the shift reflection means may use a corrected learning value, which is a value obtained by including a learning value in the other one of the open state and closed state of the wastegate valve in a learning value in the one of the open state and closed state in order to control the internal combustion engine during the cold operation. </p><p id="p0014" num="0014"> [0008] According to the abovementioned aspect, in the cold operation as a region in which hydrogen (denoted hereinbelow by H<sub>2</sub>) affects the air-fuel ratio output, correction based on the H<sub>2</sub> effect can be performed. </p><p id="p0015" num="0015"> [0009] In the abovementioned aspect, the shift reflection means may use the corrected learning value to control the internal combustion engine during the cold operation only when a value of the difference between the learning value in the open state of the wastegate valve and the learning value in the closed state of the wastegate valve is larger than a predetermined value. </p><p id="p0016" num="0016"> [0010] According to the abovementioned aspect, a shift of the learning value can be reflected in air-fuel ratio learning only when the divergence of the learning value is large enough to warrant the necessity of taking the shift of learning value into account. </p><p id="p0017" num="0017"> [0011] In the abovementioned aspect, a period of cold operation may be when a temperature of cooling water that cools the internal combustion engine is equal to or lower than a predetermined temperature. </p><p id="p0018" num="0018"> [0012] According to the abovementioned aspect, the learning means may calculate the learning value by including an effect produced by hydrogen on an output of the air-fuel ratio sensor during the cold operation. </p><p id="p0019" num="0019"> [0013] In the abovementioned aspect, the shift reflection means includes: wastegate valve control means for controlling the wastegate valve so as to change one of the open state of the wastegate valve and the closed state of the wastegate valve to the other one of the open state and closed state during operation of the internal combustion engine; acquisition means for acquiring the output of the air-fuel ratio sensor before and 
<!-- EPO <DP n="6"/>-->
 after the control performed by the wastegate valve control means; and calculation means for calculating, based on the output of the air-fuel ratio sensor before and after the control performed by the wastegate valve control means acquired by the acquisition means, a difference between the learning value calculated by the learning means in the open state of the wastegate valve and the learning value calculated by the learning means in the closed state of the wastegate valve. </p><p id="p0020" num="0020"> [0014] According to the abovementioned aspect, the difference in learning value occurring between the open and closed states of the wastegate valve can be accurately calculated. </p><p id="p0021" num="0021"> [0015] In the abovementioned aspect, the controller for an internal combustion engine according to any one of claims may further include correction means for correcting a fuel injection amount in the internal combustion engine so as to inhibit torque fluctuations in the internal combustion engine caused by a switching control when the switching control is performed to switch the wastegate valve between the open state and the closed state. </p><p id="p0022" num="0022"> [0016] According to the abovementioned aspect, the learning value shift amount can be reflected in the air-fuel ratio learning, while suppressing torque fluctuations. </p><p id="p0023" num="0023"> [0017] In the abovementioned aspect, the correction means may correct a fuel injection amount in the internal combustion engine so as to inhibit torque fluctuations in the internal combustion engine caused by the switching control only when a value of an intake air amount in the internal combustion engine is equal to or greater than a predetermined value. </p><p id="p0024" num="0024"> [0018] In the abovementioned aspect, when the wastegate valve is presently in the open state, the correction means may perform control from the open state to the closed state of the wastegate valve and correct a fuel injection amount to cut the fuel according to a torque difference corresponding to the control from the open state to the closed state. </p><p id="p0025" num="0025"> [0019] In the abovementioned aspect, when the wastegate valve is presently in the closed state, the correction means may perform control from the closed state to the 
<!-- EPO <DP n="7"/>-->
 open state of the wastegate valve and correct the fuel injection amount to increase the amount of fuel according to the torque difference corresponding to the control from the closed state to the open state. </p><p id="p0026" num="0026"> [0020] The second aspect of the invention relates to a control method for an internal combustion engine. The control method for an internal combustion engine includes: learning a learning value by performing air-fuel ratio learning in the internal combustion engine; calculating a difference between the learning value of the air-fuel ratio in an open state of a wastegate valve and the learning value of the air-fuel ratio in a closed state of the wastegate valve, and a) including in a result of the air-fuel ratio learning, the difference in the learning value or b) including in contents of air-fuel ratio control of the internal combustion engine using the learning value, the difference in the learning value. </p><p id="p0027" num="0027">BRIEF DESCRIPTION OF THE DRAWINGS </p><p id="p0028" num="0028"> [0021] Features, advantages, and technical and industrial significance of exemplary embodiments of the invention will be described below with reference to the accompanying drawings, in which like numerals denote like elements, and wherein: </p><p id="p0029" num="0029"> FIG. 1 illustrates the configuration of the controller for an internal combustion engine according to Embodiment 1 ; </p><p id="p0030" num="0030"> FIG. 2 is an image diagram illustrating schematically how the air-fuel ratio of the exhaust gas in the vicinity of the air-fuel ratio sensor changes in the closed state of the wastegate valve in the controller for an internal combustion engine in Embodiment 1 ; </p><p id="p0031" num="0031"> FIG. 3 is an image diagram illustrating schematically how the air-fuel ratio of the exhaust gas in the vicinity of the air-fuel ratio sensor changes in the open state of the wastegate valve in the controller for an internal combustion engine according to Embodiment 1 ; </p><p id="p0032" num="0032"> FIG. 4 illustrates schematically the correlation according to which the hydrogen generation amount increases as the air-fuel ratio becomes rich; </p><p id="p0033" num="0033"> FIG. 5 is a flowchart of the routine executed by an electronic control unit (ECU) in 
<!-- EPO <DP n="8"/>-->
 the controller for an internal combustion engine according to Embodiment 1 ; </p><p id="p0034" num="0034"> FIG. 6 illustrates the operation of the controller for an internal combustion engine according to Embodiment 2; </p><p id="p0035" num="0035"> FIG. 7 illustrates the operation of the controller for an internal combustion engine according to Embodiment 2; and </p><p id="p0036" num="0036"> FIG. 8 is a flowchart of the routine executed by the ECU in the controller for an internal combustion engine according to Embodiment 2. </p><p id="p0037" num="0037"> ί </p><p id="p0038" num="0038"> DETAILED DESCRIPTION OF EMBODIMENTS </p><p id="p0039" num="0039"> [0022] FIG. 1 illustrates the configuration of the controller for an internal combustion engine according to Embodiment 1 of the invention. The internal- combustion engine has an engine body 10 having four cylinders 11a, l ib, 11c, l id. An exhaust manifold 12 is connected to the engine body 10. The engine body 10 is provided with an intake valve, an exhaust valve, a spark plug, and a fuel injection valve (not shown in the figure) for each of the cylinders. Various components of the intake system such as intake sensors, for example, an intake manifold, an intake pressure sensor, and an air flowmeter, and also a throttle valve (not shown in the figure) are connected to the engine body 10. The internal combustion engine according to Embodiment 1 that includes the engine body 10 is used as a power source for a vehicle. </p><p id="p0040" num="0040"> [0023] The exhaust manifold 12 is connected by a turbocharger 20 to an exhaust pipe 14. The turbocharger 20 is provided with a turbine 20a. A compressor (not shown in the figure) of the turbocharger 20 is disposed at a predetermined position of the aforementioned intake system, and the compressor is driven by a rotation force of the turbine 20a generated by the exhaust gas. The turbocharger 20 is provided with a wastegate valve 22. As shown in FIG. 1, the wastegate valve 22 is a valve provided in a bypass passage provided so as to bypass the turbine 20a. </p><p id="p0041" num="0041"> [0024] An air-fuel ratio sensor 16 is<sub>.</sub> disposed downstream of the wastegate valve 22 downstream of the turbine 20a in the exhaust pipe 14. The air-fuel ratio sensor 16 is an exhaust gas sensor that outputs a signal corresponding linearly to the air- fuel 
<!-- EPO <DP n="9"/>-->
 ratio of the exhaust gas. A catalyst 18 is disposed further downstream of the air-fuel ratio sensor 16 in the exhaust pipe 14. </p><p id="p0042" num="0042"> [0025] The output signal of the air-fuel ratio sensor 16 is inputted to an ECU 30. The ECU 30 is connected to the wastegate valve 22 and performs control of switching the wastegate valve 22 between the open state and the closed state. Outputs of various sensors (in-cylinder pressure sensor, crank angle sensor, engine water temperature sensor, knock sensor, intake pressure sensor, air flow meter, throttle position sensor, accelerator position sensor relating to vehicle operation, and the like) relating to the engine body 10 are inputted to the input side of the ECU 30. Various actuators including fuel injection valves, spark plugs, and throttle motors are connected to the output side of the ECU 30. The ECU 30 realizes a predetermined program relating to control of the internal combustion engine on the basis of input information from various sensors and reflects this information in the operation of the actuators. </p><p id="p0043" num="0043"> [0026] The ECU 30 stores a program for performing air- fuel ratio learning on the basis of the output signals of the air-fuel ratio sensor 16. According to this program, learning values as results of the air-fuel ratio learning performed in the engine body 10 are calculated on the basis of the output signals of the air-fuel ratio sensor 16 and the learning values are stored in a storage device (an random access memory (RAM)) of the ECU 30. The ECU 30 is used for various types of control of the internal combustion engine such as fuel injection amount correction in fuel injection control. </p><p id="p0044" num="0044"> [0027] Specific contents of the air-fuel ratio control and air-fuel ratio learning according to Embodiment 1 will be explained below. The ECU 30 executes the air-fuel ratio control for adjusting the fuel injection amount such that the air-fuel ratio of the exhaust gas becomes a target air-fuel ratio. A main feedback control based on the outpour signal of a pre-catalyst sensor and a sub-feedback control based on the output signal of a post-catalyst sensor are generally available as constituents of the air-fuel ratio control. The main feedback control is a processing performed to match the output signal of the pre-catalyst sensor with the target air-fuel ratio. The sub-feedback control is a processing for compensating a stationary error included in the output signal of the 
<!-- EPO <DP n="10"/>-->
 post-catalyst sensor. In the configuration of the internal combustion engine in Embodiment 1, the air-fuel ratio sensor 16 can correspond to the pre-catalyst sensor referred to herein. </p><p id="p0045" num="0045"> [0028] The main feedback control will be explained below. In the main feedback control, a difference between the target and the actual air-fuel ratio of the exhaust gas measured by the air-fuel ratio sensor 16 is calculated, and a correction amount (referred to hereinbelow as "main FB correction value") that will be returned by feedback to the calculation of fuel injection amount by the proportional-integral (PI) control of the aforementioned difference is calculated. A stationary component included in the main FB correction value can be also learned as a learning value (referred to hereinbelow as " main FB learning value"). In the main feedback control, a correction coefficient of fuel injection amount is calculated by using the main FB correction value and main FB learning value, and a final fuel injection amount is calculated by multiplying the basic value of the fuel injection amount by this correction coefficient. The basic value of the fuel injection amount is calculated from the measured value of the intake air amount and the target air-fuel ratio. </p><p id="p0046" num="0046"> [0029] The main FB learning value is learned, for example, in the following manner. When the learning is started, the main FB learning value is set to a predetermined initial value (for example, zero). After the learning has been started, a predetermined update value is added to (or subtracted from) the main FB learning value within a predetermined period. As the learning advances, the stationary component that has been included in the main FB correction value is transferred by small portions into the main FB learning value, and the center of oscillations of the main FB correction value converges to zero. The learning of the main FB learning value ends when the center of oscillations of the main FB correction value converges to zero. </p><p id="p0047" num="0047"> [0030] FIG. 2 is an image diagram illustrating schematically how the air-fuel ratio of the exhaust gas in the vicinity of the air-fuel ratio sensor 16 changes in the closed state of the wastegate valve 22. By contrast with FIG. 2, FIG. 3 is an image diagram illustrating schematically how the air-fuel ratio of the exhaust gas in the vicinity of the 
<!-- EPO <DP n="11"/>-->
 air-fuel ratio sensor 16 changes in the open state of the wastegate valve 22. In the closed state of the wastegate valve 22, the entire exhaust gas collected in the exhaust manifold 12 flows through the turbine 20a. Where the exhaust gas flows through the turbine 20a, the exhaust gas is agitated by the turbine 20a, and mixing of the exhaust gas is thus advanced. Meanwhile, when the wastegate valve 22 is open, part of the exhaust gas bypasses the turbine 20a. Therefore, this bypassing exhaust gas is not mixed by the turbine 20a. </p><p id="p0048" num="0048"> [0031] As shown in FIGS. 2 and 3, the amplitude of the waveform of air-fuel ratio fluctuations differs between the open and closed states of the wastegate valve 22, and fluctuations of air-fuel ratio (amplitude of swinging to the rich and lean sides) is smaller in the closed state of the wastegate valve 22 in which the mixing enhancement effect is produced. Since the state of the exhaust gas passing through the air-fuel ratio sensor 16 fluctuates, these fluctuations also affect the results of air-fuel ratio learning. </p><p id="p0049" num="0049"> [0032] Accordingly, in Embodiment 1 , the difference between the learning value in the open state of the wastegate valve 22 and a learning value in the closed state of the wastegate valve 22 (this difference will be referred to hereinbelow as "learning value shift amount") is reflected in air-fuel ratio learning. More specifically, the learning value shift amount can be included in the results of air-fuel ratio learning and various modes can be realized correspondingly to the specific processing contents of individual air-fuel ratio learning routines. For example, a configuration can be considered in which the results of air-fuel ratio learning are stored as a map. In this case, when the learning value in the open state of the wastegate valve 22 and the learning value in the closed state of the wastegate valve 22 are mixed in the learning value- in the map, the learning value shift amount can be reflected in the results of air-fuel ratio learning by correcting the difference therebetween. For example, the learning value in one state may be taken as a reference and the learning value in the other state may be calculated, or the final learning value may be determined from the learning values in the two states. Further, the learning value shift amount may be also included in the contents of air-fuel ratio control of the internal combustion engine. More specifically, it is possible to store the learning 
<!-- EPO <DP n="12"/>-->
 value shift amount and include this learning value shift amount as necessary when using the learning value in the air-fuel ratio control (fuel injection amount control). Thus, by taking into account that the learning value shift amount occurs in the open and closed , states of the wastegate valve 22, it is possible to prevent the accuracy of air-fuel ratio learning from decreasing when the output signal of the air- fuel ratio sensor 16 is used in air-fuel ratio learning. As a result, the degradation of emission in air-fuel ratio control using the air-fuel ratio learning result can be inhibited. </p><p id="p0050" num="0050"> [0033] Where the effect of hydrogen (referred to hereinbelow as H<sub>2</sub>) is included in the learning value when air-fuel ratio learning based on the air-fuel ratio sensor output is performed, a difference (shift) occurs between the learning values obtained when the amount of H<sub>2</sub> is large and small. As a result, the air-fuel ratio sensor center displacement (displacement of the central air-fuel ratio from the stoichiometric air-fuel ratio) caused by H<sub>2</sub> occurs. More specifically, as shown schematically in FIG. 4, the correlation is such that as the air-fuel ratio shifts to the rich side, the amount of generated hydrogen increases. The transition to the rich side is deeper in the case of large fluctuations of the air-fuel ratio such as shown in FIG. 3, and therefore, the effect of air-fuel ratio sensor center displacement by H<sub>2</sub> tends to increase. According to this tendency, as mentioned hereinabove, the air-fuel ratio fluctuations tend to increase in the open state of the wastegate valve 22 (see FIG. 3), and the degree of the effect produced by H<sub>2</sub> on the learning results differs between the open and closed states of the wastegate valve 22. </p><p id="p0051" num="0051"> [0034] Accordingly, in Embodiment 1 , the difference in learning value between the open state and closed state of the wastegate valve 22 is learned as a "H<sub>2</sub> effect". In a region in which H<sub>2</sub> affects the air-fuel ratio output (more specifically, for example, in a cold state), the correction based on the "H<sub>2</sub> effect" is performed. As a result, the air-fuel ratio control can be performed more accurately and the emission can be reduced. </p><p id="p0052" num="0052"> [0035] When the abovementioned "H<sub>2</sub> effect" is taken into account, in Embodiment 1, either of the below-described control operation (1-1) and (1-2) is performed correspondingly to which of the "closed state" and "open state" of the 
<!-- EPO <DP n="13"/>-->
 wastegate valve 22 is used as a base for comparison. </p><p id="p0053" num="0053"> [0036] (1-1) The "closed state" of the wastegate valve 22 is used as a base for comparison </p><p id="p0054" num="0054"> In this case, the learning value shift amount corresponding to the transition of the wastegate valve 22 "from the closed state to the open state" is measured during warm-up (more specifically, for example, when the engine water temperature is &gt;70°C). More specifically, in this measurement, a learning value is calculated by the learning processing of the ECU 30 in the closed state of the wastegate valve 22, a learning value is then calculated by the learning processing of the ECU 30 in the open state of the wastegate valve 22 after the wastegate valve 22 has been controlled to the open state, and a difference between the two learning values is calculated as a learning value shift amount. When this learning value shift amount is equal to or larger than a predetermined value (emission impact is present), the air-fuel ratio control is performed upon including this learning value shift amount during the operation (running) in the open state of the wastegate valve 22 in a cold state. </p><p id="p0055" num="0055"> [0037] (1-2) The "open state" of the wastegate valve 22 is used as a base for comparison </p><p id="p0056" num="0056"> In this case, the learning value shift amount corresponding to the transition of the wastegate valve 22 "from the open state to the closed state" is measured during warm-up (more specifically, for example, when the engine water temperature is &gt;70°C). When this learning value shift amount is equal to or larger than the predetermined value (emission impact is present), the air-fuel ratio control is performed upon including this learning value shift amount during the operation (running) in the closed state of the wastegate valve 22 in a cold state. </p><p id="p0057" num="0057"> [0038]— , FIG. 5 is a flowchart of the routine executed by the ECU 30 in the controller for an internal combustion engine according to Embodiment 1 of the invention. This routine is executed with a predetermined period in the ECU 30. </p><p id="p0058" num="0058"> [0039] In the routine shown in FIG. 5, first, the ECU 30 determines whether or not the engine water temperature exceeds a predetermined value A (step SI 00). In step 
<!-- EPO <DP n="14"/>-->
 SI 00, the ECU 30 compares the engine water temperature detected on the basis of the output value of an engine water temperature sensor (not shown in the figure) with the predetermined value A. The predetermined value A can be set, for example, to 70°C. </p><p id="p0059" num="0059"> [0040] Then, the ECU 30 actively opens and closes the wastegate valve 22 and calculates the shift of the learning value amount (step SI 02). In step SI 02, the next sub-control processing is executed. </p><p id="p0060" num="0060"> [0041] First, step SI 02a is explained. The ECU 30 maintains the wastegate valve 22 in the open state during the operation of the internal combustion engine. The ECU 30 acquires the output of the air-fuel ratio sensor 16 in the open state of the wastegate valve 22. </p><p id="p0061" num="0061"> [0042] Then, step SI 02b is explained. The ECU 30 maintains the wastegate valve 22 in the closed state during the operation of the internal combustion engine. The ECU 30 acquires the output of the air-fuel ratio sensor 16 in the closed state of the wastegate valve 22. Actually, at the point of time of step SI 02, the wastegate valve 22 should be controlled to either of the closed state and the open state during the operation of the internal combustion engine. Therefore, at the point of time in which the processing of step SI 02 is started, the processing relating to either one of the closed state and the open state of the wastegate valve 22 (in other words, either of the above-described processing of step SI 02a and processing of step SI 02b) has already ended. Therefore, in step SI 02, the processing that has not ended at the point of time in which the processing of step SI 02 has started, from among the processing of steps SI 02a and S102b, may be performed by the ECU 30. Further, the opening-closing control of the wastegate valve 22 according to the step is an active control, that is an actively performed control. </p><p id="p0062" num="0062"> [0043] Finally, step SI 02c will be explained. The learning value in the open state of the wastegate valve 22 and the learning value in the closed state of the wastegate valve 22 are calculated on the basis of the output of the air-fuel ratio sensor 16 acquired in the open and closed states of the wastegate valve 22. The shift amount of the learning values thus calculated is then computed. 
<!-- EPO <DP n="15"/>-->
 [0044] Then, the ECU 30 determines whether or not the learning value shift amount calculated in step SI 02 is larger than the predetermined value C (sep SI 04). Step S 104 makes it possible to determine whether or not the shift of the learning value is so large that it cannot be ignored and to determine whether or not the shift of the learning value should be reflected in air-fuel ratio learning. </p><p id="p0063" num="0063"> [0045] The "predetermined value C" in step SI 04 can be specifically determined in the following manner. </p><p id="p0064" num="0064"> (i) The amount of shift of the air/fuel (A/F) center in A/F ratio control corresponding to the shift amount of the learning value is calculated. More specifically, the relationship between the variation in the A/F center and the variation in learning value may be determined according to the specific computational processing contents (that is, "a formula used for setting the A/F center, which is a computational formula including the air-fuel ratio learning value as a variable thereof) of air-fuel ratio learning which is actually installed in the ECU 30. </p><p id="p0065" num="0065"> (ii) The relationship between the A/F center shift amount and emission increase amount in a cold state is mapped correspondingly to the intake air amount ga and engine revolution speed ne. </p><p id="p0066" num="0066"> (iii) An emission generation amount that cannot be allowed can be set from various restrictions relating to the emission discharge amount. </p><p id="p0067" num="0067"> (iv) The "A/F center shift amount such that the emission generation amount cannot be allowed" can be determined correspondingly to the intake amount ga and engine revolution speed ne according to the abovementioned map, and "the learning value shift amount such that generates such an A/F center shift amount" can be also determined. The "predetermined value C" is set on the basis of the determined learning value shift amount. </p><p id="p0068" num="0068"> When the determination result in step SI 04 is No (the condition is not fulfilled) as a result of comparative determination using the predetermined value C that has been set in the above-described manner, the present routine ends. This is because it is possible to determine that the learning value shift amount calculated in step SI 02 is not large enough 
<!-- EPO <DP n="16"/>-->
 to be reflected in air-fuel ratio learning. </p><p id="p0069" num="0069"> [0046] When the determination result in step SI 04 is Yes (the condition if fulfilled), the ECU 30 takes in the learning value shift (step SI 06). In step SI 06, the ECU 30 takes in the learning value shift amount calculated in step SI 02 since it is determined in the abovementioned step SI 04 that the shift of the learning value should be reflected in air-fuel ratio learning. This "take-in" processing can involve learning of the aforementioned "¾ effect". For example, it is possible to store the value of the shift amount itself, or calculate a predetermined correction coefficient from the shift amount and store this correction coefficient. </p><p id="p0070" num="0070"> [0047] Then, the ECU 30 determines whether or not the engine water temperature is below the predetermined value B (step SI 08). In step SI 08, the processing is performed to determine whether or not the internal combustion engine is in a cold state. Where the engine is in a cold state, it corresponds to the region in which H<sub>2</sub> affects the air-fuel ratio output, and it is possible to conclude that the correction based on the "H<sub>2</sub> effect" should be performed. In FIG. 5, steps S I 00 to SI 08 are described as a continuous routine within one flowchart, but actually suitable flowcharts are not limited to that shown in the figure. Where there is a time interval after the processing from the abovementioned steps SI 00 to SI 06 has ended and before the cold operation period is reached, the routine preceding the take-in processing of the learning value shift amount and the routine perform to reflect the learning value shift during cold operation may be executed independently from each other by the ECU 30. </p><p id="p0071" num="0071"> [0048] Then, the ECU 30 reflects the learning value shift in the air-fuel ratio learning value (step SI 10). In step SI 10, the air- fuel ratio control using the air- fuel ratio learning value is performed after the <sup>1</sup> learning value shift amount has been included during the operation (running) in the open state of the wastegate valve 22 in a cold state of the engine, or the air- fuel ratio control using the air-fuel ratio learning value is performed after the learning value shift amount has been included during the operation (running) in the closed state of the wastegate valve 22 in a cold state of the engine. The present routine is thereafter ended. 
<!-- EPO <DP n="17"/>-->
 [0049] With the specific processing according to the above-described Embodiment 1 , by taking into account the occurrence of a learning value shift amount between the open state and the closed state of the wastegate valve 22, it is possible to inhibit the decrease in accuracy of air-fuel ratio learning when output signal of the air-fuel ratio sensor 16 is used for air-fuel ratio learning and inhibit the degradation of emission in air-fuel ratio control using the air-fuel ratio learning results. In particular, by learning the difference in learning value between the open state and closed state of the wastegate valve 22 as a learning value of "H<sub>2</sub> effect", it is possible to perform the correction based on this "H<sub>2</sub> effect" in the cold operation period which is a region in which H<sub>2</sub> affects the air-fuel ratio output. As a result, the air-fuel ratio control can be performed more accurately and emission decrease can be ensured. </p><p id="p0072" num="0072"> [0050] The invention is not limited to the abovementioned routine. Thus, it is not necessary to handle the learning value shift amount as the H<sub>2</sub> effect, and the learning value shift amount may be reflected in air-fuel ratio learning as necessary, that is, not in the form of taking the H<sub>2</sub> effect into account only in the cold state. </p><p id="p0073" num="0073"> [0051] . A controller for an internal combustion engine according to Embodiment 2 of the invention has hardware configuration similar to that of Embodiment 1 shown in FIG. 1, and the description thereof will be hereinbelow omitted or simplified to avoid redundant explanation. Control operations of various kinds (software configuration) such as air-fuel ratio learning in the controller for an internal combustion engine according to Embodiment 2 are also similar to those in Embodiment 1. In Embodiment 2, the reflection of the learning value shift amount in air-fuel ratio learning according to Embodiment 1 can be performed, while inhibiting a torque shock by adding the following control corresponding to intake air amount. </p><p id="p0074" num="0074"> [0052] FIGS. 6 and 7 illustrate the operation of the controller for an internal combustion engine according to Embodiment 2. When the intake air amount in the engine body 10 is small enough so that that the torque shock caused by opening and closing of the wastegate valve 22 can be ignored, the control according to Embodiment 1 (control routine shown in FIG. 5) can be executed. Meanwhile, when the torque shock 
<!-- EPO <DP n="18"/>-->
 caused by opening and closing of the wastegate valve 22 cannot be ignored, either of the below-described measures (2-1) and (2-2) can be used to inhibit the torque shock. </p><p id="p0075" num="0075"> [0053] (2-1) When the wastegate valve 22 is caused to make a transition from the open state to the closed state, a torque shock occurs due to the increase in torque (see broken line in FIG. 6). Therefore, the torque is controlled to a constant value to inhibit such torque shock. More specifically, the fuel injection amount is corrected so as to inhibit torque fluctuations, or the increase in torque is inhibited by performing a control to delay the ignition timing, decrease the engine revolution speed, and decrease the opening degree of the throttle (see the arrow in FIG. 6). </p><p id="p0076" num="0076"> [0054] (2-2) When the wastegate valve 22 is caused to make a transition from the closed state to the open state, a torque shock occurs due to the decrease in torque (see broken line in FIG. 7). Therefore, the torque is controlled to a constant value to inhibit such torque shock. More specifically, the fuel injection amount is corrected so as to inhibit torque fluctuations, or the decrease in torque is inhibited by performing a control to increase the engine revolution speed and increase the opening degree of the throttle (see the arrow in FIG. 7). </p><p id="p0077" num="0077"> [0055] FIG. 8 is a flowchart of the routine executed by the ECU 30 in the controller for an internal combustion engine according to Embodiment 2. This routine can be executed in the ECU 30 with a predetermined period. </p><p id="p0078" num="0078"> [0056] In the routine shown in FIG 8, first, the ECU 30 executes the processing of step SI 00, in the same manner as in the routine shown in FIG 5 and relating to Embodiment 1. </p><p id="p0079" num="0079"> [0057] Then, the ECU 30 determines whether or not the value of the intake air amount is less than a predetermined value D (step S200). When the condition of step S200 is fulfilled, the ECU 30 executes the processing of steps SI 02, SI 04, SI 06, SI 08, and SI 10 in the same manner as in the routine shown in FIG. 5 and relating to Embodiment 1. </p><p id="p0080" num="0080"> [0058] When the condition of step S200 is not fulfilled, that is, when the value of the intake air amount is equal to or greater than the predetermined value D, the ECU 
<!-- EPO <DP n="19"/>-->
 30 then determines whether or not the wastegate valve 22 (shown as "WGV" in the FIGS.) is presently in the open state (step S202). </p><p id="p0081" num="0081"> [0059] Where the determination result of step S202 is positive (Yes), the ECU 30 causes a transition of the wastegate valve 22 from the open state to the closed state and corrects the fuel injection amount so as to cut the amount of fuel according to the torque variation corresponding to such transition (step S204). As a result, a torque stabilization operation according to the aforementioned measure (2-1) can be realized. </p><p id="p0082" num="0082"> [0060] Then, the ECU 30 calculates the learning value shift amount corresponding to the transition of the wastegate valve 22 from the open state to the closed state (step S206). In step S206, the ECU 30 executes the computational processing similar to the computation of the learning value shift amount in step SI 02. Then, the ECU 30 executes the processing of steps S104, S106, S108, and S110 in the same manner as in the routine shown in FIG. 5 and relating to Embodiment 1. The present routine is thereafter ended. </p><p id="p0083" num="0083"> [0061] Where the determination result of step S202 is negative (No), the ECU</p><p id="p0084" num="0084">30 causes a transition of the wastegate valve 22 from the closed state to the open state and corrects the fuel injection amount so as to increase the amount of fuel according to the torque variation corresponding to such transition (step S208). As a result, a torque stabilization operation according to the aforementioned measure (2-2) can be realized. </p><p id="p0085" num="0085"> [0062] Then, the ECU 30 calculates the learning value shift amount corresponding to the transition of the wastegate valve 22 from the closed state to the open state (step S210). Then, the ECU 30 executes the processing of steps SI 04, SI 06, SI 08, and Sl lO in the same manner as in the routine shown in FIG. 5 and relating to Embodiment 1. The present routine is thereafter ended. </p><p id="p0086" num="0086"> [0063] According to the above-described processing, the learning value shift amount can be reflected in air-fuel ratio learning, while inhibiting the torque shock. </p><p id="p0087" num="0087"> [0064] While the invention has been described with reference to example embodiments thereof, it is to be understood that the invention is not limited to the described embodiments or constructions. To the contrary, the invention is intended to 
<!-- EPO <DP n="20"/>-->
 cover various modifications and equivalent arrangements. In addition, while the various elements of the disclosed invention are shown in various example combinations and configurations, other combinations and configurations, including more, less or only a single element, are also within the scope of the appended claims. 
</p></description><claims mxw-id="PCLM44727132" ref-ucid="WO-2012114170-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="21"/>-->CLAIMS: </claim-statement><claim id="clm-0001" num="1"><claim-text>1. A controller for an internal combustion engine, characterized by comprising: a supercharger (20) provided in an internal combustion engine (10) and having a wastegate valve (22); </claim-text><claim-text> an air-fuel ratio sensor (16) provided downstream of a turbine (20a) of the supercharger (20) in an exhaust passage (14) of the internal combustion engine (10); learning means for learning a learning value by performing air-fuel ratio learning in the internal combustion engine (10) on the basis of an output of the air-fuel ratio sensor (16); and </claim-text><claim-text> shift reflection means for: a) including in a result of the air-fuel ratio learning, a difference between the learning value in an open state of the wastegate valve (22) and the learning value in a closed state of the wastegate valve (22), or b) including in contents of air-fuel ratio control of the internal combustion engine using the learning value, a difference between the learning value in an open state of the wastegate valve (22) and the learning value in a closed state of the wastegate valve (22). </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. The controller for an internal combustion engine according to claim 1, further comprising wastegate valve control means for controlling the wastegate valve (22) to one of the closed state and the open state during a cold operation of the internal combustion engine (10), </claim-text><claim-text> wherein when the wastegate valve (22) has been controlled to one of the closed state and the open state during the cold operation, the shift reflection means uses a corrected learning value, which is a value obtained by including the learning value in the other one of the open state and the closed state of the wastegate valve (22) in the learning value in the one of the open state and closed state, in order to control the internal combustion engine (10) during the cold operation. </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. The controller for an internal combustion engine according to claim 2, wherein <!-- EPO <DP n="22"/>--> the shift reflection means uses the corrected learning value to control the internal combustion engine during the cold operation only when a value of the difference between the learning value in the open state of the wastegate valve (22) and the learning value in the closed state of the wastegate valve (22) is larger than a predetermined value (C). </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. The controller for an internal combustion engine according to claim 2 or 3, wherein a period of cold operation is when a temperature of cooling water that cools the internal combustion engine (10) is equal to or lower than a predetermined temperature (B). </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. The controller for an internal combustion engine according to any one of claims 2 to 4, wherein the learning means calculates the learning value by including an effect produced by hydrogen on an output of the air-fuel ratio sensor (16) during the cold operation. </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. The controller for an internal combustion engine according to any one of claims 1 to 5, wherein the shift reflection means comprises: </claim-text><claim-text> wastegate valve control means for controlling the wastegate valve (22) so as to change one of the open state of the wastegate valve (22) and the closed state of the wastegate valve (22) to the other one of the open state or closed state during operation of the internal combustion engine (10); </claim-text><claim-text> acquisition means for acquiring the output of the air-fuel ratio sensor (16) before and after the control performed by the wastegate valve control means; and </claim-text><claim-text> calculation means for calculating, based on the output of the air-fuel ratio sensor (16) before and after the control performed by the wastegate valve control means acquired by the acquisition means, a difference between the learning value calculated by the learning means in the open state of the wastegate valve (22) and the learning value calculated by the learning means in the closed state of the wastegate valve (22). <!-- EPO <DP n="23"/>--> </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. The controller for an internal combustion engine according to any one of claims 1 to 6, further comprising correction means for correcting a fuel injection amount in the internal combustion engine (10) so as to inhibit torque fluctuations in the internal combustion engine (10) caused by a switching control when the switching control is performed to switch the wastegate valve (22) between the open state and closed state. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. The controller for an internal combustion engine according to claim 7, wherein the correction means corrects a fuel injection amount in the internal combustion engine (10) so as to inhibit torque fluctuations in the internal combustion engine (10) caused by the switching control only when a value of an intake air amount in the internal combustion engine (10) is equal to or greater than a predetermined value (D). </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. The controller for an internal combustion engine according to claim 7 or 8, wherein when the wastegate valve (22) is presently in the open state, the correction means performs control from the open state to the closed state of the wastegate valve (22) and corrects a fuel injection amount to cut the fuel according to a torque difference corresponding to the control from the open state to the closed state. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. The controller for an internal combustion engine according to claim 7 or 8, wherein when the wastegate valve (22) is presently in the closed state, the correction means performs control from the closed state to the open state of the wastegate valve (22) and corrects the fuel injection amount to increase the amount of fuel according to the torque difference corresponding to the control from the closed state to the open state. </claim-text></claim><claim id="clm-0011" num="11"><claim-text>11. A control method for an internal combustion engine characterized by comprising: </claim-text><claim-text> learning a learning value by performing air-fuel ratio learning in the internal combustion engine (10); </claim-text><claim-text> calculating a difference between the learning value of the air-fuel ratio in an open <!-- EPO <DP n="24"/>--> state of a wastegate valve (22) and the learning value of the air-fuel ratio in a closed state of the wastegate valve (22); and </claim-text><claim-text> a) including in a result of the air-fuel ratio learning, the difference in the learning value or b) including in contents of air-fuel . ratio control of the internal combustion engine using the learning value, the difference in the learning value. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
