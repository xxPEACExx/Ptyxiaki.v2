<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2677937-A1" country="EP" doc-number="2677937" kind="A1" date="20140101" family-id="45809351" file-reference-id="318301" date-produced="20180826" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146551700" ucid="EP-2677937-A1"><document-id><country>EP</country><doc-number>2677937</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12707136-A" is-representative="NO"><document-id mxw-id="PAPP154825623" load-source="docdb" format="epo"><country>EP</country><doc-number>12707136</doc-number><kind>A</kind><date>20120213</date><lang>EN</lang></document-id><document-id mxw-id="PAPP196399975" load-source="docdb" format="original"><country>EP</country><doc-number>12707136.3</doc-number><date>20120213</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140449953" ucid="IB-2012050623-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>IB</country><doc-number>2012050623</doc-number><kind>W</kind><date>20120213</date></document-id></priority-claim><priority-claim mxw-id="PPC140453581" ucid="US-201161446105-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201161446105</doc-number><kind>P</kind><date>20110224</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988133568" load-source="docdb">A61B   6/12        20060101AFI20120911BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988137505" load-source="docdb">A61B  19/00        20060101ALI20120911BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1623806294" load-source="docdb" scheme="CPC">A61B2017/00694     20130101 LA20180626BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1623806295" load-source="docdb" scheme="CPC">A61B   6/03        20130101 LA20131127BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1889107179" load-source="docdb" scheme="CPC">A61B   5/742       20130101 LI20161012BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1976545454" load-source="docdb" scheme="CPC">A61B2034/2061      20160201 LA20160201BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1976548551" load-source="docdb" scheme="CPC">A61B2090/065       20160201 LA20160201BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1976550840" load-source="docdb" scheme="CPC">A61B2034/2051      20160201 LA20160201BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1976552977" load-source="docdb" scheme="CPC">A61B  34/20        20160201 LI20160201BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988096070" load-source="docdb" scheme="CPC">A61B   6/463       20130101 LI20130720BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988096321" load-source="docdb" scheme="CPC">A61B   6/12        20130101 LI20130720BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988096439" load-source="docdb" scheme="CPC">A61B   5/6876      20130101 LI20130720BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988099260" load-source="docdb" scheme="CPC">A61B   6/485       20130101 LI20131127BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988102299" load-source="docdb" scheme="CPC">A61B   6/5229      20130101 LI20130720BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988102621" load-source="docdb" scheme="CPC">A61B   5/055       20130101 LI20131127BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988106177" load-source="docdb" scheme="CPC">A61B   6/466       20130101 LI20130720BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988107336" load-source="docdb" scheme="CPC">A61B   5/066       20130101 FI20131127BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988109671" load-source="docdb" scheme="CPC">A61B   6/487       20130101 LI20131206BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988110222" load-source="docdb" scheme="CPC">A61B   8/0841      20130101 LI20131127BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988123017" load-source="docdb" scheme="CPC">A61B   5/062       20130101 LI20131127BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988126886" load-source="docdb" scheme="CPC">A61B   5/064       20130101 LI20131127BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988131177" load-source="docdb" scheme="CPC">A61B   6/504       20130101 LA20130720BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988136928" load-source="docdb" scheme="CPC">A61B   5/0084      20130101 LI20131127BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132187584" lang="DE" load-source="patent-office">FORMUNG EINES GEFÄSSBILDES EINES NICHT STEIFEN KÖRPERS MITTELS EINER INTRAVASKULÄREN FORMVORRICHTUNG</invention-title><invention-title mxw-id="PT132187585" lang="EN" load-source="patent-office">NON-RIGID-BODY MORPHING OF VESSEL IMAGE USING INTRAVASCULAR DEVICE SHAPE</invention-title><invention-title mxw-id="PT132187586" lang="FR" load-source="patent-office">MORPHAGE DE CORPS NON RIGIDE D'UNE IMAGE VASCULAIRE À L'AIDE D'UNE FORME DE DISPOSITIF INTRAVASCULAIRE</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR918164453" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>KONINKL PHILIPS NV</last-name><address><country>NL</country></address></addressbook></applicant><applicant mxw-id="PPAR918144438" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>KONINKLIJKE PHILIPS N.V.</last-name></addressbook></applicant><applicant mxw-id="PPAR918984768" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Koninklijke Philips N.V.</last-name><iid>101391185</iid><address><street>High Tech Campus 5</street><city>5656 AE Eindhoven</city><country>NL</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918136277" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>BARLEY MAYA ELLA</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR918151772" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>BARLEY, MAYA ELLA</last-name></addressbook></inventor><inventor mxw-id="PPAR918988909" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>BARLEY, MAYA ELLA</last-name><address><street>c/o High Tech Campus Building 44</street><city>NL-5656 AE Eindhoven</city><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR918151486" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>DESJARDINS ADRIEN EMMANUEL</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR918173034" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>DESJARDINS, ADRIEN EMMANUEL</last-name></addressbook></inventor><inventor mxw-id="PPAR918978566" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>DESJARDINS, ADRIEN EMMANUEL</last-name><address><street>c/o High Tech Campus Building 44</street><city>NL-5656 AE Eindhoven</city><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR918139982" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>CHAN RAYMOND</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR918152918" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>CHAN, RAYMOND</last-name></addressbook></inventor><inventor mxw-id="PPAR918990549" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>CHAN, RAYMOND</last-name><address><street>c/o High Tech Campus Building 44</street><city>NL-5656 AE Eindhoven</city><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR918164279" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>T HOOFT GERT WIM</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR918139438" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>T'HOOFT, Gert Wim</last-name></addressbook></inventor><inventor mxw-id="PPAR918993972" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>T'HOOFT, Gert Wim</last-name><address><street>c/o High Tech Campus Building 44</street><city>NL-5656 AE Eindhoven</city><country>NL</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918982106" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Steffen, Thomas</last-name><iid>100958149</iid><address><street>Philips Intellectual Property &amp; Standards P.O. Box 220</street><city>5600 AE Eindhoven</city><country>NL</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="IB-2012050623-W"><document-id><country>IB</country><doc-number>2012050623</doc-number><kind>W</kind><date>20120213</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012114224-A1"><document-id><country>WO</country><doc-number>2012114224</doc-number><kind>A1</kind><date>20120830</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS548935427" load-source="docdb">AL</country><country mxw-id="DS548939376" load-source="docdb">AT</country><country mxw-id="DS548935428" load-source="docdb">BE</country><country mxw-id="DS548923726" load-source="docdb">BG</country><country mxw-id="DS548818150" load-source="docdb">CH</country><country mxw-id="DS548938050" load-source="docdb">CY</country><country mxw-id="DS548939377" load-source="docdb">CZ</country><country mxw-id="DS548935429" load-source="docdb">DE</country><country mxw-id="DS548938051" load-source="docdb">DK</country><country mxw-id="DS548938052" load-source="docdb">EE</country><country mxw-id="DS548947246" load-source="docdb">ES</country><country mxw-id="DS548923727" load-source="docdb">FI</country><country mxw-id="DS548818151" load-source="docdb">FR</country><country mxw-id="DS548935434" load-source="docdb">GB</country><country mxw-id="DS548938053" load-source="docdb">GR</country><country mxw-id="DS548935435" load-source="docdb">HR</country><country mxw-id="DS548939378" load-source="docdb">HU</country><country mxw-id="DS548869335" load-source="docdb">IE</country><country mxw-id="DS548938054" load-source="docdb">IS</country><country mxw-id="DS548818152" load-source="docdb">IT</country><country mxw-id="DS548938055" load-source="docdb">LI</country><country mxw-id="DS548923728" load-source="docdb">LT</country><country mxw-id="DS548841336" load-source="docdb">LU</country><country mxw-id="DS548923729" load-source="docdb">LV</country><country mxw-id="DS548923734" load-source="docdb">MC</country><country mxw-id="DS548841337" load-source="docdb">MK</country><country mxw-id="DS548841338" load-source="docdb">MT</country><country mxw-id="DS548923735" load-source="docdb">NL</country><country mxw-id="DS548818153" load-source="docdb">NO</country><country mxw-id="DS548923736" load-source="docdb">PL</country><country mxw-id="DS548869336" load-source="docdb">PT</country><country mxw-id="DS548935436" load-source="docdb">RO</country><country mxw-id="DS548869337" load-source="docdb">RS</country><country mxw-id="DS548923737" load-source="docdb">SE</country><country mxw-id="DS548947247" load-source="docdb">SI</country><country mxw-id="DS548818154" load-source="docdb">SK</country><country mxw-id="DS548818155" load-source="docdb">SM</country><country mxw-id="DS548938056" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><abstract mxw-id="PA99623620" ref-ucid="WO-2012114224-A1" lang="EN" load-source="patent-office"><p num="0000">A medical method and system include a medical imaging system (105) configured to generate images of an interventional procedure. An overlay generator (113) is configured to generate an overlay image on the images of the interventional procedure. An interventional device tracking system (108, 125) is configured to track a three-dimensional position, orientation and shape of the interventional device during the procedure, wherein the overlay image is dynamically updated in response to deformations caused to an organ of interest by the interventional device during the procedure.</p></abstract><abstract mxw-id="PA99822439" ref-ucid="WO-2012114224-A1" lang="EN" source="national office" load-source="docdb"><p>A medical method and system include a medical imaging system (105) configured to generate images of an interventional procedure. An overlay generator (113) is configured to generate an overlay image on the images of the interventional procedure. An interventional device tracking system (108, 125) is configured to track a three-dimensional position, orientation and shape of the interventional device during the procedure, wherein the overlay image is dynamically updated in response to deformations caused to an organ of interest by the interventional device during the procedure.</p></abstract><abstract mxw-id="PA99623621" ref-ucid="WO-2012114224-A1" lang="FR" load-source="patent-office"><p num="0000">La présente invention concerne un procédé médical et un système médical qui comprennent un système d'imagerie médicale (105) configuré pour générer des images d'une intervention chirurgicale. Un générateur de recouvrement (113) est configuré pour générer une image de recouvrement sur les images de l'intervention chirurgicale. Un système de suivi de dispositif d'intervention (108, 125) est configuré pour suivre une position en trois dimensions, l'orientation et la forme du dispositif d'intervention durant la procédure, l'image de recouvrement subissant une mise à jour dynamique en réponse aux déformations entraînées sur un organe d'intérêt par le dispositif d'intervention pendant l'intervention.</p></abstract><abstract mxw-id="PA99822440" ref-ucid="WO-2012114224-A1" lang="FR" source="national office" load-source="docdb"><p>La présente invention concerne un procédé médical et un système médical qui comprennent un système d'imagerie médicale (105) configuré pour générer des images d'une intervention chirurgicale. Un générateur de recouvrement (113) est configuré pour générer une image de recouvrement sur les images de l'intervention chirurgicale. Un système de suivi de dispositif d'intervention (108, 125) est configuré pour suivre une position en trois dimensions, l'orientation et la forme du dispositif d'intervention durant la procédure, l'image de recouvrement subissant une mise à jour dynamique en réponse aux déformations entraînées sur un organe d'intérêt par le dispositif d'intervention pendant l'intervention.</p></abstract><description mxw-id="PDES50930912" ref-ucid="WO-2012114224-A1" lang="EN" load-source="patent-office"><!-- EPO <DP n="3"/>--><p id="p0001" num="0001"> NON-RIGID-BODY MORPHING OF VESSEL IMAGE USING INTRAVASCULAR </p><p id="p0002" num="0002"> DEVICE SHAPE </p><p id="p0003" num="0003">This disclosure relates to image registration, and more particularly to dynamic overlay morphing in accordance with dynamic behavior of internal organs, endo luminal anatomy, or vascular structures due to interventional medical devices. </p><p id="p0004" num="0004"> Stand-alone fluoroscopy is a standard imaging modality for many interventional procedures. One significant drawback to x-ray usage is the lack of soft-tissue definition. While interventional devices are clearly visible, the treatment site (typically a soft tissue structure) is almost invisible unless some form of x-ray contrast agent is used to define it more clearly. Furthermore, such contrast agents are frequently nephrotoxic, and their use needs to be minimized. As a result, three-dimensional (3D) image overlay on live fluoroscopy would be desirable in many x-ray guided interventional procedures. The overlay would assist in the guidance of an interventional device to the treatment site by providing continuously-visualized, static, morphological information. The 3D overlay must accurately reflect the real anatomy (to within a few mm) to be clinically relevant, which is often a challenging task. </p><p id="p0005" num="0005"> The 3D overlaid image may be either an intra-procedurally-generated image (such as a Philips<sup>®</sup> 3D-RA™ or XperCT™) or a pre-procedural image (e.g., magnetic resonance (MR) or computed tomography (CT)). The image is intended to closely correspond to the patient's anatomy for the duration of time that it is used as an overlay. However, it is widely known that a stiff instrument can significantly deform a vessel's shape by pressing against its walls. </p><p id="p0006" num="0006"> Although interventional devices are inside the patient's vessels, their trajectories on a 
<!-- EPO <DP n="4"/>-->
 fluoroscopic image may lie, in part, outside the static 3D overlay due to deformation of the real anatomy by the instruments. As a result, pre-procedural image overlays may not be accurate or clinically useful for guiding an interventional device into or through narrow lumens (e.g., a small vascular sidebranch). </p><p id="p0007" num="0007"> Multiple technologies for 3D localization and sensing along an interventional device include the following. Electromagnetic (EM) localization where single-point EM sensors can be used to accurately localize points at intervals along an interventional device. By interpolating between these points, the 3D device shape can be determined. Fiber-optic shape sensing based on scattering from Fiber Bragg Gratings (FBG) or Rayleigh scattering is another approach that permits the entire device shape in three dimensions to be determined. X-ray-based 3D device shape determination may also be used to interrogate the 3D shape of an interventional device from x-ray alone, using a combination of known device-based x-ray markers and x-ray system geometry to estimate location and configuration of the </p><p id="p0008" num="0008">interventional device. Given any particular imaging system geometry, the shapes of these markers on an x-ray image could vary depending on their 3D orientations, which depend, in turn, on the interventional device shapes. Therefore, x-ray markers may be used to approximate the 3D device shape. Characteristics of the device shape may also be determined with other sensing schemes occurring simultaneously with fluoroscopy, such as with ultrasound (conventional imaging or ultrasound time-of- flight localization of beacons embedded within the device), photoacoustics, impedance-based localization, etc. </p><p id="p0009" num="0009"> In accordance with the present principles, a medical method and system include a medical imaging system configured to generate images of an interventional procedure. An overlay generator is configured to generate an overlay image on the images of the interventional procedure. An interventional device tracking system is configured to track a 3D position, orientation and shape of the interventional device during the procedure, wherein 
<!-- EPO <DP n="5"/>-->
 the overlay image is dynamically updated in response to deformations caused to an organ of interest by the interventional device during the procedure. </p><p id="p0010" num="0010"> A method for a medical procedure includes generating images of an interventional procedure; generating an overlay image on the images of the interventional procedure; </p><p id="p0011" num="0011">tracking a position, orientation and shape of the interventional device during the procedure; dynamically updating the overlay image in response to deformations caused to an organ of interest by the interventional device during the procedure. </p><p id="p0012" num="0012"> Another method for a medical procedure includes generating images of an interventional procedure; generating an overlay image on the images of the interventional procedure; tracking a position, orientation and shape of the interventional device during the procedure; checking whether the interventional device remains within a boundary of the overlay image; if the interventional device is not fully enclosed in the boundary, determining a deformation of the organ that will permit the interventional device to remain within the boundary; and dynamically updating the overlay image in accordance with the deformation. </p><p id="p0013" num="0013"> These and other objects, features and advantages of the present disclosure will become apparent from the following detailed description of illustrative embodiments thereof, which is to be read in connection with the accompanying drawings. </p><p id="p0014" num="0014"> This disclosure will present in detail the following description of preferred embodiments with reference to the following figures wherein: </p><p id="p0015" num="0015"> FIG. 1 is a block/flow diagram showing a system/method for updating an overlay image in accordance with the present principles; </p><p id="p0016" num="0016"> FIG. 2 is a flow diagram showing a method for performing a procedure with updated overlay images in accordance with one illustrative embodiment; </p><p id="p0017" num="0017"> FIG. 3 is a flow diagram showing a method for updating an overlay image using models in accordance with another illustrative embodiment; and 
<!-- EPO <DP n="6"/>-->
 FIG. 4 is a flow diagram showing a method for updating an overlay image in accordance with another illustrative embodiment. </p><p id="p0018" num="0018"> The present disclosure describes three-dimensional (3D) image overlay systems and methods. The present embodiments improve accuracy of 3D image overlays on live fluoroscopy images for interventional procedures by non-rigid-body warping of the 3D image of an organ based on the 3D shape of the interventional device within that organ. This technique could be applied in any (e.g., minimally-invasive) interventional vascular, luminal or interstitial procedure where highly precise device placement is needed and/or the tissue morphology (e.g., the vessel in a vascular procedure) is significantly affected by inserting a rigid or semi-rigid device (e.g., abdominal or thoracic aorta stent-grafting, carotid artery stenting, Uterine fibroid embolizations (UFEs), Transjugular Intrahepatic Portosystemic Shunt (TIPS), Transarterial Chemoembolization (TACE) procedures), etc. The present embodiments may be employed in any interventional vascular procedures, e.g., where highly precise device-placement is needed and/or the vessel morphology is significantly affected by inserting a comparatively stiff device. </p><p id="p0019" num="0019"> It also should be understood that the present invention will be described in terms of medical instruments; however, the teachings of the present invention are much broader and are applicable to any instruments employed in tracking or analyzing complex biological or mechanical systems. In particular, the present principles are applicable to internal tracking procedures of biological systems, procedures in all areas of the body such as the lungs, gastro -intestinal tract, excretory organs, blood vessels, etc. The elements depicted in the FIGS, may be implemented in various combinations of hardware and software and provide functions which may be combined in a single element or multiple elements. </p><p id="p0020" num="0020"> The functions of the various elements shown in the FIGS, can be provided through the use of dedicated hardware as well as hardware capable of executing software in 
<!-- EPO <DP n="7"/>-->
 association with appropriate software. When provided by a processor, the functions can be provided by a single dedicated processor, by a single shared processor, or by a plurality of individual processors, some of which can be shared. Moreover, explicit use of the term "processor" or "controller" should not be construed to refer exclusively to hardware capable of executing software, and can implicitly include, without limitation, digital signal processor ("DSP") hardware, read-only memory ("ROM") for storing software, random access memory ("RAM"), non-volatile storage, etc. </p><p id="p0021" num="0021"> Moreover, all statements herein reciting principles, aspects, and embodiments of the invention, as well as specific examples thereof, are intended to encompass both structural and functional equivalents thereof. Additionally, it is intended that such equivalents include both currently known equivalents as well as equivalents developed in the future (i.e., any elements developed that perform the same function, regardless of structure). Thus, for example, it will be appreciated by those skilled in the art that the block diagrams presented herein represent conceptual views of illustrative system components and/or circuitry embodying the principles of the invention. Similarly, it will be appreciated that any flow charts, flow diagrams and the like represent various processes which may be substantially represented in computer readable storage media and so executed by a computer or processor, whether or not such computer or processor is explicitly shown. </p><p id="p0022" num="0022"> Furthermore, embodiments of the present invention can take the form of a computer program product accessible from a computer-usable or computer-readable storage medium providing program code for use by or in connection with a computer or any instruction execution system. For the purposes of this description, a computer-usable or computer readable storage medium can be any apparatus that may include, store, communicate, propagate, or transport the program for use by or in connection with the instruction execution system, apparatus, or device. The medium can be an electronic, magnetic, optical, 
<!-- EPO <DP n="8"/>-->
 electromagnetic, infrared, or semiconductor system (or apparatus or device) or a propagation medium. Examples of a computer-readable medium include a semiconductor or solid state memory, magnetic tape, a removable computer diskette, a random access memory (RAM), a read-only memory (ROM), a rigid magnetic disk and an optical disk. Current examples of optical disks include compact disk - read only memory (CD-ROM), compact disk - read/write (CD-R/W) and DVD. </p><p id="p0023" num="0023"> Referring now to the drawings in which like numerals represent the same or similar elements and initially to FIG. 1, a system 100 for maintaining registration between a fluoroscopy image and an overlay is illustratively depicted. The system 100 improves the accuracy of a 3D image overlay on a live imaging (e.g., fluoroscopy) system or platform 105 for vascular interventional procedures. In one embodiment, imaging system 105 includes a fluoroscopy system which may be employed without the use of contrast dyes as a result of the dynamic overlay in accordance with the present principles. </p><p id="p0024" num="0024"> The system 100 includes an interventional device 104 intended for insertion into vascular structures. The interventional device 104 may include a catheter, a probe, a diagnostic sensor, a guidewire, a therapy delivering element, a needle for biopsy or therapy delivery (e.g. injection of biologies, ablative, or embolic material), a cutting device, a shaping device, a prosthetic support device, an endoscope, a robot, an electrode, a filter device, a balloon device or any other rigid, semi-rigid or fully flexible instrument. The interventional device 104 may be coupled to a workstation or other console 112 by a cable</p><p id="p0025" num="0025">127 or other connection. A procedure is supervised and/or managed from the workstation or console 112. Workstation 112 preferably includes one or more processors 114 and memory 116 for storing programs and applications. </p><p id="p0026" num="0026"> Memory 116 includes an overlay generator 113. Overlay generator 113 may include a shape deformation module 115 configured to interpret feedback signals from device 104 
<!-- EPO <DP n="9"/>-->
 and determine a new shape for an organ or vasculature 102 affected by the device 104 during a procedure. The shape deformation module 115 accepts as input a set of parameters describing how an image space is deformed, and produces as output a deformed 3D anatomical image of the vasculature 102. Overlay generator 113 also includes or receives input from a shape determination module 117 for determining a 3D shape of the </p><p id="p0027" num="0027">interventional device(s) 104 and a position(s) of the device 104 in image space. The module 117 may also measure or track other parameters such as pressure, strain, shear, or </p><p id="p0028" num="0028">proximity/contact sensors 121 on the device 104 to provide additional feedback </p><p id="p0029" num="0029">measurements. </p><p id="p0030" num="0030"> Modules 115 and 117 work together to provide updated 3D overlay images which are consistent with a shape and position of the device 104 as it is moved into or through a vasculature. There is a data connection between modules 115 and 117 that permits an estimate of the 3D shape(s) of the interventional device(s) 104 to be used to determine the set of parameters provided as input to the shape deformation module 115. The parameters are chosen so that the vascular structures in a deformed 3D anatomical image 103 are consistent with the estimated shape of the interventional device 104. </p><p id="p0031" num="0031"> A database 123 is stored in memory or is accessible over a network and includes historic data, models, and/or finite element representations of organs and their deformation response to particular instruments for particular procedures. The database 123 may be employed by either or both modules 115 and 117 to update the 3D images for a dynamic overlay. </p><p id="p0032" num="0032"> In one embodiment, pressure or other sensors 121 may be mounted on the device 104 so that pressure or other measurements can be taken and recorded. Other instrumentality 108 such as, e.g., optical fiber sensing (Fiber Bragg gratings (FBG), Rayleigh scattering optical fiber, etc.), EM tracking or other device localization / configuration determining capability 
<!-- EPO <DP n="10"/>-->
 may be employed to further determine a position and shape of the device 104. Since the position and shape of the device 104 is known, the pressure measurements, etc. provide additional information about the device 104 interacting with the vasculature 102. A determination of tissue that is displaced as a result of the device 104 may be computed by shape deformation module 115. Shape deformation module 115 is configured to use any other feedback from device 104 to reconstruct 3D deformations, deflections and other changes associated with a medical device or instrument 104 and/or its surrounding region. Device tracking 125 is employed to estimate non-rigid body morphing of a 3D image (from pre-procedural imaging or intra-procedural 3D treatment, ultrasound, etc.). The morphing is computed such that the morphed 3D image 103 more accurately reflects a real-time vascular anatomy. </p><p id="p0033" num="0033"> Workstation 112 may include a display 118 for viewing internal images of a subject 130. In addition to the fluoroscopy or other real-time imaging platform 105, an imaging system 110 may optionally be provided. Imaging system 110 may include a magnetic resonance imaging (MRI) system, a computed tomography (CT) system, an ultrasound system, a nuclear imaging system or any other system configured to generate 3D images of the subject 130. The system 100 may or may not include such an imaging system 110 as images may be taken a priori and sent to the workstation 112 over a network or transferred to the workstation via a memory storage device. </p><p id="p0034" num="0034"> Display or displays 118 may be employed to render fluoroscopy or other real-time images and 3D overlays (from images previously taken of the subject 130). The 3D overlay images include the vasculature through which the interventional device(s) 104 is/are guided. Display 118 also permits a user to interact with the workstation 112 and its components and functions, or any other element within the system 100. This is further facilitated by an interface 120 which may include a keyboard, mouse, a joystick, a haptic device, or any other 
<!-- EPO <DP n="11"/>-->
 peripheral or control to permit user feedback from and interaction with the workstation 112.</p><p id="p0035" num="0035">System 100 may include a 3D tracking technology 125, such as EM tracking, optical shape sensing or a similar 3D position or orientation sensing system which may be integrated with the workstation 112 or be a separate system. An EM tracking system 125 includes an EM sensing module used to interpret EM signals generated by the medical device 104 during a procedure. The medical device 104 may include one or more EM tracking sensors, which may be mounted on the device 104. The medical device 104 may also include a fiber optic shape sensing device (125) which provides optical readings that are reconstructed into information about device location, orientation, and shape. </p><p id="p0036" num="0036"> Workstation 112 may include an optical interrogation unit or module (125), which is employed to transmit light and detect light returning from all fibers if optical fiber sensing is employed. This permits the determination of strains or other parameters, which will be used to interpret the shape, orientation, or other characteristics, sensed by the interventional device 104. The light signals will be employed as feedback to understand the device 104 to tissue interaction in the subject 130. The shape determination module 117 and the shape deformation module 115 are employed to compute a new overlay image that accounts for deformations due to device - tissue interactions. This improves the accuracy of the overlay 103 making the image closer to an actual organ shape during a procedure. </p><p id="p0037" num="0037"> Referring to FIG. 2, a block/flow diagram is shown for updating a three-dimensional overlay in accordance with tissue morphing as a result of a medical device for one illustrative embodiment. In block 202, 3D vessel imaging and segmentation of vessels of interest is performed. Image acquisition and segmentation of vessels from such images may be performed using known techniques. In block 204, a 3D shape of the interventional device is determined, for example, by EM localization of one or more points along the interventional device, optical shape sensing (using optical interrogation of fiber strains and 3D 
<!-- EPO <DP n="12"/>-->
 reconstruction of strain fields to track the continuous device shape in three dimensions) or x- ray-based 3D device shape sensing (e.g., using 3D markers at intervals along the device). The registration of 3D images to tracking technologies may employ known techniques. In block 206, a clinician guides an interventional device into or through a vessel of interest. </p><p id="p0038" num="0038"> In block 208, the 3D shape of the device is tracked while guiding the device along a vasculature. The 3D shape of the interventional device determined using the tracking technology should lie within the vessel boundaries displayed in the 3D vessel image. This is checked in block 210. </p><p id="p0039" num="0039"> In block 209, in one embodiment, the shapes of multiple interventional devices may be tracked and a parameterization method in block 212 would involve determining the anatomy with a 3D vessel shape that optimally encompasses the shape of all the 3D devices, based on both the available measurements and the accumulated prior knowledge available about the procedure and device(s) of interest. </p><p id="p0040" num="0040"> In block 210, the device should be physically contained by walls of the vessel. </p><p id="p0041" num="0041">Therefore, if the 3D vessel image is a true representation of the real-time patient anatomy, the device tracking technology and 3D imaging space are accurately co -registered, and the device remains within the vasculature. </p><p id="p0042" num="0042"> If this is not the case, this could be due to patient or table movement. This causes a translation of the 3D image and device tracking space, which needs to be accounted for. Another misregistration may be due to respiratory or cardiac movement. This may cause a cyclical movement of vessels that are within the patient's thorax or proximal to the diaphragm. There are many vessels whose morphologies are not affected by the respiratory or cardiac cycles (e.g. abdominal aorta, limb arteries, neuro vessels etc.). These cases may be accounted for in rigid body movement and/or cyclic compensation algorithms. </p><p id="p0043" num="0043"> Another misregistration may be from the device causing vessel deformation. Non- 
<!-- EPO <DP n="13"/>-->
 rigid-body warping of the 3D image is needed to update the 3D image so that it better reflects the real-time anatomy of the patient in accordance with the present principles. </p><p id="p0044" num="0044"> In block 212, the non-rigid-body deformation of the 3D image is parameterized so that it more accurately reflects the patient's real-time anatomy. This may be achieved in multiple ways. </p><p id="p0045" num="0045"> In block 214, one example of non-rigid-body warping is to assume that the 3D anatomy enclosing the vessel has deformed so that the vessel can continue to enclose the tracked 3D shape of the interventional device, and that the vessel diameter/length remains constant. The parameterization method then involves determining the anatomy with a 3D vessel shape that encompasses the 3D device shape. After the 3D image is deformed, it is reregistered with the device by returning to block 208, if needed. </p><p id="p0046" num="0046"> More advanced examples may permit for the deformation of both the 3D anatomy enclosing the vessel and the vessel diameter/length. In these examples, it would be useful to include vessel characteristics such as longitudinal and radial vessel elasticities and an estimate of vessel deformability in that anatomical area (which is affected, for example, by the degree of vessel calcification - seen on CT and fluoroscopy - and the number of spinal arteries). Characteristics of the 3D image would therefore be useful to determine what types of deformations should be applied. </p><p id="p0047" num="0047"> In block 222, in one embodiment, optimal parameters utilized for deformation of the 3D image may optionally be determined by taking into account parameters obtained at previous time points. With assumptions about continuity of the anatomical deformations in time, the space of parameters that is considered could be significantly constrained, which could in turn lead to faster processing times and/or predictable deformations. Parameter optimization may rely on other data as well. </p><p id="p0048" num="0048"> For example, in block 218, one embodiment provides pressure or other parametric 
<!-- EPO <DP n="14"/>-->
 sensing along the interventional device (either at distinct points or continuously along a segment as could be provided by FBGs, for example). This provides new information on which points/segments of the interventional device are in contact with the vessel wall and which points/segments are floating freely within the lumen of the vessel. This also provides valuable information on the true vessel shape that can be employed to improve the non-rigid- body parameterization process. </p><p id="p0049" num="0049"> In block 216, the fluoroscopic or real-time image is overlaid with the deformed 3D image. </p><p id="p0050" num="0050"> In block 220, in one embodiment, a user/clinician is provided with a capability of switching back and forth between the warped 3D image and a non-warped 3D image via an interface (120, FIG. 1). By comparing the two images, the clinician can assess how much pressure is being applied to the vessel walls (and whether this pressure could be dangerous and lead to potential vessel rupture). Elastographic measurements could also be obtained automatically by analyzing the deformations obtained for the 3D images. </p><p id="p0051" num="0051"> The process is updated throughout a procedure. This provides an updated and accurate overlay during the procedure. </p><p id="p0052" num="0052"> Referring to FIG. 3, another embodiment employs statistical or historic data to deform vessel images in accordance with the present principles. In block 302, a derivation of an anatomically-realistic deformable model is created with a minimal set of control points or parametric descriptions. A sparse set of tracked landmarks (localized in 3D by EM, impedance, acoustic, optical sensing, etc.) is available from the device and delivery assembly (e.g., a catheter or sheath) for adapting the rigid-body pose and deformation of the model. In block 304, one way of building this model includes gathering a library of imaging data acquired during an intervention (e.g., historic or statistical data). The data shows dynamic behavior of the anatomy as the instrumentation is moved within it. 
<!-- EPO <DP n="15"/>-->
 In block 306, segmentation of the data can be performed to extract 3D surfaces evolving over time, and deformation models of the surface shape change as a function of perturbation are generated. In particular, a principal component analysis (or similar analytical methods for decomposition of shapes into component modes) may be employed to determine eigenmodes of shape deformation and associated eigenvalues which reflect the relative importance of each shape eigenvector. In block 308, a subset of eigenmodes associated with the largest eigenvalues can be selected to minimize the parameter space associated with shape deformation, while ensuring that the dominant deformation behaviors are still captured within the parametric model. Adaptation of the library-derived models to a particular patient anatomy (from 3D preprocedural data segmentation) and particular set of tracked feature points on the device can then occur by estimating the eigenmode </p><p id="p0053" num="0053">coefficients/weighting values which minimize a distance metric computed between the model and observed measurements. </p><p id="p0054" num="0054"> In block 310, the eigenmodes are updated as needed during the procedure to ensure that the model follows closely the deflection of the tissue as a result of the medical instrument. In this way, a more clinically meaningful display of tissue response may be projected in an overlay image, in particular, during a fluoroscopically tracked procedure. Other information about deformation functions of the anatomy of interest may be derived from vector velocity fields of pre-procedural phase-contrast MR imaging or tissue speckle tracking with ultrasound imaging. These other sources of measurement information can augment the prior knowledge available from libraries of segmented 3D surface models. </p><p id="p0055" num="0055"> In addition to or instead of computing eigenmodes, a library of imaging data from actual studies may be substituted by a library of deformations that can be derived from finite element simulations of the anatomy deforming under instrument manipulation, in block 312. A host of potential libraries and training datasets for computing appropriate models for a 
<!-- EPO <DP n="16"/>-->
 range of different clinical interventions and instrumentation can be generated to broaden the scope of applicability. </p><p id="p0056" num="0056"> Referring to FIG. 4, a medical procedure is illustratively shown in accordance with another embodiment. In block 402, images of an interventional procedure are generated. These images are preferably real-time images generated using fluoroscopic imaging. In block 406, an overlay image is generated on the images of the interventional procedure. The overlay images preferably include three-dimensional anatomical images of a subject taken by, e.g., computed tomography, magnetic resonance imaging or other imaging methods. </p><p id="p0057" num="0057"> In block 410, a position, orientation and shape of the interventional device (in 3D) are tracked during the procedure. The tracking may include using one or more of </p><p id="p0058" num="0058">electromagnetic tracking, optical sensing, fluoroscopy marker tracking, etc. </p><p id="p0059" num="0059"> In block 414, the overlay image is dynamically updated in response to 3D </p><p id="p0060" num="0060">deformations caused to an organ of interest by the interventional device during the procedure. Updating the overlay image preferably includes interpreting feedback signals from the interventional device and determining a new shape for the organ affected by the </p><p id="p0061" num="0061">interventional device in block 416. In block 418, the interventional device may include pressure sensors or other sensors, and measurements (e.g., pressures) may be employed to determine a deformation response of the organ. </p><p id="p0062" num="0062"> In block 420, models of deformation responses of the organ may be stored and employed to update the overlay image of the organ. The models may generated by computing eigenmodes of tissue response, generated in accordance with finite element simulations or employ historic or statistical data to reproduce or predict organ movement. In block 422, a capability is provided to enable switching between the overlay image and an updated overlay image during the interventional procedure. In this way, the updated overlay can be compared with a previous or original overlay image. 
<!-- EPO <DP n="17"/>-->
 In interpreting the appended claims, it should be understood that: </p><p id="p0063" num="0063"> a) the word "comprising" does not exclude the presence of other elements or acts than those listed in a given claim; </p><p id="p0064" num="0064"> b) the word "a" or "an" preceding an element does not exclude the presence of a plurality of such elements; </p><p id="p0065" num="0065"> c) any reference signs in the claims do not limit their scope; </p><p id="p0066" num="0066"> d) several "means" may be represented by the same item or hardware or software implemented structure or function; and </p><p id="p0067" num="0067"> e) no specific sequence of acts is intended to be required unless specifically indicated. </p><p id="p0068" num="0068"> Having described preferred embodiments for systems and methods for non-rigid-body morphing of vessel image using intravascular device shape (which are intended to be illustrative and not limiting), it is noted that modifications and variations can be made by persons skilled in the art in light of the above teachings. It is therefore to be understood that changes may be made in the particular embodiments of the disclosure disclosed which are within the scope of the embodiments disclosed herein as outlined by the appended claims. Having thus described the details and particularity required by the patent laws, what is claimed and desired protected by Letters Patent is set forth in the appended claims. 
</p></description><claims mxw-id="PCLM44726858" ref-ucid="WO-2012114224-A1" lang="EN" load-source="patent-office"><claim-statement><!-- EPO <DP n="18"/>-->CLAIMS: </claim-statement><claim id="clm-0001" num="1"><claim-text> 1. A medical system, comprising: </claim-text><claim-text> a medical imaging system (105) configured to generate images of an interventional procedure; </claim-text><claim-text> an overlay generator (113) configured to generate an overlay image on the images of the interventional procedure; and </claim-text><claim-text> an interventional device tracking system (108, 125) configured to dynamically track a three dimensional (3D) position, orientation and shape of an interventional device (104) during the procedure; </claim-text><claim-text> wherein the overlay image is dynamically updated in response to deformations caused to an organ of interest by the interventional device during the procedure. </claim-text></claim><claim id="clm-0002" num="2"><claim-text>2. The medical system as recited in claim 1, wherein the overlay generator (113) includes a shape deformation module (115) configured to interpret feedback signals from the interventional device and determine a new shape for the organ affected by the interventional device. </claim-text></claim><claim id="clm-0003" num="3"><claim-text>3. The medical system as recited in claim 1, wherein the overlay generator (113) includes a shape determination module (117) for determining the position, the orientation and shape of the interventional device in image space. </claim-text></claim><claim id="clm-0004" num="4"><claim-text>4. The medical system as recited in claim 1, wherein the interventional device (104) includes at least one of pressure, strain, shear, or proximity/contact sensors and sensor measurements are employed to determine a deformation response of the organ. <!-- EPO <DP n="19"/>--> </claim-text></claim><claim id="clm-0005" num="5"><claim-text>5. The medical system as recited in claim 1, further comprising a database (123) configured to store models of deformation responses of the organ which are employed by the overlay module to update the overlay image of the organ. </claim-text></claim><claim id="clm-0006" num="6"><claim-text>6. The medical system as recited in claim 5, wherein the database (123) stores at least one of eigenmodes of tissue response and finite element simulations. </claim-text></claim><claim id="clm-0007" num="7"><claim-text>7. The medical system as recited in claim 1, wherein the medical imaging system (105) includes a fluoroscopy system and the images of the interventional procedure are generated without contrast dyes. </claim-text></claim><claim id="clm-0008" num="8"><claim-text>8. The medical system as recited in claim 1, wherein the interventional device tracking system (125) includes at least one of electromagnetic tracking, optical sensing, or fluoroscopy marker tracking. </claim-text></claim><claim id="clm-0009" num="9"><claim-text>9. The medical system as recited in claim 1, wherein the overlay images (103) include three-dimensional anatomical images of a subject taken by at least one of computed tomography, magnetic resonance imaging, ultrasound or nuclear imaging. </claim-text></claim><claim id="clm-0010" num="10"><claim-text>10. A method for a medical procedure, comprising </claim-text><claim-text> generating (402) images of an interventional procedure; </claim-text><claim-text> generating (406) an overlay image on the images of the interventional procedure; tracking (410) a position, orientation and shape of the interventional device during the procedure; </claim-text><claim-text> dynamically updating (414) the overlay image in response to deformations caused to <!-- EPO <DP n="20"/>--> an organ of interest by the interventional device during the procedure. </claim-text></claim><claim id="clm-0011" num="11"><claim-text>11. The method as recited in claim 10, wherein updating (414) the overlay image includes interpreting (416) feedback signals from the interventional device and determining a new shape for the organ affected by the interventional device. </claim-text></claim><claim id="clm-0012" num="12"><claim-text>12. The method as recited in claim 10, wherein the interventional device includes at least one of pressure, strain, shear, or proximity/contact sensors and sensor measurements are employed (418) to determine a deformation response of the organ. </claim-text></claim><claim id="clm-0013" num="13"><claim-text>13. The method as recited in claim 10, further comprising storing (420) models of deformation responses of the organ which are employed to update the overlay image of the organ. </claim-text></claim><claim id="clm-0014" num="14"><claim-text>14. The method as recited in claim 13, wherein the models are generated by computing eigenmodes of tissue response. </claim-text></claim><claim id="clm-0015" num="15"><claim-text>15. The method as recited in claim 13, wherein the models are generated in accordance with finite element simulations. </claim-text></claim><claim id="clm-0016" num="16"><claim-text>16. The method as recited in claim 10, further comprising switching (422) between the overlay image and an updated overlay image during the interventional procedure. </claim-text></claim><claim id="clm-0017" num="17"><claim-text>17. The method as recited in claim 10, wherein tracking (416) includes tracking <!-- EPO <DP n="21"/>--> the interventional device using at least one of electromagnetic tracking, optical sensing, or fluoroscopy marker tracking. </claim-text></claim><claim id="clm-0018" num="18"><claim-text>18. The method as recited in claim 10, wherein the overlay images include three- dimensional anatomical images of a subject taken by at least one of computed tomography, magnetic resonance imaging, ultrasound or nuclear imaging. </claim-text></claim><claim id="clm-0019" num="19"><claim-text>19. A method for a medical procedure, comprising </claim-text><claim-text> generating (202) images of an interventional procedure; </claim-text><claim-text> generating (204) an overlay image on the images of the interventional procedure; tracking (208) a position, orientation and shape of the interventional device during the procedure; </claim-text><claim-text> checking (210) whether the interventional device remains within a boundary of the overlay image; </claim-text><claim-text> if the interventional device is not fully enclosed in the boundary, determining (212) a deformation of the organ that will permit the interventional device to remain within the boundary; and </claim-text><claim-text> dynamically updating (214) the overlay image in accordance with the deformation. </claim-text></claim><claim id="clm-0020" num="20"><claim-text>20. The method as recited in claim 19, wherein updating (214) the overlay image includes interpreting feedback signals from the interventional device and determining a new shape for the organ affected by the interventional device. </claim-text></claim><claim id="clm-0021" num="21"><claim-text>21. The method as recited in claim 19, wherein the interventional device includes sensors and the method further comprises employing (218) sensor measurements to <!-- EPO <DP n="22"/>--> determine a deformation response of the organ. </claim-text></claim><claim id="clm-0022" num="22"><claim-text>22. The method as recited in claim 19, further comprising storing models (302) of deformation responses of the organ which are employed to update the overlay image of the organ. </claim-text></claim><claim id="clm-0023" num="23"><claim-text>23. The method as recited in claim 22, wherein the models are generated by at least one of computed eigenmodes (308) of tissue response or finite element simulations (312). </claim-text></claim><claim id="clm-0024" num="24"><claim-text>24. The method as recited in claim 19, further comprising switching (220) between the overlay image and an updated overlay image during the interventional procedure. </claim-text></claim></claims><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
