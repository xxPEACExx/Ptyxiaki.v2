<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2680018-A1" country="EP" doc-number="2680018" kind="A1" date="20140101" family-id="43547714" file-reference-id="264179" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146549551" ucid="EP-2680018-A1"><document-id><country>EP</country><doc-number>2680018</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-10857736-A" is-representative="YES"><document-id mxw-id="PAPP154823474" load-source="docdb" format="epo"><country>EP</country><doc-number>10857736</doc-number><kind>A</kind><date>20101201</date><lang>ZH</lang></document-id><document-id mxw-id="PAPP219226706" load-source="docdb" format="original"><country>EP</country><doc-number>10857736.2</doc-number><date>20101201</date><lang>ZH</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140449540" ucid="CN-2010079309-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>CN</country><doc-number>2010079309</doc-number><kind>W</kind><date>20101201</date></document-id></priority-claim><priority-claim mxw-id="PPC140451013" ucid="CN-201010515086-A" load-source="docdb"><document-id format="epo"><country>CN</country><doc-number>201010515086</doc-number><kind>A</kind><date>20100930</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-1861388807" load-source="ipcr">G01R  27/26        20060101ALI20161221BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1861392279" load-source="ipcr">G06F   3/041       20060101ALI20161221BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1861392748" load-source="ipcr">H03M  11/00        20060101ALI20161221BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1861393213" load-source="ipcr">H03K   5/1254      20060101ALI20161221BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1861393265" load-source="ipcr">H03K  17/96        20060101ALI20161221BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1861394554" load-source="ipcr">G01R  31/327       20060101AFI20161221BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1861388789" load-source="docdb" scheme="CPC">G06F   3/023       20130101 LI20170106BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1865074575" load-source="docdb" scheme="CPC">H03K2217/960705    20130101 LA20161219BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1865074576" load-source="docdb" scheme="CPC">H03K  17/9622      20130101 LI20161219BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1871707381" load-source="docdb" scheme="CPC">G06F   3/0416      20130101 LI20161209BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988120583" load-source="docdb" scheme="CPC">H03M  11/003       20130101 FI20130308BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132181137" lang="DE" load-source="patent-office">VERFAHREN UND VORRICHTUNG ZUR ERKENNUNG EINES SCHLÜSSELS</invention-title><invention-title mxw-id="PT132181138" lang="EN" load-source="patent-office">METHOD AND APPARATUS FOR DETECTING KEY</invention-title><invention-title mxw-id="PT132181139" lang="FR" load-source="patent-office">PROCÉDÉ ET APPAREIL DE DÉTECTION D'UNE CLÉ</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR918164294" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>JIANGSU HUITONG GROUP CO LTD</last-name><address><country>CN</country></address></addressbook></applicant><applicant mxw-id="PPAR918132911" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>JIANGSU HUITONG GROUP CO. LTD.</last-name></addressbook></applicant><applicant mxw-id="PPAR918993501" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Jiangsu Huitong Group Co. Ltd.</last-name><iid>101307923</iid><address><street>No.24, Block 2 Taohuawu New District</street><city>Zhenjiang, Jiangsu 212003</city><country>CN</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918173364" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>LONG TAO</last-name><address><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR918133636" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>LONG, TAO</last-name></addressbook></inventor><inventor mxw-id="PPAR918984680" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>LONG, TAO</last-name><address><street>No. 24 Block 2 Taohuawu New District Zhenjiang</street><city>Jiangsu 212003</city><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR918133726" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>LIU ZHENGDONG</last-name><address><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR918145341" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>LIU, ZHENGDONG</last-name></addressbook></inventor><inventor mxw-id="PPAR918984622" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>LIU, ZHENGDONG</last-name><address><street>No. 24 Block 2 Taohuawu New District Zhenjiang</street><city>Jiangsu 212003</city><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR918149443" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>LONG JIANG</last-name><address><country>CN</country></address></addressbook></inventor><inventor mxw-id="PPAR918166097" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>LONG, JIANG</last-name></addressbook></inventor><inventor mxw-id="PPAR918981497" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>LONG, JIANG</last-name><address><street>No. 24 Block 2 Taohuawu New District Zhenjiang</street><city>Jiangsu 212003</city><country>CN</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918988701" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Detken, Andreas</last-name><iid>100823474</iid><address><street>Isler &amp; Pedrazzini AG Gotthardstrasse 53 Postfach 1772</street><city>8027 Zürich</city><country>CH</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="CN-2010079309-W"><document-id><country>CN</country><doc-number>2010079309</doc-number><kind>W</kind><date>20101201</date><lang>ZH</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012040973-A1"><document-id><country>WO</country><doc-number>2012040973</doc-number><kind>A1</kind><date>20120405</date><lang>ZH</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS548843857" load-source="docdb">AL</country><country mxw-id="DS548806919" load-source="docdb">AT</country><country mxw-id="DS548843862" load-source="docdb">BE</country><country mxw-id="DS548871844" load-source="docdb">BG</country><country mxw-id="DS548874956" load-source="docdb">CH</country><country mxw-id="DS548869134" load-source="docdb">CY</country><country mxw-id="DS548869135" load-source="docdb">CZ</country><country mxw-id="DS548805584" load-source="docdb">DE</country><country mxw-id="DS548843863" load-source="docdb">DK</country><country mxw-id="DS548843864" load-source="docdb">EE</country><country mxw-id="DS548897561" load-source="docdb">ES</country><country mxw-id="DS548871845" load-source="docdb">FI</country><country mxw-id="DS548871846" load-source="docdb">FR</country><country mxw-id="DS548805585" load-source="docdb">GB</country><country mxw-id="DS548843865" load-source="docdb">GR</country><country mxw-id="DS548805586" load-source="docdb">HR</country><country mxw-id="DS548869136" load-source="docdb">HU</country><country mxw-id="DS548874957" load-source="docdb">IE</country><country mxw-id="DS548843870" load-source="docdb">IS</country><country mxw-id="DS548871847" load-source="docdb">IT</country><country mxw-id="DS548843871" load-source="docdb">LI</country><country mxw-id="DS548805587" load-source="docdb">LT</country><country mxw-id="DS548806920" load-source="docdb">LU</country><country mxw-id="DS548871848" load-source="docdb">LV</country><country mxw-id="DS548805588" load-source="docdb">MC</country><country mxw-id="DS548806921" load-source="docdb">MK</country><country mxw-id="DS548807118" load-source="docdb">MT</country><country mxw-id="DS548807119" load-source="docdb">NL</country><country mxw-id="DS548874958" load-source="docdb">NO</country><country mxw-id="DS548807120" load-source="docdb">PL</country><country mxw-id="DS548897566" load-source="docdb">PT</country><country mxw-id="DS548889065" load-source="docdb">RO</country><country mxw-id="DS548897567" load-source="docdb">RS</country><country mxw-id="DS548807121" load-source="docdb">SE</country><country mxw-id="DS548805589" load-source="docdb">SI</country><country mxw-id="DS548874959" load-source="docdb">SK</country><country mxw-id="DS548874960" load-source="docdb">SM</country><country mxw-id="DS548843872" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128670220" lang="EN" load-source="patent-office"><p id="pa01" num="0001">A method and an apparatus for detecting a key are provided. The method comprises: detecting the key to obtain a key signal (S11); sampling the key signal with a variable frequency; and outputting a control signal when the number of times of sampling the key effective signal in a pre-set time range reaches or exceeds a pre-set number (S12), wherein sampling with the variable frequency means that the sampling frequency is gradually increases from a first frequency to a second frequency, then gradually reduced from the second frequency to the first frequency, and the gradual increasing and reducing processes are repeated, moreover, the sampling frequency stays for a pre-set time in each frequency. The method and the apparatus for detecting the key reduce the probability of key detection being interfered by external signals.<img id="iaf01" file="imgaf001.tif" wi="103" he="74" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128499593" lang="EN" source="EPO" load-source="docdb"><p>A method and an apparatus for detecting a key are provided. The method comprises: detecting the key to obtain a key signal (S11); sampling the key signal with a variable frequency; and outputting a control signal when the number of times of sampling the key effective signal in a pre-set time range reaches or exceeds a pre-set number (S12), wherein sampling with the variable frequency means that the sampling frequency is gradually increases from a first frequency to a second frequency, then gradually reduced from the second frequency to the first frequency, and the gradual increasing and reducing processes are repeated, moreover, the sampling frequency stays for a pre-set time in each frequency. The method and the apparatus for detecting the key reduce the probability of key detection being interfered by external signals.</p></abstract><description mxw-id="PDES63955650" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001">CROSS REFERENCE TO RELATED APPLICATIONS</heading><p id="p0001" num="0001">The present application claims priority to Chinese patent application No. <patcit id="pcit0001" dnum="CN201010515086"><text>201010515086.3, filed on September 30, 2010</text></patcit>, and entitled "METHOD AND APPARATUS FOR DETECTING KEY", and the entire disclosure of which is incorporated herein by reference.</p><heading id="h0002">FIELD OF THE DISCLOSURE</heading><p id="p0002" num="0002">The present disclosure generally relates to electronic technology, and more particularly, to a key detection method and apparatus.</p><heading id="h0003">BACKGROUND</heading><p id="p0003" num="0003">At present, a variety of keys have been widely used in electronic products. The successful key detection rate may have a direct effect on electronic products. Key detection generally includes detecting an operation on a key and determining whether the key is pressed.</p><p id="p0004" num="0004">The existing key detection methods mainly include following steps: detecting a key to obtain a key signal; sampling the key signal with a fixed frequency; and outputting a control signal when the sampling times for an effective key signal in a predetermined time span reach or exceed a predetermined value.</p><p id="p0005" num="0005">In the existing methods, a false key triggering rate and a miss key detection rate increases and a successful key detection rate decreases if there is any interference of environment, such as noise from mobile phones or other electric appliances.</p><heading id="h0004">SUMMARY</heading><p id="p0006" num="0006">The present disclosure provides a key detection method to increase the successful key detection rate.</p><p id="p0007" num="0007">The key detection method may include following steps: detecting a key to<!-- EPO <DP n="2"> --> obtain a key signal; sampling the key signal at varying frequencies; and outputting a control signal when the sampling times for an effective key signal in a predetermined time span reach or exceed a predetermined value, where the sampling frequency varies from a first frequency increasing to a second frequency and then from the second frequency decreasing to the first frequency, the increasing and decreasing sampling processes are performed repeatedly, and the sampling may stay in each frequency point for a predetermined time.</p><p id="p0008" num="0008">Optionally, the sampling is performed in 1 unit of frequency increasingly or decreasingly.</p><p id="p0009" num="0009">Optionally, the key may be a capacitive touch-key.</p><p id="p0010" num="0010">Optionally, the key may be an air key or a contact key.</p><p id="p0011" num="0011">Optionally, detecting the key to obtain the key signal may include: detecting a charge change amount in a capacitance in the key; and obtaining the key signal, where the key signal may be a digital signal corresponding to the charge change amount in the capacitance.</p><p id="p0012" num="0012">Optionally, sampling an effective key signal may include: sampling a key signal; and determining a sampled key signal to be an effective one when numerical value of the sampled key signal is greater than a threshold of the charge change amount.</p><p id="p0013" num="0013">Optionally, the predetermined time span may be 3ms, the predetermined value may be 80, the first frequency may be 80KHz, the second frequency may be 120KHz, the predetermined time may be 5µs, and the 1 unit of frequency may be 1KHz.</p><p id="p0014" num="0014">Optionally, the key detection method further includes: receiving external signals; and when the frequency of an external signal is between the first frequency and the second frequency, generating a trigger signal which is used to trigger the key detection process.<!-- EPO <DP n="3"> --></p><p id="p0015" num="0015">Optionally, receiving external signals may include: receiving external signals at hopping frequencies, where receiving at hopping frequencies includes receiving external signals whose frequencies are equal to hopping frequency points, the hopping frequency increases from a third frequency to a fourth frequency, then decreases from the fourth frequency to the third frequency, and so the cycle to repeat, the frequency points in the increasing process are different from those in the decreasing process, and the third frequency is less than the first frequency and the fourth frequency is greater than the second frequency.</p><p id="p0016" num="0016">Optionally, the hopping frequency increases or decreases in 2 units of frequency.</p><p id="p0017" num="0017">Optionally, the frequency range from the third frequency to the fourth frequency may include three continuous frequency bands, namely, a first frequency band, a second frequency band and a third frequency band. The second frequency band may include a frequency band from the first frequency to the second frequency. Time stayed in each frequency point within the first frequency band or the third frequency band is less than that in each frequency point within the second frequency band.</p><p id="p0018" num="0018">Optionally, the third frequency may be 20KHz and the fourth frequency may be 500KHz.</p><p id="p0019" num="0019">Optionally, the frequency range from the third frequency to the fourth frequency may include three continuous frequency bands, namely, a first frequency band, a second frequency band and a third frequency band. The first frequency band is from 20KHz to 80KHz, the second frequency band is from 80KHz to 300KHz, and the third frequency band is from 300KHz to 500KHz. Time stayed in each frequency point within the first frequency band or in the third frequency band is 0.1ms and time stayed in each frequency point within the second frequency band is 0.2ms.</p><p id="p0020" num="0020">Optionally, the hopping frequency increasing from the third frequency to the fourth frequency may include: the hopping frequency increasing from 20KHz to<!-- EPO <DP n="4"> --> 21KHz, then increasing from 21KHz to 499KHz in 2KHz and increasing from 499KHz to 500KHz. The hopping frequency decreasing from the fourth frequency to the third frequency may include: the hopping frequency decreasing from 500KHz to 20KHz in 2KHz.</p><p id="p0021" num="0021">The present disclosure further provides a key detection apparatus, including: a key detecting unit configured to detect a key to obtain a key signal; and an effective signal detecting unit to sample the key signal at varying frequencies and output a control signal when the sampling times for an effective key signal in a predetermined time span reach or exceed a predetermined value, where the sampling frequency varies from a first frequency increasing to a second frequency, then from the second frequency decreasing to the first frequency, the increasing and decreasing sampling processes are repeated, and the sampling may stay in each frequency point for a predetermined time.</p><p id="p0022" num="0022">Optionally, the sampling is performed in 1 unit of frequency increasingly or decreasingly.</p><p id="p0023" num="0023">Optionally, the key may be a capacitive touch-key.</p><p id="p0024" num="0024">Optionally, the key may be an air key or a contact key.</p><p id="p0025" num="0025">Optionally, the key detecting unit may include a capacitance detecting unit configured to detect a charge change amount in a capacitance in the key to obtain the key signal, where the key signal may be a digital signal corresponding to the charge change amount in the capacitance.</p><p id="p0026" num="0026">Optionally, a key signal being an effective key signal means numerical value of the key signal is greater than a threshold of charge change amount.</p><p id="p0027" num="0027">Optionally, the predetermined time span may be 3ms, the predetermined value may be 80, the first frequency may be 80KHz, the second frequency may be 120KHz, the predetermined time may be 5µs, and the 1 unit of frequency may be 1KHz.<!-- EPO <DP n="5"> --></p><p id="p0028" num="0028">Optionally, the key detection apparatus further includes: a receiving unit configured to receive external signals; and an external signal detecting unit configured to generate a trigger signal which is used to trigger the key detection process when the frequency of an external signal is between the first frequency and the second frequency. After receiving the trigger signal, the key detecting unit may detect a key to obtain a key signal.</p><p id="p0029" num="0029">Optionally, the receiving unit may include: an antenna configured to receive external environment signals; and a frequency hopping receiving unit configured to receiving external signals at hopping frequencies. Receiving at hopping frequencies includes receiving external signals whose frequencies are equal to hopping frequency points, the hopping frequency increases from a third frequency to a fourth frequency, then decreases from the fourth frequency to the third frequency, and so the cycle to repeat, the frequency points in the increasing process are different from those in the decreasing process, and the third frequency is less than the first frequency and the fourth frequency is greater than the second frequency.</p><p id="p0030" num="0030">Optionally, the hopping frequency increases or decreases in 2 units of frequency.</p><p id="p0031" num="0031">Optionally, the frequency range from the third frequency to the fourth frequency may include three continuous frequency bands, namely, a first frequency band, a second frequency band and a third frequency band. The second frequency band may include a frequency band from the first frequency to the second frequency. Time stayed in each frequency point within the first frequency band or the third frequency band is less than that in each frequency point within the second frequency band.</p><p id="p0032" num="0032">Optionally, the third frequency may be 20KHz and the fourth frequency may be 500KHz.</p><p id="p0033" num="0033">Optionally, the frequency range from the third frequency to the fourth frequency may include three continuous frequency bands, namely, a first frequency<!-- EPO <DP n="6"> --> band, a second frequency band and a third frequency band. The first frequency band is from 20KHz to 80KHz, the second frequency band is from 80KHz to 300KHz, and the third frequency band is from 300KHz to 500KHz. Time stayed in each frequency point within the first frequency band or in the third frequency band is 0.1ms and time stayed in each frequency point within the second frequency band is 0.2ms.</p><p id="p0034" num="0034">Optionally, the hopping frequency increasing from the third frequency to the fourth frequency may include: the hopping frequency increasing from 20KHz to 21KHz, then increasing from 21KHz to 499KHz in 2KHz and increasing from 499KHz to 500KHz. The hopping frequency decreasing from the fourth frequency to the third frequency may include: the hopping frequency decreasing from 500KHz to 20KHz in 2KHz.</p><p id="p0035" num="0035">In the present disclosure, a key signal is sampled at varying frequencies and its effectiveness is determined. Compared with a fixed sampling frequency in the existing methods, varying sampling frequencies are difficult to be tracked by varying external signals, thereby reducing the probability of sampled signals being interfered by external signals.</p><p id="p0036" num="0036">Further, key detection may be initiated after an external signal with a frequency within a predetermined frequency range is received. External signals are received at hopping frequency points, which means that external signals with one kind of frequency point are received in a particular time span. Embodiments of the present disclosure combine receiving signals at hopping frequency points with sampling signals at varying frequencies, which further decreases the coincidence between sampling frequency and external signals' frequency, and thereby decreases interferences in key detection.</p><p id="p0037" num="0037">Further, external signals are received in a predetermined frequency range (from a first frequency to a second frequency) in forward hopping frequency, backward hopping frequency, and so the cycle to repeat, hopping frequency points in the forward process are different from those in the backward process, and staying time<!-- EPO <DP n="7"> --> at each frequency point lasts for a predetermined time, which improve detection rate, and almost will not miss a key press event.</p><heading id="h0005">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p0038" num="0038"><figref idrefs="f0001">FIG. 1</figref> schematically illustrates a flow chart of a key detection method according to one embodiment of the present disclosure;</p><p id="p0039" num="0039"><figref idrefs="f0002">FIG. 2</figref> schematically illustrates a detailed flow chart of Step S12 shown in <figref idrefs="f0001">FIG. 1</figref>;</p><p id="p0040" num="0040"><figref idrefs="f0003">FIG. 3</figref> schematically illustrates a flow chart of a key detection method according to another embodiment of the present disclosure;</p><p id="p0041" num="0041"><figref idrefs="f0003">FIG. 4</figref> schematically illustrates a structure of a key detection apparatus according to one embodiment of the present disclosure;</p><p id="p0042" num="0042"><figref idrefs="f0004">FIG. 5</figref> schematically illustrates a structure of a key detection apparatus according to another embodiment of the present disclosure;</p><p id="p0043" num="0043"><figref idrefs="f0004">FIG. 6</figref> schematically illustrates a structure of an anti-interference capacitive touch-key detection system according to one embodiment of the present disclosure; and</p><p id="p0044" num="0044"><figref idrefs="f0005">FIG. 7</figref> schematically illustrates a detailed structure of an anti-interference capacitive touch-key detection system according to one embodiment of the present disclosure.</p><heading id="h0006">DETAILED DESCRIPTION OF THE DISCLOSURE</heading><p id="p0045" num="0045">In the existing key detection technologies, a key signal is sampled with a fixed frequency and the sampling frequency is easy to be tracked by varied external environment signals, and the sampled signals are thereby interfered, resulting in missing effective key signals or an interference signal mistaken as an effective key signal. The present disclosure provides a method to sample a key signal with varying frequencies, thereby reducing risk of sampling signals being interfered by external<!-- EPO <DP n="8"> --> signals.</p><p id="p0046" num="0046">In order to clarify the objects, characteristics and advantages of the disclosure, embodiments of present disclosure will be described in detail in conjunction with accompanying drawings. In following embodiments, a key may be a capacitive touch-key, which is not limited thereto. For example, it may be a resistive key or a switching key in other embodiments.</p><p id="p0047" num="0047"><figref idrefs="f0001">FIG. 1</figref> schematically illustrates a flow chart of a key detection method according to one embodiment of the present disclosure, the key detection method including steps of:</p><p id="p0048" num="0048">Step S 11, detecting a key to obtain a key signal; and</p><p id="p0049" num="0049">Step S12, sampling the key signal at varying frequencies and outputting a control signal when the sampling times for an effective key signal in a predetermined time span reach or exceed a predetermined value, where the sampling frequency varies from a first frequency increasing to a second frequency, then from the second frequency decreasing to the first frequency, the sampling staying in each frequency point for a predetermined time, and the increasing sampling and the decreasing sampling processes are repeated.</p><p id="p0050" num="0050">Hereinafter, Step S11 and Step S 12 are described in detail.</p><p id="p0051" num="0051">In Step S11, a key may be detected and a key signal may be obtained. In some embodiments, the key may be a capacitive touch-key, such as an air key or a contact key. Generally, there is a parasitic capacitance to ground in a key. Once a key is pressed, the parasitic capacitance in the key is to be paralleled with a finger capacitance to ground. Therefore, whether a key is pressed can be determined by detecting the capacitance charge or the capacitance value.</p><p id="p0052" num="0052">In some embodiments, Step S11 may include: detecting a charge change amount in a capacitance (e.g. a parasitic capacitance) to obtain a key signal, where the key signal is a digital signal corresponding to the charge change amount in the<!-- EPO <DP n="9"> --> capacitance and used to determine whether a key is pressed in subsequent steps. A digital signal corresponding to the charge change amount in the capacitance means numerical value which the digital signal represents may be the charge change amount in the capacitance or may be proportional to the charge change amount in the capacitance. The technology for detecting charge change amount in a capacitance is known to those skilled in the art and is not described in detail herein.</p><p id="p0053" num="0053">Following Step S11, Step S12 may be performed. In Step S12: sampling the key signal at varying frequencies and outputting a control signal when the sampling times for an effective key signal in a predetermined time span reach or exceed a predetermined value. Namely, whether the sampling times for an effective key signal in a predetermined time span reach or exceed a predetermined value is determined. If so, a control signal is output and the key may be predetermined to be pressed; otherwise, the key signal is determined to be caused by interference of external signals. Sampling at varying frequencies may include sampling from a first frequency increasing to a second frequency, then from the second frequency decreasing to the first frequency, repeating the increasing and decreasing sampling processes, and the sampling stay in each frequency point for a predetermined time.</p><p id="p0054" num="0054">Optionally, sampling an effective key signal may include: sampling a key signal; and determining a sampled key signal to be an effective one when numerical value of the sampled key signal is greater than a threshold of charge change amount.</p><p id="p0055" num="0055">In some embodiments, <figref idrefs="f0002">FIG. 2</figref> schematically illustrates a detailed flow chart of Step S12. Step S12 may include steps of:</p><p id="p0056" num="0056">Step S121, sampling the key signal, namely, sampling a digital signal corresponding to the charge change amount in a capacitance obtained in Step S11, where the sampling frequency increases from a first frequency to a second frequency and then decreases from the second frequency to the first frequency, this increasing and decreasing sampling process is performed repeatedly, and the sampling may stay in each frequency point for a predetermined time.<!-- EPO <DP n="10"> --></p><p id="p0057" num="0057">In some embodiments, the sampling frequency may vary between the first frequency and the second frequency (including the first frequency and the second frequency) in turn. An increment value (an increment value each time of the sampling frequency increasing from the first frequency to the second frequency) and a decrement value (an decrement value each time of the sampling frequency decreasing from the second frequency to the first frequency) of the sampling frequency is 1 unit of frequency, namely, the sampling frequency increases or decreases in an equal difference. Specifically, the sampling frequency increases from the first frequency to the second frequency in 1 unit of frequency (i.e. the unit of the first frequency and the second frequency, for example, if the unit is KHz, the sampling frequency increasing in 1KHz each time) and the sampling may stay in each frequency point for a predetermined time, namely, the sampling frequency increases in 1 unit of frequency every predetermined time; then the sampling frequency decreases from the second frequency to the first frequency in 1 unit of frequency and the sampling may stay in each frequency point for the predetermined time, namely, the sampling frequency decreases in 1 unit of frequency every predetermined time; furthermore, the sampling frequency increases from the first frequency to the second frequency and decreases from the second frequency to the first frequency, and the increasing sampling and the decreasing sampling is repeated.</p><p id="p0058" num="0058">The first frequency and the second frequency may respectively be a lower limit and an upper limit of frequency of signals generated after a key is pressed and they are always determined by an experience value according to practical application. For example, a capacitive touch-key is pressed by a finger. Signals between 80KHz and 120KHz may be generated accordingly. Therefore, the first frequency may be set to be 80KHz and the second frequency may be set to be 120KHz. The 1 unit of frequency may be 1KHz. The predetermined time may depend on a predetermined time span and a predetermined value of times (sometimes being experience value). Namely, according to the predetermined time, effective key signals may be sampled more than the predetermined value of times in the predetermined time span. For<!-- EPO <DP n="11"> --> example, the predetermined time span is 3ms and the predetermined value is 80, then the predetermined time may be 5µs. The sampling frequency may be 80KHz at first, then increases to 81KHz 5µs later, increases to 82KHz after another 5µs, and so on, until the sampling frequency reaches 120KHz, and it takes 200µs to finish this increasing process; then, the sampling frequency decreases from 120KHz to 119KHz 5µs later, decreases to 118KHz after another 5µs, and so on, until the sampling frequency reaches 80KHz, and it takes 200µs to finish this decreasing process. Thus a cycle process including a increasing process and a decreasing process may be 400µs, and a key signal (digital signal) may be sampled 11 times therein. 3ms includes 7.5 cycles, therefore, a key signal may be sampled 82 to 83 times therein.</p><p id="p0059" num="0059">Step S122, determining whether a sampled key signal is an effective key signal, if so, proceeding to Step S123; otherwise, proceeding to Step S124. A key signal being an effective key signal means numerical value of the key signal is greater than a threshold of charge change amount.</p><p id="p0060" num="0060">Step S123, a counting number being increased by 1 and proceeding to Step S124. The original counting number is 0 and the counting number is used to count times for obtaining an effective key signal. The counting number may be increased by 1 when the sampled key signal is an effective key signal.</p><p id="p0061" num="0061">Step S124, determining whether the current time reaches or exceeds the predetermined time span, if so, proceeding to Step S125; otherwise, proceeding to Step S122. Each time after the sampled key signal is determined to be not an effective key signal, or the sampled key signal is determined to be an effective key signal and the counting number is increased by 1, the difference between the current time and the start time of Step S12 is determined whether to be greater than or equal to the predetermined time span, if so, proceeding to Step S125; otherwise, proceeding to Step S122.</p><p id="p0062" num="0062">Step S125, determining whether the counting number is more than or equal to the predetermined value, if so, proceeding to Step S126; otherwise, proceeding to<br/>
<!-- EPO <DP n="12"> -->Step S127. If difference between the current time and the start time of Step S12 is greater than or equal to the predetermined time span, the counting number is determined whether to be greater than or equal to the predetermined value, if so, proceeding to Step S126; otherwise, proceeding to Step S127.</p><p id="p0063" num="0063">Step S126, outputting a control signal. If the counting number within the predetermined time span is greater than or equal to the predetermined value, a control signal is output, which means that the key is pressed or probable to be pressed.</p><p id="p0064" num="0064">Step S127, determining to be interference of external signals. If the counting number within the predetermined time span is less than the predetermined value, it means that the key is not pressed and the key detection may be interfered by external interference signals.</p><p id="p0065" num="0065">Generally, the abovementioned Step S121 may be performed in parallel with Step S122 to S125.</p><p id="p0066" num="0066">The control signal and / or the determination result of whether the sampling times for an effective key signal in a predetermined time span reach or exceed a predetermined value may be used to further determine operation on the key in subsequent process. For example, Step S11 and Sep S12 may be performed repeatedly in 3s. If control signals are generated all the time, it means the key is pressed continuously.</p><p id="p0067" num="0067"><figref idrefs="f0003">FIG. 3</figref> schematically illustrates a flow chart of a key detection method according to another embodiment of the present disclosure. The difference between the embodiment and the first embodiment lies in: before Step S11, the method may further include: receiving external signals and generating a trigger signal to trigger the key detection process when the frequency of an external signal is between a first frequency and a second frequency, namely, after a trigger signal is generated, Step S11 is started.</p><p id="p0068" num="0068">The key detection method shown in <figref idrefs="f0003">FIG. 3</figref> may include:<!-- EPO <DP n="13"> --></p><p id="p0069" num="0069">Step S21, receiving external signals;</p><p id="p0070" num="0070">Step S22, generating a trigger signal to trigger the key detection process when the frequency of an external signal is between the first frequency and the second frequency;</p><p id="p0071" num="0071">Thereafter, Step S11, detecting a key to obtain a key signal, namely, detecting a key after the trigger signal is generated; and</p><p id="p0072" num="0072">Step S12, sampling the key signal at varying frequencies and outputting a control signal when the sampling times for an effective key signal in a predetermined time span reach or exceed a predetermined value, where the sampling frequency varies from a first frequency increasing to a second frequency and then decreasing from the second frequency to the first frequency, the increasing and decreasing sampling processes are repeated, and the sampling may stay in each frequency point for a first predetermined time.</p><p id="p0073" num="0073">The abovementioned Steps S11 and S12 are the same as in the first embodiment, so only Steps S21 and S22 are described in detail hereinafter.</p><p id="p0074" num="0074">First, Step S21 may be performed. In Step S21, external signals may be received. The external signals may include signals caused by environment signals and key operation from external, which may be received through an antenna. A frequency range of signals received by the antenna may depend on the antenna. In some embodiments, the frequency range of signals received by the antenna may be from 20KHz to 500KHz.</p><p id="p0075" num="0075">In some embodiments, receiving external signals may include: receiving external signals at hopping frequencies, where receiving at hopping frequencies includes receiving external signals whose frequencies are equal to hopping frequency points, the hopping frequency increases from a third frequency to a fourth frequency, then decreases from the fourth frequency to the third frequency, and so the cycle to repeat, the frequency points in the increasing process are different from those in the<!-- EPO <DP n="14"> --> decreasing process, and the third frequency is less than the first frequency and the fourth frequency is greater than the second frequency. The third frequency is a lower limit of frequency of signals received by an antenna, for example, 20KHz; and the fourth frequency is an upper limit of frequency of signals received by the antenna, for example, 500KHz. In other embodiments, external signals may be received not at hopping frequencies, while the antenna keeps in reception state all the time.</p><p id="p0076" num="0076">In some embodiments, an increment value (an increment value each time of the hopping frequency increasing from the third frequency to the fourth frequency) and a decrement value (a decrement value each time of the hopping frequency decreasing from the fourth frequency to the third frequency) of the hopping frequency is 2 units of frequency, namely, the hopping frequency increases or decreases in an equal difference.</p><p id="p0077" num="0077">The hopping frequency progressively increasing from 20KHz to 500KHz may be frequencies with an almost equal difference, e.g., the hopping frequency increasing from 20KHz to 21KHz, then increasing from 21KHz to 499KHz in 2KHz and then increasing from 499KHz to 500KHz; the hopping frequency progressively decreasing from 500KHz to 20KHz may be frequencies with an equal difference, e.g., the hopping frequency decreasing from 500KHz to 20KHz in 2KHz. In some embodiments, the frequencies points in the increasing process and in the decreasing process are different, e.g., odd ones and even ones, respectively.</p><p id="p0078" num="0078">Optionally, the frequency range from the third frequency to the fourth frequency may include three continuous frequency bands, namely, a first frequency band, a second frequency band and a third frequency band. The second frequency band may include a frequency band from the first frequency to the second frequency. Time stayed in each frequency point within the first frequency band or the third frequency band is less than that in each frequency point within the second frequency band. For example, the third frequency is 20KHz and the fourth frequency is 500KHz. Accordingly, the first frequency band may be from 20KHz to 80KHz, the second<!-- EPO <DP n="15"> --> frequency band may be from 80KHz to 300KHz, and the third frequency band may be from 300KHz to 500KHz. Time stayed in each frequency point within the first frequency band or in the third frequency band is 0.1ms and time stayed in each frequency point within the second frequency band is 0.2ms.</p><p id="p0079" num="0079">In some embodiments, time stayed at each frequency point within a first frequency band, a second frequency band and a third frequency band (a frequency band from a third frequency to a fourth frequency) may be the same. In some embodiments, external signals with frequencies within a first frequency band or a third frequency band are generally interference signals, shortening residence time at each frequency point within these two frequency bands (being less than that at each frequency point within a second frequency band) may increase frequency hopping rate, thus reduce detection time and improve a utilization rate of system resources.</p><p id="p0080" num="0080">Following Step S21, Step S22 may be performed. In Step S22, a trigger signal may be generated to trigger the key detection process when the frequency of an external signal is between the first frequency and the second frequency. The first frequency and the second frequency may respectively be a lower limit and an upper limit of frequency of signals which are caused by an operation on a key (e.g. pressing a key). In some embodiments, the first frequency is 80KHz and the second frequency is 120KHz. In the present disclosure, a subsequent key detection process is performed when an external signal with a frequency between the first frequency and the second frequency (including the first frequency and the second frequency) is received, namely, when a key is possible to be pressed. Specifically, whether the frequency of an external signal is between the first frequency and the second frequency or not is determined. If so, a trigger signal is generated; otherwise, the external signal is determined to be caused by interferences of environment.</p><p id="p0081" num="0081">Corresponding to the abovementioned key detection method, a key detection apparatus according to one embodiment of the present disclosure is illustrated in <figref idrefs="f0003">FIG. 4</figref>, including a key detecting unit 41 and an effective signal detecting<!-- EPO <DP n="16"> --> unit 42.</p><p id="p0082" num="0082">The key detecting unit 41 is configured to detect a key to obtain a key signal. In some embodiments, the key may be a capacitive touch-key, the key detecting unit may be a capacitance detecting unit configured to detect a charge change amount in a capacitance. The key signal is a digital signal corresponding to the charge change amount in the capacitance. In some embodiments, the capacitance detecting unit may be implemented by an Analog to Digital Converter (ADC) which is configured to detect the charge change amount in the capacitance and convert analog data of charge change to digital data.</p><p id="p0083" num="0083">The effective signal detecting unit 42 is configured to sample the key signal at varying frequencies and output a control signal when the sampling times for an effective key signal in a predetermined time span reach or exceed a predetermined value, where the sampling frequency varies from a first frequency increasing to a second frequency, then from the second frequency decreasing to the first frequency, the increasing and decreasing sampling processes are repeated, and the sampling may stay in each frequency point for a predetermined time. The 1 unit of frequency may be 1KHz. A key signal being an effective key signal means numerical value of the key signal is greater than a threshold of charge change amount. In some embodiments, the effective signal detecting unit 42 may be implemented by a Micro Controller Unit (MCU).</p><p id="p0084" num="0084">A key detection apparatus according to another embodiment of the present disclosure is illustrated in <figref idrefs="f0004">FIG. 5</figref>, including a receiving unit 51, an external signal detecting unit 52, a key detecting unit 41 and an effective signal detecting unit 42.</p><p id="p0085" num="0085">The receiving unit 51 is configured to receive external signals. In some embodiments, the receiving unit 51 may include an antenna 511 and a frequency hopping receiving unit 512. The antenna 511 is configured to receive external environment signals; and the frequency hopping receiving unit 512 is configured to receive external signals at hopping frequencies. Receiving at hopping frequencies<!-- EPO <DP n="17"> --> includes receiving external signals whose frequencies are equal to hopping frequency points, and transmitting the received external environment signals to the external signal detecting unit 52, the hopping frequency increases from a third frequency to a fourth frequency, then decreases from the fourth frequency to the third frequency, and so the cycle to repeat, the frequency points in the increasing process are different from those in the decreasing process, and the third frequency is less than the first frequency and the fourth frequency is greater than the second frequency. In other embodiments, a receiving unit 51 may be used as an antenna, namely, the receiving unit 51 directly receives external environment signals and transmits the received external environment signals to an external signal detecting unit 52.</p><p id="p0086" num="0086">The hopping frequency increases or decreases in 2 units of frequency. The frequency range from the third frequency to the fourth frequency may include three continuous frequency bands, namely, a first frequency band, a second frequency band and a third frequency band. The second frequency band may include a frequency band from the first frequency to the second frequency. Time stayed in each frequency point within the first frequency band or the third frequency band is less than that in each frequency point within the second frequency band.</p><p id="p0087" num="0087">The external signal detecting unit 52 is configured to generate a trigger signal which is used to trigger the key detection process when the frequency of an external signal is between the first frequency and the second frequency. The external signal detecting unit 52 is connected to the key detecting unit 41 and transmits the trigger signal to it.</p><p id="p0088" num="0088">The key detecting unit 41 is configured to detect a key to obtain a key signal after receiving the trigger signal from the external signal detecting unit 52. The effective signal detecting unit 42 is the same as the first embodiment and is not described in detail therein.</p><p id="p0089" num="0089">The abovementioned key detection method may be applied in a key detection system, which may eliminate interference of ambient noises and increase<!-- EPO <DP n="18"> --> accuracy of key detection. The key may be a contact key, such as a capacitive touch-key, or other types of keys, such as an air key. The contact key denotes the key where bodies may directly contact with metal plates and the air key denotes the key where bodies may not directly contact with metal plates.</p><p id="p0090" num="0090"><figref idrefs="f0004">FIG. 5</figref> schematically illustrates a structure of an anti-interference capacitive touch-key detection system, including: capacitive touch-keys 21, an environment detecting unit 31, a key detecting unit 32 and a control unit 40. The environment detecting unit 31 is configured to detect background environment signals, shield signals with frequencies beyond the range from a first frequency to a second frequency and generate a trigger signal after a signal with a frequency between the first frequency and the second frequency is detected; the key detecting unit 32 is configured to detect a key, triggered by the trigger signal, to obtain a key signal; and the control unit 40 is configured to sample the key signal, triggered by the trigger signal, and output a control signal when the sampling times for an effective key signal in a first time window reach or exceed a predetermined value.</p><p id="p0091" num="0091">The capacitive touch-keys are set on a detection plate 20. The detection plate 20 may be a Printed Circuit Board (PCB). At least one balance point 22 is set on the detection plate 20. The balance point may be made of metal and used to adjust the frequency reception and response range of the detection plate 20, which is described in further detail below.</p><p id="p0092" num="0092">Furthermore, the environment detecting unit 31 and the key detecting unit 32 may be integrated on one detection chip 30. The key detecting unit 32 is configured to detect a charge change amount in the keys 21, namely, the difference between the current charge in the keys 21 and the charge therein under the original balanced state, and convert the charge change amount to corresponding digital signals which correspond to the charge change amount.</p><p id="p0093" num="0093">The control unit 40 may be implemented by a MCU.</p><p id="p0094" num="0094"><figref idrefs="f0005">FIG. 7</figref> schematically illustrates a detailed structure of <figref idrefs="f0004">FIG. 6</figref>. Referring to<!-- EPO <DP n="19"> --> <figref idrefs="f0005">FIG. 7</figref>, the environment detecting unit 31 may include: a system interference detecting module 311 configured to detect system noise signals with frequencies within the frequency range of a power supply; a low-frequency interference detecting module 312 configured to detect low-frequency noise signals with frequencies between a third frequency and a fourth frequency, where the third frequency is less than the first frequency and the fourth frequency is greater than the second frequency, and generate a trigger signal after a signal with a frequency between the first frequency and the second frequency is detected; a high-frequency interference detecting module 313 configured to detect high-frequency noise signals with frequencies between a fifth frequency and a sixth frequency, where the fifth frequency is greater than the fourth frequency; and a detection control module 314 configured to control the system interference detecting module 311, the low-frequency interference detecting module 312 and the high-frequency interference detecting module 313 to operate successively and repeatedly.</p><p id="p0095" num="0095">The system interference detecting module 311 is mainly configured to detect noises caused by a power supply and other noises with frequencies within the frequency range of the power supply. In some embodiments, the power supply is formed after a voltage transformation of a lighting source and a frequency range of the corresponding system noise signals to be detected is from 50Hz to 75Hz. Generally, these system noise signals may be detected through power ripple detection circuit and method.</p><p id="p0096" num="0096">The low-frequency interference detecting module 312 is mainly configured to detect low-frequency noise signals with frequencies between the third frequency and the fourth frequency. In some embodiments, the range may be from 20KHz to 500KHz. In order to receive signals with frequencies within the range, the detection plate 20 is configured to be an antenna of the low-frequency interference detecting module 312. One or more balance points made of metal may be set on the detection plate 20 to adjust its capacitive reactance and inductive reactance. Due to the above adjustment and additional adjustment of shape and size of the detection plate 20, both<!-- EPO <DP n="20"> --> the frequency response and receiving range for signals of the detection plate 20 can include the range from the third frequency to the fourth frequency, namely, the detection plate 20 can receive the signals with frequencies between 20KHz and 500KHz. In some embodiments, capacitive reactance of the detection plate 20 may be 0.5pF, and inductive reactance may be 0.1mH to 0.8mH. The keys 21 and the whole detection plate 20 may be taken as the antenna of the low-frequency interference detecting module 312 and no special low-frequency antenna needs to be configured, thereby improving integration of the system and reducing size of a final product.</p><p id="p0097" num="0097">The high-frequency interference detecting module 313 is configured to detect high-frequency noise signals with frequencies between the fifth frequency and the sixth frequency. Specifically, the range may be from 900MHz to 3GHz. The high-frequency noise signals are received through an individual antenna 312a.</p><p id="p0098" num="0098">An anti-interference capacitive touch-key detection system and a detection method therein according to one embodiment of the present disclosure are described in detail in conjunction with <figref idrefs="f0005">FIG. 7</figref>.</p><p id="p0099" num="0099">Initialization may be performed following a power-on event of the anti-interference capacitive touch-key detection system. During the initialization, a detection chip 30 is initialized, namely, the environment detecting unit 31 and the key detecting unit 32 are initialized; furthermore, a control unit 40 is initialized as well. It may take 20ms to complete the whole initialization.</p><p id="p0100" num="0100">Following the initialization, the environment detecting unit 31 may detect background environment signals, shield signals with frequencies beyond the range from a first frequency to a second frequency and generate a trigger signal after a signal with a frequency between the first frequency and the second frequency is detected. Specifically, the environment detecting unit 31 may generate a trigger signal after a signal with a frequency between 80KHz and 120KHz is detected, and shield signals whose frequencies are other frequencies. It should be known that, a signal with a frequency between 80KHz and 120KHz being detected means that there is a signal<!-- EPO <DP n="21"> --> between 80KHz and 120KHz whose amplitude is larger than a particular amplitude threshold. The background environment signal detection process is shown in Step S11 in <figref idrefs="f0003">FIG. 3</figref>.</p><p id="p0101" num="0101">The detection process of background environment signals will be described in detail. First, a system interference detecting module 311 may detect system noise signals with frequencies within the frequency range of a power supply. Specifically, frequencies of these system noise signals are between 50Hz and 75Hz. If a signal with a frequency within the range is detected, the key detecting unit 32 may not be triggered to detect a key and the control unit 40 may not determine the key as well. In some embodiments, if amplitude of a system noise signal is less than a first predetermined amplitude (being 100mV here), for example, 50mV, the amplitude of the system noise signal may be transmitted to the control unit 40 and added to a reference signal by the control unit 40. In a subsequent determination process of effective key signals, the amplitude of the system noise signal is removed from a key signal, thereby avoiding the influence to determination caused by power ripple interference. If amplitude of a system noise signal is greater than a second predetermined amplitude (being 500mV here), for example, 800mV, the amplitude of the system noise signal may be transmitted into the control unit 40 and limited therein, namely, in the subsequent determination process of effective key signals, a key signal whose amplitude is greater than the second predetermined amplitude may be determined to be caused by system noises but not a press on a key.</p><p id="p0102" num="0102">Following the system noise signal detection, the detection control module 314 may control the low-frequency interference detecting module 312 to detect low-frequency noise signals with frequencies between the third frequency and the fourth frequency. Specifically, frequencies of these low-frequency noise signals are between 20KHz and 500KHz and the low-frequency noise signals are received through the detection plate 20. The detailed detection is performed at hopping frequencies. Detecting at hopping frequencies includes receiving external signals whose frequencies are equal to hopping frequency points, where the hopping<!-- EPO <DP n="22"> --> frequency increases from the third frequency (20KHz) to the fourth frequency (500KHz) and then decreases from the fourth frequency (500KHz) to the third frequency (20KHz), and the frequency points in the increasing process are different from those in the decreasing process. The hopping frequency increases or decreases in 2 units of frequency, namely, the hopping frequency increases or decreases by equal difference.</p><p id="p0103" num="0103">Low-frequency noise signals with frequencies beyond the range from 80KHz to 120KHz may be shielded, namely, neither the key detecting unit 32 nor the control unit 40 is triggered, thereby avoiding false determination on a key press event caused by low-frequency noise signals.</p><p id="p0104" num="0104">Following the low-frequency noise signal detection, the detection control module 314 may control the high-frequency interference detecting module 313 to detect high-frequency noise signals with frequencies between the fifth frequency (900MHz) and the sixth frequency (3GHz). High-frequency noise signals with frequencies between 900MHz and 3GHz may be shielded, namely, neither the key detecting unit 32 nor the control unit 40 is triggered, thereby avoiding false determination on a key press event caused by high-frequency noise signals.</p><p id="p0105" num="0105">Following the high-frequency noise signal detection, the detection control module 314 may control the system interference detecting module 311, the low-frequency interference detecting module 312 and the high-frequency interference detecting module 313 to operate successively and repeatedly. Namely, system noise signals, low-frequency noise signals and high-frequency noise signals are detected repeatedly.</p><p id="p0106" num="0106">If a signal with a frequency between the first frequency (80KHz) and the second frequency (120KHz) is detected at the low-frequency interference detecting module 312, a trigger signal may be generated to trigger the key detecting unit 32 and the control unit 40 to operate. The key detecting unit 32 is configured to detect the capacitive touch-key to obtain a key signal. The control unit 40 is configured to<!-- EPO <DP n="23"> --> sample the key signal and output a control signal when the sampling times for an effective key signal in a first time window (3ms) reach or exceed a predetermined value.</p><p id="p0107" num="0107">In some embodiments, a sampling frequency may vary between the first frequency and the second frequency in turn. The sampling is performed in 1 unit of frequency increasingly or decreasingly, namely, the sampling frequency increases or decreases in an equal difference. Specifically, the sampling frequency increases from the first frequency to the second frequency in 1 unit of frequency and the sampling may stay in each frequency point for a predetermined time, namely, the sampling frequency increases in 1 unit of frequency every predetermined time; then the sampling frequency decreases from the second frequency to the first frequency in 1 unit of frequency and the sampling may stay in each frequency point for the predetermined time, namely, the sampling frequency decreases in 1 unit of frequency every predetermined time; furthermore, the sampling frequency increases from the first frequency to the second frequency and decreases from the second frequency to the first frequency, and the increasing sampling and the decreasing sampling is repeated.</p><p id="p0108" num="0108">It should be noted that, during the process of sampling a key signal at the control unit 40, background environment signals are still detected continually at the environment detecting unit 31.</p><p id="p0109" num="0109">If the sampling times for an effective key signal in a first time window are less than a predetermined value, namely, no key press event being detected in the first time window and no control signal being output, the environment detecting unit 31 may enter a sleep state and stop detecting background environment signals.</p><p id="p0110" num="0110">If the sampling times for an effective key signal in a first time window reach or exceed a predetermined value, namely, a key press event being detected in the first time window and a corresponding control signal being output, then a second time window is opened, where duration of the second time window is longer than that of<!-- EPO <DP n="24"> --> the first time window. In some embodiments, duration of the second time window may be 3s. The key signal may be continually sampled in the second time window and a control signal may be output when the sampling times for an effective key signal in any first time window of the second time window reach or exceed the predetermined value. Namely, the key signal is detected still by taking the first time window as basis unit in the second time window. A control signal may be output again when the sampling times for an effective key signal in any first time window of the second time window reach or exceed the predetermined value (80 times). If the sampling times for an effective key signal in a second time window are less than a predetermined value, no key press event being detected in the second time window, the environment detecting unit 31 may enter a sleep state and stop detecting background environment signals, thereby reducing power consumption of the whole system. In practice, key press events always occur successively, such as volume is adjusted or channel is switched by pressing a key successively. Therefore, after a key press event is determined in the first time window, the longer second time window is opened to catch other following key press events, thereby effectively improving accuracy of successive key press event detection.</p><p id="p0111" num="0111">In some embodiments, a watchdog module may be included in the anti-interference capacitive touch-key detection system, configured to wake up the environment detecting unit 31 to detect system noise signals, low-frequency noise signals and high-frequency noise signals if the environment detecting unit 31 has been in a sleep state for a predetermined sleep time(being 128ms here). Generally, duration of a key press event is much longer than 128ms, therefore the environment detecting unit 31 will not miss a key press event when it is in a sleep state, thereby reducing power consumption and ensuring accuracy of detection.</p><p id="p0112" num="0112">In some embodiments, the control unit 40 may receive background environment signals from the environment detecting unit 31. Considering system noise signals, low-frequency noise signals and high-frequency noise signals being successively scanned one time at the environment detecting unit 31 as a cycle, during<!-- EPO <DP n="25"> --> a predetermined monitoring time, if a signal in one frequency point exists in 500 cycles (corresponding time of 500 cycles being the predetermined monitoring time), compensation is performed on the threshold of charge change amount according to the amplitude of the signal in the frequency point. For example, a metal component is placed around the capacitive touch-keys 21 for a long time, causing interference with a fixed frequency of 30KHz. Therefore, interference signals exists in the frequency point of 30KHz during background environment signal detection process of 500 cycles and the control unit 40 may perform compensation on the threshold of charge change amount according to the amplitude of the signal in the frequency point of 30KHz. For example, if charge in capacitive touch-keys in a balance state is reduced because of the external interference of 30KHz, the threshold of charge change amount may be adjusted when detecting the capacitive touch-keys, and the adjusted threshold may adapt to the charge in a balance state. Based on the above adjustment, the anti-interference capacitive touch-key detection system may be self-adapting to environment. And the threshold of charge change amount is modified to an original value when the fixed frequency interference disappears, thereby implementing memory and recovery function of environment and ensuring accuracy of detection.</p><p id="p0113" num="0113">In conclusion, in the present disclosure, a key signal is sampled with varying frequencies and its effectiveness is determined. Compared with a fixed sampling frequency in the existing methods, varying sampling frequencies are difficult to be tracked by varied external signals, thereby reducing the probability of sampled signals being interfered by external signals.</p><p id="p0114" num="0114">Furthermore, a key detection process may be initiated after an external signal with a frequency within a predetermined frequency range is received. Besides, external signals are received at hopping frequencies, which means that external signals with one kind of frequency point are received in a particular time span. Embodiments of the present disclosure combine receiving signals at hopping frequencies with sampling signals at varying frequencies, which further decreases the coincidence between sampling frequency signals and external signals' frequency, and<!-- EPO <DP n="26"> --> thereby decreases interferences in key detection.</p><p id="p0115" num="0115">Further, external signals are received in a predetermined frequency range (from a first frequency to a second frequency) in forward hopping frequency, backward hopping frequency, and so the cycle to repeat, hopping frequency points in the forward process are different from those in the backward process, and staying time at each frequency point lasts for a predetermined time, which improve detection rate, and almost will not miss a key press event.</p><p id="p0116" num="0116">Although the present disclosure has been disclosed as above with reference to preferred embodiments thereof but will not be limited thereto. Those skilled in the art can modify and vary the embodiments without departing from the spirit and scope of the present disclosure. Accordingly, without departing from the scope of the present invented technology scheme, whatever simple modification and equivalent variation belong to the protection range of the present invented technology scheme.</p></description><claims mxw-id="PCLM56976569" lang="EN" load-source="patent-office"><!-- EPO <DP n="27"> --><claim id="c-en-0001" num="0001"><claim-text>A key detection method, comprising:
<claim-text>detecting a key to obtain a key signal; and</claim-text>
<claim-text>sampling the key signal with varying frequencies and outputting a control signal when the sampling times for an effective key signal in a predetermined time span reach or exceed a predetermined value;</claim-text>
<claim-text>where the sampling frequency varies from a first frequency increasing to a second frequency and then from the second frequency decreasing to the first frequency, the increasing and decreasing sampling processes are repeated, and the sampling stays in each frequency point for a predetermined time.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The key detection method according to claim 1, where the sampling is performed in 1 unit of frequency increasingly or decreasingly.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The key detection method according to claim 1, where the key is a capacitive touch-key.</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>The key detection method according to claim 1, where the key is an air key or a contact key.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>The key detection method according to claim 3, where detecting the key to obtain the key signal comprises: detecting a charge change amount in a capacitance in the key; and obtaining the key signal, where the key signal is a digital signal corresponding to the charge change amount in the capacitance.</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>The key detection method according to claim 5, where sampling an effective key signal comprises: sampling a key signal; and determining a sampled key signal to be an effective key signal when numerical value of the sampled key signal is greater than a threshold of charge change amount.</claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>The key detection method according to claim 3, where the predetermined time span is 3ms, the predetermined value is 80, the first frequency is 80KHz, the second<!-- EPO <DP n="28"> --> frequency is 120KHz, the predetermined time is 5µs, and the 1 unit of frequency is 1KHz.</claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>The key detection method according to claim 1 or 3, comprising:
<claim-text>receiving external signals; and</claim-text>
<claim-text>when the frequency of an external signal is between the first frequency and the second frequency, generating a trigger signal which is used to trigger the key detection process.</claim-text></claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>The key detection method according to claim 8, where receiving external signals comprises: receiving external signals at hopping frequencies, where receiving at hopping frequencies includes receiving external signals whose frequencies are equal to hopping frequency points;<br/>
where the hopping frequency increases from a third frequency to a fourth frequency, then decreases from the fourth frequency to the third frequency, and so the cycle to repeat, the frequency points in the increasing process are different from those in the decreasing process, and the third frequency is less than the first frequency and the fourth frequency is greater than the second frequency.</claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>The key detection method according to claim 9, where the hopping frequency increases or decreases in 2 units of frequency.</claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>The key detection method according to claim 9, where the frequency range from the third frequency to the fourth frequency comprises three continuous frequency bands, namely, a first frequency band, a second frequency band and a third frequency band, the second frequency band comprises a frequency band from the first frequency to the second frequency and time stayed in each frequency point within the first frequency band or the third frequency band is less than that in each frequency point within the second frequency band.</claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>The key detection method according to claim 9, where the third frequency is 20KHz and the fourth frequency is 500KHz.<!-- EPO <DP n="29"> --></claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>The key detection method according to claim 12, where the frequency range from the third frequency to the fourth frequency comprises three continuous frequency bands, namely, a first frequency band, a second frequency band and a third frequency band, the first frequency band is from 20KHz to 80KHz, the second frequency band is from 80KHz to 300KHz, and the third frequency band is from 300KHz to 500KHz; and<br/>
time stayed in each frequency point within the first frequency band or in the third frequency band is 0.1ms and time stayed in each frequency point within the second frequency band is 0.2ms.</claim-text></claim><claim id="c-en-0014" num="0014"><claim-text>The key detection method according to claim 12,<br/>
where the hopping frequency increasing from the third frequency to the fourth frequency comprises: the hopping frequency increasing from 20KHz to 21KHz, then increasing from 21KHz to 499KHz in 2KHz and increasing from 499KHz to 500KHz; and<br/>
the hopping frequency decreasing from the fourth frequency to the third frequency comprises: the hopping frequency decreasing from 500KHz to 20KHz in 2KHz.</claim-text></claim><claim id="c-en-0015" num="0015"><claim-text>A key detection apparatus, comprising:
<claim-text>a key detecting unit configured to detect a key to obtain a key signal; and</claim-text>
<claim-text>an effective signal detecting unit to sample the key signal with varying frequencies and output a control signal when the sampling times for an effective key signal in a predetermined time span reach or exceed a predetermined value;</claim-text>
<claim-text>where the sampling frequency varies from a first frequency increasing to a second frequency, then from the second frequency decreasing to the first frequency, the increasing and decreasing sampling processes are repeated, and the sampling stays in each frequency point for a predetermined time.</claim-text><!-- EPO <DP n="30"> --></claim-text></claim><claim id="c-en-0016" num="0016"><claim-text>The key detection apparatus according to claim 15, where the sampling is performed in 1 unit of frequency increasingly or decreasingly.</claim-text></claim><claim id="c-en-0017" num="0017"><claim-text>The key detection apparatus according to claim 15, where the key is a capacitive touch-key.</claim-text></claim><claim id="c-en-0018" num="0018"><claim-text>The key detection apparatus according to claim 15, where the key is an air key or a contact key.</claim-text></claim><claim id="c-en-0019" num="0019"><claim-text>The key detection apparatus according to claim 17, where the key detecting unit comprises a capacitance detecting unit configured to detect a charge change amount in a capacitance in the key to obtain the key signal, where the key signal is a digital signal corresponding to the charge change amount in the capacitance.</claim-text></claim><claim id="c-en-0020" num="0020"><claim-text>The key detection apparatus according to claim 19, where a key signal being an effective key signal means numerical value of the key signal is greater than a threshold of charge change amount.</claim-text></claim><claim id="c-en-0021" num="0021"><claim-text>The key detection apparatus according to claim 15, where the predetermined time span is 3ms, the predetermined value is 80, the first frequency is 80KHz, the second frequency is 120KHz, the predetermined time is 5µs, and the 1 unit of frequency is 1KHz.</claim-text></claim><claim id="c-en-0022" num="0022"><claim-text>The key detection apparatus according to claim 15 or 17, further comprising:
<claim-text>a receiving unit configured to receive external signals; and</claim-text>
<claim-text>an external signal detecting unit configured to generate a trigger signal which is used to trigger the key detection process when the frequency of an external signal is between the first frequency and the second frequency;</claim-text>
<claim-text>where the key detecting unit detects a key to obtain a key signal after receiving the trigger signal.</claim-text></claim-text></claim><claim id="c-en-0023" num="0023"><claim-text>The key detection apparatus according to claim 22, where the receiving unit comprises:<!-- EPO <DP n="31"> -->
<claim-text>an antenna configured to receive external environment signals; and</claim-text>
<claim-text>a frequency hopping receiving unit configured to receive external signals at hopping frequencies, receiving at hopping frequencies includes receiving external signals whose frequencies are equal to hopping frequency points;</claim-text>
<claim-text>where the hopping frequency increases from a third frequency to a fourth frequency, then decreases from the fourth frequency to the third frequency, and so the cycle to repeat, the frequency points in the increasing process are different from those in the decreasing process, and the third frequency is less than the first frequency and the fourth frequency is greater than the second frequency.</claim-text></claim-text></claim><claim id="c-en-0024" num="0024"><claim-text>The key detection apparatus according to claim 23, where the hopping frequency increases or decreases in 2 units of frequency.</claim-text></claim><claim id="c-en-0025" num="0025"><claim-text>The key detection apparatus according to claim 23, where the frequency range from the third frequency to the fourth frequency comprises three continuous frequency bands, namely, a first frequency band, a second frequency band and a third frequency band, the second frequency band comprises a frequency band from the first frequency to the second frequency, and time stayed in each frequency point within the first frequency band or the third frequency band is less than that in each frequency point within the second frequency band.</claim-text></claim><claim id="c-en-0026" num="0026"><claim-text>The key detection apparatus according to claim 23, where the third frequency is 20KHz and the fourth frequency is 500KHz.</claim-text></claim><claim id="c-en-0027" num="0027"><claim-text>The key detection apparatus according to claim 26, where the frequency range from the third frequency to the fourth frequency comprises three continuous frequency bands, namely, a first frequency band, a second frequency band and a third frequency band, the first frequency band is from 20KHz to 80KHz, the second frequency band is from 80KHz to 300KHz, and the third frequency band is from 300KHz to 500KHz; and<br/>
time stayed in each frequency point within the first frequency band or in the third<!-- EPO <DP n="32"> --> frequency band is 0.1ms and time stayed in each frequency point within the second frequency band is 0.2ms.</claim-text></claim><claim id="c-en-0028" num="0028"><claim-text>The key detection apparatus according to claim 23, where the hopping frequency progressively increasing from the third frequency to the fourth frequency comprises: the hopping frequency increasing from 20KHz to 21KHz, then increasing from 21KHz to 499KHz in 2KHz and increasing from 499KHz to 500KHz; and the hopping frequency decreasing from the fourth frequency to the third frequency comprises: the hopping frequency decreasing from 500KHz to 20KHz in 2KHz.</claim-text></claim></claims><drawings mxw-id="PDW16667348" load-source="patent-office"><!-- EPO <DP n="33"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="109" he="78" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="34"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="158" he="195" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="35"> --><figure id="f0003" num="3,4"><img id="if0003" file="imgf0003.tif" wi="150" he="213" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="36"> --><figure id="f0004" num="5,6"><img id="if0004" file="imgf0004.tif" wi="150" he="221" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="37"> --><figure id="f0005" num="7"><img id="if0005" file="imgf0005.tif" wi="140" he="129" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="165" he="231" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="165" he="226" type="tif"/><doc-page id="srep0003" file="srep0003.tif" wi="164" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
