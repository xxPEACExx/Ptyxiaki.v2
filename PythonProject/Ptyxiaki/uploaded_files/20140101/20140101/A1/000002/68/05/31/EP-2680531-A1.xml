<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2680531-A1" country="EP" doc-number="2680531" kind="A1" date="20140101" family-id="48771285" file-reference-id="309446" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146549157" ucid="EP-2680531-A1"><document-id><country>EP</country><doc-number>2680531</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-13173902-A" is-representative="YES"><document-id mxw-id="PAPP154823080" load-source="docdb" format="epo"><country>EP</country><doc-number>13173902</doc-number><kind>A</kind><date>20130626</date><lang>EN</lang></document-id><document-id mxw-id="PAPP183267996" load-source="docdb" format="original"><country>EP</country><doc-number>13173902.1</doc-number><date>20130626</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140448972" ucid="US-201213536686-A" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201213536686</doc-number><kind>A</kind><date>20120628</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988109954" load-source="docdb">H04W  12/04        20090101ALI20130925BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988121448" load-source="docdb">H04L  29/06        20060101AFI20130925BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988127681" load-source="docdb">H04L   9/08        20060101ALI20130925BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-2087961233" load-source="docdb" scheme="CPC">H04L   9/0869      20130101 FI20150305BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2087961403" load-source="docdb" scheme="CPC">H04L  63/06        20130101 LI20150305BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2087961700" load-source="docdb" scheme="CPC">H04L2209/80        20130101 LA20150305BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2087962369" load-source="docdb" scheme="CPC">H04L   9/3271      20130101 LI20150305BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2087964285" load-source="docdb" scheme="CPC">H04W  12/06        20130101 LA20150305BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2087965736" load-source="docdb" scheme="CPC">H04W  12/04        20130101 LI20150305BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132179955" lang="DE" load-source="patent-office">Schlüsselvereinbarung mit einem Schlüsselableitungsschlüssel</invention-title><invention-title mxw-id="PT132179956" lang="EN" load-source="patent-office">Key agreement using a key derivation key</invention-title><invention-title mxw-id="PT132179957" lang="FR" load-source="patent-office">Accord de clé à l'aide d'une clé de dérivation de clé</invention-title><citations><non-patent-citations><nplcit><text>"3rd Generation Partnership Project; Technical Specification Group Services and System Aspects; 3G Security; Security architecture (Release 7)", 3GPP STANDARD; 3GPP TS 33.102, 3RD GENERATION PARTNERSHIP PROJECT (3GPP), MOBILE COMPETENCE CENTRE ; 650, ROUTE DES LUCIOLES ; F-06921 SOPHIA-ANTIPOLIS CEDEX ; FRANCE, no. V7.1.0, 1 December 2006 (2006-12-01), pages 1 - 64, XP050376419</text><sources><source mxw-id="PNPL56209526" load-source="docdb" name="SEA" category="A"/></sources></nplcit><nplcit><text>"3rd Generation Partnership Project; Technical Specification Group Services and System Aspects; Rationale and track of security decisions in Long Term Evolved (LTE) RAN / 3GPP System Architecture Evolution (SAE) (Release 8)", 3GPP STANDARD; 3GPP TR 33.821, 3RD GENERATION PARTNERSHIP PROJECT (3GPP), MOBILE COMPETENCE CENTRE ; 650, ROUTE DES LUCIOLES ; F-06921 SOPHIA-ANTIPOLIS CEDEX ; FRANCE, no. V1.0.0, 1 November 2008 (2008-11-01), pages 1 - 142, XP050376890</text><sources><source mxw-id="PNPL56209527" load-source="docdb" name="SEA" category="XI"/></sources></nplcit><nplcit><text>"Digital cellular telecommunications system (Phase 2+); Universal Mobile Telecommunications System (UMTS); Generic Authentication Architecture (GAA); Generic bootstrapping architecture (3GPP TS 33.220 version 6.11.0 Release 6); ETSI TS 133 220", IEEE, LIS, SOPHIA ANTIPOLIS CEDEX, FRANCE, vol. 3-SA3, no. V6.11.0, 1 December 2006 (2006-12-01), XP014040252, ISSN: 0000-0001</text><sources><source mxw-id="PNPL45130771" load-source="docdb" name="SEA" category="A"/></sources></nplcit><nplcit><text>"Digital cellular telecommunications system (Phase 2+); Universal Mobile Telecommunications System (UMTS); LTE; 3GPP System Architecture Evolution (SAE); Security architecture (3GPP TS 33.401 version 10.2.0 Release 10)", TECHNICAL SPECIFICATION, EUROPEAN TELECOMMUNICATIONS STANDARDS INSTITUTE (ETSI), 650, ROUTE DES LUCIOLES ; F-06921 SOPHIA-ANTIPOLIS ; FRANCE, vol. 3GPP SA 3, no. V10.2.0, 1 October 2011 (2011-10-01), XP014068337</text><sources><source mxw-id="PNPL56209528" load-source="docdb" name="SEA" category="XI"/></sources></nplcit><nplcit><text>None</text><sources><source mxw-id="PNPL67455011" load-source="docdb" name="APP"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR918144945" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>CERTICOM CORP</last-name><address><country>CA</country></address></addressbook></applicant><applicant mxw-id="PPAR918141309" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>CERTICOM CORP.</last-name></addressbook></applicant><applicant mxw-id="PPAR918981526" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Certicom Corp.</last-name><iid>101263463</iid><address><street>4701 Tahoe Boulevard Tahoe A, 6th Floor</street><city>Mississauga, Ontario L4W 0B5</city><country>CA</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918168845" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>BROWN DANIEL RICHARD L</last-name><address><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918146177" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>Brown, Daniel Richard L</last-name></addressbook></inventor><inventor mxw-id="PPAR918981324" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Brown, Daniel Richard L</last-name><address><street>4701 Tahoe Blvd Extension: 14157</street><city>Mississauga, Ontario L4W 0B5</city><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918145289" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>EBEID NEVINE MAURICE NASSIF</last-name><address><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918134979" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>EBEID, NEVINE MAURICE NASSIF</last-name></addressbook></inventor><inventor mxw-id="PPAR918994523" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>EBEID, NEVINE MAURICE NASSIF</last-name><address><street>295 Phillip Street Extension 14273</street><city>Waterloo, Ontario N2L 3W8</city><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918136563" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>CAMPAGNA MATTHEW JOHN</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918157841" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>Campagna, Matthew John</last-name></addressbook></inventor><inventor mxw-id="PPAR918987106" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>Campagna, Matthew John</last-name><address><street>264 Old Sib Road</street><city>Ridgefield, CA California 06877</city><country>US</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918990936" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Moore, Barry</last-name><suffix>et al</suffix><iid>100051455</iid><address><street>Hanna Moore &amp; Curley 13 Lower Lad Lane</street><city>Dublin 2</city><country>IE</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS548846117" load-source="docdb">AL</country><country mxw-id="DS548866747" load-source="docdb">AT</country><country mxw-id="DS548846595" load-source="docdb">BE</country><country mxw-id="DS548836191" load-source="docdb">BG</country><country mxw-id="DS548849795" load-source="docdb">CH</country><country mxw-id="DS548802607" load-source="docdb">CY</country><country mxw-id="DS548866748" load-source="docdb">CZ</country><country mxw-id="DS548846596" load-source="docdb">DE</country><country mxw-id="DS548802608" load-source="docdb">DK</country><country mxw-id="DS548802609" load-source="docdb">EE</country><country mxw-id="DS548801629" load-source="docdb">ES</country><country mxw-id="DS548836192" load-source="docdb">FI</country><country mxw-id="DS548836193" load-source="docdb">FR</country><country mxw-id="DS548846597" load-source="docdb">GB</country><country mxw-id="DS548802614" load-source="docdb">GR</country><country mxw-id="DS548846602" load-source="docdb">HR</country><country mxw-id="DS548866749" load-source="docdb">HU</country><country mxw-id="DS548849796" load-source="docdb">IE</country><country mxw-id="DS548846603" load-source="docdb">IS</country><country mxw-id="DS548836194" load-source="docdb">IT</country><country mxw-id="DS548802615" load-source="docdb">LI</country><country mxw-id="DS548846559" load-source="docdb">LT</country><country mxw-id="DS548867098" load-source="docdb">LU</country><country mxw-id="DS548846560" load-source="docdb">LV</country><country mxw-id="DS548846561" load-source="docdb">MC</country><country mxw-id="DS548852798" load-source="docdb">MK</country><country mxw-id="DS548852799" load-source="docdb">MT</country><country mxw-id="DS548867099" load-source="docdb">NL</country><country mxw-id="DS548801630" load-source="docdb">NO</country><country mxw-id="DS548849797" load-source="docdb">PL</country><country mxw-id="DS548846875" load-source="docdb">PT</country><country mxw-id="DS548867100" load-source="docdb">RO</country><country mxw-id="DS548846876" load-source="docdb">RS</country><country mxw-id="DS548867101" load-source="docdb">SE</country><country mxw-id="DS548846877" load-source="docdb">SI</country><country mxw-id="DS548801631" load-source="docdb">SK</country><country mxw-id="DS548849798" load-source="docdb">SM</country><country mxw-id="DS548852800" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128669827" lang="EN" load-source="patent-office"><p id="pa01" num="0001">Methods, systems, and computer programs for performing key agreement operations in a communication system are described. In some aspects, a wireless network operator accesses a secret key associated with a mobile device. A key derivation function (KDF) is evaluated based on the secret key to produce a key derivation key, and the KDF is evaluated based on the key derivation key to produce an output value. A session key and a challenge value are obtained based on the output value. In some aspects, the mobile device receives the challenge value and accesses a secret key. A KDF is evaluated based on the secret key to produce a key derivation key, and the KDF is evaluated based on the key derivation key to produce an output value. A response value and a session key are obtained based on the output value. The response value is transmitted to the wireless network operator.</p></abstract><abstract mxw-id="PA128499200" lang="EN" source="EPO" load-source="docdb"><p>Methods, systems, and computer programs for performing key agreement operations in a communication system are described. In some aspects, a wireless network operator accesses a secret key associated with a mobile device. A key derivation function (KDF) is evaluated based on the secret key to produce a key derivation key, and the KDF is evaluated based on the key derivation key to produce an output value. A session key and a challenge value are obtained based on the output value. In some aspects, the mobile device receives the challenge value and accesses a secret key. A KDF is evaluated based on the secret key to produce a key derivation key, and the KDF is evaluated based on the key derivation key to produce an output value. A response value and a session key are obtained based on the output value. The response value is transmitted to the wireless network operator.</p></abstract><description mxw-id="PDES63955257" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001">BACKGROUND</heading><p id="p0001" num="0001">This specification relates to performing key agreement operations in a wireless communication system. Many mobile devices are configured to communicate with a wireless network (<i>e.g</i>., Global System for Mobile Communication (GSM), Universal Mobile Telecommunication Services (UMTS), Long-Term Evolution (LTE), etc.). The mobile device and the wireless network can use cryptographic techniques to communicate with confidentiality and authenticity. In some instances, the mobile device and the wireless network perform a key agreement protocol to derive the keys (<i>e.g</i>., ciphering keys, integrity keys, etc.) that are used in cryptographic communication.</p><heading id="h0002">SUMMARY</heading><p id="p0002" num="0002">The present teaching provides a method, server or a data processing apparatus in accordance with the independent claims. Advantageous features are provided in the dependent claims.</p><heading id="h0003">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p0003" num="0003"><figref idrefs="f0001">FIG. 1</figref> is a schematic diagram of an example wireless communication system.</p><p id="p0004" num="0004"><figref idrefs="f0002">FIG. 2</figref> is a signaling and flow diagram of an example authenticated key agreement sequence in a communication system.</p><p id="p0005" num="0005"><figref idrefs="f0003">FIG. 3A</figref> is a flow diagram showing an example technique that can be used by a network operator system for authenticated key agreement.</p><p id="p0006" num="0006"><figref idrefs="f0004">FIG. 3B</figref> is a flow diagram showing an example technique that can be used by a mobile device for authenticated key agreement.</p><p id="p0007" num="0007"><figref idrefs="f0005">FIG. 4A</figref> is a flow diagram showing an example technique that can be used by a network operator system for authenticated key agreement.</p><p id="p0008" num="0008"><figref idrefs="f0006">FIG. 4B</figref> is a flow diagram showing an example technique that can be used by a mobile device for authenticated key agreement.</p><p id="p0009" num="0009"><figref idrefs="f0007">FIGS. 5A</figref> and <figref idrefs="f0008">5B</figref> are flow diagrams showing an example technique that can be used by a network operator system for authenticated key agreement in a Universal Mobile Telecommunication Services (UMTS) system.<!-- EPO <DP n="2"> --></p><p id="p0010" num="0010"><figref idrefs="f0009">FIGS. 5C</figref> and <figref idrefs="f0010">5D</figref> are flow diagrams showing example technique that can be used by a mobile device for authenticated key agreement in a UMTS system.</p><p id="p0011" num="0011"><figref idrefs="f0011">FIG. 5E</figref> is a schematic diagram showing aspects of the example technique shown in <figref idrefs="f0007">FIGS. 5A</figref> and <figref idrefs="f0008">5B</figref>.</p><p id="p0012" num="0012"><figref idrefs="f0012">FIGS. 6A</figref> is a flow diagram showing an example technique that can be used by a network operator system for authenticated key agreement in a UMTS system.</p><p id="p0013" num="0013"><figref idrefs="f0013">FIGS. 6B</figref> and <figref idrefs="f0014">6C</figref> are flow diagrams showing an example technique that can be used by a mobile device for authenticated key agreement in a UMTS system.</p><p id="p0014" num="0014"><figref idrefs="f0015">FIG. 6D</figref> is a schematic diagram showing aspects of the example technique shown in <figref idrefs="f0012">FIG. 6A</figref>.</p><p id="p0015" num="0015">Like reference numbers and designations in the various drawings indicate like elements.</p><heading id="h0004">DETAILED DESCRIPTION</heading><p id="p0016" num="0016">Wireless communication systems need security features. Security protocols may be executed, for example, by wireless network servers, by mobile devices accessing the wireless network, or by a combination of these and other components. Multiple factors influence security requirements. In some cases, a device may need to rely on long-term security of a single algorithm. For example, when an embedded universal integrated circuit card (UICC) is installed in a mobile device, the security algorithm may be difficult to modify or replace after installation. In some cases, available security algorithms evolve based on advances in computational capabilities. For example, the computational capability of mobile device technologies continues to generally increase over time. Given these factors, in some contexts, it may be useful to define loose requirements for alternative key agreement and authentication schemes in wireless networks.</p><p id="p0017" num="0017">In some aspects of what is described here, a mobile device and wireless network operator server can authenticate each other through a third-party wireless network, for example, using a previously-established symmetric key. Key derivation functions (KDFs), message authentication code (MAC) functions, or any suitable combination of them can be used in a larger construct to provide authentication and derive session keys for confidentiality and data integrity. In some instances, the constructs can be deployed<!-- EPO <DP n="3"> --> within a general framework provided by existing standards (<i>e.g</i>., within a Universal Mobile Telecommunication Services (UMTS) system). In some instances, the solutions described here may provide greater agility between underlying security primitives, for example, by using standardized KDFs or other types of functions. The techniques and systems described here may provide additional or different advantages.</p><p id="p0018" num="0018">In some implementations, a security protocol utilizes a MAC function. Any suitable MAC function may be used. Generally, a MAC function receives inputs that include a key, an arbitrary-length input message, and possibly other inputs; the MAC function may produce an output of a specified length based on the inputs. The MAC function may generate the output based on any suitable operations, such as, for example, a keyed hash function, an un-keyed hash function, cipher block chaining, or other types of functions.</p><p id="p0019" num="0019">In some cases, a MAC function can refer to a family of functions <i>h<sub>k</sub></i> parameterized by a key <i>k</i>. A MAC function can have the property of "ease of computation," such that, for a known function <i>h<sub>k</sub></i>, given a value <i>k</i> and an input <i>x, h<sub>k</sub></i>(<i>x</i>) is easy to compute. The value <i>h<sub>k</sub></i>(<i>x</i>) may be referred to as a MAC-value or MAC. A MAC function can have the property of "compression," such that, <i>h<sub>k</sub></i> maps an input x of arbitrary finite bit-length to an output <i>h<sub>k</sub></i>(<i>x</i>) of fixed bit-length <i>n.</i> A MAC function can have the property of "computation-resistance." For example, given a description of the function family <i>h</i>, for every fixed allowable value of <i>k</i> (unknown to an adversary), given zero or more text-MAC pairs (<i>x<sub>i</sub>,h<sub>k</sub></i>(<i>x<sub>i</sub></i>))<i>,</i> it may be computationally infeasible for the adversary to compute any text-MAC pair (<i>x,h<sub>k</sub></i>(<i>x</i>)) for any new input <i>x</i> ≠ <i>x<sub>i</sub></i> (including possibly for <i>h<sub>k</sub></i>(<i>x</i>) = <i>h<sub>k</sub></i>(<i>x<sub>i</sub></i>) for some <i>i</i>). In some cases, a MAC function is included within a larger function. For example, a MAC function may be included in a key derivation function (KDF) or another type of function.</p><p id="p0020" num="0020">In some implementations, a security protocol utilizes a KDF. Any suitable KDF may be used. Some example KDFs are the American National Standard Institute (ANSI) X9.63 hash-based KDF using SHA256 defined in ANSI X9.63-2011, the National Institute of Standards and Technology (NIST) counter-mode KDF defined in NIST SP800-108 with CMAC-AES128 from NIST SP800-38B, the NIST counter-mode KDF defined in NIST SP800-108 with keyed-HMAC-SHA256 from FIPS 198-1, and others.<!-- EPO <DP n="4"> --> These examples can be used, for example, at the 128-bit security level, the 256-bit security level, or at any other suitable level.</p><p id="p0021" num="0021">KDFs can derive cryptographic keys from input data. The inputs may include, for example, a secret key, a random seed, a constant, or any suitable combination of these or other inputs. The input can include a user password, a random seed value from an entropy source, or a value from a hash function or a cryptographic operation. In some instances, a KDF derives an output from an input key and other inputs by applying a function such as a hash, a keyed hash, or block cipher for one or more iterations. In some cases, an output length is provided as an input to the KDF. The output length variable can specify the bit-length of the output produced by the KDF.</p><p id="p0022" num="0022">A KDF can include one or more iterated functions. The number of iterations may depend on, for example, the specified length of the output to be produced by the KDF, a security parameter, or other factors. Some types of functions can be iterated, for example, in a counter mode, a feedback mode, a double-pipeline mode, or in another iteration mode. In a counter mode, a KDF can iterate a function <i>n</i> times and concatenate the outputs until <i>L</i> bits of keying material are generated. In this example, <i>n</i> = ┌<i>L</i>/<i>h</i>┐, where <i>h</i> is an integer that indicates the length of the output of the iterated function.</p><p id="p0023" num="0023"><figref idrefs="f0001">FIG. 1</figref> is a schematic diagram of an example wireless communication system 100. The example wireless communication system 100 includes a mobile device 102 and a wireless network system 103. The wireless communication system 100 can include additional or different features and components. For example, the wireless communication system 100 can include one or more servers, computing systems, additional or different networks, wireless terminals, or any suitable combination of these other components. The wireless network system 103 includes a wireless station 104 and a core network system 106. The wireless network system 103 can include additional or different features and components. The components of the wireless communication system 100 can be configured as shown in <figref idrefs="f0001">FIG. 1</figref>, or the wireless communication system 100 can be configured in another manner, as appropriate.</p><p id="p0024" num="0024">In the example shown in <figref idrefs="f0001">FIG. 1</figref>, the mobile device 102 can communicate with the wireless network system 103. In some instances, the wireless network system 103 can provide the mobile device 102 access to a wide area network (<i>e.g</i>., the Internet, etc.), and<!-- EPO <DP n="5"> --> the mobile device 102 can communicate with other devices or subsystems over the wide area network. In some instances, the wireless network system 103 can provide the mobile device 102 access to a telephone network (<i>e.g</i>., Integrated Services Digital Network (ISDN), Public Switched Telephone Network (PSTN), etc.), and the mobile device 102 can communicate with other devices or subsystems over the telephone network. The mobile device 102 may communicate over additional or different types of networks and may have other ways of accessing the other networks. Mobile devices can be configured to communicate over wireless Local Area Networks (WLANs), Personal Area Networks (PANs) (e.g., Bluetooth and other short-range communication systems), metropolitan area networks, public land mobile networks using cellular technology (e.g., Global System for Mobile Communication (GSM), Universal Mobile Telecommunication Services (UMTS), Long-Term Evolution (LTE), etc.), and other types of wireless networks.</p><p id="p0025" num="0025">The mobile device 102 includes a wireless interface 110, a processor 112, and a memory 114. The mobile device 102 can include additional or different features. In some instances, the mobile device 102 may include one or more user interfaces. For example, the user interface can include a touchscreen, a keyboard, a microphone, a pointing device (e.g., a mouse, a trackball, a stylus, etc.), or another type of user interface. Moreover, the features and components of the mobile device 102 can be configured as shown and described with respect to <figref idrefs="f0001">FIG. 1</figref> or in a different manner. Generally, the mobile device 102 can include any appropriate types of subsystems, modules, devices, components, and combinations thereof. Examples of mobile devices include various types of mobile telecommunication devices, electronic readers, media players, smartphones, laptop systems, tablet devices, etc.</p><p id="p0026" num="0026">The wireless interface 110 of the mobile device 102 can include any suitable hardware, software, firmware, or combinations thereof. In some implementations, the wireless interface 110 can be included in a wireless communication subsystem of the mobile device 102. The wireless interface 110 may include additional or different features or components. In some implementations, the wireless interface 110 may include or have access to programs, codes, scripts, functions, or other types of instructions that can be executed by data processing apparatus. In some implementations, the wireless interface 110 may include or have access to pre-programmed or re-programmable logic circuits, logic gates, or other types of hardware or firmware components. The wireless interface<!-- EPO <DP n="6"> --> 110 handles wireless communications between the mobile device 102 and the wireless station 104.</p><p id="p0027" num="0027">The processor 112 can execute instructions, for example, to generate output data based on data inputs. The instructions can include programs, codes, scripts or other types of data stored in memory. Additionally or alternatively, the instructions can be encoded as pre-programmed or re-programmable logic circuits, logic gates, or other types of hardware or firmware components. In some instances, the processor 112 can generate output data by executing or interpreting software, scripts, programs, functions, executable, or other modules stored in the memory 114.</p><p id="p0028" num="0028">The memory 114 can include any suitable computer-readable media. The memory 114 can include a volatile memory device, a non-volatile memory device, or both. The memory 114 can include one or more read-only memory devices, random-access memory devices, buffer memory devices, or a combination of these and other types of memory devices. In some instances, one or more components of the memory can be integrated or otherwise associated with another component of the mobile device 102. The memory 114 can store data, such as, for example, applications, files, etc. in a computer-readable format.</p><p id="p0029" num="0029">In some implementations, the mobile device 102 includes a universal integrated circuit card (UICC) and mobile equipment. The mobile equipment may be identified, for example, by an International Mobile Equipment Identity (IMEI). The UICC can be, for example, a SIM card that includes an International Mobile Subscriber Identity (IMSI), identifying the subscriber, a secret key for authentication, and other user information. The IMEI and the IMSI can be independent, thereby providing personal mobility. The SIM card may be protected against unauthorized use by a password, personal identity number, or otherwise.</p><p id="p0030" num="0030">The example wireless network system 103 shown in <figref idrefs="f0001">FIG. 1</figref> can include one or more wireless telecommunication networks, wireless data networks, combined voice and data networks, or any suitable combination of these and other types of wireless networks. The wireless network system 103 can be a public land mobile network that uses cellular technology (e.g., Global System for Mobile Communication (GSM), Universal Mobile Telecommunication Services (UMTS), Long-Term Evolution (LTE), etc.). The wireless network system 103 can communicate with the mobile device 102, for example, by radio<!-- EPO <DP n="7"> --> frequency signals or another mode of communication. The wireless network system 103 may include devices, systems, or components distributed across an area or region. The wireless network system 103 can include one or more local, regional, national, or global networks.</p><p id="p0031" num="0031">The wireless network system 103 can include one or more cellular networks. The wireless network system 103 may utilize one or more communication protocol standards, for example, 3G, 4G, GSM, LTE, CDMA, GPRS, EDGE, LTE, or others. In some cases, the wireless network system 103 is implemented as a UMTS system that uses wideband code division multiple access (WCDMA) as the air interface. Some example UMTS systems include a base station subsystem (BSS), a universal terrestrial radio access network (UTRN), and a core network for circuit switched and packet switched (e.g. e-mail) applications.</p><p id="p0032" num="0032">The wireless station 104 can include any suitable structures or systems. In some cases, the wireless station 104 can be implemented as a base station, or a as part of a base station, in a cellular network. The wireless station 104 can communicate wirelessly with the mobile device 102. For example, the wireless station 104 may include one or more antennae that communicate directly with the mobile device 102 by radio frequency signals. The wireless station 104 may include any suitable communication components (<i>e.g</i>., antennas, antenna controller systems, transceivers, computing systems, processors, memory and associated hardware components). In some instances, all or part of the wireless station 104 can be implemented as a base station subsystem (BSS), a base transceiver station (BTS), a base station controller (BSC), a radio base station (RBS), a node B, an evolved node B, a Universal Terrestrial Radio Access Network (UTRAN), or any suitable combination of one or more of these. For example, a BSS may provide allocation, release and management of specific radio resources to establish connections between a mobile device 102 and a radio access network (e.g., a GSM/EDGE radio access network); a UTRAN may include, for example, radio network controllers (RNCs) and NodeBs, and the UTRAN may allow connectivity between the mobile device 102 and the core network system 106. The wireless station 104 may include additional or different features.</p><p id="p0033" num="0033">The wireless station 104 can communicate with the core network system 106, for example, by wired connections, wireless connections, or any suitable combination of<!-- EPO <DP n="8"> --> communication links. The wireless station 104 may include features (<i>e.g</i>., hardware, software, data, etc.) adapted for communicating with the core network system 106. For example, the wireless station 104 may be adapted for encrypting, decrypting, and authenticating communications with the core network system 106.</p><p id="p0034" num="0034">The core network system 106 can include any suitable structures or systems. In some instances, the core network system 106 communicates with the wireless station 104 to control or facilitate communication between the wireless station 104 and the mobile device 102. In some instances, all or part of the core network system 106 can be implemented as a UMTS core network or another type of core network system. The core network system 106 may include any suitable server systems, communication interfaces, or other features. In some instances, the core network system 106 can communicate over a private data network (<i>e.g</i>., an enterprise network, a virtual private network, etc.), a wide area network (<i>e.g</i>., the Internet, etc.), a telephone network, and possibly additional or different types of networks.</p><p id="p0035" num="0035">In some implementations based on UMTS, the core network system 106 may include, for example, a mobile switching center (MSC), a visitor location register (VLR), a gateway MSC (GMSC), a signaling transfer point (STP), a service control point (SCP), an authentication center (AuC), home location register (HLR), a serving GPRS support node (SGSN), a gateway GPRS support node (GGSN), a short message service center SMS-SC, or a combination of these and other systems. The MSC can provide an interface between the radio system and fixed networks. For example the MSC may perform functions to handle circuit switched services to and from the mobile stations. The VLR can provide a database that stores information about mobile devices under the jurisdiction of an MSC that it serves. The HLR can support packet switched (PS) domain entities such as the SGSN, a mobile management entity (MME) and GGSN. The HLR can also support the circuit switched (CS) domain entities such as the MSC. In some instances, the HLR enables subscriber access to services and supports roaming to legacy GSM/UMTS networks. The AuC can store an identity key for each mobile subscriber registered with a home location register (HLR). This key can be used to generate security data. The core network system 106 may include additional or different features.</p><p id="p0036" num="0036">In some implementations based on UMTS, the HLR and VLR together with the MSC provide call routing and (possibly international) roaming capabilities for mobile<!-- EPO <DP n="9"> --> devices. The HLR can contain administrative information of each subscriber registered in the UMTS network, along with the current location of mobile devices. A UMTS network may include a single HLR, and the HLR may be implemented as a distributed database. The VLR can contain selected administrative information from the HLR for call control and provision of the subscribed services, for each mobile currently located in the geographical area controlled by the VLR. Each functional entity can be implemented as an independent unit. Some manufacturers of switching equipment implement one VLR together with one MSC, so that the geographical area controlled by the MSC corresponds to that controlled by the VLR.</p><p id="p0037" num="0037"><figref idrefs="f0002">FIG. 2</figref> is a signaling and flow diagram of an example process 200 for authenticated key agreement in a communication system. The example process 200 shown in <figref idrefs="f0002">FIG. 2</figref> can be modified or reconfigured to include additional, fewer, or different operations, which can be performed in the order shown or in a different order. In some instances, one or more of the operations can be repeated or iterated, for example, until a terminating condition is reached. In some implementations, one or more of the individual operations shown in <figref idrefs="f0002">FIG. 2</figref> can be executed as multiple separate operations, or one or more subsets of the operations shown in <figref idrefs="f0002">FIG. 2</figref> can be combined and executed as a single operation.</p><p id="p0038" num="0038">The process 200 can be implemented in a communication system. For example, the process 200 can be implemented by one or more components of the wireless communication system 100 shown in <figref idrefs="f0001">FIG. 1</figref> or by a different type of system. <figref idrefs="f0002">FIG. 2</figref> shows certain operations being performed by a mobile device 202, a network server 204, and another network server 206. In some implementations of the process 200, one or more of the operations shown in <figref idrefs="f0002">FIG. 2</figref> can be performed by additional or different components, devices, or subsystems, or by combinations of them, as appropriate.</p><p id="p0039" num="0039">The mobile device 202 can be any suitable device capable of wireless communication. In some aspects, the mobile device 202 can be the mobile device 102 shown in <figref idrefs="f0001">FIG. 1</figref> For example, the mobile device 202 can be a mobile unit that allows a user to access network services through network servers 204 or 206. The network servers 204 and 206 can be associated with a wireless network system, such as the wireless network system 103 shown in <figref idrefs="f0001">FIG. 1</figref>. For example, one or both of the network servers 204 and 206 can be part of the wireless station 104, the core network system 106, or the<!-- EPO <DP n="10"> --> network servers 204 and 206 may be associated with other features of a wireless network system.</p><p id="p0040" num="0040">The network server 204 can be any suitable computing system that is capable of communicating (<i>e.g</i>., directly, indirectly, wirelessly, etc.) with the mobile device 202 and the network server 206. In some implementations, the network server 204 can be a visitor location register (VLR), which can be part of a core network. For example, the network server 204 may be configured to perform the functions of detailed location information update, location information registration, paging, security for the mobile device, and can maintain a copy of the subscriber information. In some implementations, the network server 204 can assign a temporary mobile subscriber identity (TMSI) which can have local significance in the area handled by the VLR. For example, the TMSI may be assigned randomly by the AuC. The network server 204 can be implemented in another manner, and it may be configured to perform additional or different operations.</p><p id="p0041" num="0041">The network server 206 can be any suitable computing system that is capable of communicating (<i>e.g</i>., directly, indirectly, wirelessly, etc.) with the network server 204 and the mobile device 202. In some implementations, the network server 206 can be a home location register (HLR), which can be part of a core network. The network server 206 can be implemented in another manner, and it may be configured to perform additional or different operations. In some implementations, the mobile device 202 has a subscription to the wireless network system and can be registered with the network server 204. In some implementations, the mobile device 202 can be a visiting mobile device with a subscription to another wireless network system, and the visiting mobile device can temporarily register with its HLR (<i>e.g.,</i> the network server 206) through a VLR (<i>e.g.,</i> the network server 204).</p><p id="p0042" num="0042">The process 200 can be executed at any suitable time or upon any suitable condition. The process 200 may be performed, for example, when the mobile device 202 enters the jurisdiction of a particular wireless station, when the mobile device 202 initiates communication with a wireless station, when a wireless station initiates communication with the mobile device 202, or upon other events. In some cases, the process 200 can be performed periodically, for example, at specified times or at specified time intervals. In some cases, the process 200 can be performed when the mobile device<!-- EPO <DP n="11"> --> 202 or the wireless network refreshes communication parameters, or at other specified instances.</p><p id="p0043" num="0043">At 210a, the mobile device 202 sends an identifier to the network server 204. The mobile device 202 can transmit the identifier over the wireless network or by additional or different communication systems or links. In some implementation, the identifier can be a temporary mobile subscriber identity (TMSI). The TMSI can be a unique identifier assigned to the mobile device 202 by a network server to identify the mobile device 202, while supporting subscriber identity. At 210b, the network server 204 sends the identifier to the network server 206. In certain instances, the identifier can be the identifier received from the mobile device 202 at 210a. One of the possible reasons for sending the identifier is to request verification of the identifier from the network server 206.</p><p id="p0044" num="0044">At 212, the network server 206 generates a challenge and session keys. In some instances, the example processes shown in <figref idrefs="f0003">FIGS. 3A</figref>, <figref idrefs="f0005">4A</figref>, <figref idrefs="f0007">5A</figref>, <figref idrefs="f0008">5B</figref>, and <figref idrefs="f0012">6A</figref> can be used to generate the challenge and the sessions keys. Other suitable techniques may be used to generate a challenge and session keys. In some implementations, the network server 206 participates in the authentication and key agreement process to generate an authentication vector AV The authentication vector can include, for example, a random value RAND, expected response XRES, cipher key CK, integrity key IK and authentication token AUTN. Each authentication vector may be valid for only one authentication and key agreement between the network server 206 and the mobile device 202 and can be ordered based on a sequence number. Additional or different types of data may be generated by the network server 206.</p><p id="p0045" num="0045">At 216, the network server 206 sends data to the network server 204. The data can include, for example, an authentication vector or any suitable information. In some instances, the data include a random value RAND, an expected response XRES, a cipher key CK, an integrity key IK, an authentication token AUTN, or any suitable combination of values produced by the network server 206 in response to receiving the identifier.</p><p id="p0046" num="0046">At 217, the network server 204 sends a challenge to the mobile device 202. In some implementations, the network server 204 can facilitates an authenticated key agreement process by parsing the data and sending it to the mobile device 202. The challenge sent to the mobile device 202 can include the random value RAND, the authentication token AUTN, or a combination of these and other data.<!-- EPO <DP n="12"> --></p><p id="p0047" num="0047">At 218, the mobile device 202, generates a response and session keys. In some instances, the example processes shown in <figref idrefs="f0004">FIGS. 3B</figref>, <figref idrefs="f0006">4B</figref>, <figref idrefs="f0009">5C</figref>, <figref idrefs="f0010">5D</figref>, <figref idrefs="f0013">6B</figref> and <figref idrefs="f0014">6C</figref> can be used to generate the response and the sessions keys. Other suitable techniques may be used to generate a challenge and session keys. On receiving the challenge, if the authentication token AUTN is accepted by the mobile device 202, the mobile device 202 can generate the response RES, the cipher key CK, the integrity key IK and a mobile device authentication token <i>AUTN<sub>MS</sub>.</i> Additional or different types of data may be generated by the mobile device 202.</p><p id="p0048" num="0048">At 220, the mobile device 202 sends the response to the network server 204. The response can include the response RES generated by the mobile device 202. The response may include additional or different data, as appropriate.</p><p id="p0049" num="0049">At 222, the network server 204 compares the expected response XRES provided by the network server 204 and the response RES provided by the mobile device 202. If the response and the expected response match, the network server 204 can consider the authentication and key agreement to be successfully completed between the mobile device 202 and the network server 206. If the response and the expected response do not match, the network server 204 can consider the authentication and key agreement to have failed. In such instances, one or more of the prior operations can be repeated, the process can be terminated, or other options may be available.</p><p id="p0050" num="0050">At 224, the network server 206 sends an identifier to the mobile device 202. The identifier can be sent through the network server 204 or through another communication link or intermediate system. The identifier can be the TMSI or another identifier. In some cases, the identifier may be encrypted, or the identifier may be unencrypted. In some instances, the identifier is sent to the mobile device before the other operations shown in <figref idrefs="f0002">Figure 2</figref>.</p><p id="p0051" num="0051">At 226, a secure communication channel is utilized between the mobile device one or more of the network servers 204, 206. The channel can be made secure, for example, using the session keys generated at 212 and 218. In some implementations, the mobile device 202 or the network server uses the session keys to communicate with each other or with other entities. In some instances, the mobile device 202 or the network server encrypts or decrypts communications using the ciphering key CK. In some instances, the mobile device 202 or the network server generates an authentication tag or<!-- EPO <DP n="13"> --> verify authenticity of an authentication tag using the integrity key IK. Additional or different security procedures may be used. In some instances, an anonymity key AK* may be used to protect information, for example, to send a resynchronized sequence value SQN to the AuC. In some instances, the anonymity key is used to mask the sequence value SQN, as the sequence value SQN can be used for tracking. The anonymity key AK may computed, for example, from the key K and the value RAND or in any other suitable manner.</p><p id="p0052" num="0052"><figref idrefs="f0003">FIG. 3A</figref> is a flow diagram showing an example process 300 that can be used by a network operator system for authenticated key agreement. The process 300 may be implemented, for example, by a server system of a wireless network or by any other suitable system. In some implementations, one or more operations of the process 300 are performed by a home location register (HLR) or by any other component of the wireless network. The process 300 can include additional or different operations, and the operations can be performed in the order shown in <figref idrefs="f0003">FIG. 3A</figref> or any suitable order. In some cases, one or more of the operations can be iterated or repeated, for example, until a specified condition is reached.</p><p id="p0053" num="0053">At 302, an identifier of a mobile device is received. For instance, the identifier can be a temporary mobile subscriber identity (TMSI) or any other suitable identifier associated with a mobile device. In some implementations, the identifier may be affiliated with an identity in a layer of the Open Systems Interconnection (OSI) model (<i>e.g</i>., an email address, a telephone number, a Session Initiation Protocol (SIP), Uniform Resource Identifier (URI), a media access control identifier, etc.). The identifier can be received directly or indirectly from the mobile device. For example, the mobile device may wirelessly transmit the identifier to the wireless network, and the identifier may be forwarded through one or more communication links in the core network system.</p><p id="p0054" num="0054">At 304, a secret key is accessed. For example, the secret key can be stored in any suitable database or network server of the core network. The identifier received at 302 can be used to locate the secret key, for example, in a secure database. In some instances, the secret key is a long-term, symmetric key held by both the mobile device and the network operator. Additional or different types of secret keys may be used.</p><p id="p0055" num="0055">At 306, a challenge is obtained. For instance, the challenge can be a random challenge value. The random value can be a previously-generated random value, or the<!-- EPO <DP n="14"> --> random value can be generated in response to receiving the identifier. Random values can be generated, for example, by a pseudorandom generator or another suitable system. In some cases, the challenge can be updated by XORing the random challenge with an operator constant.</p><p id="p0056" num="0056">At 308, a message authentication code (MAC) function is evaluated based on the secret key and the challenge. The MAC function can include any suitable function or family of functions. For example, the MAC function can be a hashed-MAC (HMAC), a cipher-MAC (CMAC), or any other suitable MAC function. The MAC function can be evaluated as a stand-alone function, or the MAC function can be evaluated as part of a larger function (<i>e.g</i>., as part of a key derivation function). Some key derivation functions (KDFs) include MAC functions, and evaluating such KDFs causes a MAC function to be evaluated. Examples of KDFs that include MAC functions include the hash-based KDF using SHA256 defined in ANSI X9.63-2011, the counter-mode KDF defined in NIST SP800-108 with CMAC-AES128 from NIST SP800-38B, the NIST counter-mode KDF defined in NIST SP800-108 with keyed-HMAC-SHA256 from FIPS 198-1, and others. The MAC function may operate on any suitable inputs. In some examples, the inputs to the MAC function may include the secret key and the challenge value. Additional or different inputs may be used, as appropriate.</p><p id="p0057" num="0057">At 310, session key(s) and an expected response are obtained based on the output of the MAC function. For instance, the session keys can include one or both of the ciphering key (CK) and the integrity key (IK). Additional or different session keys can be generated. The expected response can be the response that the mobile device is expected to generate in response to the challenge value obtained at 306. As such, the challenge and the expected response can be used to authenticate the mobile device.</p><p id="p0058" num="0058">At 312, a message is generated based on the challenge, the expected response and the session key(s). For instance, the message can include the challenge, the expected response, the session keys (<i>e.g</i>., CK, IK, or other session keys), an authentication token (AUTN), or any suitable combination of these and other data. The message can have any suitable structure or format. The message can be structured as an ordered array or an authentication vector, which can be sent from an HLR to a VLR. In some cases, AUTN can be assembled by concatenating a sequence number SQN, an authentication management function (AMF), and a message authentication code. In addition, an<!-- EPO <DP n="15"> --> anonymity key can also be part of the AUTN. In some cases, the anonymity key AK can be masked with SQN. For example, SQN<sup>AK</sup> may be sent as part of AUTN.</p><p id="p0059" num="0059"><figref idrefs="f0004">FIG. 3B</figref> is a flow diagram showing an example process 350 that can be used by a mobile device for authenticated key agreement. The process 350 may be implemented, for example, by a mobile device in a wireless communication system or by any other suitable system. In some implementations, the example process 350 shown in <figref idrefs="f0004">FIG. 3B</figref> is performed by a mobile device in coordination with a wireless network server performing the example process 300 shown in <figref idrefs="f0003">FIG. 3A</figref>. The process 350 can include additional or different operations, and the operations can be performed in the order shown in <figref idrefs="f0004">FIG. 3B</figref> or any suitable order. In some cases, one or more of the operations can be iterated or repeated, for example, until a specified condition is reached.</p><p id="p0060" num="0060">At 352, a challenge is received. The challenge can be received from the wireless network system. For example, the VLR or another component of the wireless network system may send the challenge to the mobile device to initiate an authenticated key agreement protocol. The challenge can include a random value, an authentication token, or any suitable combination of these and other data. In some instances, the challenge can include the challenge value produced by the network operator at 306 in <figref idrefs="f0003">FIG. 3A</figref>. For example, the challenge can include data from the message generated by a network operator at 312 in <figref idrefs="f0003">FIG. 3A</figref>.</p><p id="p0061" num="0061">At 354, a secret key is accessed. The secret key can be accessed by any suitable technique. The secret key can be accessed locally on the mobile device in response to receiving the challenge from the wireless network. The secret key can be a previously-computed key held by the mobile device and a network operator. For instance, the secret key can be a long-term symmetric key stored on a USIM of a mobile device. In some cases, other types of keys may be used.</p><p id="p0062" num="0062">At 356, a MAC function is evaluated based on the secret key and the challenge. The MAC function evaluated by a mobile device at 356 can be the same MAC function evaluated by a network server at 308. For example, the MAC function can be a hashed-MAC (HMAC), a cipher-MAC (CMAC), or any other suitable MAC function. The MAC function can be evaluated as a stand-alone function, or the MAC function can be evaluated as part of a larger function (<i>e.g</i>., as part of a key derivation function). Some key<!-- EPO <DP n="16"> --> derivation functions (KDFs) include MAC functions, and evaluating such KDFs causes a MAC function to be evaluated.</p><p id="p0063" num="0063">At 358, a response and session key(s) are obtained based on the output of the MAC function. For instance, the session keys can include one or both of the ciphering key (CK) and the integrity key (IK). Additional or different session keys can be generated. The response can include information that the mobile device will proffer in response to the challenge value received at 352. For example, the mobile device can send the response to the network, and the network can use the response to authenticate the mobile device.</p><p id="p0064" num="0064">At 360, the response is transmitted. The response may be wirelessly transmitted from the mobile device to the wireless network system. For example, the response may be sent to the network system that provided the challenge at 352. In some cases, the response may be sent to the VLR or another component of the wireless network system. In some cases, the response can be sent with an authentication token and other data, as appropriate.</p><p id="p0065" num="0065"><figref idrefs="f0005">FIG. 4A</figref> is a flow diagram showing an example process 400 that can be used by a network operator system for authenticated key agreement. The process 400 may be implemented, for example, by a server system of a wireless network or by any other suitable system. In some implementations, one or more operations of the process 400 are performed by a home location register (HLR) or by another component of the wireless network. The process 400 can include additional or different operations, and the operations can be performed in the order shown in <figref idrefs="f0005">FIG. 4A</figref> or any suitable order. In some cases, one or more of the operations can be iterated or repeated, for example, until a specified condition is reached.</p><p id="p0066" num="0066">At 402, an identifier of a mobile device is received. For instance, the identifier can be a temporary mobile subscriber identity (TMSI) or any other suitable identifier associated with a mobile device. In some implementations, the identifier may be affiliated with an identity in a layer of the Open Systems Interconnection (OSI) model (<i>e.g</i>., an email address, a telephone number, a Session Initiation Protocol (SIP), Uniform Resource Identifier (URI), a media access control identifier, etc.). The identifier can be received directly or indirectly from the mobile device. For example, the mobile device may<!-- EPO <DP n="17"> --> wirelessly transmit the identifier to the wireless network, and the identifier may be forwarded through one or more communication links in the core network system.</p><p id="p0067" num="0067">At 404, a secret key is accessed. For example, the secret key can be stored in any suitable database or server of the core network. The identifier received at 302 can be used to locate the secret key, for example, in a secure database. In some instances, the secret key is a long-term, symmetric key held by both the mobile device and the network operator. Additional or different types of secret keys may be used.</p><p id="p0068" num="0068">At 406, a challenge is obtained. For instance, the challenge can be a random challenge value. The random value can be a previously-generated random value, or the random value can be generated in response to receiving the identifier. Random values can be generated, for example, by a pseudorandom generator or another suitable system. In some cases, the challenge can be updated by XORing the random challenge with an operator constant.</p><p id="p0069" num="0069">At 408, a key derivation function KDF is evaluated based on the secret key and the challenge. The KDF can include any suitable function or family of functions. The KDF can include a MAC function, a hash function or another type of one-way function, an encryption function, or any suitable combination of these and other functions. Example KDFs include the hash-based KDF using SHA256 defined in ANSI X9.63-2011, the counter-mode KDF defined in NIST SP800-108 with CMAC-AES128 from NIST SP800-38B, and the NIST counter-mode KDF defined in NIST SP800-108 with keyed-HMAC-SHA256 from FIPS 198-1. Additional or different KDFs may be used.</p><p id="p0070" num="0070">The KDF evaluated at 408 may operate on any suitable inputs. In some examples, the inputs to the KDF include the secret key and the challenge value. Additional or different inputs may be used, as appropriate. The KDF may operate on an input that specifies the length of the keying material to be derived by the KDF. Evaluating the KDF at 408 can produce a key derivation key as output.</p><p id="p0071" num="0071">At 410, the key derivation function is evaluated based on the key derivation key. As such, a tiered approach to key derivation can be used. For instance, the key derivation key produced at 408 can be used as one of the inputs to the KDF to generate another KDF output at 410. The KDF evaluated at 410 can be the same KDF that was evaluated at 408, or a different KDF can be used. In either case, the bit-length of the output produced by the<!-- EPO <DP n="18"> --> KDF at 408 can be greater than, equal to, or less than the bit-length of the output produced by the KDF at 410. For example, different output length variables may be used with the same KDF. The KDF evaluated at 410 may operate on any suitable inputs. In some examples, the inputs to the KDF include the key derivation key and a constant. Additional or different inputs may be used, as appropriate.</p><p id="p0072" num="0072">At 412, session key(s) and an expected response are obtained based on the output produced by the KDF at 410. For instance, the session keys can include one or both of the ciphering key (CK) and the integrity key (IK). Additional or different session keys can be generated. The expected response can be the response that the mobile device is expected to generate in response to the challenge value obtained at 406. As such, the challenge and the expected response can be used to authenticate the mobile device.</p><p id="p0073" num="0073">At 414, a message is generated based on the challenge, the expected response and the session key(s). For instance, the message can include the challenge, the expected response, the session keys (<i>e.g</i>., CK, IK, or other session keys), an authentication token (AUTN), or any suitable combination of these and other data. The message can have any suitable structure or format. The message can be structured as an ordered array or an authentication vector, which can be sent from an HLR to a VLR. In some cases, AUTN can be assembled by concatenating a sequence number SQN, an authentication management function (AMF), and a message authentication code. In addition, an anonymity key can also be part of the AUTN.</p><p id="p0074" num="0074"><figref idrefs="f0006">FIG. 4B</figref> is a flow diagram showing an example process 450 that can be used by a mobile device for authenticated key agreement. The process 450 may be implemented, for example, by a mobile device in a wireless communication system or by any other suitable system. In some implementations, the example process 450 shown in <figref idrefs="f0006">FIG. 4B</figref> is performed by a mobile device in coordination with a wireless network server performing the example process 400 shown in <figref idrefs="f0005">FIG. 4A</figref>. The process 450 can include additional or different operations, and the operations can be performed in the order shown in <figref idrefs="f0006">FIG. 4B</figref> or any suitable order. In some cases, one or more of the operations can be iterated or repeated, for example, until a specified condition is reached.</p><p id="p0075" num="0075">At 452, a challenge is received. The challenge can be received from the wireless network system. For example, the VLR or another component of the wireless network system may send the challenge to the mobile device to facilitate an authenticated key<!-- EPO <DP n="19"> --> agreement protocol. The challenge can include a random value, an authentication token, or any suitable combination of these and other data. In some instances, the challenge can include the challenge value produced by the network operator at 406 in <figref idrefs="f0005">FIG. 4A</figref>. For example, the challenge can include data from the message generated by a network operator at 414 in <figref idrefs="f0005">FIG. 4A</figref>.</p><p id="p0076" num="0076">At 454, a secret key is accessed. The secret key can be accessed by any suitable technique. The secret key can be accessed locally on the mobile device in response to receiving the challenge from the wireless network. The secret key can be a previously-computed key held by the mobile device and a network operator. For instance, the secret key can be a long-term symmetric key stored on a USIM of a mobile device. In some cases, other types of keys may be used.</p><p id="p0077" num="0077">At 456, a key derivation function (KDF) is evaluated based on the secret key and the challenge. Evaluating the KDF at 456 produces a key derivation key. At 458, a KDF is evaluated based on the key derivation key. The KDFs evaluated by a mobile device at 456 and 458 can be the same KDFs evaluated by a network server at 408 and 410, respectively. For example, the KDF evaluated at 456 and 458 can be the hash-based KDF using SHA256 defined in ANSI X9.63-2011, the counter-mode KDF defined in NIST SP800-108 with CMAC-AES128 from NIST SP800-38B, the NIST counter-mode KDF defined in NIST SP800-108 with keyed-HMAC-SHA256 from FIPS 198-1, or any other suitable KDF.</p><p id="p0078" num="0078">At 460, a response and session key(s) are obtained based on the output of the KDF evaluated at 458. For instance, the session keys can include one or both of the ciphering key (CK) and the integrity key (IK). Additional or different session keys can be generated. The response can include information that the mobile device will proffer in response to the challenge value received at 452. For example, the mobile device can send the response to the network, and the network can use the response to authenticate the mobile device.</p><p id="p0079" num="0079">At 462, the response is transmitted. The response may be wirelessly transmitted from the mobile device to the wireless network system. For example, the response may be sent to the network system that provided the challenge at 452. In some cases, the response may be sent to the VLR or another component of the wireless network system. In some<!-- EPO <DP n="20"> --> cases, the response can be sent with an authentication token and other data, as appropriate.</p><p id="p0080" num="0080"><figref idrefs="f0007">FIGS. 5A</figref> and <figref idrefs="f0008">5B</figref> are flow diagrams showing an example process 500 that can be used by a network operator system for authenticated key agreement in a UMTS system. The process 500 may be implemented, for example, by a server system of a wireless network or by any other suitable system. In some implementations, one or more operations of the process 500 are performed by a home location register (HLR) or by another component of the wireless network. The process 500 can include additional or different operations, and the operations can be performed in the order shown in <figref idrefs="f0007">FIGS. 5A</figref> and <figref idrefs="f0008">5B</figref> or any suitable order. In some cases, one or more of the operations can be iterated or repeated, for example, until a specified condition is reached.</p><p id="p0081" num="0081">At 502, a temporary mobile subscriber identity (TMSI) is received. The TMSI is associated with a mobile device. The TMSI can be received from the mobile device or from an entity in the wireless network system. For example, the HLR may receive the TMSI from a visitor location register (VLR) or from another component of the wireless network system. In some implementations, the mobile device wirelessly transmits the TMSI to the network, and the VLR forwards the TMSI to the HLR to authenticate the mobile device.</p><p id="p0082" num="0082">At 504, a key <i>K</i> and a sequence value <i>SQN</i> are accessed. The key <i>K</i> and the sequence value <i>SQN</i> are associated with the TMSI received at 502, and they may be accessed based on the TMSI. The key <i>K</i> and the sequence value <i>SQN</i> corresponding to the TMSI may be accessed in any suitable manner. For example, the HLR may access the key <i>K</i> and the sequence value <i>SQN</i> by searching a database for a record corresponding to the TMSI.</p><p id="p0083" num="0083">At 506, a random value <i>RAND</i> is generated. The random value <i>RAND</i> can be generated by any suitable technique. In some cases, the HLR can access a database of previously-generated random values, or the HLR may include a pseudorandom generator that generates random values as needed. The random value can be any suitable size or data format (<i>e.g</i>., binary, etc.).</p><p id="p0084" num="0084">At 508, the random value <i>RAND</i> may be updated. If the operator is using an operator constant <i>OP</i>, then <i>OP<sub>c</sub></i> is computed. The value <i>OP<sub>c</sub></i> can be used to update <i>RAND,</i><!-- EPO <DP n="21"> --> for example, by computing <i>RAND</i> = <i>RAND</i> ⊕ <i>OP<sub>c</sub>.</i> The value <i>OP<sub>c</sub></i> may be computed by evaluating <i>OP<sub>c</sub></i> = KDF(<i>K</i>, <i>OP, klength</i>), where KDF represents a key derivation function. The inputs to KDF include OP (a 128-bit operator variant algorithm configuration field), <i>K</i> (a long-term secret key) and <i>klength</i> (a key length variable). In addition, <i>OP<sub>c</sub></i> can be a 128-bit value derived from <i>OP</i> and <i>K</i>. The value <i>OP<sub>c</sub></i> can be used within the computations of <i>f1</i>, <i>f1*</i>,<i>f2, f3, f4, f5</i> and <i>f5</i>*. The value <i>f1</i> can represent an output of a message authentication code function. The value <i>f2</i> can represent an output of a message authentication code function used to compute a response (RES) and an expected response (XRES). The value <i>f3</i> can represent an output of a key generating function used to compute a cipher key (CK). The value <i>f4</i> can represent an output of a key generating function used to compute an integrity key (IK). The value <i>f5</i> can represent an output of a key generating function used to compute the anonymity key AK.</p><p id="p0085" num="0085">At 510, a value <i>Z</i> is computed. The value <i>Z</i> can be computed by evaluating <i>Z</i> = <i>KDF</i>(<i>K, RAND, outlen</i>). Here, the inputs to KDF can include the key <i>K</i>, the random value <i>RAND</i> and <i>outlen,</i> where <i>outlen</i> represents the sum of bit-lengths needed for <i>f2,f3,f5</i> and <i>f5<sub>*</sub>.</i> The function KDF can be any key derivation function that accepts an input key and other input data to derive keying material. Example KDFs include the hash-based KDF using SHA256 defined in ANSI X9.63-2011, the counter-mode KDF defined in NIST SP800-108 with CMAC-AES128 from NIST SP800-38B, and the NIST counter-mode KDF defined in NIST SP800-108 with keyed-HMAC-SHA256 from FIPS 198-1. Additional or different KDFs may be used.</p><p id="p0086" num="0086">At 512, <i>f2, f3, f5</i> and optionally <i>f5<sub>*</sub></i> are extracted from <i>Z</i>. For instance, the extraction process can include parsing <i>Z</i> or any other suitable technique.</p><p id="p0087" num="0087">At 514, <i>temp</i>=<i>SQN</i>∥<i>AMF</i>∥<i>SQN</i>∥<i>AMF</i> is formed. For instance, <i>temp</i> can be assembled by concatenating <i>SQN</i> and <i>AMF.</i> In some instances, the concatenation is done twice. Here, <i>SQN</i> is a sequence number that can be kept synchronized by the mobile device and the HLR. In addition, AMF represents the Authentication Management Field. Example uses of AMF may include support for multiple authentication algorithms and keys, changing list parameter and setting threshold values to restrict the lifetime of cipher and integrity keys.<!-- EPO <DP n="22"> --></p><p id="p0088" num="0088">At 516, a new value of <i>Z</i> is computed. The new value can be computed by evaluating <i>Z</i> = <i>KDF</i>(<i>K, RAND</i>⊕<i>temp, outlen</i>'). Here, the inputs to the KDF can include the key <i>K</i>, the random value RAND XORed with <i>temp,</i> and <i>outlen.</i> The value <i>outlen</i> can represent the sum of bit-lengths for <i>f1, f1</i>* and <i>f4</i>. The value <i>temp</i> can be the concatenation of <i>SQN</i> and AMF produced at 514.</p><p id="p0089" num="0089">At 518 , <i>f1,f1*</i> and <i>f4</i> are extracted from <i>Z.</i> For instance, the extraction process can include parsing <i>Z</i> or any other suitable technique.</p><p id="p0090" num="0090">At 520, if masking is used, the sequence value <i>SQN</i> can be masked. For example, the sequence value can be masked by computing <i>SQN</i> = <i>SQN ⊕ f5.</i> For each mobile device, the authentication center (AuC) can keep track of the sequence value <i>SQN,</i> which can facilitate re-synchronization. Sequence masking can be done, for example, while provisioning non-production environments so that copies created to support test and development processes are not exposing sensitive information and thus avoiding risks of leaking. Masking algorithms can be designed to be repeatable so referential integrity is maintained.</p><p id="p0091" num="0091">At 522, the authentication token <i>AUTN</i> is assembled. Here, the authentication token <i>AUTN</i> can be assembled by forming <i>AUTN</i> = <i>SQN</i>∥<i>AMF</i>∥ <i>f1</i> (= <i>MAC<sub>A</sub></i>)<i>.</i> For instance, <i>AUTN</i> can be assembled by the concatenation of the sequence number <i>SQN,</i> authentication management field <i>AMF</i> and the value <i>f1.</i> The value of <i>f1</i> can be the message authentication code <i>MAC<sub>A</sub>.</i></p><p id="p0092" num="0092">At 524, an output quintet <i>Q</i> is generated. Here, the output quintet can be generated by forming <i>Q</i> = (<i>RAND, XRES</i> = <i>f2, CK</i> = <i>f3, IK</i> = <i>f4, AUTN</i>)<i>.</i> For instance, <i>Q</i> can be an ordered array of authentication vector that can include a random number <i>RAND,</i> an expected response <i>XRES,</i> a cipher key <i>CK,</i> an integrity key <i>IK</i> and authentication token <i>AUTN.</i> In some cases, the quintet <i>Q</i> is valid for an authentication and key agreement between the VLR and the mobile device.</p><p id="p0093" num="0093">At 526, the output quintet <i>Q</i> is sent. The output quintet <i>Q</i> can be sent, for example, by the HLR to the VLR. The output quintet <i>Q</i> can be sent in any suitable form or format, using any suitable transmission technique. Subsequently, the VLR can extract <i>RAND</i> and <i>AUTH</i> and may forward these variables to the mobile device.<!-- EPO <DP n="23"> --></p><p id="p0094" num="0094"><figref idrefs="f0009">FIGS. 5C</figref> and <figref idrefs="f0010">5D</figref> are flow diagrams showing an example process 550 that can be used by a mobile device for authenticated key agreement in a UMTS system. The process 550 may be implemented, for example, by a mobile device in a wireless communication system or by any other suitable system. In some implementations, the example process 550 shown in <figref idrefs="f0009">FIGS. 5C</figref> and <figref idrefs="f0010">5D</figref> is performed by a mobile device in coordination with a wireless network server performing the example process 500 shown in <figref idrefs="f0007">FIGS. 5A</figref> and <figref idrefs="f0008">5B</figref>. The process 550 can include additional or different operations, and the operations can be performed in the order shown in <figref idrefs="f0009">FIGS. 5C</figref> and <figref idrefs="f0010">5D</figref> or any suitable order. In some cases, one or more of the operations can be iterated or repeated, for example, until a specified condition is reached.</p><p id="p0095" num="0095">At 552, a random value <i>RAND</i> and an authentication token <i>AUTN</i> are received. The values may be received wirelessly by the mobile device from the wireless network. In some cases, <i>RAND</i> and <i>AUTN</i> can be sent to the mobile device by a VLR or another component of the wireless network system. In some cases, the random value <i>RAND</i> and the authentication token <i>AUTN</i> are the values generated by a network operator in the process 500 (<i>e.g</i>., at 506 or 508, 522) shown in <figref idrefs="f0007">FIGS. 5A</figref> and <figref idrefs="f0008">5B</figref>. For example, the VLR may parse the random value <i>RAND</i> and authentication token <i>AUTN</i> from the authentication vector AV sent to the VLR from the HLR, and the VLR may forward the parsed values to the mobile device for authentication.</p><p id="p0096" num="0096">At 554, the key <i>K</i> and the stored sequence value <i>SQN<sub>MS</sub></i> are accessed. For instance, the key K and the sequence value <i>SQN<sub>MS</sub></i> can be accessed in a local memory of the mobile device. In the mobile device, the <i>SQN<sub>MS</sub></i> can be stored in a USIM or another suitable computer-readable medium. The sequence value <i>SQN<sub>MS</sub></i> can be a counter stored locally at the mobile device. The key <i>K</i> can be a long-term symmetric key stored by the mobile device and the network operator system. Additional or different types of keys may be used.</p><p id="p0097" num="0097">At 556, if the operator is using an operator constant, the random value <i>RAND</i> can be updated. The random value <i>RAND</i> can be updated in the same manner as in the process 500 at 508. For instance, <i>RAND</i> can be updated by computing <i>RAND</i> = <i>RAND</i>⊕<i>OP<sub>C</sub></i> (where <i>OP<sub>C</sub></i> is computed as described with respect to operation 508 in <figref idrefs="f0007">FIG. 5A</figref>).</p><p id="p0098" num="0098">At 558, the value <i>Z</i> is computed. Here, the value <i>Z</i> is computed by evaluating <i>Z</i> = <i>KDF</i>(<i>K, RAND, outlen</i>). The value <i>Z</i> can be computed by the mobile device using the<!-- EPO <DP n="24"> --> same KDF and the same inputs that were used by the network operator system in the process 500 at 510.</p><p id="p0099" num="0099">At 560, <i>f2, f3, f5</i> and optionally <i>f5<sub>*</sub></i> are extracted from <i>Z.</i> For instance, the extraction process can include parsing <i>Z</i> or any other suitable technique.</p><p id="p0100" num="0100">At 562, the authentication token <i>AUTN</i> is parsed. For instance, parsing the authentication token (<i>AUTN</i> = <i>SQN</i>∥<i>AMF</i>∥<i>MAC<sub>A</sub></i>) can be done to retrieve the sequence number <i>SQN,</i> the authentication management field AMF, the message authentication code <i>MAC<sub>A</sub>,</i> or any combination of them.</p><p id="p0101" num="0101">At 564, if masking is used, the sequence value <i>SQN</i> is masked. The sequence number <i>SQN</i> can be masked according to the technique used in the process 500 at 520. For instance, the sequence number can be masked by XORing the extracted sequence number <i>SQN</i> with <i>f5</i> (<i>SQN</i> = <i>SQN</i> ⊕ <i>f5</i>).</p><p id="p0102" num="0102">At 566, <i>temp</i> is formed. The value <i>temp</i> can be formed by the same technique used in the process 500 at 514. For instance, the value <i>temp</i> can be formed by setting <i>temp</i>=<i>SQN</i>∥<i>AMF</i>∥<i>SQN</i>∥<i>AMF,</i> a concatenation of the extracted sequence number <i>SQN</i> and <i>AMF.</i></p><p id="p0103" num="0103">At 568, a new value <i>Z</i> is computed. The new value <i>Z</i> can be computed by the same technique used to compute the new value <i>Z</i> in the process 500 at 516. For example, the new value <i>Z</i> can be computed by evaluating <i>Z</i> = <i>KDF</i>(<i>K, RAND</i>⊕<i>temp, outlen</i>').</p><p id="p0104" num="0104">At 570, <i>f1,f1<sub>*</sub></i> and <i>f4</i> are extracted from <i>Z</i>. For instance, the extraction process can include parsing <i>Z</i> or any other suitable technique.</p><p id="p0105" num="0105">At 572, <i>MAC<sub>A</sub></i> is compared to <i>f1.</i> If they are not equal (<i>i.e.,</i> if <i>MAC<sub>A</sub> ≠ f1</i>)<i>,</i> the process can be halted. In the event that the process is halted, at 573 an error code is returned. Otherwise (<i>i.e.,</i> if <i>MAC<sub>A</sub></i> = <i>f1</i>)<i>,</i> the process can proceed to 574.</p><p id="p0106" num="0106">At 574, the validity of <i>SQN</i> is checked against <i>SQN<sub>MS</sub>.</i> This check can be performed to determine if re-synchronization is needed. If <i>SQN</i> is not valid, resynchronization is performed at 575. Resynchronization can be performed by: (1) updating the sequence value <i>SQN<sub>MS</sub>,</i> (2) computing <i>Z</i> = <i>KDF</i>(<i>K, RAND</i>⊕(<i>SQN<sub>MS</sub></i>∥<i>AMF<sub>*</sub></i>∥<i>SQN<sub>MS</sub></i>∥<i>AMF<sub>*</sub></i>), <i>outlen</i>'), where <i>AMF<sub>*</sub></i> is a default value, (3) extracting <i>f1*</i> = <i>MAC<sub>S</sub></i> from <i>Z,</i> (4) if masking is used, applying the masking operation<!-- EPO <DP n="25"> --> <i>SQN<sub>MS</sub></i> = <i>SQN<sub>MS</sub></i>⊕<i>f5<sub>*</sub>,</i> and (5) forming <i>AUTN<sub>MS</sub></i> = <i>SQN<sub>MS</sub></i>∥<i>MAC<sub>S</sub>.</i> When <i>SQN</i> is valid, the process can proceed to 576.</p><p id="p0107" num="0107">At 576, a response <i>RES,</i> a cipher key <i>CK</i> and an integrity key <i>IK</i> are generated. For instance, the response <i>RES</i> and the session keys can be generated by the mobile device. Here the response <i>RES</i> = <i>f2,</i> the cipher key <i>CK</i> = <i>f3,</i> the integrity key <i>IK</i> = <i>f4,</i> and if required the mobile device authentication token <i>AUTN<sub>MS</sub></i> may be generated as well.</p><p id="p0108" num="0108">At 578, the response <i>RES</i> is sent, and the mobile device authentication token <i>AUTN<sub>MS</sub></i> may also be sent. For instance, <i>RES</i> and <i>AUTN<sub>MS</sub></i> can be sent by the mobile device to the VLR. On receiving <i>RES</i> and <i>AUTH<sub>MS</sub></i> from the mobile device, the VLR can verify that the response value RES is equal to the expected response value XRES. If RES = XRES, the verification is successful and the communication between the VLR and the mobile device is secured by the cipher and integrity keys <i>CK</i> and <i>IK.</i> If provided, the value <i>AUTN<sub>MS</sub></i> can be sent to the HLR. Upon receipt <i>of AUTN<sub>MS</sub>,</i> the HLR can verify the value <i>MAC<sub>S</sub></i> and update the sequence value indicated by <i>SQN<sub>MS</sub>.</i></p><p id="p0109" num="0109"><figref idrefs="f0011">FIG. 5E</figref> is a schematic diagram 590 showing aspects of the example technique shown in <figref idrefs="f0007">FIGS. 5A</figref> and <figref idrefs="f0008">5B</figref>. The operations shown in diagram 590 correspond to the operations in the example process 500 shown in <figref idrefs="f0007">FIG. 5A</figref> and <figref idrefs="f0008">5B</figref>. The diagram 590 is provided for illustration purposes. The process 500 may be implemented in another manner.</p><p id="p0110" num="0110"><figref idrefs="f0012">FIG. 6A</figref> is a flow diagram showing an example process 600 that can be used by a network operator system for authenticated key agreement in a UMTS system. The process 600 may be implemented, for example, by a server system of a wireless network or by any other suitable system. In some implementations, one or more operations of the process 600 are performed by a home location register (HLR) or by another component of the wireless network. The process 600 can include additional or different operations, and the operations can be performed in the order shown in <figref idrefs="f0012">FIG. 6A</figref> or any suitable order. In some cases, one or more of the operations can be iterated or repeated, for example, until a specified condition is reached.</p><p id="p0111" num="0111">At 602, a temporary mobile subscriber identity (TMSI) is received. The TMSI is associated with a mobile device. The TMSI can be received from the mobile device or from an entity in the wireless network system. For example, the HLR may receive the<!-- EPO <DP n="26"> --> TMSI from a visitor location register (VLR) or from another component of the wireless network system. In some implementations, the mobile device wirelessly transmits the TMSI to the network, and the VLR forwards the TMSI to the HLR to authenticate the mobile device.</p><p id="p0112" num="0112">At 604, a key <i>K</i> and a sequence value <i>SQN</i> are accessed. The key <i>K</i> and the sequence value <i>SQN</i> are associated with the TMSI received at 602, and they may be accessed based on the TMSI. The key <i>K</i> and the sequence value <i>SQN</i> corresponding to the TMSI may be accessed in any suitable manner. For example, the HLR may access the key <i>K</i> and the sequence value <i>SQN</i> by searching a database for a record corresponding to the TMSI.</p><p id="p0113" num="0113">At 606, a random value <i>RAND</i> is generated. The random value <i>RAND</i> can be generated by any suitable technique. In some cases, the HLR can access a database of previously-generated random values, or the HLR may include a pseudorandom generator that generates random values as needed. The random value can be any suitable size or data format (<i>e.g</i>., binary, etc.).</p><p id="p0114" num="0114">At 608, the random value <i>RAND</i> may be updated. If the operator is using an operator constant <i>OP,</i> then <i>OP<sub>c</sub></i> is computed. The value <i>OP<sub>c</sub></i> can be used to update <i>RAND,</i> for example, by computing <i>RAND</i> = <i>RAND</i> ⊕ <i>OP<sub>c</sub>.</i> The value <i>OP<sub>c</sub></i> may be computed by evaluating <i>OP<sub>c</sub></i> = KDF(<i>K</i>, <i>OP, klength</i>), where KDF represents a key derivation function. The inputs to KDF include OP (a 128-bit operator variant algorithm configuration field), <i>K</i> (a long-term secret key) and <i>klength</i> (a key length variable). In addition, <i>OP<sub>c</sub></i> can be a 128-bit value derived from <i>OP</i> and <i>K</i>.</p><p id="p0115" num="0115">At 610, a key derivation key <i>K</i>' is computed. Here, the key derivation key can be computed by evaluating <i>K</i>' = KDF(<i>K</i>, <i>RAND, klength</i>). The inputs to KDF can include the key <i>K</i>, the random value <i>RAND</i> and <i>klength,</i> where <i>klength</i> represents the bit-length of the key derivation key <i>K</i>'. KDF can be any suitable key derivation function that accepts an input key and other input data to derive keying material. Example KDFs include the hash-based KDF using SHA256 defined in ANSI X9.63-2011, the counter-mode KDF defined in NIST SP800-108 with CMAC-AES128 from NIST SP800-38B, and the NIST counter-mode KDF defined in NIST SP800-108 with keyed-HMAC-SHA256 from FIPS 198-1. Additional or different KDFs may be used.<!-- EPO <DP n="27"> --></p><p id="p0116" num="0116">At 612, a new value <i>Z</i> is computed. Here, the new value <i>Z</i> can be computed by evaluating <i>Z</i> = <i>KDF</i>(<i>K', "STRING", outlen</i>). The inputs to this KDF can include key <i>K,</i> an input string "STRING" and <i>outlen,</i> which represents the sum of bit-lengths needed for <i>f2,f3,f4,f5</i> and <i>f5<sub>*</sub>.</i> The input string "STRING" can be any constant that is known to both the mobile device and the network operator system.</p><p id="p0117" num="0117">At 614, <i>f2, f3, f4, f5</i> and <i>f5<sub>*</sub></i> are extracted from <i>Z</i>. For instance, the extraction process can include parsing <i>Z</i> or any other suitable technique.</p><p id="p0118" num="0118">At 616, the value <i>f1</i> is computed. For instance, the value <i>f1</i> can be computed by evaluating <i>f1</i> = <i>KDF</i>(<i>K', SQN</i>∥<i>AMF, outlen</i>'). Here, the inputs to KDF include the key derivation key <i>K</i>', the sequence number <i>SQN</i> concatenated with <i>AMF</i> and <i>outlen',</i> which represents the bit-length of <i>f1</i>.</p><p id="p0119" num="0119">At 618, if masking is used, the sequence value <i>SQN</i> can be masked. For example, the sequence value can be masked by computing <i>SQN</i> = <i>SQN ⊕ f5.</i> For each mobile device, the authentication center (AuC) can keep track of the sequence value <i>SQN,</i> which can facilitate re-synchronization.</p><p id="p0120" num="0120">At 620, the authentication token <i>AUTN</i> is assembled. Here, the authentication token <i>AUTN</i> can be assembled by forming <i>AUTN</i> = <i>SQN</i>∥<i>AMF</i>∥<i>f1</i> (= <i>MAC<sub>A</sub></i>)<i>.</i> For instance, <i>AUTN</i> can be assembled by the concatenation of the sequence number <i>SQN,</i> authentication management field <i>AMF</i> and the value <i>f1</i>.</p><p id="p0121" num="0121">At 622, an output quintet <i>Q</i> is generated. Here, the output quintet can be generated by forming <i>Q</i> = (<i>RAND, XRES</i> = <i>f2, CK</i> = <i>f3, IK</i> = <i>f4, AUTN</i>)<i>.</i> For instance, <i>Q</i> can be an ordered array of authentication vector that can include a random number <i>RAND,</i> an expected response <i>XRES,</i> a cipher key <i>CK,</i> an integrity key <i>IK</i> and authentication token <i>AUTN.</i> In some cases, the quintet <i>Q</i> is valid for an authentication and key agreement between the VLR and the mobile device.</p><p id="p0122" num="0122">At 624, the output quintet <i>Q</i> is sent. The output quintet <i>Q</i> can be sent, for example, by the HLR to the VLR. The output quintet <i>Q</i> can be sent in any suitable form or format, using any suitable transmission technique. Subsequently, the VLR can extract <i>RAND</i> and <i>AUTH</i> and may forward these variables to the mobile device.</p><p id="p0123" num="0123"><figref idrefs="f0013">FIGS. 6B</figref> and <figref idrefs="f0014">6C</figref> are flow diagrams showing an example process 650 that can be used by a mobile device for authenticated key agreement in a UMTS system. The process<!-- EPO <DP n="28"> --> 650 may be implemented, for example, by a mobile device in a wireless communication system or by any other suitable system. In some implementations, the example process 650 shown in <figref idrefs="f0013">FIGS. 6B</figref> and <figref idrefs="f0014">6C</figref> is performed by a mobile device in coordination with a wireless network server performing the example process 600 shown in <figref idrefs="f0012">FIG. 6A</figref>. The process 650 can include additional or different operations, and the operations can be performed in the order shown in <figref idrefs="f0013">FIGS. 6B</figref> and <figref idrefs="f0014">6C</figref> or any suitable order. In some cases, one or more of the operations can be iterated or repeated, for example, until a specified condition is reached.</p><p id="p0124" num="0124">At 652, a random value <i>RAND</i> and an authentication token <i>AUTN</i> are received. The values may be received wirelessly by the mobile device from the wireless network. In some cases, <i>RAND</i> and <i>AUTN</i> can be sent to the mobile device by a VLR or another component of the wireless network system. In some cases, the random value <i>RAND</i> and the authentication token <i>AUTN</i> are the values generated by the network operator in the process 600 (<i>e.g</i>., at 606 or 608, 620) shown in <figref idrefs="f0012">FIG. 6A</figref>. For example, the VLR may parse the random value <i>RAND</i> and authentication token <i>AUTN</i> from the authentication vector AV sent to the VLR from the HLR, and the VLR may forward the parsed values to the mobile device for authentication.</p><p id="p0125" num="0125">At 654, the key <i>K</i> and the stored sequence value <i>SQN<sub>MS</sub></i> are accessed. For instance, the key <i>K</i> and the sequence value <i>SQN<sub>MS</sub></i> can be accessed in a local memory of the mobile device. In the mobile device, the <i>SQN<sub>MS</sub></i> can be stored in an ISIM or another suitable computer-readable medium. The sequence value <i>SQN<sub>MS</sub></i> can be a counter stored locally at the mobile device. The key <i>K</i> can be a long-term symmetric key stored by the mobile device and the network operator system. Additional or different types of keys may be used.</p><p id="p0126" num="0126">At 656, if the operator is using an operator constant, the random value <i>RAND</i> can be updated. The random value <i>RAND</i> can be updated in the same manner as in the process 600 at 608. For instance, <i>RAND</i> can be updated by computing <i>RAND</i> = <i>RAND</i>⊕<i>OP<sub>C</sub></i> (where <i>OP<sub>C</sub></i> is computed as described with respect to operation 608 in <figref idrefs="f0012">FIG. 6A</figref>).</p><p id="p0127" num="0127">At 658, the key derivation key <i>K</i>' is computed. The key derivation key <i>K</i>' can be computed by evaluating <i>K</i>' = <i>KDF</i>(<i>K, RAND, klength</i>). The key derivation key <i>K</i>' can be computed by the mobile device using the same KDF and the same inputs that were used by the network operator system in the process 600 at 610.<!-- EPO <DP n="29"> --></p><p id="p0128" num="0128">At 660, the value <i>Z</i> is computed. The value <i>Z</i> can be computed by evaluating <i>Z</i> = <i>KDF</i>(<i>K, RAND, outlen</i>). The value <i>Z</i> can be computed by the mobile device using the same KDF and the same inputs that were used by the network operator system in the process 600 at 612.</p><p id="p0129" num="0129">At 662, the values <i>f2</i>, <i>f3</i>, <i>f4</i>, <i>f5</i> and <i>f5</i><sub>*</sub> are extracted from <i>Z</i>. For instance, the extraction process can include parsing <i>Z</i> or any other suitable technique.</p><p id="p0130" num="0130">At 664, the authentication token <i>AUTN</i> is parsed. For instance, parsing the authentication token (<i>AUTN</i> = <i>SQN</i>∥<i>AMF</i>∥<i>MAC<sub>A</sub></i>) can be done to retrieve the sequence number <i>SQN,</i> the authentication management field AMF, the message authentication code <i>MAC<sub>A</sub>,</i> or any combination of them.</p><p id="p0131" num="0131">At 666, if masking is used, the sequence value <i>SQN</i> is masked. The sequence number <i>SQN</i> can be masked according to the technique used in the process 600 at 618. For instance, the sequence number can be masked by XORing the extracted sequence number <i>SQN</i> with <i>f5</i> (<i>SQN</i> = <i>SQN</i> ⊕ <i>f5</i>).</p><p id="p0132" num="0132">At 668, the value <i>f1</i> is computed. For instance, the value <i>f1</i> can be computed by evaluating <i>f1</i> = <i>KDF</i>(<i>K', SQN</i>∥<i>AMF, outlen</i>'). Here, the KDF and the input values can be the same as those used by the network operator in the process 600 at 616 to compute the value <i>f1</i>.</p><p id="p0133" num="0133">At 670, <i>MAC<sub>A</sub></i> is compared to <i>f1</i>. If they are not equal (<i>i.e.,</i> if <i>MAC<sub>A</sub> ≠ f1</i>)<i>,</i> the process can be halted. In the event that the process is halted, at 669 an error code is returned. Otherwise (<i>i.e.,</i> if <i>MAC<sub>A</sub></i> = <i>f1</i>)<i>,</i> the process can proceed to 672.</p><p id="p0134" num="0134">At 672, the validity of <i>SQN</i> is checked against <i>SQN<sub>MS</sub>.</i> This check can be performed to determine if re-synchronization is needed. If <i>SQN</i> is not valid, resynchronization is performed at 675. Resynchronization can be performed by: (1) updating the sequence value <i>SQN<sub>MS</sub>,</i> (2) computing <i>f1<sub>*</sub></i> = <i>KDF</i>(<i>K', SQN<sub>MS</sub></i>∥<i>AMF<sub>*</sub></i>, <i>outlen</i>'), where <i>AMF<sub>*</sub></i> is a default value, (3) if masking is used, applying the masking operation <i>SQN<sub>MS</sub></i> = <i>SQN<sub>MS</sub></i> ⊕ <i>f5<sub>*</sub>,</i> and (4) forming <i>AUTN<sub>MS</sub></i> = <i>SQN<sub>MS</sub></i>∥<i>MAC<sub>S</sub>.</i> When <i>SQN</i> is valid, the process can proceed to 674.</p><p id="p0135" num="0135">At 674, a response <i>RES,</i> a cipher key <i>CK</i> and an integrity key <i>IK</i> are generated. For instance, the response <i>RES</i> and the session keys can be generated by the mobile<!-- EPO <DP n="30"> --> device. Here the response <i>RES</i> = <i>f2</i>, the cipher key <i>CK</i> = <i>f3</i>, the integrity key <i>IK</i> = <i>f4,</i> and if required the mobile device authentication token <i>AUTN<sub>MS</sub></i> may be generated as well.</p><p id="p0136" num="0136">At 676, the response <i>RES</i> is sent, and the mobile device authentication token <i>AUTN<sub>MS</sub></i> may also be sent. For instance, <i>RES</i> and <i>AUTN<sub>MS</sub></i> can be sent by the mobile device to the VLR. On receiving <i>RES</i> and <i>AUTH<sub>MS</sub></i> from the mobile device, the VLR can verify that the response value RES is equal to the expected response value XRES. If RES = XRES, the verification is successful and the communication between the VLR and the mobile device is secured by the cipher and integrity keys <i>CK</i> and <i>IK</i>. If provided, the value <i>AUTN<sub>MS</sub></i> can be sent to the HLR. Upon receipt of <i>AUTN<sub>MS</sub>,</i> the HLR can verify the value <i>MAC<sub>S</sub></i> and update the sequence value indicated by <i>SQN<sub>MS</sub>.</i></p><p id="p0137" num="0137"><figref idrefs="f0015">FIG. 6D</figref> is a schematic diagram showing aspects of the example technique shown in <figref idrefs="f0012">FIG. 6A</figref>. The operations shown in diagram 690 correspond to the operations in the example process 600 shown in <figref idrefs="f0012">FIG. 6A</figref>. The diagram 690 is provided for illustration purposes. The process 600 may be implemented in another manner.</p><p id="p0138" num="0138">Operations described in this specification can be implemented as operations performed by a data processing apparatus on data stored on one or more computer-readable storage devices or received from other sources. The term "data processing apparatus" encompasses all kinds of apparatus, devices, and machines for processing data, including by way of example a programmable processor, a computer, a system on a chip, or multiple ones, or combinations, of the foregoing. The apparatus can include special purpose logic circuitry, <i>e.g</i>., an FPGA (field programmable gate array) or an ASIC (application-specific integrated circuit). The apparatus can also include, in addition to hardware, code that creates an execution environment for the computer program in question, <i>e.g</i>., code that constitutes processor firmware, a protocol stack, a database management system, an operating system, a cross-platform runtime environment, a virtual machine, or a combination of one or more of them. The apparatus and execution environment can realize various different computing model infrastructures, such as web services, distributed computing and grid computing infrastructures.</p><p id="p0139" num="0139">A computer program (also known as a program, software, software application, script, or code) can be written in any form of programming language, including compiled or interpreted languages, declarative or procedural languages, and it can be deployed in any form, including as a stand-alone program or as a module, component, subroutine,<!-- EPO <DP n="31"> --> object, or other unit suitable for use in a computing environment. A computer program may, but need not, correspond to a file in a file system. A program can be stored in a portion of a file that holds other programs or data (e.g., one or more scripts stored in a markup language document), in a single file dedicated to the program in question, or in multiple coordinated files (e.g., files that store one or more modules, sub-programs, or portions of code). A computer program can be deployed to be executed on one computing device or on multiple computers that are located at one site or distributed across multiple sites and interconnected by a communication network.</p><p id="p0140" num="0140">The processes and logic flows described in this specification can be performed by one or more programmable processors executing one or more computer programs to perform actions by operating on input data and generating output. The processes and logic flows can also be performed by, and apparatus can also be implemented as, special purpose logic circuitry, e.g., an FPGA (field programmable gate array) or an ASIC (application-specific integrated circuit).</p><p id="p0141" num="0141">Processors suitable for the execution of a computer program include, by way of example, both general and special purpose microprocessors, and any one or more processors of any kind of digital computing device. Generally, a processor will receive instructions and data from a read-only memory or a random access memory or both. The essential elements of a computing device are a processor for performing actions in accordance with instructions and one or more memory devices for storing instructions and data. Generally, a computing device will also include, or be operatively coupled to receive data from or transfer data to, or both, one or more storage devices for storing data. However, a computing device need not have such devices. Moreover, a computer can be embedded in another device, <i>e.g</i>., a mobile telephone, a personal digital assistant (PDA), a mobile audio or video player, a game console, a Global Positioning System (GPS) receiver, or a portable storage device (e.g., a universal serial bus (USB) flash drive), to name just a few. Devices suitable for storing computer program instructions and data include all forms of non-volatile memory, media and memory devices, including by way of example semiconductor memory devices, <i>e.g</i>., EPROM, EEPROM, and flash memory devices; magnetic disks, e.g., internal hard disks or removable disks; magneto-optical disks; and CD-ROM and DVD-ROM disks. The processor and the memory can be supplemented by, or incorporated in, special purpose logic circuitry.<!-- EPO <DP n="32"> --></p><p id="p0142" num="0142">To provide for interaction with a user, subject matter described in this specification can be implemented on a computer having a display device, e.g., an LCD (liquid crystal display) screen for displaying information to the user and a keyboard and a pointing device, e.g., touch screen, stylus, mouse, etc. by which the user can provide input to the computer. Other kinds of devices can be used to provide for interaction with a user as well; for example, feedback provided to the user can be any form of sensory feedback, e.g., visual feedback, auditory feedback, or tactile feedback; and input from the user can be received in any form, including acoustic, speech, or tactile input. In addition, a computing device can interact with a user by sending documents to and receiving documents from a device that is used by the user; for example, by sending web pages to a web browser on a user's client device in response to requests received from the web browser.</p><p id="p0143" num="0143">Some of the subject matter described in this specification can be implemented in a computing system that includes a back-end component, e.g., as a data server, or that includes a middleware component, <i>e.g</i>., an application server, or that includes a front-end component, <i>e.g</i>., a client computing device having a graphical user interface or a Web browser through which a user can interact with an implementation of the subject matter described in this specification, or any combination of one or more such back-end, middleware, or front-end components. The components of the system can be interconnected by any form or medium of digital data communication, e.g., a data network.</p><p id="p0144" num="0144">The computing system can include clients and servers. A client and server are generally remote from each other and typically interact through a data network. The relationship of client and server arises by virtue of computer programs running on the respective computers and having a client-server relationship to each other. In some implementations, a server transmits data to a client device. Data generated at the client device can be received from the client device at the server.</p><p id="p0145" num="0145">While this specification contains many specific implementation details, these should not be construed as limitations on the scope of what may be claimed, but rather as descriptions of features specific to particular implementations. Certain features that are described in this specification in the context of separate implementations can also be implemented in combination in a single implementation. Conversely, various features<!-- EPO <DP n="33"> --> that are described in the context of a single implementation can also be implemented in multiple implementations separately or in any suitable subcombination. Moreover, although features may be described above as acting in certain combinations and even initially claimed as such, one or more features from a claimed combination can in some cases be excised from the combination, and the claimed combination may be directed to a subcombination or variation of a subcombination.</p><p id="p0146" num="0146">Similarly, while operations are depicted in the drawings in a particular order, this should not be understood as requiring that such operations be performed in the particular order shown or in sequential order, or that all illustrated operations be performed, to achieve desirable results. In certain circumstances, multitasking and parallel processing may be advantageous. Moreover, the separation of various system components in the implementations described above should not be understood as requiring such separation in all implementations, and it should be understood that the described program components and systems can generally be integrated together in a single software product or packaged into multiple software products.</p><p id="p0147" num="0147">In a general aspect, one or more session keys are generated in a communication system. A session key may be generated, for example, by a mobile device, a network operator system, another type of system, or by any suitable combination of these.</p><p id="p0148" num="0148">In some aspects, a computer system of a wireless network operator receives an identifier of a mobile device. Based on the identifier, a secret key associated with the mobile device is accessed. A key derivation function is evaluated to produce a key derivation key based on the secret key. The key derivation function is evaluated to produce an output value based on the key derivation key. A session key is obtained based on the second output value.</p><p id="p0149" num="0149">Implementations of these and other aspects may include one or more of the following features. A random challenge value is obtained before evaluating the key derivation function to produce the key derivation key. An expected response value, a ciphering key, and an integrity key are obtained based on the output value. A message that includes the ciphering key, the integrity key, the random challenge value, and the expected response value is generated. The message is transmitted to a wireless station of a wireless network.<!-- EPO <DP n="34"> --></p><p id="p0150" num="0150">Additionally or alternatively, implementations of these and other aspects may include one or more of the following features. The key derivation key is produced by evaluating the key derivation function on the secret key, a random challenge value obtained after receiving the identifier, and a first output length that specifies a bit-length of the key derivation key. The output value is produced by evaluating the key derivation function on the key derivation key, a pre-defined constant value, and a second output length that specifies a bit-length of the output value.</p><p id="p0151" num="0151">Additionally or alternatively, implementations of these and other aspects may include one or more of the following features. The key derivation function includes a message authentication code function. A message authentication code is obtained based on the key derivation key. A sequence value associated with the mobile device is accessed. A server authentication token is generated based on the message authentication code and the sequence value.</p><p id="p0152" num="0152">In some aspects, a mobile device receives a challenge value from a wireless network operator system. The mobile device accesses a secret key in response to receiving the challenge value. A key derivation function is evaluated to produce a key derivation key based on the secret key. The key derivation function is evaluated to produce an output value based on the key derivation key. A response value and a session key are obtained based on the output value. The response value is transmitted to the wireless network operator system.</p><p id="p0153" num="0153">Implementations of these and other aspects may include one or more of the following features. Obtaining the session key includes obtaining a ciphering key and an integrity key. The key derivation key is produced by evaluating the key derivation function on the secret key, the challenge value, and a first output length that specifies a bit-length of the key derivation key. The output value is produced by evaluating the key derivation function on the key derivation key, a pre-defined constant value, and a second output length that specifies a bit-length of the output value.</p><p id="p0154" num="0154">Additionally or alternatively, implementations of these and other aspects may include one or more of the following features. A sequence value previously stored on the mobile device is accessed. A message authentication code is obtained based on the secret key and the sequence value. A mobile device authentication token is generated based on the message authentication code and the sequence value.<!-- EPO <DP n="35"> --></p><p id="p0155" num="0155">Furthermore the present teaching may extend to the features of one or more of the following numbered clauses:
<ol><li>1. A method performed by a computer system of a wireless network operator, the method comprising:
<ul><li>receiving an identifier of a mobile device;</li><li>accessing, based on the identifier, a secret key associated with the mobile device;</li><li>evaluating a key derivation function to produce a key derivation key based on the secret key;</li><li>evaluating the key derivation function to produce an output value based on the key derivation key; and</li><li>obtaining a session key based on the output value.</li></ul></li><li>2. The method of clause 1, wherein obtaining the session key comprises obtaining a plurality of session keys, and the plurality of session keys include a ciphering key and an integrity key.</li><li>3. The method of clause 2, further comprising:
<ul><li>obtaining a random challenge value before evaluating the key derivation function to produce the key derivation key;</li><li>obtaining an expected response value based on the output value;</li><li>generating a message that includes the ciphering key, the integrity key, the random challenge value, and the expected response value; and</li><li>transmitting the message to a wireless station of a wireless network.</li></ul></li><li>4. The method of clause 1, further comprising obtaining a random challenge value after receiving the identifier, wherein the key derivation key is produced by evaluating the key derivation function on:
<ul><li>the secret key;</li><li>the random challenge value; and</li><li>a first output length that specifies a bit-length of the key derivation key.</li></ul></li><li>5. The method of clause 4, wherein the output value is produced by evaluating the key derivation function on:
<ul><li>the key derivation key;<!-- EPO <DP n="36"> --></li><li>a pre-defined constant value; and</li><li>a second output length that specifies a bit-length of the output value.</li></ul></li><li>6. The method of clause 1, wherein evaluating the key derivation function includes evaluating a message authentication code function.</li><li>7. The method of clause 1, further comprising:
<ul><li>obtaining a message authentication code based on the key derivation key;</li><li>accessing a sequence value associated with the mobile device; and</li><li>generating a server authentication token based on the message authentication code and the sequence value.</li></ul></li><li>8. A wireless network operator system comprising:
<ul><li>a communication interface operable to receive an identifier of a mobile device;</li><li>data processing apparatus operable to:
<ul><li>access, based on the identifier, a secret key associated with the mobile device;</li><li>evaluate a key derivation function to produce a key derivation key based on the secret key;</li><li>evaluate the key derivation function to produce an output value based on the key derivation key; and</li><li>obtain a session key based on the output value.</li></ul></li></ul></li><li>9. The wireless network operator system of clause 8, wherein obtaining the session key comprises obtaining a plurality of session keys, and the plurality of session keys include a ciphering key and an integrity key.</li><li>10. The wireless network operator system of clause 9, wherein the data processing apparatus is further operable to:
<ul><li>obtain a random challenge value before evaluating the key derivation function to produce a key derivation key;</li><li>obtain an expected response value based on the output value;</li><li>generate a message that includes the ciphering key, the integrity key, the random challenge value, and the expected response value; and</li><li>transmit the message to a wireless station of a wireless network.</li></ul><!-- EPO <DP n="37"> --></li><li>11. The wireless network operator system of clause 8, wherein the key derivation key is produced by evaluating the key derivation function on:
<ul><li>the secret key;</li><li>a random challenge value; and</li><li>a first output length that specifies a bit-length of the key derivation key.</li></ul></li><li>12. The wireless network operator system of clause 11, wherein the output value is produced by evaluating the key derivation function on:
<ul><li>the key derivation key;</li><li>a pre-defined constant value; and</li><li>a second output length that specifies a bit-length of the output value.</li></ul></li><li>13. The wireless network operator system of clause 8, wherein evaluating the key derivation function includes evaluating a message authentication code function.</li><li>14. The wireless network operator system of clause 8, wherein the data processing apparatus is further operable to:
<ul><li>obtain a message authentication code based on the key derivation key;</li><li>access a sequence value associated with the mobile device; and</li><li>generate a server authentication token based on the message authentication code and the sequence value.</li></ul></li><li>15. A method performed by a mobile device, the method comprising:
<ul><li>accessing a secret key in response to receiving a challenge value from a wireless network operator system;</li><li>evaluating a key derivation function to produce a key derivation key based on the secret key;</li><li>evaluating the key derivation function to produce an output value based on the key derivation key;</li><li>obtaining a response value and a session key based on the output value; and</li><li>transmitting the response value to the wireless network operator system.</li></ul></li><li>16. The method of clause 15, wherein obtaining the session key comprises obtaining a plurality of session keys, and the plurality of session keys include a ciphering key and an integrity key.<!-- EPO <DP n="38"> --></li><li>17. The method of clause 15, wherein the key derivation key is produced by evaluating the key derivation function on:
<ul><li>the secret key;</li><li>the challenge value; and</li><li>a first output length that specifies a bit-length of the key derivation key.</li></ul></li><li>18. The method of clause 17, wherein the output value is produced by evaluating the key derivation function on:
<ul><li>the key derivation key;</li><li>a pre-defined constant value; and</li><li>a second output length that specifies a bit-length of the output value.</li></ul></li><li>19. The method of clause 15, further comprising:
<ul><li>accessing a sequence value previously stored on the mobile device;</li><li>obtaining a message authentication code based on the secret key and the sequence value; and</li><li>generating a mobile device authentication token based on the message authentication code and the sequence value.</li></ul></li><li>20. A mobile device comprising:
<ul><li>a communication interface operable to receive a challenge value from a wireless network operator system;</li><li>data processing apparatus operable to:
<ul><li>access a secret key in response to receiving the challenge value;</li><li>evaluate a key derivation function to produce a key derivation key based on the secret key;</li><li>evaluate the key derivation function to produce an output value based on the key derivation key;</li><li>obtain a response value and a session key based on the output value; and</li><li>transmit the response value to the wireless network operator system.</li></ul></li></ul></li><li>21. The mobile device of clause 20, wherein obtaining the session key comprises obtaining a plurality of session keys, and the plurality of session keys include a ciphering key and an integrity key.<!-- EPO <DP n="39"> --></li><li>22. The mobile device of clause 20, wherein the key derivation key is produced by evaluating the key derivation function on:
<ul><li>the secret key;</li><li>the challenge value; and</li><li>a first output length that specifies a bit-length of the key derivation key.</li></ul></li><li>23. The mobile device of clause 22, wherein the output value is produced by evaluating the key derivation function on:
<ul><li>the key derivation key;</li><li>a pre-defined constant value; and</li><li>a second output length that specifies a bit-length of the output value.</li></ul></li><li>24. The mobile device of clause 20, wherein the data processing apparatus is further operable to:
<ul><li>access a sequence value previously stored on the mobile device;</li><li>obtain a message authentication code based on the secret key and the sequence value; and</li><li>generate a mobile device authentication token based on the message authentication code and the sequence value.</li></ul></li><li>25. The mobile device of clause 20, wherein the data processing apparatus comprises an embedded integrated circuit card.</li></ol></p><p id="p0156" num="0156">Thus, some implementations of the subject matter have been described. Other implementations are within the scope of the following claims.</p></description><claims mxw-id="PCLM56976171" lang="EN" load-source="patent-office"><!-- EPO <DP n="40"> --><claim id="c-en-0001" num="0001"><claim-text>A method comprising:
<claim-text>receiving an identifier of a mobile device;</claim-text>
<claim-text>accessing, based on the identifier, a secret key associated with the mobile device;</claim-text>
<claim-text>evaluating a key derivation function to produce a key derivation key based on the secret key;</claim-text>
<claim-text>evaluating the key derivation function to produce an output value based on the key derivation key; and</claim-text>
<claim-text>obtaining a session key based on the output value; wherein the key derivation function is based on a hash function.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The method of claim 1, wherein obtaining the session key comprises obtaining a plurality of session keys, and the plurality of session keys include a ciphering key and an integrity key.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The method of claim 1 or 2, further comprising obtaining a random challenge value after receiving the identifier, wherein the key derivation key is produced by evaluating the key derivation function on:
<claim-text>the secret key;</claim-text>
<claim-text>the random challenge value; and</claim-text>
<claim-text>a first output length that specifies a bit-length of the key derivation key.</claim-text></claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>The method of claim 3, wherein the output value is produced by evaluating the key derivation function on:
<claim-text>the key derivation key;</claim-text>
<claim-text>a pre-defined constant value; and</claim-text>
<claim-text>a second output length that specifies a bit-length of the output value.</claim-text></claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>The method of any preceding claim, wherein evaluating the key derivation function includes evaluating a message authentication code function.</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>The method of any preceding claim, further comprising:
<claim-text>obtaining a message authentication code based on the key derivation key;</claim-text>
<claim-text>accessing a sequence value associated with the mobile device; and<!-- EPO <DP n="41"> --></claim-text>
<claim-text>generating a server authentication token based on the message authentication code and the sequence value.</claim-text></claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>A server comprising:
<claim-text>a communication interface operable to receive an identifier of a mobile device;</claim-text>
<claim-text>data processing apparatus operable to:
<claim-text>access, based on the identifier, a secret key associated with the mobile device;</claim-text>
<claim-text>evaluate a key derivation function to produce a key derivation key based on the secret key;</claim-text>
<claim-text>evaluate the key derivation function to produce an output value based on the key derivation key; and</claim-text>
<claim-text>obtain a session key based on the output value; wherein the key derivation function is based on a hash function.</claim-text></claim-text></claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>The server of claim 7, wherein the key derivation key is produced by evaluating the key derivation function on:
<claim-text>the secret key;</claim-text>
<claim-text>a random challenge value; and</claim-text>
<claim-text>a first output length that specifies a bit-length of the key derivation key.</claim-text></claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>The server of claim 7 or 8, wherein the output value is produced by evaluating the key derivation function on:
<claim-text>the key derivation key;</claim-text>
<claim-text>a pre-defined constant value; and</claim-text>
<claim-text>a second output length that specifies a bit-length of the output value.</claim-text></claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>The server of any one of claims 7 to 9, wherein evaluating the key derivation function includes evaluating a message authentication code function.</claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>The server of any one of claims 7 to 10, wherein the data processing apparatus is further operable to:
<claim-text>obtain a message authentication code based on the key derivation key;</claim-text>
<claim-text>access a sequence value associated with the mobile device; and</claim-text>
<claim-text>generate a server authentication token based on the message authentication code and the sequence value.</claim-text><!-- EPO <DP n="42"> --></claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>A method performed by a mobile device, the method comprising:
<claim-text>accessing a secret key in response to receiving a challenge value;</claim-text>
<claim-text>evaluating a key derivation function to produce a key derivation key based on the secret key;</claim-text>
<claim-text>evaluating the key derivation function to produce an output value based on the key derivation key;</claim-text>
<claim-text>obtaining a response value and a session key based on the output value; and</claim-text>
<claim-text>transmitting the response value; wherein the key derivation function is based on a hash function.</claim-text></claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>The method of claim 12, wherein the key derivation key is produced by evaluating the key derivation function on:
<claim-text>the secret key;</claim-text>
<claim-text>the challenge value; and</claim-text>
<claim-text>a first output length that specifies a bit-length of the key derivation key.</claim-text></claim-text></claim><claim id="c-en-0014" num="0014"><claim-text>A data processing apparatus comprising:
<claim-text>a processor operable to:
<claim-text>access a secret key in response to receiving the challenge value;</claim-text>
<claim-text>evaluate a key derivation function to produce a key derivation key based on the secret key;</claim-text>
<claim-text>evaluate the key derivation function to produce an output value based on the key derivation key;</claim-text>
<claim-text>obtain a response value and a session key based on the output value;</claim-text>
<claim-text>transmit the response value to the wireless network operator system;</claim-text></claim-text>
<claim-text>access a sequence value previously stored on the mobile device;<br/>
obtain a message authentication code based on the secret key and the sequence value; and</claim-text>
<claim-text>generate a mobile device authentication token based on the message authentication code and the sequence value; wherein the key derivation function is based on a hash function.</claim-text></claim-text></claim></claims><drawings mxw-id="PDW16666955" load-source="patent-office"><!-- EPO <DP n="43"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="150" he="219" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="44"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="162" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="45"> --><figure id="f0003" num="3A"><img id="if0003" file="imgf0003.tif" wi="165" he="181" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="46"> --><figure id="f0004" num="3B"><img id="if0004" file="imgf0004.tif" wi="165" he="187" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="47"> --><figure id="f0005" num="4A"><img id="if0005" file="imgf0005.tif" wi="165" he="204" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="48"> --><figure id="f0006" num="4B"><img id="if0006" file="imgf0006.tif" wi="165" he="199" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="49"> --><figure id="f0007" num="5A"><img id="if0007" file="imgf0007.tif" wi="165" he="182" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="50"> --><figure id="f0008" num="5B"><img id="if0008" file="imgf0008.tif" wi="165" he="175" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="51"> --><figure id="f0009" num="5C"><img id="if0009" file="imgf0009.tif" wi="165" he="182" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="52"> --><figure id="f0010" num="5D"><img id="if0010" file="imgf0010.tif" wi="165" he="182" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="53"> --><figure id="f0011" num="5E"><img id="if0011" file="imgf0011.tif" wi="165" he="189" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="54"> --><figure id="f0012" num="6A"><img id="if0012" file="imgf0012.tif" wi="165" he="220" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="55"> --><figure id="f0013" num="6B"><img id="if0013" file="imgf0013.tif" wi="165" he="200" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="56"> --><figure id="f0014" num="6C"><img id="if0014" file="imgf0014.tif" wi="165" he="161" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="57"> --><figure id="f0015" num="6D"><img id="if0015" file="imgf0015.tif" wi="165" he="208" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="162" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="161" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
