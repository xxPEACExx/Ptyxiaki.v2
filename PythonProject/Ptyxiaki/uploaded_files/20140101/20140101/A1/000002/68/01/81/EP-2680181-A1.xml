<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2680181-A1" country="EP" doc-number="2680181" kind="A1" date="20140101" family-id="46545708" file-reference-id="298574" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146549449" ucid="EP-2680181-A1"><document-id><country>EP</country><doc-number>2680181</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12305783-A" is-representative="YES"><document-id mxw-id="PAPP154823372" load-source="docdb" format="epo"><country>EP</country><doc-number>12305783</doc-number><kind>A</kind><date>20120629</date><lang>EN</lang></document-id><document-id mxw-id="PAPP184034242" load-source="docdb" format="original"><country>EP</country><doc-number>12305783.8</doc-number><date>20120629</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140454420" ucid="EP-12305783-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>12305783</doc-number><kind>A</kind><date>20120629</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988121021" load-source="docdb">G06F  21/00        20130101AFI20121128BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1687189769" load-source="docdb" scheme="CPC">H04W   4/70        20180201 LA20180219BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1846796924" load-source="docdb" scheme="CPC">H04W  12/08        20130101 LI20170213BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988921205" load-source="docdb" scheme="CPC">G06F  21/53        20130101 FI20140103BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132180831" lang="DE" load-source="patent-office">System und Verfahren zur sicheren Erzeugung und Steuerung des Zugriffs auf einen virtualisierten Speicher</invention-title><invention-title mxw-id="PT132180832" lang="EN" load-source="patent-office">System and method of securely creating and controlling access to a virtualised space</invention-title><invention-title mxw-id="PT132180833" lang="FR" load-source="patent-office">Système et procédé permettant de créer de manière sécurisée et de commander l'accès à un espace virtualisé</invention-title><citations><patent-citations><patcit mxw-id="PCIT242652482" load-source="docdb" ucid="EP-1818833-A1"><document-id format="epo"><country>EP</country><doc-number>1818833</doc-number><kind>A1</kind><date>20070815</date></document-id><sources><source name="SEA" category="I" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT378320930" load-source="docdb" ucid="US-20090204964-A1"><document-id format="epo"><country>US</country><doc-number>20090204964</doc-number><kind>A1</kind><date>20090813</date></document-id><sources><source name="SEA" category="XI" created-by-npl="N"/></sources></patcit></patent-citations><non-patent-citations><nplcit><text>GARFINKEL T: "Terra: a virtual machine-based platform for trusted computing", ACM SOSP. PROCEEDINGS OF THE ACM SYMPOSIUM ON OPERATING SYSTEMSPRINCIPLES; 20031019, 22 October 2003 (2003-10-22), pages 193 - 206, XP002340992</text><sources><source mxw-id="PNPL70139470" load-source="docdb" name="SEA" category="A"/></sources></nplcit><nplcit><text>None</text><sources><source mxw-id="PNPL45131077" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>SCOTT T A: "HOW TO PLAY OUTSIDE THE JAVA SANDBOX", JOURNAL OF COMPUTING IN SMALL COLLEGES, XX, US, vol. 15, no. 1, 1 November 1999 (1999-11-01), pages 114 - 125, XP008002962</text><sources><source mxw-id="PNPL70139471" load-source="docdb" name="SEA" category="A"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR918150333" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ORANGE</last-name><address><country>FR</country></address></addressbook></applicant><applicant mxw-id="PPAR918172117" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>ORANGE</last-name></addressbook></applicant><applicant mxw-id="PPAR918988178" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Orange</last-name><iid>101394618</iid><address><street>78, rue Olivier de Serres</street><city>75015 Paris</city><country>FR</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918169801" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>AHMAD ZAHEER</last-name><address><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR918143697" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>AHMAD, ZAHEER</last-name></addressbook></inventor><inventor mxw-id="PPAR918988619" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>AHMAD, ZAHEER</last-name><address><street>29 Old Manor Road Southal</street><city>UB2 5JN London</city><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR918141976" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>DONG SONG</last-name><address><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR918152430" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>DONG, Song</last-name></addressbook></inventor><inventor mxw-id="PPAR918992041" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>DONG, Song</last-name><address><street>15 Mead Close</street><city>Surrey, TW20 8JA Egham</city><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR918132581" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>WARY JEAN-PHILIPPE</last-name><address><country>GB</country></address></addressbook></inventor><inventor mxw-id="PPAR918168668" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>WARY, JEAN-PHILIPPE</last-name></addressbook></inventor><inventor mxw-id="PPAR918982312" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>WARY, JEAN-PHILIPPE</last-name><address><street>29 Old Manor Road Southal</street><city>UB2 5JN London</city><country>GB</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918991958" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Cabinet Plasseraud</last-name><iid>100784233</iid><address><street>52, rue de la Victoire</street><city>75440 Paris Cedex 09</city><country>FR</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS548895075" load-source="docdb">AL</country><country mxw-id="DS548804872" load-source="docdb">AT</country><country mxw-id="DS548895077" load-source="docdb">BE</country><country mxw-id="DS548865890" load-source="docdb">BG</country><country mxw-id="DS548863148" load-source="docdb">CH</country><country mxw-id="DS548869681" load-source="docdb">CY</country><country mxw-id="DS548804873" load-source="docdb">CZ</country><country mxw-id="DS548895150" load-source="docdb">DE</country><country mxw-id="DS548869682" load-source="docdb">DK</country><country mxw-id="DS548869683" load-source="docdb">EE</country><country mxw-id="DS548842077" load-source="docdb">ES</country><country mxw-id="DS548865891" load-source="docdb">FI</country><country mxw-id="DS548865892" load-source="docdb">FR</country><country mxw-id="DS548895151" load-source="docdb">GB</country><country mxw-id="DS548869684" load-source="docdb">GR</country><country mxw-id="DS548895152" load-source="docdb">HR</country><country mxw-id="DS548804878" load-source="docdb">HU</country><country mxw-id="DS548863149" load-source="docdb">IE</country><country mxw-id="DS548869685" load-source="docdb">IS</country><country mxw-id="DS548865893" load-source="docdb">IT</country><country mxw-id="DS548869686" load-source="docdb">LI</country><country mxw-id="DS548805016" load-source="docdb">LT</country><country mxw-id="DS548804879" load-source="docdb">LU</country><country mxw-id="DS548805017" load-source="docdb">LV</country><country mxw-id="DS548805018" load-source="docdb">MC</country><country mxw-id="DS548881101" load-source="docdb">MK</country><country mxw-id="DS548881102" load-source="docdb">MT</country><country mxw-id="DS548804880" load-source="docdb">NL</country><country mxw-id="DS548842078" load-source="docdb">NO</country><country mxw-id="DS548863150" load-source="docdb">PL</country><country mxw-id="DS548805020" load-source="docdb">PT</country><country mxw-id="DS548804881" load-source="docdb">RO</country><country mxw-id="DS548805021" load-source="docdb">RS</country><country mxw-id="DS548863151" load-source="docdb">SE</country><country mxw-id="DS548805026" load-source="docdb">SI</country><country mxw-id="DS548842079" load-source="docdb">SK</country><country mxw-id="DS548863152" load-source="docdb">SM</country><country mxw-id="DS548881103" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128670118" lang="EN" load-source="patent-office"><p id="pa01" num="0001">A method of managing communication between a third party and a virtual space is described. The virtual space is located in an area of memory of a device. The method includes the steps of receiving, in an un-trusted area of memory, a request to access the virtual space from the third party and determining whether a security policy exists for the request. If a security policy exists for the request and the third party is an authorized source of requests for the virtual space, granting the third party access to the virtual space. If a security policy does not exist for the request, sending the request to a unique virtual space controller in a trusted area of memory, the unique virtual space controller being uniquely associated with the virtual space and processing the request in the unique virtual space controller.
<img id="iaf01" file="imgaf001.tif" wi="125" he="103" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128499491" lang="EN" source="EPO" load-source="docdb"><p>A method of managing communication between a third party and a virtual space is described. The virtual space is located in an area of memory of a device. The method includes the steps of receiving, in an un-trusted area of memory, a request to access the virtual space from the third party and determining whether a security policy exists for the request. If a security policy exists for the request and the third party is an authorized source of requests for the virtual space, granting the third party access to the virtual space. If a security policy does not exist for the request, sending the request to a unique virtual space controller in a trusted area of memory, the unique virtual space controller being uniquely associated with the virtual space and processing the request in the unique virtual space controller.</p></abstract><description mxw-id="PDES63955548" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><p id="p0001" num="0001">The present invention relates to the field of embedded system virtualization. More specifically, the present invention relates to a system and method of securely creating and controlling access to a virtualised space.</p><p id="p0002" num="0002">In the legacy fixed computing world, a user is allowed to install various third party applications running on an open operating system. Security issues, such as viruses, spyware exploiting applications and/or "OS" (for "Operating System") vulnerabilities have appeared, because user devices are usually equipped with IP connectivity and can be connected to the Internet. Because of this, on one side, the user is faced with malwares and on the other side, third party service providers that have to deliver a service onto the user's device over the internet are concerned with the assurance to operate a safe service for their customers. The same problems occurred in the domain of Machine-to-Machine ("M2M") and Internet Of Things (IOT), with more constraints, as in this latter case an equipment could operate without any human interaction for a long period of time.</p><p id="p0003" num="0003">Similarly, in the mobile computing world, hand-held devices are no longer simple device for making telephone calls, but are rather powerful communication and entertainment computing platforms for multimedia players, web surfing, social networking, GPS navigation and electronic financial transactions. This usage is boosted by various application stores that allow third party applications to be downloaded and installed easily onto the device. Unfortunately, this rich range of applications also leads to the potential installation of malicious applications that brings security concerns such as unauthorized access to personal data, geo-location information about the user, fraudulent usage of premium services, etc.</p><p id="p0004" num="0004">For both fixed and mobile computing worlds, solutions addressing these security issues exist. A first known solution is proposed on an application level: anti-virus for fixed and mobile devices; firewalls to enforce access and flow policy; sandboxing mechanism in web browsers to run Java applets; specific permission model to enforce access control to critical resources. A second known solution is based on dedicated hardware, such as Security Digital card, Trusted Platform Module (or "TPM") for<!-- EPO <DP n="2"> --> cryptographic operations and key storage. And a third solution uses hypervisors to isolate third party applications in virtual machines running on the same physical hardware.</p><p id="p0005" num="0005">Typically, access control and virtualisation of hardware is performed by what is known as a "hypervisor" (also known as a Monitor or a Virtual Machine Manager, or a "VMM"). By using such an entity, several virtual spaces can be created under the control of a hypervisor inside a device. In accordance with these types of schemes, a user who owns a plurality of devices such as set-top-box, mobile handset, laptop, or "smart appliance" like networked refrigerator, is able to apply such schemes on each of his/her devices</p><p id="p0006" num="0006">Known hypervisors in such devices create virtual spaces mainly for isolation purposes. Applications running in one virtual space cannot directly access the data in memory areas dedicated to other virtual spaces. Any communication between an application in one virtual space and an application in another virtual space is facilitated by the hypervisor. This functionality is obtained by trapping instructions and using specific protocols to communicate between the virtual spaces. Although hypervisors can provide some level of software-based isolation to processes and data, the information in a virtual space and/or the information in other areas of the device hosting the virtual space can still be compromised by rogue programs since this solution is completely software-oriented. Thus, the difficulty is to give the assurance of a safe delivery of services to third parties and to the user who owns the device.</p><p id="p0007" num="0007">In order to try to remedy this deficiency, other types of isolation have been developed, which types include hardware assisted techniques in which a portion of memory is defined as being "trusted". Once memory locations are defined as trusted, only trusted applications can get access to them in order to create a TEE (Trusted Execution Environment). An example of such a system is TrustZone<sup>™</sup>, in which an extra address bit is used to distinguish between two "worlds", named "normal world" and "secure world".</p><p id="p0008" num="0008">As opposed to the software isolation of virtual spaces created by a hypervisor, trusted memory is hardware protected and is controlled by dedicated monitoring software known as a "monitor". The processes and data that need high levels of security are<!-- EPO <DP n="3"> --> processed and stored in the TrustZone<sup>™</sup> secure world. After the completion of the TEE process, the monitor switches back to the normal world.</p><p id="p0009" num="0009">Whilst the security created by the establishment of a TEE is considered higher than the security provided by the hypervisor, the size of the trusted memory space is often limited in embedded devices and only part of a process that needs critical levels of security can therefore be processed in the trusted memory. Moreover, the price of such a solution limits its use in embedded devices. Thus, today, existing software based solutions are prone to attacks and TPM or TEE based solutions have limited space to host third party applications.</p><p id="p0010" num="0010">Accordingly, there is currently no technical solution to the problem of allocating remotely the capability of creation, allocation and management of virtual spaces for third party usages in embedded devices with critical levels of security and isolation by simultaneously giving trust to the user of the device and to the third party regarding the safety execution environment of its delivery service.</p><p id="p0011" num="0011">In order to solve the problems associated with the prior art, the present invention provides a method of managing communication between a third party and a virtual space, the virtual space being located in an area of memory of a device, the method comprising: receiving, in an un-trusted area of memory, a request to access the virtual space from the third party; determining whether a security policy exists for the request; if a security policy exists for the request and the third party is an authorized source of requests for the virtual space, granting the third party access to the virtual space; if a security policy does not exist for the request: sending the request to a unique virtual space controller in a trusted area of memory, the unique virtual space controller being uniquely associated with the virtual space; and processing the request in the unique virtual space controller.</p><p id="p0012" num="0012">Preferably, the access to the virtual space comprises at least one of reading data from the virtual space, writing data to the virtual space and executing an application in the virtual space.</p><p id="p0013" num="0013">Preferably, the method further comprises the step of updating the security policies as a result of a request from a third party.<!-- EPO <DP n="4"> --></p><p id="p0014" num="0014">Preferably, the method further comprises: keeping an identification table comprising information relating to the third party, the virtual space and the unique virtual space controller.</p><p id="p0015" num="0015">Preferably, the method further comprises the steps of: receiving a request to create a virtual space in a target device; authenticating the entity that generated the request to create a virtual space; if the entity that generated the request is authorized to create a virtual space in the target device, verifying the availability of resources on the target device; if resources are available on the target device, sending the request to the hypervisor of the target device and creating a virtual space in an un-trusted area of the target device.</p><p id="p0016" num="0016">Preferably, the method further comprises the steps of: providing an indication to the third party of the unavailability of resources if insufficient resources are available on the target device.</p><p id="p0017" num="0017">Preferably, the method further comprises the steps of: receiving a request to delete a virtual space in a target device; authenticating the entity that generated the request to delete a virtual space; if the entity that generated the request is authorized to delete a virtual space in the target device, sending the request to the hypervisor of the target device; deleting a virtual space in an un-trusted area of the target device.</p><p id="p0018" num="0018">The present invention also provides a computer program product for a data-processing device, the computer program product comprising a set of instructions which, when loaded into the data-processing device, causes the device to perform the steps of the above method.</p><p id="p0019" num="0019">The present invention also provides a unique virtual space controller for managing communication between a third party and a virtual space, the unique virtual space controller being uniquely associated with the virtual space, the virtual space being located in an area of memory of a device, the virtual space controller comprises processing means arranged to: control a hypervisor to receive, in an un-trusted area of memory, a request to access the virtual space from the third party; control a hypervisor to determine whether a security policy exists for the request; if a security policy exists for<!-- EPO <DP n="5"> --> the request and the third party is an authorized source of requests for the virtual space, controlling a hypervisor to grant the third party access to the virtual space; and if a security policy does not exist for the request: trapping the request and performing further authentification of the request.</p><p id="p0020" num="0020">Preferably, the unique virtual space controller can be downloaded from a telecommunications network and installed in a trusted area of a mobile communication device.</p><p id="p0021" num="0021">Preferably, the integrity of the unique virtual space controller is verified using cryptographic signature primitives.</p><p id="p0022" num="0022">As will be appreciated by the skilled reader, the present invention provides several advantages over the prior art. For example, the present invention provides for the dynamic creation and management of Virtual Spaces, whereas prior art hypervisors simply create Virtual Spaces at startup. Moreover, the present invention provides increased flexibility and granularity of the management of Virtual Spaces, in that it allows users to determine how applications are run (or which applications are allowed) and in particular the present invention allows the application of a specific Third Party's Security Policy to each Virtual Space and or hosted applications in those virtual spaces.</p><p id="p0023" num="0023">In accordance with the present invention, all input-output requests to the virtualized area are potentially subject to the control and authorization of a management entity which is outside of the hypervisor. This outsourcing permits the strict allocation of the Virtual Space security to the control of a specific third party, while simultaneously managing several Virtual Spaces allocated to many third parties.</p><p id="p0024" num="0024">Furthermore, in current systems, virtualization of a device is merely controlled locally without end-to-end proof of security. In particular, using prior art devices, it is not possible to dedicate a Virtual Space of a device to a specific third party autonomously and with a level of the security tailored to that third party. Dissimilarly, the Dual Virtual Space Controller of the Virtual Space enforces the security policies which are necessary to protect the integrity of the Virtual Space and its contents. The proposed framework facilitates third party applications to be installed securely in a dedicated slave VS controlled by the master application in TEE with correct level of security.<!-- EPO <DP n="6"> --></p><p id="p0025" num="0025">Moreover, in some examples, if a user has several devices capable of creating trusted and un-trusted memory spaces, it is possible to connect these devices securely with one another to create a virtual private network (VPN). An advantage of the present invention is that several virtual spaces connected through this VPN are available both locally and remotely, the routing function of this VPN is assumed by the Master Controller service and the controls of exchanged flow inside this VPN are done by DVSC services. Each virtual space can be allocated to a third party by the user so that a third party program can run in the dedicated Virtual Space and potentially been in communication with other Virtual Space owned by other third party.</p><p id="p0026" num="0026">Another advantage of the present invention is that it allows the TP to directly manage a dedicated security policy for every VS it has enslaved/ controlled, i.e. on every device. This provides flexibility to implement in every location or device, or for every couple (VS, DVSC) its own specific and chosen security policy which is more detailed and precise than the fleet security management provided by known systems.</p><p id="p0027" num="0027">Furthermore, the system of the present invention can help to implement new M2M services in trusted environment under control of the owner of the M2M devices. The proposed invention facilitates TP identification of a VS and its owner quickly, as the notion of trusted VS and related end-to-end (e2e) service link is readily available. So the TP can securely run its services in the desired location of the user network.</p><p id="p0028" num="0028">Other advantages and benefits of the present invention will become apparent from a consideration of the following description and accompanying drawings, in which:
<ul><li><figref idrefs="f0001">FIGURE 1</figref> is high-level diagram of a network which can be used in accordance with an embodiment of the present invention;</li><li><figref idrefs="f0002">FIGURE 2</figref> is high-level diagram of a scheme to allow third parties to access VS in a user's network in accordance with an embodiment of the present invention;</li><li><figref idrefs="f0003">FIGURE 3</figref> is flow chart representing a method of allocating a VS to a third party;</li><li><figref idrefs="f0004">FIGURE 4</figref> is a schematic illustration of the use of a USIM by a MC to provide the identity of the user to a Third Party;</li><li><figref idrefs="f0005">FIGURE 5</figref> is a high-level functional diagram of the operation of a Dual Virtual Space Controller;<!-- EPO <DP n="7"> --></li><li><figref idrefs="f0006">FIGURE 6</figref> is a flow chart representing a method of creating a slave VS in an un-trusted area by the DVSC located in a trusted area; and</li><li><figref idrefs="f0007">FIGURE 7</figref> is a flow chart representing a method of transferring a security query related to protected slave VS to a DVSC.</li></ul></p><p id="p0029" num="0029">In the present disclosure, the term virtual space (VS) is defined as an isolated area in an area of a memory of a device. A virtual space can be created by known virtualization techniques such as a hypervisor. In this description, we associate the notion of virtual space with the underlying system in charge of the virtualization technique. For instance, the virtual space corresponds to the set of components comprising the hypervisor which managed the virtualized space, and the virtualized space itself, it means that the global notion of virtual space comprises the operating system which allows communication outside of the virtual space itself. The term dual virtual space controller (DVSC) is defined herein as a trustable application stored in some area of the device memory. In the present disclosure, the terms dual virtual space controller and virtual space controller signify the same device, the usage of the word dual is used to reinforce the unique link between a virtual space and its corresponding dual (as unique) virtual space controller. This area is considered as trusted by the user who owns the device or by an operator of the global service; moreover a third party may recognize the trusted status of this area. Nowadays, several equipments are considered to be trusted, e.g. smartcard, "HSM" (for "Hardware Secure Module"), "TPM" (for "Trusted Platform Module"), "SOC" (for "Security Operating Center", which form a set of systems dedicated to security management, System on Chip and the dedicated computer of the user who considers it as trusted. The dual virtual space controller is provided to control the virtual space in an area of the memory of the device. In this description, the notion of dual space controller is associated with the means necessary to allow the dual virtual space controller to communicate outside of the dual virtual space controller component itself.</p><p id="p0030" num="0030">A user's devices network is a network comprising several devices owned or operated by the user, which network is managed by the user itself.</p><p id="p0031" num="0031">The term master controller (MC) is defined herein as a trustable application which acts as a security gateway to facilitate the allocation of dual virtual space controllers and<!-- EPO <DP n="8"> --> virtual spaces to third parties outside of the user's device network. This master controller is considered as trusted by the user or by the operator of the global service, and a third party may recognize the trusted status of this application. An embedded hypervisor is defined herein as a software layer specifically designed to virtualize part of an embedded device. Such embedded devices can include, but are not limited to, laptops, communication modules, mobile handsets or set-top boxes and connected equipments. A "Trusted Execution Environment" ("TEE") is defined herein as a hardware-assisted security framework standardized within Global Platform. It is a separate execution environment that runs alongside a Rich Operating System and provides security services to that Rich Operating System Environment. The Rich Operating System is defined herein as an operating system environment with a rich capability set. This environment allows a user to download and run applications. The Trusted Operating System is defined herein as an operating system running in the TEE. It provides the TEE Internal API (for "Application Programming Interface") to trusted applications and a proprietary method to enable the TEE client API software interface from other execution environment.</p><p id="p0032" num="0032">Third party (TP) is a general term used by those skilled in the art of information technology for identifying a person or an entity which does not own the user's or operator's network, system or device, but which can access a primary user's or operator's network, system or device with permission from that primary user or operator and/or from the network, system or device themselves to deliver services or contents. The third party is generally, but is not limited to, represented by the client application installed from an application store in an equipment of the user or operator. More generally, a third party is running its own infrastructure of networks and servers in order to be able to deliver, bill, charge the requested content or service to a consumer over operator's networks and services.</p><p id="p0033" num="0033"><figref idrefs="f0001">Figure 1</figref> shows a high-level diagram of a private network 100 which can be used in accordance with an embodiment of the present invention. As can be seen in <figref idrefs="f0001">Figure 1</figref>, a third party 120 is outside of the private network 100. The private network 100 consist of user's devices that may or may not have trusted memory, such as a laptop 103 with an hypervisor (the hypervisor is not represented on <figref idrefs="f0001">figure 1</figref>), a secure element 104 connected to a USB port of the laptop, a smart appliances with embedded secure element<!-- EPO <DP n="9"> --> such as a smart fridge 105, a set-top box 102 with a trusted area ("t.a." on <figref idrefs="f0001">figure 1</figref>) and a handset 101 with a trusted area. The invention is not limited to such a private network.</p><p id="p0034" num="0034">Using the framework of the invention described herein, a master controller 110 can be implemented in a trusted device area, such as the trusted area of the set-top box 102. The master controller 110 handles the requests from third party 120 requesting for allocation of virtual spaces in any of the device in the private user's network 100. The master controller 110 receives the requests 121 and 122 for virtual space allocation from the third party 120. Then, the master controller 110 determines for each request which dual virtual space controller can handle the virtual space allocation in the case where the virtual space already exists. In the other case, the master controller 110 determines which dual virtual space controller can handle the Virtual Space creation and allocation.</p><p id="p0035" num="0035">Virtual Spaces can be created in a memory area on any device of the private network 100, and some devices, such as handset 101, set-top-box 102 and laptop 103 can host several different virtual spaces. Virtual spaces and the associated dual virtual space controllers can be located in the same device or in different devices. In some implementation, the master controller and the dual virtual space controller are co-localized together in the same device. In this case, a unique application implementing the master controller function and the dual virtual space controller function can execute both functions. In <figref idrefs="f0001">Figure 1</figref>, the virtual space 113 is under the control of the dual virtual space controller 111 and both are located in the same handset 101. The virtual space 114 located in the set-top box 102 is under the control of the dual virtual space controller 112 located in the secure element 104 connected to the laptop 103.</p><p id="p0036" num="0036">With reference to <figref idrefs="f0002 f0003 f0004 f0005">Figures 2 to 5</figref>, the operation of the master controller (MC) will now be described. <figref idrefs="f0002">Figure 2</figref> is a high-level diagram of a scheme that displays an example illustrating several virtual space/dual virtual space controller/third party associations at a given point in time: the master controller MC has previously received allocation requests for association of virtual space VS2 with dual virtual space controller DVSC2 for third party TP3, virtual space VS1 with dual virtual space controller DVSC1 for third party TP2, virtual space VS3 with dual virtual space controller DVSC3 for third party TP1, and we notice that the existing association between virtual space VS4 and dual virtual space<!-- EPO <DP n="10"> --> controller DVSC4 is no more related to a dedicated third party. It means that the virtual space VS4 could be available for a new incoming allocation request from a third party.</p><p id="p0037" num="0037">In one embodiment of the invention, a function of the master controller is to route information between the dual virtual space controller of one device and the virtual space of other device in a "VPN" (for "Virtual Private Network") of user-connected devices. In another embodiment of the invention, the dual virtual space controller reroutes information from the virtual space to the master controller. Other functions of the master controller are:
<ul><li>to route information between a dual virtual space controller and its associated virtual space;</li><li>to allocate a specific dual virtual space controller to a specific third party;</li><li>to check the identity of a third party, and optionally validate de legitimacy of the request received from the third party;</li><li>to keep updated records of associations between at least the third party, associated dual virtual space controller and corresponding virtual space;</li><li>in some embodiments, to provide an indication of the identity of the user and/or the devices and/or the involved third parties to the user or the third parties.</li></ul></p><p id="p0038" num="0038">The master controller MC is installed in a trusted area of a device, as shown in <figref idrefs="f0002">Figure 2</figref>. The master controller MC can be downloaded either at the same time as the dual virtual space controller DVSC1 to DVSC4 application, or separately. There can be one master controller MC or multiple master controllers in one network of connected devices. Modules in the master controller MC include at least routing tables, and optionally others information such as security policies of secure elements, database of the existing virtual spaces, operation status of the connected devices in the network. The main function of the master controller MC is to provide the secure routing information to the third party, so that right virtual space can be reached by the third party. After the master controller MC allocates a dual virtual space controller to a third party, the third party can communicate directly with the virtual space under the control of the dual virtual space controller. In particular, the access to the virtual space is controlled by the enforcement of a security policy decided by the third party. The dual virtual space<!-- EPO <DP n="11"> --> controller is then responsible for the monitoring of activities inside the virtual space and reporting those activities to the related secured operating system.</p><p id="p0039" num="0039"><figref idrefs="f0003">Figure 3</figref> shows exemplary illustration of the steps that may be executed by the master controller MC when an allocation request is received from a third party TP. In an embodiment, at step 401, a third party sends an allocation request to a user to allocate to it a virtual space in one of the devices in the user's network. This request is sent to a user's device which hosts the master controller. The request can specify constraints related to the device which will host the requested virtual space or constraints related to the Virtual Space to be allocated. For example, a constraint on device can consist of characteristics of the device: available size in memory, device capability such as a device with a screen, device type such as a TV, or mobile phone, or connected equipment, or laptop, or domestic device etc., description of the foreseen usage of the virtual space, device address, etc. For example, constraints on a virtual space can consist of the following characteristics: needed memory size for the virtual space, type of the device, address of the device in the network, usage profile, duration of the usage, etc. At step 402, the master controller checks the authentication of the request, i.e. it authenticates the third party. For instance, the third party provides an identity proof by supplying a certificate. Optionally, the master controller validates the legitimacy of the request sent by the third party. For instance, the master controller checks if the authenticated third party is allowed to request a creation of a virtual space on a specific device, or a device of a specific type. It also analyses constraints provided in the request, if any. If a device address is specified, the master controller extracts the address of the target device from the request. If the request is not from an authorized third party or if the target device is not the authorized device for the requested third party, the request is rejected in step 409 and a rejection message could be sent back to the third party.</p><p id="p0040" num="0040">In an embodiment, the master controller can also challenge the identity of the third party. In this case, the master controller can check a database it owns in order to find if a trusted identity record associated to the third party is available.</p><p id="p0041" num="0041">After the master controller grants authorization of the third party allocation request, the master controller checks at step 403 a table it owns, called MC table. MC table memorizes associations between a third party, device information, a dual virtual<!-- EPO <DP n="12"> --> space controller, a virtual space, and a security policy. Such an association is noted (TP &lt;&gt; device_info &lt;&gt; DVSC &lt;&gt; VS &lt;&gt; SecurityLevelPolicy). It also determines whether any dual virtual space controller are available for allocation. If a dual virtual space controller is already available to be allocated to the third party, the master controller allocates the dual virtual space controller to the third party at step 404. In step 405, the master controller checks its table of dual virtual space controller records whether a virtual space is available and already associated to the dual virtual space controller. If a virtual space is available, it is allocated to the third party in step 406. Then the master controller updates its table in step 407. Finally, in step 408, the master controller informs the third party of success of a virtual space allocation and provides the third party with details to reach directly the allocated virtual space and dual virtual space controller.</p><p id="p0042" num="0042">The master controller allows also to keep information that a security policy is associated to a virtual space. This information is stored in the MC table in a "SecurityLevelPolicy" field. A default SecurityLevelPolicy can be set by the master controller at the end of the virtual space allocation procedure. This SecurityLevelPolicy is translated into security rules and stored in the dual virtual space controller. During the allocated virtual space usage, the third party can modify the security level policy either by sending a request to the Master Controller which can relay the request to the corresponding dual virtual space controller or by updating the security rules in the corresponding dual virtual space controller provided that the master controller allows the third party to access directly the dual virtual space controller. In the latter case, the dual virtual space controller updates the master controller with the modified security level policy.</p><p id="p0043" num="0043">If no dual virtual space controller is available during step 403, in step 410 whether the master controller rejects the request and sends back a rejection message to the third party, or the master controller requests to an external Trusted Service Manager (not shown) to create a dual virtual space controller in a dedicated trusted area.</p><p id="p0044" num="0044">If no virtual space exists and is available for allocation during step 405, in step 411, whether the master controller rejects the request and sends back a rejection message to the third party, or the master controller requests the allocated dual virtual space<!-- EPO <DP n="13"> --> controller to create a virtual space in a device taking into account all the constraints, if any provided in the initial request from the third party.</p><p id="p0045" num="0045">In one embodiment the master controller can be installed by default in the TEE component of a device in order to manage and securely route sensitive requests between installed secure elements or components in the device. For example, the master controller can manage the internal network comprising the TEE, an "USIM" (for "Universal Subscriber Identity Module") card and/or other devices, such as a microSD Card (for "micro Secure Digital Card").</p><p id="p0046" num="0046">The master controller can therefore allocate a virtual space to the third party and, through each respective dual virtual space controller, manage several virtual spaces allocated to many third parties. The table below is an example of a master controller relating to a situation of N virtualized zones enslaved to P external third parties.</p><p id="p0047" num="0047">N is the number of virtual spaces (for instance, seven) named VS1 to VS7, P is the number of third parties (for instance, five) named P1 to P5. In order to control N virtual spaces, N dual virtual space controllers (named DVSC1 to DVSC7) are required because of the uniqueness of the association between a virtual space and a dual virtual space controller, each of which will be stored in a trusted location. Thus, one example of a master controller mapping table is:
<tables id="tabl0001" num="0001"><table frame="all"><tgroup cols="3"><colspec colnum="1" colname="col1" colwidth="21mm"/><colspec colnum="2" colname="col2" colwidth="29mm"/><colspec colnum="3" colname="col3" colwidth="32mm"/><thead><row><entry align="center" valign="top"><b>VS identity</b></entry><entry align="center" valign="top"><b>DVSC identifier</b></entry><entry align="center" valign="top"><b>Third Party owner</b></entry></row></thead><tbody><row><entry align="center">VS1</entry><entry align="center">DVSC3</entry><entry align="center">P1</entry></row><row><entry align="center">VS2</entry><entry align="center">DVSC2</entry><entry align="center">P1</entry></row><row><entry align="center">VS3</entry><entry align="center">DVSC7</entry><entry align="center">P3</entry></row><row><entry align="center">VS4</entry><entry align="center">DVSC5</entry><entry align="center">P3</entry></row><row><entry align="center">VS5</entry><entry align="center">DVSC1</entry><entry align="center">P2</entry></row><row><entry align="center">VS6</entry><entry align="center">DVSC4</entry><entry align="center">P4</entry></row><row><entry align="center">VS7</entry><entry align="center">DVSC6</entry><entry align="center">P1</entry></row></tbody></tgroup></table></tables></p><p id="p0048" num="0048">In the above example, seven virtual spaces are dispatched over four different third parties. The seven virtual spaces are controlled by seven dual virtual space controllers, which can operate from any number up to seven different trusted areas. An important<!-- EPO <DP n="14"> --> feature of this above table is that every virtual space is controlled by a single associated dual virtual space controller. The third party P5 is not connected to any of the seven virtual spaces VS1 to VS7.</p><p id="p0049" num="0049"><figref idrefs="f0004">Figure 4</figref> shows a schematic illustration of how the master controller can use a USIM to provide the identity of a user to a third party. Identity information related to the owner of the device in which the third party is interested in getting a virtual space allocation can be stored in the master controller. The master controller knows that a specific USIM exists for this specific virtual space due to the content of its table MC Table which describes the device type of the device hosting the virtual space. In the same way, the master controller is able to provide information on the set of user's identities available for a third party. For instance, the master controller may know all the USIM information used in the user's network of devices of some family house: parents and children mobile phones. Again, the master controller is a trusted application that is stored in TEE, and only authorized entities can modify its identity details, such as network operator's identity.</p><p id="p0050" num="0050">In the process of <figref idrefs="f0004">Figure 4</figref>, a request is first sent from a third party wanting allocation of a virtual space in a user virtual network to the master controller of a user's device. Then, the master controller checks whether the third party is authorized by way of challenge authentication. Once authentication is completed, the master controller requests the identity of the user from the USIM. The USIM provides its identity record. It can also answer to an authentication challenge. Then, the master controller updates an internal record, if needed, and the identity proof of the user is provided to the third party. In one embodiment of the invention, the dual virtual space controller associated to each virtual space may control the legitimacy of those third party's request.</p><p id="p0051" num="0051"><figref idrefs="f0005">Figure 5</figref> shows the flow of information in some implementation based on the device Device 1, which is for instance a mobile phone, between normal OS and TEE for allocation of virtual space to third party. In step 1, via an application, the third party TP1 requests the creation of a virtual space prior to deliver the service. In step 2, the application uses the Rich Execution Environment API to communicate with the hypervisor and the creation request is sent to the hypervisor.<!-- EPO <DP n="15"> --></p><p id="p0052" num="0052">The hypervisor relays the creation request to the master controller MC which performs security controls, e.g, it authenticates the third party and requests authorization from the device owner, as shown in step 3. If authorization is granted, then the master controller MC allocates dual virtual space controller DVSC1 to third party TP1 and sends back an acknowledgement to the hypervisor as depicted in step 5. The dual virtual space controller DVSC1 then sends a request to the hypervisor to create the virtual space VS1 for the third party TP1. In step 6, upon successful creation of the virtual space VS1, the third party TP1 can access the allocated virtual space VS1 to deliver the service.</p><p id="p0053" num="0053">The proposed dual virtual space controller is an application that can be stored either in a secure element or in an isolated component of the trusted area of a device. The major role of dual virtual space controller application is to provide security for in and out access control service to the allocated dedicated virtual space. A secondary role of the dual virtual space controller can be to request the creation or the erasing/destruction of a given virtual space, as well as control, administration and management of the dedicated virtual space.</p><p id="p0054" num="0054">The dual virtual space controller monitors and manages the activities taking place in the dedicated virtual space. Such activities are related to security, control of contents and resources by the virtual space. The dual virtual space controller can delete the virtual space at any time and create other virtual space in any other location.</p><p id="p0055" num="0055">The dual virtual space controller uses pre-defined methods to check the integrity of a virtual space. In one example, a third party requests the use of a virtual space in a user device consisting of a rich operating system and a hypervisor. The device OS sends the request to the relevant hypervisor (if the VS is to be created in a remote device) through the master controller.</p><p id="p0056" num="0056">In one example, when an application or data in a dedicated virtual space seeks access to other memory locations outside the allocated space for the dedicated virtual space, the request must pass through the security policies controlled and defined by the dual virtual space controller inside the hypervisor. An example of such a scenario can be access to a website by the application inside the protected virtual space. In this case, the dual virtual space controller verifies the rights and security policy related to the data in the virtual space. This security policy is created at the time of the allocation of the virtual<!-- EPO <DP n="16"> --> space to third party and this policy is stored securely in the dual virtual space controller, in trusted area. Any modification in the security policies are under control of the dual virtual space controller.</p><p id="p0057" num="0057">If a process in a slave virtual space needs security critical movement, like transferring the rights of a video to a location outside the virtual space, the hypervisor forwards the request to the dual virtual space controller, where the authorization for the particular process is granted or denied. If granted, the dual virtual space controller informs the hypervisor about the authorization of the process, and then the security critical process can take place in the slave virtual space. In some embodiment, the control related to a specific file can be done through cooperation between the hypervisor of the virtual space and the operating system installed and running in this virtual space.</p><p id="p0058" num="0058">The hypervisor makes sure the contents in the slave virtual space are only visible to authorized entities. In one example, a third party application can run in a dedicated virtual space under the control of the dual virtual space controller. If an application outside the protected virtual space, i.e. virtual space enslaved by dual virtual space controller sends a request to gain access to the information inside the virtual space, the hypervisor traps the request, where the security policies are enforced by the controlling dual virtual space controller.</p><p id="p0059" num="0059">In an exemplary embodiment in accordance with the present invention, all the information, content and applications installed in a virtual space by a third party, under the control of dual virtual space controller associated, are stored encrypted in the memory of the equipment. The required content is decrypted on the fly based on need, either in full when the virtual space is mounted or initialized. This encryption can be realized under the direct control of the hypervisor or dual virtual space controller.</p><p id="p0060" num="0060">In some embodiment of the invention, the set of multiple Dual Virtual Space Controllers hosted in the network of user's devices could be implemented in such a way that a unique binary code of dual virtual space controller is implemented over a set of several dual virtual space controllers data. In this scheme, every allocated or created virtual space is associated to a unique instance of a dual virtual space controller data over a common dual virtual space controller binary.<!-- EPO <DP n="17"> --></p><p id="p0061" num="0061">The method used in the case of such a scenario is represented by the flow chart of <figref idrefs="f0007">Figure 7</figref>. In step 801, an incoming network connection tries to activate a previously installed application in the protected slave VS. A determination is made in step 802 as to whether or not the TP application is running in a dedicated VS which is managed by the DVSC. If this is found to be the case, the hypervisor traps the request in step 803.</p><p id="p0062" num="0062">In such a case, if the security policies related to the contents of VS are found in step 805, and the request is received from an authorized source (checked in step 808), then the access to the contents of the VS is granted to the requested application in step 810. If however the security policies are not found in the hypervisor or there is need of further identification, then the hypervisor sends the request to the master DVSC for further verification in step 807. If no further authentification is needed in step 809 (e.g. the application is known to be un-trusted), then access is denied in step 811.</p><p id="p0063" num="0063">The VS security policies can be updated by the owner of the device and any changes in the policies are subject to access control e.g. by pin or key. This monitoring of the contents of the VS by the DVSC enhances the security of the slave VS and the user (the owner of the VS) can safely allow third parties applications to securely run in the desired VS.</p><p id="p0064" num="0064">Because all the critical keys and certificates related to slave VS are stored in DVSC, the DVSC is always located in TEE belonging to same device or remote device. The main functions of the DVSC include identification of security keys for its slave VS and identification and authorization of the TP. The DVSC also facilitates the authorization of any request generated as a result of a security alert from the hypervisor. The DVSC also processes requests from rich OS applications to create new VS and deals with requests from slave VS, such as authorization to move data outside the VS space. The DVSC also deletes or limits the functionality of the slave VS and handles the cryptographic capabilities to be perform on the slave VS.</p><p id="p0065" num="0065">With reference to <figref idrefs="f0006">Figure 6</figref>, the methods of dynamically creating VS by a DVSC will now be described. As explained above, in the state of the art, embedded hypervisors are not designed to take instructions for dynamic creation of VS from outside their own environment, and then create VS according to the security policies of external<!-- EPO <DP n="18"> --> applications. In order to overcome this deficiency in the prior art, the DVSC will control the hypervisor in a particular way, as shown in <figref idrefs="f0006">Figure 6</figref>.</p><p id="p0066" num="0066">First, a message packet can be built by the DVSC application according to standard protocol handled by a TEE API (e.g. GlobalPlatform<sup>™</sup>). If the DVSC is in the trusted area of TEE device, the packet will travel through Monitor Controller MC to the standard TEE API and then will reach the hypervisor in step 701.</p><p id="p0067" num="0067">In step 702, the hypervisor analyses the message and in step 703 a determination is made as to whether or not the message is from a trusted control application. If the packet is in remote secure device (e.g. Secure Element SE) connected by a secure link, it will travel through the network to reach the hypervisor. The hypervisor, under control of the DVSC, parses the message header if the message is not from an external DVSC (e.g. specific bit pattern can be defined in the standard communication protocol handled by the hypervisor for communication), then the message is handed over to standard hypervisor modules to treat it as usual. If the message is not from a trusted control application, the message is handle normally (i.e. without interference from the hypervisor) in steps 704 and 705. If however the message is received in respect of a trusted application, a determination is made in step 706 as to whether the message relates to (or requires) the creation of a new VS.</p><p id="p0068" num="0068">If the message does not require the creation of a VS, the hypervisor extracts the identity of the slave VS from the message in step 708 and checks the Identification Table in order to authorize the VS. Since the message is from a trusted application and it is related to an already existing VS, the message is handed over to standard hypervisor modules to reach the desired VS, as shown in 710.</p><p id="p0069" num="0069">If however, in step 706, the message does require the creation of a VS, the authority of the requesting DVSC will be checked by the hypervisor (which contains the list of device addresses from where DVSC request can come and it can be updated by the user at any time) in step 707.</p><p id="p0070" num="0070">If the DVSC is not authorized (step 711), an indication of the rejection is generated and sent back to the DVSC (step 713).<!-- EPO <DP n="19"> --></p><p id="p0071" num="0071">If however the DVSC is authorized, the next step (step 712) is to check the available resources in the devices to support the creation of VS. This can be, for example, stored in a configuration file to accommodate recourse for dynamic creation of VS.</p><p id="p0072" num="0072">The availability of the resources is checked in step 714 and a determination is made in step 715 as to whether or not the resources are available. If the resources are not available, an indication of rejection is created and sent to the DVSC in step 716.</p><p id="p0073" num="0073">If however the resources are available, the hypervisor, under control of the DVSC continue with the creation of the VS. In step 717, at the time of creation of new VS, the DVSC sends the security policies in its message, for its newly enslaved VS.</p><p id="p0074" num="0074">In steps 718 and 719, the hypervisor uses the information (such as memory requirement, security policies (data in/out) etc) to create new VS.</p><p id="p0075" num="0075">After the creation of new VS by hypervisor according to the desired security policies, the message of successful creation of VS can be sent to DVSC and entries in the hypervisor.</p><p id="p0076" num="0076">The DVSC application inside the trusted area becomes the master and the VS is enslaved to the DVSC in such a way that user of the device (phone or PC) owns and manage the virtual space in the way they wish.</p><p id="p0077" num="0077">In an exemplary embodiment in accordance with the present invention, all the information, content and applications installed in a VS by a third party, under the control of DVSC associated, are stored encrypted in the memory of the equipment. The required content is decrypted on the fly based on need, either in full when the VS is mounted or initialized. This encryption can be realized under the direct control of the hypervisor or DVSC.</p><p id="p0078" num="0078">In the trusted area, the secure OS can create and manage isolated components. In such isolated component, the DVSC may be installed. In preferred embodiment, a security context (set of specific cryptographic keys and algorithms dedicated to some security services: authentication, confidentiality, integrity, non-repudiation etc, in the same way as the management of the privileges and access controls to Security Domain of a Global Platform smartcard) may be associated to the DVSC for its slave VS. Although it is not a requirement for implementation, a preferred embodiment would see at least one isolated component for hosting at least one instance of DVSC.<!-- EPO <DP n="20"> --></p><p id="p0079" num="0079">As will be appreciated, the present invention can also be embedded in a computer program, which comprises all the features enabling the implementation of the methods described herein, and which, when loaded in an information processing system, causes the information processing system to execute some or all of the above-mentioned steps.</p><p id="p0080" num="0080">Such a computer program can be stored on a computer or machine readable medium allowing data, instructions, messages or message packets, and other machine readable information to be read from the medium. The computer or machine readable medium may include non-volatile memory, such as ROM, Flash memory, Disk drive memory, CD-ROM, and other permanent storage.</p><p id="p0081" num="0081">Furthermore, the computer or machine readable medium may comprise computer or machine readable information in a transitory state medium such as a network link and/or a network interface, including a wired network or a wireless network, that allow a device to read such computer or machine readable information. The functionality of the elements shown in the attached figures can be provided using either dedicated hardware and/or software.</p><p id="p0082" num="0082">In some embodiment of the invention, the set of multiple Dual Virtual Space Controllers hosted in the network of user's devices can be implemented in such a way that a unique binary code of dual virtual space controller is implemented over a set of several dual virtual space controllers data. In this scheme, every allocated or created virtual space is associated to a unique instance of a dual virtual space controller data over a common dual virtual space controller binary.</p></description><claims mxw-id="PCLM56976466" lang="EN" load-source="patent-office"><!-- EPO <DP n="21"> --><claim id="c-en-0001" num="0001"><claim-text>A method of managing communication between a third party and a virtual space, the virtual space being located in an area of memory of a device, the method comprising:
<claim-text>receiving, in an un-trusted area of memory, a request to access the virtual space from the third party;</claim-text>
<claim-text>determining whether a security policy exists for the request;</claim-text>
<claim-text>if a security policy exists for the request and the third party is an authorized source of requests for the virtual space, granting the third party access to the virtual space;</claim-text>
<claim-text>if a security policy does not exist for the request:
<claim-text>sending the request to a unique virtual space controller in a trusted area of memory, the unique virtual space controller being uniquely associated with the virtual space; and</claim-text>
<claim-text>processing the request in the unique virtual space controller.</claim-text></claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>A method according to claim 1, wherein the access to the virtual space comprises at least one of reading data from the virtual space, writing data to the virtual space and executing an application in the virtual space.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>A method according to any of the preceding claims, the method further comprising the step of updating the security policies as a result of a request from a third party.</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>A method according to any of the preceding claims, the method further comprising:
<claim-text>keeping an identification table comprising information relating to the third party, the virtual space and the unique virtual space controller.</claim-text><!-- EPO <DP n="22"> --></claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>A method according to any of the preceding claims, the method further comprising the steps of:
<claim-text>receiving a request to create a virtual space in a target device;</claim-text>
<claim-text>authenticating the entity that generated the request to create a virtual space;</claim-text>
<claim-text>if the entity that generated the request is authorized to create a virtual space in the target device, verifying the availability of resources on the target device;</claim-text>
<claim-text>if resources are available on the target device, sending the request to the hypervisor of the target device and creating a virtual space in an un-trusted area of the target device.</claim-text></claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>A method according to claim 5, the method further comprising the steps of:
<claim-text>providing an indication to the third party of the unavailability of resources if insufficient resources are available on the target device.</claim-text></claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>A method according to any of the preceding claims, the method further comprising the steps of:
<claim-text>receiving a request to delete a virtual space in a target device;</claim-text>
<claim-text>authenticating the entity that generated the request to delete a virtual space;</claim-text>
<claim-text>if the entity that generated the request is authorized to delete a virtual space in the target device, sending the request to the hypervisor of the target device;</claim-text>
<claim-text>deleting a virtual space in an un-trusted area of the target device.</claim-text></claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>A computer program product for a data-processing device, the computer program product comprising a set of instructions which, when loaded into the data-processing device, causes the device to perform the steps of the method as claimed in the claims 1 to 7.</claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>A unique virtual space controller for managing communication between a third party and a virtual space, the unique virtual space controller being uniquely associated with the virtual space, the virtual space being located in an area of memory of a device, the virtual space controller comprising processing means arranged to:<!-- EPO <DP n="23"> -->
<claim-text>control a hypervisor to receive, in an un-trusted area of memory, a request to access the virtual space from the third party;</claim-text>
<claim-text>control a hypervisor to determine whether a security policy exists for the request;</claim-text>
<claim-text>if a security policy exists for the request and the third party is an authorized source of requests for the virtual space, controlling a hypervisor to grant the third party access to the virtual space; and</claim-text>
<claim-text>if a security policy does not exist for the request:
<claim-text>trapping the request and performing further authentification of the request.</claim-text></claim-text></claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>The unique virtual space controller of claim 9, wherein the unique virtual space controller can be downloaded from a telecommunications network and installed in a trusted area of a mobile communication device.</claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>The unique virtual space controller of claim 10, wherein the integrity of the unique virtual space controller is verified using cryptographic signature primitives.</claim-text></claim></claims><drawings mxw-id="PDW16667246" load-source="patent-office"><!-- EPO <DP n="24"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="165" he="157" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="25"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="165" he="194" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="26"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="165" he="229" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="27"> --><figure id="f0004" num="4"><img id="if0004" file="imgf0004.tif" wi="165" he="213" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="28"> --><figure id="f0005" num="5"><img id="if0005" file="imgf0005.tif" wi="165" he="154" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="29"> --><figure id="f0006" num="6"><img id="if0006" file="imgf0006.tif" wi="158" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="30"> --><figure id="f0007" num="7"><img id="if0007" file="imgf0007.tif" wi="140" he="216" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="155" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="157" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
