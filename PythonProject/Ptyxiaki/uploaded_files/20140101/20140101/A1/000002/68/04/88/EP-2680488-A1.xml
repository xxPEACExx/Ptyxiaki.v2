<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2680488-A1" country="EP" doc-number="2680488" kind="A1" date="20140101" family-id="46720272" file-reference-id="275025" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146549200" ucid="EP-2680488-A1"><document-id><country>EP</country><doc-number>2680488</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-11859252-A" is-representative="NO"><document-id mxw-id="PAPP154823123" load-source="docdb" format="epo"><country>EP</country><doc-number>11859252</doc-number><kind>A</kind><date>20110222</date><lang>JA</lang></document-id><document-id mxw-id="PAPP220439666" load-source="docdb" format="original"><country>EP</country><doc-number>11859252.6</doc-number><date>20110222</date><lang>JA</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140452489" ucid="JP-2011053797-W" linkage-type="A" load-source="docdb"><document-id format="epo"><country>JP</country><doc-number>2011053797</doc-number><kind>W</kind><date>20110222</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988096304" load-source="docdb">H04L   9/32        20060101AFI20120910BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1804366982" load-source="docdb" scheme="CPC">H04L2209/34        20130101 LA20170608BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988097756" load-source="docdb" scheme="CPC">H04L   9/3073      20130101 LI20131129BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988112822" load-source="docdb" scheme="CPC">H04L   9/32        20130101 FI20131121BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988116112" load-source="docdb" scheme="CPC">H04L   9/3231      20130101 LI20131219BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988116452" load-source="docdb" scheme="CPC">H04L   9/008       20130101 LI20131219BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132180084" lang="DE" load-source="patent-office">ÄHNLICHKEITSBERECHNUNGSSYSTEM, ÄHNLICHKEITSBERECHNUNGSVORRICHTUNG, COMPUTERPROGRAMM UND ÄHNLICHKEITSBERECHNUNGSVERFAHREN</invention-title><invention-title mxw-id="PT132180085" lang="EN" load-source="patent-office">SIMILARITY CALCULATION SYSTEM, SIMILARITY CALCULATION DEVICE, COMPUTER PROGRAM, AND SIMILARITY CALCULATION METHOD</invention-title><invention-title mxw-id="PT132180086" lang="FR" load-source="patent-office">SYSTÈME DE CALCUL DE SIMILITUDE, DISPOSITIF DE CALCUL DE SIMILITUDE, PROGRAMME INFORMATIQUE ET PROCÉDÉ DE CALCUL DE SIMILITUDE</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR918162188" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>MITSUBISHI ELECTRIC CORP</last-name><address><country>JP</country></address></addressbook></applicant><applicant mxw-id="PPAR918154153" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>MITSUBISHI ELECTRIC CORPORATION</last-name></addressbook></applicant><applicant mxw-id="PPAR918981128" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Mitsubishi Electric Corporation</last-name><iid>101157912</iid><address><street>7-3 Marunouchi 2-chome Chiyoda-ku</street><city>Tokyo 100-8310</city><country>JP</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918148012" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>HIRANO TAKATO</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918132267" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>HIRANO, Takato</last-name></addressbook></inventor><inventor mxw-id="PPAR918987743" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>HIRANO, Takato</last-name><address><street>c/o Mitsubishi Electric Corporation 7-3 Marunouchi 2-chome Chiyoda-ku</street><city>Tokyo 100-8310</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918150756" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>MATSUDA NORI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918170281" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>MATSUDA, NORI</last-name></addressbook></inventor><inventor mxw-id="PPAR918989804" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>MATSUDA, NORI</last-name><address><street>c/o Mitsubishi Electric Corporation 7-3 Marunouchi 2-chome Chiyoda-ku</street><city>Tokyo 100-8310</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918164191" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>ITO TAKASHI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918162667" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>ITO, TAKASHI</last-name></addressbook></inventor><inventor mxw-id="PPAR918986318" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>ITO, TAKASHI</last-name><address><street>c/o Mitsubishi Electric Corporation 7-3 Marunouchi 2-chome Chiyoda-ku</street><city>Tokyo 100-8310</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918166517" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>HATTORI MITSUHIRO</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918146770" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>HATTORI, MITSUHIRO</last-name></addressbook></inventor><inventor mxw-id="PPAR918984927" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>HATTORI, MITSUHIRO</last-name><address><street>c/o Mitsubishi Electric Corporation 7-3 Marunouchi 2-chome Chiyoda-ku</street><city>Tokyo 100-8310</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918160812" load-source="docdb" sequence="5" format="epo"><addressbook><last-name>MORI TAKUMI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918153905" load-source="docdb" sequence="5" format="intermediate"><addressbook><last-name>MORI, TAKUMI</last-name></addressbook></inventor><inventor mxw-id="PPAR918988691" load-source="patent-office" sequence="5" format="original"><addressbook><last-name>MORI, TAKUMI</last-name><address><street>c/o Mitsubishi Electric Corporation 7-3 Marunouchi 2-chome Chiyoda-ku</street><city>Tokyo 100-8310</city><country>JP</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918979456" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Pfenning, Meinig &amp; Partner GbR</last-name><iid>101244111</iid><address><street>Theresienhöhe 13</street><city>80339 München</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="JP-2011053797-W"><document-id><country>JP</country><doc-number>2011053797</doc-number><kind>W</kind><date>20110222</date><lang>JA</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012114452-A1"><document-id><country>WO</country><doc-number>2012114452</doc-number><kind>A1</kind><date>20120830</date><lang>JA</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS548848946" load-source="docdb">AL</country><country mxw-id="DS548871962" load-source="docdb">AT</country><country mxw-id="DS548848947" load-source="docdb">BE</country><country mxw-id="DS548837473" load-source="docdb">BG</country><country mxw-id="DS548848890" load-source="docdb">CH</country><country mxw-id="DS548854674" load-source="docdb">CY</country><country mxw-id="DS548854675" load-source="docdb">CZ</country><country mxw-id="DS548803304" load-source="docdb">DE</country><country mxw-id="DS548848948" load-source="docdb">DK</country><country mxw-id="DS548848949" load-source="docdb">EE</country><country mxw-id="DS548801859" load-source="docdb">ES</country><country mxw-id="DS548837474" load-source="docdb">FI</country><country mxw-id="DS548837475" load-source="docdb">FR</country><country mxw-id="DS548803305" load-source="docdb">GB</country><country mxw-id="DS548848950" load-source="docdb">GR</country><country mxw-id="DS548803310" load-source="docdb">HR</country><country mxw-id="DS548854676" load-source="docdb">HU</country><country mxw-id="DS548848891" load-source="docdb">IE</country><country mxw-id="DS548848951" load-source="docdb">IS</country><country mxw-id="DS548837476" load-source="docdb">IT</country><country mxw-id="DS548848952" load-source="docdb">LI</country><country mxw-id="DS548803311" load-source="docdb">LT</country><country mxw-id="DS548871963" load-source="docdb">LU</country><country mxw-id="DS548837477" load-source="docdb">LV</country><country mxw-id="DS548803312" load-source="docdb">MC</country><country mxw-id="DS548871964" load-source="docdb">MK</country><country mxw-id="DS548871965" load-source="docdb">MT</country><country mxw-id="DS548871966" load-source="docdb">NL</country><country mxw-id="DS548854677" load-source="docdb">NO</country><country mxw-id="DS548871967" load-source="docdb">PL</country><country mxw-id="DS548848953" load-source="docdb">PT</country><country mxw-id="DS548854607" load-source="docdb">RO</country><country mxw-id="DS548848954" load-source="docdb">RS</country><country mxw-id="DS548871968" load-source="docdb">SE</country><country mxw-id="DS548803313" load-source="docdb">SI</country><country mxw-id="DS548854678" load-source="docdb">SK</country><country mxw-id="DS548854679" load-source="docdb">SM</country><country mxw-id="DS548801860" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128669870" lang="EN" load-source="patent-office"><p id="pa01" num="0001">Based on an encrypted feature vector C (comparison ciphertext) encrypted with a public key pk of a decryption apparatus and an encrypted feature vector C' (target ciphertext) encrypted with the public key pk of the decryption apparatus, and a random number (temporary key) generated by a random number generation unit 303 (temporary key generation unit), an encrypted random similarity degree calculation unit 314 (interim similarity degree ciphertext calculation unit) performs calculation for calculationg a similarity degree in a first stage, with two encrypted feature vectors C and C' kept encrypted, thereby calculating a second challenge C". The decryption apparatus decrypts the second challenge C^ with a secret key sk of the decryption apparatus, and performs calculation for calculating the similarity degree in a second stage with a result of the decryption kept encrypted with the temporary key, thereby calculating a second response Z. A plaintext similarity degree extraction unit 315 (similarity degree calculation unit) decrypts the second response Z with the temporary key, thereby calculating a similarity degree d.<img id="iaf01" file="imgaf001.tif" wi="104" he="70" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128499243" lang="EN" source="EPO" load-source="docdb"><p>Based on an encrypted feature vector C (comparison ciphertext) encrypted with a public key pk of a decryption apparatus and an encrypted feature vector C' (target ciphertext) encrypted with the public key pk of the decryption apparatus, and a random number (temporary key) generated by a random number generation unit 303 (temporary key generation unit), an encrypted random similarity degree calculation unit 314 (interim similarity degree ciphertext calculation unit) performs calculation for calculationg a similarity degree in a first stage, with two encrypted feature vectors C and C' kept encrypted, thereby calculating a second challenge C". The decryption apparatus decrypts the second challenge C^ with a secret key sk of the decryption apparatus, and performs calculation for calculating the similarity degree in a second stage with a result of the decryption kept encrypted with the temporary key, thereby calculating a second response Z. A plaintext similarity degree extraction unit 315 (similarity degree calculation unit) decrypts the second response Z with the temporary key, thereby calculating a similarity degree d.</p></abstract><description mxw-id="PDES63955300" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001">Technical Field</heading><p id="p0001" num="0001">The present invention relates to a similarity degree calculation system for calculating a similarity degree between encrypted data.</p><heading id="h0002">Background Art</heading><p id="p0002" num="0002">There is a technology in which confidential data such as biometric information is stored in an encrypted state, and then a similarity degree indicating to what degree the data in the encrypted state is similar to different data is calculated. If an additive homomorphic encryption system is used, for example, an arithmetic operation using data that is kept encrypted becomes possible. As the additive homomorphic encryption system, the Okamoto-Takashima encryption system (in Patent Literature 3 and Non-Patent Literature 1), the BGN encryption system (in Non-Patent Literature 2), the Gentry encryption system (in Non-Patent Literature 3), the Paillier encryption system, or the like is known. The BGN encryption system and the Gentry encryption algorithm are multiplicative homomorphic as well as additive homomorphic. Thus, these systems are referred to as doubly homomorphic encryption. In the Gentry encryption system, the number of multiplications is not limited. Thus, the Gentry encryption system is referred to as fully<!-- EPO <DP n="2"> --> homomorphic encryption or ring-homomorphic encryption. There is also an encryption system having only a multiplicative homomorphism such as the RSA (trade mark) encryption system.</p><heading id="h0003">Citation List</heading><heading id="h0004">Patent Literature</heading><p id="p0003" num="0003"><ul><li>Patent Literature 1: <patcit id="pcit0001" dnum="JP2008521025A"><text>JP 2008-521025</text></patcit></li><li>Patent Literature 2: <patcit id="pcit0002" dnum="JP2009129210A"><text>JP 2009-129210</text></patcit></li><li>Patent Literature 3: <patcit id="pcit0003" dnum="JP2010054875A"><text>JP 2010-54875</text></patcit></li><li>Patent Literature 4: <patcit id="pcit0004" dnum="JP2006262333A"><text>JP 2006-262333</text></patcit></li><li>Patent Literature 5: <patcit id="pcit0005" dnum="JP2001007802A"><text>JP 2001-7802</text></patcit></li></ul></p><heading id="h0005">Non Patent Literature</heading><p id="p0004" num="0004">.
<ul><li>Non-Patent Literature 1: <nplcit id="ncit0001" npl-type="s"><text>Mitsuhiro Hattori, Yoichi Shibata, Takashi Ito, Nori Matsuda, Katsuyuki Takashima, Takeshi Yoneda, "Secure Biometric Authentication Using 2-DNF Homomorphic Encryption", IEICE Technical report 109(272), pp. 113-120, 2009</text></nplcit></li><li>Non-Patent Literature 2: <nplcit id="ncit0002" npl-type="s"><text>D. Boneh, E. -J. Goh, K, Nissim, "Evaluating 2-DNF Fomulas on Ciphertests", Theory of Cryptography Conference, Lecture Notes in Computer Science, Vol. 3378, pp. 325-341, 2005</text></nplcit>.</li><li>Non-Patent Literature 3: <nplcit id="ncit0003" npl-type="s"><text>C. Genrty, "Fully Homomorphic Encryption Using Ideal Lattices", ACM Symposium on Theory of Computing, pp. 169-178, 2009</text></nplcit>.</li><li>Non-Patent Literature 4: <nplcit id="ncit0004" npl-type="s"><text>M. Upmanyu, A. M. Namboodiri, K. Srinathan, C. V. Jawahar, "Blind Authentication: A Secure Crypto-Biometric<!-- EPO <DP n="3"> --> Verification Protocol", IEEE Transactions on Information Forensics and Security, Vol. 5, No. 2, 2010</text></nplcit>.</li></ul></p><heading id="h0006">Summary of Invention</heading><heading id="h0007">Technical Problem</heading><p id="p0005" num="0005">When using an encryption system such as the additive homomorphic encryption system where an arithmetic operation using data that is kept encrypted is possible, a homomorphism is applied to information to be exchanged between apparatuses in a system or information stored in each apparatus. By doing so, the system may suffer an unexpected attack.<br/>
In an authentication system for authenticating a user in particular, it is unsatisfactory to keep secret of original data alone. It is necessary to prevent leakage of information, with which it is possible to spoof a user, from the information to be exchanged between the apparatuses in the system and the information stored in each apparatus.<br/>
The present invention has been made to solve the problem as mentioned above, for example. An object of the present invention is to calculate a similarity degree between data that is kept encrypted while preventing leakage of information on original data and information to be used for spoofing.</p><heading id="h0008">Solution to Problem</heading><p id="p0006" num="0006">A similarity degree calculation apparatus according to the present invention is a similarity degree calculation apparatus that calculates a similarity degree between comparison data and target data. The similarity<!-- EPO <DP n="4"> --> degree calculation apparatus may include:
<ul><li>a storage device that stores data, a processing device that processes the data, a comparison ciphertext storage unit, a target ciphertext acquisition unit, a temporary key generation unit, an interim similarity degree ciphertext calculation unit, an interim similarity degree ciphertext notification unit, an interim similarity degree decrypted text acquisition unit, and a similarity degree calculation unit;</li><li>using the storage device, the comparison ciphertext storage unit storing a comparison ciphertext obtained by transforming the comparison data by encryption transformation using a public key corresponding to a secret key stored by a decryption apparatus;</li><li>using the processing device, the target ciphertext acquisition unit acquiring a target ciphertext obtained by transforming the target data by the encryption transformation using the public key;</li><li>using the processing device, the temporary key generation unit generating a temporary key;</li><li>using the processing device, based on the comparison ciphertext stored by the comparison ciphertext storage unit, the target ciphertext acquired by the target ciphertext acquisition unit, and the temporary key generated by the temporary key generation unit, the interim similarity degree ciphertext calculation unit performing calculation for calculating the similarity degree in a first stage with the comparison cirphertext and the target ciphertext kept encrypted, and then calculating an interim similarity degree ciphertext by encrypting a result of the calculation with the temporary key;</li><li>using the processing device, the interim similarity degree ciphertext<!-- EPO <DP n="5"> --> notification unit notifying to the decryption apparatus the interim similarity degree ciphertext calculated by the interim similarity degree ciphertext calculation unit;</li><li>using the processing device, the interim similarity degree decrypted text acquisition unit acquiring an interim similarity degree decrypted text calculated and notified by the decryption apparatus, based on the interim similarity degree ciphertext notified by the interim similarity degree ciphertext notification unit; and</li><li>using the processing device, the similarity degree calculation unit decrypting the interim similarity degree decrypted text with the temporary key, based on the temporary key generated by the temporary key generation unit and the interim similarity degree decrypted text acquired by the interim similarity degree decrypted text acquisition unit, thereby calculating the similarity degree between the comparison data and the target data.</li></ul></p><heading id="h0009">Advantageous Effects of Invention</heading><p id="p0007" num="0007">According to the similarity calculation sytem of the present invention, a similarity degree between data may be calculated with the data kept encrypted, and leakage of information on the original data and leakage of information to be used for spoofing may also be prevented during the course of the calculation of the similarity degree.</p><heading id="h0010">Brief Description of Drawings</heading><p id="p0008" num="0008"><ul><li>[<figref idrefs="f0001">Fig. 1</figref>] is a system configuration diagram showing an example of an overall configuration of a biometric authentication system 100 in a first<!-- EPO <DP n="6"> --> embodiment.</li><li>[<figref idrefs="f0001">Fig. 2</figref>] is a diagram showing an example of a hardware configuration of each of a certification apparatus 101, an authentication apparatus 102, a decryption apparatus 103, and a registration apparatus 104 in the first embodiment.</li><li>[<figref idrefs="f0002">Fig. 3</figref>] is a block configuration diagram showing an example of a functional block configuration of the registration apparatus 104 in the first embodiment.</li><li>[<figref idrefs="f0002">Fig. 4</figref>] is a block configuration diagram showing an example of a functional block configuration of the certification apparatus 101 in the first embodiment.</li><li>[<figref idrefs="f0003">Fig. 5</figref>] is a block configuration diagram showing an example of a functional block configuration of the authentication apparatus 102 in the first embodiment.</li><li>[<figref idrefs="f0004">Fig. 6</figref>] is a block configuration diagram showing an example of a functional block configuration of the decryption apparatus 103 in the first embodiment.</li><li>[<figref idrefs="f0004">Fig. 7</figref>] is a flow chart diagram showing an example of an overall operation of the biometric authentication system 100 in the first embodiment.</li><li>[<figref idrefs="f0005">Fig. 8</figref>] is a flow chart diagram showing an example of a flow of a setup process S500 in the first embodiment.</li><li>[<figref idrefs="f0005">Fig. 9</figref>] is a flow chart diagram showing an example of a flow of a registration process S600 in the first embodiment.</li><li>[<figref idrefs="f0006">Fig. 10</figref>] is a flow chart diagram showing an example of a flow of an authentication process S700 in the first embodiment.<!-- EPO <DP n="7"> --></li><li>[<figref idrefs="f0007">Fig. 11</figref>] is a flow chart diagram showing an example of a flow of a vector decomposition process S540 for solving a vector decomposition problem using a regular matrix X.</li><li>[<figref idrefs="f0007">Fig. 12</figref>] is a detailed block diagram showing an example of a configuration of a key generation unit 401 in the first embodiment.</li><li>[<figref idrefs="f0008">Fig. 13</figref>] is a flow chart diagram showing an example of a flow of processes of a key generation step S501 in the first embodiment.</li><li>[<figref idrefs="f0008">Fig. 14</figref>] is a flow chart diagram showing an example of a flow of processes of a feature vector encryption step S603 in the first embodiment.</li><li>[<figref idrefs="f0009">Fig. 15</figref>] is a flow chart diagram showing an example of a flow of processes of a first challenge generation step S701 in the first embodiment.</li><li>[<figref idrefs="f0009">Fig. 16</figref>] is a detailed block diagram showing an example of a configuration of an encrypted data embedding unit 217 in the first embodiment.</li><li>[<figref idrefs="f0010">Fig. 17</figref>] is a flow chart diagram showing an example of a flow of processes of a first response generation step S707 in the first embodiment.</li><li>[<figref idrefs="f0010">Fig. 18</figref>] is a detailed block diagram showing an example of a configuration of an encrypted data extraction unit 305 in the first embodiment.</li><li>[<figref idrefs="f0011">Fig. 19</figref>] is a flow chart diagram showing an example of a flow of processes of an encrypted biometric information extraction step S710 in the first embodiment.</li><li>[<figref idrefs="f0012">Fig. 20</figref>] is a detailed block diagram showing an example of a configuration of an encrypted random similarity degree calculation unit 314 in the first embodiment.<!-- EPO <DP n="8"> --></li><li>[<figref idrefs="f0013">Fig. 21</figref>] is a flow chart diagram showing an example of a flow of processes of a second challenge generation step S712 in the first embodiment.</li><li>[<figref idrefs="f0014">Fig. 22</figref>] is a detailed block diagram showing an example of a configuration of a decryption unit 404 in the first embodiment.</li><li>[<figref idrefs="f0014">Fig. 23</figref>] is a flow chart diagram showing an example of a flow of proceses of a second response generation step S716 in the first embodiment.</li><li>[<figref idrefs="f0015">Fig. 24</figref>] is a detailed block diagram showing an example of a configuration of a plaintext similarity degree extraction unit 315 in the first embodiment.</li><li>[<figref idrefs="f0015">Fig. 25</figref>] is a flow chart diagram showing an example of a flow of processes of a plaintext similarity degree calculation step S719 in the first embodiment.</li><li>[<figref idrefs="f0016">Fig. 26</figref>] is a flow chart diagram showing a calculation procedure for calculating a similarity degree in the biometric authentication system 100 in the first embodiment.</li><li>[<figref idrefs="f0016">Fig. 27</figref>] is a system configuration diagram showing an example of an overall configuration of the biometric authentication system 100 in a second embodiment.</li><li>[<figref idrefs="f0017">Fig. 28</figref>] is a flow chart diagram showing an example of a flow of processes of the second challenge generation step S712 in a third embodiment.</li><li>[<figref idrefs="f0017">Fig. 29</figref>] is a flow chart diagram showing an example of a flow of proceses of the second response generation step S716 in the third embodiment.</li><li>[<figref idrefs="f0018">Fig. 30</figref>] is a flow chart diagram showing a calculation procedure for calculating a similarity degree in the biometric authentication system 100 in<!-- EPO <DP n="9"> --> the third embodiment.</li><li>[<figref idrefs="f0018">Fig. 31</figref>] is a detailed block diagram showing an example of a configuration of the key generation unit 401 in a fourth embodiment.</li><li>[<figref idrefs="f0019">Fig. 32</figref>] is a flow chart diagram showing an example of a flow of processes of the key generation step S501 in the fourth embodiment.</li><li>[<figref idrefs="f0019">Fig. 33</figref>] is a flow chart diagram showing an example of a flow of processes of the feature vector encryption step S603 in the fourth embodiment.</li><li>[<figref idrefs="f0020">Fig. 34</figref>] is a flow chart diagram showing an example of a flow of proceses of the first challenge generation step S701 in the fourth embodiment.</li><li>[<figref idrefs="f0020">Fig. 35</figref>] is a detailed block diagram showing an example of a configuration of the encrypted data embedding unit 217 in the fourth embodiment.</li><li>[<figref idrefs="f0021">Fig. 36</figref>] is a flow chart diagram showing an example of a flow of processes of the first response generation step S707 in the fourth embodiment.</li><li>[<figref idrefs="f0021">Fig. 37</figref>] is a detailed block diagram showing an example of a configuration of the encrypted data extraction unit 305 in the fourth embodiment.</li><li>[<figref idrefs="f0022">Fig. 38</figref>] is a flow chart diagram showing an example of a flow of processes of the encrypted biometric information extraction step S710 in the fourth embodiment.</li><li>[<figref idrefs="f0023">Fig. 39</figref>] is a detailed block diagram showing an example of a configuration of the encrypted random similarity degree calculation unit 314 in the fourth embodiment.</li><li>[<figref idrefs="f0024">Fig. 40</figref>] is a flow chart diagram showing an example of a flow of<!-- EPO <DP n="10"> --> processes of the second challenge generation step S712 in the fourth embodiment.</li><li>[<figref idrefs="f0024">Fig. 41</figref>] is a detailed block diagram showing another example of the configuration of the encrypted random similarity degree calculation unit 314 in the fourth embodiment.</li><li>[<figref idrefs="f0025">Fig. 42</figref>] is a flow chart diagram showing another example of the flow of processes of the second challenge generation step S712 in the fourth embodiment.</li><li>[<figref idrefs="f0025">Fig. 43</figref>] is a flow chart diagram showing an example of a flow of processes of the second response generation step S716 in the fourth embodiment.</li><li>[<figref idrefs="f0026">Fig. 44</figref>] is a flow chart diagram showing an example of a flow of processes of the second response generation step S716 in the fourth embodiment.</li><li>[<figref idrefs="f0026">Fig. 45</figref>] is a flow chart diagram showing a calculation procedure for calculating a similarity degree in the biometric authentication system 100 in the fourth embodiment.</li><li>[<figref idrefs="f0027">Fig. 46</figref>] is a detailed block diagram showing an example of a configuration of the encrypted random similarity degree calculation unit 314 in a fifth embodiment.</li><li>[<figref idrefs="f0027">Fig. 47</figref>] is a flow chart diagram showing an example of a flow of processes of the second challenge generation step S712 in the fifth embodiment.</li><li>[<figref idrefs="f0028">Fig. 48</figref>] is a flow chart diagram showing a calculation procedure for calculating a similarity degree in the biometric authentication system 100 in<!-- EPO <DP n="11"> --> the fifth embodiment.</li><li>[<figref idrefs="f0028">Fig. 49</figref>] is a detailed block diagram showing an example of a configuration of the key generation unit 401 in a sixth embodiment.</li><li>[<figref idrefs="f0029">Fig. 50</figref>] is a flow chart diagram showing an example of a flow of processes of the key generation step S501 in the sixth embodiment.</li><li>[<figref idrefs="f0029">Fig. 51</figref>] is a flow chart diagram showing an example of a flow of processes of the feature vector encryption step S603 in the sixth embodiment.</li><li>[<figref idrefs="f0030">Fig. 52</figref>] is a flow chart diagram showing an example of a flow of processes of the first challenge generation step S701 in the sixth embodiment.</li><li>[<figref idrefs="f0030">Fig. 53</figref>] is a detailed block diagram showing an example of a configuration of the encrypted data embedding unit 217 in the sixth embodiment.</li><li>[<figref idrefs="f0031">Fig. 54</figref>] is a flow chart diagram showing an example of a flow of processes of the first response generation step S707 in the sixth embodiment.</li><li>[<figref idrefs="f0031">Fig. 55</figref>] is a flow chart diagram showing an example of a flow of processes of the encrypted biometric information extraction step S710 in the sixth embodiment.</li><li>[<figref idrefs="f0032">Fig. 56</figref>] is a detailed block diagram showing an example of a configuration of the encrypted random similarity degree calculation unit 314 in the sixth embodiment.</li><li>[<figref idrefs="f0032">Fig. 57</figref>] is a flow chart diagram showing an example of a flow of processes of the second challenge generation step S712 in the sixth embodiment.</li><li>[<figref idrefs="f0033">Fig. 58</figref>] is a detailed block diagram showing an example of a configuration of the decryption unit 404 in the sixth embodiment.<!-- EPO <DP n="12"> --></li><li>[<figref idrefs="f0034">Fig. 59</figref>] is a flow chart diagram showing an example of a flow of processes of the second response generation step S716 in the sixth embodiment.</li><li>[<figref idrefs="f0034">Fig. 60</figref>] is a flow chart diagram showing an example of a flow of processes of the plaintext similarity degree calculation step S719 in the sixth embodiment.</li><li>[<figref idrefs="f0035">Fig. 61</figref>] is a flow chart diagram showing a calculation procedure for calculating a similarity degree in the biometric authentication system 100 in the sixth embodiment.</li><li>[<figref idrefs="f0035">Fig. 62</figref>] is a detailed block diagram showing an example of a configuration of an encrypted random number generation unit 304 in a seventh embodiment.</li><li>[<figref idrefs="f0036">Fig. 63</figref>] is a flow chart diagram showing an example of a flow of processes of the first challenge generation step S701 in the seventh embodiment.</li><li>[<figref idrefs="f0037">Fig. 64</figref>] is a detailed block diagram showing an example of a configuration of the encrypted random similarity degree calculation unit 314 in the seventh embodiment.</li><li>[<figref idrefs="f0037">Fig. 65</figref>] is a flow chart diagram showing an example of a flow of processes of the second challenge generation step S712 in the seventh embodiment.</li><li>[<figref idrefs="f0038">Fig. 66</figref>] is a detailed block diagram showing an example of a configuration of the decryption unit 404 in the seventh embodiment.</li><li>[<figref idrefs="f0038">Fig. 67</figref>] is a flow chart diagram showing an example of a flow of processes of the second response generation step S716 in the seventh<!-- EPO <DP n="13"> --> embodiment.</li><li>[<figref idrefs="f0039">Fig. 68</figref>] is a flow chart diagram showing a calculation procedure for calculating a similarity degree in the biometric authentication system 100 in the seventh embodiment.</li><li>[<figref idrefs="f0039">Fig. 69</figref>] is a detailed block diagram showing an example of the encrypted random similarity degree calculation unit 314 in an eighth embodiment.</li><li>[<figref idrefs="f0040">Fig. 70</figref>] is a flow chart diagram showing an example of a flow of processes the second challenge generation step S712 in the eighth embodiment.</li><li>[<figref idrefs="f0040">Fig. 71</figref>] is a flow chart diagram showing an example of a flow of processes of the second response generation step S716.</li><li>[<figref idrefs="f0041">Fig. 72</figref>] is a flow chart diagram showing a calculation procedure for calculating a similarity degree in the biometric authentication system 100 in the eighth embodiment.</li><li>[<figref idrefs="f0041">Fig. 73</figref>] is a detailed block diagram showing an example of a configuration of the encrypted random similarity degree calculation unit 314 in a ninth embodiment.</li><li>[<figref idrefs="f0042">Fig. 74</figref>] is a flow chart diagram showing an example of a flow of processes of the second challenge generation step S712 in a ninth embodiment.</li><li>[<figref idrefs="f0042">Fig. 75</figref>] is a detailed block diagram showing an example of a configuration of the decryption unit 404 in the ninth embodiment.</li><li>[<figref idrefs="f0043">Fig. 76</figref>] is a flow chart diagram showing an example of a flow of processes of the second response generation step S716 in the ninth<!-- EPO <DP n="14"> --> embodiment.</li><li>[<figref idrefs="f0043">Fig. 77</figref>] is a flow chart diagram showing a calculation procedure for calculating a similarity degree in the biometric authentication system 100 in the ninth embodiment.</li><li>[<figref idrefs="f0044">Fig. 78</figref>] is a system configuration diagram showing an example of an overall configuration of the image search system 100 in a tenth embodiment.</li><li>[<figref idrefs="f0044">Fig. 79</figref>] is a block configuration diagram showing an example of a functional block configuration of the registration apparatus 104 in the tenth embodiment.</li><li>[<figref idrefs="f0045">Fig. 80</figref>] is a block configuration diagram showing an example of a functional block configuration of the terminal apparatus 111 in the tenth embodiment.</li><li>[<figref idrefs="f0046">Fig. 81</figref>] is a block configuration diagram showing an example of a functional block configraution of the search apparatus 112 in the tenth embodiment.</li></ul></p><heading id="h0011">Description of Embodiments</heading><heading id="h0012">First Embodiment.</heading><p id="p0009" num="0009">A first embodiment will be described using <figref idrefs="f0001 f0002 f0003 f0004 f0005 f0006 f0007 f0008 f0009 f0010 f0011 f0012 f0013 f0014 f0015 f0016">Figs. 1 to 26</figref>.</p><p id="p0010" num="0010"><figref idrefs="f0001">Fig. 1</figref> is a system configuration diagram showing an example of an overall configuration of a biometric authentication system 100 in this embodiment.<br/>
The biometric authentication system 100 is a system in which biometric information such as a fingerprint of a user is input and the input information is matched against biometric information registered in advance,<!-- EPO <DP n="15"> --> thereby authenticating the user.<br/>
The biometric authentication system 100 (similarity degree calculation system) includes a certification apparatus 101, an authentication apparatus 102, a decryption apparatus 103, and a registration apparatus 104, for example.<br/>
The registration apparatus 104 extracts biometric information from each user, encrypts the extracted biometric information, and registers the encrypted biometric information in the authentication apparatus 102.<br/>
The certification apparatus 101 (encryption apparatus) extracts biometric information from a user and then encrypts the extracted biometric information. The certification apparatus 101 also communicates with the authentication apparatus 102 to perform authentication.<br/>
The authentication apparatus 102 (similarity degree calculation apparatus) stores the encrypted biometric information of each user registered by the registration apparatus 104. The authentication apparatus 102 communicates with each of the certification apparatus 101 and the decryption apparatus 103 to perform the authentication.<br/>
The decryption apparatus 103 communicates with the authentication apparatus 102 and decrypts encrypted data related to a similarity degree transmitted from the authentication apparatus.<br/>
A plurality of the certification apparatuses 101 and a plurality of the registration apparatuses 104 may be provided. Physically, the certification apparatus 101 and the registration apparatus 104 may be one apparatus. Physically, the certification apparatus 101 and the decryption apparatus 103 may be one apparatus. Physically, the authentication apparatus 102 and the<!-- EPO <DP n="16"> --> registration apparatus 104 may be one apparatus.</p><p id="p0011" num="0011"><figref idrefs="f0001">Fig. 2</figref> is a diagram showing an example of a hardware configuration of each of the certification apparatus 101, the authentication apparatus 102, the decryption apparatus 103, and the registration apparatus 104 in this embodiment.<br/>
Each of the certification apparatus 101, the authentication apparatus 102, the decryption apparatus 103, and the registration apparatus 104 is a computer, for example, and includes a processing device 911, an input device 912, an output device 913, and a storage device 914.<br/>
The storage device 914 stores a program executed by the processing device 911 and data processed by the processing device 911. To take an example, the storage device 914 is a volatile memory, a non-volatile memory, a hard disk drive, or the like.<br/>
The processing device 911 executes the program stored in the storage device 914, thereby processing data and controlling the apparatus as a whole.<br/>
The input device 912 converts information from an outside into data capable of being processed by the processing device 911. The data obtained by the conversion by the input device 912 may be directly processed by the processing device 911, or may be stored by the storage device 914. To take an example, the input device 912 is an operation input device such as a keyboard, mouse, or the like for inputting a user operation, a biometric information input device for extracting and inputting biometric information such as a user's fingerprint or iris, a receiving device (communication device) for receiving a signal transmitted by a different device, or a reading device for reading data from a recording medium.<br/>
<!-- EPO <DP n="17"> -->The output device 913 is a device for converting the data processed by the processing device 911 and the data stored by the storage device 914 and then outputting the converted data to the outside. To take an example, the output device 913 is a display device for displaying an image, a transmitting device (communication device) for transmitting a signal to a different device, a writing device for writing data into a recording medium, or the like.</p><p id="p0012" num="0012"><figref idrefs="f0002">Fig. 3</figref> is a block configuration diagram showing an example of a functional block configuration of the registration device 104 in this embodiment.<br/>
The registration apparatus 104 includes a public key receiving unit 208, a public key storage unit 202, a biometric information extraction unit 203, a feature vector formation unit 204, a random number generation unit 205, an encrypted data generation unit 206, and an encrypted data transmitting unit 201.<br/>
The public key receiving unit 208 (public key acquisition unit) receives a public key generated by the decryption apparatus 103 using the input device 912 such as the communication device. The communication device (communication unit) exchanges data with a different device such as the authentication apparatus 102 or the decryption apparatus 103.<br/>
The encrypted data transmitting unit 201 (comparison ciphertext notification unit) transmits the encrypted biometric information (comparison ciphertext) to the authentication device 102, using the output device 913 such as the communication device.<br/>
The public key storage unit 202 stores the public key received by the public key receiving unit 208, using the storage device 914. The storage<!-- EPO <DP n="18"> --> device 914 (storage unit) stores various data such as the public key transmitted from the decryption device 103.<br/>
The biometric information extraction unit 203 extracts the biometric information necessary for performing individual identification from each user, using the input device 912 such as an optical camera, an infrared camera, or the other variety of sensor.<br/>
The feature vector formation unit 204 (comparison data acquisition unit) forms a feature vector (comparison data) indicating a personal feature from the biometric information extracted by the biometric information extraction unit 203, using the processing device 911.<br/>
The random number generation unit 205 generates random numbers, based on a part of the public key stored by the public key storage unit 202 or the like, using the processing device 911. The random numbers generated by the random number generation unit 205 are used by the encrypted data generation unit 206 or the like.<br/>
The encrypted data generation unit 206 (encryption unit, comparison ciphertext generation unit) encrypts the feature vector formed by the feature vector forming device 204, based on the random numbers generated by the random number generation unit 205, thereby generating encrypted biometric information (encrypted feature vector), using the processing device 911.</p><p id="p0013" num="0013"><figref idrefs="f0002">Fig. 4</figref> is a block configuration diagram showing an example of a functional block of the certification apparatus 101 in this embodiment.<br/>
The certification apparatus 101 includes a public key receiving unit 218, a public key storage unit 212, a biometric information extraction unit 213, a feature vector formation unit 214, a random number generation unit 215, a<!-- EPO <DP n="19"> --> first challenge receiving unit 211, an encrypted data embedding unit 217, and a first response transmitting unit 221, for example.<br/>
The public key receiving unit 218 (public key acquisition unit) receives the public key generated by the decryption apparatus 103, using the input device 912 such as the communication device. The communication device (communication unit) exchanges data with a different device such as the authentication apparatus 102 or the decryption apparatus 103.<br/>
The first challenge receiving unit 211 (temporary public key acquisition unit) receives a first challenge (temporary public key) from the authentication apparatus 102, using the input device 102 such as the communication device.<br/>
The first response transmitting unit 221 (target dual encryption text notification unit) returns a first response (target dual encryption text) corresponding to the first challenge to the authentication apparatus 102, using the input device 912 such as the communication device.<br/>
The public key storage unit 212 stores the public key received by the public key receiving unit 218, using the storage device 914. The storage device 914 (storage unit) stores various data such as the public key transmitted from the decryption apparatus 103.<br/>
The biometric information extraction unit 213 extracts from the user the biometric information necessary for performing individual identification, using the input device 912 such as an optical camera, an infrared camera, or the other variety of sensor.<br/>
The feature vector formation unit 214 (target data acquisition unit) forms a feature vector (target data) indicating a personal feature from the<!-- EPO <DP n="20"> --> biometric information extracted by the biometric information extraction unit 213, using the processing device 911.<br/>
The random number generation unit 215 generates random numbers, based on a part of the public key stored by the public key storage unit 212, using the processing device 911. The random numbers generated by the random number generation unit 215 are used by the encrypted data embedding unit 217 or the like.<br/>
The encrypted data embedding unit 217 (response generation unit, target dual encryption text calculation unit) processes the first challenge transmitted from the authentication apparatus 102, according to the value of the feature vector formed by the feature vector formation unit 214, using the processing device 911. That is, the encrypted data embedding unit 217 embeds the encrypted biometric information into the first challenge. The encrypted data embedding unit 217 calculates the first response to be returned to the authentication apparatus 102.</p><p id="p0014" num="0014"><figref idrefs="f0003">Fig. 5</figref> is a block configuration diagram showing an example of a functional block configuration of the authentication apparatus 102 in this embodiment.<br/>
The authentication apparatus 102 includes a public key receiving unit 308, a public key storage unit 302, an encrypted data receiving unit 301, an encrypted data storage unit 312, a random number generation unit 303, a random number storage unit 322, an encrypted random number generation unit 304, a first challenge transmitting unit 311, a first response receiving unit 331, an encrypted data extraction unit 305, an encrypted random similarity degree<!-- EPO <DP n="21"> --> calculation unit 314, a second challenge transmitting unit 321, a second response receiving unit 341, a plaintext similarity degree extraction unit 315, and a determination unit 306, for example.<br/>
The public key receiving unit 308 (public key acquisition unit) receives the public key generated by the decryption apparatus 103, using the input device 912 such as the communication device (communication unit).<br/>
The encrypted data receiving unit 301 (comparison ciphertext acquisition unit) receives the encrypted feature vector (comparison ciphertext) from the certification apparatus 101, using the input device 912 such as the communication device.<br/>
The first challenge transmitting unit 311 (temporary public key notification unit) transmits the first challenge (temporary public key) to the certification apparatus 101, using the output device 913 such as the communication device.<br/>
The first response receiving unit 331 (target dual encryption text acquisition unit) receives the first response (target dual encryption text) corresponding to the first challenge from the certification apparatus 101, using the input device 912 such as the communication device.<br/>
The second challenge transmitting unit 321 (interim similarity degree ciphertext notification unit) transmits a second challenge (interim similarity degree ciphertext) to the decryption apparatus 103, using the output device 913 such as the communication device.<br/>
The second response receiving unit 341 (interim similarity degree decrypted text acquisition unit) receives a second response (interim similarity degree decrypted text) from the decryption apparatus 103, using the input<!-- EPO <DP n="22"> --> device 912 such as the communication device.<br/>
The public key storage unit 302 stores the public key transmitted from the decryption apparatus 103, using the storage device 914 (storage unit).<br/>
The encrypted data storage unit 312 (comparison ciphertext storage unit) stores the encrypted feature vector transmitted from the certification apparatus 101, using the storage device 914. The encrypted data storage unit 312 stores a plurality of the encrypted feature vectors associated with user identifiers, for example.<br/>
The random number storage unit 322 (temporary secret key storage unit, temporary key storage unit) stores a part of random numbers (temporary secret key, temporary key) out of the random numbers generated by the random number generation unit 303, using the storage device 914.<br/>
The random number generation unit 303 (temporary secret key generation unit, temporary key generation unit) generates the random numbers, based on a part of the public key stored by the public key storage unit 302, using the processing device 911. The random numbers generated by the random number generation unit 303 are used by the encrypted random number generation unit 304, the encrypted data extraction unit 305, the encrypted random similarity degree calculation unit 314, the plaintext similarity degree extraction unit 315, and the like.<br/>
Using the processing device 911, the encrypted random number generation unit 304 (challenge generation unit, temporary public key calculation unit) generates the first challenge (encrypted random numbers) in order to communicate with the certification apparatus 101.<br/>
<!-- EPO <DP n="23"> -->Using the processing device 911, the encrypted data extraction unit 305 (random number removal unit, target ciphertext acquisition unit) removes random numbers included in the first response transmitted from the certification apparatus 101, employing the random numbers (stored in the random number storage unit 322) used in the first challenge corresponding to the first response. The encrypted data extraction unit 305 removes a part of the random numbers used in the first challenge from the first response, thereby extracting an encrypted feature vector.<br/>
Using the processing device 911, the encrypted random similarity degree calculation unit 314 (challenge generation unit, interim similarity degree ciphertext calculation unit) generates the second challenge (encrypted random similarity degree) in order to communicate with the decryption apparatus 103. The encrypted random similarity degree calculation unit 314 generates the second challenge, based on the encrypted feature vector extracted by the encrypted data extraction unit 305 and the encrypted feature vectors stored by the encrypted data storage unit 312. The encrypted random similarity degree calculation unit 314 acquires the encrypted feature vector whose user identifier matches the user identifier of the first response received by the first response receiving unit 331 from among the encrypted feature vectors stored by the encrypted data storage unit 312, thereby generating the second challenge.<br/>
The plaintext similarity degree extraction unit 315 (random number removal unit, similarity degree calculation unit) removes random numbers included in the second response from the second response transmitted to the decryption apparatus 103, employing the random numbers (stored in the<!-- EPO <DP n="24"> --> random number storage unit 322) used in the second challenge corresponding to the second response. The plaintext similarity degree extraction unit 315 removes the random numbers from the second response, thereby calculating a plaintext similarity degree.<br/>
Using the processing device 911, the determination unit 306 (similarity degree determination unit) performs individual identification by employing the plaintext similarity degree generated by the plaintext similarity degree extraction unit 315, thereby determining whether or not the user is the correct user. That is, the determination unit 306 analyzes the plaintext similarity degree to determine the generator element of the feature vector for authentication is valid or not.</p><p id="p0015" num="0015"><figref idrefs="f0004">Fig. 6</figref> is a block configuration diagram showing an example of a functional block configuration of the decryption apparatus 103 in this embodiment.<br/>
The decryption apparatus 103 includes a key generation unit 401, a secret key storage unit 413, a public key storage unit 403, a public key transmitting unit 408, a second challenge receiving unit 402, a decryption unit 404, and a second response transmitting unit 412, for example.<br/>
The key generation unit 401 (a parameter generation unit, a secret key generation unit, a public key calculation unit) generates parameters necessary for encryption and decryption, the public key, a secret key, and the like, using the processing device 911.<br/>
The public key transmitting unit 408 (public key notification unit) transmits the public key generated by the key generation unit 401 to the certification apparatus 101 and the authentication apparatus 102 using the<!-- EPO <DP n="25"> --> output device 913 such as the communication device (communication unit).<br/>
The second challenge receiving unit 402 (interim similarity degree ciphertext acquisition unit) receives the second challenge (interim similarity degree ciphertext) from the authentication apparatus 102, using the input device 912 such as the communication device.<br/>
The second response transmitting unit 412 (interim similarity degree decrypted text notification unit) transmits the second response (interim similarity degree decrypted text) corresponding to the second challenge to the authentication apparatus 102, using the output device 913 such as the communication device.<br/>
The public key storage unit 403 stores various data such as the public key generated by the key generation unit 401, using the storage device 914 (storage unit).<br/>
The secret key storage unit 413 stores the secret key generated by the key generation unit 401, using the storage device 914.<br/>
The decryption unit 404 (a response generation unit, an interim similarity degree decrypted text calculation unit) generates the second response corresponding to the second challenge transmitted from the authentication apparatus 102, using the processing device 911. The decryption unit 404 decrypts the second challenge (encrypted random similarity degree) to calculate the second response.</p><p id="p0016" num="0016"><figref idrefs="f0004">Fig. 7</figref> is a flow chart diagram showing an example of an overall operation of the biometric authentication system 100 in this embodiment.<br/>
The operation of the biometric authentication system 100 is constituted from three processes, which are a setup process S500, a<!-- EPO <DP n="26"> --> registration process S600, and an authentication process S700, for example.<br/>
In the setup process S500 (setting process), the decryption apparatus 103 generates the parameters, the public key, the secret key necessary, and the like for encryption and decryption.<br/>
In the registration process S600, the registration apparatus 104 encrypts the biometric information (comparison data) of each user, and then transmits the encrypted biometric information to the authentication apparatus 102. The authentication apparatus 102 stores the encrypted biometric information (comparison ciphertext).<br/>
In the authentication process S700, the authentication apparatus 102 first communicates with the certification apparatus 101 to extract the encrypted biometric information (target ciphertext) from the data (first challenge and first response) used in that communication.<br/>
Next, the authentication apparatus 102 communicates with the decryption apparatus 103 to extract a random similarity degree from the data (second challenge and second response) used in that communication based on the extracted encrypted biometric information and the encrypted biometric information registered in advance in the registration process S600.<br/>
Finally, the authentication apparatus 102 extracts the plaintext similarity degree from the random similarity, and then compares the similarity degree of the plaintext with a threshold value, thereby determining whether the user is the correct user. The threshold value herein may be a common value set in advance in the system, or a value that is different for each user.</p><p id="p0017" num="0017"><figref idrefs="f0005">Fig. 8</figref> is a flowchart diagram showing an example of a flow of the setup process S500 in this embodiment.<br/>
<!-- EPO <DP n="27"> -->The setup process S500 includes a key generation step S501, a public key notification step S502, and public key acquisition steps S503 to S505.<br/>
First, in the key generation step S501, using the processing device 911, the key generation unit 401 of the decryption apparatus 103 generates a secret key sk and a public key pk, based on the key generation system of the homomorphic encryption system. As the homomorphic encryption system, there is the Okamoto-Takashima encryption system, the BGN encryption system, the Paillier encryption system, or the like, for example.<br/>
Next, in the public key notification process S502, the public key storage unit 403 of the decryption apparatus 103 stores the public key pk, using the storage device 914. The secret key storage unit 413 of the decryption apparatus 103 stores the secret key sk, using the storage device 914. The public key transmitting unit 408 of the decryption apparatus 103 transmits the public key pk to each of the registration apparatus 104, the certification apparatus 101, the authentication apparatus 102, and the like, using the output device 913.<br/>
In the public key acquisition process S503, the public key receiving unit 208 of the registration apparatus 104 receives the public key pk transmitted by the decryption apparatus 103, using the input device 912. The public key storage unit 202 of the registration apparatus 104 stores the public key pk received by the public key receiving unit 208, using the storage device 914.<br/>
In the public key acquisition step S504, the public key receiving unit 218 of the certification apparatus 101 receives the public key pk transmitted by the decryption apparatus 103, using the input device 912. The public key<!-- EPO <DP n="28"> --> storage unit 212 of the certification apparatus 101 stores the public key pk received by the public key receiving unit 218, using the storage device 914.<br/>
In the public key acquisition step S505, the public key receiving unit 308 of the authentication apparatus 102 receives the public key pk transmitted by the decryption apparatus 103, using the input device 912. The public key storage unit 302 of the authentication apparatus 102 stores the public key pk received by the public key receiving unit 308, using the storage device 914.<br/>
It may be so configured that the public key pk is transmitted and received through a network or the like, and that the public key pk is distributed to the certification apparatus 101 or the like, using a different method. It may be so configured that, for example, the decryption apparatus 103 stores the public key pk in a recording medium (such as a hard disk drive or an optical disk), the certification apparatus 101 or the like accesses the recording medium through the network or the like, or physically moves the recording medium itself to read the public key pk from the recording medium and then store the read public key pk.</p><p id="p0018" num="0018"><figref idrefs="f0005">Fig. 9</figref> is a flowchart diagram showing an example of a flow of the registration process S600 in this embodiment.<br/>
The registration process S600 includes a biometric information extraction step S601, a feature vector generation step S602, a feature vector encryption step S603, an encrypted biometric information notification step S604, and an encrypted biometric information acquisition step S605, for example.<br/>
First, in the biometric information extraction step S601, the biometric information extraction unit 203 of the registration apparatus 104 extracts<!-- EPO <DP n="29"> --> biometric information of each user, using the input device 912.<br/>
In the feature vector generation step S602, the feature vector formation unit 204 of the registration apparatus 104 generates a feature vector b of the biometric information extracted by the biometric information extraction unit 203 in the biometric information extraction step S601, using the processing device 911.<br/>
In the feature vector encryption step S603, the random number generation unit 205 of the registration apparatus 104 generates the random numbers, based on the part of the public key pk or the like, using the processing device 911. The encrypted data generation unit 206 of the registration apparatus 104 reads the public key pk stored by the public key storage unit 202, using the processing device 911. The encrypted data generation unit 206 of the registration apparatus 104 generates an encrypted feature vector C, based on the read public key pk and the random numbers generated by the random number generation unit 205, using the processing device 911. The encrypted feature vector C is the one obtained by encrypting the feature vector b.<br/>
In the encrypted biometric information notification step S604, the encrypted data transmitting unit 201 of the registration apparatus 104 transmits to the authentication apparatus 102 the encrypted feature vector C generated by the encrypted data generation unit 206 in the feature vector encryption step S603, using the output device 913.<br/>
In the encrypted biometric information acquisition step S605, the encrypted data receiving unit 301 of the authentication apparatus 102 receives the encrypted feature vector C transmitted by the registration apparatus 104 in<!-- EPO <DP n="30"> --> the encrypted biometric information notification step S604, using the input device 912. The encrypted data storage unit 312 of the authentication apparatus 102 stores the encrypted feature vector C received by the encrypted data receiving unit 301, using the storage device 914.</p><p id="p0019" num="0019">The biometric information of the user and the feature vector b become unnecessary after generation of the encrypted feature vector C. Thus, it is desirable that the biometric information of the user and the feature vector b be erased after generation of the encrypted feature vector C. By doing so, theft of the biometric information of the user and the feature vector by an unauthorized person from the storage device 914 of the registration apparatus 104 may be prevented.<br/>
The encrypted feature vector C is encrypted with the public key generated by the decryption apparatus. Thus, even if the unauthorized person has obtained the encrypted feature vector C by intercepting communication between the registration apparatus 104 and the authentication apparatus 102 or stealing the encrypted feature vector C from the storage device 914 of the authentication apparatus 102, the biometric information of the user and the feature vector cannot be known unless the unauthorized person uses the secret key of the decryption apparatus.<br/>
Further, as will be described later, the first response including information on the feature vector at a time of authentication can be generated by the feature vector alone, and cannot be generated from the encrypted feature vector. Even if the unauthorized person has obtained the encrypted feature vector C, the unauthorized person cannot generate the first response, so that the unauthorized person cannot spoof the authorized user.<!-- EPO <DP n="31"> --></p><p id="p0020" num="0020"><figref idrefs="f0006">Fig. 10</figref> is a flow chart diagram showing an example of a flow of the authentication process S700 in this embodiment.<br/>
The authentication process S700 includes a first challenge generation step S701, a random number storage step S702, a first challenge notification step S703, a first challenge acquisition step S704, a biometric information extraction step S705, a feature vector generation step S706, a first response generation step S707, a first response notification step S708, a first response acquisition step S709, an encrypted biometric information extraction step S710, an encrypted biometric information reading step S711, a second challenge generation step S712, a random storage step S713, a second challenge notification step S714, a second challenge acquisition step S715, a second response generation step S716, a second response notification step S717, a second response acquisition step S718, a plaintext similarity degree calculation step S719, and an authentication determination step S720, for example.</p><p id="p0021" num="0021">First, in the first challenge generation step S701, using the processing device 911, the random number generation unit 303 of the authentication apparatus 102 reads the public key pk from the public key storage unit 302 to generate the random numbers. The encrypted random number generation unit 304 of the authentication apparatus 102 reads the public key pk from the public key storage unit 302 and encrypts the random numbers generated by the random number generation unit 303, thereby generating the first challenge (encrypted random numbers), using the processing device 911.<br/>
In the random storage step S702, the random number storage unit 322 of the authentication apparatus 102 stores the random numbers generated by<!-- EPO <DP n="32"> --> the random number generation unit 303 in the first challenge generation step S701, using the storage device 914.<br/>
In the first challenge notification step S703, the first challenge transmitting unit 311 of the authentication apparatus 102 transmits the first challenge generated by the encrypted random number generation unit 304 in the first challenge generation step S701 to the certification apparatus 101, using the output device 913.</p><p id="p0022" num="0022">In the first challenge acquisition step S704, the first challenge receiving unit 211 of the certification apparatus 101 receives the first challenge transmitted by the authentication apparatus 102 in the first challenge notification step S703, using the input device 912.<br/>
In the biometric information extraction step S705, the biometric information extraction unit 213 of the certification apparatus 101 extracts the biometric information of the user, using the input device 912.<br/>
In the feature vector generation step S706, the feature vector formation unit 214 of the certification apparatus 101 forms a feature vector b' of the biometric information extracted by the biometric information extraction unit 213 in the biometric information extraction step S705, using the processing device 911.<br/>
In the first response generation step S707, using the processing device 911, the random number generation unit 215 of the certification apparatus 101 reads the public key pk stored by the public key storage unit 212 to generate the random numbers. The encrypted data embedding unit 217 of the certification apparatus 101 reads the public key pk from the public key storage unit 212, processes the first challenge according to the value of<!-- EPO <DP n="33"> --> the feature vector b' formed by the feature vector formation unit 214 in the feature vector generation step S706, based on the random numbers generated by the random number generation unit 215, thereby generating the first response. The first response is the one obtained by embedding an encrypted feature vector C' in the first challenge.<br/>
In the first response notification step S708, the first response transmitting unit 221 of the certification apparatus 101 transmits the first response generated by the encrypted data embedding unit 217 in the first response generation step S707 to the authentication device 102, using the output device 913.</p><p id="p0023" num="0023">In the first response acquisition step S709, the first response receiving unit 331 of the authentication apparatus 102 receives the first response transmitted by the certification apparatus 101 in the first response notification step S708, using the input device 912.<br/>
In the encrypted biometric information extraction step S710, the encrypted data extraction unit 305 of the authentication apparatus 102 extracts from the random number storage unit 322 the random numbers generated by the random number generation unit 303 in the first challenge generation step S701, removes the random numbers from the first response, and then extracts the encrypted feature vector C', using the processing device 911.<br/>
In the encrypted biometric information reading step S711, the encrypted random similarity degree calculation unit 314 of the authentication apparatus 102 extracts the encrypted feature vector C from the encrypted data storage unit 312, using the processing device 911.<br/>
In the second challenge generation step S712, the random number<!-- EPO <DP n="34"> --> generation unit 303 of the authentication apparatus 102 reads the public key pk stored by the public key storage unit 302 to generate the random numbers, using the processing device 911. Using the processing device 911, the encrypted random number generation unit 304 of the authentication apparatus 102 reads the public key pk from the public key storage unit 302 and generates the second challenge (encrypted random similarity degree), based on the encrypted feature vector C' extracted from the first response by the encrypted data extraction unit 305 in the encrypted biometric information extraction step S710, the encrypted feature vector C extracted in the encrypted biometric information reading step S711, the read public key pk, and the random numbers generated by the random number generation unit 303.<br/>
In the random number storage step S713, the random number storage unit 322 of the authentication apparatus 102 stores the random numbers generated by the random number generation unit 303 in the second challenge generation step S712, using the storage device 914.<br/>
In the second challenge notification step S714, the second challenge transmitting unit 321 of the authentication apparatus 102 transmits the second challenge generated by the encrypted random similarity degree calculation unit 314 in the second challenge generation step S712 to the decryption apparatus 103, using the output device 913.</p><p id="p0024" num="0024">In the second challenge acquisition step S715, the second challenge receiving unit 402 of the decryption apparatus 103 receives the second challenge transmitted by the authentication apparatus 102 in the second challenge notification step S714, using the input device 912.<br/>
In the second response generation step S716, using the processing<!-- EPO <DP n="35"> --> device 911, the decryption unit 404 of the decryption apparatus 103 reads the secret key sk from the secret key storage unit 413, performs decryption processing using the secret key sk on the second challenge (encrypted random similarity degree) received by the second receiving unit 402 in the second challenge acquisition step S715, thereby generating the second response (deriving the random similarity degree).<br/>
In the second response notification step S717, the second response transmitting unit 412 of the decryption apparatus 103 transmits the second response generated by the decryption unit 404 in the second response generation step S716 to the authentication apparatus 102, using the output device 913.</p><p id="p0025" num="0025">In the second response acquisition step S718, the second response receiving unit 341 of the authentication apparatus 102 receives the second response transmitted by the decryption apparatus 103 in the second response notification step S717, using the input device 912.<br/>
In the plaintext similarity degree calculation step S719, using the processing device 911, the plaintext similarity degree extraction unit 315 of the authentication apparatus 102 extracts from the random number storage unit 322 the random numbers generated by the random number generation unit 303 in the second challenge generation step S712, removes the random numbers from the second response (random similarity degree) received by the second response receiving unit 341 in the second response acquisition step S718, thereby extracting the plaintext similarity degree.<br/>
In the authentication determination step S720, using the processing device 911, the determination unit 306 of the authentication apparatus 102<!-- EPO <DP n="36"> --> performs identity authentication, based on the plaintext similarity degree extracted in the plaintext similarity degree calculation step S719 and the predetermined threshold value.</p><p id="p0026" num="0026">The authentication process S700 is started upon receipt of a request for authentication from the certification apparatus 101, for example. It may be so configured, however, that advance preparation of the protocol is performed before the request for the authentication is received so as to reduce the communication cost or the like. To take an example, it may be so configured that the steps from the first challenge generation step S701 to the first challenge acquisition step S704 are executed in advance. That is, before receipt of the request for the authentication from the certification apparatus 101, the authentication apparatus 102 generates the first challenge (encrypted random numbers), and transmits the generated first challenge to the certification apparatus 101. Then, the encrypted data embedding unit 217 of the certification apparatus 101 stores the received first challenge, using the storage device 914. The random numbers used when the first challenge is generated are stored by the random number storage unit 322 of the authentication apparatus 102, using the storage device 914. The random numbers stored by the random number storage unit 322 must not be released to the other apparatus.</p><p id="p0027" num="0027">As the random numbers generated by the random number generation unit 303 of the authentication apparatus 102 in the first challenge generation step S701 and to be used for generating the first challenge by the encrypted random generation unit 304, there are two types of the random numbers, which are the random numbers as plaintexts and the random numbers to be<!-- EPO <DP n="37"> --> used for encrypting the plaintexts. Only the random numbers as the plaintexts out of these random numbers should be used as the random numbers stored by the random number storage unit 322 of the authentication apparatus 102 in the random number storage step S702.</p><p id="p0028" num="0028">In the first response generation step S707, the certification apparatus 101 generates the first response, based on the first challenge and the value of the feature vector, using additive homomorphism of encryption. The first challenge is obtained by encrypting the random numbers as the plaintexts. On the other hand, the value of the feature vector is a plaintext before encryption. The value of the encrypted feature vector is embedded in the first response.</p><p id="p0029" num="0029">Assume that ciphertexts E(m1) and E(m2) are combined by a group arithmetic operation on a finite group having elements of ciphertexts. Then, a ciphertext E(m1 + m2) is derived due to additive homomorphism of encryption. The ciphertext E(m1 + m2) is obtained by encrypting a plaintext m1 + m2 which is a combination of original plaintexts m1 and m2 by a group arithmetic operation on a finite group having elements of plaintexts. Herein, m1 and m2 indicate the plaintexts. E indicates encryption transformation. "+" indicates the group arithmetic operation on the finite group having the elements of plaintexts or ciphertexts.<br/>
Assume that an element obtained by combining n pieces of elements a (n being an integer) of a finite group by a group arithmetic operation on the finite group is described as "n·a". Then, n·E(m) = E (n.m) holds. Herein, m indicates a plaintext. This operation is called "scalar multiplication". Herein, the group arithmetic operation on the finite group is described as<!-- EPO <DP n="38"> --> addition. When a group arithmetic operation on the finite group is described as multiplication, the same operation is called "exponentiation", and is described as "n<sup>a</sup>".<br/>
Assume that each plaintext is an integer modulo a predetermined number. Then, the finite group having the elements of plaintexts forms a ring (or a field). Addition and multiplication are performed as the arithmetic operations of the ring. The addition on the finite ring having the elements of plaintexts is associated with the group arithmetic operation on the finite group having the elements of ciphertexts. The multiplication on the finite ring having the element of the integer modulo the predetermined number is equivalent to scalar multiplication. That is, the multiplication on the finite ring having the elements of plaintexts is associated with the scalar multiplication of the element on the finite group having the elements of the ciphertexts.<br/>
The inverse element of an element a in multiplication on the finite ring having the elements of plaintexts is described as "a<sup>-1</sup>". Assume that an inverse element m<sup>-1</sup> of the plaintext m is present. Then, when m<sup>-1</sup> pieces of E(n.m) are combined by a group arithmetic operation on the finite group having the elements of ciphertexts, a ciphertext E(n) obtained by encrypting a plaintext n is derived.<br/>
The biometric authentication system 100 makes use of this matter.</p><p id="p0030" num="0030">Assume that the feature vector is a T-dimensional vector (y<sub>1</sub>, y<sub>2</sub>, ... y<sub>T</sub>) (T being an integer not less than 1) having components of integers not less than 0 and less than q. It is assumed, however, that q is an order of a finite ring and is not less than 2. Actual components of the feature vector may be 0<!-- EPO <DP n="39"> --> or 1, for example, and may assume only a limited value.<br/>
In the first challenge generation step S701, the random number generation unit 303 sets the integers randomly selected from among the integers not less than 0 and less than q as the random numbers as the plaintexts. The random number generation unit 303 generates T pieces of random numbers x<sub>1</sub>, x<sub>2</sub>, ..., and x<sub>T</sub> as the plaintexts. These random numbers are regarded as a vector (x<sub>1</sub>, x<sub>2</sub>, ..., x<sub>T</sub>) of T dimensions that are the same as the feature vector.<br/>
The encrypted random number generation unit 304 generates a T-dimensional vector (E(x<sub>1</sub>), E(x<sub>2</sub>), ...E(x<sub>T</sub>)) obtained by encryption transforming each component of the T-dimensional vector (x<sub>1</sub>, x<sub>2</sub>, ..., x<sub>T</sub>). This is the first challenge.</p><p id="p0031" num="0031">In the first response generation step S707, the encrypted data embedding unit 217 scalar multiplies each component of the first challenge (E(x<sub>1</sub>), E(x<sub>2</sub>), ...E(x<sub>T</sub>)) by a corresponding component of the feature vector (y<sub>1</sub>, y<sub>2</sub>, ... y<sub>T</sub>), thereby calculating a T-dimensional vector (y<sub>1</sub>·(E(x<sub>1</sub>), y<sub>2</sub>·E(x<sub>2</sub>), ...y<sub>T</sub>·E(x<sub>T</sub>)). Due to the additive homomorphism of encryption, each component y<sub>i</sub>·E(x<sub>i</sub>) (i being each integer not less than 1 and less than T) of the calculated T-dimensional vector forms a ciphertext E(y<sub>i</sub>·x<sub>i</sub>) obtained by encryption transforming a product y<sub>i</sub>·x<sub>i</sub> of a component y<sub>i</sub> of the feature vector and a random number x<sub>j</sub>.<br/>
Theoretically, this ciphertext may be set to the first response without alternation. However, by doing so, the value of the feature vector may be able to be calculated, based on the relationship between the first challenge and the first response.<br/>
<!-- EPO <DP n="40"> -->The encrypted data embedding unit 217 performs randomization processing using the random numbers generated by the random number generation unit 215 in order to prevent this calculation of the value of the feature vector. The random numbers to be generated by the random number generation unit 215 are random numbers to be used for encrypting a plaintext. The encrypted data embedding unit 217 generates T ciphertexts E(0) obtained by encrypting a plaintext "0", using the random numbers generated by the random number generation unit 215. In the encryption system used by the biometric authentication system 100, a plurality of ciphertexts corresponding to one plaintext are present. Then, by randomly selecting one of the ciphertexts from among the plurality of ciphertexts, leakage of information on the plaintext from the ciphertexts is prevented. Accordingly, the plurality of ciphertexts E(0) corresponding to the plaintext "0" are also present. Usually, the T ciphertexts E(0) generated by the encrypted data embedding unit 217 are different to one another. Then, the T ciphertexts E(0) are respectively described as E0<sub>1</sub>, E0<sub>2</sub>, ..., and E0<sub>T</sub>. The encrypted data embedding unit 217 respectively combines the components of the calculated T-dimensional vector (y<sub>1</sub>·(E(x<sub>1</sub>), y<sub>2</sub>·E(x<sub>2</sub>), ...y<sub>T</sub>·E(x<sub>T</sub>)) and the calculated ciphertexts E0<sub>1</sub>, E0<sub>2</sub>, ..., and E0<sub>T</sub> by the group arithmetic operation on the finite group having the elements of ciphertexts, thereby calculating a T-dimensional vector (y<sub>1</sub>·E(x<sub>1</sub>) + E0<sub>1</sub>, y<sub>2</sub>·E(x<sub>2</sub>) + E0<sub>2</sub>, .., y<sub>T</sub>·E(x<sub>T</sub>) + E0<sub>T</sub>). Due to the additive homomorphism of encryption, each component y<sub>i</sub>·E(x<sub>i</sub>) + E0<sub>i</sub> (i being each integer not less than 1 and less than T) of the calculated T-dimensional vector forms a ciphertext E(y<sub>i</sub>·x<sub>i</sub>) obtained by encryption transforming the product y<sub>i</sub>·x<sub>i</sub> of the component y<sub>i</sub> of the feature vector and the random number x<sub>i</sub>.<!-- EPO <DP n="41"> --> This ciphertext is, however, different from the ciphertext before combining the ciphertext E0<sub>i</sub>.<br/>
This T-dimensional vector (y<sub>1</sub>·E(x<sub>1</sub>) + E0<sub>1</sub>, y<sub>2</sub>·E(x<sub>2</sub>) + E0<sub>2</sub>, .., y<sub>T</sub>·E(x<sub>T</sub>) + E0<sub>T</sub>) = (E (y<sub>1</sub>·x<sub>1</sub>), E(y<sub>2</sub>·x<sub>2</sub>), ...E(y<sub>T</sub>·x<sub>T</sub>)) is set to the first response.</p><p id="p0032" num="0032">In the encrypted biometric information extraction step S710, the encrypted data extraction unit 305 respectively calculates inverse elements (inverse numbers) of x<sub>1</sub><sup>-1</sup>, x<sub>2</sub><sup>-1</sup>, ..., X<sub>T</sub><sup>-1</sup> in multiplication of integers modulo q for the T pieces of random numbers x<sub>1</sub>, x<sub>2</sub>, ..., and x<sub>T</sub> stored by the random number storage unit 322. When q is a prime number, a finite ring having elements of the integers modulo q forms a field. Thus, the inverse elements are surely present. When q is not the prime number, the inverse elements in the multiplication may not be present. When q is sufficiently large, the possibility that the inverse elements are not present is extremely low, so that the possibility should be ignored.<br/>
The encrypted data extraction unit 305 respectively scalar multiplies components of the first response of (E (y<sub>1</sub>·x<sub>1</sub>), E(y<sub>2</sub>·x<sub>2</sub>), ...E(y<sub>T</sub>·x<sub>T</sub>)) by the calculated inverse elements, thereby calculating a T-dimensional vector (x<sub>1</sub><sup>-1</sup>·E(y<sub>1</sub>·x<sub>1</sub>), x<sub>2</sub><sup>-1</sup>·E(y<sub>2</sub>·x<sub>2</sub>), ...x<sub>T</sub><sup>-1</sup>·E(y<sub>T</sub>·x<sub>T</sub>)). Due to the additive homomorphism of encryption, each component x<sub>i</sub><sup>-1</sup>·E (y<sub>i</sub>·x<sub>i</sub>) of the calculated T-dimensional vector (i being each integer not less than 1 and less than T) forms a ciphertext E(y<sub>i</sub>) obtained by encryption transforming a component y<sub>i</sub> of the feature vector.<br/>
With this arrangement, the authentication apparatus 102 calculates the encrypted feature vector C'.</p><p id="p0033" num="0033">The inverse elements in the multiplication of the integers modulo q<!-- EPO <DP n="42"> --> can be readily calculated. Accordingly, when the random number x<sub>i</sub> is known, the inverse element x<sub>i</sub><sup>-1</sup> can be readily calculated. Consequently, it is easy to calculate the encrypted feature vector C' from the first response. However, when the random number x<sub>i</sub> is not known, it is virtually impossible to calculate the encrypted feature vector C' from the first response. That is, the random numbers as the plaintexts generated by the random number generation unit 303 in the first challenge generation step S701 constitute a secret key (temporary secret key) known by the authentication apparatus 102 alone. The first challenge obtained by encrypting the random numbers as the plaintexts constitute a public key (temporary public key) for generating the first response from the feature vector.<br/>
The first response is herein the one obtained by encrypting the feature vector with the public key of the authentication apparatus 102 and is also the one obtained by encrypting the feature vector with the public key pk of the decryption apparatus 103. It may be said that the first response is obtained by dually encrypting the feature vector. The authentication apparatus 102 can decrypt the first response with the secret key. However, the encrypted feature vector obtained by encrypting the feature vector with the public key pk of the decryption apparatus 103 is obtained as the result of the decryption. The secret key sk of the decryption apparatus 103 is needed in order to obtain the feature vector by further decrypting the encrypted feature vector. The authentication apparatus 102 does not know the secret key sk associated with the public key pk. Thus, the authentication device 102 cannot decrypt the encrypted feature vector C and the encrypted feature vector C'.<br/>
Even if a device that has spoofed the authentication apparatus 102 has<!-- EPO <DP n="43"> --> generated a set of a secret key sk' and a public key pk' and has generated the first challenge by encryption transformation using the generated public key pk' rather than generating the first challenge by encryption transformation using the public key pk of the decryption apparatus 103, the device cannot decrypt the encrypted feature vector C' from the first response. The ciphertext E0<sub>i</sub> is combined with each component of the first response by encryption transformation using the public key pk of the decryption apparatus 103. Thus, the first response becomes insignificant data that cannot be decrypted with any secret key when the encryption transformation is performed. That is, it is necessary that the public key stored by the certification apparatus 101 be the same as the public key stored by the authentication apparatus 102 in order for the first response to become significant data.</p><p id="p0034" num="0034">As the random numbers as well generated by the random number generation unit 303 of the authentication apparatus 102 in the second challenge generation step S712, there are two types of the random numbers, which are the random numbers as plaintexts and the random numbers to be used for encryption. The random numbers to be stored by the random number storage unit 322 of the authentication apparatus 102 in the random number storage step S713 should be only the random numbers as the plaintexts out of the two types of the random numbers.<br/>
The random numbers as the plaintexts generated by the random number generation unit 303 in the first challenge generation step S701 constitute the key (temporary secret key) for decrypting the first response. Similarly, the random numbers as the plaintexts generated by the random<!-- EPO <DP n="44"> --> number generation unit 303 in the second challenge generation step S712 constitute a key (temporary key) for decrypting the second response.<br/>
The relationship between the second challenge and the second response is, however, different from the relationship between the first challenge and the first response. The first challenge is the public key to be used only once by the authentication apparatus 102. The certification apparatus 101 dually encrypts the feature vector with the public key of the authentication apparatus 102 and the public key of the decryption apparatus 103, thereby generating the first response. On contrast therewith, the second challenge is encrypted data. The second challenge is data obtained by further encrypting data encrypted with the public key of the decryption apparatus 103 using the key of the authentication apparatus 102. That is, the second challenge is dually encrypted data. The decryption apparatus 103 decrypts the second challenge with the secret key of the decryption apparatus 103, thereby generating the second response. The decryption apparatus 103 decrypts the dually encrypted second challenge, thereby generating data encrypted with the key of the authentication apparatus 102 alone. The authentication apparatus 102 decrypts the second response with the key of the authentication apparatus 102, thereby obtaining the plaintext similarity degree.<br/>
Calculation for calculating the plaintext similarity degree is divided into some stages. The stages are respectively executed in the second challenge generation step S712, the second response generation step S716, and the like, for example. In the second challenge generation step S712, the authentication apparatus 102 executes a portion of the calculation for<!-- EPO <DP n="45"> --> calculating the similarity degree with the feature vectors kept encrypted. Accordingly, the authentication apparatus 102 cannot know the feature vectors in this stage. The second challenge is obtained by dually encrypting data in a state where the portion of the calculation has already been finished. Since the portion of the calculation is already finished, all of information on the original feature vectors is not included in the second challenge. Only information necessary for calculating the similarity degree is included in the second challenge. In the second response generation step S716, the decryption apparatus 103 decrypts the second challenge to derive data obtained by encrypting the information necessary for the calculation of the similarity degree with the key of the authentication apparatus 102. The decryption apparatus 103 executes a portion of the calculation for calculating the similarity degree with the data kept encrypted with the key of the authentication apparatus 102. Accordingly, the decryption apparatus 103 cannot know the feature vectors and the plaintext similarity degree in this stage. The second response is the one obtained by encrypting data in a state where almost all of the calculation has already been finished. Since almost all of the calculation is already finished, the information on the original feature vectors is not included in the second response. In the plaintext similarity degree calculation step S719, the authentication apparatus 102 decrypts the second response to calculate the similarity degree. The plaintext similarity degree itself is not derived before the plaintext similarity degree calculation step S719.<br/>
The plaintext similarity degree is information only indicating to what degree the feature vector b for registration is similar to the feature vector b'<!-- EPO <DP n="46"> --> for authentication. Thus, it is difficult to calculate the feature vectors and the biometric information from the plaintext similarity degree.</p><p id="p0035" num="0035">Next, a description will be given about an example where a specific encryption system has been used for details of processing in each stage. In this embodiment, the description will be directed to the example where the Okamoto-Takashima encryption system has been used.</p><p id="p0036" num="0036">First, the Okamoto-Takashima encryption system will be outlined.</p><p id="p0037" num="0037">Assume that q is a prime number not less than 2. Assume that G and G<sub>T</sub> are finite groups each having an order q. A group arithmetic operation on each of the finite groups G and G<sub>T</sub> will be described as multiplication. Assume that F<sub>q</sub> is a finite field having elements of integers not less than 0 and less than q. Assume that e is a pairing G × G →G<sub>T</sub> that maps a set of two elements of the finite group G to an element of the finite group G<sub>T</sub>. The pairing e satisfies bilinearity and non-degenerateness. The biliniearity is a property with which e(u<sup>a</sup>, v<sup>b</sup>) = e(u, v)<sup>ab</sup> is established for two arbitrary elements u, v in the finite group G and two arbitrary elements a,b in the finite group F<sub>q</sub>. The non-degerateness is a property with which at least one element g that satisfies e(g, g) ≠ 1 exists in elements of the finite group G. The pairing e may be an asymmetric pairing.</p><p id="p0038" num="0038">Assume that V is a direct product set G × G × ... G constituted from n pieces of the finite groups G.<br/>
With respect to addition "+" on the direct product set V, an element (g<sup>x1 + y1</sup>, g<sup>x2 + y2</sup>, ..., g<sup>xn + yn</sup>) of the direct product set V is defined as a coupling x + y by addition "+" of two arbitrary elements x = (g<sup>x1</sup>, g<sup>x2</sup>, ..., g<sup>xn</sup>) and y = (g<sup>y1</sup>, g<sup>y2</sup>, ..., g<sup>yn</sup>) on the direct product set V.<br/>
<!-- EPO <DP n="47"> -->With respect to scalar multiplication on the direct product set V, an element (g<sup>αx1</sup>, g<sup>αx2</sup>, ..., g<sup>αxn</sup>) on the direct product set V is defined as an element αx obtained by scalar multiplying an arbitrary element x = (g<sup>x1</sup>, g<sup>x2</sup>, .., g<sup>xn</sup>) on the direct product set V by an arbitrary element α on the definite field F<sub>q</sub>.<br/>
In this case, the direct product set V constitutes a vector space. Each element in the vector space V is called a "vector".</p><p id="p0039" num="0039">With respect to a pairing e: V × V →G<sub>T</sub> of the vector spaces V, an element Π<sub>i</sub> [e(u<sub>i</sub>, v<sub>i</sub>)(in which i∈{1, 2, ..., n}) on the finite group G<sub>T</sub> is defined as a pairing e (u, v) of two arbitrary vectors of u = (u<sub>1</sub>, u<sub>2</sub>, ..., u<sub>n</sub>) and v = (v<sub>1</sub>, v<sub>2</sub>, ..., v<sub>n</sub>) in the vector spaces V.</p><p id="p0040" num="0040">Further, "A" is defined as a sequence of n vectors (a<sub>1</sub>, a<sub>2</sub>, ..., a<sub>n</sub>) in the vector space V. Then, a vector a<sub>i</sub> = (a<sub>i1</sub>, a<sub>i2</sub>, ..., a<sub>in</sub>) is so defined that, when i= j, a<sub>ij</sub> = g , and when i ≠ j, a<sub>ij</sub> = 1 (1 is a unit element of the finite group G).<br/>
In this case, the "A" constitutes the base of the vector space V. The base A is called a canonical base.</p><p id="p0041" num="0041">With respect to a distortion map φ<sub>ij</sub>: V → V in the vector space V, a vector x<sub>j</sub>a<sub>i</sub> is defined as a distortion map φ<sub>ij</sub>(x) of an arbitrary vector x in the vector space V, assuming that the vector x = x<sub>1</sub>a<sub>i</sub> + x<sub>2</sub>a<sub>2</sub> + ... +x<sub>n</sub>a<sub>n</sub> and i and j are two arbitrary integers not less than 1 and less than n. It is also assumed that the distortion map φ<sub>ij</sub> can be efficiently calculated using a computer.</p><p id="p0042" num="0042">In the vector spaces V, there are the canonical bases, a pairing of the vector spaces is defined, and the distortion map that can be calculated is defined. The vector spaces as mentioned above are called bilinear pairing<!-- EPO <DP n="48"> --> vector spaces.</p><p id="p0043" num="0043">Assume that "X" is an n-dimensional i-row, j-column square matrix having elements of n<sup>2</sup> values of χ<sub>ij</sub> (each of i, j being each integer not less than 1 and less than n) uniform randomly selected from the finite field Fq. When the value of q is sufficiently large, the square matrix X will be a regular matrix at a very high probability.</p><p id="p0044" num="0044">"B" is defined to be a sequence of n vectors (b<sub>1</sub>, b<sub>2</sub>, ..., b<sub>n</sub>) in the vector space V, and it is defined that b<sub>i</sub> = Σ<sub>j</sub>[χ<sub>i</sub>, <sub>j</sub>a<sub>i</sub>] (in which i and j are each the integer not less than 1 and less than n). When the square matrix X is the regular matrix, "B" constitutes the base of the vector space V, like "A". The base B is called a random base.</p><p id="p0045" num="0045">In this case, the following property is established.<br/>
When elements (x<sub>1</sub>, x<sub>2</sub>, ..., x<sub>n</sub>) of a direct product F<sub>q</sub><sup>n</sup> of n pieces of the definite fields F<sub>q</sub> are given, a vector x = x<sub>1</sub>b<sub>1</sub> + x<sub>2</sub>b<sub>2</sub> + ...+x<sub>n</sub>b<sub>n</sub> in the vector space V can be easily calculated. When a vector x = x<sub>1</sub>b<sub>1</sub> + x<sub>2</sub>b<sub>2</sub> + ...+x<sub>L</sub>b<sub>L</sub> (L being an integer not less than 2 and less than n) in the vector V is given, a vector y = x<sub>1</sub>b<sub>1</sub> + x<sub>2</sub>b<sub>2</sub> + x<sub>1</sub>b<sub>1</sub> (1 being an integer not less than 1 and less than L) in the vector space V can be calculated, using the regular matrix X. However, when the regular matrix X is not used, it is difficult to calculate the vector y, which is as difficult as to perform a generalized Diffie-Hellman calculation.</p><p id="p0046" num="0046"><figref idrefs="f0007">Fig. 11</figref> is a flowchart diagram showing an example of a flow of a vector decomposition process S540 to solve the problem of vector decomposition, using the regular matrix X.<br/>
In the vector decomposition process S540, the vector x in the vector space V, vector components &lt;b<sub>1</sub>, b<sub>2</sub>, ..., b<sub>1</sub>&gt; to be extracted from the vector x,<!-- EPO <DP n="49"> --> the regular matrix X of n dimensions, and the random base B are input, and a vector y = Σ<sub>i</sub>Σ<sub>j</sub>Σ<sub>k</sub>[t<sub>i</sub>, <sub>j</sub>χ<sub>j</sub>, <sub>k</sub>φ<sub>k, i</sub>(x)] in the vector space V (in which i is an integer not less than 1 and not more than L, j is an integer not less than 1 and not more than 1, k is an integer not less than 1 and not more than L, and t<sub>j,j</sub> is a component in the ith column and the jth row of an inverse matrix T = X<sup>-1</sup> of the regular matrix X) is output. The vector decomposition process S540 includes an inverse matrix calculation step S541, a first initialization step S542, a first repetition step S543, a second initialization step S544, a second repetition step S545, a third initialization step S546, a third repetition step S547, a factor summation step S548, a map calculation step S549, a scalar multiplication step S550, and a vector summation step S551.</p><p id="p0047" num="0047">First, the inverse matrix X<sup>-1</sup> of the regular matrix X is calculated in the inverse matrix calculation step S541.<br/>
In the first initialization step S542, the element y of the vector space V is initialized to 0. The integer i is initialized to 0.<br/>
In the first repetition step S543, the integer i is incremented by 1. When the integer i is larger than the integer L, the element y is output, and the vector decomposition process S540 is finished. When the integer i is not more than L, the process proceeds to the second initialization step S544.<br/>
In the second initialization step S544, the integer k is initialized to 0.<br/>
In the second repetition step S545, the integer k is incremented by 1. When the integer k is larger than the integer L, the process returns to the first repetition step S543. When the integer k is not more than the integer L, the process proceeds to the third initialization step S546.<br/>
In the third initialization step S546, the integer j is initialized to 0,<!-- EPO <DP n="50"> --> and a factor κ is initialized to 0.<br/>
In the third repetition step S547, the integer j is incremented by 1. When the integer j is larger than the integer 1, the process proceeds to the map calculation step S549. When the integer j is not more than the integer 1, the process proceeds to the factor summation step S548.<br/>
In the factor summation step S548, the product of the component t<sub>i,j</sub> in the ith row and the jth column of the inverse matrix X<sup>-1</sup> calculated in the inverse matrix calculation step S541 and a componentχ<sub>j</sub>, <sub>k</sub> in the j-th row and the k-th column of the regular matrix X is calculated. The calculated product is added to the factor κ, and then the process returns to the third repetition step S547.<br/>
In the map calculation step S549, a distortion map φ<sub>k,i</sub>(x) of the vector x in the vector space V is calculated, and is then set to a vector φ.<br/>
In the scalar multiplication step S550, a vector φ' = κφ obtained by multiplying the vector φ = φ<sub>k,i</sub>(x) in the map calculation step S549 by κ is calculated.<br/>
In the vector summation step S551, the vector φ' = κφ<sub>k,i</sub>(x) calculated in the scalr multiplication step S550 is added to the vector y, and then the process returns to the second repetition step S545.</p><p id="p0048" num="0048">In the Okamoto-Takashima encryption system, the regular matrix X is used as a secret key, thereby realizing a trap door function.</p><p id="p0049" num="0049">Assume, for example, that an element m of the finite field F<sub>q</sub> is set to a plaintext and a vector mb<sub>1</sub> + r<sub>2</sub>b<sub>2</sub> + ...+r<sub>n</sub>b<sub>n</sub> in the vector space V is set to a ciphertext E(m) obtained by encrypting the plaintext m. Assume that r<sub>i</sub> (i being an integer not less than 2 and notmore than n) is set to an element<!-- EPO <DP n="51"> --> uniform randomly selected from the finite field F<sub>q</sub>. When performing decryption, the vector decomposition process S540 is performed to calculate a vector mb<sub>1</sub> in the vector space V from the ciphertext E(m), using the regular matrix X that is the secret key, thereby erasing r<sub>i</sub>, which is a randomization element.</p><p id="p0050" num="0050"><figref idrefs="f0007">Fig. 12</figref> is a detailed block diagram showing an example of a configuration of the key generation unit 401 in this embodiment.<br/>
The key generation unit 401 of the decryption apparatus 103 includes a group determination unit 421, a canonical base setting unit 422, a random number generation unit 423, a determinant calculation unit 424, a regular matrix setting unit 425, and a random base calculation unit 426, for example.<br/>
Using the processing device 911, the group determination unit 421 generates the prime number q, based on the size (number of bits) defined according to the security level. The larger the prime number q is, the higher safety is obtained. However, the ciphertext size increases, so that it takes time to perform encryption processing and decryption processing. The size of the prime number q is 200 bits, 1024 bits, or the like, for example. The group determination unit 421 determines the finite group G and the finite group G<sub>T</sub> based on the generated prime number q. Each of the finite group G and the finite group G<sub>T</sub> determined by the group determination unit 421 has the order of q, and the finite group G and the finite group G<sub>T</sub> have the pairing e: G × G → G<sub>T</sub>. The group determination unit 421 calculates a generator element g of the finite group G. The order of setting may be different. It may be so configured, for example, that the finite group G is first determined, the order of the finite group G is calculated, and then it is determined whether<!-- EPO <DP n="52"> --> the order of the finite group G is the prime number having a size that satisfies the security level.<br/>
Using the processing device 911, the canonical base setting unit 422 sets the vector space V of n dimensions, based on a dimension n defined according to the security level, thereby setting the canonical base A of the vector space V. The larger the dimension n is, the higher security is provided. However, the ciphertext size increases, so that it takes time to perform encryption processing and decryption processing. The dimension n is, for example, 3 or the like.<br/>
Using the processing device 911, the random number generation unit 423 generates n<sup>2</sup> pieces of random numbers χ<sub>i,j</sub> (each of i and j being each integer not less than 1 and not more than n) based on the order q of the finite group G determined by the group determination unit 421. The random numbers χ<sub>i,j</sub> generated by the random number generation unit 423 are integers uniform randomly selected from among integers not less than 0 and less than q.<br/>
Using the processing device 911, the determinant calculation unit 424 generates the square matrix X of n dimensions based on the n<sup>2</sup> pieces of random numbers χ<sub>i,j</sub> generated by the random number generation unit 423. The square matrix X generated by the determinant calculation unit 424 is a matrix of i rows and j columns each having elements of the random numbers χ<sub>i,j</sub>. The determinant calculation unit 424 calculates a determinant |X| of the generated square matrix X, using the processing device 911.<br/>
When the determinant |X| calculated by the determinant calculation unit 424 is not 0, the regular matrix setting unit 425 sets the square matrix X<!-- EPO <DP n="53"> --> generated by the determinant calculation unit 424 to a regular matrix X, using the processing device 911.<br/>
Using the processing device 911, the random base calculation unit 426 calculates the random base B based on the canonical base A set by the canonical base setting unit 422 and the regular matrix X set by the regular matrix setting unit 425. Each vector b<sub>i</sub> (i being each integer not less than 1 and not more than n) of the random base B calculated by the random base calculation unit 426 is given by b<sub>i</sub> =∑<sub>j</sub>[χ<sub>i</sub>,<sub>j</sub>a<sub>j</sub>] (j being each integer not less than 1 and not more than n). The random base calculation unit 426 calculates the ith vector b<sub>i</sub> of the random base B in the following manner, for example. The random base calculation unit 426 calculates a vector χ<sub>i</sub>, <sub>j</sub>a<sub>j</sub> obtained by scalar multiplying the vector a<sub>j</sub> by χ<sub>j, i</sub> in the vector space V for each integer j not less than 1 and not more than n, based on the element χ<sub>i,j</sub> in the ith row and the jth column of the regular matrix X and the jth vector a<sub>j</sub> of the canonical base A. The random base calculation unit 426 calculates a vector ∑<sub>j</sub>[χ<sub>i</sub>, <sub>j</sub>a<sub>j</sub>] obtained by combining calculated n vectors χ<sub>i</sub>, <sub>j</sub>a<sub>j</sub>, by addition in the vector space V.</p><p id="p0051" num="0051">The public key storage unit 403 of the decryption apparatus 103 stores as the public key pk, a set (q, V, e, G<sub>T</sub>, A, and B) of the order q, the pairing e, and the finite group G<sub>T</sub> set by the group setting unit 421, the vector space V and the canonical base A set by the canonical base setting unit 422, and the random base B set by the random base calculation unit 426.<br/>
Using the storage device 914, the secret key storage unit 413 of the decryption apparatus 103 stores the regular matrix X set by the regular matrix setting unit 425, as the secret key sk.</p><p id="p0052" num="0052"><figref idrefs="f0008">Fig. 13</figref> is a flow chart diagram showing an example of a flow of<!-- EPO <DP n="54"> --> processes of the key generation step S501 in this embodiment.<br/>
In the key generation step S501, the decryption apparatus 103 generates a set of the public key pk and the secret key sk. It may be so configured that a different set of the public key pk and the secret key sk is generated for each user. Alternatively, one set of the public key pk and the secret key sk may be generated for the overall system.<br/>
The key generation step S501 includes a group determination step S511, a canonical base setting step S512, a matrix generation step S513, a regular matrix determination step S514, and a random base calculation step S515, for example.</p><p id="p0053" num="0053">First, in the group determination step S511, the group determination unit 421 determines the order q, the finite group G and the finite group G<sub>T</sub> each having the order q, and the generator element g of the finite group G, using the processing device 911. The public key storage unit 403 stores the order q and the finite group G<sub>T</sub> determined by the group determination unit 421, as a part of the public key pk, using the storage device 914.<br/>
In the canonical base setting step S512, the canonical base setting unit 422 sets the vector space V and the canonical base A of the vector space V, based on the finite group G determined by the group determination unit 421 in the group determination step S511, using the processing device 911. The public key storage unit 403 stores the vector space V and the canonical base A set by the canonical base setting unit 422, as a part of the public key pk, using the storage device 914.<br/>
In the matrix generation step S513, the random number generation unit 423 generates the n<sup>2</sup> random numbers χ<sub>i, j</sub>, using the processing device<!-- EPO <DP n="55"> --> 911. The determinant calculation unit 424 generates the n-dimensional square matrix X, based on the n<sup>2</sup> random numbers χ<sub>i, j</sub>, generated by the random number generation unit 423.<br/>
In the regular matrix determination step S514, the determinant calculation unit 424 calculates the determinant |X| of the square matrix X generated in the matrix generation step S513, using the processing device 911.<br/>
When the determinant |X| calculated by the matrix calculation unit 424 is 0, the determinant calculation unit 424 causes the process to return to the matrix generation step S513, and the random number generation unit 423 generates random numbers again.<br/>
When the determinant |X| calculated by the matrix calculation unit 424 is not 0, the regular matrix setting unit 425 sets the square matrix X as the regular matrix X, using the processing device 911. The secret key storage unit 413 stores the regular matrix X set by the regular matrix setting unit 425 as the secret key sk, using the storage device 914.<br/>
In the random base calculation step S515, using the processing device 911, the random base calculation unit 426 calculates the random base B, based on the canonical base A set by the canonical base setting unit 422 in the canonical base setting step S512 and the regular matrix X set by the regular matrix setting unit 425 in the regular matrix determination step S514. Using the storage device 914, the public key storage unit 403 stores the random base B calculated by the random base calculation unit 426, as a part of the public key pk.</p><p id="p0054" num="0054">The public key pk = (q, V, e, G<sub>T</sub>, A, B) stored by the public key storage unit 403 in this manner is transmitted to each of the authentication<!-- EPO <DP n="56"> --> apparatus 102 and the like by the public key transmitting unit 408. Each of the authentication apparatus 102 and the like receives and then stores the transmitted public key.</p><p id="p0055" num="0055"><figref idrefs="f0008">Fig. 14</figref> is a flow chart diagram showing an example of a flow of processes of the feature vector encryption step S603 in this embodiment.<br/>
In the feature vector encryption step S603, the registration apparatus 104 encrypts the feature vector b to generate the encrypted feature vector C. The feature vector encryption step S603 includes an initialization step S610, a repetition step S611, a random number generation step S612, and a vector calculation step S613, for example.</p><p id="p0056" num="0056">The feature vector b formed by the feature vector formation unit 204 of the registration apparatus 104 and then encrypted by the encryption data generation unit 206 is a T-dimensional vector (b<sub>1</sub>, b<sub>2</sub>, .., b<sub>T</sub>) (T being an integer not less than 1) having components of integers, for example. Each component b<sub>i</sub> (i being each integer not less than 1 and not more than T) is one of two values of 0 and 1, for example, and indicates whether or not the biometric information has a feature corresponding to the component. The feature vector formation unit 204 divides an image (indicating biometric information) obtained by applying light to the fingerprint to shoot the pattern by the biometric information extraction unit 203 into T regions, and then determines whether or not a feature point (such as an end point or a branch point of the pattern) is present in each of the divided regions, for example. The feature vector formation unit 204 sets 0 or 1 to the feature vector component corresponding to the region. 0 indicates that the feature point exists. 1 indicates that the feature point does not exist<br/>
<!-- EPO <DP n="57"> -->The encrypted feature vector C is a T-dimensional vector (c<sub>1</sub>, c<sub>2</sub>, ..., c<sub>T</sub>) having components of vectors in the vector space V.</p><p id="p0057" num="0057">First, in the initialization step S610, the encrypted data generation unit 206 initializes the integer i to 0, using the processing device 911.<br/>
In the repetition step 611, the encrypted data generation unit 206 adds 1 to the integer i, using the processing device 911. When the integer i is larger than T, the encrypted data generation unit 206 finishes the feature vector encryption step S603. When the integer i is not more than T, the encrypted data generation unit 206 causes the process to proceed to the random number generation step S612 to generate an ith component c<sub>i</sub> of the encrypted feature vector C.<br/>
In the random number generation step S612, the random number generation unit 205 generates (n - 1) pieces of random numbers r<sub>j, i</sub> (j being each integer not less than 2 and not more than n), based on the order q which is a part of the public key pk stored by the public key storage unit 202. The random numbers r<sub>j, i</sub> generated by the random number generation unit 205 are integers uniform randomly selected from among integers not less than 0 and less than q.<br/>
In the vector calculation step S613, using the processing device 911, the encrypted data generation unit 206 calculates the ith component c<sub>i</sub> of the encrypted feature vector C, based on the random base B which is the part of the public key pk stored by the public key storage unit 202, an ith component b<sub>i</sub> of the feature vector b generated by the feature vector formation unit 204, and the (n - 1) pieces of random numbers r<sub>j, i</sub> generated by the random number generation unit 205 in the random number generation step S612. The ith<!-- EPO <DP n="58"> --> component c<sub>i</sub> of the encrypted feature vector C calculated by the encrypted data generation unit 206 is a vector b<sub>i</sub>b<sub>1</sub> + ∑<sub>j</sub>[r<sub>j,i</sub>b<sub>j</sub>](j being each integer not less than 2 and not more than n) obtained by combining a vector b<sub>i</sub>b<sub>1</sub> and (n - 1) vectors r<sub>j,i</sub>b<sub>j</sub> by addition in the vector space V. The vector b<sub>i</sub>b<sub>1</sub> is obtained by scalar multiplying a first vector b<sub>1</sub> of the random base B by an integer b<sub>i</sub> using scalar multiplication in the vector space V. The (n - 1) vectors r<sub>j,i</sub>b<sub>j</sub> are each obtained by scalar multiplying a vector b<sub>j</sub> (j being each integer not less than 2 and not more than n) of the second and subsequent vectors of the random base B by the random number r<sub>j,i</sub> by scalar multiplication in the vector space V. To take an example, the encrypted data generation unit 206 calculates the vector b<sub>i</sub>b<sub>1</sub> by scalar multiplying the first vector b<sub>1</sub> of the random base B by the integer b<sub>i</sub> using scalar multiplication in the vector space V, based on the first vector b<sub>1</sub> of the random base B and ith component b<sub>i</sub> of the feature vector b. Based on a jth vector b<sub>j</sub> of the random base B and a (j-1)th random number r<sub>j, i</sub> of the (n - 1) pieces of random numbers generated by the random number generation unit 205, the encrypted data generation unit 206 calculates the vector r<sub>j,i</sub>b<sub>j</sub> by scalar multiplying the vector b<sub>j</sub> by the random number r<sub>j,i</sub> by scalar multiplication in the vector space V, for each integer j not less than 2 and not more than n. The encrypted data generation unit 206 calculates the vector b<sub>i</sub>b<sub>1</sub> + ∑<sub>j</sub>[r<sub>j,i</sub>b<sub>j</sub>](j being each integer not less than 2 and not more than n) by combining the calculated vector b<sub>i</sub>b<sub>1</sub> and all of the calculated (n - 1) vectors r<sub>j,i</sub>b<sub>j</sub>, by addition in the vector space V.<br/>
The encrypted data generation unit 206 causes the process to return to the repetition process S611 to generate the subsequent component of the encrypted feature vector C.<!-- EPO <DP n="59"> --></p><p id="p0058" num="0058">The encrypted feature vector C generated by the encrypted data generation unit 206 in this manner is transmitted to the authentication apparatus 102 by the encrypted data transmitting unit 201. The authentication apparatus 102 receives and then stores the encrypted feature vector C.</p><p id="p0059" num="0059"><figref idrefs="f0009">Fig. 15</figref> is a flow chart diagram showing an example of a flow of processes of the first challenge generation step S701 in this embodiment.<br/>
In the first challenge generation step S701, the authentication apparatus 102 generates a first challenge R. The first challenge generation step S701 includes an initialization step S729, a repetition step S721, a random number generation step S722, and a vector calculation step S723, for example.<br/>
The first challenge R generated by the encrypted random number generation unit 304 of the authentication apparatus 102 is a T-dimensional vector (R<sub>1</sub>, R<sub>2</sub>, ..., R<sub>T</sub>) having components of vectors in the vector space V.</p><p id="p0060" num="0060">First, in the initialization step S729, the encrypted random number generation unit 304 initializes the integer i to 0, using the processing device 911.<br/>
In the repetition step S721, the encrypted random number generation unit 304 adds 1 to the integer i, using the processing device 911. When the integer i is larger than T, the encrypted random number generation unit 304 finishes the first challenge generation step S701. When the integer i is not more than T, the encrypted random number generation unit 304 causes the process to proceed to the random generation step S722 to generate an ith component R<sub>i</sub> of the first challenge R.<br/>
<!-- EPO <DP n="60"> -->In the random number generation step S722, the random number generation unit 303 generates n pieces of random numbers R<sub>j, i</sub> (j being each integer not less than 1 and not more than n), based on the order q which is the part of the public key pk stored by the public key storage unit 302. The random numbers R<sub>j, i</sub> generated by the random number generation unit 303 are integers uniform randomly selected from among integers not less than 0 and less than q. The random number storage unit 322 stores a first random number R<sub>1, j</sub> of the n pieces of random numbers R<sub>j, i</sub> generated by the random number generation unit 303, using the storage device 914.<br/>
In the vector calculation step S723, using the processing device 911, the encrypted random number generation unit 304 calculates the ith component R<sub>i</sub> of the first challenge R, based on the random base B which is the part of the public key pk stored by the public key storage unit 302 and the n pieces of random numbers R<sub>j, i</sub> generated by the random number generation unit 303 in the random number generation step S722. The ith component R<sub>i</sub> of the first challenge R calculated by the encrypted random number generation unit 304 is a vector ∑<sub>j</sub>[R<sub>j,i</sub>b<sub>j</sub>](j being each integer not less than 1 and not more than n) obtained by combining n vectors R<sub>j,i</sub>b<sub>j</sub> by addition in the vector space V. The n vectors R<sub>j, i</sub>b<sub>j</sub> are each obtained by scalar multiplying each vector b<sub>j</sub> (j being each integer not less than 1 and not more than n) by the random number R<sub>j, i</sub> by scalar multiplication in the vector space C. To take an example, based on the jth vector b<sub>j</sub> of the random base B and a jth random number R<sub>j,i</sub> of the n pieces of random numbers generated by the random number generation unit 205, the encrypted random number generation unit 304 calculates the vector R<sub>j,i</sub>b<sub>j</sub> by scalar multiplying the vector b<sub>j</sub> by the<!-- EPO <DP n="61"> --> random number R<sub>j,i</sub> by scalar multiplication in the vector space V, for each integer j not less than 1 and not more than n. The encrypted random number generation unit 304 calculates the vector ∑<sub>j</sub>[R<sub>j,i</sub>b<sub>j</sub>](j being each integer not less than 1 and not more than n) by combining the calculated n vectors R<sub>j,i</sub>b<sub>j</sub> by addition in the vector space V.<br/>
The encrypted random number generation unit 304 causes the process to return to the repetition process S721 to generate the subsequent component of the first challenge R.</p><p id="p0061" num="0061">The first challenge R generated by the encrypted random number generation unit 304 in this manner is transmitted to the certification apparatus 101 by the first challenge transmitting unit 311. The certification apparatus 101 receives and then stores the first challenge R.</p><p id="p0062" num="0062">The number of the random numbers R<sub>j, i</sub> (i being each integer not less than 1 and not more than T. j being each integer not less than 1 and not more than n) generated by the random number generation unit 303 in the first challenge generation step S701 is nT in total. Out of these nT pieces of random numbers, T pieces of random numbers R<sub>1, i</sub> (i being each integer not less than 1 and not more than T) are stored by the random number storage unit 322. The T pieces of random numbers R<sub>j, i</sub> stored by the random number storage unit 322 are random numbers as plaintexts, and the remaining (n - 1) T pieces of random numbers R<sub>j, i</sub> (i being each integer not less than 1 and not more than T. j being each integer not less than 2 and not more than n) are random numbers for encryption. Each component R<sub>i</sub> of the first challenge R is obtained by encrypting the random number R<sub>1,i</sub> as a plaintext.</p><p id="p0063" num="0063"><figref idrefs="f0009">Fig. 16</figref> is a detailed block diagram showing an example of a<!-- EPO <DP n="62"> --> configuration of the encrypted data embedding unit 217 in this embodiment.<br/>
The encrypted data embedding unit 217 of the certification apparatus 101 includes a scalar multiplication calculation unit 231, zero generation unit 232, and a vector combining unit 233, for example.</p><p id="p0064" num="0064">The feature vector b' generated by the feature vector formation unit 314 and encrypted by the encrypted data embedding unit 217 is a T-dimensional vector (b'<sub>1</sub>, b'<sub>2</sub>, ..., b'<sub>T</sub>) having components of integers, like the feature vector b generated by the feature vector formation unit 204 of the registration apparatus 104.<br/>
Using the processing device 911, the random number generation unit 215 generates (n - 1) T pieces of random numbers R'<sub>j, i</sub> (i being each integer not less than 1 and not more than T, j being each integer not less than 2 and not more than n) based on the order q which is the part of the public key pk stored by the public key storage unit 212. The random numbers R'<sub>j, i</sub> generated by the random number generation unit 215 are integers random uniformly selected from among integers not less than 0 and less than q.</p><p id="p0065" num="0065">Using the processing device 911, the scalar multiplication calculation unit 231 calculates a scalar multiplication vector <img id="ib0001" file="imgb0001.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> based on the first challenge R received by the first challenge receiving unit 211 and the feature vector b' formed by the feature vector formation unit 214. The scalar multiplication vector is a T-dimensional vector having components of vectors (<img id="ib0002" file="imgb0002.tif" wi="7" he="4" img-content="character" img-format="tif" inline="yes"/> <img id="ib0003" file="imgb0003.tif" wi="7" he="4" img-content="character" img-format="tif" inline="yes"/> ..., <img id="ib0004" file="imgb0004.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/>) in the vector space V, like the first challenge R. An ith component <img id="ib0005" file="imgb0005.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> (i being the integer not less than 1 and not more than T) of the scalar multiplication vector calculated by the scalar multiplication calculation unit 231 is a vector b'<sub>i</sub>R<sub>i</sub> obtained by scalar multiplying the ith component R<sub>i</sub><!-- EPO <DP n="63"> --> of the first challenge R by an ith component b'<sub>i</sub> of the feature vector b' by scalar multiplication in the vector space V. Each component of the scalar multiplication vector <img id="ib0006" file="imgb0001.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> is obtained by encrypting the product of the component b'<sub>i</sub> of the feature vector b' and the random number R<sub>1,j</sub> as the plaintexts generated by the authentication apparatus 102.</p><p id="p0066" num="0066">Using the processing device 911, the zero generation unit 232 generates an encrypted zero vector O, based on the random base B which is the part of the public key pk stored by the public key storage unit 202 and the (n - 1) pieces of random numbers R'<sub>j, i</sub> generated by the random number generation unit 215. The encrypted zero vector O is a T-dimensional vector (o<sub>1</sub>, o<sub>2</sub>, ..., o<sub>T</sub>) having components of vectors in the vector space V. An ith component o<sub>i</sub> of the encrypted zero vector O (i being the integer not less than 1 and not more than T) is a vector ∑<sub>j</sub>[R'<sub>j,i</sub>b<sub>j</sub>](j being each integer not less than 2 and not more than n) obtained by combining (n - 1) vectors R'<sub>j,i</sub>b<sub>j</sub> by addition in the vector space V. The (n - 1) vectors R'<sub>j,i</sub>b<sub>i</sub> are obtained by respectively scalar multiplying second to nth vectors b'<sub>j</sub> (j being each integer not less than 2 and not more than n) of the random base B by the random numbers R'<sub>j,i</sub> by scalar multiplication in the vector space V. Each component of the encrypted zero vector O is obtained by encrypting 0.<br/>
Using the processing device 911, the vector combining unit 233 calculates a first response R', based on the scalar multiplication vector<img id="ib0007" file="imgb0001.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the scalar multiplication calculation unit 231 and the encrypted zero vector O generated by the zero generation unit 232. The first response R' is a T-dimensional vector (R'<sub>1</sub>, R'<sub>2</sub>, ..., R'<sub>T</sub>) having components of vectors in the vector space V. An ith component R'<sub>i</sub> (i being the integer not less than<!-- EPO <DP n="64"> --> 1 and not more than T) of the first response R' is a vector obtained by combining the ith component <img id="ib0008" file="imgb0005.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> of the scalar multiplication vector <img id="ib0009" file="imgb0001.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> and the ith component o<sub>i</sub> of the encrypted zero vector O by addition in the vector space V. Each component R'<sub>i</sub> of the first response R' is obtained by encrypting the product of the random number R<sub>1, j</sub> as the plaintext encrypted in the component R<sub>i</sub> of the first challenge R and the component b'<sub>i</sub> of the feature vector b'.</p><p id="p0067" num="0067"><figref idrefs="f0010">Fig. 17</figref> is a flowchart diagram showing an example of a flow of processes of the first response generation step S707 in this embodiment.<br/>
In the first response generation step S707, the certification apparatus 101 generates the first response R', based on the feature vector b' and the first challenge R. The first response generation step S707 includes an initialization step S660, a repetition step S661, a scalar multiplication step S662, a random number generation step S663, a zero generation step S664, and a vector combining step S665, for example.</p><p id="p0068" num="0068">First, in the initialization step S660, the vector combining unit 233 initializes the integer i to 0, using the processing device 911.<br/>
In the repetition step 661, the vector combining unit 233 adds 1 to the integer i, using the processing device 911. When the integer i is larger than T, the vector combining unit 233 finishes the first response generation step S707. When the integer i is not more than T, the vector combining unit 233 causes the process to proceed to the scalar multiplication step S662 to generate the ith component R'<sub>i</sub> of the first response R'.<br/>
In the scalar multiplication step S662, using the processing device 911, the scalar multiplication calculation unit 231 calculates the ith<!-- EPO <DP n="65"> --> component <img id="ib0010" file="imgb0005.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> of the scalar multiplication vector <img id="ib0011" file="imgb0011.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> which is expressed by <img id="ib0012" file="imgb0005.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> = b'<sub>i</sub>R<sub>i</sub>, based on the ith component b'<sub>i</sub> of the feature vector b' generated by the feature vector formation unit 214 and the ith vector R<sub>i</sub> of the first challenge R received by the first challenge receiving unit 211.<br/>
In the zero generation step S663, using the processing device 911, the random number generation unit 215 generates (n - 1) pieces of random numbers R'<sub>j, i</sub> (j being each integer not less than 2 and not more than n).<br/>
In the zero generation step S664, using the processing device 911, the zero generation unit 232 calculates the ith component o<sub>i</sub> of the encrypted zero vector O, which is expressed by o<sub>i</sub> = ∑<sub>j</sub>[R'<sub>j,i</sub>b<sub>j</sub>](j being each integer not less than 2 and not more than n), based on the (n - 1) pieces of random numbers R'<sub>j,i</sub> generated by the random number generation unit 215 in the random number generation step S663. To take an example, based on the vector b<sub>j</sub> of the random base B and the (j - 1)th random number R'<sub>j,i</sub> of the (n - 1) pieces of random numbers generated by the random number generation unit 215, the zero generation unit 232 calculates the vector R'<sub>j,i</sub>b<sub>j</sub> by scalar multiplying the vector b<sub>j</sub> by the random number R'<sub>j,i</sub> by scalar multiplication in the vector space V, for each integer j not less than 2 and not more than n. The zero generation unit 232 calculates the vector ∑<sub>j</sub>[R'<sub>j,i</sub>b<sub>j</sub>] by combining the calculated (n - 1) vectors R'<sub>j,i</sub>b<sub>j</sub> by addition in the vector space V.<br/>
In the vector combining step S665, the vector combining unit 233 calculates the ith component R'<sub>i</sub> of the first response, which is expressed by R'<sub>i</sub> = <img id="ib0013" file="imgb0005.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> + o<sub>i</sub> = b'<sub>i</sub>R<sub>i</sub> + ∑<sub>j</sub>[R'<sub>j,i</sub>b<sub>j]</sub>, based on the ith component of the scalar multiplication vector <img id="ib0014" file="imgb0005.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> given by <img id="ib0015" file="imgb0005.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> = b'<sub>i</sub>R<sub>i</sub> calculated by the scalar multiplication calculation unit 231 in the scalar multiplication step S662 and<!-- EPO <DP n="66"> --> the ith component o<sub>i</sub> of the encrypted zero vector O given by o<sub>i</sub> = ∑<sub>j</sub>[R'<sub>j,i</sub>b<sub>j</sub>] (j being each integer not less than 2 and not more than n) calculated by the zero generation unit 232 in the zero generation step S664.<br/>
The vector combining unit 233 causes the process to return to the repetition process S611 to generate the subsequent component of the first response R'.</p><p id="p0069" num="0069">The first response R' generated by the encrypted data embedding unit 217 in this manner is transmitted to the authentication apparatus 102 by the first response transmitting unit 221, and the authetication apparatus 102 receives and then processes the first response R'.</p><p id="p0070" num="0070">When the component b'<sub>i</sub> of the feature vector b' takes only one of two values of 1 and 0, processing in the first response generation step S707 may be simplified as follows, for example.<br/>
First, there is no need for scalar multiplication. Thus, the scalar multiplication calculation unit 231 is not provided, so that the scalar multiplication step S662 is not executed.<br/>
In the vector combining step S665, the vector combining unit 233 determines whether or not the value of the ith component b'<sub>i</sub> of the feature vector b' is 0 or 1, using the processing device 911. When the value of the ith component b'<sub>i</sub> of the feature vector b' is 0, the vector combining unit 233 sets the ith component o<sub>i</sub> of the encrypted zero vector given by o<sub>i</sub> = ∑<sub>j</sub>[R'<sub>j,i</sub>b<sub>j</sub>] calculated by the zero generation unit 232 in the zero generation step S664 to the ith component R'<sub>i</sub> of the first response R', using the processing device 911. When the value of the ith component b'<sub>i</sub> of the feature vector b' is 1, the vector combining unit 233 calculates a vector o<sub>i</sub> + R<sub>i</sub> = R<sub>i</sub> + ∑<sub>j</sub>[R'<sub>j,i</sub>b<sub>j</sub>] by<!-- EPO <DP n="67"> --> combining the ith component o<sub>i</sub> of the encrypted zero vector O given by o<sub>i</sub> = ∑<sub>j</sub>[R'<sub>j,i</sub>b<sub>j</sub>] calculated by the zero generation unit 232 in the zero generation step S664 and the ith component R<sub>i</sub> of the first challenge R received by the first challenge receiving unit 211 and sets the calculated vector to the ith component R'<sub>i</sub> of the first response R'.</p><p id="p0071" num="0071">Since the ith component R<sub>i</sub> of the first challenge R is ∑<sub>j</sub>[R<sub>j,i</sub>b<sub>j</sub>] (j being each integer not less than 1 and not more than n), the ith component R'<sub>i</sub> of the first response R' is expressed by R'<sub>i</sub> = b'<sub>i</sub>∑<sub>k</sub>[R<sub>k,i</sub>b<sub>j</sub>] + ∑<sub>j</sub>[R'<sub>j,i</sub>b<sub>j</sub>] (j being each integer not less than 2 and less than n, and k being each integer not less than 1 and less than n) = b'<sub>i</sub>R<sub>1,i</sub>b<sub>1</sub> + ∑<sub>j</sub>[b'<sub>i</sub>R<sub>j,i</sub> + R'<sub>j,i</sub>)b<sub>j</sub>] (j being each integer not less than 2 and not more than n). That is, the ith component R'<sub>i</sub> of the first response R' is obtained by encrypting the product of the ith component b'<sub>i</sub> of the feature vector b' and the random number R<sub>1, i</sub>.</p><p id="p0072" num="0072"><figref idrefs="f0010">Fig. 18</figref> is a detailed block diagram showing an example of a configuration of the encrypted data extraction unit 305 in this embodiment.<br/>
The encrypted data extraction unit 305 of the authentication apparatus 102 includes an inverse number calculation unit 351 and a scalar multiplication calculation unit 352, for example.</p><p id="p0073" num="0073">The encrypted feature vector C' generated by the encrypted data extraction unit 305 of the authentication apparatus 102 is a T-dimensional vector (c'<sub>1</sub>, c'<sub>2</sub>, ..., c'<sub>T</sub>) having components of vectors in the vector space V, like the encrypted feature vector C generated by the encrypted data generation unit 206 of the registration apparatus 104.</p><p id="p0074" num="0074">Based on the T pieces of random numbers R<sub>1, i</sub> (i being each integer not less than 1 and not more than T) stored by the random number storage unit<!-- EPO <DP n="68"> --> 322, the inverse number calculation unit 351 calculates an inverse element κ<sub>i</sub> = R<sub>1, i</sub><sup>-1</sup> of each of the T pieces of random numbers R<sub>1, i</sub>, by multiplication on the finite field F<sub>q</sub>, using the processing device 911. The inverse element κ<sub>i</sub> is an integer where, when the product of the random number R<sub>1,i</sub> and the inverse element κ<sub>i</sub> is divided by q, the remainder is 1. The encrypted data extraction unit 305 calculates the inverse element κ<sub>i</sub> by computing the reminder by dividing the (q - 2)th power of the random number R<sub>1, i</sub> by q, for example.<br/>
Using the processing device 911, the scalar multiplication calculation unit 352 calculates the encrypted feature vector C', based on the first response R' received by the first response receiving unit 331 and T pieces of the inverse elements κ<sub>i</sub> calculated by the inverse number calculation unit 351. An ith component c'<sub>i</sub> (i being the integer not less than 1 and not more than T) of the encrypted feature vector C' calculated by the scalar multiplication calculation unit 352 is a vector κ<sub>i</sub>R'<sub>i</sub> obtained by scalar multiplying the ith component R'<sub>i</sub> of the first response R' by the ith inverse element κ<sub>i</sub> by scalar multiplication in the vector space V. Each component c'<sub>i</sub> of the encrypted feature vector C' is obtained by encrypting the component b'<sub>i</sub> of the feature vector b'.</p><p id="p0075" num="0075"><figref idrefs="f0011">Fig. 19</figref> is a flow chart diagram showing an example of a flow of processes of the encrypted biometric information extraction step S710 in this embodiment.<br/>
In the encrypted biometric information extraction step S710, the authentication apparatus 102 generates the encrypted feature vector C', based on the first response R'. The encrypted biometric information extraction step S710 includes an initialization step S730, a repetition step S731, an inverse number calculation step S732, and a scalar multiplication step S773,<!-- EPO <DP n="69"> --> for example.</p><p id="p0076" num="0076">First, in the initialization step S730, using the processing device 911, the scalar multiplication calculation unit 352 initializes the integer i to 0.<br/>
In the repetition step S731, the scalar multiplication calculation unit 352 adds 1 to the integer i, using the processing device 911. When the integer i is larger than T, the scalar multiplication calculation unit 352 finishes the encrypted biometric information extraction step S710. When the integer i is not more than T, the scalar multiplication calculation unit 352 causes the process to proceed to the inverse number calculation step S732 to generate the ith component c'<sub>i</sub> of the encrypted feature vector C'.<br/>
In the inverse number calculation step S732, using the processing device 911, the inverse number calculation unit 351 calculates the inverse element κ<sub>i</sub> = R<sub>1, i</sub><sup>-1</sup> of the ith random number R<sub>1, i</sub> out of the T pieces of random numbers stored by the random number storage unit 322 in the first challenge generation step S701, based on the random number R<sub>1, i</sub> and using multiplication on the finite field F<sub>q</sub>.<br/>
In the scalar multiplication step S733, using the processing device 911, the scalar multiplication calculation unit 352 calculates the ith component c'<sub>i</sub> = κ<sub>i</sub>R'<sub>i</sub> of the encrypted feature vector C', based on the ith component R'<sub>i</sub> of the first response R' received by the first response receiving unit 331 and the inverse element κ<sub>i</sub> calculated in the inverse number calculation step S732.<br/>
The scalar multiplication calculation unit 253 causes the process to return to the repetition step S731 to generate the subsequent component of the encrypted feature vector C'.<!-- EPO <DP n="70"> --></p><p id="p0077" num="0077">The encrypted feature vector C' generated by the encrypted data extraction unit 305 in this manner is used in the second challenge generation step S712.</p><p id="p0078" num="0078">The ith component R'<sub>i</sub> of the first response R' is expressed by R'<sub>i</sub> = b'<sub>i</sub>R<sub>1, i</sub>b<sub>1</sub> + ∑[(b'<sub>i</sub>R<sub>j,i</sub> + R'<sub>j, i</sub>) b<sub>j</sub>] (j being each integer not less than 2 and not more than n). Thus, the ith component c'<sub>i</sub> of the encrypted feature vector C' is given by c'<sub>i</sub> = R<sub>1, i</sub><sup>-1</sup>b'<sub>i</sub>R<sub>1, i</sub>b<sub>1</sub> + R<sub>1, i</sub><sup>-1</sup>∑[(b'<sub>i</sub>R<sub>j, i</sub> + R'<sub>j,i</sub>)b<sub>j</sub>] (j being each integer not less than 2 and not more than n). Since R<sub>1, i</sub>R<sub>1, i</sub><sup>-1</sup> ≡ 1(mod q), c' <sub>i</sub> = b'<sub>i</sub>b<sub>1</sub> + R<sub>1, i</sub><sup>-1</sup>∑[(b'<sub>i</sub>R<sub>j, i</sub> + R'<sub>j,</sub>i)b<sub>j</sub>] (j being each integer not less than 2 and not more than n) holds. That is, the ith component c'<sub>i</sub> of the encrypted feature vector C' is obtained by encrypting the ith component b'<sub>i</sub> of the feature vector b'.</p><p id="p0079" num="0079"><figref idrefs="f0012">Fig. 20</figref> is a detailed block diagram showing an example of a configuration of the encrypted random similarity degree calculation unit 314 in this embodiment.<br/>
The encrypted random similarity degree calculation unit 314 of the authentication apparatus 102 includes a difference calculation unit 361, a disturbance vector generation unit 362, a vector combining unit 363, a scalar multiplication calculation unit 364, a square summation calculation unit 365, an encryption key generation unit 366, and a vector summation unit 367, for example.</p><p id="p0080" num="0080">Using the processing device 911, the random number generation unit 303 generates n(T + 1) pieces of random numbers t<sub>j,i</sub>, and u<sub>j</sub> (i being each integer not less than 1 and not more than T, and j being each integer not less than 1 and not more than n), based on the order q which is the part of the<!-- EPO <DP n="71"> --> public key pk stored by the public key storage unit 302. The random numbers t<sub>j,i</sub>, and u<sub>j</sub> generated by the random number generation unit 303 are integers uniform randomly selected from among integers not less than 0 and less than q.<br/>
The random number storage unit 322 stores one random number u<sub>1</sub> out of the random numbers generated by the random number generation unit 303, using the storage device 914.</p><p id="p0081" num="0081">Using the processing device 911, the difference calculation unit 361 calculates an encrypted difference vector ΔC, based on the encrypted feature vector C stored by the encrypted data storage unit 312 and the encrypted feature vector C' extracted by the encrypted data extraction unit 305. The encrypted difference vector C is a T-dimensional vector (Δc<sub>1</sub>, Δc<sub>2</sub>, ..., Δc<sub>T</sub>) having components of vectors in the vector space V. An ith component Δc<sub>i</sub> (i being the integer not less than 1 and not more than T) of the encrypted difference vector C is a vector c<sub>i</sub> - c'<sub>i</sub> obtained by combining an ith component c<sub>i</sub> of the encrypted feature vector C and an inverse vector -c'<sub>i</sub> of an ith component c'<sub>i</sub> of the encrypted feature vector C' by addition in the vector space V. Each component Δc<sub>i</sub> of the encrypted difference vector ΔC is obtained by encrypting a difference b<sub>i</sub> - b'<sub>i</sub> between the component b<sub>i</sub> of the feature vector b and the component b'<sub>i</sub> of the feature vector b'.<br/>
The ith component Δc<sub>i</sub> of the encrypted difference vector C may be a vector c'<sub>i</sub> -c<sub>i</sub> obtained by combining an inverse vector -c<sub>i</sub> of the ith component c<sub>i</sub> of the encrypted feature vector C and the ith component c'<sub>i</sub> of the encrypted feature vector C' by addition in the vector space V. The component Δc<sub>i</sub> of the encrypted difference vector ΔC may be a randomly selected one of the<!-- EPO <DP n="72"> --> vector c<sub>i</sub> - c'<sub>i</sub> and the vector c'<sub>i</sub> - c<sub>i</sub>.<br/>
Using the processing device 911, the disturbance vector generation unit 362 generates a disturbance vector T, based on the random base B which is the part of the public key pk stored by the public key storage unit 302 and nT pieces of random numbers t<sub>j,i</sub> of the random numbers generated by the random number generation unit 303. The disturbance vector T is a T-dimensional vector (t<sub>1</sub>, t<sub>2</sub>, ..., t<sub>T</sub>) having components of vectors in the vector space V. Each component t<sub>i</sub> (i being each integer not less than 1 and not more than T) of the disturbance vector T is a vector ∑<sub>j</sub>[t<sub>j,i</sub>b<sub>j</sub>](j being each integer not less than 1 and not more than n) obtained by combining n vectors t<sub>j,i</sub>b<sub>j</sub> by addition in the vector space V. The n vectors t<sub>j,i</sub>b<sub>j</sub> are each obtained by scalar multiplying each vector b<sub>j</sub> (j being each integer not less than 1 and not more than n) of the random base B by the random number t<sub>j,i</sub>, by scalar multiplication in the vector space V. Each component t<sub>i</sub> of the disturbance vector T is obtained by encrypting the random number t<sub>1, i</sub> as a plaintext.<br/>
Using the processing device 911, the vector combining unit 363 calculates T vectors c^<sub>i</sub> (i being each integer not less than 1 and not more than T) which are a part of a second challenge C^, based on the encrypted difference vector ΔC calculated by the difference calculation unit 361 and the disturbance vector T calculated by the disturbance vector generation unit 362. The vectors c^<sub>i</sub> are vectors in the vector space V. The ith vector c^<sub>i</sub> is a vector Δc<sub>i</sub> + t<sub>i</sub> obtained by combining the ith component Δc<sub>i</sub> of the encrypted difference vector C and the ith component t<sub>i</sub> of the disturbance vector T, by addition in the vector space V. The vector c^<sub>i</sub> is obtained by encrypting a sum of (b<sub>i</sub> - b'<sub>i</sub>) + t<sub>1, i</sub> of a difference between the component b<sub>i</sub> of the feature<!-- EPO <DP n="73"> --> vector b and the component b'<sub>i</sub> of the feature vector b' and the random number t<sub>1, i</sub> as the plaintext.<br/>
Using the processing device 911, the scalar multiplication calculation unit 364 calculates a scalar multiplication vector C, based on the encrypted difference vector ΔC calculated by the difference calculation unit 361 and the T pieces of random numbers t<sub>1,i</sub> as the plaintexts out of the random numbers generated by the random number generation unit 303. The scalar multiplication vector is a T-dimensional vector (<img id="ib0016" file="imgb0016.tif" wi="7" he="5" img-content="character" img-format="tif" inline="yes"/> <img id="ib0017" file="imgb0017.tif" wi="7" he="5" img-content="character" img-format="tif" inline="yes"/> ..., <img id="ib0018" file="imgb0018.tif" wi="7" he="5" img-content="character" img-format="tif" inline="yes"/>) having components of vectors in the vector space V. The ith component <img id="ib0019" file="imgb0019.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> (i being the integer not less than 1 and not more than T) of the scalar multiplication vector calculated by the scalar multiplication calculation unit 364 is a vector 2t<sub>1,i</sub>Δ c<sub>i</sub> obtained by scalar multiplying the ith component c<sub>i</sub> of the encrypted difference vector ΔC by twice the ith random number t<sub>1,i</sub> of the T pieces of random numbers as the plaintexts, by scalar multiplication in the vector space V. Each component <img id="ib0020" file="imgb0019.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> of the scalar multiplication vector <img id="ib0021" file="imgb0021.tif" wi="5" he="5" img-content="character" img-format="tif" inline="yes"/> calculated by the scalar multiplication calculation unit 364 is obtained by encrypting a product 2t<sub>1,i</sub> (b - b') of 2t<sub>1,i</sub> and the difference between the component b<sub>i</sub> of the feature vector b and the component b'<sub>i</sub> of the feature vector b'.<br/>
Using the processing device 911, the square summation calculation unit 365 calculates a square summation ∑, based on the T pieces of random numbers T<sub>1,i</sub> as the plaintexts out of the random numbers generated by the random number generation unit 303. The square summation ∑ is a value ∑<sub>i</sub>[t<sub>1, i</sub><sup>2</sup>] (i being each integer not less than 1 and not more than T) obtained by summating the squares of the T pieces of random numbers t<sub>1,i</sub>.<br/>
Using the processing device 911, the encryption key generation unit<!-- EPO <DP n="74"> --> 366 calculates an encryption key <img id="ib0022" file="imgb0022.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> based on the random base B which is the part of the public key pk stored by the public key storage unit 302 and the n pieces of random numbers u<sub>j</sub> of the random numbers generated by the random number generation unit 303. The encryption key <img id="ib0023" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> is a vector in the vector space V. The encryption key <img id="ib0024" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> is a vector (u<sub>1</sub> + ∑)b<sub>1</sub> + ∑<sub>j</sub>[u<sub>j</sub>b<sub>i</sub>] (j being each integer not less than 1 and not more than n) obtained by combining a vector (u<sub>1</sub> + ∑)b<sub>1</sub> and (n - 1) vectors u<sub>j</sub>b<sub>j</sub> by addition in the vector space V. The vector (u<sub>1</sub> + ∑)b<sub>1</sub> is obtained by scalar multiplying the first vector b<sub>1</sub> of the random base B by the sum of the first random number u<sub>1</sub> of the n pieces of random numbers u<sub>1</sub> and the square summation ∑, by scalar multiplication in the vector space V. The (n - 1) vectors u<sub>j</sub>b<sub>j</sub> are obtained by respectively scalar multiplying the second and subsequent vectors b<sub>j</sub> (j being each integer not less than 2 and not more than n) of the random base B by the second and subsequent random numbers u<sub>j</sub> of the n pieces of random numbers u<sub>j</sub>, by scalar multiplication in the vector space V. To take an example, the encryption key generation unit 366 calculates a sum u<sub>1</sub> + ∑ of the random number u<sub>1</sub> generated by the random number generation unit 303 and the square summation ∑ calculated by the square summation calculation unit 365. The encryption key generation unit 366 calculates a vector (u<sub>1</sub> + ∑)b<sub>1</sub> by scalar multiplying the first vector b<sub>1</sub> of the random base B by the calculated sum u<sub>1</sub> + ∑ by scalar multiplication in the vector space V. The encryption key generation unit 366 calculates the vector u<sub>j</sub>b<sub>j</sub> by scalar multiplying the ith vector b<sub>j</sub> of the random base B by the random number u<sub>j</sub> generated by the random number generation unit 303, by scalar multiplication in the vector space V, for each integer j not less than 2 and not more than n. The<!-- EPO <DP n="75"> --> encryption key generation unit 366 calculates the vector (u<sub>1</sub> + ∑ )b<sub>1</sub> + ∑<sub>j</sub>[u<sub>j</sub>b<sub>j</sub>] (j being each integer not less than 1 and not more than n) by combining the calculated vector (u<sub>1</sub> + ∑)b<sub>1</sub> and the calculated (n - 1) vectors u<sub>j</sub>b<sub>j</sub>, by addition in the vector space V.<br/>
Using the processing device 911, the vector summation unit 367 calculates one vector c^ which is a part of the second challenge C^, based on the scalar multiplication vector <img id="ib0025" file="imgb0021.tif" wi="5" he="5" img-content="character" img-format="tif" inline="yes"/> calculated by the scalar multiplication calculation unit 364 and the encryption key <img id="ib0026" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the encryption key generation unit 366. The vector c^ is a vector ∑<sub>i</sub>[2t<sub>1, i</sub> Δc<sub>i</sub>] + (u<sub>1</sub> +∑)b<sub>1</sub> +∑<sub>j</sub>[u<sub>j</sub>b<sub>j</sub>](i being each integer not less than 1 and not more than T, and j being each integer not less than 1 and not more than n) by combining the T vectors<img id="ib0027" file="imgb0019.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> = 2t<sub>1, i</sub>Δc<sub>i</sub> (i being each integer not less than 1 and not more than T) which are the components of the scalar multiplication vector calculated by the scalar multiplication calculation unit 364 and the encryption key <img id="ib0028" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> = (u<sub>1</sub> + ∑)b<sub>1</sub> + ∑<sub>j</sub>[u<sub>j</sub>b<sub>j</sub>](j being each integer not less than 1 and not more than n). The vector c^ is obtained by encrypting an inclusive sum u<sub>1</sub> +∑<sub>i</sub>[2t<sub>1</sub>, <sub>i</sub>(b<sub>i</sub> - b'<sub>i</sub>) + t<sub>1, i</sub><sup>2</sup>] which is the inclusive sum of the random number u<sub>1</sub> and a summation of the square of t<sub>1, i</sub> and the product of 2t<sub>1, i</sub> and the difference between the component b<sub>i</sub> of the feature vector b and the component b'<sub>j</sub> of the feature vector b'. The random number u<sub>1</sub> of these components of the vector c^ is a random number as a temporary key for encrypting and decrypting a similarity degree. ∑<sub>i</sub>[2t<sub>1, i</sub> (b; - b'<sub>i</sub>) + t<sub>1,i</sub><sup>2</sup>], which is the component other than the random number u<sub>1</sub> is information for removing disturbance by the random numbers t<sub>1,i</sub> as the plaintexts to enable calculation of an encrypted similarity degree.<!-- EPO <DP n="76"> --></p><p id="p0082" num="0082">The second challenge C^ generated by the encrypted random similarity degree calculation unit 314 is constituted from (T + 1) vectors obtained by combining T vectors c^<sub>i</sub> (i being each integer not less than 1 and not more than T) calculated by the vector combining unit 363 and one vector c^ calculated by the vector summation unit 367.<br/>
The sequence of the first T vectors c^<sub>i</sub> of the second challenge C^ may be different from the sequence of the components of the feature vectors b and b'.</p><p id="p0083" num="0083"><figref idrefs="f0013">Fig. 21</figref> is a flow chart diagram showing an example of a flow of processes of the second challenge generation step S712 in this embodiment.<br/>
In the second challenge generation step S712, the authentication apparatus 102 generates the second challenge C^, based on two encrypted feature vectors C and C'. The second challenge generation step S712 includes an initialization step S740, a repetition step S741, a difference calculation step S742, a random number generation step S743, a disturbance vector generation step S744, a vector combining step S745, a scalar multiplication step S746, a vector summation step S747, a square summation step S748, a random number generation step S749, an encryption key generation step S750, and a vector summation step S751, for example.</p><p id="p0084" num="0084">First, in the initialization step S740, using the processing device 911, the vector combining unit 363 initializes the integer i to 0 and initializes the vector c" to 0 (zero vector in the vector space V). The square summation calculation unit 365 initializes the square summation ∑ to 0, using the processing device 911.<br/>
In the repetition step S741, using the processing device 911, the<!-- EPO <DP n="77"> --> vector combining unit 363 adds 1 to the integer i. When the integer i is larger than T, the vector combining unit 363 causes the process to proceed to the random number generation step S749. When the integer i is not more than T, the vector combining unit 363 causes the process to the difference calculation step S742, thereby generating the ith vector c^<sub>i</sub> of the second challenge C^.<br/>
In the difference calculation step S742, using the processing device 911, the difference calculation unit 361 calculates the ith component Δc<sub>i</sub> of the encrypted difference vector ΔC based on the ith component c<sub>i</sub> of the encrypted feature vector C stored by the encrypted data storage unit 312 and the ith component c'<sub>i</sub> of the encrypted feature vector C' extracted by the encrypted data extraction unit 305.<br/>
In the random number generation step S743, the random number generation unit 303 generates n pieces of random numbers t<sub>j,i</sub> (j is the integer not less than 1 and not more than n), using the processing device 911.<br/>
In the disturbance vector generation step S744, using the processing device 911, the disturbance vector generation unit 362 calculates the ith component t<sub>i</sub> = ∑<sub>j</sub>[t<sub>j,i</sub>b<sub>j</sub>](j being each integer not less than 1 and not more than n) of the disturbance T, based on the n pieces of random numbers t<sub>j, i</sub> generated by the random number generation unit 303 in the random generation step S743.<br/>
In the vector combining step S745, using the processing device 911, the vector combining unit 363 calculates an ith vector c^<sub>i</sub> = Δ c<sub>i</sub> + t<sub>i</sub>, based on the ith component of Δ c<sub>i</sub> of the encrypted difference vector Δ C calculated by the difference calculation unit 361 in the difference calculation step S742 and<!-- EPO <DP n="78"> --> the ith component t<sub>i</sub> of the disturbance vector T calculated by the disturbance vector generation unit 362 in the disturbance vector generation step S744.<br/>
When the order of the first T vectors c^<sub>i</sub> of the second challenge C^ and the order of the components of the feature vectors b and b' are configured to be different, the vector combining unit 363 performs the following operations, for example. The vector combining unit 363 generates a sequence where the integers not less than 1 and not more than T are randomly rearranged, in the initialization step S740. In the vector combining step S745, the vector combining unit 363 obtains an ith integer in that sequence and sets the ith integer to the integer j, and sets the calculated vector c<sub>i</sub> + t<sub>i</sub> to the j th vector c^<sub>i</sub> of the second challenge C^.<br/>
In the scalar multiplication step S746, using the processing device 911, the scalar multiplication calculation unit 364 calculates the ith component <img id="ib0029" file="imgb0019.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/>=t<sub>1,i</sub>Δ c<sub>i</sub> of the scalar multiplication vector <img id="ib0030" file="imgb0030.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> based on the ith component Δc<sub>i</sub> of the encrypted difference vector C calculated by the difference calculation unit 361 in the difference calculation step S742 and the first random number t<sub>1, i</sub> of the n pieces of random numbers t<sub>j, i</sub> generated by the random number generation unit 303 in the random number generation step S743.<br/>
In the vector summation step S747, using the processing device 911, the vector summation unit 367 combines the vector <img id="ib0031" file="imgb0019.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> with the vector c^, based on the ith component <img id="ib0032" file="imgb0019.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/>=t<sub>1,i</sub> Δ c<sub>i</sub> of the scalar multiplication vector<img id="ib0033" file="imgb0021.tif" wi="5" he="5" img-content="character" img-format="tif" inline="yes"/> calculated by the scalar multiplication calculation unit 364 in the scalar multiplication step S746, by addition in the vector space V.<br/>
In the square summation step S748, using the processing device 911,<!-- EPO <DP n="79"> --> based on the first t<sub>1, i</sub> of the n pieces of random numbers t<sub>j, i</sub> generated by the random number generation unit 303 in the random number generation step S743, the square summation calculation unit 365 calculates the square t<sub>1, i</sub><sup>2</sup> of the random number t<sub>1,i</sub> by multiplication on the finite field F<sub>q</sub>,. Then, the square summation calculation unit 365 combines the calculated square t<sub>1, i</sub><sup>2</sup> with the square summation ∑, by addition on the finite filed F<sub>q</sub>.<br/>
The vector combining unit 363 causes the process to return to the repetition step S741 to generate the subsequent vector of the second challenge C'.</p><p id="p0085" num="0085">In the random number generation step S749, using the processing device 911, the random number generation unit 303 generates the n pieces of random numbers u<sub>j</sub> (j being each integer not less than 1 and not more than n). The random number storage unit 322 stores the random number u<sub>1</sub> which is the random number out of the n pieces of random numbers generated by the random number generation unit 303, as the temporary key.<br/>
In the encryption key generation step S750, using the processing device 911, the encryption key generation unit 366 generates the encryption key <img id="ib0034" file="imgb0022.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> based on the square summation ∑ summated by the square summation calculation unit 365 in the square summation step S748 and the n pieces of random numbers u<sub>j</sub> generated by the random number generation unit 303 in the random number generation step S749.<br/>
In the vector summation step S751, using the processing device 911, the vector summation unit 367 combines the encryption key <img id="ib0035" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> with the vector c^ by addition in the vector space V, based on the encryption key <img id="ib0036" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> generated by the encryption key generation unit 366 in the encryption key generation<!-- EPO <DP n="80"> --> step S750. With this arrangement, the (T + 1)th vector c^ of the second challenge C^ is completed, and the second challenge C^ is also completed.</p><p id="p0086" num="0086">The second challenge C^ calculated by the encrypted random similarity degree calculation unit 314 in this manner is transmitted to the decryption apparatus 103 by the second challenge transmitting unit 321, and the decryption apparatus 103 receives and then processes the transmitted second challenge C^.</p><p id="p0087" num="0087"><figref idrefs="f0014">Fig. 22</figref> is a detailed block diagram of a configuration of the decryption apparatus 404 in this embodiment.<br/>
The decryption unit 404 of the decryption apparatus 103 includes an inverse matrix calculation unit 471, a vector decomposition unit 472, a square calculation unit 473, a group conversion unit 474, and an element combining unit 475, for example.</p><p id="p0088" num="0088">Using the processing device 911, the inverse matrix calculation unit 471 calculates the inverse matrix X<sup>-1</sup> of the regular matrix X in the finite field Fq, based on the order q which is the part of the public key pk stored by the public key storage unit 403 and the regular matrix X which is the secret key sk stored by the secret key storage unit 413.<br/>
Using the processing device 911, the vector decomposition unit 472 calculates (T + 1) decryption vectors y<sub>i</sub> and y (i being each integer not less than 1 and not more than T), based on the regular mateix X which is the secret key sk stored by the secret key storage unit 413, the second challenge C^ received by the second challenge receiving unit 402, and the inverse matrix X<sup>-1</sup> calcualted by the inverse matrix calculation unit 471. The decryption vectors y<sub>i</sub> and y are vectors in the vector space. An ith decryption vector y<sub>i</sub><!-- EPO <DP n="81"> --> (i being the integer not less than 1 and not more than T) is a vector obtained by decomposing the ith vector c^<sub>i</sub> of the second challenge C^ into a linear combination of the random base B, and then removing a component applied to each of the second and subsequent vectors b<sub>j</sub> (j being each integer not less than 2 and not more than n) to be the vector scalar multiplied by the first vector b<sub>1</sub> of the random base B. The decryption vector y is a vector obtained by decomposing the (T + 1)th vector c^ of the second challenge C^ into a linear combination of the random base B, and then removing a component applied to each of the second and subsequent vectors b<sub>j</sub> (j being each integer not less than 2 and not more than n) to be the vector scalar multiplied by the first vector b<sub>1</sub> of the random base B. The vector decomposition unit 472 calculates the decryption vectors y<sub>i</sub> and y by the vector decomposition process S540 shown in <figref idrefs="f0007">Fig. 11</figref>, for example. Since the ith vector c^<sub>i</sub> (i being the integer not less than 1 and not more than T) of the second challenge C^ is Δc<sub>i</sub> + t<sub>i</sub>, the ith decryption vector y<sub>i</sub> becomes (b<sub>i</sub> - b'<sub>i</sub> + t<sub>i, i</sub>)b<sub>1</sub>. Since the (T + 1)th vector c^ of the second challenge C^ is ∑<sub>i</sub>[2t<sub>1,i</sub>Δc<sub>i</sub>] + (∑<sub>i</sub>[t<sub>1, i</sub><sup>2</sup>])b<sub>1</sub> + ∑<sub>j</sub>[u<sub>j</sub>b<sub>j</sub>](i being each integer not less than 1 and not more than T, and j being each integer not less than 1 and not more than n), the decryption vector y becomes (u<sub>1</sub> + ∑<sub>i</sub>[2t<sub>1,i</sub>(b<sub>i</sub> - b'<sub>i</sub>) + t<sub>1, i</sub><sup>2</sup>])b<sub>1</sub>.<br/>
Using the processing device 911, the square calculation unit 473 calculates T pieces of square elements y'<sub>i</sub> (i being each integer not less than 1 and not more than T), based on the pairing e which is a part of the public key pk stored by the public key storage unit 403 and the T decryption vectors y<sub>i</sub> calculated by the vector decomposition unit 472. The square elements y'<sub>i</sub> are elements of the finite group G<sub>T</sub>. The ith square element y'<sub>i</sub> (i being the<!-- EPO <DP n="82"> --> integer not less than 1 and not more than T) is an element e(y<sub>i</sub>, y<sub>i</sub>) obtained by translation of a set of the ith decryption vectors y<sub>i</sub> by the pairing e. Since the ith decryption vector y<sub>i</sub> is (b<sub>i</sub> - b'<sub>i</sub> + t<sub>1, i</sub>)b<sub>1</sub>, the ith square element y'<sub>i</sub> is an element obtained by exponentiating the element e(b1, b<sub>1</sub>) of the finite group G<sub>T</sub> by the square of (b<sub>i</sub> - b'<sub>i</sub> + t<sub>1,i</sub>), by exponentiation on the finite group G<sub>T</sub>, due to bilinearity of the pairing e. The element e(b1, b<sub>1</sub>) of the finite group G<sub>T</sub> is obtained by translation of a set of the first vectors b<sub>1</sub> of the random base B by the pairing e.<br/>
Using the processing device 911, the group conversion unit 474 calculates a translation element y', based on the pairing e and the random base B which are the parts of the public key pk stored by the public key storage unit 403 and decryption vector y calculated by the vector decomposition unit 472. The translation element y' is an element of the finite group G<sub>T</sub>. The translation element y' is an element e(y, b<sub>1</sub>) obtained by translation of a set of the decryption vector y and the first vector b<sub>1</sub> of the random base B by the pairing e. The decryption vector y is expressed by (u<sub>1</sub> + ∑<sub>i</sub>[2t<sub>1, i</sub>(b<sub>i</sub> - b'<sub>i</sub>) + t<sub>1, i</sub><sup>2</sup>])b<sub>1</sub>. Thus, the translation element y' is an element obtained by exponentiating the element e(b1, b<sub>1</sub>) of the finite group G<sub>T</sub> by (u<sub>1</sub> + ∑<sub>i</sub>[2t<sub>1, i</sub>(b<sub>i</sub>-b'<sub>i</sub>) + t<sub>1, i</sub><sup>2</sup>])(i being each integer not less than 1 and not more than T) by exponentiation in the unite group G<sub>T</sub>, due to binearlity of the pairing e .<br/>
Using the processing device 911, the element combining unit 475 calculates a second response Z based on the finite group G<sub>T</sub> which is a part of the public key pk stored by the public key storage unit 403, the T pieces of square elements y'<sub>i</sub> calculated by the square calculation unit 473, and the translation element y' calculated by the group conversion unit 474. The<!-- EPO <DP n="83"> --> second response Z is an element of the finite group G<sub>T</sub>. The second response Z calculated by the element combining unit 475 is an element obtained by combining the T pieces of square elements y'<sub>i</sub> and an inverse element y'<sup>-1</sup> of the translation element y' by multiplication on the finite group G<sub>T</sub>. The second response Z is an element obtained by exponentiating the element(b<sub>1</sub>, b<sub>1</sub>) of the finite group G<sub>T</sub> by (∑<sub>i</sub>[(b<sub>i</sub> - b'<sub>i</sub>) <sup>2</sup>] - u<sub>1</sub>)(i being each integer not less than 1 and not more than T) by exponentiation on the finite group G<sub>T</sub>. That is, the second response Z is the one obtained by encrypting the square of the Euclidean distance between the feature vector b and the feature vector b', which is given by ∑<sub>i</sub>[(b<sub>i</sub> - b'<sub>i</sub>) <sup>2</sup>], by the random number u<sub>1</sub> as the temporary key.</p><p id="p0089" num="0089"><figref idrefs="f0014">Fig. 23</figref> is a flowchart diagram showing a flow of processes of the second response generation step S716 in this embodiment.<br/>
In the second response generation step S716, the decryption apparatus 103 generates the second response Z from the second challenge C^. The second response generation step S716 includes an inverse matrix calculation step S561, a vector decomposition step S566, a group conversion step S567, an initialization step S560, a repetition step S562, a vector decomposition step S563, a square calculation step S564, and an element combining step S565, for example.</p><p id="p0090" num="0090">First, in the inverse matrix calculation step S561, using the processing device 911, the inverse matrix calculation unit 471 calculates the inverse matrix X<sup>-1</sup> of the regular matrix X which is the secret key sk stored by the secret key storage unit 413. It may be so configured that, using the processing device 911, the inverse matrix calculation unit 471 calculates the<!-- EPO <DP n="84"> --> inverse matrix X<sup>-1</sup> in advance (e.g., in the setup process S500), and stores the calculated inverse matrix X<sup>-1</sup>, using the storage device 914.<br/>
In the vector decomposition step S566, using the processing device 911, the vector decomposition unit 472 vector-decomposes the last vector c^ of the second challenge C^ received by the second challenge receiving unit 402, based on the inverse matrix X<sup>-1</sup> calculated by the inverse matrix calculation unit 471 in the inverse matrix calculation step S561 and the like, thereby calculating the decryption vector y.<br/>
In the group conversion step S567, using the processing device 911, the group conversion unit 474 calculates the translation element y', based on the decryption vector y calculated by the vector decomposition unit 472 in the vector decomposition step S566.<br/>
In the initialization step S560, using the processing device 911, the element combining unit 475 initializes the integer i to 0, and initializes the second response Z to the inverse element y'<sup>-1</sup> of the translation element y' by multiplication on the finite group G<sub>T</sub>.<br/>
In the repetition step S562, using the processing device 911, the element combining unit 475 adds 1 to the integer i. When the integer i is larger than T, the second response Z has been completed. Thus, the element combining unit 475 finishes the second response generation step S716. When the integer i is not more than T, the element combining unit 475 causes the process to proceed to the vector decomposition step S563.<br/>
In the vector decomposition step S563, using the processing device 911, the vector decomposition unit 472 vector-decomposes the ith vector c^<sub>i</sub> of the second challenge C^ received by the second challenge receiving unit 402<!-- EPO <DP n="85"> --> based on the inverse matrix X<sup>-1</sup> calculated by the inverse matrix calculation unit 471 in the inverse matrix calculation step S561, thereby calculating the ith decryption vector y<sub>i</sub>.<br/>
In the square calculation step S564, using the processing device 911, the square calculation unit 473 calculates the ith square element y'<sub>i</sub> = e(y<sub>i</sub>, y<sub>i</sub>), based on the ith decryption vector y<sub>i</sub> calculated by the vector decomposition unit 472 in the vector decomposition step S563.<br/>
In the element combining step S565, using the processing device 911, the element combining unit 475 combines the ith square element y'<sub>i</sub> with the second response Z, by multiplication on the finite group G<sub>T</sub>, based on the ith square element y'<sub>i</sub> calculated by the square calculation unit 473 in the square calculation step S564.<br/>
The element combining unit 475 causes the process to return to the repetition step S562 to process the subsequent vector of the second challenge C'.</p><p id="p0091" num="0091">The second response Z generated by the decryption unit 404 in this manner is transmitted to the authentication apparatus 102 by the second response transmitting unit 412. Then, the authentication apparatus 102 receives and then processes the second response Z.</p><p id="p0092" num="0092"><figref idrefs="f0015">Fig. 24</figref> is a detailed block diagram showing an example of a configuration of the plaintext similarity degree extraction unit 315 in this embodiment.<br/>
The plaintext similarity degree extraction unit 315 of the authentication apparatus 102 includes a group conversion unit 371, an element combining unit 372, and a discrete logarithm calculation unit 373, for<!-- EPO <DP n="86"> --> example.<br/>
Using the processing device 911, the group conversion unit 371 calculates a decryption key <img id="ib0037" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> based on the pairing e and the random base B which are the parts of the public key pk stored by the public key storage unit 302 and the random number u<sub>1</sub> as the temporary key stored by the random storage unit 322. The decryption key <img id="ib0038" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> is an element of the finite group G<sub>T</sub>. The decryption key <img id="ib0039" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the group conversion unit 371 is an element e(b<sub>1</sub>, b<sub>1</sub>)<sup>u1</sup> obtained by expotentiating the element e(b<sub>1</sub>, b<sub>1</sub>) by the random number u<sub>1</sub> by expotentiation on the finite group G<sub>T</sub>. The element e(b<sub>1</sub>, b<sub>1</sub>)<sup>u1</sup> is obtained by translation of the set of the first vectors b<sub>1</sub> of the random base B by the pairing e.<br/>
Using the processing device 911, the element combining unit 372 calculates a decrypted similarity degree element Z', based on the finite group G<sub>T</sub> which is the part of the public key pk stored by the public key storage unit 302, the second response Z received by the second response receiving unit 341, and the decryption key <img id="ib0040" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the group conversion unit 371. The decrypted similarity degree element Z' is an element of the finite group G<sub>T</sub>. The decrypted similarity degree element Z' is an element obtained by combining the second response Z and the decryption key <img id="ib0041" file="imgb0022.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> by multiplication on the finite group G<sub>T</sub>. The second response Z is an element obtained by exponentiating the element e (b<sub>1</sub>, b<sub>1</sub>) of the finite group G<sub>T</sub> by [∑<sub>i</sub>(b<sub>i</sub> - b'<sub>i</sub>)<sup>2</sup>] - u<sub>1</sub>) (i being each integer not less than 1 and not more than T). Thus, the decrypted similarity degree element Z' is an element obtained by expotentiating the element e (b<sub>1</sub>, b<sub>1</sub>) of the finite group G<sub>T</sub> by [∑<sub>i</sub>(b<sub>i</sub> - b'<sub>i</sub>)<sup>2</sup>]-u<sub>1</sub>) (i being each integer not less than 1 and not more than T), using<!-- EPO <DP n="87"> --> exponentiation on the finite group G<sub>T</sub>.<br/>
Using the processing device 911, the discrete logarithm calculation unit 373 calculates a similarity degree d, based on the pairing e and the random base B which are the parts of the public key pk stored by the public key storage unit 302 and the decrypted similarity degree element Z' calculated by the element combining unit 372. The similarity degree d is an element of the finite field F<sub>q</sub>. The similarity degree d calculated by the discrete logarithm calculation unit 373 determines to what power the element e (b<sub>1</sub>, b<sub>1</sub>) of the finite group G<sub>T</sub> is raised to be equal to the decrypted similarity degree element Z' by exponentiation on the finite group G<sub>T</sub>.<br/>
Calculation of the similarity degree d from the decrypted similarity degree element Z' by the discrete logarithm calculation unit 373 is to solve a so-called discrete logarithm problem. Thus, it is generally difficult to calculate the similarity degree d. However, when the range of the similarity degree d is limited in advance, it becomes possible to calculate the similarity degree d. To take an example, it should be so arranged that, for each integer d in this range, an element e(b<sub>1</sub>, b<sub>1</sub>)<sup>d</sup> obtained by exponentiating the e(b<sub>1</sub>, b<sub>1</sub>) by the integer d is calculated in advance, and then, it is determined which integer d causes the element e(b<sub>1</sub>, b<sub>1</sub>)<sup>d</sup> to be equal to the decrypted similarity degree element Z'.<br/>
The similarity degree d is the square of the Euclidean distance between the two feature vectors b and b'. Thus, it indicates that the smaller the similarity degree d is, the more the two feature vectors b and b' are similar. To take an example, the determination unit 306 compares the similarity degree d with a predetermined threshold value do, and then determines that the two<!-- EPO <DP n="88"> --> feature vectors b and b' are similar when the similarity degree d is smaller than the threshold value do. For this reason, it is not necessary to know the specific value of the similarity degree d. It should be known whether the similarity degree d is larger or smaller than the threshold value do.<br/>
The threshold value do is an integer far smaller than the order q, and is on the order of several hundreds to several ten thousands, for example.<br/>
When each component of each of the feature vectors b and b' is 0 or 1, the square of the Euclidean distance between the two feature vectors b and b' becomes an integer not less than 0 and not more than T. In this case, unless the threshold value do is an integer smaller than the order T of each feature vector, it is determined that the two feature vectors b and b' are similar in all cases. Thus, the determination using this comparison does not make sense.<br/>
It is easy to calculate the element e(b<sub>1</sub>, b<sub>1</sub>)<sup>d</sup> in advance, for each integer d not less than 0 and not more than do. By doing so, the discrete logarithm unit 373 can calculate the similarity degree d when the similarity degree d is not more than do. When the similarity degree d is larger than do, the discrete logarithm unit 373 cannot calculate the similarity degree d, but can determine that the similarity degree d is larger than do.</p><p id="p0093" num="0093"><figref idrefs="f0015">Fig. 25</figref> is a flow chart diagram showing an example of a flow of processes of the plaintext similarity degree calculation step S719 in this embodiment.<br/>
In the plaintext similarity degree calculation step S719, the authentication apparatus 102 calculates the similarity degree d from the second response Z. The plaintext similarity degree calculation step S719 includes a group conversion step S691, an element combining step S692, and a<!-- EPO <DP n="89"> --> discrete logarithm calculation step S693, for example.</p><p id="p0094" num="0094">First, in the group conversion step S691, using the processing device 911, the group conversion unit 371 calculates the decryption key <img id="ib0042" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> = e(b<sub>1</sub>, b<sub>1</sub>)<sup>u1</sup>, based on the random number u<sub>1</sub> as the temporary key, stored by the random number storage unit 322.<br/>
In the element combining step S692, using the processing device 911, the element combining unit 372 calculates the decrypted similarity degree element Z' = Z<img id="ib0043" file="imgb0022.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> based on the second response Z received by the second response receiving unit 341 and the decryption key <img id="ib0044" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the group conversion unit 371 in the group conversion step S691.<br/>
In the discrete logarithm calculation step S693, using the processing device 911, the discrete logarithm calculation unit 373 calculates the similarity d, based on the decrypted similarity degree element Z' calculated by the element combining unit 372 in the element combining unit 372.</p><p id="p0095" num="0095">The determination unit 306 determines whether or not the two feature vectors b and b' are similar, based on the similarity degree d calculated by the plaintext similarity degree extraction unit 315, thereby determining whether or not a person having the biometric information represented by the feature vector b and a person having the biometric information represented by the feature vector b' are the same person. As described above, the determination unit 306 determines that the two feature vectors b and b' are similar when the similarity degree d is smaller than the threshold value do.</p><p id="p0096" num="0096">As described above, the biometric authentication system 100 calculates the square of the Euclidean distance between the two feature vectors b and b', as the similarity degree between the two feature vectors b<!-- EPO <DP n="90"> --> and b'. The procedure for calculating the similarity degree is divided into some stages. Then, the authentication apparatus 102 and the decryption apparatus 103 perform calculations in the respective stages, thereby preventing the authentication apparatus 102 from obtaining information on the feature vectors b and b' and preventing the decryption apparatus 103 from obtaining the information on the feature vectors b and b' and information on the similarity degree d.</p><p id="p0097" num="0097"><figref idrefs="f0016">Fig. 26</figref> is a flow chart diagram showing a procedure for calculating a similarity degree in the biometric authentication system 100 in this embodiment.<br/>
In this diagram, a portion related to the procedure for calculating the similarity degree is extracted from the authentication process S700. δ<sub>i</sub> and δ* indicate information encrypted in the second challenge C^, and ξ indicates information represented by the second response Z.<br/>
As a first stage, the authentication apparatus 102 calculates the second challenge C^ from the two encrypted feature vectors C and C', thereby calculating T pieces of δ<sub>i</sub> = (b<sub>i</sub> - b'<sub>i</sub>) + t<sub>1, i</sub>(i being each integer not less than 1 and not more than T) and one δ* = ∑<sub>i</sub>[2t<sub>1, i</sub>(b<sub>i</sub> - b'<sub>i</sub>) + t<sub>1, i</sub><sup>2</sup> + u<sub>1</sub>(i being each integer not less than 1 and less than T). This calculation is performed with the encrypted feature vectors C and C' kept encrypted with the key of the decryption apparatus 103. Thus, the authentication apparatus 102 cannot obtain the information on the feature vectors b and b'.<br/>
As a second stage, in the second response generation step S716, the decryption apparatus 103 calculates the second response Z from the second challenge C^, thereby calculating ξ = ∑<sub>i</sub>[δ<sub>i</sub><sup>2</sup>] - δ* (i being each integer not less<!-- EPO <DP n="91"> --> than 1 and not more than T). This calculation is performed with the second challenge C^ decrypted with the secret key sk of the decryption apparatus 103. The decryption apparatus 103 does not know the temporary key u<sub>1</sub>. Thus, the decryption apparatus 103 cannot obtain the information on the feature vectors b and b' and information on the similarity degree d. That is, this calculation is performed with a result of the decryption encrypted with the temporary key u<sub>1</sub>.<br/>
As a third stage, in the plaintext similarity degree calculation step S719, the authentication apparatus 102 calculates the similarity degree d = ξ + u<sub>1</sub> from the second response Z. With this arrangement, the authentication apparatus 102 can obtain the similarity degree d, but cannot obtain the information on the feature vectors b and b'.</p><p id="p0098" num="0098">In the biometric system 100 (data collation apparatus) in this embodiment, the key generation unit (401) generates the public key and the secret key, based on the key generation system of an additive homomorphic scheme.<br/>
A data extraction apparatus (authentication apparatus 102) includes the public key storage unit (302) that holds the public key distributed from the key generation unit; the encrypted data storage unit (312) that stores as encrypted first data (encrypted feature vector C) first data (feature vector b) encrypted with the public key and held by a data processing apparatus (registration apparatus 104) that holds the public key distributed from the key generation unit; the random number generation unit (303) that generates a first random number and a second random number using at least a part of the public key; the random number storage unit (322) that stores the first random number<!-- EPO <DP n="92"> --> and the second random number; the encrypted random number generation unit (304) that encrypts the first random number, thereby generating the first challenge; the encrypted data extraction unit (305) that calculates, from the first response generated by a data processing apparatus (certification apparatus 101) by an arithmetic operation on second data (feature vector b') using the first challenge, encrypted second data (encrypted feature vector C') that is encryption of second data by processing with the first random number stored in the random number storage unit; the encrypted random similarity degree calculation unit (314) that generates the second challenge using the encrypted second data and the second random number; and the plaintext similarity degree extraction unit (315) that processes the second response using the second random number stored in the random number storage unit to calculate the plaintext similarity degree. The second response is obtained by processing the second challenge by the decryption apparatus or the data processing apparatus, using the secret key stored in the secret key storage unit (413).<br/>
The data processing apparatus (certification apparatus 101) includes the encrypted data embedding unit (217) that generates the first response by an arithmetic operation on the second data using the first challenge.<br/>
The decryption apparatus (103) or a data processing apparatus includes the key generation unit (401) that generates the public key and the secret key, based on the key generation system of the additive homomorphic scheme; the secret key storage unit (413) that stores the secret key; and the decryption unit (404) that processes the second challenge using the secret key stored in the secret key storage unit, thereby generating the second response.<!-- EPO <DP n="93"> --></p><p id="p0099" num="0099">With this arrangement, even if an attacker holds information (such as a set of the first challenge R and the first response R' and a set of the second challenge C^ and the second response Z) being exchanged on the network among the certification apparatus 101, the authentication apparatus 102, the decryption apparatus 103, and the registration apparatus 104, it is difficult for the attacker to spoof an authorized user. That is, information that is critical for spoofing is never leaked from the information being exchanged among the apparatuses.<br/>
As a first reason for this prevention of leakage of the critical information for spoofing is that values of the random numbers R<sub>1, i</sub>, and u<sub>i</sub> as the plaintexts to be used for the first challenge R and the second challenge C" generated by the authentication apparatus 102, the first response R', and the second response Z change each time authentication is performed. Thus, a replay attack reusing these data without alteration cannot be performed.<br/>
As a second reason for this prevention of leakage of the critical information for spoofing is that the Okamoto-Takashima encryption system described in this embodiment, the BGN encryption, and the Paillier encryption have security where a cypertext cannot be identified. For this reason, even if the attacker uses homomorphism, the feature vectors b and b' as plaintexts, the random numbers R<sub>1,i</sub> and u<sub>1</sub> as the plaintexts, and the secret key sk will not leak from the first challenge R and the second challenge C^, and the first response R' and the second response Z respectively corresponding to the first challenge R and the second challenge C^.<br/>
A third reason for this prevention of leakage of the critical information for spoofing is that the authentication apparatus 102 generates the<!-- EPO <DP n="94"> --> first challenge R using the information not known by the certification apparatus 101, and the certification apparatus 101 generates the first response R' using the information not known by the authentication apparatus 102. That is, the authentication apparatus 101 holds the random numbers R<sub>i, i</sub> used for the first challenge R, and the certification apparatus 101 holds the user feature vector b' as the plaintext. The attacker cannot obtain the feature vector b' and information on the random numbers R<sub>1, i</sub> as the plaintexts from the first challenge R and the first response R' without knowing these secret information. Further, the authentication apparatus 102 cannot obtain the feature vector b as the plaintext even if the authentication apparatus 102 knows the random numbers R<sub>1, i</sub>. The certification apparatus 101 cannot obtain the information on the random numbers R<sub>1, i</sub> even if the certification apparatus 101 knows the feature vector b.<br/>
A similar relationship holds between the second challenge C^ and the second response Z. The authentication apparatus 102 generates the second challenge C^ using the information not known by the decryption apparatus 103, and the decryption apparatus 103 generates the second response Z using the information not known by the authentication apparatus 102. That is, the authentication apparatus 102 holds the random number u<sub>1</sub> used for the second challenge C^, and the decryption apparatus 103 holds the secret key sk. The attacker cannot obtain information on the random number u<sub>1</sub> and information on the secret key sk from the second challenge C^ and the second response Z, without knowing these secret information. Further, the authentication apparatus 102 cannot obtain the secret key sk even if the authentication apparatus 102 knows the random number u<sub>1</sub>. The decryption apparatus 103<!-- EPO <DP n="95"> --> cannot obtain the information on the random number u<sub>1</sub> even if the decryption apparatus 103 knows the secret key sk.</p><p id="p0100" num="0100">In the biometric information registration process S600 in this embodiment, each user (registration apparatus 104) transmits the encrypted feature vector C itself to the authentication apparatus 102, and then the authentication apparatus 102 just stores the transmitted encrypted feature vector C. Communication using the feature vector b does not need to be performed. Thus, a trusted registration processing apparatus is not needed.<br/>
The random numbers in this embodiment are uniformly generated from a random number space. For this reason, there is no correlation among the random numbers, so that there is no possibility that some information leaks from the correlation among the random numbers.<br/>
The feature vector b is held in the authentication apparatus 102 in an encrypted state, rather than being held without alteration. For this reason, the risk of the feature b, which is privacy information of the user, being peeped by the manager of the authentication apparatus 102 may be reduced.<br/>
Even if the encrypted feature vector C has leaked, the original feature vector b itself does not leak from the authentication apparatus 102. Thus, compared with holding of the feature vector b itself, the time and effort of data management for the authentication apparatus 102 may be reduced.</p><p id="p0101" num="0101">Further, according to the procedure in this embodiment, the decryption apparatus 103 can decrypt only the index value of a random similarity degree. The decryption apparatus 103 cannot decrypt the feature vectors b and b'. Thus, the feature vectors b and b' do not come out during the process of authentication. Thus, biometric authentication with the<!-- EPO <DP n="96"> --> biometric information kept secret is possible.</p><p id="p0102" num="0102">According to this embodiment, the biometric information is extracted so as to transmit the first response R' from the certification apparatus 101 to the authentication apparatus 102 when authentication is performed. When generation of the first response R' is finished, there is no process using the biometric information as the plaintext. For this reason, the biometric information can be immediately deleted on the certification apparatus 101. Accordingly, an opportunity where the biometric information is stolen from the certification apparatus 101 may be reduced.</p><p id="p0103" num="0103">The encryption system is not limited to the Okamoto-Takashima encryption system. It may be also so configured that a different additive homomorphic encryption system, such as the BGN encryption system, the Gentry encryption system, or the Paillier encryption system is employed.</p><p id="p0104" num="0104">The first response R' to be transmitted from the certification apparatus 101 to the authentication apparatus 102 is obtained by encrypting the encrypted feature vector C'. The encrypted feature vector C' is obtained by decrypting the first response R' by the certification apparatus 101. The biometric authentication system 100 may be configured to use a different encryption system for this encryption system used for encryption and decryption. The encryption system in that case may be configured to use a standard public key encryption system rather than the additive homomorphic encryption system.<br/>
To take an example, the authentication apparatus 102 generates a set of the public key and the secret key, using the second encryption system, and then transmits the public key to the certification apparatus 101, as the first<!-- EPO <DP n="97"> --> challenge R. The certification apparatus 101 encrypts the feature vector b' using the public key of the decryption apparatus and according to the first addictive homomorphic encryption system, thereby generating the encrypted feature vector C'. Then, the certification apparatus 101 encrypts the generated encrypted feature vector C' as the first response R', using the public key received from the authentication apparatus 102 as the first challenge R and according to the second encryption system, and transmits the encrypted feature vector C' to the authentication apparatus 102, as the first response R'. The authentication apparatus 102 decrypts the received first response R' using the secret key generated by the authentication apparatus 102 and according to the second encryption system, thereby obtaining the encrypted feature vector C'.</p><p id="p0105" num="0105">However, when the first challenge R is the public key in the second encryption system and when the encrypted feature vector C' encrypted with that public key is set to the first response R', the first response R' can be generated from the first challenge R and the encrypted feature vector C'. On contrast therewith, in the method described in this embodiment, the first response R' is generated from the first challenge R and the original feature vector b' without alteration. Thus, the first response R' cannot be generated from the first challenge R and the encrypted feature vector C'. For this reason, even if a third party has obtained the encrypted feature vector C transmitted from the registration apparatus 104 to the authentication apparatus 102 in the registration process S600 by evesdropping of the third party, the third party cannot be authenticated by spoofing the certification apparatus 101.<!-- EPO <DP n="98"> --></p><heading id="h0013">Second Embodiment.</heading><p id="p0106" num="0106">A second embodiment will be described, using <figref idrefs="f0016">Fig. 27</figref>.<br/>
Same reference signs are given to components that are common to those in the first embodiment, thereby omitting description of the components that are common to those in the first embodiment.</p><p id="p0107" num="0107"><figref idrefs="f0016">Fig. 27</figref> is a system configuration diagram showing an example of an overall configuration of the biometric authentication system 100 in this embodiment.<br/>
The biometric authentication system 100 includes the certification apparatus 101 and the authentication apparatus 102. The certification apparatus 101 combines the function of the certification apparatus 101, the function of the decryption apparatus 103, and the function of the registration apparatus 104, all of which have been described in the first embodiment.<br/>
The certification apparatus 101 generates a set of the public key pk and the secret key sk, discloses the public key pk, and holds the secret key sk in secret. The authentication apparatus 102 performs an encryption process, using the public key pk disclosed by the certification apparatus 101.<br/>
The biometric authentication system 100 may include a plurality of the certification apparatuses 101. To take an example, assume that each user to be authenticated by the biometric authentication system 100 has his own certification apparatus 101. The user connects his certification apparatus 101 to a network or the like. The certification apparatus 101 communicates with the authentication apparatus 102 through the network or the like.<br/>
The authentication apparatus 102 stores the public key pk of each certification apparatus 101. The authentication apparatus 102 selects the<!-- EPO <DP n="99"> --> public key pk of the certification apparatus 101 from among the stored public keys pk, based on the ID of the certification apparatus 101 or the ID of the user for which authentication has been demanded, and then performs encryption processing using the selected public key pk.<br/>
The public key pk of each certification apparatus 101 is transmitted to the authentication apparatus 102 by the certification apparatus 101 together with the encrypted feature vector C, in the registration process S600, for example. The authentication apparatus 102 then associates and stores the received public key pk and the encrypted feature vector C.</p><p id="p0108" num="0108">In the authentication process S700, the authentication apparatus 102 generates the first challenge R, based on the public key pk of the certification apparatus 101, and then transmits the first challenge R to the certification apparatus 101. The certification apparatus 101 generates the first response R', based on the public key pk of the certification apparatus 101, the received first challenge R, and the feature vector b', and transmits the first response R' to the authentication apparatus 102. The authentication apparatus 102 generates the encrypted feature vector C', based on the public key pk of the certification apparatus 101 and the received first response R'. The authentication apparatus 102 generates the second challenge C^, based on the public key pk of the certification apparatus 101, the generated encrypted feature vector C', and the encrypted feature vector C stored in the registration process S600, and then transmits the generated second challenge C^ to the certification apparatus 101. The certification apparatus 101 generates the second response Z, based on the secret key sk of the certification apparatus 101 and the received second challenge C^, and transmits the generated second<!-- EPO <DP n="100"> --> response Z to the authentication apparatus 102. The authentication apparatus 102 calculates the similarity degree d, based on the received second response.</p><p id="p0109" num="0109">When a third party spoofs the certification apparatus 101, the third party tries to generate the second response Z indicating that the feature vector b and the feature vector b' are similar. The third party, however, does not know the temporary key u<sub>1</sub> generated by the certification apparatus 101. Thus, the third party does not know what kind of the second response Z indicates that the feature vector b and the feature vector b' are similar. If the third party has decrypted the second challenge C^ by stealing the secret key of the certification apparatus 101, the third party cannot know the temporary key u<sub>1</sub>. Thus, the third party cannot generate the second response Z indicating that the feature vector b and the feature vector b' are similar.</p><heading id="h0014">Third Embodiment.</heading><p id="p0110" num="0110">A third embodiment will be described using <figref idrefs="f0017 f0018">Figs. 28 to 30</figref>.<br/>
Same reference signs are given to components that are common to those in the first and second embodiments, thereby omitting description of the components that are common to those in the first and second embodiments.</p><p id="p0111" num="0111">In this embodiment, the description will be directed to a case where, as the similarity degree d between the two feature vectors b and b', an inner product ∑<sub>i</sub>[b<sub>i</sub>b'<sub>i</sub>] rather than the square of the Euclidean distance ∑<sub>i</sub>[(b<sub>i</sub> - b'<sub>i</sub>)<sup>2</sup>] is calculated.<br/>
It is assumed that each component of each feature vector has one of two values of 1 and 0.</p><p id="p0112" num="0112">An overall configuration of the biometric authentication system 100 and inner configurations of the certification apparatus 101, the authentication<!-- EPO <DP n="101"> --> apparatus 102, the decryption apparatus 103, and the registration apparatus 104 are similar to those described in the first embodiment. Thus, only a difference will be explained.</p><p id="p0113" num="0113">Using the processing device 911, the vector summation unit 367 of the encrypted random similarity degree calculation unit 314 in the authentication apparatus 102 calculates the vector c^, based on the encrypted feature vector C stored by the encrypted data storage unit 312, the encrypted feature vector C' extracted by the encrypted data extraction unit 305, the scalar multiplication vector calculated by the scalar multiplication calculation unit 364, and the encryption key u calculated by the encryption key generation unit 366. The vector c^ is a vector ∑<sub>i</sub>[c<sub>i</sub>] + ∑<sub>i</sub>[c'<sub>i</sub>] + ∑<sub>i</sub>[2t<sub>1</sub>, <sub>i</sub>Δc<sub>i</sub>] + (∑<sub>i</sub>[t<sub>1</sub>, <sub>i</sub><sup>2</sup>])b<sub>1</sub> + ∑<sub>i</sub>[u<sub>j</sub>b<sub>j</sub>] (i being each integer not less than 1 and not more than T, and j being each integer not less than 1 and not more than n) obtained by combining T pieces of components c<sub>i</sub> of the encrypted feature vector C, T pieces of components c'<sub>i</sub> of the encrypted feature vector C', T pieces of components 2t<sub>1</sub>, <sub>i</sub>Δc<sub>i</sub> of the scalar multiplication vector calculated by the scalar multiplication calculation unit 364, and the encryption key <img id="ib0045" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> = (Σ<sub>i</sub>[t<sub>1</sub>, i<sup>2</sup>])b<sub>1</sub> + Σ<sub>j</sub>[u<sub>j</sub>b<sub>j</sub>] (i being each integer not less than 1 and not more than T, and j being each integer not less than 1 and not more than n), by addition in the vector space V. The vector c^ is obtained by encrypting ∑<sub>i</sub>[b<sub>i</sub> + b'<sub>i</sub> + 2t<sub>1,i</sub>(b<sub>i</sub> - b'<sub>i</sub>) + 2t<sub>1</sub>, i<sup>2</sup>] + u<sub>1</sub>, due to additive homomorphism of encryption.</p><p id="p0114" num="0114"><figref idrefs="f0017">Fig. 28</figref> is a flow chart diagram showing an example of a flow of processes of the second challenge generation step S712 in this embodiment.<br/>
Though the flow of processes of the second challenge generation step S712 is almost the same as that in the first embodiment, only the vector<!-- EPO <DP n="102"> --> summation step S747 is different.<br/>
In the vector summation step S747, using the processing device 911 and based on the ith component c<sub>i</sub> of the encrypted feature vector C stored by the encrypted data storage unit 312, the ith component c'<sub>i</sub> of the encrypted feature vector C' extracted by the encrypted data extraction unit 305, the ith component <img id="ib0046" file="imgb0019.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> = 2t<sub>1</sub>, <sub>i</sub>Δc<sub>i</sub> of the scalar multiplication vector C calculated by the scalar multiplication calculation unit 364 in the scalar multiplication step S746, the vector summation unit 367 combines the vector c<sub>i</sub>, the vector c'<sub>i</sub>, and the vector <img id="ib0047" file="imgb0019.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> with the vector c^ by addition in the vector space V.</p><p id="p0115" num="0115">Though the decryption unit 404 of the decryption apparatus 103 has the same configuration as that in the first embodiment, the vector c^ has a different meaning. Thus, the second response Z to be generated by the decryption unit 404 also has a meaning different from that in the first embodiment.<br/>
That is, the second response Z is an element obtained by exponentiating the element e (b<sub>1</sub>, b<sub>1</sub>) of the finite group G<sub>T</sub> by (∑<sub>i</sub>[(b<sub>i</sub> - b'<sub>i</sub>)<sup>2</sup> - (b<sub>i</sub> + b'<sub>i</sub>)] - u<sub>1</sub>) (i being each integer not less than 1 and not more than T) by exponentiation on the finite group G<sub>T</sub>. Since each of b<sub>i</sub> and b'<sub>i</sub> takes one of values of 0 and 1, b<sub>i</sub> = b<sub>i</sub><sup>2</sup> and b'<sub>i</sub> = b'<sub>i</sub><sup>2</sup> constantly hold. Accordingly, the second response Z is the element obtained by exponentiating the element e (b<sub>1</sub>, b<sub>1</sub>) of the finite group G<sub>T</sub> by (-2∑<sub>i</sub>[b<sub>i</sub> b'<sub>i</sub>] -u<sub>1</sub>) (i being each integer not less than 1 and not more than T). That is, the second response Z is the one obtained by encrypting the inner product ∑<sub>i</sub>[b<sub>i</sub>b'<sub>i</sub>] between the feature vector b and the feature vector b' by the random number u<sub>1</sub> as the temporary key.</p><p id="p0116" num="0116">Using the processing device 911, the element combining unit 372 of<!-- EPO <DP n="103"> --> the plaintext similarity degree extraction unit 315 in the authentication apparatus 102 calculates an inverse element <img id="ib0048" file="imgb0048.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/> = (-2)<sup>-1</sup> of (-2) using multiplication on the finite field Fq, based on the order q which is the part of the public key pk stored by the public key storage unit 302. Using the processing device 911, the authentication apparatus 102 calculates the decrypted similarity degree element Z', based on the finite group G<sub>T</sub>, which is the part of the public key pk stored by the public key storage unit 302, the second response Z received by the second response receiving unit 341, the decryption key <img id="ib0049" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> = e(b<sub>1</sub>, b<sub>1</sub>)<sup>u1</sup> calculated by the group conversion unit 371, and the calculated inverse element <img id="ib0050" file="imgb0050.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/> The decrypted similarity degree element Z' is an element (Z<img id="ib0051" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/>)<sup>III</sup> obtained by exponentiating an element Z<img id="ib0052" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> by the inverse element <img id="ib0053" file="imgb0048.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/> by exponentiation on the finite group G<sub>T</sub>. The element Z<img id="ib0054" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> is obtained by combining the second response Z and the decryption key <img id="ib0055" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> by multiplication on the finite group G<sub>T</sub>. The second response Z is the element obtained by exponentiating the element e (b<sub>1</sub>, b<sub>1</sub>) of the finite group G<sub>T</sub> by (-2∑<sub>i</sub>[b<sub>i</sub> b'<sub>i</sub>] -u<sub>1</sub>) (i being each integer not less than 1 and not more than T) using exponentiation on the finite group G<sub>T</sub>. Thus, the decrypted similarity degree element Z' is the element obtained by exponentiating the element e (b<sub>1</sub>, b<sub>1</sub>) of the finite group G<sub>T</sub> by (∑<sub>i</sub>[b<sub>i</sub> b'<sub>i</sub>]) (i being each integer not less than 1 and more than T) using exponentiation on the finite group G<sub>T</sub>.</p><p id="p0117" num="0117"><figref idrefs="f0017">Fig. 29</figref> is a flow chart diagram showing an example of a flow of processes of the plaintext similarity degree calculation step S719 in this embodiment.<br/>
In addition to the steps described in the first embodiment, the<!-- EPO <DP n="104"> --> plaintext similarity degree calculation step S719 includes an inverse number calculation step S690.<br/>
In the inverse number calculation step S690, using the processing device 911, the element combining unit 372 calculates the inverse element<img id="ib0056" file="imgb0048.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/> of (-2) using multiplication on the finite field Fq. The inverse element <img id="ib0057" file="imgb0048.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/> is constant irrespective of the second response Z. Thus, it may be so configured that the inverse element <img id="ib0058" file="imgb0048.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/> is calculated in advance.<br/>
In the element combining step S692, using the processing device 911, the element combining unit 372 calculates the decrypted similarity degree element Z' = (Z<img id="ib0059" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/>)<sup>III</sup>, based on the second response Z received by the second response receiving unit 341, the inverse element <img id="ib0060" file="imgb0048.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/> calculated in the inverse number calculation step S690, and the decryption key <img id="ib0061" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the group calculation unit 371 in the group conversion step S691.</p><p id="p0118" num="0118">It may also be so configured that, as the decrypted similarity degree element Z', the element combining unit 372 calculates the element Z<img id="ib0062" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> by combining the second response Z and the decryption key <img id="ib0063" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> using multiplication on the finite group G<sub>T</sub>, and that the discrete logarithm calculation unit 373 determines, as the similarity degree d, to what power e (b<sub>1</sub>, b<sub>1</sub>)<sup>-2</sup> of the finite group G<sub>T</sub> is raised to be equal to the decrypted similarity degree element Z'.</p><p id="p0119" num="0119">The inner product ∑<sub>i</sub>[b<sub>i</sub>b'<sub>i</sub>] between the two feature vectors b and b' indicates that the larger the inner product ∑<sub>i</sub>[b<sub>i</sub>b'<sub>i</sub>] is, the more similar the two feature vectors b and b' are, to the contrary of the square of the Euclidean distance ∑<sub>i</sub>[(b<sub>i</sub> - b'<sub>i</sub>)<sup>2</sup>]. For this reason, the determination unit 306 determines that the two feature vectors b and b' are similar when the<!-- EPO <DP n="105"> --> similarity degree d calculated by the discrete logarithm calculation unit 373 is larger than the predetermined threshold value do.</p><p id="p0120" num="0120">Each component of each feature vector takes one of the two values of 0 and 1. Thus, the inner product ∑<sub>i</sub>[b<sub>i</sub>b'<sub>i</sub>] between the two feature vectors b and b' becomes an integer not less than 0 and not more than T. The discrete logarithm calculation unit 373 calculates the element e(b<sub>1</sub>, b<sub>1</sub>)<sup>d</sup> by exponentiating e(b<sub>1</sub>, b<sub>1</sub>) by the integer d in advance for each integer d not less than do and not more than T, for example. The discrete logarithm calculation unit 373 thereby calculates the similarity degree d when the similarity degree d is not less than do and not more than T, and determines that the similarity degree d is smaller than do when the similarity degree is less than do. The discrete logarithm calculation unit 373 may also be configured to calculate the similarity degree d when the similarity degree d is not more than do and to determine that the similarity degree d is larger than do when the similarity degree is larger than do, as in the first embodiment.</p><p id="p0121" num="0121">With this arrangement, it can be determined whether the two feature vectors b and b' are similar, using the number of matches between feature points as a reference.</p><p id="p0122" num="0122"><figref idrefs="f0018">Fig. 30</figref> is a flow chart diagram showing a procedure for calculating a similarity degree in the biometric authentication system 100 in this embodiment.<br/>
As a first stage, the authentication apparatus 102 calculates the second challenge C^ from the two encrypted feature vectors C and C' , thereby calculating T pieces of δ<sub>i</sub> = (b<sub>i</sub> - b'<sub>i</sub>) + t<sub>1</sub>, <sub>i</sub> (i being each integer not less than 1 and not more than T) and one δ* = ∑<sub>i</sub>[2t<sub>1</sub>, <sub>i</sub>(b<sub>i</sub> - b'<sub>i</sub>) + t<sub>1</sub>, <sub>i</sub><sup>2</sup> + b<sub>i</sub> + b'<sub>i</sub>] + u<sub>1</sub> (i<!-- EPO <DP n="106"> --> being each integer not less than 1 and not more than T), in the second challenge generation step S712. This calculation is performed with the encrypted feature vectors C and C' kept encrypted with the key of the decryption apparatus 103. Thus, the authentication apparatus 102 cannot obtain information on the feature vectors b and b'.<br/>
As a second stage, the decryption apparatus 103 calculates the second response Z from the second challenge C^, thereby calculating ξ = ∑<sub>i</sub>[δ<sub>i</sub><sup>2</sup>] - δ* (i being each integer not less than 1 and not more than T), in the second response generation step S716. This calculation is performed with the second challenge C^ decrypted with the secret key of the decryption apparatus 103. Since the decryption apparatus 103 does not know the temporary key u<sub>1</sub>, the decryption apparatus 103 does not obtain the information on the feature vectors b and b' and information on the similarity degree. That is, this calculation is performed with a result of the decryption kept encrypted with the temporary key u<sub>1</sub>.<br/>
As a third stage, the authentication apparatus 102 calculates the similarity degree d = ξ + u<sub>1</sub> from the second response Z, in the plaintext similarity degree calculation step S719. With this arrangement, the authentication apparatus 102 can obtain the similarity degree d, but cannot obtain the information on the feature vectors b and b'.</p><p id="p0123" num="0123">The encryption system is not limited to the Okamoto-Takashima encryption system. It may be so configured that a different additive homomorphic encryption system, such as the BGN encryption system, the Gentry encryption system, or the Paillier encryption system is employed. It may also be so configured that a second encryption system such as the<!-- EPO <DP n="107"> --> standard public key encryption system is employed for communication between the certification apparatus 101 and the authentication apparatus 102.</p><p id="p0124" num="0124">As in the second embodiment, the biometric authentication system 100 may be so configured that the certification apparatus 101 combines functions as the decryption apparatus 103 and the registration apparatus 104.</p><p id="p0125" num="0125">As compared with the first embodiment, configurations of the certification apparatus 101, the decryption apparatus 103, and the registration apparatus 104 remain unchanged, but only the configuration of the authentication apparatus 102 is different in this embodiment. Accordingly, by setting the authentication apparatus 102 to a configuration capable of switching between the configuration described in the first embodiment and the configuration described in this embodiment, two types of similarity degrees using the Euclidean distance and the inner product may be calculated without altering the other apparatuses in the biometric authentication system 100.</p><heading id="h0015">Fourth Embodiment.</heading><p id="p0126" num="0126">A fourth embodiment will be described, using <figref idrefs="f0018 f0019 f0020 f0021 f0022 f0023 f0024 f0025 f0026">Figs. 31 to 45</figref>.<br/>
Same reference signs are given to components that are common to those in the first to third embodiments, thereby omitting description of the components that are common to those in the first to third embodiments.</p><p id="p0127" num="0127">In this embodiment, a description will be directed to a case where the BGN encryption system is employed as the encryption system. The square of the Euclidean distance is used for the similarity degree d, as in the first embodiment.</p><p id="p0128" num="0128">First, the BGN encryption system will be outlined.</p><p id="p0129" num="0129">Assume that N is the product of two mutually different prime<!-- EPO <DP n="108"> --> numbers p and q. Assume that G and G<sub>T</sub> are finite groups of the order N. A group arithmetic operation on each of the finite group G and the finite group G<sub>T</sub> is described as multiplication. Assume that e is a pairing G x G → G<sub>T</sub> that maps a set of two elements of the finite group G to an element of the finite group G<sub>T</sub>. The pairing e satisfies bilinearity and non-degenerateness.<br/>
Assume that g and u are elements uniform randomly selected from the generator element of the finite group G. Assume that h is an element of the finite group G, and is an element u<sup>q</sup> obtained by exponentiating the element u by the prime number q, using exponentiation on the finite group G.<br/>
Each of the finite group G and the finite group G<sub>T</sub> is the direct product of the cyclic group of the order p and the cyclic group of the order q. Accordingly, the order of the element h is p.</p><p id="p0130" num="0130">Assume that x and r are each an integer not less than 0 and less than N. Assume that a product g<sup>x</sup>h<sup>r</sup> of an element g<sup>x</sup> and an element h<sup>r</sup> is given. The element g<sup>x</sup> is obtained by exponentiating the element g by an integer x using exponentiation on the finite group G, and the element h<sup>r</sup> is obtained by exponentiating the element h by an integer r using exponentiation on the finite group G. Then, an element [g<sup>x</sup>h<sup>r</sup>]<sup>p</sup> obtained by exponentiating the product g<sup>x</sup>h<sup>r</sup> by the prime number p using exponentiation on the finite group G is equal to [g<sup>x</sup>]<sup>p</sup>, because the order of the element h is p.</p><p id="p0131" num="0131">Assume that a set of the finite group G, the finite group G<sub>T</sub>, the order N, the pairing e, the element g, and the element h is set to the public key pk, and the prime number p is set to the secret key sk, for example. Then, assume that the integer x not less than 0 and not more than L which is sufficiently smaller than the prime number q is set to a plaintext, and the<!-- EPO <DP n="109"> --> element g<sup>x</sup>h<sup>r</sup> of the finite group G is set to a ciphertext E(x) obtained by encrypting the plaintext x. Assume, however, that r is the integer uniform randomly selected from among integers not less than 0 and less than N.<br/>
The prime number p, which is the secret key sk, is used for decryption. An element E(x)<sup>p</sup> = [g<sup>x</sup>]<sup>p</sup> = [g<sup>p</sup>]<sup>x</sup> obtained by exponentiating the ciphertext E(x) by the prime number p is calculated, using exponentiation on the finite group G. When it is known to what power g<sup>p</sup> is raised to be equal to [g<sup>p</sup>]<sup>x</sup>, x can be decrypted.<br/>
When the integer L is small, this problem of discrete logarithm can be solved, by using Pollard's lambda method, for example. The amount of calculation necessary in that case is proportional to √L . Accordingly, when the value of the integer L is set so that the calculation may be performed with a practical amount of calculation, x can be decrypted.</p><p id="p0132" num="0132">When a ciphertext E(x<sub>1</sub>) = g<sup>x1</sup>h<sup>r1</sup> of an integer x<sub>1</sub> and a ciphertext E(x<sub>2</sub>) = g<sup>x2</sup>h<sup>r2</sup> of an integer x<sub>2</sub> are combined using multiplication on the finite group G, E(x<sub>1</sub>)E(x<sub>2</sub>) = g<sup>x1 + x2</sup>h<sup>r1 + r2</sup> is obtained. Thus, a ciphertext E (x<sub>1</sub> + x<sub>2</sub>) for x1 + x2, which is the sum of the integer x1 and the integer x2, is obtained.</p><p id="p0133" num="0133">The ciphertext E(x) can also be decrypted in a state of being kept encrypted, after having been translated to the finite group G<sub>T</sub> using the pairing e. A pairing e(g<sup>x1</sup>h<sup>r1</sup>, g<sup>x2</sup>h<sup>r2</sup>) between the ciphertext E(x<sub>1</sub>) of the integer x<sub>1</sub> = g<sup>x1</sup>h<sup>r1</sup> and the ciphertext E(x<sub>2</sub>) of the integer x<sub>2</sub> = g<sup>x2</sup>h<sup>r2</sup> is e(g, g)<sup>x1x2</sup>e(g, h)<sup>x1r2</sup>e(h,g)<sup>x2r1</sup>e(h, h)<sup>r1r2</sup> due to bilinearity of the paring. Since the order of the element h of the finite group G is p, the order of each of pairings e(g, h), e(h, g), e(h, h), which are elements of the finite group G<sub>T</sub>, is p. Accordingly, when the pairing e (E(x<sub>1</sub>), E(x<sub>2</sub>)) between the ciphertext E(x<sub>1</sub>) and the<!-- EPO <DP n="110"> --> ciphertext E(x<sub>2</sub>) is exponentiated by the prime number p using exponentiation on the finite group G<sub>T</sub>, [e(g, g)<sup>p</sup>]<sup>x1x2</sup> is obtained. That is, the pairing e (E(x<sub>1</sub>), E(x<sub>2</sub>)) between the ciphertext E(x<sub>1</sub>) and the ciphertext E(x<sub>2</sub>) is the ciphertext of the product x1x2 of the integer x<sub>1</sub> and the integer x<sub>2</sub>.</p><p id="p0134" num="0134"><figref idrefs="f0018">Fig. 31</figref> is a detailed block diagram showing an example of a configuration of the key generation unit 401 in this embodiment.<br/>
The key generation unit 401 of the decryption apparatus 103 includes a group determination unit 431, a generator element selection unit 432, and a generator element exponentiation unit 433, for example.<br/>
Using the processing device 911, the group determination unit 431 generates the two mutually different prime numbers p and q, based on the size (such as 512 bits or 1024 bits) determined according to the security level. The group determination unit 431 calculates the product N = pq between the two generated prime numbers p and q, using the processing device 911. The group determination unit 431 determines the finite group G and the finite group G<sub>T</sub>, based on the calculated product N, using the processing device 911. The order of each of the finite group G and the finite group G<sub>T</sub> is N, and the finite group G and the finite group G<sub>T</sub> have the pairing e: G x G → G<sub>T</sub>.<br/>
Using the processing device 911, the generator element selection unit 432 selects the two generator elements g and u of the finite group G, based on the finite group G determined by the group determination unit 431.<br/>
Using the processing device 911, the generator element exponentiation unit 433 calculates the element h, based on the prime number q generated by the group determination unit 431 and the generator element u selected by the generator element selection unit 432. The element h is the<!-- EPO <DP n="111"> --> element u<sup>q</sup> obtained by exponentiating the generator element u by the prime number q using exponentiation on the finite group G.<br/>
Using the processing device 911, a base calculation unit 434 calculates an element π, based on the prime number p generated by the group determination unit 431, the paring e, and the generator element g selected by the generator element selection unit 432. The element π is an element of the finite group G<sub>T</sub>. The element π is an element e(g, g)<sup>p</sup> obtained by exponentiating the element (g, g) by the prime number p using exponentiation on the finite group G<sub>T</sub>. The element (g, g) is obtained by translation of a set of the generator elements g by the pairing e.</p><p id="p0135" num="0135">The public key storage unit 403 stores, as the public key pk, a set (G, G<sub>T</sub>, N, e, g, h, π) of the finite group G, the finite group G<sub>T</sub>, the product N, the pairing e, the generator element g, the element h, and the element π, using the storage device 914.<br/>
The secret key storage unit 413 stores, as the secret key sk, the prime number p generated by the group determination unit 431, using the storage device 914.</p><p id="p0136" num="0136"><figref idrefs="f0019">Fig. 32</figref> is a flow chart diagram showing an example of a flow of processes of the key generation step S501 in this embodiment.<br/>
In the key generation step S501, the decryption apparatus 103 generates a set of the public key pk and the secret key sk. It may also be so configured that a set of the public key pk and the secret key sk which is different for each user is generated. Alternatively, it may be so configured that one set of the public key pk and the secret key sk is generated for the overall system.<br/>
<!-- EPO <DP n="112"> -->The key generation step S501 includes a group determination step S521, a generator element selection step S522, a generator element exponentiation step S523, and a base calculation step S524, for example.</p><p id="p0137" num="0137">First, in the group determination step S521, using the processing device 911, the group determination unit 431 determines the two prime numbers p and q, the product N, and each of the finite groups G and G<sub>T</sub> of the order N. Using the storage device 914, the public key storage unit 403 stores the product N, the finite group G, and the finite group G<sub>T</sub>, as a part of the public key pk. Using the storage device 914, the secret key storage unit 413 stores the prime number p as the secret key sk.<br/>
In the generator element selection step S522, using the processing device 911, the generator element selection unit 432 selects the two generator elements g and u, based on the finite group G determined by the group determination unit 431 in the group determination step S521. The public key storage unit 403 stores the generator element g, as a part of the public key pk, using the storage device 914.<br/>
In the generator element exponentiation step S523, using the processing device 911, the generator element exponentiation unit 433 calculates the element h = u<sup>q</sup> of the finite group G, based on the prime number q determined by the group determination unit 431 in the group determination step S521 and the generator element u selected by the generator element selection unit 432 in the generator element selection step S522. Using the processing device 911, the public key storage unit 403 stores the element h, as a part of the public key pk.<br/>
In the base calculation step S524, using the processing device 911,<!-- EPO <DP n="113"> --> the base calculation unit 434 calculates the element π = e(g, g)<sup>p</sup> of the finite group G<sub>T</sub>, based on the prime number p determined by the group determination unit 431 in the group determination step S521, the pairing e, and the generator element g selected by the generator element selection unit 432 in the generator element selection step S522. Using the processing device 911, the public key storage unit 403 stores the element π as a part of the public key pk.</p><p id="p0138" num="0138">The public key pk = (G, G<sub>T</sub>, N, e, g, h, π) stored by the public key storage unit 403 in this manner is transmitted to each of the authentication apparatus 102 and the like by the public key transmitting unit 408, and each of the authentication apparatus 102 and the like receives and then stores the public key pk.</p><p id="p0139" num="0139"><figref idrefs="f0019">Fig. 33</figref> is a flow chart diagram showing an example of a flow of processes of the feature vector encryption step S603 in this embodiment.<br/>
In the feature vector encryption step S603, the registration apparatus 104 encrypts the feature vector b, thereby generating the encrypted feature vector C. The feature vector encryption step S603 includes the initialization step S610, the repetition step S611, the random number generation step S612, and an element calculation step S613a, for example.<br/>
The feature vector b generated by the feature vector formation unit 204 of the registration apparatus 104 is a T-dimensional vector (b<sub>1</sub>, b<sub>2</sub>, ..., b<sub>T</sub>) (T being an integer not less than 1) having components of integers. The encrypted feature vector C generated by the encrypted data generation unit 206 is a T-dimensional vector (c<sub>1</sub>, c<sub>2</sub>, ..., c<sub>T</sub>) having components of elements of the finite group G.<!-- EPO <DP n="114"> --></p><p id="p0140" num="0140">First, in the initialization step S610, using the processing device 911, the encrypted data generation unit 206 initializes the integer i to 0.<br/>
In the repetition step S611, using the processing device 911, the encrypted data generation unit 206 adds 1 to the integer i. When the integer i is larger than T, the encrypted data generation unit 206 finishes the feature vector encryption step S603. When the integer i is not more than T, the encrypted data generation unit 206 causes the process to proceed to the random number generation step S612, thereby generating the ith component c<sub>i</sub> of the encrypted feature vector C.<br/>
In the random number generation step S612, using the processing device 911, the random number generation unit 205 generates a random number r<sub>i</sub>, based on the order N which is a part of the public key pk stored by the public key storage unit 202. The random number r<sub>i</sub> generated by the random number generation unit 205 is an integer uniform randomly selected from among integers not less than 0 and less than N.<br/>
In the element calculation step S613a, using the processing device 911, the encrypted data generation unit 206 calculates the ith component c<sub>i</sub> of the encrypted feature vector C, based on the generator element g and the element h which are the parts of the public key pk stored by the public key storage unit 202, the ith component b<sub>i</sub> of the feature vector b generated by the feature vector formation unit 204, and the random number r<sub>i</sub> generated by the feature vector formation unit 204 in the random number generation step S612. The ith component c<sub>i</sub> of the encrypted feature vector C calculated by the encrypted data generation unit 206 is an element g<sup>bi</sup>h<sup>ri</sup> obtained by combining an element g<sup>bi</sup> and an element h<sup>ri</sup> using multiplication on the finite group G.<!-- EPO <DP n="115"> --> The element g<sup>bi</sup> is obtained by exponentiating the generator element g by an integer b<sub>i</sub> using exponentiation on the finite group G. The element h<sup>ri</sup> is obtained by exponentiating the element h by the random number r<sub>i</sub> using exponentiation on the finite group G.<br/>
The encrypted data generation unit 206 causes the process to return to the repetition step S611, thereby generating the subsequent component of the encrypted feature vector C.</p><p id="p0141" num="0141">The encrypted feature vector C generated by the encrypted data generation unit 206 in this manner is transmitted to the authentication apparatus 102 by the encrypted data transmitting unit 201, and the authentication apparatus 102 receives and then stores the encrypted feature vector C.</p><p id="p0142" num="0142"><figref idrefs="f0020">Fig. 34</figref> is a flow chart diagram showing an example of a flow of processes of the first challenge generation step S701 in this embodiment.<br/>
In the first challenge generation step S701, the authentication apparatus 102 generates the first challenge R. The first challenge generation step S701 includes the initialization step S729, the repetition step S721, the random number generation step S722, and an element calculation step S723a, for example.<br/>
The first challenge R generated by the encrypted random number generation unit 304 of the authentication apparatus 102 is a T-dimensional vector (R<sub>1</sub>, R<sub>2</sub>, ..., R<sub>T</sub>) having components of elements of the finite group G.</p><p id="p0143" num="0143">First, in the initialization step S729, using the processing device 911, the encrypted random number generation unit 304 initializes the integer i to 0.<br/>
In the repetition step S721, using the processing device 911, the<!-- EPO <DP n="116"> --> encrypted random number generation unit 304 adds 1 to the integer i. When the integer i is larger than T, the encrypted random number generation unit 304 finishes the first challenge generation step S701. When the integer i is not more than T, the encrypted random number generation unit 304 causes the process to proceed to the random number generation step S722, thereby generating the ith component R<sub>i</sub> of the first challenge R.<br/>
In the random number generation step S722, using the processing device 911, the random number generation unit 303 generates two random numbers R<sub>1, i</sub> and R<sub>2, i</sub>, based on the order N, which is the part of the public key pk stored by the public key storage unit 302. The random numbers R<sub>1, i</sub> and R<sub>2, i</sub> generated by the random number generation unit 303 are integers uniform randomly selected from among the integers not less than 0 and less than N. The random number storage unit 322 stores the random number R<sub>1, i</sub> generated by the random number generation unit 303, using the storage device 914.<br/>
In the element calculation step S723a, using the processing device 911, the encrypted random number generation unit 304 calculates the ith component R<sub>i</sub> of the first challenge R, based on the generator element g and the element h which are the parts of the public key pk stored by the public key storage unit 302 and the two random numbers R<sub>1, i</sub> and R<sub>2, i</sub> generated by the random number generation unit 303 in the random number generation step S722. The ith component R<sub>i</sub> of the first challenge R calculated by the encrypted random number generation unit 304 is an element resulting from combination of an element obtained by exponentiating the generator element g by the random number R<sub>1, i</sub> using exponentiation on the finite group G and an<!-- EPO <DP n="117"> --> element obtained by exponentiating the element h by the random number R<sub>2, i</sub> using exponentiation on the finite group G, by multiplication on the finite group G.<br/>
The encrypted random number generation unit 304 causes the process to return to the repetition step S721, thereby generating the subsequent component of the first challenge R.</p><p id="p0144" num="0144">The first challenge R generated by the encrypted random number generation unit 304 in this manner is transmitted to the certification apparatus 101 by the first challenge transmitting unit 311. The certification apparatus 101 receives and then processes the first challenge R.</p><p id="p0145" num="0145">The number of the random numbers R<sub>1, i</sub> and R<sub>2, i</sub> (i being each integer not less than 1 and not more than T) generated by the random number generation unit 303 in the first challenge generation step S701 is 2T in total. T pieces of random numbers R<sub>1, i</sub> (i being each integer not less than 1 and not more than T) are stored by the random number storage unit 322. The T pieces of random numbers R<sub>1, i</sub> stored by the random number storage unit 322 are random numbers as plaintexts, and the remaining T pieces of random numbers R<sub>2, i</sub> (i being each integer not less than 1 and not more than T) are random numbers for encryption. Each component R<sub>i</sub> of the first challenge R is obtained by encrypting the random number R<sub>1, i</sub> as a plaintext.</p><p id="p0146" num="0146"><figref idrefs="f0020">Fig. 35</figref> is a detailed block diagram showing an example of a configuration of the encrypted data embedding unit 217 in this embodiment.<br/>
The encrypted data embedding unit 217 of the certification apparatus 101 includes an exponentiation calculation unit 234, the zero generation unit 232, and an element combining unit 235.<!-- EPO <DP n="118"> --></p><p id="p0147" num="0147">A feature vector b' generated by the feature vector formation unit 214 of the certification apparatus 101 is a T-dimensional vector (b'<sub>1</sub>, b'<sub>2</sub>, ..., b'<sub>T</sub>) having components of integers, like the feature vector b generated by the feature vector formation unit 204 of the registration apparatus 104.<br/>
Using the processing device 911, the random number generation unit 215 generates T pieces of random numbers r'<sub>i</sub> (i being each integer not less than 1 and not more than T), based on the order N which is the part of the public key pk stored by the public key storage unit 212. The random numbers r'<sub>i</sub> generated by the random number generation unit 215 are integers uniform randomly selected from among the integers not less than 1 and less than N.</p><p id="p0148" num="0148">Using the processing device 911, the exponentiation calculation unit 234 calculates an exponentiation vector <img id="ib0064" file="imgb0011.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> based on the first challenge R received by the first challenge receiving unit 211 and the feature vector b' generated by the feature vector formation unit 214. The exponentiation vector <img id="ib0065" file="imgb0001.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the exponentiation calculation unit 234 is a T-dimensional vector (<img id="ib0066" file="imgb0002.tif" wi="7" he="4" img-content="character" img-format="tif" inline="yes"/> <img id="ib0067" file="imgb0003.tif" wi="7" he="4" img-content="character" img-format="tif" inline="yes"/> ..., <img id="ib0068" file="imgb0004.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/>) having components of elements of the finite group G, like the first challenge R. The ith component <img id="ib0069" file="imgb0005.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> (i being the integer not less than 1 and not more than T) of the exponentiation vector<img id="ib0070" file="imgb0001.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the exponentiation calculation unit 234 is an element R<sub>i</sub><sup>b'i</sup> obtained by exponentiating the ith component R<sub>i</sub> of the first challenge R by the ith component b'<sub>i</sub> of the feature vector b' using exponentiation on the finite group G. Each component <img id="ib0071" file="imgb0005.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> of the exponentiation vector <img id="ib0072" file="imgb0001.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the exponentiation calculation unit 234 is obtained by encrypting the product of the component b'<sub>i</sub> of the feature vector b' and the random number<!-- EPO <DP n="119"> --> R<sub>1, i</sub> as the plaintext generated by the authentication apparatus 102.<br/>
Using the processing device 911, the zero generation unit 232 generates the encrypted zero vector O based on the element h which is the part of the public key pk stored by the public key storage unit 202 and the T pieces of random numbers r'<sub>i</sub> generated by the random number generation unit 21. The encrypted zero vector O is a T-dimensional vector (o<sub>1</sub>, o<sub>2</sub>, ..., o<sub>T</sub>) having components of elements of the finite group G. The ith component o<sub>i</sub> (i being the integer not less than 1 and not more than T) of the encrypted zero vector O is an element h<sup>r'i</sup> obtained by exponentiating the element h by the ith random number r'<sub>i</sub> using exponentiation on the finite group G.</p><p id="p0149" num="0149">Using the processing device 911, the element combining unit 235 calculates the first response R', based on the exponentiation vector<img id="ib0073" file="imgb0001.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the exponentiation calculation unit 234 and the encrypted zero vector O generated by the zero generation unit 232. The first response R' is a T-dimensional vector (R'<sub>1</sub>, R'<sub>2</sub>, ..., R'<sub>T</sub>) having components of elements of the finite group G. The ith component R'<sub>i</sub> (i being the integer not less than 1 and not more than T) of the first response R' is an element R<sub>i</sub><sup>b'i</sup>h<sup>r'i</sup> obtained by combining the ith component <img id="ib0074" file="imgb0005.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> = R<sub>i</sub><sup>b'i</sup> of the exponentiation vector and the ith component o<sub>i</sub> = h<sup>r'i</sup> of the encrypted zero vector O using multiplication on the finite group G. Each component R'<sub>i</sub> of the first response R' is obtained by encrypting the product of the random number R<sub>1, i</sub> as the plaintext and the component b'<sub>i</sub> of the feature vector b'. The random number R<sub>1, i</sub> is encrypted in the component R<sub>i</sub> of the first challenge R.</p><p id="p0150" num="0150"><figref idrefs="f0021">Fig. 36</figref> is a flow chart diagram showing an example of a flow of processes of the first response generation step S707 in this embodiment.<br/>
<!-- EPO <DP n="120"> -->In the first response generation step S707, the certification apparatus 101 generates the first response R', based on the feature vector b' and the first challenge R. The first response generation step S707 includes the initialization step S660, the repetition step S661, an exponentiation calculation step S662a, the random number generation step S663, the zero generation step S664, and an element combining step S665a.</p><p id="p0151" num="0151">First, in the initialization step S660, the element combining unit 235 initializes the integer i to 0, using the processing device 911.<br/>
In the repetition step S661, the element combining unit 235 adds 1 to the integer i, using the processing device 911. When the integer i is larger than T, the element combining unit 235 finishes the first response generation step S707. When the integer i is not more than T, the element combining unit 235 causes the process to proceed to the exponentiation calculation step S662a to generate the ith component R'<sub>i</sub> of the first response R'.<br/>
In the exponentiation calculation step S662a, using the processing device 911, the exponentiation calculation unit 234 calculates the ith component <img id="ib0075" file="imgb0005.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> = R<sub>i</sub><sup>b'i</sup> of the exponentiation vector <img id="ib0076" file="imgb0011.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> based on the ith component b'<sub>i</sub> of the feature vector b' generated by the feature vector formation unit 214 and the ith vector R<sub>i</sub> of the first challenge R received by the first challenge receiving unit 211.<br/>
In the random number generation step S663, the random number generation unit 215 generates the random number r'<sub>i</sub>, using the processing device 911.<br/>
In the zero generation step S664, using the processing device 911, the zero generation unit 232 calculates the ith component o<sub>i</sub> = h<sup>r'i</sup> of the encrypted<!-- EPO <DP n="121"> --> zero vector O, based on the random number r'<sub>i</sub> generated by the random number generation unit 215 in the random number generation step S663.<br/>
In the element combining step S665a, using the processing device 911, the element combining unit 235 calculates the ith component R'<sub>i</sub> = <img id="ib0077" file="imgb0005.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/>O<sub>i</sub>, based on the ith component <img id="ib0078" file="imgb0005.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> of the exponentiation vector <img id="ib0079" file="imgb0001.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the exponentiation calculation unit 234 in the exponentiation calculation step S662a and the ith component o<sub>i</sub> of the encrypted zero vector O calculated by the zero generation unit 232 in the zero generation step S664.<br/>
The element combining unit 235 causes the process to return to the repetition step S661 to generate the subsequent component of the first response R'.</p><p id="p0152" num="0152">The first response R' generated by the encrypted data embedding unit 217 in this manner is transmitted to the authentication apparatus 102 by the first response transmitting unit 221. The authentication apparatus 102 receives and then processes the first response R'.</p><p id="p0153" num="0153">When the component b'<sub>i</sub> of the feature vector b' takes only one of two values of 0 and 1, the processes of the first response generation step S707 can be simplified, as follows, for example.<br/>
First, there is no need for exponentiation, so that the exponentiation calculation unit 234 is not provided, and the exponentiation calculation step S662a is not executed.<br/>
Using the processing device 911, the element combining unit 235 determines whether or not the ith component b'<sub>i</sub> of the feature vector b' is 0 or 1, in the element combining step S665a. When the ith component b'<sub>i</sub> of the feature vector b' is 0, the element combining unit 235 sets the ith component<!-- EPO <DP n="122"> --> o<sub>i</sub> = h<sup>r'i</sup> of the encrypted zero vector O calculated by the zero generation unit 232 in the zero generation step S664 to the ith component R'<sub>i</sub> of the first response R', using the processing device 911. When the ith component b'<sub>i</sub> of the feature vector b' is 1, the element combining unit 235 calculates an element R<sub>i</sub>h<sup>r'i</sup> by combining the ith component o<sub>i</sub> = h<sup>r'i</sup> of the encrypted zero vector O calculated by the zero generation unit 232 in the zero generation step S664 and the ith component R<sub>i</sub> of the first challenge R received by the first challenge receiving unit 211 to set the element R<sub>i</sub>h<sup>r'i</sup> to the ith component R'<sub>i</sub> of the first response R' by multiplication on the finite group G, using the processing device 911.</p><p id="p0154" num="0154">The ith component R<sub>i</sub> of the first challenge R is the product of the R<sub>1</sub>, <sub>i</sub> th power of the generator element g and the R<sub>2, i</sub> th power of the element h. Thus, the ith component R'<sub>i</sub> of the first response R' is the product of the b'<sub>i</sub>R<sub>1, i</sub> th power of the generator element g and the (b'<sub>i</sub>R<sub>2, i</sub> + r'<sub>i</sub>) th power of the element h. That is, the ith component R'<sub>i</sub> of the first response R' is obtained by encrypting the product of the ith component b'<sub>i</sub> of the feature vector b' and the random number R<sub>1, i</sub>.</p><p id="p0155" num="0155"><figref idrefs="f0021">Fig. 37</figref> is a detailed block diagram showing an example of a configuration of the encrypted data extraction unit 305 in this embodiment.<br/>
The encrypted data extraction unit 305 of the authentication apparatus 102 includes the inverse number calculation unit 351 and the scalar multiplication calculation unit 352, for example.</p><p id="p0156" num="0156">The encrypted feature vector C' generated by the encrypted data extraction unit 305 of the authentication apparatus 102 is a T-dimensional vector (c'<sub>1</sub>, c'<sub>2</sub>, ..., c'<sub>T</sub>) having components of elements of the finite group G,<!-- EPO <DP n="123"> --> like the encrypted feature vector C generated by the encrypted data generation unit 206 of the registration apparatus 104.</p><p id="p0157" num="0157">Using the processing device 911, the inverse number calculation unit 351 calculates an inverse number κ<sub>i</sub> = R<sub>1, i</sub><sup>-1</sup> of each random number R<sub>1, i</sub> by multiplication of integers modulo N, based on the T pieces of random numbers R<sub>1, i</sub> (i being each integer not less than 1 and not more than T) stored by the random number storage unit 322. The inverse number κ<sub>i</sub> is an integer where, when the product of the random number R<sub>1, i</sub> and the inverse number κ<sub>i</sub> is divided by N, the remainder is 1. Since N is not a prime number, the random number R<sub>1, i</sub> does not necessarily have the inverse number κ<sub>i</sub>. However, the two prime numbers p and q, which are prime factors of N, are sufficiently large, the probability that the random number R<sub>1, i</sub> is a zero divisor is extremely small and is negligible.<br/>
Using the processing device 911, the exponentiation calculation unit 353 calculates the encrypted feature vector C', based on the first response R' received by the first response receiving unit 331 and the T inverse numbers κ<sub>i</sub> calculated by the inverse number calculation unit 351. The ith component c'<sub>i</sub> (i being the integer not less than 1 and not more than T) of the encrypted feature vector C' calculated by the exponentiation calculation unit 353 is an element obtained by exponentiating the ith component R'<sub>i</sub> of the first response R' by the ith inverse number κ<sub>i</sub> using multiplication on the finite group G. Each component c'<sub>i</sub> of the encrypted feature vector C' is obtained by encrypting the component b'<sub>i</sub> of the feature vector b'.</p><p id="p0158" num="0158"><figref idrefs="f0022">Fig. 38</figref> is a flow chart diagram showing an example of a flow of processes of the encrypted biometric information extraction step S710 in this<!-- EPO <DP n="124"> --> embodiment.<br/>
In the encrypted biometric information extraction step S710, the authentication apparatus 102 generates the encrypted feature vector C', based on the first response R'. The encrypted biometric information extraction unit S710 includes the initialization step S730, the repetition step S731, the inverse number calculation step S732, and an exponentiation calculation step S733a, for example.</p><p id="p0159" num="0159">First, in the initialization step S730, the exponentiation calculation unit 353 initializes the integer i to 0, using the processing device 911.<br/>
In the repetition step S731, the exponentiation calculation unit 353 adds 1 to the integer i, using the processing device 911. When the integer i is larger than T, the exponentiation calculation unit 353 finishes the encrypted biometric information extraction step S710. When the integer i is not more than T, the exponentiation calculation unit 353 causes the process to proceed to the inverse number calculation step S732 to generate the ith component c'<sub>i</sub> of the encrypted feature vector C'.<br/>
In the inverse number calculation step S732, using the processing device 911, the inverse number calculation unit 351 calculates the inverse number κ<sub>i</sub> = R<sub>1</sub>, <sub>i</sub><sup>-1</sup>, based on the ith random number R<sub>1, i</sub> out of the T pieces of random numbers stored by the random number storage unit 322 in the first challenge generation step S701.<br/>
In the exponentiation calculation step S733a, using the processing device 911, the exponentiation calculation unit 353 calculates the ith component c'<sub>i</sub> = R' <sub>i</sub><sup>κi</sup>, based on the ith component R'<sub>i</sub> of the first response R' received by the first response receiving unit 331 and the inverse number κ<sub>i</sub><!-- EPO <DP n="125"> --> calculated in the inverse number calculation step S732.<br/>
The exponentiation calculation unit 353 causes the process to return to the repetition step S731 to generate the subsequent component of the encrypted feature vector C'.</p><p id="p0160" num="0160">The encrypted feature vector C' generated by the encrypted data extraction unit 305 in this manner is used in the second challenge generation step S712.</p><p id="p0161" num="0161">The ith component R'<sub>i</sub> of the first response R' is the product of the b'<sub>i</sub>R<sub>1, i</sub>th power of the generator element g and the (b'<sub>i</sub>R<sub>2, i</sub> + r'<sub>i</sub>)th power of the element h. Thus, the ith component c'<sub>i</sub> of the encrypted feature vector C' is the product of the (R<sub>1, i</sub><sup>-1</sup>b'<sub>i</sub>R<sub>1, i</sub>) th power of the generator element g and the R<sub>1, i</sub><sup>-1</sup>(b'<sub>i</sub>R<sub>2, i</sub> + r'<sub>i</sub>) th power of the element h. Since R<sub>1, i</sub>R<sub>1, i</sub><sup>-1</sup> ≡ 1(mod N), c'<sub>i</sub> is the product of the b'<sub>i</sub>th power of the generator element g and the R<sub>1</sub>, i<sup>-1</sup>(b'<sub>i</sub>R<sub>2, i</sub> + r'<sub>i</sub>) th power of the element h. That is, the ith component c'<sub>i</sub> of the encrypted feature vector C' is obtained by encrypting the ith component b'<sub>i</sub> of the feature vector b'.</p><p id="p0162" num="0162"><figref idrefs="f0023">Fig. 39</figref> is a detailed block diagram showing an example of a configuration of the encrypted random similarity degree calculation unit 314 in this embodiment.<br/>
The encrypted random similarity degree calculation unit 314 of the authentication apparatus 102 includes the difference calculation unit 361, a square calculation unit 368, the encryption key generation unit 366, and an element combining unit 370.</p><p id="p0163" num="0163">Using the processing device 911, the random number generation unit 303 generates two random numbers s<sub>1</sub> and s<sub>2</sub>, based on the order N, which is a<!-- EPO <DP n="126"> --> part of the public key pk stored by the public key storage unit 302. The random numbers s<sub>1</sub> and s<sub>2</sub> generated by the random number generation unit 303 are the integers uniform randomly selected from among integers not less than 0 and less than N.<br/>
The random number storage unit 322 stores one random number s<sub>1</sub> out of the random numbers generated by the random number generation unit 303, using the storage device 914.</p><p id="p0164" num="0164">Using the processing device 911, the difference calculation unit 361 calculates the encrypted difference vector ΔC, based on the encrypted feature vector C stored by the encrypted data storage unit 312 and the encrypted feature vector C' extracted by the encrypted data extraction unit 305. The encrypted difference vector ΔC is a T-dimensional vector (Δc<sub>1</sub>, Δc<sub>2</sub>, ..., Δc<sub>T</sub>) having components of elements of the finite group G. The ith component Δc<sub>i</sub> (i being the integer not less than 1 and not more than T) of the encrypted difference vector ΔC is an element c<sub>i</sub>c'<sub>i</sub><sup>-1</sup> obtained by combining the ith component c<sub>i</sub> of the encrypted feature vector C and an inverse element c'<sub>i</sub><sup>-1</sup> of the ith component of the encrypted feature vector C' using multiplication on the finite group G. Each component Δc<sub>i</sub> of the encrypted difference vector ΔC is obtained by encrypting a difference (b<sub>i</sub> - b'<sub>i</sub>) between the component b<sub>i</sub> of the feature vector b and the component b'<sub>i</sub> of the feature vector b'.<br/>
The ith component Δc<sub>i</sub> of the encrypted difference vector ΔC may be an element c<sub>i</sub><sup>-1</sup>c'<sub>i</sub> obtained by an inverse element c<sub>i</sub><sup>-1</sup> of the ith component c<sub>i</sub> of the encrypted feature vector C and the ith component c'<sub>i</sub> of the encrypted feature vector C' using multiplication on the finite group G. Further, the component Δc<sub>i</sub> of the encrypted difference vector ΔC may be a randomly<!-- EPO <DP n="127"> --> selected one of the elements c<sub>i</sub>c'<sub>i</sub><sup>-1</sup> and c<sub>i</sub><sup>-1</sup>c'<sub>i</sub>.<br/>
Using the processing device 911, the square calculation unit 368 calculates an encrypted square vector ΔC', based on the pairing e which is a part of the public key pk stored by the public key storage unit 302 and the encrypted difference vector ΔC calculated by the difference calculation unit 361. The encrypted square vector ΔC' is a T-dimensional vector ((Δc'<sub>1</sub>, Δc'<sub>2</sub>, ..., Δc'<sub>T</sub>) having components of elements of the finite group G<sub>T</sub>. The ith component Δc'<sub>i</sub> (i being the integer not less than 1 and not more than T) of the encrypted square vector ΔC' is a paring e (Δc<sub>i</sub>, Δc<sub>i</sub>) obtained by translation of a set of the ith components Δc<sub>i</sub> of the encrypted difference vector ΔC by the pairing e. Each component Δc'<sub>i</sub> of the encrypted square vector ΔC' is obtained by encrypting the square (b<sub>i</sub> - b'<sub>i</sub>)<sup>2</sup> of a difference between the component b<sub>i</sub> of the feature vector b and the component b'<sub>i</sub> of the feature vector b'.<br/>
Using the processing device 911, the encryption key generation unit 366 calculates the encryption key <img id="ib0080" file="imgb0022.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> based on the paring e, the generator element g, and the element h, which are the parts of the public key pk stored by the public key storage unit 302, and the two random numbers s<sub>1</sub> and s<sub>2</sub> generated by the random number generation unit 303. The encryption key<img id="ib0081" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> is an element of the finite group G<sub>T</sub>. The encryption key <img id="ib0082" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> is an element e (g<sup>s1</sup>h<sup>s2</sup>, g) obtained by translation of a set of an element g<sup>s1</sup>h<sup>s2</sup> and the generator element g by the pairing e. The element g<sup>s1</sup>h<sup>s2</sup> is obtained by combining an element g<sup>s1</sup> and an element h<sup>s2</sup> using multiplication on the finite group G. The element g<sup>s1</sup> is obtained by exponentiating the generator element g by the random number s<sub>1</sub>, using exponentiation on the finite group<!-- EPO <DP n="128"> --> G. The element h<sup>s2</sup> is obtained by exponentiating the element h by the random number s<sub>2</sub>, using exponentiation on the finite group G. Based on the generator element g and the random number s<sub>1</sub>, the encryption key generation unit 366 calculates the element g<sup>s1</sup> by exponentiating the generator element g by the random number s<sub>1</sub>, using the exponentiation on the finite group G, for example. Based on the element h and the random number s<sub>2</sub>, the encryption key generation unit 366 calculates the element h<sup>s2</sup> by exponentiating the element h by the random number s<sub>2</sub>, using the exponentiation on the finite group G. The encryption key generation unit 366 calculates the element g<sup>s1</sup>h<sup>s2</sup> by combining the two calculated elements g<sup>s1</sup> and h<sup>s2</sup> using the multiplication on the finite group G. The encryption key generation unit 366 calculates the element e(g<sup>s</sup>h<sup>s2</sup>, g) by translation of the set of the calculated element g<sup>s1</sup>h<sup>s2</sup> and the generator element g by the pairing e. The encryption key <img id="ib0083" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> is obtained by encrypting the random number s<sub>1</sub> calculated by the random number generation unit 303.<br/>
Using the processing device 911, the element combining unit 370 calculates the second challenge C^, based on the encrypted square vector ΔC' calculated by the square calculation unit 368 and the encryption key<img id="ib0084" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the encryption key generation unit 366. The second challenge C^ is an element of the finite group G<sub>T</sub>. The second challenge C" calculated by the element combining unit 370 is an element Π<sub>i</sub>[Δc'<sub>i</sub>]u, obtained by combining T components Δc'<sub>i</sub> of the encrypted square vector ΔC' and the encryption key <img id="ib0085" file="imgb0022.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> using multiplication on the finite group G<sub>T</sub>. The second challenge C' is obtained by encrypting a summation ∑<sub>i</sub>[(b<sub>i</sub> - b'<sub>i</sub>)<sup>2</sup>] + s<sub>1</sub>, which is the sum of the random number s<sub>1</sub> and the summation of the square (b<sub>i</sub> - b'<sub>i</sub>)<sup>2</sup><!-- EPO <DP n="129"> --> of the difference between the component b<sub>i</sub> of the feature vector b and the component b'<sub>i</sub> of the feature vector b'.</p><p id="p0165" num="0165"><figref idrefs="f0024">Fig. 40</figref> is a flow chart diagram showing an example of a flow of processes of the second challenge generation step S712 in this embodiment.<br/>
In the second challenge generation step S712, the authentication apparatus 102 generates the second challenge C^, based on the two encrypted feature vectors C and C'. The second challenge generation step S712 includes the random number generation step S749, an encryption key generation step S752, the initialization step S740, the repetition step S741, the difference calculation step S742, a square calculation step S753, and an element summation step S748a, for example.</p><p id="p0166" num="0166">First, in the random generation step S749, the random number generation unit 303 generates the two random numbers s<sub>1</sub> and s<sub>2</sub>, using the processing device 911.<br/>
In the encryption key generation step S752, using the processing device 911, the encryption key generation unit 366 calculates the encryption key <img id="ib0086" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> = g<sup>s1</sup>h<sup>s2</sup>, based on the two random numbers s<sub>1</sub> and s<sub>2</sub> generated by the random number generation unit 303 in the random number generation step S749. Using the processing device 911, the element combining unit 370 initializes the second challenge C^ to the encryption key <img id="ib0087" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the encryption key generation unit 366.<br/>
In the initialization step S740, the element combining unit 370 initializes the integer i to 0, using the processing device 911.<br/>
In the repetition step S741, using the processing device 911, the element combining unit 370 adds 1 to the integer i. When the integer i is<!-- EPO <DP n="130"> --> larger T, the element combining unit 370 finishes the second challenge generation step S712, because the second challenge C^ has been completed. When the integer is not more than T, the element combining unit 370 causes the process to proceed to the difference calculation step S742.<br/>
In the difference calculation step S742, using the processing device 911, the difference calculation unit 361 calculates the ith component Δc<sub>i</sub> of the encrypted difference vector ΔC, based on the component c<sub>i</sub> of the encrypted feature vector C stored by the encrypted data storage unit 305 and the ith component c'<sub>i</sub> of the encrypted feature vector C' extracted by the encrypted data extraction unit 305.<br/>
In the square calculation step S753, the square calculation unit 368 calculates the ith component Δc'<sub>i</sub> = e(Δc<sub>i</sub>, Δc<sub>i</sub>) of the encrypted square vector ΔC', based on the element Δc<sub>i</sub> calculated by the difference calculation unit 361 in the difference calculation step S742.<br/>
In the element summation step S748a, using the processing device911, the element combining unit 370 combines the ith component Δc'<sub>i</sub> of the encrypted square vector ΔC' calculated by the square calculation unit 368 in the square calculation step S753 with the second challenge C^.<br/>
The element combining unit 370 causes the process to the repetition step S741.</p><p id="p0167" num="0167">The second challenge C^ calculated by the encrypted random similarity degree calculation unit 314 in this manner is transmitted to the decryption device 103 by the second challenge transmitting unit 321, and the decryption device 103 receives and then processes the second challenge C^.</p><p id="p0168" num="0168">The procedure for calculating the second challenge C^ may be<!-- EPO <DP n="131"> --> different from the above-mentioned procedure. Assume that calculation such as multiplication can be performed more quickly on the finite group G<sub>T</sub> than on the finite group G, for example. Then, the number of arithmetic operations on the finite group G<sub>T</sub> should be increased and the number of arithmetic operations on the finite group G should be reduced. Then, the time to be taken for calculation in the second challenge generation step S712 can be thereby reduced.</p><p id="p0169" num="0169"><figref idrefs="f0024">Fig. 41</figref> is a detailed block diagram showing another example of a configuration of the encrypted random similarity degree calculation unit 314 in this embodiment.<br/>
The encrypted random similarity degree calculation unit 314 of the authentication apparatus 102 includes two square calculation units 381 and 382, a product calculation unit 383, an exponentiation calculation unit 384, and the element combining unit 370, for example.</p><p id="p0170" num="0170">Using the processing device 911, the square calculation unit 381 calculates a first encrypted square vector <img id="ib0088" file="imgb0088.tif" wi="8" he="5" img-content="character" img-format="tif" inline="yes"/> based on the pairing e which is the part of the public pk stored by the public key storage unit 302 and the encrypted feature vector C stored by the encrypted data storage unit 312. The first encrypted square vector is a T-dimensional vector (<img id="ib0089" file="imgb0089.tif" wi="8" he="4" img-content="character" img-format="tif" inline="yes"/> <img id="ib0090" file="imgb0090.tif" wi="7" he="4" img-content="character" img-format="tif" inline="yes"/> ... <img id="ib0091" file="imgb0091.tif" wi="7" he="4" img-content="character" img-format="tif" inline="yes"/>) having components of elements of the finite group G<sub>T</sub>. The ith component<img id="ib0092" file="imgb0092.tif" wi="7" he="4" img-content="character" img-format="tif" inline="yes"/> (i being the integer not less than 1 and not more than T) of the first encrypted square vector <img id="ib0093" file="imgb0093.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/> is an element e(c<sub>i</sub>, c<sub>i</sub>) obtained by translation of a set of the ith components c<sub>i</sub> of the encrypted feature vector C by the pairing e.<br/>
Using the processing unit 911, the square calculation unit 382 calculates a second encrypted square vector <img id="ib0094" file="imgb0094.tif" wi="7" he="4" img-content="character" img-format="tif" inline="yes"/> based on the pairing e which<!-- EPO <DP n="132"> --> is the part of the public pk stored by the public key storage unit 302 and the encrypted feature vector C' extracted by the encrypted data extraction unit 305. The second encrypted square vector <img id="ib0095" file="imgb0095.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/> is a T-dimensional vector (<img id="ib0096" file="imgb0096.tif" wi="8" he="5" img-content="character" img-format="tif" inline="yes"/> <img id="ib0097" file="imgb0097.tif" wi="8" he="5" img-content="character" img-format="tif" inline="yes"/>...<img id="ib0098" file="imgb0098.tif" wi="8" he="5" img-content="character" img-format="tif" inline="yes"/>)having components of elements of the finite group G<sub>T</sub>. The ith component <img id="ib0099" file="imgb0099.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> (i being the integer not less than 1 and not more than T) of the second encrypted square vector <img id="ib0100" file="imgb0095.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/> is an element e(c'<sub>i</sub>, c'<sub>i</sub>) obtained by converting a set of the ith components c'<sub>i</sub> of the encrypted feature vector C'.<br/>
Using the processing device 911, the product calculation unit 383 calculates an encrypted product vector C, based on the pairing e which is the part of the public pk stored by the public key storage unit 302, the encrypted feature vector C stored by the encrypted data storage unit 312, and the encrypted feature vector C' extracted by the encrypted data extraction unit 305. The encrypted product vector <img id="ib0101" file="imgb0021.tif" wi="5" he="5" img-content="character" img-format="tif" inline="yes"/> is a T-dimensional vector (<img id="ib0102" file="imgb0016.tif" wi="7" he="5" img-content="character" img-format="tif" inline="yes"/> <img id="ib0103" file="imgb0017.tif" wi="7" he="5" img-content="character" img-format="tif" inline="yes"/>...<img id="ib0104" file="imgb0018.tif" wi="7" he="5" img-content="character" img-format="tif" inline="yes"/>) having components of elements of the finite group G<sub>T</sub>. The ith component<img id="ib0105" file="imgb0019.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> (i being the integer not less than 1 and not more than T) of the encrypted product vector <img id="ib0106" file="imgb0106.tif" wi="4" he="5" img-content="character" img-format="tif" inline="yes"/> is an element e(c<sub>i</sub>, c'<sub>i</sub>) obtained by translation of a set of the ith component c<sub>i</sub> of the encrypted feature vector C and the ith component c'<sub>i</sub> of the encrypted feature vector C' by the pairing e.<br/>
Using the processing device 911, the exponentiation calculation unit 384 calculates two exponentiation elements <img id="ib0107" file="imgb0107.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> and <img id="ib0108" file="imgb0108.tif" wi="7" he="4" img-content="character" img-format="tif" inline="yes"/> based on the pairing e, the generator element g, and the element h which are the parts of the public key pk stored by the public key storage unit 302 and the two random numbers s<sub>1</sub> and s<sub>2</sub> generated by the random number generation unit 303. The first exponentiation element <img id="ib0109" file="imgb0107.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> is an element e(g, g)<sup>s1</sup> obtained by exponentiating an element e(g, g) by the random number s<sub>1</sub>, using exponentiation on the finite<!-- EPO <DP n="133"> --> group G<sub>T</sub>. The element e(g, g) is obtained by translation of a set of the generator elements g by the pairing e. The second exponentiation element<img id="ib0110" file="imgb0110.tif" wi="5" he="3" img-content="character" img-format="tif" inline="yes"/> is an element e(g, h)<sup>s2</sup> obtained by exponentiating an element e(g, h) by the random number s<sub>2</sub>, using exponentiation on the finite group G<sub>T</sub>. The element e(g, h) is obtained by translation of a set of the generator element g and the generator element h by the pairing e.<br/>
Using the processing device 911, the element combining unit 370 calculates the second challenge C^, based on the first encrypted square vector<img id="ib0111" file="imgb0093.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the square calculation unit 381, the second encrypted squarevector <img id="ib0112" file="imgb0095.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the square calculation unit 382, the encrypted productvector <img id="ib0113" file="imgb0021.tif" wi="5" he="5" img-content="character" img-format="tif" inline="yes"/> calculated by the product calculation unit 383, and the two exponentiation elements <img id="ib0114" file="imgb0107.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> and <img id="ib0115" file="imgb0110.tif" wi="5" he="3" img-content="character" img-format="tif" inline="yes"/> calculated by the exponentiation calculation unit 384. The second challenge C^ is an element of the finite group G<sub>T</sub>. The second challenge C^ calculated by the element combining unit 370 is an element Πi[<img id="ib0116" file="imgb0116.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/><img id="ib0117" file="imgb0099.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/><img id="ib0118" file="imgb0019.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/><sup>-2</sup>] <img id="ib0119" file="imgb0107.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/><img id="ib0120" file="imgb0110.tif" wi="5" he="3" img-content="character" img-format="tif" inline="yes"/> obtained by combining all of the T components <img id="ib0121" file="imgb0121.tif" wi="7" he="6" img-content="character" img-format="tif" inline="yes"/> of the first encrypted square vector <img id="ib0122" file="imgb0122.tif" wi="7" he="5" img-content="character" img-format="tif" inline="yes"/> the T components <img id="ib0123" file="imgb0099.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> of the second encrypted square vector <img id="ib0124" file="imgb0094.tif" wi="7" he="4" img-content="character" img-format="tif" inline="yes"/> the minus square of the T components <img id="ib0125" file="imgb0019.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> of the encrypted product vector <img id="ib0126" file="imgb0030.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> and the two exponentiation elements <img id="ib0127" file="imgb0107.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> and <img id="ib0128" file="imgb0110.tif" wi="5" he="3" img-content="character" img-format="tif" inline="yes"/>. In this case, the second challenge C^ is obtained by encrypting ∑<sub>i</sub>[b<sub>i</sub><sup>2</sup> + b'<sub>i</sub><sup>2</sup> - 2b<sub>i</sub>b'<sub>i</sub>] + s<sub>1</sub> = ∑<sub>i</sub>[(b<sub>i</sub> - b'<sub>i</sub>)<sup>2</sup>] + s<sub>1</sub>.</p><p id="p0171" num="0171"><figref idrefs="f0025">Fig. 42</figref> is a flow chart diagram showing another example of a flow of processes of the second challenge generation step S712 in this embodiment.<br/>
The second challenge generation step S712 includes the random number generation step S749, an exponentiation calculation step S752a, the initialization step S740, the repetition step S741, the square calculation step<!-- EPO <DP n="134"> --> S753, a product calculation step S754, and the element summation step S748a, for example.</p><p id="p0172" num="0172">In the random number generation step S749, the random number generation unit 303 generates the two random numbers s<sub>1</sub> and s<sub>2</sub>, using the processing device 911.<br/>
In the exponentiation calculation step S752a, using the processing device 911, the exponentiation calculation unit 384 calculates the two exponentiation element <img id="ib0129" file="imgb0107.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> = e(g, g)<sup>s1</sup> and <img id="ib0130" file="imgb0110.tif" wi="5" he="3" img-content="character" img-format="tif" inline="yes"/> = e(g,h)<sup>s2</sup>, based on the two random numbers s<sub>1</sub> and s<sub>2</sub> generated by the random number generation unit 303 in the random number generation step S749.<br/>
In the initialization step S740, using the processing device 911, the element combining unit 370 initializes the integer i to 0. Using the processing device 911, the element combining unit 370 calculates an element<img id="ib0131" file="imgb0131.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/><img id="ib0132" file="imgb0110.tif" wi="5" he="3" img-content="character" img-format="tif" inline="yes"/> by combining the two exponentiation elements <img id="ib0133" file="imgb0133.tif" wi="6" he="6" img-content="character" img-format="tif" inline="yes"/> and <img id="ib0134" file="imgb0110.tif" wi="5" he="3" img-content="character" img-format="tif" inline="yes"/> calculated by the exponentiation calculation unit 384 in the exponentiation calculation step S752a, using multiplication on the finite group G<sub>T</sub>. The element combining unit 370 initializes the second challenge C^ to the calculated element<img id="ib0135" file="imgb0131.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/><img id="ib0136" file="imgb0108.tif" wi="7" he="4" img-content="character" img-format="tif" inline="yes"/> using the processing device 911.<br/>
In the repetition step S741, using the processing device 911, the element combining unit 370 adds 1 to the integer i. When the integer i is larger than T, the second challenge C^ has been completed. Thus, the element combining unit 370 finishes the second challenge generation step S712. When the integer i is not more than T, the element combining unit 370 causes the process to proceed to the square calculation step S753.<br/>
In the square calculation step S753, using the processing device 911,<!-- EPO <DP n="135"> --> the square calculation unit 381 calculates the ith component <img id="ib0137" file="imgb0116.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> = e(c<sub>i</sub>, c<sub>i</sub>) of the first encrypted square vector <img id="ib0138" file="imgb0122.tif" wi="7" he="5" img-content="character" img-format="tif" inline="yes"/> based on the ith component c<sub>i</sub> of the encrypted feature vector C stored by the encrypted data storage unit 312. Using the processing device 911, the square calculation unit 382 calculates the ith component <img id="ib0139" file="imgb0099.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> = e(c'<sub>i</sub>, c'<sub>i</sub>) of the second encrypted square vector <img id="ib0140" file="imgb0094.tif" wi="7" he="4" img-content="character" img-format="tif" inline="yes"/> based on the ith component c'<sub>i</sub> of the encrypted feature vector C' extracted by the encrypted data extraction unit 305.<br/>
In the product calculation step S754, using the processing device 911, the product calculation unit 383 calculates the ith component <img id="ib0141" file="imgb0019.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> = e(c<sub>i</sub>, c'<sub>i</sub>) based on the ith component c<sub>i</sub> of the encrypted feature vector C stored by the encrypted data storage unit 312 and the ith component c'<sub>i</sub> of the encrypted feature vector C' extracted by the encrypted data extraction unit 305.<br/>
In the element summation step S748a, using the processing device 911, the element combining unit 370 combines the ith component <img id="ib0142" file="imgb0116.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> of the first encrypted square vector <img id="ib0143" file="imgb0093.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the square calculation unit 381 in the square calculation step S753, the ith component <img id="ib0144" file="imgb0099.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> of the second encrypted square vector <img id="ib0145" file="imgb0095.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the square calculation unit 382 in the square calculation step S753, and the minus square of the ith component<img id="ib0146" file="imgb0019.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> of the encrypted product vector C calculated by the product calculation unit 383 in the product calculation step S754 with the second challenge C^.<br/>
The element combining unit 370 causes the process to return to the repetition step S741.</p><p id="p0173" num="0173">By using the processing procedure as described above, the need for an arithmetic operation on the finite group G is eliminated. The second challenge C^ can be generated just by calculation using the pairing e and<!-- EPO <DP n="136"> --> multiplication on the finite group G<sub>T</sub>.<br/>
Since the pairings e(g, g) and e(g, h) and the component e(c<sub>i</sub>, c<sub>i</sub>) of the first encrypted square vector <img id="ib0147" file="imgb0093.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/> are not related to the encrypted feature vector C', the pairings e(g, g) and e(g, h) and the component e(c<sub>i</sub>, c<sub>i</sub>) of the first encrypted square vector <img id="ib0148" file="imgb0093.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/> can be calculated in advance. By calculating these pairings and component in advance, the time to be taken for generating the second challenge C^ can be reduced.</p><p id="p0174" num="0174"><figref idrefs="f0025">Fig. 43</figref> is a flow chart diagram showing an example of a flow of processes of the second response generation step S716 in this embodiment.<br/>
In the second response generation step S716, the decryption device 103 generates the second response Z from the second challenge C^. The second response generation step S716 includes an exponentiation calculation step S571, for example.</p><p id="p0175" num="0175">In the exponentiation calculation step S571, using the processing device 911, the decryption unit 404 of the decryption device 103 calculates the second response Z, based on the prime number p that is the secret key sk stored by the secret key storage unit 413 and the second challenge C^ received by the second challenge receiving unit 402. The second response Z is an element of the finite group G<sub>T</sub>. The second response Z calculated by the decryption unit 404 is an element obtained by exponentiating the second challenge C^ by the prime number p, using exponentiation on the finite group G<sub>T</sub>.</p><p id="p0176" num="0176">The second challenge C^ is obtained by encrypting ∑<sub>i</sub>[b<sub>i</sub> - b'<sub>i</sub>]<sup>2</sup>] + s<sub>1</sub>. Thus, the second response Z is an element obtained by exponentiating an element e(g, g)<sup>p</sup> by ∑<sub>i</sub>[(b<sub>i</sub> - b'<sub>i</sub>)<sup>2</sup>] + s<sub>1</sub> using exponentiation on the finite group<!-- EPO <DP n="137"> --> G<sub>T</sub>. The element e(g, g)<sup>P</sup> is obtained by exponentiating the element e(g, g) by the prime number p using exponentiation on the finite group G<sub>T</sub>. The element e(g, g) is obtained by translation of a set of the generator elements g by the pairing e. Since the element e(g, g)<sup>p</sup> is the element π released as the part of the public key pk, the second response Z is an element obtained by exponentiating the element π by ∑<sub>i</sub>[(b<sub>i</sub>- b'<sub>i</sub>)<sup>2</sup>] + s<sub>1</sub>, using exponentiation on the finite group G<sub>T</sub>.</p><p id="p0177" num="0177">Since the configuration of the plaintext similarity degree extraction unit 315 is the same as that described in the first embodiment, a description will be given with reference to <figref idrefs="f0015">Fig. 24</figref></p><p id="p0178" num="0178">Using the processing device 911, the group conversion unit 371 calculates a decryption key <img id="ib0149" file="imgb0022.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> based on the element π which is the part of the public key pk stored by the public key storage unit 302 and the random number s<sub>1</sub> stored by the random number storage unit 322. The decryption key <img id="ib0150" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> is an element of the definite group G<sub>T</sub>. The decryption key <img id="ib0151" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> is an element π<sup>-s1</sup> obtained by exponentiating the element π by the additive inverse -s<sub>1</sub> of the random number s<sub>1</sub>, using exponentiation on the finite group G<sub>T</sub>.<br/>
Using the processing device 911, the element combining unit 372 calculates the decrypted similarity degree element Z', based on the second response Z received by the second response receiving unit 341 and the decryption key <img id="ib0152" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the group conversion unit 371. The decrypted similarity degree element Z' is an element of the finite group G<sub>T</sub>. The decrypted similarity degree element Z' is an element Z<img id="ib0153" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> obtained by combining the second response Z and the decryption key <img id="ib0154" file="imgb0022.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> using multiplifaction on the finite group G<sub>T</sub>. The second response Z is an element<!-- EPO <DP n="138"> --> obtained by exponentiating the element π by ∑<sub>i</sub>[(b<sub>i</sub> - b'<sub>i</sub>)<sup>2</sup>] + s<sub>1</sub>, using multiplication on the finite group G<sub>T</sub>. Thus, the decrypted similarity degree element Z' is an element obtained by exponentiating the element π by ∑<sub>i</sub>[(b<sub>i</sub> - b'<sub>i</sub>)<sup>2</sup>], using exponentiation on the finite group G<sub>T</sub>.<br/>
Using the processing device 911, the discrete logarithm calculation unit 373 calculates to what power the element π is raised to be equal to the decrypted similarity degree element Z', based on the element π which is the part of the public key pk stored by the public key storage unit 302 and the decrypted similarity degree element Z' calculated by the element combining unit 372, thereby setting the power to the similarity degree d. As in the first embodiment, the discrete logarithm calculation unit 373 may be so configured to calculate the similarity degree d when the similarity degree d is not more than the threshold value do, and to determine that the similarity degree d is larger than the threshold value do when the similarity degree d is larger than the threshold value do.</p><p id="p0179" num="0179">With this arrangement, the authentication apparatus 102 calculates the square ∑<sub>i</sub>[(b<sub>i</sub> - b'<sub>i</sub>)<sup>2</sup>] of the Euclidean distance between the two feature vectors b and b'.</p><p id="p0180" num="0180"><figref idrefs="f0026">Fig. 44</figref> is a flow chart diagram showing an example of a flow of processes of the plaintext similarity degree calculation step S719 in this embodiment.<br/>
In the plaintext similarity degree calculation step S719, the authentication apparatus 102 calculates the similarity degree d from the second response Z. The plaintext similarity degree calculation step S719 includes, the group conversion step S691, the element combining step S692,<!-- EPO <DP n="139"> --> and the discrete logarithm calculation step S693, for example.</p><p id="p0181" num="0181">First, in the group conversion step S691, the group conversion unit 371 calculates the decryption key <img id="ib0155" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> = π<sup>-s1</sup>,based on the random number s<sub>1</sub> stored by the random number storage unit 322 as a temporary key, using the processing device 911.<br/>
In the element combining step S692, using the processing device 911, the element combining unit 372 calculates the decrypted similarity degree element Z' = Z<img id="ib0156" file="imgb0022.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> based on the second response received by the second response receiving unit 341 and the decryption key <img id="ib0157" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the group conversion unit 371 in the group conversion step S691.<br/>
In the discrete logarithm calculation step S693, using the processing device 911, the discrete logarithm calculation unit 373 calculates the similarity degree d, based on the decrypted similarity degree element Z' calculated by the element combining unit 372 in the element combining unit 372.</p><p id="p0182" num="0182">The determination unit 306 determines whether or not the two feature vectors b and b' are similar, based on the similarity degree d calculated by the plaintext similarity degree extraction unit 315, thereby determining a person having biometric information represented by the feature vector b and a person having biometric information represented by the feature vector b' are identical. When the similarity degree d is smaller than the threshold value do, the determination unit 306 determines that the two feature vectors b and b' are similar.</p><p id="p0183" num="0183"><figref idrefs="f0026">Fig. 45</figref> is a flow chart diagram showing a similarity degree calculation procedure in the biometric authentication system 100 in this<!-- EPO <DP n="140"> --> embodiment.<br/>
As a first stage, in the second challenge generation step S712, the authentication apparatus 102 calculates the second challenge C" from the two encrypted feature vectors C and C', thereby calculating δ = ∑<sub>i</sub>[(b<sub>i</sub> - b'<sub>i</sub>)<sup>2</sup>] + s<sub>1</sub> (i being each integer not less than 1 and not more than T). This calculation is performed with the encrypted feature vector C and C' kept encrypted with the key of the decryption apparatus 103. Thus, the authentication apparatus 102 cannot obtain information on the feature vectors b and b'.<br/>
As a second stage, in the second response generation step S716, the decryption apparatus 103 calculates the second response Z from the second challenge C^, thereby calculating ξ. The decryption apparatus 103 just performs decryption processing, so that ξ is equal to δ. The decryption apparatus 103 does not know the temporary key s<sub>1</sub>. Thus, the decryption apparatus 103 cannot obtain the information on the feature vectors b and b' and information on the similarity degree. That is, this calculation is performed with a result of the decryption kept encrypted with the temporary key s<sub>1</sub>.<br/>
As a third stage, in the plaintext similarity degree calculation step S719, the authentication apparatus 102 calculates from the second response Z the similarity degree d = ξ - s<sub>1</sub>. With this arrangement, the authentication apparatus 102 can obtain the similarity degree d, but cannot obtain the information on the feature vectors b and b'.</p><p id="p0184" num="0184">By employing the encryption system by which an arithmetic operation corresponding to plaintext multiplication as well as an arithmetic operation corresponding to plaintext addition with the data associated with<!-- EPO <DP n="141"> --> feature vectors b and b' kept encrypted can be performed at least once, most of the similarity degree calculation procedure may be finished in the first stage. With this arrangement, the decryption apparatus 103 should simply perform the decryption processing.</p><p id="p0185" num="0185">According to this embodiment, the number of the public key pk, the secret key sk, the random numbers to be generated, and the number of the random numbers to be stored can be reduced.<br/>
Further, the amount of data of the second challenge to be transmitted from the authentication apparatus 102 to the decryption apparatus 103 is reduced. Thus, the amount of communication necessary for authentication can be reduced.</p><p id="p0186" num="0186">The encryption system is not limited to the BGN encryption system. It may be so configured that a different ring-homomorphic encryption system such as the Genrty encryption system is employed. It may be so configured that a second encryption system such as the standard public key encryption system is employed for communication between the certification apparatus 101 and the authentication apparatus 102.</p><p id="p0187" num="0187">As in the second embodiment, the certification apparatus 101 in the biometric authentication system 100 may be configured to combine functions as the decryption apparatus 103 and the registration apparatus 104.</p><heading id="h0016">Fifth Embodiment.</heading><p id="p0188" num="0188">A fifth embodiment will be described, using <figref idrefs="f0027 f0028">Figs. 46 to 48</figref>.<br/>
Same reference signs are given to components that are common to those in the first to fourth embodiments, thereby omitting description of the components that are common to those in the first to fourth embodiments.<!-- EPO <DP n="142"> --></p><p id="p0189" num="0189">In this embodiment, the description will be given about a case where the BGN encryption system described in the fourth embodiment is employed as the encryption system, and the inner product ∑<sub>i</sub>[b<sub>i</sub>b'<sub>i</sub>] is calculated as the similarity degree d, as in the third embodiment.</p><p id="p0190" num="0190">An overall configuration of the biometric authentication system 100 and inner configurations of the certification apparatus 101, the authentication apparatus 102, the decryption apparatus 103, and the registration apparatus 104 are similar to those described in the fourth embodiment. Thus, only a difference will be described.</p><p id="p0191" num="0191"><figref idrefs="f0027">Fig. 46</figref> is a detailed block diagram showing an example of a configuration of the encrypted random similarity degree calculation unit 314 in this embodiment.<br/>
The encrypted random similarity degree calculation unit 314 of the authentication apparatus 102 includes the product calculation unit 383, the exponentiation calculation unit 384, and the element combining unit 370, for example.</p><p id="p0192" num="0192">Using the processing device 911, the product calculation unit 383 calculates the encrypted product vector <img id="ib0158" file="imgb0030.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> based on the pairing e which is the part of the public pk stored by the public key storage unit 302, the encrypted feature vector C stored by the encrypted data storage unit 312, and the encrypted feature vector C' extracted by the encrypted data extraction unit 305. The encrypted product vector C is a T-dimensional vector (<img id="ib0159" file="imgb0016.tif" wi="7" he="5" img-content="character" img-format="tif" inline="yes"/> <img id="ib0160" file="imgb0017.tif" wi="7" he="5" img-content="character" img-format="tif" inline="yes"/> ...,<img id="ib0161" file="imgb0018.tif" wi="7" he="5" img-content="character" img-format="tif" inline="yes"/>) having components of elements of the finite group G<sub>T</sub>. The ith component <img id="ib0162" file="imgb0162.tif" wi="5" he="5" img-content="character" img-format="tif" inline="yes"/> of the encrypted product vector C is an element e(c<sub>i</sub>, c'<sub>i</sub>) obtained by translation of a set of the ith component c<sub>i</sub> of the encrypted<!-- EPO <DP n="143"> --> feature vector C and the ith component c'<sub>i</sub> of the encrypted feature vector C' by the pairing e.<br/>
Using the processing device 911, the exponentiation calculation unit 384 calculates the two exponentiation elements <img id="ib0163" file="imgb0107.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> and <img id="ib0164" file="imgb0108.tif" wi="7" he="4" img-content="character" img-format="tif" inline="yes"/> based on the pairing e, the generator element g, and the element h which are the parts of the public key pk stored by the public key storage unit 302 and the two random numbers s<sub>1</sub> and s<sub>2</sub> generated by the random number generation unit 303. The first exponentiation element u<sub>1</sub> is the element e(g, g)<sup>s1</sup> obtained by exponentiating the element e(g, g) by the random number s<sub>1</sub>, using exponentiation on the finite group G<sub>T</sub>. The element e(g, g) is obtained by translation of the set of the generator elements g by the pairing e. The second exponentiation element <img id="ib0165" file="imgb0110.tif" wi="5" he="3" img-content="character" img-format="tif" inline="yes"/> is the element e(g, h)<sup>s2</sup> obtained by exponentiating the element e(g, h) by the random number s<sub>2</sub>, using exponentiation on the finite group G<sub>T</sub>. The element e(g, h) is obtained by translation of the set of the generator element g and the element h by the pairing e.<br/>
Using the processing device 911, the element combining unit 370 calculates the second challenge C^, based on the encrypted product vector C calculated by the product calculation unit 383 and the two exponentiation elements <img id="ib0166" file="imgb0107.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> and <img id="ib0167" file="imgb0110.tif" wi="5" he="3" img-content="character" img-format="tif" inline="yes"/> calculated by the exponentiation calculation unit 384. The second challenge C^ is an element of the finite group G<sub>T</sub>. The second challenge C^ calculated by the element combining unit 370 is an element Π<sub>i</sub>[<img id="ib0168" file="imgb0019.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/>] <img id="ib0169" file="imgb0107.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/><img id="ib0170" file="imgb0110.tif" wi="5" he="3" img-content="character" img-format="tif" inline="yes"/>obtained by combining all of T components <img id="ib0171" file="imgb0019.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> of the encrypted product vector <img id="ib0172" file="imgb0021.tif" wi="5" he="5" img-content="character" img-format="tif" inline="yes"/> and the two exponentiation elements <img id="ib0173" file="imgb0107.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> and <img id="ib0174" file="imgb0108.tif" wi="7" he="4" img-content="character" img-format="tif" inline="yes"/> using multiplication on the finite group G<sub>T</sub>. The second challenge C^ is obtained by encrypting ∑<sub>i</sub>[b<sub>i</sub> b'<sub>i</sub>] + s<sub>1</sub>.<!-- EPO <DP n="144"> --></p><p id="p0193" num="0193"><figref idrefs="f0027">Fig. 47</figref> is a flow chart diagram showing an example of a flow of processes of the second challenge generation step S712 in this embodiment.<br/>
The second challenge generation step S712 includes the random number generation step S749, the exponentiation calculation step S752a, the initialization step S740, the repetition step S741, the product calculation step S754, and the element summation step S748a, for example.</p><p id="p0194" num="0194">In the random number generation step S749, the random number generation unit 303 generates the two random numbers s<sub>1</sub> and s<sub>2</sub>, using the processing device 911.<br/>
In the exponentiation calculation step S752a, using the processing device 911, the exponentiation calculation unit 384 calculates the two exponentiation elements <img id="ib0175" file="imgb0107.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> = e(g, g)<sup>s1</sup> and <img id="ib0176" file="imgb0110.tif" wi="5" he="3" img-content="character" img-format="tif" inline="yes"/> = e(g,h)<sup>s2</sup>, based on the two random numbers s<sub>1</sub> and s<sub>2</sub> generated by the random number generation unit 303 in the random number generation step S749.<br/>
In the initialization step S740, using the processing device 911, the element combining unit 370 initializes the integer i to 0. Using the processing device 911, the element combining unit 370 calculates the element<img id="ib0177" file="imgb0107.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/><img id="ib0178" file="imgb0110.tif" wi="5" he="3" img-content="character" img-format="tif" inline="yes"/> by combining the two exponentiation elements <img id="ib0179" file="imgb0107.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> and <img id="ib0180" file="imgb0110.tif" wi="5" he="3" img-content="character" img-format="tif" inline="yes"/> calculated by the exponentiation calculation unit 384, using multiplication on the finite group G<sub>T</sub>. The element combining unit 370 initializes the second challenge C^ to the calculated element <img id="ib0181" file="imgb0107.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/><img id="ib0182" file="imgb0108.tif" wi="7" he="4" img-content="character" img-format="tif" inline="yes"/> using the processing device 911.<br/>
In the repetition step S741, using the processing device 911, the element combining unit 370 adds 1 to the integer i. When the integer i is larger than T, the second challenge C^ has been completed. Thus, the element combining unit 370 finishes the second challenge generation step<!-- EPO <DP n="145"> --> S712. When the integer i is not more than T, the element combining unit 370 causes the process to proceed to the product calculation step S754.<br/>
In the product calculation step S754, using the processing device 911, the product calculation unit 383 calculates the ith component <img id="ib0183" file="imgb0019.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> = e(c<sub>i</sub>, c'<sub>i</sub>) of the encrypted product vector <img id="ib0184" file="imgb0030.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/>, based on the ith component c<sub>i</sub> of the encrypted feature vector C stored by the encrypted data storage unit 312 and the ith component c'<sub>i</sub> of the encrypted feature vector C' extracted by the encrypted data extraction unit 305.<br/>
In the element summation step S748a, using the processing device 911, the element combining unit 370 combines the ith component <img id="ib0185" file="imgb0019.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> of the encrypted product vector <img id="ib0186" file="imgb0021.tif" wi="5" he="5" img-content="character" img-format="tif" inline="yes"/> calculated by the product calculation unit 383 in the product calculation step S754 with the second challenge C^, using multiplication on the finite group G<sub>T</sub>.<br/>
The element combining unit 370 causes the process to proceed to the repetition step S741.</p><p id="p0195" num="0195">The second challenge C^ calculated by the encrypted random similarity degree calculation unit 314 in this manner is transmitted to the decryption apparatus 103 by the second challenge transmitting unit 321. The decryption apparatus 103 receives and then processes the second challenge C^.</p><p id="p0196" num="0196">The decryption unit 404 of the decryption apparatus 103 has the same configuration as that in the fourth embodiment. However, the second challenge C^ has a different meaning. Thus, the second response Z to be generated by the decryption unit 404 also has a meaning different from that in the first embodiment.<br/>
<!-- EPO <DP n="146"> -->That is, the second response Z is an element obtained by exponentiating the element π of the finite group G<sub>T</sub> by (∑<sub>i</sub>[(b<sub>i</sub> b'<sub>i</sub>) + s<sub>1</sub>) (i being each integer not less than 1 and not more than T) by exponentiation on the finite group G<sub>T</sub>. That is, the second response Z is the one obtained by the inner product ∑<sub>i</sub>[b<sub>i</sub>b'<sub>i</sub>] between the feature vector b and the feature vector b' by the random number s<sub>1</sub> as the temporary key.</p><p id="p0197" num="0197">The plaintext similarity degree extraction unit 315 of the authentication apparatus 102 also has the same configuration as that in the fourth embodiment.<br/>
The decrypted similarity degree element Z' calculated by the element combining unit 370 is an element obtained by exponentiating the element π by the inner product ∑<sub>i</sub>[b<sub>i</sub>b'<sub>i</sub>] between the feature vector b and the feature vector b' by exponentiation on the finite group G<sub>T</sub>. Accordingly, the plaintext similarity degree extraction unit 315 calculates the inner product ∑<sub>i</sub>[b<sub>i</sub>b'<sub>i</sub>] between the feature vector b and the feature vector b', as the similarity degree d.</p><p id="p0198" num="0198">The determination unit 306 determines that the two feature vectors b and b' are similar when the similarity degree d calculated by the discrete logarithm calculation unit 373 is larger than the predetermined threshold value do.<br/>
With this arrangement, it can be determined whether or not the two feature vectors b and b' are similar, using the number of matches between feature points as a reference.</p><p id="p0199" num="0199"><figref idrefs="f0028">Fig. 48</figref> is a similarity degree calculation procedure in the biometric authentication system 100 in this embodiment.<br/>
<!-- EPO <DP n="147"> -->As a first stage, in the second challenge generation step S712, the authentication apparatus 102 calculates the second challenge C^ from the two encrypted feature vectors C and C', thereby calculating δ = ∑<sub>i</sub>[(b<sub>i</sub> - b'<sub>i</sub>)<sup>2</sup>] + s<sub>1</sub> (i being each integer not less than 1 and not more than T). This calculation is performed with the encrypted feature vectors C and C' kept encrypted with the key of the decryption apparatus 103. Thus, the authentication apparatus 102 cannot obtain information on the feature vectors b and b'.<br/>
As a second stage, in the second response generation step S716, the decryption apparatus 103 calculates the second response Z from the second challenge C^, thereby calculating ξ. The decryption apparatus 103 just performs decryption processing, so that ξ is equal to δ. The decryption apparatus 103 does not know the temporary key s<sub>1</sub>. Thus, the decryption apparatus 103 cannot obtain the information on the feature vectors b and b' and information on the similarity degree. That is, this calculation is performed with a result of the decryption encrypted with the temporary key s<sub>1</sub>.<br/>
As a third stage, in the plaintext similarity degree calculation step S719, the authentication apparatus 102 calculates from the second response Z the similarity degree d = ξ - s<sub>1</sub>. With this arrangement, the authentication apparatus 102 can obtain the similarity degree d, but cannot obtain the information on the feature vectors b and b'.</p><p id="p0200" num="0200">The encryption system is not limited to the BGN encryption system. It may be so configured that a different ring-homomorphic encryption system such as the Genrty encryption system is employed. It may be so configured that a second encryption system such as the standard public key encryption system is employed for communication between the certification apparatus<!-- EPO <DP n="148"> --> 101 and the authentication apparatus 102.</p><p id="p0201" num="0201">As in the second embodiment, the certification apparatus 101 in the biometric authentication system 100 may be configured to combine functions as the decryption apparatus 103 and the registration apparatus 104.</p><p id="p0202" num="0202">As compared with the fourth embodiment, configurations of the certification apparatus 101, the decryption apparatus 103, and the registration apparatus 104 remain unchanged, and only the authentication apparatus 102 has a different configuration from that in the fourth embodiment. Accordingly, by setting the authentication apparatus 102 to a configuration capable of switching between the configuration described in the fourth embodiment and the configuration described in this embodiment, two types of similarity degrees using the Euclidean distance and the inner product can be calculated, without altering the other apparatuses in the biometric authentication system 100.</p><heading id="h0017">Sixth Embodiment.</heading><p id="p0203" num="0203">A sixth embodiment will be described, using <figref idrefs="f0028 f0029 f0030 f0031 f0032 f0033 f0034 f0035">Figs. 49 to 61</figref>.<br/>
Same reference signs are given to components that are common to those in the first to fifth embodiments, thereby omitting description of the components that are common to those in the first to fifth embodiments.</p><p id="p0204" num="0204">In this embodiment, the description will be given about a case where the Paillier encryption system is employed as the encryption system. The square of the Euclidean distance is used for the similarity degree d, as in the first embodiment.</p><p id="p0205" num="0205">The Pailler encryption system will be outlined.</p><p id="p0206" num="0206">Assume that N is the product of two mutually different prime<!-- EPO <DP n="149"> --> numbers p and q. Assume that λ is a common multiple between p - 1 and q-1. When r and N are set to integers that are relatively prime, r<sup>λN</sup> ≡ 1(mod N<sup>2</sup>) holds. When x and y are set to integers, (1 + xN)<sup>y</sup> ≡ 1 + xyN (mod N<sup>2</sup>) holds. Accordingly, [r<sup>N</sup>(1 + xN)]<sup>λ</sup> ≡ 1 + xλN (mod N<sup>2</sup>) holds.</p><p id="p0207" num="0207">Assume that N is set to the public key pk, and the least common multiple λ between p - 1 and q - 1 is set to the secret key sk, for example. Assume that an integer x not less than 0 and less than N is set to a plaintext, while r<sup>N</sup> (1 + xN) is set to a ciphertext E(x) obtained by encrypting the plaintext x. Assume, however, that r is an integer uniform randomly selected from among integers not less than 0 and less than N. When the prime numbers p and q are sufficiently large, the probability that r and N are not relatively prime is extremely small to be neglible. For decryption, λ that is the secret key sk is used. When E(x) <sup>λ</sup> ≡ 1 + xλN (mod N<sup>2</sup>) is used, the random number r can be deleted. Since E(x) <sup>λ</sup> - 1 is a multiple of N, [E(x) <sup>λ</sup> - 1]/N is an integer. Assume that the inverse element of λ in multiplication of integers modulo N is indicated by λ<sup>-1</sup>. Then, when the product of (E(x) <sup>λ</sup> - 1]/N and λ<sup>-1</sup> is divided by N to obtain the remainder, the plaintext x can be decrypted.</p><p id="p0208" num="0208">The remainder obtained by dividing the product of a ciphertext E(x<sub>1</sub>) of an integer x<sub>1</sub> and a ciphertext E(x<sub>2</sub>) of an integer x<sub>2</sub> by N<sup>2</sup> is r<sub>1</sub><sup>N</sup> (1 + x<sub>1</sub>N)r<sub>2</sub><sup>N</sup> (1 + x<sub>2</sub>N) ≡ (r<sub>1</sub>r<sub>2</sub>)<sup>N</sup> [1 + (x<sub>1</sub> + x<sub>2</sub>)N] (mod N<sup>2</sup>). Thus, the remainder is a ciphertext E (x<sub>1</sub> + x<sub>2</sub>) of x<sub>1</sub> + x<sub>2</sub> which is the sum of the integer x<sub>1</sub> and the integer x<sub>2</sub>.</p><p id="p0209" num="0209"><figref idrefs="f0028">Fig. 49</figref> is a detailed block diagram showing an example of a configuration of the key generation unit 401 in this embodiment.<br/>
<!-- EPO <DP n="150"> -->The key generation unit 401 of the decryption apparatus 103 includes a prime number determination unit 441, a product calculation unit 442, and a common multiple calculation unit 443, for example.<br/>
Using the processing device 911, the prime number determination unit 441 generates the mutually different two prime numbers p and q, based on the size (such as 512 bits or 1024 bits) determined according to the security level.<br/>
Using the processing device 911, the product calculation unit 442 calculates the integer N, based on the two prime numbers p and q generated by the prime number determination unit 441. The integer N is the product of the two prime numbers p and q.<br/>
Using the processing device 911, the common multiple calculation unit 443 calculates the least common multiple λ = LCM (p - 1, q - 1) between p - 1 and q - 1, based on the two prime numbers p and q generated by the prime number determination unit 441.</p><p id="p0210" num="0210">The public key storage unit 403 stores the product N, as the public key pk, using the storage device 914.<br/>
The secret key storage unit 413 stores the least common multiple λ, as the secret key sk, using the storage device 914.</p><p id="p0211" num="0211">Since the inverse number λ<sup>-1</sup> of λ in multiplication of integers modulo N is necessary for decryption, it may be so configured that the common multiple calculation unit 443 calculates the inverse number λ<sup>-1</sup>, and then, the secret key storage unit 413 stores the inverse number λ<sup>-1</sup> as a part of the secret key sk.</p><p id="p0212" num="0212"><figref idrefs="f0029">Fig. 50</figref> is a flow chart diagram showing an example of a flow of<!-- EPO <DP n="151"> --> processes of the key generation step S501 in this embodiment.<br/>
In the key generation step S501, the decryption apparatus 103 generates a set of the public key pk and the secret key sk.<br/>
It may be so configured that a set of the public key pk and the secret key sk that is different for each user is generated, or that a set of one public key pk and one secret key sk is generated for the overall system.<br/>
The key generation step S501 includes a prime number determination step S531, a product calculation step S532, and a common multiple calculation step S533.</p><p id="p0213" num="0213">First, in the prime number determination step S531, the prime number determination unit 441 determines the two prime numbers p and q, using the processing device 911.<br/>
In the product calculation step S532, the product calculation unit 442 calculates the integer N = pq, based on the two prime numbers p and q determined by the prime number determination unit 441 in the prime number determination step S531, using the processing device 911. Using the storage device 914, the public key storage unit 403 stores the integer N calculated by the product calculation unit 442, as the public key pk.<br/>
In the common multiple calculation step S533, using the processing device 911, the common multiple calculation unit 443 calculates the least common multiple λ = LCM (p - 1, q - 1), based on the two prime numbers p and q determined by the prime number determination unit 441 in the prime number determination step S531. Using the storage device 914, the secret key storage unit 413 stores the least common multiple λ calculated by the common multiple calculation unit 443, as the secret key sk.<!-- EPO <DP n="152"> --></p><p id="p0214" num="0214">The public key pk = (N) stored by the public key storage unit 403 in this manner is transmitted to each of the authentication apparatus 102 and the like by the public key transmitting unit 408. Each of the authentication apparatus 102 and the like receives and then stores the public key pk.</p><p id="p0215" num="0215"><figref idrefs="f0029">Fig. 51</figref> is a flow chart diagram showing an example of a flow of processes of the feature vector encryption step S603 in this embodiment.<br/>
In the feature vector encryption step S603, the registration apparatus 104 encrypts the feature vector b to generate the encrnypted feature vector C. The feature vector encryption step S603 includes the initialization step S610, the repetition step S611, the random number generation step S612, and an integer calculation step S613b, for example.<br/>
The feature vector b generated by the feature vector formation unit 204 of the registration apparatus 104 is a T-dimensional vector (b<sub>1</sub>, b<sub>2</sub>, ..., b<sub>T</sub>) (T being an integer not less than 1) having components of integers not less than 0 and less than N. The encrypted feature vector C generated by the encrypted data generation unit 206 is a T-dimensional vector (c<sub>1</sub>, c<sub>2</sub>, ..., c<sub>T</sub>) having components of integers not less than 0 and less than N<sup>2</sup>.</p><p id="p0216" num="0216">First, in the initialization step S610, the encrypted data generation unit 206 initializes the integer i to 0, using the processing device 911.<br/>
In the repetition step 611, the encrypted data generation unit 206 adds 1 to the integer i, using the processing device 911. When the integer i is larger than T, the encrypted data generation unit 206 finishes the feature vector encryption step S603. When the integer i is not more than T, the encrypted data generation unit 206 causes the process to proceed to the random number generation step S612 to generate the ith component c<sub>i</sub> of the<!-- EPO <DP n="153"> --> encrypted feature vector C.<br/>
In the random number generation step S612, using the processing device 911, the random number generation unit 205 generates the random number r<sub>i</sub>, based on the integer N which is the public key pk stored by the public key storage unit 202. The random number r<sub>i</sub> generated by the random number generation unit 205 is the integer uniform randomly selected from among integers not less than 1 and less than N.<br/>
In the integer calculation step S613b, using the processing device 911, the encrypted data generation unit 206 calculates the ith component c<sub>i</sub> of the encrypted feature vector C, based on the integer N which is the public key pk stored by the public key storage unit 202, the ith component b<sub>i</sub> of the feature vector b generated by the feature vector formation unit 204, and the random number r<sub>i</sub> generated by the random number generation unit 205 in the random number generation step S612. The ith component c<sub>i</sub> of the encrypted feature vector C calculated by the encrypted data generation unit 206 is a remainder when a product r<sub>i</sub><sup>N</sup> (1 + b<sub>i</sub>N) of a sum (1 + b<sub>i</sub>N) and an integer r<sub>i</sub><sup>N</sup> is divided by the square of the integer N. The sum (1 + b<sub>i</sub>N) is obtained by adding 1 to a product b<sub>i</sub>N of the ith component bi of the feature vector b and the integer N. The integer r<sub>i</sub><sup>N</sup> is obtained by exponentiating the random number r<sub>i</sub> by the integer N.<br/>
The encrypted data generation unit 206 causes the process to return to the repetition step S611 to generate the subsequent component of the encrypted feature vector C.</p><p id="p0217" num="0217">The encrypted feature vector C generated by the encrypted data generation unit 206 in this manner is transmitted to the authentication<!-- EPO <DP n="154"> --> apparatus 102 by the encrypted data transmitting unit 201. The authentication apparatus 102 receives and then stores the encrypted feature vector C.</p><p id="p0218" num="0218"><figref idrefs="f0030">Fig. 52</figref> is a flow chart diagram showing an example of a flow of processes of the first challenge generation step S701 in this embodiment.<br/>
In the first challenge generation step S701, the authentication apparatus 102 generates the first challenge R. The first challenge generation step S701 includes the initialization step S729, the repetition step S721, the random number generation step S722, and an integer calculation step S723b, for example.<br/>
The first challenge R generated by the encrypted random number generation unit 304 of the authentication apparatus 102 is a T-dimensional vector (R<sub>1</sub>, R<sub>2</sub>, ..., R<sub>T</sub>) having components of integers not less than 0 and less than N<sup>2</sup>.</p><p id="p0219" num="0219">First, in the initialization step S729, using the processing device 911, the encrypted random number generation unit 304 initializes the integer i to 0.<br/>
In the repetition step S721, using the processing device 911, the encrypted random number generation unit 304 adds 1 to the integer i. When the integer i is larger than T, the encrypted random number generation unit 304 finishes the first challenge generation step S701. When the integer i is not more than T, the encrypted random number generation unit 304 causes the process to proceed to the random number generation step S722, thereby generating the ith component R<sub>i</sub> of the first challenge R.<br/>
In the random number generation step S722, using the processing device 911, the random number generation unit 303 generates the two random<!-- EPO <DP n="155"> --> numbers R<sub>1, i</sub> and R<sub>2, i</sub>, based on the integer N which is the public key pk stored by the public key storage unit 302. The random numbers R<sub>1, i</sub> and R<sub>2, i</sub> generated by the random number generation unit 303 are the integers uniform randomly selected from among the integers not less than 1 and less than N. The random number storage unit 322 stores the random number R<sub>1, i</sub> generated by the random number generation unit 303, using the storage device 914.<br/>
In the element calculation step S723a, using the processing device 911, the encrypted random number generation unit 304 calculates the ith component R<sub>i</sub> of the first challenge R, based on the integer N which is the public key pk stored by the public key storage unit 302 and the two random numbers R<sub>1, i</sub> and R<sub>2, i</sub> generated by the random number generation unit 303 in the random number generation step S722. The ith component R<sub>i</sub> of the first challenge R calculated by the encrypted random number generation unit 304 is a remainder when the product of a sum (1 + R<sub>1, i</sub> N) and an integer R<sub>2</sub>, i<sup>N</sup> is divided by the square of the integer N. The sum (1 + R<sub>1,i</sub>N) is obtained by adding 1 to a product R<sub>1, i</sub>N of the random number R<sub>1, i</sub> and the integer N. The integer R<sub>2, i</sub><sup>N</sup> is obtained by exponentiating the random number R<sub>2, i</sub> by the integer N.<br/>
The encrypted random number generation unit 304 causes the process to return to the repetition step S721, thereby generating the subsequent component of the first challenge R.</p><p id="p0220" num="0220">The first challenge R generated by the encrypted random number generation unit 304 in this manner is transmitted to the certification apparatus 101 by the first challenge transmitting unit 311. The certification apparatus 101 receives and then processes the first challenge R.<!-- EPO <DP n="156"> --></p><p id="p0221" num="0221">The number of the random numbers R<sub>1, i</sub> and R<sub>2, i</sub> (i being each integer not less than 1 and not more than T) generated by the random number generation unit 303 in the first challenge generation step S701 is 2T in total. T pieces of random numbers R<sub>1, i</sub> (i being each integer not less than 1 and not more than T) are stored by the random number storage unit 322. The T pieces of random numbers R<sub>1, i</sub> stored by the random number storage unit 322 are random numbers as plaintexts, and the remaining T pieces of random numbers R<sub>2, i</sub> (i being each integer not less than 1 and not more than T) are random numbers for encryption. Each component R<sub>i</sub> of the first challenge R is obtained by encrypting the random number R<sub>1, i</sub> as a plaintext.</p><p id="p0222" num="0222"><figref idrefs="f0030">Fig. 53</figref> is a detailed block diagram showing an example of a configuration of the encrypted data embedding unit 217 in this embodiment.<br/>
The encrypted data embedding unit 217 of the certification apparatus 101 includes the exponentiation calculation unit 234, the zero generation unit 232, and an integer combining unit 236, for example.</p><p id="p0223" num="0223">The feature vector b' generated by the feature vector formation unit 214 of the certification apparatus 101 is a T-dimensional vector (b'<sub>1</sub>, b'<sub>2</sub>, ..., b'<sub>T</sub>) having components of the integers not less than 0 and less than N, like the feature vector b generated by the feature vector formation unit 204 of the registration apparatus 104.<br/>
Using the processing device 911, the random number generation unit 215 generates T pieces of random numbers r'<sub>i</sub> (i being each integer not less than 1 and not more than T), based on the interger N which is the public key pk stored by the public key storage unit 212. The random numbers r'<sub>i</sub> generated by the random number generation unit 215 are integers uniform<!-- EPO <DP n="157"> --> randomly selected from among the integers not less than 1 and less than N.</p><p id="p0224" num="0224">Using the processing device 911, the exponentiation calculation unit 234 calculations the exponentiation vector <img id="ib0187" file="imgb0011.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> based on the first challenge R received by the first challenge receiving unit 211 and the feature vector b' generated by the feature vector formation unit 214. The exponentiation vector <img id="ib0188" file="imgb0001.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the exponentiation calculation unit 234 is a T-dimensional vector (<img id="ib0189" file="imgb0002.tif" wi="7" he="4" img-content="character" img-format="tif" inline="yes"/> <img id="ib0190" file="imgb0003.tif" wi="7" he="4" img-content="character" img-format="tif" inline="yes"/> ..., <img id="ib0191" file="imgb0004.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/>) having components of integers not less than 1 and less than N<sup>2</sup>, like the first challenge R. The ith component <img id="ib0192" file="imgb0005.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/>(i being the integer not less than 1 and not more than T) of the exponentiation vector <img id="ib0193" file="imgb0001.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the exponentiation calculation unit 234 is a remainder when an integer R<sub>i</sub><sup>b'i</sup> obtained by exponentiating the ith component R<sub>i</sub> of the first challenge R by the ith component b'<sub>i</sub> of the feature vector b' is divided by the square of the integer N. Each component <img id="ib0194" file="imgb0005.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> of the exponentiation vector<img id="ib0195" file="imgb0001.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the exponentiation calculation unit 234 is obtained by encrypting the product of the component b'<sub>i</sub> of the feature vector b' and the random number R<sub>1, i</sub> as the plaintext that has been generated by the authentication apparatus 102.<br/>
Using the processing device 911, the zero generation unit 232 generates the encrypted zero vector O based on the integer N which is the public key pk stored by the public key storage unit 202 and the T pieces of random numbers r'<sub>i</sub> generated by the random number generation unit 215. The encrypted zero vector O is a T-dimensional vector (o<sub>1</sub>, o<sub>2</sub>, ..., o<sub>T</sub>) having components of integers not less than 0 and less than N<sup>2</sup>. The ith component o<sub>i</sub> (i being the integer not less than 1 and not more than T) of the encrypted zero vector O is a remainder when an integer r'<sub>i</sub><sup>N</sup> obtained by exponentiating<!-- EPO <DP n="158"> --> the ith random number r'<sub>i</sub> by the integer N is divided by the square of the integer N. Each component o<sub>i</sub> of the encrypted zero vector O is obtained by encrypting 0.<br/>
Using the processing device 911, the integer combining unit 236 calculates the first response R', based on the exponentiation vector<img id="ib0196" file="imgb0001.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the exponentiation calculation unit 234 and the encrypted zero vector O generated by the zero generation unit 232. The first response R' is a T-dimensional vector (R'<sub>1</sub>, R'<sub>2</sub>, ..., R'<sub>T</sub>) having components of integers not less than 0 and less than N<sup>2</sup>. The ith component R'<sub>i</sub> (i being the integer not less than 1 and not more than T) of the first response R' is a remainder when the product of the ith component <img id="ib0197" file="imgb0005.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> of the exponentiation vector <img id="ib0198" file="imgb0001.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> and the ith component o<sub>i</sub> of the encrypted zero vector O is divided by the square of the integer N. Each component R'<sub>i</sub> of the first response R' is obtained by encrypting the product of the random number R<sub>1, i</sub> as the plaintext and the component b'<sub>i</sub> of the feature vector b'. The random number R<sub>1, i</sub> is encrypted in the component R<sub>i</sub> of the first challenge R.</p><p id="p0225" num="0225"><figref idrefs="f0031">Fig. 54</figref> is a flow chart diagram showing an example of a flow of processes of the first response generation step S707 in this embodiment.<br/>
In the first response generation step S707, the certification apparatus 101 generates the first response R', based on the feature vector b' and the first challenge R. The first response generation step S707 includes the initialization step S660, the repetition step S661, the exponentiation calculation step S662a, the random number generation step S663, the zero generation step S664, and an integer combining step S665b.</p><p id="p0226" num="0226">First, in the initialization step S660, the integer combining unit 236<!-- EPO <DP n="159"> --> initializes the integer i to 0, using the processing device 911.<br/>
In the repetition step S661, the integer combining unit 236 adds 1 to the integer i, using the processing device 911. When the integer i is larger than T, the element combining unit 236 finishes the first response generation step S707. When the integer i is not more than T, the integer combining unit 236 causes the process to proceed to the exponentiation calculation step S662a to generate the ith component R'<sub>i</sub> of the first response R'.<br/>
In the exponentiation calculation step S662a, using the processing device 911, the exponentiation calculation unit 234 calculates the ith component <img id="ib0199" file="imgb0005.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> = R<sub>i</sub><sup>b'i</sup> mod N<sup>2</sup> of the exponentiation vector <img id="ib0200" file="imgb0011.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> based on the ith component b'<sub>i</sub> of the feature vector b' generated by the feature vector formation unit 214 and the ith vector R<sub>i</sub> of the first challenge R received by the first challenge receiving unit 211.<br/>
In the random number generation step S663, the random number generation unit 215 generates the random number r'<sub>i</sub>, using the processing device 911.<br/>
In the zero generation step S664, using the processing device 911, the zero generation unit 232 calculates the ith component o<sub>i</sub> = r'i<sup>N</sup> mod N<sup>2</sup> of the encrypted zero vector O, based on the random number r'<sub>i</sub> generated by the random number generation unit 215 in the random number generation step S663.<br/>
In the integer combining step S665b, using the processing device 911, the integer combining unit 236 calculates the ith component R'<sub>i</sub> of the first response R', based on the ith component <img id="ib0201" file="imgb0005.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> of the exponentiation vector<img id="ib0202" file="imgb0001.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the exponentiation calculation unit 234 in the exponentiation<!-- EPO <DP n="160"> --> calculcation step S662a and the ith component o<sub>i</sub> of the encrypted zero vector O calculated by the zero generation unit 232 in the zero generation step S664.<br/>
The integer combining unit 236 causes the process to return to the repetition step S661 to generate the subsequent component of the first response R'.</p><p id="p0227" num="0227">The first response R' generated by the encrypted data embedding unit 217 in this manner is transmitted to the authentication apparatus 102 by the first response transmitting unit 221. The authentication apparatus 102 receives and then processes the first response R'.</p><p id="p0228" num="0228">When the component b'<sub>i</sub> of the feature vector b' takes only one of two values of 0 and 1, the processes of the first response generation step S707 can be simplified, as follows, for example.<br/>
First, there is no need for exponentiation, so that the exponentiation calculation unit 234 is not provided, and the exponentiation calculation step S662a is not executed.<br/>
Using the processing device 911, the integer combining unit 236 determines whether or not the ith component b'<sub>i</sub> of the feature vector b' is 0 or 1, in the integer combining step S665a. When the ith component b'<sub>i</sub> of the feature vector b' is 0, the integer combining unit 236 sets the ith component o<sub>i</sub> = r'<sub>i</sub><sup>N</sup> mod N<sup>2</sup> of the encrypted zero vector O calculated by the zero generation unit 232 in the zero generation step S664 to the ith component R'<sub>i</sub> of the first response R', using the processing device 911. When the ith component b'<sub>i</sub> of the feature vector b' is 1, the element combining unit 235 calculates a remainder when the product of the ith component o<sub>i</sub> of the encrypted zero vector O calculated by the zero generation unit 232 in the zero generation step<!-- EPO <DP n="161"> --> S664 and the ith component R<sub>i</sub> of the first challenge R received by the first challenge receiving unit 211 is divided by the square of the integer N, and sets the remainder to the ith component R'<sub>i</sub> of the first response R', using the processing device 911.</p><p id="p0229" num="0229">The ith component R<sub>i</sub> of the first challenge R is the remainder when the product of the integer (1 + R<sub>1,i</sub>N) and the integer obtained by exponentiating the random number R<sub>2, i</sub><sup>N</sup> by N is divided by N<sup>2</sup>. The integer (1 + R<sub>1,i</sub>N) is obtained by adding 1 to the product of the random number R<sub>1, i</sub> and the integer N. Thus, the ith component R'<sub>i</sub> of the first response R' is a remainder when the product of an integer (1 + b'<sub>i</sub>R<sub>1, i</sub>N) and the Nth power of the product of the b'<sub>i</sub> power of the random number R<sub>2</sub>, and the random number r'<sub>i</sub> is divided by N<sup>2</sup>. The integer (1 + b'<sub>i</sub>R<sub>1, i</sub>N) is obtained by adding 1 to the product of the ith component b'<sub>i</sub> of the feature vector b', the random number R<sub>1, i</sub>, and the integer N. That is, the ith component R'<sub>i</sub> of the first response R' is obtained by encrypting the product of the random number R<sub>1, i</sub> and the ith component b'<sub>i</sub> of the feature vector b'.</p><p id="p0230" num="0230">The encrypted data extraction unit 305 has the same configuration as that explained in the fourth embodiment. Thus, a description will be given, with reference to <figref idrefs="f0021">Fig. 37</figref>.</p><p id="p0231" num="0231">The encrypted data extraction unit 305 of the authentication apparatus 102 includes the inverse number calculation unit 351 and the exponentiation calculation unit 353, for example.</p><p id="p0232" num="0232">The encrypted feature vector C' generated by the encrypted data extraction unit 305 of the authentication apparatus 102 is a T-dimensional vector (c'<sub>i</sub>, c'<sub>2</sub>, ..., c'<sub>T</sub>) having components of elements of integers not less<!-- EPO <DP n="162"> --> than 0 and less than N<sup>2</sup>, like the encrypted feature vector C generated by the encrypted data generation unit 206 of the registration apparatus 104.</p><p id="p0233" num="0233">Using the processing device 911, the inverse number calculation unit 351 calculates the inverse number κ<sub>i</sub> = R<sub>1, i</sub><sup>-1</sup> of each random number R<sub>1, i</sub> by multiplication of integers modulo N, based on the T pieces of random numbers R<sub>1, i</sub> (i being each integer not less than 1 and not more than T) stored by the random number storage unit 322. The inverse number κ<sub>i</sub> is the integer where, when the product of the random number R<sub>1, i</sub> and the inverse number κ<sub>i</sub> is divided by N, the remainder is one. Since N is not the prime number, the random number R<sub>1, i</sub> does not necessarily have the inverse number κ<sub>i</sub>. However, when the two prime numbers p and q that are the prime factors of N are sufficiently large, the probability that the random number R<sub>1, i</sub> is the zero divisor is extremely small and is negligible.<br/>
Using the processing device 911, the exponentiation calculation unit 353 calculates the encrypted feature vector C', based on the first response R' received by the first response receiving unit 331 and the T inverse numbers κ<sub>i</sub> calculated by the inverse number calculation unit 351. The ith component c'<sub>i</sub> (i being the integer not less than 1 and not more than T) of the encrypted feature vector C' calculated by the exponentiation calculation unit 353 is a remainder when an integer obtained by exponentiating the ith component R'<sub>i</sub> of the first response R' by the ith inverse number κ<sub>i</sub> is divided by the square of the integer N. Each component c'<sub>i</sub> of the encrypted feature vector C' is obtained by encrypting the component b'<sub>i</sub> of the feature vector b'.</p><p id="p0234" num="0234"><figref idrefs="f0031">Fig. 55</figref> is a flow chart diagram showing an example of a flow of processes of the encrypted biometric information extraction step S710 in this<!-- EPO <DP n="163"> --> embodiment.<br/>
In the encrypted biometric information extraction step S710, the authentication apparatus 102 generates the encrypted feature vector C', based on the first response R'. The encrypted biometric information extraction unit S710 includes the initialization step S730, the repetition step S731, the inverse number calculation step S732, and the exponentiation calculation step S733a, for example.</p><p id="p0235" num="0235">First, in the initialization step S730, the exponentiation calculation unit 353 initializes the integer i to 0, using the processing device 911.<br/>
In the repetition step S731, the exponentiation calculation unit 353 adds 1 to the integer i, using the processing device 911. When the integer i is larger than T, the exponentiation calculation unit 353 finishes the encrypted biometric information extraction step S710. When the integer i is not more than T, the exponentiation calculation unit 353 causes the process to proceed to the inverse number calculation step S732 to generate the ith component c'<sub>i</sub> of the encrypted feature vector C'.<br/>
In the inverse number calculation step S732, using the processing device 911, the inverse number calculation unit 351 calculates the inverse number κ<sub>i</sub> = R<sub>1, i</sub><sup>-1</sup>, based on the ith random number R<sub>1, i</sub> out of the T pieces of random numbers stored by the random number storage unit 322 in the first challenge generation step S701.<br/>
In the exponentiation calculation step S733a, using the processing device 911, the exponentiation calculation unit 353 calculates the ith component c'<sub>i</sub> = R' <sub>i</sub><sup>Ki</sup>, based on the ith component R'<sub>i</sub> of the first response R' received by the first response receiving unit 331 and the inverse number κ<sub>i</sub><!-- EPO <DP n="164"> --> calculated by the inverse number calculation step S732.<br/>
The exponentiation calculation unit 353 causes the process to return to the repetition step S731 to generate the subsequent component of the encrypted feature vector C'.</p><p id="p0236" num="0236">The encrypted feature vector C' generated by the encrypted data extraction unit 305 in this manner is used in the second challenge generation step S712.</p><p id="p0237" num="0237">The ith component R'<sub>i</sub> of the first response R' is the remainder when the product of the integer (1 + b'<sub>i</sub>R<sub>1,i</sub>N) and the Nth power of R<sub>2, i</sub><sup>b'i</sup>r'<sub>i</sub> is divided by N<sup>2</sup>. The integer (1 + b'R<sub>1,i</sub>N) is obtained by adding 1 to the product of an integer b'<sub>i</sub>R<sub>1, i</sub> and the integer N. Thus, the ith component c'<sub>i</sub> of the encrypted feature vector C' is the product of an integer (1 + κ<sub>i</sub>b'<sub>i</sub>R<sub>1, i</sub>N) and the Nth power of (R<sub>2, i</sub><sup>b'i</sup>r'<sub>i</sub>) <sup>κi</sup>. The integer (1 + κ<sub>i</sub>b'<sub>i</sub>R<sub>1, i</sub>N) is obtained by adding 1 to the product of an integer κ<sub>i</sub>b'<sub>i</sub>R<sub>1, i</sub> and the integer N. Since R<sub>1, i</sub>κ<sub>i</sub> ≡ 1 (mod N), c'<sub>i</sub> is the product of the Nth power of (R<sub>2,</sub> i<sup>b', i</sup> r'<sub>i</sub>)<sup>κi</sup> and an integer (1 + b'<sub>i</sub>N). The integer (1 + b'<sub>i</sub>N) is obtained by adding 1 to the product of an integer b'<sub>i</sub> and the integer N. That is, the ith component c'<sub>i</sub> of the encrypted feature vector C' is obtained by encrypting the ith component b'<sub>i</sub> of the feature vector b'.</p><p id="p0238" num="0238"><figref idrefs="f0032">Fig. 56</figref> is a detailed block diagram showing an example of a configuration of the encrypted random similarity degree calculation unit 314 in this embodiment.<br/>
The second challenge C^ to be generated by the encrypted random similarity degree calculation unit 314 of the authentication apparatus 102 is constituted from (T + 1) integers c^<sub>1</sub>, c^<sub>2</sub>, ..., c^<sub>T</sub>, and c^ which are not less<!-- EPO <DP n="165"> --> than 0 and less than N<sup>2</sup>. The encrypted random similarity degree calculation unit 314 includes the difference calculation unit 361, a rearrangement unit 385, and the encryption key generation unit 366, for example.</p><p id="p0239" num="0239">Using the processing device 911, the random number generation unit 303 generates two random numbers s<sub>1</sub> and s<sub>2</sub>, based on the integer N, which is the public key pk stored by the public key storage unit 302. The random numbers s<sub>1</sub> and s<sub>2</sub> generated by the random number generation unit 303 are integers uniform randomly selected from among the integers not less than 0 and less than N.<br/>
The random number storage unit 322 stores one random number s<sub>1</sub> out of the random numbers generated by the random number generation unit 303, using the storage device 914.</p><p id="p0240" num="0240">Using the processing device 911, the difference calculation unit 361 calculates the encrypted difference vector ΔC, based on the encrypted feature vector C stored by the encrypted data storage unit 312 and the encrypted feature vector C' extracted by the encrypted data extraction unit 305. The encrypted difference vector ΔC is a T-dimensional vector (Δc<sub>1</sub>, Δc<sub>2</sub>, ..., Δc<sub>T</sub>) having components of elements of the integers not less than 0 and less than N<sup>2</sup>. The ith component Δc<sub>i</sub> (i being the integer not less than 1 and not more than T) of the encrypted difference vector ΔC is one of the following two integers randomly selected. The integer which is the first candidate for Δc<sub>i</sub> is a remainder when the product of the ith component c'<sub>i</sub> of the encrypted feature vector C' and an inverse number c<sub>i</sub><sup>-1</sup> of the ith component c<sub>i</sub> of the encrypted feature vector C is divided by N<sup>2</sup> in multiplication of integers modulo N<sup>2</sup>. The integer which is the second candidate for Δc<sub>i</sub> is a remainder when the<!-- EPO <DP n="166"> --> product of the ith component c<sub>i</sub> of the encrypted feature vector C and an inverse number c'<sub>i</sub><sup>-1</sup> of the ith component c'<sub>i</sub> of the encrypted feature vector C' is divided by N<sup>2</sup> in the multiplication of integers modulo N<sup>2</sup>. That is, the first candidate and the second candidate are in a relationship of inverse numbers in the multiplication of integers modulo N<sup>2</sup>. Each component Δc<sub>i</sub> of the encrypted difference vector ΔC is obtained by encrypting a difference (b<sub>i</sub>-b'<sub>i</sub>) whose polarity has been randomly changed. The difference (b<sub>i</sub> - b'<sub>i</sub>) is the one between the component b<sub>i</sub> of the feature vector b and the component b'<sub>i</sub> of the feature vector b'.<br/>
Using the processing device 911, the rearrangement unit 385 generates T integers c^<sub>i</sub> (i being each integer not less than 1 and not more than T), which is a part of the second challenge C^, based on the encrypted difference vector ΔC calculated by the difference calculation unit 361. The integers c^<sub>i</sub> are integers not less than 0 and less than N<sup>2</sup>. The T integers c^<sub>i</sub> are obtained by rearranging the order of T components Δc<sub>i</sub> of the encrypted difference vector ΔC.<br/>
Using the processing device 911, the encryption key generation unit 366 calculates one integer c" which is a part of the second challenge C^, based on the integer N which is the public key pk stored by the public key storage unit 302 and the two random numbers s<sub>1</sub> and s<sub>2</sub> generated by the random number generation unit 303. The integer c^ is an integer not less than 0 and less than N<sup>2</sup>. The integer c^ is a remainder when the product of an integer (1 + s<sub>1</sub>N) and an integer s<sub>2</sub><sup>N</sup> is divided by the square of the integer N. The integer (1 + s<sub>1</sub>N) is obtained by adding 1 to the product of the random number s<sub>1</sub> and the integer N. The integer s<sub>2</sub><sup>N</sup> is obtained by exponentiating the<!-- EPO <DP n="167"> --> random number s<sub>2</sub> by the integer N. The integer c^ is obtained by encrypting the random number s<sub>1</sub> calculated by the random number generation unit 303.</p><p id="p0241" num="0241"><figref idrefs="f0032">Fig. 57</figref> is a flow chart diagram showing an example of a flow of processes of the second challenge generation step S712 in this embodiment.<br/>
In the second challenge generation step S712, the authentication apparatus 102 generates the second challenge C^, based on the two encrypted feature vectors C and C'. The second challenge generation step S712 includes the initialization step S740, the repetition step S741, a random number generation step S757, two difference calculation steps S742a and S742b, a random number generation step S758, a second challenge setting step S759, the random number generation step S749, and the encryption key generation step S752 , for example.</p><p id="p0242" num="0242">First, in the initialization step S740, using the processing device 911, the rearrangement unit 385 initializes the integer i to 0. Using the processing device 911, the rearrangement unit 385 initializes a group S to a group having components of elements of T integers not less than 1 and not more than T.<br/>
In the repetition step S741, using the processing device 911, the rearrangement unit 385 adds 1 to the integer i. When the integer i is larger T, the rearrangement unit 385 finishes the second challenge generation step S712. When the integer is not more than T, the rearrangement unit 385 causes the process to proceed to the random number generation step S757.<br/>
In the random number generation step S757, the random number generation unit 303 generates a random number t<sub>i</sub>, using the processing device 911. The random number t<sub>i</sub> is an integer uniform randomly selected from 0<!-- EPO <DP n="168"> --> or 1.<br/>
When the random number t<sub>i</sub> is 0, the difference calculation unit 361 causes the process to proceed to the difference calculation step S742a.<br/>
When the random number t<sub>i</sub> is 1, the difference calculation unit 361 causes the process to proceed to the difference calculation step S742b.</p><p id="p0243" num="0243">In the difference calculation step S742a, using the processing device 911, the difference calculation unit 361 calculates the inverse number c<sub>i</sub><sup>-1</sup> of the integer c<sub>i</sub> in multiplication of integers modulo N<sup>2</sup>, based on the ith component c<sub>i</sub> of the encrypted feature vector C. Using the processing device 911, the difference calculation unit 361 calculates the remainder when the product of the integer c'<sub>i</sub> and the inverse number c<sub>i</sub><sup>-1</sup> is divided by the square of the integer N, based on the calculated inverse number c<sub>i</sub><sup>-1</sup> and the ith component c'<sub>i</sub> of the encrypted feature vector C' to set the remainder to the component Δc<sub>i</sub> of the encrypted difference vector ΔC. The difference calculation unit 361 causes the process to proceed to the random number generation step S758.<br/>
In the difference calculation step S742b, using the processing device 911, the difference calculation unit 361 calculates the inverse number c'<sub>i</sub><sup>-1</sup> of the integer c'<sub>i</sub> in multiplication of integers modulo N<sup>2</sup>, based on the ith component c'<sub>i</sub> of the encrypted feature vector C'. Using the processing device 911, the difference calculation unit 361 calculates the remainder when the product of the integer c<sub>i</sub> and the inverse number c'<sub>i</sub><sup>-1</sup> is divided by the square of the integer N, based on the calculated inverse number c'<sub>i</sub><sup>-1</sup> and the ith component c<sub>i</sub> of the encrypted feature vector C to set the remainder to the component Δc<sub>i</sub> of the encrypted difference vector ΔC. The difference<!-- EPO <DP n="169"> --> calculation unit 361 causes the process to proceed to the random number generation step S758.<br/>
In the random number generation step S758, using the processing device 911, the random number generation unit 303 generates a random number j<sub>i</sub>. The random number j<sub>i</sub> is an integer uniform randomly selected from among elements of the group S. The rearrangement unit 385 removes the random number j<sub>i</sub> from the elements of the group S.<br/>
In the second challenge setting step S759, using the processing device 911, the rearrangement unit 385 sets the ith component Δc<sub>i</sub> of the encrypted difference vector ΔC to a jth integer c^<sub>ji</sub> of the second challenge C^.<br/>
The rearrangement unit 385 causes the process to return to the repetition step S741.</p><p id="p0244" num="0244">In the random number generation step S749, using the processing device 911, the random number generation unit 303 generates the two random numbers s<sub>1</sub> and s<sub>2</sub>.<br/>
In the encryption key generation step S752, the encryption key generation unit 366 calculates the (T + 1)th integer c^ = s<sub>2</sub><sup>N</sup> (1 + s<sub>1</sub>N) mod N<sup>2</sup> of the second challenge C", based on the two random numbers s<sub>1</sub> and s<sub>2</sub> generated by the random number generation unit 303 in the random number generation step S749.</p><p id="p0245" num="0245">The second challenge C^ calculated by the encrypted random similarity degree calculation unit 314 in this manner is transmitted to the decryption apparatus 103. The decryption apparatus 103 receives and then processes the second challenge C^.</p><p id="p0246" num="0246"><figref idrefs="f0033">Fig. 58</figref> is a detailed block diagram showing an example of a<!-- EPO <DP n="170"> --> configuration of the decryption apparatus 404 in this embodiment.</p><p id="p0247" num="0247">The decryption unit 404 of the decryption apparatus 103 includes an inverse number calculation unit 481, a decrypted integer calculation unit 482, the square calculation unit 473, and an integer combining unit 485, for example.</p><p id="p0248" num="0248">Using the processing device 911, based on the integer N which is the public key pk stored by the public key storage unit 403 and the integer λ which is the secret key sk stored by the secret key storage unit 413, the inverse number calculation unit 481 calculates the inverse number λ<sup>-1</sup> of the integer λ in multiplication of integers modulo N.<br/>
Using the processing device 911, the decrypted integer calculation unit 482 calculates (T + 1) integers z<sub>i</sub> and z' (i being each integer not less than 1 and not more than T), based on the integer λ which is the secret key sk stored by the secret key storage unit 413, the second challenge C^ received by the second challenge receiving unit 402, and the inverse number λ<sup>-1</sup> calculated by the inverse calculation unit 481. The integers z<sub>i</sub> and z' are integers not less than 0 and less than N. The ith integer z<sub>i</sub> (i being the integer not less than 1 and not more than T + 1) is an integer obtained by decrypting the ith integer c^<sub>i</sub> of the second challenge C^. The integer z' is an integer obtained by decrypting the (T + 1)th integer c^ of the second challenge C^. Accordingly, the integer z<sub>i</sub> indicates a difference between the component of the feature vector b and the corresponding component of the feature vector b'. The integer z' is equal to the random number s<sub>1</sub> generated by the random number generation unit 303 of the authentication apparatus 102.<br/>
The first to Tth integers c^<sub>i</sub> of the second challenge C^ are obtained<!-- EPO <DP n="171"> --> by randomly rearranging the sequence of the components of the encrypted difference vector ΔC. Thus, the decryption apparatus 103 cannot know from which components of the feature vectors b and b' the difference between the components of the feature vectors b and b' indicated by the integer z<sub>i</sub> comes from. Further, the polarity of the component Δc<sub>i</sub> of the encrypted difference vector ΔC is randomly changed. Thus, the decryption apparatus 103 cannot know which one of the two feature vectors b and b' has the larger components than the other of the two feature vectors b and b'.<br/>
Using the processing device 911, the square calculation unit 473 calculates square values z'<sub>i</sub> (i being each integer not less than 1 and not more than T), based on the integer N which is the public key pk stored by the public key storage unit 403 and the T integers z<sub>i</sub> calculated by the decrypted integer calculation unit 911. Each square value z'<sub>i</sub> is an integer not less than 0 and less than N. The ith square value z'<sub>i</sub> (i being the integer not less than 1 and not more than T) is a remainder when the square of the ith integer z<sub>i</sub> is divided by the integer N.<br/>
Using the processing device 911, the integer combining unit 485 calculates the second response Z, based on the integer N which is the public key pk stored by the public key storage unit 403, the integer z' calculated by the decrypted integer calculation unit 482, and the T integers z'<sub>i</sub> calculated by the square calculation unit 473. The second response Z is an integer not less than 0 and less than N. The second response Z calculated by the integer combining unit 485 is a remainder obtained by dividing the sum of the T integers z'<sub>i</sub> and the integer z' by the integer N. The second response Z is equal to the sum of the random number s<sub>1</sub> and ∑<sub>i</sub>[(b<sub>i</sub> - b<sub>i</sub>)<sup>2</sup>] of the square of<!-- EPO <DP n="172"> --> the Euclidean distance between the feature vector b and the feature vector b'. That is, the second response Z is obtained by encrypting the square of the Euclidean distance between the feature vector b and the feature vector b' by a random number u<sub>1</sub> as a temporary key.</p><p id="p0249" num="0249"><figref idrefs="f0034">Fig. 59</figref> is a flow chart diagram showing an example of a flow of processes of the second response generation step S716 in this embodiment.<br/>
In the second response generation step S716, the decryption apparatus 103 generates the second response Z from the second challenge C^. The second response generation step S716 includes an inverse number calculation step S561a, a decrypted integer calculation step S566a, the initialization step S560, the repetition step S562, a decrypted integer calculation step S563a, the square calculation step S564, and an integer combining step S565a, for example.</p><p id="p0250" num="0250">First, in the inverse number calculation step S561a, using the processing device 911, the inverse number calculation unit 481 calculates the inverse number λ<sup>-1</sup> of the integer λ which is the secret key sk stored by the secret key storage unit 413. The inverse calculation unit 481 may be configured to calculate the inverse number λ<sup>-1</sup> in advance (e.g., in the setup process S500) using the processing device 911 and then to store the calculated inverse number λ<sup>-1</sup>, using the storage device 914.<br/>
In the decrypted integer calculation step S566a, using the processing device 911, the decrypted integer calculation unit 482 decrypts the last integer c^ of the second challenge C^ received by the second challenge receiving unit 402 to calculate the integer z', based on the inverse number λ<sup>-1</sup> calculated by the inverse number calculation unit 481 in the inverse number calculation step<!-- EPO <DP n="173"> --> S561a. To take an example, the decrypted integer calculation unit 482 calculates a quotient y. The quotient y is obtained by dividing, by N, a remainder when an integer (c^<sup>λ</sup> - 1) is divided by the square of the integer N. The integer (c^<sup>λ</sup> - 1) is obtained by subtracting 1 from an integer obtained by exponentiating the integer c^ by the integer λ. The decrypted integer calculation unit 482 calculates a remainder when a product yλ<sup>-1</sup> of the calculated quotient y and the inverse number λ<sup>-1</sup> is divided by N, and then sets the remainder to the integer z'.<br/>
In the initialization step S560, using the processing device 911, the integer combining unit 485 initializes the integer i to 0. The integer combining unit 485 initializes the second response Z to the integer z' calculated by the decrypted integer calculation unit 482 in the decrypted integer calculation step S566a.<br/>
In the repetition step S562, using the processing device 911, the integer combining unit 485 adds 1 to the integer i. When the integer i is larger than T, the second response Z has been completed. Thus, the integer combining unit 485 finishes the second response generation step S716. When the integer i is not more than T, the integer combining unit 485 causes the process to proceed to the decrypted integer calculation step S563a.<br/>
In the decrypted integer calculation step S563a, using the processing device 911, the decrypted integer calculation unit 482 decrypts the ith component c^<sub>i</sub> of the second challenge C^ received by the second challenge receiving unit 402 to calculate the ith integer z<sub>i</sub>, based on the inverse number λ<sup>-1</sup> calculated by the inverse number calculation unit 481 in the inverse number calculation step S561a. To take an example, the decrypted integer<!-- EPO <DP n="174"> --> calculation unit 482 calculates a quotient y<sub>i</sub>. The quotient y<sub>i</sub> is obtained by dividing an integer (c^<sub>i</sub><sup>λ</sup> - 1) by the square of the integer N. The integer (c^i<sup>λ</sup> - 1) is obtained by subtracting 1 from an integer resulting from exponentiation of the integer c^<sub>i</sub>; by the integer λ. The decrypted integer calculation unit 482 calculates a remainder when a product y<sub>i</sub>λ<sup>-1</sup> of the calculated integer y<sub>i</sub> and the inverse number λ<sup>-1</sup> is divided by N, and then sets the remainder to the integer z<sub>i</sub>.<br/>
In the square calculation step S564, using the processing device 911, the square calculation unit 473 calculates the ith square value z'<sub>i</sub>, based on the ith integer z<sub>i</sub> calculated by the decrypted integer calculation unit 482 in the decrypted integer calculation step S563a.<br/>
In the integer combining step S565a, using the processing device 911, the integer combining unit 485 combines the ith square value z'<sub>i</sub> calculated by the square calculation unit 473 in the square calculation step S564 with the second response Z, by addition of integers modulo the integer N.<br/>
The integer combining unit 485 causes the process to return to the repetition step S562 to process the subsequent integer of the second challenge C^.</p><p id="p0251" num="0251">The second response Z generated by the decryption unit 404 in this manner is transmitted to the authentication apparatus 102 by the second response transmitting unit 412. The authentication apparatus 102 receives and then processes the second response Z.</p><p id="p0252" num="0252"><figref idrefs="f0034">Fig. 60</figref> is a flow chart diagram showing an example of a flow of processes of the plaintext similarity degree calculation step S719 in this embodiment.<br/>
<!-- EPO <DP n="175"> -->In the plaintext similarity degree calculation step S719, the authentication apparatus 102 calculates the similarity degree d from the second response Z. The plaintext similarity degree calculation step S719 includes an integer combining step S692a, for example.</p><p id="p0253" num="0253">In the integer combining step S692a, using the processing device 911, the plaintext similarity degree extraction unit 315 of the authentication apparatus 102 calculates the similarity degree d, based on the random number s<sub>1</sub> stored by the random number storage unit 322 and the second response Z received by the second response receiving unit 341. The similarity degree d is an integer not less than 0 and less than N. The similarity degree d calculated by the plaintext similarity degree extraction unit 315 is a remainder when a difference obtained by subtracting the random number s<sub>1</sub> from the second response Z is divided by N.</p><p id="p0254" num="0254">Based on the similarity degree d calculated by the plaintext similarity degree extraction unit 315, the determination unit 306 determines whether or not the two feature vectors b and b' are similar, thereby determining whether or not a person having biometric information represented by the feature vector b and a person having biometric information represented by the feature vector b' are identical. When the similarity degree d is smaller than the threshold value do, the determination unit 306 determines that the two feature vectors b and b' are similar.</p><p id="p0255" num="0255"><figref idrefs="f0035">Fig. 61</figref> is a flow chart diagram showing a similarity degree calculation procedure in the biometric authentication system 100 in this embodiment.<br/>
As a first stage, in the second challenge generation step S712, the<!-- EPO <DP n="176"> --> authentication apparatus 102 calculates the second challenge C^ from the two encrypted feature vectors C and C', thereby calculating T pieces of δ<sub>j</sub> = ± (b<sub>i</sub>-b'<sub>i</sub>) (each of i and j being each integer not less than 1 and not more than T) and one δ* = s<sub>1</sub>. This calculation is performed with the encrypted feature vectors C and C' kept encrypted with the key of the decryption apparatus 103. Thus, the authentication apparatus 102 cannot obtain information on the feature vectors b and b'. Further, the polarity of each δ<sub>j</sub> is randomly changed, and the sequence of the T pieces of δ<sub>i</sub> is also randomly rearranged in order to prevent leakage of the information on the feature vectors b and b' to the decryption apparatus 103.<br/>
As a second stage, in the second response generation step S716, the decryption apparatus 103 calculates the second response Z from the second challenge C^, thereby calculating ξ = ∑i[δ<sub>i</sub><sup>2</sup>] + δ* (i being each integer not less than 1 and not more than T). The first term ∑i[δ<sub>i</sub><sup>2</sup>] represents the similarity degree d and the second term δ* represents encryption. That is, the decryption apparatus 103 calculates the similarity degree d, and then encrypts the similarity degree d using δ* = s<sub>1</sub>. This calculation is performed the second challenge C^ decrypted with the secret key of the decryption apparatus 103. However, due to randomization in the first stage, the decryption apparatus 103 cannot obtain the information on the feature vectors b and b'.<br/>
As a third stage, in the plaintext similarity degree calculation step S719, the authentication apparatus 102 calculates from the second response Z the similarity degree d = ξ - s<sub>1</sub>. With this arrangement, the authentication apparatus 102 can obtain the similarity degree d, but cannot obtain the information on the feature vectors b and b'.<!-- EPO <DP n="177"> --></p><p id="p0256" num="0256">The encryption system is not limited to the Paillier encryption system. It may be so configured that a different additive-homomorphic encryption system such as the Okamoto-Takashima encryption system, the BGN encryption system, or the Gentry encryption system is employed. It may be so configured that a second encryption system such as the standard public key encryption system is employed for communication between the certification apparatus 101 and the authentication apparatus 102.</p><p id="p0257" num="0257">As in the second embodiment, the biometric authentication system 100 may be so configured that the certification apparatus 101 combines functions of the decryption apparatus 103 and the registration apparatus 104.</p><heading id="h0018">Seventh Embodiment.</heading><p id="p0258" num="0258">A seventh embodiment will be described, using <figref idrefs="f0035 f0036 f0037 f0038 f0039">Figs. 62 to 68</figref>.<br/>
Same reference signs are given to components that are common to those in the first to sixth embodiments, thereby omitting description of the components that are common to those in the first to sixth embodiments.</p><p id="p0259" num="0259">In this embodiment, a description will be directed to a configuration in which information on comparison data b that derives from the encrypted feature vector C is embedded into the first challenge R to cause the certification apparatus 101 to perform calculation in the first stage of similarity degree calculation.<br/>
In this embodiment, a description will be directed to a case where the Paillier encryption system described in the sixth embodiment is employed, and the inner product ∑<sub>i</sub>[b<sub>i</sub>b'<sub>i</sub>] is calculated as the similarity degree d, as in the third embodiment.</p><p id="p0260" num="0260"><figref idrefs="f0035">Fig. 62</figref> is a detailed block diagram showing an example of a<!-- EPO <DP n="178"> --> configuration of the encrypted random number generation unit 304 in this embodiment.<br/>
The encrypted random number generation unit 304 of the authentication apparatus 102 includes an exponentiation calculation unit 334, a zero generation unit 332, and an integer combining unit 336, for example.</p><p id="p0261" num="0261">Using the processing device 911, the random number generation unit 303 generates 2T pieces of random numbers R<sub>1, i</sub> and R<sub>2, i</sub> (i being each integer not less than 1 and not more than T), based on the integer N which is the public key pk stored by the public key storage unit 302. The random numbers R<sub>1, i</sub> and R<sub>2</sub>, generated by the random number generation unit 303 are integers uniform randomly selected from among integers not less than 0 and less than N. Using the storage device 914, the random number storage unit 322 stores T pieces of random numbers R<sub>1, i</sub> (i being each integer not less than 1 and not more than T) out of the random numbers generated by the random number generation unit 303.</p><p id="p0262" num="0262">Using the processing device 911, the exponentiation calculation unit 334 calculations an exponentiation vector <img id="ib0203" file="imgb0203.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/> based on the encrypted feature vector C stored by the encrypted data storage unit 312 and the T pieces of random numbers R<sub>1, i</sub> generated by the random number generation unit 303. The exponentiation vector <img id="ib0204" file="imgb0204.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the exponentiation calculation unit 334 is a T-dimensional vector (<img id="ib0205" file="imgb0205.tif" wi="7" he="5" img-content="character" img-format="tif" inline="yes"/> <img id="ib0206" file="imgb0206.tif" wi="8" he="5" img-content="character" img-format="tif" inline="yes"/> ..., <img id="ib0207" file="imgb0207.tif" wi="8" he="5" img-content="character" img-format="tif" inline="yes"/>) having components of integers not less than 0 and less than N<sup>2</sup>. The ith component <img id="ib0208" file="imgb0208.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> (i being the integer not less than 1 and not more than T) of the exponentiation vector <img id="ib0209" file="imgb0204.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the exponentiation calculation unit 334 is a remainder when an integer obtained by exponentiating the ith component c<sub>i</sub> of the encrypted feature<!-- EPO <DP n="179"> --> vector C by the ith random number R<sub>1,i</sub>' is divided by the square of the integer N. Each component <img id="ib0210" file="imgb0208.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> of the exponentiation vector <img id="ib0211" file="imgb0204.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the exponentiation calculation unit 334 is obtained by encrypting the product of the component b<sub>i</sub> of the feature vector b and the random number R<sub>1, i</sub> as a plaintext.<br/>
Using the processing device 911, the zero generation unit 332 generates an encrypted zero vector O' using the integer N which is the public key pk stored by the public key storage unit 302 and T pieces of random numbers R<sub>2,i</sub> generated by the random number generation unit 303. The encrypted zero vector O' is a T-dimensional vector (o'<sub>1</sub>, o'<sub>2</sub>, ..., o'<sub>T</sub>) having components of integers not less than 0 and less than N<sup>2</sup>. The ith component o'<sub>i</sub> (i being the integer not less than 1 and not more than T) of the encrypted zero vector O' is a remainder when an integer R<sub>2,i</sub><sup>N</sup> obtained by exponentiating the ith random number R<sub>2,i</sub> by the integer N is divided by the square of the integer N. Each component o'<sub>i</sub> of the encrypted zero vector O' is obtained by encrypting 0.<br/>
Using the processing device 911, the integer combining unit 336 calculates the first challenge R, based on the exponentiation vector<img id="ib0212" file="imgb0204.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the exponentiation calculation unit 334 and the encrypted zero vector O' generated by the zero generation unit 232. The first challenge R is a T-dimensional vector (R<sub>1</sub>, R<sub>2</sub>, ..., R<sub>T</sub>) having components of the integers not less than 0 and less than N<sup>2</sup>. The ith component R<sub>i</sub> (i being the integer not less than 1 and not more than T) of the first challenge R is a remainder when the product of the ith component <img id="ib0213" file="imgb0208.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> of the exponentiation vector <img id="ib0214" file="imgb0204.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> and the ith component o'<sub>i</sub> of the encrypted zero vector O' is divided by the square of<!-- EPO <DP n="180"> --> the integer N. Each component R<sub>i</sub> of the first challenge R is obtained by encrypting the product of the random number R<sub>1, i</sub> as the plaintext and the component b<sub>i</sub> of the feature vector b.</p><p id="p0263" num="0263"><figref idrefs="f0036">Fig. 63</figref> is a flow chart diagram showing an example of a flow of processes of the first challenge generation step S701 in this embodiment.<br/>
In the first challenge generation step S701, the authentication apparatus 102 generates the first challenge R, based on the encrypted feature vector C. The first challenge generation step S701 includes the initialization step S729, the repetition step S721, the random number generation step S722, an exponentiation calculation step S724, a zero generation step S725, and an integer combining step S726, for example.</p><p id="p0264" num="0264">First, in the initialization step S729, using the processing device 911, the integer combining unit 336 initializes the integer i to 0.<br/>
In the repetition step S721, using the processing device 911, the integer combining unit 336 adds 1 to the integer i. When the integer i is larger than T, the integer combining unit 336 finishes the first challenge generation step S701. When the integer i is not more than T, the integer combining unit 336 causes the process to proceed to the random number generation step S722, thereby generating the ith component R<sub>i</sub> of the first challenge R.<br/>
In the random number generation step S722, using the processing device 911, the random number generation unit 303 generates two random numbers R<sub>1, i</sub> and R<sub>2, i</sub>. The random number storage unit 322 stores the random number R<sub>1, i</sub> generated by the random number generation unit 303, using the storage device 914.<br/>
<!-- EPO <DP n="181"> -->In the exponentiation calculation step S724, using the processing device 911, the exponentiation calculation unit 334 calculates the ith component <img id="ib0215" file="imgb0208.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> of the exponentiation vector <img id="ib0216" file="imgb0203.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/> based on the ith component c<sub>i</sub> of the encrypted feature vector C stored by the encrypted data storage unit 312 and the random number R<sub>1, i</sub> generated by the random number generation unit 303 in the random number generation step S722.<br/>
In the zero generation step S725, using the processing device 911, the zero generation unit 332 calculates the ith component o'<sub>i</sub> of the encrypted zero vector O', based on the random number R<sub>2</sub>, generated by the random number generation unit 303 in the random number generation step S722.<br/>
In the integer combining step S726, the integer combining unit 336 calculates the ith component R<sub>i</sub> of the first challenge R, based on the ith component <img id="ib0217" file="imgb0208.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> of the exponentiation vector <img id="ib0218" file="imgb0204.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the exponentiation calculation unit 334 in the exponentiation calculation step S724a and the ith component o'<sub>i</sub> of the encrypted zero vector O' calculated by the zero generation unit 332 in the zero generation step S725.<br/>
The integer combining unit 336 causes the process to return to the repetition step S721 to generate the subsequent component of the first challenge R.</p><p id="p0265" num="0265">The first challenge R generated by the encrypted random number generation unit 304 in this manner is transmitted to the certification apparatus 101 by the first challenge transmitting unit 311. The certification apparatus receives and then processes the first challenge R.</p><p id="p0266" num="0266">Though the encrypted data embedding unit 217 of the certification apparatus 101 has the same configuration as that in the sixth embodiment, the<!-- EPO <DP n="182"> --> first challenge R has a different meaning. Thus, the first response R' to be generated by the encrypted data embedding unit 217 also has a meaning different from that in the sixth embodiment.<br/>
That is, the ith component R'<sub>i</sub> (i being the integer not less than 1 and not more than T) of the first response R' is obtained by encrypting the product of the ith component b<sub>i</sub> of the feature vector b, an ith component b'<sub>i</sub> of a feature vector b', and the random number R<sub>1, i</sub>.</p><p id="p0267" num="0267">The encrypted data extraction unit 305 of the authentication apparatus 102 also has the same configuration as that in the sixth embodiment.<br/>
The ith component c'i (i being the integer not less than 1 and not more than T) of the encrypted feature vector C' generated by the encrypted data extraction unit 305 is obtained by encrypting a product b<sub>i</sub>b'<sub>i</sub> of the ith components b<sub>i</sub> and b'<sub>i</sub> of the two feature vectors b and b' rather than the ith component b'<sub>i</sub> of the feature vector b'.</p><p id="p0268" num="0268"><figref idrefs="f0037">Fig. 64</figref> is a detailed block diagram showing an example of a configuration of the encrypted random similarity calculation unit 314 in this embodiment.<br/>
The second challenge C^ to be generated by the encrypted random similarity degree calculation unit 314 of the authentication apparatus 102 is constituted from (T + 1) integers c^<sub>1</sub>, c^<sub>2</sub>, ..., c^<sub>T</sub>, and c^ which are not less than 0 and less than N<sup>2</sup>. The encrypted random similarity degree calculation unit 314 includes the rearrangement unit 385, and the encryption key generation unit 366, for example.</p><p id="p0269" num="0269">Using the processing device 911, the random number generation unit 303 generates two random numbers s<sub>1</sub> and s<sub>2</sub>, based on the integer N which is<!-- EPO <DP n="183"> --> the public key pk stored by the public key storage unit 302. The random numbers s<sub>1</sub> and s<sub>2</sub> generated by the random number generation unit 303 are integers uniform randomly selected from among the integers not less than 0 and less than N.<br/>
The random number storage unit 322 stores one random number s<sub>1</sub> out of the random numbers generated by the random number generation unit 303, using the storage device 914.</p><p id="p0270" num="0270">Using the processing device 911, the rearrangement unit 385 generates T integers c^<sub>i</sub> (i being each integer not less than 1 and not more than T), which is a part of the second challenge C^, based on the encrypted feature vector C' generated by the encrypted data extraction unit 305. The integers c^<sub>i</sub> are integers not less than 0 and less than N<sup>2</sup>. The T integers c^<sub>i</sub> are obtained by rearranging the sequence of T components Δc<sub>i</sub> of the encrypted feature vector C'.<br/>
Using the processing device 911, the encryption key generation unit 366 calculates one integer c^ which is a part of the second challenge C^, based on the integer N which is the public key pk stored by the public key storage unit 302 and the two random numbers s<sub>1</sub> and s<sub>2</sub> generated by the random number generation unit 303. The integer c^ is an integer not less than 0 and less than N<sup>2</sup> The integer c^ is a remainder when the product of the integer (1 + s<sub>1</sub>N) and the integer s<sub>2</sub><sup>N</sup> is divided by the square of the integer N. The integer (1 + s<sub>1</sub>N) is obtained by adding 1 to the product of the random number s<sub>1</sub> and the integer N. The integer s<sub>2</sub><sup>N</sup> is obtained by exponentiating the random number s<sub>2</sub> by the integer N. The integer c^ is obtained by encrypting the random number s<sub>1</sub> calculated by the random number generation unit 303.<!-- EPO <DP n="184"> --></p><p id="p0271" num="0271"><figref idrefs="f0037">Fig. 65</figref> is a flow chart diagram showing an example of a flow of processes of the second challenge generation step S712 in this embodiment.<br/>
Though the flow of processes of the second challenge generation step S712 is almost the same as that in the sixth embodiment, there are just two differences between the process flows of the second challenge generation step S712 in this embodiment and the sixth embodiment.<br/>
The first difference is that, there are no random number generation step S757 and no two difference calculation steps S742a and S742b, and the procedure is made to proceed to the random number generation step S758 when the integer i is not more than T in the repetition step S741.<br/>
The second difference is the process in the second challenge setting step S759. In the second challenge setting step S759, using the processing device 911, the rearrangement unit 385 sets the ith component Δc<sub>i</sub> of the encrypted feature vector C' to the j<sub>i</sub>th integer c^<sub>ji</sub> of the second challenge C^.</p><p id="p0272" num="0272"><figref idrefs="f0038">Fig. 66</figref> is a detailed block diagram showing an example of a configuration of the decryption unit 404 in this embodiment.<br/>
The decryption unit 404 of the decryption apparatus 103 includes the inverse number calculation unit 481, the decrypted integer calculation unit 482, and the integer combining unit 485, for example.</p><p id="p0273" num="0273">Using the processing device 911, the inverse number calculation unit 481 calculates the inverse number λ<sup>-1</sup> of the integer λ in multiplication of integers modulo N, based on the integer N which is the public key pk stored by the public key storage unit 403 and the integer λ which is the secret key sk stored by the secret key storage unit 413.<br/>
Using the processing device 911, the decrypted integer calculation<!-- EPO <DP n="185"> --> unit 482 calculates (T + 1) integers z<sub>i</sub> and z' (i being each integer not less than 1 and not more than T), based on the integer λ which is the secret key sk stored by the secret key storage unit 413, the second challenge C^ received by the second challenge receiving unit 402, and the inverse number λ<sup>-1</sup> calcaulted by the inverse calculation unit 481. The integers z<sub>i</sub> and z' are integers not less than 0 and less than N. The ith integer z<sub>i</sub> (i being the integer not less than 1 and not more than T + 1) is an integer obtained by decrypting the ith integer c^<sub>i</sub> of the second challenge C^. The integer z' is an integer obtained by decrypting the (T + 1)th integer c^ of the second challenge C^. Accordingly, the integer z<sub>i</sub> indicates the product of the component of the feature vector b and the corresponding component of the feature vector b'. The integer z' is equal to the random number s<sub>1</sub> generated by the random number generation unit 303 of the authentication apparatus 102.<br/>
Using the processing device 911, the integer combining unit 485 calculates the second response Z, based on the integer N which is the public key pk stored by the public key storage unit 403, the (T + 1) integers z<sub>i</sub> and z' calculated by the decrypted integer calculation unit 482. The second response Z is an integer not less than 0 and less than N. The second response Z calculated by the integer combining unit 485 is a remainder when the sum of the T integers z'<sub>i</sub> and the integer z' is divided by the integer N. The second response Z is equal to the sum of the random number s<sub>1</sub> and the inner product ∑<sub>i</sub>[b<sub>i</sub>b'<sub>i</sub>] between the feature vector b and the feature vector b'. That is, the second response Z is obtained by encrypting the inner product of the feature vector b and the feature vector b' by the random number s<sub>1</sub> as a temporary key.</p><p id="p0274" num="0274"><figref idrefs="f0038">Fig. 67</figref> is a flow chart diagram showing an example of a flow of<!-- EPO <DP n="186"> --> processes of the second response generation step S716 in this embodiment.<br/>
Though the flow of processes of the second response generation step S716 is almost the same as that in the sixth embodiment, there are just two differences between the process flows of the second response generation step S716 in the seventh embodiment and the sixth embodiment.<br/>
The first difference is that there is no square calculation step S564, and the procedure is made to proceed to the integer combining step S565a subsequently to the decrypted integer calculation step S563a.<br/>
The second difference is the processing in the integer combining step S565a. In the integer combining step S565a, using the processing device 911, the integer combining unit 485 combines the ith integer z<sub>i</sub> calculated by the decrypted integer calculation unit 482 in the decrypted integer calculation step S563a with the second response Z, by addition modulo the integer N.</p><p id="p0275" num="0275">The second response Z generated by the decryption unit 404 in this manner is transmitted to the authentication apparatus 102 by the second response transmitting unit 412. The authentication apparatus 102 receives and then processes the second response Z.</p><p id="p0276" num="0276">The plaintext similarity degree extraction unit 315 of the authentication apparatus 102 has the same configuration as that in the sixth embodiment.<br/>
The plaintext similarity degree extraction unit 315 calculates the inner product ∑<sub>i</sub>[b<sub>i</sub>b'<sub>i</sub>] between the two feature vectors b and b', as the similarity degree d.</p><p id="p0277" num="0277">The determination unit 306 determines that the two feature vectors b and b' are similar when the similarity degree d calculated by the discrete<!-- EPO <DP n="187"> --> logarithm calculation unit 373 is larger than the predetermined threshold value do.<br/>
With this arrangement, it can be determined whether the two feature vectors b and b' are similar, using the number of matches between feature points as a reference.</p><p id="p0278" num="0278"><figref idrefs="f0039">Fig. 68</figref> is a flow chart diagram showing a similarity degree calculation procedure in the biometric authentication system 100 in this embodiment.<br/>
Assume that ρ<sub>i</sub> indicates information encrypted in the first response R'.<br/>
A first stage is the first response generation step S707 rather than the second challenge generation step S712. In the first response generation step S707, the certification apparatus 101 calculates the first response R' from the first challenge R, thereby calculating Tρ<sub>i</sub> = b<sub>i</sub>b'<sub>i</sub>. This calculation is performed with the feature vectors b and b' kept encrypted with the key of the decryption apparatus 103. Thus, the certification apparatus 101 cannot obtain information on the feature vector b.<br/>
As a second stage, in the second challenge generation step S712, the authentication apparatus 102 calculates the second challenge C^ from the encrypted feature vector C', thereby calculating T pieces of δ<sub>j</sub> (j being each integer not less than 1 and not more than T), and one δ* = s<sub>1</sub>. Since δ<sub>j</sub> are obtained by rearranging the order of the ρ<sub>i</sub> so as to prevent leakage of the information on the feature vector b and information on the feature vector b' to the decryption apparatus 103. Thus, the decryption apparatus 103 cannot obtain the information on the feature vector b and the information on the<!-- EPO <DP n="188"> --> feature vector b'.<br/>
As a third stage, in the second response generation step S716, the decryption apparatus 103 calculates the second response Z from the challenge C^, thereby calculating ξ = ∑<sub>i</sub>[δ<sub>i</sub>] + δ* (i being each integer not less than 1 and not more than T). The first term ∑<sub>i</sub>[b<sub>i</sub>] indicates the similarity degree d, while the second term δ* indicates encryption. That is, the decryption apparatus 103 calculates the similarity degree d, and then encrypts the similarity degree, using δ* = s<sub>1</sub>. This calculation is performed with the second challenge C^ decrypted with the secret key of the decryption apparatus 103. However, due to randomization in the second stage, the certification apparatus 101 cannot obtain the information on the feature vector b and the information on the feature vector b'.<br/>
As a fourth stage, the authentication apparatus 102 calculates the similarity degree d = ξ - s<sub>1</sub> in the plaintext similarity degree calculation step S719. With this arrangement, the authentication apparatus 102 can obtain the similarity degree d, but cannot obtain the information on the feature vector b and the information on the feature vector b'.</p><p id="p0279" num="0279">The encryption system is not limited to the Paillier encryption system. It may be so configured that a different additive-homomorphic encryption system such as the Okamoto-Takashima encryption system, the BGN encryption system, or the Gentry encryption system is employed. It may be so configured that a second encryption system such as the standard public key encryption system is employed for communication between the certification apparatus 101 and the authentication apparatus 102.</p><p id="p0280" num="0280">The biometric authentication system 100 may be so configured that<!-- EPO <DP n="189"> --> the certification apparatus 101 combines functions of the decryption apparatus 103 and the registration apparatus 104, as in the second embodiment.</p><p id="p0281" num="0281">When each component value of the feature vectors b and b' is one of 0 and 1, the product b<sub>i</sub>b'<sub>i</sub> of the components of the two feature vectors b and b' takes one of the values 0 and 1. Thus, the decryption apparatus 103 may have the same configuration as that described in the sixth embodiment. With that arrangement, the certification apparatus 101, the decryption apparatus 103, and the registration apparatus 104 have the same configurations as those in the sixth embodiment, and only the authentication apparatus 102 has a different configuration from that in the sixth embodiment. Accordingly, by setting the authentication apparatus 102 to a configuration capable of switching between the configuration described in the sixth embodiment and the configuration described in this embodiment, two types of similarity degrees using the Euclidean distance and the inner product may be calculated without altering the other apparatuses in the biometric authentication system 100.</p><heading id="h0019">Eighth Embodiment.</heading><p id="p0282" num="0282">An eighth embodiment will be described, using <figref idrefs="f0039 f0040 f0041">Figs. 69 to 72</figref>.<br/>
Same reference signs are given to components that are common to those in the first to seventh embodiments, thereby omitting description of the components that are common to those in the first to seventh embodiments.</p><p id="p0283" num="0283">In this embodiment, the description will be directed to a variation example of the configuration described in the seventh embodiment.</p><p id="p0284" num="0284">The encrypted feature vector C' is a T-dimensional vector (c'<sub>1</sub>, c'<sub>2</sub>, ..., c'<sub>T</sub>) having components of integers not less than 0 and less than N<sup>2</sup>. The ith<!-- EPO <DP n="190"> --> component c<sub>i</sub> (i being an integer not less than 1 and not more than T) of the encrypted feature vector C' is obtained by encrypting the product b<sub>i</sub>b'<sub>i</sub> of the ith component b<sub>i</sub> of the feature vector b and the ith component b'<sub>i</sub> of the feature vector b'.</p><p id="p0285" num="0285"><figref idrefs="f0039">Fig. 69</figref> is a detailed block diagram showing an example of a configuration of the encrypted random similarity calculation unit 314 in this embodiment.<br/>
The encrypted random similarity degree calculation unit 314 of the authentication apparatus 102 includes the disturbance vector generation unit 362 and an integer combining unit 386, for example.</p><p id="p0286" num="0286">Using the processing device 911, the random number generation unit 303 generates 2T pieces of random numbers t<sub>1, i</sub> and t<sub>2, i</sub> (i being each integer not less than 1 and not more than T). The random numbers t<sub>1, i</sub> and t<sub>2, i</sub> are integers uniform randomly selected from among the integers not less than 0 and less than N. The random number storage unit 322 stores a summation value s<sub>1</sub> = ∑<sub>i</sub>[t<sub>1, i</sub>] of the T pieces of random numbers t<sub>1, i</sub> generated by the random number generation unit 303, using the storage device 914. The random number storage unit 322 may be configured to store the T pieces of random numbers t<sub>1, i</sub> generated by the random number generation unit 303 without alteration. However, only the summation value is needed in a later stage. Thus, the configuration of storing the summation value needs a smaller storage amount than the configuration of storing the T pieces of random numbers t<sub>1, i</sub> without alteration.</p><p id="p0287" num="0287">Using the processing device 911, the disturbance vector generation unit 362 generates the disturbance vector T, based on the integer N which is<!-- EPO <DP n="191"> --> the public key pk stored by the public key storage unit 302 and the 2T pieces of random numbers t<sub>1, i</sub> and t<sub>2, i</sub> generated by the random number generation unit 303. The disturbance vector T is a T-dimensional vector (t<sub>1</sub>, t<sub>2</sub>, ..., t<sub>T</sub>) having components of integers not less than 0 and less than N<sup>2</sup>. The ith component t<sub>i</sub> (i being the integer not less than 1 and not more than T) of the disturbance vector T is a remainder when the product of a sum (1 + t<sub>1, i</sub>N) and an integer t<sub>2, i</sub><sup>N</sup> is divided by the square of the integer N. The sum (1 + t<sub>1, i</sub>N) is obtained by adding 1 to the product of the random number t<sub>1, i</sub> and the integer N. The integer t<sub>2, i</sub><sup>N</sup> is obtained by exponentiating the random number t<sub>2, i</sub> by the integer N. Each component t<sub>i</sub> of the disturbance vector T is obtained by encrypting the random number t<sub>1, j</sub>.<br/>
Using the processing device 911, the integer combining unit 386 generates the second challenge C^, based on the integer N which is the public key pk stored by the public key storage unit 403, the encrypted feature vector C' generated by the encrypted data extraction unit 305, and the disturbance vector T calculated by the disturbance vector generation unit 362. The second challenge C^ is constituted from T integers of c^<sub>1</sub>, c^<sub>2</sub>, ..., c^<sub>T</sub>. The T integers c^<sub>i</sub> are integers not less than 0 and less than N<sup>2</sup>. The ith integer c^<sub>i</sub> (i being the integer not less than 1 and not more than T) of the second challenge C^ is a remainder when the product of the ith component c'<sub>i</sub> of the encrypted feature vector C' and ith component t<sub>i</sub> of the disturbance vector T is divided by the square of the integer N. Each integer c^<sub>i</sub> of the second challenge C^ is obtained by encrypting a sum b<sub>i</sub>b'<sub>i</sub> + t<sub>1, i</sub> of b<sub>i</sub>b'<sub>i</sub> encrypted by the component of the encrypted feature vector C' and the random number t<sub>1, i</sub>.<br/>
The sequence of the T integers c^<sub>i</sub> of the second challenge C^ may be<!-- EPO <DP n="192"> --> different from the sequence of the components of the feature vectors b and b'.</p><p id="p0288" num="0288"><figref idrefs="f0040">Fig. 70</figref> is a flow chart diagram showing an example of a flow of processes of the second challenge generation step S712 in this embodiment.<br/>
In the second challenge generation step S712, the authentication apparatus 102 generates the second challenge C^, based on the encrypted feature vector C'. The second challenge generation step S712 includes the initialization step S740, the repetition step S741, the random number generation step S743, the disturbance vector generation step S744, and an integer combining step S760, for example.</p><p id="p0289" num="0289">First, in the initialization step S740, using the processing device 911, the integer combining unit 386 initializes the integer i to 0. Using the processing device 911, the random number storage unit 322 initializes the integer s<sub>1</sub> to 0. Then, the random number storage unit 322 stores the initialized integer s<sub>1</sub>, using the storage device 914.<br/>
In the repetition step S741, using the processing device 911, the integer combining unit 386 adds 1 to the integer i. When the integer i is larger than T, the integer combining unit 386 finishes the second challenge generation step S712. When the integer is not more than T, the integer combining unit 386 causes the procedure to proceed to the random number generation step S743 to generate the ith integer c^<sub>i</sub> of the second challenge C^.<br/>
In the random number generation step S743, using the processing device 911, the random number generation unit 303 generates two random numbers t<sub>1, i</sub>, and t<sub>2, i</sub>. The random number storage unit 322 adds the random number t<sub>1, i</sub> generated by the random number generation unit 303 to the integer s<sub>1</sub>, using the processing device 911, and then stores the integer s<sub>1</sub> resulting<!-- EPO <DP n="193"> --> from the calculation, using the storage device 914.<br/>
In the disturbance vector generation step S744, using the processing device 911, the disturbance vector generation unit 362 calculates the ith component t<sub>i</sub> of the disturbance vector T, based on the two random numbers t<sub>1</sub>,<sub>i</sub> and t<sub>2, i</sub> generated by the random number generation unit 303 in the random number generation step S743.<br/>
In the integer combining step S760, using the processing device 911, the integer combining unit 386 calculates the ith integer c^<sub>i</sub> of the second challenge C^, based on the ith component c'<sub>i</sub> of the encrypted feature vector C' generated by the encrypted data extraction unit 305 and the ith component t<sub>i</sub> of the disturbance vector T calculated by the disturbance vector generation unit 362 in the disturbance vector generation step S744.<br/>
The integer combining unit 386 causes the procedure to return to the repetition step S741 to generate the subsequent integer of the second challenge C^.</p><p id="p0290" num="0290">The second challenge C^ calculated by the encrypted random similarity degree calculation unit 314 in this manner is transmitted to the decryption apparatus 103 by the second challenge transmitting unit 321. The decryption apparatus 103 receives and then processes the second challenge C^.</p><p id="p0291" num="0291">Since the decryption unit 404 of the decryption apparatus 103 has the same configuration as that described in the seventh embodiment, a description will be given with reference to <figref idrefs="f0038">Fig. 66</figref>.</p><p id="p0292" num="0292">The decryption unit 404 of the decryption apparatus 103 includes the inverse number calculation unit 481, the decrypted integer calculation unit<!-- EPO <DP n="194"> --> 482, and the integer combining unit 485, for example.</p><p id="p0293" num="0293">Using the processing device 911, the inverse number calculation unit 481 calculates the inverse number λ<sup>-1</sup> of the integer λ in multiplication of integers modulo N, based on the integer N which is the public key pk stored by the public key storage unit 403 and the integer λ which is the secret key sk stored by the secret key storage unit 413.<br/>
Using the processing device 911, the decrypted integer calculation unit 482 calculates T integers z<sub>i</sub> (i being each integer not less than 1 and not more than T), based on the integer λ which is the secret key sk stored by the secret key storage unit 413, the second challenge C^ received by the second challenge receiving unit 402, and the inverse number λ<sup>-1</sup> calculated by the inverse calculation unit 481. The integers z<sub>i</sub> are integers not less than 0 and less than N. The ith integer z<sub>i</sub> (i being the integer not less than 1 and and not more than T + 1) is an integer obtained by decrypting the ith integer c^<sub>i</sub> of the second challenge C^. The integer z<sub>i</sub> is equal to the sum b<sub>i</sub>b'<sub>i</sub> + t<sub>1,i</sub> of the random number t<sub>1, i</sub> and the product of the corresponding components b<sub>j</sub> and b'<sub>i</sub> of the two feature vectors b.<br/>
Using the processing device 911, the integer combining unit 485 calculates the second response Z, based on the integer N which is the public key pk stored by the public key storage unit 403 and the T integers z<sub>i</sub> calculated by the decrypted integer calculation unit 482. The second response Z is an integer not less than 0 and not more than N. The second response Z calculated by the integer combining unit 485 is a remainder when the summation of the T integers z'<sub>i</sub> is divided by the integer N. The second response Z is equal to the sum of the inner product ∑<sub>i</sub>[b<sub>i</sub>b'<sub>i</sub>] between the<!-- EPO <DP n="195"> --> feature vector b and the feature vector b' and the summation value s<sub>1</sub> = ∑<sub>i</sub>[t<sub>1,i</sub>] of the random numbers t<sub>1,i</sub>. That is, the second response Z is obtained by encrypting the inner product between the feature vector b and the feature vector b' by the random number s<sub>1</sub> as a temporary key.</p><p id="p0294" num="0294"><figref idrefs="f0040">Fig. 71</figref> is a flow chart diagram showing an example of a flow of processes of the second response generation step S716 in this embodiment.<br/>
Though the flow of processes of the second response generation step S716 is almost the same as that in the seventh embodiment, there are two differences between the flows of processes of the second response generation steps S716 in the seventh embodiment and the eighth embodiment.<br/>
The first difference is that there are no decrypted integer calculation step S566a and no integer combining step S568a, and the initialization step S560 is executed subsequently to the inverse number calculation step S561a.<br/>
The second difference is that, in the initialization step S560, the integer combining unit 485 initializes the second response Z to 0, using the processing device 911.</p><p id="p0295" num="0295">The second response Z generated by the decryption unit 404 in this manner is transmitted to the authentication apparatus 102 by the second response transmitting unit 412. The authentication apparatus 102 receives and then processes the second response Z.</p><p id="p0296" num="0296">The plaintext similarity degree extraction unit 315 of the authentication apparatus 102 has the same configuration as that in the sixth embodiment.<br/>
The plaintext similarity degree extraction unit 315 calculates the inner product ∑[b<sub>i</sub>b'<sub>i</sub>] between the two feature vectors b and b', as the<!-- EPO <DP n="196"> --> similarity degree d.</p><p id="p0297" num="0297">The determination unit 306 determines that the two feature vectors b and b' are similar when the similarity degree d calculated by the discrete logarithm calculation unit 373 is larger than the predetermined threshold value do.<br/>
With this arrangement, it can be determined whether the two feature vectors b and b' are similar, using the number of matches between feature points as a reference.</p><p id="p0298" num="0298"><figref idrefs="f0041">Fig. 72</figref> is a flow chart diagram showing a similarity degree calculation procedure in the biometric authentication system 100 in this embodiment.<br/>
As a first stage, in the first response generation step S707, the certification apparatus 101 calculates the first response R' from the first challenge R, thereby calculating T pieces of ρ<sub>i</sub> = b<sub>i</sub>b'<sub>i</sub>. This calculation is performed with the feature vectors b and b' kept encrypted with the key of the decryption apparatus 103. Thus, the certification apparatus 101 cannot obtain information on the feature vector b.<br/>
As a second stage, in the second challenge generation step S712, the authentication apparatus 102 calculates the second challenge C^ from the encrypted feature vector C', thereby calculating T pieces of δ<sub>i</sub> = ρ<sub>i</sub> + t<sub>1</sub>, <sub>i</sub> (i being each integer not less than 1 and not more than T). This calculation is performed with the encrypted feature vectors C and C' kept encrypted with the key of the decryption apparatus 103. Thus, the authentication apparatus 102 cannot obtain the information on the feature vector b, information on the feature vector b' and information on the similarity degree.<br/>
<!-- EPO <DP n="197"> -->As a third stage, in the second response generation step S716, the decryption apparatus 103 calculates the second response Z from the second challenge C^, thereby calculating ξ = ∑<sub>i</sub>[δ<sub>i</sub>] (i being each integer not less than 1 and not more than T). This calculation is performed with the second challenge C^ decrypted with the secret key of the decryption apparatus 103. The decryption apparatus 103, however, does not know the temporary key s<sub>i</sub> = ∑<sub>i</sub>[t<sub>1,i</sub>]. Thus, the decryption apparatus 103 cannot obtain the information on the feature vector b, the information on the feature vector b', and the information on the similarity degree. That is, this calculation is performed with a result of the decryption encrypted with the temporary key s<sub>1</sub>.<br/>
As a fourth stage, the authentication apparatus 102 in the plaintext similarity degree calculation step S719 calculates the similarity degree d = ξ - s<sub>1</sub> from the second response Z. With this arrangement, the authentication apparatus 102 can obtain the similarity degree d, but cannot obtain the information on the feature vector b and the information on the feature vector b'.</p><p id="p0299" num="0299">The encryption system is not limited to the Paillier encryption system. It may be so configured that a different additive-homomorphic encryption system such as the Okamoto-Takashima encryption system, the BGN encryption system, or the Gentry encryption system is employed. It may be so configured that a second encryption system such as the standard public key encryption system is employed for communication between the certification apparatus 101 and the authentication apparatus 102.</p><p id="p0300" num="0300">The biometric authentication system 100 may be so configured that the certification apparatus 101 combines functions of the decryption apparatus<!-- EPO <DP n="198"> --> 103 and the registration apparatus 104, as in the second embodiment.</p><heading id="h0020">Ninth Embodiment.</heading><p id="p0301" num="0301">A ninth embodiment will be described, using <figref idrefs="f0041 f0042 f0043">Figs. 73 to 77</figref>.<br/>
Same reference signs are given to components that are common to those in the first to eighth embodiments, thereby omitting description of the components that are common to those in the first to eighth embodiments.</p><p id="p0302" num="0302">In this embodiment, the description will be directed to another variation example of the configuration described in the seventh embodiment.</p><p id="p0303" num="0303">The encrypted feature vector C' is a T-dimensional vector (c'<sub>1</sub>, c'<sub>2</sub>, ..., c'<sub>T</sub>) having components of integers not less than 0 and less than N<sup>2</sup>. The ith component c<sub>i</sub> (i being an integer not less than 1 and not more than T) of the encrypted feature vector C' is obtained by encrypting the product b<sub>i</sub>b'<sub>i</sub> between the ith components b<sub>i</sub> and b'<sub>i</sub> of feature vectors b and b'.</p><p id="p0304" num="0304"><figref idrefs="f0041">Fig. 73</figref> is a detailed block diagram showing an example of a configuration of the encrypted random number generation unit 314 in this embodiment.<br/>
The encrypted random similarity degree calculation unit 314 of the authentication apparatus 102 includes the encryption key generation unit 366 and the integer combining unit 386, for example.</p><p id="p0305" num="0305">Using the processing device 911, the random number generation unit 303 generates two random numbers s<sub>1</sub> and s<sub>2</sub>. The random numbers s<sub>1</sub> and s<sub>2</sub> are integers uniform randomly selected from among integers not less than 0 and less than N. Using the storage device 914, the random number storage unit 322 stores the random number s<sub>1</sub> generated by the random number generation unit 303.<!-- EPO <DP n="199"> --></p><p id="p0306" num="0306">Using the processing device 911, the encryption key generation unit 366 calculates the encryption key <img id="ib0219" file="imgb0022.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> based on the integer N which is the public key pk stored by the public key storage unit 302 and the random numbers s<sub>1</sub> and s<sub>2</sub>generated by the random number generation unit 303. The encryption key <img id="ib0220" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> is an integer not less than 0 and less than N<sup>2</sup>. The encryption key u is a remainder when the product of the sum (1 + s<sub>1</sub>N) and the integer s<sub>2</sub><sup>N</sup> is divided by the square of the integer N. The sum (1 + s<sub>1</sub>N) is obtained by adding 1 to the product of the random number s<sub>1</sub> and the integer N. The integer s<sub>2</sub><sup>N</sup> is obtained by exponentiating the random number s<sub>2</sub> by the integer N. The encryption key <img id="ib0221" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> is obtained by encrypting the random number s<sub>1</sub> as a plaintext.<br/>
Using the processing device 911, the integer combining unit 386 generates the second challenge C^, based on the integer N which is the public key pk stored by the public key storage unit 302, the encrypted feature vector C' generated by the encrypted data extraction unit 305, and the encryption key<img id="ib0222" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the encryption key generation unit 366. The second challenge C^ is an integer not less than 0 and less than N<sup>2</sup>. The second challenge C^ is a remainder when a total product Π<sub>i</sub>[c'<sub>i</sub>]<img id="ib0223" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> of T components c'<sub>i</sub> of the encrypted feature vector C' and the encryption key <img id="ib0224" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> is divided by the square of the integer N. The second challenge C^ is obtained by encrypting a sum ∑<sub>i</sub>[b<sub>i</sub>b'<sub>i</sub>] + s<sub>1</sub> of the random number s<sub>1</sub> as the plaintext and the summation of encrypted b<sub>i</sub>b'<sub>i</sub> which are the components of the encrypted feature vector C' (or the inner product of two feature vectors b and b').</p><p id="p0307" num="0307"><figref idrefs="f0042">Fig. 74</figref> is a flow chart diagram showing an example of a flow of processes of the second challenge generation step S712 in this embodiment.<br/>
<!-- EPO <DP n="200"> -->In the second challenge generation step S712, the authentication apparatus 102 generates the second challenge C^, based on the encrypted feature vector C'. The second challenge generation step S712 includes the random number generation step S749, the encryption key generation step S752, the initialization step S740, the repetition step S741, and the integer combining step S760, for example.</p><p id="p0308" num="0308">First, in the random number generation step S749, using the processing device 911, the random number generation unit 303 generates two random numbers s<sub>1</sub> and s<sub>2</sub>. The random number storage unit 322 stores the integer s<sub>1</sub>, using the storage device 914.<br/>
In the encryption key generation step S752, using the processing device 911, the encryption key generation unit 366 calculates the encryption key <img id="ib0225" file="imgb0022.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> based on the two random numbers s<sub>1</sub> and s<sub>2</sub> generated by the random number generation unit 303 in the random number generation step S749.<br/>
In the initialization step S740, using the processing device 911, the integer combining unit 386 initializes the integer i to 0, and initializes the second challenge C^ to the encryption key <img id="ib0226" file="imgb0023.tif" wi="4" he="4" img-content="character" img-format="tif" inline="yes"/> calculated by the encryption key generation unit 366 in the encryption key generation step S752.<br/>
In the repetition step S741, using the processing device 911, the integer combining unit 386 adds 1 to the integer i. When the integer i is larger than T, the second challenge C' has been completed. Thus, the integer combining unit 386 finishes the second challenge generation step S712. When the integer i is not more than T, the integer combining unit 386 causes the procedure to proceed to the integer combining step S760.<br/>
In the integer combining step S760, using the processing device 911,<!-- EPO <DP n="201"> --> the integer combining unit 386 combines the ith component c'<sub>i</sub> of the encrypted feature vector C' generated by the encrypted data extraction unit 305 with the second challenge C^, by multiplication of integers modulo the square of the integer N.<br/>
The integer combining unit 386 causes the procedure to return to the repetition step S741.</p><p id="p0309" num="0309">The second challenge C^ generated by the encrypted random similarity degree calculation unit 314 in this manner is transmitted to the decryption apparatus 103 by the second challenge transmitting unit 321. The decryption apparatus 103 receives and then processes the second challenge C^.</p><p id="p0310" num="0310"><figref idrefs="f0042">Fig. 75</figref> is a detailed block diagram showing an example of a configuration of the decryption unit 404 in this embodiment.<br/>
The decryption unit 404 of the decryption apparatus 103 includes the inverse number calculation unit 481 and the decrypted integer calculation unit 482, for example.<br/>
Using the processing device 911, the inverse number calculation unit 481 calculates the inverse number λ<sup>-1</sup> of the integer λ in multiplication of integers modulo N, based on the integer N which is the public key pk stored by the public key storage unit 403 and the integer λ which is the secret key sk stored by the secret key storage unit 413.<br/>
Using the processing device 911, the decrypted integer calculation unit 482 calculates the second response Z, based on the integer λ which is the secret key sk stored by the secret key storage unit 413, the second challenge C^ received by the second challenge receiving unit 402, and the inverse<!-- EPO <DP n="202"> --> number λ<sup>-1</sup> calcaulted by the inverse calculation unit 481. The second response Z is an integer not less than 0 and less than N. The second response Z is the integer obtained by decrypting the second challenge C^. The second response Z is equal to the sum of the random number s<sub>1</sub> and the inner product ∑[b<sub>i</sub>b'<sub>i</sub>] between the feature vector b and the feature vector b'. That is, the second response Z is obtained by encrypting the inner product of the feature vector b and the feature vector b' by the random number s<sub>1</sub> as the temporary key.</p><p id="p0311" num="0311"><figref idrefs="f0043">Fig. 76</figref> is a flow chart diagram showing an example of a flow of processes of the second response generation step S716 in this embodiment.<br/>
In the second response generation step S716, the decryption apparatus 103 generates the second response Z from the second challenge C^. The second response generation step S716 includes the inverse number calculation step S561a and the decrypted integer calculation step S563a, for example.</p><p id="p0312" num="0312">First, in the inverse number calculation step S561a, using the processing device 911, the inverse number calculation unit 481 calculates the inverse number λ<sup>-1</sup> of the integer λ which is the secret key sk stored by the secret key storage unit 413.<br/>
In the decrypted integer calculation step S563a, using the processing device 911, the decrypted integer calculation unit 482 decrypts the second challenge C^ received by the second challenge receiving unit 402 to calculate the second response Z, based on the inverse matrix λ<sup>-1</sup> calculated by the inverse number calculation unit 481 in the inverse number calculation step S561a and the like. To take an example, the decrypted integer calculation<!-- EPO <DP n="203"> --> unit 482 calculates the quotient y. The quotient y is obtained by dividing an integer (C^<sup>λ</sup> - 1) by the square of the integer N. The integer (C^<sup>λ</sup> - 1) is obtained by subtracting 1 from an integer resulting from exponentiation of the second challenge C^ by the integer λ. The decrypted integer calculation unit 482 calculates a remainder when the product yλ<sup>-1</sup> of the calculated quotient y and the inverse number λ<sup>-1</sup> is divided by the integer N, and then sets the remainder to the second response Z.</p><p id="p0313" num="0313">The second response Z generated by the decryption unit 404 in this manner is transmitted to the authentication apparatus 102 by the second response transmitting unit 412. The authentication apparatus 102 receives and then processes the second response Z.</p><p id="p0314" num="0314">The plaintext similarity degree extraction unit 315 of the authentication apparatus 102 has the same configuration as that in the sixth embodiment.<br/>
The plaintext similarity degree extraction unit 315 calculates the inner product ∑[b<sub>i</sub>b'<sub>i</sub>] between the two feature vectors b and b', as the similarity degree d.</p><p id="p0315" num="0315">The determination unit 306 determines that the two feature vectors b and b' are similar when the similarity degree d calculated by the discrete logarithm calculation unit 373 is larger than the predetermined threshold value do.<br/>
With this arrangement, it can be determined whether or not the two feature vectors b and b' are similar, using the number of matches between feature points as a reference.</p><p id="p0316" num="0316"><figref idrefs="f0043">Fig. 77</figref> is a flow chart diagram showing a similarity degree<!-- EPO <DP n="204"> --> calculation procedure in the biometric authentication system 100 in this embodiment.<br/>
As a first stage, in the first response generation step S707, the certification apparatus 101 calculates the first response R' from the first challenge R, thereby calculating T pieces of ρ<sub>i</sub> = b<sub>i</sub>b'<sub>i</sub>. This calculation is performed with the two feature vectors b and b' kept encrypted with the key of the decryption apparatus 103. Thus, the certification apparatus 101 cannot obtain information on the feature vector b.<br/>
As a second stage, in the second challenge generation step S712, the authentication apparatus 102 calculates the second challenge C^ from the encrypted feature vector C', thereby calculating δ = ∑[b<sub>i</sub>b'<sub>i</sub>] + s<sub>1</sub> (i being each integer not less than 1 and not more than T). This calculation is performed with the encrypted feature vectors C and C' kept encrypted with the key of the decryption apparatus 103. Thus, the authentication apparatus 102 cannot obtain the information on the feature vector b and information on the feature vector b'.<br/>
As a third stage, in the second response generation step S716, the decryption apparatus 103 calculates the second response Z from the second challenge C^, thereby calculating ξ. Since the decryption apparatus 103 just performs decryption processing, ξ is equal to δ. The decryption apparatus 103 does not know the temporary key s<sub>1</sub>. Thus, the decryption apparatus 103 cannot obtain the information on the feature vector b, the information on the feature vector b', and information on the similarity degree. That is, this calculation is performed with a result of the decryption encrypted with the temporary key s<sub>1</sub>.<br/>
<!-- EPO <DP n="205"> -->As a fourth stage, in the plaintext similarity degree calculation step S719, the authentication apparatus 102 calculates the similarity degree d = ξ - s<sub>1</sub> from the second response Z. With this arrangement, the authentication apparatus 102 can obtain the similarity degree d, but cannot obtain the information on the feature vector b and the information on the feature vector b'.</p><p id="p0317" num="0317">The encryption system is not limited to the Paillier encryption system. It may be so configured that a different additive-homomorphic encryption system such as the Okamoto-Takashima encryption system, the BGN encryption system, or the Gentry encryption system is employed. It may be so configured that a second encryption system such as the standard public key encryption system is employed for communication between the certification apparatus 101 and the authentication apparatus 102.</p><p id="p0318" num="0318">The biometric authentication system 100 may be so configured that the certification apparatus 101 combines functions of the decryption apparatus 103 and the registration apparatus 104, as in the second embodiment.</p><heading id="h0021">Tenth Embodiment.</heading><p id="p0319" num="0319">A tenth embodiment will be described, using <figref idrefs="f0044 f0045 f0046">Figs. 78 to 81</figref>.<br/>
Same reference signs are given to components that are common to those in the first to ninth embodiments, thereby omitting description of the components that are common to those in the first to ninth embodiments.</p><p id="p0320" num="0320"><figref idrefs="f0044">Fig. 78</figref> is a system configuration diagram showing an example of an overall configuration of an image search system 110.<br/>
The image search system 110 is a system for searching an image similar to a specified image from among registered images with image data of<!-- EPO <DP n="206"> --> the registered images kept encrypted.<br/>
The image search system 110 (similarity degree calculation system) includes a terminal apparatus 111, a search apparatus 112, the decryption apparatus 103, and the registration apparatus 104, for example.<br/>
The registration apparatus 104 inputs image data, and then extracts from the input image data a feature of each image represented by the image data, thereby generating the feature vector b. The registration apparatus 104 encrypts the generated feature vector b to generate the encrypted feature vector C. The registration apparatus 104 encrypts the input image data to generate encrypted image data. The registration apparatus 104 registers the encrypted feature vector C and the encrypted image data in the search apparatus 112. It may be so configured that the encrypted image data is stored in a location different from the search apparatus 112, and that the encrypted feature vector C and data indicating the location of the encrypted image data are registered in the search apparatus 112.<br/>
The terminal apparatus 111 receives image data and extracts from the input image data a feature of an image represented by the image data, thereby generating the feature vector b'. The terminal apparatus 111 encrypts the generated feature vector b' to generate the encrypted feature vector C'. The terminal apparatus 112 requests the search apparatus 112 to make a search.<br/>
The search apparatus 112 stores a plurality of the encrypted feature vectors C registered in the registration apparatus 104. The search apparatus 112 calculates the similarity d, based on each of the stored encrypted feature vectors C and the encrypted feature vector C' transmitted from the terminal apparatus 111, based on the request for the search from the terminal apapratsu<!-- EPO <DP n="207"> --> 111. The search apparatus 112 determines the image similar to the specified image from among the registered images, based on the calculated similarity degree d, and returns the encrypted image data of the determined image or the data indicating the location of the enecrypted image data to the terminal apparatus 111.</p><p id="p0321" num="0321">Hardware configurations of the terminal apparatus 111, the search apparatus 112, the decryption apparatus 103, and the registration apparatus 104 are the same as those described in the first embodiment.</p><p id="p0322" num="0322"><figref idrefs="f0044">Fig. 79</figref> is a block configuration diagram showing an example of a functional block configuration of the registration apparatus 104 in this embodiment.<br/>
The registration apparatus 104 includes the public key receiving unit 208, the public key storage unit 202, an image input unit 209, the feature vector formation unit 204, the random number generation unit 205, the encrypted data generation unit 206, the encrypted data transmitting unit 201, an image encryption unit 226, and an encrypted image transmitting unit 228, for example.<br/>
The public key receiving unit 208 (public key acquisition unit) receives the public key pk of the decryption apparatus 103, using the input device 912 such as a communication device. The public key pk of the decryption apparatus 103 is a public key corresponding to the secret key sk stored by the decryption apparatus 103 in secret. Data encrypted with the public key pk of the decryption apparatus 103 can be decrypted only with the secret key sk stored by the decryption apparatus 103.<br/>
The public key storage unit 202 stores the public key pk received by<!-- EPO <DP n="208"> --> the public key receiving unit 208, using the storage device 914.<br/>
The image input unit 209 inputs the image data to be registered, using the input device 912.<br/>
Using the processing device 911, the feature vector formation unit 204 (comparison data acquisition unit) generates the feature vector b (comparison data) from the image data input by the image input unit 209. The feature vector b is a T-dimensional vector having components of integers, for example.<br/>
Using the processing device 911, the random number generation unit 205 generates random numbers to be used when encrypting the feature vector b and the image data.<br/>
Using the processing device 911, the encrypted data generation unit 206 (comparison ciphertext generation unit) generates the encrypted feature vector C (comparison ciphertext), based on the public key stored by the public key storage unit 202, the feature vector b generated by the feature vector formation unit 204, and the random numbers generated by the random number generation unit 205. The encrypted feature vector C is a T-dimensional vector having components of ciphertexts. Each component of the encrypted feature vector C is obtained by encrypting each component of the feature vector b.<br/>
The encrypted data transmitting unit 201 (comparison ciphertext notification unit) transmits the encrypted feature vector C to the search apparatus 112, using the output device 913 such as a communication device, in order to register the encrypted feature vector C generated by the encrypted data generation unit 206 in the search apparatus 112.<br/>
<!-- EPO <DP n="209"> -->Using the processing device 911, the image encryption unit 226 generates the encrypted image data, based on the public key stored by the public key storage unit 202, the image data input by the image input unit 209, and the random numbers generated by the random number generation unit 205. The encrypted image data is obtained by encrypting the image data. An encryption system to be used when the image encryption unit 226 encrypts the image data may be the same encryption system as that to be used when the encrypted data generation unit 206 encrypts the feature vector b, or may be a different encryption system.<br/>
The encrypted image transmitting unit 228 transmits the encrypted image data to the search apparatus 112 together with the encrypted feature vector C to be transmitted by the encrypted data transmitting unit 201, using the output device 913 such as the communication device, in order to register the encrypted iamge data generated by the image encryption unit 226. It may be so configured that the encrypted image data is not registered in the search apparatus 112, but is registered in a different apparatus. It may also be so configured that the registration apparatus 104 itself stores the encrypted image data. In that case, the encrypted iamge transmitting unit 228 transmits to the search apparatus 112 the data indicating the location of the encrypted image data such as the URI (unified resource identifier) of the encrypted image data.</p><p id="p0323" num="0323"><figref idrefs="f0045">Fig. 80</figref> is a block configuration diagram showing an example of a functional block configuration of the terminal apparatus 111 in this embodiment.<br/>
The terminal apparatus 111 includes the public key receiving unit 218,<!-- EPO <DP n="210"> --> the public key storage unit 212, an image input unit 219, the feature vector formation unit 214, the random number generation unit 215, an encrypted data generation unit 216, an encrypted data transmitting unit 222, a result receiving unit 223, and a result outputting unit 224, for example.<br/>
The public key receiving unit 218 (public key acquisition unit) receives the public key pk of the decryption apparatus 103, using the input device 912 such as a communication device.<br/>
Using the storage device 914, the public key storage unit 202 stores the public key pk received by the public key receiving unit 218.<br/>
The image input unit 219 inputs the image data from which the similar image should be searched, using the input device 912.<br/>
The feature vector formation unit 214 (target data acquisition unit) generates the feature vector b' (target data) from the image data input by the image input unit 219, using the processing device 911. The feature vector b' is a T-dimensional vector having components of integers, for example.<br/>
Using the processing device 911, the random number generation unit 215 generates random numbers to be used when encrypting the feature vector b'.<br/>
Using the processing device 911, the encrypted data generation unit 216 (target ciphertext generation unit) generates the encrypted feature vector C' (target ciphertext), based on the public key stored by the public key storage unit 212, the feature vector b' generated by the feature vector formation unit 214, and the random numbers generated by the random number generation unit 215. The encrypted feature vector C' is a T-dimensional vector having components of ciphertexts. Each component of the encrypted feature vector<!-- EPO <DP n="211"> --> C' is obtained by encrypting each component of the feature vector b'.<br/>
Using the output device 913 such as a communication device, the encrypted data transmitting unit 222 (target ciphertext notification unit) transmits to the search apparatus 112 the encrypted feature vector C' generated by the ciphertext data generation unit 216 in order to search the image similar to that represented by the image data input by the image input unit 219.<br/>
Using the input device 912 such as the communication device, the result receiving unit 223 receives a result of the search transmitted by the search apparatus 112. The result of the search is the encrypted image data itself representing the image similar to that represented by the image data input by the image input unit 219 or the data indicating the location of the encrypted image data, for example.<br/>
Using the output device 913 such as a display device, the result outputting unit 224 outputs the result of the search received by the result receiving unit 223. The result outputting unit 224 displays the number of the images similar to the image represented by the image data input by the image input unit 219, for example. Alternatively, it may be so configured that the result outputting unit 224 displays the image by decryption of the encrypted image data.</p><p id="p0324" num="0324">Different from the certification apparatus 101 described in the first to ninth embodiments, the terminal apparatus 111 transmits the encrypted feature vector C' without alteration. In an authentication system, it is necessary to prevent spoofing using a replay attack. On contrast therewith, the terminal apparatus 111 in the image search system 110 in this embodiment can just<!-- EPO <DP n="212"> --> obtain the encrypted image data that has been encrypted, as the result of the search. If the terminal apparatus 111 has no authorization of decrypting the encrypted image data, the terminal apparatus 111 cannot display the searched image. Thus, the need for preventing the replay attack is eliminated.<br/>
However, the terminal apparatus 111 may be configured to receive the first challenge R from the search apparatus 112, to generate the first response R' based on the received first challenge R and the feature vector b', and then to transmit the generated first response R' to the search apparatus 112, like the certification apparatus 101 described in each of the first to ninth embodiments.</p><p id="p0325" num="0325"><figref idrefs="f0046">Fig. 81</figref> is a block configuration diagram showing an example of a functional block configuration of the search apparatus 112 in this embodiment.<br/>
The search apparatus 112 includes the public key receiving unit 308, the public key storage unit 302, the encrypted data receiving unit 301 and an encrypted data receiving unit 325 which are two encrypted data receiving units, the encrypted data storage unit 312, the random number generation unit 303, the random number storage unit 322, the encrypted random similarity degree calculation unit 314, the second challenge transmitting unit 321, the second response receiving unit 341, the plaintext similarity degree extraction unit 315, the determination unit 306, and a result transmitting unit 323.<br/>
Using the input device 912 such as a communication device, the public key receiving unit 308 (public key acquisition unit) receives the public key pk of the decryption apparatus 103.<br/>
Using the storage device 914, the public key storage unit 302 stores<!-- EPO <DP n="213"> --> the public key pk received by the public key receiving unit 308.<br/>
The encrypted data receiving unit 301 (comparison ciphertext acquisition unit) receives the encrypted feature vector C transmitted by the registration apparatus 104, using the input device 912 such as the communication device.<br/>
The encrypted data storage unit 312 (comparison ciphertext storage unit) stores the encrypted feature vector C received by the encrypted data receiving unit 301, using the storage device 914. The encrypted data storage unit 312 associates the plurality of the encrypted feature vectors C with the data indicating the locations of the encrypted image data.<br/>
The encrypted data receiving unit 325 (target ciphertext acquisition unit) receives the encrypted feature vector C' transmitted by the terminal apparatus 111, using the input device 912 such as the communication device.<br/>
Using the processing device 911, the random number generation unit 303 generates random numbers to be used for generation of the second challenge C^.<br/>
Using the storage device 914, the random number storage unit 322 stores the random numbers as plaintexts out of the random numbers generated by the random number generation unit 303.<br/>
Using the processing device 911, the encrypted random similarity degree calculation unit 314 generates the second challenge C^, based on the encrypted feature vector C' received by the encrypted data receiving unit 325 and the random numbers generated by the random number generation unit 303 for each of the encrypted feature vectors C stored by the encrypted data storage unit 312.<br/>
<!-- EPO <DP n="214"> -->The second challenge transmitting unit 321 transmits the second challenge C^ generated by the encrypted random similarity degree calculation unit 314 to the decryption apparatus 103, using the output device 913 such as a communication device.<br/>
The second response receiving unit 341 receives the second response Z transmitted by the decryption apparatus 103, as a response for the second challenge C" transmitted by the second challenge transmitting unit 321, using the input device 912 such as the communication device.<br/>
Using the processing device 911, the plaintext similarity degree extraction unit 315 calculates the similarity degree d, based on the random numbers stored by the random number storage unit 322 and the second response Z received by the second response receiving unit 341.<br/>
Using the processing device 911, the determination unit 306 determines the image similar to the image represented by the image data input by the terminal apparatus 111, based on the similarity degree d calculated by the plaintext similarity degree extraction unit 315. Assume that the similarity degree d is the square of the Euclidean distance or the like which indicates that the feature vectors b and b' are more similar as the similarity degree d becomes smaller. Then, when the similarity degree d is smaller than the predetermined threshold value do, the determination unit 306 determines that the image having the similarity degree d is similar to the image represented by the image data input by the terminal apparatus 111. When the number of images having the similarity degrees d smaller than the threshold value do is larger than a predetermined number, the determination unit 306 may be configured to determine that only the predetermined number<!-- EPO <DP n="215"> --> of images having the similarity degrees d in the descending order of the similarity degrees d are similar to the image represented by the image data input by the terminal apparatus 111.</p><p id="p0326" num="0326">Using the output device 913 such as the communication device, the result transmitting unit 323 transmits a result determined by the plaintext similarity degree extraction unit 315 to the terminal apparatus 111.</p><p id="p0327" num="0327">Detailed configurations of the encrypted random similarity degree calculation unit 314, the plaintext similarity degree extraction unit 315, and the like are the same as those of the encrypted random similarity degree calculation unit 314, the plaintext similarity degree extraction unit 315, and the like of the authentication apparatus 102 described in each of the first to ninth embodiments.<br/>
The decryption apparatus 103 also has the same configuration as that of the decryption apparatus 103 described in each of the first to ninth embodiment.</p><p id="p0328" num="0328">By searching the image similar to the image represented by the image data input by the terminal apparatus 111 based on the similarity degree d calculated by the method described in each of the first to ninth embodiments, the image can be searched without decrypting the encrypted image data and the feature vectors.</p><p id="p0329" num="0329">Data to be searched is not limited to the image data. The data to be searched may be different data such as document data. Assume that the target to be searched is the document data. Then, a configuration may be considered where the number of occurrences of a predetermined word is set to the value of each feature vector component.<!-- EPO <DP n="216"> --></p><p id="p0330" num="0330">The configuration described in each embodiment is an example, and may be a different configuration. To take an example, a configuration that combines the configurations described in the different embodiments may be used. Alternatively, a configuration may be used where the configuration of an insignificant portion is replaced by a different configuration.</p><p id="p0331" num="0331">The description was directed to the configuration where the square of the Euclidean distance between the two feature vectors b and b' is calculated as the similarity degree d and the configuration where the inner product of the two feature vectors b and b' is calculated as the similarity degree d, for example. A configuration may be employed where the similarity degree d is calculated by a different formula for computation, such as a Hamming distance between the two feature vectors b and b' or the number of matches between feature points.</p><p id="p0332" num="0332">In the biometric system 100 described in each of the first to ninth embodiments, the description was directed to the configuration where the encrypted feature vector C corresponding to the first response R' received by the first response receiving unit 331 is identified from among the encrypted feature vectors C stored by the encrypted data storage unit 312 of the authentication apparatus 102, using the user identifier, thereby generating the second challenge C'. A configuration may be employed where the similarity degree d is calculated for each encrypted feature vector C stored by the encrypted data storage unit 312, as in the image search system 110 described in the tenth embodiment. In that case, the determination unit 306 may be configured to determine a user who input biometric information to the certification apparatus 101 is the user having the encrypted feature vector C<!-- EPO <DP n="217"> --> determined to be most similar, for example.</p><p id="p0333" num="0333">In each of the first to ninth embodiments, the description was given about the biometric authentication system 100 that performs authentication based on biometric information. An authentication system that performs authentication based on different information may be used.</p><p id="p0334" num="0334">Further, the similarity degree calculation system described above is not limited to the authentication system or the search system, but may be applied to other various systems.</p><p id="p0335" num="0335">The similarity degree calculation apparatus (authentication apparatus 102; or search apparatus 112) described above calculates a similarity degree (d) between comparison data (feature vector b) and target data (feature vector b').<br/>
The similarity degree calculation apparatus includes a storage device (914) that stores data, a processing device (911) that processes the data, a comparison ciphertext storage unit (encrypted data storage unit 312), a target ciphertext acquisition unit (encrypted data extraction unit 305; or encrypted data receiving unit 325), a temporary key generation unit (random number generation unit 303), an interim similarity degree ciphertext calculation unit (encrypted random similarity degree calculation unit 314), an interim similarity degree ciphertext notification unit (second challenge transmitting unit 321), an interim similarity degree decrypted text acquisition unit (second response receiving unit 341), and a similarity degree calculation unit (plaintext similarity degree extraction unit 315).<br/>
Using the storage device, the comparison ciphertext storage unit stores a comparison ciphertext (encrypted feature vector C) obtained by<!-- EPO <DP n="218"> --> transforming the comparison data by encryption transformation using a public key (pk) corresponding to a secret key (sk) stored by a decryption apparatus (103).<br/>
Using the processing device, the target ciphertext acquisition unit acquires a target ciphertext (encrypted feature vector C') obtained by transforming the target data by the encryption transformation using the public key.<br/>
Using the processing device, the temporary key generation unit generates a temporary key (random number u<sub>1</sub>; or random number s<sub>1</sub>).<br/>
Using the processing device, based on the comparison ciphertext stored by the comparison ciphertext storage unit, the target ciphertext acquired by the target ciphertext acquisition unit, and the temporary key generated by the temporary key generation unit, the interim similarity degree ciphertext calculation unit performs calculation for calculating the similarity degree in a first stage with the comparison cirphertext and the target ciphertext kept encrypted. The interim similarity degree ciphertext calculation unit calculates an interim similarity degree ciphertext (second challenge C^) by encrypting a result of the calculation with the temporary key.<br/>
Using the processing device, the interim similarity degree ciphertext notification unit notifies to the decryption apparatus the interim similarity degree ciphertext calculated by the interim similarity degree ciphertext calculation unit.<br/>
Using the processing device, the interim similarity degree decrypted text acquisition unit acquires an interim similarity degree decrypted text (second response Z) calculated and notified by the decryption apparatus,<!-- EPO <DP n="219"> --> based on the interim similarity degree ciphertext notified by the interim similarity degree ciphertext notification unit.<br/>
Using the processing device, the similarity degree calculation unit decrypts the interim similarity degree decrypted text with the temporary key, based on the temporary key generated by the temporary key generation unit and the interim similarity degree decrypted text acquired by the similarity degree calculating decrypted text acquisition unit, thereby calculating the similarity degree between the comparison data and the target data.</p><p id="p0336" num="0336">The similarity degree calculation system (biometric authentication system 100; or image search system 110) described above includes the similarity degree calculation apparatus (authentication apparatus 102; or search apparatus 112) and a decryption apparatus (103).<br/>
The decryption apparatus includes a storage device (914) that stores data, a processing device (911) that processes the data, a secret key storage unit (413), an interim similarity degree ciphertext acquisition unit (second challenge receiving unit 402), an interim similarity degree decrypted text calculation unit (decryption unit 404), and an interim similarity degree decrypted text notification unit (second response transmitting unit 412).<br/>
Using the storage device of the decryption apparatus, the secret key storage unit of the decryption apparatus stores the secret key (sk).<br/>
Using the processing device of the decryption apparatus, the interim similarity degree ciphertext acquisition unit of the decryption apparatus acquires the interim similarity degree ciphertext notified from the similarity degree calculation unit.<br/>
Using the processing device of the decryption apparatus, the interim<!-- EPO <DP n="220"> --> similarity degree decrypted text calculation unit of the decryption apparatus decrypts the interim similarity degree ciphertext with the secret key, based on the secret key stored by the secret key storage unit of the decryption apparatus and the interim similarity degree ciphertext acquired by the interim similarity degree ciphertext acquisition unit of the decryption apparatus. Thhe interim similarity degree decrypted text calculation unit performs calculation for calculating the similarity degree in a second stage with a result of the decryption kept encrypted with the temporary key, thereby calculating the interim similarity degree decrypted text.<br/>
Using the processing device of the decryption apparatus, the interim similarity degree decrypted text notification unit of the decryption apparatus notifies the interim similarity degree decrypted text calculated by the interim similarity degree decrypted text calculation unit of the decryption apparatus to the similarity degree calculation apparatus.</p><p id="p0337" num="0337">In the similarity degree calculation system (biometric authentication system 100; or image search system 110) described above,<br/>
each of the comparison data (feature vector b) and the target data (feature vector b') is a T-dimensional vector (T being an integer not less than 1) having components of integers.<br/>
Using the processing device (911) of the similarity degree calculation apparatus (authentication apparatus 102; or search apparatus 112), the interim similarity degree ciphertext calculation unit (encrypted random similarity degree calculation unit 314) of the similarity degree calculation apparatus calculates the difference or the product of the corresponding components of the comparison data and the target data, with the comparison ciphertext<!-- EPO <DP n="221"> --> (encrypted feature vector C) and the target ciphertext (encrypted feature vector C') kept encrypted.<br/>
Using the processing device (911) of the decryption apparatus (103), the interim similarity degree ciphertext calculation unit (decryption unit 404) of the decryption apparatus decrypts the interim similarity degree ciphertext with the secret key (sk), and calculates the similarity degree (d), with the result of the decryption kept encrypted with the temporary key.<br/>
Using the processing device of the similarity degree calculation apparatus, the similarity degree calculation unit (plaintext similarity degree extraction unit 315) of the similarity degree calculation apparatus decrypts the interim similarity degree decrypted text, thereby obtaining the similarity degree.</p><p id="p0338" num="0338">In the similarity degree calculation system (biometric authentication system 100; or image search system 110) described above,<br/>
the encryption transformation is transformation for transforming an integer (integer not less than 0 and less than q; or integer not less than 0 and less than N) into a ciphertext (vector in a vector space V; element in a finite group G; or integer not less than 0 and less than N<sup>2</sup>). An arithmetic operation (addition in the vector space V; multiplication on the finite group G; multiplication of integers modulo N<sup>2</sup>) for combining and transforming a plurality of ciphertexts into a different ciphertext may be calculated for the ciphertext. A ciphertext obtained by combining a ciphertext (E(x1)) resulting from transformation of an arbitrary first integer (x1) and a ciphertext (E(x2)) resulting from transformation of an arbitrary second integer (x2) by the arithmetic operation for the ciphertext is a ciphertext (E(x1 + x2))<!-- EPO <DP n="222"> --> resulting from transformation of the sum (x1 + x2) of the first integer and the second integer.</p><p id="p0339" num="0339">In the similarity degree calculation system (biometric authentication system 100; or image search system 110),<br/>
each of the comparison data (feature vector b) and the target data (feature vector b') is a T-dimensional vector (T being an integer not less than 1) having each component of an integer (b<sub>i</sub> or b'<sub>i</sub>).<br/>
The comparison ciphertext (encrypted feature vector C) is a T-dimensional vector havinga component of a ciphertext (c<sub>i</sub>) obtained by transforming each component of the comparison data by the encryption transformation using the public key (pk).<br/>
The target ciphertext (encrypted feature vector C') is a T-dimensional vector having a component of a ciphertext (c'<sub>i</sub>) obtained by transforming each component of the target data by the encryption transformation using the public key.<br/>
The similarity degree calculation apparatus (authentication apparatus 102; or search apparatus 112) further includes a public key storage unit (302).<br/>
Using the storage device (914) of the similarity degree calculation apparatus, the public key storage unit of the similarity degree calculation apparatus stores a public key (pk) corresponding to the secret key (sk) stored by the decryption apparatus (103).<br/>
Using the processing device (911) of the similarity degree calculation apparatus, the temporary key generation unit (random number generation unit 303) of the similarity degree calculation apparatus randomly generates an integer (u<sub>1</sub>), and sets the generated integer to the temporary key.<br/>
<!-- EPO <DP n="223"> -->The interim similarity degree ciphertext calculation unit (encrypted random similarity degree calculation unit 314) of the similarity degree calculation apparatus includes a random number plaintext generation unit (disturbance vector generation unit 362), a first ciphertext calculation unit (vector combining unit 363), and a second ciphertext calculation unit (vector summation unit 367).<br/>
Using the processing device of the similarity degree calculation apparatus, the random number plaintext generation unit of the similarity degree calculation apparatus generates a T-dimensional vector having a component of an integer (t<sub>1, i</sub>), and sets the generated T-dimensional vector to a random number plaintext (disturbance vector T).<br/>
Using the processing device of the similarity degree calculation apparatus, the first ciphertext calculation unit of the similarity degree calculation apparatus calculates a first interim similarity degree ciphertext using the arithmetic operation for the ciphertext, based on the comparison ciphertext stored by the comparison ciphertext storage unit (encrypted data storage unit 312) of the similarity degree calculation apparatus, the target ciphertext acquired by the target ciphertext acquisition unit (encrypted data extraction unit 305; or encrypted data receiving unit 325) of the similarity degree calculation apparatus, and the random number plaintext generated by the random number plaintext generation unit of the similarity degree calculation apparatus. The first interim similarity degree ciphertext is a T-dimensional vector having a component of a ciphertext (c^<sub>i</sub>) obtained by transforming a sum (b<sub>i</sub> - b'<sub>i</sub> + t<sub>1, i</sub>) of a difference between each component of the comparison data and the corresponding component of the target data and<!-- EPO <DP n="224"> --> the corresponding component of the random number plaintext by the encryption transformation using the public key.<br/>
Using the processing device of the similarity degree calculation apparatus, the second ciphertext calculation unit of the similarity degree calculation apparatus calculates a second interim similarity degree ciphertext (c^) using the arithmetic operation for the ciphertext, based on the comparison ciphertext stored by the comparison ciphertext storage unit of the similarity degree calculation apparatus, the target ciphertext acquired by the target ciphertext acquisition unit of the similarity degree calculation apparatus, the temporary key generated by the temporary key generation unit of the similarity degree calculation apparatus, and the random number plaintext generated by the random number plaintext generation unit of the similarity degree calculation apparatus. The second interim similarity degree ciphertext is a ciphertext obtained by transforming the sum of a correction value and the temporary key (u<sub>1</sub>) by the encryption transformation using the public key. The correction value is an integer (∑[2t<sub>1, i</sub>(b<sub>i</sub> - b'<sub>i</sub>) + t<sub>1, i</sub><sup>2</sup>]) obtained by summating, for all of the components, sums of squares of the respective components of the random number plaintext and twice the products of differences between the respective components of the comparison data and the corresponding components of the target data and the corresponding components of the random number plaintext.<br/>
Using the processing device of the similarity degree calculation apparatus, the similarity degree calculatin ciphertext notification unit (second challenge transmitting unit 321) of the similarity degree calculation apparatus notifies the first interim similarity degree ciphertext calculated by the first<!-- EPO <DP n="225"> --> ciphertext calculation unit of the similarity degree calculation apparatus and the second interim similarity degree ciphertext calculated by the second ciphertext calculation unit of the similarity degree calculation apparatus to the decryption apparatus.</p><p id="p0340" num="0340">In the similarity degree calculation system (biometric authentication system 100: or image search system 110) described above,<br/>
each of the comparison data (feature vector b) and the target data (feature vector b') is a T-dimensional vector (T being an integer not less than 1) having each component (b<sub>i</sub>, or b'<sub>i</sub>) of an integer of 0 or one.<br/>
The comparison ciphertext (encrypted feature vector C) is a T-dimensional vector having a component of a ciphertext obtained by transforming each component of the comparison data by the encryption transformation using the public key (pk).<br/>
The target ciphertext is a T-dimensional vector having a component of a ciphertext obtained by transforming each component (b'<sub>i</sub>) of the target data by the encryption transformation using the public key.<br/>
The similarity degree calculation apparatus (authentication apparatus 102; or search apparatus 112) further includes a public key storage unit (302).<br/>
Using the storage device (914) of the similarity degree calculation apparatus, the public key storage unit of the similarity degree calculation apparatus stores the public key (pk) corresponding to the secret key (sk) stored by the decryption apparatus (103).<br/>
Using the processing device (911) of the similarity degree calculation apparatus, the temporary key generation unit (random number generation unit 303) of the similarity degree calculation apparatus randomly generates an<!-- EPO <DP n="226"> --> integer (u<sub>1</sub>) and sets the integer to the temporary key.<br/>
The interim similarity degree ciphertext calculation unit (encrypted random similarity degree calculation unit 314) of the similarity degree calculation apparatus includes a random number plaintext generation unit (disturbance vector generation unit 362), a first ciphertext calculation unit (vector combining unit 363), and a second ciphertext calculation unit (vector summation unit 367).<br/>
Using the processing device of the similarity degree calculation apparatus, the random number plaintext generation unit of the similarity degree calculation apparatus generates a T-dimensional vector havinga component of an integer (t<sub>1, i</sub>), and sets the generated T-dimensional vector to a random number plaintext (disturbance vector T).<br/>
Using the processing device of the similarity degree calculation apparatus, the first ciphertext calculation unit of the similarity degree calculation apparatus calculates a first interim similarity degree ciphertext using the arithmetic operation for the ciphertext, based on the comparison ciphertext stored by the comparison ciphertext storage unit (encrypted data storage unit 312) of the similarity degree calculation apparatus, the target ciphertext acquired by the target ciphertext acquisition unit (encrypted data extraction unit 305; and encrypted data receiving unit 325) of the similarity degree calculation apparatus, and the random number plaintext generated by the random number plaintext generation unit of the similarity degree calculation apparatus. The first interim similarity degree ciphertext is a T-dimensional vector havinga component of a ciphertext (c^<sub>i</sub>) obtained by transforming a sum (b<sub>i</sub> - b'<sub>i</sub> + t<sub>1, i</sub>) of a difference between each component of<!-- EPO <DP n="227"> --> the comparison data and the corresponding component of the target data and the corresponding component of the random number plaintext by the encryption transformation using the public key.<br/>
Using the processing device of the similarity degree calculation apparatus, the second ciphertext calculation unit of the similarity degree calculation apparatus calculates a second interim similarity degree ciphertext (c^) using the arithmetic operation for the ciphertext, based on the comparison ciphertext stored by the comparison ciphertext storage unit of the similarity degree calculation apparatus, the target ciphertext acquired by the target ciphertext acquisition unit of the similarity degree calculation apparatus, the temporary key generated by the temporary key generation unit of the similarity degree calculation apparatus, and the random number plaintext generated by the random number plaintext generation unit of the similarity degree calculation apparatus. The second interim similarity degree ciphertext is a ciphertext obtained by transforming the sum of a correction value and the temporary key by the encryption transformation using the public key. The correction value is an integer (∑[2t<sub>1, i</sub>(b<sub>i</sub> - b'<sub>i</sub>) + t<sub>1, i</sub><sup>2</sup> + b<sub>i</sub> + b'<sub>i</sub>]) obtained by summating, for all the components, sums of squares of the respective components of the random number plaintext, the respective components of the comparison data, the respective components of the target data, and twice the products of differences between the respective components of the comparison data and the corresponding components of the target data and the corresponding components of the random number plaintext.<br/>
Using the processing device of the similarity degree calculation apparatus, the interim similarity degree ciphertext notification unit (second<!-- EPO <DP n="228"> --> challenge transmitting unit 321) of the similarity degree calculation apparatus notifies the first interim similarity degree ciphertext calculated by the first ciphertext calculation unit of the similarity degree calculation apparatus and the second interim similarity degree ciphertext calculated by the second ciphertext calculation unit of the similarity degree calculation apparatus to the decryption apparatus.</p><p id="p0341" num="0341">In the similarity degree calculation system (biometric authentication system 100; or image search system 110) described above,<br/>
each of the comparison data (feature vector b) and the target data (feature vector b') is a T-dimensional vector (T being an integer not less than 1) having each component (b<sub>i</sub> or b'<sub>i</sub>) of an integer.<br/>
The comparison ciphertext (encrypted feature vector C) is a T-dimensional vector having a component of a ciphertext (c<sub>i</sub>) obtained by transforming each component of the comparison data by the encryption transformation using the public key (pk).<br/>
The target ciphertext (encrypted feature vector C') is a T-dimensional vector havinga component of a ciphertext (c'<sub>i</sub>) obtained by transforming each component of the target data by the encryption transformation using the public key.<br/>
The similarity degree calculation apparatus (authentication apparatus 102; or search apparatus 112) further includes a public key storage unit (302).<br/>
Using the storage device (914) of the similarity degree calculation apparatus, the public key storage unit of the similarity degree calculation apparatus stores the public key (ps) corresponding to the secret key (sk) stored by the decryption apparatus (103).<br/>
<!-- EPO <DP n="229"> -->Using the processing device of the similarity degree calculation apparatus, the temporary key generation unit (random number generation unit 303) of the similarity degree calculation apparatus randomly generates an integer (s<sub>1</sub>), and sets the generated integer to the temporary key.<br/>
The interim similarity degree ciphertext calculation unit of the similarity degree calculation apparatus includes a first ciphertext calculation unit (difference calculation unit 361, and rearrangement unit 385) and a second ciphertext calculation unit (encryption key generation unit 366).<br/>
Using the processing device of the similarity degree calculation apparatus, the first ciphertext calculation unit of the similarity degree calculation apparatus calculates a first interim similarity degree ciphertext using the arithmetic operation for the ciphertext, based on the comparison ciphertext stored by the comparison ciphertext storage unit (encrypted data storage unit 312) of the similarity degree calculation apparatus and the target ciphertext acquired by the target ciphertext acquisition unit (encrypted data extraction unit 305; or encrypted data receiving unit 325) of the similarity degree calculation apparatus. The first interim similarity degree ciphertext is a T-dimensional vector having a component of a ciphertext (c^<sub>i</sub>) obtained by transforming a difference (b<sub>i</sub> - b'<sub>i</sub>) between each component of the comparison data and the corresponding component of the target data by the encryption transformation using the public key.<br/>
Using the processing device of the similarity degree calculation apparatus, the second ciphertext calculation unit of the similarity degree calculation apparatus sets a ciphertext (c^) obtained by transformation of the temporary key by the encryption transformation using the public key to a<!-- EPO <DP n="230"> --> second interim similarity degree ciphertext, based on the public key stored by the public key storage unit of the similarity degree calculation apparatus and the temporary key generated by the temporary key generation unit of the similarity degree calculation apparatus.<br/>
Using the processing device of the similarity degree calculation apparatus, the interim similarity degree ciphertext notification unit (second challenge transmitting unit 321) of the similarity degree calculation apparatus notifies the first interim similarity degree ciphertext calculated by the first ciphertext calculation unit of the similarity degree calculation apparatus and the second interim similarity degree ciphertext calculated by the second ciphertext calculation unit of the similarity degree calculation apparatus to the decryption apparatus.</p><p id="p0342" num="0342">In the similarity degree calculation system (biometric authentication system 100; or image search system 110) described above,<br/>
using the processing device (911) of the similarity degree calculation apparatus (authentication apparatus 102; or search apparatus 112), the first ciphertext calculation unit (difference calculation unit 361, and rearrangement unit 385) of the similarity degree calculation apparatus sets, as the first interim similarity degree ciphertext, the T-dimensional vector having components of a ciphertext randomly selected from among ciphertexts obtained by transforming the difference of each component of the comparison data from the corresponding component of the target data by the encryption transformation using the public key (pk) and ciphertexts obtained by transforming the difference of each component of the target data from the corresponding component of the comparison data by the encryption<!-- EPO <DP n="231"> --> transformation using the public key, the T-dimensional vector having asequence of the components randomly rearranged.</p><p id="p0343" num="0343">In the similarity degree calculation system (biometric authentication system 100; or image search system 110) described above,<br/>
using the processing device (911) of the decryption apparatus (103), the interim similarity degree decrypted text calculation unit (decryption unit 404) of the decryption apparatuscalculates a difference or a sum between the summation of squares of the integers obtained by decrypting the T components of the first interim similarity degree ciphertext and the integer obtained by decrypting the second interim similarity degree ciphertext, or calculates an element obtained by combining z pieces of predetermined elements (in which z is the difference or the sum between the summation of squares of the integers obtained by decrypting the T components of the first interim similarity degree ciphertext and the integer obtained by decrypting the second interim similarity degree ciphertext) in a predetermined finite group by a group arithmetic operation on the predetermined finite group, and sets the calculated difference or the calculated sum or the calculated element to the interim similarity degree decrypted text (second response Z).</p><p id="p0344" num="0344">In the similarity degree calculation system (biometric authentication system 100; or image search system 110) described above,<br/>
each of the comparison data (feature vector b) and the target data (feature vector b') is a T-dimensional vector (T being an integer not less than 1) having each component (b<sub>i</sub> or b'<sub>i</sub>) of an integer.<br/>
The comparison ciphertext (encrypted feature vector C) is a T-dimensional vector having a component of a ciphertext (c<sub>i</sub>) obtained by<!-- EPO <DP n="232"> --> transforming each component of the comparison data by the encryption transformation using the public key (pk).<br/>
The target ciphertext (encrypted feature vector C') is a T-dimensional vector having a component of a ciphertext (c'<sub>i</sub>) obtained by transforming each component of the target data by the encryption transformation using the public key.<br/>
The similarity degree calculation apparatus (authentication apparatus 102; or search apparatus 112) further includes a public key storage unit (302).<br/>
Using the storage device (914) of the similarity degree calculation apparatus, the public key storage unit of the similarity degree calculation apparatus stores the public key (pk) corresponding to the secret key (sk) stored by the decryption apparatus (103).<br/>
Using the processing device (911) of the similarity degree calculation apparatus, the temporary key generation unit (random number generation unit 303) of the similarity degree calculation apparatus randomly generates an integer (s<sub>1</sub>), , and sets the generated integer to the temporary key.<br/>
using the processing device of the similarity degree calculation apparatus, the interim similarity degree ciphertext calculation unit (encrypted random similarity degree calculation unit 314) of the similarity degree calculation apparatus calculates the interim similarity degree ciphertext (second challenge C^) using the arithmetic operation for the ciphertext, based on the comparison ciphertext stored by the comparison ciphertext storage unit (encrypted data storage unit 312) of the similarity degree calculation apparatus and the target ciphertext acquired by the target ciphertext acquisition unit (encrypted data extraction unit 305; or encrypted data<!-- EPO <DP n="233"> --> receiving unit 325) of the similarity degree calculation apparatus, and the temporary key generated by the temporary key generation unit of the similarity degree calculation apparatus. The interim similarity degree ciphertext is a ciphertext obtained by transforming a sum or a difference between a summation value and the temporary key by the encryption transformation using the public key. The summation value is an integer (∑<sub>i</sub>[(b<sub>i</sub> - b'<sub>i</sub>)<sup>2</sup>]; or ∑<sub>i</sub>[b<sub>i</sub>b'<sub>i</sub>]) obtained by summating a square of a difference between each component of the comparison data and the corresponding component of the target data or the product of each component of the comparison data and the corresponding component of the target data, for all the components.</p><p id="p0345" num="0345">In the similarity degree calculation system (biometric authentication system 100; or image search system 110),<br/>
the encryption transformation is transformation for transforming an integer not less than 0 and less than q (q being a prime number) into a ciphertext that is an n-dimensional vector (n being an integer not less than 2) in a vector space (V).<br/>
The vector space is a direct product of n cyclic groups of an order q.<br/>
The arithmetic operation for the ciphertext is addition of vectors in the vector space.<br/>
The public key (pk) includes a random base (B) that is a base of the vector space.<br/>
The encryption transformation is transformation for transforming an integer x not less than 0 and less than q into a vector obtained by adding x times a first vector (b<sub>1</sub>) of the random base and random number times a<!-- EPO <DP n="234"> --> different vector (b<sub>j</sub>) of the random base.</p><p id="p0346" num="0346">In the similarity degree calculation system (biometric authentication system 100; or image search system 110),<br/>
the encryption transformation is transformation for transforming an integer not less than 0 and less than N (N being the product of mutually different two prime numbers p and q) into a ciphertext that is an element of a finite group (G) of an order N.<br/>
The arithmetic operation for the ciphertext is a group arithmetic operation on the finite group.<br/>
The public key (pk) includes a generator element (g) of the finite group and a disturbance element (h) that is an element of the finite group and has an order of the prime number p.<br/>
The encryption transformation is transformation for transforming an integer x not less than 0 and less than N into an element obtained by combining x pieces of the generator elements and a random number of the disturbance elements using the group arithmetic operation on the finite group.</p><p id="p0347" num="0347">In the similarity degree calculation system (biometric authentication system 100; or image search system 110),<br/>
the encryption transformation is transformation for transforming an integer not less than 0 and less than N (N being the product of mutually different two prime numbers p and q) into a ciphertext that is an integer not less than 0 and less than N<sup>2</sup>.<br/>
The arithmetic operation for the ciphertext is multiplication of integers modulo N<sup>2</sup>.<br/>
The encryption transformation is transformation for transforming an<!-- EPO <DP n="235"> --> integer x not less than 0 and less than N into a remainder when the product of an Nth power of a random number and the sum of 1 and the product of the integer x and the integer N is divided by N<sup>2</sup>.</p><p id="p0348" num="0348">The similarity degree calculation system (biometric authentication system 100; or image search system 110) further includes an encryption apparatus (certification apparatus 101; or terminal apparatus 111).<br/>
The encryption apparatus includes a storage device (914) that stores data, a processing device (911) that processes the data, a public key storage unit (212), a target data acquisition unit (feature vector formation unit 214), a temporary public key acquisition unit (first challenge receiving unit 211), a target dual encryption text calculation unit (encrypted data embedding unit 217), and a target dual encryption text notification unit (first response transmitting unit 221).<br/>
Using the storage device of the encryption apparatus, the public key storage unit of the encryption apparatus stores the public key (pk) corresponding to the secret key (sk) stored by the decryption apparatus (103).<br/>
Using the processing device of the encryption apparatus, the target data acquisition unit of the encryption apparatus acquires the target data (feature vector b').<br/>
Using the processing device of the encryption apparatus, the temporary public key acquisition unit of the encryption apparatus acquires a temporary public key (first challenge R) notified from the similarity degree calculation apparatus (authentication apparatus 102; or search apparatus 112).<br/>
Using the processing device of the encryption apparatus, the target dual encryption text calculation unit of the encryption apparatus transforms<!-- EPO <DP n="236"> --> the target data by second encryption transformation using the public key and the temporary public key, thereby calculating a target dual encryption text (first response R'), based on the public key stored by the public key storage unit of the encrypted apparatus, the target data acquired by the target data acquisition unit of the encryption apparatus, and the temporary public key acquired by the temporary public key acquisition unit of the encryption apparatus.<br/>
Using the processing device of the encryption apparatus, the target dual encryption text notification unit of the encryption apparatus notifies the target dual encryption text calculated by the target dual encryption text calculation unit of the encryption apparatus to the similarity degree calculation apparatus.<br/>
The similarity degree calculation apparatus further includes a temporary secret key generation unit (random number generation unit 303, and encrypted random number generation unit 304), a temporary public key notification unit (first challenge transmitting unit 311), and a target dual encryption text acquisition unit (first response receiving unit 331).<br/>
Using the processing device (911) of the similarity degree calculation apparatus, the temporary secret key generation unit of the similarity degree calculation apparatus generates a temporary secret key (R<sub>1, i</sub>) and a temporary public key (first challenge R) corresponding to the temporary secret key.<br/>
Using the processing device of the similarity degree calculation apparatus, the temporary public key notification unit of the similarity degree calculation apparatus notifies the temporary public key generated by the temporary secret key generation unit of the similarity degree calculation<!-- EPO <DP n="237"> --> apparatus to the encryption apparatus.<br/>
Using the processing device of the similarity degree calculation apparatus, the target dual encryption text acquisition unit of the similarity degree calculation apparatus acquires the target dual encryption text notified from the encryption apparatus.<br/>
Using the processing device of the similarity degree calculation apparatus, the target ciphertext acquisition unit of the similarity degree calculation apparatus transforms the target dual encryption text by second decryption transformation using the temporary secret key, based on the temporary secret key generated by the temporary secret key generation unit of the similarity degree calculation apparatus and the target dual encryption text acquired by the target dual encryption text acquisition unit of the similarity degree calculation apparatus, thereby calculating the target ciphertext (encrypted feature vector C') obtained by transforming the target data by the encryption transformation using the public key.</p><p id="p0349" num="0349">In the similarity degree calculation system (biometric authentication system 100; or image search system 110) described above,<br/>
each of the comparison data (feature vector b) and the target data (feature vector b') is a T-dimensional vector (T being an integer not less than 1) having each component (b<sub>i</sub> or b'<sub>i</sub>) of an integer.<br/>
Using the processing device (911) of the similarity degree calculation apparatus (authentication apparatus 102; or search apparatus 112), the temporary secret key generation unit (random number generation unit 303, and encrypted random number generation unit 304) of the similarity degree calculation apparatusgenerates the temporary public key (first challenge R)<!-- EPO <DP n="238"> --> including encrypted information on the comparison data, based on the comparison ciphertext (encrypted feature vector C) stored by the comparison ciphertext storage unit (encrypted data storage unit 312) of the similarity degree calculation apparatus.<br/>
Using the processing device (911) of the encryption apparatus (certification apparatus 101; or terminal apparatus 111), the target dual encryption text calculation unit (encrypted data embedding unit 217) of the encryption apparatuscalculates the target dual encryption text (first response R') including encrypted information on the product of the component of the target data and the corresponding component of the comparison data, by the second encryption transformation using the temporary public key.</p><p id="p0350" num="0350">In the similarity degree calculation system (biometric authentication system 100; or image search system 110) described above,<br/>
the encryption transformation is transformation for transforming an integer (integer not less than 0 and less than q; or integer not less than 0 and less than N) into a cirphertext (vector in the vector space V; element of the finite group G; or integer not less than 0 and less than N<sup>2</sup>). An arithmetic operation (addition in the vector space V; multiplication on the finite group G; or multiplication of integers modulo N<sup>2</sup>) for combining and transforming a plurality of ciphertexts into a different ciphertext may be performed for the ciphertext, and a ciphertext obtained by combining a ciphertext (E(x1)) resulting from transformation of an arbitrary first integer (x1) and a ciphertext resulting from transformation of an arbitrary second integer (x2) by the arithmetic operation for the ciphertext is a ciphertext (E(x1 + x2)) resulting from transformation of a sum (x1 + x2) of the first integer and the second<!-- EPO <DP n="239"> --> integer.<br/>
The target data (feature vector b') is a T-dimensional vector (T being an integer not less than 1) having components of integers.<br/>
The similarity degree calculation apparatus (authentication apparatus 102; or search apparatus 112) further includes a public key storage unit (302).<br/>
Using the storage device (914) of the similarity degree calculation apparatus, the public key storage unit of the similarity degree calculation apparatus stores the public key (pk) corresponding to the secret key (sk) stored by the decryption apparatus (103).<br/>
Using the processing device (911) of the similarity degree calculation apparatus, the temporary public key generation unit (random number generation unit 303; and encrypted random number generation unit 304) of the similarity degree calculation apparatus randomly generates a T-dimensional vector having a component of an integer (R<sub>1, i</sub>), and sets the generated T-dimensional vector to the temporary secret key, and calculates a T-dimensional vector having a component of a ciphertext (R<sub>i</sub>) obtained by transforming each component of the temporary secret key by the encryption transformation using the public key, based on the public key stored by the public key storage unit of the similarity degree calculation apparatus and the generated temporary secret key, and sets the calculated T-dimensional vector to the temporary public key (first challenge R).<br/>
Using the processing device (911) of the encryption apparatus, the target dual encryption text calculation unit (encrypted data embedding unit 217) of the encryption apparatus (certification apparatus 101; or terminal apparatus 111) randomly generates a T-dimensional vector having a<!-- EPO <DP n="240"> --> component of a ciphertext (o<sub>i</sub>) obtained by transforming 0 by the encryption transformation using the public key, based on the public key stored by the public key storage unit (212) of the encryption apparatus, and sets the generated T-dimensional vector to a zero ciphertext (encrypted zero vector O), and calculates a T-dimensional vector having a component of a cirphetext obtained by combining b'<sub>i</sub> pieces of each component of the temporary public key (b'<sub>i</sub> being the integer indicating the corresponding component of the target data) and the corresponding component of the zero ciphertext by the arithmetic operation for the ciphertext, based on the target data acquired by the target data acquisition unit (feature vector formation unit 214) of the encryption apparatus, the temporary public key acquired by the temporary public key acquisition unit (first challenge receiving unit 211) of the encryption apparatus, and the generated zero ciphertext, and sets the calculated T-dimensional vector to the target dual encryption text (first response R').<br/>
The target ciphertext acquisition unit (encrypted data extraction unit 305) of the similarity degree calculation apparatus includes a temporary decryption key calculation unit (inverse number calculation unit 351) and a target ciphertext calculation unit (scalar multiplication calculation unit 352).<br/>
Using the processing device of the similarity degree calculation apparatus, the temporary decryption key calculation unit of the similarity degree calculation apparatus calculates a T-dimensional vector having a component of an inverse number (κ<sub>i</sub>) of each component of the temporary secret key, based on the temporary secret key generated by the temporary secret key generation unit of the similarity degree calculation apparatus, and<!-- EPO <DP n="241"> --> sets the calculated T-dimensional vector to a temporary decryption key.<br/>
Using the processing device of the similarity degree calculation apparatus, the target ciphertext calculation unit of the similarity degree calculation apparatus calculates a T-dimensional vector having a component of a ciphertext obtained by combining R<sub>i</sub><sup>-1</sup> pieces of each component (R'<sub>i</sub>) of the target dual encryption text (R<sub>i</sub><sup>-1</sup> being the inverse number indicating the corresponding component of the temporary decryption key), based on the target dual encryption text acquired by the target dual encryption text acquisition unit (first response receiving unit 331) of the similarity degree calculation apparatus and the temporary decryption key calculated by the temporary decryption key calculation unit of the similarity degree calculation apparatus, and sets the calculated T-dimensional vector to the target ciphertext (encrypted feature vector C').</p><p id="p0351" num="0351">In the similarity degree calculation system (biometric authentication system 100; or image search system 110),<br/>
the encryption transformation is transformation for transforming an integer (integer not less than 0 and less than q; or integer not less than 0 and less than N) into a cirphertext (vector in the vector space V; element of the finite group G; or integer not less than 0 and less than N<sup>2</sup>). An arithmetic operation (addition in the vector space V; multiplication on the finite group G; or multiplication of integers modulo N<sup>2</sup>) for combining and transforming a plurality of ciphertexts into a different ciphertext may be performed for the ciphertext. A ciphertext obtained by combining a ciphertext (E(x1)) resulting from transformation of an arbitrary first integer (x1) and a ciphertext (E(x2)) resulting from transformation of an arbitrary second integer (x2) using<!-- EPO <DP n="242"> --> the arithmetic operation for the ciphertext is a ciphertext (E(x1 + x2)) resulting from transformation of a sum (x1 + x2) of the first integer and the second integer.<br/>
Each of the comparison data (feature vector b) and the target data (feature vector b') is a T-dimensional vector (T being an integer not less than 1) having each component (b<sub>i</sub>, b'<sub>i</sub>) of an integer.<br/>
The comparison ciphertext (encrypted feature vector C) is a T-dimensional vector having a component of a ciphertext (c<sub>i</sub>) obtained by transforming each component of the comparison data by the encryption transformation using the public key (pk).<br/>
The similarity degree calculation apparatus (authentication apparatus 102; or search apparatus 112) further includes a public key storage unit (302).<br/>
Using the storage device (914) of the similarity degree calculation apparatus, the public key storage unit of the similarity degree calculation apparatus stores the public key (pk) corresponding to the secret key (sk) stored by the decryption apparatus (103).<br/>
Using the processing device (911) of the similarity degree calculation apparatus, the temporary public key generation unit (random number generation unit 303; and encrypted random number generation unit 304) of the similarity degree calculation apparatus randomly generates a T-dimensional vector having a componens of an integer (R<sub>1</sub>, <sub>i</sub>), and sets the generated T-dimensional vector to the temporary secret key, and randomly generates a T-dimensional vector having a component of a ciphertext (o'<sub>i</sub>) obtained by transforming 0 by the encryption transformation using the public key and sets the calculated T-dimensional vector to a zero ciphertext (encrypted zero<!-- EPO <DP n="243"> --> vector O'), based on the public key stored by the public key storage unit of the similarity degree calculation apparatus, and calculates a T-dimensional vector having a component of a ciphertext obtained by combining R<sub>i</sub> pieces of each component of the comparison ciphertext (R<sub>i</sub> being an integer indicating a corresponding component of the temporary secret key) and the corresponding component of the zero ciphertext, based on the comparison ciphertext stored by the comparison ciphertext storage unit (encrypted data storage unit 312) of the similarity degree calculation apparatus, the generated temporary secret key, and the generated zero ciphertext, and sets the generated T-dimensional vector to the temporary public key (first challenge R).<br/>
Using the processing device (911) of the encryption apparatus(certification apparatus 101; or terminal apparatus 111), the target dual encryption text calculation unit (encrypted data embedding unit 217) of the encryption apparatus randomly generates a T-dimensional vector having a component of a ciphertext (o<sub>i</sub>) obtained by transforming 0 by the encryption transformation using the public key, based on the public key stored by the public key storage unit (212) of the encryption apparatus, and set the generated T-dimensional vector to a zero ciphertext (encrypted zero vector O), and then calculates a T-dimensional vector having a component of a cirphetext obtained by combining b'<sub>i</sub> pieces of each component of the temporary public key (b'<sub>i</sub> being the integer indicating the corresponding component of the target data) and the corresponding component of the zero ciphertext by the arithmetic operation for the ciphertext, based on the target data acquired by the target data acquisition unit (feature vector formation unit 214) of the encryption apparatus, the temporary public key acquired by the temporary<!-- EPO <DP n="244"> --> public key acquisition unit (first challenge receiving unit 211) of the encryption apparatus, and the generated zero ciphertext, and sets the calculated T-dimensional vector to the target dual encryption text (first response R').<br/>
The target ciphertext acquisition unit (encrypted data extraction unit 305) of the similarity degree calculation apparatus includes a temporary decryption key calculation unit (inverse number calculation unit 351) and a target ciphertext calculation unit (exponentiation calculation unit 353).<br/>
Using the processing device of the similarity degree calculation apparatus, the temporary decryption key calculation unit of the similarity degree calculation apparatus calculates a T-dimensional vector having a component of an inverse number (κ<sub>i</sub>) of each component of the temporary secret key, based on the temporary secret key generated by the temporary secret key generation unit of the similarity degree calculation apparatus, and sets the calculated T-dimensional vector to a temporary decryption key.<br/>
Using the processing device of the similarity degree calculation apparatus, the target ciphertext calculation unit of the similarity degree calculation apparatus calculates a T-dimensional vector having a component of a ciphertext obtained by combining R<sub>i</sub><sup>-1</sup> pieces of each component of the target dual encryption text (R<sub>i</sub><sup>-1</sup> being the inverse number indicating the corresponding component of the temporary decryption key) by the arithmetic operation for the ciphertext, based on the target dual encryption text acquired by the target dual encryption text acquisition unit (first challenge transmitting unit 311) of the similarity degree calculation apparatus and the temporary decryption key calculated by the temporary decryption key calculation unit of<!-- EPO <DP n="245"> --> the similarity degree calculation apparatus, and sets the calculated T-dimensional vector to the target ciphertext (encrypted feature vector C').</p><p id="p0352" num="0352">In the similarity degree calculation system (biometric authentication system 100; or image search system 110) described above,<br/>
The interim similarity degree ciphertext calculation unit (encrypted random similarity degree calculation unit 314) of the similarity degree calculation apparatus (authentication apparatus 102; or search apparatus 112) includes a random number plaintext generation unit (encryption key generation unit 366) and a ciphertext calculation unit (integer combining unit 386).<br/>
Using the processing device (911) of the similarity degree calculation apparatus, the random number plaintext generation unit of the similarity degree calculation apparatus randomly generates a T-dimensional vector having a component of an integer (t<sub>1, i</sub>) and sets the generated T-dimensional vector to a random number plaintext (disturbance vector T).<br/>
Using the processing device of the similarity degree calculation apparatus, the temporary key generation unit (random number storage unit 322) of the similarity degree calculation apparatus calculates a summation (∑<sub>i</sub>[t<sub>l1, i</sub>]) of components of the random number plaintext generated by the random number generation unit of the similarity degree calculation apparatus, and sets the calculated summation to the temporary key.<br/>
Using the processing device of the similarity degree calculation apparatus, the ciphertext calculation unit of the similarity degree calculation apparatus calculates a T-dimensional vector having a component of a ciphertext obtained by combining each component of the target ciphertext and<!-- EPO <DP n="246"> --> the corresponding component of the random number plaintext by the arithmetic operation for the ciphertext, based on the target ciphertext (encrypted feature vector C') acquired by the target ciphertext acquisition unit (encrypted data extraction unit 305) of the similarity degree calculation apparatus and the random number plaintext generated by the random number plaintext generation unit of the similarity degree calculation apparatus, and sets the calculated T-dimensional vector to the interim similarity degree ciphertext (second challenge C^).</p><p id="p0353" num="0353">In the similarity degree calculation system (biometric authentication system 100; or image search system 110) described above,<br/>
using the processing device (911) of the similarity degree calculation apparatus (authentication apparatus 102; or search apparatus 112), the temporary key generation unit (random number generation unit 303) of the similarity degree calculation apparatus randomly generates an integer (s<sub>1</sub>), and sets the generated integer to the temporary key.<br/>
The interim similarity degree ciphertext calculation unit (encrypted random similarity degree calculation unit 314) of the similarity degree calculation apparatus includes a first ciphertext calculation unit (rearrangement unit 385) and a second ciphertext calculation unit (encryption key generation unit 366).<br/>
Using the processing device of the similarity degree calculation apparatus, the first ciphertext calculation unit of the similarity degree calculation apparatus calculates a T-dimensional vector with asequence of the components of the target ciphertext (encrypted feature vector C') randomly rearranged, based on the target ciphertext acquired by the target<!-- EPO <DP n="247"> --> ciphertext acquisition unit (encrypted data extraction unit 305) of the similarity degree calculation apparatus, and sets the calculated T-dimensional vector to a first interim similarity degree ciphertext.<br/>
Using the processing device of the similarity degree calculation apparatus, the second ciphertext calculation unit of the similarity degree calculation apparatus calculates a ciphertext obtained by transforming the temporary key by the encryption transformation using the public key, based on the public key (pk) stored by the public key storage unit (302) of the similarity degree calculation apparatus and the temporary key generated by the temporary key generation unit of the similarity degree calculation apparatus, and sets the calculated ciphertext to a second interim similarity degree ciphertext.<br/>
Using the processing device of the similarity degree calculation apparatus, the interim similarity degree ciphertext notification unit (second challenge transmitting unit 321) of the similarity degree calculation apparatus notifies the first interim similarity degree ciphertext calculated by the first ciphertext calculation unit of the similarity degree calculation apparatus and the second interim similarity degree ciphertext calculated by the second ciphertext calculation unit of the similarity degree calculation apparatus to the decryption apparatus (103).</p><p id="p0354" num="0354">In the similarity degree calculation system (biometric authentication system 100; or image search system 110) described above,<br/>
using the processing device (911) of the decryption apparatus, the interim similarity degree decrypted text calculation unit (decryption unit 404) of the decryption apparatus (103) calculates a difference or a sum between the<!-- EPO <DP n="248"> --> summation of the integers obtained by decrypting the T components of the first interim similarity degree ciphertext and the integer obtained by decrypting the second interim similarity degree ciphertext, or calculates an element obtained by combining z pieces of predetermined elements in a predetermined finite group (z being is the difference or the sum between the summation of the integers obtained by decrypting the T components of the first interim similarity degree ciphertext and the integer obtained by decrypting the second interim similarity degree ciphertext) by a group arithmetic operation on the predetermined finite group, and sets the calculated difference or the calculated sum or the calculated element to the interim similarity degree decrypted text (second response Z).</p><p id="p0355" num="0355">In the similarity degree calculation system (biometric authentication system 100; or image search system 110) described above,<br/>
using the processing device (911) of the similarity degree calculation apparatus (authentication apparatus 102; or search apparatus 112), the temporary key generation unit (random number generation unit 303) of the similarity degree calculation apparatusrandomly generates an integer (s<sub>1</sub>), and sets the generated integer to the temporal key.<br/>
Using the processing device of the similarity degree calculation apparatus, the interim similarity degree ciphertxt calculation unit (encrypted random similarity degree calculation unit 314) of the similarity degree calculation apparatus calculates a ciphertext by combining a ciphertext obtained by transformation of the temporary key by the encryption transformation using the public key (pk) and the T components of the target ciphertext by the encryption transformation using the public key, using the<!-- EPO <DP n="249"> --> arithmetic operation for the ciphertext, based on the public key stored by the public key storage unit (302) of the encryption apparatus, the target ciphertext (encrypted feature vector C') acquired by the target ciphertext acquisition unit (encrypted data extraction unit 305) of the similarity degree calculation apparatus, and the temporary key generated by the temporary key generation unit of the similarity degree calculation apparatus, and sets the calculated ciphertext to the interim similarity degree ciphertext (second challenge C^).</p><p id="p0356" num="0356">In the similarity degree calculation system (biometric authentication system 100; or image search system 110) described above,<br/>
using the processing device (911) of the decryption apparatus (103), the interim similarity degree decrypted text calculation unit (decryption unit 404) of the decryption apparatus calculates an integer obtained by decrypting the interim similarity degree ciphertext (second challenge C^), or calculates an element by combining z pieces of predetermined elements (z being the integer obtained by decrypting the interim similarity degree ciphertext) in a predetermined finite group by a group arithmetic operation on the predetermined finite group, based on the interim similarity degree ciphertext acquired by the interim similarity degree ciphertext acquisition unit (second challenge receiving unit 402) of the decryption apparatus, and sets the calculated integer or the calculated element to the interim similarity degree decrypted text (second response Z).</p><p id="p0357" num="0357">In the similarity degree calculation system (biometric authentication system 100; or image search system 110) described above,<br/>
the interim similarity degree decrypted text (second response Z) is an integer.<br/>
<!-- EPO <DP n="250"> -->Using the processing device (911) of the similarity degree calculation apparatus (authentication apparatus 102; or search apparatus 112), the temporary key generation unit (random number generation unit 303) of the similarity degree calculation apparatus randomly generates an integer (u<sub>1</sub>; or s<sub>1</sub>), and sets the generated integer to the temporary key.<br/>
Using the processing device of the similarity degree calculation apparatus, the similarity degree calculation unit (plaintext similarity degree extraction unit 315) of the similarity degree calculation apparatus calculates a sum or a difference between the temporary key and the interim similarity degree decrypted text, based on the temporary key generated by the temporary key generation unit of the similarity degree calculation apparatus and the interim similarity degree decrypted text acquired by the interim similarity degree decrypted text acquisition unit (second response receiving unit 341) of the similarity degree calculation apparatus, and sets the calculated sum or the calculated difference to the similarity degree (d).</p><p id="p0358" num="0358">In the similarity degree calculation system (biometric authentication system 100; or image search system 110) described above,<br/>
the interim similarity degree decrypted text is an element in a predetermined finite group (G<sub>T</sub>).<br/>
Using the processing device (911) of the similarity degree calculation apparatus, the temporary key generation unit (random number generation unit 303) of the similarity degree calculation apparatus randomly generates an integer (u<sub>1</sub>; or s<sub>1</sub>), and sets the generated integer to the temporary key.<br/>
The similarity degree calculation unit (plaintext similarity degree extraction unit 315) of the similarity degree calculation apparatus includes a<!-- EPO <DP n="251"> --> similarity degree decrypted text calculation unit (element combining unit 372) and a discrete logarithm calculation unit (373).<br/>
Using the processing device of the similarity degree calculation apparatus, the similarity degree decrypted text calculation unit of the similarity degree calculation apparatus calculates an element by combining the interim similarity degree decrypted text and u pieces of predetermined elements (e(b<sub>1</sub>, b<sub>1</sub>); or π) (u being the integer that is the temporary key) in the predetermined finite group by a group arithmetic operation on the predetermined finite group, based on the temporary key generated by the temporary key generation unit of the similarity degree calculation apparatus and the interim similarity degree decrypted text acquired by the interim similarity degree decrypted text acquisition unit (second response receiving unit 341) of the similarity degree calculation apparatus, and sets the calculated element to a similarity degree decrypted text (decrypted similarity degree element Z').<br/>
Using the processing device of the similarity degree calculation apparatus, the discrete logarithm calculation unit of the similarity degree calculation apparatus calculates a number of the predetermined elements to be combined to be equal to the similarity degree decrypted text, by the group arithmetic operation on the predetermined finite group, based on the similarity degree decrypted text calculated by the similarity degree decrypted text of the similarity degree calculation apparatus, and sets the calculated number of the predetermine elements to the similarity degree (d).</p><p id="p0359" num="0359">In the similarity degree calculation system (biometric authentication system 100; or image search system 110) described above,<br/>
<!-- EPO <DP n="252"> -->using the processing device (911) of the similarity degree calculation apparatus (authentication apparatus 102; or search apparatus 112), the discrete logarithm calculation unit (373) of the similarity degree calculation apparatuscalculates the similarity degree (d) when the similarity degree is an integer within a predetermined range, and determines that the similarity degree is outside the predetermined range when the similarity degree is outside the predetermined range.</p><p id="p0360" num="0360">The similarity degree calculation system (biometric authentication system 100; or image search system 110) described above further includes a registration apparatus (104).<br/>
The registration apparatus includes a storage device (914) that stores data, a processing device (911) that processes the data, a public key storage unit (202), a comparison data acquisition unit (feature vector formation unit 204), a comparison ciphertext calculation unit (encrypted data generation unit 206), and a comparison ciphertext notification unit (encrypted data transmitting unit 201).<br/>
Using the storage device of the registration apparatus, the public key storage unit of the registration apparatus stores the public key (pk) corresponding to the secret key (sk) stored by the decryption apparatus (103).<br/>
Using the processing device of the registration apparatus, the comparison data acquisition unit of the registration apparatus acquires the comparison data.<br/>
Using the processing device of the registration apparatus, the comparison ciphertext calculation unit of the registration apparatus transforms the comparison data by the encryption transformation using the public key,<!-- EPO <DP n="253"> --> thereby calculating the comparison ciphertext (encrypted feature vector C), based on the public key stored by the public key storage unit of the registration apparatus and the comparison data acquired by the comparison data acquisition unit of the registration apparatus.<br/>
Using the processing device of the registration apparatus, the comparison ciphertext notification unit of the registration apparatus notifies the comparison ciphertext calculated by the comparison ciphertext calculation unit of the registration apparatus to the similarity degree calculation apparatus (authentication apparatus 102; or search apparatus 112).<br/>
The similarity degree calculation apparatus' further includes a comparison ciphertext acquisition unit (encrypted data receiving unit 301).<br/>
Using the processing device (911) of the similarity degree calculation apparatus, the comparison ciphertext acquisition unit of the similarity degree calculation apparatus acquires the comparison ciphertext notified from the registration apparatus.<br/>
Using the storage device (914) of the similarity degree calculation apparatus, the comparison ciphertext storage unit (encrypted data storage unit 312) of the similarity degree calculation apparatus stores the comparison ciphertext acquired by the comparison ciphertext acquisition unit of the similarity degree calculation apparatus.</p><p id="p0361" num="0361">According to the similarity degree calculation apparatus, the similarity degree calculation system, the computer program, and the similarity degree calculation method described above, a similarity degree between data may be calculated with the data kept encrypted, and leakage of information on the original data and leakage of information to be used for spoofing during the<!-- EPO <DP n="254"> --> course of the calculation of the similarity degree may also be prevented.</p><heading id="h0022">[Description of Reference Signs]</heading><p id="p0362" num="0362">100: biometric authentication system, 101: certification apparatus, 102: authentication apparatus, 103: decryption apparatus, 104: registration apparatus, 110: image search system, 111: terminal apparatus, 112: search apparatus, 201, 222: encrypted data transmitting unit, 202, 212, 302, 403: public key storage unit, 203, 213: biometric information extraction unit, 204, 214: feature vector formation unit, 205, 215, 303: random number generation unit, 206, 216: encrypted data generation unit, 208, 218, 308: public key receiving unit, 209, 219: image input unit, 211: first challenge receiving unit, 217: encrypted data embedding unit, 221: first response transmitting unit, 223: result receiving unit, 224: result outputting unit, 226: image encryption unit, 228: encrypted image transmitting unit, 231, 352, 364: scalar multiplication calculation unit, 232, 332: zero generation unit, 233, 363: vector combining unit, 234, 353, 384, 334: exponentiation calculation unit, 235, 370, 372, 475: element combining unit, 236, 336, 386, 485: integer combining unit, 301, 325: encrypted data receiving unit, 304: encrypted random number generation unit, 305: encrypted data extraction unit, 306: determination unit, 311: first challenge transmitting unit, 312: encrypted data storage unit, 314: encrypted random similarity degree calculation unit, 315: plaintext similarity degree extraction unit, 321: second challenge transmitting unit, 322: random number storage unit, 323: result transmitting unit, 331: first response receiving unit, 341: second response receiving unit, 351: inverse number calculation unit, 361: difference calculation unit, 362: disturbance vector generation unit, 365: square summation calculation unit, 366:<!-- EPO <DP n="255"> --> encryption key generation unit, 367: vector summation unit, 368, 381, 382, 473: square calculation unit, 371, 474: group conversion unit, 373: discrete logarithm calculation unit, 383: product calculation unit, 385: rearrangement unit, 401: key generation unit, 402: second challenge receiving unit, 404: decryption unit, 408: public key transmitting unit, 412: second response transmitting unit, 413: secret key storage unit, 421, 431: group determination unit, 422: canonical base setting unit, 423: random number generation unit, 424: determinant calculation unit, 425: regular matrix setting unit, 426: random base calculation unit, 432: generator element selection unit, 433: generator element exponentiation unit, 434: base calculation unit, 441: prime number determination unit, 442: product calculation unit, 443: common multiple calculation unit, 471: inverse matrix calculation unit, 472: vector decomposition unit, 481: inverse number calculation unit, 482: decrypted integer calculation unit, 911: processing device, 912: input device, 913: output device, 914: storage device, A: canonical base, B: random base, b, b': feature vector, C, C': encrypted feature vector, C^: second challenge, ΔC: encrypted difference vector, ΔC': encrypted square vector, d: similarity degree, d<sub>0</sub>: threshold value, Fq: finite field, G, G<sub>T</sub>: finite group, g: generator element, O, O': encrypted zero vector, pk: public key, R: first challenge, R': first response, <img id="ib0227" file="imgb0227.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/> vector, <img id="ib0228" file="imgb0228.tif" wi="6" he="4" img-content="character" img-format="tif" inline="yes"/> exponentiation vector, S500: setup process, S501: key generation step, S502: public key notification step, S503, S504, S505: public key acquisition step, S511, S521: group determination step, S512: canonical base setting step, S513: matrix generation step, S514: regular matrix determination step, S515: random base calculation step, S522: generator element selection step, S523: generator element exponentiation step, S524:<!-- EPO <DP n="256"> --> base calculation step, S531: prime number determination step, S532, S754: product calculation step, S533: common multiple calculation step, S540: vector decomposition process, S541, S561: inverse matrix calculation step, S542: first initialization step, S543: first repetition step, S544: second initialization step, S545: second repetition step, S546: third initialization step, S547: third repetition step, S548: factor summation step, S549: map calculation step, S550: scalar multiplication step, S551, S747, S751: vector summation step, S560, S610, S660, S729, S730, S740: initialization step, S561a, S690, S732: inverse number calculation step, S562, S611, S661, S721, S731, S741: repetition step, S563, S566: vector decomposition step, S563a, S566a: decrypted integer calculation step, S564, 5753: square calculation step, S565, S665a, S692: element combining step, S565a, S665b, S692a, S726, S760: integer combining step, S567, S691: group conversion step, S571, S662a, S724, S733a, S752a, S755: exponentiation calculation step, S600: registration process, S601, S705: biometric information extraction step, S602, S706: feature vector generation step, S603: feature vector encryption step, S604: encrypted biometric information notification step, S605: encrypted biometric information acquisition step, S612, S663, S722, S743, S749, S757, S758: random number generation step, S613, S723: vector calculation step, S613a, S723a: element calculation step, S613b, S723b: integer calculation step, S662, S733, S746: scalar multiplication step, S664, S725: zero generation step, S665, S745: vector combining step, S693: discrete logarithm calculation step, S700: authentication process, S701: first challenge generation step, S702, S713: random number storage step, S703: first challenge notification step, S704: first challenge acquisition step, S707: first<!-- EPO <DP n="257"> --> response generation step, S708: first response notification step, S709: first response acquisition step, S710: encrypted biometric information extraction step, S711: encrypted biometric information reading step, S712: second challenge generation step, S714: second challenge notification step, S715: second challenge acquisition step, S716: second response generation step, S717: second response notification step, S718: second response acquisition step, S719: plaintext similarity degree calculation step, S720: authentication determination step, S742, S742a, S742b: difference calculation step, S744: disturbance vector generation step, S748: square summation step, S748a: element summation step, S750: encryption key generation step, S752: encryption key generation step, S759: second challenge setting step, sk: secret key, T: disturbance vector, <img id="ib0229" file="imgb0229.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> decryption key, <img id="ib0230" file="imgb0229.tif" wi="6" he="5" img-content="character" img-format="tif" inline="yes"/> encryption key,<img id="ib0231" file="imgb0131.tif" wi="5" he="4" img-content="character" img-format="tif" inline="yes"/><img id="ib0232" file="imgb0232.tif" wi="7" he="4" img-content="character" img-format="tif" inline="yes"/> exponentiation element, V: vector space, III: inverse element, X: regular matrix, X<sup>-1</sup>: inverse matrix, Z: second response, Z': decrypted similarity degree element, <img id="ib0233" file="imgb0233.tif" wi="7" he="4" img-content="character" img-format="tif" inline="yes"/> first encrypted square vector, <img id="ib0234" file="imgb0234.tif" wi="7" he="4" img-content="character" img-format="tif" inline="yes"/> second encrypted square vector</p></description><claims mxw-id="PCLM56976216" lang="EN" load-source="patent-office"><!-- EPO <DP n="258"> --><claim id="c-en-0001" num="0001"><claim-text>A similarity degree calculation apparatus that calculates a similarity degree between comparison data and target data, the similarity degree calculation apparatus including:
<claim-text>a storage device that stores data, a processing device that processes the data, a comparison ciphertext storage unit, a target ciphertext acquisition unit, a temporary key generation unit, an interim similarity degree ciphertext calculation unit, an interim similarity degree ciphertext notification unit, an interim similarity degree decrypted text acquisition unit, and a similarity degree calculation unit;</claim-text>
<claim-text>using the storage device, the comparison ciphertext storage unit storing a comparison ciphertext obtained by transforming the comparison data by encryption transformation using a public key corresponding to a secret key stored by a decryption apparatus;</claim-text>
<claim-text>using the processing device, the target ciphertext acquisition unit acquiring a target ciphertext obtained by transforming the target data by the encryption transformation using the public key;</claim-text>
<claim-text>using the processing device, the temporary key generation unit generating a temporary key;</claim-text>
<claim-text>using the processing device, based on the comparison ciphertext stored by the comparison ciphertext storage unit, the target ciphertext acquired by the target ciphertext acquisition unit, and the temporary key generated by the temporary key generation unit, the interim similarity degree ciphertext calculation unit performing calculation for calculating the similarity degree in a first stage with the comparison cirphertext and the target<!-- EPO <DP n="259"> --> ciphertext kept encrypted, and calculating an interim similarity degree ciphertext by encrypting a result of the calculation with the temporary key;</claim-text>
<claim-text>using the processing device, the interim similarity degree ciphertext notification unit notifying to the decryption apparatus the interim similarity degree ciphertext calculated by the interim similarity degree ciphertext calculation unit;</claim-text>
<claim-text>using the processing device, the interim similarity degree decrypted text acquisition unit acquiring an interim similarity degree decrypted text calculated and notified by the decryption apparatus, based on the interim similarity degree ciphertext notified by the interim similarity degree ciphertext notification unit; and</claim-text>
<claim-text>using the processing device, the similarity degree calculation unit decrypting the interim similarity degree decrypted text with the temporary key, based on the temporary key generated by the temporary key generation unit and the interim similarity degree decrypted text acquired by the interim similarity degree decrypted text acquisition unit, thereby calculating the similarity degree between the comparison data and the target data.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The similarity degree calculation apparatus according to claim 1, wherein<br/>
the similarity degree calculation apparatus further includes a temporary secret key generation unit and a target dual encryption text acquisition unit;<br/>
using the processing device, the temporary key generation unit generates a temporary secret key and a temporary public key corresponding to<!-- EPO <DP n="260"> --> the temporary secret key;<br/>
using the processing device, the target dual encryption text acquisition unit acquires a target dual encryption text encrypted with the temporary public key generated by the temporary secret key generation unit; and<br/>
using the processing device, the target ciphertext acquisition unit decrypts the target dual encryption text with the temporary secret key, based on the temporary secret key stored by the temporary secret key storage unit and the target dual encryption text acquired by the target dual encryption text acquisition unit, thereby acquiring the target ciphertext obtained by transforming the target data by the encryption transformation using the public key.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>A similarity degree calculation system including the similarity degree calculation apparatus according to claim 1 and a decryption apparatus, wherein<br/>
the decryption apparatus includes a storage unit that stores data, a processing device that processes the data, a secret key storage unit, an interim similarity degree ciphertext acquisition unit, an interim similarity degree decrypted text calculation unit, and an interim similarity degree decrypted text notification unit;<br/>
using the storage device of the decryption apparatus, the secret key storage unit of the decryption apparatus stores the secret key;<br/>
using the processing device of the decryption apparatus, the interim similarity degree ciphertext acquisition unit of the decryption apparatus<!-- EPO <DP n="261"> --> acquires the interim similarity degree ciphertext notified from the similarity degree calculation apparatus;<br/>
using the processing device of the decryption apparatus, the interim similarity degree decrypted text calculation unit of the decryption apparatus decrypts the interim similarity degree ciphertext with the secret key, based on the secret key stored by the secret key storage unit of the decryption apparatus and the interim similarity degree ciphertext acquired by the interim similarity degree ciphertext acquisition unit of the decryption apparatus, and performs calculation for calculating the similarity degree in a second stage with a result of the decryption kept encrypted with the temporary key, thereby calculating the interim similarity degree decrypted text; and<br/>
using the processing device of the decryption apparatus, the interim similarity degree decrypted text notification unit of the decryption apparatus notifies the interim similarity degree decrypted text calculated by the interim similarity degree decrypted text calculation unit of the decryption apparatus to the similarity degree calculation apparatus.</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>The similarity degree calculation system according to claim 3, wherein<br/>
each of the comparison data and the target data is a T-dimensional vector (T being an integer not less than 1) having components of integers;<br/>
using the processing device of the similarity degree calculation apparatus, the interim similarity degree ciphertext calculation unit of the similarity degree calculation apparatus calculates a difference or a product of the corresponding components of the comparison data and the target data,<!-- EPO <DP n="262"> --> with the comparison ciphertext and the target ciphertext kept encrypted;<br/>
using the processing device of the decryption apparatus, the interim similarity degree ciphertext calculation unit of the decryption apparatus decrypts the interim similarity degree ciphertext with the secret key, and calculates the similarity degree, with the result of the decryption kept encrypted with the temporary key; and<br/>
using the processing device of the similarity degree calculation apparatus, the similarity degree calculation unit of the similarity degree calculation apparatus decrypts the interim similarity degree decrypted text, thereby obtaining the similarity degree.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>The similarity degree calculation system according to claim 3, wherein<br/>
the encryption transformation is transformation for transforming an integer into a ciphertext, an arithmetic operation for combining and transforming a plurality of ciphertexts into a different ciphertext may be calculated for the ciphertext, and a ciphertext obtained by combining a ciphertext resulting from transformation of an arbitrary first integer and a ciphertext resulting from transformation of an arbitrary second integer by the arithmetic operation for the ciphertext is a ciphertext resulting from transformation of a sum of the first integer and the second integer.</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>The similarity degree calculation system according to claim 5, wherein<br/>
each of the comparison data and the target data is a T-dimensional<!-- EPO <DP n="263"> --> vector (T being an integer not less than 1) having each component of an integer;<br/>
the comparison ciphertext is a T-dimensional vector having a component of a ciphertext obtained by transforming each component of the comparison data by the encryption transformation using the public key;<br/>
the target ciphertext is a T-dimensional vector having a component of a ciphertext obtained by transforming each component of the target data by the encryption transformation using the public key;<br/>
the similarity degree calculation apparatus further includes a public key storage unit;<br/>
using the storage device of the similarity degree calculation apparatus, the public key storage unit of the similarity degree calculation apparatus stores a public key corresponding to the secret key stored by the decryption apparatus;<br/>
using the processing device of the similarity degree calculation apparatus, the temporary key generation unit of the similarity degree calculation apparatus randomly generates an integer, and sets the generated integer to the temporary key;<br/>
the interim similarity degree ciphertext calculation unit of the similarity degree calculation apparatus includes a random number plaintext generation unit, a first ciphertext calculation unit, and a second ciphertext calculation unit;<br/>
using the processing device of the similarity degree calculation apparatus, the random number plaintext generation unit of the similarity degree calculation apparatus randomly generates a T-dimensional vector<!-- EPO <DP n="264"> --> having a component of an integer, and sets the generated T-dimensional vector to a random number plaintext;<br/>
using the processing device of the similarity degree calculation apparatus, the first ciphertext calculation unit of the similarity degree calculation apparatus calculates a first interim similarity degree ciphertext using the arithmetic operation for the ciphertext, based on the comparison ciphertext stored by the comparison ciphertext storage unit of the similarity degree calculation apparatus, the target ciphertext acquired by the target ciphertext acquisition unit of the similarity degree calculation apparatus, and the random number plaintext generated by the random number plaintext generation unit of the similarity degree calculation apparatus, the first interim similarity degree ciphertext being a T-dimensional vector having a component of a ciphertext obtained by transforming a sum of a difference between each component of the comparison data and the corresponding component of the target data and the corresponding component of the random number plaintext by the encryption transformation using the public key;<br/>
using the processing device of the similarity degree calculation apparatus, the second ciphertext calculation unit of the similarity degree calculation apparatus calculates a second interim similarity degree ciphertext using the arithmetic operation for the ciphertext, based on the comparison ciphertext stored by the comparison ciphertext storage unit of the similarity degree calculation apparatus, the target ciphertext acquired by the target ciphertext acquisition unit of the similarity degree calculation apparatus, the temporary key generated by the temporary key generation unit of the similarity degree calculation apparatus, and the random number plaintext<!-- EPO <DP n="265"> --> generated by the random number plaintext generation unit of the similarity degree calculation apparatus, the second interim similarity degree ciphertext being a ciphertext obtained by transforming a sum of a correction value and the temporary key by the encryption transformation using the public key, the correction value being an integer obtained by summating, for all of the components, sums of squares of the respective components of the random number plaintext and twice products of the corresponding components of the random number plaintext and differences between the respective components of the comparison data and the corresponding components of the target data; and<br/>
using the processing device of the similarity degree calculation apparatus, the interim similarity degree ciphertext notification unit of the similarity degree calculation apparatus notifies the first interim similarity degree ciphertext calculated by the first ciphertext calculation unit of the similarity degree calculation apparatus and the second interim similarity degree ciphertext calculated by the second ciphertext calculation unit of the similarity degree calculation apparatus to the decryption apparatus.</claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>The similarity degree calculation system according to claim 5, wherein<br/>
each of the comparison data and the target data is a T-dimensional vector (T being an integer not less than 1) having each component of an integer of 0 or one;<br/>
the comparison ciphertext is a T-dimensional vector having a component of a ciphertext obtained by transforming each component of the<!-- EPO <DP n="266"> --> comparison data by the encryption transformation using the public key;<br/>
the target ciphertext is a T-dimensional vector having a component of a ciphertext obtained by transforming each component of the target data by the encryption transformation using the public key;<br/>
the similarity degree calculation apparatus further includes a public key storage unit;<br/>
using the storage device of the similarity degree calculation apparatus, the public key storage unit of the similarity degree calculation apparatus stores the public key corresponding to the secret key stored by the decryption apparatus;<br/>
using the processing device of the similarity degree calculation apparatus, the temporary key generation unit of the similarity degree calculation apparatus randomly generates an integer, and sets the generated integer to the temporary key;<br/>
the interim similarity degree ciphertext calculation unit of the similarity degree calculation apparatus includes a random number plaintext generation unit, a first ciphertext calculation unit, and a second ciphertext calculation unit;<br/>
using the processing device of the similarity degree calculation apparatus, the random number plaintext generation unit of the similarity degree calculation apparatus generates a T-dimensional vector having a component of an integer, and sets the generated T-dimensional vector to a random number plaintext;<br/>
using the processing device of the similarity degree calculation apparatus, the first ciphertext calculation unit of the similarity degree<!-- EPO <DP n="267"> --> calculation apparatus calculates a first interim similarity degree ciphertext using the arithmetic operation for the ciphertext, based on the comparison ciphertext stored by the comparison ciphertext storage unit of the similarity degree calculation apparatus, the target ciphertext acquired by the target ciphertext acquisition unit of the similarity degree calculation apparatus, and the random number plaintext generated by the random number plaintext generation unit of the similarity degree calculation apparatus, the first interim similarity degree ciphertext being a T-dimensional vector having a component of a ciphertext obtained by transforming a sum of a difference between each component of the comparison data and the corresponding component of the target data and the corresponding component of the random number plaintext by the encryption transformation using the public key;<br/>
using the processing device of the similarity degree calculation apparatus, the second ciphertext calculation unit of the similarity degree calculation apparatus calculates a second interim similarity degree ciphertext using the arithmetic operation for the ciphertext, based on the comparison ciphertext stored by the comparison ciphertext storage unit of the similarity degree calculation apparatus, the target ciphertext acquired by the target ciphertext acquisition unit of the similarity degree calculation apparatus, the temporary key generated by the temporary key generation unit of the similarity degree calculation apparatus, and the random number plaintext generated by the random number plaintext generation unit of the similarity degree calculation apparatus, the second interim similarity degree ciphertext being a ciphertext obtained by transforming a sum of a correction value and the temporary key by the encryption transformation using the public key, the<!-- EPO <DP n="268"> --> correction value being an integer obtained by summating, for all the components, sums of squares of the respective components of the random number plaintext, the respective components of the comparison data, the respective components of the target data, and twice products of the corresponding components of the random number plaintext and differences between the respective components of the comparison data and the corresponding components of the target data; and<br/>
using the processing device of the similarity degree calculation apparatus, the interim similarity degree ciphertext notification unit of the similarity degree calculation apparatus notifies the first interim similarity degree ciphertext calculated by the first ciphertext calculation unit of the similarity degree calculation apparatus and the second interim similarity degree ciphertext calculated by the second ciphertext calculation unit of the similarity degree calculation apparatus to the decryption apparatus.</claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>The similarity degree calculation system according to claim 5, wherein<br/>
each of the comparison data and the target data is a T-dimensional vector (T being an integer not less than 1) having a component of an integer;<br/>
the comparison ciphertext is a T-dimensional vector having a component of a ciphertext obtained by transforming each component of the comparison data by the encryption transformation using the public key;<br/>
the target ciphertext is a T-dimensional vector having a component of a ciphertext obtained by transforming each component of the target data by the encryption transformation using the public key;<br/>
<!-- EPO <DP n="269"> -->the similarity degree calculation apparatus further includes a public key storage unit;<br/>
using the storage device of the similarity degree calculation apparatus, the public key storage unit of the similarity degree calculation apparatus stores the public key corresponding to the secret key stored by the decryption apparatus;<br/>
using the processing device of the similarity degree calculation apparatus, the temporary key generation unit of the similarity degree calculation apparatus randomly generates an integer, and sets the generated integer to the temporary key;<br/>
the interim similarity degree ciphertext calculation unit of the similarity degree calculation apparatus includes a first ciphertext calculation unit and a second ciphertext calculation unit;<br/>
using the processing device of the similarity degree calculation apparatus, the first ciphertext calculation unit of the similarity degree calculation apparatus calculates a first interim similarity degree ciphertext using the arithmetic operation for the ciphertext, based on the comparison ciphertext stored by the comparison ciphertext storage unit of the similarity degree calculation apparatus and the target ciphertext acquired by the target ciphertext acquisition unit of the similarity degree calculation apparatus, the first interim similarity degree ciphertext being a T-dimensional vector having a component of a ciphertext obtained by transforming a difference between each component of the comparison data and the corresponding component of the target data by the encryption transformation using the public key;<br/>
using the processing device of the similarity degree calculation<!-- EPO <DP n="270"> --> apparatus, the second ciphertext calculation unit of the similarity degree calculation apparatus sets a ciphertext obtained by transformation of the temporary key by the encryption transformation using the public key to a second interim similarity degree ciphertext, based on the public key stored by the public key storage unit of the similarity degree calculation apparatus and the temporary key generated by the temporary key generation unit of the similarity degree calculation apparatus; and<br/>
using the processing device of the similarity degree calculation apparatus, the interim similarity degree ciphertext notification unit of the similarity degree calculation apparatus notifies the first interim similarity degree ciphertext calculated by the first ciphertext calculation unit of the similarity degree calculation apparatus and the second interim similarity degree ciphertext calculated by the second ciphertext calculation unit of the similarity degree calculation apparatus to the decryption apparatus.</claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>The similarity degree calculation system according to claim 8, wherein<br/>
using the processing device of the similarity degree calculation apparatus, the first ciphertext calculation unit of the similarity degree calculation apparatus sets, as the first interim similarity degree ciphertext, the T-dimensional vector having components of a ciphertext randomly selected from among ciphertexts obtained by transforming the difference of each component of the comparison data from the corresponding component of the target data by the encryption transformation using the public key and ciphertexts obtained by transforming the difference of each component of the<!-- EPO <DP n="271"> --> target data from the corresponding component of the comparison data by the encryption transformation using the public key, the T-dimensional vector having asequence of the components randomly rearranged.</claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>The similarity degree calculation system according to any one of claims 6 to 9, wherein<br/>
using the processing device of the decryption apparatus, the interim similarity degree decrypted text calculation unit of the decryption apparatus calculates a difference or a sum between a summation of squares of the integers obtained by decrypting the T components of the first interim similarity degree ciphertext and the integer obtained by decrypting the second interim similarity degree ciphertext, or calculates an element obtained by combining z pieces of predetermined elements (z being the difference or the sum between the summation of squares of the integers obtained by decrypting the T components of the first interim similarity degree ciphertext and the integer obtained by decrypting the second interim similarity degree ciphertext) in a predetermined finite group by a group arithmetic operation on the predetermined finite group, and sets the calculated difference, the calculated sum, or the calculated element to the interim similarity degree decrypted text.</claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>The similarity degree calculation system according to claim 5, wherein<br/>
each of the comparison data and the target data is a T-dimensional vector (T being an integer not less than 1) having each component of an<!-- EPO <DP n="272"> --> integer;<br/>
the comparison ciphertext is a T-dimensional vector having a component of a ciphertext obtained by transforming each component of the comparison data by the encryption transformation using the public key;<br/>
the target ciphertext is a T-dimensional vector having a component of a ciphertext obtained by transforming each component of the target data by the encryption transformation using the public key;<br/>
the similarity degree calculation apparatus further includes a public key storage unit;<br/>
using the storage device of the similarity degree calculation apparatus, the public key storage unit of the similarity degree calculation apparatus stores the public key corresponding to the secret key stored by the decryption apparatus;<br/>
using the processing device of the similarity degree calculation apparatus, the temporary key generation unit of the similarity degree calculation apparatus randomly generates an integer, and sets the generated integer to the temporary key; and<br/>
using the processing device of the similarity degree calculation apparatus, the interim similarity degree ciphertext calculation unit of the similarity degree calculation apparatus calculates the interim similarity degree ciphertext using the arithmetic operation for the ciphertext, based on the comparison ciphertext stored by the comparison ciphertext storage unit of the similarity degree calculation apparatus and the target ciphertext acquired by the target ciphertext acquisition unit of the similarity degree calculation apparatus, and the temporary key generated by the temporary key generation<!-- EPO <DP n="273"> --> unit of the similiarity degree calculation apparatus, the interim similarity degree ciphertext being a ciphertext obtained by transforming a sum or a difference between a summation value and the temporary key by the encryption transformation using the public key, and the summation value is an integer obtained by summating a square of a difference between each component of the comparison data and the corresponding component of the target data or by summating a product of each component of the comparison data and the corresponding component of the target data, for all the components.</claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>The similarity degree calculation system according to claim 5, wherein<br/>
the encryption transformation is transformation for transforming an integer not less than 0 and less than q (q being a prime number) into a ciphertext that is an n-dimensional vector (n being an integer not less than 2) in a vector space;<br/>
the vector space is a direct product of n cyclic groups of an order q; the arithmetic operation for the ciphertext is addition of vectors in the vector space;<br/>
the public key includes a random base that is a base of the vector space; and<br/>
the encryption transformation is transformation for transforming an integer x not less than 0 and less than q into a vector obtained by adding x times a first vector of the random base and random number times a different vector of the random base.<!-- EPO <DP n="274"> --></claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>The similarity degree calculation system according to claim 5, wherein<br/>
the encryption transformation is transformation for transforming an integer not less than 0 and less than N (N being a product of mutually different two prime numbers p and q) into a ciphertext that is an element of a finite group of an order N;<br/>
the arithmetic operation for the ciphertext is a group arithmetic operation on the finite group;<br/>
the public key includes a generator element of the finite group and a disturbance element that is an element of the finite group and has an order of the prime number p; and<br/>
the encryption transformation is transformation for transforming an integer x not less than 0 and less than N into an element obtained by combining x pieces of the generator elements and a random number of the disturbance elements by the group arithmetic operation on the finite group.</claim-text></claim><claim id="c-en-0014" num="0014"><claim-text>The similarity degree calculation system according to claim 5, wherein<br/>
the encryption transformation is transformation for transforming an integer not less than 0 and less than N (N being a product of mutually different two prime numbers p and q) into a ciphertext that is an integer not less than 0 and less than N<sup>2</sup>;<br/>
the arithmetic operation for the ciphertext is multiplication of integers modulo N<sup>2</sup>; and<br/>
<!-- EPO <DP n="275"> -->the encryption transformation is transformation for transforming an integer x not less than 0 and less than N into a remainder when a product of an Nth power of a random number and a sum of 1 and a product of the integer x and the integer N is divided by N<sup>2</sup>.</claim-text></claim><claim id="c-en-0015" num="0015"><claim-text>The similarity degree calculation system according to claim 3, wherein<br/>
the similarity degree calculation system further includes an encryption apparatus;<br/>
the encryption apparatus includes a storage device that stores data, a processing device that processes the data, a public key storage unit, a target data acquisition unit, a temporary public key acquisition unit, a target dual encryption text calculation unit, and a target dual encryption text notification unit;<br/>
using the storage device of the encryption apparatus, the public key storage unit of the encryption apparatus stores the public key corresponding to the secret key stored by the decryption apparatus;<br/>
using the processing device of the encryption apparatus, the target data acquisition unit of the encryption apparatus acquires the target data;<br/>
using the processing device of the encryption apparatus, the temporary public key acquisition unit of the encryption apparatus acquires a temporary public key notified from the similarity degree calculation apparatus;<br/>
using the processing device of the encryption apparatus, the target dual encryption text calculation unit of the encryption apparatus transforms<!-- EPO <DP n="276"> --> the target data by second encryption transformation using the public key and the temporary public key, thereby calculating a target dual encryption text, based on the public key stored by the public key storage unit of the encryption apparatus, the target data acquired by the target data acquisition unit of the encryption apparatus, and the temporary public key acquired by the temporary public key acquisition unit of the encryption apparatus;<br/>
using the processing device of the encryption apparatus, the target dual encryption text notification unit of the encryption apparatus notifies the target dual encryption text calculated by the target dual encryption text calculation unit of the encryption apparatus to the similarity degree calculation apparatus;<br/>
the similarity degree calculation apparatus further includes a temporary secret key generation unit, a temporary public key notification unit, and a target dual encryption text acquisition unit;<br/>
using the processing device of the similarity degree calculation apparatus, the temporary secret key generation unit of the similarity degree calculation apparatus generates a temporary secret key and a temporary public key corresponding to the temporary secret key;<br/>
using the processing device of the similarity degree calculation apparatus, the temporary public key notification unit of the similarity degree calculation apparatus notifies the temporary public key generated by the temporary secret key generation unit of the similarity degree calculation apparatus to the encryption apparatus;<br/>
using the processing device of the similarity degree calculation apparatus, the target dual encryption text acquisition unit of the similarity<!-- EPO <DP n="277"> --> degree calculation apparatus acquires the target dual encryption text notified from the encryption apparatus; and<br/>
using the processing device of the similarity degree calculation apparatus, the target ciphertext acquisition unit of the similarity degree calculation apparatus transforms the target dual encryption text by second decryption transformation using the temporary secret key, based on the temporary secret key generated by the temporary secret key generation unit of the similarity degree calculation apparatus and the target dual encryption text acquired by the target dual encryption text acquisition unit of the similarity degree calculation apparatus, thereby calculating the target ciphertext obtained by transforming the target data by the encryption transformation using the public key.</claim-text></claim><claim id="c-en-0016" num="0016"><claim-text>The similarity degree calculation system according to claim 15, wherein<br/>
each of the comparison data and the target data is a T-dimensional vector (T being an integer not less than 1) having a component of an integer;<br/>
using the processing device of the similarity degree calculation apparatus, the temporary secret key generation unit of the similarity degree calculation apparatus generates the temporary public key including encrypted information on the comparison data, based on the comparison ciphertext stored by the comparison ciphertext storage unit of the similarity degree calculation apparatus; and<br/>
using the processing device of the encryption apparatus, the target dual encryption text calculation unit of the encryption apparatus calculates the<!-- EPO <DP n="278"> --> target dual encryption text including encrypted information on a product of the component of the target data and the corresponding component of the comparison data, by the second encryption transformation using the temporary public key.</claim-text></claim><claim id="c-en-0017" num="0017"><claim-text>The similarity degree calculation system according to claim 15, wherein<br/>
the encryption transformation is transformation for transforming an integer to a ciphertext, an arithmetic operation for combining and transforming a plurality of ciphertexts into a different ciphertext may be calculated for the ciphertext, and a ciphertext obtained by combining a ciphertext resulting from transformation of an arbitrary first integer and a ciphertext resulting from transformation of an arbitrary second integer by the arithmetic operation for the ciphertext is a ciphertext resulting from transformation of a sum of the first integer and the second integer;<br/>
the target data is a T-dimensional vector (T being an integer not less than 1) having components of integers;<br/>
the similarity degree calculation apparatus further includes a public key storage unit;<br/>
using the storage device of the similarity degree calculation apparatus, the public key storage unit of the similarity degree calculation apparatus stores the public key corresponding to the secret key stored by the decryption apparatus;<br/>
using the processing device of the similarity degree calculation apparatus, the temporary public key generation unit of the similarity degree<!-- EPO <DP n="279"> --> calculation apparatus randomly generates a T-dimensional vector having a component of an integer, and sets the generated T-dimensional vector to the temporary secret key, and calculates a T-dimensional vector having a component of a ciphertext obtained by transforming each component of the temporary secret key by the encryption transformation using the public key, based on the public key stored by the public key storage unit of the similarity degree calculation apparatus and the generated temporary secret key, and sets the calculated T-dimensional vector to the temporary public key;<br/>
using the processing device of the encryption apparatus, the target dual encryption text calculation unit of the encryption apparatus randomly generates a T-dimensional vector having a component of a ciphertext obtained by transforming 0 by the encryption transformation using the public key, based on the public key stored by the public key storage unit of the encryption apparatus, and sets the generated T-dimensional vector to a zero ciphertext, and calculates a T-dimensional vector having a component of a cirphetext obtained by combining b'<sub>i</sub> pieces of each component of the temporary public key (b'<sub>i</sub> being the integer indicating the corresponding component of the target data) and the corresponding component of the zero ciphertext by the arithmetic operation for the ciphertext, based on the target data acquired by the target data acquisition unit of the encryption apparatus, the temporary public key acquired by the temporary public key acquisition unit of the encryption apparatus, and the generated zero ciphertext, and sets the calculated T-dimensional vector to the target dual encryption text;<br/>
the target ciphertext acquisition unit of the similarity degree calculation apparatus includes a temporary decryption key calculation unit<!-- EPO <DP n="280"> --> and a target ciphertext calculation unit;<br/>
using the processing device of the similarity degree calculation apparatus, the temporary decryption key calculation unit of the similarity degree calculation apparatus calculates a T-dimensional vector having a component of an inverse number of each component of the temporary secret key, based on the temporary secret key generated by the temporary secret key generation unit of the similarity degree calculation apparatus, and sets the calculated T-dimensional vector to a temporary decryption key; and<br/>
using the processing device of the similarity degree calculation apparatus, the target ciphertext calculation unit of the similarity degree calculation apparatus calculates a T-dimensional vector having a component of a ciphertext obtained by combining R<sub>i</sub><sup>-1</sup> pieces of each component of the target dual encryption text (R<sub>i</sub><sup>-1</sup> being the inverse number indicating the corresponding component of the temporary decryption key), based on the target dual encryption text acquired by the target dual encryption text acquisition unit of the similarity degree calculation apparatus and the temporary decryption key calculated by the temporary decryption key calculation unit of the similarity degree calculation apparatus, and sets the calculated T-dimensional vector to the target ciphertext.</claim-text></claim><claim id="c-en-0018" num="0018"><claim-text>The similarity degree calculation system according to claim 15, wherein<br/>
the encryption transformation is transformation for transforming an integer to a ciphertext, an arithmetic operation for combining and transforming a plurality of ciphertexts into a different ciphertext may be<!-- EPO <DP n="281"> --> calculated for the ciphertext, and a ciphertext obtained by combining a ciphertext resulting from transformation of an arbitrary first integer and a ciphertext resulting from transformation of an arbitrary second integer by the arithmetic operation for the ciphertext is a ciphertext resulting from transformation of a sum of the first integer and the second integer;<br/>
each of the comparison data and the target data is a T-dimensional vector (T being an integer not less than 1) having a component of an integer;<br/>
the comparison ciphertext is a T-dimensional vector having a component of a ciphertext obtained by transforming each component of the comparison data by the encryption transformation using the public key;<br/>
the similarity degree calculation apparatus further includes a public key storage unit;<br/>
using the storage device of the similarity degree calculation apparatus, the public key storage unit of the similarity degree calculation apparatus stores the public key corresponding to the secret key stored by the decryption apparatus;<br/>
using the processing device of the similarity degree calculation apparatus, the temporary public key generation unit of the similarity degree calculation apparatus randomly generates a T-dimensional vector having a component of an integer, and sets the generated T-dimensional vector to the temporary secret key, and randomly generates a T-dimensional vector having a component of a ciphertext obtained by transforming 0 by the encryption transformation using the public key and sets the generated T-dimensional vector to a zero ciphertext, based on the public key stored by the public key storage unit of the similarity degree calculation apparatus, and calculates a<!-- EPO <DP n="282"> --> T-dimensional vector having a components of a ciphertext obtained by combining R<sub>i</sub> pieces of each component of the comparison ciphertext (R<sub>i</sub> being an integer indicating a corresponding component of the temporary secret key) and a corresponding component of the zero ciphertext, based on the comparison ciphertext stored by the comparison ciphertext storage unit of the similarity degree calculation apparatus, the generated temporary secret key, and the generate zero ciphertext, and sets the generated T-dimensional vector to the temporary public key;<br/>
using the processing device of the encryption apparatus, the target dual encryption text calculation unit of the encryption apparatus randomly generates a T-dimensional vector having a component of a ciphertext obtained by transforming 0 by the encryption transformation using the public key, based on the public key stored by the public key storage unit of the encryption apparatus, and sets the generated T-dimensional vector to a zero ciphertext, and calculates a T-dimensional vector having a component of a cirphetext obtained by combining b'<sub>i</sub> pieces of each component of the temporary public key (b'<sub>i</sub> being the integer indicating the corresponding component of the target data) and the corresponding component of the zero ciphertext by the arithmetic operation for the ciphertext, based on the target data acquired by the target data acquisition unit of the encryption apparatus, the temporary public key acquired by the temporary public key acquisition unit of the encryption apparatus, and the generated zero ciphertext, and sets the calculated T-dimensional vector to the target dual encryption text;<br/>
the target ciphertext acquisition unit of the similarity degree calculation apparatus includes a temporary decryption key calculation unit<!-- EPO <DP n="283"> --> and a target ciphertext calculation unit;<br/>
using the processing device of the similarity degree calculation apparatus, the temporary decryption key calculation unit of the similarity degree calculation apparatus calculates a T-dimensional vector having a component of an inverse number of each component of the temporary secret key, based on the temporary secret key generated by the temporary secret key generation unit of the similarity degree calculation apparatus, and sets the calculated T-dimensional vector to a temporary decryption key; and<br/>
using the processing device of the similarity degree calculation apparatus, the target ciphertext calculation unit of the similarity degree calculation apparatus calculates a T-dimensional vector having a component of a ciphertext obtained by combining R<sub>i</sub><sup>-1</sup> pieces of each component of the target dual encryption text (R<sub>i</sub><sup>-1</sup> being the inverse number indicating the corresponding component of the temporary decryption key) by the arithmetic operation for the ciphertext, based on the target dual encryption text acquired by the target dual encryption text acquisition unit of the similarity degree calculation apparatus and the temporary decryption key calculated by the temporary decryption key calculation unit of the similarity degree calculation apparatus, and sets the calculated T-dimensional vector to the target ciphertext.</claim-text></claim><claim id="c-en-0019" num="0019"><claim-text>The similarity degree calculation system according to claim 18, wherein<br/>
the interim similarity degree ciphertext calculation unit of the similarity degree calculation apparatus includes a random number plaintext<!-- EPO <DP n="284"> --> generation unit and a ciphertext calculation unit;<br/>
using the processing device of the similarity degree calculation apparatus, the random number plaintext generation unit of the similarity degree calculation apparatus randomly generates a T-dimensional vector having a component of an integer and sets the generated T-dimensional vector to a random number plaintext;<br/>
using the processing device of the similarity degree calculation apparatus, the temporary key generation unit of the similarity degree calculation apparatus calculates a summation of components of the random number plaintext generated by the random number generation unit of the similarity degree calculation apparatus, and sets the calculated summation to the temporary key; and<br/>
using the processing device of the similarity degree calculation apparatus, the ciphertext calculation unit of the similarity degree calculation apparatus calculates a T-dimensional vector having a component of a ciphertext obtained by combining each component of the target ciphertext and the corresponding component of the random number plaintext by the arithmetic operation for the ciphertext, based on the target ciphertext acquired by the target ciphertext acquisition unit of the similarity degree calculation apparatus and the random number plaintext generated by the random number plaintext generation unit of the similarity degree calculation apparatus, and sets the calculated T-dimensional vector to the interim similarity degree ciphertext.</claim-text></claim><claim id="c-en-0020" num="0020"><claim-text>The similarity degree calculation system according to claim 18,<!-- EPO <DP n="285"> --> wherein<br/>
using the processing device of the similarity degree calculation apparatus, the temporary key generation unit of the similarity degree calculation apparatus randomly generates an integer, and sets the generated integer to the temporary key;<br/>
the interim similarity degree ciphertext calculation unit of the similarity degree calculation apparatus includes a first ciphertext calculation unit and a second ciphertext calculation unit;<br/>
using the processing device of the similarity degree calculation apparatus, the first ciphertext calculation unit of the similarity degree calculation apparatus calculates a T-dimensional vector with a sequence of the components of the target ciphertext randomly rearranged, based on the target ciphertext acquired by the target ciphertext acquisition unit of the similarity degree calculation apparatus, and sets the calculated T-dimensional vector to a first interim similarity degree ciphertext;<br/>
using the processing device of the similarity degree calculation apparatus, the second ciphertext calculation unit of the similarity degree calculation apparatus calculates a ciphertext obtained by transforming the temporary key by the encryption transformation using the public key, based on the public key stored by the public key storage unit of the similarity degree calculation apparatus and the temporary key generated by the temporary key generation unit of the similarity degree calculation apparatus, and sets the calculated ciphertext to a second interim similarity degree ciphertext; and<br/>
using the processing device of the similarity degree calculation apparatus, the interim similarity degree ciphertext notification unit of the<!-- EPO <DP n="286"> --> similarity degree calculation apparatus notifies the first interim similarity degree ciphertext calculated by the first ciphertext calculation unit of the similarity degree calculation apparatus and the second interim similarity degree ciphertext calculated by the second ciphertext calculation unit of the similarity degree calculation apparatus to the decryption apparatus.</claim-text></claim><claim id="c-en-0021" num="0021"><claim-text>The similarity degree calculation system according to claim 20, wherein<br/>
using the processing device of the decryption apparatus, the interim similarity degree decrypted text calculation unit of the decryption apparatus calculates a difference or a sum between a summation of the integers obtained by decrypting T components of the first interim similarity degree ciphertext and the integer obtained by decrypting the second interim similarity degree ciphertext, or calculates an element by combining z pieces of predetermined elements in a predetermined finite group (z being the difference or the sum between the summation of the integers obtained by decrypting the T components of the first interim similarity degree ciphertext and the integer obtained by decrypting the second interim similarity degree ciphertext) by a group arithmetic operation on the predetermined finite group, and sets the calculated difference, the calculated sum, or the calculated element to the interim similarity degree decrypted text.</claim-text></claim><claim id="c-en-0022" num="0022"><claim-text>The similarity degree calculation system according to claim 18, wherein<br/>
using the processing device of the similarity degree calculation<!-- EPO <DP n="287"> --> apparatus, the temporary key generation unit of the similarity degree calculation apparatus randomly generates an integer, and sets the generated integer to the temporary key; and<br/>
using the processing device of the similarity degree calculation apparatus, the interim similarity degree ciphertxt calculation unit of the similarity degree calculation apparatus calculates a ciphertext by combining a ciphertext obtained by transformation of the temporary key by the encryption transformation using the public key, and the T components of the target ciphertext using the arithmetic operation for the ciphertext based on the public key stored by the public key storage unit of the encryption apparatus, the target ciphertext acquired by the target ciphertext acquisition unit of the similarity degree calculation apparatus, and the temporary key generated by the temporary key generation unit of the similarity degree calculation apparatus, and sets the calculated ciphertext to the interim similarity degree ciphertext.</claim-text></claim><claim id="c-en-0023" num="0023"><claim-text>The similarity degree calculation system according to any one of claim 11 or claim 22, wherein<br/>
using the processing device of the decyprtion apparatus, the interim similarity degree decrypted text calculation unit of the decryption apparatus calculates an integer obtained by decrypting the interim similarity degree ciphertext, or calculates an element by combining z pieces of predetermined elements (z being the integer obtained by decrypting the interim similarity degree ciphertext) in a predetermined finite group by a group arithemetic operation in the predetermined finite group, based on the interim similarity<!-- EPO <DP n="288"> --> degree ciphertext acquired by the interim similarity degree ciphertext acquisition unit of the decryption apparatus, and sets the calculated integer or the calculated element to the interim similarity degree decrypted text.</claim-text></claim><claim id="c-en-0024" num="0024"><claim-text>The similarity degree calculation system according to any one of claims 3 to 9 and claims 11 to 22, wherein<br/>
the interim similarity degree decrypted text is an integer;<br/>
using the processing device of the similarity degree calculation apparatus, the temporary key generation unit of the similarity degree calculation apparatus randomly generates an integer, and sets the generated integer to the temporary key; and<br/>
using the processing device of the similarity degree calculation apparatus, the similarity degree calculation unit of the similarity degree calculation apparatus calculates a sum or a difference between the temporary key and the interim similarity degree decrypted text, based on the temporary key generated by the temporary key generation unit of the similarity degree calculation apparatus and the interim similarity degree decrypted text acquired by the interim similarity degree decrypted text acquisition unit of the similarity degree calculation apparatus, and sets the calculated sum or the calculated difference to the similarity degree.</claim-text></claim><claim id="c-en-0025" num="0025"><claim-text>The similarity degree calculation system according to any one of claims 3 to 9 and claims 11 to 22, wherein<br/>
the interim similarity degree decrypted text is an element in a predetermined finite group;<br/>
<!-- EPO <DP n="289"> -->using the processing device of the similarity degree calculation apparatus, the temporary key generation unit of the similarity degree calculation apparatus randomly generates an integer, and sets the generated integer to the temporary key;<br/>
the similarity degree calculation unit of the similarity degree calculation apparatus includes a similarity degree decrypted text calculation unit and a discrete logarithm calculation unit;<br/>
using the processing device of the similarity degree calculation apparatus, the similarity degree decrypted text calculation unit of the similarity degree calculation apparatus calculates an element by combining the interim similarity degree decrypted text and u pieces of predetermined elements (u being the integer of the temporary key) in the predetermined finite group by a group arithmetic operation on the predetermined finite group, based on the temporary key generated by the temporary key generation unit of the similarity degree calculation apparatus and the interim similarity degree decrypted text acquired by the interim similarity degree decrypted text acquisition unit of the similarity degree calculation apparatus, and sets the calculated element to a similarity degree decrypted text; and<br/>
using the processing device of the similarity degree calculation apparatus, the discrete logarithm calculation unit of the similarity degree calculation apparatus calculates a number of the predetermined elements to be combined to be equal to the similarity degree decrypted text, by the group arithmetic operation in the predetermined finite group, based on the similarity degree decrypted text calculated by the similarity degree decrypted text of the similarity degree calculation apparatus, and sets the number of the<!-- EPO <DP n="290"> --> predetermine elements to the similarity degree.</claim-text></claim><claim id="c-en-0026" num="0026"><claim-text>The similarity degree calculation system according to claim 25, wherein<br/>
using the processing device of the similarity degree calculation apparatus, the discrete logarithm calculation unit of the similarity degree calculation apparatus calculates the similarity degree when the similarity degree is an integer within a predetermined range, and determines that the similarity degree is outside the predetermined range when the similarity degree is outside the predetermined range.</claim-text></claim><claim id="c-en-0027" num="0027"><claim-text>The similarity degree calculation system according to any one of claims 3 to 9 and claims 11 to 22, wherein<br/>
the similarity degree calculation system further includes a registration apparatus;<br/>
the registration apparatus includes a storage device that stores data, a processing device that processes the data, a public key storage unit, a comparison data acquisition unit, a comparison ciphertext calculation unit, and a comparison ciphertext notification unit;<br/>
using the storage device of the registration apparatus, the public key storage unit of the registration apparatus stores the public key corresponding to the secret key stored by the decryption apparatus;<br/>
using the processing device of the registration apparatus, the comparison data acquisition unit of the registration apparatus acquires the comparison data;<br/>
<!-- EPO <DP n="291"> -->using the processing device of the registration apparatus, the comparison ciphertext calculation unit of the registration apparatus transforms the comparison data by the encryption transformation using the public key to calculate the comparison ciphertext, based on the public key stored by the public key storage unit of the registration apparatus and the comparison data acquired by the comparison data acquisition unit of the registration apparatus;<br/>
using the processing device of the registration apparatus, the comparison ciphertext notification unit of the registration apparatus notifies the comparison ciphertext calculated by the comparison ciphertext calculation unit of the registration apparatus to the similarity degree calculation apparatus;<br/>
the similarity degree calculation apparatus further includes a comparison ciphertext acquisition unit;<br/>
using the processing device of the similarity degree calculation apparatus, the comparison ciphertext acquisition unit of the similarity degree calculation apparatus acquires the comparison ciphertext notified from the registration apparatus; and<br/>
using the storage device of the similarity degree calculation apparatus, the comparison ciphertext storage unit of the similarity degree calculation apparatus stores the comparison ciphertext acquired by the comparison ciphertext acquisition unit of the similarity degree calculation apparatus.</claim-text></claim><claim id="c-en-0028" num="0028"><claim-text>A computer program, wherein the computer program is executed by a computer including a storage device that stores data and a processing<!-- EPO <DP n="292"> --> device that processes the data, thereby causing the computer to function as the similarity degree calculation apparatus according to claim 1 or 2.</claim-text></claim><claim id="c-en-0029" num="0029"><claim-text>A similarity degree calculation method of calculating a similarity degree between comparison data and target data by a similarity degree calculation system including a similarity degree calculation apparatus and a decryption apparatus,<br/>
each of the similarity degree calculation apparatus and the decryption apparatus including a storage device that stores data and a processing device that processes the data, the similarity degree calculation method comprising:
<claim-text>storing a secret key by the storage device of the decryption apparatus;</claim-text>
<claim-text>storing by the storage device of the similarity degree calculation apparatus a comparison ciphertext obtained by transforming the comparison data by encryption transformation using a public key corresponding to the secret key stored by the decryption apparatus;</claim-text>
<claim-text>acquiring by the processing device of the similarity degree calculation apparatus a target ciphertext obtained by transforming the target data by the encryption transformation using the public key;</claim-text>
<claim-text>generating a temporary key by the processing device of the similarity degree calculation apparatus;</claim-text>
<claim-text>by the processing device of the similarity degree calculation apparatus, performing calculation for calculating the similarity degree in a first stage with the comparison cirphertext and the target ciphertext kept encrypted, based on the comparison ciphertext stored by the storage device of the similiarity degree calculation apparatus, the target ciphertext acquired by<!-- EPO <DP n="293"> --> the processing device of the similarity degree calculation apparatus, and the temporary key generated by the processing device of the similiarity degree calculation apparatus, thereby calculating an interim similarity degree ciphertext obtained by encrypting a result of the calculation by the temporary key;</claim-text>
<claim-text>by the processing device of the similarity degree calculation apparatus, notifying to the decryption apparatus the interim similarity degree ciphertext calculated by the processing device of the interim similarity degree ciphertext calculation apparatus;</claim-text>
<claim-text>by the processing device of the decryption apparatus, acquiring the interim similarity degree ciphertext notified from the similarity degree calculation apparatus;</claim-text>
<claim-text>by the processing device of the decryption apparatus, decrypting the interim similarity degree ciphertext with the secret key, based on the secret key stored by the storage device of the decryption apparatus and the interim similarity degree ciphertext acquired by the processing device of the decryption apparatus, performing calculation for calculating the similarity degree in a second stage with a result of the decryption kept encrypted with the temporary key, thereby calculating the interim similarity degree decrypted text;</claim-text>
<claim-text>by the processing device of the decryption apparatus, notifying the interim similarity degree decrypted text calculated by the processing device of the decryption apparatus to the similarity degree calculation apparatus;</claim-text>
<claim-text>by the processing device of the similarity degree calculation apparatus, acquiring the interim similarity degree decrypted text notified from the<!-- EPO <DP n="294"> --> decryption apparatus; and</claim-text>
<claim-text>by the processing device of the similarity degree calculation apparatus, decrypting the interim similarity degree decrypted text with the temporary key, based on the temporary key generated by the processing device of the similarity degree calculation apparatus and the interim similarity degree decrypted text acquired by the processing device of the similarity degree calculation apparatus, thereby calculating the similarity degree between the comparison data and the target data.</claim-text></claim-text></claim></claims><drawings mxw-id="PDW16666998" load-source="patent-office"><!-- EPO <DP n="295"> --><figure id="f0001" num="1,2"><img id="if0001" file="imgf0001.tif" wi="165" he="187" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="296"> --><figure id="f0002" num="3,4"><img id="if0002" file="imgf0002.tif" wi="165" he="214" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="297"> --><figure id="f0003" num="5"><img id="if0003" file="imgf0003.tif" wi="158" he="232" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="298"> --><figure id="f0004" num="6,7"><img id="if0004" file="imgf0004.tif" wi="165" he="214" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="299"> --><figure id="f0005" num="8,9"><img id="if0005" file="imgf0005.tif" wi="165" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="300"> --><figure id="f0006" num="10"><img id="if0006" file="imgf0006.tif" wi="165" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="301"> --><figure id="f0007" num="11,12"><img id="if0007" file="imgf0007.tif" wi="165" he="214" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="302"> --><figure id="f0008" num="13,14"><img id="if0008" file="imgf0008.tif" wi="129" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="303"> --><figure id="f0009" num="15,16"><img id="if0009" file="imgf0009.tif" wi="165" he="217" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="304"> --><figure id="f0010" num="17,18"><img id="if0010" file="imgf0010.tif" wi="165" he="232" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="305"> --><figure id="f0011" num="19"><img id="if0011" file="imgf0011.tif" wi="138" he="130" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="306"> --><figure id="f0012" num="20"><img id="if0012" file="imgf0012.tif" wi="123" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="307"> --><figure id="f0013" num="21"><img id="if0013" file="imgf0013.tif" wi="165" he="185" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="308"> --><figure id="f0014" num="22,23"><img id="if0014" file="imgf0014.tif" wi="165" he="224" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="309"> --><figure id="f0015" num="24,25"><img id="if0015" file="imgf0015.tif" wi="165" he="198" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="310"> --><figure id="f0016" num="26,27"><img id="if0016" file="imgf0016.tif" wi="137" he="199" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="311"> --><figure id="f0017" num="28,29"><img id="if0017" file="imgf0017.tif" wi="154" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="312"> --><figure id="f0018" num="30,31"><img id="if0018" file="imgf0018.tif" wi="161" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="313"> --><figure id="f0019" num="32,33"><img id="if0019" file="imgf0019.tif" wi="140" he="224" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="314"> --><figure id="f0020" num="34,35"><img id="if0020" file="imgf0020.tif" wi="165" he="211" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="315"> --><figure id="f0021" num="36,37"><img id="if0021" file="imgf0021.tif" wi="165" he="211" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="316"> --><figure id="f0022" num="38"><img id="if0022" file="imgf0022.tif" wi="132" he="122" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="317"> --><figure id="f0023" num="39"><img id="if0023" file="imgf0023.tif" wi="144" he="216" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="318"> --><figure id="f0024" num="40,41"><img id="if0024" file="imgf0024.tif" wi="165" he="222" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="319"> --><figure id="f0025" num="42,43"><img id="if0025" file="imgf0025.tif" wi="161" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="320"> --><figure id="f0026" num="44,45"><img id="if0026" file="imgf0026.tif" wi="106" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="321"> --><figure id="f0027" num="46,47"><img id="if0027" file="imgf0027.tif" wi="165" he="210" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="322"> --><figure id="f0028" num="48,49"><img id="if0028" file="imgf0028.tif" wi="165" he="210" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="323"> --><figure id="f0029" num="50,51"><img id="if0029" file="imgf0029.tif" wi="165" he="210" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="324"> --><figure id="f0030" num="52,53"><img id="if0030" file="imgf0030.tif" wi="165" he="210" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="325"> --><figure id="f0031" num="54,55"><img id="if0031" file="imgf0031.tif" wi="127" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="326"> --><figure id="f0032" num="56,57"><img id="if0032" file="imgf0032.tif" wi="165" he="230" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="327"> --><figure id="f0033" num="58"><img id="if0033" file="imgf0033.tif" wi="142" he="203" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="328"> --><figure id="f0034" num="59,60"><img id="if0034" file="imgf0034.tif" wi="165" he="232" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="329"> --><figure id="f0035" num="61,62"><img id="if0035" file="imgf0035.tif" wi="165" he="222" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="330"> --><figure id="f0036" num="63"><img id="if0036" file="imgf0036.tif" wi="157" he="175" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="331"> --><figure id="f0037" num="64,65"><img id="if0037" file="imgf0037.tif" wi="165" he="228" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="332"> --><figure id="f0038" num="66,67"><img id="if0038" file="imgf0038.tif" wi="165" he="211" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="333"> --><figure id="f0039" num="68,69"><img id="if0039" file="imgf0039.tif" wi="165" he="211" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="334"> --><figure id="f0040" num="70,71"><img id="if0040" file="imgf0040.tif" wi="165" he="224" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="335"> --><figure id="f0041" num="72,73"><img id="if0041" file="imgf0041.tif" wi="165" he="224" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="336"> --><figure id="f0042" num="74,75"><img id="if0042" file="imgf0042.tif" wi="165" he="202" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="337"> --><figure id="f0043" num="76,77"><img id="if0043" file="imgf0043.tif" wi="112" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="338"> --><figure id="f0044" num="78,79"><img id="if0044" file="imgf0044.tif" wi="165" he="211" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="339"> --><figure id="f0045" num="80"><img id="if0045" file="imgf0045.tif" wi="161" he="221" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="340"> --><figure id="f0046" num="81"><img id="if0046" file="imgf0046.tif" wi="157" he="230" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="165" he="231" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
