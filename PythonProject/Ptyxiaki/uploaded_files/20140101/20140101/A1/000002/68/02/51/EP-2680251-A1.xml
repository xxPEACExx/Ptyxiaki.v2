<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2680251-A1" country="EP" doc-number="2680251" kind="A1" date="20140101" family-id="46720808" file-reference-id="311173" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146549353" ucid="EP-2680251-A1"><document-id><country>EP</country><doc-number>2680251</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12748906-A" is-representative="YES"><document-id mxw-id="PAPP154823276" load-source="docdb" format="epo"><country>EP</country><doc-number>12748906</doc-number><kind>A</kind><date>20120220</date><lang>JA</lang></document-id><document-id mxw-id="PAPP168045538" load-source="docdb" format="original"><country>EP</country><doc-number>12748906.0</doc-number><date>20120220</date><lang>JA</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140453416" ucid="JP-2011035677-A" load-source="docdb"><document-id format="epo"><country>JP</country><doc-number>2011035677</doc-number><kind>A</kind><date>20110222</date></document-id></priority-claim><priority-claim mxw-id="PPC140445455" ucid="JP-2012053948-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>JP</country><doc-number>2012053948</doc-number><kind>W</kind><date>20120220</date></document-id></priority-claim></priority-claims><technical-data><classification-ipc><edition>7</edition><main-classification>G06F  21/24</main-classification></classification-ipc><classifications-ipcr><classification-ipcr mxw-id="PCL-1992695185" load-source="docdb">G06F  17/30        20060101ALI20151127BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1992698554" load-source="docdb">G09C   1/00        20060101AFI20151127BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1992701156" load-source="docdb">G06F  21/62        20130101ALI20151127BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1992704186" load-source="docdb">H04L   9/08        20060101ALN20151127BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-1992706039" load-source="docdb">H04L   9/00        20060101ALN20151127BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1934603543" load-source="docdb" scheme="CPC">G06F2221/2123      20130101 LA20160531BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1965267034" load-source="docdb" scheme="CPC">H04L   9/002       20130101 LI20160229BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1965269067" load-source="docdb" scheme="CPC">G06F  21/6227      20130101 LI20160229BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1965272112" load-source="docdb" scheme="CPC">H04L   9/0894      20130101 LI20160229BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988122660" load-source="docdb" scheme="CPC">G06F  21/6218      20130101 FI20131205BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132180543" lang="DE" load-source="patent-office">SUCHSYSTEM, SUCHVERFAHREN FÜR DAS SUCHSYSTEM, INFORMATIONSVERARBEITUNGSVORRICHTUNG, SUCHPROGRAMM, ENTSPRECHENDE STICHWORTVERWALTUNGSVORRICHTUNG UND ENTSPRECHENDES STICHWORTVERWALTUNGSSYSTEM</invention-title><invention-title mxw-id="PT132180544" lang="EN" load-source="patent-office">SEARCH SYSTEM, SEARCH METHOD FOR SEARCH SYSTEM, INFORMATION PROCESSING DEVICE, SEARCH PROGRAM, CORRESPONDING KEYWORD MANAGEMENT DEVICE AND CORRESPONDING KEYWORD MANAGEMENT SYSTEM</invention-title><invention-title mxw-id="PT132180545" lang="FR" load-source="patent-office">SYSTÈME DE RECHERCHE, PROCÉDÉ DE RECHERCHE POUR UN SYSTÈME DE RECHERCHE, DISPOSITIF DE TRAITEMENT D'INFORMATIONS, PROGRAMME DE RECHERCHE, DISPOSITIF DE GESTION DE MOTS-CLÉS CORRESPONDANTS ET SYSTÈME DE GESTION DE MOTS-CLÉS CORRESPONDANTS</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR918134515" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>MITSUBISHI ELECTRIC CORP</last-name><address><country>JP</country></address></addressbook></applicant><applicant mxw-id="PPAR918171060" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>MITSUBISHI ELECTRIC CORPORATION</last-name></addressbook></applicant><applicant mxw-id="PPAR918989802" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Mitsubishi Electric Corporation</last-name><iid>101157912</iid><address><street>7-3 Marunouchi 2-chome Chiyoda-ku</street><city>Tokyo 100-8310</city><country>JP</country></address></addressbook></applicant><applicant mxw-id="PPAR918140868" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>UNIV ELECTRO COMMUNICATIONS</last-name><address><country>JP</country></address></addressbook></applicant><applicant mxw-id="PPAR918170998" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>THE UNIVERSITY OF ELECTRO-COMMUNICATIONS</last-name></addressbook></applicant><applicant mxw-id="PPAR918983422" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>The University of Electro-Communications</last-name><iid>101075383</iid><address><street>1-5-1, Chofugaoka</street><city>Chofu-shi Tokyo 182-8585</city><country>JP</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918173488" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ITO TAKASHI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918145926" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>ITO, TAKASHI</last-name></addressbook></inventor><inventor mxw-id="PPAR918992409" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>ITO, TAKASHI</last-name><address><street>c/o Mitsubishi Electric Corporation 7-3 Marunouchi 2-chome Chiyoda-ku</street><city>Tokyo 100-8310</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918167190" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>HATTORI MITSUHIRO</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918164101" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>HATTORI, MITSUHIRO</last-name></addressbook></inventor><inventor mxw-id="PPAR918989718" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>HATTORI, MITSUHIRO</last-name><address><street>c/o Mitsubishi Electric Corporation 7-3 Marunouchi 2-chome Chiyoda-ku</street><city>Tokyo 100-8310</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918133395" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>MATSUDA NORI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918142326" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>MATSUDA, NORI</last-name></addressbook></inventor><inventor mxw-id="PPAR918992447" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>MATSUDA, NORI</last-name><address><street>c/o Mitsubishi Electric Corporation 7-3 Marunouchi 2-chome Chiyoda-ku</street><city>Tokyo 100-8310</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918145227" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>OTA KAZUO</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918137310" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>OTA, KAZUO</last-name></addressbook></inventor><inventor mxw-id="PPAR918992180" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>OTA, KAZUO</last-name><address><street>c/o The University of Electro-Communications 1-5-1 Chofugaoka</street><city>Chofu-shi Tokyo 182-8585</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918171634" load-source="docdb" sequence="5" format="epo"><addressbook><last-name>SAKAI YUSUKE</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918154450" load-source="docdb" sequence="5" format="intermediate"><addressbook><last-name>SAKAI, YUSUKE</last-name></addressbook></inventor><inventor mxw-id="PPAR918993988" load-source="patent-office" sequence="5" format="original"><addressbook><last-name>SAKAI, YUSUKE</last-name><address><street>c/o The University of Electro-Communications 1-5-1 Chofugaoka</street><city>Chofu-shi Tokyo 182-8585</city><country>JP</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918986987" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Pfenning, Meinig &amp; Partner GbR</last-name><iid>101244111</iid><address><street>Theresienhöhe 13</street><city>80339 München</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="JP-2012053948-W"><document-id><country>JP</country><doc-number>2012053948</doc-number><kind>W</kind><date>20120220</date><lang>JA</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012115031-A1"><document-id><country>WO</country><doc-number>2012115031</doc-number><kind>A1</kind><date>20120830</date><lang>JA</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS548804478" load-source="docdb">AL</country><country mxw-id="DS548860932" load-source="docdb">AT</country><country mxw-id="DS548804479" load-source="docdb">BE</country><country mxw-id="DS548856520" load-source="docdb">BG</country><country mxw-id="DS548840585" load-source="docdb">CH</country><country mxw-id="DS548887787" load-source="docdb">CY</country><country mxw-id="DS548860933" load-source="docdb">CZ</country><country mxw-id="DS548804480" load-source="docdb">DE</country><country mxw-id="DS548888156" load-source="docdb">DK</country><country mxw-id="DS548888157" load-source="docdb">EE</country><country mxw-id="DS548876942" load-source="docdb">ES</country><country mxw-id="DS548856521" load-source="docdb">FI</country><country mxw-id="DS548856522" load-source="docdb">FR</country><country mxw-id="DS548804481" load-source="docdb">GB</country><country mxw-id="DS548888158" load-source="docdb">GR</country><country mxw-id="DS548804482" load-source="docdb">HR</country><country mxw-id="DS548861254" load-source="docdb">HU</country><country mxw-id="DS548840586" load-source="docdb">IE</country><country mxw-id="DS548888159" load-source="docdb">IS</country><country mxw-id="DS548856523" load-source="docdb">IT</country><country mxw-id="DS548888414" load-source="docdb">LI</country><country mxw-id="DS548859913" load-source="docdb">LT</country><country mxw-id="DS548861255" load-source="docdb">LU</country><country mxw-id="DS548859914" load-source="docdb">LV</country><country mxw-id="DS548859915" load-source="docdb">MC</country><country mxw-id="DS548803259" load-source="docdb">MK</country><country mxw-id="DS548803260" load-source="docdb">MT</country><country mxw-id="DS548876943" load-source="docdb">NL</country><country mxw-id="DS548856524" load-source="docdb">NO</country><country mxw-id="DS548803261" load-source="docdb">PL</country><country mxw-id="DS548840587" load-source="docdb">PT</country><country mxw-id="DS548876944" load-source="docdb">RO</country><country mxw-id="DS548840588" load-source="docdb">RS</country><country mxw-id="DS548803266" load-source="docdb">SE</country><country mxw-id="DS548840589" load-source="docdb">SI</country><country mxw-id="DS548856525" load-source="docdb">SK</country><country mxw-id="DS548803267" load-source="docdb">SM</country><country mxw-id="DS548888415" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128670023" lang="EN" load-source="patent-office"><p id="pa01" num="0001">Searchable encryption resistant to frequency analysis is realized. (1) A conversion rule management device 400 generates a conversion rule table associating a search keyword with a conversion keyword group. (2) Based on the conversion rule table, a data registration device 500 generates registration data associating encrypted data with an encrypted keyword, and registers the registration data in a server device 300. (3) An information processing device 200 obtains from the conversion rule table a conversion keyword group associated with a specified search keyword, generates an encrypted keyword group, and requests a data search by specifying the encrypted keyword group. (4) Using as a search key an encrypted keyword included in the encrypted keyword group, the server device 300 searches for encrypted data associated with the search key, and returns searched encrypted data. (5) The information processing device 200 decrypts the searched encrypted data, and outputs as a search result search data obtained by decryption.<img id="iaf01" file="imgaf001.tif" wi="78" he="65" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128499396" lang="EN" source="EPO" load-source="docdb"><p>Searchable encryption resistant to frequency analysis is realized. (1) A conversion rule management device 400 generates a conversion rule table associating a search keyword with a conversion keyword group. (2) Based on the conversion rule table, a data registration device 500 generates registration data associating encrypted data with an encrypted keyword, and registers the registration data in a server device 300. (3) An information processing device 200 obtains from the conversion rule table a conversion keyword group associated with a specified search keyword, generates an encrypted keyword group, and requests a data search by specifying the encrypted keyword group. (4) Using as a search key an encrypted keyword included in the encrypted keyword group, the server device 300 searches for encrypted data associated with the search key, and returns searched encrypted data. (5) The information processing device 200 decrypts the searched encrypted data, and outputs as a search result search data obtained by decryption.</p></abstract><description mxw-id="PDES63955453" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><b>Technical Field</b></heading><p id="p0001" num="0001">The present invention relates, for example, to a search system that performs searchable encryption, a search method of the search system, an information processing device, a search program, a corresponding keyword management device, and a corresponding keyword management program.</p><heading id="h0002"><b>Background Art</b></heading><p id="p0002" num="0002">A searchable encryption system enables a search user to search for data stored in a server by specifying a keyword, and at that time the data and the keyword are kept secret to the server.</p><p id="p0003" num="0003">Searchable encryption systems are expected to be applied to outsourcing of confidential data management and filtering of encrypted mail messages in a mail server.<br/>
Thus, as techniques for searchable encryption systems, there have been proposed techniques for achieving various security requirements and techniques for reducing storage, communication overhead, and computational overhead of servers and search users.</p><p id="p0004" num="0004">In particular, in a searchable encryption technique based on deterministic encryption, the same keyword corresponds to the same encrypted keyword, so that a<!-- EPO <DP n="2"> --> server is only required to search for matching data based on a specified encrypted keyword. This allows acceleration using existing search techniques.</p><p id="p0005" num="0005">However, when a keyword is encrypted using deterministic encryption, the frequency information of the keyword is directly reflected in the frequency information of the encrypted keyword. Therefore, by investigating the frequency of an encrypted keyword, a corresponding keyword can be guessed. That is, an attack called "frequency analysis" is possible.</p><p id="p0006" num="0006">As a countermeasure against this frequency analysis, there is a method in which dummy data is inserted to disturb frequencies.<br/>
Patent Literature 1 discloses a method for generating dummy data using character strings not normally used in searching, such as punctuation marks. By this method, resistance against frequency analysis can be provided without increasing the database size.</p><heading id="h0003"><b>Citation List</b></heading><heading id="h0004"><b>Patent Literature</b></heading><p id="p0007" num="0007"><ul><li>Patent Literature 1: <patcit id="pcit0001" dnum="JP2005072917A"><text>JP 2005-72917 A</text></patcit></li></ul></p><heading id="h0005"><b>Disclosure of Invention</b></heading><heading id="h0006"><b>Technical Problem</b></heading><p id="p0008" num="0008">In the method for disturbing frequencies by inserting dummy data, if the frequencies of keywords vary greatly to begin with, it is necessary to provide a large amount of dummy data corresponding to differences in the frequencies.<br/>
In Patent Literature 1, the database size is prevented from being increased by using character strings not used in searching. However, with some types of database, there may be a small number of or no "character strings not used in searching". In this case, frequencies cannot be disturbed efficiently.<!-- EPO <DP n="3"> --></p><p id="p0009" num="0009">It is an object of the present invention, for example, to realize high-speed searchable encryption resistant to frequency analysis by efficiently disturbing frequencies regardless of how frequencies of keywords are distributed.</p><heading id="h0007"><b>Solution to Problem</b></heading><p id="p0010" num="0010">A search system according to the present invention includes an information processing device and a search device.<br/>
The information processing device includes<br/>
a corresponding keyword storage unit that stores as corresponding keyword data a corresponding keyword group associating a search keyword with one or more corresponding keywords;<br/>
a search keyword input unit that inputs a search keyword;<br/>
a corresponding keyword group acquisition unit that obtains from the corresponding keyword data stored in the corresponding keyword storage unit a corresponding keyword group associated with the search keyword input by the search keyword input unit;<br/>
an encrypted keyword group generation unit that encrypts corresponding keywords included in the corresponding keyword group obtained by the corresponding keyword group acquisition unit, thereby generating an encrypted keyword group;<br/>
a search request data transmission unit that transmits to the search device search request data including the encrypted keyword group generated by the encrypted keyword group generation unit;<br/>
a search response data receiving unit that receives search response data transmitted from the search device; and<br/>
a search result output unit that decrypts encrypted data included in the search response data received by the search response data receiving unit, and outputs as a<!-- EPO <DP n="4"> --> search result search data obtained by decryption.<br/>
The search device includes<br/>
an encrypted data storage unit that stores encrypted data generated by encrypting search data, the encrypted data storage unit storing for each search data the encrypted data generated by encrypting the each search data and an encrypted keyword generated by encrypting a corresponding keyword, the encrypted data and the encrypted keyword being associated with each other;<br/>
a search request data receiving unit that receives the search request data transmitted by the information processing device;<br/>
an encrypted data search unit that obtains encrypted data associated with a search key from the encrypted data storage unit using as the search key an encrypted keyword included in the encrypted keyword group in the search request data, based on the search request data received by the search request data receiving unit; and<br/>
a search response data transmission unit that transmits the search response data including the encrypted data obtained by the encrypted data search unit.</p><heading id="h0008"><b>Advantageous Effects of Invention</b></heading><p id="p0011" num="0011">According to the present invention, for example, by associating search data with a plurality of encrypted keywords, it is possible to efficiently disturb frequencies regardless of how frequencies of keywords are distributed and realize high-speed searchable encryption resistant to frequency analysis.</p><heading id="h0009"><b>Brief Description of Drawings</b></heading><p id="p0012" num="0012"><ul><li><figref idrefs="f0001">Fig. 1</figref> is a configuration diagram of a searchable encryption system 100 in a first embodiment;</li><li><figref idrefs="f0002">Fig. 2</figref> is a functional configuration diagram of an information processing device 200 in the first embodiment;<!-- EPO <DP n="5"> --></li><li><figref idrefs="f0003">Fig. 3</figref> is a functional configuration diagram of a server device 300 in the first embodiment;</li><li><figref idrefs="f0004">Fig. 4</figref> is a functional configuration diagram of a conversion rule management device 400 in the first embodiment;</li><li><figref idrefs="f0005">Fig. 5</figref> is a functional configuration diagram of a data registration device 500 in the first embodiment;</li><li><figref idrefs="f0006">Fig. 6</figref> is a flowchart illustrating a conversion rule management method of the conversion rule management device 400 in the first embodiment;</li><li><figref idrefs="f0007">Fig. 7</figref> is a diagram showing a search keyword table 491 in the first embodiment;</li><li><figref idrefs="f0008">Fig. 8</figref> is a flowchart illustrating an example of a conversion rule calculation process (S 110) in the first embodiment;</li><li><figref idrefs="f0009">Fig. 9</figref> is a diagram showing a conversion rule table 291 in the first embodiment;</li><li><figref idrefs="f0010">Fig. 10</figref> is a flowchart illustrating a data registration method of the data registration device 500 in the first embodiment;</li><li><figref idrefs="f0011">Fig. 11</figref> is a diagram showing a registration data table 391 in the first embodiment;</li><li><figref idrefs="f0012">Fig. 12</figref> is a diagram showing registration frequencies of encrypted keywords in the first embodiment;</li><li><figref idrefs="f0013">Fig. 13</figref> is a flowchart illustrating a search method of the information processing device 200 in the first embodiment;</li><li><figref idrefs="f0014">Fig. 14</figref> is a flowchart illustrating a search method of the server device 300 in the first embodiment;</li><li><figref idrefs="f0015">Fig. 15</figref> is a diagram showing an example of hardware resources of the<!-- EPO <DP n="6"> --> searchable encryption system 100 in the first embodiment;</li><li><figref idrefs="f0016">Fig. 16</figref> is a flowchart illustrating a conversion rule calculation process (S110) in a second embodiment;</li><li><figref idrefs="f0017">Fig. 17</figref> is a diagram showing a search keyword table 491 and a divided frequency table 492 in the second embodiment;</li><li><figref idrefs="f0018">Fig. 18</figref> is a schematic diagram of the conversion rule calculation process (S 110) in the second embodiment;</li><li><figref idrefs="f0019">Fig. 19</figref> is a schematic diagram of the conversion rule calculation process (S 110) in the second embodiment;</li><li><figref idrefs="f0020">Fig. 20</figref> is a schematic diagram of the conversion rule calculation process (S110) in the second embodiment;</li><li><figref idrefs="f0021">Fig. 21</figref> is a schematic diagram of the conversion rule calculation process (S 110) in the second embodiment;</li><li><figref idrefs="f0022">Fig. 22</figref> is a diagram showing a conversion rule table 291 in the second embodiment;</li><li><figref idrefs="f0023">Fig. 23</figref> is a diagram showing registration frequencies of encrypted keywords in the second embodiment;</li><li><figref idrefs="f0024">Fig. 24</figref> is a diagram showing another example of the search keyword table 491 and the divided frequency table 492 in the second embodiment;</li><li><figref idrefs="f0025">Fig. 25</figref> is a flowchart illustrating a re-division process (S116B) of the conversion rule calculation process (S 110) in the second embodiment;</li><li><figref idrefs="f0026">Fig. 26</figref> is a schematic diagram of the re-division process (S 116B) in the second embodiment;</li><li><figref idrefs="f0027">Fig. 27</figref> is a schematic diagram of the re-division process (S116B) in the second embodiment;<!-- EPO <DP n="7"> --></li><li><figref idrefs="f0028">Fig. 28</figref> is a diagram showing optimization of divided frequencies in the second embodiment;</li><li><figref idrefs="f0029">Fig. 29</figref> is a diagram showing optimization of divided frequencies in the second embodiment;</li><li><figref idrefs="f0030">Fig. 30</figref> is a diagram showing optimization of divided frequencies in the second embodiment;</li><li><figref idrefs="f0031">Fig. 31</figref> is a flowchart illustrating a conversion rule calculation process (S110) in a third embodiment;</li><li><figref idrefs="f0032">Fig. 32</figref> is a schematic diagram of the conversion rule calculation process (S110) in the third embodiment;</li><li><figref idrefs="f0033">Fig. 33</figref> is a schematic diagram of the conversion rule calculation process (S110) in the third embodiment;</li><li><figref idrefs="f0034">Fig. 34</figref> is a diagram showing a conversion rule table 291 in the third embodiment;</li><li><figref idrefs="f0035">Fig. 35</figref> is a diagram showing registration frequencies of encrypted keywords in the third embodiment;</li><li><figref idrefs="f0036">Fig. 36</figref> is a diagram showing a specific example of optimization of a divided frequency table 492 in the third embodiment;</li><li><figref idrefs="f0037">Fig. 37</figref> is a diagram showing another example of the conversion rule table 291 in the third embodiment;</li><li><figref idrefs="f0038">Fig. 38</figref> is a diagram showing another example of registration frequencies of encrypted keywords in the third embodiment;</li><li><figref idrefs="f0039">Fig. 39</figref> is a flowchart illustrating a conversion rule calculation process (S110) in a fourth embodiment;</li><li><figref idrefs="f0040">Fig. 40</figref> is a diagram showing a search keyword table 491 in the fourth<!-- EPO <DP n="8"> --> embodiment;</li><li><figref idrefs="f0041">Fig. 41</figref> is a diagram showing an example of a conversion rule table 291 in the fourth embodiment;</li><li><figref idrefs="f0042">Fig. 42</figref> is a diagram showing an example of combinations of search keywords and conversion keywords in the fourth embodiment; and</li><li><figref idrefs="f0043">Fig. 43</figref> is a diagram showing an example of combinations of search keywords and conversion keywords in the fourth embodiment.</li></ul></p><heading id="h0010"><b>Description of Preferred Embodiments</b></heading><heading id="h0011">First Embodiment</heading><p id="p0013" num="0013">Description will be directed to an embodiment of a searchable encryption system that searches for data using encrypted search keywords and prevents frequency analysis of the encrypted search keywords.</p><p id="p0014" num="0014"><figref idrefs="f0001">Fig. 1</figref> is a configuration diagram of a searchable encryption system 100 in a first embodiment.<br/>
Referring to <figref idrefs="f0001">Fig. 1</figref>, the searchable encryption system 100 in the first embodiment will be described in outline.</p><p id="p0015" num="0015">The searchable encryption system 100 (an example of a search system) includes an information processing device 200, a server device 300 (an example of a search device), a conversion rule management device 400 (an example of a corresponding keyword management device), and a data registration device 500 (an example of an encrypted data generation device). These devices communicate with one another through a network 101.</p><p id="p0016" num="0016"><ol><li>(1) The conversion rule management device 400 generates a conversion rule table associating each search keyword with a conversion keyword group (conversion rule generation process).<!-- EPO <DP n="9"> --></li><li>(2) Based on the conversion rule table, the data registration device 500 generates registration data associating encrypted data with an encrypted keyword, the encrypted data being encrypted search data and the encrypted keyword being an encrypted conversion keyword. Then, the data registration device 500 registers the registration data in the server device 300 (data registration process).</li><li>(3) The information processing device 200 obtains from the conversion rule table a conversion keyword group corresponding to a search keyword specified by a user, and encrypts the obtained conversion keyword group, thereby generating an encrypted keyword group. Then, the information processing device 200 requests the server device 300 to perform a data search by specifying the encrypted keyword group (search request process).</li><li>(4) Using as a search key an encrypted keyword included in the encrypted keyword group specified by the information processing device 200, the server device 300 searches for encrypted data corresponding to the search key. Then, the server device 300 returns the searched encrypted data to the information processing device 200 (search process).</li><li>(5) The information processing device 200 decrypts the encrypted data searched by the server device 300, and outputs as a search result search data obtained by decryption (search result output process).</li></ol></p><p id="p0017" num="0017">The searchable encryption system 100 will now be described in detail.</p><p id="p0018" num="0018"><figref idrefs="f0002">Fig. 2</figref> is a functional configuration diagram of the information processing device 200 in the first embodiment.<br/>
Referring to <figref idrefs="f0002">Fig. 2</figref>, the functional configuration of the information processing device 200 in the first embodiment will be described.</p><p id="p0019" num="0019">The information processing device 200 includes a search keyword input unit<!-- EPO <DP n="10"> --> 210, a conversion keyword group acquisition unit 220, an encrypted keyword group generation unit 230, a search request unit 240, a search result output unit 250, a processing device communication unit 280, and a processing device storage unit 290.</p><p id="p0020" num="0020">The processing device storage unit 290 (an example of a corresponding keyword storage unit) stores data to be used in the information processing device 200.<br/>
A conversion rule table 291, encryption key data 292, or decryption key data 293 is an example of data to be stored in the processing device storage unit 290.<br/>
The conversion rule table 291 (an example of corresponding keyword data) is data defining a conversion keyword group generated by associating a search keyword with one or more conversion keywords (corresponding keywords). For example, the conversion rule table 291 is data defining a plurality of search keywords and also defining as a conversion keyword group one or more conversion keywords for each search keywords.</p><p id="p0021" num="0021">The search keyword input unit 210 inputs a search keyword (search keyword input process).</p><p id="p0022" num="0022">The conversion keyword group acquisition unit 220 (an example of a corresponding keyword group acquisition unit) obtains from the conversion rule table 291 stored in the processing device storage unit 290 a conversion keyword group corresponding to the search keyword input by the search keyword input unit 210 (corresponding keyword group acquisition process).</p><p id="p0023" num="0023">Using the encryption key data 292, the encrypted keyword group generation unit 230 encrypts conversion keywords included in the conversion keyword group obtained by the conversion keyword group acquisition unit 220, thereby generating an encrypted keyword group (encrypted keyword group generation process).</p><p id="p0024" num="0024">The search request unit 240 (an example of a search request data transmission<!-- EPO <DP n="11"> --> unit and a search response data receiving unit) transmits to the server device 300 through the processing device communication unit 280 search request data including the encrypted keyword group generated by the encrypted keyword group generation unit 230 (search request data transmission process).<br/>
The search request unit 240 receives search response data transmitted by the server device 300 (search response data receiving process).</p><p id="p0025" num="0025">Using the decryption key data 293, the search result output unit 250 decrypts encrypted data included in the search response data received by the search request unit 240, and outputs as a search result search data obtained by decryption (search result output process).</p><p id="p0026" num="0026">The processing device communication unit 280 performs data communication.<br/>
For example, the processing device communication unit 280 transmits search request data to the server device 300, and receives search response data from the server device 300.<br/>
The processing device communication unit 280 also receives the conversion rule table 291 from the conversion rule management device 400, and stores the received conversion rule table 291 in the processing device storage unit 290.</p><p id="p0027" num="0027"><figref idrefs="f0003">Fig. 3</figref> shows a functional configuration of the server device 300 in the first embodiment.<br/>
Referring to <figref idrefs="f0003">Fig. 3</figref>, the functional configuration of the server device 300 in the first embodiment will be described.</p><p id="p0028" num="0028">The server device 300 includes a server device communication unit 310, a data search unit 320, a data registration unit 330, and a server device storage unit 390.</p><p id="p0029" num="0029">The server device storage unit 390 (an example of an encrypted data storage unit) stores data to be used in the server device 300.<br/>
<!-- EPO <DP n="12"> -->A registration data table 391 is an example of data to be stored in the server device storage unit 390.<br/>
The registration data table 391 is data associating encrypted data with an encrypted keyword, the encrypted data being encrypted search data and the encrypted keyword being an encrypted conversion keyword. For example, the registration data table 391 is data associating each encrypted data generated by encrypting each search data with an encrypted keyword generated by encrypting a specific conversion keyword.</p><p id="p0030" num="0030">The server device communication unit 310 (an example of a search request data receiving unit and a search response data transmission unit) performs data communication.<br/>
For example, the server device communication unit 310 receives search request data transmitted by the information processing device 200 (search request data receiving process).<br/>
The server device communication unit 310 also transmits search response data including encrypted data obtained by the data search unit 320 (search response data transmission process).<br/>
The server device communication unit 310 also receives registration request data transmitted by the data registration device 500 (registration request data receiving process).</p><p id="p0031" num="0031">Based on the search request data received by the server device communication unit 310, the data search unit 320 obtains from the registration data table 391 encrypted data corresponding to a search key using as the search key an encrypted keyword included in an encrypted keyword group in the search request data (data search process).<!-- EPO <DP n="13"> --></p><p id="p0032" num="0032">The data registration unit 330 sets in the registration data table 391 registration data (encrypted data, encrypted keyword) included in the registration request data received by the server device communication unit 310 (data registration process).</p><p id="p0033" num="0033"><figref idrefs="f0004">Fig. 4</figref> is a functional configuration diagram of the conversion rule management device 400 in the first embodiment.<br/>
Referring to <figref idrefs="f0004">Fig. 4</figref>, the functional configuration of the conversion rule management device 400 in the first embodiment will be described.</p><p id="p0034" num="0034">The conversion rule management device 400 (corresponding keyword management device) includes a conversion rule calculation unit 410, a conversion keyword group generation unit 420, a conversion rule generation unit 430, a management device communication unit 440, and a management device storage unit 490.</p><p id="p0035" num="0035">The management device storage unit 490 stores data to be used in the conversion rule management device 400.<br/>
A search keyword table 491 is an example of data to be stored in the management device storage unit 490.<br/>
The search keyword table 491 (an example of appearance frequency data) is data defining search keywords and defining as an appearance frequency of a specific search keyword a rate of search data to be associated with the specific search keyword.</p><p id="p0036" num="0036">The conversion rule calculation unit 410 (an example of a corresponding keyword number calculation unit) calculates as a conversion keyword number the number of conversion keywords to be associated with each search keyword, according to the appearance frequency of each search keyword defined in the search keyword table 491 (corresponding keyword number calculation process).<br/>
Based on the appearance frequency of each search keyword defined in the<!-- EPO <DP n="14"> --> search keyword table 491, the conversion rule calculation unit 410 calculates as a conversion probability (corresponding keyword selection rate) a rate at which each corresponding keyword of the search keyword is selected from the corresponding keyword group of the search keyword (corresponding keyword selection rate calculation process).</p><p id="p0037" num="0037">For example, the conversion rule calculation unit 410 calculates the conversion keyword number and the conversion probability as described below.</p><p id="p0038" num="0038">The conversion rule calculation unit 410 calculates the conversion keyword number of each search keyword such that the appearance frequency of each search keyword after being divided by the conversion keyword number is uniform.</p><p id="p0039" num="0039">The conversion rule calculation unit 410 calculates the greatest common divisor of appearance frequencies of the search keywords, and calculates as the conversion keyword number of each search keyword a value obtained by dividing the appearance frequency of each search keyword by the greatest common divisor.</p><p id="p0040" num="0040">For each search keyword, the conversion rule calculation unit 410 calculates as the conversion probability an inverse number of the conversion keyword number.</p><p id="p0041" num="0041">The conversion keyword group generation unit 420 (an example of a corresponding keyword group generation unit) generates as a conversion keyword group the same number of conversion keywords as the conversion keyword number calculated by the conversion rule calculation unit 410 (corresponding keyword group generation process).</p><p id="p0042" num="0042">The conversion rule generation unit 430 (an example of a corresponding keyword data generation unit) generates the conversion rule table 291 (an example of corresponding keyword data and corresponding keyword selection rate data) by associating each search keyword with a conversion keyword group and conversion<!-- EPO <DP n="15"> --> probabilities (corresponding keyword data generation process).</p><p id="p0043" num="0043">The management device communication unit 440 performs data communication.<br/>
For example, the management device communication unit 440 transmits the conversion rule table 291 generated by the conversion rule generation unit 430 to the information processing device 200 and the data registration device 500.</p><p id="p0044" num="0044"><figref idrefs="f0005">Fig. 5</figref> is a functional configuration diagram of the data registration device 500 in the first embodiment.<br/>
Referring to <figref idrefs="f0005">Fig. 5</figref>, the functional configuration of the data registration device 500 in the first embodiment will be described.</p><p id="p0045" num="0045">The data registration device 500 (an example of an encrypted data generation device) includes a registration device input unit 510, a keyword conversion unit 520, a registration data generation unit 530, a registration request unit 540, a registration device communication unit 580, and a registration device storage unit 590.</p><p id="p0046" num="0046">The registration device storage unit 590 (an example of a search data storage unit and a keyword selection rate storage unit) stores data to be used in the data registration device 500.<br/>
A search data table 591, the conversion rule table 291, or the encryption key data 292 is an example of data to be stored in the registration device storage unit 590.<br/>
The search data table 591 is data associating search data with a search keyword.</p><p id="p0047" num="0047">The keyword conversion unit 520 (an example of a corresponding keyword selection unit) obtains from the conversion rule table 291 a conversion keyword group corresponding to each search keyword included in the search data table 591.<br/>
According to the conversion probabilities included in the conversion rule table<!-- EPO <DP n="16"> --> 291, the keyword conversion unit 520 selects at least any one of the conversion keywords included in the obtained conversion keyword group (corresponding keyword selection process).</p><p id="p0048" num="0048">Using the encryption key data 292, the registration data generation unit 530 (an example of an encrypted data generation unit) encrypts each search data included in the search data table 591, thereby generating encrypted data (encrypted data generation process).<br/>
Using the encryption key data 292, the registration data generation unit 530 encrypts the conversion keyword selected by the keyword conversion unit 520, thereby generating an encrypted keyword (encrypted keyword generation process).</p><p id="p0049" num="0049">The registration request unit 540 transmits to the server device 300 through the registration device communication unit 580 registration request data that is set by associating the encrypted data and the encrypted keyword generated by the registration data generation unit 530 (registration request process).</p><p id="p0050" num="0050">The registration device communication unit 580 performs data communication.<br/>
For example, the registration device communication unit 580 transmits registration request data to the server device 300.</p><p id="p0051" num="0051"><figref idrefs="f0006">Fig. 6</figref> is a flowchart illustrating a conversion rule management method of the conversion rule management device 400 in the first embodiment.<br/>
Referring to <figref idrefs="f0006">Fig. 6</figref>, the conversion rule management method of the conversion rule management device 400 in the first embodiment will be described.</p><p id="p0052" num="0052">First, the conversion rule management method of the conversion rule management device 400 will be described in outline.</p><p id="p0053" num="0053">Based on the appearance frequency of each search keyword, the conversion<!-- EPO <DP n="17"> --> rule calculation unit 410 calculates the conversion keyword number and the conversion probability of each conversion keyword (S110).<br/>
The conversion keyword group generation unit 420 generates the same number of conversion keywords as the conversion keyword number (conversion keyword group) (S120).<br/>
The conversion rule generation unit 430 generates the conversion rule table 291 by associating each search keyword with a conversion keyword group and conversion probabilities of respective conversion keywords (S130).<br/>
The management device communication unit 440 transmits the conversion rule table 291 to the information processing device 200 and the data registration device 500 (S 140).</p><p id="p0054" num="0054">The conversion rule management method of the conversion rule management device 400 will now be described in detail.</p><p id="p0055" num="0055">In S110, the conversion rule calculation unit 410 obtains the search keyword table 491 from the management device storage unit 490. The search keyword table 491 is prestored in the management device storage unit 490.</p><p id="p0056" num="0056"><figref idrefs="f0007">Fig. 7</figref> is a diagram showing the search keyword table 491 in the first embodiment.<br/>
As shown in <figref idrefs="f0007">Fig. 7</figref>, the search keyword table 491 is data associating each search keyword with an appearance frequency.<br/>
An appearance frequency indicates a rate of search data for which a corresponding search keyword is used as a search key. For example, when a search keyword "Company A" is used as a search key for 25 out of 100 pieces of search data, the appearance frequency of the search keyword "Company A" is "25% (= 25/100)".</p><p id="p0057" num="0057">Referring back to <figref idrefs="f0006">Fig. 6</figref>, the description of S110 continues.<!-- EPO <DP n="18"> --></p><p id="p0058" num="0058">In S110, based on the search keyword table 491, the conversion rule calculation unit 410 calculates as the "conversion keyword number" a frequency division number such that the appearance frequencies of the search keywords after being divided are equal.<br/>
Further, the conversion rule calculation unit 410 calculates as the "conversion probability" an inverse number of the conversion keyword number.</p><p id="p0059" num="0059">For example, the search keyword table 491 shown in <figref idrefs="f0007">Fig. 7</figref> defines the appearance frequency of a search keyword "Company A" as "25%", the appearance frequency of a search keyword "Company B" as "15%", and the appearance frequency of each of other search keywords as "5%".<br/>
In this case, if the appearance frequency "25%" of the search keyword "(Company A" is divided by 5 and the appearance frequency "15%" of the search keyword "Company B" is divided by 3, appearance frequencies after being divided are all equal, being "5%".<br/>
Accordingly, the conversion rule calculation unit 410 calculates frequency division number "5" as the conversion keyword number of the search keyword "Company A", frequency division number "3" as the conversion keyword number of the search keyword "Company B", and frequency division number "1" as the conversion keyword number of each of the other search keywords.<br/>
The conversion rule calculation unit 410 also calculates conversion probability "1/5" of the search keyword "Company A", conversion probability "1/3" of the search keyword "Company B", and conversion probability "1/1" of each of the other search keywords.</p><p id="p0060" num="0060">For example, the conversion rule calculation unit 410 calculates the conversion keyword numbers and the conversion probabilities using the greatest<!-- EPO <DP n="19"> --> common divisor of appearance frequencies.</p><p id="p0061" num="0061"><figref idrefs="f0008">Fig. 8</figref> is a flowchart illustrating an example of a conversion rule calculation process (S110) in the first embodiment.<br/>
Referring to <figref idrefs="f0008">Fig. 8</figref>, the conversion rule calculation process (S 110) will be described in which the conversion keyword numbers and the conversion probabilities are calculated using the greatest common divisor of appearance frequencies.</p><p id="p0062" num="0062">In S111, based on the appearance frequencies of the search keywords set in the search keyword table 491, the conversion rule calculation unit 410 calculates the greatest common divisor of the appearance frequencies.<br/>
For example, in the case of the search keyword table 491 shown in <figref idrefs="f0007">Fig. 7</figref>, the greatest common divisor of the appearance frequencies is "5%".<br/>
After S111, processing proceeds to S 112.</p><p id="p0063" num="0063">In S112, the conversion rule calculation unit 410 divides the appearance frequency of each search keyword by the greatest common divisor. A value obtained by this division is the conversion keyword number.<br/>
For example, in the case of <figref idrefs="f0007">Fig. 7</figref>, the conversion keyword number of the search keyword "Company A" is "5 (= 25% ÷ 5%)" obtained by dividing the appearance frequency "25%" by the greatest common divisor "5%".<br/>
After S 112, processing proceeds to S 113.</p><p id="p0064" num="0064">In S113, the conversion rule calculation unit 410 calculates as the conversion probability an inverse number of the conversion keyword number for each search keyword.<br/>
For example, in the case of <figref idrefs="f0007">Fig. 7</figref>, the conversion probability of the search keyword "Company A" is inverse number "1/5" of the conversion keyword number "5".<br/>
S 113 completes the conversion rule calculation process (S110).<!-- EPO <DP n="20"> --></p><p id="p0065" num="0065">Referring back to <figref idrefs="f0006">Fig. 6</figref>, the description of the conversion rule management method continues.</p><p id="p0066" num="0066">After S110, processing proceeds to S120.</p><p id="p0067" num="0067">In S120, the conversion keyword group generation unit 420 generates the same number of conversion keywords as the conversion keyword number for each search keyword. The same number of conversion keywords as the conversion keyword number will be hereinafter referred to as a "conversion keyword group".<br/>
For example, when the conversion keyword number of the search keyword "Company A" is "5", the conversion keyword group generation unit 420 generates a conversion keyword group of "Company A-1", "Company A-2", "Company A-3", "Company A-4", and "Company A-5" by adding serial numbers at the end of the search keyword "Company A".<br/>
Note that a conversion keyword not including a search keyword may be used. For example, a conversion keyword may be a combination of randomly selected characters, numerical values, symbols and so on. A one-way function may be used to generate a conversion keyword.<br/>
After S120, processing proceeds to S 130.</p><p id="p0068" num="0068">In S 130, the conversion rule generation unit 430 generates the conversion rule table 291 by associating each search keyword set in the search keyword table 491 with the conversion probabilities calculated in S 110 and the conversion keyword group generated in S120.</p><p id="p0069" num="0069"><figref idrefs="f0009">Fig. 9</figref> is a diagram showing the conversion rule table 291 in the first embodiment.<br/>
As shown in <figref idrefs="f0009">Fig. 9</figref>, the conversion rule table 291 is data associating search keywords, conversion probabilities, and conversion keywords.<br/>
<!-- EPO <DP n="21"> -->The conversion rule table 291 shown in <figref idrefs="f0009">Fig. 9</figref> is generated based on the search keyword table 491 shown in <figref idrefs="f0007">Fig. 7</figref>. That is, the appearance frequencies of the conversion keywords are equal, being "5%", as explained with reference to <figref idrefs="f0007">Fig. 7</figref>.</p><p id="p0070" num="0070">Referring back to <figref idrefs="f0006">Fig. 6</figref>, the description of the conversion rule management method continues.</p><p id="p0071" num="0071">After S130, processing proceeds to S140.</p><p id="p0072" num="0072">In S140, the management device communication unit 440 transmits the conversion rule table 291 generated in S 130 to the information processing device 200 and the data registration device 500.<br/>
The processing device communication unit 280 of the information processing device 200 receives the conversion rule table 291, and stores the received conversion rule table 291 in the processing device storage unit 290.<br/>
The registration device communication unit 580 of the data registration device 500 also receives the conversion rule table 291, and stores the received conversion rule table 291 in the registration device storage unit 590.<br/>
S 140 completes the process of the conversion rule management method.</p><p id="p0073" num="0073"><figref idrefs="f0010">Fig. 10</figref> is a flowchart illustrating a data registration method of the data registration device 500 in the first embodiment.<br/>
Referring to <figref idrefs="f0010">Fig. 10</figref>, the data registration method of the data registration device 500 in the first embodiment will be described.</p><p id="p0074" num="0074">First, the data registration method of the data registration device 500 will be described in outline.</p><p id="p0075" num="0075">The registration device input unit 510 inputs search data and a search keyword (S210).<br/>
The keyword conversion unit 520 selects from the conversion rule table 291 a<!-- EPO <DP n="22"> --> conversion keyword corresponding to the input keyword (S220).<br/>
The registration data generation unit 530 encrypts the input data and the selected keyword, thereby generating registration data (S230).<br/>
The registration request unit 540 transmits registration request data including the registration data to the server device 300 (S240).</p><p id="p0076" num="0076">The data registration method of the data registration device 500 will now be described in detail.</p><p id="p0077" num="0077">In S210, using an input device such as a keyboard or a mouse, an administrator specifies to the data registration device 500 a combination of search data and a search keyword. A numerical value such as an age, an attribute such as a gender, a character string such as a name, and a file such as a document are examples of search data.<br/>
The registration device input unit 510 inputs from the input device the combination of search data and the search keyword specified by the administrator.<br/>
Note that a plurality of combinations of search data and a search keyword may be prestored in the registration device storage unit 590, and the registration device input unit 510 may input each combination of search data and a search keyword from the registration device storage unit 590.<br/>
The search data and the search keyword input in S210 will be hereinafter respectively referred to as the "input data" and the "input keyword".<br/>
After S210, processing proceeds to S220.</p><p id="p0078" num="0078">In S220, the keyword conversion unit 520 obtains the conversion rule table 291 (see <figref idrefs="f0009">Fig. 9</figref>) from the registration device storage unit 590.<br/>
The keyword conversion unit 520 obtains from the conversion rule table 291 a conversion keyword group corresponding to the same search keyword as the input keyword.<br/>
<!-- EPO <DP n="23"> -->The keyword conversion unit 520 randomly selects one conversion keyword from the obtained conversion keyword group. Note that a selection probability of selecting each conversion keyword depends on the conversion probability set in the conversion rule table 291.<br/>
The conversion keyword selected in S220 will be hereinafter referred to as the "selected keyword".</p><p id="p0079" num="0079">For example, in the case of the conversion rule table 291 shown in <figref idrefs="f0009">Fig. 9</figref>, one of the conversion keywords "Company A-1", "Company A-2", "Company A-3", "Company A-4", and "Company A-5" is selected for the input keyword "Company A". A probability of each conversion keyword being selected (conversion probability) is "1/5".<br/>
That is, when there are 100 pieces of the input keyword "Company A", "Company A-1", "Company A-2", "Company A-3", "Company A-4" and "Company A-5" are respectively selected approximately 20 times.</p><p id="p0080" num="0080">After S220, processing proceeds to S230.</p><p id="p0081" num="0081">In S230, the registration data generation unit 530 obtains the encryption key data 292 from the registration device storage unit 590. The encryption key data 292 is generated by a predetermined key generation algorithm and is prestored in the registration device storage unit 590.<br/>
Using the encryption key data 292, the registration data generation unit 530 encrypts the input data by a predetermined encryption algorithm. The encrypted input data will be hereinafter referred to as the "encrypted data".<br/>
Using the encryption key data 292, the registration data generation unit 530 encrypts the selected keyword by a predetermined encryption algorithm (deterministic encryption). The encrypted selected keyword will be hereinafter referred to as the<!-- EPO <DP n="24"> --> "encrypted keyword".<br/>
Note that encryption key data used for encrypting the selected keyword may be different from the encryption key data used for encrypting the input data. An encryption algorithm used for encrypting the selected keyword may be different from the encryption algorithm used for encrypting the input data.<br/>
A combination of the encrypted data and the encrypted keyword will be hereinafter referred to as "registration data".<br/>
After S230, processing proceeds to S240.</p><p id="p0082" num="0082">In S240, the registration request unit 540 generates registration request data including the registration data generated in S230, and transmits the generated registration request data to the server device 300 through the registration device communication unit 580. Note that the registration request unit 540 may transmit to the server device 300 registration request data including a plurality of registration data.<br/>
The server device communication unit 310 of the server device 300 receives the registration request data, and registers (sets) the registration data included in the received registration request data in the registration data table 391.<br/>
S240 completes the process of the data registration method.</p><p id="p0083" num="0083"><figref idrefs="f0011">Fig. 11</figref> is a diagram showing the registration data table 391 in the first embodiment.<br/>
As shown in <figref idrefs="f0011">Fig. 11</figref>, the registration data table 391 (also referred to as a database) is data including a plurality of combinations of an encrypted keyword and encrypted data (registration data). That is, the registration data table 391 is data associating each encrypted keyword with each encrypted data.<br/>
"E(x)" denotes data of encrypted "x".</p><p id="p0084" num="0084">As described above, the conversion keywords are selected according to the<!-- EPO <DP n="25"> --> uniform conversion probabilities defined in the conversion rule table 291 (<figref idrefs="f0010">Fig. 10</figref>, S220). Thus, when a sufficient number of pieces of registration data are registered in the registration data table 391, the number of each encrypted keyword included in the registration table 391 is approximately uniform.</p><p id="p0085" num="0085">Encrypted keywords and encrypted data may be stored in respectively different tables or storage devices. For example, there may be a table associating encrypted keywords and data IDs of encrypted data and a table associating data IDs and encrypted data.</p><p id="p0086" num="0086"><figref idrefs="f0012">Fig. 12</figref> is a diagram showing registration frequencies of encrypted keywords in the first embodiment.<br/>
For example, when conversion keywords are selected based on the conversion rule table 291 shown in <figref idrefs="f0009">Fig. 9</figref> and the selected conversion keywords are encrypted, the rates (registration frequencies) of the encrypted keywords registered in the registration data table 391 are equalized to "5%" (see <figref idrefs="f0012">Fig. 12</figref>).</p><p id="p0087" num="0087">Therefore, when frequency analysis is performed on encrypted keywords based on the registration data table 391 stored in the server device 300, a search keyword cannot be guessed from an encrypted keyword. This is because there is practically no difference in the registration frequencies of the encrypted keywords.</p><p id="p0088" num="0088"><figref idrefs="f0013">Fig. 13</figref> is a flowchart illustrating a search method of the information processing device 200 in the first embodiment.<br/>
Referring to <figref idrefs="f0013">Fig. 13</figref>, the search method of the information processing device 200 in the first embodiment will be described.</p><p id="p0089" num="0089">First, the search method of the information processing device 200 will be described in outline.</p><p id="p0090" num="0090">The search keyword input unit 210 inputs a search keyword (S310).<br/>
<!-- EPO <DP n="26"> -->The conversion keyword group acquisition unit 220 obtains from the conversion rule table 291 a conversion keyword group corresponding to the input keyword (S320).<br/>
The encrypted keyword group generation unit 230 encrypts the conversion keyword group, thereby generating an encrypted keyword group (S330).<br/>
The search request unit 240 transmits search request data including the encrypted keyword group to the server device 300 (S340).<br/>
The search request unit 240 receives search response data including encrypted data from the server device 300 (S350).<br/>
The search result output unit 250 decrypts the encrypted data included in the search response data, and outputs as a search result search data obtained by decryption (S360).</p><p id="p0091" num="0091">The search method of the information processing device 200 will now be described in detail.</p><p id="p0092" num="0092">In S310, using an input device such as a keyboard or a mouse, a user specifies a search keyword to the information processing device 200.<br/>
The search keyword input unit 210 inputs from the input device the search keyword specified by the user.<br/>
The search keyword input in S310 will be hereinafter referred to as the "input keyword".<br/>
After S310, processing proceeds to S320.</p><p id="p0093" num="0093">In S320, the conversion keyword group acquisition unit 220 obtains a conversion keyword group corresponding to the input keyword from the conversion rule table 291 stored in the processing device storage unit 290.<br/>
For example, the conversion keyword group acquisition unit 220 obtains from<!-- EPO <DP n="27"> --> the conversion rule table 291 shown in <figref idrefs="f0009">Fig. 9</figref> the conversion keyword group of "(Company A-1", "Company A-2", "Company A-3", "Company A-4", and "Company A-5" corresponding to the input keyword "Company A".<br/>
After S320, processing proceeds to S330.</p><p id="p0094" num="0094">In S330, the encrypted keyword group generation unit 230 obtains the encryption key data 292 from the processing device storage unit 290.<br/>
Using the encryption key data 292, the encrypted keyword group generation unit 230 encrypts each conversion keyword included in the conversion keyword group obtained in S320 by a predetermined encryption algorithm (determinitic encryption).<br/>
Note that the encryption key data 292 and the encryption algorithm used in S330 are the same as the encryption key data and the encryption algorithm used for encrypting a search keyword in generation of registration data (S230 of <figref idrefs="f0010">Fig. 10</figref>).<br/>
An encrypted conversion keyword will be hereinafter referred to as an "encrypted keyword" and data consisting of encrypted keywords will be referred to as an "encrypted keyword group".<br/>
After S330, processing proceeds to S340.</p><p id="p0095" num="0095">In S340, the search request unit 240 generates search request data including the encrypted keyword group generated in S330, and transmits the generated search request data to the server device 300 through the processing device communication unit 280.<br/>
For example, in the case of the conversion rule table 291 shown in <figref idrefs="f0009">Fig. 9</figref>, the search request data for the input keyword "Company A" includes an encrypted keyword group of "E (Company A-1)", "E (Company A-2)", "E (Company A-3)", "E (Company A-4)", and "E (Company A-5)".<br/>
After S340, processing proceeds to S350.<!-- EPO <DP n="28"> --></p><p id="p0096" num="0096">In S350, the server device 300 searches for encrypted data based on the search request data, and transmits to the information processing device 200 search response data including one or a plurality of pieces of encrypted data found as a result of searching.<br/>
The search request unit 240 receives through the processing device communication unit 280 the search response data transmitted from the server device 300.<br/>
After S350, processing proceeds to S360.</p><p id="p0097" num="0097">In S360, the search result output unit 250 obtains the decryption key data 293 from the processing device storage unit 290.<br/>
Using the decryption key data 293, the search result output unit 250 decrypts each encrypted data included in the search response data by a predetermined decryption algorithm.<br/>
The search result output unit 250 outputs each search data obtained by decryption as a search result for the input keyword. For example, the search result output unit 250 displays the search result on a display device.<br/>
Note that the decryption key data 293 used in S360 is data paired with the encryption key data used for encrypting search data (S203 of <figref idrefs="f0010">Fig. 10</figref>). The decryption algorithm used in S360 is an algorithm paired with the encryption algorithm used for encrypting search data.<br/>
S360 completes the search method of the information processing device 200.</p><p id="p0098" num="0098"><figref idrefs="f0014">Fig. 14</figref> is a flowchart illustrating a search method of the server device 300 in the first embodiment.<br/>
Referring to <figref idrefs="f0014">Fig. 14</figref>, the search method of the server device 300 in the first embodiment will be described.<!-- EPO <DP n="29"> --></p><p id="p0099" num="0099">First, the search method of the server device 300 will be described in outline.</p><p id="p0100" num="0100">The server device communication unit 310 receives search request data including a search request keyword group (S410).<br/>
The data search unit 320 obtains from the registration data table 391 encrypted data corresponding to a search request keyword in the search request keyword group (S420).<br/>
The server device communication unit 310 transmits to the information processing device 200 search response data including the encrypted data (S430).</p><p id="p0101" num="0101">The search method of the server device 300 will now be described in detail.</p><p id="p0102" num="0102">In S410, the server device communication unit 310 receives search request data transmitted from the information processing device 200.<br/>
An encrypted keyword group (encrypted keywords) included in the search request data will be hereinafter referred to as a "search request keyword group (search request keywords)".<br/>
After S410, processing proceeds to S420.</p><p id="p0103" num="0103">In S420, the data search unit 320 searches through the registration data table 391 (see <figref idrefs="f0011">Fig. 11</figref>) using as a search key each search request keyword included in the search request keyword group. That is, the data search unit 320 searches through the registration data table 391 and identifies an encrypted keyword that matches at least any one of the search request keywords (OR search).<br/>
An encrypted keyword that matches a search key will be referred to as a "target keyword".</p><p id="p0104" num="0104">Then, the data search unit 320 obtains from the registration data table 391 encrypted data corresponding to each target keyword.</p><p id="p0105" num="0105">For example, in the case of the registration data table 391 shown in <figref idrefs="f0011">Fig. 11</figref>, the<!-- EPO <DP n="30"> --> data search unit 320 obtains encrypted data "E (data a)", "E (data b)", and "E (data d)" for a search request keyword group of "E (Company A-1)", "E (Company A-2)", "E (Company A-3)", "E (Company A-4)", and "E (Company A-5)".</p><p id="p0106" num="0106">The search process (S420) may be accelerated using a conventional search technique (for example, a technique using a hash table).</p><p id="p0107" num="0107">After S420, processing proceed to S430.</p><p id="p0108" num="0108">In S430, the data search unit 320 generates search response data including each encrypted data obtained in S420.<br/>
Then, the server device communication unit 310 transmits to the information processing device 200 the search response data generated by the data search unit 320.<br/>
S430 completes the search method of the server device 300.</p><p id="p0109" num="0109"><figref idrefs="f0015">Fig. 15</figref> is a diagram showing an example of hardware resources of the searchable encryption system 100 in the first embodiment.<br/>
In <figref idrefs="f0015">Fig. 15</figref>, each of the information processing device 200, the server device 300, the conversion rule management device 400, and the data registration device 500 includes a CPU 901 (Central Processing Unit). The CPU 901 is connected through a bus 902 with a ROM 903, a RAM 904, a communication board 905, a display device 911, a keyboard 912, a mouse 913, a drive device 914, and a magnetic disk device 920, and controls these hardware devices. The drive device 914 is a device that reads from and writes to storage media such as an FD (Flexible Disk Drive), a CD (Compact Disc), and a DVD (Digital Versatile Disc).</p><p id="p0110" num="0110">The communication board 905 is connected with a communication network such as a LAN (Local Area Network), the Internet, or a telephone line in a wired or wireless fashion.</p><p id="p0111" num="0111">The magnetic disk device 920 stores an OS 921 (operating system), programs<!-- EPO <DP n="31"> --> 922, and files 923.</p><p id="p0112" num="0112">The programs 922 include programs that execute functions described as "... unit" in the embodiments. The programs are read and executed by the CPU 901. That is, each program causes a computer to function as "... unit" or causes the computer to execute a procedure or a method of "... unit".</p><p id="p0113" num="0113">The files 923 include various types of data (inputs, outputs, determination results, calculation results, processing results, etc.) used in "... unit" described in the embodiments.</p><p id="p0114" num="0114">In the embodiments, arrows included in the configuration diagrams and the flowcharts mainly denote inputs/outputs of data and signals.</p><p id="p0115" num="0115">In the embodiments, what is described as "... unit" may be "... circuit", "... device" or "... equipment" and may also be "... step", "... procedure", or "... process". That is, what is described as "... unit" may be implemented by any of firmware, software, hardware, or a combination thereof.</p><p id="p0116" num="0116">In the first embodiment, the searchable encryption system 100 such as described below, for example, has been discussed.</p><p id="p0117" num="0117">The information processing device 200 performs a search without revealing data and keywords to the server device 300.<br/>
Since deterministic encryption is used instead of probabilistic encryption, it is only necessary to search for exactly matching binary data in searching. With this arrangement, a faster search can be performed using existing search techniques.<br/>
Deterministic encryption is an encryption scheme in which there is a one-to-one correspondence between plaintext data and encrypted data. That is, encrypted data is uniquely determined by plaintext data.<br/>
Probabilistic encryption is an encryption scheme in which plaintext data has a<!-- EPO <DP n="32"> --> plurality of corresponding encrypted data. Encrypted data is not uniquely determined by plaintext data.</p><p id="p0118" num="0118">The searchable encryption system 100 does not require dummy data which is required in Patent Literature 1. Thus, storage areas can be used efficiently.</p><p id="p0119" num="0119">The conversion rule table 291 is generated for the purpose of providing resistance to frequency analysis by an attacker with respect to the frequency information (appearance frequency, registration frequency) of a given keyword (for example, an encrypted keyword).<br/>
The conversion rule table 291 may be encrypted for enhanced security.</p><p id="p0120" num="0120">The information processing device 200, the server device 300, the conversion rule management device 400, or the data registration device 500 may be combined or separated.<br/>
For example, the information processing device 200 may include functions of the conversion rule management device 400 or the data registration device 500.</p><p id="p0121" num="0121">Encrypted data may be associated with one or a plurality of encrypted keywords. When encrypted data is associated with a plurality of encrypted keywords, the encrypted data is treated as matching data for a search if the search request keyword group includes all the encrypted keywords, or if the search request keyword group includes at least any one of the encrypted keywords.<br/>
One encrypted keyword may be associated with a plurality of encrypted data. In this case, if the search request keyword group includes the encrypted keyword, all or at least any of the plurality of encrypted data is treated as matching data for a search.</p><p id="p0122" num="0122">The encryption key data 292 may be input from an IC card or the like, or may be automatically generated based on user information such as a password and biological information.<!-- EPO <DP n="33"> --></p><heading id="h0012">Second Embodiment</heading><p id="p0123" num="0123">An embodiment of the searchable encryption system 100 that satisfies "k-anonymity" will be described.<br/>
Features that are different from the first embodiment will be mainly described hereinafter. Features not described are substantially the same as described in the first embodiment.</p><p id="p0124" num="0124">"k-anonymity" is a property of making frequency analysis of encrypted keywords difficult by providing "k" or more encrypted keywords having the same registration frequency.</p><p id="p0125" num="0125">The configuration of devices of the searchable encryption system 100 and the functional configuration of each device are the same as described in the first embodiment (see <figref idrefs="f0001 f0002 f0003 f0004 f0005">Figs. 1 to 5</figref>).</p><p id="p0126" num="0126">Note that the conversion rule calculation unit 410 of the conversion rule management device 400 calculates the conversion keyword number and the conversion probability as described below.<br/>
The conversion rule calculation unit 410 calculates as the conversion keyword number (corresponding keyword number) of each search keyword a division number based on which the appearance frequency of each search keyword is divided, such that "k" or more search keywords have the same appearance frequency, "k" being a predetermined anonymity number.<br/>
The conversion rule calculation unit 410 calculates as the conversion probability (corresponding keyword selection rate) of each search keyword a division rate based on which the appearance frequency of each search keyword is divided (divided frequency to be described later).</p><p id="p0127" num="0127">For example, the conversion rule calculation unit 410 calculates the<!-- EPO <DP n="34"> --> conversion keyword number and the conversion probability as described below.<br/>
The conversion rule calculation unit 410 selects as a computing frequency the "k"th greatest appearance frequency from the appearance frequencies of the search keywords, where k is the predetermined anonymity number.<br/>
The conversion rule calculation unit 410 subtracts the computing frequency one or more times from each appearance frequency greater than or equal to the computing frequency.<br/>
The conversion rule calculation unit 410 selects as a new computing frequency the "k"th greatest appearance frequency from the appearance frequencies of the search keywords after subtraction.<br/>
The conversion rule calculation unit 410 subtracts the new computing frequency one or more times from each appearance frequency greater than or equal to the new computing frequency.<br/>
For each search keyword, the conversion rule calculation unit 410 calculates as the conversion keyword number the number of times each of the computing frequencies is subtracted from the appearance frequency.<br/>
For each search keyword, the conversion rule calculation unit 410 calculates as the conversion probability a rate of each computing frequency with respect to the original appearance frequency.</p><p id="p0128" num="0128"><figref idrefs="f0016">Fig. 16</figref> is a flowchart illustrating a conversion rule calculation process (S110) in the second embodiment.<br/>
Referring to <figref idrefs="f0016">Fig. 16</figref>, the conversion rule calculation process (S110) in the second embodiment will be described.</p><p id="p0129" num="0129">In S111B, the conversion rule calculation unit 410 generates a divided frequency table 492 including a search keyword table 491.<!-- EPO <DP n="35"> --></p><p id="p0130" num="0130"><figref idrefs="f0017">Fig. 17</figref> is a diagram showing the search keyword table 491 and the divided frequency table 492 in the second embodiment.<br/>
As shown in <figref idrefs="f0017">Fig. 17</figref>, the search keyword table 491 is data associating each "search keyword" with an "appearance frequency". Note that appearance frequencies are represented as integer ratios.<br/>
The divided frequency table 492 is data including the search keyword table 491, and is data associating each "search keyword" with an "appearance frequency" and a "divided frequency".</p><p id="p0131" num="0131">Referring back to <figref idrefs="f0016">Fig. 16</figref>, the description of the conversion rule calculation process (S110) continues.</p><p id="p0132" num="0132">After S111B, processing proceeds to S112B.</p><p id="p0133" num="0133">In S112B, the conversion rule calculation unit 410 selects the "k"th greatest appearance frequency from the divided frequency table 492.<br/>
"k" denotes an anonymity number "k" defined as a parameter value of "k-anonymity".<br/>
For example, in the case of "3-anonymity (k=3)", the conversion rule calculation unit 410 selects the third greatest appearance frequency "28" from the divided frequency table 492 shown in <figref idrefs="f0017">Fig. 17</figref>.<br/>
The appearance frequency selected in S111B will be hereinafter referred to as the "computing frequency".<br/>
After S112B, processing proceeds to S113B.</p><p id="p0134" num="0134">In S113B, the conversion rule calculation unit 410 selects from the divided frequency table 492 an appearance frequency greater than or equal to the computing frequency. The appearance frequency selected in S113B will be hereinafter referred to as the "target frequency".<br/>
<!-- EPO <DP n="36"> -->The conversion rule calculation unit 410 subtracts the computing frequency from the target frequency, thereby updating the target frequency, and sets the computing frequency as a divided frequency.</p><p id="p0135" num="0135"><figref idrefs="f0018">Fig. 18</figref> is a schematic diagram of the conversion rule calculation process (S110) in the second embodiment.<br/>
In the divided frequency table 492 shown in (1) of <figref idrefs="f0018">Fig. 18</figref>, the computing frequency for "3-anonymity (k=3)" is "28", and target frequencies (appearance frequencies greater than or equal to 28) are "40", "35" and "28".<br/>
As shown in (2) of <figref idrefs="f0018">Fig. 18</figref>, the conversion rule calculation unit 410 subtracts the computing frequency "28" from the target frequency "40", thereby updating the target frequency to "12 (= 40 - 28)".<br/>
The conversion rule calculation unit 410 sets the computing frequency "28" as a divided frequency.<br/>
In this way, the target frequency "40" is divided into a target frequency "12" after subtraction and a divided frequency "28".</p><p id="p0136" num="0136">Likewise, the conversion rule calculation unit 410 divides the target frequency "35" into a target frequency "7" after subtraction and a divided frequency "28", and divides the target frequency "28" into a target frequency "0" after subtraction and a divided frequency "28".</p><p id="p0137" num="0137">Note that when the target frequency is a value greater than or equal to n times the computing frequency (n being an integer of 1 or more), the conversion rule calculation unit 410 updates the target frequency by subtracting the computing frequency n times from the target frequency, and sets the n number of the computing frequency as divided frequencies.<br/>
For example, when the target frequency is "60", the conversion rule<!-- EPO <DP n="37"> --> calculation unit 410 subtracts the computing frequency "28" twice from the target frequency "60", thereby updating the target frequency to "4 (= 60-28-28)", and sets two of the computing frequency "28" as divided frequencies. In this way, the target frequency "60" is divided into a target frequency "4" after subtraction and two divided frequencies "28" and "28".</p><p id="p0138" num="0138">Referring back to <figref idrefs="f0016">Fig. 16</figref>, the description of the conversion rule calculation process (S110) continues.</p><p id="p0139" num="0139">After S113B, processing proceeds to S114B.</p><p id="p0140" num="0140">In S 114B, the conversion rule calculation unit 410 determines whether or not there remains an appearance frequency other than "0" in the divided frequency table 492.<br/>
If there remains an appearance frequency other than "0" (YES), processing proceeds to S115B.<br/>
If there is no longer any appearance frequency other than "0" (NO), processing proceeds to S117B.</p><p id="p0141" num="0141">In S115B, the conversion rule calculation unit 410 determines whether or not there remain "k" or more appearance frequencies other than "0" in the divided frequency table 492.<br/>
If there remain "k" or more appearance frequencies other than "0" (YES), processing returns to S112B. For example, in the divided frequency table 492 shown in (2) of <figref idrefs="f0018">Fig. 18</figref>, there remain 7 appearance frequencies other than "0". That is, there remain 3 (=k) or more appearance frequencies other than "0". Thus, processing returns to S112B.<br/>
If there remain only less than "k" appearance frequencies other than "0" (NO), processing proceeds to S116B.<!-- EPO <DP n="38"> --></p><p id="p0142" num="0142">In S 116B, the conversion rule calculation unit 410 further divides the divided frequencies set in the divided frequency table 492 such that k-anonymity is satisfied.<br/>
Processing in S116B will be separately described in detail.<br/>
After S116B, processing proceeds to S117B.</p><p id="p0143" num="0143">In S117B, the conversion rule calculation unit 410 calculates as the "conversion keyword number" the number of divided frequencies set in the divided frequency table 492.<br/>
The conversion rule calculation unit 410 calculates as the "conversion probability" a rate of each divided frequency.<br/>
Specific examples of calculation methods of the conversion keyword number and the conversion probability will be separately described.<br/>
S117B completes the conversion rule calculation process (S110).</p><p id="p0144" num="0144"><figref idrefs="f0019 f0020 f0021">Figs. 19 to 21</figref> are schematic diagrams of the conversion rule calculation process (S110) in the second embodiment.<br/>
<figref idrefs="f0022">Fig. 22</figref> is a diagram showing a conversion rule table 291 in the second embodiment.<br/>
Referring to <figref idrefs="f0019 f0020 f0021 f0022">Figs. 19 to 22</figref>, a specific example of processing if there remain "k" or more appearance frequencies other than "0" in S115B (YES).</p><p id="p0145" num="0145">In <figref idrefs="f0019">Fig. 19</figref>, the conversion rule calculation unit 410 selects as a computing frequency the third (= "k"th) greatest appearance frequency "22" from the divided frequency table 492 (2) (S112B).<br/>
Next, the conversion rule calculation unit 410 selects as target frequencies appearance frequencies "27", "23", "22" and "22" greater than or equal to the computing frequency "22". Then, the conversion rule calculation unit 410 divides the target frequency "27" into "5" and "22", divides the target frequency "23" into "1" and<!-- EPO <DP n="39"> --> "22", and divides the target frequency "22" into "0" and "22" (S 113B).<br/>
In this way, the divided frequency table 492 (3) shown in of <figref idrefs="f0019">Fig. 19</figref> is generated.</p><p id="p0146" num="0146">In the divided frequency table 492 (3), there remain 3 (= k) or more appearance frequencies other than "0". Thus, processing returns to S 112B (S114B-S115B). The description continues.</p><p id="p0147" num="0147">In <figref idrefs="f0020">Fig. 20</figref>, the conversion rule calculation unit 410 selects as a computing frequency the third (= "k"th) greatest appearance frequency "7" from the divided frequency table 492 (3) (S112B).<br/>
Next, the conversion rule calculation unit 410 selects as target frequencies appearance frequencies "21", "12", and "7" greater than or equal to the computing frequency "7". Then, the conversion rule calculation unit 410 divides the target frequency "21" into "0" and 3 pieces of "7", divides the target frequency "12" into "5" and "7", and divides the target frequency "7" into "0" and "7" (S113B).<br/>
In this way, the divided frequency table 492 (4) shown in <figref idrefs="f0020">Fig. 20</figref> is generated.</p><p id="p0148" num="0148">In the divided frequency table 492 (4), there remain 3 (= k) or more appearance frequencies other than "0". Thus, processing returns to S 112B (S114B-S115B). The description continues.</p><p id="p0149" num="0149">In <figref idrefs="f0021">Fig. 21</figref>, the conversion rule calculation unit 410 selects as a computing frequency the third (= "k"th) greatest appearance frequency "1" from the divided frequency table 492 (4) (S112B).<br/>
Next, the conversion rule calculation unit 410 selects as target frequencies appearance frequencies "5", "5", and "1" greater than or equal to the computing frequency "1". Then, the conversion rule calculation unit 410 divides the target frequency "5" into "0" and 5 pieces of "1", and divides the target frequency "1" into "0"<!-- EPO <DP n="40"> --> and "1" (S113B).<br/>
In this way, the divided frequency table 492 (5) shown in <figref idrefs="f0021">Fig. 21</figref> is generated.</p><p id="p0150" num="0150">In the divided frequency table 492 (5), there is no longer any appearance frequency other than "0" (S114B). Thus, the conversion rule calculation unit 410 calculates the conversion keyword number and the conversion probabilities of each search keyword as described below (S117B).</p><p id="p0151" num="0151">In the divided frequency table 492 (5), a search keyword "Sato" has divided frequencies "28", "7", and 5 pieces of "1".</p><p id="p0152" num="0152">Referring to the divided frequency table 492 (5), the conversion rule calculation unit 410 calculates as the conversion keyword number of the search keyword "Sato" the number of divided frequencies of the search keyword "Sato", the number being "7".<br/>
Further, the conversion rule calculation unit 410 calculates as the conversion probability of each conversion keyword of the search keyword "Sato" a rate of each divided frequency of the search keyword "Sato", which is "28/40", "7/40", and "1/40" respectively.</p><p id="p0153" num="0153">The conversion rule calculation unit 410 calculates the conversion keyword number and the conversion probabilities of each of other search keywords in the same manner.</p><p id="p0154" num="0154">Based on the divided frequency table 492 (5) shown in <figref idrefs="f0021">Fig. 21</figref>, the conversion rule table 291 is generated.<br/>
For example, associated with the search keyword "Sato", the same number of conversion keywords as the conversion keyword number "7", namely "Sato-1 to Sato-7", are set in the conversion rule table 291.<br/>
Associated with respective conversion keywords of the search keyword<!-- EPO <DP n="41"> --> "Sato", the conversion probabilities "28/40", "7/40", and "1/40" are set in the conversion rule table 291.</p><p id="p0155" num="0155"><figref idrefs="f0023">Fig. 23</figref> is a diagram showing registration frequencies of encrypted keywords in the second embodiment.<br/>
For example, when conversion keywords are selected based on the conversion rule table 291 shown in <figref idrefs="f0022">Fig. 22</figref> and the selected conversion keywords are encrypted, the encrypted keywords are registered in the registration data table 391 at registration rates as shown in <figref idrefs="f0023">Fig. 23</figref>.</p><p id="p0156" num="0156">For example, as encrypted keywords having the registration frequency "28", there are 3 (= k) types of encrypted keywords, namely "E (Sato-1)", "E (Suzuki-1)", and "E (Takahashi-1)". Thus, it is not possible to identify which of these 3 encrypted keywords represents data that corresponds to the search keyword "Sato (or Suzuki or Takahashi)".<br/>
That is, "3-anonymity" is secured, so that frequency analysis of the encrypted keywords is difficult.</p><p id="p0157" num="0157">Likewise, other registration frequencies, namely "22", "7", and "1", are also common to 3 (= k) or more types of encrypted keywords. Thus, "3-anonymity" is secured, so that frequency analysis of the encrypted keywords is difficult.</p><p id="p0158" num="0158"><figref idrefs="f0024">Fig. 24</figref> is a diagram showing another example of the search keyword table 491 and the divided frequency table 492 in the second embodiment.<br/>
<figref idrefs="f0025">Fig. 25</figref> is a flowchart illustrating a re-division process (S116B) of the conversion rule calculation process (S 110) in the second embodiment.<br/>
<figref idrefs="f0026">Fig. 26</figref> and <figref idrefs="f0027">27</figref> are schematic diagrams of the re-division process (S116B) in the second embodiment.<br/>
Referring to <figref idrefs="f0024 f0025 f0026 f0027">Figs. 24 to 27</figref>, description will be directed to the re-division<!-- EPO <DP n="42"> --> process (S116B) when there remain only less than "k" appearance frequencies other than "0" in S 115B (NO).</p><p id="p0159" num="0159">When the appearance frequency of each search keyword is divided in S 112B to S115B (see <figref idrefs="f0016">Fig. 16</figref>) based on the search keyword table 491 shown in <figref idrefs="f0024">Fig. 24</figref>, the divided frequency table 492 (1) of <figref idrefs="f0024">Fig. 24</figref> is obtained. In the divided frequency table 492 (1), there remain 2 appearance frequencies other than "0", namely 2 pieces of "5". That is, there remain only less than 3 (=k) appearance frequencies other than "0", so that the re-division process (S116B) shown in <figref idrefs="f0025">Fig. 25</figref> is executed.</p><p id="p0160" num="0160">In S116B-1 (see <figref idrefs="f0025">Fig. 25</figref>), based on the divided frequency table 492, the conversion rule calculation unit 410 calculates the number of divided frequencies included in each divided frequency group for each divided frequency group consisting of divided frequencies having the same value. The number of divided frequencies included in a divided frequency group will be hereinafter referred to as "group frequency number".<br/>
The divided frequency table 492 (1) shown in <figref idrefs="f0024">Fig. 24</figref> includes three groups: a "28" divided frequency group consisting of 3 divided frequencies "28", a "22" divided frequency group consisting of 4 divided frequencies "22" and a "7" divided frequency group consisting of 5 divided frequencies "7". In this case, the group frequency number of the "28" divided frequency group is "3", the group frequency number of the "22" divided frequency group is "4", and the group frequency number of the "7" divided frequency group is "5".</p><p id="p0161" num="0161">The conversion rule calculation unit 410 determines as a "division candidate group" a divided frequency group having a group frequency number exceeding the anonymity number "k". This is to satisfy "k-anonymity".<br/>
In the case of the divided frequency table 492 (1) shown in <figref idrefs="f0024">Fig. 24</figref>, the "22"<!-- EPO <DP n="43"> --> divided frequency group and the "7" divided frequency group are division candidate groups.</p><p id="p0162" num="0162">The conversion rule calculation unit 410 selects as a "re-division frequency group" a division candidate group consisting of the smallest divided frequencies.<br/>
In the case of the divided frequency table 492 (1) shown in <figref idrefs="f0024">Fig. 24</figref>, the "7" divided frequency group is a re-division frequency group.<br/>
Note that the conversion rule calculation unit 410 may select as a re-division frequency group a division candidate group consisting of the greatest divided frequencies, or may select as a re-division frequency group a divided frequency group having the greatest (or smallest) group frequency number, or may randomly select a re-division frequency group from division candidate groups.</p><p id="p0163" num="0163">The conversion rule calculation unit 410 selects as a "re-division frequency" a divided frequency to be returned to an appearance frequency from a plurality of divided frequencies included in the re-division frequency group.<br/>
For example, the conversion rule calculation unit 410 selects a re-division frequency to satisfy a condition that the number of search keywords corresponding to the remaining divided frequencies in the re-division frequency group is equal to or more than the anonymity number "k".<br/>
In the case of the divided frequency table 492 (1) shown in <figref idrefs="f0024">Fig. 24</figref>, the conversion rule calculation unit 410 selects as a re-division frequency the divided frequency "7" of a search keyword "Nakamura".<br/>
After S116B-1, processing proceeds to S116B-2.</p><p id="p0164" num="0164">In S116B-2, the conversion rule calculation unit 410 adds the re-division frequency to the appearance frequency from which the re-division frequency has been divided (subtracted), thereby updating the appearance frequency, and deletes the<!-- EPO <DP n="44"> --> re-division frequency. As a result, the re-division frequency returns from the "divided frequency" to the "appearance frequency".<br/>
For example, when the re-division frequency "7" is returned to the appearance frequency in the divided frequency table 492 (1) shown in <figref idrefs="f0026">Fig. 26</figref>, the divided frequency table 492 (2) is obtained.<br/>
After S116B-2, processing proceeds to S116B-3.</p><p id="p0165" num="0165">In S116B-3, the conversion rule calculation unit 410 determines whether or not there remain "k" or more appearance frequencies other than "0" in the divided frequency table 492.<br/>
If there remain "k" or more appearance frequencies other than "0" (YES), processing proceeds to S116B-4.<br/>
If there remain only less than "k" appearance frequencies other than "0" (NO), processing returns to S 116B-1.</p><p id="p0166" num="0166">In S116B-4, the conversion rule calculation unit 410 determines a combination of divided frequencies for dividing each remaining appearance frequency (≠ 0) in the divided frequency table 492, and divides each appearance frequency according to the determined combination of divided frequencies.<br/>
Note that the conversion rule calculation unit 410 divides each appearance frequency using all the divided frequencies constituting the combination of divided frequencies.<br/>
That is, each appearance frequency is divided according to the same combination of divided frequencies as other appearance frequencies. In this way, "k-anonymity" can be satisfied.</p><p id="p0167" num="0167">In the divided frequency table 492 (2) shown in <figref idrefs="f0027">Fig. 27</figref>, there remain appearance frequencies "5", "5", and "7". Each of the appearance frequencies "5",<!-- EPO <DP n="45"> --> "5", and "7" can be divided by a combination of "3" and "2". When the appearance frequencies "5", "5", and "7" are divided into divided frequencies "3" and "2", the divided frequency table 492 (3) is obtained.</p><p id="p0168" num="0168">For example, the conversion rule calculation unit 410 generates a plurality of candidate combinations by dividing the appearance frequencies by all possible combinations (searching for all possible division combinations), and calculates the total number of divided frequencies when the appearance frequencies are divided according to each of the generated candidate combinations. Then, the conversion rule calculation unit 410 selects a candidate combination with the smallest total number of divided frequencies as the combination of divided frequencies, and divides each of the appearance frequencies according to the selected combination of divided frequencies. This combination of divided frequencies is a combination that produces the smallest average value of conversion keyword numbers. With this arrangement, the average value of the number of search request keywords (encrypted keywords) included in search request data can be minimized.<br/>
For example, the appearance frequencies "5", "5", and "7" can be divided by a combination of "4" and "1", a combination of "3" and "1", or a combination of "2" and "1". Note that the total number of divided frequencies is the smallest when the appearance frequencies are divided by a combination of "3" and "2". Thus, the conversion rule calculation unit 410 divides the appearance frequencies "5", "5", and "7" into divided frequencies "3" and "2".</p><p id="p0169" num="0169">Note that the conversion rule calculation unit 410 may calculate the maximum value of conversion keyword numbers when the appearance frequencies are respectively divided according to each candidate combination, and select a candidate combination with the smallest maximum value of conversion keyword numbers as the combination<!-- EPO <DP n="46"> --> of divided frequencies. With this arrangement, the maximum value of the number of search request keywords included in search request data can be made small.</p><p id="p0170" num="0170">S116B-4 completes the re-division process (S116B).</p><p id="p0171" num="0171">A supplementary description of the conversion rule calculation process (S110) shown in <figref idrefs="f0016">Fig. 16</figref> will be provided.<br/>
In S115B (<figref idrefs="f0016">Fig. 16</figref>), if there remain "k" or more appearance frequencies other than "0" (YES), divided frequencies may be optimized by performing a process substantially the same as the re-division process (S116B) described in <figref idrefs="f0025">Fig. 25</figref>.</p><p id="p0172" num="0172"><figref idrefs="f0028 f0029 f0030">Figs. 28 to 30</figref> are diagrams showing optimization of divided frequencies in the second embodiment.<br/>
Referring to <figref idrefs="f0020">Fig. 20</figref> and <figref idrefs="f0028">28</figref> to <figref idrefs="f0030">30</figref>, a specific example of divided frequencies will be described.</p><p id="p0173" num="0173">In <figref idrefs="f0020">Fig. 20</figref>, more than 3 (=k) divided frequencies "7" are newly set in the divided frequency table 492 (4).<br/>
At this time, there remain 3 (= k) or more appearance frequencies other than "0", namely "5", "5" and "1". The third (= "k"th) greatest appearance frequency "1" (computing frequency) among the remaining appearance frequencies "5", "5", and "1" is less than or equal to a predetermined frequency threshold (for example, 1).<br/>
Accordingly, out of the 5 divided frequencies "7", the conversion rule calculation unit 410 returns one divided frequency "7" of the search keyword "Nakamura" which satisfies "k-anonymity" to the appearance frequency. As a result, the divided frequency table 492 (5) of <figref idrefs="f0028">Fig. 28</figref> is obtained.</p><p id="p0174" num="0174">The conversion rule calculation unit 410 generates candidate combinations of divided frequencies by dividing the remaining appearance frequencies "7", "5", "5", and "1". Note that each candidate combination of divided frequencies should satisfy<!-- EPO <DP n="47"> --> "3-anonymity". That is, candidate combinations are generated to satisfy a condition that each divided frequency constituting a candidate combination of divided frequencies is set by being associated with 3 (= k) or more search keywords.<br/>
Then, the conversion rule calculation unit 410 selects a combination of divided frequencies from the generated candidate combinations of divided frequencies, and divides each of the appearance frequencies "7" "5", "5" and "1" based on the selected combination of divided frequencies.</p><p id="p0175" num="0175">The divided frequency table 492 (A) of <figref idrefs="f0029">Fig. 29</figref> shows a division result with the smallest average value of conversion keyword numbers (the smallest total number of divided frequencies), and the divided frequency table 492 (B) of <figref idrefs="f0029">Fig. 29</figref> shows a division result with the smallest maximum value of conversion keyword numbers.<br/>
In the divided frequency table 492 (A), the average value of conversion keyword numbers is "2.5", which is smaller than the average value "2.875" of conversion keyword numbers in the divided frequency table 492 (5) shown in <figref idrefs="f0021">Fig. 21</figref>.<br/>
In the divided frequency table 492 (B), the maximum value of conversion keyword numbers is "5" (search keywords: Sato, Nakamura), which is smaller than the maximum value "7" of conversion keyword numbers (search keyword: Sato) in the divided frequency table 492 (5) shown in <figref idrefs="f0021">Fig. 21</figref>.</p><p id="p0176" num="0176">Further, the conversion rule calculation unit 410 may generate the divided frequency table 492 for each of a plurality of "k-anonymity".<br/>
In this case, the conversion rule calculation unit 410 determines each divided frequency table 492 satisfying a predetermined optimization condition from the generated divided frequency tables 492, and selects the divided frequency table 492 having the greatest value of "k" from the divided frequency tables 492 satisfying the predetermined optimization condition (for example, the average value or maximum<!-- EPO <DP n="48"> --> value of search keyword numbers).</p><p id="p0177" num="0177">For example, the conversion rule calculation unit 410 generates the divided frequency tables 492 for "3-anonymity", "4-anonymity", and "5-anonymity".<br/>
<figref idrefs="f0030">Fig. 30</figref> shows the divided frequency tables 492 for "3-anonymity" and "4-anonymity". The divided frequency table 492 for "5-anonymity" is not illustrated.</p><p id="p0178" num="0178">The conversion rule calculation unit 410 calculates the average value of search keyword numbers for each of "3-anonymity", "4-anonymity, and "5-anonymity". In the case of <figref idrefs="f0030">Fig. 30</figref>, the average value of search keyword numbers for "3-anonymity" is "2.5", and the average value of search keyword numbers for "4-anonymity" is "2.75". It is assumed that the average value of search keyword numbers for "5-anonymity" is "3.5".<br/>
The conversion rule calculation unit 410 compares each of the average values "2.5", "2.75", and "3.5" of search keyword numbers with a predetermined optimization condition value "3.0". In this case, the average value "2.5" of search keyword numbers for "3-anonymity" and the average value "2.75" of search keyword numbers for "4-anonymity" are below the optimization condition value "3", satisfying the optimization condition.<br/>
Accordingly, from the divided frequency table 492 for "3-anonymity" and the divided frequency table 492 for "4-anonymity", the conversion rule calculation unit 410 selects the divided frequency table 492 for "4-anonymity" which has the greater value of "k".</p><p id="p0179" num="0179">As described above, the conversion rule calculation unit 410 may optimize the divided frequency table 492.</p><p id="p0180" num="0180">Other processes (S120-S140) of the conversion rule management method of the conversion rule management device 400 are substantially the same as described in<!-- EPO <DP n="49"> --> the first embodiment (see <figref idrefs="f0006">Fig. 6</figref>).</p><p id="p0181" num="0181">The data registration method of the data registration device 500, the search method of the information processing device 200, and the search method of the server device 300 are substantially the same as described in the first embodiment (see <figref idrefs="f0010">Figs. 10</figref>, <figref idrefs="f0013">13</figref>, and <figref idrefs="f0014">14</figref>).</p><p id="p0182" num="0182">In the second embodiment, the searchable encryption system 100 as described below, for example, has been discussed.</p><p id="p0183" num="0183">In the searchable encryption system 100, "k-anonymity" is defined as a security index, and the conversion rule management device 400 generates conversion rules based on this index.<br/>
With this arrangement, it is possible to reduce the size of a search request transmitted from the information processing device 200 to the server device 300 in a search.<br/>
k-anonymity means that when an attacker has all information concerning frequency distribution of keywords, conversion rules, and frequency distribution of encrypted keywords and guesses a keyword from an encrypted keyword, there are k or more keywords that may be associated with a given encrypted keyword.</p><p id="p0184" num="0184">In the searchable encryption system 100, the information processing device 200 can perform a search without revealing data and keywords to the server device 300.<br/>
By satisfying the property of k-anonymity, identification of keywords by the server device 300 can be prevented. Furthermore, the size of a search request can be reduced compared to the first embodiment.<br/>
For example, when the conversion rule table 291 is generated based on the search keyword table 491 shown in <figref idrefs="f0017">Fig. 17</figref>, in the first embodiment 40 conversion keywords having appearance frequency "1" are required for the search keyword "Sato"<!-- EPO <DP n="50"> --> in order to equalize the appearance frequencies of the conversion keywords. On the other hand, in the second embodiment 7 conversion keywords are required for the search keyword "Sato" as shown in <figref idrefs="f0022">Fig. 22</figref>. That is, the conversion keyword number is smaller in the second embodiment, so that the size of search request data is smaller in the second embodiment.</p><heading id="h0013">Third Embodiment</heading><p id="p0185" num="0185">An embodiment, different from the second embodiment, of the searchable encryption system 100 that satisfies "k-anonymity" will be described.<br/>
Features different from the first and second embodiments will be mainly described hereinafter. Features not described are substantially the same as described in the first and second embodiments.</p><p id="p0186" num="0186">The configuration of devices of the searchable encryption system 100 and the functional configuration of each device are substantially the same as described in the first embodiment (see <figref idrefs="f0001 f0002 f0003 f0004 f0005">Figs. 1 to 5</figref>).</p><p id="p0187" num="0187">Note that the conversion rule calculation unit 410 of the conversion rule management device 400 calculates the conversion keyword number and the conversion probability as described below.<br/>
The conversion rule calculation unit 410 divides the appearance frequency of each search keyword into a plurality of appearance frequencies using exponential values of a predetermined base.<br/>
The conversion rule calculation unit 410 calculates as the conversion keyword number (corresponding keyword number) the number of divided appearance frequencies.<br/>
The conversion rule calculation unit 410 calculates as the conversion probability (corresponding keyword selection rate) a rate of each divided frequency<!-- EPO <DP n="51"> --> (appearance frequency after being divided) with respect to the appearance frequency before being divided.</p><p id="p0188" num="0188">Using an exponential value of the base, the conversion rule calculation unit 410 divides a divided frequency that is common to less than "k" search keywords among the divided frequencies of the search keywords, "k" being a predetermined anonymity number.</p><p id="p0189" num="0189"><figref idrefs="f0031">Fig. 31</figref> is a flowchart of a conversion rule calculation process (S110) in a third embodiment.<br/>
<figref idrefs="f0032">Figs. 32</figref> and <figref idrefs="f0033">33</figref> are schematic diagrams of the conversion rule calculation process (S110) in the third embodiment.<br/>
Referring to <figref idrefs="f0031 f0032 f0033">Figs. 31 to 33</figref>, the conversion rule calculation process (S110) in the third embodiment will be described.</p><p id="p0190" num="0190">In S111 C (see <figref idrefs="f0031">Fig. 31</figref>), using a predetermined base value "p", the conversion rule calculation unit 410 performs p-adic expansion of each appearance frequency set in the divided frequency table 492, and divides each appearance frequency into a plurality of divided frequencies.</p><p id="p0191" num="0191">In <figref idrefs="f0032">Fig. 32</figref>, each appearance frequency set in the divided frequency table 492 (1) can be divided by 2-adic expansion into divided frequencies set in the divided frequency table 492 (2).<br/>
For example, an appearance frequency "40" of a search keyword "Sato" is divided into "32" which is the base "2 (= p)" to the power of 5 and "8" which is the base "2" to the power of 3.<br/>
Note that each appearance frequency may be divided using an exponential value with a base of other than "2" (for example, 3 or 5).</p><p id="p0192" num="0192">Referring back to <figref idrefs="f0031">Fig. 31</figref>, the description of the conversion rule calculation<!-- EPO <DP n="52"> --> process (S110) continues.</p><p id="p0193" num="0193">After S111C, processing proceeds to S112C.</p><p id="p0194" num="0194">In S112C, based on the divided frequency table 492, the conversion rule calculation unit 410 calculates the number of divided frequencies for each value of divided frequencies. The number of divided frequencies will be hereinafter referred to as a "frequency number".<br/>
The conversion rule calculation unit 410 determines whether or not there is any divided frequency having a frequency number less than the anonymity number "k".<br/>
If there is a divided frequency having a frequency number less than the anonymity number "k" (YES), processing proceeds to S 113C.<br/>
If there is no divided frequency having a frequency number less than the anonymity number "k" (NO), processing proceeds to S114C.</p><p id="p0195" num="0195">In the case of the divided frequency table 492 (2) of <figref idrefs="f0032">Fig. 32</figref>, the frequency number of a divided frequency "32" is "2", the frequency number of a divided frequency "16" is "6", the frequency number of a divided frequency "8" is "3", the frequency number of a divided frequency "4" is "5", the frequency number of a divided frequency "2" is "5", and the frequency number of a divided frequency "1" is "4".<br/>
In this case, the frequency number "2" of the divided frequency "32" is less than "3 (= k)".<br/>
Accordingly, processing proceeds to S 113C.</p><p id="p0196" num="0196">Referring back to <figref idrefs="f0031">Fig. 31</figref>, the description continues from S113C.</p><p id="p0197" num="0197">In S113C, the conversion rule calculation unit 410 divides the divided frequency having the frequency number of less than the anonymity number "k" (hereinafter referred to as a "re-division frequency") by p-adic expansion.</p><p id="p0198" num="0198">The re-division frequency "32" set in the divided frequency table 492 (2) of<!-- EPO <DP n="53"> --> <figref idrefs="f0033">Fig. 33</figref> can be divided into "16" which is 2 (= p) to the power of 4. As a result, the divided frequency table 492 (3) is obtained.</p><p id="p0199" num="0199">Referring back to <figref idrefs="f0031">Fig. 31</figref>, the description of the conversion rule calculation process (S110) continues.</p><p id="p0200" num="0200">After S 113C, processing returns to S 112C.</p><p id="p0201" num="0201">In the divided frequency table 492 (3) shown in <figref idrefs="f0033">Fig. 33</figref>, the frequency numbers of all the divided frequencies are greater than or equal to "3 (= k)".<br/>
Accordingly, after S112C, processing proceeds to S114C (see <figref idrefs="f0031">Fig. 31</figref>).</p><p id="p0202" num="0202">In S 114C, based on the divided frequency table 492, the conversion rule calculation unit 410 calculates as the "conversion keyword number" the number of divided frequencies for each conversion keyword, and calculates as the "conversion probability" a rate of each divided frequency.</p><p id="p0203" num="0203">In the case of the divided frequency table 492 (3) of <figref idrefs="f0033">Fig. 33</figref>, the search keyword "Sato" has divided frequencies "16", "16" and "8".<br/>
Thus, the conversion rule calculation unit 410 calculates as the conversion keyword number of the search keyword "Sato" the number of divided frequencies of the search keyword "Sato", the number being "3".<br/>
Further, the conversion rule calculation unit 410 calculates as the conversion probabilities of the conversion keywords of the search keyword "Sato" rates "16/40", "16/40", and "8/40" of the divided frequencies of the search keyword "Sato".</p><p id="p0204" num="0204">Likewise, the conversion rule calculation unit 410 obtains the conversion keyword numbers and conversion probabilities of other search keywords.</p><p id="p0205" num="0205"><figref idrefs="f0034">Fig. 34</figref> is a diagram showing a conversion rule table 291 in the third embodiment.<br/>
<figref idrefs="f0035">Fig. 35</figref> is a diagram showing registration frequencies of encrypted keywords<!-- EPO <DP n="54"> --> in the third embodiment.<br/>
Based on the divided frequency table 492 (3) shown in <figref idrefs="f0033">Fig. 33</figref>, the conversion rule table 291 shown in <figref idrefs="f0034">Fig. 34</figref> is generated.<br/>
For example, associated with the search keyword "Sato", the same number of conversion keywords as the conversion keyword number "3", namely "Sato-1 to Sato-3", are set in the conversion rule table 291.<br/>
Further, associated with the respective keywords of the search keyword "Sato", conversion probabilities "16/40", "16/40", and "8/40" are set in the conversion rule table 291.<br/>
When conversion keywords are selected based on the conversion rule table 291 of <figref idrefs="f0034">Fig. 34</figref> and the selected conversion keywords are encrypted, the encrypted keywords are registered in the registration data table 391 at registration rates shown in <figref idrefs="f0035">Fig. 35</figref>.<br/>
Each registration frequency is common to 3 (= k) or more types of encrypted keywords. Thus, "3-anonymity" is secured, so that frequency analysis of the encrypted keywords is difficult.</p><p id="p0206" num="0206">The conversion rule calculation unit 410 may optimize the divided frequency table 492.</p><p id="p0207" num="0207">For example, the conversion rule calculation unit 410 optimizes the divided frequency table 492 as described below.<br/>
Referring to the divided frequency table 492, the conversion rule calculation unit 410 determines as "integration candidates" combinations of divided frequencies satisfying "k-anonymity" even after being integrated.<br/>
The conversion rule calculation unit 410 generates the divided frequency table 492 by integrating divided frequencies according to each integration candidate.<br/>
<!-- EPO <DP n="55"> -->The conversion rule calculation unit 410 calculates the average value of conversion keyword numbers (or the maximum value of conversion keyword numbers) for each divided frequency table 492.<br/>
The conversion rule calculation unit 410 selects the divided frequency table 492 having the smallest average value of conversion keyword numbers (or the smallest maximum number of conversion keyword numbers).</p><p id="p0208" num="0208"><figref idrefs="f0036">Fig. 36</figref> is a diagram showing a specific example of optimization of the divided frequency table 492 in the third embodiment.<br/>
In the case of the divided frequency table 492 (3) shown in <figref idrefs="f0036">Fig. 36</figref>, integration candidates satisfying "3-anonymity" include {16, 8}, {16, 4}, 16, 2}, and {16, 1}. This is because when divided frequencies are integrated by selecting any of the integration candidates, each divided frequency after being integrated is common to 3 (= k) or more search keywords.<br/>
For example, when the integration candidate {16, 2} is integrated into a divided frequency "18 (= 16+2)", the divided frequency table 492 (4) shown in <figref idrefs="f0036">Fig. 36</figref> is obtained. The average value of conversion keyword numbers in the divided frequency table 492 (4) is "2.75".<br/>
When the integration candidate {16, 8} is integrated, the average value of conversion keyword numbers is "3.0". When the integration candidate {16, 4} is integrated, the average value of conversion keyword numbers is "2.75". When the integration candidate {16, 1} is integrated, the average of conversion keyword numbers is "2.875".<br/>
That is, when the integration candidate {16, 2} is integrated, the average value of conversion keyword numbers is the smallest "2.75". Thus, the conversion rule calculation unit 410 selects the divided frequency table 492 (4) in which the integration<!-- EPO <DP n="56"> --> candidate {16, 2} is integrated. Note that when the integration candidate {16, 4} is integrated, the average value of conversion keyword numbers is also "2.75". Thus, the conversion rule calculation unit 410 may select the divided frequency table 492 in which the integration candidate {16, 4} is integrated.</p><p id="p0209" num="0209"><figref idrefs="f0037">Figs. 37</figref> and <figref idrefs="f0038">38</figref> respectively show the conversion rule table 291 and registration frequencies of encrypted keywords based on the divided frequency table 492 (4) in which the integration candidate {16, 2} is integrated.</p><p id="p0210" num="0210">The conversion rule calculation unit 410 may randomly select an integration candidate from a plurality of integration candidates, and generate the divided frequency table 492 using the selected integration candidate.</p><p id="p0211" num="0211">In the above description, the appearance frequencies of search keywords are divided using p-adic expansion. However, the appearance frequencies of search keywords may be divided according to a division rule other than p-adic expansion.<br/>
For example, a division rule consisting of a plurality of division numbers "1, 5, 10, 50, 100, 500, ..." is predefined. Then, the conversion rule calculation unit 410 divides the appearance frequencies of search keywords according to this division rule. In this case, the appearance frequency "28" is divided into "10", "10", "5", "1", "1", and "1".</p><p id="p0212" num="0212">Other processes (S120-S140) of the conversion rule management method of the conversion rule management device 400 are substantially the same as described in the first embodiment (see <figref idrefs="f0006">Fig. 6</figref>).</p><p id="p0213" num="0213">The data registration method of the data registration device 500, the search method of the information processing device 200, and the search method of the server device 300 are substantially the same as described in the first embodiment (see <figref idrefs="f0010">Figs. 10</figref>, <figref idrefs="f0013">13</figref>, and <figref idrefs="f0014">14</figref>).<!-- EPO <DP n="57"> --></p><p id="p0214" num="0214">Substantially the same effects as in the second embodiment can be obtained by the third embodiment.</p><heading id="h0014">Fourth Embodiment</heading><p id="p0215" num="0215">An embodiment will be described in which the conversion keyword number and the conversion probability are calculated using ambiguity of an attacker in guessing a keyword (entropy) as a security index.<br/>
Features different from the first to third embodiments will be mainly described hereinafter. Features not described are substantially the same as described in the first to third embodiments.</p><p id="p0216" num="0216">The configuration of devices of the searchable encryption system 100 and the functional configuration of each device are the same as described in the first embodiment (see <figref idrefs="f0001 f0002 f0003 f0004 f0005">Figs. 1 to 5</figref>).</p><p id="p0217" num="0217">Note that the conversion rule calculation unit 410 of the conversion rule management device 400 calculates the conversion keyword number and the conversion probability as described below.<br/>
Based on the appearance frequency of each search keyword, the conversion rule calculation unit 410 calculates, as an occurrence probability value (correspondence probability value) when a specific number of conversion keywords are provided for each search keyword, a probability that the search keywords and the specific number of conversion keywords are associated in predetermined combinations.<br/>
Based on the calculated occurrence probability value, the conversion rule calculation unit 410 calculates as an entropy value an entropy of the combinations of the search keywords and the specific number of conversion keywords.<br/>
The conversion rule calculation unit 410 calculates an entropy index value by multiplying the calculated entropy value by the occurrence probability.<br/>
<!-- EPO <DP n="58"> -->The conversion rule calculation unit 410 compares the calculated entropy index value with a predetermined entropy threshold value.<br/>
If the entropy index value is greater than the entropy threshold value, the conversion rule calculation unit 410 calculates as the conversion keyword number the specific number of conversion keywords.<br/>
The conversion rule calculation unit 410 calculates as the conversion probability (conversion keyword selection rate) an inverse number of the conversion keyword number.</p><p id="p0218" num="0218"><figref idrefs="f0039">Fig. 39</figref> is a flowchart illustrating a conversion rule calculation process (S 110) in a fourth embodiment.<br/>
Referring to <figref idrefs="f0039">Fig. 39</figref>, the conversion rule calculation process (S110) in the fourth embodiment will be described.</p><p id="p0219" num="0219">It is assumed hereinafter that a registration data number "N" and an entropy threshold value "H" are given as parameter values representing security.</p><p id="p0220" num="0220">In S111D, the conversion rule calculation unit 410 sets an initial value "1" in a variable "keyword conversion number w". Note that the initial value may be an integer of 2 or more.<br/>
After S111D, processing proceeds to S112D.</p><p id="p0221" num="0221">In S112D, based on the appearance frequency of each search keyword, the conversion rule calculation unit 410 calculates an occurrence probability value when "w" conversion keywords are provided for each search keyword, "w" being the conversion keyword number. The occurrence probability value is a probability that the search keywords and the "w" conversion keywords are associated in the correct combinations.</p><p id="p0222" num="0222"><figref idrefs="f0040">Fig. 40</figref> is a diagram illustrating a search keyword table 491 in the fourth<!-- EPO <DP n="59"> --> embodiment.<br/>
<figref idrefs="f0041">Fig. 41</figref> is a diagram showing an example of a conversion rule table 291 in the fourth embodiment.<br/>
<figref idrefs="f0042">Figs. 42</figref> and <figref idrefs="f0043">43</figref> are diagrams showing examples of combinations of search keywords and conversion keywords in the fourth embodiment.<br/>
When one (= w) conversion keyword "married-1" is provided for a search keyword "married" and one conversion keyword "unmarried-1" is provided for a search keyword "unmarried" based on the search keyword table 491 shown in <figref idrefs="f0040">Fig. 40</figref>, the conversion rule table 291 (1) shown in <figref idrefs="f0041">Fig. 41</figref> is obtained.<br/>
Assuming that the conversion keywords "married-1" and "unmarried-1" are encrypted into encrypted keywords "E (married-1)" and "E (unmarried-1)", there are 2 patterns of combinations of the search keywords and the encrypted keywords as shown in (1) and (2) of <figref idrefs="f0042">Fig. 42</figref>. The combinations shown in (1) of <figref idrefs="f0042">Fig. 42</figref> are the correct combinations.</p><p id="p0223" num="0223">When the keyword conversion number w is "2", the conversion rule table 291 (2) shown in <figref idrefs="f0041">Fig. 41</figref> is obtained based on the search keyword table 491 shown in <figref idrefs="f0040">Fig. 40</figref>.<br/>
In this case, there are 6 patterns of combinations of the search keywords and the encrypted keywords as shown in (1) to (6) of <figref idrefs="f0043">Fig. 43</figref>.</p><p id="p0224" num="0224">As shown in <figref idrefs="f0040">Fig. 40</figref>, the appearance frequency of the search keyword "married" is "75% (= 3/4)", and the appearance frequency of the search keyword "unmarried" is "25% (= 1/4)".<br/>
Accordingly, the registration frequency of the encrypted keyword "E (married-1)" is "75% (= 3/4)", and the registration frequency of the encrypted keyword "E (unmarried-1)" is "25% (= 1/4)".<!-- EPO <DP n="60"> --></p><p id="p0225" num="0225">When the registration data number "N = 10", it is possible that 1 encrypted keyword "E (married-1)" and 9 encrypted keywords "E (unmarried-1)" are registered in the registration data table 391 (see <figref idrefs="f0011">Fig. 11</figref>).<br/>
It is also possible that 2, 3, ..., or 10 encrypted keywords "E (married-1)" are registered. Further, it is also possible that the encrypted keyword "E (married-1)" is not registered, that is, there are zero encrypted keywords "E (married-1)".<br/>
However, since the conversion keywords are encrypted, it is not possible to identify which encrypted keyword corresponds to which conversion keyword. Thus, the correct combinations of the search keywords and the encrypted keywords cannot be known.</p><p id="p0226" num="0226">For example, assume that 6 encrypted keywords "E (married-1)" and 4 encrypted keywords "E (unmarried-1)" are registered in the registration data table 391. In this case, when the search keywords and the encrypted keywords are associated in the correct combinations as shown in (1) of <figref idrefs="f0042">Fig. 42</figref>, <figref idrefs="f0006">6</figref> encrypted keywords "E (married-1)" and 4 encrypted keywords "E (unmarried-1)" are registered with a registration probability of 3<sup>6</sup>/4<sup>10</sup> (= (3/4)<sup>6</sup> × (1/4)<sup>4</sup>). This value is based on the registration data number "10", the registration numbers "6" and "4" of the encrypted keywords, and the registration frequencies "3/4" and "1/4" of the encrypted keywords.<br/>
Likewise, when the search keywords and the encrypted keywords are associated in the incorrect combinations as shown in (2) of <figref idrefs="f0042">Fig. 42</figref>, the registration probability is 3<sup>4</sup>/4<sup>10</sup> (= (3/4)<sup>4</sup> × (1/4)<sup>6</sup>).</p><p id="p0227" num="0227">Thus, 0.9 (= (3<sup>6</sup>/4<sup>10</sup>) / (3<sup>6</sup>/4<sup>10</sup> + 3<sup>4</sup>/4<sup>10</sup>)) is a likelihood that the combinations shown in (1) of <figref idrefs="f0042">Fig. 42</figref> are correct. Likewise, 0.1 (= (3<sup>4</sup>/4<sup>10</sup>) / (3<sup>6</sup>/4<sup>10</sup> + 3<sup>4</sup>/4<sup>10</sup>)) is a likelihood that the combinations shown in (1) of <figref idrefs="f0042">Fig. 42</figref> are incorrect. These values are calculated according to Bayes' theorem using the registration probabilities "3<sup>6</sup>/4<sup>10</sup>"<!-- EPO <DP n="61"> --> and "3<sup>4</sup>/4<sup>10</sup>". A calculated likelihood will be hereinafter referred to as an "occurrence probability value".</p><p id="p0228" num="0228">The conversion rule calculation unit 410 calculates the occurrence probability value for each registration number of the encrypted keyword "E (married-1)" as described above. Note that one or more registration data tables having N pieces of registration data may be randomly selected based on the Monte Carlo method, and the occurrence probability value may be calculated for each selected registration data table.</p><p id="p0229" num="0229">After S 112D (<figref idrefs="f0039">Fig. 39</figref>), processing proceeds to S 113D.</p><p id="p0230" num="0230">In S113D, based on the occurrence probability value calculated in S112D, the conversion rule calculation unit 410 calculates as an entropy value an entropy of the combinations of the search keywords and the conversion keywords. Note that the conversion rule calculation unit 410 calculates the entropy value for each registration number of the encrypted keyword "E (married-1)". When the occurrence probability value is calculated for each registration data table randomly selected in S112D, the conversion rule calculation unit 410 calculates the entropy value for each registration data table for which the occurrence probability value is calculated.<br/>
For example, when the occurrence probability values are "0.9" and "0.1", the entropy value is 0.47 (≈ (0.9 log<sub>2</sub> 0.9 + 0.1 log<sub>2</sub> 0.1)).<br/>
After S113D, processing proceeds to S 114D.</p><p id="p0231" num="0231">In S 114D, for each registration number of the encrypted keyword "E (married-1)", the conversion rule calculation unit 410 multiplies the entropy value A calculated in S 113D by a probability B of each registration number of the encrypted keyword "E (married-1)" occurring, thereby calculating a weighted entropy value C (= A × B).<br/>
The weighted entropy value corresponding to a registration number n (n being<!-- EPO <DP n="62"> --> an integer of 0 to N) of the encrypted keyword "E (married-1)" will be hereinafter denoted as "C<sub>n</sub>".</p><p id="p0232" num="0232">The conversion rule calculation unit 410 calculates as an entropy index value "h" a total value of the weighted entropy values C<sub>n</sub>.<br/>
After S114D, processing proceeds to S115D.</p><p id="p0233" num="0233">In S 115D, the conversion rule calculation unit 410 compares the entropy index value "h" calculated in S 114D with a predetermined entropy threshold value "H".<br/>
If the entropy index value "h" is greater than or equal to the entropy threshold value "H" (YES), processing proceeds to S 117D.<br/>
If the entropy index value "h" is less than the entropy threshold value "H" (NO), processing proceeds to S116D.</p><p id="p0234" num="0234">In S116D, the conversion rule calculation unit 410 adds an addition value "1" to the keyword conversion number "w". Note that the addition value may be an integer of 2 or more. The keyword conversion number "w" may be multiplied by an integer.<br/>
After S116D, processing returns to S112D.</p><p id="p0235" num="0235">In S117D, the conversion rule calculation unit 410 outputs the keyword conversion number "w" as the conversion keyword number.<br/>
The conversion rule calculation unit 410 also calculates as the conversion probability an inverse number of the conversion keyword number, "1/w".</p><p id="p0236" num="0236">Other processes (S120-S140) of the conversion rule management method of the conversion rule management device 400 are substantially the same as described in the first embodiment (see <figref idrefs="f0006">Fig. 6</figref>).<br/>
Note that the conversion probability does not necessarily have to be set for each conversion keyword in the conversion rule table 291. This is because the<!-- EPO <DP n="63"> --> conversion probability is the same for all the conversion keywords so that it is sufficient to store one conversion probability</p><p id="p0237" num="0237">The data registration method of the data registration device 500, the search method of the information processing device 200, and the search method of the server device 300 are substantially the same as described in the first embodiment (see <figref idrefs="f0010">Figs. 10</figref>, <figref idrefs="f0013">13</figref>, and <figref idrefs="f0014">14</figref>).</p><p id="p0238" num="0238">The fourth embodiment will now be described supplementarily.</p><p id="p0239" num="0239">A frequency analysis attack is an attack in which the content of an encrypted keyword is guessed by comparing the frequency distribution of search keywords and the frequency distribution of encrypted keywords and finding associations between the search keywords and the encrypted keywords.<br/>
If an attacker can obtain a sufficient number of encrypted keywords, it is considered that the frequency distribution of encrypted keywords is sufficiently close to the frequency distribution of search keywords.<br/>
Therefore, in each embodiment, a plurality of encrypted keywords having the same frequency are generated to prevent identification of search keywords.</p><p id="p0240" num="0240">If an attacker can obtain only a small number of encrypted keywords, the frequency distribution of encrypted keywords does not always coincide with the frequency distribution of search keywords.<br/>
In this case, it is not possible to identify the contents of encrypted keywords having matching frequencies. In addition, it is difficult to guess the contents of encrypted keywords having similar frequencies.</p><p id="p0241" num="0241">Thus, in the fourth embodiment, assuming that an attacker obtains a limited amount of encrypted keywords, ambiguity as to associations between encrypted keywords and search keywords (entropy) is represented in a numerical value, and<!-- EPO <DP n="64"> --> conversion rules are generated using this numerical value as a security index.</p><p id="p0242" num="0242">In the fourth embodiment, the searchable encryption system 100 such as described below, for example, has been discussed.</p><p id="p0243" num="0243">In the searchable encryption system 100, the information processing device 200 can perform a search without revealing data and keywords to the server device 300.<br/>
By security based on entropy, a certain degree of ambiguity can be secured with respect to guessing of keywords by the server device 300, and furthermore the size of a search request can be reduced compared to the first embodiment.<br/>
The conversion probability of each conversion keyword (frequency division number of each search keyword) is uniform, so that the data size of the conversion rule table 291 can be made small. This is because the conversion probability does not have to be set for each conversion keyword.</p><p id="p0244" num="0244">Note that the conversion probability may be variable for each conversion keyword. For example, search keywords may be divided into groups and a given conversion probability may be used for each group, such as "prefecture names in the Kanto region to be divided into 10" and "prefecture names in the Kinki region to be divided into 9".</p><p id="p0245" num="0245">In the above description, reduction in search request size and simplification of conversion rules are achieved based on the fixed lower limit of security using entropy. However, security may be enhanced based on the fixed search request size or the fixed complexity of conversion rules.<br/>
For example, the average value of search request size (average value of keyword conversion numbers w, conversion keyword numbers) may be limited to 2 or less, and conversion rules that achieve the greatest entropy may be used.<br/>
In dividing search keywords into groups, the number of groups may be limited<!-- EPO <DP n="65"> --> to 3, and conversion rules that achieve the greatest entropy may be used.</p><heading id="h0015"><b>Reference Signs List</b></heading><p id="p0246" num="0246">100: searchable encryption system, 101: network, 200: information processing device, 210: search keyword input unit, 220: conversion keyword group acquisition unit, 230: encrypted keyword group generation unit, 240: search request unit, 250: search result output unit, 280: processing device communication unit, 290: processing device storage unit, 291: conversion rule table, 292: encryption key data, 293: decryption key data, 300: server device, 310: server device communication unit, 320: data search unit, 330: data registration unit, 390: server device storage unit, 391: registration data table, 400: conversion rule management device, 410: conversion rule calculation unit, 420: conversion keyword group generation unit, 430: conversion rule generation unit, 440: management device communication unit, 490: management device storage unit, 491: search keyword table, 492: divided frequency table, 500: data registration device, 510: registration device input unit, 520: keyword conversion unit, 530: registration data generation unit, 540: registration request unit, 580: registration device communication unit, 590: registration device storage unit, 591: search data table, 901: CPU, 902: bus, 903: ROM, 904: RAM, 905: communication board, 911: display device, 912: keyboard, 913: mouse, 914: drive device, 920: magnetic disk device, 921: OS, 922: programs, 923: files</p></description><claims mxw-id="PCLM56976370" lang="EN" load-source="patent-office"><!-- EPO <DP n="66"> --><claim id="c-en-0001" num="0001"><claim-text>A search system comprising an information processing device and a search device,<br/>
the information processing device including<br/>
a corresponding keyword storage unit that stores as corresponding keyword data a corresponding keyword group associating a search keyword with one or more corresponding keywords;<br/>
a search keyword input unit that inputs a search keyword;<br/>
a corresponding keyword group acquisition unit that obtains from the corresponding keyword data stored in the corresponding keyword storage unit a corresponding keyword group associated with the search keyword input by the search keyword input unit;<br/>
an encrypted keyword group generation unit that encrypts corresponding keywords included in the corresponding keyword group obtained by the corresponding keyword group acquisition unit, thereby generating an encrypted keyword group;<br/>
a search request data transmission unit that transmits to the search device search request data including the encrypted keyword group generated by the encrypted keyword group generation unit;<br/>
a search response data receiving unit that receives search response data transmitted from the search device; and<br/>
a search result output unit that decrypts encrypted data included in the search response data received by the search response data receiving unit, and outputs as a search result search data obtained by decryption,<br/>
the search device including<br/>
<!-- EPO <DP n="67"> -->an encrypted data storage unit that stores encrypted data generated by encrypting search data, the encrypted data storage unit storing for each search data the encrypted data generated by encrypting the each search data and an encrypted keyword generated by encrypting a corresponding keyword, the encrypted data and the encrypted keyword being associated with each other;<br/>
a search request data receiving unit that receives the search request data transmitted by the information processing device;<br/>
an encrypted data search unit that obtains encrypted data associated with a search key from the encrypted data storage unit using as the search key an encrypted keyword included in the encrypted keyword group in the search request data, based on the search request data received by the search request data receiving unit; and<br/>
a search response data transmission unit that transmits the search response data including the encrypted data obtained by the encrypted data search unit.</claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The search system according to claim 1, further comprising:
<claim-text>a corresponding keyword management device including</claim-text>
<claim-text>an appearance frequency storage unit that stores appearance frequency data defining search keywords and defining as an appearance frequency of a specific search keyword a rate of search data associated with the specific search keyword;</claim-text>
<claim-text>a corresponding keyword number calculation unit that calculates as a corresponding keyword number a number of corresponding keywords to be associated with each of the search keywords, according to the appearance frequency of each of the search keywords defined in the appearance frequency data stored in the appearance frequency storage unit;</claim-text>
<claim-text>a corresponding keyword group generation unit that generates as a<!-- EPO <DP n="68"> --> corresponding keyword group a same number of corresponding keywords as each corresponding keyword number calculated by the corresponding keyword number calculation unit; and</claim-text>
<claim-text>a corresponding keyword data generation unit that generates the corresponding keyword data by associating each of the search keywords defined in the appearance frequency data with each corresponding keyword group generated by the corresponding keyword group generation unit,</claim-text>
<claim-text>wherein the corresponding keyword storage unit of the information processing device stores the corresponding keyword data generated by the corresponding keyword management device.</claim-text></claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The search system according to claim 2,<br/>
wherein the corresponding keyword number calculation unit of the corresponding keyword management device calculates as a corresponding keyword selection rate a rate of selecting each corresponding keyword from the corresponding keyword group of the search keyword, based on the appearance frequency of the search keyword defined in the appearance frequency data,<br/>
wherein the corresponding keyword data generation unit of the corresponding keyword management device generates, as corresponding keyword selection rate data, data associating the search keyword with the corresponding keyword group and each corresponding keyword selection rate,<br/>
the search system further comprising:
<claim-text>an encrypted data generation device including</claim-text>
<claim-text>a search data storage unit that stores search data and a search keyword by associating the search data and the search keyword with each other;<!-- EPO <DP n="69"> --></claim-text>
<claim-text>a corresponding keyword selection rate storage unit that stores the corresponding keyword selection rate data generated by the corresponding keyword management device;</claim-text>
<claim-text>a corresponding keyword selection unit that obtains from the corresponding keyword selection rate data the corresponding keyword group associated with the search keyword stored in the search data storage unit, and selects at least any one of corresponding keywords included in the corresponding keyword group obtained, according to the corresponding keyword selection rate included in the corresponding keyword selection rate data; and</claim-text>
<claim-text>an encrypted data generation unit that generates encrypted data by encrypting the search data stored in the search data storage unit, and generates an encrypted keyword by encrypting the corresponding keyword selected by the corresponding keyword selection unit,</claim-text>
<claim-text>wherein the encrypted data storage unit of the search device stores the encrypted data and the encrypted keyword generated by the encrypted data generation device by associating the encrypted data and the encrypted keyword with each other.</claim-text></claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>The search system according to claim 3,<br/>
wherein the corresponding keyword number calculation unit of the corresponding keyword management device calculates the corresponding keyword number of each search keyword such that an appearance frequency of the each search keyword after being divided by the corresponding keyword number of the each search keyword is uniform, and<br/>
wherein the corresponding keyword number calculation unit calculates as the corresponding keyword selection rate an inverse number of the corresponding keyword<!-- EPO <DP n="70"> --> number for each search keyword.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>The search system according to claim 4,<br/>
wherein the corresponding keyword number calculation unit calculates a greatest common divisor of appearance frequencies of search keywords, and calculates as the corresponding keyword number of each search keyword a value obtained by dividing the appearance frequency of the each search keyword by the greatest common divisor.</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>The search system according to claim 3,<br/>
wherein the corresponding keyword number calculation unit of the corresponding keyword management device calculates as the corresponding keyword number of each search keyword a division number for dividing the appearance frequency of the each search keyword such that at least a predetermined anonymity number of search keywords have a same appearance frequency, and calculates as the corresponding keyword selection rate of the each search keyword a division rate for dividing the appearance frequency of the each search keyword.</claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>The search system according to claim 3,<br/>
wherein the corresponding keyword number calculation unit selects as a computing frequency a "k"th greatest appearance frequency from appearance frequencies of search keywords, "k" being a predetermined anonymity number, subtracts the computing frequency one or more times from an appearance frequency greater than or equal to the computing frequency, selects as a new computing frequency a "k"th greatest appearance frequency from the appearance frequencies of the search<!-- EPO <DP n="71"> --> keywords after subtraction, subtracts the new computing frequency one or more times from an appearance frequency greater than or equal to the new computing frequency, calculates as the corresponding keyword number of each search keyword a number of times each of the computing frequencies is subtracted from the appearance frequency of the each search keyword, and calculates as the corresponding keyword selection rate a rate of each of the computing frequencies with respect to the appearance frequency before subtraction.</claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>The search system according to claim 3,<br/>
wherein the corresponding keyword number calculation unit divides the appearance frequency of each search keyword into a plurality of appearance frequencies using an exponential value of a predetermined base, calculates as the corresponding keyword number of the each search keyword a division number of the appearance frequency of the each search keyword, and calculates as the corresponding keyword selection rate a rate of a divided appearance frequency with respect to the appearance frequency before being divided.</claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>The search system according to claim 8,<br/>
wherein the corresponding keyword number calculation unit, using the exponential value of the base, divides an appearance frequency that is common to less than a predetermined anonymity number of search keywords among the appearance frequencies of the search keywords after being divided.</claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>The search system according to claim 3,<br/>
wherein the corresponding keyword number calculation unit calculates, as a<!-- EPO <DP n="72"> --> corresponding probability value when a specific number of corresponding keywords are provided for each search keyword, a probability that each search keyword and each of the specific number of corresponding keywords are associated in a predetermined combination based on the appearance frequency of the each search keyword, calculates as an entropy value an entropy of the combination of the each search keyword and the each of the specific number of corresponding keywords based on the calculated corresponding probability value, calculates an entropy index value by multiplying the calculated entropy value by the corresponding probability value, compares the calculated entropy index value with a predetermined entropy threshold value, and calculates the specific number of corresponding keywords as the corresponding keyword number when the entropy index value is greater than the entropy threshold value, and<br/>
wherein the corresponding keyword number calculation unit calculates as the corresponding keyword selection rate an inverse number of the corresponding keyword number.</claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>A search method of a search system comprising an information processing device and a search device,<br/>
the information processing device including a corresponding keyword storage unit that stores as corresponding keyword data a corresponding keyword group associating a search keyword with one or more corresponding keywords,<br/>
the information processing device executing<br/>
a search keyword input process of inputting a search keyword;<br/>
a corresponding keyword group acquisition process of obtaining from the corresponding keyword data stored in the corresponding keyword storage unit a<!-- EPO <DP n="73"> --> corresponding keyword group associated with the search keyword input by the search keyword input unit;<br/>
an encrypted keyword group generation process of encrypting corresponding keywords included in the corresponding keyword group obtained by the corresponding keyword group acquisition process and thereby generating an encrypted keyword group; and<br/>
a search request data transmission process of transmitting to the search device search request data including the encrypted keyword group generated by the encrypted keyword group generation process,<br/>
the search device including an encrypted data storage unit that stores encrypted data generated by encrypting search data, the encrypted data storage unit storing for each search data the encrypted data generated by encrypting the each search data and an encrypted keyword generated by encrypting a corresponding keyword, the encrypted data and the encrypted keyword being associated with each other,<br/>
the search device executing<br/>
a search request data receiving process of receiving the search request data transmitted from the information processing device;<br/>
an encrypted data search process of obtaining from the encrypted data storage unit encrypted data associated with a search key using as the search key an encrypted keyword included in the encrypted keyword group in the search request data, based on the search request data received by the search request data receiving process; and<br/>
a search response data transmission process of transmitting search response data including the encrypted data obtained by the encrypted data search process,<br/>
the information processing device further executing<br/>
a search response receiving process of receiving the search response data<!-- EPO <DP n="74"> --> transmitted by the search device; and<br/>
a search result output process of decrypting the encrypted data included in the search response data received by the search response data receiving process and outputting as a search result search data obtained by decryption.</claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>An information processing device comprising:
<claim-text>a corresponding keyword storage unit that stores as corresponding keyword data a corresponding keyword group associating a search keyword with one or more corresponding keywords;</claim-text>
<claim-text>a search keyword input unit that inputs a search keyword;</claim-text>
<claim-text>a corresponding keyword group acquisition unit that obtains from the corresponding keyword data stored in the corresponding keyword storage unit a corresponding keyword group associated with the search keyword input by the search keyword input unit;</claim-text>
<claim-text>an encrypted keyword group generation unit that encrypts corresponding keywords included in the corresponding keyword group, thereby generating an encrypted keyword group, based on the corresponding keyword group obtained by the corresponding keyword group acquisition unit;</claim-text>
<claim-text>a search request data transmission unit that transmits to a predetermined search device search request data including the encrypted keyword group generated by the encrypted keyword group generation unit;</claim-text>
<claim-text>a search response data receiving unit that receives search response data transmitted by the search device, the search response data including encrypted data associated with the encrypted keyword; and</claim-text>
<claim-text>a search result output unit that decrypts the encrypted data included in the<!-- EPO <DP n="75"> --> search response data received by the search response data receiving unit, and outputs as a search result search data obtained by decryption.</claim-text></claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>A search program of an information processing device including a corresponding keyword storage unit that stores as corresponding keyword data a corresponding keyword group associating a search keyword with one or more corresponding keywords, the search program making the information processing device execute:
<claim-text>a search keyword input process of inputting a search keyword;</claim-text>
<claim-text>a corresponding keyword group acquisition process of obtaining from the corresponding keyword data stored in the corresponding keyword storage unit a corresponding keyword group associated with the search keyword input by the search keyword input unit;</claim-text>
<claim-text>an encrypted keyword group generation process of encrypting corresponding keywords included in the corresponding keyword group obtained by the corresponding keyword group acquisition process and thereby generating an encrypted keyword group, based on the corresponding keyword group obtained by the corresponding keyword group acquisition process;</claim-text>
<claim-text>a search request data transmission process of transmitting to a predetermined search device search request data including the encrypted keyword group generated by the encrypted keyword group generation process;</claim-text>
<claim-text>a search response data receiving process of receiving search response data transmitted by the search device, the search response data including encrypted data associated with the encrypted keyword group; and</claim-text>
<claim-text>a search result output process of decrypting the encrypted data included in the<!-- EPO <DP n="76"> --> search response data received by the search response data receiving process and outputting as a search result search data obtained by decryption.</claim-text></claim-text></claim><claim id="c-en-0014" num="0014"><claim-text>A corresponding keyword management device comprising:
<claim-text>an appearance frequency storage unit that stores appearance frequency data defining search keywords and defining as an appearance frequency of a specific search keyword a rate of search data associated with the specific search keyword;</claim-text>
<claim-text>a corresponding keyword number calculation unit that calculates as a corresponding keyword number a number of corresponding keywords to be associated with each of the search keywords, according to the appearance frequency of the each of the search keywords defined in the appearance frequency data stored in the appearance frequency storage unit, and calculates as a corresponding keyword selection rate a rate of selecting each corresponding keyword of the each of the search keywords;</claim-text>
<claim-text>a corresponding keyword group generation unit that generates as a corresponding keyword group a same number of corresponding keywords as each corresponding keyword number calculated by the corresponding keyword number calculation unit; and</claim-text>
<claim-text>a corresponding keyword data generation unit that generates, as corresponding keyword data, data associating each of the search keywords defined in the appearance frequency data, each corresponding keyword group generated by the corresponding keyword group generation unit, and each corresponding keyword selection rate calculated by the corresponding keyword number calculation unit with one another.</claim-text></claim-text></claim><claim id="c-en-0015" num="0015"><claim-text>The corresponding keyword management device according to claim 14,<br/>
wherein the corresponding keyword number calculation unit calculates as the<!-- EPO <DP n="77"> --> corresponding keyword number of each search keyword a division number for dividing the appearance frequency of the each search keyword such that at least a predetermined anonymity number of search keywords have a same appearance frequency, and calculates as the corresponding keyword selection rate of the each search keyword a division rate for dividing the appearance frequency of the each search keyword.</claim-text></claim><claim id="c-en-0016" num="0016"><claim-text>The corresponding keyword management device according to claim 14,<br/>
wherein the corresponding keyword number calculation unit selects as a computing frequency a "k"th greatest appearance frequency from appearance frequencies of search keywords, "k" being a predetermined anonymity number, subtracts the computing frequency one or more times from an appearance frequency greater than or equal to the computing frequency, selects as a new computing frequency a "k"th greatest appearance frequency from the appearance frequencies of the search keywords after subtraction, subtracts the new computing frequency one or more times from an appearance frequency greater than or equal to the new computing frequency, calculates as the corresponding keyword number a number of times each of the computing frequencies is subtracted from the appearance frequency of the each of the search keywords, and calculates as the corresponding keyword selection rate a rate of each of the computing frequencies with respect to the appearance frequency before subtraction.</claim-text></claim><claim id="c-en-0017" num="0017"><claim-text>The corresponding keyword management device according to claim 14,<br/>
wherein the corresponding keyword number calculation unit divides the appearance frequency of each search keyword into a plurality of appearance frequencies using an exponential value of a predetermined base, calculates as the corresponding<!-- EPO <DP n="78"> --> keyword number of the each search keyword a division number of the appearance frequency of the each search keyword, and calculates as the corresponding keyword selection rate a rate of a divided appearance frequency with respect to the appearance frequency before division.</claim-text></claim><claim id="c-en-0018" num="0018"><claim-text>The corresponding keyword management device according to claim 17,<br/>
wherein the corresponding keyword number calculation unit, using the exponential value of the base, divides an appearance frequency that is common to less than a predetermined anonymity number of search keywords among the appearance frequencies of the search keywords after being divided.</claim-text></claim><claim id="c-en-0019" num="0019"><claim-text>The corresponding keyword management device according to claim 14,<br/>
wherein the corresponding keyword number calculation unit calculates, as a corresponding probability value when a specific number of corresponding keywords are provided for each search keyword, a probability that the each search keyword and each of the specific number of corresponding keywords are associated in a predetermined combination, based on the appearance frequency of the each search keyword, calculates as an entropy value an entropy of the combination of the each search keyword and the each of the specific number of corresponding keywords based on the calculated corresponding probability value, calculates an entropy index value by multiplying the calculated entropy value by the corresponding probability value, compares the calculated entropy index value with a predetermined entropy threshold value, and calculates the specific number of corresponding keywords as the corresponding keyword number when the entropy index value is greater than the entropy threshold value, and<br/>
<!-- EPO <DP n="79"> -->wherein the corresponding keyword number calculation unit calculates as the corresponding keyword selection rate an inverse number of the corresponding keyword number.</claim-text></claim><claim id="c-en-0020" num="0020"><claim-text>A corresponding keyword management program of a corresponding keyword management device including an appearance frequency storage unit that stores appearance frequency data defining search keywords and defining as an appearance frequency of a specific search keyword a rate of search data to be associated with the specific search keyword, the corresponding keyword management program making the corresponding keyword management device execute:
<claim-text>a corresponding keyword number calculation process of calculating as a corresponding keyword number a number of corresponding keywords to be associated with each of the search keywords according to the appearance frequency of the each of the search keywords defined in the appearance frequency data stored in the appearance frequency storage unit, and calculating as a corresponding keyword selection rate a rate of selecting each corresponding keyword of the each of the search keywords;</claim-text>
<claim-text>a corresponding keyword group generation process of generating as a corresponding keyword group a same number of corresponding keywords as each corresponding keyword number calculated by the corresponding keyword number calculation process; and</claim-text>
<claim-text>a corresponding keyword data generation process of generating, as corresponding keyword data, data associating each of the search keywords defined in the appearance frequency data, each corresponding keyword group generated by the corresponding keyword group generation process, and each corresponding keyword selection rate calculated by corresponding keyword number calculation unit with one<!-- EPO <DP n="80"> --> another.</claim-text></claim-text></claim></claims><drawings mxw-id="PDW16667151" load-source="patent-office"><!-- EPO <DP n="81"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="163" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="82"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="163" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="83"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="163" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="84"> --><figure id="f0004" num="4"><img id="if0004" file="imgf0004.tif" wi="163" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="85"> --><figure id="f0005" num="5"><img id="if0005" file="imgf0005.tif" wi="163" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="86"> --><figure id="f0006" num="6"><img id="if0006" file="imgf0006.tif" wi="163" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="87"> --><figure id="f0007" num="7"><img id="if0007" file="imgf0007.tif" wi="163" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="88"> --><figure id="f0008" num="8"><img id="if0008" file="imgf0008.tif" wi="165" he="213" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="89"> --><figure id="f0009" num="9"><img id="if0009" file="imgf0009.tif" wi="156" he="194" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="90"> --><figure id="f0010" num="10"><img id="if0010" file="imgf0010.tif" wi="162" he="231" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="91"> --><figure id="f0011" num="11"><img id="if0011" file="imgf0011.tif" wi="129" he="138" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="92"> --><figure id="f0012" num="12"><img id="if0012" file="imgf0012.tif" wi="152" he="138" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="93"> --><figure id="f0013" num="13"><img id="if0013" file="imgf0013.tif" wi="165" he="219" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="94"> --><figure id="f0014" num="14"><img id="if0014" file="imgf0014.tif" wi="165" he="207" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="95"> --><figure id="f0015" num="15"><img id="if0015" file="imgf0015.tif" wi="165" he="193" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="96"> --><figure id="f0016" num="16"><img id="if0016" file="imgf0016.tif" wi="165" he="222" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="97"> --><figure id="f0017" num="17"><img id="if0017" file="imgf0017.tif" wi="165" he="226" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="98"> --><figure id="f0018" num="18"><img id="if0018" file="imgf0018.tif" wi="165" he="215" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="99"> --><figure id="f0019" num="19"><img id="if0019" file="imgf0019.tif" wi="165" he="215" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="100"> --><figure id="f0020" num="20"><img id="if0020" file="imgf0020.tif" wi="165" he="215" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="101"> --><figure id="f0021" num="21"><img id="if0021" file="imgf0021.tif" wi="165" he="215" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="102"> --><figure id="f0022" num="22"><img id="if0022" file="imgf0022.tif" wi="165" he="215" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="103"> --><figure id="f0023" num="23"><img id="if0023" file="imgf0023.tif" wi="165" he="215" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="104"> --><figure id="f0024" num="24"><img id="if0024" file="imgf0024.tif" wi="165" he="215" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="105"> --><figure id="f0025" num="25"><img id="if0025" file="imgf0025.tif" wi="165" he="215" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="106"> --><figure id="f0026" num="26"><img id="if0026" file="imgf0026.tif" wi="165" he="215" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="107"> --><figure id="f0027" num="27"><img id="if0027" file="imgf0027.tif" wi="165" he="215" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="108"> --><figure id="f0028" num="28"><img id="if0028" file="imgf0028.tif" wi="126" he="222" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="109"> --><figure id="f0029" num="29"><img id="if0029" file="imgf0029.tif" wi="165" he="218" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="110"> --><figure id="f0030" num="30"><img id="if0030" file="imgf0030.tif" wi="165" he="218" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="111"> --><figure id="f0031" num="31"><img id="if0031" file="imgf0031.tif" wi="165" he="218" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="112"> --><figure id="f0032" num="32"><img id="if0032" file="imgf0032.tif" wi="165" he="218" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="113"> --><figure id="f0033" num="33"><img id="if0033" file="imgf0033.tif" wi="165" he="218" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="114"> --><figure id="f0034" num="34"><img id="if0034" file="imgf0034.tif" wi="165" he="231" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="115"> --><figure id="f0035" num="35"><img id="if0035" file="imgf0035.tif" wi="165" he="231" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="116"> --><figure id="f0036" num="36"><img id="if0036" file="imgf0036.tif" wi="165" he="231" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="117"> --><figure id="f0037" num="37"><img id="if0037" file="imgf0037.tif" wi="165" he="208" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="118"> --><figure id="f0038" num="38"><img id="if0038" file="imgf0038.tif" wi="165" he="194" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="119"> --><figure id="f0039" num="39"><img id="if0039" file="imgf0039.tif" wi="165" he="230" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="120"> --><figure id="f0040" num="40"><img id="if0040" file="imgf0040.tif" wi="106" he="187" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="121"> --><figure id="f0041" num="41"><img id="if0041" file="imgf0041.tif" wi="165" he="222" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="122"> --><figure id="f0042" num="42"><img id="if0042" file="imgf0042.tif" wi="165" he="228" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="123"> --><figure id="f0043" num="43"><img id="if0043" file="imgf0043.tif" wi="162" he="233" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="165" he="229" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="165" he="229" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
