<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2680157-A1" country="EP" doc-number="2680157" kind="A1" date="20140101" family-id="48703175" file-reference-id="223322" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146549473" ucid="EP-2680157-A1"><document-id><country>EP</country><doc-number>2680157</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-13173462-A" is-representative="YES"><document-id mxw-id="PAPP154823396" load-source="docdb" format="epo"><country>EP</country><doc-number>13173462</doc-number><kind>A</kind><date>20130624</date><lang>EN</lang></document-id><document-id mxw-id="PAPP188910895" load-source="docdb" format="original"><country>EP</country><doc-number>13173462.6</doc-number><date>20130624</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140452359" ucid="US-201213538343-A" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201213538343</doc-number><kind>A</kind><date>20120629</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988115653" load-source="docdb">G06F  17/50        20060101ALI20131014BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988116836" load-source="docdb">G06F  17/13        20060101AFI20131014BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-2004750100" load-source="docdb" scheme="CPC">G06F2217/16        20130101 LA20151104BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2004752654" load-source="docdb" scheme="CPC">G06F  17/13        20130101 FI20151104BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2004753200" load-source="docdb" scheme="CPC">G06F  17/5009      20130101 LI20151104BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132180903" lang="DE" load-source="patent-office">Co-Simulationsverfahren unter Verwendung von vollständigen Ableitungen von Ausgangsvariablen</invention-title><invention-title mxw-id="PT132180904" lang="EN" load-source="patent-office">Co-simulation procedures using full derivatives of output variables</invention-title><invention-title mxw-id="PT132180905" lang="FR" load-source="patent-office">Procédures de co-simulation utilisant des dérivés complettes de variables de sortie</invention-title><citations><non-patent-citations><nplcit><text>Bastian J et al:  "Master for Co-Simulation Using FMI", Proceedings of conference Modelica 2011, 20-22 March 2011, Dresden, Germany, 20 March 2011 (2011-03-20), XP055083500, Retrieved from the Internet: URL:https://www.modelica.org/events/modeli ca2011/Proceedings/pages/papers/05_2_ID_16 5_a_fv.pdf [retrieved on 2013-10-10]</text><sources><source mxw-id="PNPL45131113" load-source="docdb" name="SEA" category="A"/></sources></nplcit><nplcit><text>Blochwitz T et al:  "Functional Mockup Interface 2.0: The Standard for Tool independent Exchange of Simulation Models", Proceedings of conference Modelica 2012, 3-5 September 2012, Munich, Germany, 3 September 2012 (2012-09-03), pages 173-184, XP055083442, Retrieved from the Internet: URL:https://svn.fmi-standard.org/fmi/branc hes/public/docs/Modelica2012/ecp12076173_B lochwitzOtter.pdf [retrieved on 2013-10-10]</text><sources><source mxw-id="PNPL45131114" load-source="docdb" name="SEA" category="AP"/></sources></nplcit><nplcit><text>Blochwitz T et al:  "The Functional Mockup Interface for Tool independent Exchange of Simulation Models", Proceedings of conference Modelica 2011, 20-22 March 2011, Dresden, Germany, 20 March 2011 (2011-03-20), XP055083443, Retrieved from the Internet: URL:https://www.modelica.org/events/modeli ca2011/Proceedings/pages/papers/05_1_ID_17 3_a_fv.pdf [retrieved on 2013-10-10]</text><sources><source mxw-id="PNPL45131115" load-source="docdb" name="SEA" category="A"/></sources></nplcit><nplcit><text>ITEA2:  "Functional Mock-up Interface for Model Exchange and Co-Simulation v2.0 Beta 3", Output document of ITEA2 project MODELISAR, 14 November 2011 (2011-11-14), XP055083479, Retrieved from the Internet: URL:https://svn.fmi-standard.org/fmi/branc hes/public/specifications/FMI_for_ModelExc hange_and_CoSimulation_v2.0_Beta3.pdf [retrieved on 2013-10-10]</text><sources><source mxw-id="PNPL45131116" load-source="docdb" name="SEA" category="A"/></sources></nplcit><nplcit><text>None</text><sources><source mxw-id="PNPL45131117" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>Sicklinger S et al:  "Interface-Jacobian based co-simulation", Abstract of presentation at the COUPLED PROBLEMS 2013 conference, 17-19 June 2013, Sta. Eulalia, Ibiza, Spain, 17 June 2013 (2013-06-17), XP055083472, Retrieved from the Internet: URL:http://congress.cimne.com/coupled2013/proceedings/pdfs/a869.pdf [retrieved on 2013-10-10]</text><sources><source mxw-id="PNPL45131118" load-source="docdb" name="SEA" category="L"/></sources></nplcit><nplcit><text>Sicklinger S et al:  "Interface-Jacobian based co-simulation", Abstract of presentation at the NWC 2013 Conference, 9-12 June 2013, Salzburg, Austria, 9 June 2013 (2013-06-09), XP055083466, Retrieved from the Internet: URL:http://www.nafems.org/downloads/nwc13/abstracts/344_Sicklinger.pdf [retrieved on 2013-10-10]</text><sources><source mxw-id="PNPL45131119" load-source="docdb" name="SEA" category="L"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR918153988" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>DASSAULT SYSTEMES</last-name><address><country>FR</country></address></addressbook></applicant><applicant mxw-id="PPAR918173691" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>DASSAULT SYSTEMES</last-name></addressbook></applicant><applicant mxw-id="PPAR918987621" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Dassault Systèmes</last-name><iid>101081585</iid><address><street>10 Rue Marcel Dassault</street><city>78140 Velizy Villacoublay</city><country>FR</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918163795" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ELMQVIST HILDING</last-name><address><country>SE</country></address></addressbook></inventor><inventor mxw-id="PPAR918171920" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>ELMQVIST, HILDING</last-name></addressbook></inventor><inventor mxw-id="PPAR918978606" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>ELMQVIST, HILDING</last-name><address><street>Ideon Science Park</street><city>Lunde 22370</city><country>SE</country></address></addressbook></inventor><inventor mxw-id="PPAR918163035" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>OLSSON HANS ROLAND</last-name><address><country>SE</country></address></addressbook></inventor><inventor mxw-id="PPAR918146507" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>OLSSON, HANS ROLAND</last-name></addressbook></inventor><inventor mxw-id="PPAR918982949" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>OLSSON, HANS ROLAND</last-name><address><street>Ideon Science Park</street><city>Lunde 22370</city><country>SE</country></address></addressbook></inventor><inventor mxw-id="PPAR918170219" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>BELSKY VLADIMIR</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918171531" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>BELSKY, VLADIMIR</last-name></addressbook></inventor><inventor mxw-id="PPAR918990531" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>BELSKY, VLADIMIR</last-name><address><street>166 Valley Street</street><city>Providence,RI 02909</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918152420" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>ENGELMANN BRUCE EDWARD</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918139923" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>ENGELMANN, BRUCE EDWARD</last-name></addressbook></inventor><inventor mxw-id="PPAR918993049" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>ENGELMANN, BRUCE EDWARD</last-name><address><street>166 Valley Street</street><city>Providence, RI 02909</city><country>US</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918991298" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Hirsch &amp; Associés</last-name><iid>101259449</iid><address><street>58, avenue Marceau</street><city>75008 Paris</city><country>FR</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS548805235" load-source="docdb">AL</country><country mxw-id="DS548842592" load-source="docdb">AT</country><country mxw-id="DS548805237" load-source="docdb">BE</country><country mxw-id="DS548870623" load-source="docdb">BG</country><country mxw-id="DS548896293" load-source="docdb">CH</country><country mxw-id="DS548882934" load-source="docdb">CY</country><country mxw-id="DS548842593" load-source="docdb">CZ</country><country mxw-id="DS548805246" load-source="docdb">DE</country><country mxw-id="DS548882935" load-source="docdb">DK</country><country mxw-id="DS548882940" load-source="docdb">EE</country><country mxw-id="DS548867371" load-source="docdb">ES</country><country mxw-id="DS548870624" load-source="docdb">FI</country><country mxw-id="DS548896310" load-source="docdb">FR</country><country mxw-id="DS548805247" load-source="docdb">GB</country><country mxw-id="DS548882941" load-source="docdb">GR</country><country mxw-id="DS548805248" load-source="docdb">HR</country><country mxw-id="DS548842594" load-source="docdb">HU</country><country mxw-id="DS548805184" load-source="docdb">IE</country><country mxw-id="DS548882942" load-source="docdb">IS</country><country mxw-id="DS548896311" load-source="docdb">IT</country><country mxw-id="DS548882943" load-source="docdb">LI</country><country mxw-id="DS548870625" load-source="docdb">LT</country><country mxw-id="DS548864264" load-source="docdb">LU</country><country mxw-id="DS548870626" load-source="docdb">LV</country><country mxw-id="DS548870627" load-source="docdb">MC</country><country mxw-id="DS548864265" load-source="docdb">MK</country><country mxw-id="DS548864266" load-source="docdb">MT</country><country mxw-id="DS548805185" load-source="docdb">NL</country><country mxw-id="DS548867372" load-source="docdb">NO</country><country mxw-id="DS548805190" load-source="docdb">PL</country><country mxw-id="DS548870628" load-source="docdb">PT</country><country mxw-id="DS548842595" load-source="docdb">RO</country><country mxw-id="DS548870629" load-source="docdb">RS</country><country mxw-id="DS548805191" load-source="docdb">SE</country><country mxw-id="DS548896312" load-source="docdb">SI</country><country mxw-id="DS548867373" load-source="docdb">SK</country><country mxw-id="DS548867374" load-source="docdb">SM</country><country mxw-id="DS548864267" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128670142" lang="EN" load-source="patent-office"><p id="pa01" num="0001">A computer-implemented method for use in simulating dynamic behavior of complex engineering systems comprised of several subsystems includes computing (104) a Jacobian matrix based on output derivatives, wherein the output derivatives are based on corresponding state variable derivatives related to corresponding first input variables for each of a plurality of subsystems. The method also includes modifying (112) the first input variables and computing (116) second input variables and residuals for each of the plurality of subsystems based on corresponding state variable derivatives.
<img id="iaf01" file="imgaf001.tif" wi="78" he="130" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128499515" lang="EN" source="EPO" load-source="docdb"><p>A computer-implemented method for use in simulating dynamic behavior of complex engineering systems comprised of several subsystems includes computing (104) a Jacobian matrix based on output derivatives, wherein the output derivatives are based on corresponding state variable derivatives related to corresponding first input variables for each of a plurality of subsystems. The method also includes modifying (112) the first input variables and computing (116) second input variables and residuals for each of the plurality of subsystems based on corresponding state variable derivatives.</p></abstract><description mxw-id="PDES63955572" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001">BACKGROUND OF THE INVENTION</heading><p id="p0001" num="0001">The embodiments described herein relate generally to co-simulation methods for use with simulation of models of real-world objects and, more particularly, to using parallel execution of the methods during such simulations.</p><p id="p0002" num="0002">Science and engineering often require modeling of physical systems in order to solve problems. Models of the problems can then be solved without the need of constructing and, frequently, destroying, physical specimens. However, complex multi-disciplinary systems need to be broken up into multiple subsystem models, where the various sub-problems are examined and solved. The term "co-simulation" refers generally to an approach to simulating coupled technical systems. For example, in a master-slave system, one or more slave subsystems would simulate sub-problems while the master system coordinates the overall simulation and transfers data between slave subsystems. The slave subsystems can be "coupled" in order to communicate data during simulation at certain times</p><p id="p0003" num="0003">At least some known processes for addressing co-simulation problems are based on establishing specific rules of transferring output variables, or some combinations of output variables, from one subsystem at a "rendezvous" or "communication" time to another subsystem as input variables, and vice versa at the same or previous time. The stability of such processes depends on how strong the coupling conditions are relative to the stiffness of the subsystems themselves. Typically, such processes require subsystems to be processed in a specific order. However, such a requirement requires knowledge of the numerical properties of the individual subsystems and coupling conditions. This prevents using a generic co-simulation procedure from being built and used to analyze different problems. Moreover, such a requirement can greatly reduce performance in analyzing the overall model because it does not enable a parallel co-simulation computational procedure.<!-- EPO <DP n="2"> --></p><p id="p0004" num="0004">Other, more advanced processes address the issues of stability and accuracy in co-simulation techniques by utilizing stabilized modular time integration approaches that can be applied to coupled differential algebraic equations. Such processes are based on the use of Jacobian matrices that correspond to algebraic equations between input and output variables. When algebraic loops are present in a system, known co-simulation processes may become computationally unstable. For example, this will happen if, for a pair of explicitly dependent input variables of a first subsystem and output variables of a second subsystem, input variables of the second subsystem also explicitly depend on the output variables of the first subsystem. Iterative processes for algebraic variables are sometimes used in such cases to improve stability.</p><p id="p0005" num="0005">For systems that do not include algebraic loops, non-iterative linearly implicit stabilization processes enable a specific chain of communication to be established between the increments of input and output variables at the communication time points. Linear implicit behavior for the output and state variables is often assumed between the communication points for each subsystem. However, this approach requires certain multiplications of Jacobian matrices, corresponding to specific subsystem integration schemes, to be communicated between co-simulated subsystems.</p><p id="p0006" num="0006">Furthermore, some known processes use a domain decomposition approach for solving problems in structural dynamics, for example. Such processes address co-simulation using condensed components of subsystem matrices that are exposed in the interfaces between subsystems. These matrices are constructed based on time integration equations for each subsystem.</p><p id="p0007" num="0007">The approaches described above use a modular approach that assumes communication of only the output and input variables and only at the communication points, which may lead to unstable co-simulation processes. Moreover, these approaches require investigation of the presence of algebraic loops in the algebraic system of input-output relationships. Furthermore, these approaches<!-- EPO <DP n="3"> --> are dependent on the order in which the subsystems are processed and, consequently, prevent the co-simulation process from running in parallel.</p><heading id="h0002">BRIEF DESCRIPTION OF THE INVENTION</heading><p id="p0008" num="0008">In one aspect, a computer-implemented method includes computing a Jacobian matrix based on output derivatives related to corresponding first input variables for each of a plurality of subsystems, modifying the first input variables, and computing second input variables and residuals for each of the plurality of subsystems based on corresponding state variable derivatives.</p><p id="p0009" num="0009">In another aspect, a computer includes a memory area and a processor coupled to the memory area. The memory area is configured to store a Jacobian matrix, output derivatives, first and second input variables for each of a plurality of subsystems, residuals for each of the plurality of subsystems, and state variable derivatives corresponding to the first input variables and residuals. The processor is configured to communicate with the memory area to compute the Jacobian matrix based on the output derivatives related to the corresponding first input variables for each of the plurality of subsystems, modify the first input variables, and compute the second input variables and the residuals for each of the plurality of subsystems based on the corresponding state variable derivatives.</p><p id="p0010" num="0010">The computer may comprise one or more of the following:
<ul><li>the residuals are second residuals, said processor further configured to compute input increments and first residuals for each of the plurality of subsystems based on corresponding predictors;</li><li>said processor is further configured to compute the output derivatives related to the corresponding first input variables for each of the plurality of subsystems to compute the Jacobian matrix</li><li>said processor is further configured to factorize the Jacobian matrix;</li><li>said processor is further configured to: assemble the residuals, and compute input increments based on the factorized Jacobian matrix to compute the second input variables;<!-- EPO <DP n="4"> --></li><li>said processor is further configured to compute outputs for each of the plurality of subsystems based on corresponding correctors;</li><li>said memory area is further configured to store the outputs.</li></ul></p><p id="p0011" num="0011">In another aspect, a computer program product includes one or more non-transitory computer-readable storage media having computer-executable components thereon. The computer-executable components include a Jacobian matrix component that when executed by a processor causes the processor to compute a Jacobian matrix based on output derivatives related to corresponding first input variables for each of a plurality of subsystems. The components also include a modification component that when executed by a processor causes the processor to modify the first input variables, and a second derivative component that when executed by a processor causes the processor to compute second input variables and residuals for each of the plurality of subsystems based on corresponding state variable derivatives.</p><p id="p0012" num="0012">The computer program may comprise one or more of the following:
<ul><li>the residuals are second residuals, said second derivative component further causes the processor to compute input increments and first residuals for each of the plurality of subsystems based on corresponding predictors;</li><li>said computer-executable components further comprise a first derivative component that when executed by a processor causes the processor to compute the output derivatives related to the corresponding first input variables for each of the plurality of subsystems to facilitate computing the Jacobian matrix;</li><li>said Jacobian matrix component further causes the processor to factorize the Jacobian matrix;</li><li>said Jacobian matrix component further causes the processor to: assemble the residuals, and compute input increments based on the factorized Jacobian matrix to compute the second input variables;</li><li>said computer-executable components further comprise an output component that when executed by a processor causes the processor to compute outputs for each of the plurality of subsystems based on corresponding correctors;<!-- EPO <DP n="5"> --></li><li>said output component further causes the processor to store in a memory area one or more of the Jacobian matrix, the output derivatives, the first input variables, the second input variables, the residuals, and the outputs.</li></ul></p><heading id="h0003">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p0013" num="0013">The details of one or more embodiments of the invention are set forth in the accompanying drawings and the description that follows. Other features, objects, and advantages of the invention will be apparent from the description and drawings, and from the claims.
<ul><li><figref idrefs="f0001">Figure 1</figref> is a flowchart that illustrates an exemplary computer-implemented method for use in simulating a model of a physical object.</li><li><figref idrefs="f0002">Figure 2</figref> is a schematic block diagram of an exemplary computer network for use with the method shown in <figref idrefs="f0001">Figure 1</figref>.</li><li><figref idrefs="f0003">Figure 3</figref> is a schematic block diagram of an exemplary computer architecture for use with the method shown in <figref idrefs="f0001">Figure 1</figref>.</li></ul></p><heading id="h0004">DETAILED DESCRIPTION OF THE INVENTION</heading><p id="p0014" num="0014">Exemplary embodiments of systems, methods, apparatus (computers), and computer program products for use in simulating models of three-dimensional objects are described herein. The embodiments described herein facilitate simulating dynamic behavior of complex engineering systems, which are comprised of several subsystems and is often performed by a modular approach in which the global system is naturally decomposed into several subsystems. As a result of such approach each individual subsystem can be modeled and analyzed separately and even in parallel by means of exchange of information between different software components used to model each subsystem. The examples of such systems could be high precision tool machines or modem automobiles requiring the modeling of multiple components which may represent different engineering fields (different physics), e.g. mechanics, controls, electronics, hydraulics, etc. More specifically, the embodiments described herein facilitate communicating proper components of<!-- EPO <DP n="6"> --> full Jacobian matrices. These Jacobian matrices include partial derivatives of output variables with respect to inputs, thereby representing direct output-to-input dependency. Moreover, the Jacobian matrices include derivatives related to output-to-input dependency via state variables, thereby representing indirect output-to-input dependency. Further, the embodiments described herein eliminate the need to inspect for the presence of algebraic loops and provide an enhanced global system Jacobian matrix that can be used to update input increments. In addition, the embodiments described herein facilitate parallel time integration of individual subsystems, thereby enhancing performance in the overall simulation and analysis of a model.</p><p id="p0015" num="0015"><figref idrefs="f0001">Figure 1</figref> is a flowchart 100 that illustrates an exemplary computer-implemented method for use in simulating dynamic behavior of complex engineering systems comprised of several subsystems. As described above, a co-simulation process is one in which several time-dependent simulations proceed independently between "rendezvous" or "communication" time points <i>t<sub>n</sub></i> for n = 0, 1, ... <i>n<sub>f</sub></i>, where <i>n<sub>f</sub></i> is the total number of co-simulation steps. At each communication point, an exchange of information occurs between individual subsystem simulations. The entire co-simulation process proceeds from the initial time <i>t<sub>start</sub></i> = t<sub>0</sub> to the end time <i>t<sub>finish</sub></i> = <i>t<sub>n<sub2>f</sub2></sub></i>. Consequently, in some embodiments, there is no data exchange between the individual subsystem simulations at any point between <i>t<sub>n</sub></i> and <i>t</i><sub><i>n</i>+1</sub>. However, in such embodiments, it is not assumed that the co-simulation time steps between Δ<i>t</i><sub><i>n</i>+1</sub> = <i>t</i><sub><i>n</i>+1</sub> - <i>t<sub>n</sub></i> are the same. Moreover, in some embodiments, the behavior of each individual subsystem simulation is described by an ordinary differential equation as shown in Equations (1) and (2):<!-- EPO <DP n="7"> --> <maths id="math0001" num="eq. (1)"><math display="block"><msup><mover><mi>x</mi><mo>˙</mo></mover><mi>ι</mi></msup><mfenced><mi>t</mi></mfenced><mo>=</mo><msup><mi>f</mi><mi>i</mi></msup><mfenced separators=""><msup><mi>x</mi><mi>i</mi></msup><mfenced><mi>t</mi></mfenced><mo>,</mo><msup><mi>u</mi><mi>i</mi></msup><mfenced><mi>t</mi></mfenced></mfenced></math><img id="ib0001" file="imgb0001.tif" wi="100" he="15" img-content="math" img-format="tif"/></maths> <maths id="math0002" num="eq. (2)"><math display="block"><msup><mi>y</mi><mi>i</mi></msup><mfenced><mi>t</mi></mfenced><mo>=</mo><msup><mi>g</mi><mi>i</mi></msup><mfenced separators=""><msup><mi>x</mi><mi>i</mi></msup><mfenced><mi>t</mi></mfenced><mo>,</mo><msup><mi>u</mi><mi>i</mi></msup><mfenced><mi>t</mi></mfenced></mfenced><mo>,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>r</mi></math><img id="ib0002" file="imgb0002.tif" wi="100" he="15" img-content="math" img-format="tif"/></maths><br/>
where <i>ẋ<sup>l</sup>t</i> represents state variables of the <i>i</i>-th subsystem; <i>u<sup>i</sup></i> and <i>y<sup>i</sup></i> represent input and output variables for the same subsystem, respectively; and r ≥ 2 is the number of subsystem in the co-simulation process.</p><p id="p0016" num="0016">Coupling two or more subsystems is governed by linear or non-linear algebraic input-output relationships, as shown in Equation (3): <maths id="math0003" num="eq. (3)"><math display="block"><msup><mi>u</mi><mi>i</mi></msup><mfenced><mi>t</mi></mfenced><mo>=</mo><msup><mi>z</mi><mi>i</mi></msup><mfenced separators=""><msup><mi>y</mi><mi>j</mi></msup><mfenced><mi>t</mi></mfenced><mo>,</mo><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>r</mi><mo>,</mo><mi>j</mi><mo>≠</mo><mi>i</mi></mfenced><mo>,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>r</mi></math><img id="ib0003" file="imgb0003.tif" wi="120" he="8" img-content="math" img-format="tif"/></maths></p><p id="p0017" num="0017">For example, for the case of two subsystems, a coupling equation could be written as shown in Equation (4): <maths id="math0004" num="eq. (4)"><math display="block"><msup><mi>u</mi><mn>1</mn></msup><mfenced><mi>t</mi></mfenced><mo>=</mo><msup><mi>y</mi><mn>2</mn></msup><mfenced><mi>t</mi></mfenced><mo>;</mo><msup><mi>u</mi><mn>2</mn></msup><mfenced><mi>t</mi></mfenced><mo>=</mo><msup><mi>y</mi><mn>1</mn></msup><mfenced><mi>t</mi></mfenced></math><img id="ib0004" file="imgb0004.tif" wi="84" he="9" img-content="math" img-format="tif"/></maths></p><p id="p0018" num="0018">Assuming that all of the inputs are linear between the communication points leads to Equation (5): <maths id="math0005" num="eq. (5)"><math display="block"><msup><mi>u</mi><mi>i</mi></msup><mfenced><mi>t</mi></mfenced><mo>=</mo><mfrac><mrow><msubsup><mi>u</mi><mi>n</mi><mi>i</mi></msubsup><mo>⋅</mo><mfenced separators=""><msub><mi>t</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>-</mo><mi>t</mi></mfenced><mo>+</mo><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>⋅</mo><mfenced separators=""><mi>t</mi><mo>-</mo><msub><mi>t</mi><mi>n</mi></msub></mfenced></mrow><mrow><msub><mi>t</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>-</mo><msub><mi>t</mi><mi>n</mi></msub></mrow></mfrac></math><img id="ib0005" file="imgb0005.tif" wi="97" he="14" img-content="math" img-format="tif"/></maths><br/>
where state and output variables for all individual subsystems at the time <i>t</i><sub><i>n</i>+1</sub> may be approximated as shown in Equation (6): <maths id="math0006" num="eq. (6)"><math display="block"><msubsup><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>=</mo><msup><mi>F</mi><mi>i</mi></msup><mo>⁢</mo><mfenced separators=""><msubsup><mi>x</mi><mi>n</mi><mi>i</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mi>n</mi><mi>i</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mfenced><mo>,</mo></math><img id="ib0006" file="imgb0006.tif" wi="88" he="12" img-content="math" img-format="tif"/></maths> <maths id="math0007" num=""><math display="block"><msubsup><mi>y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>=</mo><msup><mi>g</mi><mi>i</mi></msup><mo>⁢</mo><mfenced separators=""><msup><mi>F</mi><mi>i</mi></msup><mo>⁢</mo><mfenced separators=""><msubsup><mi>x</mi><mi>n</mi><mi>i</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mi>n</mi><mi>i</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mfenced><mo>,</mo><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mfenced></math><img id="ib0007" file="imgb0007.tif" wi="72" he="13" img-content="math" img-format="tif"/></maths></p><p id="p0019" num="0019">Notably, the variables <maths id="math0008" num=""><math display="inline"><msubsup><mi>x</mi><mi>n</mi><mi>i</mi></msubsup></math><img id="ib0008" file="imgb0008.tif" wi="7" he="8" img-content="math" img-format="tif" inline="yes"/></maths> and <maths id="math0009" num=""><math display="inline"><msubsup><mi>u</mi><mi>n</mi><mi>i</mi></msubsup></math><img id="ib0009" file="imgb0009.tif" wi="7" he="8" img-content="math" img-format="tif" inline="yes"/></maths> are always available at the beginning of each co-simulation time step. When an approximation of input variables at the end of this step <maths id="math0010" num=""><math display="inline"><msubsup><mover><mi>u</mi><mo>‾</mo></mover><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></math><img id="ib0010" file="imgb0010.tif" wi="12" he="8" img-content="math" img-format="tif" inline="yes"/></maths> is known, an increment of the input variables <maths id="math0011" num=""><math display="inline"><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></math><img id="ib0011" file="imgb0011.tif" wi="14" he="8" img-content="math" img-format="tif" inline="yes"/></maths> is determined from the solution of the system of linear equations, as shown in Equation (7):<!-- EPO <DP n="8"> --> <maths id="math0012" num="eq. (7)"><math display="block"><mi>J</mi><mo>⁢</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msub><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>h</mi></math><img id="ib0012" file="imgb0012.tif" wi="61" he="14" img-content="math" img-format="tif"/></maths><br/>
where J is a full-coupled Jacobian matrix of the input-output relation, and as expressed in Equation (8): <maths id="math0013" num="eq. (8)"><math display="block"><mi>J</mi><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><mi>I</mi></mtd><mtd><mo>-</mo><mfrac><mrow><mo>∂</mo><msup><mi>z</mi><mn>1</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>y</mi><mn>2</mn></msup></mrow></mfrac><mo>⁢</mo><mfenced separators=""><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mn>2</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac><mo>⁢</mo><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mn>2</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mn>2</mn></msup></mrow></mfrac><mo>+</mo><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mn>2</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mn>2</mn></msup></mrow></mfrac></mfenced></mtd><mtd><mo>⋯</mo></mtd><mtd><mo>-</mo><mfrac><mrow><mo>∂</mo><msup><mi>z</mi><mn>1</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>y</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mfrac><mo>⁢</mo><mfenced separators=""><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mrow><mo>∂</mo><msup><mi>x</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mfrac><mo>⁢</mo><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mfrac><mo>+</mo><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mfrac></mfenced></mtd><mtd><mo>-</mo><mfrac><mrow><mo>∂</mo><msup><mi>z</mi><mn>1</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>y</mi><mi>r</mi></msup></mrow></mfrac><mo>⁢</mo><mfenced separators=""><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mi>r</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>x</mi><mi>r</mi></msup></mrow></mfrac><mo>⁢</mo><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mi>r</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mi>r</mi></msup></mrow></mfrac><mo>+</mo><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mi>r</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mi>r</mi></msup></mrow></mfrac></mfenced></mtd></mtr><mtr><mtd><mo>-</mo><mfrac><mrow><mo>∂</mo><msup><mi>z</mi><mn>2</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>y</mi><mn>1</mn></msup></mrow></mfrac><mo>⁢</mo><mfenced separators=""><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mn>1</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>x</mi><mn>1</mn></msup></mrow></mfrac><mo>⁢</mo><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mn>1</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mn>1</mn></msup></mrow></mfrac><mo>+</mo><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mn>1</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mn>1</mn></msup></mrow></mfrac></mfenced></mtd><mtd><mi>I</mi></mtd><mtd><mo>⋯</mo></mtd><mtd><mo>-</mo><mfrac><mrow><mo>∂</mo><msup><mi>z</mi><mn>2</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>y</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mfrac><mo>⁢</mo><mfenced separators=""><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mrow><mo>∂</mo><msup><mi>x</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mfrac><mo>⁢</mo><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mfrac><mo>+</mo><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mfrac></mfenced></mtd><mtd><mo>-</mo><mfrac><mrow><mo>∂</mo><msup><mi>z</mi><mn>2</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>y</mi><mi>r</mi></msup></mrow></mfrac><mo>⁢</mo><mfenced separators=""><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mi>r</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>x</mi><mi>r</mi></msup></mrow></mfrac><mo>⁢</mo><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mn>2</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mi>r</mi></msup></mrow></mfrac><mo>+</mo><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mi>r</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mi>r</mi></msup></mrow></mfrac></mfenced></mtd></mtr><mtr><mtd><mo>⋯</mo></mtd><mtd><mo>⋯</mo></mtd><mtd><mo>⋯</mo></mtd><mtd><mo>⋯</mo></mtd><mtd><mo>⋯</mo></mtd></mtr><mtr><mtd><mo>-</mo><mfrac><mrow><mo>∂</mo><msup><mi>z</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mrow><mo>∂</mo><msup><mi>y</mi><mn>1</mn></msup></mrow></mfrac><mo>⁢</mo><mfenced separators=""><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mn>1</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>x</mi><mn>1</mn></msup></mrow></mfrac><mo>⁢</mo><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mn>1</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mn>1</mn></msup></mrow></mfrac><mo>+</mo><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mn>1</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mn>1</mn></msup></mrow></mfrac></mfenced></mtd><mtd><mo>-</mo><mfrac><mrow><mo>∂</mo><msup><mi>z</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mrow><mo>∂</mo><msup><mi>y</mi><mn>2</mn></msup></mrow></mfrac><mo>⁢</mo><mfenced separators=""><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mn>2</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac><mo>⁢</mo><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mn>2</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mn>2</mn></msup></mrow></mfrac><mo>+</mo><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mn>2</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mn>2</mn></msup></mrow></mfrac></mfenced></mtd><mtd><mo>⋯</mo></mtd><mtd><mi>I</mi></mtd><mtd><mo>-</mo><mfrac><mrow><mo>∂</mo><msup><mi>z</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mrow><mo>∂</mo><msup><mi>y</mi><mi>r</mi></msup></mrow></mfrac><mo>⁢</mo><mfenced separators=""><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mi>r</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>x</mi><mi>r</mi></msup></mrow></mfrac><mo>⁢</mo><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mi>r</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mi>r</mi></msup></mrow></mfrac><mo>+</mo><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mi>r</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mi>r</mi></msup></mrow></mfrac></mfenced></mtd></mtr><mtr><mtd><mo>-</mo><mfrac><mrow><mo>∂</mo><msup><mi>z</mi><mi>r</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>y</mi><mn>1</mn></msup></mrow></mfrac><mo>⁢</mo><mfenced separators=""><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mn>1</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>x</mi><mn>1</mn></msup></mrow></mfrac><mo>⁢</mo><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mn>1</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mn>1</mn></msup></mrow></mfrac><mo>+</mo><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mn>1</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mn>1</mn></msup></mrow></mfrac></mfenced></mtd><mtd><mo>-</mo><mfrac><mrow><mo>∂</mo><msup><mi>z</mi><mi>r</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>y</mi><mn>2</mn></msup></mrow></mfrac><mo>⁢</mo><mfenced separators=""><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mn>2</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac><mo>⁢</mo><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mn>2</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mn>2</mn></msup></mrow></mfrac><mo>+</mo><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mn>2</mn></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mn>2</mn></msup></mrow></mfrac></mfenced></mtd><mtd><mo>⋯</mo></mtd><mtd><mo>-</mo><mfrac><mrow><mo>∂</mo><msup><mi>z</mi><mi>r</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>y</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mfrac><mo>⁢</mo><mfenced separators=""><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mrow><mo>∂</mo><msup><mi>x</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mfrac><mo>⁢</mo><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mfrac><mo>+</mo><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup></mrow></mfrac></mfenced></mtd><mtd><mi>I</mi></mtd></mtr></mtable></mfenced></math><img id="ib0013" file="imgb0013.tif" wi="158" he="49" img-content="math" img-format="tif"/></maths></p><p id="p0020" num="0020">Here <i>h</i> is the current residual of the input-output relationship, as expressed in Equation (9): <maths id="math0014" num="eq. (9)"><math display="block"><mi>h</mi><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><msup><mi>z</mi><mn>1</mn></msup><mo>⁢</mo><mfenced separators=""><msup><mi>g</mi><mi>j</mi></msup><mo>⁢</mo><mfenced separators=""><msup><mi>F</mi><mi>j</mi></msup><mo>⁢</mo><mfenced separators=""><msubsup><mi>x</mi><mi>n</mi><mi>j</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mi>n</mi><mi>j</mi></msubsup><mo>⁢</mo><msubsup><mover><mi>u</mi><mo>‾</mo></mover><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>j</mi></msubsup></mfenced><mo>,</mo><msubsup><mover><mi>u</mi><mo>‾</mo></mover><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>j</mi></msubsup></mfenced><mo>,</mo><mi>j</mi><mo>≠</mo><mn>1</mn></mfenced><mo>-</mo><msubsup><mover><mi>u</mi><mo>‾</mo></mover><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mn>1</mn></msubsup></mtd></mtr><mtr><mtd><msup><mi>z</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><msup><mi>g</mi><mi>j</mi></msup><mo>⁢</mo><mfenced separators=""><msup><mi>F</mi><mi>j</mi></msup><mo>⁢</mo><mfenced separators=""><msubsup><mi>x</mi><mi>n</mi><mi>j</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mi>n</mi><mi>j</mi></msubsup><mo>⁢</mo><msubsup><mover><mi>u</mi><mo>‾</mo></mover><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>j</mi></msubsup></mfenced><mo>,</mo><msubsup><mover><mi>u</mi><mo>‾</mo></mover><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>j</mi></msubsup></mfenced><mo>,</mo><mi>j</mi><mo>≠</mo><mn>2</mn></mfenced><mo>-</mo><msubsup><mover><mi>u</mi><mo>‾</mo></mover><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mn>2</mn></msubsup></mtd></mtr><mtr><mtd><mo>⋯</mo></mtd></mtr><mtr><mtd><msup><mi>z</mi><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><mfenced separators=""><msup><mi>g</mi><mi>j</mi></msup><mo>⁢</mo><mfenced separators=""><msup><mi>F</mi><mi>j</mi></msup><mo>⁢</mo><mfenced separators=""><msubsup><mi>x</mi><mi>n</mi><mi>j</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mi>n</mi><mi>j</mi></msubsup><mo>⁢</mo><msubsup><mover><mi>u</mi><mo>‾</mo></mover><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>j</mi></msubsup></mfenced><mo>,</mo><msubsup><mover><mi>u</mi><mo>‾</mo></mover><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>j</mi></msubsup></mfenced><mo>,</mo><mi>j</mi><mo>≠</mo><mi>r</mi><mo>-</mo><mn>1</mn></mfenced><mo>-</mo><msubsup><mover><mi>u</mi><mo>‾</mo></mover><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><msup><mi>z</mi><mi>r</mi></msup><mo>⁢</mo><mfenced separators=""><msup><mi>g</mi><mi>j</mi></msup><mo>⁢</mo><mfenced separators=""><msup><mi>F</mi><mi>j</mi></msup><mo>⁢</mo><mfenced separators=""><msubsup><mi>x</mi><mi>n</mi><mi>j</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mi>n</mi><mi>j</mi></msubsup><mo>⁢</mo><msubsup><mover><mi>u</mi><mo>‾</mo></mover><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>j</mi></msubsup></mfenced><mo>,</mo><msubsup><mover><mi>u</mi><mo>‾</mo></mover><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>j</mi></msubsup></mfenced><mo>,</mo><mi>j</mi><mo>≠</mo><mi>r</mi></mfenced><mo>-</mo><msubsup><mover><mi>u</mi><mo>‾</mo></mover><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>r</mi></msubsup></mtd></mtr></mtable></mfenced><mo>;</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msub><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mn>1</mn></msubsup></mtd></mtr><mtr><mtd><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mn>2</mn></msubsup></mtd></mtr><mtr><mtd><mo>⋯</mo></mtd></mtr><mtr><mtd><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>r</mi></msubsup></mtd></mtr></mtable></mfenced></math><img id="ib0014" file="imgb0014.tif" wi="158" he="31" img-content="math" img-format="tif"/></maths></p><p id="p0021" num="0021">Based on the above equations, it should be apparent that each individual subsystem simulation <i>j</i> supplies a full derivative of its own output with respect to its inputs <maths id="math0015" num=""><math display="inline"><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mi>j</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mi>j</mi></msup></mrow></mfrac><mo>=</mo><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mi>j</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>x</mi><mi>j</mi></msup></mrow></mfrac><mo>⁢</mo><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mi>j</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mi>j</mi></msup></mrow></mfrac><mo>+</mo><mfrac><mrow><mo>∂</mo><msup><mi>g</mi><mi>j</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mi>j</mi></msup></mrow></mfrac><mo>,</mo></math><img id="ib0015" file="imgb0015.tif" wi="37" he="10" img-content="math" img-format="tif" inline="yes"/></maths> which include contributions from corresponding derivatives of state variables and are computed at the beginning of a respective co-simulation step.</p><p id="p0022" num="0022">The <maths id="math0016" num=""><math display="inline"><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mi>j</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mi>j</mi></msup></mrow></mfrac></math><img id="ib0016" file="imgb0016.tif" wi="8" he="12" img-content="math" img-format="tif" inline="yes"/></maths> value can be approximated in a number of ways. Two will be described here but one of skill in the art will understand that other methods may be used. The two described herein rely on applying methods of approximating derivatives.</p><p id="p0023" num="0023">The first method of approximating <maths id="math0017" num=""><math display="inline"><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mi>j</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mi>j</mi></msup></mrow></mfrac></math><img id="ib0017" file="imgb0017.tif" wi="8" he="12" img-content="math" img-format="tif" inline="yes"/></maths> is to use divided differences as shown in Equation (10):<!-- EPO <DP n="9"> --> <maths id="math0018" num="eq. (10)"><math display="block"><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mi>j</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mi>j</mi></msup></mrow></mfrac><mo>≈</mo><msup><mfenced open="[" close="]"><mtable><mtr><mtd><mfrac><mrow><msup><mi>F</mi><mi>j</mi></msup><mo>⁢</mo><mfenced separators=""><msubsup><mi>x</mi><mi>n</mi><mi>j</mi></msubsup><mo>,</mo><msubsup><mi>u</mi><mi>n</mi><mi>j</mi></msubsup><mo>,</mo><msubsup><mover><mi>u</mi><mo>‾</mo></mover><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>j</mi></msubsup><mo>+</mo><mi>ε</mi><mo>⁢</mo><msub><mi>e</mi><mn>1</mn></msub></mfenced><mo>-</mo><msup><mi>F</mi><mi>j</mi></msup><mo>⁢</mo><mfenced separators=""><msubsup><mi>x</mi><mi>n</mi><mi>j</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mi>n</mi><mi>j</mi></msubsup><mo>⁢</mo><msubsup><mover><mi>u</mi><mo>‾</mo></mover><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>j</mi></msubsup></mfenced></mrow><mi>ε</mi></mfrac></mtd></mtr><mtr><mtd><mfrac><mrow><msup><mi>F</mi><mi>j</mi></msup><mo>⁢</mo><mfenced separators=""><msubsup><mi>x</mi><mi>n</mi><mi>j</mi></msubsup><mo>,</mo><msubsup><mi>u</mi><mi>n</mi><mi>j</mi></msubsup><mo>,</mo><msubsup><mover><mi>u</mi><mo>‾</mo></mover><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>j</mi></msubsup><mo>+</mo><mi>ε</mi><mo>⁢</mo><msub><mi>e</mi><mn>2</mn></msub></mfenced><mo>-</mo><msup><mi>F</mi><mi>j</mi></msup><mo>⁢</mo><mfenced separators=""><msubsup><mi>x</mi><mi>n</mi><mi>j</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mi>n</mi><mi>j</mi></msubsup><mo>⁢</mo><msubsup><mover><mi>u</mi><mo>‾</mo></mover><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>j</mi></msubsup></mfenced></mrow><mi>ε</mi></mfrac></mtd></mtr><mtr><mtd><mo>⋮</mo></mtd></mtr></mtable></mfenced><mi>T</mi></msup></math><img id="ib0018" file="imgb0018.tif" wi="109" he="34" img-content="math" img-format="tif"/></maths><br/>
where ε is a suitably small number and <i>e<sub>m</sub></i> is the m-th unit-vector. The column dimension of each matrix <maths id="math0019" num=""><math display="inline"><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mi>j</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mi>j</mi></msup></mrow></mfrac></math><img id="ib0019" file="imgb0019.tif" wi="8" he="10" img-content="math" img-format="tif" inline="yes"/></maths> is equal to the dimension of corresponding vector of input variables <i>u<sup>j</sup></i>.</p><p id="p0024" num="0024">The second method of approximating <maths id="math0020" num=""><math display="inline"><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mi>j</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mi>j</mi></msup></mrow></mfrac></math><img id="ib0020" file="imgb0020.tif" wi="8" he="10" img-content="math" img-format="tif" inline="yes"/></maths> is to use a Padé-approximation of a matrix-exponential for the linearized system. Specifically, a (2,1)-Padé approximation results in Equation (11): <maths id="math0021" num="eq. (11)"><math display="block"><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mi>j</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mi>j</mi></msup></mrow></mfrac><mo>≈</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>⁢</mo><msup><mfenced separators=""><mi>I</mi><mo>⋅</mo><mfrac><mn>1</mn><mrow><msub><mi>t</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>-</mo><msub><mi>t</mi><mi>n</mi></msub></mrow></mfrac><mo>-</mo><mfrac><mrow><mo>∂</mo><msup><mi>f</mi><mi>j</mi></msup><mfenced separators=""><msubsup><mi>x</mi><mi>n</mi><mi>j</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mi>n</mi><mi>j</mi></msubsup></mfenced></mrow><mrow><mo>∂</mo><msubsup><mi>x</mi><mi>n</mi><mi>j</mi></msubsup></mrow></mfrac><mo>⋅</mo><mfrac><mn>1</mn><mn>3</mn></mfrac></mfenced><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><mfrac><mrow><mo>∂</mo><msup><mi>f</mi><mi>j</mi></msup><mfenced separators=""><msubsup><mi>x</mi><mi>n</mi><mi>j</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mi>n</mi><mi>j</mi></msubsup></mfenced></mrow><mrow><mo>∂</mo><msubsup><mi>u</mi><mi>n</mi><mi>j</mi></msubsup></mrow></mfrac></math><img id="ib0021" file="imgb0021.tif" wi="119" he="18" img-content="math" img-format="tif"/></maths></p><p id="p0025" num="0025">It should be understood that a higher order Padé-approximation may also be used. This approximation can be computed directly or may alternatively be combined with the simulation of subsystem <i>j</i> since implicit integration methods for each subsystem are also approximate <maths id="math0022" num=""><math display="inline"><mfrac><mrow><mo>∂</mo><msup><mi>f</mi><mi>j</mi></msup><mfenced separators=""><msubsup><mi>x</mi><mi>n</mi><mi>j</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mi>n</mi><mi>j</mi></msubsup></mfenced></mrow><mrow><mo>∂</mo><msubsup><mi>x</mi><mi>n</mi><mi>j</mi></msubsup></mrow></mfrac><mn>.</mn></math><img id="ib0022" file="imgb0022.tif" wi="19" he="13" img-content="math" img-format="tif" inline="yes"/></maths> Moreover, some embodiments transform this matrix to Hessenberg form to handle subsystem integration with varying step-sizes more efficiently, which enhances speed in solving <maths id="math0023" num=""><math display="inline"><mrow><mo>(</mo></mrow><mi>I</mi><mo>⋅</mo><mi>α</mi><mo>-</mo></math><img id="ib0023" file="imgb0023.tif" wi="18" he="13" img-content="math" img-format="tif" inline="yes"/></maths> <maths id="math0024" num=""><math display="inline"><mfrac><mrow><mo>∂</mo><msup><mi>f</mi><mi>j</mi></msup><mfenced separators=""><msubsup><mi>x</mi><mi>n</mi><mi>j</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mi>n</mi><mi>j</mi></msubsup></mfenced></mrow><mrow><mo>∂</mo><msubsup><mi>x</mi><mi>n</mi><mi>j</mi></msubsup></mrow></mfrac><mo>⋅</mo><mi>β</mi><mo>⁢</mo><msup><mrow><mo>)</mo></mrow><mrow><mo>-</mo><mn>1</mn></mrow></msup></math><img id="ib0024" file="imgb0024.tif" wi="30" he="15" img-content="math" img-format="tif" inline="yes"/></maths> for an arbitrary matrix γ and arbitrary non-zero scalars α, β.</p><p id="p0026" num="0026">One advantage of the embodiments described herein is the use of these derivatives, which are completely independent of each other, and are computed in parallel by each individual subsystem simulation process. State variables, derivatives of the state variables, and the algorithm used by each individual subsystem simulation process to perform integration between communication points remain completely internal or localized within each process and are not visible to other subsystem simulation processes or to the global or master co-simulation driver. The only visible quantity provided by each subsystem simulation process, and which<!-- EPO <DP n="10"> --> quantity is necessary to compute the Jacobian matrix, is a full derivative of the subsystem simulation process output with respect to an input computed for predicted values of input variables at the end of each current co-simulation time increment. The global Jacobian matrix is assembled, or computed, using partial derivatives of each input as a function of all other outputs in the coupling equation, which is typically represented by an algebraic expression, and by the individual output derivatives.</p><p id="p0027" num="0027">Moreover, final values of all input variables for all subsystem simulation processes at the end of a given co-simulation time increment <i>t</i><sub><i>n</i>+1</sub> are determined as a result of an iterative process. On each iteration <i>k</i>, input increments are determined as a solution of the system of linear equations presented above. Typically, a Jacobian matrix is computed and factorized only once per each co-simulation time increment, while the global residual vector is recomputed at each iteration based on the updated input variables in Equation (12): <maths id="math0025" num="eq. (12)"><math display="block"><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>=</mo><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>k</mi></mrow><mi>i</mi></msubsup><mo>+</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>k</mi></mrow><mi>i</mi></msubsup><mo>,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>r</mi></math><img id="ib0025" file="imgb0025.tif" wi="115" he="9" img-content="math" img-format="tif"/></maths></p><p id="p0028" num="0028">In an exemplary embodiment, the initial approximation of the global residual vector is determined for each subsystem process using a predictor. One predictor is expressed in Equation (13): <maths id="math0026" num="eq. (13)"><math display="block"><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn><mo>,</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>=</mo><msubsup><mi>u</mi><mi>n</mi><mi>i</mi></msubsup><mo>,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>r</mi></math><img id="ib0026" file="imgb0026.tif" wi="92" he="10" img-content="math" img-format="tif"/></maths></p><p id="p0029" num="0029">In some embodiments, only a single iteration is performed to determine the input increments for all of the individual subsystem simulation processes. However, in the exemplary embodiment, several nonlinear iterations are performed to facilitate enhanced accuracy without sacrificing performance.</p><p id="p0030" num="0030">Another advantage of the embodiments described herein is that there is no time integration process within each individual subsystem simulation process for the residual computations. Rather, the derivatives of individual state variables with respect to corresponding inputs <maths id="math0027" num=""><math display="inline"><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mi>j</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mi>j</mi></msup></mrow></mfrac></math><img id="ib0027" file="imgb0027.tif" wi="8" he="10" img-content="math" img-format="tif" inline="yes"/></maths> are computed and stored by each individual subsystem simulation process. Accordingly, updated state variables and output variables are approximated based on Equation (14):<!-- EPO <DP n="11"> --> <maths id="math0028" num="eq. (14)"><math display="block"><mtable columnalign="left"><mtr><mtd><mspace width="2em"/><msubsup><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>=</mo><msup><mi>F</mi><mi>i</mi></msup><mo>⁢</mo><mfenced separators=""><msubsup><mi>x</mi><mi>n</mi><mi>i</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mi>n</mi><mi>i</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mfenced><mo>≅</mo><msup><mi>F</mi><mi>i</mi></msup><mo>⁢</mo><mfenced separators=""><msubsup><mi>x</mi><mi>n</mi><mi>i</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mi>n</mi><mi>i</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>k</mi></mrow><mi>i</mi></msubsup></mfenced><mo>+</mo></mtd></mtr><mtr><mtd><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mi>i</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mi>i</mi></msup></mrow></mfrac><mo>⁢</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>k</mi></mrow><mi>i</mi></msubsup><mo>=</mo><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>k</mi></mrow><mi>i</mi></msubsup><mo>+</mo><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mi>i</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mi>i</mi></msup></mrow></mfrac><mo>⁢</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>k</mi></mrow><mi>i</mi></msubsup><mo>,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>r</mi></mtd></mtr></mtable></math><img id="ib0028" file="imgb0028.tif" wi="126" he="20" img-content="math" img-format="tif"/></maths></p><p id="p0031" num="0031">In an exemplary embodiment, Equation (14) is more efficiently computed based on the exact solution of the ordinary differential equation shown in Equation (15): <maths id="math0029" num="eq. (15)"><math display="block"><mtable><mtr><mtd><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msup><mover><mi>x</mi><mo>˙</mo></mover><mi>ι</mi></msup><mfenced><mi>t</mi></mfenced><mo>=</mo><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mi>i</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>x</mi><mi>i</mi></msup></mrow></mfrac><mo>⁢</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msup><mi>x</mi><mi>i</mi></msup><mfenced><mi>t</mi></mfenced><mo>+</mo><mfrac><mrow><mo>∂</mo><msup><mi>F</mi><mi>i</mi></msup></mrow><mrow><mo>∂</mo><msup><mi>u</mi><mi>i</mi></msup></mrow></mfrac><mo>⁢</mo><msup><mover><mi>u</mi><mo>˙</mo></mover><mi>ι</mi></msup><mo>⁢</mo><mfenced separators=""><mi>t</mi><mo>-</mo><msub><mi>t</mi><mi>n</mi></msub></mfenced><mo>,</mo><msub><mi>t</mi><mi>n</mi></msub><mo>≤</mo><mi>t</mi><mo>≤</mo><msub><mi>t</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msup><mi>x</mi><mi>i</mi></msup><mfenced><msub><mi>t</mi><mi>n</mi></msub></mfenced><mo>=</mo></mtd></mtr><mtr><mtd><mn>0</mn><mo>,</mo><msup><mover><mi>u</mi><mo>˙</mo></mover><mi>ι</mi></msup><mo>=</mo><mfrac><mrow><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mrow><mrow><msub><mi>t</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>-</mo><msub><mi>t</mi><mi>n</mi></msub></mrow></mfrac></mtd></mtr></mtable></math><img id="ib0029" file="imgb0029.tif" wi="120" he="24" img-content="math" img-format="tif"/></maths></p><p id="p0032" num="0032">Notably, Equation (15) leads to a different solution than one that is obtained under an assumption of linear behavior of state variables between neighboring communication time points.</p><p id="p0033" num="0033">After the iterative process for the nonlinear system of input-output relations is complete, the final values of input variables <maths id="math0030" num=""><math display="inline"><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>r</mi></math><img id="ib0030" file="imgb0030.tif" wi="35" he="8" img-content="math" img-format="tif" inline="yes"/></maths> are determined, and the corrector integration for each individual subsystem simulation process is computed to complete the integration process for a given co-simulation time increment. These calculations are independent of each other and, therefore, can be performed in parallel. The calculations are shown in Equations (16) and (17): <maths id="math0031" num="eq. (16)"><math display="block"><msubsup><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>=</mo><msup><mi>F</mi><mi>i</mi></msup><mo>⁢</mo><mfenced separators=""><msubsup><mi>x</mi><mi>n</mi><mi>i</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mi>n</mi><mi>i</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mfenced></math><img id="ib0031" file="imgb0031.tif" wi="88" he="12" img-content="math" img-format="tif"/></maths> <maths id="math0032" num="eq. (17)"><math display="block"><msubsup><mi>y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo>=</mo><msup><mi>g</mi><mi>i</mi></msup><mo>⁢</mo><mfenced separators=""><msup><mi>F</mi><mi>i</mi></msup><mo>⁢</mo><mfenced separators=""><msubsup><mi>x</mi><mi>n</mi><mi>i</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mi>n</mi><mi>i</mi></msubsup><mo>⁢</mo><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mfenced><mo>,</mo><msubsup><mi>u</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></msubsup></mfenced></math><img id="ib0032" file="imgb0032.tif" wi="88" he="13" img-content="math" img-format="tif"/></maths></p><p id="p0034" num="0034">Referring now to <figref idrefs="f0001">Figure 1</figref>, the process steps are shown for a single co-simulation time increment across a plurality of simulation subsystems. As used herein, the term "predictor" refers to an independent variable that represents a value being manipulated or changed. A predictor-corrector method proceeds in two steps. First, the prediction step calculates a rough approximation of the desired quantity. Second, the corrector step refines the initial approximation using another means. In an exemplary embodiment, a single co-simulation increment begins by computing 102 input increments and a first set of residuals for all subsystems using corresponding predictors. A Jacobian matrix is then computed 104 based on output derivatives related to a corresponding first set of input variables for each of the<!-- EPO <DP n="12"> --> subsystems. More specifically, output derivatives related to the corresponding first set of input variables are computed 106 for each of the subsystems, the Jacobian matrix is assembled 108, and the Jacobian matrix is then factorized 110.</p><p id="p0035" num="0035">In an exemplary embodiment, the Jacobian matrix is used to modify 112 the input variables. More specifically, the residuals are assembled 114 and input increments are computed based on the factorized Jacobian matrix. A second set of input variables and a second set of residuals are then computed 116 for each of the subsystems based on corresponding state variable derivatives. Final outputs are computed 118 for each of the subsystems based on corresponding correctors, and relevant data is stored 120 in a memory area. If subsequent time increments are necessary when <i>t</i><sub><i>n</i>+1</sub> &lt; <i>t<sub>finish</sub></i>, the process begins again with computation 102 of input increments and residuals for all subsystems using corresponding predictors on the subsequent time step.</p><p id="p0036" num="0036"><figref idrefs="f0002">Figure 2</figref> is a schematic block diagram of an exemplary computer network 200 for use in simulating dynamic behavior of complex engineering systems comprised of several subsystems, and/or for use in performing the processes described above and/or additional processes that may be related to those described above. In an exemplary embodiment, a memory area 202 includes one or more storage devices 204 for use in storing data, such as input increments, residuals, predictors, output derivatives, one or more Jacobian matrices, state variable derivatives, final system outputs, correctors, or any other suitable data. In some embodiments, the memory area 202 is coupled to a server system 206, which is in turn coupled to client systems 208 such as an administrator system and/or a user system, via a network 210. The storage devices 204 may be embodied as one or more databases, may be located at a single or at multiple geographical sites, or may be integrated with the server system 206.</p><p id="p0037" num="0037">As can be appreciated, the network 210 can be a public network, such as the Internet, or a private network such as an LAN or WAN network, or any combination thereof and can also include PSTN or ISDN sub-networks. The network 210 can also be wired, such as an Ethernet network, or can be wireless such as a cellular<!-- EPO <DP n="13"> --> network including EDGE, 3G, and 4G wireless cellular systems. The wireless network can also be WiFi, Bluetooth, or any other wireless form of communication that is known. Thus, the network 210 is merely exemplary and in no way limits the scope of the present advancements.</p><p id="p0038" num="0038">The client systems 208 can be any suitable computer architecture such as the one described below with reference to <figref idrefs="f0003">Figure 3</figref>, or any other computing architecture that is known. Moreover, it should be understood that the server system 206 is configured to perform the processes described above and/or any additional processes that may be related to those described above.</p><p id="p0039" num="0039">The server system 206 stores the computer-readable instructions to execute the processes described above, and provides these instructions via the network 210 to the client systems 208. Moreover, the server system 206 can also provide data from the memory area 202 as needed to the client systems 208 such that the client systems 208 execute the processes described above. As such, <figref idrefs="f0002">Figure 2</figref> includes implementations of the computer system 200 via cloud computing, distributed computing, and the like.</p><p id="p0040" num="0040">During operation, the server system 206 and the client systems 208 interact to perform the steps described above in <figref idrefs="f0001">Figure 1</figref>. For example, the server system 206 performs operations within a single co-simulation increment by computing input increments and a first set of residuals for all subsystems using corresponding predictors. The server system 206 then computes a Jacobian matrix based on output derivatives related to a corresponding first set of input variables for each of the subsystems. More specifically, output derivatives related to the corresponding first set of input variables are computed on the basis of corresponding state variable derivatives for each of the subsystems, the Jacobian matrix is assembled, and the Jacobian matrix is then factorized. Moreover, in an exemplary embodiment, the server system 206 uses the factorized Jacobian matrix to modify the first set of input variables. More specifically, the first set of residuals is assembled and input increments are computed based on the factorized Jacobian matrix. The server system 206 then computes a second set of input variables and a second set of<!-- EPO <DP n="14"> --> residuals for each of the subsystems based on corresponding state variable derivatives. The server system 206 also computes final outputs for each of the subsystems based on corresponding correctors, and stores the data in memory area 202. The server system 206 may also transmit the final outputs and/or the data to one or more client systems 208 for display to a user.</p><p id="p0041" num="0041"><figref idrefs="f0003">Figure 3</figref> is a schematic block diagram of an exemplary computer architecture 300 for use with the server system 206 and/or the client systems 208 (each shown in <figref idrefs="f0002">Figure 2</figref>).</p><p id="p0042" num="0042">In an exemplary embodiment, the computer architecture 300 includes one or more processors 302 (CPU) that performs the processes described above and/or any additional processes that may be related to those described above. It should be understood that the term "processor" refers generally to any programmable system including systems and microcontrollers, reduced instruction set circuits (RISC), application-specific integrated circuits (ASIC), programmable logic circuits, and/or any other circuit or processor capable of executing the functions described herein. The above examples are exemplary only and, thus, are not intended to limit in any way the definition and/or meaning of the term "processor."</p><p id="p0043" num="0043">The steps of the processes described above and/or any additional processes that may be related to those described above may be stored as computer-executable instructions in, for example, a memory area 304 that is operably and/or communicatively coupled to the processor 302 by a system bus 306. A "memory area," as used herein, refers generally to any means of storing non-transitory program code and instructions executable by one or more processors to aid in simulating dynamic behavior of complex engineering systems comprised of several subsystems, and/or for use in performing the processes described above and/or additional processes that may be related to those described above. The memory area 304 may include one, or more than one, forms of memory. For example, the memory area 304 may include random-access memory (RAM) 308, which can include non-volatile RAM, magnetic RAM, ferroelectric RAM, and/or other forms of RAM. The memory area 304 may also include read-only memory (ROM) 310<!-- EPO <DP n="15"> --> and/or flash memory and/or electrically-programmable read-only memory (EEPROM). Any other suitable magnetic, optical, and/or semiconductor memory, such as a hard-disk drive (HDD) 312, by itself or in combination with other forms of memory, may be included in the memory area 304. The HDD 312 may also be coupled to a disk controller 314 for use in transmitting and receiving messages to and from the processor 302. Moreover, the memory area 304 may also be, or may include, a detachable or removable memory 316, such as a suitable cartridge disk, CD-ROM, DVD, or USB memory. The above examples are exemplary only and, thus, are not intended to limit in any way the definition and/or meaning of the term "memory area."</p><p id="p0044" num="0044">The computer architecture 300 also includes a display device 318 that is coupled, such as operatively coupled, to a display controller 320. The display controller 320 receives data via the system bus 306 for display by the display device 318. The display device 318 may be, without limitation, a monitor, a television display, a plasma display, a liquid crystal display (LCD), a display based on light-emitting diodes (LED), a display based on organic LEDs (OLED), a display based on polymer LEDs, a display based on surface-conduction electron emitters, a display including a projected and/or reflected image, or any other suitable electronic device or display mechanism. Moreover, the display device 318 may include a touchscreen with an associated touchscreen controller 320. The above examples are exemplary only and, thus, are not intended to limit in any way the definition and/or meaning of the term "display device."</p><p id="p0045" num="0045">In addition, the computer architecture 300 includes a network interface 322 for use in communicating with a network (not shown in <figref idrefs="f0003">Figure 3</figref>). Moreover, the computer architecture 300 includes one or more input devices, such as a keyboard 324 and/or a pointing device 326, such as a roller ball, mouse, touchpad, and the like. The input devices are coupled to and controlled by an input/output (I/O) interface 328, which is further coupled to the system bus 306.</p><p id="p0046" num="0046">A description of the general features and functionality of the display device 318, keyboard 324, pointing device 326, as well as the display controller 320, disk<!-- EPO <DP n="16"> --> controller 314, network interface 322, and I/O interface 328 is omitted herein for brevity as these features are known.</p><p id="p0047" num="0047">During operation, the processor 302 performs the steps described above in <figref idrefs="f0001">Figure 1</figref>. For example, the processor 302 performs operations within a single co-simulation increment by computing input increments and a first set of residuals for all subsystems using corresponding predictors. The processor 302 then computes a Jacobian matrix based on output derivatives related to a corresponding first set of input variables for each of the subsystems. More specifically, output derivatives related to the corresponding first set of input variables are computed on the basis of corresponding state variables derivatives for each of the subsystems, the Jacobian matrix is assembled, and the Jacobian matrix is then factorized. Moreover, in an exemplary embodiment, the processor 302 uses the factorized Jacobian matrix to modify the first set of input variables. More specifically, the first set of residuals is assembled and input increments are computed based on the factorized Jacobian matrix. The processor 302 then computes a second set of input variables and a second set of residuals for each of the subsystems based on corresponding state variable derivatives. The processor 302 also computes final outputs for each of the subsystems based on corresponding correctors, and stores the data in memory area 304. The processor 302 may also transmit the final outputs and/or the data to the display controller 320 for display to a user via the display device 318.</p><p id="p0048" num="0048">Exemplary embodiments of methods, systems, apparatuses, and computer program products for use in simulating dynamic behavior of complex engineering systems comprised of several subsystems are described above in detail. The methods, systems, apparatuses, and computer program products are not limited to the specific embodiments described herein but, rather, some operations of the methods and/or components of the system and/or apparatus may be utilized independently and separately from other operations and/or components described herein. However, in some embodiments, the above-described sequence of operations of the methods and/or use of the components of the system and/or apparatus is necessary for correct operation. Further, the described operations and/or components may also be defined in, or used in combination with, other<!-- EPO <DP n="17"> --> systems, methods, and/or apparatus, and are not limited to practice with only the systems, methods, and storage media as described herein.</p><p id="p0049" num="0049">Client computers and servers, such as those described herein, includes at least one processor or processing unit and a system memory. The client computers and servers typically has at least some form of computer readable media. By way of example and not limitation, computer readable media include computer storage media and communication media. Computer storage media include volatile and nonvolatile, removable and non-removable media implemented in any method or technology for storage of information such as computer readable instructions, data structures, program modules, or other data. Communication media typically embody computer readable instructions, data structures, program modules, or other data in a modulated data signal such as a carrier wave or other transport mechanism and include any information delivery media. Those skilled in the art are familiar with the modulated data signal, which has one or more of its characteristics set or changed in such a manner as to encode information in the signal. Combinations of any of the above are also included within the scope of computer readable media.</p><p id="p0050" num="0050">Although the present invention is described in connection with an exemplary simulation system environment, embodiments of the invention are operational with numerous other general purpose or special purpose simulation system environments or configurations. The simulation system environment is not intended to suggest any limitation as to the scope of use or functionality of any aspect of the invention. Moreover, the simulation system environment should not be interpreted as having any dependency or requirement relating to any one or combination of components illustrated in the exemplary operating environment. Examples of well known simulation systems, environments, and/or configurations that may be suitable for use with aspects of the invention include, but are not limited to, personal computers, server computers, hand-held or laptop devices, multiprocessor systems, microprocessor-based systems, set top boxes, programmable consumer electronics, mobile telephones, network PCs, minicomputers, mainframe computers, distributed computing environments that include any of the above systems or devices, and the like.<!-- EPO <DP n="18"> --></p><p id="p0051" num="0051">Embodiments of the invention may be described in the general context of computer-executable instructions, such as program components or modules, executed by one or more computers or other devices. Aspects of the invention may be implemented with any number and organization of components or modules. For example, aspects of the invention are not limited to the specific computer-executable instructions or the specific components or modules illustrated in the figures and described herein. Alternative embodiments of the invention may include different computer-executable instructions or components having more or less functionality than illustrated and described herein.</p><p id="p0052" num="0052">An exemplary computer program product includes, for example, one or more non-transitory computer-readable storage media having computer-executable components thereon. The computer-executable components include a Jacobian matrix component that when executed by a processor, such as processor 302 (shown in <figref idrefs="f0003">Figure 3</figref>) or a processor of server system 206 (shown in <figref idrefs="f0002">Figure 2</figref>) causes the processor to compute a Jacobian matrix based on output derivatives related to corresponding input variables from a first set of input variables for each of a plurality of subsystems of a master system that represents the physical object. In some embodiments, the Jacobian matrix component further causes the processor to factorize the Jacobian matrix. Moreover, in some embodiments, the Jacobian matrix component further causes the processor to assemble a first set of residuals and compute input increments based on the factorized Jacobian matrix in order to compute a second set of input variables.</p><p id="p0053" num="0053">In an exemplary embodiment, the computer-executable components also include a modification component that causes the processor to modify the first set of input variables. Moreover, in an exemplary embodiment, the computer-executable components include a second derivative component that causes the processor to compute the second set of input variables and a second set of residuals for each of the plurality of subsystems based on corresponding state variable derivatives. In some embodiments, and when the residuals are a second set of residuals, the second derivative component causes the processor to compute input increments and a first<!-- EPO <DP n="19"> --> set of residuals for each of the plurality of subsystems based on corresponding predictors.</p><p id="p0054" num="0054">In some embodiments, the computer-executable components also include a first derivative component that causes the processor to compute the output derivatives related to the corresponding first set of input variables for each of the plurality of subsystems to facilitate computing the Jacobian matrix. Moreover, in some embodiments, the computer-executable components include an output component that causes the processor to compute outputs for each of the plurality of subsystems based on corresponding correctors. In some such embodiments, the output component also causes the processor to store in a memory area one or more of the Jacobian matrix, the output derivatives, the first input variables, the second input variables, the residuals, and the outputs.</p><p id="p0055" num="0055">The order of execution or performance of the operations in the embodiments of the invention illustrated and described herein is not essential, unless otherwise specified. That is, the operations may be performed in any order, unless otherwise specified, and embodiments of the invention may include additional or fewer operations than those disclosed herein. For example, it is contemplated that executing or performing a particular operation before, contemporaneously with, or after another operation is within the scope of aspects of the invention.</p><p id="p0056" num="0056">When introducing elements of aspects of the invention or embodiments thereof, the articles "a," "an," "the," and "said" are intended to mean that there are one or more of the elements. The terms "comprising," including," and "having" are intended to be inclusive and mean that there may be additional elements other than the listed elements.</p><p id="p0057" num="0057">This written description uses examples to disclose the invention, including the best mode, and also to enable any person skilled in the art to practice the invention, including making and using any devices or systems and performing any incorporated methods. The patentable scope of the invention is defined by the claims, and may include other examples that occur to those skilled in the art. Such other examples are intended to be within the scope of the claims if they have<!-- EPO <DP n="20"> --> structural elements that do not differ from the literal language of the claims, or if they include equivalent structural elements with insubstantial differences from the literal language of the claims.</p></description><claims mxw-id="PCLM56976490" lang="EN" load-source="patent-office"><!-- EPO <DP n="21"> --><claim id="c-en-0001" num="0001"><claim-text>A computer-implemented method comprising:
<claim-text>computing (104) a Jacobian matrix based on output derivatives, wherein the output derivatives are based on corresponding state variable derivatives related to corresponding first input variables for each of a plurality of subsystems;</claim-text>
<claim-text>modifying (112) the first input variables; and</claim-text>
<claim-text>computing (116) second input variables and residuals for ea ch of the plurality of subsystems based on corresponding state variable derivatives.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>A computer-implemented method in accordance with Claim 1, wherein the residuals are second residuals, said computer-implemented method further comprising computing input increments and first residuals for each of the plurality of subsystems based on corresponding predictors.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>A computer-implemented method in accordance with any of Claims 1 to 2, wherein computing a Jacobian matrix comprises computing the output derivatives based on the corresponding state variable derivatives related to the corresponding first input variables for each of the plurality of subsystems.</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>A computer-implemented method in accordance with any of Claims 1 to 3, wherein computing a Jacobian matrix comprises factorizing (110) the Jacobian matrix.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>A computer-implemented method in accordance with Claim 4, wherein computing second input variables comprises:
<claim-text>assembling the residuals; and</claim-text>
<claim-text>computing input increments based on the factorized Jacobian matrix.</claim-text><!-- EPO <DP n="22"> --></claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>A computer-implemented method in accordance with any of Claims 1 to 5, further comprising computing (118) outputs for each of the plurality of subsystems based on corresponding correctors.</claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>A computer comprising:
<claim-text>a memory area configured to store a Jacobian matrix, output derivatives, first and second input variables for each of a plurality of subsystems, residuals for each of the plurality of subsystems, state variable derivatives corresponding to the first input variables and residuals, and outputs; and</claim-text>
<claim-text>a processor coupled to said memory area, said processor being configured to perform the method of any of Claims 1 to 6.</claim-text></claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>A computer program product comprising instructions for execution by a computer, the instructions comprising means for performing the method of any of Claims 1 to 6.</claim-text></claim></claims><drawings mxw-id="PDW16667270" load-source="patent-office"><!-- EPO <DP n="23"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="151" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="24"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="165" he="194" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="25"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="165" he="194" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="160" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="157" he="233" type="tif"/><doc-page id="srep0003" file="srep0003.tif" wi="161" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
