<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2680520-A1" country="EP" doc-number="2680520" kind="A1" date="20140101" family-id="46384248" file-reference-id="318308" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146549168" ucid="EP-2680520-A1"><document-id><country>EP</country><doc-number>2680520</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12174386-A" is-representative="YES"><document-id mxw-id="PAPP154823091" load-source="docdb" format="epo"><country>EP</country><doc-number>12174386</doc-number><kind>A</kind><date>20120629</date><lang>EN</lang></document-id><document-id mxw-id="PAPP175260659" load-source="docdb" format="original"><country>EP</country><doc-number>12174386.8</doc-number><date>20120629</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140448443" ucid="EP-12174386-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>12174386</doc-number><kind>A</kind><date>20120629</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-2049521067" load-source="docdb">H04L  25/03        20060101AFI20150528BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-2049529857" load-source="docdb">H04L  25/02        20060101ALI20150528BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-2044367061" load-source="docdb" scheme="CPC">H04L  25/0204      20130101 LI20150625BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2044367187" load-source="docdb" scheme="CPC">H04B   7/0413      20130101 LI20150625BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2044367579" load-source="docdb" scheme="CPC">H04L   1/0054      20130101 LI20150625BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2044367963" load-source="docdb" scheme="CPC">H04L  25/03057     20130101 LI20150625BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2044368232" load-source="docdb" scheme="CPC">H04L  25/0246      20130101 LI20150626BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2044368797" load-source="docdb" scheme="CPC">H04L  25/03305     20130101 FI20150625BHEP        </classification-cpc><classification-cpc mxw-id="PCL2001016845" load-source="docdb" scheme="CPC">H04L  25/0328      20130101 LI20140117BHEP        </classification-cpc><classification-cpc mxw-id="PCL2001016846" load-source="docdb" scheme="CPC">H04L  25/03318     20130101 LI20140117BHEP        </classification-cpc><classification-cpc mxw-id="PCL2007295632" load-source="docdb" scheme="CPC">H04L  25/03171     20130101 LI20130719BHEP        </classification-cpc><classification-cpc mxw-id="PCL2007295633" load-source="docdb" scheme="CPC">H04L  25/03891     20130101 LI20140207BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132179988" lang="DE" load-source="patent-office">Turbo-Entzerrung unter Verwendung Paralleler Entzerrungsstufen</invention-title><invention-title mxw-id="PT132179989" lang="EN" load-source="patent-office">Turbo equalization using multiple parallel equalization stages</invention-title><invention-title mxw-id="PT132179990" lang="FR" load-source="patent-office">Égalisation Turbo en utililsant des égaliseurs parallèles</invention-title><citations><patent-citations><patcit mxw-id="PCIT371081248" load-source="docdb" ucid="WO-2010112370-A2"><document-id format="epo"><country>WO</country><doc-number>2010112370</doc-number><kind>A2</kind><date>20101007</date></document-id><sources><source name="SEA" category="XA" created-by-npl="N"/></sources></patcit></patent-citations><non-patent-citations><nplcit><text>BERARDINELLI G ET AL: "Turbo Receivers for Single User MIMO LTE-A Uplink", IEEE 69TH VEHICULAR TECHNOLOGY CONFERENCE, 26 April 2009 (2009-04-26) - 29 April 2009 (2009-04-29), BARCELONA, SPAIN, pages 1 - 5, XP031474840, ISBN: 978-1-4244-2517-4</text><sources><source mxw-id="PNPL54403054" load-source="docdb" name="SEA" category="X"/></sources></nplcit><nplcit><text>BIN DONG ET AL: "A new class of soft mimo demodulation algorithms", IEEE TRANSACTIONS ON SIGNAL PROCESSING, vol. 51, no. 11, 1 November 2003 (2003-11-01), NY, US, pages 2752 - 2763, XP011102792, ISSN: 1053-587X, DOI: 10.1109/TSP.2003.818155</text><sources><source mxw-id="PNPL54403055" load-source="docdb" name="SEA" category="X"/></sources></nplcit><nplcit><text>JALDEN J ET AL: "Parallel Implementation of a Soft Output Sphere Decoder", THIRTY- NINTH ASILOMAR CONFERENCE ON SIGNALS, SYSTEMS AND COMPUTERS, 28 October 2005 (2005-10-28) - 1 November 2005 (2005-11-01), NJ, USA, pages 581 - 585, XP010900066, ISBN: 978-1-4244-0131-4, DOI: 10.1109/ACSSC.2005.1599816</text><sources><source mxw-id="PNPL54403056" load-source="docdb" name="SEA" category="X"/></sources></nplcit><nplcit><text>None</text><sources><source mxw-id="PNPL67455012" load-source="docdb" name="APP"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR918144556" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ST ERICSSON SA</last-name><address><country>CH</country></address></addressbook></applicant><applicant mxw-id="PPAR918134903" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>ST-ERICSSON SA</last-name></addressbook></applicant><applicant mxw-id="PPAR918994170" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>ST-Ericsson SA</last-name><iid>101296718</iid><address><street>39 Chemin du Champ-des-Filles</street><city>1228 Plan-les-Ouates</city><country>CH</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918148086" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>PAKER OEZGUEN</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR918142787" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>PAKER, OEZGUEN</last-name></addressbook></inventor><inventor mxw-id="PPAR918981908" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Paker, Özgün</last-name><address><street>Oppwettensemolen 56</street><city>5612 DH Eindhoven</city><country>NL</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918991847" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Gray, Peter John Bracey</last-name><iid>101294770</iid><address><street>Thompson Gray LLP 25 Southampton Buildings</street><city>London Greater London WC2A 1AL</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS548802701" load-source="docdb">AL</country><country mxw-id="DS548853181" load-source="docdb">AT</country><country mxw-id="DS548802707" load-source="docdb">BE</country><country mxw-id="DS548837180" load-source="docdb">BG</country><country mxw-id="DS548847827" load-source="docdb">CH</country><country mxw-id="DS548847605" load-source="docdb">CY</country><country mxw-id="DS548853186" load-source="docdb">CZ</country><country mxw-id="DS548802708" load-source="docdb">DE</country><country mxw-id="DS548847606" load-source="docdb">DK</country><country mxw-id="DS548847607" load-source="docdb">EE</country><country mxw-id="DS548852744" load-source="docdb">ES</country><country mxw-id="DS548837181" load-source="docdb">FI</country><country mxw-id="DS548847828" load-source="docdb">FR</country><country mxw-id="DS548802709" load-source="docdb">GB</country><country mxw-id="DS548847608" load-source="docdb">GR</country><country mxw-id="DS548802710" load-source="docdb">HR</country><country mxw-id="DS548853187" load-source="docdb">HU</country><country mxw-id="DS548801665" load-source="docdb">IE</country><country mxw-id="DS548847609" load-source="docdb">IS</country><country mxw-id="DS548847829" load-source="docdb">IT</country><country mxw-id="DS548847610" load-source="docdb">LI</country><country mxw-id="DS548837186" load-source="docdb">LT</country><country mxw-id="DS548867472" load-source="docdb">LU</country><country mxw-id="DS548837187" load-source="docdb">LV</country><country mxw-id="DS548837188" load-source="docdb">MC</country><country mxw-id="DS548867473" load-source="docdb">MK</country><country mxw-id="DS548867474" load-source="docdb">MT</country><country mxw-id="DS548867475" load-source="docdb">NL</country><country mxw-id="DS548853188" load-source="docdb">NO</country><country mxw-id="DS548867476" load-source="docdb">PL</country><country mxw-id="DS548847611" load-source="docdb">PT</country><country mxw-id="DS548852745" load-source="docdb">RO</country><country mxw-id="DS548847612" load-source="docdb">RS</country><country mxw-id="DS548867477" load-source="docdb">SE</country><country mxw-id="DS548802712" load-source="docdb">SI</country><country mxw-id="DS548853189" load-source="docdb">SK</country><country mxw-id="DS548853518" load-source="docdb">SM</country><country mxw-id="DS548801666" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128669838" lang="EN" load-source="patent-office"><p id="pa01" num="0001">A receiver (200) for receiving for receiving encoded data transmitted simultaneously as a plurality of M different sequences of transmitted symbols from different transmit antennas using a plurality of m modulation levels, where M and m are integers and each of the transmitted symbols represents a plurality of bits of the encoded data, comprises a demodulator (210) arranged to provide N received symbol combinations by receiving at a plurality of N receive antennas (202, 204), where N is an integer, the plurality of M different sequences of transmitted symbols, wherein each received symbol combination comprises M simultaneously received ones of the transmitted symbols. An equaliser (230) is arranged to generate from the N received symbol combinations M pre-processed signals by performing interference cancellation, in which interference cancellation a different symbol of the respective received symbol combination is a wanted signal and the other symbols of the respective received symbol combination are interfering signals. The equaliser (230) is also arranged to generate from each of the M pre-processed signals a list of up to m initial candidate symbol combinations by, for each of the up to m initial candidate symbol combinations, selecting a first initial symbol indicative of a different one of the m modulation levels and selecting M-1 further initial symbols. The equaliser (230) is further arranged to generate from the lists of initial candidate symbol combinations an initial estimate of the transmitted symbols. A decoder (260) is arranged to decode bits represented by the initial estimate of the transmitted symbols.
<img id="iaf01" file="imgaf001.tif" wi="118" he="80" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128499211" lang="EN" source="EPO" load-source="docdb"><p>A receiver (200) for receiving for receiving encoded data transmitted simultaneously as a plurality of M different sequences of transmitted symbols from different transmit antennas using a plurality of m modulation levels, where M and m are integers and each of the transmitted symbols represents a plurality of bits of the encoded data, comprises a demodulator (210) arranged to provide N received symbol combinations by receiving at a plurality of N receive antennas (202, 204), where N is an integer, the plurality of M different sequences of transmitted symbols, wherein each received symbol combination comprises M simultaneously received ones of the transmitted symbols. An equaliser (230) is arranged to generate from the N received symbol combinations M pre-processed signals by performing interference cancellation, in which interference cancellation a different symbol of the respective received symbol combination is a wanted signal and the other symbols of the respective received symbol combination are interfering signals. The equaliser (230) is also arranged to generate from each of the M pre-processed signals a list of up to m initial candidate symbol combinations by, for each of the up to m initial candidate symbol combinations, selecting a first initial symbol indicative of a different one of the m modulation levels and selecting M-1 further initial symbols. The equaliser (230) is further arranged to generate from the lists of initial candidate symbol combinations an initial estimate of the transmitted symbols. A decoder (260) is arranged to decode bits represented by the initial estimate of the transmitted symbols.</p></abstract><description mxw-id="PDES63955268" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001">Technical Field</heading><p id="p0001" num="0001">The present disclosure relates to a receiver and a method of operating a receiver for use in a Multiple Input Multiple Output (MIMO) communication system. The disclosure has application in, particularly but not exclusively, wireless communication systems operating in accordance with the Third Generation Partnership Project (3GPP) Long Term Evolution (LTE) protocol.</p><heading id="h0002">Background</heading><p id="p0002" num="0002">MIMO technology enables a high spectral efficiency to be obtained. This high spectral efficiency, measured in terms of bits per second per Hertz, has made MIMO technology attractive for many communication standards such as Long Term Evolution (LTE), LTE-Advanced, the Wireless Local Area Network (WLAN) standards Institution of Electrical and Electronic Engineers (IEEE) 802.11n, and WiMax, also known as IEEE 802.16e, for implementing the high data rate transmission in the range 100Mbit.s<sup>-1</sup> to 1Gbit.s<sup>-1</sup>. In a communication system employing MIMO technology, data to be transmitted is divided into a plurality of data streams, and different data streams are transmitted from different transmit antennas at the same time in the same frequency band. The plurality of data streams intentionally interfere with each other, and a receiver for receiving the plurality of data streams has to separate the data streams from each other. The data streams comprise symbols, where a symbol is a signal representative of an integer number of binary digits, that is, bits. Typically, each symbol is representative of a plurality of bits.</p><p id="p0003" num="0003">An element of such a MIMO receiver that affects reception performance is an equaliser. The equaliser detects the plurality of received data streams and mitigates the effects of inter-symbol interference between different symbols transmitted simultaneously on the different data streams. A channel decoder, such as a turbo decoder, can then be used to recover bits of the transmitted data from the equalised symbols.</p><p id="p0004" num="0004">In a MIMO system with M transmit and N receive antennas, the received signal y can be expressed as an N dimensional received signal vector, <maths id="math0001" num="(1)"><math display="block"><mi mathvariant="normal">y</mi><mo>=</mo><mi>Cs</mi><mo>+</mo><mi mathvariant="normal">n</mi></math><img id="ib0001" file="imgb0001.tif" wi="98" he="8" img-content="math" img-format="tif"/></maths><br/>
where s is an M-dimensional vector of symbols transmitted simultaneously from each of the M transmit antennas, C is a channel matrix with N rows and M columns, and n is an N-dimensional<!-- EPO <DP n="2"> --> additive complex Gaussian noise vector. For the case of two transmit antennas, s=[s1, s2], where s1 is a first transmitted signal transmitted from a first one of the transmit antennas, and s2 is a second transmitted signal transmitted from a second one of the transmit antennas. Also, for the case of two receive antennas, y=[y11, y21], where y11 is the signal received at a first one of the receive antennas, and y21 is the signal received at a second one of the receive antennas. The symbols of s are chosen independently from a complex signal constellation of, for example, Quadrature Phase Shift Key (QPSK) modulation, 16-Quadrature Amplitude Modulation (16-QAM), or 64-Quadrature Amplitude Modulation (64-QAM). The symbols may be represented by complex numbers, each mapped to a unique bit pattern. For example, for QPSK modulation, a signal constellation of four symbols may be represented by the set of complex numbers {-1-i, -1+i, 1-i, 1+i}.</p><p id="p0005" num="0005"><figref idrefs="f0001">Figure 1</figref> illustrates a block schematic diagram of an example MIMO receiver 100. Referring to <figref idrefs="f0001">Figure 1</figref>, the MIMO receiver 100 comprises a first receive antenna 102 and a second receive antenna 104, both of which are coupled to a demodulator 110 for demodulating signals received at the first and second receive antennas 102, 104. The signals received at the first and second receive antennas 102, 104 comprise the plurality of data streams transmitted simultaneously from different transmit antennas. The demodulated received signals are delivered to an input of a MIMO equaliser 130. A channel estimator 120 is coupled to the demodulator 110 and estimates, from the received signals, the characteristics of the communication channel between the transmit antennas and the receive antennas 102, 104. The channel estimator 120 delivers the estimated channel characteristics to the MIMO equaliser 130, and the MIMO equaliser 130 employs the estimated channel characteristics in detecting the symbols of the transmitted data streams. Each detected symbol comprises soft bits values, and the soft information may be provided as log-likelihood ratios (LLR). The detected symbols are descrambled by a de-scrambler 140 and de-interleaved in a de-interleaver 150, and the descrambled and de-interleaved symbols are decoded by a turbo decoder 160. The turbo decoder 160 delivers decoded bits at an output 162 of the MIMO receiver 100.</p><p id="p0006" num="0006">There is a requirement for improvements in receivers for use in MIMO systems.</p><heading id="h0003">Summary</heading><p id="p0007" num="0007">According to a first aspect there is provided a method of operating a receiver to receive encoded data transmitted simultaneously as a plurality of M different sequences of transmitted symbols from different transmit antennas using a plurality of m modulation<!-- EPO <DP n="3"> --> levels, where M and m are integers and each of the transmitted symbols represents a plurality of bits of the encoded data, the method comprising:
<ul><li>providing N received symbol combinations by receiving at a plurality of N receive antennas, where N is an integer, the plurality of M different sequences of transmitted symbols, wherein each received symbol combination comprises M simultaneously received ones of the transmitted symbols;</li><li>generating from the N received symbol combinations M pre-processed signals by performing interference cancellation, in which interference cancellation a different symbol of the respective received symbol combination is a wanted signal and the other symbols of the respective received symbol combination are interfering signals;</li><li>generating from each of the M pre-processed signals a list of up to m initial candidate symbol combinations by, for each of the up to m initial candidate symbol combinations, selecting a first initial symbol indicative of a different one of the m modulation levels and selecting M-1 further initial symbols;</li><li>generating from the lists of initial candidate symbol combinations an initial estimate of the transmitted symbols; and</li><li>decoding bits represented by the initial estimate of the transmitted symbols.</li></ul></p><p id="p0008" num="0008">According to a second aspect there is provided a receiver for receiving encoded data transmitted simultaneously as a plurality of M different sequences of transmitted symbols from different transmit antennas using a plurality of m modulation levels, where M and m are integers and each of the transmitted symbols represents a plurality of bits of the encoded data, the receiver comprising:
<ul><li>a demodulator arranged to provide N received symbol combinations by receiving at a plurality of N receive antennas, where N is an integer, the plurality of M different sequences of transmitted symbols, wherein each received symbol combination comprises M simultaneously received ones of the transmitted symbols;</li><li>an equaliser arranged to:
<ul><li>generate from the N received symbol combinations M pre-processed signals by performing interference cancellation, in which interference cancellation a different symbol of the respective received symbol combination is a wanted signal and the other symbols of the respective received symbol combination are interfering signals;</li><li>generate from each of the M pre-processed signals a list of up to m initial candidate symbol combinations by, for each of the up to m initial candidate symbol combinations, selecting a first initial symbol indicative of a different one of the m modulation levels and selecting M-1 further initial symbols; and<!-- EPO <DP n="4"> --></li><li>generate from the lists of initial candidate symbol combinations an initial estimate of the transmitted symbols; and</li></ul></li><li>a decoder arranged to decode bits represented by the initial estimate of the transmitted symbols.</li></ul></p><p id="p0009" num="0009">Performing interference cancellation with different ones of the M symbols of the respective received symbol combination as a wanted signal and the other M-1 symbols of the respective received symbol combination as interfering symbols can enable each of the M symbols of the received symbol combination to be estimated. Generating from each of the M pre-processed signals a list of up to m initial candidate symbol combinations with the first initial symbol indicative of a different one of the m modulation levels can enable processing to be reduced by enabling the initial estimate of the transmitted symbols to be generated from, at most, M times m initial candidate symbol combinations.</p><p id="p0010" num="0010">Generating the M pre-processed signals from the N received symbol combination may comprise performing interference cancellation by, for each of the pre-processed signals:
<ul><li>generating a channel matrix of channel transfer function elements indicative of a channel transfer function between each of the transmit antennas and each of the receive antennas, wherein the channel transfer function elements are positioned in the channel matrix dependent on which of the symbols of the respective received symbol combination is the wanted signal;</li><li>performing QR decomposition of the channel matrix into a matrix Q having dimension N by M and for which Q<sup>-1</sup>=Q<sup>H</sup>, where Q<sup>H</sup> denotes a Hermitian transpose of Q, and an upper triangular matrix R having dimension M by M; and</li><li>generating the respective pre-processed signal by multiplying a vector representative of the respective received symbol combination by Q<sup>H</sup>; and wherein the list of up to m initial candidate symbol combinations is generated, from each of the M pre-processed signals, dependent on the respective upper triangular matrix R.</li></ul></p><p id="p0011" num="0011">Likewise, the equaliser may be arranged to generate the M pre-processed signals from the N received symbol combination by performing interference cancellation by, for each of the pre-processed signals:
<ul><li>generating a channel matrix of channel transfer function elements indicative of a channel transfer function between each of the transmit antennas and each of the receive antennas, wherein the channel transfer function elements are positioned in the channel<!-- EPO <DP n="5"> --> matrix dependent on which of the symbols of the respective received symbol combination is the wanted signal;</li><li>performing QR decomposition of the channel matrix into a matrix Q having dimension N rows by M columns and for which Q<sup>-1</sup>=Q<sup>H</sup>, where Q<sup>H</sup> denotes a Hermitian transpose of Q, and an upper triangular matrix R having dimension M by M; and</li><li>generating the respective pre-processed signal by multiplying a vector representative of the respective received symbol combination by Q<sup>H</sup>; and wherein the list of up to m initial candidate symbol combinations is generated, from each of the M pre-processed signals, dependent on the respective upper triangular matrix R.</li></ul></p><p id="p0012" num="0012">Such manipulation of the channel matrix can enable the interference cancellation to be performed in a low complexity manner.</p><p id="p0013" num="0013">The method may comprise selecting the M-1 further initial symbols dependent on Euclidean distances of bits of each of the selected first and further initial symbols relative to the respective pre-processed signal from which the list of initial candidate symbol combinations is generated. Likewise, the equaliser may be arranged to select the M-1 further initial symbols dependent on Euclidean distances of bits of each of the selected first and further initial symbols relative to the respective pre-processed signal from which the list of initial candidate symbol combinations is generated. This feature can enable high reliability by enabling the quality of all bits represented by the symbols to be taken into account when selecting the further initial symbols of the initial candidate symbol combinations.</p><p id="p0014" num="0014">Selecting the M-1 further initial symbols may comprise minimising a sum of squares of the Euclidean distances of the bits of each of the selected first and further initial symbols relative to the respective pre-processed signal from which the list of initial candidate symbol combinations is generated. This feature can reduce complexity by avoiding square root operations.</p><p id="p0015" num="0015">Generating each of the M lists of up to m initial candidate symbol combinations may comprise including only initial candidate symbol combinations for which the minimised sum of squares of the Euclidean distances of the bits of each of the selected first and further initial symbols relative to the respective pre-processed signal from which the list of initial candidate symbol combinations is generated is less than a first threshold. Likewise, the equaliser may be arranged to generate each of the M lists of up to m initial candidate symbol combinations by including only initial candidate symbol combinations for which the minimised sum of squares of the Euclidean distances of the bits of each of the selected first and further initial symbols relative to the respective pre-processed signal<!-- EPO <DP n="6"> --> from which the list of initial candidate symbol combinations is generated is less than a first threshold. This feature can enable complexity to be reduced by excluding initial candidate symbol combinations having a relatively low reliability.</p><p id="p0016" num="0016">The initial candidate symbol combinations may comprise a soft value for each bit represented by each symbol of each initial candidate symbol combination, and generating the initial estimate of the transmitted symbols may comprise merging the initial candidate symbol combinations dependent on the soft values of the initial candidate symbol combinations. Likewise, the initial candidate symbol combinations may comprise a soft value for each bit represented by each symbol of each initial candidate symbol combination, and the equaliser may be arranged to generate the initial estimate of the transmitted symbols by merging the initial candidate symbol combinations dependent on the soft values of the initial candidate symbol combinations. This feature can enable improved reliability of the initial estimate of the transmitted symbols.</p><p id="p0017" num="0017">The soft value for each bit represented by each symbol of each initial candidate symbol combination may be indicative of a minimum Euclidean distance of the respective bit relative to the respective pre-processed signal from which the list of initial candidate symbol combinations is generated, and merging the initial candidate symbol combinations may comprise selecting, for each bit represented by each symbol of the initial estimate of the transmitted symbols, the bits of the M lists of initial candidate symbol combinations for which the soft value is indicative of the smallest Euclidean distance. Likewise, in the receiver, the soft value for each bit represented by each symbol of each initial candidate symbol combination may be indicative of a minimum Euclidean distance of the respective bit relative to the respective pre-processed signal from which the list of initial candidate symbol combinations is generated, and the equaliser may be arranged to merge the initial candidate symbol combinations by selecting, for each bit represented by each symbol of the initial estimate of the transmitted symbols, the bits of the M lists of initial candidate symbol combinations for which the soft value is indicative of the smallest Euclidean distance. This feature can enable further improved reliability of the initial estimate of the transmitted symbols.</p><p id="p0018" num="0018">Decoding bits represented by the initial estimate of the transmitted symbols may comprise generating soft information for each of the bits represented by the initial estimate of the transmitted symbols. Likewise, the decoder may be arranged to generate soft information for each of the bits represented by the initial estimate of the transmitted symbols. This feature can enable improved reliability.</p><p id="p0019" num="0019">The soft information representative of each of the bits represented by the initial estimate of the transmitted symbols may be dependent on a square of a Euclidean<!-- EPO <DP n="7"> --> distance of the respective bit, after decoding, from the respective pre-processed signal from which the respective initial symbol that represents the respective bit was selected. This feature can enable the soft information to have a high reliability.</p><p id="p0020" num="0020">The method may comprise:
<ul><li>generating from each of the M pre-processed signals a list of up to m secondary candidate symbol combinations by, for each of the secondary candidate symbol combinations, selecting a first secondary symbol indicative of a different one of the m modulation levels and selecting M-1 further secondary symbols dependent on the soft information;</li><li>generating from the M lists of secondary candidate symbol combinations a secondary estimate of the transmitted symbols; and</li><li>decoding bits represented by the secondary estimate of the transmitted symbols.</li></ul></p><p id="p0021" num="0021">Likewise, the equaliser may be arranged to:
<ul><li>generate from each of the M pre-processed signals a list of up to m secondary candidate symbol combinations by, for each of the secondary candidate symbol combinations, selecting a first secondary symbol indicative of a different one of the m modulation levels and selecting M-1 further secondary symbols dependent on the soft information; and</li><li>generate from the M lists of secondary candidate symbol combinations a secondary estimate of the transmitted symbols;</li><li>and the decoder may be arranged to decode bits represented by the secondary estimate of the transmitted symbols.</li></ul></p><p id="p0022" num="0022">This feature can enable improved reliability of the decoded bits by providing a further iteration of estimating the transmitted symbols, using the soft information resulting from the initial iteration, whilst enabling processing to be reduced by enabling the secondary estimate of the transmitted symbols to be generated from, at most, M times m secondary candidate symbol combinations.</p><p id="p0023" num="0023">Selecting the M-1 further secondary symbols may be dependent on Euclidean distances of bits of each of the selected first and further secondary symbols relative to the respective pre-processed signal from which the list of secondary candidate symbol combinations is generated. This feature can enable high reliability by enabling the quality of all bits represented by the symbols to be taken into account when selecting the further secondary symbols of the secondary candidate symbol combinations.</p><p id="p0024" num="0024">Selecting the M-1 further secondary symbols dependent on the soft information may comprise minimising a sum of: squares of Euclidean distances of bits of each of the selected first and further secondary symbols relative to the pre-processed signal from<!-- EPO <DP n="8"> --> which the list of secondary candidate symbol combinations is generated; and the soft information representative of each of the bits represented by the initial estimate of the transmitted symbols. This feature can enable high reliability by enabling the quality of all bits represented by the symbols, and the soft information resulting from the initial iteration, to be taken into account when selecting the further secondary symbols of the secondary candidate symbol combinations.</p><p id="p0025" num="0025">Generating each of the M lists of up to m secondary candidate symbol combinations may comprise including only secondary candidate symbol combinations for which the minimised sum of squares of Euclidean distances of bits of each of the selected first and further secondary symbols relative to the pre-processed signal from which the list of secondary candidate symbol combinations is generated and the soft information representative of each of the bits represented by the initial estimate of the transmitted symbols is less than a second threshold. Likewise, the equaliser may be arranged to generate each of the M lists of up to m secondary candidate symbol combinations by including only secondary candidate symbol combinations for which the minimised sum of squares of Euclidean distances of bits of each of the selected first and further secondary symbols relative to the pre-processed signal from which the list of secondary candidate symbol combinations is generated and the soft information representative of each of the bits represented by the initial estimate of the transmitted symbols is less than a second threshold. This feature can enable complexity to be reduced by excluding secondary candidate symbol combinations having a relatively low reliability.</p><p id="p0026" num="0026">The secondary candidate symbol combinations may comprise a soft value for each bit represented by each symbol of each secondary candidate symbol combination, and generating the secondary estimate of the transmitted symbols may comprise merging the secondary candidate symbol combinations dependent on the soft values of the secondary candidate symbol combinations. Likewise, the secondary candidate symbol combinations may comprise a soft value for each bit represented by each symbol of each secondary candidate symbol combination, and the equaliser may be arranged to generate the secondary estimate of the transmitted symbols by merging the secondary candidate symbol combinations dependent on the soft values of the secondary candidate symbol combinations. This feature can enable improved reliability of the secondary estimate of the transmitted symbols.</p><p id="p0027" num="0027">The soft value for each bit represented by each symbol of each secondary candidate symbol combination may be indicative of a minimum Euclidean distance of the respective bit relative to the respective pre-processed signal from which the list of secondary candidate symbol combinations is generated, and merging the secondary<!-- EPO <DP n="9"> --> candidate symbol combinations may comprise selecting, for each bit represented by each symbol of the secondary estimate of the transmitted symbols, the bits of the M lists of secondary candidate symbol combinations for which the soft value is indicative of the smallest Euclidean distance. Likewise, in the receiver, the soft value for each bit represented by each symbol of each secondary candidate symbol combination may be indicative of a minimum Euclidean distance of the respective bit relative to the respective pre-processed signal from which the list of secondary candidate symbol combinations is generated, and the equaliser may be arranged to merge the secondary candidate symbol combinations by selecting, for each bit represented by each symbol of the secondary estimate of the transmitted symbols, the bits of the M lists of secondary candidate symbol combinations for which the soft value is indicative of the smallest Euclidean distance. This feature can enable further improved reliability of the initial estimate of the transmitted symbols.</p><heading id="h0004">Brief Description of the Drawings</heading><p id="p0028" num="0028">Preferred embodiments will now be described, by way of example only, with reference to the accompanying drawings, in which:
<ul><li><figref idrefs="f0001">Figure 1</figref> illustrates a prior art receiver;</li><li><figref idrefs="f0002">Figure 2</figref> is a block schematic diagram of a receiver;</li><li><figref idrefs="f0003">Figure 3</figref> illustrates a signal constellation for QPSK;</li><li><figref idrefs="f0004">Figure 4</figref> is a flow chart of a method of processing a received signal;</li><li><figref idrefs="f0005">Figure 5</figref> is a diagrammatic representation of a search tree;</li><li><figref idrefs="f0006">Figure 6</figref> is a block schematic diagram of an equaliser; and</li><li><figref idrefs="f0007">Figure 7</figref> is a graph illustrating improvements in block error rate.</li></ul></p><heading id="h0005">Detailed Description</heading><p id="p0029" num="0029"><figref idrefs="f0002">Figure 2</figref> illustrates a block schematic diagram of a receiver 200 for use in a MIMO system, in which equalisation and channel decoding are done jointly. Such a combination of joint equalisation and channel decoding, and in particular turbo decoding, can be referred to as turbo equalisation. The receiver 200 is described below for the example case of receiving a first transmitted signal s1 transmitted from a first transmit antenna and a second transmitted signal s2 transmitted simultaneously from a second transmit antenna, corresponding to M=2. The first and second transmitted signals s1, s2 comprise, respectively, a first data stream and a second data stream, or more specifically, a first<!-- EPO <DP n="10"> --> stream of symbols and a second stream of symbols, and each symbol represents one or a plurality of bits. In a MIMO system communicating a plurality of data streams, the different data streams and different transmitted signals may be referred to as different spatial layers. Therefore, in the present example, the first data stream and first transmitted signal s1 may be referred to as a first spatial layer, and the second data stream and second transmitted signal s2 may be referred to as a second spatial layer.</p><p id="p0030" num="0030">Referring to <figref idrefs="f0002">Figure 2</figref>, a first receive antenna 202 is coupled to a first input 212 of a demodulator 210 and a second receive antenna 204 is coupled to a second input 214 of the demodulator 210. The first and second receive antennas 202, 204 both receive the transmitted vector of symbols s=[s1, s2], after transmission through a channel. A first output 216 and a second output 218 of the demodulator 210 both deliver the received signal y=[y11, y21], or more specifically the transpose of the vector y, that is Y=y<sup>T</sup>, demodulated from the transmitted vector, or combination, of symbols s received at the first and second receive antennas 202, 204, where the received signal y is defined by equation (1).</p><p id="p0031" num="0031">The first output 216 of the demodulator 210 is coupled to a first input 232 of an equaliser 230, which may also be referred to as a MIMO equaliser or MIMO detector, and the second output 218 of the demodulator 210 is coupled to a second input of the equaliser 230. A third output 215 of the demodulator 210 is coupled to an input of a channel estimator 220 which estimates the channel matrix C of equation (1), and delivers the channel matrix C at an output 226 of the channel estimator 220 which is coupled to a third input 235 of the equaliser 230. The channel matrix C may be estimated from the received combinations of the symbols of the first and second data stream, or from reference symbols, such as pilots symbols, transmitted from the first and second transmit antennas. The equaliser 230 performs equalisation of the received signal y based on the channel matrix C, and generates a first list of initial candidate symbol combinations, or vectors, corresponding to the first transmitted signal s1, and generates a second list of initial candidate symbol combinations, or vectors, corresponding to the second transmitted signal s2. Each initial candidate symbol combination of the first and second lists consists of a plurality of candidate symbols, with each candidate symbol corresponding to a symbol of one of the M data streams transmitted by the M transmit antennas, in this example M having a value of two. Furthermore, each candidate symbol represents a plurality of bits having soft values. Generation of the lists and soft values, which soft values may be indicative of a minimum Euclidean distance of the respective bit relative to the respective pre-processed signal from which the list of initial candidate symbol combinations is generated, and which in particular may be log-likelihood ratios, is described below in more<!-- EPO <DP n="11"> --> detail. The terms "distance" and "Euclidean distance" are alternatives, both referring to the Euclidean distance. Euclidean distance is a distance between two points where, herein, the points are in a signal space and one of the points represents a pre-processed signal and the other point represents a symbol, or the bits of a symbol. A symbol and the bits represented by the symbol are represented by a common point, such that the distance between a pre-processed signal and each of the bits of a symbol is the same as the distance between the pre-processed signal and the symbol.</p><p id="p0032" num="0032">The equaliser 230 merges, that is, combines, the first and second list of initial candidate symbol combinations, and delivers at a first output 236 of the equaliser 230 an initial estimate of the symbols of the first transmitted signal s1, and delivers at a second output 238 of the equaliser 230 an initial estimate of the symbols of the second transmitted signal s2.</p><p id="p0033" num="0033">The bits of the symbols of the first and second data streams are, prior to transmission from the M transmit antennas, interleaved and then scrambled. Therefore, in the receiver 200, continuing to refer to <figref idrefs="f0002">Figure 2</figref>, the first and second outputs 236, 238 of the equaliser 230 are coupled to respective first and second inputs 242, 244 of a descrambler and de-interleaver 240 where the bits of the initial estimates of successive symbols of the first and second transmitted signals s1, s2 are de-scrambled and de-interleaved. The bits of the initial estimate of the symbols of the first transmitted signal s1, after de-scrambling and de-interleaving, are delivered at a first output 246 of the descrambler and de-interleaver 240, and the bits of the initial estimate of the symbols of the second transmitted signal s2, after de-scrambling and de-interleaving, are delivered at a second output 248 of the de-scrambler and de-interleaver 240.</p><p id="p0034" num="0034">The first and second outputs 246, 248 of the de-scrambler and de-interleaver 240 are coupled to respective first and second inputs 262, 264 of a turbo decoder stage 260. The turbo decoder stage 260 provides a first decoding process for decoding the bits of the initial estimate of the symbols of the first transmitted signal s1, and a second decoding process for decoding the bits of the initial estimate of the symbols of the second transmitted signal s2, and delivers the decoded bits at a data output 265 of the turbo decoder stage 260. The turbo decoder stage 260 also generates soft information, that is, signal reliability information, for the decoded bits. The soft information may be dependent on a squared Euclidean distance of the respective bit, after decoding, from the respective pre-processed signal from which the respective initial symbol that represents the respective bit was selected, and in particular may be a log-likelihood ratio. The decoded bits of the initial estimate of the transmitted symbols of the first transmitted signal s1, including the corresponding first soft information denoted Apriori1, are delivered at a first<!-- EPO <DP n="12"> --> output 266 of the turbo decoder stage 260, and the decoded bits of the initial estimate of the symbols of the second transmitted signal s2, including the corresponding second soft information denoted Apriori2, are delivered at a second output 268 of the turbo decoder stage 260.</p><p id="p0035" num="0035">The first and second outputs 266, 268 of the turbo decoder stage 260 are coupled to respective first and second inputs 272, 274 of an interleaver and scrambler 270 which interleaves and scrambles the decoded bits of the initial estimate of the symbols of the first transmitted signal s1, and interleaves and scrambles the decoded bits of the initial estimate of the symbols of the second transmitted signal s2. The resulting interleaved and scrambled bits, including the corresponding first soft information Apriori1, corresponding to the first spatial layer are delivered at a first output 275 of the interleaver and scrambler 270 that is coupled to a fourth input 237 of the equaliser 230, and the resulting interleaved and scrambled bits, including the corresponding second soft information Apriori2, corresponding to the second spatial layer are delivered at a second output 276 of the interleaver and scrambler 270 that is coupled to a fifth input 277 of the equaliser 230. The equaliser 230 employs these interleaved and scrambled bits, with the corresponding first and second soft information Apriori1, Apriori2, as a priori soft information for updating the first and second lists of initial candidate symbol vectors, as described below, thereby generating first and second lists of secondary candidate symbol combinations. The symbols of the first and second lists of secondary candidate symbol combinations are merged, in the same manner as described in relation to the first and second lists of initial candidate symbol combinations, to provide a secondary estimate of the transmitted symbols of the first transmitted signal s1 and a secondary estimate of the symbols of the second transmitted signal s2, which are delivered at, respectively, the first and second outputs 236, 238 of the equaliser 230.</p><p id="p0036" num="0036">After de-scrambling and de-interleaving by the de-scrambler and de-interleaver 240, the turbo decoder stage 260 applies the first decoding process to decode the bits of the secondary estimate of the symbols of the first transmitted signal s1, and the second decoding process to decode the bits of the secondary estimate of the symbols of the second transmitted signal s2, and delivers the decoded bits at a data output 265 of the turbo decoder stage 260, including the soft information. Updating the first and second lists of candidate symbol combinations by employing the decoded bits with corresponding first and second soft information Apriori1, Apriori2, and decoding the updated first and second lists of candidate symbol combinations, after merging, de-scrambling and de-interleaving, may be iterated to progressively increase the reliability of the decoded bits, for example, reducing a block error rate of bits or symbols. For the generation of the first<!-- EPO <DP n="13"> --> and second lists of initial candidate symbol combinations, before the turbo decoder stage 260 has performed decoding, no soft information is available to the equaliser 230 from the turbo decoder stage 260, and so the equaliser 230 generates the first and second lists of initial candidate symbol combinations without using soft information, or with the first and second soft information Apriori1, Apriori2 set to zero.</p><p id="p0037" num="0037">Referring to <figref idrefs="f0006">Figure 6</figref>, the equaliser 230 comprises a first decomposition stage 610 having an input 609 coupled to the third input 235 of the equaliser 230 for receiving the channel matrix C. The first decomposition stage 610 performs QR decomposition of the channel matrix C for the first spatial layer, that is, the first transmitted signal s1, by decomposing the channel matrix C into a first Q matrix, Q1, and a first R matrix, R1, where C=Q1.R1, where Q1 is a matrix of dimension N by M having the property that Q1<sup>-1</sup> is equal to the Hermitian transpose of Q1, and where R1 is a matrix having dimension M by M that is upper triangular. The first decomposition stage 610 delivers at a first output 611 the Hermitian transpose of the first Q matrix, Q1<sup>H</sup>, and at a second output 612 the first R matrix, R1. A first multiplier 605 has a first input 603 coupled to the first input 232 of the equaliser 230 for receiving the received signal y, or more specifically the transpose of y, that is Y=y<sup>T</sup>, and a second input 604 coupled to the first output 611 of the first decomposition stage 610 which performs the rotation of the received signal y, delivering the product Q1<sup>H</sup>.y11 at an output 606. The product Q1<sup>H</sup>.y11 is referred to as a pre-processed signal, with the first decomposition stage 610 and the first multiplier 605 pre-processing the received signal y. This pre-processing, in effect, performs interference cancellation on the received signal y with the first transmitted signal s1 as a wanted signal and the second transmitted signal s2 as an interfering signal. More specifically, the pre-processing applies interference cancellation to each symbol combination of the received signal y, with the symbols of the first transmitted signal s1 as a wanted signal and the symbols of the second transmitted signal s2 as interfering signals. In this example, each of the candidate symbol combinations generated by the equaliser 230 has two symbols, as there are two transmitted signals s1 and s2, corresponding to two spatial layers. The two symbols of each of the candidate symbol combinations are referred to as a top symbol and a bottom symbol. A first top symbol enumeration stage 615 has a first input 613 coupled to the second output 612 of the first decomposition stage 610, and a second input 614 coupled to the output 606 of the first multiplier 605. The first top symbol enumeration stage 615 enumerates, that is, selects, the top symbol for each of the first initial candidate symbol combinations and first secondary candidate symbol combinations, and determines the soft values, for example in the form of LLRs, of the bits of these symbols. A first bottom symbol determination stage 620 has a first input 618 coupled to<!-- EPO <DP n="14"> --> an output 616 of the first top symbol enumeration stage 615, and a second input 619 coupled to the output 606 of the first multiplier 605. The first bottom symbol determination stage 620 selects the bottom symbol of each of the first initial candidate symbol combinations and first secondary candidate symbol combinations, and determines the soft values, for example in the form of LLRs, of the bits of these symbols. The first bottom symbol determination stage 620 has a third input 624 coupled to the fourth input 237 of the equaliser 230 for receiving the first soft information Apriori1 generated by the turbo decoder stage 260, which it uses in determining the symbols of the first secondary candidate symbol combinations and the LLRs of the bits of these symbols, as described below. A first list store 625 has a first input 623 coupled to an output 621 of the first bottom symbol determination stage 620, and stores the list of first initial candidates symbol combinations, and subsequently the list of first secondary candidate symbol combinations, produced by the first top symbol enumeration stage 615 and the first bottom symbol determination stage 620, and the LLRs of the bits of these symbol combinations.</p><p id="p0038" num="0038">A column swapping stage 640 has an input 639 coupled to the third input 235 of the equaliser 230 for receiving the channel matrix C, and swaps the columns of the channel matrix C for selecting the second spatial layer, that is, the second transmitted signal s2, as the wanted signal for interference cancellation. Initially, the columns of the channel matrix may be arranged, for example, in order of increasing or decreasing signal to noise ratio (SNR) of the signals received at the respective receive antennas 202, 204. A second decomposition stage 650 has an input 649 coupled to an output 641 of the column swapping stage 640 and performs QR decomposition of the channel matrix C for the second spatial layer, that is, the second transmitted signal s2, by decomposing the channel matrix C into a second Q matrix, Q2, and a second R matrix, R2, where C=Q2.R2, where Q2 is a matrix of dimension N by M having the property that Q2<sup>-1</sup> is equal to the Hermitian transpose of Q2, and where R2 is a matrix having dimension M by M that is upper triangular. The second decomposition stage 650 delivers at a first output 651 the Hermitian transpose of the second Q matrix, Q2<sup>H</sup>, and at a second output 652 the second R matrix, R2. A second multiplier 645 has a first input 643 coupled to the second input 234 of the equaliser 230 for receiving the received signal y, or more specifically the transpose of y, Y=y<sup>T</sup>, and a second input 644 coupled to the first output 651 of the second decomposition stage 650 which performs the rotation of the received signal y, delivering the product Q2<sup>H</sup>.y21 at an output 646. A second top symbol enumeration stage 655 has a first input 653 coupled to the second output 652 of the second decomposition stage 650, and a second input 654 coupled to the output 646 of the second multiplier 645. The<!-- EPO <DP n="15"> --> second top symbol enumeration stage 655 enumerates, that is, selects, the top symbol of each of the second initial candidate symbol combinations and second secondary candidate symbol combinations, and determines the soft values, for example in the form of LLRs, of the bits of these symbols. A second bottom symbol determination stage 660 has a first input 658 coupled to an output 656 of the second top layer enumeration stage 655, and a second input 659 coupled to the output 646 of the second multiplier 645. The second bottom symbol determination stage 660 selects the bottom symbols of each of the second initial candidate symbol combinations and second secondary candidate symbol combinations, and determines the soft values, for example in the form of LLRs, of the bits of these symbols. The second bottom symbol determination stage 660 has a third input 664 coupled to a fifth input 277 of the equaliser 230 for receiving the second soft information Apriori2 generated by the turbo decoder stage 260, which it uses in determining the symbols of the second secondary candidate symbol combinations and the LLRs of the bits of these symbols, as described below. A second list store 665 has a first input 663 coupled to an output 661 of the second bottom symbol determination stage 660, and stores the list of second initial candidates symbol combinations, and subsequently the list of second secondary candidate symbol combinations, produced by the second top symbol enumeration stage 655 and the second bottom symbol determination stage 660, and the LLRs of the bits of these symbol combinations.</p><p id="p0039" num="0039">A merger stage 680 has a first input 672 coupled to an output 626 of the first list store 625 and a second input 673 coupled to an output 666 of the second list store 665. The merger stage 680 merges the lists stored in the first and second list stores 625, 665, as described below, and delivers the initial estimate, and subsequently the secondary estimate, of the transmitted symbols of the first transmitted signal s1, corresponding to the first spatial layer, at a first output 674, and delivers the initial estimate, and subsequently the secondary estimate, of the transmitted symbols of the second transmitted signal s2, corresponding to the second spatial layer, at a second output 675. The first output 674 of the merger stage 680 is coupled to the first output 236 of the equaliser 230, and the second output 675 of the merger stage 680 is coupled to the second output 238 of the equaliser 230.</p><p id="p0040" num="0040">More generally, where there are M transmitted signals, the equaliser 230 has M signal paths supporting M spatial layers, comprising M-1 column swapping stages and M decomposition stages for performing interference cancellation with each of the M transmitted signals as the wanted signal, M top symbol enumeration stages, M bottom symbol enumeration stages and M list stores, arranged for generating and storing one list of candidate symbol combinations for each of the M transmitted signals. Correspondingly,<!-- EPO <DP n="16"> --> the merger stage 680 is arranged to merge the M lists stored in the list stores, and deliver estimates of the transmitted symbols for each of the M transmitted signals. Moreover, each candidate symbol combination comprises M symbols, and so for the generation of each of the candidate symbol combinations, in addition to the top symbol enumeration stage 615 or 655, M-1 further symbol determination stages are required, including the bottom symbol determination stage 620 or 660.</p><p id="p0041" num="0041">The following paragraphs provide more details of the operation of the equaliser 230.</p><p id="p0042" num="0042">For each of the lists of candidate symbol combinations generated by the equaliser 230, each of the candidate symbol combinations are generated by selecting, in the respective first or second top symbol enumeration stage 615, 654, the top symbol as a different one of the m symbols which represent m modulation levels, and, in the respective first or second bottom symbol determination stage 620, 660, a bottom symbol such that the Euclidean distance of the candidate symbol combination from the respective pre-processed received signal y is minimised. Therefore, each of the lists of candidate symbol combinations can nominally comprise m candidate symbol combinations. However, the equaliser 230 can employ sphere decoding when selecting the top and bottom symbols, and more generally any further symbols of each candidate symbol combination when M&gt;2, which can reduce the number of candidate symbol combinations below m. Moreover, the amount of processing required for the generation of the lists of candidate symbol combinations can be reduced by using tree pruning. In this case, the equaliser 230 generates the first and second lists of candidate symbols combinations, both initial and secondary, and any further iterations, by applying sphere decoding with tree pruning to the received signal y. The sphere decoding, tree pruning, generation of the soft values as LLRs, and the updating of the first and second lists of candidate symbols vectors by the equaliser 230 are described in the following paragraphs.</p><p id="p0043" num="0043">Sphere decoding limits the number of candidate symbol combinations to those that lie within an M-dimensional sphere of radius r around the received signal y, or more specifically the received signal y after the pre-processing for interference cancellation. This condition may be expressed in terms of a square of a Euclidean distance d(s) of a candidate symbol combination from the received signal y after the pre-processing, where <maths id="math0002" num="(2)"><math display="block"><msup><mi mathvariant="normal">d</mi><mn mathvariant="normal">2</mn></msup><mfenced><mi mathvariant="normal">s</mi></mfenced><mo>=</mo><msup><mrow><mo>‖</mo><mi mathvariant="normal">y</mi><mo>-</mo><mi>Cs</mi><mo>‖</mo></mrow><mn mathvariant="normal">2</mn></msup><mo>&lt;</mo><msup><mi mathvariant="normal">r</mi><mn mathvariant="normal">2</mn></msup></math><img id="ib0002" file="imgb0002.tif" wi="104" he="13" img-content="math" img-format="tif"/></maths><br/>
In order to determine those candidate symbol combinations that satisfy the condition of equation (2) without searching all possible candidate symbol combinations, that is m<sup>M</sup> candidate symbol combinations, where m is the number of modulation levels and<!-- EPO <DP n="17"> --> corresponds to the number of points in the complex signal constellation, tree pruning is used.</p><p id="p0044" num="0044">Rewriting equation (2) using QR decomposition leads to: <maths id="math0003" num="(3)"><math display="block"><msup><mi mathvariant="normal">d</mi><mn mathvariant="normal">2</mn></msup><mfenced><mi mathvariant="normal">s</mi></mfenced><mo>=</mo><mi mathvariant="normal">k</mi><mo>+</mo><msup><mrow><mo>‖</mo><mi mathvariant="normal">yʹ</mi><mo>-</mo><mi>Rs</mi><mo>‖</mo></mrow><mn mathvariant="normal">2</mn></msup><mo>&lt;</mo><msup><mi mathvariant="normal">r</mi><mn mathvariant="normal">2</mn></msup></math><img id="ib0003" file="imgb0003.tif" wi="115" he="10" img-content="math" img-format="tif"/></maths><br/>
where y'=Q<sup>H</sup>y, and k is a constant that is independent of the symbol and can be ignored in the metric computation of the squared distance. The squared distance d<sup>2</sup>(s)=T<sub>i</sub>(s<sup>i</sup>) can be computed recursively as: <maths id="math0004" num="(4)"><math display="block"><msub><mi mathvariant="normal">T</mi><mi mathvariant="normal">i</mi></msub><mfenced><msup><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi></msup></mfenced><mo>=</mo><msub><mi mathvariant="normal">T</mi><mrow><mi mathvariant="normal">i</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow></msub><mo>⁢</mo><mfenced><msup><mi mathvariant="normal">s</mi><mrow><mi mathvariant="normal">i</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow></msup></mfenced><mo>+</mo><msup><mfenced open="|" close="|" separators=""><msub><mi mathvariant="normal">b</mi><mrow><mi mathvariant="normal">i</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow></msub><mo>-</mo><msub><mi mathvariant="normal">R</mi><mi>ii</mi></msub><mo>⁢</mo><msub><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi></msub><mo>-</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi mathvariant="normal">j</mi><mo>=</mo><mi mathvariant="normal">i</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow><mi mathvariant="normal">M</mi></munderover></mstyle><msub><mi mathvariant="normal">R</mi><mi>ii</mi></msub><mo>⁢</mo><msub><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi></msub></mfenced><mn mathvariant="normal">2</mn></msup><mspace width="1em"/><mi>for i</mi><mo>=</mo><mn mathvariant="normal">1</mn><mo>,</mo><mn mathvariant="normal">2</mn><mo>,</mo><mo>…</mo><mi mathvariant="normal">M</mi></math><img id="ib0004" file="imgb0004.tif" wi="130" he="15" img-content="math" img-format="tif"/></maths><br/>
In equation (4), T<sub>M+1</sub>(s<sup>M+1</sup>)=0, s<sup>i</sup>=[s<sub>i</sub>, s<sub>i+1</sub>,...s<sub>M</sub>]<sup>T</sup>, and R<sub>ij</sub> denotes elements of the R matrix for row j and column i. All possible vectors <i>s<sup>i</sup></i> and the respective path metrics T<sub>i</sub>(s<sup>i</sup>) can be associated with nodes on the i<sup>th</sup> level of a tree, the root of which is at i=M+1. Since the second term of equation (4) is positive, whenever a path metric violates the sphere constraint given in (2), the path metrics of all the children will violate the constraint given in equation (2). Consequently the tree can be pruned above this node, or level. This approach effectively reduces the number of vector symbols, corresponding to leaves of the tree, to be checked. Equation (4) can be re-written as: <maths id="math0005" num="(5)"><math display="block"><msub><mi mathvariant="normal">T</mi><mi mathvariant="normal">i</mi></msub><mfenced><msup><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi></msup></mfenced><mo>=</mo><msub><mi mathvariant="normal">T</mi><mrow><mi mathvariant="normal">i</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow></msub><mo>⁢</mo><mfenced><msup><mi mathvariant="normal">s</mi><mrow><mi mathvariant="normal">i</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow></msup></mfenced><mo>+</mo><msup><mfenced open="|" close="|" separators=""><msub><mi mathvariant="normal">b</mi><mrow><mi mathvariant="normal">i</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow></msub><mo>-</mo><msub><mi mathvariant="normal">R</mi><mi>ii</mi></msub><mo>⁢</mo><msub><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi></msub></mfenced><mn mathvariant="normal">2</mn></msup></math><img id="ib0005" file="imgb0005.tif" wi="130" he="10" img-content="math" img-format="tif"/></maths><br/>
where <maths id="math0006" num=""><math display="inline"><msub><mi mathvariant="normal">b</mi><mrow><mi mathvariant="normal">i</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow></msub><mo>=</mo><mi mathvariant="normal">yʹ</mi><mo>-</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi mathvariant="normal">j</mi><mo>=</mo><mi mathvariant="normal">i</mi><mo>+</mo><mn mathvariant="normal">1</mn></mrow><mi mathvariant="normal">M</mi></munderover></mstyle><msub><mi mathvariant="normal">R</mi><mi>ij</mi></msub><mo>⁢</mo><msub><mi mathvariant="normal">s</mi><mi mathvariant="normal">j</mi></msub><mn mathvariant="normal">.</mn></math><img id="ib0006" file="imgb0006.tif" wi="33" he="12" img-content="math" img-format="tif" inline="yes"/></maths> The term T<sub>i</sub>(s<sup>i</sup>) can also be referred to as the square of the Partial Euclidean Distance (PED), and is a metric representative of the partial symbol vector s<sup>i</sup>=[s<sub>i</sub>, s<sub>i+1</sub>,...s<sub>M</sub>]<sup>T</sup>, that is, the path taken from the root of the tree to the i<sup>th</sup> level. Once the search is done, that is, the vector with the smallest radius has been found, the resulting path from the root to leaf is the closest to the received signal y. The symbol vector corresponding to this path is the most likely (ML) transmitted symbol vector. The total Euclidean distance computed from the root to the leaf for the path of the ML transmitted symbol vector corresponds to minimum distance for the corresponding bit pattern that makes up the ML symbol vector. In other words, no other bit pattern that has the same bit value in one or more positions of the ML symbol vector can be closer to the received signal y.</p><p id="p0045" num="0045">Computation of the soft values consist of computing the square of the minimum distance for each bit value 1 or 0 of each received symbol, and subtracting these squared distances and scaling with the signal-to-noise ratio. These soft values can be expressed as LLRs, dependent on minimum distances of the received symbols from the points of the complex signal constellation for each bit position and for each bit value. For example,<!-- EPO <DP n="18"> --> referring to <figref idrefs="f0003">Figure 3</figref>, a signal constellation [00, 01, 10, 11] is illustrated corresponding to QPSK. The point x represents a received and equalised symbol. The constellation on the left shows the minimum distance do to the closest symbol, 00, that has a logic 0 for its first bit, and the minimum distance d<sub>1</sub> to the closest symbol, 10, that has a logic 1 for its first bit. Similarly, the constellation on the right shows the minimum distance do to the closest symbol, 00, that has a logic 0 for its second bit, and the minimum distance d<sub>1</sub> to the closest symbol, 01, that has a logic 1 for its second bit. The difference between the square of the minimum distances d<sub>0</sub> and d<sub>1</sub> is a measure on the likelihood of the bit value, that is, the LLR, which can be expressed as: <maths id="math0007" num="(6)"><math display="block"><mi>LLR</mi><mo>=</mo><mo>≈</mo><mfrac><mn mathvariant="normal">1</mn><msup><mi>σ</mi><mn mathvariant="normal">2</mn></msup></mfrac><mo>⁢</mo><mfenced separators=""><msubsup><mi mathvariant="normal">d</mi><mn mathvariant="normal">0</mn><mn mathvariant="normal">2</mn></msubsup><mo>-</mo><msubsup><mi mathvariant="normal">d</mi><mn mathvariant="normal">1</mn><mn mathvariant="normal">2</mn></msubsup></mfenced></math><img id="ib0007" file="imgb0007.tif" wi="105" he="14" img-content="math" img-format="tif"/></maths><br/>
where σ<sup>2</sup> is the noise power. For sphere decoding, the minimum distances for each bit position of each transmitted symbol are calculated for each bit value, based on equation (2), and the LLRs are calculated from the minimum distances using equation (6). The LLRs may be expressed in a more general form as follows: <maths id="math0008" num="(7)"><math display="block"><mi>LLR</mi><mfenced><msub><mi mathvariant="normal">b</mi><mrow><mi mathvariant="normal">i</mi><mo>,</mo><mi mathvariant="normal">q</mi></mrow></msub></mfenced><mo>=</mo><mfrac><mn mathvariant="normal">1</mn><msup><mi>σ</mi><mn mathvariant="normal">2</mn></msup></mfrac><mo>⁢</mo><mfenced separators=""><msub><mi>min</mi><mrow><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">0</mn></msub><mfenced separators=""><mi mathvariant="normal">i</mi><mo>⁢</mo><mi mathvariant="normal">q</mi></mfenced></mrow></msub><mo>⁢</mo><msup><mrow><mo>‖</mo><mi mathvariant="normal">y</mi><mo>-</mo><mi>Cs</mi><mo>‖</mo></mrow><mn mathvariant="normal">2</mn></msup><mo>-</mo><msub><mi>min</mi><mrow><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">1</mn></msub><mfenced separators=""><mi mathvariant="normal">i</mi><mo>⁢</mo><mi mathvariant="normal">q</mi></mfenced></mrow></msub><mo>⁢</mo><msup><mrow><mo>‖</mo><mi mathvariant="normal">y</mi><mo>-</mo><mi>Cs</mi><mo>‖</mo></mrow><mn mathvariant="normal">2</mn></msup></mfenced></math><img id="ib0008" file="imgb0008.tif" wi="129" he="14" img-content="math" img-format="tif"/></maths><br/>
where V<sub>0</sub>(i,q), V<sub>1</sub>(i,q) are sets of all the symbol vectors with a bit value that is, respectively, 0 and 1 for transmit antenna i and bit position q within a particular symbol. Expressing the square of the minimum distance for a bit value 0 as <maths id="math0009" num=""><math display="inline"><msubsup><mi mathvariant="normal">d</mi><mn mathvariant="normal">0</mn><mn mathvariant="normal">2</mn></msubsup><mfenced separators=""><mi mathvariant="normal">i</mi><mo>⁢</mo><mi mathvariant="normal">q</mi></mfenced><mo>=</mo><msub><mi>min</mi><mrow><msub><mi mathvariant="normal">V</mi><mn mathvariant="normal">0</mn></msub><mfenced separators=""><mi mathvariant="normal">i</mi><mo>⁢</mo><mi mathvariant="normal">q</mi></mfenced></mrow></msub><mo>⁢</mo><msup><mrow><mo>‖</mo><mi mathvariant="normal">y</mi><mo>-</mo><mi>Cs</mi><mo>‖</mo></mrow><mn mathvariant="normal">2</mn></msup><mo>,</mo></math><img id="ib0009" file="imgb0009.tif" wi="46" he="10" img-content="math" img-format="tif" inline="yes"/></maths> and the square of the minimum distance for bit value 1 as <maths id="math0010" num=""><math display="inline"><msubsup><mi mathvariant="normal">d</mi><mn>1</mn><mn mathvariant="normal">2</mn></msubsup><mfenced separators=""><mi mathvariant="normal">i</mi><mo>⁢</mo><mi mathvariant="normal">q</mi></mfenced><mo>=</mo><msub><mi>min</mi><mrow><msub><mi mathvariant="normal">V</mi><mn>1</mn></msub><mfenced separators=""><mi mathvariant="normal">i</mi><mo>⁢</mo><mi mathvariant="normal">q</mi></mfenced></mrow></msub><mo>⁢</mo><msup><mrow><mo>‖</mo><mi mathvariant="normal">y</mi><mo>-</mo><mi>Cs</mi><mo>‖</mo></mrow><mn mathvariant="normal">2</mn></msup><mo>,</mo></math><img id="ib0010" file="imgb0010.tif" wi="45" he="9" img-content="math" img-format="tif" inline="yes"/></maths> equation (7) can be rewritten as: <maths id="math0011" num=""><math display="block"><mi>LLR</mi><mfenced><msub><mi mathvariant="normal">b</mi><mrow><mi mathvariant="normal">i</mi><mo>,</mo><mi mathvariant="normal">q</mi></mrow></msub></mfenced><mo>=</mo><mfrac><mn mathvariant="normal">1</mn><msup><mi>σ</mi><mn mathvariant="normal">2</mn></msup></mfrac><mo>⁢</mo><mfenced separators=""><msubsup><mi mathvariant="normal">d</mi><mn mathvariant="normal">0</mn><mn mathvariant="normal">2</mn></msubsup><mfenced separators=""><mi mathvariant="normal">i</mi><mo>⁢</mo><mi mathvariant="normal">q</mi></mfenced><mo>-</mo><msubsup><mi mathvariant="normal">d</mi><mn mathvariant="normal">1</mn><mn mathvariant="normal">2</mn></msubsup><mfenced separators=""><mi mathvariant="normal">i</mi><mo>⁢</mo><mi mathvariant="normal">q</mi></mfenced></mfenced></math><img id="ib0011" file="imgb0011.tif" wi="62" he="14" img-content="math" img-format="tif"/></maths><br/>
In the receiver 200 described with reference to <figref idrefs="f0002">Figure 2</figref>, where a-priori soft information, that is, an a-priori LLR, is available from the turbo decoder stage 260 for each bit, for example from a previous iteration of turbo decoding as described above, or even from a previous transmission in a Hybrid-Automated-Repeat Request (HARQ) protocol, the computation of LLRs by the equaliser 230 also takes account of these values appropriately for each bit, calculating the square of the distance values for a transmitted signal s as: <maths id="math0012" num="(8)"><math display="block"><msup><mi mathvariant="normal">d</mi><mn mathvariant="normal">2</mn></msup><mfenced><mi mathvariant="normal">s</mi></mfenced><mo>=</mo><msup><mrow><mo>‖</mo><mi mathvariant="normal">y</mi><mo>-</mo><mi>Cs</mi><mo>‖</mo></mrow><mn mathvariant="normal">2</mn></msup><mo>-</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi mathvariant="normal">i</mi><mo>=</mo><mn mathvariant="normal">1</mn></mrow><mi mathvariant="normal">M</mi></munderover></mstyle><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi mathvariant="normal">q</mi><mo>=</mo><mn mathvariant="normal">1</mn></mrow><mi mathvariant="normal">M</mi></munderover></mstyle><mspace width="1em"/><mi>log</mi><mfenced separators=""><mi mathvariant="normal">p</mi><mfenced><msub><mi mathvariant="normal">s</mi><mrow><mi mathvariant="normal">i</mi><mo>,</mo><mi mathvariant="normal">q</mi></mrow></msub></mfenced></mfenced></math><img id="ib0012" file="imgb0012.tif" wi="135" he="14" img-content="math" img-format="tif"/></maths><br/>
where M denotes the number of transmit antennas, B denotes the number of bits per symbol, for example B=6 for 64-QAM or B=2 for QPSK, s<sub>i,q</sub> denotes the bit position q of a symbol transmitted from the i<sup>th</sup> transmit antenna, corresponding to the i<sup>th</sup> spatial layer, and<!-- EPO <DP n="19"> --> log(p(s<sub>i,q</sub>)) is a bit probability of s<sub>i,q</sub> in the log domain which can be computed from the apriori LLRs using the formula <maths id="math0013" num="(9)"><math display="block"><mi>log</mi><mfenced separators=""><mi mathvariant="normal">p</mi><mfenced><mi mathvariant="normal">x</mi></mfenced></mfenced><mo>=</mo><mo>-</mo><mi>log</mi><mo>⁢</mo><mfenced separators=""><mn mathvariant="normal">1</mn><mo>+</mo><msup><mi mathvariant="normal">e</mi><mrow><mo>±</mo><mi>LLR</mi><mfenced><mi mathvariant="normal">x</mi></mfenced></mrow></msup></mfenced></math><img id="ib0013" file="imgb0013.tif" wi="129" he="9" img-content="math" img-format="tif"/></maths><br/>
where LLR(x) denotes the log-likelihood of bit x, and the expression ±LLR(x) in the exponent has the negative sign if x refers to a bit value of 0, and the positive sign if x refers to a bit value of 1. In order to reduce processing, the summations in equation 8 may be approximated by using only the maximum element of the joint summation.</p><p id="p0046" num="0046">Therefore, the sphere decoding by the equaliser 230 does not merely use the channel matrix C and the received signal y to calculate LLRs but also takes account of the a-priori soft information that changes every iteration of the sphere decoding and turbo decoding. Consequently, the candidate symbol vectors computed in the first iteration of sphere decoding by considering only the channel matrix C and the received signal y may not, after the second iteration, lie inside the sphere after updating the distance values with the a-priori soft information for each bit as calculated using equation (8). A theoretical option is to maintain the LLRs for all the combinations of symbol combinations such that all possible bit combinations are stored. However, this option would be impractical to implement in an integrated circuit even for a simple MIMO system having two transmit antennas and two receive antennas. For example, for a 64-QAM modulation scheme, such as used in LTE, there would be the product 64 by 64 = 4096 candidate symbol combinations per subcarrier, and 1200 subcarriers must be processed in 0.71µs, which would entail computing equation (8) about 68 billion times. Computing the first part of equation (8), that is, excluding the second part corresponding to the a-priori soft information, would require four complex multiply-and-accumulate instructions (MAC) per second, leading to an excessive requirement of 275 Giga complex MAC.s<sup>-1</sup>. Leading edge vector digital signal processors (DSPs), such as the Embedded Vector Processor (EVP) manufactured by NXP Semiconductors, that can handle eight complex MACs per cycle would require a clock frequency of roughly 34GHz per turbo equaliser iteration. In this case, even a single turbo-equaliser iteration is not practical, let alone 2 or 3. Another option is to perform a smart search and maintain a smaller list of candidate symbol combinations, but still try to capture all possible bit values for each bit position. However, some of the candidate symbol combinations based on the a-priori soft information from the turbo decoder stage 260 will have an increased distance as calculated using equation (8), and with the list size being fixed during iterations, the soft information may not always be accurate as potentially other symbol combinations that are not included in the initial list could contribute to LLR calculation more precisely if the a-priori soft information from the turbo decoder stage 260 causes their distances to shrink such that they are eligible to<!-- EPO <DP n="20"> --> enter the list. Therefore, the equaliser 230 can employ a dynamic list for sphere decoding, where candidate symbol combinations, or in other words candidate symbol vectors, are re-assessed at each iteration, and some of them may be dropped out of the list, and some new candidates may be introduced to the list, depending on the distance contributions of the a-priori soft information of each bit. A replacement mechanism for the equaliser 230 to maintain the list of most likely candidate symbol combinations over iterations of such dynamic list based turbo-equaliser sphere decoding is described below. The replacement mechanism aims to ensure that each member of the list of candidate symbol combinations used for calculating the soft values, that is, the LLRs, that are delivered from the equaliser 230 to the turbo decoder stage 260 is the closest symbol combination around the received signal y for a particular bit position and bit value. The replacement mechanism employs the a-priori soft information that the turbo decoder stage 260 delivers to the equaliser 230.</p><p id="p0047" num="0047">In brief, after updating the distances of the candidate symbol combinations in the first or second, or further, list store 625, 665 with the a-priori soft information from the turbo decoder stage 260, by computing equation (8) in the first or second bottom, or further, symbol determination stages 620, 660, the K candidate symbol combinations, K&lt;m<sup>M</sup>, that have the largest distance are assessed by the equaliser 230 for replacement by up to K potential candidate symbol combinations that are not already in the respective list but which are closer to the received signal y than the K candidate symbol combinations. In one example, where there are two transmit antennas using QPSK modulation and the receiver 200 has two receive antennas, there are two spatial layers to be decoded, and K may have a value of two for each spatial layer. More generally, K may have a value equal to m/2, that is, half of the number of modulation levels, or half of the number of different available transmitted symbols. The potential candidate symbol combinations for each spatial layer are computed based on a-priori soft information for each spatial layer, provided to the equaliser 230 by the turbo decoder stage 260, and are compared to the candidate symbol combinations, in the current respective list, having the largest Euclidean distance, or squared Euclidean distance, from the receive signal y, and the candidate symbol combinations in the current respective list having a larger Euclidean distance, or squared Euclidean distance than the potential candidate symbol combinations are replaced by the potential candidate symbol combinations having a smaller distance.</p><p id="p0048" num="0048">The equaliser 230 maintains an independent search tree for each spatial layer, and a dynamic list of candidate symbol combinations for each of the search trees, in the respective first and second, or further, list store 625, 665. For the example of QPSK modulation and two spatial layers, the list of candidate symbol combinations can consist<!-- EPO <DP n="21"> --> of four candidate symbol combinations per spatial layer, so for two spatial layers, a total of eight candidate symbol combinations are employed. In addition, if two potential candidate symbol combinations per spatial layer are considered, that is, K=2, a total of twelve candidate and potential candidate symbol combinations are assessed.</p><p id="p0049" num="0049">As another example, in the case of 64-QAM modulation, the list of candidate symbol combinations can consist of 64 candidate symbol combinations per spatial layer, and 32 potential candidate symbol combinations can be considered per spatial layer, resulting in a total of 192 candidate and potential candidate symbol combinations for two spatial layers. If the list of candidate symbol combinations were to consist of all possible candidate symbol combinations, for the two spatial layers a total of 64<sup>2</sup>=4096 candidate symbol combinations would need to be stored and processed. Therefore, the dynamic list technique disclosed herein is about twenty times less complex for this example of 64-QAM and can feasibly be implemented in dedicated hardware.</p><p id="p0050" num="0050">Referring to <figref idrefs="f0004">Figure 4</figref>, there is illustrated a method of operating the receiver 200 which has two receive antennas 202, 204, that is, N=2 and which is used for receiving independent data streams transmitted from two transmit antennas, that is, M=2. The method commences at step 400 in which the demodulator 210 demodulates the first and second transmitted signals s1, s2 to provide the received signal y, represented by the received signal vector y=[y11, y21]. At step 402, the channel estimator 220 estimates the channel matrix C.</p><p id="p0051" num="0051">At step 404, the QR decomposition of the channel matrix C is performed for the first spatial layer, to provide the first Q matrix, Q1, and the first R matrix, R1, and for the second spatial layer, to provide the second Q matrix, Q2, and the second R matrix, R2, but in this case with the columns of the channel matrix C swapped.</p><p id="p0052" num="0052">At step 406, the received signal y is pre-processed for the first spatial layer by multiplying, or rotating, it by the Hermitian transpose of the first Q matrix Q1, that is, multiplying by Q1<sup>H</sup>. Likewise, also at step 406, the received signal y is pre-processed for the second spatial layer by multiplying, or rotating, it by the Hermitian transpose of the second Q matrix Q2, that is, multiplying by Q2<sup>H</sup>. The pre-processing therefore results in the pre-processed received signal y'=Q<sup>H</sup>y</p><p id="p0053" num="0053">At step 408, a first search tree is generated by, based on equation (3), computing the squared distance ∥Q1<sup>H</sup>.y-R1.s∥<sup>2</sup> and eliminating those symbol combinations exceeding the square of the radius r, that is, exceeding a threshold equal to r<sup>2</sup>. Computation of the squared distance can employ equation (5), with Q1 replacing Q and R1 replacing R. This results in a first search tree having a first, that is, top, level corresponding to the first spatial layer and a second level, in this example the bottom<!-- EPO <DP n="22"> --> level, corresponding to the second spatial layer. In this first search tree all m symbols at the top level are enumerated. There is no need for symbol ordering at the top level as all possible options for the top level are used. To generate the bottom level, only the symbol, in this example the QPSK symbol, that has the smallest square of the partial Euclidean distance (PED) as computed using equation (5), or equivalently the smallest PED, is included in the first search tree. This significantly reduces the search space. All the paths of the first search tree, from the root to the leaves of the first search tree, which in this example are symbol pairs, form the first list of initial candidate symbol combinations, and each initial candidate symbol combination has an associated bit pattern, made up from the bits of the symbols of the respective initial candidate symbol combination, and a Euclidean distance from the pre-processed signal y', from which the LLR of each bit of each symbol is calculated. Also at step 408, a second search tree is generated by, based on equation (3), computing the squared distance ∥Q2<sup>H</sup>.y-R2.s∥<sup>2</sup> and eliminating those transmitted symbol combinations exceeding the square of the radius r, that is, exceeding the threshold equal to r<sup>2</sup>. Although in this example the same threshold is applied at step 408 for generating the first and second search trees, this is not essential and different threshold may be applied. Computation of the squared distance can employ equation (5), with Q2 replacing Q and R2 replacing R. This results in a second search tree having a first, that is, top, level corresponding to, due to the swapping of columns of the channel matrix C, the second spatial layer and a second level, in this example the bottom level, corresponding to the first spatial layer. In this second search tree all m symbols at the top level are enumerated. Again, there is no need for symbol ordering as all possible options for the top level are used. To generate the bottom level, only the symbol, in this example the QPSK symbol, that has the smallest square of the partial Euclidean distance (PED) as computed using equation (5), or equivalently the smallest PED, is included in the second search tree. This significantly reduces the search space. All the paths of the second search tree, from the root to the leaves of the second search tree, which in this example are symbol pairs, form the second list of initial candidate symbol combinations, and each initial candidate symbol combination has an associated bit pattern, made up from the bits of the symbols of the respective initial candidate symbol combination, and a Euclidean distance from the pre-processed signal y' from which the LLR of each bit of each symbol is calculated. The first and second lists of initial candidate symbol combinations, including the soft values of their bits, in the form of LLRs, are stored in, respectively, the first list store 625 and the second list store 665.</p><p id="p0054" num="0054">An example of the first and second search tree is shown in <figref idrefs="f0005">Figure 5</figref>. The top level of the first search tree consists of the four possible QPSK symbols of the first spatial layer,<!-- EPO <DP n="23"> --> and the second, that is, bottom, level of the first search tree consists of the symbols of the second spatial layer that result in the top and bottom level symbol pair having the smallest PED from the pre-processed signal y'. The top level of the second search tree consists of the four possible QPSK symbols of the second spatial layer, and the second, that is, bottom, level of the second search tree consists of the symbols of the second spatial layer that result in the top and bottom level symbol pair having the smallest PED from the pre-processed signal y'.</p><p id="p0055" num="0055">At step 410, the initial estimate of the transmitted symbols is generated from the first and second lists of initial candidate symbol combinations by merging, in the merger stage 680, the first and second lists of initial candidate symbol combinations dependent on the soft values of the bits represented by the symbols of the first and second lists of initial candidate symbol combinations. In particular, the merging comprises selecting, for each bit represented by each symbol of the initial estimate of the transmitted symbols, the bits of the first and second lists of initial candidate symbol combinations for which the soft values are indicative of a smallest minimum distance. More generally, where there are M transmitted signals, there are M lists of the initial candidate symbol combinations, and the initial estimate of the transmitted symbols is generated by merging these M lists.</p><p id="p0056" num="0056">At step 420, the bits of the initial estimate of the transmitted symbols are descrambled and then de-interleaved, by the de-scrambler and de-interleaver 240.</p><p id="p0057" num="0057">At step 422, after the descrambling and de-interleaving, the turbo decoder stage 260 decodes the bits represented by the initial estimate of the transmitted symbols to provide initial decoded bits, thereby generating the soft information for the bits represented by the first transmitted signal s1, which is referred to as first a-priori soft information, Apriori1, and the soft information for the bits represented by the second transmitted signal s2, which is referred to as second a-priori soft information, Apriori2.</p><p id="p0058" num="0058">At step 426, a test is performed to determine whether a further iteration of turbo equalisation is required, and if so, at step 428 the initial decoded bits are interleaved and then scrambled by the interleaver and scrambler 270.</p><p id="p0059" num="0059">At step 430 the equaliser 230, employs the first and second a-priori soft information Apriori1, Apriori2 to update the first and second lists of initial candidate symbol combinations to provide first and second lists of secondary candidate symbol combinations. The update may comprise replacing all of the initial candidate symbol combinations by newly calculated candidate symbol combinations. An alternative replacement criterion can be to replace only those initial candidate symbol combinations for which the distance values, calculated using equation 8, are smaller for the newly calculated candidate symbol combinations. A further replacement criterion may be, as<!-- EPO <DP n="24"> --> described above, to replace up K, where K an integer, initial candidate symbol combinations in each of the first and second lists having the greatest distance values, calculated using equation 8, by the newly calculated candidate symbol combinations which have a smaller distance.</p><p id="p0060" num="0060">Selection of symbols for the first and second secondary candidate symbol combinations can be based on the a-priori soft information Apriori1, Apriori2, by creating a bit pattern based on the sign of the a-priori soft information, and then mapping the bit pattern to a symbol value. For example, a positive value can be interpreted as a binary 0, and a negative value can be interpreted as a binary 1. In this case, if for example the apriori soft information is +1.5, -3.4, a symbol having bits 0,1 is added to the bottom level of the appropriate first or second search tree, resulting in a decoded symbol vector having this symbol at the bottom level being assessed according to the replacement criterion described above.</p><p id="p0061" num="0061">At step 432, the secondary estimate of the transmitted symbols is generated from the first and second lists of secondary candidate symbol combinations by merging, in the merger stage 680, the first and second lists of secondary candidate symbol combinations dependent on the soft values of the bits represented by the symbols of the first and second lists of secondary candidate symbol combinations, in a corresponding manner to the merging at step 410.</p><p id="p0062" num="0062">Flow then returns to step 420 for descrambling and de-interleaving by the descrambler and de-interleaver 240, and the secondary estimate of the transmitted symbols is delivered to the turbo decoder stage 260 via the descrambler and de-interleaver 240 for decoding at step 422.</p><p id="p0063" num="0063">If, at step 426, no further iterations of turbo equalisation are required, flow proceeds to step 440 where the decoded bits from the turbo decoder stage 260 is delivered. The loop comprising steps 428 to 432 followed by 420 to 426 may be repeated if desired, for example, generating first and second tertiary lists of candidate symbol combinations and a tertiary estimate of the transmitted symbols. <figref idrefs="f0007">Figure 7</figref>, illustrates, as a function of signal-to-noise ratio (SNR), and for a deterministic channel with high correlation, the successive reduction in block error rate (BLER) for an increasing number of iterations of the turbo equalisation. In <figref idrefs="f0007">Figure 7</figref>, graph (a) corresponds to the BLER without any feedback of a-priori soft information from the turbo decoder stage 260 to the equaliser 230, or with the a-priori soft information set to zero, and graphs (b), (c) and (d) shows the BLER for respectively, one, two and three iterations of steps 428 to 432 followed by 420 to 426. It can be seen from <figref idrefs="f0007">Figure 7</figref> that a single iteration of candidate replacement and subsequent turbo decoding of the amended lists of candidate symbol<!-- EPO <DP n="25"> --> vectors can provide a reduction in SNR of about 1 dB, whilst further iterations provide a smaller improvement. A criterion for terminating the iterations at step 426 can be, for example, a fixed number of iterations, the lack of any replacements being made at step 432, or the lack of a change in the first and second a-priori soft information greater than a threshold.</p><p id="p0064" num="0064">Although embodiments have been described which employ turbo decoding, other types of channel decoding that produces a soft output may alternatively be employed, such as a Viterbi decoder or a Low-Density Parity-Check decoder.</p><p id="p0065" num="0065">Although embodiments have been described for the case of two transmit antennas, more transmit antennas may be used, corresponding to more spatial layers, and therefore requiring more search trees and more levels in the search trees. In this case, the equaliser 230 can comprise additional signal paths, in particular, correspondingly more column swapping stages, more decomposition stages, more multipliers for rotation, more top symbol enumeration stages, more symbol determination stages for determining the the symbols at each level of the search tree, and more list stores. Similarly, although embodiments have been described for the case of two receive antennas, other numbers of receive antennas may be used.</p><p id="p0066" num="0066">Although embodiments have been described which employ sphere decoding to eliminate candidate symbol combinations having a distance, or squared distance, exceeding a threshold, it is not essential to employ sphere decoding, although omission of the sphere decoding can result in a greater number of candidate symbol combinations to be processed.</p><p id="p0067" num="0067">Although an approach to merging candidate symbol combinations to provide an estimate of the transmitted symbols has been described, alternative approaches to merging may be employed.</p><p id="p0068" num="0068">Although embodiments have been described in which the a-priori soft information is employed by the equaliser 230 for further processing, by candidate replacement in the first and second list stores 625, 665, of the same lists of candidate signal vectors, or combinations, from which the a-priori soft information is generated, in other embodiments, the a-priori soft information employed by the equaliser 230 for candidate replacement in the first and second list stores 625, 665, may be generated from a previous transmission of the same signal, for example, in an automatic repeat request (ARQ) protocol.</p><p id="p0069" num="0069">Other variations and modifications will be apparent to the skilled person. Such variations and modifications may involve equivalent and other features that are already known and which may be used instead of, or in addition to, features described herein. Features that are described in the context of separate embodiments may be provided in<!-- EPO <DP n="26"> --> combination in a single embodiment. Conversely, features that are described in the context of a single embodiment may also be provided separately or in any suitable subcombination.</p><p id="p0070" num="0070">It should be noted that the term "comprising" does not exclude other elements or steps, the term "a" or "an" does not exclude a plurality, a single feature may fulfil the functions of several features recited in the claims and reference signs in the claims shall not be construed as limiting the scope of the claims. It should also be noted that the Figures are not necessarily to scale; emphasis instead generally being placed upon illustrating the principles of the present invention.</p></description><claims mxw-id="PCLM56976182" lang="EN" load-source="patent-office"><!-- EPO <DP n="27"> --><claim id="c-en-0001" num="0001"><claim-text>A method of operating a receiver to receive encoded data transmitted simultaneously as a plurality of M different sequences of transmitted symbols from different transmit antennas using a plurality of m modulation levels, where M and m are integers and each of the transmitted symbols represents a plurality of bits of the encoded data, the method comprising:
<claim-text>providing N received symbol combinations by receiving at a plurality of N receive antennas (202, 204), where N is an integer, the plurality of M different sequences of transmitted symbols, wherein each received symbol combination comprises M simultaneously received ones of the transmitted symbols;</claim-text>
<claim-text>generating from the N received symbol combinations M pre-processed signals by performing interference cancellation, in which interference cancellation a different symbol of the respective received symbol combination is a wanted signal and the other symbols of the respective received symbol combination are interfering signals;</claim-text>
<claim-text>generating from each of the M pre-processed signals a list of up to m initial candidate symbol combinations by, for each of the up to m initial candidate symbol combinations, selecting a first initial symbol indicative of a different one of the m modulation levels and selecting M-1 further initial symbols;</claim-text>
<claim-text>generating from the lists of initial candidate symbol combinations an initial estimate of the transmitted symbols; and</claim-text>
<claim-text>decoding bits represented by the initial estimate of the transmitted symbols.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>A method as claimed in claim 1, wherein generating the M pre-processed signals from the N received symbol combination comprises performing interference cancellation by, for each of the pre-processed signals:
<claim-text>generating a channel matrix of channel transfer function elements indicative of a channel transfer function between each of the transmit antennas and each of the receive antennas (202, 204), wherein the channel transfer function elements are positioned in the channel matrix dependent on which of the symbols of the respective received symbol combination is the wanted signal;</claim-text>
<claim-text>performing QR decomposition of the channel matrix into a matrix Q having dimension N rows by M columns and for which Q<sup>-1</sup>=QH, where Q<sup>H</sup> denotes a Hermitian transpose of Q, and an upper triangular matrix R having dimension M by M; and</claim-text>
<claim-text>generating the respective pre-processed signal by multiplying a vector representative of the respective received symbol combination by Q<sup>H</sup>;</claim-text><!-- EPO <DP n="28"> -->
and wherein the list of up to m initial candidate symbol combinations is generated, from each of the M pre-processed signals, dependent on the respective upper triangular matrix R.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>A method as claimed in claim 1 or claim 2, comprising selecting the M-1 further initial symbols dependent on Euclidean distances of bits of each of the selected first and further initial symbols relative to the respective pre-processed signal from which the list of initial candidate symbol combinations is generated.</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>A method as claimed in claim 3, wherein selecting the M-1 further initial symbols comprises minimising a sum of squares of the Euclidean distances of the bits of each of the selected first and further initial symbols relative to the respective pre-processed signal from which the list of initial candidate symbol combinations is generated.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>A method as claimed in claim 4, wherein generating each of the M lists of up to m initial candidate symbol combinations comprises including only initial candidate symbol combinations for which the minimised sum of squares of the Euclidean distances of the bits of each of the selected first and further initial symbols relative to the respective pre-processed signal from which the list of initial candidate symbol combinations is generated is less than a first threshold.</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>A method as claimed in any preceding claim, wherein the initial candidate symbol combinations comprise a soft value for each bit represented by each symbol of each initial candidate symbol combination, and generating the initial estimate of the transmitted symbols comprises merging the initial candidate symbol combinations dependent on the soft values of the initial candidate symbol combinations.</claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>A method as claimed in claim 6, wherein the soft value for each bit represented by each symbol of each initial candidate symbol combination is indicative of a minimum Euclidean distance of the respective bit relative to the respective pre-processed signal from which the list of initial candidate symbol combinations is generated, and wherein the merging comprises selecting, for each bit represented by each symbol of the initial estimate of the transmitted symbols, the bits of the M lists of initial candidate symbol combinations for which the soft value is indicative of the smallest Euclidean distance.<!-- EPO <DP n="29"> --></claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>A method as claimed in any preceding claim, wherein decoding bits represented by the initial estimate of the transmitted symbols comprises generating soft information for each of the bits represented by the initial estimate of the transmitted symbols.</claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>A method as claimed in claim 8, wherein the soft information representative of each of the bits represented by the initial estimate of the transmitted symbols is dependent on a square of a Euclidean distance of the respective bit, after decoding, from the respective pre-processed signal from which the respective initial symbol that represents the respective bit was selected.</claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>A method as claimed in claim 8 or 9, comprising:
<claim-text>generating from each of the M pre-processed signals a list of up to m secondary candidate symbol combinations by, for each of the up to m secondary candidate symbol combinations, selecting a first secondary symbol indicative of a different one of the m modulation levels and selecting M-1 further secondary symbols dependent on the soft information;</claim-text>
<claim-text>generating from the M lists of secondary candidate symbol combinations a secondary estimate of the transmitted symbols; and</claim-text>
<claim-text>decoding bits represented by the secondary estimate of the transmitted symbols.</claim-text></claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>A method as claimed in claim 10, comprising selecting the M-1 further secondary symbols dependent on Euclidean distances of bits of each of the selected first and further secondary symbols relative to the respective pre-processed signal from which the list of secondary candidate symbol combinations is generated.</claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>A method as claimed in claim 10 or 11, wherein selecting the M-1 further secondary symbols dependent on the soft information comprises minimising the sum of:
<claim-text>squares of Euclidean distances of bits of each of the selected first and further secondary symbols relative to the pre-processed signal from which the list of secondary candidate symbol combinations is generated, and</claim-text>
<claim-text>the soft information representative of each of the bits represented by the initial estimate of the transmitted symbols.</claim-text></claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>A method as claimed in claim 12, wherein generating each of the M lists of up to m secondary candidate symbol combinations comprises including only secondary candidate symbol combinations for which the minimised sum of squares of Euclidean distances of<!-- EPO <DP n="30"> --> bits of each of the selected first and further secondary symbols relative to the pre-processed signal from which the list of secondary candidate symbol combinations is generated and the soft information representative of each of the bits represented by the initial estimate of the transmitted symbols is less than a second threshold.</claim-text></claim><claim id="c-en-0014" num="0014"><claim-text>A method as claimed in any one of claims 10 to 13, wherein the secondary candidate symbol combinations comprise a soft value for each bit represented by each symbol of each secondary candidate symbol combination, and generating the secondary estimate of the transmitted symbols comprises merging the secondary candidate symbol combinations dependent on the soft values of the secondary candidate symbol combinations.</claim-text></claim><claim id="c-en-0015" num="0015"><claim-text>A method as claimed in claim 14, wherein the soft value for each bit represented by each symbol of each secondary candidate symbol combination is indicative of a minimum Euclidean distance of the respective bit relative to the respective pre-processed signal from which the list of secondary candidate symbol combinations is generated, and wherein the merging comprises selecting, for each bit represented by each symbol of the secondary estimate of the transmitted symbols, the bits of the M lists of secondary candidate symbol combinations for which the soft value is indicative of the smallest Euclidean distance.</claim-text></claim><claim id="c-en-0016" num="0016"><claim-text>A receiver (200) for receiving encoded data transmitted simultaneously as a plurality of M different sequences of transmitted symbols from different transmit antennas using a plurality of m modulation levels, where M and m are integers and each of the transmitted symbols represents a plurality of bits of the encoded data, the receiver comprising:
<claim-text>a demodulator (210) arranged to provide N received symbol combinations by receiving at a plurality of N receive antennas (202, 204), where N is an integer, the plurality of M different sequences of transmitted symbols, wherein each received symbol combination comprises M simultaneously received ones of the transmitted symbols;</claim-text>
<claim-text>an equaliser (230) arranged to:
<claim-text>generate from each of the received symbol combinations M pre-processed signals by performing interference cancellation, in which interference cancellation a different symbol of the respective received symbol combination is a wanted signal and the other symbols of the respective received symbol combination are interfering signals;<!-- EPO <DP n="31"> --></claim-text>
<claim-text>generate from each of the M pre-processed signals a list of up to m initial candidate symbol combinations by, for each of the up to m initial candidate symbol combinations, selecting a first initial symbol indicative of a different one of the m modulation levels and selecting M-1 further initial symbols; and</claim-text>
<claim-text>generate from the lists of initial candidate symbol combinations an initial estimate of the transmitted symbols; and</claim-text></claim-text>
<claim-text>a decoder (260) arranged to decode bits represented by the initial estimate of the transmitted symbols.</claim-text></claim-text></claim></claims><drawings mxw-id="PDW16666966" load-source="patent-office"><!-- EPO <DP n="32"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="120" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="33"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="148" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="34"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="148" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="35"> --><figure id="f0004" num="4"><img id="if0004" file="imgf0004.tif" wi="165" he="232" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="36"> --><figure id="f0005" num="5"><img id="if0005" file="imgf0005.tif" wi="165" he="232" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="37"> --><figure id="f0006" num="6"><img id="if0006" file="imgf0006.tif" wi="157" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="38"> --><figure id="f0007" num="7"><img id="if0007" file="imgf0007.tif" wi="165" he="207" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="160" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="157" he="233" type="tif"/><doc-page id="srep0003" file="srep0003.tif" wi="158" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
