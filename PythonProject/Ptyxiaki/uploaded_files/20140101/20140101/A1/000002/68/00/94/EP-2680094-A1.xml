<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2680094-A1" country="EP" doc-number="2680094" kind="A1" date="20140101" family-id="46602152" file-reference-id="318287" date-produced="20180823" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146549977" ucid="EP-2680094-A1"><document-id><country>EP</country><doc-number>2680094</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-11824295-A" is-representative="NO"><document-id mxw-id="PAPP154823900" load-source="docdb" format="epo"><country>EP</country><doc-number>11824295</doc-number><kind>A</kind><date>20110131</date><lang>JA</lang></document-id><document-id mxw-id="PAPP172244683" load-source="docdb" format="original"><country>EP</country><doc-number>11824295.7</doc-number><date>20110131</date><lang>JA</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140453290" ucid="JP-2011000525-W" linkage-type="A" load-source="docdb"><document-id format="epo"><country>JP</country><doc-number>2011000525</doc-number><kind>W</kind><date>20110131</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL-2059334005" load-source="docdb">G06F   9/48        20060101AFI20150424BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-2059335578" load-source="docdb">G05B  15/02        20060101ALI20150424BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-2059336896" load-source="docdb">G05B   9/02        20060101ALI20150424BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-2059337428" load-source="docdb">G05B  19/042       20060101ALI20150424BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-2059337924" load-source="docdb">B25J   9/16        20060101ALI20150424BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-2059340307" load-source="docdb">G05B  19/05        20060101ALI20150424BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL-2059341203" load-source="docdb">B25J  19/06        20060101ALI20150424BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL2091569472" load-source="docdb" scheme="CPC">G05B2219/25347     20130101 LA20140625BHEP        </classification-cpc><classification-cpc mxw-id="PCL2091575177" load-source="docdb" scheme="CPC">G05B2219/25343     20130101 LA20140625BHEP        </classification-cpc><classification-cpc mxw-id="PCL2091575798" load-source="docdb" scheme="CPC">G05B  19/0426      20130101 LI20140626BHEP        </classification-cpc><classification-cpc mxw-id="PCL2091576215" load-source="docdb" scheme="CPC">G05B2219/24211     20130101 LA20140625BHEP        </classification-cpc><classification-cpc mxw-id="PCL2091578123" load-source="docdb" scheme="CPC">G05B  19/0428      20130101 LI20140626BHEP        </classification-cpc><classification-cpc mxw-id="PCL2093535987" load-source="docdb" scheme="CPC">G05B2219/34382     20130101 LA20140630BHEP        </classification-cpc><classification-cpc mxw-id="PCL2093536363" load-source="docdb" scheme="CPC">B25J   9/1656      20130101 LI20140630BHEP        </classification-cpc><classification-cpc mxw-id="PCL2093537926" load-source="docdb" scheme="CPC">B25J   9/1674      20130101 FI20140630BHEP        </classification-cpc><classification-cpc mxw-id="PCL2093540227" load-source="docdb" scheme="CPC">G05B2219/34383     20130101 LA20140630BHEP        </classification-cpc><classification-cpc mxw-id="PCL2093541741" load-source="docdb" scheme="CPC">G06F   9/4887      20130101 LI20140630BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132182415" lang="DE" load-source="patent-office">SICHERHEITSSTEUERUNGSVORRICHTUNG UND SICHERHEITSSTEUERUNGSVERFAHREN</invention-title><invention-title mxw-id="PT132182416" lang="EN" load-source="patent-office">SAFETY CONTROL DEVICE AND SAFETY CONTROL METHOD</invention-title><invention-title mxw-id="PT132182417" lang="FR" load-source="patent-office">DISPOSITIF DE COMMANDE DE SÉCURITÉ ET PROCÉDÉ DE COMMANDE DE SÉCURITÉ</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR918134781" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>TOYOTA MOTOR CO LTD</last-name><address><country>JP</country></address></addressbook></applicant><applicant mxw-id="PPAR918156722" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>TOYOTA JIDOSHA KABUSHIKI KAISHA</last-name></addressbook></applicant><applicant mxw-id="PPAR918985830" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Toyota Jidosha Kabushiki Kaisha</last-name><iid>101083898</iid><address><street>1 Toyota-cho,</street><city>Toyota-shi, Aichi 471-8571</city><country>JP</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918168267" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>TAIRA TETSUYA</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918157454" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>TAIRA, TETSUYA</last-name></addressbook></inventor><inventor mxw-id="PPAR918980111" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>TAIRA, TETSUYA</last-name><address><street>c/o Toyota Jidosha Kabushiki Kaisha 1 Toyota-cho</street><city>Toyota-shi Aichi 471-8571</city><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918155412" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>BITOH HIROSHI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918148947" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>BITOH, HIROSHI</last-name></addressbook></inventor><inventor mxw-id="PPAR918986260" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>BITOH, HIROSHI</last-name><address><street>c/o Toyota Jidosha Kabushiki Kaisha 1 Toyota-cho</street><city>Toyota-shi Aichi 471-8571</city><country>JP</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918991419" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Albutt, Anthony John</last-name><iid>101194770</iid><address><street>D Young &amp; Co LLP 120 Holborn</street><city>London EC1N 2DY</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="JP-2011000525-W"><document-id><country>JP</country><doc-number>2011000525</doc-number><kind>W</kind><date>20110131</date><lang>JA</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2012104897-A1"><document-id><country>WO</country><doc-number>2012104897</doc-number><kind>A1</kind><date>20120809</date><lang>JA</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS548819028" load-source="docdb">AL</country><country mxw-id="DS548852615" load-source="docdb">AT</country><country mxw-id="DS548819029" load-source="docdb">BE</country><country mxw-id="DS548904513" load-source="docdb">BG</country><country mxw-id="DS548808645" load-source="docdb">CH</country><country mxw-id="DS548899623" load-source="docdb">CY</country><country mxw-id="DS548852616" load-source="docdb">CZ</country><country mxw-id="DS548896962" load-source="docdb">DE</country><country mxw-id="DS548819030" load-source="docdb">DK</country><country mxw-id="DS548899624" load-source="docdb">EE</country><country mxw-id="DS548888969" load-source="docdb">ES</country><country mxw-id="DS548904518" load-source="docdb">FI</country><country mxw-id="DS548904519" load-source="docdb">FR</country><country mxw-id="DS548896963" load-source="docdb">GB</country><country mxw-id="DS548819031" load-source="docdb">GR</country><country mxw-id="DS548896964" load-source="docdb">HR</country><country mxw-id="DS548899625" load-source="docdb">HU</country><country mxw-id="DS548808646" load-source="docdb">IE</country><country mxw-id="DS548819032" load-source="docdb">IS</country><country mxw-id="DS548904520" load-source="docdb">IT</country><country mxw-id="DS548819033" load-source="docdb">LI</country><country mxw-id="DS548896965" load-source="docdb">LT</country><country mxw-id="DS548852617" load-source="docdb">LU</country><country mxw-id="DS548896970" load-source="docdb">LV</country><country mxw-id="DS548896971" load-source="docdb">MC</country><country mxw-id="DS548852618" load-source="docdb">MK</country><country mxw-id="DS548852619" load-source="docdb">MT</country><country mxw-id="DS548852620" load-source="docdb">NL</country><country mxw-id="DS548808647" load-source="docdb">NO</country><country mxw-id="DS548852621" load-source="docdb">PL</country><country mxw-id="DS548888970" load-source="docdb">PT</country><country mxw-id="DS548852622" load-source="docdb">RO</country><country mxw-id="DS548888971" load-source="docdb">RS</country><country mxw-id="DS548852623" load-source="docdb">SE</country><country mxw-id="DS548896972" load-source="docdb">SI</country><country mxw-id="DS548808648" load-source="docdb">SK</country><country mxw-id="DS548808649" load-source="docdb">SM</country><country mxw-id="DS548819034" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128670645" lang="EN" load-source="patent-office"><p id="pa01" num="0001">Time partitions which need not be executed can be skipped. An OS 100 partially includes a partition scheduler 21 which selects and decides a time partition to be subsequently scheduled in accordance with a scheduling pattern including TP1 in which an execution time is allocated to a safety monitoring program, TP2 in which the execution time is allocated to a normal control program, and TP 3 in which the execution time is allocated to a safety control program. A processor executes the OS 100 to cause the partition scheduler 21 to periodically operate. The partition scheduler 21 skips a TP including a program which need not be executed among TPs included in the scheduling pattern, in response to a notification of an execution result from a program executed in at least one of the time partitions TP1 to TP3.<img id="iaf01" file="imgaf001.tif" wi="78" he="106" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128500018" lang="EN" source="EPO" load-source="docdb"><p>Time partitions which need not be executed can be skipped. An OS 100 partially includes a partition scheduler 21 which selects and decides a time partition to be subsequently scheduled in accordance with a scheduling pattern including TP1 in which an execution time is allocated to a safety monitoring program, TP2 in which the execution time is allocated to a normal control program, and TP 3 in which the execution time is allocated to a safety control program. A processor executes the OS 100 to cause the partition scheduler 21 to periodically operate. The partition scheduler 21 skips a TP including a program which need not be executed among TPs included in the scheduling pattern, in response to a notification of an execution result from a program executed in at least one of the time partitions TP1 to TP3.</p></abstract><description mxw-id="PDES63956075" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><b>Technical Field</b></heading><p id="p0001" num="0001">The present invention relates to a safety controller mounted in a service robot, transportation equipment, and the like to ensure functional safety, and particularly to a safety controller using a computer system.</p><heading id="h0002"><b>Background Art</b></heading><p id="p0002" num="0002">Service robots are required to ensure functional safety by constantly monitoring a safety state using an external sensor and a self-diagnosis device and by executing appropriate safety control logic upon detecting some risk.</p><p id="p0003" num="0003">IEC 61508 has been established as an international standard for functional safety of the service robots described above as well as systems which operate on an electrical principle, such as transportation equipment. In IEC 61508, a system provided to ensure functional safety is called a safety-related system. IEC 61508 defines various techniques for constructing the safety-related system using hardware, such as a microprocessor and a PLC (Programmable Logic Controller), and a computer program (software). The use of techniques defined in IEC 61508 makes it possible to construct the safety-related system using a computer system.</p><p id="p0004" num="0004">Meanwhile, in recent years, the throughput of programmable electronic devices, such as a microprocessor, has been improved. Accordingly, various application programs are executed in parallel on a computer system by using a multitask OS (Operating System), thereby enabling integration of computer systems which are mounted in equipment, such as a service robot and a vehicle, for various purposes.<!-- EPO <DP n="2"> --></p><p id="p0005" num="0005">Patent Literature 1, for example, discloses a technique for causing an application program related to ensuring of functional safety (hereinafter, referred to as "safety-related application") to run on a computer system together with another application program (hereinafter, referred to as "non-safety-related application").</p><p id="p0006" num="0006">When the techniques defined in IEC 61508 are applied to the entire software including the safety-related application and the non-safety-related application, a need arises to apply the techniques also to the non-safety-related application. This causes a problem of an increase in software development cost.</p><p id="p0007" num="0007">Thus, in the technique disclosed in Patent Literature 1, safety-related applications (a safety monitoring program and a safety control program) are made independent from a non-safety-related application (a normal control program) by time partitioning of a system program. Accordingly, the normal control program can be excluded from the safety-related system, which contributes to a reduction in cost of the safety-related system constructed using a computer system.</p><heading id="h0003"><b>Citation List</b></heading><heading id="h0004"><b>Patent Literature</b></heading><p id="p0008" num="0008"><ul><li>[Patent Literature 1] Japanese Unexamined Patent Application Publication No. <patcit id="pcit0001" dnum="JP2010271759A"><text>2010-271759</text></patcit></li></ul></p><heading id="h0005"><b>Summary of Invention</b></heading><heading id="h0006"><b>Technical Problem</b></heading><p id="p0009" num="0009">However, a safety controller of a related art as illustrated in Patent Literature 1 has problems as described below.</p><p id="p0010" num="0010">A first problem will be first described in detail with reference to<!-- EPO <DP n="3"> --> <figref idrefs="f0009">Fig. 11A</figref>. Note that in <figref idrefs="f0009">Fig. 11A</figref>, TP1 represents a time partition for executing the safety monitoring program; TP2 represents a time partition for executing the normal control program; and TP3 is a time partition for executing the safety control program.</p><p id="p0011" num="0011">The system program according to the related art switches time partitions in accordance with a predetermined fixed scheduling pattern. For this reason, if an abnormality occurs when scheduling is performed in accordance with a scheduling pattern (fixed pattern) during normal control as shown in the upper part of <figref idrefs="f0009">Fig. 11A</figref>, for example, the scheduling pattern is switched to a scheduling pattern (fixed pattern) during safety control as shown in the lower part of <figref idrefs="f0009">Fig. 11A</figref>. After that, scheduling is performed in accordance with the scheduling pattern (fixed pattern) during safety control.</p><p id="p0012" num="0012">However, upon occurrence of an abnormality, an immediate response may be required depending on the type of the abnormality. To deal with such an abnormality, when scheduling is executed in accordance with the scheduling pattern during the safety control as shown in the lower part of <figref idrefs="f0009">Fig. 11A</figref>, for example, not only TP3, which is required to be immediately executed to deal with the abnormality, but also TP1, which need not be executed to deal with the occurring abnormality, is repeatedly executed. For this reason, also TP1 included as a fixed pattern has to be executed, despite the fact that TP3 needs to be executed immediately and continuously until safety is ensured.</p><p id="p0013" num="0013">Thus, there is a problem that only the time partition for executing the safety control program cannot be executed immediately and continuously upon occurrence of an abnormality, and the execution of the processing using the safety control program is delayed, with the result that the safety control may not be appropriately performed upon occurrence of an abnormality.</p><p id="p0014" num="0014"><!-- EPO <DP n="4"> --> Next, a second problem will be described in detail with reference to <figref idrefs="f0010">Figs. 12</figref> and <figref idrefs="f0011">13</figref>. Note that <figref idrefs="f0010">Fig. 12</figref> shows a specific example of the scheduling pattern during the normal control according to the related art. <figref idrefs="f0011">Fig. 13</figref> shows a specific example of a procedure related to the task initialization processing using the system program according to the related art.</p><p id="p0015" num="0015">In a system program including a time partitioning function, it is necessary to provide a time resource (time partition) for executing tasks in order to execute the tasks generated by the safety monitoring program and the like. In order to provide the time partition to execute the tasks, it is necessary to perform initialization processing prior to execution of normal task processing. Additionally, at least one time partition is required for the task initialization processing.</p><p id="p0016" num="0016">Assume herein that the system program according to the related art executes scheduling in accordance with a basic scheduling pattern as illustrated in <figref idrefs="f0010">Fig. 12</figref>. Here, an example is described in which all types of time partitions (in this case, TP1, TP2, and TP3) are included in one cycle as the basic scheduling pattern.</p><p id="p0017" num="0017"><figref idrefs="f0011">Fig. 13</figref> shows a specific example of a procedure related to the task initialization processing using the system program according to the related art. In <figref idrefs="f0011">Fig. 13</figref>, the partition scheduler causes tasks related to TPX (TP selected from TP1 to TP3) to operate (S111), and the initialization processing for the tasks related to TPX is sequentially executed until the initialization processing for the tasks related to all the time partitions is completed (S 112 to S 114). When the initialization processing for the tasks related to all the time partitions is completed, the partition scheduler operates the tasks related to TPX, and after that, execution of the normal task processing is started (S115).</p><p id="p0018" num="0018">Accordingly, when the system program according to the related<!-- EPO <DP n="5"> --> art executes the scheduling in accordance with the basic scheduling pattern (for example, <figref idrefs="f0010">Fig. 12</figref>) based on the procedure illustrated in <figref idrefs="f0011">Fig. 13</figref>, the initialization processing for the tasks related to all the time partitions (TP1, TP2, and TP3) is first executed in at least one time partition in a first cycle. After completion of the initialization processing for all the tasks, the normal task processing can be started in time partitions included in second and subsequent cycles.</p><p id="p0019" num="0019">If no abnormality occurs, however, the normal task processing for TP3 is not executed. Accordingly, no task is to be executed in TP3 included in the second and subsequent cycles. In other words, when the initialization processing for the tasks related to TP3 in the first cycle is completed, there is no task to be executed in TP3, which is included in the second and subsequent cycle, except for tasks to be executed upon occurrence of an abnormality. Therefore, under such circumstances that an abnormality hardly occurs after completion of the initialization processing for the tasks related to all TPs, unnecessary TP3 is actually scheduled.</p><p id="p0020" num="0020">It is preferable to secure a longer execution time for the tasks generated by the normal control program, as compared to that for the tasks generated by the safety monitoring program, for example. In the related art, unnecessary TP3 is scheduled even after completion of the initialization processing. This results in a problem that it is difficult to allocate a longer period of time to the execution time (TP2) for the tasks generated by the normal control program.</p><p id="p0021" num="0021">As a result of dedicated study about the related art disclosed in Patent Literature 1, the inventors of the present invention have found that the following problem occurs for the following reasons.</p><p id="p0022" num="0022">First, in an OS 100 disclosed in Patent Literature 1, a safety monitoring process 21 selects a scheduling pattern to define the order and timing for switching time partitions, and the OS 100 performs partition scheduling in accordance with the scheduling pattern (see<!-- EPO <DP n="6"> --> paragraphs 0036 and 0039, <figref idrefs="f0003">Fig. 4</figref>, etc. of Patent Literature 1). In short, a technique is disclosed in which the OS 100 switches time partitions in accordance with a fixed scheduling pattern specified by the safety monitoring process 21.</p><p id="p0023" num="0023">Accordingly, the partition switching in the OS 100 disclosed in Patent Literature 1 depends on the selection result obtained by the safety monitoring processing 21 in TP1. For this reason, TP1, which is originally scheduled in the scheduling pattern, cannot be skipped. Further, the OS 100 disclosed in Patent Literature 1 merely performs monitoring of the running status of the normal control process 22 and monitoring of input and output data to and from an I/O port 12 by the safety monitoring process 21 in TP1 (see paragraph 0036 etc. of Patent Literature 1). Accordingly, the OS 100 cannot select and decide any TP to be skipped in consideration of the running status of the safety control process 23 and of the safety monitoring process 21 itself.</p><p id="p0024" num="0024">Thus, in the OS 100 disclosed in Patent Literature 1, the partition scheduling function is not independent from processes generated in each time partition, and it is impossible for the partition scheduling function to grasp running statuses of all the processes. This causes a problem that time partitions which need not be executed cannot be skipped. As a result, the above-mentioned problems cannot be solved.</p><p id="p0025" num="0025">The present invention has been made based on the above findings, and has an object to provide a safety controller and a safety control method which are capable of skipping time partitions which need not be executed.</p><heading id="h0007"><b>Solution to Problem</b></heading><p id="p0026" num="0026">A safety controller according to an aspect of the present invention includes: a hardware resource including at least one<!-- EPO <DP n="7"> --> processor; (a) a safety monitoring program for motoring occurrence of an abnormality related to a control target; (b) a normal control program related to a control of the control target during normal time; and (c) a system program for controlling allocation of an execution time of the processor with respect to the safety control program related to the control of the control target upon occurrence of an abnormality. The system program partially includes a partition scheduler that selects and decides a time partition to be subsequently scheduled in accordance with a scheduling pattern including: (d) a first time partition in which the execution time is allocated to the safety monitoring program; (e) a second time partition in which the execution time is allocated to the normal control program; and (f) a third time partition in which the execution time is allocated to the safety control program. The processor executes the system program to cause the partition scheduler to operate periodically. The partition scheduler skips a time partition including a program which need not be executed among time partitions included in the scheduling pattern, in response to a notification of an execution result from a program executed in at least one of the first to third time partitions.</p><p id="p0027" num="0027">According to an aspect of the present invention described above, the partition scheduler can grasp statuses related to time partitions in an integrated fashion, thereby making it possible to skip time partitions which need not be executed.</p><p id="p0028" num="0028">Upon reception of the notification of the execution result indicating that an abnormality has been detected by the safety monitoring program executed in the first time partition, the partition scheduler may skip time partitions other than the third time partition in a subsequent scheduling. As a result, only the time partition for executing the safety control program can be executed immediately and continuously upon occurrence of an abnormality, so that a safety control can be appropriately performed upon occurrence of an abnormality.<!-- EPO <DP n="8"> --></p><p id="p0029" num="0029">Further, the partition scheduler may skip the third time partition in a subsequent scheduling upon execution and completion of program initialization processing in each of the first to third time partitions. As a result, a longer execution time can be allocated to the normal control program.</p><p id="p0030" num="0030">Furthermore, the safety controller further includes a reset circuit that resets the hardware resource. The partition scheduler may output a reset instruction signal to the reset circuit in response to a notification indicating an abnormality including an emergency stop from a program executed in at least one of the first to third time partitions, and the reset circuit may reset the hardware resource upon reception of the reset instruction signal.</p><p id="p0031" num="0031">Moreover, the safety controller further includes a reset circuit that resets the hardware resource. The partition scheduler may periodically transmit a signal to the reset circuit, and may suspend transmission of the signal to the reset circuit in response to a notification indicating an abnormality including an emergency stop from a program executed in at least one of the first to third time partitions. The reset circuit may reset the hardware resource when the transmission of the signal from the partition scheduler is interrupted.</p><heading id="h0008"><b>Advantageous Effects of Invention</b></heading><p id="p0032" num="0032">According to the present invention, it is possible to provide a safety controller and a safety control method which are capable of skipping time partitioning which need not be executed.</p><heading id="h0009"><b>Brief Description of Drawings</b></heading><p id="p0033" num="0033"><ul><li><figref idrefs="f0001">Fig. 1</figref> is a block diagram showing a configuration example of a safety controller according to a first embodiment of the invention;<!-- EPO <DP n="9"> --></li><li><figref idrefs="f0001">Fig. 2</figref> is a diagram for explaining the concept of time partitioning in the first embodiment of the invention;</li><li><figref idrefs="f0002">Fig. 3</figref> is a conceptual diagram for explaining the concept of resource partitioning in the first embodiment of the invention;</li><li><figref idrefs="f0003">Fig. 4</figref> is a diagram showing relationships between a partition scheduler and tasks which are activated in an execution environment provided by an OS shown in <figref idrefs="f0001">Fig. 1</figref>;</li><li><figref idrefs="f0004">Fig. 5A</figref> is a diagram showing a specific example of a scheduling pattern;</li><li><figref idrefs="f0004">Fig. 5B</figref> is a diagram showing a specific example of the scheduling pattern;</li><li><figref idrefs="f0005">Fig. 6</figref> is a flowchart showing a specific example of a procedure of the partition scheduler;</li><li><figref idrefs="f0006">Fig. 7</figref> is a flowchart showing a specific example of a reset procedure of a microcontroller;</li><li><figref idrefs="f0007">Fig. 8</figref> is a flowchart showing a specific example of the reset procedure of the microcontroller;</li><li><figref idrefs="f0008">Fig. 9</figref> is a flowchart showing a specific example of a procedure of a partition scheduler;</li><li><figref idrefs="f0009">Fig. 10</figref> is a flowchart showing a specific example of a procedure during initialization processing;</li><li><figref idrefs="f0009">Fig. 11A</figref> is a diagram for explaining a problem to be solved by the present invention;</li><li><figref idrefs="f0010">Fig. 11B</figref> is a diagram for explaining an advantageous effect of the present invention;</li><li><figref idrefs="f0010">Fig. 12</figref> is a diagram for explaining a problem to be solved by the present invention; and</li><li><figref idrefs="f0011">Fig. 13</figref> is a diagram for explaining a problem to be solved by the present invention.</li></ul></p><heading id="h0010"><b>Description of Embodiments</b></heading><p id="p0034" num="0034">Exemplary embodiments of the present invention will be described in detail below with reference to the drawings. Throughout<!-- EPO <DP n="10"> --> the drawings, the same components are denoted by the same reference numerals, and a repeated explanation thereof is omitted as needed for clarity of the explanation.</p><heading id="h0011">&lt;First Embodiment of the Invention&gt;</heading><p id="p0035" num="0035">A safety controller 1 according to this embodiment is mounted in a service robot, transportation equipment, or the like and executes safety control for ensuring functional safety. The safety controller 1 is configured to execute a safety-related application and a non-safety-related application in one computer system. <figref idrefs="f0001">Fig. 1</figref> is a block diagram showing a configuration example of the safety controller 1 according to this embodiment.</p><p id="p0036" num="0036">A processor 10 fetches programs (instruction stream), decodes instructions, and carries out arithmetic processing according to the result of instruction decoding. Though only one processor 10 is illustrated in <figref idrefs="f0001">Fig. 1</figref>, the safety controller 1 may have a multiprocessor configuration including a plurality of processors 10. The processor 10 may be a multicore processor. The processor 10 executes an operating system (OS) 100 as a system program to thereby provide a multiprogramming environment. The multiprogramming environment means an environment in which a plurality of programs are assumed to be executed in parallel by periodically switching a plurality of programs to be executed or by switching programs to be executed upon generation of an event.</p><p id="p0037" num="0037">Multiprogramming is sometimes called a multiprocess, multithread, multitask, or the like. Each of a process, a thread, and a task indicates a program unit to be executed in parallel in the multiprogramming environment. The multiprogramming environment included in the processor 10 according to this embodiment may be a multiprocess environment or a multithread environment.</p><p id="p0038" num="0038">An execution memory 11 is a memory used for the processor 10<!-- EPO <DP n="11"> --> to execute programs. The execution memory 11 stores programs (OS 100, applications 101 to 103, etc.), which are loaded from a nonvolatile memory 13, input and output data to and from the processor 10, and the like. Note that the processor 10 may directly execute these programs from the nonvolatile memory 13 without loading the programs from the nonvolatile memory 13 into the execution memory 11.</p><p id="p0039" num="0039">Specifically, the execution memory 11 may be a randomly accessible volatile memory such as an SRAM (Static Random Access Memory) or a DRAM (Dynamic Random Access Memory). The execution memory 11 of <figref idrefs="f0001">Fig. 1</figref> shows logical units. That is, the execution memory 11 may be implemented as a combination of a plurality of SRAM devices, a combination of a plurality of DRAM devices, or a combination of an SRAM device and a DRAM device, for example.</p><p id="p0040" num="0040">An I/O port 12 is used for data transmission and reception to and from external devices. When the safety controller 1 is mounted in a service robot, for example, the external devices are a visual sensor capable of measuring obstacles around the service robot, an actuator for causing the service robot to operate, and the like.</p><p id="p0041" num="0041">The nonvolatile memory 13 is a memory device capable of maintaining storage contents more stably than the execution memory 11 without being supplied with power. The nonvolatile memory 13 is, for example, a ROM (Read Only Memory), a flash memory, a hard disk drive, an optical disk drive, or a combination thereof. The nonvolatile memory 13 stores the OS 100 and the applications 101 to 103. Note that at least a part of the nonvolatile memory 13 may be configured to be removable from the safety controller 1. For example, the memory storing the applications 101 to 103 may be removably mounted. Alternatively, at least a part of the nonvolatile memory 13 may be disposed outside the safety controller 1.<!-- EPO <DP n="12"> --></p><p id="p0042" num="0042">The OS 100 is executed by the processor 10 so as to perform task management including task scheduling, interrupt management, time management, and resource management, and to provide a mechanism for inter-task synchronization and inter-task communication, for example, by using hardware resources such as the processor 10, the execution memory 11, and the nonvolatile memory 13.</p><p id="p0043" num="0043">In addition, the OS 100 has a function of protecting hardware resources temporally and spatially in order to increase the independence of the safety monitoring application 101 and the safety control application 103, which are related to ensuring of functional safety, from the normal control application 102. Here, the hardware resources include the processor 10, the execution memory 11, and the I/O port 12.</p><p id="p0044" num="0044">Out of these, temporal protection is performed by partitioning a temporal resource such as an execution time of the processor 10. Specifically, the temporal protection is performed by partitioning the execution time of the processor 10 and allocating a task (a process or a thread) to each partition (referred to as "time partition"). A scheduling function (partition scheduler 21) of the OS 100 provides a guarantee of use of resources, including the execution time of the processor 10, to the task allocated to each time partition (hereinafter, abbreviated as "TP" in some cases).</p><p id="p0045" num="0045"><figref idrefs="f0001">Fig. 2</figref> is a conceptual diagram relating to the time partitioning. <figref idrefs="f0001">Fig. 2</figref> shows an example in which a predetermined one-cycle time is divided into three time partitions of TP1, TP2, and TP3. Assuming that the one-cycle time is 100 ticks, the first 20 ticks are defined as TP1, the middle 30 ticks are defined as TP2, and the last 50 ticks are defined as TP3.</p><p id="p0046" num="0046">In the example shown in <figref idrefs="f0001">Fig. 2</figref>, a first application (APL1) to a<!-- EPO <DP n="13"> --> fourth application (APL4) are allocated to any of TP1 to TP3. The scheduling function (partition scheduler 21) of the OS 100 selects and decides one of TP1 to TP3 to be activated according to a lapse of time. Then, the application allocated to the active TP is executed by the processor 10.</p><p id="p0047" num="0047">Meanwhile, spatial protection is performed by partitioning stationary resources, including the execution memory 11 and the I/O port 12, and by allocating a task to each partition (referred to as "resource partition"). The scheduling function (partition scheduler 21) of the OS 100 inhibits the task from exceeding the resource partition preliminarily allocated (hereinafter, abbreviated as "RP" in some cases) and from accessing other resources.</p><p id="p0048" num="0048"><figref idrefs="f0002">Fig. 3</figref> is a conceptual diagram relating to the resource partitioning. The example of <figref idrefs="f0002">Fig. 3</figref> shows two RPs (RP1 and RP2). A part (A area) of each of the execution memory 11 and the nonvolatile memory 13 and a part (port A) of the I/O port 12 are allocated to RP 1. Further, another part (B area) of each of the execution memory 11 and the nonvolatile memory 13 and another part (port B) of the I/O port 12 are allocated to RP2. Access from RP1 to the resources allocated to RP2 is inhibited, and access from RP2 to the resources allocated to RP1 is inhibited.</p><p id="p0049" num="0049">Note that there is no need to exclusively allocate all the resources to any one of RPs. That is, the resources may be shared by a plurality of RPs. For example, in the case of performing safety control of a service robot, it is necessary for the actuator to be accessible from both the normal control application 101 and the safety control application 102. Accordingly, the I/O port for controlling the actuator may be shared by the RP to which the normal control application 101 belongs and the RP to which the safety control application 102 belongs.</p><p id="p0050" num="0050">Returning to <figref idrefs="f0001">Fig. 1</figref>, description will be continued. The<!-- EPO <DP n="14"> --> applications 101 to 103 are executed in the multiprogramming environment provided by the OS 100 and the processor 10. Among these applications, the safety monitoring application 101 includes instruction code for causing the processor 10 to execute monitoring of the running status of the normal control application 102, monitoring of the running status of the safety control application 103, and monitoring of the input and output data to and from the I/O port 12. The safety monitoring application 101 also includes instruction code for causing the processor 10 to execute notification of a result to the partition scheduler 21. That is, the safety monitoring application 101 is a safety-related application.</p><p id="p0051" num="0051">Further, the normal control application 102 includes instruction code for causing the processor 10 to execute a control procedure to cause a control target, such as a service robot, to execute a normal function/operation. The normal control application 102 also includes instruction code for causing the processor 10 to execute notification of the result to the partition scheduler 21. That is, the normal control application 102 is a non-safety-related application.</p><p id="p0052" num="0052">Furthermore, the safety control application 103 includes instruction code for causing the processor 10 to execute a control procedure prescribed to ensure functional safety in a case where some abnormality is detected. The safety control application 103 also includes instruction code for causing the processor 10 to execute notification of the result to the partition scheduler 21. That is, the safety control application 103 is a safety-related application.</p><p id="p0053" num="0053">A reset circuit 14 resets a microcontroller 15 based on a signal from the OS 100. The mechanism for resetting the microcontroller 15 using the reset circuit 14 will be described later.</p><p id="p0054" num="0054">Subsequently, relationships between the partition scheduler 21 and tasks generated upon activation of the applications 101 to 103 will<!-- EPO <DP n="15"> --> be described with reference to <figref idrefs="f0003">Fig. 4. Fig. 4</figref> is a diagram showing the relationships between the partition scheduler 21 and tasks 24, 26, and 28 which are activated in the multiprogramming environment provided by the OS 100.</p><p id="p0055" num="0055">The microcontroller 15 includes the processor 10, the execution memory 11, the I/O port 12, and the nonvolatile memory 13. While <figref idrefs="f0003">Fig. 4</figref> illustrates a configuration in which the reset circuit 14 is provided outside the microcontroller 15, a configuration in which the reset circuit 14 is included in the microcontroller 15 may also be employed.</p><p id="p0056" num="0056">The microcontroller 15 is supplied with a clock signal from an external clock source, and the processor 10 and the like operate in a predetermined timer period based on the clock signal. This embodiment is described assuming that the predetermined timer period is one tick. Accordingly, when the OS 100 is executed by the processor 10, the partition scheduler 21 operates every one tick. In the TPs, task schedulers 23, 25, and 27 and the tasks (the safety monitoring task 24, the normal control task 26, and the safety control task 28) operate every one tick.</p><p id="p0057" num="0057">The partition scheduler 21 operates every one tick and switches the TP (partition scheduling). The partition scheduler 21 selects and decides one of TP1 to TP3 to be activated in the next one tick. Further, the partition scheduler 21 starts operation of the task scheduler on the selected TP.</p><p id="p0058" num="0058">Specifically, the partition scheduling is performed by the partition scheduler 21 in such a manner that the partition scheduler 21 refers to a scheduling table 22 to perform the partition scheduling in accordance with a scheduling pattern defining a setting of each TP.</p><p id="p0059" num="0059">The scheduling table 22 retains scheduling patterns each defining a switching order and a timing of each TP. Note that the<!-- EPO <DP n="16"> --> scheduling table 22 holds at least two different scheduling patterns. One is a scheduling pattern applied when abnormality detection is not performed by the safety monitoring task 24 (i.e., during normal time). The other is a scheduling pattern applied when an abnormality is detected by the safety monitoring task 24. Hereinafter, the scheduling pattern applied during normal time is called a "normal control scheduling pattern", and the scheduling pattern applied upon detection of an abnormality is called a "safety control scheduling pattern".</p><p id="p0060" num="0060"><figref idrefs="f0004">Fig. 5A</figref> shows a specific example of the normal control scheduling pattern. In <figref idrefs="f0004">Fig. 5A</figref>, TP2 to which the normal control task 26 belongs is allocated to the first half (T1) of the one-cycle time. Further, TP1 to which the safety monitoring task 24 belongs is allocated to the latter half (T2) of the one-cycle time. According to the scheduling pattern shown in <figref idrefs="f0004">Fig. 5A</figref>, the normal control task 26 and the safety monitoring task 24 are repeatedly scheduled.</p><p id="p0061" num="0061"><figref idrefs="f0004">Fig. 5B</figref> shows a specific example of the safety control scheduling pattern. In <figref idrefs="f0004">Fig. 5B</figref>, TP3 to which the safety control task 28 belongs is allocated to the first half (T3) of the one-cycle time. Further, TP1 to which the safety monitoring task 24 belongs is allocated to the latter half (T4) of the one-cycle time. According to the scheduling pattern shown in <figref idrefs="f0004">Fig. 5B</figref>, the safety control task 28 and the safety monitoring task 24 are repeatedly scheduled.</p><p id="p0062" num="0062">Returning to <figref idrefs="f0003">Fig. 4</figref>, the description will be continued. The task schedulers 23, 25, and 27 schedule the tasks in the TPs to which the task schedulers respectively belong. Typical scheduling based on priorities may be applied to the scheduling of the tasks in the TPs. Note that <figref idrefs="f0003">Fig. 4</figref> illustrates that each TP includes only one task, but in practice, each TP includes one or more tasks. For example, TP2 for normal control may include two tasks: a normal control task A and a normal control task B.</p><p id="p0063" num="0063"><!-- EPO <DP n="17"> --> The safety monitoring task 24 is a task generated upon activation of the safety monitoring application 101. In the example shown in <figref idrefs="f0003">Fig. 4</figref>, the safety monitoring task 24 is allocated to TP1 and RP1. The safety monitoring task 24 monitors the running status of the normal control task 26, which is a non-safety-related application, monitors the running status of the safety control task 28, which is a safety-related application, and monitors the input and output data to and from the I/O port 12. Furthermore, the safety monitoring task 24 notifies the partition scheduler 21 of the running status of the task.</p><p id="p0064" num="0064">The normal control task 26 is a task generated upon activation of the normal control application 102. In the example shown in <figref idrefs="f0003">Fig. 4</figref>, the normal control task 26 is allocated to TP2 and RP2. The normal control task 26 performs a control for causing a control target, such as a service robot, to execute a normal function/operation. Furthermore, the normal control task 26 notifies the partition scheduler 21 of the running status of the task.</p><p id="p0065" num="0065">The safety control task 28 is a task generated upon activation of the safety control application 103. In the example shown in <figref idrefs="f0003">Fig. 4</figref>, the safety control task 28 is allocated to TP3 and RP3. The safety control task 28 performs a control prescribed to ensure functional safety in a case where some abnormality is detected. Furthermore, the safety control task 28 notifies the partition scheduler 21 of the running status of the task. Note that various techniques may be employed as a specific configuration for notifying the results from each task to the partition 21. For example, a task may invoke a system call (service call) of the OS 100, and results may be notified to the partition scheduler 21 through the OS 100. Alternatively, assuming that a flag related to the running status of a task is stored in the execution memory 11, the task may set the value of the flag according to the running status of the task, and the partition scheduler 21 may judge the running status of the task according to the set value of the flag.</p><p id="p0066" num="0066"><!-- EPO <DP n="18"> --> As described above, the partition scheduler 21 operates every one tick to select and decide one of TP1 to TP3 to be activated. Further, the partition scheduler 21 starts operation of the task scheduler on the selected TP. Then, when the task schedulers 23, 25, and 27 start operation, the task scheduling is carried out, and the processor 10 executes the tasks in the TP in the order of the tasks scheduled by the task schedulers 23, 25, and 27. Thus, the application allocated to the active TP is executed by the processor 10.</p><p id="p0067" num="0067">Subsequently, the partition scheduling performed by the partition scheduler 21 will be described with reference to <figref idrefs="f0005">Fig. 6. Fig. 6</figref> is a flowchart showing a specific example of the procedure of the partition scheduler 21. Referring to <figref idrefs="f0005">Fig. 6</figref>, a case is described by way of example in which the scheduling is executed in accordance with the normal control scheduling pattern (for example, <figref idrefs="f0004">Fig. 5A</figref>) or the safety control scheduling pattern (for example, <figref idrefs="f0004">Fig. 5B</figref>). In other words, a case is described by way of example in which when TP1 is a TP subsequent to TP2 or TP3 and when an abnormality of TP2 is detected in TP1, TP3 is a TP subsequently selected and decided upon reception of the result from TP1.</p><p id="p0068" num="0068">First, the partitioning scheduler 21, which operates every one tick, causes the task scheduler in TPX to operate (S11). Here, a variable X represents a TP number, and X is a value other than 1. Specifically, in S11, one of TP2 and TP3, excluding TP1 for safety monitoring, is caused to operate.</p><p id="p0069" num="0069">The task scheduler in TPX having started operation in S11 executes tasks in TPX according to priority (S 12). After a lapse of one tick, the partition scheduler 21 starts scheduling of TPs (S13). Specifically, the partition scheduler 21 selects and decides one of TPs to be activated in the next one tick in accordance with the scheduling pattern.</p><p id="p0070" num="0070"><!-- EPO <DP n="19"> --> When the TP to be subsequently activated is not changed (No in S 14), the partition scheduler 21 returns to S11 to continue operation on the same TPX. Accordingly, before the timing when TPX is switched, the processing of S11 to S 14 is repeated.</p><p id="p0071" num="0071">When the TP to be subsequently activated is changed (Yes in S14), the partition scheduler 21 causes the task scheduler in the time partition to be changed to operate (S15). Here, the task scheduler in TP1 is caused to operate. Then, the task scheduler 23 in TP1 executes the tasks in TP1 according to priority (S16).</p><p id="p0072" num="0072">The safety monitoring task 24 executed in TP1 monitors the running status of the normal control task 26 and monitors the input and output data to and from the I/O port 12, to thereby judge whether these are normal (S17). As a result of the judgment, when it is judged that they are abnormal (No in S 18), the safety monitoring task 24 notifies the partition scheduler 21 of the result (S19).</p><p id="p0073" num="0073">After a lapse of one tick, the partition scheduler 21 resumes scheduling (S20). The partition scheduler 21 selects and decides which TP is to be activated in the next one tick in accordance with the scheduling pattern. When the TP to be subsequently activated is not changed (No in S21), the flow returns to S15 to continue the operation on TP 1.</p><p id="p0074" num="0074">When the TP to be subsequently activated is changed (Yes in S21), the partition scheduler 21 further judges whether TPX has been normal according to the result notified from TP1 in S 19 (S22). As a result of the judgment, when it has been abnormal (No in S22), the partition scheduler 21 selects and decides TP3 as the TP to be activated in the next one tick (S23).</p><p id="p0075" num="0075">As a result of the judgment, when it has been normal (Yes in S22), the partition scheduler 21 selects and decides TPX other than<!-- EPO <DP n="20"> --> TP1 and TP3 as the TP to be activated in the next one tick (S24).</p><p id="p0076" num="0076">As for the processing shown in <figref idrefs="f0005">Fig. 6</figref>, a specific example of the partition scheduling will be described.<br/>
First, a case will be described in which scheduling is started in S11 in accordance with the normal control scheduling pattern illustrated in <figref idrefs="f0004">Fig. 5A</figref>. In this case, the scheduling is started in S11 assuming that TPX=TP2 holds, and TPX=TP2 is maintained during the processing of S12 to S14. Then, TPX is changed from TP2 to TP1 in S15, and TP1 remains unchanged during the processing of S15 to S21. When it is determined that the running status (data input and output) related to TP2 is normal in S18, TPX=TP2 holds in S24 (that is, the normal control scheduling pattern starting from TP2 is continued). Meanwhile, when it is determined that the running status (data input and output) related to TP2 is abnormal in S 18, TPX=TP3 holds in S23 (that is, the scheduling pattern is switched to the safety control scheduling pattern starting from TP3).</p><p id="p0077" num="0077">Further, a case will be described in which scheduling is started in S11 in accordance with the safety control scheduling pattern illustrated in <figref idrefs="f0004">Fig. 5B</figref>. In this case, the scheduling is started assuming that TPX=TP3 holds in S11, and TPX=TP3 is maintained during the processing of S12 to S14. Then, TPX is changed from TP3 to TP1 in S 15, and TP1 remains unchanged during the processing of S 15 to S21. When it is determined that the running status (data input and output) related to TP3 is normal in S 18, TPX=TP2 holds (that is, the scheduling pattern is switched to the normal control scheduling pattern starting from TP2) in S24. Meanwhile, when it is determined that the running status (data input and output) related to TP3 is abnormal in S18, TPX=TP3 holds (that is, the safety control scheduling pattern starting from TP3 is continued) in S23.</p><p id="p0078" num="0078">The above example illustrates the case where only the three TPs (TP1 for safety monitoring, TP2 for normal control, and TP3 for safety<!-- EPO <DP n="21"> --> control) are combined as the scheduling pattern, but a plurality of partitions TP2 for normal control and a plurality of partitions TP3 for safety control may be present. For example, scheduling patterns may be formed by a combination of five TPs (TP1 to TP5) including two TPs of TP2 and TP4 for normal control, TP1 for safety monitoring, and two TPs of TP3 and TP5 for safety control. In this case, in S23, the partition scheduler 21 may determine the type of the abnormality state of the running status (data input and output) related to TPX, and may select one of TP3 and TP5 for safety control according to the abnormality type. Further, in S24, one of TP2 and TP4 for normal control may be selected.</p><p id="p0079" num="0079">As described above, in this embodiment, the OS 100 includes the partition scheduler 21 for selecting and deciding a partition to be subsequently activated in response to the notification from TP1 for safety monitoring or the notification from each TP. The partition scheduler 21 operates in the predetermined timer period independently from the tasks executed in each TP. The partition scheduler 21 which operates independently in the predetermined timer period includes a partition scheduling function, which provides the following effects.</p><p id="p0080" num="0080">First, in general, there is a demand for shortening the execution time of the safety monitoring task 24 as much as possible in order to sufficiently ensure the execution time of the normal control task 26. In a related art (for example, Patent Literature 1), the safety monitoring task 24 performs not only monitoring of the running status of the normal control task 26 and monitoring of the input and output data to and from the I/O port 12, but also selection and decision of the scheduling pattern. Therefore, it is necessary to allocate the execution time required for the selection and decision to TP2 to which the safety monitoring task 24 belongs.</p><p id="p0081" num="0081">In order to guarantee the ensuring of functional safety, it is basically necessary to alternately execute the safety monitoring task 24<!-- EPO <DP n="22"> --> and the normal control task 26. For this reason, in the related art, the selection and decision of the scheduling pattern by the safety monitoring task 24 are also executed each time upon execution of the normal control task 26. After a plurality of cycles in total, a lot of execution time is required for the safety monitoring task 24 to select and decide the scheduling pattern.</p><p id="p0082" num="0082">On the other hand, according to this embodiment, it is not necessary for the safety monitoring task 24 itself to execute selection and decision of the scheduling pattern. Additionally, the execution time required for the partition scheduler 21 to select and decide the scheduling pattern is shortened. This provides an effect that a shorter period of time can be allocated to TP1 for safety monitoring and a longer period of time can be allocated to TP2 for normal control, as compared with the related art.</p><p id="p0083" num="0083">Furthermore, the processing illustrated in <figref idrefs="f0005">Fig. 6</figref> has been described assuming that the partition scheduler 21 selects and decides TP3 for safety control (S23), or selects and decides TP2 for normal control (S24), according to the result notified from TP1, but the present invention is not limited thereto. For example, a configuration in which the result of the running status is notified to the partition scheduler 21 from each of TP1 to TP3 may be employed in place of the configuration in which the result is notified to the partition scheduler 21 only from TP1 for safety monitoring, and the partition scheduler 21 may select and decide TP3 for safety control according to the result notified from each TP.</p><p id="p0084" num="0084">When the partition scheduler 21 which operates independently from each TP employs a configuration for receiving the results notified from all TPs, the partition scheduler 21 can grasp the statuses related to all TPs in an integrated manner. Accordingly, for example, the partition scheduler 21 can execute judgment as to skipping or the like of the TP which need not be executed, in consideration of the status of<!-- EPO <DP n="23"> --> each TP based on the result notified from each TP. This provides an effect that only the time partition which need not be executed can be intentionally skipped. Furthermore, for example, the partition scheduler 21 can decide and select the next partition only from TPs in the normal state in consideration of the status of each TP based on the result notified from TP1 for safety monitoring. Therefore, unlike the related art, the effect of achieving more accurate partition scheduling can be obtained.</p><p id="p0085" num="0085">Subsequently, the mechanism for resetting the microcontroller 15 using the reset circuit 14 will be described with reference to <figref idrefs="f0006">Figs. 7</figref> and <figref idrefs="f0007">8</figref>. <figref idrefs="f0006">Figs. 7</figref> and <figref idrefs="f0007">8</figref> are flowcharts each showing a specific example of the reset procedure of the microcontroller 15 using the reset circuit 14.</p><p id="p0086" num="0086">In this embodiment, the partition scheduler 21 which operates every one tick has a function of resetting the microcontroller 15. Upon detecting an abnormality in the OS 100, the partition scheduler 21 takes a measure for the abnormality in conjunction with the reset circuit 14. The reset circuit 14 resets the microcontroller 15 based on the signal from the partition scheduler 21.</p><p id="p0087" num="0087">Referring first to <figref idrefs="f0006">Fig. 7</figref>, a specific example of the reset procedure of the microcontroller 15 using the reset circuit 14 will be described. In the processing shown in <figref idrefs="f0006">Fig. 7</figref>, upon receiving a reset instruction signal from the partition scheduler 21, the reset circuit 14 resets the microcontroller 15. Note that in <figref idrefs="f0006">Fig. 7</figref>, TPX is a TP other than TP1 and TP3.</p><p id="p0088" num="0088">First, in S31 to S33, the partition scheduler 21 starts operation of TPX, thereby executing processing related to TPX until the TP to be subsequently activated is changed. After the partition scheduler 21 starts operation of the task scheduler 23 in TP1 (S34), the safety monitoring task 24 belonging to TP1 judges whether the processing (input and output) related to TPX has been normal (S35). As a result<!-- EPO <DP n="24"> --> of the judgment, when the processing has been normal (Yes in S35), the flow returns to S31 to continue the operation for the same TPX.</p><p id="p0089" num="0089">As a result of the judgment, when the processing has been abnormal (No in S35), the safety monitoring task 24 belonging to TP1 judges whether the abnormality in TPX is an abnormality that can be dealt with by the safety control task 28 belonging to TP3 (S36). When the abnormality is not an abnormality that can be dealt with in TP3 (No in S36), the safety monitoring task 24 belonging to TP1 notifies the partition scheduler 21 of an abnormality including an emergency stop (S37). The partition scheduler 21 having received the notification from the safety monitoring task 24 belonging to TP1 outputs a reset instruction signal to the reset circuit 14, and the reset circuit 14 having received the reset instruction signal resets the microcontroller 15 (S38).</p><p id="p0090" num="0090">When the abnormality is an abnormality that can be dealt with in TP3 (Yes in S36), the safety monitoring task 24 belonging to TP1 notifies the partition scheduler 21 of the abnormality in TPX (S39). The partition scheduler 21 having received the notification from TP1 switches the time partition from TPX to TP3 (S40).</p><p id="p0091" num="0091">Referring next to <figref idrefs="f0007">Fig. 8</figref>, another specific example of the reset procedure of the microcontroller 15 using the reset circuit 14 will be described. In the processing shown in <figref idrefs="f0007">Fig. 8</figref>, the partition scheduler 21 periodically transmits signals to the reset circuit 14. Further, when the transmission of signals from the partition scheduler 21 is interrupted, the reset circuit 14 resets the microcontroller 15. Note that in <figref idrefs="f0007">Fig. 8</figref>, TPX is a TP other than TP1 and TP3.</p><p id="p0092" num="0092">In comparison with the processing of S31 to S35 shown in <figref idrefs="f0006">Fig. 7</figref>, it is clarified in S53 of <figref idrefs="f0007">Fig. 8</figref> that the partition scheduler 21 operates every one tick, and there is a difference in that the partition scheduler 21 periodically transmits signals to the reset circuit 14 in S54 and S55.<!-- EPO <DP n="25"> --> The other processing of S51 to S57 shown in <figref idrefs="f0007">Fig. 8</figref> is basically the same as that of S31 to S35 shown in <figref idrefs="f0006">Fig. 7</figref>.</p><p id="p0093" num="0093">Further, in comparison with the processing of S36 to S40 shown in <figref idrefs="f0006">Fig. 7</figref>, there is a difference in that the partition scheduler 21 suspends transmission of signals to the reset circuit 14 in S60 of <figref idrefs="f0007">Fig. 8</figref>, and that the partition scheduler 21 transmits signals to the reset circuit 14 in S63. There is another difference in that, in S61 of <figref idrefs="f0007">Fig. 8</figref>, the reset circuit 14 resets the microcontroller 15 upon interruption of the transmission of signals from the partition scheduler 21. The other processing of S58 to S64 shown in <figref idrefs="f0007">Fig. 8</figref> is basically the same as that of S36 to S40 shown in <figref idrefs="f0006">Fig. 7</figref>.</p><p id="p0094" num="0094">Moreover, as shown in S71 and S72 of <figref idrefs="f0007">Fig. 8</figref>, when a malfunction occurs in the partition scheduler 21, or when a malfunction occurs in a signal line from the partition scheduler 21 to the reset circuit 14, in parallel with the processing of S51 to S64, the transmission of signals from the partition scheduler 21 to the reset circuit 14 is interrupted. Also in this case, the reset circuit 14 resets the microcontroller 15 upon interruption of the transmission of signals from the partition scheduler 21 (S61).</p><p id="p0095" num="0095">According to the processing shown in <figref idrefs="f0007">Fig. 8</figref>, the microcontroller 15 can be reliably reset not only when the reset instruction is intentionally issued from the partition scheduler 21 to the reset circuit 14, but also when the partition scheduler 21 itself fails to operate normally due to some causes or when a malfunction occurs in a signal line for transmitting signals from the partition scheduler 21 to the reset circuit 14. At the same time, execution of normal switching of TPs every one tick can also be guaranteed.</p><p id="p0096" num="0096">Note that in <figref idrefs="f0006">Figs. 7</figref> and <figref idrefs="f0007">8</figref>, the description has been made assuming that the partition scheduler 21 outputs the reset instruction signal to the reset circuit 14 or suspends transmission of the signal to<!-- EPO <DP n="26"> --> the reset circuit 14 in response to the notification of the result from TP 1 . Alternatively, the partition scheduler 21 may output the reset instruction signal to the reset circuit 14 or stop transmission of the signal to the reset circuit 14 in response to the notification of the result from any one of TP1 to TP3.</p><heading id="h0012">&lt;Second Embodiment of the Invention&gt;</heading><p id="p0097" num="0097">A safety controller according to this embodiment is a modification of the safety controller 1 described above. The overall configuration of the safety controller according to this embodiment may be similar to the configuration of the safety controller 1 shown in <figref idrefs="f0001">Fig. 1</figref>. Additionally, a task execution environment provided by an OS included in the safety controller according to this embodiment may be configured in the same manner as that of the task execution environment shown in <figref idrefs="f0003">Fig. 4</figref>.</p><p id="p0098" num="0098">Referring next to <figref idrefs="f0008">Figs. 9</figref> and <figref idrefs="f0010">11B</figref>, the processing of the safety controller 1 according to this embodiment will be described in further detail. <figref idrefs="f0008">Fig. 9</figref> is a flowchart showing a specific example of the procedure of the partition scheduler 21 according to this embodiment. Note that in the following description, description of processing contents identical with those described in <figref idrefs="f0005">Fig. 6</figref> is simplified, and different processing contents will be described in more detail.</p><p id="p0099" num="0099">First, the partition scheduler 21 that operates every one tick causes the task scheduler in TPX to operate (S81). Here, a variable X represents a TP number, and X is a value other than 1. Note that the processing contents of S81 to S83 in <figref idrefs="f0008">Fig. 9</figref> are identical with those of S11 to S 13 in <figref idrefs="f0005">Fig. 6</figref>, so the detailed description thereof is herein omitted.</p><p id="p0100" num="0100">Referring to <figref idrefs="f0008">Fig. 9</figref>, a case is described by way of example in which the scheduling pattern is switched to the safety control scheduling pattern (for example, <figref idrefs="f0004">Fig. 5B</figref>) when scheduling is started in<!-- EPO <DP n="27"> --> accordance with the normal control scheduling pattern (for example, <figref idrefs="f0004">Fig. 5A</figref>). In other words, a case is described by way of example in which when TP1 is a TP subsequent to TP2 and when an abnormality of TP2 is detected in TP1, TP3 is a TP to be subsequently selected and decided upon reception of the result from TP1.</p><p id="p0101" num="0101">The partition scheduler 21 judges whether the task in TP3 is currently executed (S95). When the task in TP3 is not being executed (No in S95) and when the partition scheduler 21 does not change the TP to be subsequently activated (No in S84), the flow returns to S81 to continue the operation for the same TPX. Note that the processing contents of S85 to S93 in <figref idrefs="f0008">Fig. 9</figref> are the same as those of S15 to S23 in <figref idrefs="f0005">Fig. 6</figref>, so the detailed description thereof is herein omitted.</p><p id="p0102" num="0102">As for the processing shown in <figref idrefs="f0008">Fig. 9</figref>, a specific example of partition scheduling will be described.<br/>
Here, a case is described in which scheduling is started in S81 in accordance with the normal control scheduling pattern illustrated in <figref idrefs="f0004">Fig. 5A</figref>. In this case, the scheduling is started in S81 assuming that TPX=TP2 holds, and TPX=TP2 is maintained also in the processing of S82 to S84 until TPX=TP3 is satisfied after passing through S93. Further, TPX is changed from TP2 to TP1 in S85, and TP1 remains unchanged during the processing of S85 to S91. When it is determined that the running status (data input and output) related to TP2 is normal in S85, TPX=TP2 holds in S94 (that is, the normal control scheduling pattern starting from TP2 is continued). Meanwhile, when it is determined that the running status (data input and output) related to TP2 is abnormal in S88, TPX=TP3 holds in S93 (that is, the scheduling pattern is switched to the safety control scheduling pattern starting from TP3). Furthermore, when TPX=TP3 holds in S93, the partition scheduler 21 maintains TPX=TP3 in S95 and S93. That is, the partition scheduler 21 executes the partition scheduling so as to continuously select and decide TP3.</p><p id="p0103" num="0103"><!-- EPO <DP n="28"> --> Note that in the example shown in <figref idrefs="f0008">Fig. 9</figref>, processing for switching from TP3 to TP2 as a result of ensuring the safety by the safety control after TP 3 is continuously selected and decided as TPX is not particularly illustrated. However, in order to implement this processing, a configuration for determining switching to TP2 depending on the contents of the notified result in TP3 may be employed as a configuration in which the partition scheduler 21 receives the result notified from the task in TP3, for example.</p><p id="p0104" num="0104">Note that the example of <figref idrefs="f0008">Fig. 9</figref> illustrates the case where only the three TPs (TP1 for safety monitoring, TP2 for normal control, and TP3 for safety control) are combined as the scheduling pattern, but a plurality of partitions TP2 for normal control and a plurality of partitions TP3 for safety control may be present. For example, scheduling patterns may be formed by a combination of five TPs (TP1 to TP5) including two TPs of TP2 and TP4 for normal control, TP1 for safety monitoring, and two TPs of TP3 and TP5 for safety control. In this case, in S95, the partition scheduler 21 may determine whether any one of tasks in TP3 or TP5 is currently executed, and in S83, the partition scheduler 21 may determine the type of the abnormality state of the running status (data input and output) related to TPX, and may select one of TP3 and TP5 for safety control according to the type.</p><p id="p0105" num="0105">According to this embodiment described above, when an abnormality occurs, TPs for executing tasks other than the tasks for safety control can be skipped, and only the tasks in TP3 can be executed in the subsequent scheduling. As a result, if an abnormality occurs when the scheduling is performed in accordance with the scheduling pattern during the normal control as shown in the upper part of <figref idrefs="f0010">Fig. 11B</figref>, for example, the scheduling pattern can be switched to the scheduling pattern shown in the lower part of <figref idrefs="f0010">Fig. 11B</figref>, and only TP3 can be executed immediately and continuously. This makes it possible to start processing using a safety control program more rapidly.<!-- EPO <DP n="29"> --></p><p id="p0106" num="0106">Further, when a configuration is employed in which the partition scheduler 21 receives results notified from each TP and switches TPs in consideration of the statuses of all TPs, the time partition can be switched to TP3 for safety control and TP3 can be maintained until the safety is ensured, regardless of the predetermined scheduling pattern. Moreover, it is judged whether the safety has been ensured by executing TP3, based on the result notified from TP3, thereby enabling switching of the time partition to TP2 (restoring the pattern during the normal control). Accordingly, the safety control can be appropriately performed upon occurrence of an abnormality.</p><heading id="h0013">&lt;Third Embodiment of the Invention&gt;</heading><p id="p0107" num="0107">A safety controller according to this embodiment is a modification of the safety controller 1 described above. The overall configuration of the safety controller according to this embodiment may be similar to the configuration of the safety controller 1 shown in <figref idrefs="f0001">Fig. 1</figref>. Additionally, a task execution environment provided by an OS included in the safety controller according to this embodiment may be configured in the same manner as that of the task execution environment shown in <figref idrefs="f0003">Fig. 4</figref>.</p><p id="p0108" num="0108">Referring next to <figref idrefs="f0009">Fig. 10</figref>, the processing of the safety controller 1 according to this embodiment will be described in more detail. <figref idrefs="f0009">Fig. 10</figref> is a flowchart showing a specific example of a procedure of the partition scheduler 21 according to this embodiment. <figref idrefs="f0009">Fig. 10</figref> shows a specific example of a procedure related to task initialization processing of the partition scheduler 21.</p><p id="p0109" num="0109">First, the partition scheduler 21 that operates every one tick causes the task scheduler in TPX to operate (S101). Here, a variable X represents a TP number, and all types of TPs included in the scheduling pattern are targeted.</p><p id="p0110" num="0110"><!-- EPO <DP n="30"> --> The task scheduler in TPX having started operation in S101 executes tasks in TPX, thereby executing the initialization processing for the tasks. Then, after a lapse of one tick, the partition scheduler 21 judges whether the initialization processing for the tasks in TPX has been finished (S102). When the initialization processing for the tasks has not been finished yet (No in S102), the flow returns to S101 to continue the initialization processing for the tasks in TPX. Note that, for example, the partition scheduler 21 may judge whether the initialization processing for the tasks in TPX has been finished, based on the notification of the result of the running status from TPX. In the case where the initialization processing has been finished, the tasks may set a value of a flag to indicate the end of the initialization processing, and the partition scheduler 21 may judge the end according to the value of the flag.</p><p id="p0111" num="0111">In the case where the initialization processing for the tasks has been finished (Yes in S102), the partition scheduler 21 judges whether the initialization processing for the tasks related to all types of TPs included in the scheduling pattern has been finished (S103). If the initialization processing for the tasks related to all TPs has not been finished yet (No in S103), the partition scheduler 21 switches TPX to a subsequent TPX (S 104). As a result, the process returns to S101, and the initialization processing for the tasks in the switched TPX is continued.</p><p id="p0112" num="0112">In the case where the initialization processing for the tasks related to all TPs has been finished (Yes in S103), the partition scheduler 21 selects and decides TPs other than TP3 as TPX to be activated, thereby allowing the task scheduler to operate in the TPX thus selected and decided (S105). For example, the partition scheduler 21 skips TP3, and executes only TP1 and TP2. As a method for selecting and deciding only TPs other than TP3, the partition scheduler 21 may select decide time partitions other than TP3 when TP3 is a candidate of the time partition to be subsequently activated.<!-- EPO <DP n="31"> --></p><p id="p0113" num="0113">According to this embodiment described above, an execution time is provided to all TPs only during the initialization processing for the tasks. After execution of normal task processing is started, TP3 for executing tasks for safety control is skipped, and only TP1 for executing tasks for safety monitoring and TP2 for executing tasks for normal control can be executed.</p><p id="p0114" num="0114">Accordingly, under such circumstances that an abnormality hardly occurs after completion of the initialization processing for the tasks related to all TPs, there is no need to execute unnecessary TP3. Consequently, a longer period of time can be allocated as compared to the execution time (TP2) for tasks generated by the normal control program.</p><p id="p0115" num="0115">Moreover, the present invention is not limited to the above embodiments, and various modifications can be made without departing from the scope of the present invention as described above. For example, the present invention can be carried out singly or in combination of a plurality of embodiments. For example, it is also possible to combine the configurations as described below. That is, the configuration in which an execution time is provided to all TPs during the initialization processing for tasks, and TP3 is skipped and only TP1 and Tp2 are executed after execution of the normal task processing is started, and the configuration in which the scheduling pattern is switched to the scheduling pattern starting from TP3 upon occurrence of an abnormality and TPs other than TP3 are skipped and only tasks in TP3 are executed in the subsequent scheduling.</p><heading id="h0014"><b>Reference Signs List</b></heading><p id="p0116" num="0116"><dl id="dl0001"><dt>1</dt><dd>SAFETY CONTROLLER</dd><dt>10</dt><dd>PROCESSOR</dd><dt>11</dt><dd>EXECUTION MEMORY<!-- EPO <DP n="32"> --></dd><dt>12</dt><dd>I/O PORT</dd><dt>13</dt><dd>NONVOLATILE MEMORY</dd><dt>14</dt><dd>RESET CIRCUIT</dd><dt>15</dt><dd>MICROCONTROLLER</dd><dt>21</dt><dd>PARTITION SCHEDULER</dd><dt>22</dt><dd>SCHEDULING TABLE</dd><dt>23, 25, 27</dt><dd>TASK SCHEDULER</dd><dt>24</dt><dd>SAFETY MONITORING TASK</dd><dt>26</dt><dd>NORMAL CONTROL TASK</dd><dt>28</dt><dd>SAFETY CONTROL TASK</dd><dt>100</dt><dd>OPERATING SYSTEM</dd><dt>101</dt><dd>SAFETY MONITORING APPLICATION</dd><dt>102</dt><dd>NORMAL CONTROL APPLICATION</dd><dt>103</dt><dd>SAFETY CONTROL APPLICATION</dd></dl></p></description><claims mxw-id="PCLM56976999" lang="EN" load-source="patent-office"><!-- EPO <DP n="33"> --><claim id="c-en-0001" num="0001"><claim-text>A safety controller comprising:
<claim-text>a hardware resource including at least one processor; and</claim-text>
<claim-text>a system program for controlling allocation of an execution time of the processor with respect to (a) a safety monitoring program for motoring occurrence of an abnormality related to a control target, (b) a normal control program related to a control of the control target during normal time, and (c) the safety control program related to the control of the control target upon occurrence of an abnormality, wherein</claim-text>
<claim-text>the system program partially includes a partition scheduler that selects and decides a time partition to be subsequently scheduled in accordance with a scheduling pattern including: (d) a first time partition in which the execution time is allocated to the safety monitoring program; (e) a second time partition in which the execution time is allocated to the normal control program; and (f) a third time partition in which the execution time is allocated to the safety control program,</claim-text>
<claim-text>the processor executes the system program to cause the partition scheduler to operate periodically, and</claim-text>
<claim-text>the partition scheduler skips a time partition including a program which need not be executed among time partitions included in the scheduling pattern, in response to a notification of an execution result from a program executed in at least one of the first to third time partitions.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The safety controller according to Claim 1, wherein upon receiving the notification of the execution result indicating that an abnormality has been detected by the safety monitoring program executed in the first time partition, the partition scheduler skips time partitions other than the third time partition in a subsequent scheduling.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The safety controller according to Claim 1 or 2, wherein the<!-- EPO <DP n="34"> --> partition scheduler skips the third time partition in a subsequent scheduling upon execution and completion of program initialization processing in each of the first to third time partitions.</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>The safety controller according to any one of Claims 1 to 3, further comprising a reset circuit that resets the hardware resource, wherein<br/>
the partition scheduler outputs a reset instruction signal to the reset circuit in response to a notification indicating an abnormality including an emergency stop from a program executed in at least one of the first to third time partitions, and<br/>
the reset circuit resets the hardware resource upon reception of the reset instruction signal.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>The safety controller according to any one of Claims 1 to 3, further comprising a reset circuit that resets the hardware resource, wherein<br/>
the partition scheduler periodically transmits a signal to the reset circuit, and suspends transmission of the signal to the reset circuit in response to a notification indicating an abnormality including an emergency stop from a program executed in at least one of the first to third time partitions, and<br/>
the reset circuit resets the hardware resource when the transmission of the signal from the partition scheduler is interrupted.</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>A safety control method for a control target, comprising the steps of:
<claim-text>periodically operating to cause a processor to select and decide a time partition to be subsequently scheduled in accordance with a scheduling pattern including (a) a first time partition in which an execution time of the processor is allocated to a safety monitoring program for monitoring occurrence of an abnormality related to the control target, (b) a second time partition in which the execution time is allocated to a normal control program related to a control for the<!-- EPO <DP n="35"> --> control target during normal time, and (c) a third time partition in which the execution time is allocated to a safety control program related to the control for the control target upon occurrence of an abnormality; and</claim-text>
<claim-text>operating to cause the processor to skip a time partition including a program which need not be executed among time partitions included in the scheduling pattern, in response to a notification of an execution result from a program executed in at least one of the first to third time partitions.</claim-text></claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>The safety control method according to Claim 6, further comprising the step of operating to cause the processor to skip time partitions other than the third time partition in a subsequent scheduling, upon reception of the notification of the execution result indicating that an abnormality has been detected by the safety monitoring program executed in the first time partition.</claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>The safety control method according to Claim 6 or 7, further comprising the step of operating to cause the processor to skip the third time partition in a subsequent scheduling, upon execution and completion of program initialization processing in each of the first to third time partitions.</claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>The safety control method according to any one of Claims 6 to 8, further comprising a reset circuit that resets a hardware resource including the processor,<br/>
wherein the safety control method further comprises the steps of:
<claim-text>outputting a reset instruction signal to the reset circuit in response to a notification indicating an abnormality including an emergency stop from a program executed in at least one of the first to third time partitions; and</claim-text>
<claim-text>resetting the hardware resource using the reset circuit upon reception of the reset instruction signal.</claim-text><!-- EPO <DP n="36"> --></claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>The safety control method according to any one of Claims 6 to 8, further comprising a reset circuit that resets a hardware resource including the processor,<br/>
wherein the safety control method further comprises the steps of:
<claim-text>periodically transmitting a signal to the reset circuit, and suspending transmission of the signal to the reset circuit in response to a notification indicating an abnormality including an emergency stop from a program executed in at least one of the first to third time partitions; and</claim-text>
<claim-text>resetting the hardware resource using the reset circuit when the transmission of the signal from the partition scheduler is interrupted.</claim-text></claim-text></claim></claims><drawings mxw-id="PDW16667722" load-source="patent-office"><!-- EPO <DP n="37"> --><figure id="f0001" num="1,2"><img id="if0001" file="imgf0001.tif" wi="164" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="38"> --><figure id="f0002" num="3"><img id="if0002" file="imgf0002.tif" wi="159" he="120" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="39"> --><figure id="f0003" num="4"><img id="if0003" file="imgf0003.tif" wi="165" he="220" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="40"> --><figure id="f0004" num="5A,5B"><img id="if0004" file="imgf0004.tif" wi="165" he="181" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="41"> --><figure id="f0005" num="6"><img id="if0005" file="imgf0005.tif" wi="162" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="42"> --><figure id="f0006" num="7"><img id="if0006" file="imgf0006.tif" wi="157" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="43"> --><figure id="f0007" num="8"><img id="if0007" file="imgf0007.tif" wi="163" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="44"> --><figure id="f0008" num="9"><img id="if0008" file="imgf0008.tif" wi="163" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="45"> --><figure id="f0009" num="10,11A"><img id="if0009" file="imgf0009.tif" wi="163" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="46"> --><figure id="f0010" num="11B,12"><img id="if0010" file="imgf0010.tif" wi="165" he="209" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="47"> --><figure id="f0011" num="13"><img id="if0011" file="imgf0011.tif" wi="165" he="148" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="165" he="227" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="165" he="227" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
