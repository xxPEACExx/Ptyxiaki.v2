<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2680182-A1" country="EP" doc-number="2680182" kind="A1" date="20140101" family-id="48325465" file-reference-id="318318" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146549448" ucid="EP-2680182-A1"><document-id><country>EP</country><doc-number>2680182</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-13167024-A" is-representative="YES"><document-id mxw-id="PAPP154823371" load-source="docdb" format="epo"><country>EP</country><doc-number>13167024</doc-number><kind>A</kind><date>20130508</date><lang>EN</lang></document-id><document-id mxw-id="PAPP177814742" load-source="docdb" format="original"><country>EP</country><doc-number>13167024.2</doc-number><date>20130508</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140446336" ucid="US-201261666742-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201261666742</doc-number><kind>P</kind><date>20120629</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988100473" load-source="docdb">G06F  21/55        20130101AFI20131015BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1957301845" load-source="docdb" scheme="CPC">H04W  12/12        20130101 LI20160321BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988114697" load-source="docdb" scheme="CPC">G06F  21/55        20130101 FI20131014BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132180828" lang="DE" load-source="patent-office">Mobile Vorrichtung und Verfahren zur Überwachung eines Basisbandprozessor in Bezug auf die Reaktion eines Anwendungsprozessors</invention-title><invention-title mxw-id="PT132180829" lang="EN" load-source="patent-office">Mobile device and method to monitor a baseband processor in relation to the actions on an application processor</invention-title><invention-title mxw-id="PT132180830" lang="FR" load-source="patent-office">Dispositif mobile et procédé pour surveiller un processeur de bande de base en relation avec les actions sur un processeur d'application</invention-title><citations><patent-citations><patcit mxw-id="PCIT242652477" load-source="docdb" ucid="DE-102006016994-A1"><document-id format="epo"><country>DE</country><doc-number>102006016994</doc-number><kind>A1</kind><date>20071018</date></document-id><sources><source name="SEA" category="A" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242652478" load-source="docdb" ucid="US-20090260081-A1"><document-id format="epo"><country>US</country><doc-number>20090260081</doc-number><kind>A1</kind><date>20091015</date></document-id><sources><source name="SEA" category="I" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242652479" load-source="docdb" ucid="US-20100121916-A1"><document-id format="epo"><country>US</country><doc-number>20100121916</doc-number><kind>A1</kind><date>20100513</date></document-id><sources><source name="SEA" category="A" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242652480" load-source="docdb" ucid="US-20100251370-A1"><document-id format="epo"><country>US</country><doc-number>20100251370</doc-number><kind>A1</kind><date>20100930</date></document-id><sources><source name="SEA" category="A" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242652481" load-source="docdb" ucid="US-20120096539-A1"><document-id format="epo"><country>US</country><doc-number>20120096539</doc-number><kind>A1</kind><date>20120419</date></document-id><sources><source name="SEA" category="I" created-by-npl="N"/></sources></patcit></patent-citations><non-patent-citations><nplcit><text>None</text><sources><source mxw-id="PNPL45131075" load-source="docdb" name="APP"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR918156483" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>GSMK GES FUER SICHERE MOBILE KOMMUNIKATION MBH</last-name><address><country>DE</country></address></addressbook></applicant><applicant mxw-id="PPAR918157627" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>GSMK GESELLSCHAFT FUER SICHERE MOBILE KOMMUNIKATION MBH</last-name></addressbook></applicant><applicant mxw-id="PPAR918994219" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>GSMK Gesellschaft für sichere Mobile Kommunikation mbH</last-name><iid>100977306</iid><address><street>Marienstrasse 11</street><city>10117 Berlin</city><country>DE</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918156769" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>RIEGER FRANK</last-name><address><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918145956" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>RIEGER, FRANK</last-name></addressbook></inventor><inventor mxw-id="PPAR918993798" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>RIEGER, FRANK</last-name><address><street>Marienstrasse 11</street><city>10117 Berlin</city><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918144579" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>UVIN VADIM</last-name><address><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918139185" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>UVIN, VADIM</last-name></addressbook></inventor><inventor mxw-id="PPAR918980855" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>UVIN, VADIM</last-name><address><street>Marienstrasse 11</street><city>11017 Berlin</city><country>DE</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918986791" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>2K Patentanwälte Blasberg Kewitz &amp; Reichel</last-name><iid>101365732</iid><address><street>Partnerschaft Schumannstrasse 27</street><city>60325 Frankfurt am Main</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS548804842" load-source="docdb">AL</country><country mxw-id="DS548842073" load-source="docdb">AT</country><country mxw-id="DS548804844" load-source="docdb">BE</country><country mxw-id="DS548881090" load-source="docdb">BG</country><country mxw-id="DS548894991" load-source="docdb">CH</country><country mxw-id="DS548862803" load-source="docdb">CY</country><country mxw-id="DS548842074" load-source="docdb">CZ</country><country mxw-id="DS548804845" load-source="docdb">DE</country><country mxw-id="DS548862804" load-source="docdb">DK</country><country mxw-id="DS548862805" load-source="docdb">EE</country><country mxw-id="DS548865889" load-source="docdb">ES</country><country mxw-id="DS548881091" load-source="docdb">FI</country><country mxw-id="DS548894992" load-source="docdb">FR</country><country mxw-id="DS548804858" load-source="docdb">GB</country><country mxw-id="DS548862806" load-source="docdb">GR</country><country mxw-id="DS548804859" load-source="docdb">HR</country><country mxw-id="DS548842075" load-source="docdb">HU</country><country mxw-id="DS548869680" load-source="docdb">IE</country><country mxw-id="DS548862807" load-source="docdb">IS</country><country mxw-id="DS548894993" load-source="docdb">IT</country><country mxw-id="DS548862808" load-source="docdb">LI</country><country mxw-id="DS548881092" load-source="docdb">LT</country><country mxw-id="DS548805012" load-source="docdb">LU</country><country mxw-id="DS548881093" load-source="docdb">LV</country><country mxw-id="DS548881094" load-source="docdb">MC</country><country mxw-id="DS548805013" load-source="docdb">MK</country><country mxw-id="DS548805014" load-source="docdb">MT</country><country mxw-id="DS548862809" load-source="docdb">NL</country><country mxw-id="DS548804861" load-source="docdb">NO</country><country mxw-id="DS548863146" load-source="docdb">PL</country><country mxw-id="DS548881095" load-source="docdb">PT</country><country mxw-id="DS548842076" load-source="docdb">RO</country><country mxw-id="DS548881100" load-source="docdb">RS</country><country mxw-id="DS548863147" load-source="docdb">SE</country><country mxw-id="DS548895074" load-source="docdb">SI</country><country mxw-id="DS548804870" load-source="docdb">SK</country><country mxw-id="DS548804871" load-source="docdb">SM</country><country mxw-id="DS548805015" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128670117" lang="EN" load-source="patent-office"><p id="pa01" num="0001">Method and device to analyze the security of a mobile terminal, comprising an application processor (AP), a baseband processor (BP), the AP and the BP exchange information, comprising the steps:<br/>
a) acquiring by a Basband- monitor application and an Application-monitor application running on the mobile device one or more of the following information:<br/>
-Information from the BP about opening and closing of transmission channels to and from a base station;<br/>
-Infomation from the baseband CPU about protocol transmissions to and from the station;<br/>
-Information from the baseband CPU about the volume of data transmission;<br/>
- Measures response times to standard service requests from application CPU(AP) to baseband CPU (BP);<br/>
- Information of the power consumption of phone components;<br/>
- Information of the current and voltage delivered by the battery to the phone;<br/>
-Configuration of the the audio path , to determine which component or application is using the micro-phone;<br/>
- Monitor the running applications on the AP;<br/>
- Monitor the status of the running applications on the AP;<br/>
Monitor time or duration of applications running on the AP;<br/>
- Monitor the input or output of the applications running on the AP;<br/>
- Monitor the input of a user to a User-Interface.<br/>
 <br/>
  
<img id="iaf01" file="imgaf001.tif" wi="104" he="68" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128499490" lang="EN" source="EPO" load-source="docdb"><p>Method and device to analyze the security of a mobile terminal, comprising an application processor (AP), a baseband processor (BP), the AP and the BP exchange information, comprising the steps: 
a) acquiring by a Basband- monitor application and an Application-monitor application running on the mobile device one or more of the following information: 
-Information from the BP about opening and closing of transmission channels to and from a base station; 
-Infomation from the baseband CPU about protocol transmissions to and from the station; 
-Information from the baseband CPU about the volume of data transmission; 
- Measures response times to standard service requests from application CPU(AP) to baseband CPU (BP); 
- Information of the power consumption of phone components; 
- Information of the current and voltage delivered by the battery to the phone; 
-Configuration of the the audio path , to determine which component or application is using the micro-phone; 
- Monitor the running applications on the AP; 
- Monitor the status of the running applications on the AP; 
Monitor time or duration of applications running on the AP; 
- Monitor the input or output of the applications running on the AP; 
- Monitor the input of a user to a User-Interface. 
  
</p></abstract><description mxw-id="PDES63955547" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><b><u>Field of the Invention</u></b></heading><p id="p0001" num="0001">The invention disclosed herein describes devices and methods to mitigate and prevent over-the-air attacks against the baseband processor of mobile devices by means of monitoring the baseband processor's behavior, correlating this behavior with the intentions of the user (as expressed by the behavior of the application processor), and taking appropriate countermeasures against attacks.</p><heading id="h0002"><b><u>Backaround of Invention</u></b></heading><p id="p0002" num="0002">Modem mobile devices (typically, mobile phones and tablet computers with cellular network connectivity) consist of at least two separate processors: The so called application CPU (Central Processing Unit), which runs the operating system, user interface and applications, and the so-called baseband CPU that runs all the necessary software to interface with the mobile network (e.g. GSM Global System for Mobile Communications, 3G, CDMA (Code Division Multiple Access), CDMA2000, UMTS Universal Mobile Telecommunications System, or LTE (Long Term Evolution).</p><p id="p0003" num="0003">A mobile application processor is a system on a chip designed to support applications running in a mobile operating system environment. The system on a chip can be physically independent from the baseband CPU as separate chip or can be implemented physically integrated into one chip together with the baseband CPU.</p><p id="p0004" num="0004">A mobile application processor provides a self-contained operating environment that delivers all system capabilities needed to support a device's applications, including memory management, graphics processing, and multimedia decoding.</p><p id="p0005" num="0005">Mobile application processors may be independent from other specialized processors in the same mobile device, such as a phone's baseband (wireless communications) processor.<!-- EPO <DP n="2"> --></p><p id="p0006" num="0006">Some vendors manufacture their own mobile application processors. Other vendors purchase their mobile application processors, using them as original equipment manufacturer (OEM) components. For example, the Qualcomm Snapdragon mobile application processor is contained in many smart phones that use Snapdragon to run the Android operating system and Android applications. In this way, every phone manufacturer need not develop its own mobile application processor (atthough they can); this approach reduces bill-of-materials cost and makes it possible to develop low-cost "smart" consumer electronics.</p><p id="p0007" num="0007">A wide variety of mobile devices contain mobile application processors, including feature phones, smartphones, tablets, eReaders, netbooks, automotive navigation devices, and gaming consoles.</p><p id="p0008" num="0008">A baseband processor (also known as baseband radio processor, BP, or BBP) is a device (a chip or part of a chip) in a network interface that manages all the radio functions (all functions that require an antenna). This may or may not include WiFi and/or Bluetooth. It typically uses its own RAM and firmware. This RAM can also be shared with the application processor.</p><p id="p0009" num="0009">The reasons for separating the baseband processor from the application CPU (known as the AP or Application Processor) are:
<ol><li>1. radio performance: radio control functions (signal modulation, encoding, radio frequency shifting, etc.) are highly timing dependant, and require a realtime OS</li><li>2. legal: some authorities (e.g. the U.S. Federal Communications Commission (FCC)) require that the entire software stack running on a device which communicates with the cellular network must be certified. Separating the BP into a different component allows reusing them without having to certify the full AP.</li><li>3. radio reliability: Separating the BP into a different component ensures proper radio operation while allowing application and OS changes.</li></ol></p><p id="p0010" num="0010">Baseband processors typically run a RTOS written in firmware: e.g. Nucleus RTOS (iPhone 3G/3GS/iPad), ENEA's OSE, VRTX, ThreadX (iPhone 4)</p><p id="p0011" num="0011">Significant baseband manufacturers include MediaTek, Broadcom, lcera, Intel Mobile Communications- former infineon wireless division, Qualcomm, ST-Ericsson.</p><p id="p0012" num="0012">The BP and the AP can communicate and exchange information. One possibility is to use shared memory, which is controlled by a memory controller or a memory management unit. In this context the terms memory controller<!-- EPO <DP n="3"> --> and memory management are used to identify the same unit which has the functionality of a memory controller, of a memory management unit, or of both. The memory controller controls regions of the memory for the AP and the BP and in some areas concurrent access is possible by both the AP and the BP. Also a bus system is possible over which the AP and the BP exchange information. Also private memory sections with private memory controllers and a mutual memory controller for a shared area are possible solutions. There is also a certain exchange of commandos between BP and AP, for example to initiate a call from an application running on the AP, or to start an application when a call is detected by the BP. The memory controller is a digital circuit which manages the flow of data going to and from the main memory. It can be a separate chip or integrated into another chip, such as on the die of a microprocessor. This is also called a Memory Chip Controller (MCC). Memory controllers contain the logic necessary to read and write to RAM or DRAM, and to "refresh" the DRAM by sending current through the entire device. Without constant refreshes, DRAM will lose the data written to it as the capacitors leak their charge within a fraction of a second.<br/>
Reading and writing to DRAM is performed by selecting the row and column data addresses of the DRAM as the inputs to the multiplexer circuit, where the demultiplexer on the DRAM uses the converted inputs to select the correct memory location and return the data, which is then passed back through a multiplexer to consolidate the data in order to reduce the required bus width for the operation. Also the memory controller might be necessary to control the concurrent access to the RAM by different component of the device and the CPUs of the device.</p><p id="p0013" num="0013">While the security situation for software running on the application CPU largely follows the methods and procedures developed for desktop computers (e.g. running anti-virus software, firewalls, restrict code execution to signed applications, etc.), the security of the baseband processor has been mostly ignored so far. This is despite of the fact that the baseband CPU is a complex hardware component in an exposed position: The baseband CPU is connected on one side to the mobile network(s) and on the other side to the application CPU. All data transmissions, phone calls, SMS messages, etc. from and to the mobile networks as requested by software running on the application CPU pass through the baseband CPU.</p><p id="p0014" num="0014">With increasing availability of private GSM and 3G base stations, a so far largely neglected class of attacks against the security and integrity of a mobile device becomes feasible and, consequently, more widespread. This class of attacks is characterized by forcing or "seducing" the victim's mobile device to camp on a base station that is under the control of the attacker. The attacker then uses manipulated transmissions to trigger security vulnerabilities on the victim's mobile device (e.g. buffer overruns, memory corruption, stack overflows etc.) and cause the victim's mobile device to behave in ways favorable to the attacker. The attacker can for example cause the victim's mobile device to accept incoming calls without ringing or any user interaction (thus allowing the attacker to eavesdrop onto conversations held in the vicinity of the victim's phone), or let malicious software run on the baseband CPU to cause unintended behavior like monitoring of ongoing communications or exfiltration of critical data.<!-- EPO <DP n="4"> --></p><p id="p0015" num="0015">The security quality of the software running on today's baseband CPUs is on average rather low, as large parts of the necessary protocol stacks haven been written back in the 1990s, before secure programming guidelines were known or observed. Fixing or patching baseband software for security reasons is very seldom done by the device manufacturers. There is a multitude of reasons for this problem: The baseband chipsets are developed and manufactured by a very small group of specialized companies which typically supply both the chips and the software/firmware running on them. The baseband software is usually customized to the needs of the specific phone either by the baseband processor's manufacturer, the phone's manufacturer, or both. These relationships, interdependencies, and the question of code ownership are often complicated. The result is a situation where baseband firmware is typically only updated when there are problems with battery lifetime or data throughput. Building new baseband firmware is a process that might also involve the need to obtain new regulatory approvals from bodies like the Federal Communications Commission (FCC), which is a costly and time-consuming, such that the process may not be completed during the market life cycle of the mobile device in question.</p><p id="p0016" num="0016">The resulting situation is detrimental to the security and protection of the mobile device's user against the types of over-the-air-attack described above. Even when new attacks are published and become widespread, the standard simple defense strategy of applying a software update may not be available. The invention disclosed herein therefore describes the missing piece in the security armor: means and methods to mitigate and prevent these types of attacks.</p><heading id="h0003"><b><u>Summarv of Invention</u></b></heading><p id="p0017" num="0017">The invention intends to provide a solution for the missing security on the baseband processor.</p><p id="p0018" num="0018">In order to defend against an attack on the baseband CPU, the attack first needs to be detected. As the baseband firmware itself typically contains only insufficient or no provisions for detection of attacks, a new method is required. One core idea behind the invention is to monitor the behavior of the baseband CPU, as reflected in various extermally observable signs, and correlate this behavior with information about the actual intended activities of the mobile device's user. The invention consists of several components.</p><p id="p0019" num="0019">Method for detecting an attack on the baseband processor of a mobile device which contains a baseband processor and an application processor, which may or may not be integrated in a single chip, comprising the steps:
<ol><li>a) monitoring, by dedicated baseband monitor software (can also be a hardware component), the behavior of the baseband processor by using features available on the respective mobile device,</li><li>b) monitoring, by a dedicated application monitor component (which can be implemented in either software or<!-- EPO <DP n="5"> --> hardware), the behavior of the application processor by keeping a record of the parameters, execution time, and execution duration of legitimate software and user activities on the application processor that cause normal baseband activities as intended by the user;</li><li>c) correlating by an evaluator component (which can be implemented in either software or hardware) the baseband processor behavior with application processor behavior in order to distinguish between legitimate and suspicious/illegitimate baseband activities,</li><li>d) initiation of countermeasures by a defense component (which can be implemented in either software or hardware) designed to ward off the suspicious/illegitimate baseband activities.</li></ol></p><p id="p0020" num="0020">In a possible embodiment the data collection, aggregation and analysis of detected suspicious events from multiple mobile devices can be used by a centralized reporter monitoring component to distribute warnings to the users of either all or only a selected subset of mobile devices connected to the respective reporter component, to adjust the behavior of the evaluator mechanism of mobile devices connected to the respective reporter, and/or to initiate more extensive logging. This is done by centralized server structure which is connected to the devices over the intemet.</p><p id="p0021" num="0021">In a possible embodiment the initiation of countermeasures designed to ward off the suspicious/illegitimate baseband activities comprises one or more of the following: resetting the baseband processor, resetting the phone, forcing all connections to be dropped. It has to be noted that this list is not limited to the listed options.</p><p id="p0022" num="0022">In a possible embodiment the monitoring by the baseband monitor comprises one or more of the following:
<ul><li>collecting information on power consumption of individual hardware components of the mobile device,</li><li>collecting information on audio path configuration,</li><li>collecting information on the response time to normal service requests from the application processor to the baseband processor;</li><li>monitoring of communication interfaces or memory areas shared between application processor and baseband processor for atypical communication patterns,</li><li>monitoring of communication interfaces and memory areas shared between application processor and baseband for patterns associated with exploit attempts,</li><li>collecting information obtained from the baseband processor's debugging output. It has to be noted that this list is not limited to the listed options.</li></ul></p><p id="p0023" num="0023">In a possible embodiment the monitoring of communication interfaces or memory areas shared between application processor and baseband processor for patterns associated with exploit attempts, comprises one or more of the following:<!-- EPO <DP n="6"> -->
<ul><li>Monitoring malformated messages or data structures or very large data blocks;</li><li>Monitoring the usage of procedures, functions, features or messages not seen in normal operations;</li><li>Monitoring attempts to access memory areas not consistent with normal operations.</li></ul>
It has to be noted that this list is not limited to the listed options.</p><p id="p0024" num="0024">In a possible embodiment the collecting of information obtained from the baseband processor's debugging output comprises one or more of the following:
<ul><li>timing and volume of voice call setup attempts,</li><li>timing and volume of data transmission,</li><li>timing and volume of SMS message transmission,</li><li>timing and sequence of establishment of traffic channels.</li></ul></p><p id="p0025" num="0025">In a possible embodiment the evaluator component runs as an application on the application processor.</p><p id="p0026" num="0026">In a possible embodiment the evaluator component flags the absence of standard A5/1, A5/2, or A5/3 link encryption on GSM or 3G/UMTS/W-CDMA mobile networks which leads the defense component to issue a warning to the mobile device's user that link encryption has been deactivated.</p><p id="p0027" num="0027">In a possible embodiment the evaluator component flags the presence of a rogue base station that does not belong to the legitimate mobile network and the defense component wams the mobile device's user that a rogue base station (a so-called "IMSI catcher") has been detected, and/or the 'defense' component shuts down the baseband processor in order to prevent exploitation.</p><p id="p0028" num="0028">An IMSI catcher is essentially a false mobile tower acting between the target mobile phone(s) and the service provider's real towers. As such it is considered a Man In the Middle (MITM) attack. It is used as an eavesdropping device used for interception and tracking of cellular phones and usually is undetectable for the users of mobile phones. Such a virtual base transceiver station (VBTS) is a device for identifying the International Mobile Subscriber Identity (IMSI) of a nearby GSM mobile phone and intercepting its calls and messages.</p><p id="p0029" num="0029">In a possible embodiment the evaluator component flags the presence of a rogue base station that does not belong to the legitimate mobile network using one or more of the following pieces of information:
<ul><li>cell identification, distance, and signal strength,</li><li>signal growth/attenuation,</li><li>forced network change from 3G to 2G network,</li><li>unusual changes in the list of neighboring cells,</li><li>unusual configuration parameters of the mobile base station designed to make it appear more<!-- EPO <DP n="7"> --> 'attractive' to the targeted mobile device(s),</li><li>network parameters not consistent with the mobile device's location and/or the currently selected mobile network operator</li></ul>
It has to be noted that this list is not limited to the listed options.</p><p id="p0030" num="0030">In a possible embodiment the evaluator component categorizes activities on the baseband processor in different classes ranging from normal/inconspicious to highly suspicious,</p><p id="p0031" num="0031">In a possible embodiment the evaluator is plotting all the events in a diagram that shows baseband activity and suspectedness of baseband activities over time and displays this diagram on either the mobile device's screen or an external display device.</p><p id="p0032" num="0032">In a possible embodiment the evaluator component compiles the information on suspectedness of baseband activities over time in one single integrated graphical representation of the overall threat level in respect to the mobile device's baseband processor or in the form of a 'threat level thermometer' that is displayed on either the mobile device's screen or an external display device.</p><p id="p0033" num="0033">In a possible embodiment the evaluator component records baseband activity in a log file that can subsequently be read and combined with log files from other mobile devices by a centralized reporter component in order to arrive at an overview of the aggregated threat level to which multiple mobile devices are subject to.</p><p id="p0034" num="0034">In a possible embodiment the evaluator component transmits data on baseband activity and network parameters to a remote reporter entity which performs additional location-based analytics to determine the locations of hostile networks.</p><p id="p0035" num="0035">In a possible embodiment the reporter remote analytics entity sends out warnings and configuration changes to either all or only a selected subset of mobile devices in respect to detected hostile network activity (e.g. based on the mobile devices' location and the location of areas where over-the-air attacks heap up).</p><p id="p0036" num="0036">In a possible embodiment the reporter remote analytics entity sends out warnings about hostile network activity to dedicated connected devices which are mounted as stationary sensors in sensitive areas for the primary purpose of informing users who do not have the baseband monitor component installed on their mobile devices about ongoing suspicious/illegitimate activities.<!-- EPO <DP n="8"> --></p><p id="p0037" num="0037">In a possible embodiment mobile devices are connected to the centralized reporter monitoring component via a direct wireless data connection, or via a synchronization mechanism that is activated whenever the phone is connected to a desktop computer to synchronize data with it.</p><p id="p0038" num="0038">In a possible embodiment the central reporter component can adjust the behavior of the evaluator mechanism of mobile devices connected to the respective reporter component (e.g. by lowering the suspiciousness level before countermeasures are initiated, or initiating more extensive logging).</p><p id="p0039" num="0039">In a possible embodiment the defense component runs as an application on the application processor.</p><p id="p0040" num="0040">In the following an example will be discussed. If the baseband monitor component detects an ongoing call by monitoring the baseband processor, while at the same time, the application monitor component reports that the telephony software running on the application CPU has not initiated or accepted a call, then the evaluator mechanism will determine that the likelihood of malicious baseband behavior is high, and that this is very likely the result of an attack.</p><p id="p0041" num="0041">In an alternative embodiment the invention provides a method to analyze the security of a mobile terminal, comprising an application processor (AP), a baseband processor (BP), the AP and the BP exchange information. The method comprises the steps:
<ol><li>a) acquiring by a Baseband-monitor application and an Application-monitor application running on the mobile device one or more of the following information:
<ul><li>Information from the BP about opening and closing of transmission channels to and from a base station;</li><li>Information from the baseband CPU about protocol transmissions to and from the base station;</li><li>Information from the baseband CPU about the volume of data transmission;</li><li>Measurement data of response times to standard service requests from application CPU(AP) to baseband CPU (BP);</li><li>Information on the power consumption of phone components;</li><li>Information on the current voltage delivered by the battery to the phone;</li><li>Configuration of the audio path, to determine which component or application is using the micro-phone ;</li><li>Monitor the running applications on the AP;</li><li>Monitor the status of the running applications on the AP;</li><li>Monitor time or duration of applications running on the AP;</li><li>Monitor the input or output of the applications running on the AP;</li><li>Monitor the input of a user to a User-Interfaces.</li></ul></li></ol><!-- EPO <DP n="9"> --></p><p id="p0042" num="0042">The information is stored in a possible embodiment in a database or container which can be accessed by a correlation engine to find correlations between at least two pieces of information above that indicate an unsecure situation, and triggering an alarm.</p><p id="p0043" num="0043">In a possible embodiment the Baseband-monitor application acquires one or more of the following information:
<ul><li>Information from the BP about opening and closing of transmission channels to and from a base station;</li><li>Information from the baseband CPU about protocol transmissions to and from the base station;</li><li>Information from the baseband CPU about the volume of data transmission;</li><li>Measures response times to standard service requests from application CPU(AP) to baseband CPU (BP). Furthermore the application monitor application acquires one or more of the following information :</li><li>Information of the power consumption of phone components;</li><li>Information of the current and voltage delivered by the battery to the phone;</li><li>Monitors the audio path configuration, by determining which component or application is using the micro-phone;</li><li>Monitor the running applications on the AP;</li><li>Monitor the status of the running applications on the AP;</li><li>Monitor time or duration of applications running on the AP;</li><li>Monitor the input or output of the applications running on the AP;</li><li>Monitor the input of a user to a User-Interface;</li></ul></p><p id="p0044" num="0044">All these pieces of information are used to find a correlation between the information of the baseband-monitor application and the information of the application-monitor-application, that indicate an unsecure situation, and triggering an alarm.</p><p id="p0045" num="0045">In a possible embodiment a correlation is defined being likely secure for one or more of the following:
<ul><li>if the user inputs information to a User-Interface and an application is running which is defined as the receiver of the information inputted, and network connection on the BP is opened after the inputted information;</li><li>if a web-browser application is started or activated and user input is detected which is directed to the web-browser application and a IP-Session is opened by the BP;</li><li>if an email-application is running and is checking for new emails and an IP-Session is opened by the BP;</li><li>if a phone call application is started, user input is detected, and a voice session is opened by the BP;</li><li>if a phone call application is started and has opened a voice connection over the BP a speaker path to the phone call application is allowed;</li><li>if an instant messaging communication is initiated or received by the user and an IP-Session is opened by the BP;</li><li>if software or system updates are initiated by the user or authorized system services, and an IP-Session is opened by the BP.</li></ul><!-- EPO <DP n="10"> --></p><p id="p0046" num="0046">In a possible embodiment a correlation is defined being likely unsecure for one or more of the following:
<ul><li>if a phone call is ongoing while no phone call is made or accepted by the phone call application or telephony application;</li><li>if the microphone is active and a phone call is ongoing over the BP while no phone call is made accepted by the phone call application or telephony application;</li><li>if the microphone is assigned to an application that is not allowed to have access to the microphone and which transfers data over the BP as a phone call or a IP-Session;</li><li>if the mobile device is an idle or sleep mode, while large amount of data from the storage device of the phone is transferred over a IP-session opened by the BP;</li><li>if the actual power consumption is larger than the displayed power consumption and a IP-session is opened by the BP to transfer data;</li><li>if the actual power differs from the expected power consumption and a IP-session or phone calls is ongoing over the BP.</li></ul></p><p id="p0047" num="0047">In a possible embodiment a correlation engine defines and maintains pattern of secure and unsecure states is then matched against the currently present data by mathematical correlation methods, including but not limited to neural networks and statistical deviation analysis.</p><p id="p0048" num="0048">In a possible embodiment power consumption is analyzed by mathematical subtraction of the area under the curve for battery discharge and if the area of the expected discharge curve as computed on the base of application and operating system power usage deviates significantly from the actually measured discharge curve, the resulting area under the curve is large and an IP-session or phone call is ongoing over the BP an alarm is triggered.</p><p id="p0049" num="0049">In a possible embodiment a user setting is provided allowing the configuration of the sensitivity of the alarm and attack countermeasure routines, so the user is not overwhelmed by false alarms.</p><p id="p0050" num="0050">In a possible embodiment in case of the alarm the BP is reset, the mobile device is reset or all connections are forced to be dropped.</p><p id="p0051" num="0051">A further part of the invention is Mobile terminal comprising an application processor (AP), a baseband processor (BP), the AP and the BP exchange information, comprising a Baseband- monitor application and an Application-monitor application running on the AP or BP, the monitor applications are configured to collect one or more of the following information:
<ul><li>Information from the BP about opening and closing of transmission channels to and from a base station;<!-- EPO <DP n="11"> --></li><li>Information from the baseband CPU about protocol transmissions to and from the base station;</li><li>Information from the baseband CPU about the volume of data transmission;</li><li>Measures response times to standard service requests from application CPU(AP) to baseband CPU (BP);</li><li>Information of the power consumption of phone components;</li><li>Information of the current and voltage delivered by the battery to the phone;</li><li>Configuration of the audio path, to determine which component or application is using the micro-phone;</li><li>Monitor the running applications on the AP;</li><li>Monitor the status of the running applications on the AP;</li><li>Monitor time or duration of applications running on the AP;</li><li>Monitor the input or output of the applications running on the AP;</li><li>Monitor the input of a user to a User-Interfaces;</li></ul></p><p id="p0052" num="0052">further comprising a correlation application being configured to find correlations between at least two information above that indicate an unsecure situation, and triggering an alarm.</p><p id="p0053" num="0053">In a possible embodiment of the mobile terminal the Baseband- monitor application acquires one or more of the following information:
<ul><li>Information from the BP about opening and closing of transmission channels to and from a base station;</li><li>Information from the baseband CPU about protocol transmissions to and from the base station;</li><li>Information from the baseband CPU about the volume of data transmission;</li><li>Measures response times to standard service requests from application CPU(AP) to baseband CPU (BP); and wherein the application monitor application acquires one or more of the following information:</li><li>Information of the power consumption of phone components;</li><li>Information of the current and voltage delivered by the battery to the phone;</li><li>Monitors the audio path configuration, by determining which component or application is using the micro-phone;</li><li>Monitor the running applications on the AP;</li><li>Monitor the status of the running applications on the AP;</li><li>Monitor time or duration of applications running on the AP;</li><li>Monitor the input or output of the applications running on the AP;</li><li>Monitor the input of a user to a User-Interface;</li></ul>
and the correlation application is configured to find correlation between the information of the baseband-monitor application and the information of the application-monitor-application, above that indicate an unsecure situation, and triggering an alarm.<!-- EPO <DP n="12"> --></p><p id="p0054" num="0054">In a possible embodiment of the mobile terminal a correlation is defined being likely secure for one or more of the following:
<ul><li>if the user inputs information to a User-Interface and an application is running which is defined as the receiver of the information inputed, and network connection on the BP is opened after the inputted information;</li><li>if a web-browser application is started or activated and user input is detected which is directed to the web-browser application and a IP-Session is opened by the BP;</li><li>if a email-application is running and is checking for new emails and an IP-Session is opened by the BP;</li><li>if a phone call application is started user input is detected and a voice session is opened by the BP;</li><li>if a phone call application is started and has opened a voice connection over the BP an speaker path to the phone call application is allowed;</li><li>if an instant messaging communication is initiated or received by the user and an IP-Session is opened by the BP;</li><li>if software or system updates are initiated by the user or authorized system services, and an IP-Session is opened by the BP.</li></ul></p><p id="p0055" num="0055">In a possible embodiment of the mobile terminal a correlation is defined being likely unsecure for one or more of the following:
<ul><li>if a phone call is ongoing while no phone call is made or accepted by the phone call application or telephony application;</li><li>if the microphone is active and a phone call is ongoing over the BP while no phone call is made accepted by the phone call application or telephony application;</li><li>if the microphone is assigned to an application that is not allowed to have access to the microphone and which transfers data over the BP as a phone call or a IP-Session;</li><li>if the mobile device is an idle or sleep mode, while large amount of data from the storage device of the phone is transferred over a IP-session opened by the BP;</li><li>if the actual power consumption is larger than the displayed power consumption and a IP-session is opened by the BP to transfer data;</li><li>if the actual power differs from the expected power consumption and a IP-session or phone calls is ongoing over the BP:</li></ul></p><p id="p0056" num="0056">In a possible embodiment of the mobile terminal the correlation engine is configured to define and maintain pattern of secure and unsecure states, which are then matched against the currently present data by mathematical correlation methods, including but not limited to neural networks and statistical deviation analysis.</p><p id="p0057" num="0057">In a possible embodiment of the mobile terminal a Power consumption is analyzed by mathematical subtraction of the area under the curve for battery discharge and If the area of the expected discharge curve as computed on<!-- EPO <DP n="13"> --> the base of application and operating system power usage deviates significantly from the actually measured discharge curve, the resulting area under the curve is large and a IP-session or phone calls is ongoing over the BP an alarm is triggred.</p><p id="p0058" num="0058">In a possible embodiment of the mobile terminal the correlation engine is configured to provide a user setting allowing the configuration of the sensitivity of the alarm and attack countermeasure routines, so the user is not overwhelmed by false alarms.<br/>
In a possible embodiment of the mobile terminal wherein in case of the alarm the BP is reset, the mobile device is reset or all connections are forced to be dropped.</p><p id="p0059" num="0059">Another aspect of the invention is a mobile device, that implements the above mentioned aspects. The Mobile device configured to detect an attack on a baseband processor comprising a baseband processor and an application processor, which may or may not be integrated in a single chip, comprising :
<ol><li>a) baseband monitor component configured to monitor the behavior of the baseband processor by using features available on the respective mobile device.</li><li>b) application monitor component configured to monitor the behavior of the application processor by keeping a record of the parameters, execution time or execution duration of legitimate software or user activities on the application processor that cause normal baseband activities as intended by the user;</li><li>c) evaluator component configured to correlate the baseband processor behavior with application processor behavior in order to distinguish between legitimate and suspicious/illegitimate baseband activities,</li><li>d) defense component configured to initiate component of countermeasures designed to ward off the suspicious/illegitimate baseband activities.</li></ol>
The other possible configurations of the mobile device which are described in the appended claims implement the method above.</p><p id="p0060" num="0060">It has to be noted, that the components mentioned above can be software or hardware, in case of software they run on the application processors or on the baseband processor or partially on both.<br/>
Also the applications can run on the BP or AP, or partially on the AP or BP, can be implemented in hardware or software or a combination thereof.</p><p id="p0061" num="0061">The invention consists in a possible configuration of the following components:</p><p id="p0062" num="0062">One component is a Baseband-Monitor that observes the behavior of the baseband. It uses all means available to determine the current behavior of the Baseband Processor (BP). The Baseband-Monitor is an application which preferable runs as application on the application processor (AP). It is also possible that parts of the Baseband-Monitor runs as application on the BP. Baseband-Monitor in the preferred embodiment uses the<!-- EPO <DP n="14"> --> interfaces and functions the of the BP, which are provide by in the standard configuration. The information and the interfaces available differs depending on capabilities of the baseband processor and interfaces made available on a specific phone model/mobile terminal and includes but is not limited to:
<ul><li>1. Information from the baseband CPU about opening and closing of transmission channels to and from a base station</li><li>2. Information from the baseband CPU about protocol transmissions to and from the base station</li><li>3. Information from the baseband CPU about the volume of data transmission<br/>
Further the Baseband-Monitor</li><li>4. Monitors and records the power consumption of phone components (as available)</li><li>5. Records the current and voltage delivered by the battery to the phone.</li><li>6. Monitors the audio path configuration (e.g. which component is using the microphone)</li><li>7. Measures response times to normal service requests from application CPU(AP) to baseband CPU (BP)</li></ul></p><p id="p0063" num="0063">Using these data points the Baseband-Monitor provides a rich set of information on the current activities of the baseband. The level of detail depends on the availability of data sources in the specific phone model. Not all data sources are usually available on all phone models.</p><p id="p0064" num="0064">The other component of the invention in the possible configuration of two components is a monitoring and alerting component that observes the parameters, time and duration of legitimate software and user activities on the application CPU that cause normal Baseband activities intended by the user. Under normal circumstances, most Baseband activities with some known exceptions are correlated with user interaction, like making a call or loading a web page, or known-to-be-good automated application activity, like checking e-mail. Application use of baseband ressources is monitored on the AP by various means like hooking or replacing the respective "provider" functions in the operating system that manage the communication with the baseband. This analyses can also be performed by checking the network traffic for example by sniffing the ports and the IP-packages, or by using proxies which are located between the applications and the baseband. Also the communication between the AP and BP can be monitored by reading the shared memory which is normally used for an information exchange between the two units. Also the activity for example the processor using of the applications can be monitored to detect if the application is very active or suspended. So the information of the process scheduler in the operating system can provide information. Also the event table of the operating system can be check and verified. In the event table the applications running on the AP give a feedback of the actions and errors and warnings. Also a monitoring on the AP can be given by tracking the use of a user interface like a keyboard or a touch screen. For example if a SMS has been send by an application without a detection of a user input a security problem can be given. The same situation can be determined if the mobile terminal is in a standby mode and a SMS is sent or phone call is performed. The monitoring application on the AP collects this information and stores<!-- EPO <DP n="15"> --> the information over a defined time period in a database. The storing and collecting of the information is done in defined time intervals or driven by events like interrupts. Each collected information has in a possible implementation a time stamp which allows finding a time correlation. Furthermore the information can be categorized which allows the implementation of general concepts and rules on the categories.</p><p id="p0065" num="0065">The mechanism then correlates the data from the Baseband monitoring (described above) and the data from the application CPU monitoring to distinguish between legitimate and suspicious Baseband activities. Suspicious are activities that cause transmissions or resource consumption on the Baseband but are not correlated to legitimate user activities.<br/>
One very simple example is that if the Baseband is detected by the monitoring component to have an active call ongoing while no phone call is made or accepted by the telephony software, very likely this is the result of an attack.</p><p id="p0066" num="0066">The correlation engine of the invention builds a pattern of "normality" that is then matched against the currently present data by mathematical correlation methods, including but not limited to neural networks and statistical deviation analysis etc. A simple example is the analysis of the battery discharge curve while taking into account the power usage of applications and sensors as provided by the operating system or seperate readout of power consumption data from respective phone sensors. If the actual discharge curve deviates from the expected precalculated discharge curve, malicious baseband activitiy is suspected. These statistical concepts are well known so that a further discussion can be omitted. Also logical dependencies can be expressed by definable expression, using conditional expression and logical conjunctions etc.. The detection of ongoing suspicious baseband activity can rely on one or a combination of data sources on Baseband and application CPU. Specific user usage patterns are taken into account by an adaption mechanism built into the correlation engine. A user setting is provided to allow for a configuration of the sensitivity of the alarm and attack countermeasure routines, so the user is not overwhelmed by false alarms.</p><p id="p0067" num="0067">In the most simple case when very little data is available to the Baseband Monitor, the battery current and voltage measurement is used to check for a deviation from the expected power consumption. An ongoing attack that would e.g. use the baseband to transmit room audio to the attacker by means of a surreptitious call or periodic data transmissions would cause a deviation between power consumption actually measured at the battery and the expected consumption computed from the phones power profile.</p><p id="p0068" num="0068">When suspicious activity is detected in the form of deviation between expected and actual power use, open channels to the base station, data transmission, audio circuit configuration, response times etc. countermeasures can be taken for instance but not limited to resetting the baseband, resetting the phone, forcing all connections to be dropped and / or alerting the phones user.<!-- EPO <DP n="16"> --></p><heading id="h0004"><b><u>Brief Description of Drawinas</u></b></heading><p id="p0069" num="0069">The Figures show examples of possible implementations but do not intend to limit the application on these embodiments. Consequently the scope of protection has to be determined by the broadest interpretation of the claims.
<ul><li><figref idrefs="f0001">Fig. 1</figref> shows a structure of components and their connection;</li><li><figref idrefs="f0002">Fig. 2</figref> shows the flow diagram of the method AP monitor application;</li><li><figref idrefs="f0002">Fig. 3</figref> shows the flow diagram of the method BP monitor application;</li><li><figref idrefs="f0002">Fig. 4</figref> shows the flow diagram of the method correlation engine;</li></ul></p><heading id="h0005"><b><u>Detailed Description of Embodiments</u></b></heading><p id="p0070" num="0070"><ul><li><figref idrefs="f0001">Fig. 1</figref> disclosss a structure of a mobile device with a BP running an operating system OS and with an AP running an OS. On the OS of the AP an application monitor application is running which implements the collection of information. Furthermore the baseband monitor application is running on the AP collecting information. The information are used by a correlation engine application which has access to the collected information. A memory controller MC is controlled by a firmware / program. The MC is connected to the memory and controls a memory that is logical divided into shared memory, AP memory and BP memory. The logical separation is provided by the memory controller and the firmware. The memory controller is connected to the BP and AP.</li><li><figref idrefs="f0002">Fig. 2</figref> shows a flow diagram of the application monitor that collects specific data and stores the date in a database. The data can be collected cyclic or event driven. <figref idrefs="f0002">Fig.3</figref> shows a flow diagram of the baseband monitor application that collects specific data and stores the date in a database. The data can be collected cyclic or event driven. <figref idrefs="f0002">Fig. 4</figref> shows a flow diagram of the correlation that has access to the database and reads the information to find unsecure patterns by finding the unsecure correlation. In case of finding a unsecure correlation an alarm is triggered.</li></ul></p></description><claims mxw-id="PCLM56976465" lang="EN" load-source="patent-office"><!-- EPO <DP n="17"> --><claim id="c-en-0001" num="0001"><claim-text>Method for detecting an attack on a baseband processor of a mobile device which comprises the baseband processor and an application processor, which may or may not be integrated in a single chip, comprising the steps:
<claim-text>a) monitoring by a baseband monitor component the behavior of the baseband processor by using features available on the respective mobile device,</claim-text>
<claim-text>b) monitoring by an application monitor component the behavior of the application processor by keeping a record of the parameters, execution time or execution duration of legitimate software or user activities on the application processor that cause normal baseband activities as intended by the user,</claim-text>
<claim-text>c) correlating by an evaluator component the baseband processor behavior with application processor behavior in order to distinguish between legitimate and suspicious/illegitimate baseband activities,</claim-text>
<claim-text>d) initiation by a defense component of countermeasures designed to ward off the suspicious/illegitimate baseband activities.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The method according to claim 1, wherein the initiation of countermeasures designed to ward off the suspicious/illegitimate baseband activities comprises one or more of the following: resetting the baseband processor, resetting the phone, forcing all connections to be dropped.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The method according to claim 1 or 2, wherein the monitoring by the baseband monitor comprises one or more of the following:
<claim-text>- collecting information on power consumption of individual hardware components of the mobile device,</claim-text>
<claim-text>- collecting information on audio path configuration,</claim-text>
<claim-text>- collecting information on the response time to normal service requests from the application processor to the baseband processor;</claim-text>
<claim-text>- monitoring of communication interfaces or memory areas shared between application processor and baseband processor for atypical communication patterns,</claim-text>
<claim-text>- monitoring of communication interfaces and memory areas shared between application processor and baseband for patterns associated with exploit attempts,</claim-text>
<claim-text>- collecting information obtained from the baseband processor's debugging output and preferably wherein the monitoring of communication interfaces or memory areas shared between application processor and baseband for patterns associated with exploit attempts, comprises one or<!-- EPO <DP n="18"> --> more of the following:</claim-text>
<claim-text>- Monitoring malformated messages or data structures or very large data blocks;</claim-text>
<claim-text>- Monitoring the usage of procedures, functions, features or messages not seen in normal operations;</claim-text>
<claim-text>- Monitoring attempts to access memory areas not consistent with normal operations.</claim-text>
and preferably wherein the collecting of information obtained from the baseband processor's debugging output comprises one or more of the following:
<claim-text>timing and volume of voice call setup,</claim-text>
<claim-text>timing and volume of data transmission,</claim-text>
<claim-text>timing and volume of SMS message transmission,</claim-text>
<claim-text>timing and sequence of establishment of traffic channels.</claim-text></claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>Method according to any of the claims 1 to 3, wherein the evaluator component flags the absence of standard A5/1, A5/2, or A5/3 link encryption on GSM or 3G/UMTS/W-CDMA mobile networks which leads the defense component to issue a warning to the mobile device's user that link encryption has been deactivated.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>Method according to any of the claims 1 to 4, wherein the evaluator component flags the presence of a rogue base station that does not belong to the legitimate mobile network and the defense component warning the mobile device's user that a rogue base station (a so-called "IMSI catcher") has been detected and/or the defense component shutting down the baseband processor in order to prevent exploitation,<br/>
and preferably wherein the evaluator component flags the presence of a rogue base station that does not belong to the legitimate mobile network using one or more of the following information:
<claim-text>- cell identification, distance, and signal strength,</claim-text>
<claim-text>- signal growth/attenuation,</claim-text>
<claim-text>- forced network change from 3G to 2G network,</claim-text>
<claim-text>- unusual changes in the list of neighboring cells,</claim-text>
<claim-text>- unusual configuration parameters of the mobile base -station designed to make it appear more 'attractive' to the targeted mobile device(s),</claim-text>
<claim-text>- network parameters not consistent with the mobile device's location and/or the currently selected mobile network operator</claim-text></claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>Method according to any of the claims 1 to 5, wherein the evaluator component categorizes activities on the baseband processor in different classes ranging from normal/inconspicious to highly suspicious,<br/>
and preferably wherein the evaluator is plotting all the events in a diagram that shows baseband activity<!-- EPO <DP n="19"> --> and suspectedness of baseband activities over time and that is displayed on either the mobile device's screen or an external display device,<br/>
and preferably, wherein the evaluator component compiles the information on suspectedness of baseband activities over time in one single integrated graphical representation of the overall threat level in respect to the mobile device's baseband processor or in the form of a 'threat level thermometer' that is displayed on either the mobile device's screen or an external display device.</claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>Method according to any of the claims 1 to 6, wherein the evaluator component records baseband activity in a log file that can subsequently be read and combined with log files from other mobile devices by the reporter component in order to arrive at an overview of the aggregated threat level to which multiple mobile devices are subject to.</claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>Method according to any of the claims 1 to 7, wherein the evaluator component transmits data on baseband activity and network parameters to a remote reporter entity which performs additional location-based analytics to determine the locations of hostile networks.<br/>
and preferably wherein the reporter remote analytics entity sends out warnings and configuration changes to mobile devices in respect to detected hostile network activity.<br/>
and preferably wherein the reporter remote analytics entity sends out warnings about hostile network activity to dedicated connected devices which are mounted as stationary sensors in sensitive areas for the primary purpose of informing users who do not have the baseband monitor component installed on their mobile devices about ongoing suspicious/illegitimate activities.</claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>Mobile device configured to detect an attack on a baseband processor comprising a baseband processor and an application processor, which may or may not be integrated in a single chip, comprising :
<claim-text>a) baseband monitor component configured to monitor the behavior of the baseband processor by using features available on the respective mobile device,</claim-text>
<claim-text>b) application monitor component configured to monitor the behavior of the application processor by keeping a record of the parameters, execution time or execution duration of legitimate software or user activities on the application processor that cause normal baseband activities as intended by the user;</claim-text>
<claim-text>c) evaluator component configured to correlate the baseband processor behavior with application processor behavior in order to distinguish between legitimate and suspicious/illegitimate baseband activities,</claim-text>
<claim-text>d) defense component configured to initiate component of countermeasures designed to ward off the suspicious/illegitimate baseband activities.</claim-text></claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>Mobile device according to claim 9, wherein the defense component is configured to initiate countermeasures<!-- EPO <DP n="20"> --> designed to ward off the suspicious/legitimate baseband activities comprises one or more of the following: resetting the baseband processor, resetting the phone, forcing all connections to be dropped.</claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>Mobile device according to claim 9 or 10, wherein the baseband monitor component is configured to implement one or more of the following:
<claim-text>- collecting information on power consumption of individual hardware components of the mobile device,</claim-text>
<claim-text>- collecting information on audio path configuration,</claim-text>
<claim-text>- collecting information on the response time to normal service requests from the application processor to the baseband processor;</claim-text>
<claim-text>- monitoring of communication interfaces or memory areas shared between application processor and baseband processor for atypical communication patterns,</claim-text>
<claim-text>- monitoring of communication interfaces and memory areas shared between application processor and baseband for patterns associated with exploit attempts,</claim-text>
<claim-text>- collecting information obtained from the baseband processor's debugging output; and preferably wherein the monitoring of communication interfaces or memory areas shared between application processor and baseband for patterns associated with exploit attempts, comprises one or more of the following:</claim-text>
<claim-text>- Monitoring malformated messages or data structures or very large data blocks;</claim-text>
<claim-text>- Monitoring the usage of procedures, functions, features or messages not seen in normal operations;</claim-text>
<claim-text>- Monitoring attempts to access memory areas not consistent with normal operations;</claim-text>
and preferably wherein the collecting of information obtained from the baseband processor's debugging output comprises one or more of the following:
<claim-text>timing and volume of voice call setup,</claim-text>
<claim-text>timing and volume of data transmission,</claim-text>
<claim-text>timing and volume of SMS message transmission,</claim-text>
<claim-text>timing and sequence of establishment of traffic channels.</claim-text></claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>Mobile device according to any of the claims 9 to 11, wherein the evaluator component is configured to flag the absence of standard A5/1, A5/2, or A5/3 link encryption on GSM or 3G/UMTS/W-CDMA mobile networks which leads the defense component to issue a warning to the mobile device's user that link encryption has been deactivated.<!-- EPO <DP n="21"> --></claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>Mobile device according to any of the claims 9 to 12, wherein the evaluator component is configured to flag the presence of a rogue base station that does not belong to the legitimate mobile network and the defense component warning the mobile device's user that a rogue base station (a so-called "IMSI catcher") has been detected and/or the defense component shutting down the baseband processor in order to prevent exploitation;<br/>
and preferably wherein the evaluator component is configured to flag the presence of a rogue base station that does not belong to the legitimate mobile network using one or more of the following information:
<claim-text>- cell identification, distance, and signal strength,</claim-text>
<claim-text>- signal growth/attenuation,</claim-text>
<claim-text>- forced network change from 3G to 2G network,</claim-text>
<claim-text>- unusual changes in the list of neighboring cells,</claim-text>
<claim-text>- unusual configuration parameters of the mobile base -station designed to make it appear more 'attractive' to the targeted mobile device(s),</claim-text>
<claim-text>- network parameters not consistent with the mobile device's location and/or the currently selected mobile network operator</claim-text></claim-text></claim><claim id="c-en-0014" num="0014"><claim-text>Mobile device according to any of the claims 9 to 13, wherein the evaluator component is configured to categorizes activities on the baseband processor in different classes ranging from normal/inconspicious to highly suspicious,<br/>
and preferably wherein the evaluator is configured to plot all the events in a diagram that shows baseband activity and suspectedness of baseband activities over time and that is displayed on either the mobile device's screen or an external display device.<br/>
and preferably wherein the evaluator component is configured to compile the information on suspectedness of baseband activities over time in one single integrated graphical representation of the overall threat level in respect to the mobile device's baseband processor or in the form of a 'threat level thermometer' that is displayed on either the mobile device's screen or an external display device.</claim-text></claim><claim id="c-en-0015" num="0015"><claim-text>Mobile device according to any of the claims 9 to 14, wherein the evaluator component is configured to record baseband activity in a log file that can subsequently be read and combined with log files from other mobile devices by the reporter component in order to arrive at an overview of the aggregated threat level to which multiple mobile devices are subject to.</claim-text></claim><claim id="c-en-0016" num="0016"><claim-text>Mobile device according to any of the claims 9 to 15, wherein the evaluator component is configured to transmit data on baseband activity and network parameters to a remote reporter entity which performs additional location-based analytics to determine the locations of hostile networks.<br/>
and preferably wherein the reporter remote analytics entity is configured to send out warnings and configuration<!-- EPO <DP n="22"> --> changes to mobile devices in respect to detected hostile network activity.<br/>
and preferably wherein the reporter remote analytics entity is configured to send out warnings about hostile network activity to dedicated connected devices which are mounted as stationary sensors in sensitive areas for the primary purpose of informing users who do not have the baseband monitor component installed on their mobile devices about ongoing suspicious/illegitimate activities.</claim-text></claim></claims><drawings mxw-id="PDW16667245" load-source="patent-office"><!-- EPO <DP n="23"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="155" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="24"> --><figure id="f0002" num="2,3,4"><img id="if0002" file="imgf0002.tif" wi="164" he="233" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="157" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="157" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
