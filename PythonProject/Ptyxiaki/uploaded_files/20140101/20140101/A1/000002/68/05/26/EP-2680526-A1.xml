<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2680526-A1" country="EP" doc-number="2680526" kind="A1" date="20140101" family-id="47598629" file-reference-id="298574" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146549162" ucid="EP-2680526-A1"><document-id><country>EP</country><doc-number>2680526</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12197346-A" is-representative="YES"><document-id mxw-id="PAPP154823085" load-source="docdb" format="epo"><country>EP</country><doc-number>12197346</doc-number><kind>A</kind><date>20121214</date><lang>EN</lang></document-id><document-id mxw-id="PAPP197861066" load-source="docdb" format="original"><country>EP</country><doc-number>12197346.5</doc-number><date>20121214</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140453289" ucid="US-201261664725-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>201261664725</doc-number><kind>P</kind><date>20120626</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988112446" load-source="docdb">H04W  12/08        20090101ALI20130322BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988115615" load-source="docdb">H04L  29/06        20060101AFI20130322BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1687189775" load-source="docdb" scheme="CPC">H04W   4/80        20180201 LA20180219BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1824866334" load-source="docdb" scheme="CPC">H04L  63/061       20130101 LI20170411BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1824866335" load-source="docdb" scheme="CPC">H04L  63/0435      20130101 LA20170411BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1824866336" load-source="docdb" scheme="CPC">H04L  63/101       20130101 LI20170411BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988117581" load-source="docdb" scheme="CPC">H04W  12/08        20130101 LI20130321BHEP        </classification-cpc><classification-cpc mxw-id="PCL1991312141" load-source="docdb" scheme="CPC">H04L  63/0492      20130101 LI20140106BHEP        </classification-cpc><classification-cpc mxw-id="PCL1991312360" load-source="docdb" scheme="CPC">H04W  12/04        20130101 FI20131219BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132179970" lang="DE" load-source="patent-office">Verfahren und Vorrichtungen zur Herstellung von Vertrauen bei der ersten Verwendung von Näherungskommunikationen</invention-title><invention-title mxw-id="PT132179971" lang="EN" load-source="patent-office">Methods and devices for establishing trust on first use for close proximity communications</invention-title><invention-title mxw-id="PT132179972" lang="FR" load-source="patent-office">Procédés et dispositifs pour établir une confiance sur une première utilisation pour des communications de proximité immédiate</invention-title><citations><patent-citations><patcit mxw-id="PCIT376756183" load-source="docdb" ucid="EP-2239918-A1"><document-id format="epo"><country>EP</country><doc-number>2239918</doc-number><kind>A1</kind><date>20101013</date></document-id><sources><source name="SEA" category="XA" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242651982" load-source="docdb" ucid="US-20110255692-A1"><document-id format="epo"><country>US</country><doc-number>20110255692</doc-number><kind>A1</kind><date>20111020</date></document-id><sources><source name="SEA" category="X" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT376756184" load-source="docdb" ucid="WO-2012167200-A1"><document-id format="epo"><country>WO</country><doc-number>2012167200</doc-number><kind>A1</kind><date>20121206</date></document-id><sources><source name="SEA" category="XP" created-by-npl="N"/></sources></patcit></patent-citations><non-patent-citations><nplcit><text>None</text><sources><source mxw-id="PNPL45130776" load-source="docdb" name="APP"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR918154565" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>CERTICOM CORP</last-name><address><country>CA</country></address></addressbook></applicant><applicant mxw-id="PPAR918164373" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>CERTICOM CORP.</last-name></addressbook></applicant><applicant mxw-id="PPAR918985900" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Certicom Corp.</last-name><iid>101263463</iid><address><street>4701 Tahoe Boulevard Tahoe A, 6th Floor</street><city>Mississauga, Ontario L4W 0B5</city><country>CA</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918158124" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ROSATI ANTHONY</last-name><address><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918157889" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>Rosati, Anthony</last-name></addressbook></inventor><inventor mxw-id="PPAR918979951" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Rosati, Anthony</last-name><address><street>54 Rosedale Ave.</street><city>Ottawa, Ontario K1S 4T5</city><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918140675" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>CAMPAGNA MATTHEW JOHN</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918154438" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>Campagna, Matthew John</last-name></addressbook></inventor><inventor mxw-id="PPAR918979623" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>Campagna, Matthew John</last-name><address><street>264 Old Sib Road</street><city>Ridgefield, CT 06877</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918149133" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>ZAVERUCHA GREGORY MARC</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918165227" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>Zaverucha, Gregory Marc</last-name></addressbook></inventor><inventor mxw-id="PPAR918979869" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>Zaverucha, Gregory Marc</last-name><address><street>4604 170th PL NE</street><city>Redmond, WA 98052</city><country>US</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918987886" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Noble, Nicholas</last-name><suffix>et al</suffix><iid>101231519</iid><address><street>Kilburn &amp; Strode LLP Electronics 20 Red Lion Street</street><city>London WC1R 4PJ</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS548846894" load-source="docdb">AL</country><country mxw-id="DS548850581" load-source="docdb">AT</country><country mxw-id="DS548846896" load-source="docdb">BE</country><country mxw-id="DS548802648" load-source="docdb">BG</country><country mxw-id="DS548867123" load-source="docdb">CH</country><country mxw-id="DS548837130" load-source="docdb">CY</country><country mxw-id="DS548850582" load-source="docdb">CZ</country><country mxw-id="DS548846962" load-source="docdb">DE</country><country mxw-id="DS548846897" load-source="docdb">DK</country><country mxw-id="DS548837131" load-source="docdb">EE</country><country mxw-id="DS548853151" load-source="docdb">ES</country><country mxw-id="DS548802649" load-source="docdb">FI</country><country mxw-id="DS548802654" load-source="docdb">FR</country><country mxw-id="DS548846963" load-source="docdb">GB</country><country mxw-id="DS548846898" load-source="docdb">GR</country><country mxw-id="DS548846899" load-source="docdb">HR</country><country mxw-id="DS548837132" load-source="docdb">HU</country><country mxw-id="DS548867124" load-source="docdb">IE</country><country mxw-id="DS548846900" load-source="docdb">IS</country><country mxw-id="DS548802655" load-source="docdb">IT</country><country mxw-id="DS548837133" load-source="docdb">LI</country><country mxw-id="DS548846964" load-source="docdb">LT</country><country mxw-id="DS548850583" load-source="docdb">LU</country><country mxw-id="DS548846965" load-source="docdb">LV</country><country mxw-id="DS548846966" load-source="docdb">MC</country><country mxw-id="DS548801648" load-source="docdb">MK</country><country mxw-id="DS548801649" load-source="docdb">MT</country><country mxw-id="DS548846901" load-source="docdb">NL</country><country mxw-id="DS548802656" load-source="docdb">NO</country><country mxw-id="DS548846902" load-source="docdb">PL</country><country mxw-id="DS548802657" load-source="docdb">PT</country><country mxw-id="DS548846903" load-source="docdb">RO</country><country mxw-id="DS548802662" load-source="docdb">RS</country><country mxw-id="DS548846904" load-source="docdb">SE</country><country mxw-id="DS548867125" load-source="docdb">SI</country><country mxw-id="DS548846968" load-source="docdb">SK</country><country mxw-id="DS548846969" load-source="docdb">SM</country><country mxw-id="DS548837138" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128669832" lang="EN" load-source="patent-office"><p id="pa01" num="0001">Methods and devices for establishing trust on first use for close proximity communications are disclosed. An example method includes establishing a close proximity communications connection with a device, receiving a public key from the device via the close proximity communications connection, obtaining, via a user interface, an indication that the device is trusted, and storing at least one of the public key or an identifier for the device.
<img id="iaf01" file="imgaf001.tif" wi="131" he="107" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128499205" lang="EN" source="EPO" load-source="docdb"><p>Methods and devices for establishing trust on first use for close proximity communications are disclosed. An example method includes establishing a close proximity communications connection with a device, receiving a public key from the device via the close proximity communications connection, obtaining, via a user interface, an indication that the device is trusted, and storing at least one of the public key or an identifier for the device.</p></abstract><description mxw-id="PDES63955262" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001">RELATED APPLICATIONS</heading><p id="p0001" num="0001">This patent claims priority to <patcit id="pcit0001" dnum="US61664725A"><text>U.S. Provisional Application No. 61/664,725, filed on June 26, 2012</text></patcit>, the entirety of which is hereby incorporated by reference.</p><heading id="h0002">FIELD OF THE DISCLOSURE</heading><p id="p0002" num="0002">This disclosure relates generally to close-proximity communications and, more particularly, to methods and devices for establishing trust on first use for close proximity communications.</p><heading id="h0003">BACKGROUND</heading><p id="p0003" num="0003">Close-proximity communications, such as near field communications, enable convenient transfers of data by bringing devices into proximity. Transferrable data may include contact information such as phone numbers and addresses, media such as photos or songs, and other information such as web links or web pages.</p><heading id="h0004">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p0004" num="0004"><figref idrefs="f0001">FIG. 1</figref> is a block diagram of an example system for establishing trust on first use for near field communications.</p><p id="p0005" num="0005"><figref idrefs="f0001">FIG. 2</figref> is a diagram of an example mobile device for use in the system of <figref idrefs="f0001">FIG. 1</figref>.</p><p id="p0006" num="0006"><figref idrefs="f0002">FIG. 3</figref> illustrates a known process for establishing near field communications.</p><p id="p0007" num="0007"><figref idrefs="f0002">FIG. 4</figref> illustrates a man-in-the-middle attack by which the security of the process of <figref idrefs="f0002">FIG. 3</figref> may be compromised.</p><p id="p0008" num="0008"><figref idrefs="f0003">FIG. 5</figref> illustrates an example process for establishing trust on first use for near field communications.<!-- EPO <DP n="2"> --></p><p id="p0009" num="0009"><figref idrefs="f0003">FIG. 6</figref> illustrates an example user interface for verifying that a mobile device is trusted.</p><p id="p0010" num="0010"><figref idrefs="f0004">FIG. 7</figref> is a flowchart representative of an example method to establish trust on first use for near field communications.</p><p id="p0011" num="0011"><figref idrefs="f0004">FIG. 8</figref> is a flowchart representative of an example method to establish near field communications after trust has been established between two devices.</p><p id="p0012" num="0012"><figref idrefs="f0005">FIG. 9</figref> is a flowcharts representative of another example method to establish near field communications after trust has been established between two devices.</p><p id="p0013" num="0013"><figref idrefs="f0006">FIG. 10</figref> is a flowchart representative of an example method to send and receive trusted connections to and from a server.</p><p id="p0014" num="0014"><figref idrefs="f0007">FIG. 11</figref> illustrates an example process for establishing trust for near field communications.</p><p id="p0015" num="0015"><figref idrefs="f0008">FIG. 12</figref> is a flowchart representative of another example method to establish trust on first use for near field communications.</p><p id="p0016" num="0016"><figref idrefs="f0008">FIG. 13</figref> is a flowchart representative of another example method to establish near field communications after trust has been established between two devices.</p><heading id="h0005">DETAILED DESCRIPTION</heading><p id="p0017" num="0017">Example methods and devices for establishing trust on first use (TOFU) for close proximity communications, are disclosed herein. In some examples, two users, having respective mobile devices, seek to establish a secure NFC connection between their mobile devices. The users "tap" their devices together (e.g., bring the devices into close proximity or make actual contact), at which time their devices exchange respective keys. Each of the example mobile devices then requests (e.g., via a user interface) that their respective users acknowledge or verify that the key or an identifier associated with the key is trusted. If the users acknowledge or verify the trust, each of the example mobile devices accepts the key<!-- EPO <DP n="3"> --> received from the other mobile device as trusted and stores the key, the identifier, and/or a shared key calculated using the received key. For subsequently establishing secure NFC connections between mobile devices that have established trust, the keys exchanged between the mobile devices are used to verify trust, such as by looking up the exchanged key(s) and/or retrieving the stored identifiers and/or the shared key. The shared key is then used to exchange data between the mobile devices without further verification by the user (although there may be user verification for specific types of data transactions to occur).</p><p id="p0018" num="0018">Disclosed example apparatus include a processor, a close proximity communications module coupled to the processor; and a memory coupled to the processor and storing instructions. When executed by the processor, the example instructions cause the processor to obtain, via a user interface, an indication that a device is trusted, and store at least one of a public key or an identifier for the device, the public key being received from the device via a close proximity communications connection.</p><p id="p0019" num="0019">In some examples, the instructions are to further cause the processor to obtain a shared key based on the public key, the public key being received from the device via a second close proximity communications connection. In some such examples, the instructions are to cause the processor to obtain the shared key based on the identifier. In some example apparatus, the instructions are to further cause the processor to obtain verification that the identifier is trusted.</p><p id="p0020" num="0020">In some example apparatus, the instructions are to further cause the processor to, prior to obtaining the shared key based on the public key, verify that the public key is trusted by performing a lookup of the public key in a storage. In some examples, storing at least one of the public key or the identifier comprises storing the public key in association with the identifier. In some example apparatus, the instructions are to further cause the processor to determine a shared key based on the public key in response to<!-- EPO <DP n="4"> --> obtaining the indication. In some example apparatus, the instructions are to further cause the processor to store a shared key in association with the at least one of the public key or the identifier.</p><p id="p0021" num="0021">In some examples, the instructions are to further cause the processor to obtain the identifier via the user interface. In some example apparatus, the instructions are to further cause the processor to obtain the identifier via the close proximity communications connection. In some examples, the instructions are to further cause the processor to send the at least one of the identifier or the public key to a server, and store at least one of a second identifier or a second public key received from the server, the at least one of the second identifier or the second public key corresponding to a second trusted device.</p><p id="p0022" num="0022">In some example apparatus, the instructions are to further cause the processor to store a first counter value associated with at least one of the identifier, a shared key, or the public key, compare the first counter value with a second counter value received from the device, perform a data transaction using the shared key based on the comparison, and store the second counter value received from the device. In some example apparatus, the close proximity communications connection comprises a near field communications connection. In some examples, the device comprises a mobile device.</p><p id="p0023" num="0023">Disclosed example methods include receiving a public key from a device via a close proximity communications connection, obtaining, via a user interface, an indication that the device is trusted, and storing at least one of the public key or an identifier for the device.</p><p id="p0024" num="0024">Some example methods further include receiving a public key from the device via a second close proximity communications connection, and obtaining a shared key based on the public key. In some such example methods obtaining the shared key is based on the identifier. Some such example methods further include obtaining verification that the<!-- EPO <DP n="5"> --> identifier is trusted. Some example methods include verifying, prior to obtaining the shared key based on the public key, that the public key is trusted by performing a lookup of the public key in a storage.</p><p id="p0025" num="0025">In some example methods, storing at least one of the public key or the identifier comprises storing the public key in association with the identifier. Some examples further include determining a shared key based on the public key in response to obtaining the indication. Some such example methods further include storing the shared key in association with the at least one of the public key or the identifier.</p><p id="p0026" num="0026">Some example methods further include obtaining the identifier via the user interface. Some example methods further include obtaining the identifier via the close proximity communications connection. Some examples further include sending the at least one of the identifier or the public key to a server, and receiving at least one of a second identifier or a second public key from the server, the at least one of the second identifier or the second public key corresponding to a second trusted device.</p><p id="p0027" num="0027">Some example methods further include storing a first counter value associated with at least one of the identifier, a shared key, or the public key, receiving a second counter value from the device, comparing the first and second counter values, performing a data transaction using the shared key based on the comparison, and storing the second counter value in association with the at least one of the identifier, the shared key, or the public key. In some examples, the close proximity communications connection comprises a near field communications connection. In some examples, the device comprises a mobile device.</p><p id="p0028" num="0028"><figref idrefs="f0001">FIG. 1</figref> is a block diagram of an example system 100 for establishing trust on first use for NFC communications. The example system 100 of <figref idrefs="f0001">FIG. 1</figref> includes two mobile devices 102, 104. The mobile devices 102, 104 may communicate with each other via<!-- EPO <DP n="6"> --> NFC communications as described in more detail below. In some examples, each of the mobile devices 102, 104 has a user (e.g., a primary user, a sole user, an owner, etc.). The users may use the example mobile devices 102, 104 to securely transfer data between the devices 102, 104. Depending on the functionality provided by the mobile devices 102, 104, the mobile devices 102, 104 may be any of a multiple-mode communication device configured for both data and voice communication, a mobile telephone, such as a smartphone, a wearable computer such as a watch, a tablet computer, a personal digital assistant (PDA), and/or a computer system such as a notebook, laptop or desktop system. The mobile devices 102, 104 may take other forms apart from those specifically listed above.</p><p id="p0029" num="0029">In some examples, the mobile devices 102, 104 establish a trust relationship on a first occasion or first use that the mobile devices 102, 104 are connected via NFC. As used herein, a trust relationship exists when both parties to an NFC transaction have verified that the other party is authentic (e.g., there is no attacker, such as a man-in-the-middle attacker). When a trust relationship is established between the mobile devices 102, 104, the example mobile device 102 may store a key, an identifier corresponding to the mobile device 104, and/or a shared key. Similarly, the example mobile device 104 stores a key, an identifier corresponding to the mobile device 102, and/or the shared key. When subsequently establishing NFC connections between the mobile devices 102, 104, the example mobile devices 102, 104 access the respective stored keys, identifiers and/or shared keys to determine that there is a trust relationship between the mobile devices 102, 104 and that the NFC connection is not subject to a man-in-the-middle attack.</p><p id="p0030" num="0030">As used herein, a public key refers to a non-secret key and a private key refers to a secret key. A shared key refers to a secret key known to the parties (e.g., devices) involved in a secure transaction.<!-- EPO <DP n="7"> --></p><p id="p0031" num="0031">The example system 100 of <figref idrefs="f0001">FIG. 1</figref> further includes a server 106. The example server 106 may be an enterprise server or any other type of communications server. The example server 106 communicates with the mobile devices 102, 104 via any type(s) of wired and/or wireless communication methods. In the example of <figref idrefs="f0001">FIG. 1</figref>, the server 106 receives identifiers from the mobile devices 102, 104. For example, the server 106 may backup and/or synchronize trust relationships (e.g., sets of identifiers and public keys) that the mobile devices 102, 104 have established between the mobile devices 102, 104 and/or with other mobile devices. In some examples, the trust relationships (e.g., sets of identifiers and public keys) received by the server 106 from the first mobile device 102 are associated with a unique identification of the user or owner of the first mobile device 102 (e.g., a Blackberry ID). If the user of the first mobile device 102 has or switches to using a second mobile device 108 (e.g., also capable of communicating via NFC) in association with the user's identification, the example server 106 of <figref idrefs="f0001">FIG. 1</figref> may provide the trust relationships associated with the user identification to the second mobile device 108. The shared key may then be calculated by the mobile device 108 upon receipt of the corresponding public key and identifier. In some examples, such as when there is a secure connection between the mobile devices 102, 108 and the server 106, the shared keys may also be included in the trust relationship with the sets of identifiers and public keys. The example second mobile device 108 may then establish secure NFC connections with the mobile device 104 without having to establish a new trust relationship at the time of the first NFC connection between the mobile devices 104 and 108. In some examples, the server 106 may be omitted and the mobile device 102 transfers trust relationships directly to the mobile device 108.</p><p id="p0032" num="0032">While the example system 100 of <figref idrefs="f0001">FIG. 1</figref> includes close proximity communications between mobile devices 102, 104, 108, the example system 100 may include other types of devices. Furthermore, the example system 100 may be used to establish trust<!-- EPO <DP n="8"> --> on first use for close proximity communications between types of devices other than mobile devices.</p><p id="p0033" num="0033">Block diagrams of apparatus and flowcharts representative of example processes that may be executed to implement some or all of the elements and devices described herein are described below and shown in the drawings. In these examples, the process represented by each flowchart may be implemented by one or more programs comprising machine readable instructions for execution by a processor or controller, such as shown in <figref idrefs="f0001">FIG. 2</figref>, and/or any other suitable device.</p><p id="p0034" num="0034">The one or more programs may be embodied in software or software instructions stored on a tangible storage medium such as, for example, a flash memory, a CD-ROM, a hard drive, a DVD, or a memory associated with a processor, but the entire program or programs and/or portions thereof could alternatively be executed by a device other than the microprocessor and/or embodied in firmware or dedicated hardware (e.g., implemented by an application specific integrated circuit (ASIC), a programmable logic device (PLD), a field programmable logic device (FPLD), discrete logic, etc.). For example, any one, some or all of the example mobile device components could be implemented by any combination of software, hardware, and/or firmware. Also, some or all of the methods represented by the flowcharts may be implemented manually. As used herein, the term tangible computer readable storage medium is expressly defined to include any type of computer readable storage.</p><p id="p0035" num="0035">Additionally or alternatively, the example methods described herein may be implemented using coded instructions (e.g., computer readable instructions) stored on a non-transitory computer readable medium such as a hard disk drive, a flash memory, a read-only memory, a compact disk, a digital versatile disk, a cache, a random-access memory and/or any other storage media in which information is stored for any duration (e.g., for extended<!-- EPO <DP n="9"> --> time periods, permanently, brief instances, for temporarily buffering, and/or for caching of the information). As used herein, the term non-transitory computer readable medium is expressly defined to include any type of computer readable medium.</p><p id="p0036" num="0036"><figref idrefs="f0001">FIG. 2</figref> is a diagram of an example mobile device 200 for use in the system 100 of <figref idrefs="f0001">FIG. 1</figref>. The example mobile device 200 may implement any of the mobile devices 102, 104, 108 of <figref idrefs="f0001">FIG. 1</figref>. The example mobile device 200 of <figref idrefs="f0001">FIG. 2</figref> includes a processor 202 that is connected to a close-proximity communication device, such as a close proximity communications module 204. In some examples, the close proximity communications module 204 is or includes an NFC module. The examples described below refer to the close proximity communications module 204 as an NFC module. However, other types of close proximity communications modules may implement the close proximity communications module 204.</p><p id="p0037" num="0037">The processor 202 may be implemented using any suitable microcontroller or microprocessor capable of executing instructions. Additionally, the processor 202 may include hardware implementations, such as application-specific integrated circuits (ASIC), programmable logic devices (PLDs), or any other suitable logic circuit(s) and/or device(s).</p><p id="p0038" num="0038">The NFC module 204 includes a memory 206 and an antenna 208. In one example, the NFC module 204 is implemented according to the International Standards Organization standard ISO 14443. Implementation according to other standards is possible. The memory 206 may store information related to the user of the mobile device 200, such as a public key for the mobile device 200 that may be transferred to another NFC-enabled communication device upon the NFC module 204 being interrogated. The information may be input into the memory 206 manually, via close-proximity communication (e.g., NFC), via scanning, or through any other suitable technique. In addition, the NFC module 204 may receive public keys or other authentication information (e.g., from other mobile devices).<!-- EPO <DP n="10"> --> The received public keys may be stored in the memory 206 of the NFC module 204 and/or in a storage 210 in the mobile device 200, and/or may be transferred to one or more data stores (e.g., the server 106 of <figref idrefs="f0001">FIG. 1</figref>) across a network. While the close-proximity communication device is described as being an NFC module 204, other types of close-proximity communication devices may be utilized instead of, or in addition to, the NFC module 204. In some examples, the NFC module 204 interfaces with the storage 210 and/or does not include the memory 206.</p><p id="p0039" num="0039">The NFC module 204 may store information (e.g., credentials) or may store pointers to information that may be retrieved over the network by the processor 202 via a Bluetooth interface 212 and/or via a network interface 214. In some examples, all of the information may be stored across a network, and/or the NFC module 204 may store information and may store pointers to information.</p><p id="p0040" num="0040">The network interface 214 may be implemented using any wired or wireless communication interface. For example, the network interface 214 may be implemented using an Ethernet connection, or any other wired connection. Alternatively, the network interface 214 may be implemented using a WiFi interface, a cellular modem, which may be a second generation (2G) and/or third generation (3G) and/or fourth generation (4G) cellular modem, or the like, and/or any other wireless network interface. Although shown as having a single network interface 214 the mobile device 102 may include several different network interfaces using one or more different wireless access technologies.</p><p id="p0041" num="0041">The example mobile device 200 of <figref idrefs="f0001">FIG. 2</figref> further includes a user interface 216. The example user interface 216 may include hardware and/or software to enable a user of the mobile device 200 to interface with the processor 202. For example, the user interface 216 may include a display screen and a keyboard and/or any other suitable input device, such as a touch-screen. The user interface 216 allows a user to receive information and/or<!-- EPO <DP n="11"> --> prompts, such as requests to verify that a mobile device to be paired is trusted, that are produced by the processor 202. The user interface 216 also enables the user to provide information, such as text, button selections, and/or any other suitable input, to the processor 202.</p><p id="p0042" num="0042">When the example mobile device 200 is to establish a secure NFC connection with another mobile device (e.g., the mobile device 104 of <figref idrefs="f0001">FIG. 1</figref>), the users of the mobile devices to be securely connected "tap" the mobile devices together. For example, the tap may include positioning the antennas 208 of the NFC modules 204 in adjacent positions (e.g., such that the mobile devices 200 touch or nearly touch). When the tap occurs, the NFC module 204 detects the opposite NFC module (e.g., of the mobile device 104). To establish the secure connection, the example NFC module 204 transmits a public key (e.g., public key A) to the other NFC module via the antenna 208. When a secure NFC connection has been established, the NFC module 204 transmits and receives data encrypted using a shared key.</p><p id="p0043" num="0043"><figref idrefs="f0002">FIG. 3</figref> illustrates a known process 300 for establishing near field communications. The process 300 uses the Diffie-Hellman key exchange method to exchange cryptographic keys according to the ECMA 386 specification. The process is performed by two mobile devices 302, 304 (e.g., the mobile devices 102, 104, 108, 200 of <figref idrefs="f0001">FIGS. 1</figref> and/or 2). Each of the mobile devices 302, 304 has a private key/public key pair 306 (e.g., a pair of keys including a public key and a private lcey). The devices 302, 304 exchange 308 the public key portions of the private key/public key pair. Using the received public key portion and their own respective private key portions, the mobile devices 302, 304 are then able to calculate 310 a common shared key Z. The common shared key Z is then used to exchange encrypted data.<!-- EPO <DP n="12"> --></p><p id="p0044" num="0044">The process 300 of <figref idrefs="f0002">FIG. 3</figref> is potentially vulnerable to a man-in-the-middle attack. <figref idrefs="f0002">FIG. 4</figref> illustrates a man-in-the-middle (MITM) attack 400 by which the security of the process of <figref idrefs="f0002">FIG. 3</figref> may be compromised. In addition to the mobile devices 302, 304 of <figref idrefs="f0002">FIG. 3</figref>, the process of <figref idrefs="f0002">FIG. 4</figref> further includes a MITM attacker 402. The attacker 402 is capable of communicating with both mobile devices 302, 304. The mobile devices 302, 304 and the attacker 402 each have a private key/public key pair 404.</p><p id="p0045" num="0045">The attacker 402 performs the MITM attack by intercepting 406 the transmissions of the public keys Q<sub>A</sub> and Q<sub>B</sub> between the mobile devices 302, 304, and substituting the attacker's key Q<sub>E</sub> for the public keys of the mobile devices 302, 304. After the exchange, the mobile devices 302, 304 do not share a common key (Z). Instead, the mobile device 302 shares a common key Z' with the attacker 402, while the mobile device 304 shares a different common key Z" with the attacker 402. While both mobile devices 302, 304 believe that they are communicating securely with each other, they are in fact both communicating securely with the attacker 402. The attacker 402 can now monitor or modify communications as desired.</p><p id="p0046" num="0046"><figref idrefs="f0003">FIG. 5</figref> illustrates an example process 500 for establishing trust for near field communications. The example process 500 is performed by the two example mobile devices 102, 104 of <figref idrefs="f0001">FIG. 1</figref> when the mobile devices 102, 104 are "tapped" together (e.g., when NFC communications or any other close-proximity communications are established).</p><p id="p0047" num="0047">Each of the example mobile devices 102, 104 has a private key/public key pair 502. The devices 102, 104 exchange 504 the public key portions of the private key/public key pair. After exchanging the public keys, each of the example mobile devices 102, 104 obtains verification 506 (e.g., from their respective users, via user interfaces of the mobile devices 102, 104) that the other mobile device 102, 104 is trusted. For example, the mobile device 102 prompts a user of the mobile device 102 to confirm that the other mobile<!-- EPO <DP n="13"> --> device 104, from which the mobile device 102 has received a public key, is trusted. For example, the mobile device 102 may display the name and/or other identifier of the user of the mobile device 104. The user may know that the other mobile device 104 is trusted because of the close-proximity nature of the NFC connection (e.g., she is standing next to the user of the device 104). Verification that the other mobile device is trusted may additionally or alternatively be accomplished using other methods.</p><p id="p0048" num="0048">When the users verify that the mobile devices 102, 104 are trusted, the example mobile devices 102, 104 assign identifiers to the public keys. For example, the mobile device 102 assigns an identifier B<sub>QB</sub> to the mobile device 104. The identifier B<sub>QB</sub> may be input by the user of the mobile device 102 and/or may be received from the mobile device 104 as a suggested identifier. Similarly, the example mobile device 104 assigns an identifier A<sub>QA</sub> to the mobile device 102. In some examples, the mobile devices 102, 104 exchange suggested identifiers when exchanging the public keys Q<sub>A</sub>, Q<sub>B</sub>. In some examples, the public keys Q<sub>A</sub>, Q<sub>B</sub>, or a derivative of the public keys Q<sub>A</sub>, Q<sub>B</sub>, is used as the identifiers.</p><p id="p0049" num="0049">The suggested identifiers may then be used when prompting the respective users to verify that the mobile devices are trusted. <figref idrefs="f0003">FIG. 6</figref> illustrates an example display interface 600 for verifying that a mobile device is trusted. The example display interface 600 may be implemented by the example user interface 216 of <figref idrefs="f0001">FIG. 2</figref> and/or the example mobile devices 102, 200 of <figref idrefs="f0001">FIGS. 1</figref> and/or 2. The display interface 600 displays a suggested identifier 602 for a mobile device (e.g., the mobile device 104). The example suggested identifier 602 includes a name of the user of the mobile device 104 (e.g., "Bob") and a unique identifier (e.g., a Blackberry user identifier, a personal identification number, a personal security number, "PIN: 123456," etc.). In the example of <figref idrefs="f0003">FIG. 6</figref>, the display interface 600 further displays a picture 604 received from the other mobile device 104 as a suggested identifier.<!-- EPO <DP n="14"> --></p><p id="p0050" num="0050">The example display interface 600 of <figref idrefs="f0003">FIG. 6</figref> further includes buttons 606, 608 to verify or deny that the other mobile device 104 is trusted. If the other mobile device 104 is trusted to the user, the example user may select the button 606 to verify that the mobile device 104 is trusted. Alternatively, if the user does not trust the other mobile device 104 (e.g., the suggested identity is incorrect, an NFC connection was not intended, etc.), the user may select the button 608 to cause the mobile device 102 to deny the NFC transaction.</p><p id="p0051" num="0051">Other methods of verifying that the mobile device 104 is trusted via a display interface may be used. For example, the users of the mobile devices 102, 104 may be prompted to enter a common identification number or other agreed-upon key.</p><p id="p0052" num="0052">Returning to the example of <figref idrefs="f0003">FIG. 5</figref>, assuming the users of the mobile devices 102, 104 have verified that the opposite mobile devices are trusted, the mobile devices 102, 104 assign 508 respective identifiers to the received public keys. For example, the mobile device 102 assigns an identifier B<sub>QB</sub> to the received public key Q<sub>B</sub> and the mobile device 104 assigns an identifier A<sub>QA</sub> to the received public key Q<sub>A</sub>. In some examples, the assigned identifiers A<sub>QA</sub> and/or B<sub>QB</sub> are suggested identifiers provided (e.g., exchanged) with the public keys.</p><p id="p0053" num="0053">The example mobile devices 102, 104 calculate 510 the shared key Z based on the exchanged public keys Q<sub>A</sub>, Q<sub>B</sub> and the respective private keys d<sub>A</sub>, d<sub>B</sub>. The example mobile devices 102, 104 then store 512 the shared key Z in association with the identifier associated with the opposite mobile device 102, 104. For example, the mobile device 102 stores the shared key Z and the identifier B<sub>QB</sub>. The stored key and the identifier may then be used for subsequent secure NFC connections between the mobile devices 102, 104. Additionally or alternatively, the stored key and the identifier may be used between the mobile device 102 and another mobile device associated with the user of the mobile device 104.<!-- EPO <DP n="15"> --></p><p id="p0054" num="0054">A subsequent secure NFC connection process 514 may be used between the two mobile devices 102, 104 that have previously established a secure NFC connection according to the example process 500. Unlike prior art processes, the secure NFC connection process 514 reduces (e.g., prevents) the possibility of a man-in-the-middle attack between the mobile devices 102, 104. The example subsequent secure NFC connection process 514 may be performed when the mobile devices 102, 104 are tapped together.</p><p id="p0055" num="0055">Each of the example mobile devices 102, 104 has a private key/public key pair 516. The devices 102, 104 exchange 518 the public key portions of the private key/public key pair. The example mobile devices 102, 104 look up 520 the identifiers (e.g., stored during the first secure NFC transaction) based on the received public key. For example, the mobile device 102 looks up the identifier B<sub>QB</sub> based on the public key Q<sub>B</sub>. Similarly, the mobile device 102 looks up the identifier A<sub>QA</sub> based on the public key Q<sub>A</sub>. When the mobile devices 102, 104 have determined the identifiers, the mobile devices 102, 104 determine that the other mobile device 102, 104 is trusted and a secure NFC connection may be established. The mobile devices 102, 104 then use 522 the shared key Z (e.g., previously stored during a first NFC connection between the mobile devices 102, 104) to securely communicate via NFC.</p><p id="p0056" num="0056"><figref idrefs="f0004">FIG. 7</figref> is a flowchart representative of an example method 700 to establish trust on first use for near field communications. The example method 700 may be performed to implement any of the example mobile devices 102, 104, 108, 200 of <figref idrefs="f0001">FIGS. 1, 2</figref>, and/or 5. For clarity, the method 700 will be described below with reference to the mobile devices 102 and 200 of <figref idrefs="f0001">FIGS. 1 and 2</figref>.</p><p id="p0057" num="0057">The method of <figref idrefs="f0004">FIG. 7</figref> establishes (and/or initiates establishment of) a close proximity communications (e.g., NFC) connection (e.g., via the close proximity communications module 204 of <figref idrefs="f0001">FIG. 2</figref>, via an NFC module) with another device (e.g., the<!-- EPO <DP n="16"> --> mobile device 104 of <figref idrefs="f0001">FIG. 1</figref>, a desktop computer, a notebook computer, a tablet computer, or any other type(s) of devices) (block 702). The NFC connection may be established when the mobile device 102 is tapped to the mobile device 104 such that the respective NFC modules 204 of the mobile devices 102, 104 are communicatively coupled. The example mobile device 102 sends (e.g., via the NFC module 204) a public key (e.g., Q<sub>A</sub>) to the mobile device 104 (block 704). The example mobile device 102 also receives a public key (e.g., Q<sub>B</sub>) from the mobile device 104 (block 706). In some examples, the mobile device 102 obtains (e.g., receives) an identifier from the mobile device 104 (block 707).</p><p id="p0058" num="0058">The example mobile device 102 requests a user to verify that the NFC connection is trusted (block 708). For example, the mobile device 102 may display a message to the user via the user interface 216 of <figref idrefs="f0001">FIG. 2</figref> requesting the user to input (e.g., press a button) an indication of whether the mobile device 104 from which the public key was received is trusted. If an identifier was received from the mobile device 104 (block 707), the example mobile device 102 may display the identifier to the user as part of the request. If the connection is trusted (block 710), the example mobile device 102 determines a shared key based on the received public key (e.g., Q<sub>B</sub>) (block 712). For example, the processor 202 of <figref idrefs="f0001">FIG. 2</figref> may calculate the shared key (e.g., Z) using the public key Q<sub>B</sub> received from the mobile device 104 and a private (e.g., secret) key (e.g., d<sub>A</sub>). In some examples (e.g., when an identifier is not received from the mobile device 104 as in block 707), when the user verifies that the connection is trusted (block 710) the mobile device 102 obtains an identifier for the mobile device 104 via the user interface 216 (block 711).</p><p id="p0059" num="0059">The example mobile device 102 stores the public key (e.g., Q<sub>B</sub>), the shared key (e.g., Z), and the identifier of the mobile device 104 (e.g., B<sub>QB</sub>) (block 714). For example, the mobile device 102 stores the shared key and the identifier in the memory 206 and/or the storage 210 of <figref idrefs="f0001">FIG. 2</figref>. Additionally or alternatively, the mobile device 102 may store the<!-- EPO <DP n="17"> --> shared key and the identifier at the server 106 (e.g., in association with the user), which may then be provided to another mobile device (e.g., the mobile device 108). The example mobile device 102 uses the shared key Z to exchange data with the other mobile device 104 (e.g., via the NFC module 204) (block 716).</p><p id="p0060" num="0060">If the connection is not trusted (e.g., based on the user input via the user interface 216) (block 710), the example mobile device 102 may skip blocks 712-716 because the NFC connection may not be secure. The example method 700 may then end and/or iterate for an NFC connection with a different mobile device.</p><p id="p0061" num="0061"><figref idrefs="f0004">FIG. 8</figref> is a flowchart representative of an example method 800 to establish near field communications after trust has been established between two devices. The example method 800 may be performed to implement any of the example mobile devices 102, 104, 108, 200 of <figref idrefs="f0001">FIGS. 1, 2</figref>, and/or 5 and/or any other type of device. For clarity, the method 800 will be described below with reference to the mobile devices 102 and 200 of <figref idrefs="f0001">FIGS. 1 and 2</figref>.</p><p id="p0062" num="0062">The example method 800 begins when the mobile device 102 establishes (and/or initiates establishment of) a close proximity communications connection with another device (e.g., the mobile device 104 of <figref idrefs="f0001">FIG. 1</figref>) (block 802). The NFC connection may be established when the mobile device 102 is tapped to the mobile device 104 such that the respective NFC modules 204 of the mobile devices 102, 104 are communicatively coupled. The example mobile device 102 sends (e.g., via the NFC module 204) a public key (e.g., Q<sub>A</sub>) to the mobile device 104 (block 804). The example mobile device 102 also receives a public key (e.g., Q<sub>B</sub>) from the mobile device 104 (block 806).</p><p id="p0063" num="0063">The example mobile device 102 retrieves (e.g., from the storage 210 of <figref idrefs="f0001">FIG. 2</figref>) an identifier based on the received public key Q<sub>B</sub> (block 808). If performed after performing the example method 700 of <figref idrefs="f0004">FIG. 7</figref> described above, the retrieval based on the public key Q<sub>B</sub> results in an identifier B<sub>QB</sub>. In some examples, the retrieval includes<!-- EPO <DP n="18"> --> performing a look up based on the received public key Q<sub>B</sub>. Additionally, successfully retrieving an identifier based on a received public key Q<sub>B</sub> may serve as verification that the identifier is associated with a trusted NFC connection or a trusted device. In some other examples, the example mobile device 102 receives the identifier from the mobile device 104 and retrieves the public key Q<sub>B</sub> from the storage 210 based on the identifier.</p><p id="p0064" num="0064">If the retrieval results in finding a trusted identifier (block 810), the example mobile device 102 retrieves a shared key (e.g., Z) (block 812) that is stored in association with the stored identifier and/or the stored public key. For example, the shared key may have been stored as a result of establishing trust on first use for an earlier NFC connection between the mobile devices 102, 104. Alternatively, the shared key may be computed on every instance of establishment of a connection.</p><p id="p0065" num="0065">At this time, the example mobile devices 102, 104 may establish a secure NFC connection. However, the trust between the mobile devices 102, 104 does not necessarily extend to every type of data transaction being performed by the mobile devices 102, 104. Accordingly, the example mobile device 102 may request a user of the mobile device to authorize a data transaction (block 814). For example, the mobile device 102 may request and receive permission via the user interface 216 to perform a data transaction (e.g., a particular type of data transaction). If the transaction is authorized by the user (e.g., via the user interface 216) (block 816), the example mobile device 102 uses the shared key Z to exchange data (block 818). The example method 800 may then end and/or iterate to perform another data transaction.</p><p id="p0066" num="0066">If the look up does not result in finding an identifier (block 810), the example mobile device 102 does not perform blocks 812-818 (e.g., does not establish an NFC connection or exchange data). If the data transaction is not authorized (block 816), the<!-- EPO <DP n="19"> --> example mobile device 102 does not exchange data. In some examples, the mobile devices 102, 104 may treat the NFC connection as a first NFC connection with no prior trust.</p><p id="p0067" num="0067"><figref idrefs="f0005">FIG. 9</figref> is a flowchart representative of another example method 900 to establish near field communications after trust has been established between two devices. The example method 900 may be performed to implement any of the example mobile devices 102, 104, 108, 200 of <figref idrefs="f0001">FIGS. 1, 2</figref>, and/or 5. For clarity, the method 900 will be described below with reference to the mobile devices 102 and 200 of <figref idrefs="f0001">FIGS. 1 and 2</figref>. In contrast to the example method 800 of <figref idrefs="f0004">FIG. 8</figref>, the method 900 of <figref idrefs="f0005">FIG. 9</figref> reduces the risk of (e.g., prevents) replay attacks in which an attacker attempts to duplicate a data transaction with a trusted party using the same data transmissions.</p><p id="p0068" num="0068">The example method 900 begins when the mobile device 102 establishes (and/or initiates establishment of) an NFC connection with another mobile device (e.g., the mobile device 104 of <figref idrefs="f0001">FIG. 1</figref>) (block 902). The NFC connection may be established when the mobile device 102 is tapped to the mobile device 104 such that the respective NFC modules 204 of the mobile devices 102, 104 are communicatively coupled. The example mobile device 102 stores a counter value A associated with the mobile device 102 (block 904). The example counter value A for the mobile device 102 indicates a number of an NFC connection such that the counter value A increases for each NFC connection. In some examples, the mobile device 102 maintains a counter value for each trusted NFC connection with a mobile device.</p><p id="p0069" num="0069">The example mobile device 102 sends (e.g., via the NFC module 204) a public key (e.g., Q<sub>A</sub>) and the counter value A to the mobile device 104 (block 906). The example mobile device 102 also receives a public key (e.g., Q<sub>B</sub>) and a counter value B from the mobile device 104 (block 908). The example mobile device 102 looks up (e.g., retrieves from the storage 210 of <figref idrefs="f0001">FIG. 2</figref>) an identifier and a previous counter value B based on the<!-- EPO <DP n="20"> --> received public key Q<sub>B</sub> (block 910). If performed after performing the example method 700 of <figref idrefs="f0004">FIG. 7</figref> described above, the look up based on the public key Q<sub>B</sub> results in an identifier B<sub>QB</sub>. The previous counter value B may stored in the example storage 210 in association with the received public key Q<sub>B</sub>.</p><p id="p0070" num="0070">If the look up results in finding an identifier (block 912), the example mobile device 102 retrieves a shared key (e.g., Z) (block 914) that is stored in association with the stored identifier B<sub>QB</sub> and/or the stored public key Q<sub>B</sub>. The example mobile device 102 determines whether the received counter value B is greater than the previous counter value B (block 916). In the example of <figref idrefs="f0005">FIG. 9</figref>, the counter value B is incremented (or otherwise increased) for each NFC data transaction. In some examples, the mobile device 102 may determine whether the counter value B is indicative of a replay attack or a genuine data transaction using a different method.</p><p id="p0071" num="0071">If the received value of counter B (e.g., X+1) is greater than the previous value of counter B (e.g., X) (block 916), the example mobile device 102 optionally requests the user to authorize the data transaction (block 918). For example, the mobile device 102 may request and receive permission via the user interface 216 to perform a data transaction (e.g., a particular type of data transaction). If the transaction is authorized (e.g., by the user via the user interface 216) (block 920), the example mobile device 102 uses the shared key Z to exchange data (block 922). The updated (e.g., incremented) value of counter B (e.g., X+1) may be stored as the value of the counter B (block 924) for use in future transactions to authenticate the transactions. The example method 900 may then end and/or iterate to perform another data transaction.</p><p id="p0072" num="0072">If the look up does not result in finding an identifier (block 912), the example mobile device 102 does not perform blocks 914-922 (e.g., does not establish an NFC connection or exchange data). If the received counter value B is not greater than the previous<!-- EPO <DP n="21"> --> counter value B (block 916), the example mobile device 102 cancels the data transaction (e.g., does not prompt the user to go forward with the data transaction). If the data transaction is not authorized (block 920), the example mobile device 102 does not exchange data.</p><p id="p0073" num="0073"><figref idrefs="f0006">FIG. 10</figref> is a flowchart representative of an example method 1000 to send and receive trusted connections to and from a server. The example method 1000 may be performed to implement any of the example mobile devices 102, 104, 108, 200 of <figref idrefs="f0001">FIGS. 1, 2</figref>, and/or 5. For clarity, the method 1000 will be described below with reference to the mobile devices 102 and 200 of <figref idrefs="f0001">FIGS. 1 and 2</figref>.</p><p id="p0074" num="0074">The example method 1000 sends (e.g., via the network interface 214 of <figref idrefs="f0001">FIG. 2</figref>) an identifier and a public key to a server (e.g., the server 106 of <figref idrefs="f0001">FIG. 1</figref>) to be stored with a user identifier (block 1002). The user identifier may be a unique identifier for the user of the mobile device 102. In combination, the identifier and the public key represent a trusted NFC connection or a trusted device. In some examples, such as when there is a secure connection between the mobile device 102 and the server 106, the mobile device 102 sends the shared key associated with the identifier and the public key.</p><p id="p0075" num="0075">The example mobile device 102 receives from the server 106 a (different) identifier and a public key for a trusted NFC connection associated with the user identifier (block 1004). For example, the received identifier and public key may represent a trusted connection made by the user using a different mobile device. The received identifier, public key, and shared key may be used to establish secure NFC connections without the user verifying that the connection is trusted. In some examples, such as when there is a secure connection between the mobile device 102 and the server 106, the mobile device 102 receives the shared key associated with the received identifier and public key.</p><p id="p0076" num="0076"><figref idrefs="f0007">FIG. 11</figref> illustrates an example process 1100 for establishing trust for near field communications. The example process 1100 is performed by the two example mobile<!-- EPO <DP n="22"> --> devices 102, 104 of <figref idrefs="f0001">FIG. 1</figref> when the mobile devices 102, 104 are "tapped" together (e.g., when NFC communications or any other close-proximity communications are established).</p><p id="p0077" num="0077">Each of the example mobile devices 102, 104 has a private key/public key pair 1102. The devices 102, 104 exchange 1104 the public key portions of the private key/public key pair. After exchanging the public keys, each of the example mobile devices 102, 104 obtains verification 1106 (e.g., from their respective users, via user interfaces of the mobile devices 102, 104) that the other mobile device 102, 104 is trusted. For example, the mobile device 102 prompts a user of the mobile device 102 to confirm that the other mobile device 104, from which the mobile device 102 has received a public key, is trusted. For example, the mobile device 102 may display the name and/or other identifier of the user of the mobile device 104. The user may know that the other mobile device 104 is trusted because of the close-proximity nature of the NFC connection (e.g., she is standing next to the user of the device 104).</p><p id="p0078" num="0078">When the users verify that the mobile devices 102, 104 are trusted, the example mobile devices 102, 104 assign identifiers to the public keys. For example, the mobile device 102 assigns an identifier B<sub>QB</sub> to the mobile device 104. The identifier B<sub>QB</sub> may be input by the user of the mobile device 102 and/or may be received from the mobile device 104 as a suggested identifier. Similarly, the example mobile device 104 assigns an identifier A<sub>QA</sub> to the mobile device 102. In some examples, the mobile devices 102, 104 exchange suggested identifiers when exchanging the public keys Q<sub>A</sub>, Q<sub>B</sub>.</p><p id="p0079" num="0079">The suggested identifiers may then be used when prompting the respective users to verify that the mobile devices are trusted. Assuming the users of the mobile devices 102, 104 have verified that the opposite mobile devices are trusted, the mobile devices 102, 104 assign 1108 respective identifiers to the received public keys. For example, the mobile device 102 assigns an identifier B<sub>QB</sub> to the received public key Q<sub>B</sub> and the mobile device 104<!-- EPO <DP n="23"> --> assigns an identifier A<sub>QA</sub> to the received public key Q<sub>A</sub>. In some examples, the assigned identifiers A<sub>QA</sub> and/or B<sub>QB</sub> are suggested identifiers provided (e.g., exchanged) with the public keys.</p><p id="p0080" num="0080">The example mobile devices 102, 104 calculate 1110 the shared key Z based on the exchanged public keys Q<sub>A</sub>, Q<sub>B</sub> and the respective private keys d<sub>A</sub>, d<sub>B</sub>. The example mobile devices 102, 104 then store 1112 the public key Q<sub>A</sub>, Q<sub>B</sub> and/or the identifier A<sub>QA</sub>, B<sub>QB</sub> in association the opposite mobile device 102, 104. For example, the mobile device 102 stores the public key Q<sub>B</sub>. The public key Q<sub>B</sub> may then be used for subsequent secure NFC connections between the mobile devices 102, 104. Additionally or alternatively, the public key Q<sub>B</sub> may be used between the mobile device 102 and another mobile device associated with the user of the mobile device 104.</p><p id="p0081" num="0081">A subsequent secure NFC connection process 1114 may be used between the two mobile devices 102, 104 that have previously established a secure NFC connection according to the example process 1100. Unlike prior art processes, the secure NFC connection process 1114 reduces (e.g., prevents) the possibility of a man-in-the-middle attack between the mobile devices 102, 104. The example subsequent secure NFC connection process 1114 may be performed when the mobile devices 102, 104 are tapped together.</p><p id="p0082" num="0082">Each of the example mobile devices 102, 104 has a private key/public key pair 1116. The devices 102, 104 exchange 1118 the public key Q<sub>A</sub>, Q<sub>B</sub> portions of the private key/public key pair and/or the identifiers A<sub>QA</sub>, B<sub>QB</sub>. The example mobile devices 102, 104 verify that the received public keys Q<sub>A</sub>, Q<sub>B</sub> are in the respective storages. For example, the mobile device 102 verifies that the public key Q<sub>A</sub> and/or the identifier A<sub>QA</sub> are in its storage (e.g., the public key Q<sub>A</sub> matches a public key in a stored table of trusted public keys, the identifier A<sub>QA</sub> matches an identifier in a stored table of identifiers, or both). Similarly, the mobile device 102 verifies that the public key Q<sub>B</sub> and/or the identifier B<sub>QB</sub> are in its storage<!-- EPO <DP n="24"> --> (e.g., the public key Q<sub>B</sub> matches a public key in a stored table of trusted public keys, the identifier B<sub>QB</sub> matches an identifier in a stored table of identifiers, or both). When the mobile devices 102, 104 have verified the public keys and/or the identifiers, the mobile devices 102, 104 determine that the other mobile device 102, 104 is trusted and a secure NFC connection may be established. The mobile devices 102, 104 then use 1122 the shared key Z (e.g., calculate the shared key Z from the public keys Q<sub>A</sub>, Q<sub>B</sub> and the private keys d<sub>A</sub>, d<sub>B</sub>) to securely communicate via NFC.</p><p id="p0083" num="0083"><figref idrefs="f0008">FIG. 12</figref> is a flowchart representative of another example method 1200 to establish trust on first use for near field communications. The example method 1200 may be performed to implement any of the example mobile devices 102, 104, 108, 200 of <figref idrefs="f0001">FIGS. 1, 2</figref>, and/or 5. For clarity, the method 1200 will be described below with reference to the mobile devices 102 and 200 of <figref idrefs="f0001">FIGS. 1 and 2</figref>.</p><p id="p0084" num="0084">Example blocks 1202-1212 are substantially identical to respective blocks 702-712 of <figref idrefs="f0004">FIG. 7</figref>. The example mobile device 102 stores the public key (e.g., Q<sub>B</sub>) and/or the identifier of the mobile device 104 (e.g., B<sub>QB</sub>) (block 1214). For example, the mobile device 102 may store only the public key, only the identifier, or both the public key and the identifier, in the memory 206 and/or the storage 210 of <figref idrefs="f0001">FIG. 2</figref>. Additionally or alternatively, the mobile device 102 may store only the public key, only the identifier, or both the public key and the identifier at the server 106 (e.g., in association with the user), which may then be provided to another mobile device (e.g., the mobile device 108). The example mobile device 102 uses the shared key Z to exchange data with the other mobile device 104 (e.g., via the NFC module 204) (block 1216).</p><p id="p0085" num="0085"><figref idrefs="f0008">FIG. 13</figref> is a flowchart representative of another example method 1300 to establish near field communications after trust has been established between two devices. The example method 1300 may be performed to implement any of the example mobile devices<!-- EPO <DP n="25"> --> 102, 104, 108, 200 of <figref idrefs="f0001">FIGS. 1, 2</figref>, and/or 5 and/or any other type of device. For clarity, the method 1300 will be described below with reference to the mobile devices 102 and 200 of <figref idrefs="f0001">FIGS. 1 and 2</figref>.</p><p id="p0086" num="0086">Example blocks 1302 and 1304 are substantially identical to respective blocks 802 and 804 of <figref idrefs="f0004">FIG. 8</figref>. The example mobile device 102 receives a public key (e.g., Q<sub>B</sub>) and/or an identifier (e.g., B<sub>QB</sub>) from the mobile device 104 (block 1306). The mobile device 102 looks up the public key Q<sub>B</sub> and/or the identifier in a storage (e.g., the storage 210 of <figref idrefs="f0001">FIG. 2</figref>) (block 1308). If the public key Q<sub>B</sub> and/or the identifier are in the storage 210 (block 1310), the example mobile device 102 calculates a shared key (e.g., Z) (block 1312). In some examples, the mobile device calculates the shared key Z without user intervention, thereby increasing the speed of the subsequent transaction.</p><p id="p0087" num="0087">At this time, the example mobile devices 102, 104 may establish a secure NFC connection. However, the trust between the mobile devices 102, 104 does not necessarily extend to every type of data transaction being performed by the mobile devices 102, 104. Accordingly, the example mobile device 102 requests a user of the mobile device 102, 104 to authorize a data transaction (block 1314). For example, the mobile device 102 may request and receive permission via the user interface 216 to perform a data transaction (e.g., a particular type of data transaction). If the transaction is authorized by the user (e.g., via the user interface 216) (block 1316), the example mobile device 102 uses the shared key Z to exchange data (block 1318). The example method 1300 may then end and/or iterate to perform another data transaction.</p><p id="p0088" num="0088">If the public key QB and/or the identifier are not in the storage 210 (block 1310), the example mobile device 102 does not perform blocks 1312-1318 (e.g., does not establish an NFC connection or exchange data). If the data transaction is not authorized (block 1316), the example mobile device 102 does not exchange data. Instead, the example<!-- EPO <DP n="26"> --> method 1300 may end and/or the mobile device 102, 104 may treat the NFC connection as a first NFC connection with no prior trust.</p><p id="p0089" num="0089">Although certain methods, apparatus, and articles of manufacture have been described herein, the scope of coverage of this patent is not limited thereto. To the contrary, this patent covers all methods, apparatus, and articles of manufacture falling within the scope of the claims.</p></description><claims mxw-id="PCLM56976176" lang="EN" load-source="patent-office"><!-- EPO <DP n="27"> --><claim id="c-en-0001" num="0001"><claim-text>A method, comprising:
<claim-text>establishing a close proximity communications connection with a device;</claim-text>
<claim-text>receiving a public key from the device via the close proximity communications connection;</claim-text>
<claim-text>obtaining, via a user interface, an indication that the device is trusted; and</claim-text>
<claim-text>storing at least one of the public key or an identifier for the device.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>A method as defined in claim 1, further comprising:
<claim-text>establishing a second close proximity communications connection with the device;</claim-text>
<claim-text>receiving the public key from the device via the second close proximity communications connection; and</claim-text>
<claim-text>obtaining a shared key based on the public key.</claim-text></claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>A method as defined in claim 2, wherein obtaining the shared key is based on the identifier.</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>A method as defined in claim 3, further comprising obtaining verification that the identifier is trusted.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>A method as defined in claim 2, further comprising, prior to obtaining the shared key based on the public key, verifying that the public key is trusted by performing a lookup of the public key in a storage.</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>A method as defined in claim 1, wherein storing at least one of the public key or the identifier comprises storing the public key in association with the identifier.</claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>A method as defined in claim 1, further comprising determining a shared key based on the public key in response to obtaining the indication.</claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>A method as defined in claim 7, further comprising storing the shared key in association with the at least one of the public key or the identifier.<!-- EPO <DP n="28"> --></claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>A method as defined in claim 1, further comprising obtaining the identifier via the user interface.</claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>A method as defmed in claim 1, further comprising obtaining the identifier via the close proximity communications connection.</claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>A method as defined in claim 1, further comprising:
<claim-text>sending the at least one of the identifier or the public key to a server; and</claim-text>
<claim-text>receiving at least one of a second identifier or a second public key from the server, the at least one of the second identifier or the second public key corresponding to a second trusted device.</claim-text></claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>A method as defined in claim 1, further comprising:
<claim-text>storing a first counter value associated with at least one of the identifier, a shared key, or the public key;</claim-text>
<claim-text>receiving a second counter value from the device;</claim-text>
<claim-text>comparing the first and second counter values;</claim-text>
<claim-text>performing a data transaction using the shared key based on the comparison; and</claim-text>
<claim-text>storing the second counter value in association with the at least one of the identifier, the shared key, or the public key.</claim-text></claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>A method as defined in claim 1, wherein the close proximity communications connection comprises a near field communications connection.</claim-text></claim><claim id="c-en-0014" num="0014"><claim-text>A method as defined in claim 1, wherein the device comprises a mobile device.</claim-text></claim><claim id="c-en-0015" num="0015"><claim-text>An apparatus, comprising:
<claim-text>a processor;</claim-text>
<claim-text>a close proximity communications module coupled to the processor; and</claim-text>
<claim-text>a memory coupled to the processor and storing instructions which, when executed by the processor, cause the processor to implement the method of any of the foregoing claims.</claim-text><!-- EPO <DP n="29"> --></claim-text></claim><claim id="c-en-0016" num="0016"><claim-text>A tangible computer readable storage medium comprising machine readable instructions which, when executed by a processor, cause the processor to implement the methods or apparatus of any of the foregoing claims.</claim-text></claim></claims><drawings mxw-id="PDW16666960" load-source="patent-office"><!-- EPO <DP n="30"> --><figure id="f0001" num="1,2"><img id="if0001" file="imgf0001.tif" wi="165" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="31"> --><figure id="f0002" num="3,4"><img id="if0002" file="imgf0002.tif" wi="165" he="201" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="32"> --><figure id="f0003" num="5,6"><img id="if0003" file="imgf0003.tif" wi="165" he="232" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="33"> --><figure id="f0004" num="7,8"><img id="if0004" file="imgf0004.tif" wi="165" he="229" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="34"> --><figure id="f0005" num="9"><img id="if0005" file="imgf0005.tif" wi="141" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="35"> --><figure id="f0006" num="10"><img id="if0006" file="imgf0006.tif" wi="137" he="124" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="36"> --><figure id="f0007" num="11"><img id="if0007" file="imgf0007.tif" wi="165" he="141" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="37"> --><figure id="f0008" num="12,13"><img id="if0008" file="imgf0008.tif" wi="165" he="228" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="156" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="154" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
