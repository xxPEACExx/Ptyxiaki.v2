<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2680228-A1" country="EP" doc-number="2680228" kind="A1" date="20140101" family-id="48579067" file-reference-id="318307" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146549376" ucid="EP-2680228-A1"><document-id><country>EP</country><doc-number>2680228</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12173489-A" is-representative="YES"><document-id mxw-id="PAPP154823299" load-source="docdb" format="epo"><country>EP</country><doc-number>12173489</doc-number><kind>A</kind><date>20120625</date><lang>EN</lang></document-id><document-id mxw-id="PAPP172244660" load-source="docdb" format="original"><country>EP</country><doc-number>12173489.1</doc-number><date>20120625</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140447795" ucid="EP-12173489-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>12173489</doc-number><kind>A</kind><date>20120625</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988114308" load-source="docdb">G06T   7/00        20060101ALI20121116BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988118305" load-source="docdb">G06T   7/20        20060101AFI20121116BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1861391382" load-source="docdb" scheme="CPC">G06T   7/246       20170101 LI20170102BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1861392493" load-source="docdb" scheme="CPC">G06T   7/73        20170101 LI20170102BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2062992945" load-source="docdb" scheme="CPC">G06T   7/0042      20130101 FI20150501BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2062993890" load-source="docdb" scheme="CPC">G06T2207/10028     20130101 LA20150501BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2062993912" load-source="docdb" scheme="CPC">G06T2207/30196     20130101 LA20150501BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132180612" lang="DE" load-source="patent-office">Verbesserungen bei oder im Zusammenhang mit dreidimensionalen nahen Interaktionen</invention-title><invention-title mxw-id="PT132180613" lang="EN" load-source="patent-office">Improvements in or relating to three dimensional close interactions.</invention-title><invention-title mxw-id="PT132180614" lang="FR" load-source="patent-office">Améliorations dans ou associées à des interactions tridimensionnelles</invention-title><citations><patent-citations><patcit mxw-id="PCIT242652358" load-source="docdb" ucid="US-20050271279-A1"><document-id format="epo"><country>US</country><doc-number>20050271279</doc-number><kind>A1</kind><date>20051208</date></document-id><sources><source name="SEA" category="A" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242652359" load-source="docdb" ucid="WO-2003071410-A2"><document-id format="epo"><country>WO</country><doc-number>2003071410</doc-number><kind>A2</kind><date>20030828</date></document-id><sources><source name="APP" created-by-npl="N"/></sources></patcit></patent-citations><non-patent-citations><nplcit><text>A. KIRILLOV, HANDS GESTURE RECOGNITION, May 2008 (2008-05-01), Retrieved from the Internet &lt;URL:http://www.codeproject.com/Articles/26280/Hands-Gesture-Recognition&gt;</text><sources><source mxw-id="PNPL64192143" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>A.A. ARGYROS; M.I.A. LOURAKIS: "Proceedings of the European Conference on Computer Vision", vol. 3, 11 May 2004, SPRINGER-VERLAG, article "Real Time Tracking of Multiple Skin Colored Objects with a Possibly Moving Camera", pages: 368 - 379, XP019005884</text><sources><source mxw-id="PNPL64192144" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>GEORG HACKENBERG ET AL: "Lightweight palm and finger tracking for real-time 3D gesture control", VIRTUAL REALITY CONFERENCE (VR), 2011 IEEE, IEEE, 19 March 2011 (2011-03-19), pages 19 - 26, XP031863506, ISBN: 978-1-4577-0039-2, DOI: 10.1109/VR.2011.5759431</text><sources><source mxw-id="PNPL64192145" load-source="docdb" name="SEA" category="A"/></sources></nplcit><nplcit><text>L. GUIGUES: "Comparison of image segmentations using a hierarchical model for n-m regions matchings", PROC. OF 2ND IAPR-TC15 WORKSHOP ON GRAPH-BASED REPRESENTATIONS, HAINDORF, AUSTRIA, 1999</text><sources><source mxw-id="PNPL64192146" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>M.K. BHUYAN ET AL.: "Fingertip Detection for Hand Pose Recognition", INTERNATIONAL JOURNAL ON COMPUTER SCIENCE AND ENGINEERING, vol. 4, no. 3, March 2012 (2012-03-01), XP032592597, DOI: doi:10.1109/GCIS.2013.23</text><sources><source mxw-id="PNPL64192147" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>MALASSIOTIS S ET AL: "Real-time hand posture recognition using range data", IMAGE AND VISION COMPUTING, ELSEVIER, GUILDFORD, GB, vol. 26, no. 7, 2 July 2008 (2008-07-02), pages 1027 - 1037, XP022618942, ISSN: 0262-8856, [retrieved on 20071204], DOI: 10.1016/J.IMAVIS.2007.11.007</text><sources><source mxw-id="PNPL64192148" load-source="docdb" name="SEA" category="A"/></sources></nplcit><nplcit><text>S.E. GHOBADI; O.E. LOEPPRICH; K.HARTMANN; O. LOFFELD: "Hand Segmentation using 2D/3D Images", PROCEEDINGS OF IMAGE AND VISION COMPUTING NEW ZEALAND 2007, December 2007 (2007-12-01), pages 64 - 69, XP047042065, DOI: doi:10.1007/978-3-642-40763-5_67</text><sources><source mxw-id="PNPL64192149" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>THIAGO R. TRIGO; SERGIO ROBERTO M. PELLEGRINO: "An Analysis of Features for Hand-Gesture Classification", IWSSIP 2010, 17TH INTERNATIONAL CONFERENCE ON SYSTEMS, SIGNALS AND IMAGE PROCESSING, 2010, XP006053520, DOI: doi:10.1049/iet-cvi.2014.0426</text><sources><source mxw-id="PNPL64192150" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>Y. BULALOV; S. JAMBAWALIKAR; P. KUMAR; S. SETHIA, HAND RECOGNITION USING GEOMETRIC CLASSIFIERS</text><sources><source mxw-id="PNPL64192151" load-source="docdb" name="APP"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR918140778" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>SOFTKINETIC SOFTWARE</last-name><address><country>BE</country></address></addressbook></applicant><applicant mxw-id="PPAR918142795" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>SOFTKINETIC SOFTWARE</last-name></addressbook></applicant><applicant mxw-id="PPAR918987536" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>SOFTKINETIC SOFTWARE</last-name><iid>101291579</iid><address><street>Boulevard de la Plaine, 15</street><city>1050 Brussels</city><country>BE</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918150743" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>GUIGUES LAURENT</last-name><address><country>BE</country></address></addressbook></inventor><inventor mxw-id="PPAR918135911" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>Guigues, Laurent</last-name></addressbook></inventor><inventor mxw-id="PPAR918993475" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Guigues, Laurent</last-name><address><street>Rue Emile Claus, 47</street><city>1050 Brussels</city><country>BE</country></address></addressbook></inventor><inventor mxw-id="PPAR918150537" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>FEYS OLIVIER</last-name><address><country>BE</country></address></addressbook></inventor><inventor mxw-id="PPAR918134160" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>FEYS, Olivier</last-name></addressbook></inventor><inventor mxw-id="PPAR918992880" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>FEYS, Olivier</last-name><address><street>Avenue des Meuniers, 22</street><city>1160 Brussels</city><country>BE</country></address></addressbook></inventor><inventor mxw-id="PPAR918137771" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>SIMONS KEVIN</last-name><address><country>BE</country></address></addressbook></inventor><inventor mxw-id="PPAR918149020" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>SIMONS, KEVIN</last-name></addressbook></inventor><inventor mxw-id="PPAR918988530" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>SIMONS, KEVIN</last-name><address><street>Rue de la Vallée, 29</street><city>1050 Brussels</city><country>BE</country></address></addressbook></inventor><inventor mxw-id="PPAR918139957" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>HOU YUNSHU</last-name><address><country>BE</country></address></addressbook></inventor><inventor mxw-id="PPAR918142739" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>HOU, Yunshu</last-name></addressbook></inventor><inventor mxw-id="PPAR918989952" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>HOU, Yunshu</last-name><address><street>Rue Xavier De Bue 22 B12</street><city>1180 Brussels</city><country>BE</country></address></addressbook></inventor><inventor mxw-id="PPAR918166017" load-source="docdb" sequence="5" format="epo"><addressbook><last-name>KAMOVICH ALIAKSANDR</last-name><address><country>BE</country></address></addressbook></inventor><inventor mxw-id="PPAR918137045" load-source="docdb" sequence="5" format="intermediate"><addressbook><last-name>KAMOVICH, Aliaksandr</last-name></addressbook></inventor><inventor mxw-id="PPAR918991347" load-source="patent-office" sequence="5" format="original"><addressbook><last-name>KAMOVICH, Aliaksandr</last-name><address><street>Avenue Château de Walzin, 5</street><city>1180 Brussels</city><country>BE</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918984518" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Mackett, Margaret Dawn</last-name><suffix>et al</suffix><iid>101202405</iid><address><street>Gevers &amp; Vander Haeghen Holidaystraat 5</street><city>1831 Diegem</city><country>BE</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS548857966" load-source="docdb">AL</country><country mxw-id="DS548860684" load-source="docdb">AT</country><country mxw-id="DS548840693" load-source="docdb">BE</country><country mxw-id="DS548803439" load-source="docdb">BG</country><country mxw-id="DS548877367" load-source="docdb">CH</country><country mxw-id="DS548840694" load-source="docdb">CY</country><country mxw-id="DS548804590" load-source="docdb">CZ</country><country mxw-id="DS548857968" load-source="docdb">DE</country><country mxw-id="DS548840695" load-source="docdb">DK</country><country mxw-id="DS548840696" load-source="docdb">EE</country><country mxw-id="DS548889689" load-source="docdb">ES</country><country mxw-id="DS548803440" load-source="docdb">FI</country><country mxw-id="DS548803441" load-source="docdb">FR</country><country mxw-id="DS548857969" load-source="docdb">GB</country><country mxw-id="DS548840697" load-source="docdb">GR</country><country mxw-id="DS548857970" load-source="docdb">HR</country><country mxw-id="DS548804591" load-source="docdb">HU</country><country mxw-id="DS548877368" load-source="docdb">IE</country><country mxw-id="DS548840698" load-source="docdb">IS</country><country mxw-id="DS548803446" load-source="docdb">IT</country><country mxw-id="DS548840699" load-source="docdb">LI</country><country mxw-id="DS548803447" load-source="docdb">LT</country><country mxw-id="DS548860685" load-source="docdb">LU</country><country mxw-id="DS548803448" load-source="docdb">LV</country><country mxw-id="DS548803449" load-source="docdb">MC</country><country mxw-id="DS548860686" load-source="docdb">MK</country><country mxw-id="DS548860687" load-source="docdb">MT</country><country mxw-id="DS548803454" load-source="docdb">NL</country><country mxw-id="DS548877369" load-source="docdb">NO</country><country mxw-id="DS548803455" load-source="docdb">PL</country><country mxw-id="DS548889690" load-source="docdb">PT</country><country mxw-id="DS548857972" load-source="docdb">RO</country><country mxw-id="DS548889691" load-source="docdb">RS</country><country mxw-id="DS548803456" load-source="docdb">SE</country><country mxw-id="DS548863511" load-source="docdb">SI</country><country mxw-id="DS548877370" load-source="docdb">SK</country><country mxw-id="DS548877371" load-source="docdb">SM</country><country mxw-id="DS548840700" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128670046" lang="EN" load-source="patent-office"><p id="pa01" num="0001">Described herein is a method for detecting, identifying and tracking hand, hand parts, and fingers on the hand (500) of a user within depth images of a three-dimensional scene. Arms of a user are detected, identified, segmented from the background of the depth images, and tracked with respect to time. Hands of the user are identified and tracked and the location and orientation of its parts, including the palm and the fingers (510, 520, 530, 540, 550) are determined and tracked in order to produce output information enabling gesture interactions.
<img id="iaf01" file="imgaf001.tif" wi="82" he="103" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128499419" lang="EN" source="EPO" load-source="docdb"><p>Described herein is a method for detecting, identifying and tracking hand, hand parts, and fingers on the hand (500) of a user within depth images of a three-dimensional scene. Arms of a user are detected, identified, segmented from the background of the depth images, and tracked with respect to time. Hands of the user are identified and tracked and the location and orientation of its parts, including the palm and the fingers (510, 520, 530, 540, 550) are determined and tracked in order to produce output information enabling gesture interactions.</p></abstract><description mxw-id="PDES63955476" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><u>Field of the Invention</u></heading><p id="p0001" num="0001">The present invention relates to improvements in or relating to three dimensional (3D) close interactions, and is more particularly, although not exclusively, concerned with detection and tracking of the hand(s) and/or main parts of a hand of a user at distances close to a depth sensing imaging device so that information enabling hand and/or finger based gesture interactions to be determined.</p><heading id="h0002"><u>Background to the invention</u></heading><p id="p0002" num="0002">Human to computer interactive systems and methods using gesture and movement recognition are technologies known from the computer vision domain. The recent range finding camera device based interactive systems, for example, a system using a 3D structured light camera, are also known to enable 3D gesture and movement recognition of users when performed in the field of view of the particular imaging device. In such systems, a human user is typically standing at least at 1 m from the camera and his movements and/or gestures need to be bold, that is, large enough to be detected by the 3D camera, the resolution of which is predefined and limited. For example, a typical 3D camera resolution is in accordance with quarter video graphics array (QVGA), that is, 320*240 pixels, and, therefore limits the accuracy of detectable movement or the capacity of detecting small objects, such as fingers, when they are situated far too away from the 3D imaging device. In such systems, it is generally not possible to detect and track reliably the hands of a user, and more particularly, the fingers of the hand at such distances. More precisely, most of the current 3D imaging devices are built to enable full skeletal tracking of<!-- EPO <DP n="2"> --> a user in the range of between 1m and 5m from the camera. Moreover, most of these 3D imaging devices have technical specifications which do not allow them to perform measurements in the range from between 0m and 1.5m from the camera sensor.</p><p id="p0003" num="0003">However, with the development of some new technologies, among which is the 3D time-of-flight (ToF) cameras, it becomes possible to detect and to track features at different distances from the camera sensor, including features, such as the hands and/or fingers of a user, at distances less than 1 m, typically less than 0.5m, form the camera sensor. This is termed "close interaction", and this is particularly adapted for enabling touch-less hand and finger gesture based interactions in a desktop environment or in other environments, such as in an automotive environment.</p><p id="p0004" num="0004">It is known to detect the presence of a plurality of parts of a human being within an image embedding colour channels for each pixel using detection of skin colour. Such a method is described in an article entitled "<nplcit id="ncit0001" npl-type="b"><text>Real Time Tracking of Multiple Skin Colored Objects with a Possibly Moving Camera" by A.A. Argyros &amp; M.I.A. Lourakis, in Proceedings of the European Conference on Computer Vision (ECCV '04), Springer-Verlag, vol. 3, pages 368 to 379, May 11 to 14, 2004, Prague, Czech Republic</text></nplcit>. Here, blobs are detected based on a Bayesian classifier which is bootstrapped with a small training set of data, and, includes skin-colour probabilities to enable the classifier to cope with illumination changes as colour measurements may be disturbed by environmental illumination. This detection method basically enables the detection of hands and face of a user in a close interaction environment, and may when be combined with some tracking capabilities of these detected skin-colour blobs so that information about the position of the blobs in the image can be provided. Such information can then be used to provide input to gesture recognition<!-- EPO <DP n="3"> --> systems, for example, to control in a simple way, the mouse of a computer without physical contact.</p><p id="p0005" num="0005">In another disclosure, a fast and robust segmentation technique based on the fusion of 2D/3D images for gesture recognition is described by <nplcit id="ncit0002" npl-type="s"><text>S.E. Ghobadi, O.E. Loepprich, K.Hartmann, &amp; O. Loffeld in an article entitled "Hand Segmentation using 2D/3D Images", Proceedings of Image and Vision Computing New Zealand 2007, pages 64 to 69, Hamilton, New Zealand, December 2007</text></nplcit>. A 3D ToF camera is used for generating an intensity image together with range information for each pixel of a Photonic Mixer Device (PMD) sensor. The intensity and range data are fused to provide input information to a segmentation algorithm relying on the K-Means mixed with expectation maximisation technique (KEM). The KEM combines K-Means clustering techniques with expectation maximisation technique so that centres of natural clusters are located in an initial step using the K-means, and, in a second step, soft probabilistic assignments of expectation maximisation are used to find local maxima iteratively and thus refine position and borders of the found clusters. In a simple environment in which the background is uniform and at a sufficient distance from the objects to be segmented, the fused data enables a proper segmentation in real time of the hand of a user from his/her body, face, arm or other objects in the scene whatever the illumination conditions. Robustness of the method in the environment being considered is said to satisfy a use as the first step of processing technique in 2D/3D gesture tracking and gesture recognition. In another article entitled "Tracking the Articulated Motion of Two Strongly Interacting Hands" by I. Oikonomidis, N. Kyriazis &amp; A.A. Argyros, <u>(http://www.ics.forth.gr/∼argyros/mypapers/2012 06 cvpr twohands.pdf</u>), particle swarm optimisation (PSO) is used to process signals from a RGB-D sensor, that is, a colour sensor that also provides depth information. The method performs marker-less visual observations to track the full articulation<!-- EPO <DP n="4"> --> of two hands interacting with one another in a complex, unconstrained manner. The method described achieves complete detection and tracking of two interacting hands by directly attributing sensory information to the joint articulation of two synthetic and symmetric 3D hand models of known size and kinematics. For given articulations of the two hands, a prediction of what the RGB-D sensor would perceive is obtained by simulating the image acquisition process, for example, by producing synthetic depth maps for the specific camera-scene calibrations. Having established a parametric process that produces comparable data to the actual input, tracking is performed by searching for the parameters that produce depth maps which are most similar to the actual input. Tracking is performed in an online fashion, where, at each step and for every new input, an optimisation step is performed, and using a variant of PSO, the discrepancy between the actual RGB-D input and simulated depth maps generated from hypothesised articulations is minimised, the best scoring hypothesis constituting the solution for the current input. The discrepancy measure is carefully formulated so that robustness is achieved with computational efficiency and temporal continuity being utilised at each optimisation step.</p><p id="p0006" num="0006">Forearm and hand segmentation is also described in "<nplcit id="ncit0003" npl-type="s"><text>Fingertip Detection for Hand Pose Recognition" by M.K. Bhuyan et al., International Journal on Computer Science and Engineering (ISCSE), Vol. 4, No. 3, March 2012</text></nplcit>. Here, a method for fingertip detection and finger type recognition is proposed in which fingertips are located in the hand region using Bayesian rule based skin colour segmentation. Morphological operations are then performed in the segmented hand region by observing some key geometric features. A final probabilistic modeling of the geometric features of finger movements is then performed so that a finger type recognition process is significantly made more robust, especially in the<!-- EPO <DP n="5"> --> context of providing valuable information for finger spelling in sign language recognition and gesture animation.</p><p id="p0007" num="0007"><patcit id="pcit0001" dnum="WO03071410A"><text>WO-A-03/071410</text></patcit> describes another method for enabling a person to interact with an electronic device using gestures and poses. The method includes obtaining position information for a plurality of discrete regions of a body part of the person. The position information includes depth values of each discrete region of the body part relative to a reference position. A depth image of a 3D scene is captured using a 3D sensor system and processed to segment one or more regions of interest from the background of the scene, each region of interest including a hand whose gestures are to be detected. Each gesture is classified and compared to a set of different hand gestures.</p><p id="p0008" num="0008">Despite hand detection and modelling being widely addressed in the literature, none of the documents described above provides for the detection and tracking of the parts of the hands and their parameters including fingers, palm and orientation, at distances close to the imaging device using a depth map from a 3D imaging sensor as input information, and without the use of any colour information, nor the use of any hand model or skeletal representation having articulations.</p><heading id="h0003"><u>Summary of the Invention</u></heading><p id="p0009" num="0009">It is therefore an object of the present invention to provide a method for the detection, localisation and segmentation of hands of a user, and in particular, fingers, finger tips, palm and parameters of the hand, in a predetermined volume defined by the frustum of a 3D sensing device, such as, a time-of-flight (ToF) camera having adequate resolution.</p><p id="p0010" num="0010">It is another object of the present invention to provide a method for the detection, localisation and segmentation of hands of a user, and in particular, fingers, finger tips, palm and parameters of the hand, without<!-- EPO <DP n="6"> --> using any model or skeletal representation to be fitted or matched onto an input depth map.</p><p id="p0011" num="0011">It is another object of the present invention to provide a method for the detection, localisation and segmentation of hands of a user, and in particular, fingers, finger tips, palm and parameters of the hand, irrespective of the pose in space of the hand.</p><p id="p0012" num="0012">It is further object of the present invention to provide a method for the detection, localisation, and segmentation of a plurality of hands of at least one user standing in a scene, and using input information provided by a 3D sensing device having near mode detection capability.</p><p id="p0013" num="0013">It is another further object of the present invention to provide input data to a human-to-machine interface which utilises hand and finger gestures and/or poses for close interaction using a 3D sensing device.</p><p id="p0014" num="0014">It is a further object of the present invention to provide control of a computerised system using only the hands operating within a frustum of a 3D sensing system associated with the computerised system.</p><p id="p0015" num="0015">In accordance with a first aspect of the present invention, there is provided a method of detecting and tracking at least one feature associated with an extremity of a user in a three-dimensional scene using depth images of the scene, the method comprising the steps of:-
<ul><li>a) segmenting at least one region of interest within each depth image;</li><li>b) determining at least one object of interest that corresponds to a limb of the user within the segmented depth image;</li><li>c) tracking each limb with respect to time;</li><li>d) identifying an extremity associated with each limb;</li><li>e) tracking each identified extremity with respect to time;</li><li>f) isolating each identified extremity from its associated limb;<!-- EPO <DP n="7"> --></li><li>g) determining parameters relating to each isolated extremity;</li><li>h) identifying at least one feature in each isolated extremity; and</li><li>e) tracking each identified feature with respect to time.</li></ul></p><p id="p0016" num="0016">Step a) may comprise utilising at least one structuring element adapted to be a function of the depth of each pixel in the depth image.</p><p id="p0017" num="0017">Step c) may comprise determining temporal associations for each limb. In this case, step e) comprises tracking each extremity based on temporal associations assessed for each limb.</p><p id="p0018" num="0018">In one embodiment, step d) may further comprise using a weighted average of points of each limb in the depth image to identify each extremity.</p><p id="p0019" num="0019">In another embodiment, step f) may comprise the steps of:-
<ul><li>f1) determining a centre of each extremity associated with each limb of the user; and</li><li>f2) determining a distance from the centre of the extremity to its boundary.</li></ul></p><p id="p0020" num="0020">Additionally, step f) may further comprise using a cutting process to isolate the extremity from the limb, the cutting process being centred on the determined centre of the extremity.</p><p id="p0021" num="0021">Alternatively or additionally, step d) may further comprise using a growing process to isolate the extremity from the limb.</p><p id="p0022" num="0022">Step g) may comprise the step of determining at least one parameter associated with the extremity. Each such determined parameter associated with the extremity may be used to identify at least one feature associated with the extremity. In one embodiment, the at least one parameter associated with the extremity may comprise the orientation of the extremity within the depth image.<!-- EPO <DP n="8"> --></p><p id="p0023" num="0023">In one embodiment, step g) may further comprise using each determined parameter to determine a tip position of the extremity.</p><p id="p0024" num="0024">In one embodiment, the limb comprises an arm and the extremity comprises a hand, and wherein each feature associated with the extremity comprises at least one finger of the hand. In this case, step h) comprises identifying silhouette fingers and pointing fingers within a hand contour. In another embodiment, step h) comprises identifying each finger tip. This may be achieved by merging the identified silhouette fingers and pointing fingers to form a unique set of fingers.</p><p id="p0025" num="0025">In accordance with another aspect of the present invention, there is provided a gesture recognition method for recognising gestures made by at least one hand, comprising the method of detecting and tracking at least one feature associated with an extremity of a user in a three-dimensional scene using depth images of the scene as described above.</p><p id="p0026" num="0026">In accordance with a further aspect of the present invention, there is provided a computer program for performing the steps of the method of detecting and tracking at least one feature associated with an extremity of a user in a three-dimensional scene using depth images of the scene as described above.</p><heading id="h0004"><u>Brief Description of the Drawings</u></heading><p id="p0027" num="0027">For a better understanding of the present invention, reference will now be made, by way of example only, to the accompanying drawings in which:-
<ul><li><figref idrefs="f0001">Figure 1</figref> illustrates a flow chart illustrating the steps of the method in accordance with the present invention;</li><li><figref idrefs="f0002">Figure 2</figref> illustrates a grey scale representation of a segmentation of a human user from the background in a depth map<!-- EPO <DP n="9"> --> representing a 3D scene captured by a near mode range finding camera device;</li><li><figref idrefs="f0002">Figure 3</figref> illustrates a grey scale representation of limb segmentation in depth map representing a 3D scene captured by a near mode range finding camera device, in accordance with the present invention;</li><li><figref idrefs="f0003">Figures 4 and 5</figref> illustrate respectively tracking steps of the segmented limbs as the limbs merge in accordance with the present invention;</li><li><figref idrefs="f0004">Figures 6 and 7</figref> illustrate respective steps of 'cutting' limb extremities to isolate the hands in accordance with the present invention;</li><li><figref idrefs="f0005">Figures 8 and 9</figref> illustrate respective steps in determining centres of the isolated hands;</li><li><figref idrefs="f0006">Figures 10 and 11</figref> illustrate respective steps in hand modelling in a 3D point cloud representation of the range finding measurements, in accordance with the present invention; and</li><li><figref idrefs="f0007">Figures 12 to 14</figref> illustrate respective steps in finger detection and tracking in accordance with the present invention.</li></ul></p><heading id="h0005"><u>Description of the Invention</u></heading><p id="p0028" num="0028">The present invention will be described with respect to particular embodiments and with reference to certain drawings but the invention is not limited thereto. The drawings described are only schematic and are non-limiting. In the drawings, the size of some of the elements may be exaggerated and not drawn on scale for illustrative purposes.</p><p id="p0029" num="0029">It will be understood that the terms "vertical" and "horizontal" are used herein refer to particular orientations of the Figures and these terms are not limitations to the specific embodiments described herein.<!-- EPO <DP n="10"> --></p><p id="p0030" num="0030">The present invention is directed to detecting and tracking at least one part of at least one hand of at least one user within a scene for enabling human to computer interactions in a close interaction context. The detection and tracking aims at determining the respective position of the hand or the part of the hand which will perform interactions with respect to time so that to be able to detect and recognise, in a further step, static poses and dynamic gestures made by this hand or part of this hand and, in particular, those made by the fingers of this hand. By using depth-related information, a plurality of objects of interest in the scene are determined and segmented over different captured images. The depth-related information is obtained using a ToF camera having close interaction capability, that is, having a range below 1 m and preferably below 0.5m. The method would be suitable for use in a context in which the user stands far away from the camera or imaging device, that is, at more than 1 m from the camera, if the camera or imaging device comprises a sensor having a resolution compliant for finger detection and tracking at that distance.</p><p id="p0031" num="0031">The term "pose" as used herein refers to an arrangement of a set of key points representing the hand at a particular instant in time. The term "gesture" as used herein refers to a change in the arrangement of the key points of the hand with respect to time. In addition or alternatively, the term "gesture" may also refer to a change in the position of an unchanged arrangement of the key points in space with respect to time.</p><p id="p0032" num="0032">If the pose does not change with respect to time, that is, the arrangement of key points and its position within space remains unchanged, it is described as a static pose. If the arrangement of key points remains unchanged and the position of the arrangement changes within space with respect to time, this can be described as a gesture having static pose. If the arrangement of key points changes with respect to time, this is described as a gesture having different poses.<!-- EPO <DP n="11"> --></p><p id="p0033" num="0033">In accordance with the present invention, a method is described which provides for the detection, tracking, and modelling of the hands of a user, including in particular the fingers and the palm, based on a real-time stream of depth images acquired by a 3D sensing device. In particular, a ToF 3D camera may be used to provide the depth images in the form of 3D point clouds or depth maps. In addition, the method of the present invention can be used to detect, track and model more than one hand and utilises a smart segmentation method for isolating object of interest in the scene, namely the hands in a preferred embodiment of the present invention. However, the method is not limited to hands and can be used for tracking other extremities or potentially interacting objects the form of which is known.</p><p id="p0034" num="0034"><figref idrefs="f0001">Figure 1</figref> illustrates a flow chart 100 illustrating the steps in the method of the present invention. The first step, step 105, is to acquire a depth image which may be in the form of a 3D point cloud or of a depth map as described above. The next step is to segment limbs of a user from the rest of the depth image, step 110. The segmented limbs are tracked, step 115, and then the extremities of the tracked limbs are determined, step 120. These limb extremities are then tracked, step 125, and modelling of those extremities is performed, step 130. After the modelling, a recognition process for recognising the hands is performed, step 135, and then the geometrical modelling of the hands is performed, step 140. The fingers of the hands are then detected and tracked, step 145, and a further computation of the openness of the hands may be determined, step 150. The output from step 150 can be used, for example, for controlling an interaction with a computerised system which includes a 3D imaging system for the capture of the input 3D point cloud or depth map. Each of the steps of the process will now be described in more detail below.<!-- EPO <DP n="12"> --></p><p id="p0035" num="0035">The depth image, step 105, may be acquired by any suitable known technique, for example, using a 3D imaging system or other range finding measurement camera or imaging device which, either provides the depth image directly, or provides the depth image in the form of a 3D point cloud in a determined coordinate system. The depth image forms an input to the limbs segmentation process in step 110.</p><p id="p0036" num="0036">The 3D imaging system comprises a camera or imaging sensor having known physical parameters, for example, focal length, field of view, lens distortion etc. From this, 2D points corresponding to an object within the frustum of the imaging system in captured image together with their depth values can easily be transformed into 3D coordinates in a camera reference system. This means that real world coordinates at a given position in space can be transformed into coordinates into image space, for example, pixel units in a depth map. A radius of the erosion/dilation sphere used in the morphological opening process described in more detail below provided in the real world metric system is transformed to a radius in the depth image for each pixel independently, knowing its depth.</p><p id="p0037" num="0037">In the limbs segmentation process, step 110, the depth image forms the input and particular regions of the current depth image are delineated which correspond to objects having smaller dimensions than a predefined or threshold value in 3D space. The maximum dimension value is set to be greater than the width of the limbs and the head of a human being, but less than the width of the chest of a human being. This enables the regions to be delineated by the limbs segmentation process to include limbs and head of humans visible in the image, but not the torso nor the background.</p><p id="p0038" num="0038">The limb segmentation step may be performed using a particular adaptation of a fundamental image filtering algorithm, for example, a morphological opening process, followed by a region growing and merging<!-- EPO <DP n="13"> --> method specially adapted for the implementation of the present invention which require the use of depth map information. The morphological opening process on a real valued image comprises calculating the erosion of the image using a structuring element of predefined size which results in an 'eroded image'; and calculating the dilation of the eroded image with another structuring element.</p><p id="p0039" num="0039">Erosion is one of two fundamental operations in morphological image processing from which all other morphological operations are based. The basic idea in binary morphology is to probe an image with a simple, predefined shape, and to determine how this predefined shape fits or does not fit the shapes in the image being processed. This simple "probe" is called a structuring element, and is itself a binary image, that is, a subset of the space or grid or pixels.</p><p id="p0040" num="0040">The other of the fundamental operations in morphological image processing is dilation. Here, the basic effect of the operator on a binary image is to gradually enlarge the boundaries of regions of foreground pixels, for example, typically white pixels in a 2D image, or pixels closer than a predetermined distance in a depth map, so that areas of foreground pixels grow in size while holes within those regions become smaller. The dilation operator takes two pieces of data as inputs, namely, the image to be dilated, and a set of coordinate points, normally a small set, known as a structuring element (also known as a kernel). It is this structuring element that determines the precise effect of the dilation on the input image.</p><p id="p0041" num="0041">The use of a morphological opening process has two advantages, namely, that two different structuring elements may be used for erosion and dilation steps, and that the size of the structuring elements may be adapted for each pixel in the image according to the depth value it contains instead of using a fixed size for the whole image like in standard 2D image processing techniques. In a particular and advantageous<!-- EPO <DP n="14"> --> embodiment, the size of the structuring element, for example, a sphere having a radius r, is adapted to be a function of the depth of each pixel, that is, the distance of the pixel from the camera or 3D imaging system, so that if the element was positioned at a real world 3D position of the point corresponding to the camera coordinate system, then it would have a constant size. This provides a 'perspective invariant' opening. This means that changes in perspective of the object do not affect the size of the opening.</p><p id="p0042" num="0042">As part of the limbs segmentation step, step 110, parameters, such as, erosion radius in metres, r<sub>e</sub>, and dilation radius in metres, r<sub>d</sub>; may be determined as part of the morphological opening process. In addition, parameters, such as, a difference threshold, t, and a maximum change in depth, Δd, are applied to the input depth image as part of the limbs segmentation step. Although these parameters are derived in the limbs segmentation step, they are not used in subsequent processing steps.</p><p id="p0043" num="0043">The output from the limb segmentation step, step 110, comprises a label image which is derived from an erosion image (erosion), an opening image (dilation), an output difference image (difference), and an output region label image (labelling of connected regions).</p><p id="p0044" num="0044">For each pixel of the image having a depth, d, the erosion image is determined from a sphere by projecting, in image space, a sphere of radius r<sub>e</sub> centred on the 3D point corresponding to the pixel; and the maximum depth value of the image on this disk is calculated and assigned to the corresponding pixel of the eroded image.</p><p id="p0045" num="0045">For each pixel of the eroded image, the output opening image is determined from a disk obtained by projecting, in image space, a sphere of radius r<sub>d</sub> centred on the 3D point corresponding to the pixel; and the maximum value of the eroded image on this disk is calculated and assigned to the corresponding pixel of the opened image.<!-- EPO <DP n="15"> --></p><p id="p0046" num="0046">For each pixel of the depth image, the output difference image is determined as the difference between its depth and its value in the opening image. A pixel is considered as belonging to a 'limb' if its output difference is greater than the difference threshold, t.</p><p id="p0047" num="0047">The output region label image (connected regions labelling) is determined by marking each pair of neighboring pixels of the image as being connected if their absolute difference of depth value is smaller than the maximum change in depth, Δd; and labelling each connected component differently in accordance with the 'connected' relationship determined previously.</p><p id="p0048" num="0048">Small regions are then merged into larger adjacent regions in order to remove spurious small regions from the 'limb' segmentation determination. A connectivity based segmentation of the remaining unlabelled zones of the region label image allows one to isolate 'bodies'. An analysis of the connectivity between adjacent limbs and bodies then allows an assessment as to which limb is connected to which body.</p><p id="p0049" num="0049"><figref idrefs="f0002">Figure 2</figref> illustrates an image 200 of a human user 210 within a 3D scene in a close interaction context. As shown, the user 210 has a pair of arms 220, 230, a head 240 and a body 250. Each arm 220, 230 has an associated hand 260, 270. Following the limb segmentation step, step 110 as described above, the arms 220, 230, together with the hands 260, 270, and head 240 of the user 200 can be isolated as shown in <figref idrefs="f0002">Figure 3</figref>. The body 250 is not an object of interest and therefore does not form part of the output of the limb segmentation. Sorting objects of interest among the segmented objects may be done using depth measurements related to statistical moment analysis of the objects in the scene. For example, too large an object far from the camera may be removed while the same object close to the camera would be kept as a distance criteria for defining an object of interest may give priority to those objects. Typically, in a close<!-- EPO <DP n="16"> --> interaction context, only one or two objects closer to the camera may be considered as being of interest.</p><p id="p0050" num="0050">Having performed the limb segmentation in step 110, the next step is to perform limbs tracking, step 115 (<figref idrefs="f0001">Figure 1</figref>). In this step, 'limb' regions of a current depth image, image at t, are associated to 'limb' regions of a previous depth image, image at t-1, in a tracking process. The pair wise association is made by computing a matching score for a limb in image at t-1 and the same limb in image at t. The matching score can be a surface, or a matching surface ratio. In a preferred embodiment, the position of the pixels of each region of the previous frame can be estimated for the current frame by a state-of-the-art motion estimation algorithm. Motion can also be compensated at the region level, using a statistical value, for example, an average or a median motion.</p><p id="p0051" num="0051">Motion estimation refers to a process of determining motion vectors that describe a transformation from one image to another, for example, from image capture to image capture, and can be represented by a model that approximates rotation and translation in the X-, Y- and Z-axes. Motion vectors can be found using pixel-based techniques (also termed direct methods), for example, block matching, phase correlation and/or frequency domain methods, and pixel recursive algorithms. In the pixel-based methods, the evaluation metrics may be one or more of: minimum squared error (MSE), sum of absolute differences (SAD), mean absolute difference (MAD) and sum of squared errors (SSE). It is also possible to use indirect methods where features are matched using a statistical function, for example, random sample consensus (RANSAC), applied over a local or global area.</p><p id="p0052" num="0052">A subset of all possible associations is then computed which verifies the constraints that the retained set of associations can only model 'split' (1-n) or 'merge' (m-1) relationships. This has been described in<!-- EPO <DP n="17"> --> "<nplcit id="ncit0004" npl-type="s"><text>Comparison of image segmentations using a hierarchical model for n-m regions matchings" by L. Guigues in Proc. Of 2nd IAPR-TC15 Workshop on Graph-Based Representations, Haindorf, Austria 1999</text></nplcit>, as a graph optimisation problem. A weighted bipartite graph is defined in which each region of the previous image and the current image corresponds to a node in the graph and an edge is set between each pair of nodes belonging to different frames, that is, a previous frame and a current frame. The edges are weighted by the matching score. An optimal matching is obtained by finding the maximum weight sub graph of this association graph which has a diameter at most 2. A two step optimal procedure was proposed. In a preferred embodiment, a greedy optimisation algorithm can be used. A greedy algorithm is an algorithm that follows the problem solving heuristic of making the locally optimal choice at each stage with the hope of finding a global optimum. In some cases, a greedy strategy need not produce an optimal solution, but nonetheless a greedy heuristic may yield locally optimal solutions that approximate to a global optimal solution.</p><p id="p0053" num="0053">By using a greedy optimisation algorithm, one can start with an empty solution, the relations can be sorted in decreasing score order and the sorted relations can be scanned to include in the current solution the ones which do not lead to a new solution violating the maximum graph diameter constraint. Bodies can be tracked by the same method and then only associations between limbs connected to tracked bodies can be considered for further processing.</p><p id="p0054" num="0054">In step 120 (<figref idrefs="f0001">Figure 1</figref>), the extremities of the limbs are detected and tracked, that is, the hands in this case. In this step, a particular part of each limb is identified as a preferred extremity of the limb. In a preferred embodiment, for each limb segmented in step 110 (<figref idrefs="f0001">Figure 1</figref>), a preferred extremity is determined using a weighted average of the 3D points of the limb. The weight associated with each 3D point of the limb may depend on<!-- EPO <DP n="18"> --> the distance of the extremity to the mass centre of the limb as extremities are determined to be located at a position remote from the mass centre of the limb. This distance can be a Euclidian distance in 3D space or a geodesic distance on the limb surface.</p><p id="p0055" num="0055">Alternatively, the weight associated with each 3D point of the limb may depend on the distance to particular points in space which model preferences for extremities in specific directions in space, and that can be called 'anchor points'. Anchor points can be chosen to be located at some absolute or reference positions, such as, the camera position, or at some position relative to the limb mass centre. For example, if one uses an anchor at the camera position, then the preferred extremity selected by the method will be the closest to the camera. If one uses an anchor above and in front of the mass centre, then the preferred extremity selected by the method will by the upper-front extremity relatively to limb centre. Anchor points can be related to the relative position of the extremity in the previous frame. The method then acts as a tracking method as the extremity determined in a frame depends on the position of the extremity in a previous frame. This prevents, for example, the extremity of a limb drifting from the hand to the elbow of the user when the elbow appears to be closer to the camera or imaging device than the hand. As the tracking method is based on a weighted average, the position of an extremity is continuous with respect to the position of the 3D points corresponding to the limb being tracked. The output from the tracking process is therefore stable with respect to noise in the input data, that is, the input depth image, and is resistant to small perturbations.</p><p id="p0056" num="0056">Having detected the extremities, they are tracked based on the temporal associations assessed for limbs in the limb tracking step (step 125). Motion estimation may additionally be used to improve robustness of the tracking of the extremities of the limbs. Each new extremity found for<!-- EPO <DP n="19"> --> each limb is associated with one of: zero or none, one or multiple previous extremities through the limb associations. The same extremity identified in a previous frame can be associated with one of: zero or none, one or multiple new extremities. The temporal tracking of the limbs only retains 1-m (split) or n-1 (merge) associations and discards n-m associations.</p><p id="p0057" num="0057">The only ambiguous cases are the 'split' and 'merge' cases where one particular association needs to be selected from a multitude of possibilities in order to track extremities which have unique paths in time. This is shown in <figref idrefs="f0003">Figures 4 and 5</figref>. Here, two arms 220, 230 of a user are shown in front of the head 240. <figref idrefs="f0003">Figure 4</figref> shows the arms 220, 230 separated from one another in the vicinity of the hands 260, 270 and <figref idrefs="f0003">Figure 5</figref> shows the situation where hand 260 of arm 220 is merged with hand 270 of arm 230. It will be appreciated that, although not shown, the split case starts as shown in <figref idrefs="f0003">Figure 5</figref> and the hand 260 of arm 220 is split from hand 270 of arm 230.</p><p id="p0058" num="0058">For the 'split' case, the selection of the extremity from among the different possibilities in new frame (tracking an extremity detected in a previous frame) can be determined using, for example, distance, overlap in 2D or 3D, etc. For the 'merge' case, the selection of the extremity from among the different possibilities in a previous frame (tracking an extremity detected in a current frame) can be done by using, for example, distance, overlap, or a particular criterion associated with the extremities in a previous frame, such as, their 'age' parameter (time since detection) or a preference for extremities that were detected as hands in the past.</p><p id="p0059" num="0059">Once the positions of the extremities and the tracking of the extremities have been computed, in the extremities modelling step, step 130, the positions of the centres are refined to match a particular point of the limb which has a particular morphological or geometrical property. <figref idrefs="f0004">Figure 6</figref> illustrates the arms 220, 230, with their associated hands 260, 270, and<!-- EPO <DP n="20"> --> head 240 to which the centres are applied, and <figref idrefs="f0004">Figure 7</figref> illustrates the centres 340 applied to the head 240 and centres 360, 370 applied to each hand 260, 270 on respective arms 220, 230 (<figref idrefs="f0004">Figure 6</figref>). In a preferred embodiment, one can choose the position of the central point of the shape as the applied centre, the central point of the shape being the farthest point from the contours of the limb. This point can be efficiently determined by computing a distance of the point to the contours of the limb. In a refinement, a tracking method can be used to match, not the absolute central point of the limb, but a point which is a local maximum of the distance function which is close to the previous refined position of the extremity. Additionally, if the distance function is viewed as a density then a more robust mode estimation method can be used, such as, a mean-shift estimation. One then has a mean-shift like tracking method specifically designed to track the central point of a limb.</p><p id="p0060" num="0060">A subset of the points of the segmented limb are selected which may constitute points of the relevant extremity region. This selection can be done by either a 'cutting' method or a 'growing' method.</p><p id="p0061" num="0061">In the 'cutting' method, points are excluded from the extremity regions which are outside a particular region defined around the refined centre of the extremity. The particular region may be a sphere centred on the centre of the extremity; a half space, that is, one of two portions of 3D space separated by a plane, defined by a plane located between the extremity centre and the limb centre; or an orthogonal to the vector joining the points corresponding to the centres of the extremity, that is, the centre of the hand, and the limb, that is, the forearm. The geometrical properties of the cutting region can result from a continuous learning mechanism of some properties of the extremity, such as, the maximum distance of the refined extremity centre to the contour of the limb, computed in 3D camera<!-- EPO <DP n="21"> --> coordinates, which is an estimate of the radius of the palm in the case where the extremity is a human hand.</p><p id="p0062" num="0062">In the 'growing' method, a 'secure' set of points of the limb to be excluded from the extremity region is identified. This set of points may comprise the farthest points from the extremity centre. The identified set of points form 'seed' points which are then grown until the growing points enter a 'sure' inclusion zone, which can be defined in a similar way as that for the 'cutting' method described above.</p><p id="p0063" num="0063"><figref idrefs="f0005">Figure 8</figref> illustrates the segmented arms 220, 230, together with the hands 260, 270, and head 240 without the centres applied and <figref idrefs="f0005">Figure 9</figref> illustrates the effect of the isolation of hands 260, 270 from the arms 220, 230 (<figref idrefs="f0005">Figure 8</figref>).</p><p id="p0064" num="0064">In step 135, a hands recognition process is performed. A state-of-the art method may be used to identify known features of the hand, for example, in "<nplcit id="ncit0005" npl-type="s"><text>Hand recognition using geometric classifiers" by Y. Bulalov, S. Jambawalikar, P. Kumar &amp; S. Sethia, published on the intern</text></nplcit>et at: <u>http://www.ams.sunysb.edu/∼saurabh/research/hand_workshop.pdf</u>and in <nplcit id="ncit0006" npl-type="s"><text>"Hands gesture recognition" by A. Kirillov, May 2008 and availab</text></nplcit>le at: <u>http://www.codeproject.com/Articles/26280/Hands-Gesture-Recognition</u>. The output from this step can be fed back to the limb tracking step, step 115, and used as a verification for any assumptions made in that step.</p><p id="p0065" num="0065">In step 140, the modelling of the hands is performed. This comprises at least the determination of the hand orientation and the determination of hand tip position. For the hand orientation, principal component analysis (PCA) is performed on 3D points corresponding to the hand as determined in step 135 above. This effectively solves an eigen system of a covariance matrix. In order to perform temporal filtering on the determined principal axis of the hand, first order auto-regressive temporal<!-- EPO <DP n="22"> --> smoothing of the covariance matrix can be performed before solving the eigen system, in accordance with: <maths id="math0001" num=""><math display="block"><mi mathvariant="italic">Cov</mi><mfenced><mi>t</mi></mfenced><mo>=</mo><mi mathvariant="italic">RawCov</mi><mfenced><mi>t</mi></mfenced><mo>*</mo><mi>a</mi><mo>+</mo><mi mathvariant="italic">Cov</mi><mo>⁢</mo><mfenced separators=""><mi>t</mi><mo>-</mo><mn>1</mn></mfenced><mo>*</mo><mfenced separators=""><mn>1</mn><mo>-</mo><mi>α</mi></mfenced></math><img id="ib0001" file="imgb0001.tif" wi="73" he="4" img-content="math" img-format="tif"/></maths><br/>
where cov(t-1) and cov(t) are the smooth covariance matrix respectively at time t-1 and t; RawCov(t) is the raw covariance matrix computed at time t; and alpha is a parameter which tunes the level of smoothing.</p><p id="p0066" num="0066">The first determined eigen vector provides an estimate of the principal direction or principal axis of the hand, and the third determined eigen vector provides an estimate of the palm normal. The second determined eigen vector is orthogonal to both the first and third determined eigen vectors. These eigen vectors are illustrated in <figref idrefs="f0006">Figure 10</figref>.</p><p id="p0067" num="0067">In <figref idrefs="f0006">Figure 10</figref>, a hand 400 is shown with a centre point 410 located in the centre of the palm. Three axes 420, 430, 440 are centred at that centre point 410 with axis 430 being the normal to the palm, axis 440 indicating the principal direction of the hand 400, and axis 420 being orthogonal to axes 430 and 440. These axes correspond to the eigen vectors described above.</p><p id="p0068" num="0068">Having determined the hand orientation, a maximum hand tip position 450 is determined, that is, the position that is the furthest from the centre point 410, as shown in <figref idrefs="f0006">Figure 11</figref>. A histogram of 3D points of the hand in a hand principal direction is determined and the farthest points are averaged. Typically, these farthest points may be determined as being , for example, in the range of 95% to 99% of histogram. The hand tip position 350 is then stabilised with respect to time. As alternatives, the previous maximum hand tip position can be used on its own or as a blend with hand principal direction, as indicated by axis 440 (<figref idrefs="f0006">Figure 10</figref>), instead of hand principal direction only.<!-- EPO <DP n="23"> --></p><p id="p0069" num="0069">The precise determination of the tip of the hand can then be used to correct the estimate of the palm normal direction provided by PCA analysis in step 135 above, and, in particular, to give a better determination in case the third eigen vector is ill-defined. This corresponds to the case in which the hand is not sufficiently flat to get a well defined orientation using a planar model, for example, when the hand is in the form of a fist or where the fingers are pinched. The flatness information is provided by the eigen values of the system. More precisely, the flatness information is indicated by the ratio of the second eigen value to the third eigen value. Further information is provided by the extension of the hand which can be measured by the distance from the tip of the hand to the centre of the palm, normalised by the palm radius. The estimate of the palm normal direction is then refined by blending it with the direction of the tip of the hand with a weight which depends on the flatness and the extension of the hand.</p><p id="p0070" num="0070">In step 145, fingers of the hand are then individually detected and tracked. The term "fingers" as used here also includes the thumb. First, the 'silhouette' fingers 510, 520, 530, 540, 550 in the hand 500 are detected as shown in <figref idrefs="f0007">Figure 12</figref>. The 'silhouette' fingers are those that are visible in the hand contour as shown. 'Pointing' fingers are detected, that is, those fingers pointing towards the imaging device or camera as shown by finger 560 in <figref idrefs="f0007">Figure 13</figref>. The detected 'silhouette' fingers and 'pointing' fingers are merged into a unique set of fingers avoiding duplicating fingers that are detected in both the silhouette and pointing configurations. This merger is achieved by checking whether each 'pointing' finger corresponds to the same finger as a 'silhouette' finger. If this is the case, that finger is discarded. The check can rely on the distance between the two detected fingers, the most reliable criterion using a geodesic distance. The unique set of fingers can then be tracked as shown in <figref idrefs="f0007">Figure 14</figref>.<!-- EPO <DP n="24"> --></p><p id="p0071" num="0071">The detection of 'silhouette' fingers 510, 520, 530, 540, 550 can be achieved by using extremities of a morphological skeleton, or by determining a minimum of the curvature of the hand contour. One method for the detection of 'silhouette' fingers is described in "<nplcit id="ncit0007" npl-type="s"><text>An Analysis of Features for Hand-Gesture Classification" by Thiago R. Trigo and Sergio Roberto M. Pellegrino, IWSSIP 2010, 17th International Conference on Systems, Signals and Image Processing</text></nplcit>. Here, shape descriptors such as aspect ratio, circularity, and spreadness are used together with other features, such as roundness, solidity, number of fingers, and relation "distance-radius".</p><p id="p0072" num="0072">The detection of pointing fingers 560 can be achieved by identifying local minima in a smooth depth image. In order to retain only the minima which correspond to the local shape of a fingertip, a number of one-dimensional profiles of the local minima are examined in a predefined number of directions. Various criteria are checked against each of these one-dimensional profiles. For the tracking portion of step 145, mappings between fingers 510, 520, 530, 540, 550 of a previous frame and those in a current frame are performed including a no match possibility. For each possible mapping, an optimal rigid transform is computed between fingers in the previous frame and associated ones in the current frame. The optimal rigid transform, that is, a 3D translation and rotation, is computed using a least squares determination. A better determination of the transform can be obtained by including the mapping between finger base positions and palm position. For each possible finger association, an error value is computed which comprises the weighted sum of the distances from fingers in the current frame to the rigidly transformed fingers in the previous frame (measuring the hand deformation); the norm of translation and rotation of the rigid transform (measuring the hand global movement); and the number of<!-- EPO <DP n="25"> --> unmatched fingers (fixed cost for appearing or disappearing fingers). The association which leads to the least error is retained.</p><p id="p0073" num="0073">For the additional hand openness parameter computation, step 150, a continuous "openness" variable is computed using a combination of different measurements. These measurements may be the maximum distance between fingers; the maximum distance between fingers and palm or between the tip of the hand and the palm. The combination can be a linear combination or a maximum value. This continuous "openness" variable is then binarised into a Boolean state, that is, hand open or hand closed, by first performing a temporal filtering to remove noise and then normalising by the largest value that has been observed since the hand was detected. A hysteresis threshold may then be applied to obtain the desired binary state.</p><p id="p0074" num="0074">Having completed the steps described with reference to <figref idrefs="f0001">Figure 1</figref>, the output data and parameters can then be used in computerised systems utilising finger tracking applications to perform human to machine interactions and, in particular, to perform hand and finger based close interactions using range finding imaging devices and the means for processing it.</p></description><claims mxw-id="PCLM56976393" lang="EN" load-source="patent-office"><!-- EPO <DP n="26"> --><claim id="c-en-0001" num="0001"><claim-text>A method of detecting and tracking at least one feature associated with an extremity of a user in a three-dimensional scene using depth images of the scene, the method comprising the steps of:-
<claim-text>a) segmenting at least one region of interest within each depth image;</claim-text>
<claim-text>b) determining at least one object of interest that corresponds to a limb of the user within the segmented depth image;</claim-text>
<claim-text>c) tracking each limb with respect to time;</claim-text>
<claim-text>d) identifying an extremity associated with each limb;</claim-text>
<claim-text>e) tracking each identified extremity with respect to time;</claim-text>
<claim-text>f) isolating each identified extremity from its associated limb;</claim-text>
<claim-text>g) determining parameters relating to each isolated extremity;</claim-text>
<claim-text>h) identifying at least one feature in each isolated extremity; and</claim-text>
<claim-text>i) tracking each identified feature with respect to time.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>A method according to claim 1, wherein step a) comprises utilising at least one structuring element adapted to be a function of the depth of each pixel in the depth image.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>A method according to claim 1 or 2, wherein step c) comprises determining temporal associations for each limb.</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>A method according to claim 3, wherein step e) comprises tracking each extremity based on temporal associations assessed for each limb.<!-- EPO <DP n="27"> --></claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>A method according to any one of the preceding claims, wherein step d) further comprises using a weighted average of points of each limb in the depth image to identify each extremity.</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>A method according to any one of the preceding claims, wherein step f) comprises the steps of:-
<claim-text>f1) determining a centre of each extremity associated with each limb of the user; and</claim-text>
<claim-text>f2) determining a distance from the centre of the extremity to its boundary.</claim-text></claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>A method according to claim 6, wherein step f) further comprises using a cutting process to isolate the extremity from the limb, the cutting process being centred on the determined centre of the extremity.</claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>A method according to claim 6 or 7, wherein step f) further comprises using a growing process to isolate the extremity from the limb.</claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>A method according to any one of claims 6 to 8, wherein step g) comprises the step of determining at least one parameter associated with the extremity.</claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>A method according to claim 9, wherein step g) further comprises the step of using each determined parameter associated with the extremity to identify at least one feature associated with the extremity.<!-- EPO <DP n="28"> --></claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>A method according to claim 9 or 10, wherein the at least one parameter associated with the extremity comprises the orientation of the extremity within the depth image.</claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>A method according to any one of claims 9 to 11, wherein step g) further comprises using each determined parameter to determine a tip position of the extremity.</claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>A method according to any one of claims 9 to 12, wherein the limb comprises an arm and the extremity comprises a hand, and wherein each feature associated with the extremity comprises at least one finger of the hand.</claim-text></claim><claim id="c-en-0014" num="0014"><claim-text>A method according to claim 13, wherein step h) comprises identifying silhouette fingers and pointing fingers within a hand contour.</claim-text></claim><claim id="c-en-0015" num="0015"><claim-text>A method according to claim 14, wherein step h) comprises merging the identified silhouette fingers and pointing fingers to form a unique set of fingers.</claim-text></claim><claim id="c-en-0016" num="0016"><claim-text>A gesture recognition method for recognising gestures made by at least one hand, comprising the method of detecting and tracking at least one feature associated with an extremity of a user in a three-dimensional scene using depth images of the scene according to any one of claims 13 to 15.</claim-text></claim><claim id="c-en-0017" num="0017"><claim-text>A computer program for performing the steps of the method of detecting and tracking at least one feature associated with an<!-- EPO <DP n="29"> --> extremity of a user in a three-dimensional scene using depth images of the scene according to any one of the preceding claims.</claim-text></claim></claims><drawings mxw-id="PDW16667174" load-source="patent-office"><!-- EPO <DP n="30"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="114" he="209" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="31"> --><figure id="f0002" num="2,3"><img id="if0002" file="imgf0002.tif" wi="134" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="32"> --><figure id="f0003" num="4,5"><img id="if0003" file="imgf0003.tif" wi="132" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="33"> --><figure id="f0004" num="6,7"><img id="if0004" file="imgf0004.tif" wi="134" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="34"> --><figure id="f0005" num="8,9"><img id="if0005" file="imgf0005.tif" wi="134" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="35"> --><figure id="f0006" num="10,11"><img id="if0006" file="imgf0006.tif" wi="141" he="227" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="36"> --><figure id="f0007" num="12,13,14"><img id="if0007" file="imgf0007.tif" wi="140" he="233" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="161" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="158" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
