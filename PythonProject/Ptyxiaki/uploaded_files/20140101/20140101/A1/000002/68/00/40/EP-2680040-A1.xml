<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2680040-A1" country="EP" doc-number="2680040" kind="A1" date="20140101" family-id="36916933" file-reference-id="287040" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146549529" ucid="EP-2680040-A1"><document-id><country>EP</country><doc-number>2680040</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-13186218-A" is-representative="NO"><document-id mxw-id="PAPP154823452" load-source="docdb" format="epo"><country>EP</country><doc-number>13186218</doc-number><kind>A</kind><date>20060209</date><lang>EN</lang></document-id><document-id mxw-id="PAPP226229720" load-source="docdb" format="original"><country>EP</country><doc-number>13186218.7</doc-number><date>20060209</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140449081" ucid="EP-06734717-A" linkage-type="3" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>06734717</doc-number><kind>A</kind><date>20060209</date></document-id></priority-claim><priority-claim mxw-id="PPC140446808" ucid="EP-12168497-A" linkage-type="3" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>12168497</doc-number><kind>A</kind><date>20060209</date></document-id></priority-claim><priority-claim mxw-id="PPC140445313" ucid="US-5664005-A" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>5664005</doc-number><kind>A</kind><date>20050212</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988128983" load-source="docdb">G01V   1/28        20060101AFI20131118BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL2072234716" load-source="docdb" scheme="CPC">G01V   1/362       20130101 FI20140430BHEP        </classification-cpc><classification-cpc mxw-id="PCL2072235098" load-source="docdb" scheme="CPC">G01V2210/522       20130101 LA20140428BHEP        </classification-cpc><classification-cpc mxw-id="PCL2072241713" load-source="docdb" scheme="CPC">G01V2210/52        20130101 LA20140428BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132181071" lang="DE" load-source="patent-office">Verfahren und Vorrichtung für echte relative Amplitudenkorrektur seismischer Daten für normale Moveout-Streckeffekte</invention-title><invention-title mxw-id="PT132181072" lang="EN" load-source="patent-office">Method and apparatus for true relative amplitude correction of seismic data for normal moveout stretch effects.</invention-title><invention-title mxw-id="PT132181073" lang="FR" load-source="patent-office">Procédé et appareil de correction de l'amplitude relative réelle de données sismiques permettant d'obtenir des effets d'étirement avec obliquité</invention-title><citations><patent-citations><patcit mxw-id="PCIT242652602" load-source="docdb" ucid="US-4747054-A"><document-id format="epo"><country>US</country><doc-number>4747054</doc-number><kind>A</kind><date>19880524</date></document-id><sources><source name="SEA" category="A" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242652604" load-source="docdb" ucid="US-5684754-A"><document-id format="epo"><country>US</country><doc-number>5684754</doc-number><kind>A</kind><date>19971104</date></document-id><sources><source name="APP" created-by-npl="N"/><source name="SEA" category="X" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242652605" load-source="docdb" ucid="US-6516275-B2"><document-id format="epo"><country>US</country><doc-number>6516275</doc-number><kind>B2</kind><date>20030204</date></document-id><sources><source name="APP" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242652606" load-source="docdb" ucid="WO-2002065372-A1"><document-id format="epo"><country>WO</country><doc-number>2002065372</doc-number><kind>A1</kind><date>20020822</date></document-id><sources><source name="SEA" category="X" created-by-npl="N"/></sources></patcit></patent-citations><non-patent-citations><nplcit><text>R. M. BRACEWELL: "The Fourier Transform and Its Applications", 1995, MCGRAW-HILL, pages: 101 - 104</text><sources><source mxw-id="PNPL69958943" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>R. M. BRACEWELL: "The Fourier Transform and Its Applications", MCGRAW-HILL, pages: 104 - 107</text><sources><source mxw-id="PNPL69958944" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>SWAN, H.W.: "Removal of Offset-Dependent Tuning in AVO Analysis", EXPANDED ABSTRACTS OF 67TH ANNUAL, INT. SEG MTG., 1997, pages 175 - 178</text><sources><source mxw-id="PNPL69958945" load-source="docdb" name="APP"/></sources></nplcit></non-patent-citations></citations></technical-data><related-documents><relation type="division"><child-doc ucid="EP-13186218-A"><document-id load-source="patent-office" format="epo"><country>EP</country><doc-number>13186218</doc-number><kind>A</kind><date>20060209</date></document-id></child-doc><parent-doc ucid="EP-06734717.9"><document-id load-source="patent-office" format="epo"><country>EP</country><doc-number>06734717.9</doc-number><date>20060209</date></document-id></parent-doc></relation><relation type="division"><child-doc ucid="EP-13186218-A"><document-id load-source="patent-office" format="epo"><country>EP</country><doc-number>13186218</doc-number><kind>A</kind><date>20060209</date></document-id></child-doc><parent-doc ucid="EP-12168497.1"><document-id load-source="patent-office" format="epo"><country>EP</country><doc-number>12168497.1</doc-number><date>20120518</date></document-id><parent-grant-document ucid="EP-2511735-B1"><document-id><country>EP</country><doc-number>2511735</doc-number><kind>B1</kind><date>20140514</date></document-id></parent-grant-document></parent-doc></relation></related-documents><parties><applicants><applicant mxw-id="PPAR918160030" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>CHEVRON USA INC</last-name><address><country>US</country></address></addressbook></applicant><applicant mxw-id="PPAR918157834" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>CHEVRON U.S.A. INC.</last-name></addressbook></applicant><applicant mxw-id="PPAR918987969" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Chevron U.S.A. Inc.</last-name><iid>101046043</iid><address><street>6001 Bollinger Canyon Road Building T, 3rd Floor</street><city>San Ramon, CA 94583-2324</city><country>US</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918170282" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>HERKENHOFF FREDERIC E</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918142982" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>HERKENHOFF, FREDERIC E.</last-name></addressbook></inventor><inventor mxw-id="PPAR918984002" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>HERKENHOFF, FREDERIC E.</last-name><address><street>27 Bel Air Drive</street><city>Orinda, Ca California 94563</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918165871" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>ALFORD RICHARD B</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918165344" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>ALFORD, RICHARD B.</last-name></addressbook></inventor><inventor mxw-id="PPAR918988018" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>ALFORD, RICHARD B.</last-name><address><street>1730 Argonne Drive</street><city>Concord, CA California 94518</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918133756" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>MARTIN HARRY L</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918140211" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>MARTIN, HARRY L.</last-name></addressbook></inventor><inventor mxw-id="PPAR918987011" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>MARTIN, HARRY L.</last-name><address><street>185 Copper Ridge Road</street><city>San Ramon, CA California 94583</city><country>US</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918983651" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Claydon, Michelle Leonie</last-name><iid>101410661</iid><address><street>Haseltine Lake LLP Redcliff Quay 120 Redcliff Street</street><city>Bristol BS1 6NH</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS548888475" load-source="docdb">FR</country><country mxw-id="DS548867217" load-source="docdb">GB</country><country mxw-id="DS548873149" load-source="docdb">NL</country></ep-contracting-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128670198" lang="EN" load-source="patent-office"><p id="pa01" num="0001">The present invention provides a method and apparatus for arriving at true relative amplitude destretched seismic traces from stretched seismic traces. The method compensates for offset varying reflection interference effects due to normal moveout. Stretch factors β and also input spectra are determined for NMOR stretched seismic traces. Estimates are then made of stretched wavelet spectra from the input spectra. A destretched wavelet spectra is then obtained. Shaping correction factors are determined by taking the ratio of the destretched wavelet spectra to the stretched wavelet spectra and are applied to the input spectra of the stretched traces to arrive at a destretched trace spectra. True relative amplitude scaling factors are computed by taking the ratio of a true relative amplitude property of the destretched wavelet spectra to a corresponding true relative amplitude property of the stretched wavelet spectra. Finally, the true relative amplitude scaling factors are applied to the destretched trace spectra to arrive at true relative amplitude destretched seismic traces.
<img id="iaf01" file="imgaf001.tif" wi="86" he="68" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128499571" lang="EN" source="EPO" load-source="docdb"><p>The present invention provides a method and apparatus for arriving at true relative amplitude destretched seismic traces from stretched seismic traces. The method compensates for offset varying reflection interference effects due to normal moveout. Stretch factors ² and also input spectra are determined for NMOR stretched seismic traces. Estimates are then made of stretched wavelet spectra from the input spectra. A destretched wavelet spectra is then obtained. Shaping correction factors are determined by taking the ratio of the destretched wavelet spectra to the stretched wavelet spectra and are applied to the input spectra of the stretched traces to arrive at a destretched trace spectra. True relative amplitude scaling factors are computed by taking the ratio of a true relative amplitude property of the destretched wavelet spectra to a corresponding true relative amplitude property of the stretched wavelet spectra. Finally, the true relative amplitude scaling factors are applied to the destretched trace spectra to arrive at true relative amplitude destretched seismic traces.</p></abstract><description mxw-id="PDES63955628" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><u>TECHNICAL FIELD</u></heading><p id="p0001" num="0001">The present invention relates generally to methods of analyzing seismic reflection data for subsurface properties, and more particularly, to a method to compensate for offset varying reflection interference effects due to normal moveout removal (NMOR) that are present in common midpoint (CMP) or common reflection point traces (CRP) seismic gathers of traces.</p><heading id="h0002"><u>BACKGROUND OF THE INVENTION</u></heading><p id="p0002" num="0002">Seismic data obtained in field surveys are typically recorded using a common midpoint (CMP) field technique as shown in <figref idrefs="f0001">FIG. 1</figref>. Acoustic energy in the form of a wave train is introduced into the earth from a series of "shot" sources S which are spaced apart from a common midpoint (CMP). Energy from each of the sources S strikes a common subsurface reflection point (CRP) and a portion of that energy is returned to a series of spaced apart receivers R. Using this acquisition technique, gathers of traces are recorded which are characterized by increasing shot to receiver offset distance and a common known surface (CMP) or common subsurface reflection point (CRP). These gathers of traces contain recordings of desirable signals that have been reflected from the common reflection point (CRP) of the subsurface at various reflection angles θ<sub>r</sub> and/or refracted from subsurface formations. Further, the recorded traces also include other unwanted components, i.e. noise, in addition to the desired signals.</p><p id="p0003" num="0003">A reflection coefficient is a measure of the ratio of reflected wave to incident wave amplitudes, indicating how much energy is reflected from a subsurface interface. Reflection coefficients are a function of a subsurface formation's elastic properties, including changes at interfaces in compressional wave velocity, shear velocity and density. In reflection seismic art, the earth's reflection coefficients are recovered<!-- EPO <DP n="2"> --> below a common known surface location from the recorded seismic amplitude response or seismic traces. The actual seismic disturbance from a single reflecting interface is characterized by a time varying response or wavelet that is related to the earth's overburden properties as well as to the reflection seismic acquisition equipment.</p><p id="p0004" num="0004">A wavelet is a one-dimensional pulse characterized by amplitude, frequency, and phase. The wavelet originates as a packet of energy from a source S, having a specific origin in time, and is returned to receivers R as a series of events or reflected wavelets distributed in time and energy. This distribution is dependent upon velocity and density in the subsurface and the relative position of the sources S and receivers R.</p><p id="p0005" num="0005">The field recorded traces of a CMP gather are typically subjected to a number of steps in a processing sequence to separate the desired signals from noise, to reduce the effect of time and offset varying wavelets and to align and compare amplitude responses from common interfaces. An important step in trace alignment is to apply normal moveout removal NMOR to the data either directly in an NMOR application or indirectly through a prestack imaging step. Travel times to common subsurface interfaces for differing shot to group offsets are calculated using the CMP gather acquisition geometry and estimates of the subsurface propagation velocity of seismic energy traveling from the shot location to a common subsurface reflection point (CRP) and then back to a receiver location. The differences in travel time between zero and non-zero shot to receiver offsets are used to map the amplitudes of traces from field record time coordinates to zero offset time coordinates. After application of NMOR, whether directly applied to CMP gather traces or indirectly applied within a prestack migration to generate CRP gather traces, amplitudes of signal traces in the gather can then be (1) summed together to form stacked traces; (2) compared to one another within an amplitude versus offset (AVO) analysis; or (3) inverted for amplitude attributes from which detailed interface properties are to be deduced from changes in amplitude response.</p><p id="p0006" num="0006"><figref idrefs="f0002">FIGS. 2A-C</figref> illustrate the effect of wavelets and normal moveout removal (NMOR) on a single time-offset CMP gather made up of identical, equal amplitude reflections<!-- EPO <DP n="3"> --> from a layered earth model composed of randomly spaced subsurface interfaces. <figref idrefs="f0002">FIG. 2A</figref> shows a CMP gather of interface reflection coefficients (RC series) illustrating the moveout effect (time convergence) of reflections from different interfaces. <figref idrefs="f0002">FIG. 2B</figref> depicts the same CMP gather with each reflection coefficient replaced by a wavelet whose amplitude is proportional to the reflection coefficient. Offset varying interference effects are shown in the form of offset varying amplitudes for a common event. <figref idrefs="f0002">FIG. 2C</figref> presents the data of <figref idrefs="f0002">FIG. 2B</figref> after application of NMOR demonstrating that moveout has generated offset varying wavelets which result in offset varying amplitudes for the equal reflection coefficients. Note in <figref idrefs="f0002">FIG. 2C</figref> that there are changes in reflection amplitude and bandwidth which are due to pre-NMOR wavelet interference as well as to NMOR correction. As a result, amplitudes in traces from different offsets differ from one another even when the underlying reflection coefficients are equal. Therefore, these NMOR corrected amplitudes are not considered to be of "true relative amplitude."</p><p id="p0007" num="0007">Especially because of ongoing deep water exploration and development efforts, AVO analysis and inversion are now being applied to CRP trace gathers containing processed seismic amplitudes that have been reflected from subsurface interfaces at reflection angles from 0° to 60° or more. As shown by <figref idrefs="f0003">FIG. 3</figref> depicting the amplitude spectrum of a single event reflected from an interface at angle θ<sub>r</sub>, application of NMOR will map the amplitude spectrum and phase spectrum of a seismic wavelet to frequencies equal to cos θ<sub>r</sub> times the original pre-NMOR frequency while also amplifying the amplitude spectrum of the data by a factor of (cos θ<sub>r</sub>)<sup>-1</sup> relative to the zero angle reflected event. Accordingly, for a 60° reflected event, NMOR will shift an 40 Hz amplitude response to 20 Hz while doubling the strength of the amplitude spectrum. Wavelets have both an amplitude spectrum and a phase spectrum. For the purposes of this specification, here after the term "spectra" refers to both of the amplitude spectrum and phase spectrum of a wavelet.</p><p id="p0008" num="0008">When multiple reflection events are present, NMOR stretches the interfering event response differently at each offset resulting in a more complex offset dependent interference as shown in <figref idrefs="f0002">FIG. 2C</figref>. Such NMOR stretch effects make it difficult to directly compare common event amplitude strengths from different offset traces to<!-- EPO <DP n="4"> --> one another. Another complexity is that even after extensive processing, traces in a CMP gather will typically have embedded wavelets which vary with both time and offset. These wavelet variations are due to remaining acquisition and propagation effects and to NMOR stretch effects. Velocity analysis, which is required to align events between near and far offsets, also becomes problematic when amplitude responses for a common event vary significantly from near to far offsets. Moreover, at high frequencies NMOR stretch will reduce the signal-to-noise ratio improvements normally expected as a result of stacking seismic traces together.</p><p id="p0009" num="0009"><patcit id="pcit0001" dnum="US5684754A"><text>U.S. Patent No. 5,684,754 to Byun et. al</text></patcit> teaches a method for removal of NMOR stretch from CMP gather traces. This method relies on prior knowledge of an embedded wavelet and the measurement of a NMOR stretch factor from a semblance analysis of seismic data. This technique does not provide a true relative amplitude compensation of NMOR induced amplitude effects and is thus is less than desirable for AVO analysis.</p><p id="p0010" num="0010"><nplcit id="ncit0001" npl-type="s"><text>Swan, H.W., 1997, "Removal of Offset-Dependent Tuning in AVO Analysis", Expanded Abstracts of 67th Annual, Int. SEG Mtg., pp. 175-178</text></nplcit>, teaches a method for reduction of NMOR stretch effects from AVO attributes (e.g. AVO intercepts and gradients) that are computed from NMOR processed traces that are not compensated for NMOR stretch effects. As a result, this method has the shortcoming of not being applicable for the correction of CMP or CRP gather traces.</p><p id="p0011" num="0011"><patcit id="pcit0002" dnum="US6516275B"><text>U.S. Patent No. 6,516,275 to Lazaratos</text></patcit> describes removing wavelet stretch effects from seismic traces prior to operations such as stacking or computing AVO attributes. A method for destretching individual traces is taught in which time and offset varying filters are used to match the response of stretched, nonzero offset traces to that of a zero offset (and destretched) trace. Because this method involves making each nonzero offset trace match a zero offset trace by designing and applying an equalization filter, the method can alter relative amplitude relationships between traces when reflectivity strength varies. This method fails to restore trace amplitudes to the relative values consistent with each traces' reflectivity being convolved with a pre-NMOR wavelet. To be true amplitude this method must assume that all<!-- EPO <DP n="5"> --> pre-NMOR traces have the same wavelets as the zero offset pre-NMOR trace. Moreover, this method also implicitly assumes that the reflectivity of each trace averaged in time has the same value at all offsets as it does on the zero offset trace ---an assumption that is generally not met across a wide range of offsets or reflection angles.</p><p id="p0012" num="0012">Accordingly, there is a need for a method and apparatus which overcome shortcomings of previous methods and apparatus which fail to destretch seismic traces so as to recover true relative amplitudes of seismic reflections between traces of differing offsets. More particularly, these methods fail to compensate for offset varying reflection interference effects due to normal moveout. The present invention provides a solution to these shortcomings.</p><heading id="h0003"><u>SUMMARY OF THE INVENTION</u></heading><p id="p0013" num="0013">Seismic traces may be stretched due to direct normal moveout removal (NMOR) processing or stretched indirectly through a prestack imaging processing step. The present invention provides a method for arriving at true relative amplitude destretched seismic traces from such stretched seismic traces. In particular, the method compensates for offset varying reflection interference effects due to normal moveout.</p><p id="p0014" num="0014">In a preferred embodiment of this method, stretch factors β and also input spectra are determined for NMOR stretched seismic traces. Estimates are then made of stretched wavelet spectra from the input spectra. A destretched wavelet spectra is then obtained which may be either the same wavelet that was embedded in the seismic data traces prior to NMOR or else by using an externally specified target wavelet. Shaping correction factors are then determined by taking the ratio of the destretched wavelet spectra to the stretched wavelet spectra. The shaping correction factors are applied to the input spectra of the stretched traces to arrive at destretched trace spectra.</p><p id="p0015" num="0015">True relative amplitude scaling factors are then computed by taking the ratio of a true relative amplitude property of the destretched wavelet spectra to a corresponding true relative amplitude property of the stretched wavelet spectra. Examples of true relative<!-- EPO <DP n="6"> --> amplitude properties, by way of example and not limitation, might include the zero time value of a wavelet, the area under the amplitude spectrum of the wavelet, or the time average mean absolute value of the stretched traces. Finally, the true relative amplitude scaling factors are applied to the destretched trace spectra to arrive at true relative amplitude destretched seismic traces whereby the true relative amplitude property of the stretched wavelet spectra is substantially preserved.</p><p id="p0016" num="0016">The destretched wavelet spectra may be obtained by mapping the stretched wavelet spectra into the destretched wavelet spectra utilizing the similarity theorem and the stretch factor. Further, the target wavelet spectra can be modified to correct for non-white reflectivity. The stretch factors are preferably calculated deterministically as functions of variables such as offset, time, rms velocity, interval velocity, overburden anisotropy and geologic dip. Examples of gathers of traces for which stretch factors may be calculated include CDP, DMO or CRP gathers.</p><p id="p0017" num="0017">An objective of the present invention is to correct the changes in reflection amplitude and bandwidth induced due to NMOR processing of traces so that amplitudes from traces of different offsets are substantially proportional to the underlying reflection coefficient and identical to one another (true relative amplitude) when the underlying reflection coefficients are equal.</p><heading id="h0004"><u>BRIEF DESCRIPTION OF THE DRAWINGS</u></heading><p id="p0018" num="0018">These and other objects, features and advantages of the present invention will become better understood with regard to the following description, pending claims and accompanying drawings where:
<ul><li><figref idrefs="f0001">FIG. 1</figref> is a schematic drawing showing the geometry of acquisition of a common midpoint (CMP) gather of traces wherein shot sources S produce energy which is reflected from a common reflection point (CRP) and recorded by receivers R;</li><li><figref idrefs="f0002">FIGS. 2A-C</figref> illustrate a CMP gather of interface reflection coefficients (RC series), the same CMP gather with each reflection coefficient replaced by a wavelet whose<!-- EPO <DP n="7"> --> amplitude is proportional to a respective reflection coefficient, and the CMP gather after the removal of normal moveout (NMO);</li><li><figref idrefs="f0003">FIG. 3</figref> is a graph illustrating the effect of stretch on a wavelet amplitude spectrum with maximum amplitude being enhanced and shifted to a lower frequency due to NMOR and the wavelet being stretched;</li><li><figref idrefs="f0004">FIGS. 4A-D</figref> illustrate time domain responses of decomposing a single event into frequency bands wherein <figref idrefs="f0004">FIG. 4A</figref> is an input spike, <figref idrefs="f0004">FIG. 4B</figref> shows the data decomposed into narrow frequency bands, <figref idrefs="f0004">FIG. 4C</figref> depicts smoothed envelopes of narrow frequency bands and <figref idrefs="f0004">FIG. 4D</figref> shows a reconstituted spike;</li><li><figref idrefs="f0005">FIGS. 5A-B</figref> illustrate an example of destretching applied to a common angle CMP gather containing normal moveout stretch effects comparing a stretched gather to a destretched gather for a multi-event model;</li><li><figref idrefs="f0006">FIG. 6</figref> is a flowchart depicting steps, taken in accordance with the present invention, for arriving at true relative amplitude destretched seismic traces from stretched seismic traces;</li><li><figref idrefs="f0007">FIG. 7</figref> is a flowchart more specifically showing the steps of <figref idrefs="f0006">FIG. 6</figref> used with time-offset trace data (top half of the flowchart) and time-angle trace data (lower half of the flowchart);</li><li><figref idrefs="f0010">FIG. 8</figref> is a schematic drawing showing geometry and terms used in calculating stretch factors β; and</li><li><figref idrefs="f0011">FIG. 9</figref> illustrates the shape of individual filters used in the formation of complementary frequency band traces.</li></ul><!-- EPO <DP n="8"> --></p><heading id="h0005"><u>DETAILED DESCRIPTION OF THE INVENTION</u></heading><heading id="h0006"><b>I. CONVOLUTIONAL MODEL APPLIED TO NORMAL MOVEOUT STRETCH</b></heading><p id="p0019" num="0019">An accepted model for processed seismic data amplitudes provides that the amplitudes represent the convolution of a source excitation wavelet with subsurface reflection coefficients derived from the changes in elastic properties at subsurface interfaces. The time domain form of this model provides that processed seismic data traces, prior to NMOR, can be represented as the convolution of a wavelet with an earth reflection coefficient function or: <maths id="math0001" num="(1)"><math display="block"><mi mathvariant="normal">d</mi><mfenced separators=""><mi mathvariant="normal">t</mi><mo>,</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub><mo>,</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msub><mi mathvariant="normal">t</mi><mi mathvariant="normal">j</mi></msub></mfenced><mo>=</mo><mo>∫</mo><mspace width="1em"/><mi mathvariant="normal">w</mi><mfenced><mi mathvariant="normal">τ</mi></mfenced><mspace width="1em"/><mi mathvariant="normal">r</mi><mo>⁢</mo><mfenced separators=""><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub><mo>-</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msub><mi mathvariant="normal">t</mi><mi mathvariant="normal">j</mi></msub><mo>-</mo><mi mathvariant="normal">τ</mi></mfenced><mspace width="1em"/><mi mathvariant="normal">dτ</mi></math><img id="ib0001" file="imgb0001.tif" wi="115" he="12" img-content="math" img-format="tif"/></maths><br/>
where d(t,t<sub>0j</sub>,Δt<sub>j</sub>) is a seismic data trace, w(τ) is the wavelet and r(t-t<sub>0j</sub>-Δt<sub>j</sub>) is a sum of discrete subsurface reflection coefficient delta (impulse) functions given by: <maths id="math0002" num="(2)"><math display="block"><mi mathvariant="normal">r</mi><mo>⁢</mo><mfenced separators=""><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub><mo>-</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msub><mi mathvariant="normal">t</mi><mi mathvariant="normal">j</mi></msub></mfenced><mo>=</mo><mi mathvariant="normal">Σ</mi><mspace width="1em"/><msub><mi mathvariant="normal">r</mi><mi mathvariant="normal">j</mi></msub><mo>⁢</mo><mi mathvariant="normal">δ</mi><mo>⁢</mo><mfenced separators=""><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub><mo>-</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msub><mi mathvariant="normal">t</mi><mi mathvariant="normal">j</mi></msub></mfenced><mn mathvariant="normal">.</mn></math><img id="ib0002" file="imgb0002.tif" wi="113" he="14" img-content="math" img-format="tif"/></maths></p><p id="p0020" num="0020">In this expression, r<sub>j</sub>δ(t-t<sub>0j</sub>-Δt<sub>j</sub>) is a time domain representation of the jth reflection coefficient of magnitude r<sub>j</sub> with a zero offset time of t<sub>0j</sub> and a pre-NMOR time shift of Δt<sub>j</sub>.</p><p id="p0021" num="0021">In the frequency domain, this convolution is expressed as a multiplication of the Fourier transforms of the wavelet and the earth reflection coefficient function or <maths id="math0003" num="(3)"><math display="block"><mi mathvariant="normal">D</mi><mfenced><mi mathvariant="normal">f</mi></mfenced><mo>=</mo><mi mathvariant="normal">W</mi><mfenced><mi mathvariant="normal">f</mi></mfenced><mo>⁢</mo><mi mathvariant="normal">Σ</mi><mo>⁢</mo><msub><mi mathvariant="normal">r</mi><mi mathvariant="normal">j</mi></msub><mo>⁢</mo><msup><mi mathvariant="normal">e</mi><mrow><mo>-</mo><mn mathvariant="normal">2</mn><mo>⁢</mo><mi mathvariant="normal">πif</mi><mo>⁢</mo><mfenced separators=""><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub><mo>-</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msub><mi mathvariant="normal">t</mi><mi mathvariant="normal">j</mi></msub></mfenced></mrow></msup><mn mathvariant="normal">.</mn></math><img id="ib0003" file="imgb0003.tif" wi="115" he="12" img-content="math" img-format="tif"/></maths></p><p id="p0022" num="0022">In this expression D(f), W(f) and Σr<sub>j</sub>e<sup>-2πif(t</sup><sub>0j</sub><sup>-Δt</sup><sub>j</sub><sup>)</sup> are respectively the Fourier transforms of the pre-NMOR data, d(t,t<sub>0j</sub>,Δt<sub>j</sub>), the pre-NMOR wavelet function, w(t), herein after simply referred to as just a wavelet, and the reflection coefficient function, r(t-t<sub>0j</sub>-Δt<sub>j</sub>).<!-- EPO <DP n="9"> --> Key insights for removing the effects of NMOR on stretched traces derive from the understanding that NMOR has a different effect on the reflection coefficient function than it has on the wavelets. First, the model supporting application of applying NMOR to the reflection coefficient function is to align the times of the reflection coefficients to the zero offset time, t<sub>0j</sub> without altering their magnitudes r<sub>j</sub>. Conceptually, NMOR changes the travel time between the reflection coefficient at the top and base of a layer to be that of the vertical travel time through the layer. Apply the shift theorem (<nplcit id="ncit0002" npl-type="b"><text>R. M. Bracewell, The Fourier Transform and Its Applications, McGraw-Hill, 1965, p. 104-107</text></nplcit>), NMOR transforms the reflection coefficient function as follows: <maths id="math0004" num="(4)"><math display="block"><mi mathvariant="normal">Σ</mi><mspace width="1em"/><msub><mi mathvariant="normal">r</mi><mi mathvariant="normal">j</mi></msub><mo>⁢</mo><mi mathvariant="normal">δ</mi><mo>⁢</mo><mfenced separators=""><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub><mo>-</mo><msub><mi mathvariant="normal">Δt</mi><mi mathvariant="normal">j</mi></msub></mfenced><mo>⇒</mo><mi>NMO</mi><mo>⇒</mo><mi mathvariant="normal">Σ</mi><mspace width="1em"/><msub><mi mathvariant="normal">r</mi><mi mathvariant="normal">j</mi></msub><mo>⁢</mo><mi mathvariant="normal">δ</mi><mo>⁢</mo><mfenced separators=""><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></mfenced><mo>⊃</mo><mi mathvariant="normal">Σ</mi><mo>⁢</mo><msub><mi mathvariant="normal">r</mi><mi mathvariant="normal">j</mi></msub><mo>⁢</mo><msub><msup><mi mathvariant="normal">e</mi><mrow><mo>-</mo><mn mathvariant="normal">2</mn><mo>⁢</mo><mi mathvariant="normal">πift</mi></mrow></msup><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></math><img id="ib0004" file="imgb0004.tif" wi="130" he="14" img-content="math" img-format="tif"/></maths><br/>
where r<sub>j</sub>δ(t-t<sub>0j</sub>-Δt<sub>j</sub>) is a time domain representation of a reflection coefficient of magnitude r<sub>j</sub> at zero offset time t<sub>0j</sub> before applying an NMOR time shift of Δt<sub>j</sub>, ⊃ indicates the Fourier transform of Σ r<sub>j</sub>δ(t-t<sub>0j</sub>) to the frequency domain. Second, the effect of applying NMOR in the time domain to a wavelet is to stretch it by a time varying factor β that is related to offset dependent differences in travel time to an interface. The similarity theorem (<nplcit id="ncit0003" npl-type="b"><text>R. M. Bracewell, The Fourier Transform and Its Applications, McGraw-Hill, 1995, p. 101-104</text></nplcit>) may be used to describe the frequency domain effect of applying a constant stretch factor β to a pre-NMOR time domain wavelet w(t) and is illustrated in <figref idrefs="f0003">FIG. 3</figref>. The similarity theorem provides that: <maths id="math0005" num="(5)"><math display="block"><mi mathvariant="normal">w</mi><mfenced><mi mathvariant="normal">t</mi></mfenced><mo>⇒</mo><mi>stretch</mi><mo>⇒</mo><mi mathvariant="normal">w</mi><mfenced separators=""><mi mathvariant="normal">t</mi><mo>/</mo><mi mathvariant="normal">β</mi></mfenced><mo>⊃</mo><mi mathvariant="normal">W</mi><mfenced><mi mathvariant="normal">fβ</mi></mfenced><mo>⁢</mo><mfenced open="|" close="|"><mi mathvariant="normal">β</mi></mfenced></math><img id="ib0005" file="imgb0005.tif" wi="118" he="14" img-content="math" img-format="tif"/></maths><br/>
where w(t/β) is the wavelet stretched in time, ⊃ indicates the Fourier transform of w(t/β) to the frequency domain, W(fβ)|β| is the Fourier transform of the stretched wavelet and β is a stretch factor which will typically vary with time and offset in CMP or CRP traces. Conceptually, the similarity theorem governs the effects of NMOR on wavelets while the shift theorem governs the effect of NMOR on reflection coefficients. NMOR alters the time differences between reflection coefficients but not their magnitudes.<!-- EPO <DP n="10"> --></p><p id="p0023" num="0023">Finally, because of the differing effects of NMOR on reflectivity and wavelets, Fourier transforms of typical NMOR corrected seismic traces, D<sub>nmo</sub>(f), yield spectra of the form: <maths id="math0006" num="(6)"><math display="block"><msub><mi mathvariant="normal">D</mi><mi>nmo</mi></msub><mfenced><mi mathvariant="normal">f</mi></mfenced><mo>=</mo><mi mathvariant="normal">W</mi><mfenced><mi mathvariant="normal">fβ</mi></mfenced><mo>⁢</mo><mfenced open="|" close="|"><mi mathvariant="normal">β</mi></mfenced><mspace width="1em"/><mfenced separators=""><msub><mi mathvariant="normal">Σr</mi><mi mathvariant="normal">j</mi></msub><mo>⁢</mo><msub><msup><mi mathvariant="normal">e</mi><mrow><mo>-</mo><mn mathvariant="normal">2</mn><mo>⁢</mo><mi mathvariant="normal">πift</mi></mrow></msup><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></mfenced></math><img id="ib0006" file="imgb0006.tif" wi="104" he="19" img-content="math" img-format="tif"/></maths><br/>
indicating that the pre-NMOR wavelet's frequency components are scaled by a frequency dependent sum of earth reflection coefficients as well as being shifted and scaled by the stretch factor β.</p><p id="p0024" num="0024">In summary, the convolutional model predicts that application of NMOR to CMP or CRP gather traces will result in frequency dependent changes to both the amplitude and phase spectra of convolved wavelets but in no changes to the underlying reflection coefficient amplitudes. Removal of NMOR stretch requires estimating and then compensating wavelet spectra for the stretch factor β to produce output trace amplitudes that are scaled in proportion to local subsurface reflection coefficients.</p><heading id="h0007"><b>II. CONCEPTS FOR TRUE RELATIVE AMPLITUDE CORRECTION OF STRETCHED TRACES</b></heading><p id="p0025" num="0025">The present invention provides a method and apparatus for true relative amplitude correction of seismic traces for the effects of NMOR stretch. Removal of NMOR stretch (destretching) is achieved in the frequency domain by estimating a wavelet stretch factor β and removing it from an estimate of the stretched wavelet W(fβ)|β| so that the resultant data (convolution of the embedded wavelet and reflection coefficient function) becomes: <maths id="math0007" num="(7)"><math display="block"><mi mathvariant="normal">W</mi><mfenced><mi mathvariant="normal">fβ</mi></mfenced><mo>⁢</mo><mfenced open="|" close="|"><mi mathvariant="normal">β</mi></mfenced><mspace width="1em"/><mi mathvariant="normal">Σ</mi><mo>⁢</mo><msub><mi mathvariant="normal">r</mi><mi mathvariant="normal">j</mi></msub><mo>⁢</mo><msub><msup><mi mathvariant="normal">e</mi><mrow><mo>-</mo><mn mathvariant="normal">2</mn><mo>⁢</mo><mi mathvariant="normal">πift</mi></mrow></msup><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub><mo>⇒</mo><mi>Destretch</mi><mo>⇒</mo><mi mathvariant="normal">W</mi><mfenced><mi mathvariant="normal">f</mi></mfenced><mspace width="1em"/><mi mathvariant="normal">Σ</mi><mo>⁢</mo><msub><mi mathvariant="normal">r</mi><mi mathvariant="normal">j</mi></msub><mo>⁢</mo><msub><msup><mi mathvariant="normal">e</mi><mrow><mo>-</mo><mn mathvariant="normal">2</mn><mo>⁢</mo><mi mathvariant="normal">πift</mi></mrow></msup><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></math><img id="ib0007" file="imgb0007.tif" wi="130" he="14" img-content="math" img-format="tif"/></maths><br/>
where the wavelet stretch factor β is equal to the inverse of the cosine of the interface reflection angle θ<sub>r</sub> and W(f) is a destretched or externally specified target wavelet.<!-- EPO <DP n="11"> --></p><p id="p0026" num="0026">The stretched wavelet spectra W(fβ)|β| can be estimated using trace spectral averaging techniques. These techniques reduce the effect of the earth's reflection coefficients on a trace's amplitude spectrum to that of a constant scalar multiplier. Spectral averaging techniques rely on earth reflection coefficients averaged within a frequency band taken from a large time gate to be statistically constant or of a known spectral shape. The averaging techniques include frequency band averaging of a trace's spectra or Fourier transforming a limited number of lags of a trace's autocorrelation function. The effect of non-white reflection coefficient spectra on estimated wavelet spectra can be removed by application of reflectivity whitening filters as described herein.</p><p id="p0027" num="0027">In a preferred embodiment of this invention, the effect of varying earth reflection coefficients in a trace's spectra are minimized by averaging amplitude and phase samples within frequency bands. Ideally, the number of frequency samples that are averaged is inverse to the maximum expected wavelet duration and also greater than the ratio of transform time window to wavelet time duration (should preferably include at least 10 spectral samples in each frequency band.) Averaged trace amplitude and phase spectra from such bands will be reflectivity scaled estimates of stretched wavelet spectra, W<sub>n</sub>(f), of the form: <maths id="math0008" num="(8)"><math display="block"><msub><mi mathvariant="normal">W</mi><mi mathvariant="normal">n</mi></msub><mfenced><mi mathvariant="normal">f</mi></mfenced><mo>=</mo><mfenced><msub><mi mathvariant="normal">r</mi><mi mathvariant="normal">c</mi></msub></mfenced><mspace width="1em"/><mi mathvariant="normal">W</mi><mfenced><mi mathvariant="normal">fβ</mi></mfenced><mo>⁢</mo><mfenced open="|" close="|"><mi mathvariant="normal">β</mi></mfenced></math><img id="ib0008" file="imgb0008.tif" wi="104" he="19" img-content="math" img-format="tif"/></maths><br/>
where W(f) is the pre-NMOR wavelet spectra and r<sub>c</sub> is a frequency independent, time and offset dependent scale factor that depends on local subsurface reflection coefficients. As illustrated in steps 130B, 132B, and 140B of <figref idrefs="f0007">FIG. 7</figref>, alternately, wavelet spectral estimates can be generated by frequency domain averaging of the Fourier transform samples of small time gates.</p><p id="p0028" num="0028">"True relative amplitude" destretch is defined as an operation which preserves the zero time value of the stretched (pre-NMO) wavelet convolved with an isolated reflection coefficient. This occurs if the zero time values of the stretched wavelet w(t/β)|<sub>t=0</sub> and destretched wavelet w(t)|<sub>t=0</sub> are constrained so that: <maths id="math0009" num="(9)"><math display="block"><mi mathvariant="normal">w</mi><mfenced><mi mathvariant="normal">t</mi></mfenced><mo>⁢</mo><msub><mrow><mo>|</mo></mrow><mrow><mi mathvariant="normal">t</mi><mo>=</mo><mn mathvariant="normal">0</mn></mrow></msub><mo>=</mo><mi mathvariant="normal">w</mi><mfenced separators=""><mi mathvariant="normal">t</mi><mo>/</mo><mi mathvariant="normal">β</mi></mfenced><mo>⁢</mo><msub><mrow><mo>|</mo></mrow><mrow><mi mathvariant="normal">t</mi><mo>=</mo><mn mathvariant="normal">0</mn></mrow></msub><mo>=</mo><mi>constant</mi></math><img id="ib0009" file="imgb0009.tif" wi="104" he="13" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="12"> --></p><p id="p0029" num="0029">In the frequency domain, this constraint would require that: <maths id="math0010" num="(10)"><math display="block"><mi mathvariant="normal">Σ W</mi><mfenced separators=""><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub><mo>⁢</mo><mi mathvariant="normal">β</mi></mfenced><mo>⁢</mo><mfenced open="|" close="|"><mi mathvariant="normal">β</mi></mfenced><mo>=</mo><mi mathvariant="normal">Σ W</mi><mfenced><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub></mfenced></math><img id="ib0010" file="imgb0010.tif" wi="108" he="18" img-content="math" img-format="tif"/></maths><br/>
where W(f<sub>i</sub>) are discrete values of a destretched wavelet's Fourier transform.</p><p id="p0030" num="0030">If the phase spectrum of the wavelet is assumed to be zero, or if only the amplitude spectrum of the wavelet is known, true relative amplitude destretching of the data can alternately be defined as an operation that does not alter the area under the amplitude spectrum of the wavelet so that: <maths id="math0011" num="(11)"><math display="block"><mi mathvariant="normal">Σ</mi><mo>⁢</mo><msup><mfenced separators=""><mi mathvariant="normal">W</mi><mfenced separators=""><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub><mo>⁢</mo><mi mathvariant="normal">β</mi></mfenced><mo>⁢</mo><mfenced open="|" close="|"><mi mathvariant="normal">β</mi></mfenced><mspace width="1em"/><msup><mi mathvariant="normal">W</mi><mo>*</mo></msup><mfenced separators=""><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub><mo>⁢</mo><mi mathvariant="normal">β</mi></mfenced><mo>⁢</mo><mfenced open="|" close="|"><mi mathvariant="normal">β</mi></mfenced></mfenced><mrow><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup><mo>=</mo><mi mathvariant="normal">Σ</mi><mo>⁢</mo><msup><mfenced separators=""><mi mathvariant="normal">W</mi><mfenced><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub></mfenced><mo>⁢</mo><msup><mi mathvariant="normal">W</mi><mo>*</mo></msup><mfenced><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub></mfenced></mfenced><mrow><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup></math><img id="ib0011" file="imgb0011.tif" wi="120" he="18" img-content="math" img-format="tif"/></maths><br/>
where W*(f<sub>i</sub>) and W*(f<sub>i</sub>β) are complex conjugates of W(f<sub>i</sub>) and W(f<sub>i</sub>β) respectively and (W*(f<sub>i</sub>)W(f<sub>i</sub>))<sup>1/2</sup> is an amplitude spectrum sample. For situations where the stretch factor β or the wavelet varies with time, this true relative amplitude condition should be met on an instantaneous time basis.</p><p id="p0031" num="0031">In the most general form of this method, normal moveout stretched traces are transformed with a discrete Fourier transform and separated into overlapping frequency band traces with center frequencies f<sub>i</sub>. The frequency bands should be complimentary so that the frequency domain sum of each of the frequency bands is equal to the frequency domain representation of the input trace data. Alternately, wavelet spectral estimates can be generated by frequency domain averaging of the Fourier transform samples of small time gates.</p><p id="p0032" num="0032">Using the above concepts, true relative amplitude destretching of seismic traces is done in 3 steps. First, wavelet spectral estimates are preferably corrected for non-white reflectivity spectra to produce a time varying reflectivity corrected stretched wavelet spectrum W<sub>s</sub>(f<sub>i</sub>,t-t<sub>0j</sub>) given by the following expression: <maths id="math0012" num="(12)"><math display="block"><msub><mi mathvariant="normal">W</mi><mi mathvariant="normal">s</mi></msub><mo>⁢</mo><mfenced separators=""><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub><mo>,</mo><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></mfenced><mo>=</mo><msub><mi mathvariant="normal">W</mi><mi mathvariant="normal">n</mi></msub><mo>⁢</mo><mfenced separators=""><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub><mo>,</mo><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></mfenced><mo>⁢</mo><mi mathvariant="normal">R</mi><mfenced><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub></mfenced><mo>/</mo><mi mathvariant="normal">R</mi><mfenced separators=""><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub><mo>⁢</mo><mi mathvariant="normal">β</mi></mfenced></math><img id="ib0012" file="imgb0012.tif" wi="115" he="10" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="13"> --> where W<sub>n</sub>(f<sub>i</sub>,t-t<sub>0j</sub>) is the stretched wavelet spectra at time t-t<sub>0j</sub> and frequency f<sub>i</sub>, R(f<sub>i</sub>) is a non-white, vertical time reflectivity spectrum at frequency f<sub>i</sub> and β is the stretch factor. Then the destretched (pre-NMO) target wavelet spectra O(f<sub>i</sub>) is defined using the similarity theorem as: <maths id="math0013" num="(13)"><math display="block"><mi mathvariant="normal">O</mi><mfenced><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub></mfenced><mo>=</mo><msub><mi mathvariant="normal">W</mi><mi mathvariant="normal">s</mi></msub><mo>⁢</mo><mfenced separators=""><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub><mo>/</mo><mi mathvariant="normal">β</mi><mo>,</mo><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></mfenced><mo>/</mo><mfenced open="|" close="|"><mi mathvariant="normal">β</mi></mfenced></math><img id="ib0013" file="imgb0013.tif" wi="104" he="17" img-content="math" img-format="tif"/></maths><br/>
where W<sub>s</sub>(f<sub>i</sub>,t-t<sub>0j</sub>) is the reflectivity corrected stretched wavelet spectra (the post-NMOR wavelet spectra) and β the stretch factor.</p><p id="p0033" num="0033">Alternately, for true relative amplitude destretching (replacement of the post-NMOR wavelet) with a user specified target wavelet, W<sub>d</sub>(f<sub>i</sub>), the desired output wavelet is defined as: <maths id="math0014" num="(14)"><math display="block"><mi mathvariant="normal">O</mi><mfenced><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub></mfenced><mo>=</mo><msub><mi mathvariant="normal">W</mi><mi mathvariant="normal">d</mi></msub><mo>⁢</mo><mfenced separators=""><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub><mo>,</mo><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></mfenced><mo>⁢</mo><mi mathvariant="normal">R</mi><mfenced><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub></mfenced></math><img id="ib0014" file="imgb0014.tif" wi="105" he="19" img-content="math" img-format="tif"/></maths><br/>
where R(f<sub>i</sub>) is a user specified non-white, vertical time reflectivity spectrum at frequency f<sub>i</sub>. Second, for each input amplitude value at center frequency f<sub>i</sub> and time t-t<sub>0j</sub>, A<sub>in</sub>(f<sub>i</sub>,t-t<sub>0j</sub>), the output amplitude, A<sub>out</sub>(f<sub>i</sub>,t-t<sub>0j</sub>), is given by: <maths id="math0015" num="(15)"><math display="block"><msub><mi mathvariant="normal">A</mi><mi>out</mi></msub><mo>⁢</mo><mfenced separators=""><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub><mo>,</mo><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></mfenced><mo>=</mo><msub><mi mathvariant="normal">A</mi><mi>in</mi></msub><mo>⁢</mo><mfenced separators=""><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub><mo>,</mo><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></mfenced><mspace width="1em"/><mi mathvariant="normal">O</mi><mfenced><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub></mfenced><mo>/</mo><msub><mi mathvariant="normal">W</mi><mi mathvariant="normal">s</mi></msub><mo>⁢</mo><mfenced separators=""><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub><mo>,</mo><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></mfenced><mn mathvariant="normal">.</mn></math><img id="ib0015" file="imgb0015.tif" wi="120" he="14" img-content="math" img-format="tif"/></maths></p><p id="p0034" num="0034">In general, the desired and estimated wavelet samples can be complex, having both amplitude and phase components.<!-- EPO <DP n="14"> --></p><p id="p0035" num="0035">Finally, at each time t-t<sub>0j</sub>, the sum of the output frequency band data, ΣA<sub>out</sub>(f<sub>i</sub>,t-t<sub>0j</sub>), is constrained so that the area under the spectra of the input and desired output wavelets are equal. For a desired output wavelet with minimum and maximum output frequencies f<sub>min</sub> and f<sub>max</sub>, the stretched spectrum values are summed over over β<sup>-1</sup>f<sub>min</sub> to β<sup>-1</sup>f<sub>max</sub> in W<sub>s</sub>(f<sub>i</sub>,t-t<sub>0j</sub>) and over f<sub>min</sub> to f<sub>max</sub> in O(f<sub>i</sub>) and applied as follows: <maths id="math0016" num="(16)"><math display="block"><msub><mi mathvariant="normal">A</mi><mi>out</mi></msub><mo>⁢</mo><mfenced separators=""><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></mfenced><mo>=</mo><mi mathvariant="normal">Σ</mi><mo>⁢</mo><msub><mi mathvariant="normal">A</mi><mi>out</mi></msub><mo>⁢</mo><mfenced separators=""><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub><mo>,</mo><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></mfenced><mspace width="1em"/><mi mathvariant="normal">Σ</mi><mo>⁢</mo><msup><mfenced separators=""><msub><mi mathvariant="normal">W</mi><mi mathvariant="normal">s</mi></msub><mo>⁢</mo><mfenced separators=""><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub><mo>,</mo><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></mfenced><mo>⁢</mo><msup><msub><mi mathvariant="normal">W</mi><mi mathvariant="normal">s</mi></msub><mo>*</mo></msup><mo>⁢</mo><mfenced separators=""><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub><mo>,</mo><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></mfenced></mfenced><mrow><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup><mo>/</mo><mi mathvariant="normal">Σ</mi><mo>⁢</mo><msup><mfenced separators=""><mi mathvariant="normal">O</mi><mfenced><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub></mfenced><mo>⁢</mo><msup><mi mathvariant="normal">O</mi><mo>*</mo></msup><mfenced><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub></mfenced></mfenced><mrow><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup></math><img id="ib0016" file="imgb0016.tif" wi="147" he="18" img-content="math" img-format="tif"/></maths><br/>
to yield destretched true relative amplitude trace data, A<sub>out</sub>(t-t<sub>0j</sub>).</p><heading id="h0008"><b>III. DETAILED STEPS FOR IMPLEMENTING TRUE RELATIVE AMPLITUDE CORRECTION OF STRETCHED TRACES</b></heading><p id="p0036" num="0036"><figref idrefs="f0006">FIG. 6</figref> shows a flowchart of a preferred exemplary "destretch" method for arriving at true relative amplitude destretched seismic traces from stretched seismic traces. <figref idrefs="f0007">FIG. 7</figref> expands upon the steps of <figref idrefs="f0006">FIG. 6</figref> with each of the steps being identified with a corresponding brief descriptor at the top of the flowchart. Two examples of the destretch method are shown for processing (a) time-offset data in an upper flowpath and (b) time-angle data in a lower flowpath. Steps in each of these flowpaths are identified with the character "a" added to references numerals in the time-offset data flowpath and character "b" in time-angle data. In both exemplary flowpaths, the destretch processing of traces is accomplished by replacing wavelet spectra in stretched seismic traces with true relative amplitude pre-NMOR wavelet spectra to arrive at true relative amplitude destretched seismic traces.</p><p id="p0037" num="0037"><figref idrefs="f0006">FIG. 6</figref> summarizes the general steps taken in the present destretch method. In step 110, stretched seismic traces are acquired. Stretch factors β are then determined in step 120 for each of the stretched seismic traces. An input spectrum for each of the stretched traces is determined in step 130. Estimates of stretched wavelet spectra are made from the input spectra in step 140. In step 150, destretched wavelet spectra are obtained through calculations utilizing the stretch factor β of step 120 or else from a desired destretched wavelet spectra input by a user.<!-- EPO <DP n="15"> --></p><p id="p0038" num="0038">Shaping correction factors are determined in step 160 by comparing the destretched wavelet spectra to the stretched wavelet spectra. The shaping correction factors are applied in step 170 to the input spectra of the stretched traces to arrive at destretched trace spectra. True relative amplitude scaling factors are computed in step 180 by taking the ratio of a true relative amplitude property of the destretched wavelet spectra to a corresponding true relative amplitude property of the stretched wavelet spectra. Finally, the true relative amplitude scaling factors are applied in step 190 to the destretched trace spectra to arrive at true relative amplitude destretched seismic trace whereby the true relative amplitude property of the stretched wavelet spectra is substantially preserved.</p><p id="p0039" num="0039">Referring now to <figref idrefs="f0007">FIG. 7</figref>, the above destretch method may be carried out in a time-offset domain or in a time-reflection angle domain. The destretch method will first be described as applied to the time-offset domain.</p><heading id="h0009"><b>A. Destretch Method - Time-Offset Domain</b></heading><p id="p0040" num="0040">In step 110, stretched seismic traces are acquired. Input data is processed in such a way as to preserve true relative amplitude. Further the data is time corrected such that the now observed times in each trace represent the time as if the source and receiver positions were coincident, i.e. at zero-offset. This time correction can be done either through normal moveout removal or through Pre-Stack imaging processing. It is required that the distance from the source to receiver is known and constant over the length of a trace. This time correction process occurs on a trace by trace operation and any trace ordering can be used. However, the preferred data organization of traces is to sort ensembles of data into common depth point (CDP), common mid-point (CMP) or common reflection point (CRP) gathers. Additionally, it is assumed that an embedded waveform in the traces has a phase spectrum that is constant over the usable bandwidth (sufficiently strong amplitude) of the data. Auxiliary data required to calculate stretch factors β are a model of velocity as a function of location and time, and information detailing the location of a trace with respect to the velocity model and the distance from source to receiver distance or offset.<!-- EPO <DP n="16"> --></p><p id="p0041" num="0041">Stretch factors β are then determined in step 120A for each of the respective stretched seismic traces in step 120A. A stretch factor β is defined as the inverse of the cosine of the reflection angle θ<sub>r</sub> for a trace.</p><p id="p0042" num="0042"><figref idrefs="f0010">FIG. 8</figref> shows a shot source S and a receiver R. A wavelet of energy emanating from source S will general be refracted as it passes through subsurface formations. An interface containing a common reflection point (CRP) may be orientated at a geologic dip angle θ<sub>d</sub> relative to a vertical normal. Straight ray reflection angle α is shown as the angle between the normal to the interface at the CRP and a ray extending from the CRP to receiver R. The reflection angle θ<sub>r</sub> is the angle at which a wavelet will reflect from a CRP. As shown in <figref idrefs="f0010">FIG. 8</figref>, the wavelet will further refract after it is reflected from the CRP due to changing velocities in the subsurface, prior to be received at receiver R.</p><p id="p0043" num="0043">A deterministic estimate of the stretch factor β as a function of time and offset is generated from an rms velocity function and the subsurface interval velocity at the interface as: <maths id="math0017" num="(17)"><math display="block"><mi mathvariant="normal">β</mi><mo>=</mo><msup><mfenced separators=""><mn mathvariant="normal">1</mn><mo>-</mo><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">r</mi></msub></mfenced><mrow><mo>-</mo><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup></math><img id="ib0017" file="imgb0017.tif" wi="120" he="14" img-content="math" img-format="tif"/></maths><br/>
where <maths id="math0018" num="(18)"><math display="block"><msub><mi mathvariant="normal">sinθ</mi><mi mathvariant="normal">r</mi></msub><mo>=</mo><mi mathvariant="normal">x</mi><mspace width="1em"/><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">i</mi></msub><mo>⁢</mo><msub><mrow><mspace width="1em"/><mi mathvariant="normal">cosθ</mi></mrow><mi mathvariant="normal">d</mi></msub><mo>/</mo><mfenced separators=""><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msup><mfenced separators=""><msup><msub><mi mathvariant="normal">t</mi><mn mathvariant="normal">0</mn></msub><mn mathvariant="normal">2</mn></msup><mo>+</mo><msup><mfenced><msub><mi mathvariant="normal">xcosθ</mi><mi mathvariant="normal">d</mi></msub></mfenced><mn mathvariant="normal">2</mn></msup><mo>/</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mn mathvariant="normal">2</mn></msup></mfenced><mrow><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup></mfenced></math><img id="ib0018" file="imgb0018.tif" wi="116" he="14" img-content="math" img-format="tif"/></maths> <maths id="math0019" num="(19)"><math display="block"><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mo>=</mo><msub><mi mathvariant="normal">v</mi><mi>rms</mi></msub><mo>⁢</mo><msup><mfenced separators=""><mn mathvariant="normal">1</mn><mo>+</mo><mn mathvariant="normal">2</mn><mo>⁢</mo><msup><mi mathvariant="normal">ε sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><mi mathvariant="normal">α</mi><mo>⁢</mo><mfenced separators=""><mn mathvariant="normal">2</mn><mo>-</mo><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><mi mathvariant="normal">α</mi></mfenced></mfenced><mrow><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup></math><img id="ib0019" file="imgb0019.tif" wi="120" he="14" img-content="math" img-format="tif"/></maths><br/>
and <maths id="math0020" num="(20)"><math display="block"><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><mi mathvariant="normal">α</mi><mo>=</mo><msup><mi mathvariant="normal">x</mi><mn mathvariant="normal">2</mn></msup><mo>/</mo><msup><mfenced separators=""><msup><mi mathvariant="normal">x</mi><mn mathvariant="normal">2</mn></msup><mo>+</mo><msub><mi mathvariant="normal">v</mi><mi>rms</mi></msub><mo>⁢</mo><msub><mi mathvariant="normal">t</mi><mn mathvariant="normal">0</mn></msub></mfenced><mn mathvariant="normal">2</mn></msup><mrow><mo>)</mo></mrow></math><img id="ib0020" file="imgb0020.tif" wi="119" he="10" img-content="math" img-format="tif"/></maths><br/>
for CDP gathers: <maths id="math0021" num="(18a)"><math display="block"><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">r</mi></msub><mo>=</mo><msup><mfenced separators=""><mi mathvariant="normal">x</mi><mspace width="1em"/><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">i</mi></msub><mo>⁢</mo><msub><mrow><mspace width="1em"/><mi mathvariant="normal">cosθ</mi></mrow><mi mathvariant="normal">d</mi></msub></mfenced><mn mathvariant="normal">2</mn></msup><mo>/</mo><mfenced separators=""><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mn mathvariant="normal">4</mn></msup><mo>⁢</mo><mfenced separators=""><msup><msub><mi mathvariant="normal">t</mi><mn mathvariant="normal">0</mn></msub><mn mathvariant="normal">2</mn></msup><mo>+</mo><msup><mfenced><msub><mi mathvariant="normal">xcosθ</mi><mi mathvariant="normal">d</mi></msub></mfenced><mn mathvariant="normal">2</mn></msup><mo>/</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mn mathvariant="normal">2</mn></msup></mfenced></mfenced></math><img id="ib0021" file="imgb0021.tif" wi="121" he="9" img-content="math" img-format="tif"/></maths><br/>
for dip moveout (DMO) gathers: <maths id="math0022" num=""><math display="block"><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">r</mi></msub><mo>=</mo><msup><mfenced separators=""><mi>x cos</mi><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">d</mi></msub></mfenced><mn mathvariant="normal">2</mn></msup><mo>/</mo><mfenced separators=""><mfenced separators=""><msup><msub><mi mathvariant="normal">t</mi><mi>dmo</mi></msub><mn>2</mn></msup><mo>⁢</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mn mathvariant="normal">4</mn></msup><mo>/</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">i</mi></msub><mn mathvariant="normal">2</mn></msup></mfenced><mo>+</mo><mfenced separators=""><msup><mi>cos</mi><mn>2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">d</mi></msub><mo>⁢</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mn mathvariant="normal">2</mn></msup><mo>/</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">i</mi></msub><mn mathvariant="normal">2</mn></msup></mfenced></mfenced></math><img id="ib0022" file="imgb0022.tif" wi="104" he="8" img-content="math" img-format="tif"/></maths><br/>
and for PSTM data: <maths id="math0023" num=""><math display="block"><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">r</mi></msub><mo>=</mo><msup><mfenced separators=""><mi mathvariant="normal">x</mi><mspace width="1em"/><msup><mi>cos</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">d</mi></msub></mfenced><mn mathvariant="normal">2</mn></msup><mo>/</mo><mfenced separators=""><mfenced separators=""><msup><msub><mi mathvariant="normal">t</mi><mi>mig</mi></msub><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mn mathvariant="normal">4</mn></msup><mo>/</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">i</mi></msub><mn mathvariant="normal">2</mn></msup></mfenced><mo>+</mo><mfenced separators=""><msup><mi>cos</mi><mn mathvariant="normal">4</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">d</mi></msub><mo>⁢</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mn mathvariant="normal">2</mn></msup><mo>/</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">i</mi></msub><mn mathvariant="normal">2</mn></msup></mfenced></mfenced></math><img id="ib0023" file="imgb0023.tif" wi="100" he="12" img-content="math" img-format="tif"/></maths><br/>
<!-- EPO <DP n="17"> -->wherein sin θ<sub>r</sub> is the sin of the reflection angle at the interface, x is shot to group offset, v<sub>i</sub> is the subsurface interval velocity at the t<sub>0</sub>, v<sub>rms</sub> is the rms velocity of the overburden, t<sub>0</sub> is the zero offset travel time, t<sub>dmo</sub> is the zero offset travel time of DMO gathers, t<sub>mig</sub> is the zero offset time of migrated gathers, ε is the overburden anisotropy parameter and θ<sub>d</sub> is the geologic dip at the interface.</p><p id="p0044" num="0044">The input trace spectra for the stretched traces is determined in step 130A where stretched traces are decomposed into a number of narrow frequency band traces, as shown in <figref idrefs="f0004">FIG. 4B</figref>. These narrow frequency band traces have the property that their sum will yield the original input trace.</p><p id="p0045" num="0045"><figref idrefs="f0011">FIG. 9</figref> shows the design of the frequency band filters required to generate the frequency band traces.</p><p id="p0046" num="0046">The number of frequency bands, N<sub>b</sub>, is preferably chosen to be the smallest value that satisfies the following condition: <maths id="math0024" num="(21)"><math display="block"><msub><mi mathvariant="normal">N</mi><mi mathvariant="normal">w</mi></msub><mo>≤</mo><msub><mi mathvariant="normal">N</mi><mi mathvariant="normal">b</mi></msub><mo>≤</mo><msub><mi mathvariant="normal">N</mi><mi mathvariant="normal">t</mi></msub><mo>/</mo><mn mathvariant="normal">10</mn></math><img id="ib0024" file="imgb0024.tif" wi="94" he="13" img-content="math" img-format="tif"/></maths><br/>
where N<sub>w</sub> is the expected number of time samples in the wavelet and N<sub>t</sub> is the number of samples in the Fourier transform time window. Typical choices of N<sub>b</sub> and Nt /10 imply time averaging windows of several hundred milliseconds.</p><p id="p0047" num="0047">The preferred practice is to choose the number of frequency bands approximately equal to the number of sample points in the embedded waveform.</p><p id="p0048" num="0048">User defined frequency band filters have the property of fully passing data at a central frequency and tapering to fully rejecting data away from the central frequency. Neighboring frequency bands are entirely complimentary such that the full pass central frequency is the zero pass frequency of adjacent frequency bands. Corresponding frequency samples of each frequency filter is multiplied by the Fourier transform of the input trace. The result of this operation forms the filtered Fourier<!-- EPO <DP n="18"> --> transformed frequency data. This product is then inverse Fourier transformed to yield the desired narrow frequency band traces of <figref idrefs="f0004">FIG. 4B</figref>.</p><p id="p0049" num="0049">Estimates of stretched wavelet spectra are made in step 140A from the input spectra of step 130A.</p><p id="p0050" num="0050"><figref idrefs="f0004">FIGS. 4A-D</figref> illustrates the decomposition of the single event of <figref idrefs="f0004">FIG.4A</figref> into frequency bands using an N<sub>b</sub> value that satisfy the above constraints. The frequency bands are then inverse transformed back to the time traces shown in <figref idrefs="f0004">FIG.4B</figref>. Envelopes or rms time averaging of each of these time traces is used to generate the time and frequency independent post-NMOR wavelet spectral estimates W<sub>n</sub>(f<sub>i</sub>,t-t<sub>0j</sub>), for each center frequency f<sub>i</sub> and time t-t<sub>0j</sub>. according to Equation (8): <maths id="math0025" num="(22)"><math display="block"><msub><mi mathvariant="normal">W</mi><mi mathvariant="normal">n</mi></msub><mo>⁢</mo><mfenced separators=""><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub><mo>,</mo><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></mfenced><mo>=</mo><mfenced><msub><mi mathvariant="normal">r</mi><mi mathvariant="normal">c</mi></msub></mfenced><mo>⁢</mo><mi mathvariant="normal">W</mi><mo>⁢</mo><mfenced separators=""><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub><mo>⁢</mo><mi mathvariant="normal">β</mi><mo>,</mo><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></mfenced><mo>⁢</mo><mfenced open="|" close="|"><mi mathvariant="normal">β</mi></mfenced></math><img id="ib0025" file="imgb0025.tif" wi="120" he="14" img-content="math" img-format="tif"/></maths><br/>
where β is the stretch factor and r<sub>c</sub> is a local reflectivity scalar.</p><p id="p0051" num="0051">An estimate of the amplitude of each frequency band trace is computed by taking the filtered Fourier transformed frequency data that is an intermediate product from step 130A and applying a 90° phase rotation and then computing the inverse Fourier transform which forms a Hilbert transform for each corresponding frequency band trace from step 130A. To form the trace envelope corresponding time samples from each narrow frequency band trace, Hilbert transform pairs are squared, summed together and the square root is taken of the resulting sum. This forms the trace envelope (<figref idrefs="f0004">FIG. 4C</figref>) which is filtered to reduce the effects of noise. The resulting collection of trace amplitudes represents an estimate of the pre-corrected wavelet amplitude spectrum determined on a time by time basis.</p><p id="p0052" num="0052">A destretched output spectrum is obtained in step 150A. In a preferred manner, the estimates of the stretched wavelet spectra determined in step 140A are corrected utilizing the Similarity Theorem Equation (5). This correction utilizes the stretch factors (β) eq. (17-20) calculated in step 120A and the estimate of the stretched wavelet spectra of eq. (8) determined in step 140A to correct for the stretch in the<!-- EPO <DP n="19"> --> trace data. For each time and mean frequency in step 140A, the amplitude of stretched wavelet is interpolated at a frequency that is the product of β and the current central frequency. The interpolated amplitude is, in turn, multiplied by the inverse stretch factor (β<sup>-1</sup>) and becomes a corrected sample of the destretched output spectrum. The product of performing this operation is to form a time varying corrected wavelet amplitude spectrum.</p><p id="p0053" num="0053">As an alternative to calculating the destretched output spectrum, a user defined target waveform may be used to generate the destretched output spectrum. This destretched output spectrum preferably has the characteristic of having high and low frequency characteristics that extend across the usable data frequencies on the widest offset traces.</p><p id="p0054" num="0054">Shaping (or corrected shaping) correction factors are determined in step 162A using Equations (12-14) by taking the ratio of the destretched wavelet spectra to the stretched wavelet spectra. A stabilization factor is preferably added to the denominator (stretched wavelet spectra) to prevent possible division by zero. If warranted, an optional correction to the destretched wavelet spectrum for non-white reflectivity is computed in step 160A using Equations (12) and (14). This correction is performed by modeling the amplitude spectrum of the underlying earth reflectivity. The modeled earth reflectivity spectrum is divided into the destretched wavelet spectrum determined in step 150A.</p><p id="p0055" num="0055">The shaping (or corrected shaping) correction factors are applied in step 170A to the input spectra of the stretched traces using Equation (15) to arrive at a destretched trace spectra.</p><p id="p0056" num="0056">True relative amplitude scaling factors are computed in step 180A. The ratios of corresponding true relative amplitude properties of the stretched and destretched wavelet spectra are taken to determine the true relative amplitude scaling factors. Examples of such true relative amplitude properties include the zero time value of a wavelet, the area under the amplitude spectrum of the wavelet, or the time average mean absolute value of the stretched traces.<!-- EPO <DP n="20"> --></p><p id="p0057" num="0057">The true relative amplitude scaling factors and shaping (or corrected shaping) factors are applied in step 192A to the destretched trace spectra using Equation (16) to arrive at true relative amplitude destretched seismic traces whereby the true relative amplitude property of the stretched wavelet spectra is substantially preserved. The input spectra of step 130A are corrected in step 192A to form a corrected output spectrum comprising individual frequency band traces. Corresponding samples in time and central frequency from the output of step 180A, i.e. the correction factors, and from step 162A, i.e. the shaping (or corrected shaping) factors, are multiplied by those of step 130A the input data represented as frequency forming corrected frequency bands. The corrected output spectrum is converted into destretched seismic traces in step 195A. The corrected individual frequency band traces of step 190A are summed together to form the destretched output traces.</p><p id="p0058" num="0058">Finally, at each time t-t<sub>0j</sub>, the sum of the output frequency band data, ΣA<sub>out</sub>(f<sub>i</sub>,t-t<sub>0j</sub>), is constrained so that the area under the spectra of the input and desired output wavelets are equal. For a desired output wavelet with minimum and maximum output frequencies f<sub>min</sub> and f<sub>max</sub>, the stretched spectrum values are summed over βf<sub>min</sub> to βf<sub>max</sub> in W<sub>s</sub>(f<sub>i</sub>,t-t<sub>0j</sub>) and over f<sub>min</sub> to f<sub>max</sub> in O(f<sub>i</sub>) and applied as follows: <maths id="math0026" num="(16)"><math display="block"><msub><mi mathvariant="normal">A</mi><mi>out</mi></msub><mo>⁢</mo><mfenced separators=""><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></mfenced><mo>=</mo><mi mathvariant="normal">Σ</mi><mo>⁢</mo><msub><mi mathvariant="normal">A</mi><mi>out</mi></msub><mo>⁢</mo><mfenced separators=""><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub><mo>,</mo><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></mfenced><mspace width="1em"/><mi mathvariant="normal">Σ</mi><mo>⁢</mo><msup><mfenced separators=""><msub><mi mathvariant="normal">W</mi><mi mathvariant="normal">s</mi></msub><mo>⁢</mo><mfenced separators=""><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub><mo>,</mo><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></mfenced><mo>⁢</mo><msup><msub><mi mathvariant="normal">W</mi><mi mathvariant="normal">s</mi></msub><mo>*</mo></msup><mo>⁢</mo><mfenced separators=""><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub><mo>,</mo><mi mathvariant="normal">t</mi><mo>-</mo><msub><mi mathvariant="normal">t</mi><mrow><mn mathvariant="normal">0</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mrow></msub></mfenced></mfenced><mrow><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup><mo>/</mo><mi mathvariant="normal">Σ</mi><mo>⁢</mo><msup><mfenced separators=""><mi mathvariant="normal">O</mi><mfenced><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub></mfenced><mo>⁢</mo><msup><mi mathvariant="normal">O</mi><mo>*</mo></msup><mfenced><msub><mi mathvariant="normal">f</mi><mi mathvariant="normal">i</mi></msub></mfenced></mfenced><mrow><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup></math><img id="ib0026" file="imgb0026.tif" wi="145" he="18" img-content="math" img-format="tif"/></maths><br/>
to yield destretched true relative amplitude trace data, A<sub>out</sub>(t-t<sub>0j</sub>).</p><heading id="h0010"><b>B. Destretch Method Time-Angle Domain</b></heading><p id="p0059" num="0059">In step 110, stretched seismic traces are acquired. As described above, the stretched traces may have been processed by normal move out removal (NMOR) or through the Pre-Stack imaging process.</p><p id="p0060" num="0060">Stretch factors β are then determined in step 120B for the stretched seismic traces. The stretch factor β is defined as the inverse of the cosine of the reflection angle θ<sub>r</sub>.<!-- EPO <DP n="21"> --> Since this reflection angle θ<sub>r</sub> is a constant value over a trace, the reflection angle θ<sub>r</sub> can be determined directly by interrogating the trace header for each trace.</p><p id="p0061" num="0061">Input spectra for stretched trace windows are determined in step 130B. The data is split into overlapping windows. Each window, in turn, is converted to the frequency domain by taking its Fourier transform in step 132B and calculating its amplitude spectrum.</p><p id="p0062" num="0062">An estimate of the stretched wavelet (amplitude) spectrum is calculated in step 140B. These estimates are determined by smoothing the input spectra from step 132B by low pass filtering thus forming the estimate of the stretched wavelet spectrum.</p><p id="p0063" num="0063">A destretched wavelet spectrum is obtained in step 150B. Preferably, the destretched wavelet spectrum is calculated as follows. The estimate of the stretched wavelet spectrum determined in step 140B is now corrected utilizing the Similarity Theorem. This correction uses the stretch factor (β) determined in step 120B and the estimate of the stretched wavelet spectrum to correct for the stretch in the data. The amplitude for each frequency sample in step 140B is interpolated at a frequency that is the product of β and the current frequency. The amplitude for that frequency sample is, in turn, scaled by the stretch factor β and becomes the destretched wavelet (amplitude) spectrum.</p><p id="p0064" num="0064">As an alternative to calculating the destretched output spectrum, a user defined target waveform may be used to generate the destretched output spectrum. This destretched output spectrum preferably has the characteristic of having high and low frequency characteristics that extend across the usable data frequencies on the widest offset traces.</p><p id="p0065" num="0065">If warranted, an additional adjustment is made to the shaping correction factors in step 160B to accommodate for non-white reflectivity. This correction is calculated by modeling the amplitude spectrum of the underlying earth reflectivity. The modeled earth reflectivity spectrum is divided into the destretched wavelet spectrum determined in step 150B.<!-- EPO <DP n="22"> --></p><p id="p0066" num="0066">Shaping correction factors (or corrected shaping factors) are determined in step 162B by comparing the estimates of the stretched wavelet spectrum with the desired destretched wavelet spectrum. The quotient or ratio of each corresponding frequency sample of the destretched wavelet spectra to the stretched wavelet spectra is calculated to arrive at the shaping correction factors. Preferably, a stabilization factor is added to the denominator to prevent division by zero.</p><p id="p0067" num="0067">The shaping correction factors (or the adjusted shaping factors) are applied in step 170B to the input spectra of the stretched traces to arrive at a destretched trace spectra.</p><p id="p0068" num="0068">True relative amplitude scaling factors are then computed in step 180B. Ratios of corresponding true relative amplitude properties of the stretched and destretched wavelet spectra are calculated to determine the true relative amplitude scaling factors. Again, these true relative amplitude properties might include zero time value of a wavelet, the area under the amplitude spectrum of the wavelet, or the time average mean absolute value of the stretched traces.</p><p id="p0069" num="0069">The true relative amplitude scaling factors and shaping correction factors (or corrected shaping correction factors) are applied in step 190B to the destretched trace spectra to arrive at true relative amplitude destretched seismic trace whereby the true relative amplitude property of the stretched wavelet spectra is substantially preserved. More particularly, corresponding frequency samples of the shaping correction factors (or corrected shaping correction factors) and the true relative amplitude scaling factors are applied to the input spectra of the stretched trace windows to arrive at an output spectra of destretched trace windows. In step 192B the destretched time windows of the data are formed by taking the inverse Fourier transform of the product of step 190B. The destretched seismic traces are formed in step 194B by summing the individual windows to reconstitute the traces.</p><p id="p0070" num="0070"><figref idrefs="f0005">FIG. 5</figref> is an example of destretching a common angle CMP gather. The stretched input gathers on the left have interference induced apparent residual moveout as well<!-- EPO <DP n="23"> --> as angle dependent variations in amplitude irrespective of the fact that each event's reflection coefficients are equal with angle. In the destretched data on the right, all events have nearly identical amplitudes with angle as well as reduced apparent residual moveout.</p><p id="p0071" num="0071">The inventor also includes a program storage device readable by a machine, tangibly embodying a program of instructions executable by the machine to perform method steps for arriving at true relative amplitude destretched seismic traces from stretched seismic traces using the following steps:
<ol><li>a. acquiring stretched seismic traces;</li><li>b. determining stretch factors β for the stretched seismic traces;</li><li>c. determining input spectra for the stretched seismic traces;</li><li>d. determining estimates of stretched wavelet spectra from the input spectra;</li><li>e. obtaining a destretched wavelet spectra;</li><li>f. determining shaping correction factors by taking the ratio of the destretched wavelet spectra to the stretched wavelet spectra;</li><li>g. applying the shaping correction factors to the input spectra of the stretched traces to arrive at a destretched trace spectra;</li><li>h. computing true relative amplitude scaling factors by taking the ratio of a true relative amplitude property of the destretched wavelet spectra to a corresponding true relative amplitude property of the stretched wavelet spectra; and</li><li>i. applying the true relative amplitude scaling factors to the destretched trace spectra to arrive at true relative amplitude destretched seismic trace whereby the true relative amplitude property of the stretched wavelet spectra is substantially preserved.</li></ol></p><p id="p0072" num="0072">While in the foregoing specification this invention has been described in relation to certain preferred embodiments thereof, and many details have been set forth for purposes of illustration, it will be apparent to those skilled in the art that the invention is susceptible to alteration and that certain other details described herein can vary considerably without departing from the basic principles of the invention.<!-- EPO <DP n="24"> --></p><p id="p0073" num="0073">For the avoidance of doubt, the subject-matter of the present invention includes subject-matter as defined in the following numbered paragraphs (hereafter "para."):
<ol><li>1. A method for arriving at true relative amplitude destretched seismic traces from stretched seismic traces, the method comprising the steps of:
<ol><li>a. acquiring stretched seismic traces;</li><li>b. determining stretch factors β for the stretched seismic traces;</li><li>c. determining input spectra for the stretched seismic traces;</li><li>d. determining estimates of stretched wavelet spectra from the input spectra;</li><li>e. obtaining a destretched wavelet spectra;</li><li>f. determining shaping correction factors by taking the ratio of the destretched wavelet spectra to the stretched wavelet spectra;</li><li>g. applying the shaping correction factors to the input spectra of the stretched traces to arrive at a destretched trace spectra;</li><li>h. computing true relative amplitude scaling factors by taking the ratio of a true relative amplitude property of the destretched wavelet spectra to a corresponding true relative amplitude property of the stretched wavelet spectra; and</li><li>i. applying the true relative amplitude scaling factors to the destretched trace spectra to arrive at true relative amplitude destretched seismic trace whereby the true relative amplitude property of the stretched wavelet spectra is substantially preserved.</li></ol></li><li>2. The method of para. 1 wherein:
<ul><li>the destretched wavelet spectra is obtained by mapping the stretched wavelet spectra utilizing the similarity theorem with the stretch factor into a destretched wavelet spectra utilizing the following mathematical formulas: <maths id="math0027" num=""><math display="block"><mi mathvariant="normal">W</mi><mfenced><mi mathvariant="normal">f</mi></mfenced><mo>=</mo><msub><mi mathvariant="normal">W</mi><mi mathvariant="normal">n</mi></msub><mfenced separators=""><mi mathvariant="normal">f</mi><mo>/</mo><mi mathvariant="normal">β</mi></mfenced><mo>/</mo><mfenced open="|" close="|"><mi mathvariant="normal">β</mi></mfenced></math><img id="ib0027" file="imgb0027.tif" wi="47" he="12" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="25"> --> where:
<ul><li>W(f) = destretched wavelet spectra;</li><li>W<sub>n</sub>(f) = the stretched wavelet spectra</li><li>β = the wavelet stretch factor</li></ul></li></ul></li><li>3. The method of para. 2 wherein the stretched wavelet spectra are modified to correct for a non-white reflectivity utilizing the following mathematical formula: <maths id="math0028" num=""><math display="block"><msub><mi mathvariant="normal">W</mi><mi mathvariant="normal">s</mi></msub><mfenced><mi mathvariant="normal">f</mi></mfenced><mo>=</mo><msub><mi mathvariant="normal">W</mi><mi mathvariant="normal">n</mi></msub><mfenced><mi mathvariant="normal">f</mi></mfenced><mo>⁢</mo><mi mathvariant="normal">R</mi><mfenced><mi mathvariant="normal">f</mi></mfenced><mo>/</mo><mi mathvariant="normal">R</mi><mfenced separators=""><mi mathvariant="normal">f</mi><mo>/</mo><mi mathvariant="normal">β</mi></mfenced></math><img id="ib0028" file="imgb0028.tif" wi="55" he="9" img-content="math" img-format="tif"/></maths><br/>
where:
<ul><li>W<sub>s</sub>(f) = the stretched wavelet spectra corrected for a non-white reflectivity spectrum;</li><li>W<sub>n</sub>(f) = the stretched wavelet spectra;</li><li>R(f) = a user specified reflectivity spectrum in normal incidence time; and</li><li>β = the wavelet stretch factor.</li></ul></li><li>4. The method of para. 1 wherein:
<ul><li>the destretched wavelet spectra is obtained from a user specified target wavelet spectra wherein: <maths id="math0029" num=""><math display="block"><mi mathvariant="normal">W</mi><mfenced><mi mathvariant="normal">f</mi></mfenced><mo>=</mo><msub><mi mathvariant="normal">W</mi><mi mathvariant="normal">d</mi></msub><mfenced><mi mathvariant="normal">f</mi></mfenced><mo>;</mo></math><img id="ib0029" file="imgb0029.tif" wi="37" he="10" img-content="math" img-format="tif"/></maths><br/>
where:
<ul><li>W(f) = destretched wavelet spectra; and</li><li>W<sub>d</sub>(f) = a user specified target wavelet spectra.</li></ul></li></ul></li><li>5. The method of para. 4 wherein the target wavelet spectra are modified to correct for a non-white reflectivity utilizing the following mathematical formula: <maths id="math0030" num=""><math display="block"><mi mathvariant="normal">W</mi><mfenced><mi mathvariant="normal">f</mi></mfenced><mo>=</mo><msub><mi mathvariant="normal">W</mi><mi mathvariant="normal">d</mi></msub><mfenced><mi mathvariant="normal">f</mi></mfenced><mo>⁢</mo><mi mathvariant="normal">R</mi><mfenced><mi mathvariant="normal">f</mi></mfenced></math><img id="ib0030" file="imgb0030.tif" wi="40" he="10" img-content="math" img-format="tif"/></maths><br/>
where:
<ul><li>W(f) = destretched wavelet spectra;<!-- EPO <DP n="26"> --></li><li>W<sub>d</sub>(f) = a user specified target wavelet spectra; and</li><li>R(f) = a user specified reflectivity spectrum in vertical time.</li></ul></li><li>6. The method of para. 1 wherein:
<ul><li>the stretch factors β are calculated deterministically as functions of offset, time, rms velocity and interval velocity.</li></ul></li><li>7. The method of para. 1 wherein:
<ul><li>the stretch factors β are calculated deterministically as functions of offset, time, rms velocity, interval velocity and at least one of overburden anisotropy and geologic dip.</li></ul></li><li>8. The method of para. 7 wherein:
<ul><li>the stretched seismic traces are CDP gathers and β<sup>-1</sup> is calculated in accordance with the following mathematical expression: <maths id="math0031" num=""><math display="block"><mi mathvariant="normal">β</mi><mo>=</mo><msup><mfenced separators=""><mn mathvariant="normal">1</mn><mo>-</mo><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">r</mi></msub></mfenced><mrow><mo>-</mo><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup><mo>=</mo><mn mathvariant="normal">1</mn><mo>/</mo><msub><mi mathvariant="normal">cos θ</mi><mi mathvariant="normal">r</mi></msub><mo>;</mo></math><img id="ib0031" file="imgb0031.tif" wi="56" he="13" img-content="math" img-format="tif"/></maths><br/>
where <maths id="math0032" num=""><math display="block"><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">r</mi></msub><mo>=</mo><msup><mfenced separators=""><mi mathvariant="normal">x</mi><mspace width="1em"/><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">i</mi></msub><mo>⁢</mo><msub><mrow><mspace width="1em"/><mi mathvariant="normal">cosθ</mi></mrow><mi mathvariant="normal">d</mi></msub></mfenced><mn mathvariant="normal">2</mn></msup><mo>/</mo><mfenced separators=""><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mn mathvariant="normal">4</mn></msup><mo>⁢</mo><mfenced separators=""><msup><msub><mi mathvariant="normal">t</mi><mn mathvariant="normal">0</mn></msub><mn mathvariant="normal">2</mn></msup><mo>+</mo><msup><mfenced><msub><mi mathvariant="normal">xcosθ</mi><mi mathvariant="normal">d</mi></msub></mfenced><mn mathvariant="normal">2</mn></msup><mo>/</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mn mathvariant="normal">2</mn></msup></mfenced></mfenced><mo>;</mo></math><img id="ib0032" file="imgb0032.tif" wi="84" he="9" img-content="math" img-format="tif"/></maths> <maths id="math0033" num=""><math display="block"><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mo>=</mo><msub><mi mathvariant="normal">v</mi><mi>rms</mi></msub><mo>⁢</mo><msup><mfenced separators=""><mn mathvariant="normal">1</mn><mo>+</mo><mn mathvariant="normal">2</mn><mo>⁢</mo><msup><mi mathvariant="normal">ε sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><mi mathvariant="normal">α</mi><mo>⁢</mo><mfenced separators=""><mn mathvariant="normal">2</mn><mo>-</mo><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><mi mathvariant="normal">α</mi></mfenced></mfenced><mrow><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup><mo>;</mo></math><img id="ib0033" file="imgb0033.tif" wi="67" he="8" img-content="math" img-format="tif"/></maths><maths id="math0034" num=""><math display="block"><mrow><msup><mrow><mi mathvariant="normal">sin</mi></mrow><mrow><mn mathvariant="normal">2</mn></mrow></msup><mo>⁢</mo><mi mathvariant="normal">α</mi><mo>=</mo><msup><mrow><mi mathvariant="normal">x</mi></mrow><mrow><mn mathvariant="normal">2</mn></mrow></msup><mo>/</mo><msup><mfenced separators=""><msup><mrow><mi mathvariant="normal">x</mi></mrow><mrow><mn mathvariant="normal">2</mn></mrow></msup><mo>+</mo><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">rms</mi></msub><mo>⁢</mo><msub><mrow><mi mathvariant="normal">t</mi></mrow><mrow><mn mathvariant="normal">0</mn></mrow></msub></mfenced><mrow><mn mathvariant="normal">2</mn></mrow></msup><mrow><mo>)</mo></mrow><mo>;</mo></mrow></math><img id="ib0034" file="imgb0034.tif" wi="46" he="8" img-content="math" img-format="tif"/></maths><br/>
and<br/>
where<br/>
θ <sub>r</sub> is the reflection angle at the interface;<br/>
x is shot to group offset,<br/>
v<sub>i</sub> is the subsurface interval velocity at the t<sub>0</sub>;<br/>
v<sub>rms</sub> is the rms velocity of overburden;<br/>
t<sub>0</sub> is the zero offset travel time;<br/>
ε is the overburden anisotropy parameter; and θ<sub>d</sub> is the geologic dip at the interface.</li></ul><!-- EPO <DP n="27"> --></li><li>9. The method of para. 7 wherein:
<ul><li>the stretched seismic traces are dip moveout (DMO) gathers and β<sup>-1</sup> is calculated in accordance with the following mathematical expression: <maths id="math0035" num=""><math display="block"><mi mathvariant="normal">β</mi><mo>=</mo><msup><mfenced separators=""><mn mathvariant="normal">1</mn><mo>-</mo><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">r</mi></msub></mfenced><mrow><mo>-</mo><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup><mo>;</mo></math><img id="ib0035" file="imgb0035.tif" wi="35" he="9" img-content="math" img-format="tif"/></maths><br/>
where <maths id="math0036" num=""><math display="block"><mtable><mtr><mtd><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">r</mi></msub><mo>=</mo><msup><mfenced separators=""><mi>x cos</mi><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">d</mi></msub></mfenced><mn mathvariant="normal">2</mn></msup><mo>/</mo><mfenced separators=""><mfenced separators=""><msup><msub><mi mathvariant="normal">t</mi><mi>dmo</mi></msub><mn>2</mn></msup><mo>⁢</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mn mathvariant="normal">4</mn></msup><mo>/</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">i</mi></msub><mn mathvariant="normal">2</mn></msup></mfenced><mo>+</mo><mfenced separators=""><msup><mi>cos</mi><mn mathvariant="normal">4</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">d</mi></msub><mo>⁢</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mn mathvariant="normal">2</mn></msup><mo>/</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">i</mi></msub><mn mathvariant="normal">2</mn></msup></mfenced></mfenced></mtd></mtr><mtr><mtd><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mo>=</mo><msub><mi mathvariant="normal">v</mi><mi>rms</mi></msub><mo>⁢</mo><msup><mfenced separators=""><mn mathvariant="normal">1</mn><mo>+</mo><mn mathvariant="normal">2</mn><mo>⁢</mo><msup><mi mathvariant="normal">ε sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><mi mathvariant="normal">α</mi><mo>⁢</mo><mfenced separators=""><mn mathvariant="normal">2</mn><mo>-</mo><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><mi mathvariant="normal">α</mi></mfenced></mfenced><mrow><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup><mo>;</mo></mtd></mtr></mtable></math><img id="ib0036" file="imgb0036.tif" wi="100" he="18" img-content="math" img-format="tif"/></maths> <maths id="math0037" num=""><math display="block"><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><mi mathvariant="normal">α</mi><mo>=</mo><msup><mi mathvariant="normal">x</mi><mn mathvariant="normal">2</mn></msup><mo>/</mo><msup><mfenced separators=""><msup><mi mathvariant="normal">x</mi><mn mathvariant="normal">2</mn></msup><mo>+</mo><msub><mi mathvariant="normal">v</mi><mi>rms</mi></msub><mo>⁢</mo><msub><mi mathvariant="normal">t</mi><mn mathvariant="normal">0</mn></msub></mfenced><mn mathvariant="normal">2</mn></msup><mrow><mo>)</mo></mrow><mo>;</mo></math><img id="ib0037" file="imgb0037.tif" wi="46" he="9" img-content="math" img-format="tif"/></maths><br/>
and<br/>
where<br/>
θ <sub>r</sub> is the reflection angle at the interface;<br/>
x is shot to group offset,<br/>
v<sub>i</sub> is the subsurface interval velocity at the t<sub>0</sub>;<br/>
v<sub>rms</sub> is the rms velocity of overburden;<br/>
t<sub>dmo</sub> is the zero offset travel time of DMO gathers;<br/>
ε is the overburden anisotropy parameter; and<br/>
θ <sub>d</sub> is the geologic dip at the interface.</li></ul></li><li>10. The method of para. 7 wherein:
<ul><li>the stretched seismic traces are CRP gathers and β<sup>-1</sup> is calculated in accordance with the following mathematical expression: <maths id="math0038" num=""><math display="block"><mi mathvariant="normal">β</mi><mo>=</mo><msup><mfenced separators=""><mn mathvariant="normal">1</mn><mo>-</mo><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">r</mi></msub></mfenced><mrow><mo>-</mo><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup><mo>;</mo></math><img id="ib0038" file="imgb0038.tif" wi="35" he="12" img-content="math" img-format="tif"/></maths><br/>
where <maths id="math0039" num=""><math display="block"><mtable><mtr><mtd><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">r</mi></msub><mo>=</mo><msup><mfenced separators=""><msup><mi>x cos</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">d</mi></msub></mfenced><mn mathvariant="normal">2</mn></msup><mo>/</mo><mfenced separators=""><mfenced separators=""><msup><msub><mi mathvariant="normal">t</mi><mi>mig</mi></msub><munder><mn mathvariant="normal">2</mn><mo>̲</mo></munder></msup><mo>⁢</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mn mathvariant="normal">4</mn></msup><mo>/</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">i</mi></msub><mn mathvariant="normal">2</mn></msup></mfenced><mo>+</mo><mfenced separators=""><msup><mi>cos</mi><mn mathvariant="normal">4</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">d</mi></msub><mo>⁢</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mn mathvariant="normal">2</mn></msup><mo>/</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">i</mi></msub><mn mathvariant="normal">2</mn></msup></mfenced></mfenced></mtd></mtr><mtr><mtd><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mo>=</mo><msub><mi mathvariant="normal">v</mi><mi>rms</mi></msub><mo>⁢</mo><msup><mfenced separators=""><mn mathvariant="normal">1</mn><mo>+</mo><mn mathvariant="normal">2</mn><mo>⁢</mo><msup><mi mathvariant="normal">ε sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><mi mathvariant="normal">α</mi><mo>⁢</mo><mfenced separators=""><mn mathvariant="normal">2</mn><mo>-</mo><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><mi mathvariant="normal">α</mi></mfenced></mfenced><mrow><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup><mo>;</mo></mtd></mtr></mtable></math><img id="ib0039" file="imgb0039.tif" wi="100" he="18" img-content="math" img-format="tif"/></maths> <maths id="math0040" num=""><math display="block"><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><mi mathvariant="normal">α</mi><mo>=</mo><msup><mi mathvariant="normal">x</mi><mn mathvariant="normal">2</mn></msup><mo>/</mo><msup><mfenced separators=""><msup><mi mathvariant="normal">x</mi><mn mathvariant="normal">2</mn></msup><mo>+</mo><msub><mi mathvariant="normal">v</mi><mi>rms</mi></msub><mo>⁢</mo><msub><mi mathvariant="normal">t</mi><mn mathvariant="normal">0</mn></msub></mfenced><mn mathvariant="normal">2</mn></msup><mrow><mo>)</mo></mrow><mo>;</mo></math><img id="ib0040" file="imgb0040.tif" wi="46" he="10" img-content="math" img-format="tif"/></maths><br/>
and<br/>
where<br/>
θ <sub>r</sub> is the reflection angle at the interface;<br/>
x is shot to group offset,<br/>
v<sub>i</sub> is the subsurface interval velocity at the t<sub>0</sub>;<br/>
v<sub>rms</sub> is the rms velocity of overburden;<br/>
<!-- EPO <DP n="28"> -->t<sub>mig</sub> is the zero offset time of migrated gathers;<br/>
ε is the overburden anisotropy parameter; and<br/>
θ <sub>d</sub> is the geologic dip at the interface.</li></ul></li><li>11. The method of para. 1 wherein:
<ul><li>the true relative amplitude property, that is preserved in the true relative amplitude destretched traces, is selected from one of the following zero time value of the wavelet, the area under the amplitude spectrum of the wavelet,</li><li>and time average mean absolute value of the stretched traces.</li></ul></li><li>12. A method of computing true relative amplitude scaling factors comprising the steps of:
<ul><li>determining a stretched wavelet spectra for NMOR stretched gather of traces;</li><li>determining a destretched wavelet spectra; and</li><li>taking the ratio of a true relative amplitude property of the destretched wavelet spectra to a corresponding true relative amplitude property of the stretched wavelet spectra to compute true relative amplitude scaling factors.</li></ul></li><li>13. A method of obtaining destretched wavelet spectra from a gather of stretched traces, the method comprising:
<ul><li>mapping the stretched wavelet spectra utilizing the similarity theorem with the stretch factor into a destretched wavelet spectra utilizing the following mathematical formulas: <maths id="math0041" num=""><math display="block"><mi mathvariant="normal">W</mi><mfenced><mi mathvariant="normal">f</mi></mfenced><mo>=</mo><msub><mi mathvariant="normal">W</mi><mi mathvariant="normal">n</mi></msub><mfenced separators=""><mi mathvariant="normal">f</mi><mo>/</mo><mi mathvariant="normal">β</mi></mfenced><mo>/</mo><mfenced open="|" close="|"><mi mathvariant="normal">β</mi></mfenced></math><img id="ib0041" file="imgb0041.tif" wi="46" he="12" img-content="math" img-format="tif"/></maths><br/>
where:
<ul><li>W(f) = destretched wavelet spectra;</li><li>W<sub>n</sub>(f) = the stretched wavelet spectra</li><li>β = the wavelet stretch factor.</li></ul></li></ul></li><li>14. A method for calculating stretch factors β for stretched seismic traces wherein:
<ul><li>the stretch factors β are calculated deterministically as functions of offset, time, rms velocity and interval velocity.</li></ul><!-- EPO <DP n="29"> --></li><li>15. The method of para. 14 wherein:
<ul><li>the stretch factors β are calculated deterministically as functions of offset, time, rms velocity, interval velocity and at least one of overburden anisotropy and geologic dip.</li></ul></li><li>16. The method of para. 14 wherein:
<ul><li>the stretched seismic traces are CDP gathers and β<sup>-1</sup> is calculated in accordance with the following mathematical expression: <maths id="math0042" num=""><math display="block"><mi mathvariant="normal">β</mi><mo>=</mo><msup><mfenced separators=""><mn mathvariant="normal">1</mn><mo>-</mo><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">r</mi></msub></mfenced><mrow><mo>-</mo><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup><mo>;</mo></math><img id="ib0042" file="imgb0042.tif" wi="35" he="13" img-content="math" img-format="tif"/></maths><br/>
where <maths id="math0043" num=""><math display="block"><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">r</mi></msub><mo>=</mo><msup><mfenced separators=""><mi mathvariant="normal">x</mi><mspace width="1em"/><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">i</mi></msub><mo>⁢</mo><msub><mrow><mspace width="1em"/><mi mathvariant="normal">cosθ</mi></mrow><mi mathvariant="normal">d</mi></msub></mfenced><mn mathvariant="normal">2</mn></msup><mo>/</mo><mfenced separators=""><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mn mathvariant="normal">4</mn></msup><mo>⁢</mo><mfenced separators=""><msup><msub><mi mathvariant="normal">t</mi><mn mathvariant="normal">0</mn></msub><mn mathvariant="normal">2</mn></msup><mo>+</mo><msup><mfenced><msub><mi mathvariant="normal">xcosθ</mi><mi mathvariant="normal">d</mi></msub></mfenced><mn mathvariant="normal">2</mn></msup><mo>/</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mn mathvariant="normal">2</mn></msup></mfenced></mfenced><mo>;</mo></math><img id="ib0043" file="imgb0043.tif" wi="91" he="8" img-content="math" img-format="tif"/></maths> <maths id="math0044" num=""><math display="block"><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mo>=</mo><msub><mi mathvariant="normal">v</mi><mi>rms</mi></msub><mo>⁢</mo><msup><mfenced separators=""><mn mathvariant="normal">1</mn><mo>+</mo><mn mathvariant="normal">2</mn><mo>⁢</mo><msup><mi mathvariant="normal">ε sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><mi mathvariant="normal">α</mi><mo>⁢</mo><mfenced separators=""><mn mathvariant="normal">2</mn><mo>-</mo><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><mi mathvariant="normal">α</mi></mfenced></mfenced><mrow><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup><mo>;</mo></math><img id="ib0044" file="imgb0044.tif" wi="63" he="8" img-content="math" img-format="tif"/></maths> <maths id="math0045" num=""><math display="block"><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><mi mathvariant="normal">α</mi><mo>=</mo><msup><mi mathvariant="normal">x</mi><mn mathvariant="normal">2</mn></msup><mo>/</mo><msup><mfenced separators=""><msup><mi mathvariant="normal">x</mi><mn mathvariant="normal">2</mn></msup><mo>+</mo><msub><mi mathvariant="normal">v</mi><mi>rms</mi></msub><mo>⁢</mo><msub><mi mathvariant="normal">t</mi><mn mathvariant="normal">0</mn></msub></mfenced><mn mathvariant="normal">2</mn></msup><mrow><mo>)</mo></mrow><mo>;</mo></math><img id="ib0045" file="imgb0045.tif" wi="45" he="10" img-content="math" img-format="tif"/></maths><br/>
and<br/>
where<br/>
θ <sub>r</sub> is the reflection angle at the interface;<br/>
x is shot to group offset,<br/>
v<sub>i</sub> is the subsurface interval velocity at the t<sub>0</sub>;<br/>
v<sub>rms</sub> is the rms velocity of overburden;<br/>
t<sub>0</sub> is the zero offset travel time;<br/>
ε is the overburden anisotropy parameter; and<br/>
θ <sub>d</sub> is the geologic dip at the interface.</li></ul></li><li>17. The method of para. 14 wherein:
<ul><li>the stretched seismic traces are dip moveout (DMO) gathers and β<sup>-1</sup> is calculated in accordance with the following mathematical expression: <maths id="math0046" num=""><math display="block"><mi mathvariant="normal">β</mi><mo>=</mo><msup><mfenced separators=""><mn mathvariant="normal">1</mn><mo>-</mo><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">r</mi></msub></mfenced><mrow><mo>-</mo><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup><mo>;</mo></math><img id="ib0046" file="imgb0046.tif" wi="39" he="9" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="30"> --> where <maths id="math0047" num=""><math display="block"><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">r</mi></msub><mo>=</mo><msup><mfenced separators=""><mi>x cos</mi><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">d</mi></msub></mfenced><mn mathvariant="normal">2</mn></msup><mo>/</mo><mfenced separators=""><mfenced separators=""><msup><msub><mi mathvariant="normal">t</mi><mi>dmo</mi></msub><mn>2</mn></msup><mo>⁢</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mn mathvariant="normal">4</mn></msup><mo>/</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">i</mi></msub><mn mathvariant="normal">2</mn></msup></mfenced><mo>+</mo><mfenced separators=""><msup><mi>cos</mi><mn mathvariant="normal">4</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">d</mi></msub><mo>⁢</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mn mathvariant="normal">2</mn></msup><mo>/</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">i</mi></msub><mn mathvariant="normal">2</mn></msup></mfenced></mfenced></math><img id="ib0047" file="imgb0047.tif" wi="99" he="9" img-content="math" img-format="tif"/></maths> <maths id="math0048" num=""><math display="block"><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mo>=</mo><msub><mi mathvariant="normal">v</mi><mi>rms</mi></msub><mo>⁢</mo><msup><mfenced separators=""><mn mathvariant="normal">1</mn><mo>+</mo><mn mathvariant="normal">2</mn><mo>⁢</mo><msup><mi mathvariant="normal">ε sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><mi mathvariant="normal">α</mi><mo>⁢</mo><mfenced separators=""><mn mathvariant="normal">2</mn><mo>-</mo><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><mi mathvariant="normal">α</mi></mfenced></mfenced><mrow><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup><mo>;</mo></math><img id="ib0048" file="imgb0048.tif" wi="62" he="8" img-content="math" img-format="tif"/></maths><maths id="math0049" num=""><math display="block"><mrow><msup><mrow><mi mathvariant="normal">sin</mi></mrow><mrow><mn mathvariant="normal">2</mn></mrow></msup><mo>⁢</mo><mi mathvariant="normal">α</mi><mo>=</mo><msup><mrow><mi mathvariant="normal">x</mi></mrow><mrow><mn mathvariant="normal">2</mn></mrow></msup><mo>/</mo><msup><mfenced separators=""><msup><mrow><mi mathvariant="normal">x</mi></mrow><mrow><mn mathvariant="normal">2</mn></mrow></msup><mo>+</mo><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">rms</mi></msub><mo>⁢</mo><msub><mrow><mi mathvariant="normal">t</mi></mrow><mrow><mn mathvariant="normal">0</mn></mrow></msub></mfenced><mrow><mn mathvariant="normal">2</mn></mrow></msup><mrow><mo>)</mo></mrow><mo>;</mo></mrow></math><img id="ib0049" file="imgb0049.tif" wi="45" he="8" img-content="math" img-format="tif"/></maths> and where<br/>
θ <sub>r</sub> is the reflection angle at the interface;<br/>
x is shot to group offset,<br/>
v<sub>i</sub> is the subsurface interval velocity at the t<sub>0</sub>;<br/>
v<sub>rms</sub> is the rms velocity of overburden;<br/>
t<sub>dmo</sub> is the zero offset travel time of DMO gathers;<br/>
ε is the overburden anisotropy parameter; and<br/>
θ <sub>d</sub> is the geologic dip at the interface.</li></ul></li><li>18. The method of para. 14 wherein:
<ul><li>the stretched seismic traces are CRP gathers and β<sup>-1</sup> is calculated in accordance with the following mathematical expression: <maths id="math0050" num=""><math display="block"><mi mathvariant="normal">β</mi><mo>=</mo><msup><mfenced separators=""><mn mathvariant="normal">1</mn><mo>-</mo><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">r</mi></msub></mfenced><mrow><mo>-</mo><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup><mo>;</mo></math><img id="ib0050" file="imgb0050.tif" wi="37" he="10" img-content="math" img-format="tif"/></maths><br/>
where <maths id="math0051" num=""><math display="block"><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">r</mi></msub><mo>=</mo><msup><mfenced separators=""><msup><mi>x cos</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">d</mi></msub></mfenced><mn mathvariant="normal">2</mn></msup><mo>/</mo><mfenced separators=""><mfenced separators=""><msup><msub><mi mathvariant="normal">t</mi><mi>mig</mi></msub><munder><mn mathvariant="normal">2</mn><mo>̲</mo></munder></msup><mo>⁢</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mn mathvariant="normal">4</mn></msup><mo>/</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">i</mi></msub><mn mathvariant="normal">2</mn></msup></mfenced><mo>+</mo><mfenced separators=""><msup><mi>cos</mi><mn mathvariant="normal">4</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">θ</mi><mi mathvariant="normal">d</mi></msub><mo>⁢</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mn mathvariant="normal">2</mn></msup><mo>/</mo><msup><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">i</mi></msub><mn mathvariant="normal">2</mn></msup></mfenced></mfenced></math><img id="ib0051" file="imgb0051.tif" wi="98" he="9" img-content="math" img-format="tif"/></maths> <maths id="math0052" num=""><math display="block"><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi></msub><mo>=</mo><msub><mi mathvariant="normal">v</mi><mi>rms</mi></msub><mo>⁢</mo><msup><mfenced separators=""><mn mathvariant="normal">1</mn><mo>+</mo><mn mathvariant="normal">2</mn><mo>⁢</mo><msup><mi mathvariant="normal">ε sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><mi mathvariant="normal">α</mi><mo>⁢</mo><mfenced separators=""><mn mathvariant="normal">2</mn><mo>-</mo><msup><mi>sin</mi><mn mathvariant="normal">2</mn></msup><mo>⁢</mo><mi mathvariant="normal">α</mi></mfenced></mfenced><mrow><mn mathvariant="normal">1</mn><mo>/</mo><mn mathvariant="normal">2</mn></mrow></msup><mo>;</mo></math><img id="ib0052" file="imgb0052.tif" wi="66" he="8" img-content="math" img-format="tif"/></maths><maths id="math0053" num=""><math display="block"><mrow><msup><mrow><mi mathvariant="normal">sin</mi></mrow><mrow><mn mathvariant="normal">2</mn></mrow></msup><mo>⁢</mo><mi mathvariant="normal">α</mi><mo>=</mo><msup><mrow><mi mathvariant="normal">x</mi></mrow><mrow><mn mathvariant="normal">2</mn></mrow></msup><mo>/</mo><msup><mfenced separators=""><msup><mrow><mi mathvariant="normal">x</mi></mrow><mrow><mn mathvariant="normal">2</mn></mrow></msup><mo>+</mo><msub><mi mathvariant="normal">v</mi><mi mathvariant="normal">rms</mi></msub><mo>⁢</mo><msub><mrow><mi mathvariant="normal">t</mi></mrow><mrow><mn mathvariant="normal">0</mn></mrow></msub></mfenced><mrow><mn mathvariant="normal">2</mn></mrow></msup><mrow><mo>)</mo></mrow><mo>;</mo></mrow></math><img id="ib0053" file="imgb0053.tif" wi="49" he="9" img-content="math" img-format="tif"/></maths><br/>
and<br/>
where<br/>
θ <sub>r</sub> is the reflection angle at the interface;<br/>
x is shot to group offset,<br/>
v<sub>i</sub> is the subsurface interval velocity at the t<sub>0</sub>;<br/>
v<sub>rms</sub> is the rms velocity of overburden;<br/>
t<sub>mig</sub> is the zero offset time of migrated gathers;<br/>
ε is the overburden anisotropy parameter; and<br/>
θ <sub>d</sub> is the geologic dip at the interface.</li></ul></li><li>19. A program storage device readable by a machine, tangibly embodying a program of instructions executable by the machine to perform method steps<!-- EPO <DP n="31"> --> for arriving at true relative amplitude destretched seismic traces from stretched seismic traces, the method comprising the steps of:
<ol><li>a. acquiring stretched seismic traces;</li><li>b. determining stretch factors β for the stretched seismic traces;</li><li>c. determining input spectra for the stretched seismic traces;</li><li>d. determining estimates of stretched wavelet spectra from the input spectra;</li><li>e. obtaining a destretched wavelet spectra;</li><li>f. determining shaping correction factors by taking the ratio of the destretched wavelet spectra to the stretched wavelet spectra;</li><li>g. applying the shaping correction factors to the input spectra of the stretched traces to arrive at a destretched trace spectra;</li><li>h. computing true relative amplitude scaling factors by taking the ratio of a true relative amplitude property of the destretched wavelet spectra to a corresponding true relative amplitude property of the stretched wavelet spectra; and</li><li>i. applying the true relative amplitude scaling factors to the destretched trace spectra to arrive at true relative amplitude destretched seismic trace whereby the true relative amplitude property of the stretched wavelet spectra is substantially preserved.</li></ol></li></ol></p></description><claims mxw-id="PCLM56976546" lang="EN" load-source="patent-office"><!-- EPO <DP n="32"> --><claim id="c-en-0001" num="0001"><claim-text>A method of computing true relative amplitude scaling factors comprising the steps of:
<claim-text>determining a stretched wavelet spectra for NMOR stretched gather of traces;</claim-text>
<claim-text>determining a destretched wavelet spectra; and</claim-text>
<claim-text>taking the ratio of a true relative amplitude property of the destretched wavelet spectra to a corresponding true relative amplitude property of the stretched wavelet spectra to compute true relative amplitude scaling factors.</claim-text></claim-text></claim></claims><drawings mxw-id="PDW16667326" load-source="patent-office"><!-- EPO <DP n="33"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="165" he="212" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="34"> --><figure id="f0002" num="2A,2B,2C"><img id="if0002" file="imgf0002.tif" wi="165" he="215" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="35"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="165" he="210" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="36"> --><figure id="f0004" num="4A,4B,4C,4D"><img id="if0004" file="imgf0004.tif" wi="165" he="210" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="37"> --><figure id="f0005" num="5A,5B"><img id="if0005" file="imgf0005.tif" wi="165" he="223" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="38"> --><figure id="f0006" num="6"><img id="if0006" file="imgf0006.tif" wi="165" he="209" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="39"> --><figure id="f0007" num="7,7A"><img id="if0007" file="imgf0007.tif" wi="165" he="217" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="40"> --><figure id="f0008" num="7B"><img id="if0008" file="imgf0008.tif" wi="165" he="217" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="41"> --><figure id="f0009" num="7C"><img id="if0009" file="imgf0009.tif" wi="165" he="220" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="42"> --><figure id="f0010" num="8"><img id="if0010" file="imgf0010.tif" wi="165" he="220" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="43"> --><figure id="f0011" num="9"><img id="if0011" file="imgf0011.tif" wi="165" he="220" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="158" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="158" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
