<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2680046-A1" country="EP" doc-number="2680046" kind="A1" date="20140101" family-id="39156776" file-reference-id="315023" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146549523" ucid="EP-2680046-A1"><document-id><country>EP</country><doc-number>2680046</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-13185533-A" is-representative="NO"><document-id mxw-id="PAPP154823446" load-source="docdb" format="epo"><country>EP</country><doc-number>13185533</doc-number><kind>A</kind><date>20070910</date><lang>EN</lang></document-id><document-id mxw-id="PAPP220439704" load-source="docdb" format="original"><country>EP</country><doc-number>13185533.0</doc-number><date>20070910</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140452166" ucid="EP-07800588-A" linkage-type="3" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>07800588</doc-number><kind>A</kind><date>20070910</date></document-id></priority-claim><priority-claim mxw-id="PPC140453748" ucid="US-82492106-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>82492106</doc-number><kind>P</kind><date>20060908</date></document-id></priority-claim><priority-claim mxw-id="PPC140451220" ucid="US-86556606-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>86556606</doc-number><kind>P</kind><date>20061113</date></document-id></priority-claim><priority-claim mxw-id="PPC140449132" ucid="US-92981607-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>92981607</doc-number><kind>P</kind><date>20070713</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988095712" load-source="docdb">G01V  15/00        20060101AFI20131015BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988095999" load-source="docdb">H04L   9/32        20060101ALI20131015BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988100337" load-source="docdb">G01V   3/12        20060101ALI20131015BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988104592" load-source="docdb">H04L   9/30        20060101ALI20131015BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-2107895218" load-source="docdb" scheme="CPC">H04L   9/3252      20130101 LI20150122BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2107898902" load-source="docdb" scheme="CPC">H04L   9/3066      20130101 FI20150122BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2107900185" load-source="docdb" scheme="CPC">H04L2209/805       20130101 LA20150122BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132181053" lang="DE" load-source="patent-office">AUTHENTIFIZIERTE HOCHFREQUENZIDENTIFIKATION MIT AGGREGIERTEN SIGNATUREN UND SCHLÜSSELVERTEILUNGSSYSTEM DAFÜR</invention-title><invention-title mxw-id="PT132181054" lang="EN" load-source="patent-office">Authenticated radio frequency identification using aggregate digital signature and key distribution system therefor</invention-title><invention-title mxw-id="PT132181055" lang="FR" load-source="patent-office">ETIQUETTE D'IDENTIFICATION RADIOFRÉQUENCE RADIO AUTHENTIFIÉE UTILSANT DES SIGNATURES AGREGEES ET SYSTÈME DE DISTRIBUTION DE CLÉ CORRESPONDANT</invention-title><citations><patent-citations><patcit mxw-id="PCIT242652589" load-source="docdb" ucid="US-20030183683-A1"><document-id format="epo"><country>US</country><doc-number>20030183683</doc-number><kind>A1</kind><date>20031002</date></document-id><sources><source name="SEA" category="Y" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242652590" load-source="docdb" ucid="US-20060106718-A1"><document-id format="epo"><country>US</country><doc-number>20060106718</doc-number><kind>A1</kind><date>20060518</date></document-id><sources><source name="SEA" category="Y" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT377483656" load-source="docdb" ucid="US-45041806-A" dnum-type="application"><document-id format="epo"><country>US</country><doc-number>45041806</doc-number><kind>A</kind><date>20060612</date></document-id><sources><source name="APP" created-by-npl="N"/></sources></patcit></patent-citations><non-patent-citations><nplcit><text>"Recommendation for Key Management - Part 1: General Revised", NIST SPECIAL PUBLICATION 800-57, NATIONAL INSTITUTE OF STANDARDS AND TECHNOLOGY, May 2006 (2006-05-01)</text><sources><source mxw-id="PNPL67455053" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>BEN-OR ET AL.: "Completeness theorems for non- cryptographic fault-tolerant distributed computation", PROC. OF ACM STOC '88, 1988, pages 1 - 10</text><sources><source mxw-id="PNPL67455054" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>CHAUM ET AL.: "Multi-party unconditionally secure protocols", PROC. OF ACM STOC, vol. 88, 1988</text><sources><source mxw-id="PNPL67455055" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>FDA COUNTERFEITING DRUG TASK FORCE REPORT, 2006</text><sources><source mxw-id="PNPL67455056" load-source="docdb" name="APP"/></sources></nplcit><nplcit><text>LEON A PINTSOV AND SCOTT A VANSTONE: "Postal Revenue Collection in the Digital Age", FINANCIAL CRYPTOGRAPHY,, 1 January 2000 (2000-01-01), pages 105 - 120, XP008133041, DOI: 10.1007/3-540-45472-1_8</text><sources><source mxw-id="PNPL67455057" load-source="docdb" name="SEA" category="IY"/></sources></nplcit><nplcit><text>PEARSON J: "Securing the Pharmaceutical Supply Chain with RFID and Public-key infrastructure (PKI) Technologies", WHITE PAPER TEXAS INSTRUMENTS,, no. RFIDPH01, 1 June 2005 (2005-06-01), pages 1 - 12, XP007916924</text><sources><source mxw-id="PNPL67455058" load-source="docdb" name="SEA" category="YD"/></sources></nplcit><nplcit><text>TZENG S-F ET AL: "Digital signature with message recovery and its variants based on elliptic curve discrete logarithm problem", COMPUTER STANDARDS AND INTERFACES, ELSEVIER SEQUOIA. LAUSANNE, CH, vol. 26, no. 2, 1 March 2004 (2004-03-01), pages 61 - 71, XP004479629, ISSN: 0920-5489, DOI: 10.1016/S0920-5489(03)00069-2</text><sources><source mxw-id="PNPL67455059" load-source="docdb" name="SEA" category="IY"/></sources></nplcit></non-patent-citations></citations></technical-data><related-documents><relation type="division"><child-doc ucid="EP-13185533-A"><document-id load-source="patent-office" format="epo"><country>EP</country><doc-number>13185533</doc-number><kind>A</kind><date>20070910</date></document-id></child-doc><parent-doc ucid="EP-07800588.1"><document-id load-source="patent-office" format="epo"><country>EP</country><doc-number>07800588.1</doc-number><date>20070910</date></document-id></parent-doc></relation></related-documents><parties><applicants><applicant mxw-id="PPAR918155446" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>CERTICOM CORP</last-name><address><country>CA</country></address></addressbook></applicant><applicant mxw-id="PPAR918154628" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>CERTICOM CORP.</last-name></addressbook></applicant><applicant mxw-id="PPAR918992826" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Certicom Corp.</last-name><iid>101263463</iid><address><street>4701 Tahoe Boulevard Tahoe A, 6th Floor</street><city>Mississauga, Ontario L4W 0B5</city><country>CA</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918142959" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>GRIFFITHS-HARVEY MICHAEL</last-name><address><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918152806" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>GRIFFITHS-HARVEY, MICHAEL</last-name></addressbook></inventor><inventor mxw-id="PPAR918986653" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>GRIFFITHS-HARVEY, MICHAEL</last-name><address><street>223 Browndale Crescent</street><city>Richmond Hill, Ontario L4C 3H9</city><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918161300" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>NEILL BRIAN</last-name><address><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918151514" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>NEILL, BRIAN</last-name></addressbook></inventor><inventor mxw-id="PPAR918993887" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>NEILL, BRIAN</last-name><address><street>2135 Donald Road</street><city>Burlington, Ontario L7M 3R3</city><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918133299" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>SMITH KEELAN</last-name><address><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918144602" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>SMITH, KEELAN</last-name></addressbook></inventor><inventor mxw-id="PPAR918992994" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>SMITH, KEELAN</last-name><address><street>41 O'Hara Avenue</street><city>Toronto, Ontario M6K 2P9</city><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918157959" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>ROSATI TONY</last-name><address><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918169779" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>ROSATI, TONY</last-name></addressbook></inventor><inventor mxw-id="PPAR918984395" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>ROSATI, TONY</last-name><address><street>167 Grandview Road</street><city>Ottawa, Ontario K2H 8B8</city><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918147585" load-source="docdb" sequence="5" format="epo"><addressbook><last-name>DAVIS WALT</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918138607" load-source="docdb" sequence="5" format="intermediate"><addressbook><last-name>DAVIS, WALT</last-name></addressbook></inventor><inventor mxw-id="PPAR918986614" load-source="patent-office" sequence="5" format="original"><addressbook><last-name>DAVIS, WALT</last-name><address><street>Singinghearts Farm 7580 East Farm Road 182</street><city>Rogersville, MO Missouri 65742</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918137799" load-source="docdb" sequence="6" format="epo"><addressbook><last-name>WALTERS ANTHONY J</last-name><address><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918146046" load-source="docdb" sequence="6" format="intermediate"><addressbook><last-name>WALTERS, ANTHONY J.</last-name></addressbook></inventor><inventor mxw-id="PPAR918991606" load-source="patent-office" sequence="6" format="original"><addressbook><last-name>WALTERS, ANTHONY J.</last-name><address><street>57 Sanderson Crescent</street><city>Richmond Hil, Ontario L4C 5L5</city><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918133171" load-source="docdb" sequence="7" format="epo"><addressbook><last-name>TSANG RANDY</last-name><address><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918145864" load-source="docdb" sequence="7" format="intermediate"><addressbook><last-name>TSANG, RANDY</last-name></addressbook></inventor><inventor mxw-id="PPAR918987483" load-source="patent-office" sequence="7" format="original"><addressbook><last-name>TSANG, RANDY</last-name><address><street>1419 North Mill Court</street><city>Mississauga, Ontario L5V 1S3</city><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918170936" load-source="docdb" sequence="8" format="epo"><addressbook><last-name>BROWN DANIEL R</last-name><address><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918141170" load-source="docdb" sequence="8" format="intermediate"><addressbook><last-name>BROWN, DANIEL R.</last-name></addressbook></inventor><inventor mxw-id="PPAR918986632" load-source="patent-office" sequence="8" format="original"><addressbook><last-name>BROWN, DANIEL R.</last-name><address><street>6033 Paddle Road</street><city>Mississauga, Ontario L5N 1X8</city><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918161368" load-source="docdb" sequence="9" format="epo"><addressbook><last-name>VANSTONE SCOTT A</last-name><address><country>CA</country></address></addressbook></inventor><inventor mxw-id="PPAR918160719" load-source="docdb" sequence="9" format="intermediate"><addressbook><last-name>VANSTONE, SCOTT A</last-name></addressbook></inventor><inventor mxw-id="PPAR918987691" load-source="patent-office" sequence="9" format="original"><addressbook><last-name>VANSTONE, SCOTT A</last-name><address><street>10140 Pineview Trail</street><city>Campbellville, Ontario N0P 1B0</city><country>CA</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918981023" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Boyce, Conor</last-name><suffix>et al</suffix><iid>101405718</iid><address><street>Hanna Moore &amp; Curley 13 Lower Lad Lane</street><city>Dublin 2</city><country>IE</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS548843366" load-source="docdb">AT</country><country mxw-id="DS548870169" load-source="docdb">BE</country><country mxw-id="DS548873127" load-source="docdb">BG</country><country mxw-id="DS548897214" load-source="docdb">CH</country><country mxw-id="DS548805460" load-source="docdb">CY</country><country mxw-id="DS548843367" load-source="docdb">CZ</country><country mxw-id="DS548870170" load-source="docdb">DE</country><country mxw-id="DS548805461" load-source="docdb">DK</country><country mxw-id="DS548805462" load-source="docdb">EE</country><country mxw-id="DS548888150" load-source="docdb">ES</country><country mxw-id="DS548873128" load-source="docdb">FI</country><country mxw-id="DS548897215" load-source="docdb">FR</country><country mxw-id="DS548870171" load-source="docdb">GB</country><country mxw-id="DS548805463" load-source="docdb">GR</country><country mxw-id="DS548843368" load-source="docdb">HU</country><country mxw-id="DS548888151" load-source="docdb">IE</country><country mxw-id="DS548805464" load-source="docdb">IS</country><country mxw-id="DS548873129" load-source="docdb">IT</country><country mxw-id="DS548805465" load-source="docdb">LI</country><country mxw-id="DS548873130" load-source="docdb">LT</country><country mxw-id="DS548866858" load-source="docdb">LU</country><country mxw-id="DS548873131" load-source="docdb">LV</country><country mxw-id="DS548873132" load-source="docdb">MC</country><country mxw-id="DS548866859" load-source="docdb">MT</country><country mxw-id="DS548888160" load-source="docdb">NL</country><country mxw-id="DS548888161" load-source="docdb">PL</country><country mxw-id="DS548873133" load-source="docdb">PT</country><country mxw-id="DS548843369" load-source="docdb">RO</country><country mxw-id="DS548888162" load-source="docdb">SE</country><country mxw-id="DS548897216" load-source="docdb">SI</country><country mxw-id="DS548806596" load-source="docdb">SK</country><country mxw-id="DS548866860" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128670192" lang="EN" load-source="patent-office"><p id="pa01" num="0001">A method is disclosed for generating an aggregate digital signature. The method comprises receiving first and second signature components (cl and sl). A third signature (c2) component is generated by encrypting said first signature component using a first encryption key (X2). A first intermediate signature component (h2) is generated from said third signature component and a second portion of data (V). A fourth signature component (s2) is generated from said first intermediate signature component and a first private key (w2). The second signature component (s1), third (c2) and fourth (s2) signature components are output as said digital signature.
<img id="iaf01" file="imgaf001.tif" wi="78" he="57" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128499565" lang="EN" source="EPO" load-source="docdb"><p>A method is disclosed for generating an aggregate digital signature. The method comprises receiving first and second signature components (cl and sl). A third signature (c2) component is generated by encrypting said first signature component using a first encryption key (X2). A first intermediate signature component (h2) is generated from said third signature component and a second portion of data (V). A fourth signature component (s2) is generated from said first intermediate signature component and a first private key (w2). The second signature component (s1), third (c2) and fourth (s2) signature components are output as said digital signature.</p></abstract><description mxw-id="PDES63955622" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001">FIELD OF THE INVENTION:</heading><p id="p0001" num="0001">The present invention relates generally to radio frequency identification (RFID) tags and RFID authentication systems, and has particular utility in signing and authenticating RFID tags.</p><heading id="h0002">DESCRIPTION OF THE PRIOR ART</heading><p id="p0002" num="0002">Traditionally, objects such as inventory and commercial products have been given an associated identifier to allow the object to be tracked, identified and/or monitored. Recently, barcodes are becoming displaced by radio frequency identification (RFID) technology for providing the identifiers. RFID is beneficial as it provides an automatic identification system rather than requiring a user or machine to locate the barcode tag and then scan the barcode in a particular way.</p><p id="p0003" num="0003">RFID relies on the storage and remote retrieval of.data using devices typically referred to as RFID tags or RFID transponders. An RFID tag is an object that can be attached to or incorporated into a product or even a living being such as an animal for the purpose of identification using radio waves. There are chip-based RFID tags that contain silicon chips and antennas and RFID tags can be either passive or active.</p><p id="p0004" num="0004">Passive RFID tags require no internal power source. The relatively small electrical current induced in the antenna by the incoming radio frequency signal provides enough power for the circuit in the tag to power up and transmit a response. Often, passive tags signal by backscattering the carrier signal from the reader and thus the antenna is designed to both collect power from the incoming signal and also to transmit the outbound backscatter signal. Without requiring an onboard power supply, passive RFID tags can be smaller and more cost effective to implement.</p><p id="p0005" num="0005">Active RFID tags have their own internal power source which is used to power any circuit resident on the tag that generates an outgoing signal. Active tags have been found to be more reliable than passive RFID tags since active tags can conduct a "session" with a reader. With an onboard power supply, an active RFID tag can transmit a higher power signal which allows them to be more effective in areas where RF signals have trouble<!-- EPO <DP n="2"> --> transmitting e.g., water, and relatively long distances. The onboard power supply also requires more space and thus active RFID tags are generally larger and more expensive than passive RFID tags.</p><p id="p0006" num="0006">An RFID system generally comprises tags, tag readers, and supporting infrastructure. The purpose of an RFID system is to enable data to be transmitted by a mobile device (the tag), which is read and processed by an RFID reader. The amount of processing and the nature of the data is largely dependent on the application. For example, the information transmitted by the tag may provide identification or location information, or specifics about the object to which the tag is affixed. In typical applications such as for inventory tracking, the RFID system uses small, inexpensive tags affixed to objects that are to be tracked. The tag contains a transponder with a memory that is given a unique code (e.g. product code). A signal is emitted from the reader that activates the RFID tag so that the reader can read and write data to the tag. When the RFID tag passes through the electromagnetic zone created by the emission, the tag detects the reader's activation signal. The reader decodes the data encoded in the tag's memory and the data is passed to the supporting infrastructure for its particular use.</p><p id="p0007" num="0007">RFID technology is becoming more popular not only for reducing the effort involved in tracking inventory and commercial products, but also for combating security issues such as the existence of counterfeit or compromised products. Such security issues have become increasingly important in the pharmaceutical industry for advancing the security of the pharmaceutical supply chain and improving patient safety. Current work includes adding a layer of authentication to pharmaceutical drugs in the supply chain, in particular using a public-key infrastructure (PKI) combined with an RFID system as discussed in the white paper entitled "Securing the Pharmaceutical Supply Chain with RFID and Public-Key Infrastructure (PKI) Technologies" by Joseph Pearson, Texas Instruments Radio Frequency Identification (TI-RFID<sup>™</sup>) Systems, RFIDPH01, June 2005.</p><p id="p0008" num="0008">An authenticated RFID system such as that described in the above-noted white paper allows the tag to be authenticated at one or more stages in the supply chain to ensure supply-chain integrity throughout.<!-- EPO <DP n="3"> --></p><p id="p0009" num="0009">The above-noted implementation requires an RFID tag that is large enough to store a relatively large signature, e.g. 1024 bit digital Rivest-Shamir-Adleman (RSA) signature, which can be prohibitively expensive. As a result, the authenticated RFID tags, when signed with an RSA signature, can only accommodate one signature without requiring a tag that may be too expensive to use. Even when only one signature is desired, a relatively large tag is still required.</p><p id="p0010" num="0010">The use of such relatively large RSA signatures also makes the use of multiple signatures on the same tag infeasible without increasing the tag size even further which can be even more prohibitively expensive.</p><p id="p0011" num="0011">It is therefore an object of the following to obviate or mitigate the above-noted disadvantages.</p><heading id="h0003">SUMMARY OF THE INVENTION</heading><p id="p0012" num="0012">In one aspect, there is provided a method for adding security to a radio frequency identification (RFID) tag comprising obtaining the RFID tag and signing the RFID tag using an elliptic curve (EC) cryptographic scheme.</p><p id="p0013" num="0013">The method above may be performed using either ECPVS or ECDSA signature schemes.</p><p id="p0014" num="0014">In another aspect, there is provided a radio frequency identification (RFID) tag comprising an elliptic curve cryptographic signature.</p><p id="p0015" num="0015">In yet another aspect, there is provided a method for signing an RFID tag comprising obtaining a first set of data to be written to the tag, the first set of data having information therein intended to be hidden from unauthorized RFID readers; incorporating the first set of data into a signature scheme with message recovery as a recoverable portion; and writing a signature to the tag using a private key having a corresponding verification key; wherein the first set of data can only be recovered by an authorized RFID reader having access to the verification key.</p><p id="p0016" num="0016">In yet another aspect, there is provided an RFID signing station comprising an RFID reader for reading RFID tags, and a cryptographic module for writing signatures to the<!-- EPO <DP n="4"> --> RFID tags, the cryptographic module being configured for obtaining a first set of data to be written to the tag, the first set of data having information therein intended to be hidden from unauthorized RFID readers; incorporating the first set of data into a signature scheme with message recovery as a recoverable portion; and writing a signature to the tag using a private key having a corresponding verification key; wherein the first set of data can only be recovered by an authorized RFID reader having access to the verification key.</p><p id="p0017" num="0017">In yet another aspect, there is provided a method for authenticating an RFID tag comprising obtaining the tag, the tag having thereon a signature with at least one component encrypting a first set of data therein, and having a second set of data, the second set of data being plaintext; obtaining a verification key; decrypting the at least one component using the verification key to obtain the first set of data; and examining the first set of data for a predetermined characteristic to verify the signature and thereby authenticate the tag.</p><p id="p0018" num="0018">In yet another aspect, there is provided an RFID reader comprising a cryptographic module for verifying EC cryptographic signatures on an RFID tag, the cryptographic module being configured for obtaining the tag, the tag having thereon a signature with at least one component encrypting a first set of data therein, and having a second set of data, the second set of data being plaintext; obtaining a verification key; decrypting the at least one component using the verification key to obtain the first set of data; and examining the first set of data for a predetermined characteristic to verify the signature and thereby authenticate the tag.</p><p id="p0019" num="0019">In yet another aspect, there is provided a method for managing verification keys for a plurality of RFID readers in an authenticated RFID system comprising determining a set of permissions indicative of which of one or more of the plurality of RFID readers have permission to authenticate one or more product types; for one or more of the plurality of readers, preparing a set of verification keys according to the set of permissions, each verification key being associated with a specific product type; and distributing each the set of verification keys to respective RFID readers.</p><p id="p0020" num="0020">In yet another aspect, there is provided a key management system for an authenticated RFID system having a plurality of RFID readers configured for determining a set of permissions indicative of which of one or more of the plurality of RFID readers has<!-- EPO <DP n="5"> --> permission to read one or more product types having corresponding RFID tags; preparing a set of verification keys for each of the plurality of readers according to the permissions; and distributing the verification keys to the readers.</p><p id="p0021" num="0021">In yet another aspect, there is provided a method for generating an aggregate digital signature comprising generating a first signature component by encrypting a first portion of data using a first encryption key; generating a first intermediate signature component from the first signature component and a second portion of data; generating a second signature component from the first intermediate signature component and a first private key; generating a third signature component by encrypting one of the first and second signature components using a second encryption key; generating a second intermediate signature component from the third signature component and the second portion of data; generating a fourth signature component from the second intermediate signature component and a second private key; and outputting the other of the first and second signature components and the third and fourth signature components as the digital signature.</p><p id="p0022" num="0022">In yet another aspect, there is provided a method for verifying an aggregate digital signature comprising: obtaining the digital signature, the digital signature having a first signature component encrypting at least one other signature component using respective encryption keys, a first of which encrypts a first portion of data, and having at least one secondary signature component, each being generated from either the first signature component or a respective one of the at least one other signature component and a respective private key; generating a first decryption key using the first signature component and a second portion of data and decrypting the first signature component to obtain a recovered signature component; using the recovered signature component to recover additional signature components corresponding to the at least one other signature component by generating one or more subsequent decryption keys; recovering from the first of the at least one other signature components, a representation of the first portion of data; and examining the representation of the first portion of data for a predetermined characteristic to verify the digital signature.</p><p id="p0023" num="0023">In yet another aspect, there is provided a method for generating an aggregate digital signature at a plurality of signing stages comprising generating an initial pair of signature components; encrypting one of the initial pair of components in a next set of<!-- EPO <DP n="6"> --> signature components, the next set of signature components including the other of the initial pair of components and two new signature components; and for subsequent signing stages, encrypting a previous signature component that in turn encrypts another previous signature component and generating an additional new signature component; wherein the number of signature components in the digital signature at each stage is one more than the total number of signing stages.</p><p id="p0024" num="0024">In yet another aspect, there is provided a method for generating an aggregate digital signature comprising generating a first signature component using a first value derived from first individual values contributed by each of a plurality of signers; generating a second signature component using a second value derived from second individual values contributed by each the plurality of signers; and outputting the digital signature having the first and second signature components.</p><p id="p0025" num="0025">In yet another aspect, there is provided a method for verifying an aggregate digital signature comprising obtaining the digital signature having a first signature component generated using a first value derived from first individual values contributed by each of a plurality of signers and a second signature component generated using a second value derived from second individual values contributed by each the plurality of signers; combining individual public values of respective ones of the plurality of signers to generate a combined public key; and using the combined public key in at least one step in a signature verification process.</p><p id="p0026" num="0026">In yet another aspect, there is provided cryptographic processors and computer readable media for performing the methods above.</p><heading id="h0004">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p0027" num="0027">An embodiment of the invention will now be described by way of example only with reference to the appended drawings wherein:</p><p id="p0028" num="0028"><figref idrefs="f0001">Figure 1</figref> is a schematic block diagram showing an authenticated RFID system.</p><p id="p0029" num="0029"><figref idrefs="f0002">Figure 2</figref> is a schematic block diagram showing the certificate authority (CA), a signing station and a verifying station shown in <figref idrefs="f0001">Figure 1</figref>.<!-- EPO <DP n="7"> --></p><p id="p0030" num="0030"><figref idrefs="f0003">Figure 3</figref> is a schematic diagram of a generic RFID tag.</p><p id="p0031" num="0031"><figref idrefs="f0004">Figure 4</figref> is a block diagram of two different RFID identification (ID) codes.</p><p id="p0032" num="0032"><figref idrefs="f0004">Figure 5</figref> is a schematic diagram of a 256 bit RFID tag.</p><p id="p0033" num="0033"><figref idrefs="f0005">Figure 6</figref> is a flow diagram illustrating a key distribution procedure.</p><p id="p0034" num="0034"><figref idrefs="f0006">Figure 7</figref> is a flow diagram illustrating a signing procedure.</p><p id="p0035" num="0035"><figref idrefs="f0007">Figure 8</figref> is a flow diagram illustrating the programming procedure of <figref idrefs="f0006">Figure 7</figref>.</p><p id="p0036" num="0036"><figref idrefs="f0008">Figure 9</figref> is a flow diagram illustrating a verification procedure.</p><p id="p0037" num="0037"><figref idrefs="f0009">Figure 10</figref> is a schematic block diagram showing a key management system for distributing keys in an authenticated RFID system and supply chain therefor.</p><p id="p0038" num="0038"><figref idrefs="f0010">Figure 11</figref> is a schematic block diagram showing the manufacturing stage of <figref idrefs="f0009">Figure 10</figref>.</p><p id="p0039" num="0039"><figref idrefs="f0011">Figure 12</figref> is a schematic block diagram showing the reader manufacturer of <figref idrefs="f0009">Figure 10</figref>.</p><p id="p0040" num="0040"><figref idrefs="f0012">Figure 13</figref> is a schematic block diagram showing the KMS of <figref idrefs="f0009">Figure 10</figref>.</p><p id="p0041" num="0041"><figref idrefs="f0013">Figure 14</figref> is a schematic block diagram showing the clinic/pharmacy of <figref idrefs="f0009">Figure 10</figref>.</p><p id="p0042" num="0042"><figref idrefs="f0014">Figure 15</figref> is a flow chart illustrating key generation and tag signing process.</p><p id="p0043" num="0043"><figref idrefs="f0015">Figure 16</figref> is a flow chart illustrating reader registration process.</p><p id="p0044" num="0044"><figref idrefs="f0016">Figure 17</figref> is a flow chart illustrating a key distribution process.</p><p id="p0045" num="0045"><figref idrefs="f0017">Figure 18</figref> is a flow chart illustrating a revenue tracking process.</p><p id="p0046" num="0046"><figref idrefs="f0018">Figure 19</figref> is a schematic block diagram showing a semi-aggregate signature generation scheme.</p><p id="p0047" num="0047"><figref idrefs="f0019">Figure 20</figref> is a schematic block diagram showing a semi-aggregate signature verification scheme.<!-- EPO <DP n="8"> --></p><p id="p0048" num="0048"><figref idrefs="f0020">Figure 21</figref> is a schematic block diagram showing another semi-aggregate signature generation scheme.</p><p id="p0049" num="0049"><figref idrefs="f0021">Figure 22</figref> is a schematic block diagram showing another semi-aggregate signature verification scheme.</p><p id="p0050" num="0050"><figref idrefs="f0022">Figure 23</figref> is a schematic block diagram showing a fully aggregate signature generation scheme.</p><p id="p0051" num="0051"><figref idrefs="f0022">Figure 24</figref> is a schematic block diagram showing a fully aggregate signature verification scheme.</p><p id="p0052" num="0052"><figref idrefs="f0023">Figure 25</figref> is a schematic block diagram showing yet another aggregate signature generation scheme.</p><p id="p0053" num="0053"><figref idrefs="f0023">Figure 26</figref> is a schematic block diagram showing yet another aggregate signature verification scheme.</p><heading id="h0005">DETAILED DESCRIPTION OF THE INVENTION</heading><heading id="h0006"><b>Authenticated RFID System and Example Supply Chain</b></heading><p id="p0054" num="0054">Referring to <figref idrefs="f0001">Figure 1</figref>, an authenticated RFID system 10 is shown. The system 10 shown comprises a certificate authority (CA) 12 for issuing certificates to control the distribution of public keys in one embodiment, an arbitrary N number of RFID readers 14 distributed along a supply chain 22 for reading an RFID tag 20 affixed to an object 18 (e.g. a pharmaceutical product, consumer product, piece of luggage, mobile communication device, etc.), and an arbitrary T number of signing stations 16 for writing signatures to the RFID tags 20 in establishing an electronic pedigree for the tag 20. Each reader 14 produces a radio frequency (RF) field 26 which energizes the tags 20, which in this example are preferably passive. It will be appreciated that the tags 20 may also be active if the cost can be justified for the particular application.</p><p id="p0055" num="0055">The CA 12 preferably communicates with the readers 14 and the signing stations 16 over a communication channel 24 to facilitate the distribution of keys through the issuance of certificates and for log reporting as necessary. The communication channel 24 may be<!-- EPO <DP n="9"> --> electronic such as a local or wide area network (secure or insecure with cryptographic safeguards) or may be implemented by distributing media such as CD-ROM disks or by deploying technicians. Therefore, it will be appreciated that the readers 14 and signing stations 16 may operate together in a network or as substantially standalone units.</p><p id="p0056" num="0056">In some applications, there may be little or no relationship between particular ones of the readers 14 and the signing stations 16 such that they are under the control of different parties. Therefore, each party may be required to contact and communicate with the CA 12 individually in order for the readers 14 to each be able to validate the signatures written by the signing stations. It will be appreciated that the participation of a CA 12 is only one implementation and that any other management or controlling entity could also be used as will be discussed later.</p><p id="p0057" num="0057">The schematic block diagram of <figref idrefs="f0002">Figure 2</figref> shows a general embodiment for the distribution of keys between a CA 12, a signing station 16 and a reader 14. The CA 12 issues certificates for both the signing station 16 and the reader 14. The CA 12 may also be capable of issuing sub-CA certificates so that other CAs (not shown) can issue reader certificates. The certificates are used to distribute and validate public keys and a certificate is not typically stored on the RFID tag 20. Since the certificates are not stored on the tags 20, the entire chain of certificates for all signing readers 16 is distributed to each reader 14 so that they may validate each and every signature that is written to the tag 20. The CA 12 includes a crypto module 30 for performing cryptographic operations and for generating certificates. The CA 12 also includes a secure storage device 32 for storing keys and certificates. Each CA 12 has a CA certificate C<sub>CA</sub>, and stores the public keys <i>W</i><sub>1-T</sub> of the signing stations 16, the public keys of the readers <i>Z</i><sub>1-N</sub> and the respective certificates C<sub>SIGN1-T</sub> and C<sub>VER1-N</sub> that are to be distributed. In general, <i>j</i> indicates the specific signing station 16 where <i>j</i> is a number from 1 to T and <i>i</i> indicates the specific reader 14 where <i>i</i> is a number from 1 to N (according to the arbitrary designations shown in <figref idrefs="f0001">Figure 1</figref>).</p><p id="p0058" num="0058">In one embodiment, the CA 12 generates the private keys of the readers 14 (which correspond to the respective public keys <i>Z</i><sub>1-N</sub>) and provides such private keys to a manufacturer of the readers 14 in a bulk encrypted set, along with the certificates C<sub>VER1-N</sub>. This embodiment provides additional assurance of the integrity of the keys, since the CA 12 can state that the operators generating the keys did not have unencrypted access to the private<!-- EPO <DP n="10"> --> keys. The provision of private keys and manufacturing of the readers 14 is discussed below in connection with <figref idrefs="f0010">Figure 11</figref>.</p><p id="p0059" num="0059">The signing stations 16 are attached to RFID readers and are capable of generating elliptic curve cryptography (ECC) signatures using a crypto module 30a and writing them to the RFID tags 20. Preferably, the signing stations 16 are not used to verify signatures from other signers 16 and thus typically do not need to access certificates from other RFID readers, both signing and verifying. The signing station 16 shown in <figref idrefs="f0002">Figure 2</figref> designated signing station 1, has a private/public key pair (<i>w<sub>1</sub></i>, <i>W<sub>1</sub></i>) stored in a key store 34 and an ECC crypto module 30a. The private key <i>w<sub>1</sub></i> is preferably stored in secure hardware and protected with a password or other mechanism.</p><p id="p0060" num="0060">The readers 14 are used for verifying the signatures written to the tags 20 by the signing stations 16 and typically are not used for or capable of generating signatures. Preferably, each reader 14 has its own key pair, e.g. (<i>z<sub>1</sub></i>, <i>Z<sub>1</sub></i>) for reader 1. The private key <i>z<sub>1</sub></i> is used to decrypt signer certificates C<sub>SIGN1</sub> and the public key <i>Z<sub>1</sub></i> corresponds to the private key <i>z<sub>1</sub></i> and has a corresponding certificate C<sub>VER1</sub>. The reader 14 also stores a copy of the CA certificate C<sub>CA</sub> and a list of validated public keys <i>W<sub>j</sub></i> for the various signing stations 16. The reader 14 also has a crypto module 30a that is capable of validating certificates and verifying ECC signatures.</p><heading id="h0007"><b>RFID Authentication Schemes using Elliptic Curve Cryptography</b></heading><p id="p0061" num="0061">A generic RFID tag 20 is shown in <figref idrefs="f0003">Figure 3</figref>. The tag 20 is used primarily for data storage and the firmware for the tag 20 is locked at the manufacturing stage. As such, these tags 20 respond to a fixed set of commands once they leave the factory. The commands are used for reading, writing and locking data blocks. <figref idrefs="f0003">Figure 3</figref> illustrates a typical memory organization for such a tag 20. In the example shown in <figref idrefs="f0003">Figure 3</figref>, the tag 20 is segmented into 32 bit blocks with two lock bits for each block, a factory lock bit (F) and a user lock bit (U). At the time of manufacture, the tag 20 is given a serial number, which in this example consumes 2 blocks or 64 bits. The serial numbers are preferably burned into read only memory (ROM) by a trusted party to ensure that each tag 20 is unique. At the time of manufacturing, configuration data is also added to the tag 20 and in this example consumes all or a portion of 1 block (i.e. up to 32 bits). In applications such as a pharmaceutical supply<!-- EPO <DP n="11"> --> chain, product specific information such as a product type identifier is also added, according to the appropriate standards and regulations. In this example, the product type identifier consumes 3 blocks or 96 bits. The remaining memory on the tag 20 is dedicated to user data, which may include, e.g. a digital signature. It can be seen that <figref idrefs="f0003">Figure 3</figref> shows an arbitrary N blocks of user data. A 2048 bit tag, which is commonly in use would thus provide 64 blocks of data for storing signatures. A 256 bit tag would provide 8 blocks of data.</p><p id="p0062" num="0062">An example of a 256 bit tag 20 to be used in an authenticated RFID system is shown in <figref idrefs="f0004">Figure 5</figref>. The serial number in this example is a unique identifier (UID), which is programmed and locked at the factory and is unique to each tag 20 and is typically 64 bits as shown. The configuration data comprises a data storage format identifier (DSFID), which is used to identify how the user data was encoded and stored on the tag 20; and an application family identifier (AFI), which can be used to identify with which of a plurality of numbering systems the UID is associated (if applicable). In this example, the DSFID and AFI consume 8 bits each and thus there would be 16 empty bits if they are written to the same block or potentially 48 empty bits if they are each written to separate and consecutive blocks. The product type identifier is in <figref idrefs="f0004">Figure 5</figref>, a 96 bit EPCglobal product ID. As will be discussed below, at least a portion of the product ID may included sensitive or confidential information regarding the product 18 to which the tag 20 is affixed thus creating privacy concerns as any reader 14 could presumably read such portion of the product ID without the proper safeguards in place. The user data provides 8 blocks for a digital signature for a 256 bit tag.</p><p id="p0063" num="0063">It can be appreciated that an RSA signature is too large to be written to such a 256 bit tag 20 and would instead require a large tag such as a 2048 bit tag 20. It can also be appreciated that an RSA signature would also be too large for tags 20 of other sizes such as 512 bits. Also, an RSA signature can be cloned when read from a genuine tag and programmed onto another. However, since the tags 20 are unique and cannot be reprogrammed, a cloned signature will not be successfully verified. It is seen from <figref idrefs="f0003">Figure 3</figref> that a signature such as an RSA signature would consume a significant portion of the tag 20 (or require there to be a relatively large number of user data blocks) and only one signature can be accommodated without having the tag 20 become prohibitively expensive.</p><p id="p0064" num="0064">The writing and reading of, e.g., 1024 bit RSA signatures, to and from RFID tags 20 can create a significant bottleneck in the manufacturing process. It is therefore desirable<!-- EPO <DP n="12"> --> to replace an RSA signature with a smaller one, while maintaining a similar level of security. The size of a 1024 bit RSA signature requires a relatively large RFID tag (e.g. 2048 bits) that can only accommodate one signature. To reduce such bottlenecks, to provide the possibility of including multiple signatures on the same RFID tag 20 (e.g. representing stages in the manufacturing process), and to provide the possibility of using a smaller (and thus cheaper) RFID tag 20, a signature with similar security but that is smaller in size is required. It has been recognized that an elliptic curve cryptography (ECC) signature is particularly suitable for providing these features and advantages when considering the following analysis.</p><p id="p0065" num="0065">ECC is implemented in an algebraic system defined on the points of an elliptic curve over a finite field and encryption schemes using ECC are based on the intractability of the discrete log problem in finite groups.</p><p id="p0066" num="0066">In one example, the domain parameters of such an ECC cryptosystem are a curve of the form <i>y</i><sup>2</sup> = <i>x</i><sup>3</sup> + <i>dx</i> + <i>c</i> and a seed point <i>P</i>. One correspondent in the system has a private key <i>a,</i> 0 &lt; <i>a</i> &lt; <i>n</i> where <i>n</i> is the order of the point <i>P</i> and a corresponding public key <i>Q<sub>A</sub></i> = <i>aP.</i> The public key may be held in a certifying authority (CA). The following principles are also applicable in binary F<sub>2<i><sup>m</sup></i></sub> applications.</p><p id="p0067" num="0067">When compared to RSA, ECC offers the same security with smaller bit sizes. The following table taken from "Recommendation for Key Management - Part 1: General Revised", NIST Special Publication 800-57, National Institute of Standards and Technology, May 2006, compares the bit sizes of ECC and RSA at similar security levels.
<tables id="tabl0001" num="0001"><table frame="all"><title><i>Table 1: Comparison of RSA and ECC</i></title><tgroup cols="5"><colspec colnum="1" colname="col1" colwidth="24mm"/><colspec colnum="2" colname="col2" colwidth="41mm"/><colspec colnum="3" colname="col3" colwidth="34mm"/><colspec colnum="4" colname="col4" colwidth="27mm"/><colspec colnum="5" colname="col5" colwidth="33mm"/><thead><row><entry align="center" valign="top">Bits of security</entry><entry align="center" valign="top">Symmetric key algorithms</entry><entry align="center" valign="top">FFC (e.g., DSA, D-H)</entry><entry align="center" valign="top">IFC (e.g., RSA)</entry><entry align="center" valign="top">ECC (e.g., ECDSA)</entry></row></thead><tbody><row><entry align="center">80</entry><entry align="center">2TDEA</entry><entry align="center"><i>L</i> = 1024</entry><entry align="center"><i>k</i> = 1024</entry><entry align="center"><i>f</i> = 160-223</entry></row><row><entry align="center"/><entry align="center"/><entry align="center"><i>N</i> = 160</entry><entry align="center"/><entry align="center"/></row><row><entry align="center">112</entry><entry align="center">3TDEA</entry><entry align="center"><i>L</i> = 2048</entry><entry align="center"><i>k</i> = 2048</entry><entry align="center"><i>f</i> = 224-255</entry></row><row><entry align="center"/><entry align="center"/><entry align="center"><i>N</i> = 224</entry><entry align="center"/><entry align="center"/></row><row><entry align="center">128</entry><entry align="center">AES-128</entry><entry align="center"><i>L</i> = 3072</entry><entry align="center"><i>k</i> = 3072</entry><entry align="center"><i>f</i> = 256-383</entry></row><row><entry align="center"/><entry align="center"/><entry align="center"><i>N</i> = 256</entry><entry align="center"/><entry align="center"/></row><row><entry align="center">192</entry><entry align="center">AES-192</entry><entry align="center"><i>L</i> = 7680</entry><entry align="center"><i>k</i> = 7680</entry><entry align="center"><i>f</i> = 384-511</entry></row><row><entry align="center"/><entry align="center"/><entry align="center"><i>N</i> = 384</entry><entry align="center"/><entry align="center"/></row><row><entry align="center">256</entry><entry align="center">AES-256</entry><entry align="center"><i>L</i> = 15360</entry><entry align="center"><i>k</i> = 15360</entry><entry align="center"><i>f</i> = 512+</entry></row><row><entry align="center"/><entry align="center"/><entry align="center"><i>N</i> = 512</entry><entry align="center"/><entry align="center"/></row></tbody></tgroup><!-- EPO <DP n="13"> --></table></tables></p><p id="p0068" num="0068">To achieve the same security level as a 1024 bit RSA signature, an elliptic curve of 160 bits or higher should be used. The examples described herein compare the use of elliptic curve Pintsov-Vanstone signature (ECPVS) scheme and the use of the elliptic curve digital signature algorithm (ECDSA), to the use of public key schemes such as RSA. It will be appreciated that other ECC schemes are applicable.</p><p id="p0069" num="0069">ECPVS is a digital signature scheme with message recovery, which means that part of the message that was signed can be recovered from the signature verification process. ECPVS is specified in IEEE 1363a-2004, ISO/IEEE 9796-3, and as a draft ANSI standard. In ECPVS, a message <i>M</i> that is to be signed is considered to be two separate and distinct portions or sets of data <i>H</i> and <i>V</i> (e.g. <i>M=H</i> ∥ <i>V</i>) where <i>H</i> is a message or a set of data that is to be hidden in the signature and recovered during the verification process, and <i>V</i> is a message or set of data which is also signed but is sent in the clear (or otherwise be readily or publicly available) and used in the verification process. The message <i>H</i> can only be recovered by those entities that possess a particular verification key and the message <i>V</i> can be read by any entity, e.g. any RFID reader 14, i.e. without verifying the signature.</p><p id="p0070" num="0070">The ECPVS signature generation algorithm typically begins by specifying a particular characteristic for the message <i>H</i> that can be examined during signature verification to verify the signature. For example, one can determine if the message <i>H</i> has a certain amount of redundancy that is above a predetermined limit sufficient to prevent an existential forgery attack. If it is determined that the original data forming the message <i>M</i> contains enough redundancy then <i>H</i> may simply be a subset of that data. If the predetermined redundancy is not found, then <i>H</i> may be modified to contain artificially added redundancy such as additional zeros. It will be appreciated that having a certain amount of redundancy is only one characteristic and others may be used such as any string or set of data that can be compared to a known and expected value.</p><p id="p0071" num="0071">For example, 80 bits of redundancy is typically what is needed to provide the same level of security as 1024 bit RSA and should preferably be chosen as the minimum threshold when the same security or better than 1024 bit RSA is desired. However, as discussed below, the amount of redundancy used can be tailored to suit the application based<!-- EPO <DP n="14"> --> on the size of tag that is desired, and the minimum security level that makes forging the signature uneconomical or which is otherwise deemed to be acceptable. The following summarizes ECPV signature generation.</p><p id="p0072" num="0072">First, an ephemeral key pair (k, Q) is generated, where Q = kG is a point on the elliptic curve, k is a random integer 1 ≤ k &lt; n, and n is the order of the group generated by the elliptic curve base point G. Next, a key k<sub>1</sub> = KDF(Q) is constructed, where KDF is a key derivation function. In general, a key derivation function is used to derive a secret key from a secret value and/or a other known information. In ECPVS, KDF takes as an input a point, Q, and possibly other information, and generates an encryption key k<sub>1</sub>. The signing entity then computes a first signature component <i>c</i> as <i>c</i> = <i>ENC</i><sub><i>k</i><sub2>1</sub2></sub> (<i>H</i>), i.e. the encryption of the message <i>H</i> using a key k<sub>1</sub>, where ENC is a suitable encryption scheme that takes as an input plaintext (e.g. <i>H</i>) and encrypts it with a key k<sub>1</sub> to produce ciphertext <i>c</i>.</p><p id="p0073" num="0073">Next, an intermediate component <i>h</i> is computed as <i>h</i> = Hash(<i>c</i> ∥ <i>V</i>), where Hash is a suitable hash function, e.g. SHA1. If preferred, additional information that may be available or become available to parties verifying the signature (in other words information that the verifier needs 'on the side' for verification), e.g. a certificate or identifying information of the signer may be incorporated into <i>h</i>. The intermediate component <i>h</i> is then converted to an integer <i>e</i>. A second signature component <i>s</i> is then calculated using a suitable signature algorithm, such as the Schnorr algorithm, where: <i>s</i> = <i>e·w</i> + k mod n, <i>w</i> being a long term private key of the signing entity, namely the signing station in the examples discussed above. The resultant signature is then (<i>c</i>, <i>s</i>, V) or (<i>s</i>, <i>c</i>∥V).</p><p id="p0074" num="0074">The following illustrates ECPV signature verification on a signature (<i>s</i>, <i>c</i>∥V), when provided with the signing entity's genuine public key <i>W</i>. First, the intermediate component <i>h</i> is computed using the component <i>c</i>∥V and using the same hash function used in the signing stage and any additional information, such as the identification information of the signer, where: <i>h</i> = Hash(<i>c</i>∥V). Next, <i>h</i> is converted to an integer <i>e</i>. A representation <i>Q</i>' of the ephemeral public key Q is then computed using the integer <i>e</i>, the public key <i>W</i> of the signer, the base point G, and the signature component <i>s</i>, e.g. as Q' = <i>s</i>G - <i>e</i>W.</p><p id="p0075" num="0075">Next, a decryption key k<sub>1</sub>' is computed using the same key derivation function KDF used in the signing stage, including the same additional information, namely as k<sub>1</sub>' =<!-- EPO <DP n="15"> --> KDF(Q'). A representation H' of the hidden portion H is then recovered by decrypting the component c using the key derived above, and a complementary decryption function DEC, namely as <i>H'= DEC<sub>k<sub2>1'</sub2></sub></i>(<i>c</i>)<i>.</i> The verifier may then check the specified characteristic (such as a particular format) of, e.g., redundancy contained in H'. If H' contains the necessary characteristic such as a certain amount of redundancy, then H' is a valid message and the signature is verified. If H' does not contain the necessary redundancy, then a null and invalid signature is returned.</p><p id="p0076" num="0076">Because the message <i>M</i> is subdivided, it is only necessary for one portion, e.g. <i>H</i> to contain the requisite characteristic such as redundancy, and to be hidden. The other portion <i>V</i> is plaintext that has the same structure as the original message and thus can improve bandwidth efficiency. As such, for an RFID tag, the visible portion <i>V</i> may include any portion of data that is otherwise available to RFID readers 14. The portion <i>H</i> hidden in <i>c</i> is only available to those individuals who have the public key <i>W</i> of the signer, whereas the data contained in <i>V</i> is available to all. Although the principles described herein where a portion of data is hidden to conceal sensitive information is particularly suitable for a pharmaceutical supply chain as exemplified below, it will be appreciated that such principles are equally applicable to any RFID authentication system for any product type and in any environment where authentication and privacy or confidentiality is desired. For example, the principles below are also applicable to tracking baggage in an airport, tracking any merchandise, or for authenticating users of mobile devices utilizing RFID technology, etc.</p><p id="p0077" num="0077">The use of ECPVS in authenticating the RFID system 10 described herein allows part of the identifying information on the tag 20 to be kept secret from unauthorized readers whilst allowing conventional readers to read the remaining data, e.g. for regular scanning operations. This is because a certain portion of data can be hidden in the signature and any other non-sensitive information can simply remain on the tag 20 as is or included as part of the plaintext <i>V</i>. Also, since an ECPVS signature is smaller than a 1024 bit RSA signature, a smaller tag can be used with similar security. For example, a 512 bit tag or 256 bit tag can be used depending on the application, the level of security required and the availability of such tags as will be explained in greater detail below.<!-- EPO <DP n="16"> --></p><p id="p0078" num="0078">An product identification (ID) code 40 (e.g. EPCglobal code) is generally shown in <figref idrefs="f0004">Figure 4</figref>. The size of the ID code 40 is assumed to be 96 bits in the following discussion. Variation (a) includes a header 50a and a serial number 52a. Variation (b) includes a header 50b, serial number 52b and a product ID 54. The product ID 54 may be part of the serial number 52b or a distinct code. The product ID 54 reveals the type of product to which the tag 20 is attached.</p><p id="p0079" num="0079">In industries such as the pharmaceutical industry, the use of variation (b) ID codes 40b have been viewed as posing a privacy issue since the code 40b reveals what the product is. Therefore an illegitimate reader could potentially discern what a customer is purchasing when within the requisite range. These privacy concerns are discussed in a Food and Drug Administration (FDA) report, "FDA Counterfeiting Drug Task Force Report: 2006 Update", which in part recommends not revealing the NDC number on the RFID tag, the NDC number containing the information that identifies the drug.</p><p id="p0080" num="0080">It is therefore desirable to encrypt or hide at least the product ID 54 where a variation (b) code 40b is used so that an illegitimate reader cannot discern the product type. It has been recognized that ECPVS provides a suitable ECC signature scheme (for size and efficiency) that can also hide the product ID 54 in the signature by designating the ID code 40 as the message to be signed and having the product ID 54 designated as portion <i>H</i>, which is hidden and recovered during verification.</p><p id="p0081" num="0081">Also, using ECPVS, either variation (a) or variation (b), the entire ID code 40 can be chosen as <i>H</i> and the non-recoverable or visible portion <i>V</i> can be the UID. In a simple example, ECPVS allows a digital signature to fit within an RFID tag 20 with 256 bits of storage (see <figref idrefs="f0004">Figure 5</figref>) as set forth in the following table:
<tables id="tabl0002" num="0002"><table frame="all"><title><i>Table 2: Signature sizes for ECPVS</i></title><tgroup cols="5"><colspec colnum="1" colname="col1" colwidth="25mm"/><colspec colnum="2" colname="col2" colwidth="41mm"/><colspec colnum="3" colname="col3" colwidth="32mm"/><colspec colnum="4" colname="col4" colwidth="28mm"/><colspec colnum="5" colname="col5" colwidth="42mm"/><thead><row><entry morerows="1" align="center" valign="top">ID Code (bits)</entry><entry namest="col2" nameend="col4" align="center" valign="top">ECPVS</entry><entry morerows="1" align="center" valign="top">Total Size - Message and Signature (32 bit RFID memory blocks)</entry></row><row><entry align="center" valign="top">Curve</entry><entry align="center" valign="top">Signature Element</entry><entry align="center" valign="top">Size (bits/bytes)</entry></row></thead><tbody><row><entry rowsep="0" align="center">96</entry><entry rowsep="0" align="center">160 bit - SECP160R1</entry><entry align="center"><i>r<sub>ecpvs</sub></i></entry><entry align="center">96/12</entry><entry rowsep="0" align="center">8</entry></row><row><entry rowsep="0"/><entry/><entry align="center"><i>s<sub>ecpvs</sub></i></entry><entry align="center">160/20</entry><entry/></row><row><entry rowsep="0"/><entry morerows="1" align="center">163 bit - SECT163K1 (NIST recommended)</entry><entry align="center"><i>r<sub>ecpvs</sub></i></entry><entry align="center">96/12</entry><entry rowsep="0" align="center">9</entry></row><row><entry/><entry align="center"><i>s<sub>ecpvs</sub></i></entry><entry align="center">163/21</entry><entry align="center">(29 unused bits in last block)</entry></row></tbody></tgroup></table></tables><!-- EPO <DP n="17"> --></p><p id="p0082" num="0082">In a practical implementation, several issues should be considered. First, if the entire ID code 40 is hidden (to be recovered during signature verification), then the readers 14 not supporting ECPVS, or not possessing the correct public key <i>Z<sub>i</sub></i>, would not be able to read the ID code 40 at all. The ID code 40 itself can be divided into recoverable and non-recoverable portions (e.g. where product ID 54 is recoverable), however the redundancy of the recoverable portion may be insufficient. If the ID Code 40 is to be sub-divided, the RFID tag 20 may need to be larger if additional redundancy is required and/or other ways of adding redundancy, e.g. padding would need to be explored in order to provide adequate security.</p><p id="p0083" num="0083">Second, the IEEE Standard 1363a-2004 specifies that the recoverable message H be padded with at least 1 byte. If it is desirable to comply with this standard, an extra byte of storage is required. Third, if a 256 bit tag 20 is used, there may be no room to store data such as the time of signing unless some of the unused bits in the AFID are used. Finally, there may not be enough redundancy in the ID Code 40 to allow the verifier 14 to determine if the signature is valid. Some out-of-band information (e.g. visual verification with a paper label) may be required. The issue of redundancy is addressed below.</p><p id="p0084" num="0084">As discussed, there are two types of ID codes 40a, b. The variation (a) fields cannot be directly linked to the product. In a variation (b) code 40b, the product ID 54 directly identifies the product. It is therefore desirable to encrypt or hide at least the product ID 54, namely by making the product ID 54 at least a portion of the hidden message <i>H</i>.</p><p id="p0085" num="0085">It can be appreciated that, depending on the application, the ID code 40 may not contain enough redundancy and may require that a pattern or limit be imposed on the fields to avoid a vulnerability to signature forgery.</p><p id="p0086" num="0086">With the 160 bit curve and SHA-1 as the hash function, the typical rule-of-thumb is to use 80 bits of redundancy. However, since each forged signature is specific to one particular RFID tag 20, it may be adequate to use a smaller number. Moreover, it may be that the amount of computing power and/or time to forge one signature is long enough to deter a forger from attempting to forge the signature. The security level should be tailored to provide enough of a deterrent to such a forger.</p><p id="p0087" num="0087">To offer the same security level as a 1024 bit RSA signature, an ECPVS signature with a 160 bit curve would fit within the 256 bit structure shown in <figref idrefs="f0004">Figure 5</figref>. The product ID<!-- EPO <DP n="18"> --> 54 (if present) and an "other" portion such as parts of the ID code 40 that contain redundancy would form the recoverable message <i>H</i>. The remainder of the ID code 40 and the UID would then form the non-recoverable portion <i>V</i>. There should be enough information available from the non-recoverable portion <i>V</i> to identify the signing station 16. For example, with an encryption key <i>k</i>, the signature component <i>c</i> can be computed as <i>c</i> = EN<i>C</i><sub>k</sub>(product ID+other). Also, with the serial number and the header of the ID code 40 taken as the visible portion V, the intermediate component <i>h</i> can be computed as <i>h</i> = HASH(<i>c</i>∥serial # + header). In this example, any reader 14 can read the serial number and header information, but would require access to the proper verification key (e.g. W) to decrypt the product ID 54.</p><p id="p0088" num="0088">Unless there are 80 bits of redundancy, ECPVS does not offer the same level of resistance to counterfeit signatures as 1024 bit RSA. However, since each forged signature is only applicable to one particular RFID tag 20, a reduced level of resistance may be acceptable since other signatures would not be compromised.</p><p id="p0089" num="0089">To implement ECPVS without padding, and where no additional fields in the RFID tag 20 can be used to increase redundancy, the inherent redundancy of the ID code 40 should be relied upon to determine if the signature is valid. This may involve imposing certain patterns or structures to the ID code 40 or using some out-of-band information such as referring to a product database. Since part of the ID code 40 is contained in the recoverable portion <i>H</i>, readers 14 that do not support ECPVS are not able to read the entire ID code 40.</p><p id="p0090" num="0090">To implement ECPVS with padding, the AFI, DSFID and user lock (U) bits may be used to increase the redundancy of the recoverable message <i>H</i>. For example, as can be appreciated from <figref idrefs="f0004">Figure 5</figref>, the AFI (when written to its own block) would have 24 unused bits, as well as the DSFID field and the user lock has 8 unused bits (if it is acceptable to leave user data block unlocked). These bits would then be available to provide padding.</p><p id="p0091" num="0091">Although the ideal level of padding is 80 bits, a lesser number of bits may be used if for the particular application such lesser padding is secure enough to make the forgery of signatures uneconomical.</p><p id="p0092" num="0092">With the extra padding, if may not be necessary to rely on the inherent redundancy in the ID code 40. Therefore, the entire code 40, with the exception of the Product ID 54, can be stored as the non-recoverable message <i>V</i>. All readers 14 will be able to<!-- EPO <DP n="19"> --> read the ID code 40, but only readers 14 with the correct public key can recover the Product ID 54.</p><p id="p0093" num="0093">It can therefore be seen that smaller RFID tags 20 can be signed using ECPVS than those suitable to be signed with RSA. By examining the data structures of the information in the tag 20, varied levels of redundancy can be provided by padding unused blocks with such redundancy. Also, if the ID code 40 does not need to be read by unauthorized readers 14, redundancy in the ID code 40 can be relied upon, or imposed, in order to provide a desired amount of redundancy. It has thus been recognized that the use of ECC signatures on an RFID tag 20 can offer similar protection to RSA signatures whilst being smaller and more efficient. This allows smaller tags to be used (or a more efficient use of the available data blocks) and/or multiple signatures to fit on the same tag. This cannot be done when using RSA signatures due to their overall size.</p><p id="p0094" num="0094">It will be appreciated that the principles described herein regarding the use of ECPV signatures are equally applicable to other signature schemes with message recovery such as the Elliptic Curve Digital Signature with Recovery (ECDSR) described in U.S. Provisional Patent Application No. ____ entitled "Signatures with Confidential Message Recovery" filed on September 4, 2007, the contents of which are incorporated herein by reference. When using ECDSR, the same considerations regarding security and tag size should be made similar to those discussed above.</p><p id="p0095" num="0095">In another embodiment, an ECDSA signature can be used for providing security to an RFID tag 20, in particular for a variation (b) ID code 40b where privacy is not an important issue.</p><p id="p0096" num="0096">ECDSA is a widely standarized elliptic curve-based signature scheme, appearing in the ANSI X9.62, FIPS 186-2, IEEE 1363-2000 and ISO/IEC 15946-2 standards as well as several draft standards.</p><p id="p0097" num="0097">ECDSA signature generation operates on several domain parameters, a private key d, and a message m, outputs the signature (r,s), where r and s are integers, and a summary of the algorithm is as follows.<!-- EPO <DP n="20"> -->
<ol><li>1. Select <i>k</i> ∈ <i><sub>R</sub></i> [1, <i>n</i> - 1], <i>n</i> being the order of the group generated by the elliptic curve base point, and being one of the domain parameters.</li><li>2. Compute <i>kP</i> = (<i>x</i><sub>1</sub>,<i>y</i><sub>1</sub>) and convert <i>x</i><sub>1</sub> to an integer <i>x̅</i><sub>1</sub>, where <i>P</i> is a point on an elliptic curve <i>E</i> and is one of the domain parameters.</li><li>3. Compute <i>r</i> = <i>x̅</i><sub>1</sub> mod <i>n</i>, wherein if <i>r</i> = 0, then go back to step 1.</li><li>4. Compute <i>e</i> = <i>H</i>(<i>m</i>), where <i>H</i> denotes a cryptographic hash function whose outputs have a bitlength no more than that of <i>n</i> (if this condition is not satisfied, then the outputs of <i>H</i> can be truncated).</li><li>5. Compute <i>s</i> = <i>k</i><sup>-1</sup>(<i>e</i> + <i>dr</i>) mod <i>n</i>, where if <i>s</i> = 0, then go back to step 1.</li><li>6. Output the pair (<i>r</i>, <i>s</i>) as the ECDSA signature.</li></ol></p><p id="p0098" num="0098">ECDSA signature verification operates on several domain parameters, a public key <i>Q</i>, the message <i>m</i>, and the signature (<i>r, s</i>) derived above. ECDSA signature verification outputs a rejection or acceptance of the signature, and proceeds as follows.
<ol><li>1. Verify that <i>r</i> and <i>s</i> are integers in the interval [1,n-1]. If any verification fails then a rejection is returned.</li><li>2. Compute <i>e</i> = <i>H</i>(<i>m</i>).</li><li>3. Compute <i>w</i> = <i>s</i><sup>-1</sup> mod <i>n</i>.</li><li>4. Compute <i>u</i><sub>1</sub> = <i>ew</i> mod <i>n</i> and <i>u</i><sub>2</sub> = <i>rw</i> mod <i>n</i>.</li><li>5. Compute <i>R = u</i><sub>1</sub><i>P</i> + <i>u</i><sub>2</sub><i>Q</i></li><li>6. If <i>R</i> = ∞ then the signature is rejected.</li><li>7. Convert the x-coordinate <i>x</i><sub>1</sub> of <i>R</i> to an integer <i>x̅</i><sub>1</sub>; compute <i>v</i> = <i>x̅</i><sub>1</sub> mod <i>n</i>.</li><li>8. If <i>v</i> = <i>r</i> then the signature is accepted, if not then the signature is rejected.</li></ol><!-- EPO <DP n="21"> --></p><p id="p0099" num="0099">As discussed above, an ECDSA signature is made up of two integers, namely <i>r</i> and <i>s</i>, both of which are the same size as the underlying field of the elliptic curve. For example, with a 160 bit curve, the signature size is 160x2 = 320 bits or 40 bytes.</p><p id="p0100" num="0100">If a message <i>M</i> is signed with ECDSA, then <i>M, r</i> and <i>s</i> are sent to the verifier, assuming that the verifier already possesses the correct public key <i>Q</i>.</p><p id="p0101" num="0101">The use of ECDSA in the authenticated RFID system 10 reduces the read/write times of digital signatures when compared to RSA, however, does not provide the privacy of ECPVS. The simplest way to implement ECDSA is to replace the 1024 bit RSA signature with an ECDSA signature of comparable security. The minimum curve size is typically required to be 160 bits, so an ECDSA signature occupies at least 320 bits. The smallest NIST recommended curve is 163 bits with a corresponding ECDSA signature size of 42 bytes. The following table illustrates the RFID memory required assuming that the ID CODE 40 occupies 96 bits.
<tables id="tabl0003" num="0003"><table frame="all"><title><i>Table 3: Signature Sizes for ECDSA</i></title><tgroup cols="5"><colspec colnum="1" colname="col1" colwidth="25mm"/><colspec colnum="2" colname="col2" colwidth="41mm"/><colspec colnum="3" colname="col3" colwidth="32mm"/><colspec colnum="4" colname="col4" colwidth="28mm"/><colspec colnum="5" colname="col5" colwidth="42mm"/><thead><row><entry morerows="1" align="center" valign="top">ID Code (bits)</entry><entry namest="col2" nameend="col4" align="center" valign="top">ECDSA</entry><entry morerows="1" align="center" valign="top">Total Size - Message and Signature (32 bit RFID memory blocks)</entry></row><row><entry align="center" valign="top">Curve</entry><entry align="center" valign="top">Signature Element</entry><entry align="center" valign="top">Size (bits/bytes)</entry></row></thead><tbody><row><entry rowsep="0" align="center">96</entry><entry rowsep="0" align="center">160 bit - SECP160R1</entry><entry align="center"><i>r<sub>ecdsa</sub></i></entry><entry align="center">160/20</entry><entry rowsep="0" align="center">13</entry></row><row><entry rowsep="0" align="center"/><entry align="center"/><entry align="center"><i>s<sub>ecdsa</sub></i></entry><entry align="center">160/20</entry><entry align="center"/></row><row><entry rowsep="0" align="center"/><entry morerows="1" align="center">163 bit - SECT163K1 (NIST recommended)</entry><entry align="center"><i>r<sub>ecdsa</sub></i></entry><entry align="center">163/21</entry><entry rowsep="0" align="center">14</entry></row><row><entry align="center"/><entry align="center"><i>s<sub>ecdsa</sub></i></entry><entry align="center">163/21</entry><entry align="center">(16 unused bits in last block)</entry></row></tbody></tgroup></table></tables></p><p id="p0102" num="0102">The message that is signed using an ECDSA scheme can be a concatenation of the UID of the tag 20 and the ID code 40.</p><p id="p0103" num="0103">For a variation (a) code 40a, there is no Product ID 54. The signature element <i>r</i> can be computed using the padding alone. If the recovered message matches the expected padding, the signature is valid.</p><p id="p0104" num="0104">For a variation (b), the Product ID 54 may be replaced by an invalid value which does not correspond to any product. The actual Product ID 54 and the padding would then be used in the computation of <i>r.</i> If the recovered message matches the expected padding, the<!-- EPO <DP n="22"> --> signature is valid. The reader 14 can then replace the invalid Product ID 54 with the recovered value to form the correct ID code 40b.</p><p id="p0105" num="0105">The ECC signature scheme that is chosen will typically depend on the amount of storage available on the RFID tag 20. It will be appreciated that the size of tag that is used can be chosen based on the security that can be acceptable, and based on the sizes that are available. An acceptable level of security is typically determined based on whether or not it would be economically feasible for a forger to forge a signature. If the redundancy in an ECPVS signature can be lowered and a forgery remain infeasible, then a smaller tag can be used. The examples used herein using 2048 bit and 256 bit tags are shown for illustrative purposes only and it will be appreciated that other tag sizes may instead be used, e.g. a 512 bit tag.</p><p id="p0106" num="0106">If a 2048 bit RFID tag 20 is used, either ECDSA or ECPVS can be used. ECDSA can be used to replace the RSA signature, and the digital signature will occupy 320 bits instead of 1024 bits, while offering the same level of security. The total storage required, including the ID code 40 is 416 bits or 13 memory blocks. It is therefore seen that using ECDSA allows multiple signatures to be written to a 2048 bit tag 20 whilst providing similar security and reducing the read/write time allowing an electronic pedigree to be established as the product 18 proceeds along the supply chain 22. However, unlike ECPVS, ECDSA cannot hide the product ID 54.</p><p id="p0107" num="0107">ECPVS can be used to further reduce the signature size and to hide the product ID 54 from readers 14 without the proper public key <i>Z<sub>i</sub></i>. With the additional storage space in a 2048 bit tag 20, padding can be used to increase the redundancy to an acceptable level. Without considering any inherent redundancy in the ID code 40, 80 bits of padding can be added to provide the same security as a 1024 bit RSA signature. The total storage required would be 96 bits for the ID code 40, 20 bits for product ID 54 and 80 bits of padding for <i>r</i> and 160 bits for <i>s</i>. A total of 356 bits or 12 memory blocks are thus used for the padded ECPVS signature. If a lower level of security is acceptable, the memory requirement can be further reduced. The following table summarizes the signature schemes that can be used with 256 and 2048 RFID tags.<!-- EPO <DP n="23"> -->
<tables id="tabl0004" num="0004"><table frame="all"><title><i>Table 4: Comparison of ECC Signatures</i></title><tgroup cols="4"><colspec colnum="1" colname="col1" colwidth="38mm"/><colspec colnum="2" colname="col2" colwidth="38mm"/><colspec colnum="3" colname="col3" colwidth="45mm"/><colspec colnum="4" colname="col4" colwidth="46mm"/><thead><row><entry align="center" valign="top">RFID Tag Memory (bits)</entry><entry align="center" valign="top">Signature Scheme</entry><entry align="center" valign="top">Advantage</entry><entry align="center" valign="top">Disadvantage</entry></row></thead><tbody><row><entry>256</entry><entry>ECPVS without Padding</entry><entry>• Uses 256 bit of storage</entry><entry>• Non-ECPVS reader cannot access entire ID code</entry></row><row><entry/><entry/><entry>• Hides Product ID from non-ECPVS reader</entry><entry>• Imposes structure or pattern in ID code, or uses out-of-band information</entry></row><row><entry rowsep="0"/><entry/><entry/><entry>• Lower forgery resistance than 1024 bit RSA</entry></row><row><entry/><entry>ECPVS with Padding</entry><entry>• Non-ECPVS reader can access entire ID code</entry><entry>• Requires more than 256 bits of storage unless inherent redundancy used</entry></row><row><entry/><entry/><entry>• Hides Product ID from non-ECPVS reader</entry><entry>• Lower forgery resistance than 1024 bit RSA</entry></row><row><entry>2048</entry><entry>ECDSA</entry><entry>• Non-ECDSA reader can access entire ID code</entry><entry>• Cannot hide Product ID from non-ECDSA reader</entry></row><row><entry rowsep="0"/><entry/><entry>• Offers same security as 1024 bit RSA</entry><entry/></row><row><entry/><entry>ECPVS with Padding</entry><entry>• Smaller signature size than ECDSA</entry><entry/></row><row><entry/><entry/><entry>• Non-ECDSA reader can access entire ID code</entry><entry/></row><row><entry/><entry/><entry>• Hides Product ID from non-ECPVS reader</entry><entry/></row><row><entry/><entry/><entry>• Offers same security as 1024 bit RSA</entry><entry/></row></tbody></tgroup></table></tables></p><p id="p0108" num="0108">It can therefore be seen that a 2048 bit RFID tag 20 using ECPVS provides the ability to write more than one signature to the tag, e.g. at different stages in the supply chain 22 and allows the system 10 to hide the product ID 54 from unauthorized readers to add privacy. It will be appreciated that the above is for illustrative purposes only and that other tag sizes may be deemed appropriate according to the same principles and considerations discussed above.</p><p id="p0109" num="0109">As a result, taking certain parameters such as the level of acceptable security and the inherent redundancy offered by the ID code 40, a smaller tag 20 may be used, such as a 256 bit RFID tag 20 or a 512 bit tag etc. (not shown) using ECPVS with and without padding.</p><p id="p0110" num="0110">Where ECPVS is used to hide the product ID 54, the public keys <i>Z<sub>i</sub></i> stored on the readers 14 should be physically protected and the distribution of the keys carefully controlled<!-- EPO <DP n="24"> --> by, e.g. the CA 12. If each reader 14 contains its own public/private key pair, certificates can be encrypted for each specific reader 14 before distribution. The CA 12 issues certificates for both the signing stations 16 and the readers 14. Key pairs for the readers 14 and signing stations 16 are generated at manufacture time. As discussed above, each reader 14 has a validated list of public keys <i>W<sub>j</sub></i> for the signing stations so that the signatures can be validated. An example key distribution procedure using signer certificates C<sub>SIGNj</sub> is shown in <figref idrefs="f0005">Figure 6</figref>.</p><p id="p0111" num="0111">In step 100 the CA 12 obtains the appropriate public key <i>W<sub>j</sub></i> and generates the corresponding certificate C<sub>SIGNj</sub> at step 102. The certificate is then encrypted using the appropriate public key <i>Zi</i> for the reader 14 to which the certificate is being distributed at step 104 to obtain an encrypted version C<sub>SIGNj</sub>'. The encrypted version is then distributed to the appropriate reader 14 at step 106, which is received by the reader 14 at step 108. The encrypted version is decrypted by the reader 14 at step 110 using the private key <i>z<sub>i</sub></i> to obtain the original certificate C<sub>SIGNj</sub>. The certificate is evaluated using the CA certificate C<sub>CA</sub> at step 114 where the CA certificate was obtained at step 112. If valid, the key <i>W<sub>j</sub></i> is obtained from the certificate and stored in the secure key store 36.</p><p id="p0112" num="0112">A signing operation is shown in <figref idrefs="f0006">Figure 7</figref> that is applicable to either ECDSA or ECPVS. In the example shown, the signing station 16 first determines if the tag 20 being signed is from a manufacturer that is known to them at step 200. If the manufacturer is known, the manufacturer ID is selected at step 202. If the manufacturer ID is not found, the signing station selects an option to add the manufacturer at step 204 whereby the name is entered at step 206. Typically, the signer is pre-programmed to sign for only a preset number of particular manufacturers and thus steps 200-206 may not be required or may occur automatically without the need for operator intervention. Key pairs for the manufacturer for each type of signature and curve supported are generated, imported or otherwise obtained by the manufacturer at step 208. The private keys are stored in secure hardware at step 210 and the public keys are communicated to the CA 12 at step 212.</p><p id="p0113" num="0113">The signing station 16 then selects or reads from the tag 20, a serial number at step 214 (may use a default counter value) and a product code is selected at step 216 when applicable (variation (b)). Preferably, the serial number is pre-burned into ROM prior to arrival at the signing/programming facility as discussed above. This enables the manufacturer of the unsigned tag 20 to ensure that in order to compromise the security or<!-- EPO <DP n="25"> --> attack the system, the hardware would have to be counterfeited rather than simply being able to use a generic part and program a UID that suits the counterfeiter's purposes.</p><p id="p0114" num="0114">As noted above, the signing station 16 is typically pre-programmed to automatically generate the proper signature type but in some cases may be programmed to provide the ability for an operator to choose the type of signature to write to the tag (e.g. ECDSA or ECPVS) at step 218, write the signature at step 219, and the tag 20 may then be programmed at step 220. A record is created at step 222 and preferably stored as a log report for tracking and auditing purposes. It will be appreciated that preferably each signing station 16 is pre-programmed such that any decision above is calibrated prior to the signer being deployed. However, if desired, the above-noted decision structures can be offered in a program, e.g. from drop down lists in a graphical user interface (GUI) (not shown). Such a GUI may also be used by a technician for programming and repairing the signing stations 16.</p><p id="p0115" num="0115">Step 220 is shown in greater detail in <figref idrefs="f0007">Figure 8</figref>. The UID is read from the tag 20 at step 230 and the ID code 40 is generated at step 232 based on user selections, the type of product etc. The UID, ID code, any meta data, and any hidden data (e.g. product ID 54 and using ECPVS) is then signed at step 234 to generate the signature using the manufacturer specific public key. The ID code 40 and the signature are then written to the tag 20 at step 236 and a timestamp is preferably recorded at least in a record internal to the signing station 16 at step 238. If desired, log records and log reports may be stored at the signing stations 16 and then later polled or reported for auditing and tracking purposes.</p><p id="p0116" num="0116">A verification procedure is shown in <figref idrefs="f0008">Figure 9</figref>. At some point, the reader 14 obtains the manufacturer specific public key <i>W<sub>j</sub></i> from the CA at step 300. The tag 20 is energized at step 302 when it enters the RF zone 26 (if passive tag) and the UID, data and signature are read by the reader 14 at step 304. The reader 14 then verifies the signature at step 306 using the public key <i>W<sub>j</sub></i> and according to the type of signature scheme being used and a timestamp is recorded if applicable at step 308. A log report is preferably generated at step 310 which can be used for auditing purposes by the appropriate parties responsible for the supply chain and integrity of the product.</p><p id="p0117" num="0117">It is therefore seen that the read/write times and signature sizes can be reduced in an authenticated RFID system 10 by using ECC and in particular ECPVS and ECDSA when<!-- EPO <DP n="26"> --> appropriate. The use of ECPVS further adds the benefit of being able to hide a portion of the product information which provides an added incentive to adopting RFID technology. ECPVS also provides the smallest signature at a similar security to an RSA signature. The smaller signature can enable multiple signing stations 16 to be used in the supply chain so that multiple signatures are written sequentially to each tag in the remaining available space and would then need to be verified sequentially. Therefore, it becomes easier to track the life of the product as it moves through the supply chain.</p><heading id="h0008"><b>Key Management System for Authenticated RFID System</b></heading><p id="p0118" num="0118">Turning now to <figref idrefs="f0009">Figure 10</figref>, a key management system (KMS) 400 is shown as one embodiment for distributing keys as shown generally in <figref idrefs="f0002">Figure 2</figref>. In the example shown in <figref idrefs="f0009">Figure 10</figref>, the KMS 400 is responsible for managing the distribution of keys in a pharmaceutical manufacturing stage, supply chain 22 and subsequent distribution to customers.</p><p id="p0119" num="0119">As discussed above, RFID tags 20 that include private or otherwise sensitive information such as a drug or product ID codes 54 can be hidden using ECPV signatures. However, since the hidden portion can be recovered using the public keys <i>W<sub>1-T</sub></i> and <i>Z<sub>1-N</sub></i> of the signing stations 16 and readers 14 respectively, when the overall system is intended to be distributed and scalable, it is generally preferable to protect the ECPV public keys in a secure manner and to monitor and control distribution thereof. The KMS 400 can be used to control distribution of the ECPV public keys such that only authorized readers 14 can recover the product ID code 54. As such, the keys <i>W<sub>1-T</sub></i> and <i>Z<sub>1-N</sub></i> in the following example, are to be referred to as "verification keys" given that by imposing such control over the use of these keys, they are not "public" in the traditional sense.</p><p id="p0120" num="0120">As can be seen in <figref idrefs="f0009">Figure 10</figref>, products 18 that are manufactured (which may include RFID programming, labelling etc.) at a manufacturer 402, can enter a supply chain 22 and eventually end up at a clinic or pharmacy 408 which then distributes the product 18 to customers. The products 18 have affixed thereto, RFID tags 20 which are signed and the signatures read and verified from the tags 20 at various stages in the supply chain 20 and at the point of sale. The clinic or pharmacy 408 thus includes an RFID reader 14, which is programmed and supplied by a reader manufacturer 410. As discussed above, verification of<!-- EPO <DP n="27"> --> the signed RFID tags 20 requires having up-to-date verification keys, which are distributed, updated, tracked, and otherwise controlled by a central KMS 400. The KMS 400 may utilize key inject controllers 422 to track the number of tags 20 that are signed, the number of readers 14 programmed, and the number of deployed readers 14 that are updated to collect revenue and to protect the distribution of the product 18 and the privacy of the contents. The KMS 400 can be used to distribute the keys and any associated information to the deployed readers 14 in a controlled and authentic manner, which ensures that the ECPV signatures 416 on a tag 20 can only be authenticated by "authorized" readers 14. For example, this can prevent unauthorized readers from obtaining the drug ID code 54 or other confidential information that can otherwise be hidden in the ECPV signature on the passive memory of the RFID tag 20.</p><p id="p0121" num="0121">As shown in <figref idrefs="f0010">Figure 11</figref> the manufacturing process implemented by a drug manufacturer 402 in this example includes, in part, an RFID tag programming stage 404 and a pharmaceutical product labelling stage 406. Once the pharmaceutical product 18 is given a label 19, it may then enter a supply chain 22 if applicable to eventually end up at the clinic or pharmacy 408, which in turn distributes (sells) the product 18 to consumers as discussed above.</p><p id="p0122" num="0122">The tag programming stage 404 generally obtains or receives non-programmed RFID tags 20 (preferably containing a pre-burned serial number or UID), which are programmed using an RFID programmer 414 such that they include, e.g. a product ID code 54 such as an EPCglobal code as shown in <figref idrefs="f0004">Figure 5</figref>. In this example, a digital signature 416, e.g. an ECPV signature, is written to the tag 20 by the RFID programmer 414. The RFID programmer 414 preferably interfaces and is at least partially controlled by a key injection system 417a, which includes a signing agent 419a, a key inject server 418a (which in this example resides at the same site as the programming stage 404), and a key inject controller 422a (which is typically an external entity that communicates securely with the key inject server 418a). The RFID programmer 414 in this example interfaces directly with the signing agent 419a to obtain the necessary information in order to prepare and write a signature 416 to the tag 20.</p><p id="p0123" num="0123">In general, the key inject system 417 is a system that is used to remotely monitor device registration and, if required, to meter the injection of unique and immutable<!-- EPO <DP n="28"> --> information into the device. A complete description of the key injection system 417 is provided in co-pending <patcit id="pcit0001" dnum="US45041806A"><text>U.S. patent application No. 11/450,418 filed on June 12, 2006</text></patcit>, the contents of which are incorporated herein by reference. In the present example, the controller 422a is a computer system that is remote to the RFID programming facility but is preferably under control of the company that produces the drug.</p><p id="p0124" num="0124">The key inject server 418a, signing agent 419a, and the RFID programmer 414 may or may not be in the same location or building. Preferably, a secure connection is established over a network connecting the components of the key inject system 417a internally and/or externally. The signing agent 419a comprises a data storage device 420, preferably in a hardware security module, which is a protected device used by the signing agent 419a to perform cryptographically secure operations such as encryption, decryption and signing and to store sensitive data.</p><p id="p0125" num="0125">The storage device 420 stores a key pair (<i>w<sub>j</sub></i>, <i>W<sub>j</sub></i>) for each product type (e.g. for each drug). In this example, the drug manufacturer 402 is responsible for writing signatures 416 for five (5) different products and thus stores five key pairs as shown in <figref idrefs="f0010">Figure 11</figref>. It will be appreciated that the data storage device 420 may be accessed by multiple RFID programmers 414 on multiple product lines in the same facility, or distributed in different buildings. As such, any number of key inject systems 417a, data storage devices 420 and RFID programmers 414 can be used depending on the logistics of the manufacturing process. For simplicity, the present example illustrates five product lines in the same facility that use a common key inject system 417 having a single RFID programmer 414 that is configured to write signatures 416 using any of the key pairs (<i>w<sub>j</sub></i>, <i>W<sub>j</sub></i>) appropriate to the product. It will be appreciated that a key inject system 417a is only one way to distribute keys and any other configuration that enables the KMS 400 to monitor and control such a process may be used. As such, the KMS 400, in general, can be thought of as a controller for distributing the keys, which may make use of any applicable sub-systems for interacting with the various parties involved in the overall authenticated RFID system.</p><p id="p0126" num="0126">The signature 416 is generated by signing the tag 20 using the serial number, a drug ID code 54 specific to the product 18, and other supply chain 22 specific meta data using the private key for that product 18. The signature 416 is preferably an ECPV signature written to the tag 20 as described above.<!-- EPO <DP n="29"> --></p><p id="p0127" num="0127">As can also be seen in <figref idrefs="f0010">Figure 11</figref>, the labelling stage 406 applies the programmed RFID tag 20 (which includes the signature 416) to a label 19, and in turn applies the label 19 to the product 18. It can be appreciated that the labelling stage 406 may also be integrated with the RFID programming stage 404 and, similarly, may be at the same facility. Again, the nature of the manufacturing process is dependent on the product 18, the requirements of the industry etc. and <figref idrefs="f0010">Figure 11</figref> is only an illustrative arrangement. In this example, a labelling machine (not shown may be used and could interface with the key inject system 417a if desired or if a signature is to be added at the labelling stage 406.</p><p id="p0128" num="0128">Once the products 18 are labelled, they may then enter the supply chain 22, which may include steps of shipping, warehousing, distribution etc. As will be discussed below, additional signatures 416 may be added to the tag 20 and/or the signature 416 may be verified by RFID readers 14 at any one or all of the supply chain stages.</p><p id="p0129" num="0129">The product 18, in this case a drug, eventually arrives at one or more clinics or pharmacies 408, shown in more detail in <figref idrefs="f0013">Figure 14</figref>, which is then responsible for distributing the drug 18 to consumers. Each clinic or pharmacy 408 includes a reader 14 that includes an up-to-date set of keys, which are stored locally, preferably in secure hardware, in a data storage device 426. As shown generally in <figref idrefs="f0002">Figure 2</figref>, the reader 14 stores its own key pair, in this case, it being reader 1, key pair (<i>z<sub>1</sub>, Z<sub>1</sub></i>); a copy of the corresponding certificate C<sub>VER1;</sub> a copy of the CA's certificate C<sub>CA</sub>; and the verification keys of which it has permission to use (e.g. keys <i>W<sub>1-5</sub></i>). The verification keys are provided on a conditional basis by the KMS 400 as will be explained below.</p><p id="p0130" num="0130">Each reader 14 is programmed at the reader manufacturer 410, shown in <figref idrefs="f0011">Figure 12</figref>, which also uses a key inject system 417 to create the key pairs (<i>z<sub>i</sub></i>, <i>Z<sub>i</sub></i>) and to assign a device identifier Dev<sub>i</sub> to each reader 14 for identification purposes. The reader manufacturer 410 includes a database 424 that records the device identifiers for the KMS 400. A reader manufacturer reader/programmer 421 interfaces with another key inject agent 419b, which in turn communicates with another key inject server 418b to track the programming of the readers 14. In this way, as each reader 14 is given a new key pair, the key inject server 418b can communicate the new keys back to the KMS 400 via another key inject controller 422b and track revenue for such an operation.<!-- EPO <DP n="30"> --></p><p id="p0131" num="0131">As shown in <figref idrefs="f0012">Figure 13</figref>, the KMS 400 includes a CA 429, a certificate server 428, and a conditional access database 430 and allows the readers 14 in the field to obtain up-to-date certificates for the signing stations 16. These certificates can then be used by the readers 14 to verify the digital signatures 416 generated by the key inject agents 418 at the signing station 16.</p><p id="p0132" num="0132">New key pairs (<i>w<sub>j</sub></i>, <i>W<sub>j</sub></i>) for the signing stations 16 can be generated in a number of ways. For example, the key pairs may be generated in a secure environment by approved personnel and then uploaded to the signing stations 16 when appropriate. In another embodiment, the key pairs can be automatically generated by the signing agent 419 or key inject server 418. In yet another embodiment, the key pairs can be generated by the key inject controller 422 or the KMS 400 (i.e. from a remote location) and then securely transmitted or uploaded to the signing station 16 (i.e. through the key inject server 418 and agent 419). A new key pair (<i>w<sub>j</sub></i>, <i>W<sub>j</sub></i>) is required each time that a new signing station 16 is deployed or when it is desirable for an existing signing station 16 to use multiple keys (e.g. for different product lines). If the signing station 16 generates a new key pair, a certificate request may be created, which contains the public key signed with the private key. The certificate request is then transmitted back to the KMS 400, which in this example is done through the key inject controller 422a. By using the key inject controller 422a, the KMS 400 is not only able to keep up to date key information, but use of the key inject controller 422a also enables the KMS 400 to inhibit fraudulent attempts to create new manufacturing lines without the proper consent. The KMS 400 is therefore able to track and obtain revenue for each tag 20 that is signed, for each product line that is properly registered.</p><p id="p0133" num="0133">The KMS 400 can also track the number of readers 14 that are programmed using the other key inject controller 422b. In this way, the KMS 400 can ensure that it is aware of all readers 14 that are capable of (and have permission for) verifying the signatures 416 signed by the signing stations 16. Where at least a portion of the recoverable contents of the signature 416 is sensitive or private information, this enables the KMS 400 to have greater confidence in the security and privacy of the overall system.</p><p id="p0134" num="0134">The KMS 400 may similarly track each signature verification or additional signature write operation that occurs as the tag 20 passes through the supply chain 22. The KMS 400 therefore not only securely distributes keys to the appropriate entities, but can also<!-- EPO <DP n="31"> --> track points of revenue for the key distribution service. For example, the KMS 400 can track the number of tags 20 signed, and the number of readers 14 programmed and collect a per-device or per-tag charge. The KMS 400 may also track reader usage at the clinic or pharmacy 408 and collect a monthly or flat rate service fee for synchronizing the deployed readers 14 with up to date keys. The clinic or pharmacy 408 and the manufacturer 402 can, in turn, offer security and privacy to their customers and/or business partners.</p><p id="p0135" num="0135">Referring now to <figref idrefs="f0014">Figure 15</figref>, processes for generating new keys for the signing station 16 and for signing tags 20 are generally shown. As noted above, a new key pair (<i>w<sub>j</sub></i>, <i>W<sub>j</sub></i>) can be generated in a secure environment and then loaded manually into the signing agent 419a, or can be generated and loaded by the KMS 400 and/or key inject system 417a. Once the new key pair has been generated and loaded at the signing station 16 (e.g. manufacturer 402), the key agent 419a then generates and sends a certificate request to the KMS 400, e.g. through the key inject system 417a. It should be noted that the system shown in <figref idrefs="f0009 f0010 f0011 f0012 f0013">Figures 10-14</figref> does not require that the signing stations 16 and readers 14 be online at all times. As such, the certificate requests may be sent to the CA 429 at a later time by the key inject server 418a, e.g. by way of an email or other form of communication, together with the business request to add a certificate to the KMS 400.</p><p id="p0136" num="0136">The business request typically includes the parameters of the business relationship between the KMS 400 and the manufacturer 402. For example, there may be an agreement for a per-signature charge that can be collected by the KMS 400 for keeping the manufacturer 402 up to date with current and valid keys for generating the signatures. Other agreements such as flat rate monthly fees, one time fees etc. may also be established depending on the nature of the manufacturing environment, the product 18, volumes, price per unit etc.</p><p id="p0137" num="0137">Once the business agreements have been processed by the KMS 400, the KMS 400 then issues and returns a certificate C<sub>SIGNj</sub>, which corresponds to the key pair generated. The certificate is placed on the certificate server 428, together with a list of readers 14 that are entitled to the certificate. Therefore, it can be appreciated that the business request also typically includes details of preferred or mandatory distributors and/or parties in the supply chain 22. This enables the KMS 400 to track permissions for the readers 14 and to update their keys accordingly. The certificate C<sub>SIGNj</sub> is also stored by the signing station 16 for<!-- EPO <DP n="32"> --> future reference as discussed above. It may be noted that the signing station 16 does not necessarily make use of the certificate in normal operations.</p><p id="p0138" num="0138">Once the signing agent 419a has been provisioned with one or more keys, which correspond to one or more products 18 on one or more product lines, tags 20 may then be signed during the programming stage 404. The key inject system 417a may be used to meter a credit pool to restrict the number of tags 20 that are signed or may instead simply track the number of tags 20 that are signed by using a secure reporting process. For example, after signing a tag 20 as shown in <figref idrefs="f0014">Figure 15</figref>, the signing agent 419a then reports back to the signing server 418a indicating that a tag 20 has been signed, which is repeated for each tag 20 in the particular run or shift, and then the signing agent waits 419a for its next instructions, updates or batch of tags 20. The server 418a may then report the total number of signed tags to the KMS 400 through the key inject controller 422a at the appropriate time. Alternatively, the signing agent 419a may track the number of tags signed and then report the total to the server 418a who in turn reports back to the KMS 400 through the controller 422a. The key inject system 417a can not only track tag signing but also meter a credit pool to restrict the number of tags 20 signed in a particular amount of time and/or for a particular manufacturer 402 or product line etc.</p><p id="p0139" num="0139">Referring now to <figref idrefs="f0015">Figure 16</figref>, a process for registering a reader 14 is shown. The reader 14 is first manufactured at the reader manufacturer 410, which includes the creation of a reader key pair (<i>z<sub>i</sub></i>, <i>Z<sub>i</sub></i>). The reader 14 generates a certificate request, sends the certificate request to the KMS 400 through the key inject system 417b, and is issued a corresponding certificate C<sub>VERi</sub>. The reader 14 may then be deployed to a clinic or pharmacy 408 or a particular stage in the supply chain 22. The reader 14, once deployed, then connects to the KMS 400 through the key inject system 417b to request for registration. The KMS 400 determines which, if any, keys the particular owner of that reader 14 are entitled to, and verifies the request. If verified, the KMS 400 then assigns and records a set of permissions to the reader 14. The KMS 400 sends an indication of these permissions with the associated verification keys <i>W<sub>j</sub></i> to the reader 14 and meta data may be appended at this point. The reader 14 then securely stores the keys, preferably in a hardware security module (HSM) and acknowledges receipt of the keys to the KMS 400. The reader 14 may then use the<!-- EPO <DP n="33"> --> verification keys according to its permissions, to verify signatures 416 on the tags 20 as product 18 is sold.</p><p id="p0140" num="0140">The reader 14 in the meantime waits for updates from the KMS 400 since some of the keys may expire after a prescribed amount of time and new products 18 may need to be verified. The KMS 400 is able to update the reader 14 based on the feedback it obtains from the signing stations 16 (e.g. manufacturers 402) and based on product information, privacy issues etc.</p><p id="p0141" num="0141">Referring now to <figref idrefs="f0016">Figure 17</figref>, a process for updating the readers 14 is shown. The KMS 400 first obtains or gathers information regarding revocation of certificates, expiration of products and any other information that affects the validity of the product 18 and keys <i>W<sub>j</sub></i> that are used to verify the corresponding signature 416. This information is compared to the locally stored information regarding the permissions that have been assigned to certain readers 14, and updates are prepared for each reader 14. The KMS 400, when a connection is available (or using a polling or other scheduled routine), connects to the readers 14 and then sends the updates, waits for acknowledgement that the reader 14 has been updated and then disconnects until the next updates are required and/or available.</p><p id="p0142" num="0142">It can be seen that the KMS 400 can operate in a semi-online manner and thus the readers 14 and signing stations 16 do not require a dedicated connection that is always online. The KMS 400 can update at appropriate times or have scheduled updates that require a connection to be established. It will be appreciated that where possible, a fully online system may also be used and/or a closed loop system within a single entity depending on the nature of the manufacturing environment and the supply chain 22 and distribution channels.</p><p id="p0143" num="0143"><figref idrefs="f0017">Figure 18</figref> illustrates an exemplary revenue flow to enable a KMS 400 to track and collect per use and flat charges for keeping up to date keys. For example, on the signature end, the key inject server 418a can be used to track the number of signatures written, report this number to the controller 422a, which then, if necessary, determines if more signatures can be written etc. (metering) and reports back to the KMS 400 for further "credit" or to simply report the revenue that should be collected from the particular manufacturer 402. The server 418a can be used to track multiple signing agents 419a on multiple product lines to prepare a consolidated revenue report for the KMS 400. The controller 422a is preferably<!-- EPO <DP n="34"> --> responsible for managing credits and updating credit pools (and relaying this information to the KMS 400) with the KMS 400 overseeing operation of the controllers 422 (e.g. using log reports). However, the KMS 400 may also grant further credit if appropriate, may prepare updates while a connection is established, and then would able to directly collect revenue from the manufacturer 402 for the signatures 416 that have been written. The revenue is, as noted above, dictated by the corresponding business requirements and arrangements. For example, the KMS 400 may be paid in advance for a predetermined number of signatures 416 and thereafter obtain additional revenue for individual signatures.</p><p id="p0144" num="0144">For the reader manufacturer 410, the KMS 400 may charge per reader 14 that is produced, which is tracked by the key inject server 418b and controller 422b and reported back to the KMS 400 for billing and tracking needs. Once the readers 14 are deployed, the KMS 400 preferably provides a key update in exchange for a regular service fee. It will be appreciated that, although more difficult to track every read performed by each reader, e.g. due to missed reads etc., the KMS 400 can also charge per read. It will also be appreciated that similar revenue streams can be tracked and acquired through the various other stages in the supply chain 22 depending on the nature of the involvement of the other entities.</p><heading id="h0009"><b>Aggregate Signatures for Multiple Signers</b></heading><p id="p0145" num="0145">If the number of signers is large so too is the number of signatures and where the amount of space for storing the signatures is limited or at a premium (e.g. RFID tags 20), then the combined size of all the signatures can be costly. The following signature schemes reduce the size of multiple signatures by aggregating one or more signature components. The following schemes improve on traditional multi-signature schemes that compress two or more signatures.</p><p id="p0146" num="0146">Although particularly suitable for incorporating a contribution from multiple signing entities in an RFID signing scheme as discussed and exemplified herein, it will be appreciated that the signature schemes discussed below are applicable to any environment.</p><p id="p0147" num="0147">In one implementation the following aggregate signature schemes can be used with multiple signing stations (e.g. with RFID tags 20 in a pharmaceutical supply chain).<!-- EPO <DP n="35"> --></p><p id="p0148" num="0148">Traditionally, aggregate signatures have been proposed based on a digital signature algorithm using bilinear pairings. The algorithm defines an aggregate signature scheme, which is a traditional signature scheme equipped with two additional operations. The first operation takes a set of signatures s<sub>1</sub>, s<sub>2</sub>, ... , s<sub>t</sub> of messages m<sub>1</sub>,m<sub>2</sub>, ... , m<sub>t</sub> signed by t users with public keys U<sub>1</sub>, ... ,U<sub>t</sub>, and aggregates these into a single compressed signature s. The second operation verifies an aggregate signature s, given the messages m<sub>1</sub>, . . . ,m<sub>t</sub> and the users' public keys U<sub>1</sub>, ... ,U<sub>t</sub>. The signature s is valid if and only if every one of the s<sub>i</sub> verifies for the associated message and user.</p><p id="p0149" num="0149">The following is particularly useful for ECPVS signatures although is equally applicable to other ElGamal signatures and similarly to other schemes such as ECDSA as will also be shown below.</p><p id="p0150" num="0150">When referring to ECPVS and ECDSA signature schemes, the terminology used above is repeated for consistency.</p><p id="p0151" num="0151">According to the above examples, it is assumed that there are T signers 16 that are each to sign a message <i>M</i>. For simplicity, it is also assumed that <i>M</i> is identical for all signers and, when signed using ECPVS, the recoverable portion <i>H</i> and visible portion <i>V</i> are also the same, e.g. the product ID and UID respectively. It will be appreciated that in some cases, <i>V</i> will be different for each signer <i>j</i> , i.e. <i>V<sub>j</sub></i>. It is also considered below that each signer may instead sign a different recoverable message <i>H<sub>j</sub></i>.</p><p id="p0152" num="0152">The following describes two types of aggregation, namely a semi-aggregate signature scheme and a fully-aggregate signature scheme. It has been found that the semi-aggregate signature scheme can compress the signatures to two-thirds of the original size. The fully-aggregate signature scheme is named as such since the compressed aggregate signature is the size of a single signature, no matter how many signing stations 16 are involved. The rate of compression is T-fold when there are T signers, and thus the fully-aggregate signature scheme can reach very high rates of compression when there are many signers.</p><p id="p0153" num="0153">Although full aggregation has better compression than semi-aggregation, it requires the co-operation of the signers to create the aggregate signature and thus may not be suitable where the signers are in different locations. Also, in other circumstances, e.g. where<!-- EPO <DP n="36"> --> parties sign at different times, full aggregation may not be possible. The semi-aggregate signatures, discussed below, however, enable asynchronous signing and thus can be used instead of full-aggregation when necessary.</p><heading id="h0010"><b>Semi-Aggregate ECPVS</b></heading><p id="p0154" num="0154">The semi-aggregate signature scheme using ECPVS for T signers begins with a first signer, namely Signer 1, computing a traditional ECPVS signature (c<sub>1</sub>,s<sub>1</sub>) by encrypting a hidden portion <i>H</i> in c<sub>1</sub>. Signer 2 then encrypts c<sub>1</sub> when computing c<sub>2</sub> rather than encrypting <i>H</i>, and then computes the other component s<sub>2</sub> in the normal fashion, producing an updated signature (c<sub>2</sub>, s<sub>1</sub>, s<sub>2</sub>). This is repeated for each signer, until signer T encrypts c<sub>T-1</sub> when computing c<sub>T</sub> and the semi-aggregate signature is (c<sub>T</sub>, s<sub>1</sub>,...,s<sub>T</sub>). In other words, each signer encrypts the previous "c" component whilst generating then next "s" component using the updated "c" component.</p><p id="p0155" num="0155">To verify the semi-aggregate ECPVS signature, a verifier 14 (e.g. RFID reader) first recovers c<sub>T-1</sub> by performing an ECPVS verification on components (c<sub>T</sub>,s<sub>T</sub>) to decrypt c<sub>T-1</sub> from c<sub>T</sub>. Next, the verifier recovers c<sub>T-2</sub> from (c<sub>T-1</sub>,s<sub>T-1</sub>) and this is repeated until representation <i>H</i>' of <i>H</i> is recovered. <i>H</i>' is then checked for a particular characteristic, such as redundancy and, if the characteristic is present, message <i>M</i> can be reconstructed using <i>H</i>' and <i>V</i>.</p><p id="p0156" num="0156">The semi-aggregate method is named as such for two reasons. First, the intermediate ciphertexts c<sub>1</sub>, ..., c<sub>T-1</sub> do not need to be included in the final ciphertext c<sub>T</sub>. Second, the verifier 14 has deferred the acceptance or rejection of the intermediate signature(s) until all ciphertexts have been decrypted. For example, it is not necessary for signers 2 to T to add any redundancy. Therefore, the extra signers only add message expansion by adding the values s<sub>2</sub>, ..., s<sub>T</sub>.</p><p id="p0157" num="0157">To further illustrate the semi-aggregate signature scheme, the following example is provided for three signers, making reference to <figref idrefs="f0018">Figures 19</figref> and <figref idrefs="f0019">20</figref>. The following example is particularly applicable to a pharmaceutical supply chain having three signing stations 16 in the supply chain 22 that each contribute to the signature added to an RFID tag 20 affixed to<!-- EPO <DP n="37"> --> an object 18 (see also <figref idrefs="f0001">Figure 1</figref>). It will be appreciated that the semi-aggregate signature scheme can be used to provide multiple signatures in any environment and should not be limited to RFID systems.</p><p id="p0158" num="0158">As shown in <figref idrefs="f0018">Figure 19</figref>, Signing Station 1 generates an ephemeral key pair (k<sub>1</sub>,Q<sub>1</sub>) and then generates an encryption key <i>X</i><sub>1</sub> = KDF(Q<sub>1</sub>) as described above. A first signature component for the first signer c<sub>1</sub> is then computed by encrypting the recoverable part <i>H</i> of the message <i>M</i> using the key <i>X</i><sub>1</sub> while, in this example, ensuring sufficient redundancy in <i>H</i> exists for later verification. Using the visible portion <i>V</i> of the message <i>M</i>, an intermediate component <i>h</i><sub>1</sub> is then computed using a hash function (e.g. SHA1) and converted to an integer <i>e</i><sub>1</sub>, which is then used along with the private key <i>w</i><sub>1</sub> of Signing Station 1 and the ephemeral key k<sub>1</sub> to generate the second signature component s<sub>1</sub> for the first signer. In this example, the signature having components (c<sub>1</sub>, s<sub>1</sub>) is then written to the RFID tag 20 as usual in ECPVS.</p><p id="p0159" num="0159">A second signing station, Signing Station 2, then contributes to creating an updated, semi-aggregate signature rather then adding a separate signature. In this example, Signing Station 2 is at another point in the supply chain. Similar to Signing Station 1, Signing Station 2 generates an ephemeral key pair (k<sub>2</sub>,Q<sub>2</sub>) and an encryption key <i>X</i><sub>2</sub> = KDF(Q<sub>1</sub>). However, at this stage, Signing Station 2 encrypts the existing signature component c<sub>1</sub> using <i>X</i><sub>2</sub> to generate signature component c<sub>2</sub>. Intermediate signature component <i>h</i><sub>2</sub>, integer <i>e</i><sub>2</sub> and signature component s<sub>2</sub> are computed as before, however, the resultant updated signature now comprises the set of components (c<sub>2</sub>,s<sub>1</sub>,s<sub>2</sub>). As such, signature component c<sub>1</sub> is encrypted in c<sub>2</sub> and the "s" components (i.e. s<sub>1</sub>, s<sub>2</sub> at this stage) are kept in the updated signature.</p><p id="p0160" num="0160">A third signing station, Signing Station 3, in this example the final signing stage, also contributes to the semi-aggregate signature, which currently comprises (c<sub>2</sub>,s<sub>1</sub>,s<sub>2</sub>) on the RFID tag 20. Similar to the previous signing stations 16, Signing Station 3 generates its own encryption key, in this case k<sub>3</sub>, and then encrypts signature component c<sub>2</sub> using k<sub>3</sub> to generate an updated "c" signature component c<sub>3</sub>. Intermediate component <i>h</i><sub>3</sub>, integer <i>e</i><sub>3</sub>, and component s<sub>3</sub> are computed as described above, and the resultant updated (and in this example final) signature comprises components (c<sub>3</sub>,s<sub>1</sub>,s<sub>2</sub>,s<sub>3</sub>).<!-- EPO <DP n="38"> --></p><p id="p0161" num="0161">At each stage, the new signature that embeds the "c" component of the previous signer 16, is written over the previous form of the semi-aggregate signature. Therefore, the semi-aggregate signature (c<sub>T</sub>,s<sub>1</sub>,...s<sub>T</sub>) is smaller than writing individual signatures ((c<sub>1</sub>,s<sub>1</sub>),...,(c<sub>T</sub>,s<sub>T</sub>)) to the RFID tag 20.</p><p id="p0162" num="0162">Referring now to <figref idrefs="f0019">Figure 20</figref>, verification of the semi-aggregate signature in general includes a stage for each signing stage and in this example, the RFID tag 20 includes a signature having components (c<sub>3</sub>,s<sub>1</sub>,s<sub>2</sub>,s<sub>3</sub>) and the visible portion V of the message M (e.g. UID).</p><p id="p0163" num="0163">In stage 1, the verifier 14 computes <i>h</i><sub>3</sub>' using component c<sub>3</sub> and the visible portion <i>V</i>, converts <i>h</i><sub>3</sub>' to an integer <i>e<sub>3</sub></i>', computes Q<sub>3</sub>' using s<sub>3</sub>, <i>e<sub>3</sub>'</i> and the public key W<sub>3</sub> of Signing Station 3, and then generates <i>X</i><sub>3</sub>' by applying the same KDF to Q<sub>3</sub>'. The verifier 14 then obtains c<sub>2</sub> by decrypting c<sub>3</sub> using <i>X</i><sub>3</sub>' and a complementary decryption function, e.g. that denoted by "DEC" in <figref idrefs="f0019">Figure 20</figref>.</p><p id="p0164" num="0164">Now that the verifier has obtained c<sub>2</sub>, in stage 2, the verifier computes <i>h</i><sub>2</sub>' using component c<sub>2</sub> and the visible portion <i>V</i>, converts <i>h</i><sub>2</sub>' to an integer <i>e<sub>2</sub></i>', computes Q<sub>2</sub>' using s<sub>2</sub>, <i>e<sub>2</sub>'</i> and the public key W<sub>2</sub> of Signing Station 2, and then generates <i>X</i><sub>2</sub>' by applying the same KDF to Q<sub>2</sub>'. The verifier then obtains c<sub>1</sub> by decrypting c<sub>2</sub> using <i>X</i><sub>2</sub>' and a complementary decryption function.</p><p id="p0165" num="0165">In stage 3, the verifier computes <i>h</i><sub>1</sub>' using component c<sub>1</sub> and the visible portion <i>V</i>, converts <i>h</i><sub>1</sub>' to an integer <i>e<sub>1</sub></i>', computes Q<sub>1</sub>' using s<sub>1</sub>, <i>e<sub>1</sub></i>' and the public key W<sub>1</sub> of Signing Station 1, and then generates <i>X</i><sub>1</sub>' by applying the same KDF to Q<sub>1</sub>'. Since c<sub>1</sub> was generated by encrypting the recoverable portion of the message <i>H</i>, a bit string <i>H</i>', which is a representation of <i>H</i> is then obtained by decrypting c<sub>1</sub> using <i>X</i><sub>1</sub>'. At stage 4, the verifier 14 then checks for the expected characteristic such as the redundancy of <i>H</i>' in this example and, if sufficient, accepts <i>H</i>' as the recoverable portion <i>H</i> and can reconstruct the message <i>M</i>, e.g. by combining <i>H</i>' and <i>V</i> at stage 5. The verifier 14 may then conclude that each signer signed the message <i>M</i> represented by components (<i>H</i>,<i>V</i>).</p><p id="p0166" num="0166">It should be noted that although in this example, each signer 16 operates on the same visible portion <i>V</i>, the visible portion <i>V</i> may alternatively vary as <i>V</i><sub>i</sub> for each signer 16. In this alternative, each intermediate component <i>h</i>' would be computed using the respective<!-- EPO <DP n="39"> --> visible portion <i>V</i><sub>i</sub> and the verifier 14 would perform each verification stage using the same respective visible portion <i>V</i><sub>i</sub>. The above example using the same visible portion <i>V</i> was provided for the sake of simplicity.</p><p id="p0167" num="0167">It can be seen that with the above semi-aggregate signature method, each additional signer 16, after the first signer 16 (e.g. Signing Station 1), at an 80 bit security level, each contributes approximately 160 bits of message expansion, which is the bit size of <i>n</i> and <i>s</i><sub>i</sub> at the security level of 80 bits. At 128 bits of security, the relatively marginal message expansion per signer would be approximately 256 bits. As such, the semi-aggregate signature method is particularly suitable for having multiple signing entities contribute to a signature thus enabling a verifier to ensure that, e.g., an RFID tag was handled by the expected participants in the supply chain. It will be appreciated that the semi-aggregate signature scheme provides similar advantages to any environment where storage or bandwidth or both are at a premium.</p><heading id="h0011"><b>Semi-Aggregate Signatures - Variations</b></heading><p id="p0168" num="0168">Variations on the above-described semi-aggregate method are possible. For example, each signer could add a small amount of redundancy at each signing stage. This could be done to ensure that the verification process, that typically requires some minimal amount of padding in the plaintext (e.g. 1 byte), does not need modification. This variation would be most suitable where the symmetric encryption scheme is able to use a plaintext of any byte length and does not make the ciphertext any longer than the plaintext.</p><p id="p0169" num="0169">Another variation is one where the intermediate plaintexts incorporate portions of the previous signer's "s" components. In this variation, the final signature would have the form (c<sub>T</sub>,s<sub>T</sub>) and the verifier 14 would recover c<sub>T-1</sub> and s<sub>T-1</sub> from c<sub>T</sub> and so on. Although this form of semi-aggregate signature has fewer components, it may not necessarily be shorter in length because the ciphertext c<sub>T</sub> is an encryption of c<sub>T-1</sub> and s<sub>T-1</sub> which itself is an encryption of c<sub>T-2</sub> and s<sub>T-2</sub> and so on. It can be expected that the length of c<sub>T</sub> be at least the length of <i>H</i> plus the sum of the lengths of s<sub>1</sub>, ..., s<sub>T</sub>, which is about the same length as the first form of semi-aggregate signature (c<sub>T</sub>,s<sub>1</sub>,...s<sub>T</sub>).</p><p id="p0170" num="0170">In another variation, the intermediate plaintexts are the previous "s" values, without including the previous ciphertexts. In this variation, the final signature has the form<!-- EPO <DP n="40"> --> (c<sub>1</sub>, ... , c<sub>T</sub>, s<sub>T</sub>), where a verifier would recover s<sub>T-1</sub> from c<sub>T</sub> and so on. Again, the signature length would be expected to be approximately the same as the first form (c<sub>1</sub>, s<sub>1</sub>, ..., s<sub>T</sub>).</p><p id="p0171" num="0171">To further illustrate this variation on the semi-aggregate signature scheme, the following example is provided for three signers, making reference to <figref idrefs="f0020">Figures 21</figref> and <figref idrefs="f0021">22</figref>. The following example is also particularly applicable to a pharmaceutical supply chain having three signing stations 16 in the supply chain 22 that each contribute to the signature added to an RFID tag 20 affixed to an object 18 (see also <figref idrefs="f0001">Figure 1</figref>).</p><p id="p0172" num="0172">Similar to <figref idrefs="f0018">Figure 19</figref>, as shown in <figref idrefs="f0020">Figure 21</figref>, Signing Station 1 generates an ephemeral key pair (<i>k</i><sub>1</sub>, Q<sub>1</sub>) and computes encryption key <i>X</i><sub>1</sub> = KDF(Q<sub>1</sub>). A first signature component c<sub>1</sub> is then computed using the recoverable part <i>H</i> of the message <i>M</i>, while ensuring sufficient redundancy in <i>H</i> exists for later verification. Using the visible portion <i>V</i> of the message <i>M</i>, an intermediate component <i>h</i><sub>1</sub> is then computed using a hash function (e.g. SHA1), <i>h</i><sub>1</sub> then converted to an integer <i>e</i><sub>1</sub>, which is then used along with the private key w<sub>1</sub> of Signing Station 1 and the key k<sub>1</sub> to generate the second signature component s<sub>1</sub>. In this example, the signature having components (c<sub>1</sub>, s<sub>1</sub>) is then written to the RFID tag 20.</p><p id="p0173" num="0173">As before, Signing Station 2, then contributes to the semi-aggregate signature by generating ephemeral key pair (k<sub>2</sub>, Q<sub>2</sub>) and computing <i>X</i><sub>2</sub> = KDF(Q<sub>2</sub>). However, in this variation, Signing Station 2 encrypts existing signature component s<sub>1</sub> using <i>X</i><sub>2</sub> to generate signature component c<sub>2</sub>. Intermediate signature component <i>h<sub>2</sub></i>, integer <i>e</i><sub>2</sub>, and signature component s<sub>2</sub> are computed as usual, however, the resultant updated signature comprises (c<sub>1</sub>,c<sub>2</sub>,s<sub>2</sub>). As such, signature component s<sub>1</sub> is encrypted in c<sub>2</sub> and the "c" components (i.e. c<sub>1</sub>, c<sub>2</sub> at this stage) are kept available directly from the signature.</p><p id="p0174" num="0174">As before, Signing Station 3 then also contributes to the semi-aggregate signature, by creating a resultant updated signature (c<sub>1</sub>,c<sub>2</sub>,c<sub>3</sub>,s<sub>3</sub>) as shown in <figref idrefs="f0020">Figure 21</figref>. It can be seen that, similar to the above, Signing Station 3 updates the signature by encrypting the previous "s" component in generating the next "c" component and each "c" component contribution is kept in the signature as it is updated.</p><p id="p0175" num="0175">Therefore, at each stage in this variation, the new signature that embeds the "s" component of the previous signer 16, is written over the previous form of the semi-aggregate<!-- EPO <DP n="41"> --> signature. Therefore, the semi-aggregate signature (c<sub>1</sub>,...c<sub>T</sub>, s<sub>T</sub>) is smaller than writing individual signatures ((c<sub>1</sub>,s<sub>1</sub>),...,(c<sub>T</sub>,s<sub>T</sub>)) to the RFID tag 20.</p><p id="p0176" num="0176">Referring now to <figref idrefs="f0021">Figure 22</figref>, verification of the semi-aggregate signature includes a stage for each signing stage as before and, in this example, the RFID tag 20 includes a signature having components (c<sub>1</sub>,c<sub>2</sub>,c<sub>3</sub>,s<sub>3</sub>) and the visible portion <i>V</i> of the message <i>M</i> (e.g. UID).</p><p id="p0177" num="0177">In stage 1, the verifier 14 computes <i>h</i><sub>3</sub>' using component c<sub>3</sub> and the visible portion <i>V</i>, converts <i>h</i><sub>3</sub>' to an integer <i>e</i><sub>3</sub>', computes Q<sub>3</sub>' using s<sub>3</sub>, <i>e<sub>3</sub></i>' and the public key W<sub>3</sub> of Signing Station 3, and then generates <i>X</i><sub>3</sub>' by applying the same KDF to Q<sub>3</sub>'. The verifier 14 then obtains s<sub>2</sub> by decrypting c<sub>3</sub> using <i>X</i><sub>3</sub>' and a complementary decryption function, e.g. that denoted by "DEC" in <figref idrefs="f0021">Figure 22</figref>.</p><p id="p0178" num="0178">Now that the verifier has obtained s<sub>2</sub>, in stage 2, the verifier computes <i>h</i><sub>2</sub>' using component c<sub>2</sub> and the visible portion <i>V</i>, converts <i>h</i><sub>2</sub>' to an integer e<sub>2</sub>', computes Q<sub>2</sub>' using s<sub>2</sub>, <i>e<sub>2</sub>'</i> and the public key W<sub>2</sub> of Signing Station 2, and then generates <i>X</i><sub>2</sub>' by applying the same KDF to Q<sub>2</sub>'. The verifier then obtains s<sub>1</sub> by decrypting c<sub>2</sub> using <i>X</i><sub>2</sub>' and a complementary decryption function.</p><p id="p0179" num="0179">In stage 3, the verifier computes <i>h</i><sub>1</sub>' using component c<sub>1</sub> and the visible portion <i>V</i>, converts <i>h</i><sub>1</sub>' to an integer <i>e</i><sub>1</sub>', computes Q<sub>1</sub>' using s<sub>1</sub> (which was recovered in stage 2), <i>e</i><sub>1</sub>' and the public key W<sub>1</sub> of Signing Station 1, and then generates <i>X</i><sub>1</sub>' by applying the same KDF to Q<sub>1</sub>'. It can be seen that in this variation, <i>X</i><sub>1</sub>' can only be recovered by having previously recovered s<sub>1</sub>. Since c<sub>1</sub> was, as before, generated by encrypting the recoverable portion of the message <i>H</i>, a bit string <i>H</i>', which is a representation of <i>H</i> is then obtained by decrypting c<sub>1</sub> using <i>X</i><sub>1</sub>'. At stage 4, the verifier 14 then checks for the expected characteristic such as the redundancy of <i>H'</i> in this example and, if sufficient, accepts <i>H</i>' as the recoverable portion <i>H</i> and can reconstruct the message <i>M</i>, e.g. by combining <i>H</i>' and <i>V</i> at stage 5. The verifier 14 may then conclude that each signer signed the message <i>M</i>.</p><p id="p0180" num="0180">It may also be possible that the recoverable message part <i>H</i> is not the same for each signer 16. For example, suppose that the recoverable message part is <i>H</i><sub>j</sub> for each signer 16. In a non-aggregated case, there is an ECPVS signature (c<sub>j</sub>,s<sub>j</sub>) for each signer 16 for<!-- EPO <DP n="42"> --> message <i>H</i><sub>j</sub>, and the message <i>H</i><sub>j</sub> is encoded within <i>c</i><sub>j</sub>. If the signatures were aggregated, each of the messages would need to be encoded.</p><p id="p0181" num="0181">The first approach to semi-aggregate signatures can be modified by appending the distinct messages <i>H</i><sub>j</sub> to the intermediate plaintexts. Since the intermediate plaintexts were taken to be the previous intermediate ciphertext, the previous ciphertext can be concatenated (or other method of combining) to the current recoverable message part. A first plaintext PT<sub>1</sub> is H<sub>1</sub> with any necessary padding to make it sufficiently redundant, and the intermediate plaintexts can be computed as PT<sub>2</sub> = c<sub>1</sub> ∥H<sub>2</sub> and so on.</p><p id="p0182" num="0182">For example, Signing Station 3 would generate ephemeral key pair (k<sub>3</sub>, Q<sub>3</sub>) and compute <i>X</i><sub>3</sub> = KDF(Q<sub>3</sub>), compute <i>c</i><sub>3</sub> = <i>ENC<sub>X<sub2>3</sub2></sub></i> (<i>c</i><sub>2</sub> ∥<i>H</i><sub>3</sub>), and then compute <i>h</i><sub>3</sub> = HASH(c<sub>3</sub>∥ <i>V</i>), convert to <i>e</i><sub>3</sub>, and compute s<sub>3</sub> = <i>e</i><sub>3</sub>w<sub>3</sub> + k<sub>3</sub>(mod <i>n</i>). The final aggregate signature in this variation has the form (c<sub>T</sub>,s<sub>1</sub>, ...s<sub>T</sub>). However, the length of c<sub>T</sub> is at least the combined length of the distinct messages <i>H</i><sub>1</sub><i>, H<sub>2</sub>,</i> ..., <i>H</i><sub>T</sub>, instead of only the length of <i>H</i>. Although the signed message is longer, the message expansion would be the same because component c<sub>T</sub> is no longer than the total length of the recoverable message being signed. Alternatively stated, the message expansion mainly occurs due to the "s" components, which is true whether or not there are distinct recoverable portions <i>H</i><sub>j</sub> or a single recoverable portion <i>H</i>.</p><p id="p0183" num="0183">It will be appreciated that the other variants described above could also be implemented as semi-aggregate signature using distinct recoverable portions <i>H</i><sub>j</sub> as well as distinct visible portions <i>V</i><sub>j</sub>.</p><heading id="h0012"><b>Semi-Aggregate Signatures used with Implicit Certificates</b></heading><p id="p0184" num="0184">The semi-aggregate signature methods described above can also be used in conjunction with implicit certificates. For an implicit certificate having correspondents Alice and Bob, Alice receives from Bob or some directory, Bob's implicit certificate C<sub>B</sub>. From this single point, Alice computes Bob's public key as B = Hash(C<sub>B</sub>, I<sub>B</sub>) + Q<sub>CA</sub>, where I<sub>B</sub> is a string identifying Bob, a certifying authority (CA), and other pertinent information, such as a validity period, key usage etc.; and Q<sub>CA</sub> is the public key of the identified CA. Now Alice can use B as the implicitly certified public key of Bob. The implicit nature is due to the fact<!-- EPO <DP n="43"> --> that Alice can be sure that only Bob knows the private key associated with B, but she cannot be sure that Bob actually knows the private key. However, Alice soon expects Bob to use the private key and, as such, Alice would be able to detect this problem almost as soon as she needs to use B.</p><p id="p0185" num="0185">For semi-aggregate signatures, if Signer <i>j</i> has implicit certificate C<sub>Signer j</sub>, then the verifier 14 computes the public key of Signer <i>j</i> as Q<sub>Signer <i>j</i></sub> = Hash(C<sub>Signer <i>j</i></sub>, I<sub>Signer <i>j</i></sub>) + Q<sub>CA <i>j</i></sub>, where I<sub>Signer <i>j</i></sub> is the certificate information associated with Signer <i>j</i> and Q<sub>CA <i>j</i></sub> is the public key of the CA who issued implicit certificate C<sub>Signer <i>j</i></sub>.</p><p id="p0186" num="0186">For example, when the verifier 14 is recovering the plaintext that, say, Signing Station 2 signed using ECPVS, then the verifier 14 normally computes <i>h<sub>2</sub>'= HASH(c<sub>2</sub></i> ∥ <i>V),</i> converts to integer e<sub>2</sub>', and from that computes <i>Q<sub>2</sub>'=s<sub>2</sub>G-e<sub>2</sub>'W</i> and finally <i>X<sub>2</sub> = KDF</i>(<i>Q</i><sub>2</sub>'). Where there is implicit certificate C<sub>2</sub>, the computations may instead be performed as: <i>h<sub>2</sub>'= HASH(c<sub>2</sub></i> ∥<i>V</i>)<i>HASH</i>(<i>C</i><sub>2</sub>∥<i>I</i><sub>2</sub>)mod <i>n</i> and <i>X</i><sub>2</sub> <i>=s</i><sub>2</sub><i>G</i>+<i>e</i><sub>2</sub>'<i>C</i><sub>2</sub>+<i>Hash</i>(<i>c</i><sub>2</sub> ∥<i>V</i>)<i>Q<sub>CA2</sub></i> respectively.</p><p id="p0187" num="0187">Known methods such as Shamir's trick and Solinas' "Joint Sparse Form" etc. allow an increase in the speed of the single computation of X<sub>2</sub>, compared to computing Q<sub>2</sub> first from C<sub>2</sub>, and then X<sub>2</sub> with the former equation. It will be appreciated that if an explicit certificate has been used, the verifier 14 would need to verify an explicit signature of the CA computed upon public key Q<sub>2</sub>, which would have taken longer.</p><p id="p0188" num="0188">It can therefore be seen that several variations of semi-aggregate ECPVS signatures can be used. For pharmaceutical supply chains 22 exemplified above, manufacturers, wholesalers, distributors and shippers may each add their own ECPVS to an RFID tag 20 attached to a package 18. Because the space available for data on an RFID tag 20 is limited, semi-aggregate signatures are advantageous in such an application by allowing more signatures to be fit into the same limited space. When the package 18 arrives at a pharmacy, the aggregate signature can be verified so that the pharmacy can conclude that the delivery was handled by authorized parties during the entire course of the supply chain 22. It will be appreciated that the above principles equally apply to other systems and should not be limited to pharmaceutical environments or limited to use in authenticated RFID systems.<!-- EPO <DP n="44"> --></p><heading id="h0013"><b>Fully-Aggregate ECPVS Signatures</b></heading><p id="p0189" num="0189">In certain scenarios, where the co-operation of multiple signers can be achieved, a fully-aggregate ECPVS signature scheme can be used. In the following scheme, T signers cooperate to aggregate what would normally be T distinct ECPVS signatures into what is effectively a single ECPVS signature of all T signers.</p><p id="p0190" num="0190">In general, where Signing Station j has private key w<sub>j</sub> and public key W<sub>j</sub>, Signing Station j generates ephemeral key pair (kj, Q<sub>j</sub>) and then encryption key X<sub>j</sub> = KDF(Q<sub>j</sub>) as done in traditional ECPVS and explained in detail above. An aggregate encryption key is then computed as <i>X=X</i><sub>1</sub> +<i>X</i><sub>2</sub> +...+<i>X<sub>T</sub></i>.</p><p id="p0191" num="0191">As per the description above, the recoverable part H of message M is encrypted using the encryption key, in this case, the aggregate encryption key X to obtain a ciphertext <i>c</i> =<i>ENC<sub>X</sub></i> (<i>H</i>). If the recoverable part varies, then H is replaced by H<sub>j</sub> and <i>c</i> is replaced by <i>c</i><sub>j</sub>.</p><p id="p0192" num="0192">An intermediate component <i>h = HASH</i>(<i>c</i> ∥<i>V</i>) may then be computed from <i>c</i>, the intermediate component <i>h</i> converted to an integer <i>e</i>, and each Signing Station j then computes an "s" component, e.g. as: <i>s<sub>j</sub></i>= <i>ew<sub>j</sub></i> +<i>k<sub>j</sub></i>(mod<i>n</i>).</p><p id="p0193" num="0193">An aggregate s value is then computed as <i>s</i> =<i>s</i><sub>1</sub> +...+<i>s<sub>T</sub></i> and the aggregate signature is (<i>c</i>, <i>s</i>) where <i>c</i> encrypts <i>H</i>. If there are distinct recoverable message portions <i>H</i><sub>j</sub>, the aggregate signature would appear similar to the semi-aggregate signature, namely as (<i>c</i><sub>1</sub>,...,<i>c<sub>T</sub></i>,<i>s<sub>T</sub></i>). The latter aggregate signature is not as fully aggregate as the former signature since each ciphertext <i>c</i><sub>j</sub> may contribute some message expansion to provide redundancy, whereas in full aggregation, message expansion does not grow as the number of signers grows.</p><p id="p0194" num="0194">To overcome this, it may be noted that the typical way to pad a recoverable message <i>H</i><sub>j</sub> for use in ECPVS is to prepend the message <i>H</i><sub>j</sub> with a sufficiently long string <i>S</i> so that <i>H</i><sub>j</sub><i>'</i>=<i>S</i><sub>j</sub> ∥<i>H</i><sub>j</sub>. If the signers all use the same <i>S</i><sub>j</sub> so that <i>S</i><sub>j</sub> =<i>S</i>, then it may be the case that <i>c<sub>j</sub> = ENC<sub>X</sub></i> (<i>H<sub>j</sub></i>) =<i>ENC<sub>X</sub></i> (S ∥<i>H<sub>j</sub></i>) = <i>c</i> ∥<i>c</i><sub>j</sub> for some fixed signer-common string <i>c</i> and a signer-specific string <i>c</i><sub>j</sub>'. If the symmetric encryption has the properties of a stream cipher,<!-- EPO <DP n="45"> --> this may be likely. For symmetric encryption schemes such as AES in CBC mode, this will be true provided that S has a certain length that matches the block size of AES (which is typically 128 bits or 16 bytes). In this case, the aggregate signature may be represented more compactly as (<i>c</i>, <i>c</i><sub>1</sub>',..., <i>c<sub>T</sub></i>',<i>s</i>), and the only message expansion is (<i>c</i>,<i>s</i>), which, being the size of a single signed message, makes the approach fully aggregate.</p><p id="p0195" num="0195">It should be noted that when a stream cipher is used, wherever the messages have common parts, the ciphertexts also have common parts and, therefore, the common ciphertext portions may be sent just once to further reduce message expansion. As such, the commonality of the ciphertext portions can be exploited no matter where the commonality occurs, even if it is not at the beginning of the message. For messages with certain fixed formatting, this may occur, as well as for block ciphers applied in CTR mode (e.g. like a stream cipher) or in ECB mode (in 64 or 128 bit chunks).</p><p id="p0196" num="0196">Where there is a single visible portion <i>V</i>, for verification, the intermediate component can be computed as <i>h'</i>= <i>HASH</i>(<i>c</i> ∥ <i>V</i>), <i>h'</i> converted to integer e' as before, the ephemeral public key Q' computed as <i>Q'</i> = <i>sG</i> - <i>e'</i>(<i>W</i><sub>1</sub> +... + <i>W<sub>T</sub></i>), and from that the decryption key computed as X = KDF(Q'). It should be noted however that where there are distinct visible portions <i>V</i><sub>i</sub>, each intermediate component is computed as <i>h<sub>j</sub></i>' = <i>HASH</i>(<i>c</i> ∥<i>V<sub>j</sub></i>) and the ephemeral public key Q' computed as <i>Q</i>'= <i>sG</i> - (<i>e</i><sub>1</sub><i>'W</i><sub>1</sub> <i>+ ... + e<sub>T</sub>'W<sub>T</sub></i>). It should also be noted that if the recoverable portion <i>H</i> varies by signer 16, each occurrence of <i>c</i> is replaced by <i>c</i><sub>j</sub>.</p><p id="p0197" num="0197">Not only is the computation <i>Q'</i>= <i>sG</i> - <i>e'</i>(<i>W</i><sub>1</sub> +... + <i>W<sub>T</sub></i>) generally more efficiently computable, it will indicate that (<i>c</i>,<i>s</i>) is a valid ECPVS signature for public key <i>W</i><sub>1</sub> +<i>W</i><sub>2</sub>+...+<i>W<sub>T</sub></i>.</p><p id="p0198" num="0198">The verifier 14 may then obtain the plaintext <i>H</i>' by decrypting c using the decryption key X, which can be derived from the ephemeral key Q' using the same KDF. If H' has the necessary redundancy, then the message <i>M</i> can be reconstructed by, e.g. concatenating <i>H</i>' and <i>V</i> and the verifier 14 can then conclude that each signer signed the message.<!-- EPO <DP n="46"> --></p><p id="p0199" num="0199">Referring to <figref idrefs="f0022">Figures 23 and 24</figref>, an example with Signing Stations 1 through 3 is illustrated. It can be seen in <figref idrefs="f0022">Figure 23</figref> that each signer 16 contributes a component in computing X and each signer 16 uses the intermediate component h' to compute an "s" component that is contributed to the aggregate s used in the signature.</p><p id="p0200" num="0200">It can also be seen in <figref idrefs="f0022">Figure 24</figref> that the ephemeral public key is reconstructed using a combination of the public keys of the signers and a representation <i>H</i>' of the recoverable portion <i>H</i> is decrypted from <i>c</i> using the public key.</p><p id="p0201" num="0201">In the case where each signer 16 uses a distinct recoverable portions <i>H<sub>j</sub></i>, the step of recovering <i>H</i><sub>j</sub>' is replaced with <i>H</i><sub>j</sub>'= <i>DEC<sub>X</sub></i> (<i>c<sub>j</sub></i>).</p><p id="p0202" num="0202">It should be noted that the fully aggregated method requires the active participation of each signer 16. If a new signer 16 is to be added to the aggregate, then the previous signers will need to contribute new contributions <i>s</i><sub>j</sub> to the signature component s. This may be disadvantageous when compared to semi-aggregate ECPVS, where any new signer could add in an extra signature. As such, these considerations can be used to determine whether semi-aggregate or fully-aggregate signature are more appropriate for a given application.</p><p id="p0203" num="0203">For security reasons, it is preferable in aggregate ECPVS that signer <i>j</i> who obtains certificates for Q<sub>Signer j</sub>, provides a proof-of-possession (POP) of the private key to some CA (or failing that, to the verifier). Typically, POP for signing public keys is done by signing a certificate request sent to the CA. Verifiers can usually rely on a CA to obtain POP from the subject of each certificate as it issues.</p><p id="p0204" num="0204">Also, fully aggregated ECPVS signatures can work in conjunction with implicit certificates. For example, if Signer <i>j</i> has implicit certificate C<sub>Signer <i>j</i></sub>, then the verifier 14 can compute the public key of Signer <i>j</i> as W<sub>j</sub> = Hash(C<sub>Signer <i>j</i></sub>, I<sub>Signer <i>j</i></sub>)C<sub>Signer <i>j</i></sub> + Q<sub>CA <i>j</i></sub>, where I<sub>Signer <i>j</i></sub> is the certificate information associated with Signer <i>j</i> and Q<sub>CA <i>j</i></sub> is the public key of the CA who issued implicit certificate C<sub>Signer <i>j</i></sub>. As with semi-aggregate signatures, the computation of Q<sub>j</sub> can be substituted into the equations for computing X, which may offer better performance rather than computing Q<i><sub>j</sub></i> first and then X.<!-- EPO <DP n="47"> --></p><heading id="h0014"><b>Other Signature Schemes</b></heading><p id="p0205" num="0205">Other ElGamal type signatures can use the principles above with respect to ECPVS to apply the semi-aggregate and fully aggregate methods described above. Other signature schemes, such as ECDSA, have features that are sufficiently different warranting additional consideration.</p><heading id="h0015"><b>Aggregating ECDSA Signatures</b></heading><p id="p0206" num="0206">It may also be desirable to aggregate ECDSA signatures, for example in a pharmaceutical supply chain 22 where ECDSA is used for signing the RFID tags 20. Such an embodiment is shown in <figref idrefs="f0023">Figures 25 and 26</figref>.</p><p id="p0207" num="0207">Similar to the above, it is considered how T signers can cooperate to produce a fully aggregate signature that is valid if and only if the corresponding T ECDSA signatures would have been valid. Reference is made to the above-description of ECDSA.</p><p id="p0208" num="0208">Each signer chooses a random value <i>k<sub>j</sub></i> and computes a value <i>R<sub>j</sub></i> = <i>k<sub>j</sub>P</i>, which is sent to the other signers. The common value of R is computed as <i>R</i> = <i>R</i><sub>1</sub> +... + <i>R<sub>T</sub></i>. The corresponding <i>k</i> such that R=<i>k</i>P would thus be <i>k</i> = <i>k</i><sub>1</sub> +... + <i>k<sub>T</sub></i>. None of the individual signers knows the value k since signer <i>j</i> only knows its contribution <i>k<sub>j</sub></i> to the common key <i>k</i>. Similarly, <i>d</i> = <i>d</i><sub>1</sub> +... <i>+ d<sub>T</sub></i> represents a common private key of the signers, where none of the individual signers knows the whole value of <i>d</i>. The corresponding public key would thus be computed as the sum of the individual signers' public keys where <i>W</i>=<i>dP</i>=<i>d</i><sub>1</sub><i>P</i>+...+<i>d<sub>T</sub>P</i>=<i>W</i><sub>1</sub>+...+<i>W<sub>T</sub></i>.</p><p id="p0209" num="0209">The first signature component r is computed as <i>r</i>= <i>f</i>(<i>R</i>)<i>,</i> where <i>f</i> () is the function that is normally used in the particular implementation of ECDSA to convert the x-coordinate of a point to an integer, and reduces the integer modulo n (also see above definition of ECDSA).</p><p id="p0210" num="0210">Finally, the second signature component <i>s</i> can then be computed as <i>s</i> = <i>k</i><sup>-1</sup>(<i>H</i>(<i>m</i>)+<i>rd</i>)mod<i>n</i> and the signature can be computed as (<i>r</i>,<i>s</i>), which will be a valid ECDSA signature on message <i>M</i> under common public key <i>W</i> =<i>W</i><sub>1</sub> +... + <i>W<sub>T</sub></i>.<!-- EPO <DP n="48"> --></p><p id="p0211" num="0211">Verifying the aggregated ECDSA signature can be done by the verifier 14 first computing the common public key <i>W</i> =<i>W</i><sub>1</sub> +... + <i>W</i><sub>T</sub>, where <i>W<sub>j</sub></i> is the public key of Signing Station <i>j</i>; and then verifying (<i>r</i>,<i>s</i>) (e.g. by reading RFID tag 20) under common public key W.</p><p id="p0212" num="0212">The value s is computed from d and <i>k</i>, which are secret values that no individual signer 16 shown know as a whole. Similarly, no signer 16 should know any other signer's private keys. To preserve this level of security, the signers 16 can use one of the known methods for doing secure multiparty computation, which allows multiple entities to compute a value that is a function of the multiple individually held secrets, without any party revealing anything about it own secrets to the other parties. Known methods for secure multiparty computation are given in <nplcit id="ncit0001" npl-type="s"><text>Chaum et al., "Multi-party unconditionally secure protocols ", in Proc. of ACM STOC '88, 1988</text></nplcit>; and <nplcit id="ncit0002" npl-type="s"><text>Ben-Or et al., "Completeness theorems for non-cryptographic fault-tolerant distributed computation, in Proc. of ACM STOC '88, 1988, pp. 1-10</text></nplcit><i>.</i></p><p id="p0213" num="0213">It can therefore be seen that multiple signatures from multiple signers can be achieved using less message expansion. Both semi-aggregate and fully-aggregate signature schemes can be used and are particularly adaptable to ECPVS and ECDSA. Multiple signatures are particularly useful in applications where the amount of storage space for such signature is at a premium and multiple signatures enables signatures to be written at various stages in a process, such as an RFID tag 20 in a pharmaceutical supply chain 22.<!-- EPO <DP n="49"> --></p><heading id="h0016">Features</heading><p id="p0214" num="0214"><ol><li>1. A method for adding security to a radio frequency identification (RFID) tag comprising obtaining said RFID tag and signing said RFID tag using an elliptic curve (EC) cryptographic scheme.</li><li>2. The method according to claim 1 wherein said cryptographic scheme is an elliptic curve Pintsov-Vanstone (ECPV) signature scheme, said method comprising examining said RFID tag and padding a first portion of data to be hidden in a first signature component if said first portion of data has less than a predetermined amount of redundancy.</li><li>3. The method according to claim 2 wherein unused data blocks on said RFID tag are used to provide said padding.</li><li>4. The method according to claim 2 wherein said first data portion identifies a product type to which said RFID is attached and said padding is provided through inherent redundancy in another portion of data existing on said RFID tag.</li><li>5. The method according to claim 1 wherein said RFID tag is chosen to be large enough to accommodate a plurality of EC signatures.</li><li>6. The method according to claim 1 wherein said cryptographic scheme is an elliptic curve digital signature algorithm (ECDSA).</li><li>7. The method according to claim 6 wherein the message to be signed is a combination of a serial number for said RFID tag and an identification code.</li><li>8. A radio frequency identification (RFID) tag comprising an elliptic curve cryptographic signature.</li><li>9. The RFID tag according to claim 8 wherein said elliptic curve cryptographic signature is an ECPV signature, wherein a first portion of data to be hidden in a first signature<!-- EPO <DP n="50"> --> component is padded if said first portion of data has less than a predetermined amount of redundancy.</li><li>10. The RFID tag according to claim 9 wherein unused data blocks on said RFID tag are used to provide said padding.</li><li>11. The RFID tag according to claim 9 wherein said first data portion identifies a product type to which said RFID is attached and said padding is provided through inherent redundancy in another portion of data existing on said RFID tag.</li><li>12. The RFID tag according to claim 8 wherein said RFID tag is chosen to be large enough to accommodate a plurality of EC signatures.</li><li>13. The RFID tag according to claim 8 wherein said elliptic curve cryptographic signature is an ECDSA signature.</li><li>14. The RFID tag according to claim 13 wherein the message to be signed is a combination of a serial number for said RFID tag and an identification code.</li><li>15. The RFID tag according to claim 8, wherein a serial number for said tag is burned to said tag prior to said signing.</li><li>16. A method for signing an RFID tag comprising obtaining a first set of data to be written to said tag, said first set of data having information therein intended to be hidden from unauthorized RFID readers; incorporating said first set of data into a signature scheme with message recovery as a recoverable portion; and writing a signature to said tag using a private key having a corresponding verification key; wherein said first set of data can only be recovered by an authorized RFID reader having access to said verification key.</li><li>17. The method according to claim 16 wherein said first set of data is a product identifier.</li><li>18. The method according to claim 16 comprising controlling access to said verification key by distributing said verification key to a selected one or more authorized RFID readers.<!-- EPO <DP n="51"> --></li><li>19. The method according to claim 16 wherein said signature has a first component encrypting said first set of data and a second component generated using said private key and said first component, said method comprising generating an updated signature by encrypting said first component in a third component and generating a fourth component using said third component, said updated signature comprising said second, third and fourth components.</li><li>20. The method according to claim 16 comprising generating further updated signatures by encrypting a previous signature component in a next signature component and using said next signature component to generate another next signature component.</li><li>21. An RFID signing station comprising an RFID reader for reading RFID tags, and a cryptographic module for writing signatures to said RFID tags, said cryptographic module being configured for obtaining a first set of data to be written to said tag, said first set of data having information therein intended to be hidden from unauthorized RFID readers; incorporating said first set of data into a signature scheme with message recovery as a recoverable portion; and writing a signature to said tag using a private key having a corresponding verification key; wherein said first set of data can only be recovered by an authorized RFID reader having access to said verification key.</li><li>22. The signing station according to claim 21 wherein said first set of data is a product identifier.</li><li>23. A method for authenticating an RFID tag comprising obtaining said tag, said tag having thereon a signature with at least one component encrypting a first set of data therein, and having a second set of data, said second set of data being plaintext; obtaining a verification key; decrypting said at least one component using said verification key to obtain said first set of data; and examining said first set of data for a predetermined characteristic to verify said signature and thereby authenticate said tag.</li><li>24. The method according to claim 23 wherein said first set of data is a product identifier.<!-- EPO <DP n="52"> --></li><li>25. An RFID reader comprising a cryptographic module for verifying EC cryptographic signatures on an RFID tag, said cryptographic module being configured for obtaining said tag, said tag having thereon a signature with at least one component encrypting a first set of data therein, and having a second set of data, said second set of data being plaintext; obtaining a verification key; decrypting said at least one component using said verification key to obtain said first set of data; and examining said first set of data for a predetermined characteristic to verify said signature and thereby authenticate said tag.</li><li>26. The RFID reader according to claim 25 wherein said first set of data is a product identifier.</li><li>27. A method for managing verification keys for a plurality of RFID readers in an authenticated RFID system comprising determining a set of permissions indicative of which of one or more of said plurality of RFID readers have permission to authenticate one or more product types; for one or more of said plurality of readers, preparing a set of verification keys according to said set of permissions, each verification key being associated with a specific product type; and distributing each said set of verification keys to respective RFID readers.</li><li>28. The method according to claim 27 wherein said distributing is performed periodically such that dedicated connections to said RFID readers are not required.</li><li>29. The method according to claim 27 comprising receiving a key update request from one or more of said RFID readers, said determining a set of permissions comprising checking for new permissions.</li><li>30. The method according to claim 27 comprising receiving a registration request from a new RFID reader; and determining a new set of permissions for said new RFID reader.</li><li>31. The method according to claim 27 comprising receiving a certificate request associated with a new verification key; returning a certificate for said new verification key; determining which ones of said plurality of readers are entitled to said certificate; updating said permissions; and storing said certificate for future updates.<!-- EPO <DP n="53"> --></li><li>32. The method according to claim 27 comprising receiving a report indicative of the usage of said verification keys; and associating revenue with said usage.</li><li>33. The method according to claim 27 comprising receiving a report indicating a number of signatures written to corresponding RFID tags; and associating revenue with said number of signatures written.</li><li>34. The method according to claim 27 comprising performing said distributing according to receipt of a subscription payment.</li><li>35. A key management system for an authenticated RFID system having a plurality of RFID readers configured for determining a set of permissions indicative of which of one or more of said plurality of RFID readers has permission to read one or more product types having corresponding RFID tags; preparing a set of verification keys for each of said plurality of readers according to said permissions; and distributing said verification keys to said readers.</li><li>36. The key management system according to claim 35 comprising a certificate agent for issuing certificates for said verification keys, a certificate server, and a conditional access database for storing certificates associated with said verification keys.</li><li>37. The key management system according to claim 35 comprising at least one controller for monitoring signing of RFID tags and verification of RFID tags using said verification keys.</li><li>38. The key management system according to claim 35 wherein said distributing is performed a scheduled intervals such that dedicated connections to said RFID readers are not required.<!-- EPO <DP n="54"> --></li><li>39. The key management system according to claim 35 configured for receiving a key update request from one or more of said RFID readers, said determining a set of permissions comprising checking for new permissions.</li><li>40. The key management system according to claim 35 configured for receiving a registration request from a new RFID reader; and determining a new set of permissions for said new RFID reader.</li><li>41. The key management system according to claim 35 configured for receiving a certificate request associated with a new verification key; returning a certificate for said new verification key; determining which ones of said plurality of readers is entitled to said certificate; updating said permissions; and storing said certificate for future updates.</li><li>42. The key management system according to claim 3 5 configured for receiving a report indicative of the usage of said verification keys; and associating revenue with said usage.</li><li>43. The key management system according to claim 35 configured for receiving a report indicating a number of signatures written to corresponding RFID tags; and associating revenue with said number of signatures written.</li><li>44. The key management system according to claim 35 configured for performing said distributing according to receipt of a subscription payment.</li><li>45. A method for generating an aggregate digital signature comprising generating a first signature component by encrypting a first portion of data using a first encryption key; generating a first intermediate signature component from said first signature component and a second portion of data; generating a second signature component from said first intermediate signature component and a first private key; generating a third signature component by encrypting one of said first and second signature components using a second encryption key; generating a second intermediate signature component from said third signature component and said second portion of data; generating a fourth signature component from said second intermediate signature component and a second private key;<br/>
<!-- EPO <DP n="55"> -->and outputting the other of said first and second signature components and said third and fourth signature components as said digital signature.</li><li>46. The method according to claim 45 comprising generating said first and second encryption keys by applying a key derivation function to respective ephemeral public keys.</li><li>47. The method according to claim 45 wherein said first and second intermediate components are generated by hashing a combination of a respective signature component and said second portion of data.</li><li>48. The method according to claim 45 wherein said second and fourth signature components are generated using integer representations of respective intermediate components, respective long term private keys, and respective ephemeral private keys.</li><li>49. The method according to claim 45 wherein said first and second signature components are generated by a first signing entity to produce a first representation of said digital signature; and said third and fourth signature components are generated from said first representation by a second signing entity to produce a second representation of said digital signature.</li><li>50. The method according to claim 45 wherein said signature components are generated according to an ECPVS cryptographic scheme.</li><li>51. A method for verifying an aggregate digital signature comprising:
<ul><li>obtaining said digital signature, said digital signature having a first signature component encrypting at least one other signature component using respective encryption keys, a first of which encrypts a first portion of data, and having at least one secondary signature component, each being generated from either said first signature component or a respective one of said at least one other signature component and a respective private key;</li><li>generating a first decryption key using said first signature component and a second portion of data and decrypting said first signature component to obtain a recovered signature component;<!-- EPO <DP n="56"> --></li><li>using said recovered signature component to recover additional signature components corresponding to said at least one other signature component by generating one or more subsequent decryption keys;</li><li>recovering from said first of said at least one other signature components, a representation of said first portion of data; and</li><li>examining said representation of said first portion of data for a predetermined characteristic to verify said digital signature.</li></ul></li><li>52. The method according to claim 51 wherein said decryption keys are generated by computing respective intermediate values from said first signature component or said at least one other signature component and said second portion of data; converting said intermediate values to integer representations; using said integer representations and public data to generate respective ephemeral public keys; and generating said decryption keys from said ephemeral public keys.</li><li>53. The method according to claim 52 wherein said intermediate components are computed by hashing a respective signature component and said second portion of data.</li><li>54. The method according to claim 51 wherein said predetermined characteristic is redundancy.</li><li>55. The method according to claim 51 wherein said decryption keys are generated using a key derivation function.</li><li>56. The method according to claim 51 using an ECPVS verification scheme.</li><li>57. A method for generating an aggregate digital signature at a plurality of signing stages comprising generating an initial pair of signature components; encrypting one of said initial pair of components in a next set of signature components, said next set of signature components including the other of said initial pair of components and two new signature components; and for subsequent signing stages, encrypting a previous signature component that in turn encrypts another previous signature component and generating an<!-- EPO <DP n="57"> --> additional new signature component; wherein the number of signature components in said digital signature at each stage is one more than the total number of signing stages.</li><li>58. A computer readable medium comprising computer executable instructions for causing a cryptographic processor to execute the method according to any one of claims 45 to 57.</li><li>59. A cryptographic processor configured for generating an aggregate digital signature according to any one of claims 45 to 57.</li><li>60. A method for generating an aggregate digital signature comprising generating a first signature component using a first value derived from first individual values contributed by each of a plurality of signers; generating a second signature component using a second value derived from second individual values contributed by each said plurality of signers; and outputting said digital signature having said first and second signature components.</li><li>61. The method according to claim 60, said first signature component being computed by encrypting a first portion of data using said first value, said first value being an encryption key derived from individual encryption keys generated by each said plurality of signers; and said second signature component being computed by combining individual second components derived from said first signature component and a second portion of data.</li><li>62. The method according to claim 60 wherein said individual encryption keys are derived from respective ephemeral keys derived by said plurality of signers.</li><li>63. The method according to claim 60 wherein said individual second components are each derived from an intermediate signature component computed by hashing a combination of said first signature component and said second portion of data.</li><li>64. The method according to claim 60 wherein said individual second components are each derived from respective private values of said plurality of signers.<!-- EPO <DP n="58"> --></li><li>65. The method according to claim 60, said first signature component being computed as a function of said first value, said first value being a combination of said first individual values; and said second signature component being computed using said second value and said first signature component, wherein said second value is a combined private key computed by combining private values from each of said plurality of signers.</li><li>66. The method according to claim 65 wherein said first individual values are computed using respective ephemeral private keys generated by said plurality of signers.</li><li>67. The method according to claim 65 wherein said second signature is computed using a representation of a message being signed.</li><li>68. The method according to claim 67 wherein said representation is a hash of said message.</li><li>69. A method for verifying an aggregate digital signature comprising obtaining said digital signature having a first signature component generated using a first value derived from first individual values contributed by each of a plurality of signers and a second signature component generated using a second value derived from second individual values contributed by each said plurality of signers; combining individual public values of respective ones of said plurality of signers to generate a combined public key; and using said combined public key in at least one step in a signature verification process.</li><li>70. The method according to claim 69, said first signature component having been computed by encrypting a first portion of data using said first value, said first value being an encryption key derived from individual encryption keys generated by each said plurality of signers; and said second signature component having been computed by combining individual second components derived from said first signature component and a second portion of data.</li><li>71. The method according to claim 70 wherein said combined public key is used in generating a representation of an ephemeral public key for generating a decryption key for decrypting said first portion of data from said first signature component.<!-- EPO <DP n="59"> --></li><li>72. The method according to claim 71 wherein said representation of said ephemeral public key is computed using said second signature component and an integer representation of an intermediate signature component derived from said first signature component and said second portion of data.</li><li>73. The method according to claim 69, said first signature component having been computed as a function of said first value, said first value being a combination of said first individual values; and said second signature component having been computed using said second value and said first signature component, wherein said second value is a combined private key computed by combining private values from each of said plurality of signers.</li><li>74. The method according to claim 73 wherein said signature verification process is ECDSA.</li><li>75. A computer readable medium comprising computer executable instructions for causing a cryptographic processor to execute the method according to any one of claims 60 to 74.</li><li>76. A cryptographic processor configured for generating an aggregate digital signature according to any one of claims 60 to 74.</li></ol></p></description><claims mxw-id="PCLM56976540" lang="EN" load-source="patent-office"><!-- EPO <DP n="60"> --><claim id="c-en-0001" num="0001"><claim-text>A method for generating an aggregate digital signature, the method comprising:
<claim-text>receiving first and second signature components (c1 and s1);</claim-text>
<claim-text>generating a third signature (c2) component by encrypting said first signature component using a first encryption key (X2);</claim-text>
<claim-text>generating a first intermediate signature component (h2) from said third signature component and a second portion of data (V);</claim-text>
<claim-text>generating a fourth signature component (s2) from said first intermediate signature component and a first private key (w2);</claim-text>
<claim-text>and outputting said second signature component (s1) and said third (c2) and fourth (s2) signature components as said digital signature.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The method according to claim 1, comprising generating said first encryption key by applying a key derivation function to an ephemeral public key.</claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The method according to claim 1 or 2, wherein said first and second intermediate components is generated by hashing a combination of the third signature component and said second portion (V) of data.</claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>The method according any one of claims 1 to 3, wherein said fourth signature component is generated using integer representations of the first intermediate component, a long term private key, and an ephemeral private key.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>The method according to claim 1, wherein the first signature component (c1) is generated by encrypting a first portion of data (H) using a second encryption key (X1) and the second signature component (s1) is generated based on the first signature component, said second portion of data and a second private key (w1).</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>A method for verifying an aggregate digital signature (c2,s1,s2) using a visible data portion of a message (V), the signature including a final component (c2), the method comprising:<!-- EPO <DP n="61"> -->
<claim-text>generating a first decryption key (X2') using said final component (c2) and the visible data portion of a message (V) and decrypting said final component to obtain a recovered signature component (c1');</claim-text>
<claim-text>using the recovered signature component (c1') to recover a representation of a second portion of data (H); and</claim-text>
<claim-text>examining said representation of said second portion of data for a predetermined characteristic to verify said digital signature.</claim-text></claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>The method according to claim 6, wherein said decryption keys are generated by:
<claim-text>computing respective intermediate values from said first signature component or said at least one other signature component and said second portion of data;</claim-text>
<claim-text>converting said intermediate values to integer representations;</claim-text>
<claim-text>using said integer representations and public data to generate respective ephemeral public keys; and</claim-text>
<claim-text>generating said decryption keys from said ephemeral public keys.</claim-text></claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>The method according to claim 6 or 7 wherein said intermediate components are computed by hashing a respective signature component and said second portion of data.</claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>The method according to any one of claims 6 to 8 wherein said predetermined characteristic is redundancy.</claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>The method according to any one of claims 6 to 9 wherein said decryption keys are generated using a key derivation function.</claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>A method for generating an aggregate digital signature at a plurality of signing stages, said method comprising:
<claim-text>generating an initial pair of signature components;</claim-text>
<claim-text>encrypting one of said initial pair of components in a next set of signature components, said next set of signature components including the other of said initial pair of components and two new signature components; and<!-- EPO <DP n="62"> --></claim-text>
<claim-text>for subsequent signing stages, encrypting a previous signature component that in turn encrypts another previous signature component and generating an additional new signature component; wherein the number of signature components in said digital signature at each stage is one more than the total number of signing stages.</claim-text></claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>The method according to any one of claims 1 to 11, wherein said method is performed by a computing device in communication with a radio frequency identification (RFID) device, said RFID device configured to at least one of read and write an RFID tag.</claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>The method according to any one of claims 1 to 12, wherein said signature is an ECPVS signature.</claim-text></claim><claim id="c-en-0014" num="0014"><claim-text>A computer readable medium comprising computer executable instructions for causing a cryptographic processor to execute the method according to any one of claims 1 to 13.</claim-text></claim><claim id="c-en-0015" num="0015"><claim-text>A cryptographic processor configured for executing the method according to any one of claims 1 to 13.</claim-text></claim></claims><drawings mxw-id="PDW16667320" load-source="patent-office"><!-- EPO <DP n="63"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="165" he="217" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="64"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="164" he="172" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="65"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="164" he="156" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="66"> --><figure id="f0004" num="4,5"><img id="if0004" file="imgf0004.tif" wi="128" he="205" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="67"> --><figure id="f0005" num="6"><img id="if0005" file="imgf0005.tif" wi="165" he="162" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="68"> --><figure id="f0006" num="7"><img id="if0006" file="imgf0006.tif" wi="165" he="172" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="69"> --><figure id="f0007" num="8"><img id="if0007" file="imgf0007.tif" wi="165" he="145" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="70"> --><figure id="f0008" num="9"><img id="if0008" file="imgf0008.tif" wi="165" he="103" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="71"> --><figure id="f0009" num="10"><img id="if0009" file="imgf0009.tif" wi="165" he="185" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="72"> --><figure id="f0010" num="11"><img id="if0010" file="imgf0010.tif" wi="165" he="195" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="73"> --><figure id="f0011" num="12"><img id="if0011" file="imgf0011.tif" wi="132" he="148" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="74"> --><figure id="f0012" num="13"><img id="if0012" file="imgf0012.tif" wi="141" he="162" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="75"> --><figure id="f0013" num="14"><img id="if0013" file="imgf0013.tif" wi="141" he="163" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="76"> --><figure id="f0014" num="15"><img id="if0014" file="imgf0014.tif" wi="165" he="162" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="77"> --><figure id="f0015" num="16"><img id="if0015" file="imgf0015.tif" wi="163" he="148" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="78"> --><figure id="f0016" num="17"><img id="if0016" file="imgf0016.tif" wi="163" he="148" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="79"> --><figure id="f0017" num="18"><img id="if0017" file="imgf0017.tif" wi="157" he="172" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="80"> --><figure id="f0018" num="19"><img id="if0018" file="imgf0018.tif" wi="157" he="185" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="81"> --><figure id="f0019" num="20"><img id="if0019" file="imgf0019.tif" wi="160" he="205" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="82"> --><figure id="f0020" num="21"><img id="if0020" file="imgf0020.tif" wi="160" he="204" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="83"> --><figure id="f0021" num="22"><img id="if0021" file="imgf0021.tif" wi="160" he="209" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="84"> --><figure id="f0022" num="23,24"><img id="if0022" file="imgf0022.tif" wi="160" he="206" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="85"> --><figure id="f0023" num="25,26"><img id="if0023" file="imgf0023.tif" wi="160" he="201" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="158" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="157" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
