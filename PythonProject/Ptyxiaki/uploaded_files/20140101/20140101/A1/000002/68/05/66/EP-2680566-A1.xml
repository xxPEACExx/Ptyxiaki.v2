<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2680566-A1" country="EP" doc-number="2680566" kind="A1" date="20140101" family-id="48746287" file-reference-id="301918" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146549122" ucid="EP-2680566-A1"><document-id><country>EP</country><doc-number>2680566</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-13173725-A" is-representative="YES"><document-id mxw-id="PAPP154823045" load-source="docdb" format="epo"><country>EP</country><doc-number>13173725</doc-number><kind>A</kind><date>20130626</date><lang>EN</lang></document-id><document-id mxw-id="PAPP189754535" load-source="docdb" format="original"><country>EP</country><doc-number>13173725.6</doc-number><date>20130626</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140445757" ucid="JP-2012147511-A" load-source="docdb"><document-id format="epo"><country>JP</country><doc-number>2012147511</doc-number><kind>A</kind><date>20120629</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988099710" load-source="docdb">H04N   1/44        20060101AFI20131127BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1732713582" load-source="docdb" scheme="CPC">H04L   9/3263      20130101 LI20171116BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1732713583" load-source="docdb" scheme="CPC">H04L   9/0894      20130101 LI20171116BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2001300318" load-source="docdb" scheme="CPC">H04N   1/4413      20130101 LI20151110BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2001302480" load-source="docdb" scheme="CPC">H04N   1/4486      20130101 LI20151110BHEP        </classification-cpc><classification-cpc mxw-id="PCL1991316793" load-source="docdb" scheme="CPC">H04L   9/28        20130101 FI20131226BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132179850" lang="DE" load-source="patent-office">Bilddatenverarbeitungsvorrichtung und Bilddatenverarbeitungsprogramm</invention-title><invention-title mxw-id="PT132179851" lang="EN" load-source="patent-office">Image data processing device and image data processing program</invention-title><invention-title mxw-id="PT132179852" lang="FR" load-source="patent-office">Dispositif de traitement de données dýimage et programme de traitement de données dýimage</invention-title><citations><patent-citations><patcit mxw-id="PCIT242651889" load-source="docdb" ucid="EP-1187390-A1"><document-id format="epo"><country>EP</country><doc-number>1187390</doc-number><kind>A1</kind><date>20020313</date></document-id><sources><source name="SEA" category="Y" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT401566994" load-source="docdb" ucid="US-20080162941-A1"><document-id format="epo"><country>US</country><doc-number>20080162941</doc-number><kind>A1</kind><date>20080703</date></document-id><sources><source name="SEA" category="IY" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242651891" load-source="docdb" ucid="US-20080253573-A1"><document-id format="epo"><country>US</country><doc-number>20080253573</doc-number><kind>A1</kind><date>20081016</date></document-id><sources><source name="SEA" category="A" created-by-npl="N"/></sources></patcit></patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR918156664" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>OKI DATA KK</last-name><address><country>JP</country></address></addressbook></applicant><applicant mxw-id="PPAR918137897" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>OKI DATA CORPORATION</last-name></addressbook></applicant><applicant mxw-id="PPAR918980130" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Oki Data Corporation</last-name><iid>100191619</iid><address><street>11-22, Shibaura 4-Chome, Minato-ku</street><city>Tokyo 108-8551</city><country>JP</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918158076" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>SATO KIMITOSHI</last-name><address><country>JP</country></address></addressbook></inventor><inventor mxw-id="PPAR918143311" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>SATO, KIMITOSHI</last-name></addressbook></inventor><inventor mxw-id="PPAR918982359" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>SATO, KIMITOSHI</last-name><address><street>c/o Oki Data Corporation 11-22, Shibaura 4-chome, Minato-ku</street><city>TOKYO, 108-8551</city><country>JP</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918985399" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Betten &amp; Resch</last-name><iid>100060687</iid><address><street>Theatinerstrasse 8</street><city>80333 München</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS548835877" load-source="docdb">AL</country><country mxw-id="DS548801442" load-source="docdb">AT</country><country mxw-id="DS548835879" load-source="docdb">BE</country><country mxw-id="DS548844160" load-source="docdb">BG</country><country mxw-id="DS548842800" load-source="docdb">CH</country><country mxw-id="DS548847785" load-source="docdb">CY</country><country mxw-id="DS548801443" load-source="docdb">CZ</country><country mxw-id="DS548835880" load-source="docdb">DE</country><country mxw-id="DS548847786" load-source="docdb">DK</country><country mxw-id="DS548847787" load-source="docdb">EE</country><country mxw-id="DS548802264" load-source="docdb">ES</country><country mxw-id="DS548844161" load-source="docdb">FI</country><country mxw-id="DS548842801" load-source="docdb">FR</country><country mxw-id="DS548835881" load-source="docdb">GB</country><country mxw-id="DS548847788" load-source="docdb">GR</country><country mxw-id="DS548835882" load-source="docdb">HR</country><country mxw-id="DS548801444" load-source="docdb">HU</country><country mxw-id="DS548802265" load-source="docdb">IE</country><country mxw-id="DS548847789" load-source="docdb">IS</country><country mxw-id="DS548842802" load-source="docdb">IT</country><country mxw-id="DS548848118" load-source="docdb">LI</country><country mxw-id="DS548844162" load-source="docdb">LT</country><country mxw-id="DS548846151" load-source="docdb">LU</country><country mxw-id="DS548844163" load-source="docdb">LV</country><country mxw-id="DS548844164" load-source="docdb">MC</country><country mxw-id="DS548846152" load-source="docdb">MK</country><country mxw-id="DS548846153" load-source="docdb">MT</country><country mxw-id="DS548802270" load-source="docdb">NL</country><country mxw-id="DS548846128" load-source="docdb">NO</country><country mxw-id="DS548802271" load-source="docdb">PL</country><country mxw-id="DS548846426" load-source="docdb">PT</country><country mxw-id="DS548842803" load-source="docdb">RO</country><country mxw-id="DS548846427" load-source="docdb">RS</country><country mxw-id="DS548802272" load-source="docdb">SE</country><country mxw-id="DS548801445" load-source="docdb">SI</country><country mxw-id="DS548846129" load-source="docdb">SK</country><country mxw-id="DS548846134" load-source="docdb">SM</country><country mxw-id="DS548844165" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128669792" lang="EN" load-source="patent-office"><p id="pa01" num="0001">A user key storage unit stores at least one user key corresponding to usage authorities of image data. A first encryption unit encrypts the image data using a first encryption key. A second encryption key creation unit creates a second encryption key assigned to each usage authority. A key-storage data creation unit creates a key-storage data for each usage authority by encrypting the first encryption key and authority information using the second encryption key. A user-supplementary data creation unit creates user-supplementary data (an identifier of the user key and the second encryption key encrypted using the user key) for each user key. A device-supplementary data creation unit creates device-supplementary data (an identifier of the device key and the second encryption key encrypted using the device key) for at least one usage authority and for at least one device key. A data output unit outputs encrypted image data with the key-storage data, the user-supplementary data and the device-supplementary data.
<img id="iaf01" file="imgaf001.tif" wi="78" he="132" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128499165" lang="EN" source="EPO" load-source="docdb"><p>A user key storage unit stores at least one user key corresponding to usage authorities of image data. A first encryption unit encrypts the image data using a first encryption key. A second encryption key creation unit creates a second encryption key assigned to each usage authority. A key-storage data creation unit creates a key-storage data for each usage authority by encrypting the first encryption key and authority information using the second encryption key. A user-supplementary data creation unit creates user-supplementary data (an identifier of the user key and the second encryption key encrypted using the user key) for each user key. A device-supplementary data creation unit creates device-supplementary data (an identifier of the device key and the second encryption key encrypted using the device key) for at least one usage authority and for at least one device key. A data output unit outputs encrypted image data with the key-storage data, the user-supplementary data and the device-supplementary data.</p></abstract><description mxw-id="PDES63955222" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001">BACKGROUND OF THE INVENTION</heading><p id="p0001" num="0001">The present invention relates to an image data processing device such as an MFP (Multi Function Peripheral) and an image data processing program capable of processing, for example, encrypted PDF (Portable Document Format) files.</p><p id="p0002" num="0002">A general image data processing device such as an MFP is configured to obtain image data by reading (scanning) a document, and to convert the image data into an encrypted PDF file. Such an encrypted PDF can be attached to an electronic mail, stored in an external storage device connected to the MFP via an USB port, or transferred to a server connected to the MFP via network.</p><p id="p0003" num="0003">For example, Japanese Laid-open Patent Publication No. <patcit id="pcit0001" dnum="JP2005277736A"><text>2005 -277736</text></patcit> discloses a system that creates an encrypted PDF file by encrypting scanned image data.</p><p id="p0004" num="0004">In the conventional system, when the MFP (i.e., the image data processing device) creates the encrypted PDF file, the MFP needs to have a public key of a requester (who requests to create the encrypted PDF file).</p><p id="p0005" num="0005">For example, when the MFP decrypts the PDF file having been encrypted using the public key, the MFP needs to obtain a secret key (corresponding to the public key) from another device via network. Therefore, if a communication error occurs between the MFP and the device having the secret key, security may not be ensured.</p><p id="p0006" num="0006">Therefore, it is demanded to enhance security in processing encrypted data (for example, an encrypted PDF file).</p><heading id="h0002">SUMMARY OF THE INVENTION</heading><p id="p0007" num="0007">An aspect of the present invention is intended to provide an image data processing device and an image data processing program capable of enhancing security in processing encrypted data.<!-- EPO <DP n="2"> --></p><p id="p0008" num="0008">According to an aspect of the present invention, there is provided an image data processing device including an image data storage unit that stores image data, a user key storage unit that stores at least one user key corresponding to respective usage authorities of the image data, a first encryption unit that encrypts the image data stored in the image data storage unit using a first encryption key to create encrypted image data, a second encryption key creation unit that creates a second encryption key assigned to each of the usage authorities of the image data, and a key-storage data creation unit that creates a key-storage data for each of the usage authorities. The key-storage data is created by encrypting the first encryption key and authority information indicating the usage authority using the second encryption key assigned to the usage authority. The image data processing device further includes a user-supplementary data creation unit that creates user-supplementary data for each of the user keys stored in the user key storage unit. The user-supplementary data includes an identifier of the user key and encrypted data created by encrypting the second encryption key assigned to the usage authority corresponding to the user key using the user key. The image data processing device further includes a device-supplementary data creation unit that creates device-supplementary data for at least one of the usage authorities and for at least one device key of at least one image data processing device. The device-supplementary data includes an identifier of the device key and encrypted data created by encrypting the second encryption key assigned to the usage authority using the device key of the image data processing device. The image data processing device further includes a data output unit outputs the encrypted image data with supplementary data including the key-storage data, the user-supplementary data and the device-supplementary data for each of the usage authorities.</p><p id="p0009" num="0009">With such a configuration, it becomes possible to execute<!-- EPO <DP n="3"> --> decryption and output of encrypted image data more safely.</p><p id="p0010" num="0010">Further scope of applicability of the present invention will become apparent from the detailed description given hereinafter. However, it should be understood that the detailed description and specific embodiments, while indicating preferred embodiments of the invention, are given by way of illustration only, since various changes and modifications within the spirit and scope of the invention will become apparent to those skilled in the art from this detailed description.</p><heading id="h0003">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p0011" num="0011">In the attached drawings:
<ul><li><figref idrefs="f0001">FIG. 1</figref> is a perspective view showing an external configuration of an MFP according to the first embodiment of the present invention;</li><li><figref idrefs="f0002">FIG. 2</figref> is a function block diagram showing the MFP according to the first embodiment;</li><li><figref idrefs="f0003">FIG. 3</figref> is a flowchart showing an entire operation of the MFP according to the first embodiment;</li><li><figref idrefs="f0004">FIG. 4</figref> is a flowchart showing authentication processing according to the first embodiment;</li><li><figref idrefs="f0005">FIG. 5</figref> is an illustrative view showing an example of an authentication screen according to the first embodiment;</li><li><figref idrefs="f0005">FIG. 6</figref> is an illustrative view showing an example of a function selection screen according to the first embodiment;</li><li><figref idrefs="f0006">FIG. 7</figref> is a flowchart showing public key certificate selection processing according to the first embodiment;</li><li><figref idrefs="f0007">FIG. 8</figref> is an illustrative view showing an example of a public key certificate selection screen according to the first embodiment;</li><li><figref idrefs="f0007">FIG. 9</figref> is an illustrative view showing an example of an authority selection screen according to the first embodiment;</li><li><figref idrefs="f0008">FIG. 10</figref> is a flowchart showing image reading processing according to the first embodiment;<!-- EPO <DP n="4"> --></li><li><figref idrefs="f0009">FIG. 11</figref> is a flowchart showing data encryption processing according to the first embodiment;</li><li><figref idrefs="f0010">FIG. 12A</figref> is an illustrative view showing an example of a data structure of PKCS#7 data D20 according to the first embodiment;</li><li><figref idrefs="f0010">FIG. 12B</figref> is an illustrative view showing an example of a data structure of a completed encrypted PDF file according to the first embodiment;</li><li><figref idrefs="f0011">FIG. 13</figref> is a flowchart showing encrypted data display/ confirmation processing according to the first embodiment;</li><li><figref idrefs="f0011">FIG. 14</figref> is an illustrative view showing an example of a function execution confirmation screen according to the first embodiment;</li><li><figref idrefs="f0012">FIG. 15</figref> is a flowchart showing selected function executing processing of the first embodiment.</li><li><figref idrefs="f0013">FIG. 16</figref> is a flowchart showing an entire operation of an MFP according to the second embodiment;</li><li><figref idrefs="f0014">FIG. 17</figref> is a flowchart showing search processing for device -supplementary data according to the second embodiment;</li><li><figref idrefs="f0014">FIG. 18</figref> is a flowchart showing search processing for user-supplementary data of the second embodiment;</li><li><figref idrefs="f0015">FIG. 19</figref> is a flowchart showing authority confirmation processing according to the second embodiment;</li><li><figref idrefs="f0015">FIG. 20</figref> is a flowchart showing printing processing of the second embodiment, and</li><li><figref idrefs="f0016">FIG. 21</figref> is a function block diagram showing another example of the MFP according to the first and second embodiments.</li></ul></p><heading id="h0004">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENT</heading><p id="p0012" num="0012">Hereinafter, embodiments of the present invention will be described with reference to drawings. The drawings are provided for illustrative purpose and are not intended to limit the scope of the present invention.<!-- EPO <DP n="5"> --></p><heading id="h0005">FIRST EMBODIMENT.</heading><p id="p0013" num="0013">An image data processing device and an image data processing program according to the first embodiment of the present invention will be described with reference to drawings. In the first embodiment, an MFP (Multi Function Peripheral) will be described as an example of the image data processing device.</p><heading id="h0006">&lt;CONFIGURATION OF FIRST EMBODIMENT&gt;</heading><p id="p0014" num="0014"><figref idrefs="f0001">FIG. 1</figref> is a perspective view showing an external configuration of an MFP 600 according to the first embodiment. <figref idrefs="f0002">FIG. 2</figref> is a function block diagram of the MFP 600.</p><p id="p0015" num="0015">As shown in <figref idrefs="f0001">FIG. 1</figref>, the MFP 600 includes an automatic document feeder (hereinafter referred to as an ADF) 610, an image reader 620, an operation panel 160, an accessory function execution unit 90 and a printing medium housing unit 7. The operation panel 160 functions as an intermediary between a user (an operator) and the MFP 600 for exchanging information. The accessory function execution unit 90 includes modules for executing accessory functions such as an email creation function, a network communication function and a file output function.</p><p id="p0016" num="0016">As shown in <figref idrefs="f0002">FIG. 2</figref>, the MFP 600 further includes a printing unit 95. The printing unit 95 is controlled by a control unit 150 described below, and forms (i.e., prints) an image on a printing medium (such as a paper) fed from the printing medium housing unit 7. In this regard, the printing unit 95 functions as an "output unit".</p><p id="p0017" num="0017">The MFP 600 includes the control unit 150, a data converter 140, a data decryption unit 142, an image data storage unit 210, a public key storage unit 230, and an authentication information storage unit 250. These components (mainly executing data and signal processing) can be constructed by, for example, installing corresponding programs (including an image data processing program according to the first embodiment) into an information processing device having a processor or a memory. Even in such a case, a function block diagram can be illustrated as shown in <figref idrefs="f0002">FIG.<!-- EPO <DP n="6"> --> 2</figref>.</p><p id="p0018" num="0018">The operation panel 160 has an operation key 161 (<figref idrefs="f0001">FIG. 1</figref>) with which the user inputs necessary information (i.e., settings or the like) for operating the MFP 600. The operation panel 160 also has a function to present necessary information to the user by, for example, displaying information on a display 162 (<figref idrefs="f0001">FIG. 1</figref>). The MFP 600 causes the operation panel 160 (i.e., a touch panel) to present necessary information to the user. When inputting an instruction into or setting a set value of the MFP 600, the user touches the operation panel 160 or presses the operation key 161 based on an instruction displayed on the operation panel 160.</p><p id="p0019" num="0019">The ADF 610 includes a document feeding tray 611 (<figref idrefs="f0001">FIG. 1</figref>) in which documents (i.e., manuscripts) M are set. An ADF switch 615 is disposed on the medium feeding tray 611, and is configured to detect that the documents M are set in the medium feeding tray 611. When the user inputs an instruction to execute reading (scanning) to the MFP 600, the ADF 610 (<figref idrefs="f0001">FIG. 1</figref>) automatically feeds the documents M one by one to a predetermined reading position where the image reader 620 reads each document M.</p><p id="p0020" num="0020">The image reader 620 includes a light source that emits light toward the document M at the reading position, and a photoelectric conversion element that receives light reflected by the document M. The image reader 620 scans an image of the document M based on a size of the document M. The photoelectric conversion element converts received light into electric signal. After the image reader 620 completes reading the document M, the document M is ejected to a document ejection tray 612 (<figref idrefs="f0001">FIG. 1</figref>).</p><p id="p0021" num="0021">The image reader 620 reads the document M as described above, converts read data (i.e., the electric signal) into scan data (i.e., image data), and stores the scan data in the image data storage unit 210. When the image reader 620 completes reading the document M, the image reader 620 notifies the control unit 150 that the reading is completed.</p><p id="p0022" num="0022">The image reader 620 further includes the ADF switch 615<!-- EPO <DP n="7"> --> disposed on the medium feeding tray 611. When the ADF switch 615 detects that the documents M are set in the medium feeding tray 611, the ADF switch 615 notifies the control unit 150 that setting of the documents M is completed.</p><p id="p0023" num="0023">Next, the control unit 150 and components related to the control unit 150 will be described.</p><p id="p0024" num="0024">The control unit 150 includes a public key certificate selection unit 151, a public key certificate setting unit 152, a public key certificate registration unit 153, a temporally memory 240, and an authentication processor (i.e., authentication unit) 260. The control unit 150 entirely controls respective modules of the MFP 600.</p><p id="p0025" num="0025">The data converter 140 includes an encryption processor 141 configured to execute data conversion (i.e., encryption processing) based on an instruction of the control unit 150. More specifically, the data converter 140 reads image data from the image data storage unit 210 based on the instruction of the control unit 150, causes the encryption processor 141 to convert the image data into an encrypted PDF file using a public key notified by the control unit 150, and supplies the PDF file to the control unit 150.</p><p id="p0026" num="0026">In this regard, the data converter 140 functions as a "first encryption unit", a "second encryption key creation unit", a "key-storage data creation unit", a "user-supplementary data creation unit", a "device-supplementary data creation unit" and a "data output unit".</p><p id="p0027" num="0027">A data decryption unit 142 is configured to execute data decryption processing using a decryption processor 143 according to an instruction of the control unit 150. The data decryption unit 142 functions as a "first encryption key acquiring unit", a "second encryption key acquiring unit", and a "decryption unit".</p><p id="p0028" num="0028">The image data storage unit 210 is configured to store data created by the data converter 140 or the image reader 620.</p><p id="p0029" num="0029">The public key storage unit 230 is configured to store, for<!-- EPO <DP n="8"> --> example, public keys and public key certificates in association with user names. Further, the public key storage unit 230 provides the public key and the public key certificate based on an instruction of the control unit 150. In this embodiment, the public key storage unit 230 preliminarily stores the public keys and the public key certificates for respective user names. However, it is also possible that the public key storage unit 230 acquires the public keys and the public key certificates from an external device (for example, a certificate authority) via a network N as necessary. In this regard, the public key storage unit 230 functions as a "user key storage unit". The public keys for users are also referred to as "user keys".</p><p id="p0030" num="0030">The authentication information storage unit 250 is configured to store user IDs and passwords in association with each other. The authentication information storage unit 250 provides authentication information (for example, the passwords associated with the user names) based on an instruction of the control unit 150.</p><p id="p0031" num="0031">The public key certificate selection unit 151 is configured to inquire the user whether or not to execute encryption, and to receive a user's selection (for example, selection of a public key of a recipient) or the like, when converting the image data into the PDF file.</p><p id="p0032" num="0032">The public key certificate setting unit 152 is configured to acquire the public key certificate from the public key storage unit 230, and stores the acquired public key certificate in the temporary memory 240 according to a user's operation.</p><p id="p0033" num="0033">The temporary memory 240 is a memory configured to store intermediate processing results of the control unit 150.</p><p id="p0034" num="0034">The accessory function execution unit 90 includes modules for executing accessory functions. To be more specific, the accessory function execution unit 90 includes a FAX execution unit 91, a USB port 92, a network interface 93 and an email creation unit 94.<!-- EPO <DP n="9"> --></p><p id="p0035" num="0035">The FAX execution unit 91 is configured to establish a connection with a public telephone network PN, and transmit or receive facsimile upon request of the control unit 150.</p><p id="p0036" num="0036">The USB port 92 is an USB (Universal Serial Bus) interface provided for connection with a USB memory U (i.e., an external storage unit). The USB port 92 executes processing of data (for example, addition of a file) stored in the USB memory U based on an instruction of the control unit 150. In this regard, the USB memory U functions as an "encrypted image data storage unit".</p><p id="p0037" num="0037">The network interface 93 is an interface for connecting the MFP 600 and the network N. The network interface 93 establishes connection between the MFP 600 with a file server (not shown) on the network N based on an instruction of the control unit 150, and executes processing such as updating of data (file).</p><p id="p0038" num="0038">The email creation unit 94 creates an email addressed to a destination address as instructed, and sends the email with an attachment file (data) to, for example, an email server on the network N based on an instruction of the control unit 150.</p><p id="p0039" num="0039">In this regard, the control unit 150 functions as a "user-supplementary data detection unit", an "authority information acquiring unit", an "image output unit" and a "data output unit".</p><heading id="h0007">&lt;OPERATION OF FIRST EMBODIMENT&gt;</heading><p id="p0040" num="0040">An operation of the MFP 600 of the first embodiment having the above described configuration will be described.</p><p id="p0041" num="0041">Herein, an entire operation of the MFP 600 will be first described with reference to <figref idrefs="f0003">FIG. 3</figref>, and thereafter respective steps of the flowchart will be described.</p><p id="p0042" num="0042"><figref idrefs="f0003">FIG. 3</figref> is a flowchart showing the entire operation of the MFP 600 of the first embodiment. First, the authentication processor 260 of the control unit 150 executes an authentication processing (S100) according to a user's operation on the operation panel 160. When the authentication processing is successively completed, the control unit 150 prompts the user to select one of functions to be executed by the MFP 600.<!-- EPO <DP n="10"> --></p><p id="p0043" num="0043">When the user selects function (hereinafter referred to as user-selected function), the control unit 150 decides whether it is necessary to encrypt a PDF file in executing the user-selected function (S600).</p><p id="p0044" num="0044">When the control unit 150 decides that it is unnecessary to encrypt the PDF file in the user-selected function in the above described step S600, the control unit 150 causes the data converter 140 to read out image data (S700), and to convert the image data (in the form of a plain text) into the PDF file (S800).</p><p id="p0045" num="0045">In contrast, when the control unit 150 decides that it is necessary to encrypt the PDF file in the user-selected function in the above described step S600, the control unit 150 causes the public key certificate selection unit 151 to execute a public key certificate selection processing (S200). In this step, the public key certificate selection unit 151 stores a public key, a public key certificate and authentication information of a recipient in the temporary memory 240 in such a manner that the public key, the public key certificate and the authentication information are associated with each other. In this regard, a plurality of recipients can be designated in the public key certificate selection processing of the above described step S200.</p><p id="p0046" num="0046">Next, the control unit 150 causes the image reader 620 to execute an image reading processing (S300). The image reader 620 scans the document M to obtain image data, and stores the image data in the image data storage unit 210.</p><p id="p0047" num="0047">Then, the control unit 150 causes the data converter 140 to encrypt the image data (S400). The data converter 140 reads the image data from the image data storage unit 210, and creates an encrypted PDF file.</p><p id="p0048" num="0048">Next, the control unit 150 causes the operation panel 160 to display the encrypted image data so that the user can confirm contents of the encrypted image data (i.e., encrypted image display-and-confirmation processing). The control unit 150 prompts the user to choose whether or not to execute a processing<!-- EPO <DP n="11"> --> of the image data (S1000).</p><p id="p0049" num="0049">If the user chooses to execute the processing of the image data in the above described step S1000, the control unit 150 executes the processing of the image data (S500), and ends the processes.</p><p id="p0050" num="0050">In contrast, if the user does not choose to execute the processing of the image data in the above described step S1000, the control unit 150 deletes the created PDF file (S1100) without executing the processing of the image data, and ends the operation.</p><p id="p0051" num="0051">Next, the authentication processing in the above described step S100 (<figref idrefs="f0003">FIG. 3</figref>) will be described with reference to <figref idrefs="f0004">FIG. 4. FIG. 4</figref> is a flowchart showing the authentication processing of the first embodiment.</p><p id="p0052" num="0052">When the control unit 150 starts the authentication process, the control unit 150 causes the operation panel 160 to display an operation screen (i.e., an authentication screen) shown in <figref idrefs="f0005">FIG. 5</figref> (S101), and prompts the user to input a login name and a password (S102).</p><p id="p0053" num="0053"><figref idrefs="f0005">FIG. 5</figref> shows an example of the authentication screen. As shown in <figref idrefs="f0005">FIG. 5</figref>, the authentication screen includes a field F12 for inputting the login name, and a field F13 for inputting the password.</p><p id="p0054" num="0054">Referring back to <figref idrefs="f0004">FIG. 4</figref>, when the user inputs the login name and the password in the authentication screen, the authentication processor 260 execute processing to check consistency between the input login name and the input password (S103). To be more specific, the authentication processor 260 searches the authentication information storage unit 250 using the input login name as a search key to detect a password corresponding to the input login name. When the password corresponding to the input login name is detected, the authentication processor 260 compares the detected password and the input password. If both passwords coincide with each other,<!-- EPO <DP n="12"> --> the authentication processor 260 decides that the authentication is successful. If no password corresponding to the input login name is detected, or if both passwords do not coincide with each other, the authentication processor 260 decides that the authentication is unsuccessful.</p><p id="p0055" num="0055">Then, the control unit 150 checks whether the authentication by the authentication processor 260 is successful or not (S104). If the authentication is unsuccessful, the control unit 150 returns to the above described steps S101. If the authentication is successful, the control unit 150 causes the operation panel 160 to display a function selection screen as shown in <figref idrefs="f0005">FIG. 6</figref> (S105).</p><p id="p0056" num="0056">Further, the control unit 150 stores information of the function (i.e., user-selected function information) selected by the function selection screen (<figref idrefs="f0005">FIG. 6</figref>) in the temporary memory 240 (S106).</p><p id="p0057" num="0057">FTG. 6 shows an example of the function selection screen. As shown in <figref idrefs="f0005">FIG. 6</figref>, the function selection screen includes buttons B1, B2, B3 and B4 displayed on the operation panel 160. The buttons B1, B2, B3 and B4 are located at a left part of the function selection screen. The buttons B1, B2, B3 and B4 are vertically arranged, and respectively correspond to "COPY", "SCAN", "FAX" and "PRINT", i.e., four main functions of the MFP 600. <figref idrefs="f0005">FIG. 6</figref> shows a state where the button B2 (highlighted in <figref idrefs="f0005">FIG. 6</figref>) corresponding to a scanning function ("SCAN") is selected. Further, in a state where the button B2 is selected, buttons B21, B22, B23 and B24 are also displayed in the function selection screen. The buttons B21, B22, B23 and B24 respectively correspond to "Scan to Network", "Scan to Email", "Scan to USB", and "Scan to Fax", i.e., four sub-functions. Using the function selection screen, the user selects one of the main functions and one of the sub-functions. The control unit 150 stores information (i.e., information on the main function and the sub-function) indicating the user-selected function in the temporary<!-- EPO <DP n="13"> --> memory 240.</p><p id="p0058" num="0058">Next, the public key certificate selection processing in the above described step S200 (<figref idrefs="f0003">FIG. 3</figref>) will be described with reference to <figref idrefs="f0006">FIG. 7. FIG. 7</figref> is a flowchart showing the public key certificate selection processing of the first embodiment.</p><p id="p0059" num="0059">First, the public key certificate selection unit 151 of the control unit 150 acquires the information on the user-selected function from the temporary memory 240 (S201). The public key certificate selection unit 151 then decides whether it is necessary to convert the scanned image data into a PDF file (S202). If the public key certificate selection unit 151 decides that it is necessary to convert the scanned image data into the PDF file, the public key certificate selection unit 151 proceeds to step S203 described below. If the public key certificate selection unit 151 decides that it is unnecessary to convert the scanned image data into the PDF file, the public key certificate selection unit 151 ends the public key certificate selection processing.</p><p id="p0060" num="0060">For example, when the user-selected function is "Scan to Fax", the public key certificate selection unit 151 decides that it is unnecessary to convert the scanned image data into the PDF file. If the user-selected function is "Scan to USB", the public key certificate selection unit 151 decides that it is necessary to convert the scanned image data into the PDF file.</p><p id="p0061" num="0061">If the public key certificate selection unit 151 decides that it is necessary to convert the scanned image data into the PDF file in the above described step S202, the public key certificate selection unit 151 prompts the user to choose whether or not to execute a public key encryption processing (S203). For example, the public key certificate selection unit 151 causes the operation panel 160 to display a message "Do you want public key encryption processing to be executed?" and also display two buttons indicating "YES" and "NO" so that the user can choose whether or not to execute the public key encryption processing.<!-- EPO <DP n="14"> --> If the user does not choose to execute the public key encryption processing, the public key certificate selection unit 151 ends the public key certificate selection processing. If the user chooses to execute the public key encryption processing, the public key certificate selection unit 151 proceeds to steps S204 through S207 to execute the public key encryption processing as described below.</p><p id="p0062" num="0062">If the user chooses to execute the public key encryption processing in the above described step S203, the public key certificate selection unit 151 causes the operation panel 160 to display a public key certificate selection screen in <figref idrefs="f0007">FIG. 8</figref> (S204). Using the public key certificate selection screen, the public key certificate selection unit 151 prompts the user to select a public key certificate for use in encrypting the PDF file among public key certificates stored in the public key storage unit 230.</p><p id="p0063" num="0063"><figref idrefs="f0007">FIG. 8</figref> is an illustrative view showing an example of a public key certificate selection screen of the first embodiment. The public key certificate selection screen includes buttons BKA, BKB, BKC and BKD indicating respective identifiers of public key certificates KA, KB, KC and KD. The public key-storage portion 230 stores the public key certificates KA, KB, KC and KD. When the user selects one of the buttons BKA, BKB, BKC and BKD, the public key certificate selection unit 151 specifies the public key certificate and the public key corresponding to the selected button. That is, an owner of the public key certificate selected in the public key certificate selection screen is specified as a recipient of the PDF file.</p><p id="p0064" num="0064">Then, referring back to <figref idrefs="f0006">FIG. 7</figref>, the public key certificate selection unit 151 reads out the selected public key certificate and the public key from the public key certificate storage unit 230, and stores the public key certificate and the public key in the temporary memory 240 (S205),</p><p id="p0065" num="0065">Next, the public key certificate selection unit 151 causes<!-- EPO <DP n="15"> --> the operation panel 160 to display an authority selection screen shown in <figref idrefs="f0007">FIG. 9</figref>, and prompts the user to select a usage authority to use the PDF file (i.e., permission or prohibition of each of printing, changing and copying of the PDF file) corresponding to the stored public key certificate (S206).</p><p id="p0066" num="0066"><figref idrefs="f0007">FIG. 9</figref> shows an example of the authority selection screen of the first embodiment. The authority selection screen includes buttons B211 and B212 respectively indicating permission and prohibition of "printing" of the PDF file corresponding to the selected public key certificate. The authority selection screen further includes buttons B221 and B222 respectively indicating permission and prohibition of "changing" of said PDF file. The authority selection screen further includes buttons B231 and B232 respectively indicate permission and prohibition of "copying" of said PDF file. The authority selection screen (<figref idrefs="f0007">FIG. 9</figref>) enables the user to select a usage authority assigned to the owner of the selected public key certificate (i.e., the recipient of the encrypted PDF file). The public key certificate selection unit 151 holds the selected usage authority as "usage authority information". In this example, the usage authority information set by the MFP 600 includes three items (i.e., printing, changing and copying). However, the number and combination of the usage authority information of the items are not limited.</p><p id="p0067" num="0067">Then, referring back to <figref idrefs="f0006">FIG. 7</figref>, the public key certificate selection unit 151 stores the selected usage authority information in the temporary memory 240 (S207).</p><p id="p0068" num="0068">Next, the public key certificate selection unit 151 prompts the user to choose whether or not to add a public key certificate for use in encrypting the PDF file (S208). If the user chooses to add the public key certificate, the public key certificate selection unit 151 returns to the above described step S204 to display the public key certificate selection screen. If the user does not choose to add the public key certificate, the public key certificate selection unit 151 ends the public key certificate<!-- EPO <DP n="16"> --> selection processing.</p><p id="p0069" num="0069">Next, the image reading processing in the above described step S300 (<figref idrefs="f0003">FIG. 3</figref>) will be described with reference to <figref idrefs="f0008">FIG. 10. FIG. 10</figref> is a flowchart showing the image reading processing of the first embodiment.</p><p id="p0070" num="0070">When the user sets the documents M in the document feeding tray 611, the ADF switch 615 detects the setting of the documents M and outputs an ON signal (S301). When the user inputs an instruction to start reading (scanning) the documents M by, for example, pressing a "start" button on the operation panel 160, the operation panel 160 outputs an operation signal. When the control unit 150 receives the ON signal from the ADF switch 615 and the operation signal from the operation panel 160 (S302), the control unit 150 causes the image reader 620 to start scanning the documents M.</p><p id="p0071" num="0071">The image reader 620 scans each document M fed from the ADF tray 611 (S303), converts read data into image data, and stores the image data in the image data storage unit 210 (S304). When all the documents M are fed out of the ADF tray 611, the ADF switch 615 outputs an OFF signal (S305), and the image reader 620 notifies the control unit 150 that scanning is completed (S306).</p><p id="p0072" num="0072">Next, the data encryption processing in step S400 (<figref idrefs="f0003">FIG. 3</figref>) will be described with reference to <figref idrefs="f0009">FIG. 11. FIG. 11</figref> is a flowchart showing the data encryption processing of the first embodiment.</p><p id="p0073" num="0073">When the image reading processing of step S300 is completed (i.e., when the control unit 150 is notified of the completion of scanning) (S401), the control unit 150 creates a PDF encryption key K1 based on current date and current time, and stores the PDF encryption key K1 in the temporary memory 240 (S402). The PDF encryption key K1 is an encryption key of a common key encryption system, and is also used in decryption. An algorithm for creating the PDF encryption key K1 is not limited, and various algorithms may be used. In this regard, the PDF encryption key<!-- EPO <DP n="17"> --> K1 is also referred to as a "first encryption key".</p><p id="p0074" num="0074">Then, the control unit 150 reads the created PDF encryption key K1 from the temporary memory 240, and supplies the PDF encryption key K1 to the data converter 140 (more specifically, the encryption processor 141) (S403).</p><p id="p0075" num="0075">Next, the data converter 140 (more specifically, the encryption processor 141) reads out the image data that was stored in the image data storage unit 210 in the above described step S300 (S404).</p><p id="p0076" num="0076">Further, the data converter 140 creates an encrypted PDF file based on the obtained image data using the PDF encryption key K1 created in the above described step S402 (S405).</p><p id="p0077" num="0077">Then, the data converter 140 executes grouping the recipients (i.e., identifiers of the public key certificates of the recipients) based on kinds of usage authorities assigned to recipients (S406). The usage authorities assigned to respective recipients are hereinafter referred to as "recipient's authorities".</p><p id="p0078" num="0078">In this embodiment, three kinds of recipient's authorities (printing, changing and copying) are provided. That is, permission or prohibition is set for each of printing, changing and copying. Therefore, the data converter 140 groups the recipients into 9 groups. The data converter 140 executes processing in steps S407 through S415 (described below) for each of the groups which were grouped in the above described step S406.</p><p id="p0079" num="0079">The data converter 140 creates encryption keys K2 for respective recipients based on current date, current time and the recipient's authorities (S407). The encryption keys K2 are encryption keys of a common key encryption system, and art also used in decryption. The data converter 140 creates the encryption key K2 for each of the groups (which were grouped in step S406), An algorithm for creating the encryption keys K2 is not limited, and various algorithms may be used. In this regard, the encryption key K2 is also referred to as a second encryption<!-- EPO <DP n="18"> --> key".</p><p id="p0080" num="0080">Next, the data converter 140 selects one of the above described groups (i.e., one of the recipient's authorities), and synthesizes the PDF encryption key K1 and recipient's authority information I of the selected recipient's authority to obtain continuous data (i.e., a series of binary data). Further, the data converter 140 encrypts the synthesized data using the encryption key K2 (created for each recipient's authority in the above described step S407) to obtain key-storage data D1 (S408).</p><p id="p0081" num="0081">Then, the data converter 140 executes processing in steps S410 through S412 described below. First, the data converter 140 converts the encrypted data (created in the above described step S408 for each recipient's authority) into PKCS#7 format (Public Key Cryptography Standards No. 7) using the encryption processor 141. The resulting data (converted into PKCS#7 format) is hereinafter referred to as "PKCS#7 data D20". The PKCS#7 data D20 is also referred to as "supplementary data D20". The data converter 140 adds the PKCS#7 data D20 to the PDF file.</p><p id="p0082" num="0082">In this regard, PKCS is a standard for standardizing the public key encryption technology. PKCS#7 defines a format with which encrypted data or signed data is stored together with public key certificate. Details of PKCS#7 are described in "IETF RFC2315" and the like. Details of specifications for attaching PKCS#7 data to an encrypted PDF file are described in "PDF reference" (3.5.3 Public-Key Security Handlers) published by Adobe System Incorporated.</p><p id="p0083" num="0083">The data converter 140 creates the PKCS#7 data D20 for respective recipient' s authorities (i.e., for respective encrypted data formed in the above described step S408). Therefore, in this embodiment, at most 9 PKCS#7 data D20 are registered for one PDF file.</p><p id="p0084" num="0084">An example of the PKCS#7 data D20 will be described with reference to <figref idrefs="f0010">FIG. 12A. FIG. 12A</figref> is an illustrative view showing an example of a data structure of the PKCS#7 data D20.<!-- EPO <DP n="19"> --></p><p id="p0085" num="0085">The PKCS#7 data D20 shown in <figref idrefs="f0010">FIG. 12A</figref> includes the key-storage data D1 created in the above described step S408 for each recipient' authority. The key-storage data D1 is obtained by, for example, synthesizing the PDF encryption key K1 of 20 bytes and the recipient's authority information I of 4 bytes and encrypting the synthesized data using the encryption key K2 corresponding to the recipient's authority. The PKCS#7 data D20 created by the data converter 140 further includes user-supplementary data D2 (D2-1 through D2-N) for N recipients belonging to the same group of the recipient's authority. The user-supplementary data D2 (D2-1 through D2-N) respectively include data D21 (D21-1 through D21-N) and data D22 (D22-1 through D22-N). The data D21 (D21-1 through D21-N) indicate identifiers of the public key certificates of the recipients. The data D22 (D22-1 through D22-N) are obtained by encrypting the encryption key K2 corresponding to the recipient's authority using the public keys K3 (K3-1 through K3-N) of the recipients. When the recipient decrypts the encrypted PDF file, the recipient uses the data D21 (indicating the identifier of the public key certificate of the recipient) to find the data D22 encrypted by its own public key K3.</p><p id="p0086" num="0086">Then, referring back to <figref idrefs="f0009">FIG. 11</figref>, the data converter 140 executes processing in steps S410 through S412 (described below) to create user-supplementary data D2-1 through D2-N (to be added to the PKCS#7 data D20 of the selected recipient's authority) for respective N recipients.</p><p id="p0087" num="0087">First, the data converter 140 selects one of the recipients belonging to the group of the relevant recipient's authority, and encrypts the encryption key K2 corresponding to the recipient's authority using the public key K3 of the selected recipient to obtain the data D22 (S410).</p><p id="p0088" num="0088">Then, the data converter 140 creates the user-supplementary data D2 by associating the data D22 of the selected recipient and the data D21 indicating the identifier of the public key<!-- EPO <DP n="20"> --> certificate of the selected recipient. The data converter 140 adds the user-supplementary data D2 to the PKCS#7 data D20 of the recipient's authority (S411).</p><p id="p0089" num="0089">Next, the data converter 140 checks whether creation of the user-supplementary data for all of the recipients belonging to the recipient's authority is completed or not (S412). If the creation of the user-supplementary data for all of the recipients belonging to the recipient's authority is not completed, the data converter 140 returns to the above described step S410 (i.e., starts processing for the next recipient).</p><p id="p0090" num="0090">If the creation of the user-supplementary data for all of the recipients belonging to the recipient's authority is completed, the data converter 140 creates data D32 by encrypting the encryption key K2 for the recipient's authority using a device public key K5 of the MFP 600 (step S413). The device public key k5 is also referred to as a "device key".</p><p id="p0091" num="0091">Then, the data converter 140 creates device-supplementary data D3 by associating the created data D32 and data D31 indicating an identifier of the public key certificate of the device public key K5. Further, the data converter 140 adds the device-supplementary data D3 to the PKCS#7 data D20 of the recipient's authority (S414).</p><p id="p0092" num="0092">Next, the data converter 140 executes processing to add the created PKCS#7 data D20 of the recipient's authority to the encrypted PDF file (S415).</p><p id="p0093" num="0093">Further, the data converter 140 checks whether creation of the PKCS#7 data D20 for all recipient's authorities is completed (S416). If there is any recipient's authority for which creation of the PKCS#7 data D20 is not completed, the data converter 140 returns to the above described step S407 (i.e., starts processing for the next recipient's authority). If the creation of the PKCS#7 data D20 for all recipient's authorities is completed, the data converter 140 supplies the completed encrypted PDF file to the control unit 150 (S417), and ends the data encryption<!-- EPO <DP n="21"> --> processing.</p><p id="p0094" num="0094"><figref idrefs="f0010">FIG. 12B</figref> is an illustrative view showing an example of a data structure of the completed encrypted PDF file. The encrypted PDF file (i.e., referred to data D100) created by the data converter 140 includes encrypted image data (i.e., encrypted PDF data) D10 and supplementary data D20 including M PKCS#7 data D20-1 through D20-M. In this regard, "M" is the number of the groups (i.e., the recipient's authorities).</p><p id="p0095" num="0095">Next, the encrypted data display-and-confirmation processing executed by the control unit 150 in the above described step S900 (<figref idrefs="f0003">FIG. 3</figref>) will be described with reference to <figref idrefs="f0011">FIG. 13. FIG. 13</figref> is a flowchart showing the encrypted data display-and-confirmation processing of the first embodiment.</p><p id="p0096" num="0096">First, the control unit 150 supplies the completed encrypted PDF file and a device secret key K6 corresponding to the device public key K5 of the MFP 600 to the data decryption unit 142, and causes the data decryption unit 142 to decrypt the encrypted PDF file using the device secret key K6 (S901).</p><p id="p0097" num="0097">In this regard, the encrypted PDF file includes the device-supplementary data D3 (including the data D32 obtained by encrypting the encryption key K2 using the device public key K5) which was added in the above described step S414 (<figref idrefs="f0009">FIG. 11</figref>). Therefore, the control unit 150 can decrypt the encrypted PDF file using the device secret key K6.</p><p id="p0098" num="0098">Then, the control unit 150 causes the operation panel 160 to display a function execution confirmation screen including an image of the PDF file obtained by decrypting the encrypted PDF file and buttons for selecting whether or not to execute functions as shown in <figref idrefs="f0011">FIG. 14</figref> (S902). Using the function execution confirmation screen, the control unit 150 receives a user's confirmation on whether or not to execute each function (S903).</p><p id="p0099" num="0099"><figref idrefs="f0011">FIG. 14</figref> shows an example of the function execution confirmation screen of the first embodiment. The function<!-- EPO <DP n="22"> --> execution confirmation screen includes a field F2 for displaying the image of the encrypted PDF file, a button B241 for confirming execution of the function (selected among the buttons B1 through B4), a button B242 for discarding the PDF file without executing the function, and a button B243 for displaying the next page of the PDF file in the field F2. When the user selects (touches) the button B241, the control unit 150 obtains the user's confirmation to execute the function, and proceeds to step S500 to start selected function executing processing described below.</p><p id="p0100" num="0100">Next, the selected function executing processing executed by the control unit 150 in the above described step S500 (<figref idrefs="f0003">FIG. 3</figref>) will be described with reference to <figref idrefs="f0012">FIG. 15. FIG. 15</figref> is a flowchart showing the selected function executing processing of the first embodiment.</p><p id="p0101" num="0101">When the control unit 150 proceeds to step S500 and starts the selected function executing processing, the control unit 150 obtains the encrypted PDF file (S501), and obtains the user-selected function information from the temporary memory 240 (S502). Further, the control unit 150 transfers the encrypted PDF file to one of the function modules (i.e., the FAX execution unit 91, the USB port 92, the network interface 93 and the email creation unit 94) of the accessory function execution unit 90 corresponding to the user-selected function information (S503).</p><p id="p0102" num="0102">For example, when the function "Scan to USB" is selected as the user-selected function information, the control unit 150 transfers the data of the encrypted PDF file to the USB port 92.</p><p id="p0103" num="0103">The respective modules of the accessory function execution unit 90 that receive the encrypted PDF file execute the functions of the respective modules (S504). For example, when the function "Scan to USB" is selected as the user-selected function information, the control unit 150 stores the encrypted PDF file in a predetermined directory (for example, a root directory) of the USE memory (i.e., the external storage unit) U via the USP port 92.<!-- EPO <DP n="23"> --></p><p id="p0104" num="0104">Then, the control unit 150 initializes the temporary memory 240 (S505), and ends the selected function executing processing.</p><heading id="h0008">&lt;ADVANTAGES OF FIRST EMBODIMENT&gt;</heading><p id="p0105" num="0105">The first embodiment of the present invention provides the following advantages.</p><p id="p0106" num="0106">When the MFP 600 of the first embodiment creates the encrypted PDF file, the MFP 600 adds the supplementary data 20 including the key-storage data D1 and the device-supplementary data D3 to the encrypted PDF file. The encrypted PDF file can be decrypted using the PDF encryption key K1.</p><p id="p0107" num="0107">The encrypted PDF file created by the MFP 600 of the first embodiment is encrypted according to specifications (PKCS#7 or the like) used in general PDF format. The recipient who receives the encrypted PDF file can execute processing using a conventional PDF viewer or an editing tool within a given authority. Therefore, the encrypted PDF file which is not decryptable without using the secret key corresponding to the public key can be created without registering the secret key (of a creator of the encrypted PDF file) to the MFP 600. Accordingly, the MFP 600 of the first embodiment can create the encrypted PDF file more safely.</p><heading id="h0009">SECOND EMBODIMENT.</heading><p id="p0108" num="0108">An image data processing device and an image data processing program of the second embodiment of the present invention will be described. In the second embodiment, the MFP will be described as an example of the image data processing device.</p><heading id="h0010">&lt;CONFIGURAITON OF SECOND EMBODIMENT&gt;</heading><p id="p0109" num="0109">The image data processing device (i.e., the MFP) of the second embodiment has a functional configuration described in the first embodiment with reference to <figref idrefs="f0001">FIGS. 1</figref> and <figref idrefs="f0002">2</figref>.</p><p id="p0110" num="0110">The description of the second embodiment will be mainly focused on differences from the first embodiment. The second<!-- EPO <DP n="24"> --> embodiment is different from the first embodiment in that, when the MFP 600 of the second embodiment acquires the encrypted PDF file (having a structure shown in <figref idrefs="f0010">FIGS. 12A and 12B</figref>) created by itself from the USB memory U, the MFP 600 can execute processing of the encrypted PDF file according to the authority assigned to a user who is operating the MFP 600. Details of processing executed by the MFP 600 of the second embodiment will be described in a description of an operation.</p><heading id="h0011">&lt;OPERATION OF SECOND EMBODIMENT&gt;</heading><p id="p0111" num="0111">An operation of the MFP 600 of the second embodiment will be described. An entire operation of the MFP 600 will be described with reference to <figref idrefs="f0013">FIG. 16</figref>, and thereafter respective steps of the flowchart will be described.</p><p id="p0112" num="0112"><figref idrefs="f0013">FIG. 16</figref> is a flowchart showing the entire operation of the MFP 600 of the second embodiment. First, the authentication processor 260 of the control unit 150 executes an authentication processing (S2100) according to the user's operation on the operation panel 160. The authentication processing (S2100) is executed as described in the first embodiment with reference to <figref idrefs="f0004">FIG. 4</figref>. It is herein assumed that the authentication processor 260 receives the user ID and the password, and the authentication is successful (steps S101 through S104 in <figref idrefs="f0004">FIG. 4</figref>). Further, it is herein assumed that the user selects "Print" function in the function selection screen (step S105 in <figref idrefs="f0004">FIG. 4</figref>).</p><p id="p0113" num="0113">Then, the control unit 150 searches the public key storage unit 230 to find (detect) a public key certificate assigned to a logging-in user (referred to as an "authenticatee") (S3200). The control unit 150 checks whether the public key certificate of the authenticatee is detected in the public key-storage portion 230 (S2200). If the public key certificate of the authenticatee is detected, the control unit 150 proceeds to step S2300 described below. If the public key certificate of the authenticatee is not detected, the control unit 150 causes the operation panel 160 to display the message indicating that printing is disabled (S3100),<!-- EPO <DP n="25"> --> and ends the processing.</p><p id="p0114" num="0114">If the public key certificate of the authenticatee is detected in the above described step S2200, the control unit 150 executes processing to select a file to be printed (S2300). In this process, it is possible to cause the operation panel 160 to display file names of the encrypted PDF files stored in the USB memory U connected to the USB port 92 (for example, in the form of a list as shown in <figref idrefs="f0007">FIG. 8</figref>) so that the user can select any of the encrypted PDF files. When the user selects any of the encrypted PDF files, the control unit 150 obtains the data of the encrypted PDF file, and stores the data in the temporary memory 240.</p><p id="p0115" num="0115">Then, the control unit 150 searches the data attached to the encrypted PDF file stored in the temporary memory 240 to detect the device-supplementary data D3 corresponding to the MFP 600 (S2400).</p><p id="p0116" num="0116">The search processing for the device-supplementary data D3 in the above described step S2400 will be described with reference to <figref idrefs="f0014">FIG. 17. FIG. 17</figref> is a flowchart showing the search processing for the device-supplementary data D3 of the second embodiment. The control unit 150 searches the data attached to the encrypted PDF file stored in the temporary memory 240, and checks whether the device-supplementary data D3 corresponding to the MFP 600 is included in the first detected PKCS#7 data D20 (S2401). If the device-supplementary data D3 corresponding to the MFP 600 is detected, the control unit 150 proceeds to step S2500 (<figref idrefs="f0013">FIG. 16</figref>). If the device-supplementary data D3 corresponding to the MFP 600 is not detected, the control unit 150 proceeds to the above described step S3100 (i.e., displaying the message indicating that printing is disabled), and ends the processing.</p><p id="p0117" num="0117">In this regard, there are cases where a plurality of PKCS#7 data D20 are included in the data attached to the encrypted PDF file. In this example, the control unit 150 searches the first<!-- EPO <DP n="26"> --> detected PKCS#7 data D20 to detect the device-supplementary data D3 corresponding to the MFP 600. Since all of the PKCS#7 data D20 include the device-supplementary data D3 as described in the first embodiment, it is only necessary to search only one PKCS#7 data D20.</p><p id="p0118" num="0118">Referring back to <figref idrefs="f0013">FIG. 16</figref>, when the device-supplementary data D3 corresponding to the MFP 600 is detected, the control unit 150 searches the encrypted PDF file to detect the user-supplementary data D2 corresponding to the authenticatee (S2600). If the user-supplementary data D2 for the authenticatee is detected, the control unit 150 proceeds to step S2800 described below. If the user-supplementary data D2 for the authenticatee is not detected, the control unit 150 proceeds to the above described step S3100 (i.e., displaying the message indicating that printing is disabled), and ends the processing.</p><p id="p0119" num="0119">The search processing for the user-supplementary data D2 in the step S2600 will be described with reference to <figref idrefs="f0014">FIG. 18</figref>.</p><p id="p0120" num="0120"><figref idrefs="f0014">FIG. 18</figref> is a flowchart showing the search processing for the user-supplementary data D2 of the second embodiment. First, the control unit 150 checks the number of PKCS#7 data D20 included in the supplementary data of the encrypted PDF file (S2601). Then, the control unit 150 executes processing in steps S2602 through S2604 (i.e., searching for the user-supplementary data D2 of the authenticatee) for all of the PKCS#7 data D20.</p><p id="p0121" num="0121">That is, the control unit 150 searches the PKCS#7 data D20 to check whether the user-supplementary data D2 for the authenticatee (i.e., the data D21 indicating the identifier of the public key certificate of the authenticatee) is included in the PKCS#7 data D20 (S2602 and S2603). If the user-supplementary data D2 for the authenticatee is included in the PKCS#7 data D20, the control unit 150 ends the search processing. If the user-supplementary data D2 for the authenticatee is not included in the PKCS#7 data D20, the control unit 150 checks whether all of the PKCS#7 data D 20 are searched (step S2604). If there is<!-- EPO <DP n="27"> --> unsearched PKCS#7 data D20, the control unit 150 returns to the above described step S2602 to search the next PKCS#7 data D20. If there is no unsearched PKCS#7 data D20, the control unit 150 ends the search processing.</p><p id="p0122" num="0122">Referring back to <figref idrefs="f0013">FIG, 16</figref>, when the control unit 150 obtains the user-supplementary data D2 for the authenticatee, the control unit 150 executes processing to confirm the authority assigned to the authenticatee regarding the encrypted PDF file (S2800).</p><p id="p0123" num="0123">The authority confirmation processing in the above described step S2800 will be described with reference to <figref idrefs="f0015">FIG. 19</figref>.</p><p id="p0124" num="0124"><figref idrefs="f0015">FIG. 19</figref> is a flowchart showing the authority confirmation processing according to the second embodiment. First, the control unit 150 stores the PKCS#7 data D20 including the user-supplementary data D2 for the authenticatee in the temporary memory 240 (S2801).</p><p id="p0125" num="0125">Next, the control unit 150 causes the data decryption unit 142 to decrypt the device-supplementary data D3 (i.e., the encrypted data D32) of the PKCS#7 data D20 using the device-secret key K6 of the MFP 600 (S2802), and obtains the encryption key K2 (20 Bytes). Further, the control unit 150 causes the data decryption unit 142 to decrypt the key-storage data D1 of the PKCS#7 data D20 using the encryption key K2, and obtains the PDF encryption key K1 and the recipient's authority information I (4 Bytes) for the recipient's authority (S2803). The recipient's authority information I (4 Bytes) includes information on authority (i.e., information on permission and prohibition of each of printing, changing and copying) according to specifications of PDF.</p><p id="p0126" num="0126">Then, referring back to <figref idrefs="f0013">FIG. 16</figref>, the control unit 150 refers the obtained recipient's authority information I, and checks whether the authenticatee has the authority to execute printing (S2900). If it is confirmed that the authenticatee has the authority to execute printing (i.e., if the recipient's<!-- EPO <DP n="28"> --> authority information I includes permission of printing), the control unit 150 proceeds to step S3000 described below. If the authenticatee has no authority to execute printing, the control unit 150 proceeds to the above described step S3100 (displaying the message indicating that printing is disabled), and ends the processing.</p><p id="p0127" num="0127">If the control unit 150 confirms that the authenticatee has the authority to execute printing in the above described step S2900, the control unit 150 executes printing of the PDF file (S3000), and ends the processing.</p><p id="p0128" num="0128">The printing processing (S3000) will be described with reference to <figref idrefs="f0015">FIG. 20. FIG. 20</figref> is a flowchart showing the printing processing of the second embodiment.</p><p id="p0129" num="0129">The control unit 150 causes the data decryption unit 142 to decrypt the encrypted PDF file using the PDF encryption key K1 obtained in the above described step S2800 (S3001). Then, the control unit 150 causes the printing unit 95 to print an image of the decrypted PDF file (S3002).</p><heading id="h0012">&lt;ADVANTAGES OF SECOND EMBODIMENT&gt;</heading><p id="p0130" num="0130">The second embodiment provides the following advantages in addition to the advantages of the first embodiment.</p><p id="p0131" num="0131">The MFP 600 of the second embodiment checks the authority assigned to the authenticatee based on the supplementary data (i.e., the data D21 indicating the identifier of the public key certificate of the authenticatee) of the respective PKCS#7 data D20, and executes processing such as printing within the authority assigned to the authenticated. Therefore, it becomes possible to confirm the authority assigned to the authenticatee based on the secret key of the MFP 600 (without registering the user's secret key to the MFP 600) and to execute processing such as printing within the authority assigned to the authenticatee. Accordingly, the MFP 600 can execute processing of the encrypted PDF file more safely.<!-- EPO <DP n="29"> --></p><heading id="h0013">MODIFICATIONS.</heading><p id="p0132" num="0132">The present invention is not limited to the above described embodiments, but following modifications can be made.</p><p id="p0133" num="0133">For example, in the above described embodiments, the MFP has been described as an example of the image data processing device. However, the image data processing device of the present invention is also applicable to, for example, a device (for example, a scanner) having no printing unit (i.e., no image forming unit) and configured to execute other processing than printing.</p><p id="p0134" num="0134">Further, the image data processing device of the present invention is applicable to a device that has no image reader, and that creates an encrypted PDF file based on image data supplied from outside. For example, the image data processing device can be implemented by installing an image data processing program in a computer (for example, a personal computer) connected to a scanner.</p><p id="p0135" num="0135">Moreover, the present invention is applicable to an image data processing program that causes a computer to function as the components of the MFP 600 described in the first and second embodiment.</p><p id="p0136" num="0136">In the above described embodiments, the device-supplementary data D3 included in the respective PKCS#7 data D20 is only the device-supplementary data D3 of the MFP 600 that creates the encrypted PDF file as shown in <figref idrefs="f0010">FIG. 12A</figref>. However, it is also possible to create a device-supplementary data D3 using the public key of another image data processing device (such as an MFP), and to add such a device-supplementary data D3 to the PKCS#7 data D20. In other words, the number of the device-supplementary data D3 included in the PKCS#7 data D20 is not limited. For example, if 10 MFPs are used in a company, it is possible to add ten device-supplementary data D3 (respectively using public keys of all of the 10 MFPs) to the PKCS#7 data D20 when creating an encrypted PDF. With such an arrangement, the<!-- EPO <DP n="30"> --> recipient of the encrypted PDF file can execute processing such as printing using any of the ten MFPs in the company.</p><p id="p0137" num="0137">In the above described embodiments, the encrypted image data created by the MFP is in the PDF format. However, as long as the encrypted image data has the data structure as described with reference to <figref idrefs="f0010">FIG. 12A and 12B</figref>, other specifications are not limited to PDF and PKCS#7.</p><p id="p0138" num="0138">In the above described embodiments, the device-supplementary data D3 is included in all of the PKCS#7 data constituting the supplementary data. However, it is also possible that the device-supplementary data D3 is included in at least one of the PKCS#7 data constituting the supplementary data D20. For example, it is also possible that the device-supplementary data D3 is included only in the first PKCS#7 data of the supplementary data D20. Further, it is also possible that the device-supplementary data D3 is included only in the PKCS#7 data corresponding to the recipient's authority having all of the authorities.</p><p id="p0139" num="0139">In the above described embodiments, the MFP creates encrypted PDF files and executes output processing (i.e., printing). However, the MFP can also be configured to only execute output processing. Further, the MFP can also be configured to only execute processing as shown in <figref idrefs="f0013 f0014 f0015">FIGS. 16 through 20</figref>. <figref idrefs="f0016">FIG. 21</figref> shows an example of such an MFP (referred to as an MFP 600A). The MFP 600A shown in <figref idrefs="f0016">FIG. 21</figref> has no data converter 140 shown in <figref idrefs="f0002">FIG. 2</figref>. The MFP 600A receives the encrypted PDF data outputted by the MFP 600 (<figref idrefs="f0002">FIG. 2</figref>), and executes processing (for example, printing) as shown in <figref idrefs="f0013 f0014 f0015">FIGS. 16 through 20</figref>.</p><p id="p0140" num="0140">While the preferred embodiments of the present invention have been illustrated in detail, it should be apparent that modifications and improvements may be made to the invention without departing from the spirit and scope of the invention as described in the following claims.</p></description><claims mxw-id="PCLM56976135" lang="EN" load-source="patent-office"><!-- EPO <DP n="31"> --><claim id="c-en-0001" num="0001"><claim-text>An image data processing device (600) comprising:
<claim-text>an image data storage unit (210) that stores image data;</claim-text>
<claim-text>a user key storage unit (230) that stores at least one user key (K3) corresponding to respective usage authorities of the image data;</claim-text>
<claim-text>a first encryption unit (140) that encrypts the image data stored in the image data storage unit (210) using a first encryption key (k1) to create encrypted image data (D10);</claim-text>
<claim-text>a second encryption key creation unit (140) that creates a second encryption key (K2) assigned to each of the usage authorities;</claim-text>
<claim-text>a key-storage data creation unit (140) that creates a key-storage data (D2) for each of the usage authorities, the key-storage data (D1) being created by encrypting the first encryption key (K1) and authority information (I) indicating the usage authority using the second encryption key (K2) assigned to the usage authority;</claim-text>
<claim-text>a user-supplementary data creation unit (140) that creates user-supplementary data (D2) for each of the user keys stored in the user key storage unit (230), the user-supplementary data (D2) including an identifier of the user key (K3) and encrypted data created by encrypting the second encryption key (K2) assigned to the usage authority corresponding to the user key (K3) using the user key (K3);</claim-text>
<claim-text>a device-supplementary data creation unit (140) that creates device-supplementary data (D3) for at least one of the usage authorities and for at least one device key (K5) of at least one image data processing device (600), the device-supplementary data (D3) including an identifier of the device key (K5) and encrypted data created by encrypting the second encryption key (K2) assigned to the usage authority using the device key (K5) of the image data processing device (600); and<!-- EPO <DP n="32"> --></claim-text>
<claim-text>a data output unit (150) that outputs the encrypted image data (D10) with supplementary data (D20) including the key-storage data (D1), the user-supplementary data (D2) and the device-supplementary data (D3) for each of the usage authorities.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The image data processing device (600) according to claim 1, wherein the device-supplementary data creation unit (140) creates the device-supplementary data (D3) based on at least the device key (K5) of the image data processing device (600), and<br/>
wherein the image data processing device (600) further comprises:
<claim-text>a second encryption key acquiring unit (142) that acquires the device-supplementary data (D3) assigned to the image data processing device (600) from the supplementary data (D20) attached to the encrypted image data (D10) outputted by the data output unit (150), and acquires the second encryption key (K2) by decrypting the acquired device-supplementary data (D3);</claim-text>
<claim-text>a first encryption key acquiring unit (142) that acquires the first encryption key (K1) from the key-storage data (D1) using the acquired second encryption key (K2);</claim-text>
<claim-text>a decryption unit (142) that decrypts the encrypted image data (D10) using the acquired first encryption key (K1) to obtain image data, and</claim-text>
<claim-text>an output unit (95) that outputs the image data decrypted by the decryption unit (142).</claim-text></claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The image data processing device (600) according to claim 1 or 2, further comprising:
<claim-text>an authentication unit (260) that executes authentication of the user in response to an operation by the user;</claim-text>
<claim-text>an encrypted image data storage unit (U) that stores the encrypted image data (D10) with the supplementary data (D20) outputted by the data output unit (150);<!-- EPO <DP n="33"> --></claim-text>
<claim-text>a user-supplementary data detection unit (150) that detects the user-supplementary data (D2) corresponding to the user key (k3) of a user authenticated by the authentication unit (260) from the supplementary data (D20) attached to the encrypted image data (D10) stored in the encrypted image data storage unit (U);</claim-text>
<claim-text>an authority information acquiring unit (150) that acquires authority information (I) by decrypting the key-storage data (D1) corresponding to the same usage authority as the user-supplementary data (D2) detected by the user-supplementary data detection unit (150) using the second encryption key (K2) acquired by the second encryption key acquiring unit (142), and</claim-text>
<claim-text>an image output unit (150) that outputs an image based on the image data decrypted by the decryption unit (142) within usage authority based on the authority information (I).</claim-text></claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>The image data processing device (600) according to one of claims 1 to 3, further comprising a printing unit (95) that executes printing,<br/>
wherein the image output unit (150) causes the printing unit (95) to print an image based on the image data decrypted by the decryption unit (142) only when printing is permitted by the authority information (I) acquired by the authority information acquiring unit (150).</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>The image data processing device (600) according to any one of claims 1 to 4, wherein the user key (K3) is a public key (K3) of the user, and<br/>
wherein the device key (k5) is a public key (K5) of the image data processing device (600).</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>The image data processing device (600) according to one of claims 2 to 5, wherein the second encryption key acquiring unit (142) decrypts the acquired device-supplementary data (D3) using a secret key (K6) of the image data processing device (600).<!-- EPO <DP n="34"> --></claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>An image data processing device (600) comprising:
<claim-text>a second encryption key acquiring unit (142) that acquires the device-supplementary data (D3) assigned to the image data processing device (600) from the supplementary data (D20) attached to the encrypted image data (D10) outputted by the image data processing device (600) according to any one of claims 1 to 6, and acquires the second encryption key (K2) by decrypting the acquired device-supplementary data (D3);</claim-text>
<claim-text>a first encryption key acquiring unit (142) that acquires the first encryption key (K1) from the key-storage data (D1) using the acquired second encryption key (K2);</claim-text>
<claim-text>a decryption unit (142) that decrypts the encrypted image data (D10) using the acquired first encryption key (K1) to obtain image data, and</claim-text>
<claim-text>an output unit (95) that outputs the image data decrypted by the decryption unit (142).</claim-text></claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>An image data processing program that causes a computer to execute functions as:
<claim-text>an image data storage unit (210) that stores image data;</claim-text>
<claim-text>a user key storage unit (230) that stores at least one user key (K3) corresponding to respective usage authorities of the image data;</claim-text>
<claim-text>a first encryption unit (140) that encrypts the image data stored in the image data storage unit (210) using a first encryption key (K1) to create encrypted image data (D10);</claim-text>
<claim-text>a second encryption key creation unit (140) that creates a second encryption key (K2) assigned to each of the usage authorities;</claim-text>
<claim-text>a key-storage data creation unit (140) that creates a key-storage data (D1) for each of the usage authorities, the key-storage data (D1) being created by encrypting the first encryption key (K1) and authority information (I) indicating the<!-- EPO <DP n="35"> --> usage authority using the second encryption key (K2) assigned to the usage authority;</claim-text>
<claim-text>a user-supplementary data creation unit (140) that creates user-supplementary data (D2) for each of the user keys stored in the user key storage unit (230), the user-supplementary data (D2) including an identifier of the user key (K3) and encrypted data created by encrypting the second encryption key (K2) assigned to the usage authority corresponding to the user key (K3) using the user key (K3);</claim-text>
<claim-text>a device-supplementary data creation unit (140) that creates device-supplementary data (D3) for at least one of the usage authorities and for at least one device key (K5) of at least one image data processing device (600), the device-supplementary data (D3) including an identifier of the device key (K5) and encrypted data created by encrypting the second encryption key (K2) assigned to the usage authority using the device key (K5) of the image data processing device (600); and</claim-text>
<claim-text>a data output unit (150) that outputs the encrypted image data (D10) with supplementary data (D20) including the key-storage data (D1), the user-supplementary data (D2) and the device-supplementary data (D3) for each of the usage authorities.</claim-text></claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>An image data processing program that causes a computer to execute functions as:
<claim-text>a second encryption key acquiring unit (142) that acquires the device-supplementary data (D3) assigned to the image data processing device (600) from the supplementary data (D20) attached to the encrypted image data (D10) outputted by the image data processing device (600) according to any one of claims 1 to 6, and acquires the second encryption key (K2) by decrypting the acquired device-supplementary data (D3);</claim-text>
<claim-text>a first encryption key acquiring unit (142) that acquires the first encryption key (K1) from the key-storage data (D1) using the acquired second encryption key (K2);<!-- EPO <DP n="36"> --></claim-text>
<claim-text>a decryption unit (142) that decrypts the encrypted image data (D10) using the acquired first encryption key (K1) to obtain image data, and</claim-text>
<claim-text>an output unit (95) that outputs the image data decrypted by the decryption unit (142).</claim-text></claim-text></claim></claims><drawings mxw-id="PDW16666920" load-source="patent-office"><!-- EPO <DP n="37"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="164" he="219" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="38"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="153" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="39"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="165" he="210" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="40"> --><figure id="f0004" num="4"><img id="if0004" file="imgf0004.tif" wi="121" he="184" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="41"> --><figure id="f0005" num="5,6"><img id="if0005" file="imgf0005.tif" wi="160" he="188" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="42"> --><figure id="f0006" num="7"><img id="if0006" file="imgf0006.tif" wi="129" he="226" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="43"> --><figure id="f0007" num="8,9"><img id="if0007" file="imgf0007.tif" wi="165" he="199" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="44"> --><figure id="f0008" num="10"><img id="if0008" file="imgf0008.tif" wi="130" he="194" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="45"> --><figure id="f0009" num="11"><img id="if0009" file="imgf0009.tif" wi="145" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="46"> --><figure id="f0010" num="12A,12B"><img id="if0010" file="imgf0010.tif" wi="165" he="232" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="47"> --><figure id="f0011" num="13,14"><img id="if0011" file="imgf0011.tif" wi="165" he="232" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="48"> --><figure id="f0012" num="15"><img id="if0012" file="imgf0012.tif" wi="124" he="157" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="49"> --><figure id="f0013" num="16"><img id="if0013" file="imgf0013.tif" wi="150" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="50"> --><figure id="f0014" num="17,18"><img id="if0014" file="imgf0014.tif" wi="156" he="232" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="51"> --><figure id="f0015" num="19,20"><img id="if0015" file="imgf0015.tif" wi="156" he="232" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="52"> --><figure id="f0016" num="21"><img id="if0016" file="imgf0016.tif" wi="161" he="233" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="155" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="155" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
