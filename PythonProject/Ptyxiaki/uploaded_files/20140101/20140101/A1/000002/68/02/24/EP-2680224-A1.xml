<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2680224-A1" country="EP" doc-number="2680224" kind="A1" date="20140101" family-id="46319646" file-reference-id="318307" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146549380" ucid="EP-2680224-A1"><document-id><country>EP</country><doc-number>2680224</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12173823-A" is-representative="YES"><document-id mxw-id="PAPP154823303" load-source="docdb" format="epo"><country>EP</country><doc-number>12173823</doc-number><kind>A</kind><date>20120627</date><lang>EN</lang></document-id><document-id mxw-id="PAPP222722618" load-source="docdb" format="original"><country>EP</country><doc-number>12173823.1</doc-number><date>20120627</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140447929" ucid="EP-12173823-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>12173823</doc-number><kind>A</kind><date>20120627</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988120133" load-source="docdb">G06T   7/00        20060101AFI20121127BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1861395014" load-source="docdb" scheme="CPC">G06T   7/571       20170101 FI20170102BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988921011" load-source="docdb" scheme="CPC">G06T2207/20021     20130101 LA20140103BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132180624" lang="DE" load-source="patent-office">Verfahren und Vorrichtung zur Bestimmung eines Tiefenbildes</invention-title><invention-title mxw-id="PT132180625" lang="EN" load-source="patent-office">Method and device for determining a depth image</invention-title><invention-title mxw-id="PT132180626" lang="FR" load-source="patent-office">Procédé et dispositif de détermination d'une image de profondeur</invention-title><citations><patent-citations><patcit mxw-id="PCIT242652367" load-source="docdb" ucid="US-6584219-B1"><document-id format="epo"><country>US</country><doc-number>6584219</doc-number><kind>B1</kind><date>20030624</date></document-id><sources><source name="SEA" category="A" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242652368" load-source="docdb" ucid="WO-2007063478-A2"><document-id format="epo"><country>WO</country><doc-number>2007063478</doc-number><kind>A2</kind><date>20070607</date></document-id><sources><source name="SEA" category="A" created-by-npl="N"/></sources></patcit></patent-citations><non-patent-citations><nplcit><text>None</text><sources><source mxw-id="PNPL45131019" load-source="docdb" name="APP"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR918145833" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>VESTEL ELEKT SANAYI VE TICARET</last-name><address><country>TR</country></address></addressbook></applicant><applicant mxw-id="PPAR918158361" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>VESTEL ELEKTRONIK SANAYI VE TICARET A.S.</last-name></addressbook></applicant><applicant mxw-id="PPAR918992912" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Vestel Elektronik Sanayi ve Ticaret A.S.</last-name><iid>100249217</iid><address><street>Organize Sanayi Bölgesi</street><city>45030 Manisa</city><country>TR</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918172519" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>BASTUG AHMET</last-name><address><country>TR</country></address></addressbook></inventor><inventor mxw-id="PPAR918169404" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>BASTUG, AHMET</last-name></addressbook></inventor><inventor mxw-id="PPAR918992977" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>BASTUG, AHMET</last-name><address><street>VESTEL ELEKTRONIK SANAYI VE TICARET A.S. Organize Sanayi Bolgesi</street><city>45030 Manisa</city><country>TR</country></address></addressbook></inventor><inventor mxw-id="PPAR918144463" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>OZER NURI</last-name><address><country>TR</country></address></addressbook></inventor><inventor mxw-id="PPAR918148184" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>Ozer, Nuri</last-name></addressbook></inventor><inventor mxw-id="PPAR918980200" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>Ozer, Nuri</last-name><address><street>VESTEL ELEKTRONIK SANAYI VE TICARET A.S. Organize Sanayi Bolgesi</street><city>45030 Manisa</city><country>TR</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918985818" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Cayli, Hülya</last-name><iid>101072070</iid><address><street>Paragon Consultancy Inc. Koza Sokak No: 63/2 GOP</street><city>06540 Ankara</city><country>TR</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS548857984" load-source="docdb">AL</country><country mxw-id="DS548804608" load-source="docdb">AT</country><country mxw-id="DS548857985" load-source="docdb">BE</country><country mxw-id="DS548877745" load-source="docdb">BG</country><country mxw-id="DS548889888" load-source="docdb">CH</country><country mxw-id="DS548857986" load-source="docdb">CY</country><country mxw-id="DS548840809" load-source="docdb">CZ</country><country mxw-id="DS548803500" load-source="docdb">DE</country><country mxw-id="DS548857987" load-source="docdb">DK</country><country mxw-id="DS548857988" load-source="docdb">EE</country><country mxw-id="DS548864605" load-source="docdb">ES</country><country mxw-id="DS548877746" load-source="docdb">FI</country><country mxw-id="DS548877747" load-source="docdb">FR</country><country mxw-id="DS548803501" load-source="docdb">GB</country><country mxw-id="DS548857989" load-source="docdb">GR</country><country mxw-id="DS548803506" load-source="docdb">HR</country><country mxw-id="DS548840810" load-source="docdb">HU</country><country mxw-id="DS548889889" load-source="docdb">IE</country><country mxw-id="DS548858314" load-source="docdb">IS</country><country mxw-id="DS548877756" load-source="docdb">IT</country><country mxw-id="DS548858315" load-source="docdb">LI</country><country mxw-id="DS548803507" load-source="docdb">LT</country><country mxw-id="DS548804609" load-source="docdb">LU</country><country mxw-id="DS548877757" load-source="docdb">LV</country><country mxw-id="DS548803508" load-source="docdb">MC</country><country mxw-id="DS548804610" load-source="docdb">MK</country><country mxw-id="DS548804611" load-source="docdb">MT</country><country mxw-id="DS548858316" load-source="docdb">NL</country><country mxw-id="DS548803514" load-source="docdb">NO</country><country mxw-id="DS548858317" load-source="docdb">PL</country><country mxw-id="DS548877758" load-source="docdb">PT</country><country mxw-id="DS548840811" load-source="docdb">RO</country><country mxw-id="DS548877759" load-source="docdb">RS</country><country mxw-id="DS548858318" load-source="docdb">SE</country><country mxw-id="DS548890058" load-source="docdb">SI</country><country mxw-id="DS548803515" load-source="docdb">SK</country><country mxw-id="DS548803516" load-source="docdb">SM</country><country mxw-id="DS548804612" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128670050" lang="EN" load-source="patent-office"><p id="pa01" num="0001">Various embodiments provide a method for determining a depth image for a digital image including a plurality of picture elements. The method may include edge filtering the digital image to determine an edge map, wherein the edge map includes a plurality of edge values and each edge value is associated with at least one picture element; determining for each edge map region of a plurality of edge map regions an edge map region metric; determining for each edge map region as to whether the respective edge region metric fulfills a predefined criterion; determining the number of edge map regions for which the respective edge map region metric fulfills the predefined criterion as a first value; determining the number of edge map regions for which the respective edge map region metric does not fulfill the predefined criterion as a second value; and determining the depth image using the first value and the second value.
<img id="iaf01" file="imgaf001.tif" wi="153" he="59" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128499423" lang="EN" source="EPO" load-source="docdb"><p>Various embodiments provide a method for determining a depth image for a digital image including a plurality of picture elements. The method may include edge filtering the digital image to determine an edge map, wherein the edge map includes a plurality of edge values and each edge value is associated with at least one picture element; determining for each edge map region of a plurality of edge map regions an edge map region metric; determining for each edge map region as to whether the respective edge region metric fulfills a predefined criterion; determining the number of edge map regions for which the respective edge map region metric fulfills the predefined criterion as a first value; determining the number of edge map regions for which the respective edge map region metric does not fulfill the predefined criterion as a second value; and determining the depth image using the first value and the second value.</p></abstract><description mxw-id="PDES63955480" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><p id="p0001" num="0001">Various embodiments relate generally to image processing. Furthermore, various embodiments relate to a method and a device for determining a depth image.</p><p id="p0002" num="0002">With the development and success of three-dimensional (3D) technologies, its application is not limited to 3D movies in theaters, but is extending to home electronics, such as 3D TVs and other 3D consumer products. 3D vision or stereoscopic vision may usually be created by presenting two slightly different sets of images to a viewer, wherein one set includes left eye images corresponding to a left eye viewpoint and the other set includes right eye images corresponding to a right eye viewpoint. 3D displays (e.g., CRT, LCD, Plasma, etc.) show left eye and right eye views on the same surface, and by temporal or spatial multiplexing, make the left eye of a viewer only see the left eye view and the right eye only see the right-eye view. Disparities between the two views provide a vision with depth perception to the viewer, and make the viewer perceive a stereoscopic view.</p><p id="p0003" num="0003">Two-dimensional (2D) images with multiple viewpoints are usually necessary to provide a 3D image or video with depth information. However, accessible 3D content is insufficient, e.g. limited to a few sports and documentary broadcasts obtained by expensive subscription fees, due to expensive costs for shooting 3D films and preparing 3D stereo video.</p><p id="p0004" num="0004">In situations wherein only 2D content is available, a possible solution is to create 3D content from 2D content by computing depth map of the image frames. In the computation of depth maps for image frames, noise remains a problem that needs to be considered in order to determine accurate depth maps.</p><p id="p0005" num="0005">Various embodiments provide a method and a device for determining a depth image for a digital image.</p><p id="p0006" num="0006">Various embodiments provide a method for determining a depth image for a digital image including a plurality of picture elements. The method may include edge filtering the digital image to determine an edge map, wherein the edge map includes a plurality of edge values and each edge value is associated with at least one picture element; determining for each edge map region of a plurality of edge map regions an edge map region metric; determining for each edge map region as to whether the respective edge region metric fulfills<!-- EPO <DP n="2"> --> a predefined criterion; determining the number of edge map regions for which the respective edge map region metric fulfills the predefined criterion as a first value; determining the number of edge map regions for which the respective edge map region metric does not fulfill the predefined criterion as a second value; and determining the depth image using the first value and the second value.</p><p id="p0007" num="0007">Various embodiments provide a method and a device for determining a depth image for a digital image. Embodiments provide more accurate depth information for 2D image or video, such that 2D image or video may be converted to 3D image or video using the determined depth image.</p><p id="p0008" num="0008">Various embodiments are directed to a method for determining a depth image for a digital image including a plurality of picture elements (also referred to as pixels). The method may include edge filtering the digital image to determine an edge map, wherein the edge map includes a plurality of edge values and each edge value is associated with at least one picture element; determining for each edge map region of a plurality of edge map regions an edge map region metric; determining for each edge map region as to whether the respective edge region metric fulfills a predefined criterion; determining the number of edge map regions for which the respective edge map region metric fulfills the predefined criterion as a first value; determining the number of edge map regions for which the respective edge map region metric does not fulfill the predefined criterion as a second value; and determining the depth image using the first value and the second value.</p><p id="p0009" num="0009">The digital image may be a 2D image, e.g. an image captured by a camera from a single viewpoint. The digital image may be an image frame of a video including a sequence of image frames. For the purpose of simplicity, the method and device in this description is described with regard to images, but it is understood that the method and device of the embodiments may apply similarly to each image frame of the video to process the entire video.</p><p id="p0010" num="0010">In an embodiment, the edge filtering may include maximum-minimum filtering, based on the difference between a maximum value and a minimum value within a predefined image region. For example, for each picture element of the digital image, a maximum picture element value associated with a picture element in a predefined neighboring region of the respective picture element and a minimum picture element value associated with a picture element in a predefined neighboring region of the respective picture element may be<!-- EPO <DP n="3"> --> determined, and a difference value between the maximum picture element value and the minimum picture element value may be determined. The edge value associated with the picture element may be determined based on the difference value. In other embodiments, the edge filtering may use other filtering suitable for detecting the edges, such as maximum filtering and average filtering, for example. In some embodiments, the edge filtering may include a Canny edge detector, a Sobel operator, or any other suitable edge detection algorithms.</p><p id="p0011" num="0011">In an embodiment, the digital image may be divided into a plurality of blocks, wherein each block includes a plurality of pixel elements. Each determined edge value may be associated with a block of pixel elements.</p><p id="p0012" num="0012">In one embodiment, the digital image may be a grayscale image. The picture element value used in edge filtering may refer to the intensity value of the picture element in the grayscale image.</p><p id="p0013" num="0013">In another embodiment, the digital image may be a color image, which may be represented using existing color models, such as RGB (red, green, blue) and CMYK (cyan, magenta, yellow and key) color model, wherein respective color values (in general picture element values) are associated with one or more picture elements. The picture element value used in edge filtering may refer to a weighted average value of the color component values. In an illustrative example wherein the digital image is a RGB image, the RGB image may be converted to YC<sub>b</sub>C<sub>r</sub> color space, including a Y component representing the luminance component and C<sub>B</sub> and C<sub>R</sub> components representing the blue-difference and red-difference chrominance components. In this example, the picture element value used in the edge filtering may refer to the Y component value of the picture element in the color image.</p><p id="p0014" num="0014">According to an embodiment, in determining the depth image, for each picture element associated with a depth value, it may be determined as to whether the picture element is located in an edge map region for which the respective edge map region metric fulfills the predefined criterion. In case the picture element is located in an edge map region for which the respective edge map region metric fulfills the predefined criterion, the associated depth value may be reduced by a first noise floor adaptation value to determine a noise floor adapted depth value. In case the picture element is located in an edge map region for which the respective edge map region metric does not fulfill the predefined criterion, the associated depth value may be reduced by a second noise floor adaptation<!-- EPO <DP n="4"> --> value to determine a noise floor adapted depth value. The second noise floor adaptation value may be smaller than the first noise floor adaptation value. The depth image may include the respectively determined noise floor adapted depth values.</p><p id="p0015" num="0015">According to an embodiment, the edge map region metric for each edge map region may include the number of high edge values and the number of low edge values in the respective edge map region. In this embodiment, the high edge values may represent the edge values higher than a predetermined high threshold (e.g. a threshold value of 96), and the low edge values may represent the edge values lower than a predetermined low threshold (e.g. a threshold value of 6).</p><p id="p0016" num="0016">In an embodiment, the predefined criterion may be whether the edge map region metric exceeds a first predefined edge threshold value. In an illustrative embodiment, determining whether the edge map region metric fulfills the predefined criterion may include determining whether the number of high edge values exceeds the first predefined edge threshold value. If the number of high edge values exceeds the first predefined edge threshold value, the associated edge map region may be referred to as a high frequency region, indicating that the edge map region includes sufficient number of high edge values.</p><p id="p0017" num="0017">In a further embodiment, the edge map region metric not fulfilling the predefined criterion may be whether the edge map region metric exceeds a second predefined edge threshold value. The second predefined edge threshold value may be different from the first predefined edge threshold value. In an illustrative embodiment, whether the edge map region metric exceeds the second predefined edge threshold value may include whether the number of low edge values in the edge map region metric exceeds the second predefined edge threshold value. If the number of low edge values exceeds the first predefined edge threshold value, the associated edge map region may be referred to as a low frequency region, indicating that the edge map region includes sufficient number of low edge values.</p><p id="p0018" num="0018">According to a further embodiment, in determining the depth image, it may be determined as to whether the digital image is a high frequency image or a low frequency image based on the first value and the second value. In case the digital image is neither a high frequency image nor a low frequency image, a respective depth scaled value may be determined for each depth value associated with a picture element by reducing the depth value by a first depth scale. In case the digital image is either a high frequency image or a low frequency image, a respective depth scaled value may be determined for each depth<!-- EPO <DP n="5"> --> value associated with a picture element by reducing the depth value by a second depth scale. The first depth scale may be smaller than the second depth scale.</p><p id="p0019" num="0019">In an embodiment, the digital image may be determined to be a high frequency image in case the first value exceeds a first frequency threshold value. In an embodiment, the first value may represent the number of edge map regions in which the respective number of high edge values exceeds the first predefined edge threshold value, i.e. the number of high frequency regions.</p><p id="p0020" num="0020">In another embodiment, the digital image may be determined to be a low frequency image in case the second value exceeds a second frequency threshold value. The second frequency threshold value may be different from the first frequency threshold value. The second value may represent the number of edge map regions in which the respective number of low edge values exceeds the second predefined edge threshold value, i.e. the number of low frequency regions.</p><p id="p0021" num="0021">In an embodiment, the depth image may be determined using the first value and the second value. In one embodiment, the depth image may be determined based on the edge map via a piece-wise linear mapping function. In another embodiment, the depth image may be determined based on the edge map via a S-curve mapping function. Other suitable mapping functions may also be used in other embodiments.</p><p id="p0022" num="0022">Another embodiment is directed to a device for determining a depth image for a digital image including a plurality of picture elements (also referred to as pixels). The device may include an edge filter configured to filter the digital image to determine an edge map, wherein the edge map includes a plurality of edge values and each edge value is associated with at least one picture element. The device may further include a processor configured to determine for each edge map region of a plurality of edge map regions an edge map region metric; determine for each edge map region as to whether the respective edge map region metric fulfills a predefined criterion; determine the number of edge map regions for which the respective edge map region metric fulfills the predefined criterion as a first value; determine the number of edge map regions for which the respective edge map region metric does not fulfill the predefined criterion as a second value ; and determining the depth image using the first value and the second value.</p><p id="p0023" num="0023">According to an embodiment, the processor may be configured to determine the depth image, including determining for each picture element associated with a depth value as<!-- EPO <DP n="6"> --> to whether the picture element is located in an edge map region for which the respective edge map region metric fulfills the predefined criterion. In case the picture element is located in an edge map region for which the respective edge map region metric fulfills the predefined criterion, the associated depth value may be reduced by a first noise floor adaptation value to determine a noise floor adapted depth value. In case the picture element is located in an edge map region for which the respective edge map region metric does not fulfill the predefined criterion, the associated depth value may be reduced by a second noise floor adaptation value to determine a noise floor adapted depth value. The second noise floor adaptation value may be smaller than the first noise floor adaptation value. The depth image may include the respectively determined noise floor adapted depth values.</p><p id="p0024" num="0024">In an embodiment, the predefined criterion may be whether the edge map region metric exceeds a first predefined edge threshold value. In an illustrative embodiment, determining whether the edge map region metric fulfills the predefined criterion may include determining whether the number of high edge values exceeds the first predefined edge threshold value. If the number of high edge values exceeds the first predefined edge threshold value, the associated edge map region may be referred to as a high frequency region, indicating that the edge map region includes sufficient number of high edge values.</p><p id="p0025" num="0025">In a further embodiment, the edge map region metric not fulfilling the predefined criterion may be whether the edge map region metric exceeds a second predefined edge threshold value. The second predefined edge threshold value may be different from the first predefined edge threshold value. In an illustrative embodiment, whether the edge map region metric exceeds the second predefined edge threshold value may include whether the number of low edge values in the edge map region metric exceeds the second predefined edge threshold value. If the number of low edge values exceeds the first predefined edge threshold value, the associated edge map region may be referred to as a low frequency region, indicating that the edge map region includes sufficient number of low edge values.</p><p id="p0026" num="0026">According to a further embodiment, the processor may be configured to determine as to whether the digital image is a high frequency image or a low frequency image based on the first value and the second value. In case the digital image is neither a high frequency image nor a low frequency image, a respective depth scaled value may be determined for each depth value associated with a picture element by reducing the depth value by a first depth scale. In case the digital image is either a high frequency image or a low frequency<!-- EPO <DP n="7"> --> image, a respective depth scaled value may be determined for each depth value associated with a picture element by reducing the depth value by a second depth scale. The first depth scale may be smaller than the second depth scale.</p><p id="p0027" num="0027">In an embodiment, the processor may be configured to determine that the digital image is a high frequency image in case the first value exceeds a first frequency threshold value. In an embodiment, the first value may represent the number of edge map regions in which the respective number of high edge values exceeds the first predefined edge threshold value, i.e. the number of high frequency regions.</p><p id="p0028" num="0028">In another embodiment, the processor may be configured to determine that the digital image is a low frequency image in case the second value exceeds a second frequency threshold value. The second frequency threshold value may be different from the first frequency threshold value. The second value may represent the number of edge map regions in which the respective number of low edge values exceeds the second predefined edge threshold value, i.e. the number of low frequency regions.</p><p id="p0029" num="0029">Various embodiments described in the context of the method for determining a depth image for a digital image are analogously valid for the device, and vice versa.</p><p id="p0030" num="0030">The filter and circuit, such as the edge filter and the processor, may each be configured to carry out the functions described in the method of various embodiments above.</p><p id="p0031" num="0031">In an embodiment, the various "filter" and "processor" comprised in the device and a "circuit" may be understood as any kind of a logic implementing entity, which may be special purpose circuitry or a processor executing software stored in a memory, firmware, or any combination thereof. Thus, in an embodiment, a "filter", "processor" or "circuit" may be a hard-wired logic circuit or a programmable logic circuit such as a programmable processor, e.g. a microprocessor (e.g. a Complex Instruction Set Computer (CISC) processor or a Reduced Instruction Set Computer (RISC) processor). A "filter", "processor" or "circuit" may also be a processor executing software, e.g. any kind of computer program, e.g. a computer program using a virtual machine code such as e.g. Java. Any other kind of implementation of the respective functions described in the embodiments in this description may also be understood as a "filter", "processor" or "circuit" in accordance with an alternative embodiment.<!-- EPO <DP n="8"> --></p><p id="p0032" num="0032">In an embodiment, the device for determining a depth image may be a circuit described above configured to perform the method for determining a depth image for a digital image.</p><p id="p0033" num="0033">In another embodiment, a computer readable medium having a program stored thereon may be provided, wherein the program is to make a computer execute a method described in the above embodiments. The computer readable medium may include any data storage device, such as read-only memory (ROM), random-access memory (RAM), CD-ROMs, magnetic tapes, floppy disks and optical data storage devices.</p><p id="p0034" num="0034">In this context, the device as described in this description may include a memory which is for example used in the processing carried out by the device. A memory used in the embodiments may be a volatile memory, for example a DRAM (Dynamic Random Access Memory), or a non-volatile memory, for example a PROM (Programmable Read Only Memory), an EPROM (Erasable PROM), EEPROM (Electrically Erasable PROM), or a flash memory, e.g., a floating gate memory, a charge trapping memory, an MRAM (Magnetoresistive Random Access Memory) or a PCRAM (Phase Change Random Access Memory).</p><p id="p0035" num="0035">In the drawings, like reference characters generally refer to the same parts throughout the different views. The drawings are not necessarily to scale, emphasis instead generally being placed upon illustrating the principles of the invention. In the following description, various embodiments are described with reference to the following drawings, in which:
<ul><li><figref idrefs="f0001">Fig. 1</figref> shows a schematic diagram of a device according to an embodiment.</li><li><figref idrefs="f0002">Fig. 2</figref> shows a flow diagram according to an embodiment.</li><li><figref idrefs="f0002">Fig. 3</figref> shows a flow diagram according to another embodiment.</li><li><figref idrefs="f0003">Fig. 4</figref> shows a flow diagram illustrating the determination of different edge numbers according to an embodiment.</li><li><figref idrefs="f0004">Fig. 5</figref> shows a flow diagram illustrating the determination of different edge regions according to an embodiment.</li><li><figref idrefs="f0005">Fig. 6</figref> shows a flow diagram illustrating the classification of the digital image according to an embodiment.</li><li><figref idrefs="f0006">Fig. 7</figref> shows a flow diagram illustrating the classification of the edge map regions according to an embodiment.<!-- EPO <DP n="9"> --></li><li><figref idrefs="f0007">Fig. 8</figref> shows a flow diagram illustrating the determination of depth scale according to an embodiment.</li><li><figref idrefs="f0007">Fig. 9</figref> shows a flow diagram illustrating the determination of noise floor adaptation values according to an embodiment.</li><li><figref idrefs="f0008">Fig. 10</figref> shows a flow diagram illustrating the noise floor and depth scale adaptation according to an embodiment.</li><li><figref idrefs="f0009">Fig. 11</figref> illustrates a mapping function between an edge map and a depth map according to an embodiment.</li><li><figref idrefs="f0009">Fig. 12</figref> shows an image system according to an embodiment.</li></ul></p><p id="p0036" num="0036"><figref idrefs="f0001">FIG. 1</figref> shows a schematic diagram of a device for determining a depth image according to various embodiments.</p><p id="p0037" num="0037">The device 100 may be implemented by a computer system. In various embodiments, the edge filter and the processor may also be implemented as modules executing on one or more computer systems. The computer system may include a CPU 101 (central processing unit), a processor 103, a memory 105, a network interface 107, input interface/devices 109 and output interface/devices 111. All the components 101, 103, 105, 107, 109, 111 of the computer system 100 may be connected and communicating with each other through a computer bus 113.</p><p id="p0038" num="0038">The memory 105 may be used as for storing digital images, edge maps, noise floor adapted depth values, depth scaled values, depth images, threshold values, and intermediate values used and determined according to the method of the embodiments. The memory 105 may include more than one memory, such as RAM, ROM, EPROM, hard disk, etc. wherein some of the memories are used for storing data and programs and other memories are used as working memories.</p><p id="p0039" num="0039">In an embodiment, the memory 105 may be configured to store instructions for determining the depth image for the digital image according to various embodiments. The instructions, when executed by the CPU 101, may cause the CPU 101 to edge filter the digital image; determine for each edge map region of a plurality of edge map regions an edge map region metric; determine for each edge map region as to whether the respective edge map region metric fulfills a predefined criterion; determine the number of edge map regions for which the respective edge map region metric fulfills the predefined criterion as a first value; determine the number of edge map regions for which the respective edge map region metric<!-- EPO <DP n="10"> --> does not fulfill the predefined criterion as a second value; and determining the depth image using the first value and the second value. The instruction may also cause the CPU 101 to store the digital images, the edge maps, noise floor adapted depth values, depth scaled values, threshold values, intermediate values, and the depth image determined according to the method of the embodiments in the memory 105.</p><p id="p0040" num="0040">In another embodiment, the processor 103 may be a special purpose processor, in this example, an image processor, for executing the instructions described above.</p><p id="p0041" num="0041">The CPU 101 or the processor 103 may be used as the device as described in various embodiments below, and may be connected to an internal network (e.g. a local area network (LAN) or a wide area network (WAN) within an organization) and/or an external network (e.g. the Internet) through the network interface 107.</p><p id="p0042" num="0042">The input 109 may include a keyboard, a mouse, etc. The output 111 may include a display for display the images processed in the embodiments below.</p><p id="p0043" num="0043"><figref idrefs="f0002">FIG. 2</figref> shows a flow diagram according to various embodiments.</p><p id="p0044" num="0044">Given a digital image 201 including a plurality of picture elements, the digital image 201 is edge filtered at 210 to determine an edge map 211, wherein the edge map 211 1 includes a plurality of edge values and each edge value is associated with at least one picture element of the digital image 201. There is a statistically monotonic relationship between the sharpness level of the image regions and the associated depths. Usually sharper regions are closer to an observer, whereas smoother regions are farther to the observer. Accordingly, the edge map may be used as a sharpness cue in the determination of depth image.</p><p id="p0045" num="0045">The digital image 201 may be received via a network interface, or may be stored on a data storage. In an embodiment, the digital image may be downscaled for one or more times. The edge filtering and the subsequent processing on the digital image 201 may be similarly carried out on the downscaled image accordingly. In the embodiment wherein the digital image is downscaled, each edge value of the edge map may be associated with more than one pixels of the digital image 201.</p><p id="p0046" num="0046">In an embodiment, the edge filtering 210 may include maximum-minimum filtering, based on the difference between a maximum value and a minimum value within a predefined image region. For example, for each picture element of the digital image 201, a maximum picture element value associated with a picture element in a predefined neighboring region of the respective picture element and a minimum picture element value associated with a<!-- EPO <DP n="11"> --> picture element in a predefined neighboring region of the respective picture element may be determined, and a difference value between the maximum picture element value and the minimum picture element value may be determined. The edge value associated with the picture element may be determined based on the difference value. In other embodiments, the edge filtering may use other filtering suitable for detecting the edges, such as maximum filtering and average filtering, for example. In some embodiments, the edge filtering may include a Canny edge detector, a Sobel operator, or any other suitable edge detection algorithms.</p><p id="p0047" num="0047">In an embodiment, the digital image may be divided into a plurality of blocks, wherein each block includes a plurality of pixel elements. Each determined edge value may be associated with a block of pixel elements.</p><p id="p0048" num="0048">In one embodiment wherein the digital image 201 is a grayscale image, the picture element value described in the edge filtering may refer to the intensity value of the picture element in the grayscale image. In another embodiment wherein the digital image 201 is a color image, the picture element value described in the edge filtering may refer to a weighted average value of the color component values of the picture element.</p><p id="p0049" num="0049">After the edge map 211 is determined at 210, the edge map 211 may be further processed and evaluated at 220. For each edge map region of a plurality of edge map regions in the edge map 211, an edge map region metric may be determined. For each edge map region, a determination may be made as to whether the respective edge region metric fulfills a predefined criterion. The number of edge map regions for which the respective edge map region metric fulfills the predefined criterion may be determined as a first value, and the number of edge map regions for which the respective edge map region metric does not fulfill the predefined criterion may be determined as a second value.</p><p id="p0050" num="0050">According to an embodiment, the edge map region metric for each edge map region may include the number of high edge values and the number of low edge values in the respective edge map region. In this embodiment, the high edge values may represent the edge values higher than a predetermined high threshold, and the low edge values may represent the edge values lower than a predetermined low threshold.</p><p id="p0051" num="0051">In an embodiment, the predefined criterion may be whether the edge map region metric exceeds a first predefined edge threshold value. In an illustrative embodiment, determining whether the edge map region metric fulfills the predefined criterion may include<!-- EPO <DP n="12"> --> determining whether the number of high edge values exceeds the first predefined edge threshold value. If the number of high edge values exceeds the first predefined edge threshold value, the associated edge map region may be referred to as a high frequency region, indicating that the edge map region includes sufficient number of high edge values.</p><p id="p0052" num="0052">In a further embodiment, the edge map region metric not fulfilling the predefined criterion may be whether the edge map region metric exceeds a second predefined edge threshold value. The second predefined edge threshold value may be different from the first predefined edge threshold value. In an illustrative embodiment, whether the edge map region metric exceeds the second predefined edge threshold value may include whether the number of low edge values in the edge map region metric exceeds the second predefined edge threshold value. If the number of low edge values exceeds the first predefined edge threshold value, the associated edge map region may be referred to as a low frequency region, indicating that the edge map region includes sufficient number of low edge values.</p><p id="p0053" num="0053">According to a further embodiment, in the edge map evaluation 220, it may be determined as to whether the digital image is a high frequency image or a low frequency image based on the first value and the second value. In case the digital image is neither a high frequency image nor a low frequency image, a respective depth scaled value may be determined for each depth value associated with a picture element by reducing the depth value by a first depth scale. In case the digital image is either a high frequency image or a low frequency image, a respective depth scaled value may be determined for each depth value associated with a picture element by reducing the depth value by a second depth scale. The first depth scale may be smaller than the second depth scale.</p><p id="p0054" num="0054">In an embodiment, the digital image may be determined to be a high frequency image in case the first value exceeds a first frequency threshold value. In an embodiment, the first value may represent the number of edge map regions in which the respective number of high edge values exceeds the first predefined edge threshold value, i.e. the number of high frequency regions.</p><p id="p0055" num="0055">In another embodiment, the digital image may be determined to be a low frequency image in case the second value exceeds a second frequency threshold value. The second frequency threshold value may be different from the first frequency threshold value. The second value may represent the number of edge map regions in which the respective<!-- EPO <DP n="13"> --> number of low edge values exceeds the second predefined edge threshold value, i.e. the number of low frequency regions.</p><p id="p0056" num="0056">Based on the first value and the second value determined at edge map evaluation 220, the depth image 231 may be determined at 230. In one embodiment, the depth image may be determined based on the edge map 211, the first value and the second value via a piece-wise linear mapping function. In another embodiment, the depth image may be determined based on the edge map 211, the first value and the second value via a S-curve mapping function. Other suitable mapping functions may also be used in other embodiments.</p><p id="p0057" num="0057"><figref idrefs="f0002">Fig. 3</figref> shows a flow diagram according to another embodiment.</p><p id="p0058" num="0058">Similar to the flow diagram of <figref idrefs="f0002">Fig. 2</figref>, a digital image 201 is edge filtered at 210 to determine an edge map 211, wherein the edge map 211 includes a plurality of edge values and each edge value is associated with at least one picture element of the digital image 201.</p><p id="p0059" num="0059">After the edge map 211 is determined at 210, noise floor and depth scale determination may be made at 220, e.g. to determine the noise floor adaptation values and depth scale for the depth image determination. For each edge map region of a plurality of edge map regions in the edge map 211, an edge map region metric may be determined. For each edge map region, a determination may be made as to whether the respective edge region metric fulfills a predefined criterion. The number of edge map regions for which the respective edge map region metric fulfills the predefined criterion may be determined as a first value, and the number of edge map regions for which the respective edge map region metric does not fulfill the predefined criterion may be determined as a second value.</p><p id="p0060" num="0060">According to an embodiment, a first noise floor adaptation value or a second noise floor adaptation value may be determined for each picture element at 320, depending on whether the picture element is located in an edge map region for which the respective edge map region metric fulfills the predefined criterion. The second noise floor adaptation value may be smaller than the first noise floor adaptation value.</p><p id="p0061" num="0061">According to a further embodiment, it may be further determined at 320 as to whether the digital image 201 is a high frequency image or a low frequency image based on the first value and the second value. Depending on whether the digital image 201 is a high frequency image or a low frequency image, a first depth scale or a second depth scale may be determined for each picture element. The first depth scale may be smaller than the second depth scale.<!-- EPO <DP n="14"> --></p><p id="p0062" num="0062">Based on the first noise floor adaptation value, the second noise floor adaptation value, the first depth scale and the second depth scale determined at 320, edge noise may be subtracted and the depth value may be scaled in the depth image determination 230 to determine the depth image 231.</p><p id="p0063" num="0063">For example, in case a picture element is located in an edge map region for which the respective edge map region metric fulfills the predefined criterion, the depth value associated with the picture element may be reduced by the first noise floor adaptation value to determine a noise floor adapted depth value. In case the picture element is located in an edge map region for which the respective edge map region metric does not fulfill the predefined criterion, the depth value associated with the picture element may be reduced by the second noise floor adaptation value to determine a noise floor adapted depth value. The second noise floor adaptation value may be smaller than the first noise floor adaptation value. The depth image 231 may include the respectively determined noise floor adapted depth values.</p><p id="p0064" num="0064">In another example, in case the digital image is neither a high frequency image nor a low frequency image, a respective depth scaled value may be determined for each depth value associated with a picture element by reducing the depth value by the first depth scale. In case the digital image is either a high frequency image or a low frequency image, a respective depth scaled value may be determined for each depth value associated with a picture element by reducing the depth value by the second depth scale. The first depth scale may be smaller than the second depth scale.</p><p id="p0065" num="0065">A detailed description of the various embodiments of noise floor and depth scale adaptation is provided below.</p><p id="p0066" num="0066"><figref idrefs="f0003">Fig. 4</figref> shows a flow diagram illustrating the determination of different edge numbers according to an embodiment.</p><p id="p0067" num="0067">As shown in <figref idrefs="f0003">Fig. 4</figref>, the edge map 211 as determined at 210 includes a plurality of edge values associated with a plurality of pixels or blocks of pixels. For each edge value or for each block of edge values, it is determined at 410 as to whether the edge value is higher than a predetermined high threshold "edge_Thr_H". In an example, the high threshold "edge_Thr_H" may have a value of 96. If the edge value is higher than the high threshold, the edge value is a high edge value, and the number of high edges is increased by 1.<!-- EPO <DP n="15"> --></p><p id="p0068" num="0068">For each edge value or for each block of edge values, it is determined at 420 as to whether the edge value is smaller than a predetermined low threshold "edge_Thr_L". In an example, the low threshold "edge_Thr_L" may have a value of 6. If the edge value is lower than the low threshold, the edge value is a low edge value, and the number of low edges is increased by 1.</p><p id="p0069" num="0069">The above determination may be made for all edge values of the edge map in a raster scan order, or any other suitable scan order, such that the total number of high edges and the total number of low edges in the edge map 211 may be determined, which represent a global classification of the edge values. The total number of high edges and the total number of low edges may be used to determine whether the digital image 210 from which the edge map 211 is determined is a high frequency image (i.e. an image in which the number of high edges is sufficiently high) or a low frequency image (i.e. in image in which the number of low edges is sufficiently high).</p><p id="p0070" num="0070"><figref idrefs="f0004">Fig. 5</figref> shows a flow diagram illustrating the determination of different edge regions according to an embodiment.</p><p id="p0071" num="0071">Different from <figref idrefs="f0003">Fig. 4</figref> wherein the number of high edges and low edges are determined for the edge map 211, the number of high edges and low edges are determined for each edge map region of the edge map 211 in <figref idrefs="f0004">Fig. 5</figref>.</p><p id="p0072" num="0072">The edge map 211 may be divided into NxM (e.g. 9x16) edge map regions, e.g. "region 1", "region 2", ...as shown in <figref idrefs="f0004">Fig. 5</figref>, wherein each edge map region may include a plurality of edge values associated with a plurality of picture elements.</p><p id="p0073" num="0073">For each edge map region, e.g. "region 1" 213, it is determined at 510 as to whether each edge value in the "region 1" 213 is higher than the predetermined high threshold "edge_Thr_H". If the edge value is higher than the high threshold, the edge value is a high edge value, and the number of high edges in "region 1" 213 is increased by 1.</p><p id="p0074" num="0074">For each edge map region, e.g. "region 1" 213, it is determined at 520 as to whether each edge value in the "region 1" 213 is smaller than the predetermined low threshold "edge_Thr_L". If the edge value is lower than the low threshold, the edge value is a low edge value, and the number of low edges is increased by 1.</p><p id="p0075" num="0075">After the above determination is made for all edge values of the "region 1" 213, the same determination may be made for other edge map regions of the edge map 211. Accordingly, the number of high edges and the number of low edges in each edge map<!-- EPO <DP n="16"> --> region may be determined according to <figref idrefs="f0004">Fig. 5</figref>, which represents a local classification of the edge values. The number of high edge values and the number of low edge values in the respective edge map region may be determined as the edge map region metric for the respective edge map region.</p><p id="p0076" num="0076">Depending on the number of high edges and the number of low edges determined for each edge map region and for the entire edge map, the edge map regions and the associated digital image may be classified into various types, which may be taken into account when determining the noise floor and depth scale.</p><p id="p0077" num="0077"><figref idrefs="f0005">Fig. 6</figref> shows a flow diagram illustrating the classification of the digital image 210 according to an embodiment.</p><p id="p0078" num="0078">As shown in <figref idrefs="f0005">Fig. 6</figref>, the number of high edges and the number of low edges determined for the edge map 211 in <figref idrefs="f0003">Fig. 4</figref> may be compared with a first frequency threshold value and a second frequency threshold value, respectively.</p><p id="p0079" num="0079">At 610, it is determined whether the number of high edges in the edge map 211 exceeds the first frequency threshold value. In case the number of high edges exceeds the first frequency threshold value, it is determined at 620 whether the number of low edges in the edge map 211 exceeds the second frequency threshold value. The second frequency threshold value may be different from the first frequency threshold value. In case the number of low edges in the edge map 211 does not exceed the second frequency threshold value, the digital image 201 associated with the edge map 211 is classified as a high frequency image having a high frequency characteristic. In case the number of low edges in the edge map 211 exceeds the second frequency threshold value at 620, the digital image 201 associated with the edge map 211 is classified as both high and low frequency image having both high frequency and low frequency characteristics.</p><p id="p0080" num="0080">In case the number of high edges does not exceed the first frequency threshold value at 610, it is determined at 630 whether the number of low edges in the edge map 211 exceeds the second frequency threshold value. In case the number of low edges in the edge map 211 exceeds the second frequency threshold value, the digital image 201 associated with the edge map 211 is classified as a low frequency image having a low frequency characteristic. In case the number of low edges in the edge map 211 does not exceed the second frequency threshold value at 630, the digital image 201 associated with the edge map<!-- EPO <DP n="17"> --> 211 is classified as neither high nor low frequency image having neither high frequency nor low frequency characteristics.</p><p id="p0081" num="0081">The determination of low frequency characteristic for the digital image may be independent from the determination of high frequency characteristic.</p><p id="p0082" num="0082">Similar to <figref idrefs="f0005">Fig. 6</figref>, each edge map region of the edge map 211 may be classified as to the high frequency or low frequency characteristics.</p><p id="p0083" num="0083"><figref idrefs="f0006">Fig. 7</figref> shows a flow diagram illustrating the classification of the edge map regions according to an embodiment.</p><p id="p0084" num="0084">As shown in <figref idrefs="f0006">Fig. 7</figref>, the number of high edges and the number of low edges determined for each edge map regions of the edge map 211 in <figref idrefs="f0004">Fig. 5</figref> may be compared with a first edge threshold value and a second edge threshold value, respectively.</p><p id="p0085" num="0085">At 710, it is determined whether the number of high edges in the edge map region 1 exceeds the first edge threshold value. In case the number of high edges exceeds the first edge threshold value, it is determined at 720 whether the number of low edges in the edge map region 1 exceeds the second edge threshold value. The second edge threshold value may be different from the first edge threshold value. In case the number of low edges the edge map region 1 does not exceed the second edge threshold value, the edge map region 1 may classified as a high frequency region having a high frequency characteristic. In case the number of low edges in the edge map region 1 exceeds the second edge threshold value at 720, the edge map region 1 is classified as both high and low frequency region having both high frequency and low frequency characteristics.</p><p id="p0086" num="0086">In case the number of high edges does not exceed the first edge threshold value at 710, it is determined at 730 whether the number of low edges in the edge map region 1 exceeds the second edge threshold value. In case the number of low edges in the edge map region 1 exceeds the second edge threshold value, the edge map region 1 is classified as a low frequency region having a low frequency characteristic. In case the number of low edges in the edge map region 1 does not exceed the second edge threshold value at 730, the edge map region 1 is classified as neither high nor low frequency region having neither high frequency nor low frequency characteristics.</p><p id="p0087" num="0087">The above determination may be made for each edge map regions of the edge map, such that each edge map regions is classified with regard to its high frequency or low frequency characteristics.<!-- EPO <DP n="18"> --></p><p id="p0088" num="0088">The determination of low frequency characteristic for the edge map regions may be independent from the determination of high frequency characteristic.</p><p id="p0089" num="0089">In the embodiments of <figref idrefs="f0005">Fig. 6</figref>, the determination as to whether the digital image is a high or low frequency image is based on the total number of high edges and the total number of low edges in the edge map as determined in <figref idrefs="f0003">Fig. 4</figref>.</p><p id="p0090" num="0090">In another embodiment, the determination as to whether the digital image is a high or low frequency image may be based on the number of high frequency regions and the number of low frequency regions in the edge map. For example, based on the classification of the edge map regions in the embodiment of <figref idrefs="f0006">Fig. 7</figref>, the number of edge map regions classified as high frequency regions may be counted as a first value, and the number of edge map regions classified as low frequency regions may be countered as a second value. The first value may be compared with the first frequency threshold value, and the second value may be compared with the second frequency threshold value, to determine whether the digital image is a high frequency image or a low frequency image.</p><p id="p0091" num="0091">Depending on the classification of the digital image and the edge map regions as in the embodiments of <figref idrefs="f0005">Figs. 6</figref> and <figref idrefs="f0006">7</figref> above, the noise floor and depth scale used in the determination of the depth image may be determined.</p><p id="p0092" num="0092"><figref idrefs="f0007">Fig. 8</figref> shows a flow diagram illustrating the determination of depth scale according to an embodiment.</p><p id="p0093" num="0093">At 810, it is determined whether the digital image is neither a high frequency image nor a low frequency image. In case the digital image is neither a high frequency image nor a low frequency image at 830, a first depth scale may be determined. In case the digital image is either a high frequency image or a low frequency image, or a both high and low frequency image at 850, a second depth scale may be determined. The first depth scale is lower than the second depth scale.</p><p id="p0094" num="0094">If the digital image is neither a high frequency image nor a low frequency image, the digital image may have intermediate frequency characteristics and may be blurry. A lower depth scale may be provided to scale up depth values compared with a digital image which is either a high frequency image or a low frequency image.</p><p id="p0095" num="0095"><figref idrefs="f0007">Fig. 9</figref> shows a flow diagram illustrating the determination of noise floor adaptation values according to an embodiment.<!-- EPO <DP n="19"> --></p><p id="p0096" num="0096">At 910, it is determined whether an edge map region the current pixel is in is a low frequency region. In case the current pixel is not located in a low frequency region at 930, a first noise floor adaptation value is determined. In case the current pixel is located in a low frequency region 950, a second noise floor adaptation value may be determined. The first noise floor adaptation value may be higher than the second noise floor adaptation value. Since the effect of the noise on the edge map to the depth image is more harmful in high frequency contents, a higher noise floor adaption value is used in high frequency edge map regions compared with low frequency edge map regions.</p><p id="p0097" num="0097">In the embodiment of <figref idrefs="f0007">Fig. 9</figref>, in case the region including the current pixel is not a low frequency region, the region may be a high frequency region, or a neither high nor low frequency region as determined in <figref idrefs="f0006">Fig. 7</figref>, for which a higher noise floor adaptation value is used. In case the region including the current pixel is a low frequency region, the region may also be a both high and low frequency region as determined in <figref idrefs="f0006">Fig. 7</figref>, for which a lower noise floor adaptation value is used.</p><p id="p0098" num="0098">In another embodiment, a higher noise adaptation value may be used for a high frequency region and a both high and low frequency region. A lower noise adaptation value may be used for a low frequency region. An intermediate noise adaptation value inbetween may be used for a neither high nor low frequency region.</p><p id="p0099" num="0099">The noise adaptation values and the depth scales as determined in accordance with the embodiments above may be used to adjust the depth values so as to determine a depth image.</p><p id="p0100" num="0100"><figref idrefs="f0008">Fig. 10</figref> shows a flow diagram illustrating the noise floor and depth scale adaptation according to an embodiment.</p><p id="p0101" num="0101">For a depth value associated with a pixel, a noise floor adaptation 1010 is performed to determine noise floor adapted depth values 1011, and a depth scaling 1020 is performed to determine the depth scaled values 1021. The depth scaled values 1021 may form the depth values in the determined depth image.</p><p id="p0102" num="0102">In the noise floor adaptation 1010, the similar operations of <figref idrefs="f0007">Fig. 9</figref> are performed. For example, at 910, it is determined whether the edge map region the current pixel is in is a low frequency region. In case the current pixel is not located in a low frequency region at 930, the depth value associated with the current pixel is reduced by a first noise floor adaptation value to determine the noise floor adapted depth value 1011. In case the current pixel is<!-- EPO <DP n="20"> --> located in a low frequency region 950, the depth value associated with the current pixel is reduced by a second noise floor adaptation value to determine the noise floor adapted depth value 1011. The first noise floor adaptation value may be higher than the second noise floor adaptation value.</p><p id="p0103" num="0103">In the depth scaling 1020, the similar operations of <figref idrefs="f0007">Fig. 8</figref> are performed. For example, at 810 it is determined whether the digital image is neither a high frequency image nor a low frequency image. In case the digital image is neither a high frequency image nor a low frequency image at 830, the depth value associated with the current pixel is reduced by a first depth scale to determine a new depth scaled value 1021. In case the digital image is either a high frequency image or a low frequency image, or a both high and low frequency image at 850, the depth value associated with the current pixel is reduced by a second depth scale to determine a new depth scaled value 1021. The first depth scale is lower than the second depth scale.</p><p id="p0104" num="0104">The finally determined depth image may include depth values adapted by noise floor adaptation values and scaled by the depth scales, which may be determined by a mapping from the edge map.</p><p id="p0105" num="0105">In an embodiment as shown in <figref idrefs="f0009">Fig. 11</figref>, the depth values of the depth image may be determined using the edge values of the edge map via a piece-wise linear mapping function.</p><p id="p0106" num="0106">The x-axis and y-axis represent edge values and depth values, respectively. The edge lower bound value 1111 represents the noise floor value, which may be determined in accordance with the above embodiments. Edge values below the edge lower bound value 1111 may be assigned with the highest depth value, as shown in <figref idrefs="f0009">Fig. 11</figref>. The depth range 1121 defines how much depth variation may be obtained based on the edge value variations. The tangent of the mapping function, Theta 1131, represents the depth scale as determined in accordance with the above embodiments. A low depth scale value may push regions of the image more to the background, whereas a high depth scale value may push regions of the image more to the foreground. A range of edge values below the maximum edge value 1113 may be mapped to the same depth value, e.g. the lowest depth value representing the foreground object.</p><p id="p0107" num="0107">In another embodiment, the depth image may be determined by mapping the edge map using other suitable mapping functions. For example, when a look-up table is provided,<!-- EPO <DP n="21"> --> a S-curve mapping function may be used, wherein the noise floor may also be used to set the starting point of the S-curve and the depth scale factor may be used for blending coefficient</p><p id="p0108" num="0108">The embodiments above provide a method and a device for determining a depth image indicating the relative depth of the objects in the digital image, i.e., which objects are in the front and which objects are at the back, using a 2D digital image (i.e. a single viewpoint image). Based on the determined depth image, 2D images or videos may be converted to 3D images or videos. The method and the device of the various embodiments provide a depth image with more accuracy, by adjusting noise elimination level and depth scale level based on the high or low frequency characteristics of the image and its edge map regions.</p><p id="p0109" num="0109"><figref idrefs="f0009">FIG. 12</figref> shows an imaging system according to an embodiment.</p><p id="p0110" num="0110">The imaging system 1200 receives an image 1201, which may be a digital image 201 as described above.</p><p id="p0111" num="0111">The imaging system 1200 includes an image processing device 1210 for determining a depth image for each image 1201 in accordance with the various embodiments above. The determined depth image 1211 is transmitted to an image render 1220.</p><p id="p0112" num="0112">The image render 1220 may receive the image 1201 and the depth map 1211 and render the image 1201 for 3D display.</p><p id="p0113" num="0113">The imaging system 1200 may be embodied in a 3D TV or a computer, for example.</p><p id="p0114" num="0114">The method and the device for determining the depth image in the above embodiments provide accurate depth values, by subtracting out edge noise effects and scaling edge values based on the high or low frequency characteristics of the image and its edge map regions. In addition, the method and the device are based on the 2D images or videos, which enables displaying of 2D content in a 3D display and may also be used in any other areas in which the depth information or the information about the location of the objects in a scene is required.</p><p id="p0115" num="0115">While the invention has been particularly shown and described with reference to specific embodiments, it should be understood by those skilled in the art that various changes in form and detail may be made therein without departing from the spirit and scope of the invention as defined by the appended claims. The scope of the invention is thus indicated by the appended claims and all changes which come within the meaning and range of equivalency of the claims are therefore intended to be embraced.</p></description><claims mxw-id="PCLM56976397" lang="EN" load-source="patent-office"><!-- EPO <DP n="22"> --><claim id="c-en-0001" num="0001"><claim-text>A method for determining a depth image for a digital image comprising a plurality of picture elements, the method comprising:
<claim-text>• edge filtering the digital image to determine an edge map, the edge map comprising a plurality of edge values, wherein each edge value is associated with at least one picture element;</claim-text>
<claim-text>• determining for each edge map region of a plurality of edge map regions an edge map region metric;</claim-text>
<claim-text>• determining for each edge map region as to whether the respective edge map region metric fulfills a predefined criterion;</claim-text>
<claim-text>• determining the number of edge map regions for which the respective edge map region metric fulfills the predefined criterion as a first value;</claim-text>
<claim-text>• determining the number of edge map regions for which the respective edge map region metric does not fulfill the predefined criterion as a second value; and</claim-text>
<claim-text>• determining the depth image using the first value and the second value.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>The method of claim 1,<br/>
wherein the determining the depth image comprises:
<claim-text>• determining for each picture element associated with a depth value as to whether the picture element is located in an edge map region for which the respective edge map region metric fulfills the predefined criterion;</claim-text>
<claim-text>• in case the picture element is located in an edge map region for which the respective edge map region metric fulfills the predefined criterion, reducing the associated depth value by a first noise floor adaptation value to determine a noise floor adapted depth value;</claim-text>
<claim-text>• in case the picture element is located in an edge map region for which the respective edge map region metric does not fulfill the predefined criterion, reducing the associated depth value by a second noise floor adaptation value to<!-- EPO <DP n="23"> --> determine a noise floor adapted depth value, wherein the second noise floor adaptation value is smaller than the first noise floor adaptation value;</claim-text>
<claim-text>• wherein the depth image comprises the respectively determined noise floor adapted depth values.</claim-text></claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>The method of any one of claims 1 or 2,<br/>
wherein the determining the depth image comprises:
<claim-text>• determining as to whether the digital image is a high frequency image or a low frequency image based on the first value and the second value;</claim-text>
<claim-text>• in case the digital image is neither a high frequency image nor a low frequency image, determining for each depth value associated with a picture element a respective depth scaled value by reducing the depth value by a first depth scale; and</claim-text>
<claim-text>• in case the digital image is either a high frequency image or a low frequency image, determining for each depth value associated with a picture element a respective depth scaled value by reducing the depth value by a second depth scale, wherein the first depth scale is smaller than the second depth scale.</claim-text></claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>The method of any one of claims 1 to 3,<br/>
wherein the predefined criterion is whether the edge map region metric exceeds a first predefined edge threshold value.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>The method of any one of claims 1 to 4,<br/>
wherein not fulfilling the predefined criterion is whether the edge map region metric exceeds a second predefined edge threshold value.</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>The method of claims 4 and 5,<br/>
wherein the first predefined edge threshold value is different from the second predefined edge threshold value.</claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>The method of any one of claims 1 to 6,<br/>
<!-- EPO <DP n="24"> -->wherein determining as to whether the digital image is a high frequency image or a low frequency image comprises:
<claim-text>• determining that the digital image is a high frequency image in case the first value exceeds a first frequency threshold value;</claim-text>
<claim-text>• determining that the digital image is a low frequency image in case the second value exceeds a second frequency threshold value, the second frequency threshold value being different from the first frequency threshold value.</claim-text></claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>A device for determining a depth image for a digital image comprising a plurality of picture elements, the device comprising:
<claim-text>an edge filter configured to filter the digital image to determine an edge map, the edge map comprising a plurality of edge values, wherein each edge value is associated with at least one picture element;</claim-text>
<claim-text>a processor configured to
<claim-text>• determine for each edge map region of a plurality of edge map regions an edge map region metric;</claim-text>
<claim-text>• determine for each edge map region as to whether the respective edge map region metric fulfills a predefined criterion;</claim-text>
<claim-text>• determine the number of edge map regions for which the respective edge map region metric fulfills the predefined criterion as a first value;</claim-text>
<claim-text>• determine the number of edge map regions for which the respective edge map region metric does not fulfill the predefined criterion as a second value;</claim-text>
<claim-text>• determine the depth image using the first value and the second value.</claim-text></claim-text></claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>The device of claim 8,<br/>
wherein the processor is configured to determine the depth image such that it comprises:
<claim-text>• determining for each picture element associated with a depth value as to whether the picture element is located in an edge map region for which the respective edge map region metric fulfills the predefined criterion;</claim-text>
<claim-text>• in case the picture element is located in an edge map region for which the respective edge map region metric fulfills the predefined criterion, reducing the<!-- EPO <DP n="25"> --> associated depth value by a first noise floor adaptation value to determine a noise floor adapted depth value;</claim-text>
<claim-text>• in case the picture element is located in an edge map region for which the respective edge map region metric does not fulfill the predefined criterion, reducing the associated depth value by a second noise floor adaptation value to determine a noise floor adapted depth value, wherein the second noise floor adaptation value is smaller than the first noise floor adaptation value;</claim-text>
<claim-text>• wherein the depth image comprises the respectively determined noise floor adapted depth values.</claim-text></claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>The device of any one of claims 8 or 9,<br/>
wherein the processor is configured to determine the depth image such that it comprises:
<claim-text>• determining as to whether the digital image is a high frequency image or a low frequency image based on the first value and the second value;</claim-text>
<claim-text>• in case the digital image is neither a high frequency image nor a low frequency image, determining for each depth value associated with a picture element a respective depth scaled value by reducing the depth value by a first depth scale; and</claim-text>
<claim-text>• in case the digital image is either a high frequency image or a low frequency image, determining for each depth value associated with a picture element a respective depth scaled value by reducing the depth value by a second depth scale, wherein the first depth scale is smaller than the second depth scale;</claim-text></claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>The device of any one of claims 8 to 10,<br/>
wherein the predefined criterion is whether the edge map region metric exceeds a first predefined edge threshold value.</claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>The device of any one of claims 8 to 11,<br/>
wherein not fulfilling the predefined criterion is whether the edge map region metric exceeds a second predefined edge threshold value.<!-- EPO <DP n="26"> --></claim-text></claim><claim id="c-en-0013" num="0013"><claim-text>The device of claims 11 and 12,<br/>
wherein the first predefined edge threshold value is different from the second predefined edge threshold value.</claim-text></claim><claim id="c-en-0014" num="0014"><claim-text>The device of any one of claims 8 to 13,<br/>
wherein the processor is configured to determine as to whether the digital image is a high frequency image or a low frequency image such that it comprises:
<claim-text>• determining that the digital image is a high frequency image in case the first value exceeds a first frequency threshold value;</claim-text>
<claim-text>• determining that the digital image is a low frequency image in case the second value exceeds a second frequency threshold value, the second frequency threshold value being different from the first frequency threshold value.</claim-text></claim-text></claim></claims><drawings mxw-id="PDW16667178" load-source="patent-office"><!-- EPO <DP n="27"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="161" he="152" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="28"> --><figure id="f0002" num="2,3"><img id="if0002" file="imgf0002.tif" wi="165" he="164" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="29"> --><figure id="f0003" num="4"><img id="if0003" file="imgf0003.tif" wi="165" he="98" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="30"> --><figure id="f0004" num="5"><img id="if0004" file="imgf0004.tif" wi="165" he="119" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="31"> --><figure id="f0005" num="6"><img id="if0005" file="imgf0005.tif" wi="165" he="119" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="32"> --><figure id="f0006" num="7"><img id="if0006" file="imgf0006.tif" wi="165" he="119" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="33"> --><figure id="f0007" num="8,9"><img id="if0007" file="imgf0007.tif" wi="165" he="199" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="34"> --><figure id="f0008" num="10"><img id="if0008" file="imgf0008.tif" wi="165" he="223" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="35"> --><figure id="f0009" num="11,12"><img id="if0009" file="imgf0009.tif" wi="165" he="223" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="157" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="159" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
