<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2680519-A1" country="EP" doc-number="2680519" kind="A1" date="20140101" family-id="46384243" file-reference-id="318307" date-produced="20180824" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146549169" ucid="EP-2680519-A1"><document-id><country>EP</country><doc-number>2680519</doc-number><kind>A1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-12174076-A" is-representative="YES"><document-id mxw-id="PAPP154823092" load-source="docdb" format="epo"><country>EP</country><doc-number>12174076</doc-number><kind>A</kind><date>20120628</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140450626" ucid="EP-12174076-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>12174076</doc-number><kind>A</kind><date>20120628</date></document-id></priority-claim></priority-claims><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988120333" load-source="docdb">H04L  27/36        20060101ALI20120921BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988123151" load-source="docdb">H04L  25/03        20060101AFI20120921BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988130276" load-source="docdb">H03F   1/32        20060101ALI20120921BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL1991318300" load-source="docdb" scheme="CPC">H04L  25/03891     20130101 FI20131226BHEP        </classification-cpc><classification-cpc mxw-id="PCL2119719428" load-source="docdb" scheme="CPC">H03F   3/24        20130101 LI20140924BHEP        </classification-cpc><classification-cpc mxw-id="PCL2119720814" load-source="docdb" scheme="CPC">H04L  25/03343     20130101 LI20140924BHEP        </classification-cpc><classification-cpc mxw-id="PCL2119721275" load-source="docdb" scheme="CPC">H04L  27/368       20130101 LI20140924BHEP        </classification-cpc><classification-cpc mxw-id="PCL2119722142" load-source="docdb" scheme="CPC">H03F   3/195       20130101 LI20140924BHEP        </classification-cpc><classification-cpc mxw-id="PCL2119722732" load-source="docdb" scheme="CPC">H04L  25/49        20130101 LA20140924BHEP        </classification-cpc><classification-cpc mxw-id="PCL2119727355" load-source="docdb" scheme="CPC">H03F   1/3241      20130101 LI20140924BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132179991" lang="DE" load-source="patent-office">Vorentzerrer für ein digital moduliertes HF-Signal und Verfahren</invention-title><invention-title mxw-id="PT132179992" lang="EN" load-source="patent-office">Pre-equalizer for a digitally modulated RF signal and method</invention-title><invention-title mxw-id="PT132179993" lang="FR" load-source="patent-office">Pré-égaliseur pour signal RF modulé numériquement et procédé</invention-title><citations><patent-citations><patcit mxw-id="PCIT242651998" load-source="docdb" ucid="US-20050123066-A1"><document-id format="epo"><country>US</country><doc-number>20050123066</doc-number><kind>A1</kind><date>20050609</date></document-id><sources><source name="SEA" category="X" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242651999" load-source="docdb" ucid="US-20100134255-A1"><document-id format="epo"><country>US</country><doc-number>20100134255</doc-number><kind>A1</kind><date>20100603</date></document-id><sources><source name="APP" created-by-npl="N"/></sources></patcit><patcit mxw-id="PCIT242652000" load-source="docdb" ucid="US-20110068868-A1"><document-id format="epo"><country>US</country><doc-number>20110068868</doc-number><kind>A1</kind><date>20110324</date></document-id><sources><source name="SEA" category="X" created-by-npl="N"/></sources></patcit></patent-citations><non-patent-citations><nplcit><text>TOMLINSON M:  "NEW AUTOMATIC EQUALISER EMPLOYING MODULO ARITHMETIC", ELECTRONICS LETTERS, IEE STEVENAGE, GB, vol. 7, no. 5/06, 25 March 1971 (1971-03-25), page 138/139, XP000761097, ISSN: 0013-5194</text><sources><source mxw-id="PNPL45130804" load-source="docdb" name="SEA" category="I"/></sources></nplcit></non-patent-citations></citations></technical-data><parties><applicants><applicant mxw-id="PPAR918163875" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>NXP BV</last-name><address><country>NL</country></address></addressbook></applicant><applicant mxw-id="PPAR918135696" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>NXP B.V.</last-name></addressbook></applicant><applicant mxw-id="PPAR918987085" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>NXP B.V.</last-name><iid>100810158</iid><address><street>High Tech Campus 60</street><city>5656 AG Eindhoven</city><country>NL</country></address></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918137587" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>VAN DE BEEK REMCO</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR918160843" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>VAN DE BEEK, REMCO</last-name></addressbook></inventor><inventor mxw-id="PPAR918989680" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>VAN DE BEEK, REMCO</last-name><address><street>NXP B.V. High Tech Campus 60</street><city>5656 AG Eindhoven</city><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR918137223" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>CIACCI MASSIMO</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR918139419" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>CIACCI, MASSIMO</last-name></addressbook></inventor><inventor mxw-id="PPAR918990094" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>CIACCI, MASSIMO</last-name><address><street>NXP B.V. High Tech Campus 60</street><city>5656 AG Eindhoven</city><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR918134406" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>VERLINDEN JOS</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR918148030" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>VERLINDEN, JOS</last-name></addressbook></inventor><inventor mxw-id="PPAR918991767" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>VERLINDEN, JOS</last-name><address><street>NXP B.V. High Tech Campus 60</street><city>5656 AG Eindhoven</city><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR918136322" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>AL-KADI GHIATH</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR918137717" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>AL-KADI, GHIATH</last-name></addressbook></inventor><inventor mxw-id="PPAR918988938" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>AL-KADI, GHIATH</last-name><address><street>NXP B.V. High Tech Campus 60</street><city>5656 AG Eindhoven</city><country>NL</country></address></addressbook></inventor></inventors><agents><agent mxw-id="PPAR918988804" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Krott, Michel</last-name><iid>101128573</iid><address><street>NXP B.V. IP &amp; Licensing Department High Tech Campus 60</street><city>5656 AG Eindhoven</city><country>NL</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS548852746" load-source="docdb">AL</country><country mxw-id="DS548847830" load-source="docdb">AT</country><country mxw-id="DS548852748" load-source="docdb">BE</country><country mxw-id="DS548853519" load-source="docdb">BG</country><country mxw-id="DS548867478" load-source="docdb">CH</country><country mxw-id="DS548837189" load-source="docdb">CY</country><country mxw-id="DS548847831" load-source="docdb">CZ</country><country mxw-id="DS548852749" load-source="docdb">DE</country><country mxw-id="DS548837190" load-source="docdb">DK</country><country mxw-id="DS548837191" load-source="docdb">EE</country><country mxw-id="DS548802713" load-source="docdb">ES</country><country mxw-id="DS548853520" load-source="docdb">FI</country><country mxw-id="DS548853521" load-source="docdb">FR</country><country mxw-id="DS548852750" load-source="docdb">GB</country><country mxw-id="DS548837192" load-source="docdb">GR</country><country mxw-id="DS548852751" load-source="docdb">HR</country><country mxw-id="DS548847832" load-source="docdb">HU</country><country mxw-id="DS548867479" load-source="docdb">IE</country><country mxw-id="DS548837193" load-source="docdb">IS</country><country mxw-id="DS548853526" load-source="docdb">IT</country><country mxw-id="DS548837194" load-source="docdb">LI</country><country mxw-id="DS548801667" load-source="docdb">LT</country><country mxw-id="DS548847833" load-source="docdb">LU</country><country mxw-id="DS548801668" load-source="docdb">LV</country><country mxw-id="DS548801669" load-source="docdb">MC</country><country mxw-id="DS548847613" load-source="docdb">MK</country><country mxw-id="DS548847614" load-source="docdb">MT</country><country mxw-id="DS548802878" load-source="docdb">NL</country><country mxw-id="DS548853527" load-source="docdb">NO</country><country mxw-id="DS548847615" load-source="docdb">PL</country><country mxw-id="DS548867480" load-source="docdb">PT</country><country mxw-id="DS548802879" load-source="docdb">RO</country><country mxw-id="DS548867481" load-source="docdb">RS</country><country mxw-id="DS548847616" load-source="docdb">SE</country><country mxw-id="DS548867482" load-source="docdb">SI</country><country mxw-id="DS548853528" load-source="docdb">SK</country><country mxw-id="DS548847617" load-source="docdb">SM</country><country mxw-id="DS548837195" load-source="docdb">TR</country></ep-contracting-states><ep-extended-states><ep-extended-state-data><country>BA</country></ep-extended-state-data><ep-extended-state-data><country>ME</country></ep-extended-state-data></ep-extended-states></designated-states></international-convention-data></bibliographic-data><abstract mxw-id="PA128669839" lang="EN" load-source="patent-office"><p id="pa01" num="0001">A method for pre-equalizing a digital modulated RF signal is presented. The method comprises receiving an input stream of symbols (x(i)) representing a phase change and magnitude of an RF signal, the magnitudes of the symbols in the input stream are constant, the phase changes of the symbols in the input stream encode digital information, and adjusting the input stream of symbols to reduce inter-symbol interference in transmission of an RF signal modulated according to the input stream, thus obtaining an equalized stream of symbols (x'(i)), each symbol of the equalized stream representing a phase change and magnitude of an RF signal. The adjusting comprising iteratively determining a next symbol of the equalized stream (x'(n)) after receiving a next symbol of the input stream (x(n)) by multiplying said next symbol of the input stream (x(n)) with a next adjusting real number (a(n)),<br/>
multiplying a previous symbol of the input stream (x(n-1)) with a previous adjusting real number (a(n-1)), said previous symbol being received directly before said next symbol of the input stream, and computing the next symbol of the equalized stream from the multiplied next symbol of the input stream and the multiplied previous symbol of the input stream.
<img id="iaf01" file="imgaf001.tif" wi="101" he="68" img-content="drawing" img-format="tif"/></p></abstract><abstract mxw-id="PA128499212" lang="EN" source="EPO" load-source="docdb"><p>A method for pre-equalizing a digital modulated RF signal is presented. The method comprises receiving an input stream of symbols (x(i)) representing a phase change and magnitude of an RF signal, the magnitudes of the symbols in the input stream are constant, the phase changes of the symbols in the input stream encode digital information, and adjusting the input stream of symbols to reduce inter-symbol interference in transmission of an RF signal modulated according to the input stream, thus obtaining an equalized stream of symbols (x'(i)), each symbol of the equalized stream representing a phase change and magnitude of an RF signal. The adjusting comprising iteratively determining a next symbol of the equalized stream (x'(n)) after receiving a next symbol of the input stream (x(n)) by multiplying said next symbol of the input stream (x(n)) with a next adjusting real number (a(n)), 
multiplying a previous symbol of the input stream (x(n-1)) with a previous adjusting real number (a(n-1)), said previous symbol being received directly before said next symbol of the input stream, and computing the next symbol of the equalized stream from the multiplied next symbol of the input stream and the multiplied previous symbol of the input stream.</p></abstract><description mxw-id="PDES63955269" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><b>FIELD OF THE INVENTION</b></heading><p id="p0001" num="0001">The invention relates to a method for pre-equalizing a digitally modulated RF signal, the method comprising
<ul><li>receiving an input stream of symbols (x(i)) representing a phase change and magnitude of an RF signal, the magnitudes of the symbols in the input stream are constant, the phase changes of the symbols in the input stream encode digital information,</li><li>adjusting the input stream of symbols to reduce inter-symbol interference in transmission of an RF signal modulated according to the input stream, thus obtaining an equalized stream of symbols (x'(i)), each symbol of the equalized stream representing a phase change and magnitude of an RF signal,</li><li>the adjusting comprising iteratively determining a next symbol of the equalized stream (x'(n)) after receiving a next symbol of the input stream (x(n)) by</li><li>computing the next symbol of the equalized stream from the next symbol of the input stream and the previous symbol of the input stream.</li></ul></p><heading id="h0002"><b>BACKGROUND OF THE INVENTION</b></heading><p id="p0002" num="0002">Digital data communication over a wireless channel is used in a variety of applications. One way to encode digital information in an RF signal is by manipulating the phase of the signal in dependence on the digital information which is to be transmitted. At the receiving end the phase changes are detected and the digital information is reconstructed. Transmitting data by encoding the information in phase changes is referred to as phase-shift keying (PSK). For example, it conveys data by modulating the phase of a reference signal (the carrier wave).</p><p id="p0003" num="0003">Phase-shift keying (PSK) is used in a variety of applications such as: communication to and from RFID tags, wireless LAN, including Wi-Fi, and Bluetooth. PSK may use a finite number of phases to represent digital data, also called symbols. Each phase may be assigned a unique pattern of binary digits.</p><p id="p0004" num="0004">At the transmitter side, a modulator maps digital information to a sequence of symbols which in turn is encoded in the phase changes of a signal which is to be transmitted using an antenna. At the receiver end, a demodulator determines the phase of the received signal and maps it back to the symbol it represents, thus recovering the original digital<!-- EPO <DP n="2"> --> information. Typically, the demodulator is designed specifically for the symbol-set used by the modulator.</p><p id="p0005" num="0005">The phase may be defined with respect to a reference signal, or with respect to a previous phase. In the first case, the demodulator of the receiver compares the phase of the received signal to the reference signal. In the latter case, the demodulator determines the changes in the phase of the received signal rather than the phase relative to a reference wave; this approach is termed differential phase-shift keying (DPSK) since it depends on the difference between successive phases.</p><p id="p0006" num="0006">When communicating over a wireless channel, one of the sources of error on the received data is inter-symbol interference (ISI), meaning that received symbols are affected by surrounding (typically past) transmitted symbols, for example due to a bandwidth limited physical channel. One of the methods to reduce ISI is to pre-equalize the signal applied to the channel on the transmitter side such that after passing through the channel, the ISI is zero. The intended signal, i.e., the phase modulated signal encoding the digital information, is modified before it is broadcasted over the antenna, anticipating the distortions that are going to occur due to inter-symbol interference. In the ideal case, the signal is received exactly as intended since the distortion that occurred exactly cancelled the pre-equalization.</p><p id="p0007" num="0007">One approach to pre-equalization is to apply a linear filter with a transfer that is the inverse of the channel transfer, so that the combination of filter plus channel is ISI free. This technique is referred to as zero-forcing equalization. A known signal distortion pre-compensation process is given in <patcit id="pcit0001" dnum="US20100134255A1"><text>US patent application 2010/0134255 A1</text></patcit>, "RIFD device, RFID system and signal distortion pre-compensation process in RFID system", incorporated herein by reference. The known signal distortion pre-compensation process is applied to an RFID system. An RFID device comprises an interface for transmitting wireless carrier and data signals to a remote RFID transponder. Carrier and data signal pre-compensation means are arranged between the antenna and the data signal processing means of the RFID device. The carrier and data signal pre-compensation means are adapted to pre-compensate signal distortions of the carrier and data signals caused by quality factors of the device air interface and the transponder air interface of the RFID device and the RFID transponder, respectively.</p><heading id="h0003"><b>SUMMARY OF THE INVENTION</b></heading><p id="p0008" num="0008">Although zero-forcing equalization works well to reduce inter-symbol interference there is a drawback. The inventor has realized that a constant amplitude signal which is pre-equalized using zero-forcing equalization does not have constant amplitude anymore after the pre-equalization. A constant magnitude is also known as a constant envelope. This means that amplifiers must be used which take varying magnitudes into account.<!-- EPO <DP n="3"> --></p><p id="p0009" num="0009">It would be advantageous to have an improved method for pre-equalizing a digital modulated RF signal. The improved method comprises receiving an input stream of symbols representing a phase change and magnitude of an RF signal, the magnitudes of the symbols in the input stream are constant, the phase changes of the symbols in the input stream encode digital information and adjusting the input stream of symbols to reduce inter-symbol interference in transmission of an RF signal modulated according to the input stream, thus obtaining an equalized stream of symbols, each symbol of the equalized stream representing a phase change and magnitude of an RF signal. The adjusting comprises iteratively determining a next symbol of the equalized stream after receiving a next symbol of the input stream by multiplying said next symbol of the input stream with a next adjusting real number, multiplying a previous symbol of the input stream with a previous adjusting real number, said previous symbol being received directly before said next symbol of the input stream, and computing the next symbol of the equalized stream from the multiplied next symbol of the input stream and the multiplied previous symbol of the input stream.</p><p id="p0010" num="0010">In conventional zero-forcing pre-equalization an input stream of symbols is also adjusted to take into account the inter-symbol interference that would occur during transmission of an RF signal modulated according to the input stream. The inter-symbol interference is determined with respect to a prediction of the RF channel. If the RF channel is exactly as predicted, the inter-symbol interference would exactly cancel. In particular if the input stream has constant magnitude, the stream that would be received across the channel has also constant magnitude. The inventors had the insight that in a phase-shift keying (PSK) no information is encoded in the magnitude. Thus there is no need for the symbols to have constant magnitude after transmission. On the other hand at the side of the transmitter, it would be advantageous if the equalized symbols have constants magnitude, since this allows an power-efficient switching amplifier to be used. However, zero-forcing pre-equalization does not have the flexibility to influence the equalized symbols in any way. Accordingly, with zero-forcing pre-equalization one cannot arrange a constant magnitude equalized stream by sacrificing constant magnitude after transmission.</p><p id="p0011" num="0011">The reduction of inter-symbol interference in transmission of an RF signal modulated according to the input stream may be measured with respect to a model of the RF channel, e.g., a prediction. Typically, the model is expressed as a single complex number, referred to as the 'pole'.</p><p id="p0012" num="0012">The pre-equalization scheme according comprises multiplying the symbols of the input stream with adjusting real numbers. This gives a much more versatile equalizer which can take the above wishes into account. Typically the next adjusting real number is not equal to the previous adjusting real number. Typically the next adjusting real number is not precisely equal to one.<!-- EPO <DP n="4"> --></p><p id="p0013" num="0013">The input stream is obtained from some digital source, say a digital processor e.g. a CPU, which encodes a stream of digital information into the input stream, by selecting the symbols of the input stream from a set of constellation points of a phase-shift keying digital modulation scheme. The use of symbols, <i>per</i> se, is well known in digital modulation of RF signals. Usually, a symbol is comprises a combination of an in-phase (I) and quadrature (Q) component. The in-phase and quadrature components are often represented as a complex number. In an implementation the in-phase and quadrature component may be represented digitally, or analog. Alternatively, a symbol may be represented by a combination of magnitude and phase. Magnitude/phase representation can be converted into in-phase (I) / quadrature (Q) representation, or vice versa, as desired. The symbols in the input stream and adjusted input stream may be represented as digital symbols. Computing the adjusted input stream may be implemented as software running on a computer processor.</p><p id="p0014" num="0014">In an embodiment, an adjusting stream of adjusting real numbers is generated iteratively. Each symbol in the input stream is multiplied with a corresponding number in the adjusting stream. Generating the adjusting stream comprises, after receiving the next symbol of the input stream determining the next adjusting real number of the adjusting stream, the next adjusting real number of the adjusting stream depending on said next symbol of the input stream, said previous symbol of the input stream and the previous adjusting real number in the adjusting stream of adjusting real numbers. The dependence may be expressed as a formula.</p><p id="p0015" num="0015">In an embodiment, the next symbol of the equalized stream is computed by multiplying said multiplied previous symbol with a predictive complex number (p) indicating the predicted RF channel and adding to the result said multiplied next symbol. Representing an RF channel with a predictive complex number (p), per se, is known in the art. This model is sometimes referred to as the single-pole channel.</p><p id="p0016" num="0016">In an embodiment, the adjusting stream depends only on the next symbol of the input stream, the previous symbol of the input stream, the previous adjusting real number in the adjusting stream and the predictive complex number.</p><p id="p0017" num="0017">It would be most advantageous if the magnitudes of the symbols in the equalized stream of symbols are, for practical purposes, equal. If the magnitudes are not exactly equal using a switching amplifier may add a small amount of distortion, but as long as these distortions are within the tolerances for the receiver of the transmitted stream, this is not a problem. This allows the use of approximations of the adjusting stream. For example, in an embodiment, the magnitude of the symbols in the equalized stream of symbols (x'(i)) are within a target magnitude multiplied with an upper-margin and target magnitude multiplied with a lower-margin, wherein the upper-margin is 1.1 and the lower-margin is 0.9.</p><p id="p0018" num="0018">The pre-equalization may be used in wireless communication applications using pure phase-shift keying (PSK) or 4-QAM. An example of such an application is very-high bit rate RFID communication according to the VHBR ISO14443 amendment, PSK version.<!-- EPO <DP n="5"> --></p><p id="p0019" num="0019">An aspect of the invention concerns a method for transmitting a digital modulated signal comprising the method of pre-equalizing a digital modulated signal as in any one of the preceding claims and further comprising, upconverting the equalized stream of symbols into an RF signal, and, in particular, amplifying the RF signal using a switching power amplifier. A switching power amplifier (also known as a Class D amplifier) is an electronic amplifier where all power devices (usually MOSFETs) are operated as binary switches. Switching power amplifier are particularly power efficient, however when used on a signal with non-constant amplitude they are known to easily distort the signal. By using an equalized stream with an (approximately) constant magnitude these amplifiers reduce power loss significantly, without losing fidelity.</p><p id="p0020" num="0020">An aspect of the invention is a pre-equalizer for use in a digital modulation RF transmitter. The pre-equalizer comprises an input interface for receiving an input stream of symbols (x(i)) representing a phase change and magnitude of an RF signal, the magnitudes of the symbols in the input stream are constant, the phase changes of the symbols in the input stream encode digital information, and an output interface for outputting an equalized stream of symbols (x'(i)) obtained by adjusting the input stream of symbols to reduce inter-symbol interference in transmission of an RF signal modulated according to the input stream, each symbol of the equalized stream representing a phase change and magnitude of an RF signal. The pre-equalizer is configured to iteratively determine a next symbol of the equalized stream (x'(n)) after receiving a next symbol of the input stream (x(n)), the pre-equalizer comprises a first multiplier configured to multiply said next symbol of the input stream (x(n)) with a next adjusting real number (a(n)), a second multiplier configured to multiply a previous symbol of the input stream (x(n-1)) with a previous adjusting real number (a(n-1)), said previous symbol being received directly before said next symbol of the input stream, and a symbol combiner configure to compute the next symbol of the equalized stream from the multiplied next symbol of the input stream and the multiplied previous symbol of the input stream.</p><p id="p0021" num="0021">An embodiment of the pre-equalizer comprises an adjustment stream source configured to iteratively generate an adjusting stream of adjusting real numbers, by after receiving the next symbol of the input stream determining the next adjusting real number of the adjusting stream, the next adjusting real number of the adjusting stream depending on said next symbol of the input stream, said previous symbol of the input stream and the previous adjusting real number in the adjusting stream of adjusting real numbers.</p><p id="p0022" num="0022">An aspect of the invention is a digital modulation RF transmitter comprising a pre-equalizer, an upconverter configured to upconvert the equalized stream of symbols into an RF signal, and, preferably, a switching power amplifier configured to amplifying the RF signal of the upconverter.<!-- EPO <DP n="6"> --></p><p id="p0023" num="0023">The pre-equalizer is preferably implemented as an electronic device, in particular a mobile electronic device, e.g., a mobile phone, RFID device, RFID transponder, Wi-Fi and/or Bluetooth device, etc.</p><p id="p0024" num="0024">A method according to the invention may be implemented on a computer as a computer implemented method, or in dedicated hardware, or in a combination of both. Executable code for a method according to the invention may be stored on a computer program product. Examples of computer program products include memory devices, optical storage devices, integrated circuits, servers, online software, etc. Preferably, the computer program product comprises non-transitory program code means stored on a computer readable medium for performing a method according to the invention when said program product is executed on a computer</p><p id="p0025" num="0025">In a preferred embodiment, the computer program comprises computer program code means adapted to perform all the steps of a method according to the invention when the computer program is run on a computer. Preferably, the computer program is embodied on a computer readable medium.</p><p id="p0026" num="0026">A method and circuitry for active transmitter-side pre-equalization in phase-shift keying (PSK) communication systems is proposed, removing inter-symbol interference from the channel output and allowing a power-efficient constant-envelope power amplifier to be used in the transmitter. The method uses a pre-equalizer that calculates the necessary phase of the channel input signal (given its constant amplitude) in order to cancel inter-symbol interference for optimum signal reception on receiver side. An added benefit is that the power contained in the received signal is significantly higher than when using conventional zero-forcing pre-equalization.</p><heading id="h0004"><b>BRIEF DESCRIPTION OF THE DRAWINGS</b></heading><p id="p0027" num="0027">These and other aspects of the invention are apparent from and will be elucidated with reference to the embodiments described hereinafter. In the drawings,
<ul><li><figref idrefs="f0001">Figure 1</figref> constellation diagram illustrating zero-forcing pre-equalization,</li><li><figref idrefs="f0001">Figure 2</figref> constellation diagram illustrating phase-only pre-equalization,</li><li><figref idrefs="f0002">Figure 3</figref> schematic block diagram illustrating an implementation of a phase-only pre-equalizer,</li><li><figref idrefs="f0003 f0004">Figure 4-9</figref> constellation diagram illustrating simulated results,</li><li><figref idrefs="f0005">Figure 10</figref> shows formulas illustrating streams,</li><li><figref idrefs="f0006">Figure 11a</figref>, <figref idrefs="f0007">11b</figref>, <figref idrefs="f0008">11c</figref>, <figref idrefs="f0009">11d</figref> illustrates embodiments of a pre-equalizer,</li><li><figref idrefs="f0010">Figure 12</figref> shows formulas illustrating phase-only equalization,</li><li><figref idrefs="f0011">Figure 13</figref> illustrates in a flow chart an embodiment of a method for pre-equalizing.</li></ul><!-- EPO <DP n="7"> --></p><p id="p0028" num="0028">It should be noted that items which have the same reference numbers in different Figures, have the same structural features and the same functions, or are the same signals. Where the function and/or structure of such an item has been explained, there is no necessity for repeated explanation thereof in the detailed description.</p><heading id="h0005">List of Reference Numerals (figure 10-11d)</heading><p id="p0029" num="0029"><dl id="dl0001" compact="compact"><dt>110</dt><dd>an input stream</dd><dt>120</dt><dd>an equalized stream</dd><dt>130</dt><dd>an adjustment stream</dd><dt>140</dt><dd>a channel output stream</dd><dt>200</dt><dd>a pre-equalizer</dd><dt>205</dt><dd>a input stream symbol source</dd><dt>207</dt><dd>an up-converter</dd><dt>208</dt><dd>a switching power amplifier</dd><dt>209</dt><dd>an antenna</dd><dt>210</dt><dd>an input interface</dd><dt>220</dt><dd>a delay element</dd><dt>232</dt><dd>a first real multiplier</dd><dt>234</dt><dd>a second real multiplier</dd><dt>230</dt><dd>an adjustment stream source</dd><dt>240</dt><dd>a symbol combiner</dd><dt>250</dt><dd>an output interface</dd></dl></p><heading id="h0006"><b>DETAILED EMBODIMENTS</b></heading><p id="p0030" num="0030">While this invention is susceptible of embodiment in many different forms, there is shown in the drawings and will herein be described in detail one or more specific embodiments, with the understanding that the present disclosure is to be considered as exemplary of the principles of the invention and not intended to limit the invention to the specific embodiments shown and described.</p><p id="p0031" num="0031">We use the notation illustrated by <figref idrefs="f0005">Figure 10</figref>. In <figref idrefs="f0005">figure 10</figref>, Stream 110 denotes an input stream. The input stream represents an input stream of symbols which encode a stream of digital information; the two final symbols are: x(n) is the next symbol, and x(n-1) the previous symbol. Stream 120 denotes an equalized stream of output symbols: these are ready for upconverting and amplifying. Stream 130 denotes an adjusting stream. Stream 140 denotes the channel output, i.e., the symbols that are actually received by a receiver for receiving a digitally modulated RF signal, after transmission.
<ul><li><figref idrefs="f0001"><b>Figure 1</b></figref> illustrates zero-forcing pre-equalization in the complex plane.</li></ul><!-- EPO <DP n="8"> --></p><p id="p0032" num="0032"><figref idrefs="f0001">Figure 1</figref> is a so-called constellation diagram. Often constellation points are represented in a constellation diagram. The constellation diagram displays an RF signal as a two-dimensional scatter diagram in the complex plane at symbol sampling instants. It represents the possible symbols that may be selected by the modulation scheme as points in the complex plane. Constellation diagrams may also be measured to visualize the interference and distortion in a signal.</p><p id="p0033" num="0033">When communicating over a wireless channel, one of the sources of error on the received data is inter-symbol interference (ISI), meaning that received symbols are affected by surrounding (typically past) transmitted symbols, for example due to a bandwidth limited physical channel. One of the methods to reduce ISI is to pre-equalize the signal applied to the channel on the transmitter side such that after passing through the channel, the ISI is zero.</p><p id="p0034" num="0034">The previous channel output is shown in the figure by point <i>y(n-1).</i> In zero-forcing it is assumed by the equalizer to be equal to x(n-1). Then the pre-equalizer applies input x'(n) to the channel. The solid line shows the time-continuous complex amplitude (also known as phasor) of the channel output which is a path in the complex plane. At the instant when the system samples this signal, the complex amplitude would exactly equal the wanted value of x(n).</p><p id="p0035" num="0035">Note that the next zero-forced equalized point x'(n), does not have the same magnitude as x(n-1).</p><p id="p0036" num="0036">The channel is described in a time-discrete baseband model by a single pole in p, the channel output y as a response to the channel input x' (which is delivered by the pre-equalizer) A conventional zero-forcing pre-equalizer in the discrete time domain can be described by: <i>y(n)</i> = <i>p · y(n-1)</i> + (1-<i>p)· x' (n)</i> = <i>x(n).</i> The latter equality states the function of the ideal pre-equalizer: to make the channel output y equal to the wanted value x by applying pre-equalized value x' at the channel input. Note p is a complex number which represents a model, e.g. an approximation or prediction, of the RF channel. Solving for x'(n) gives: <maths id="math0001" num=""><math display="inline"><mi mathvariant="italic">xʹ</mi><mfenced><mi>n</mi></mfenced><mo>=</mo><mfrac><mrow><mi>x</mi><mfenced><mi>n</mi></mfenced><mo>-</mo><mi>p</mi><mo>⋅</mo><mi>y</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mrow><mrow><mn>1</mn><mo>-</mo><mi>p</mi></mrow></mfrac><mn>.</mn></math><img id="ib0001" file="imgb0001.tif" wi="46" he="14" img-content="math" img-format="tif" inline="yes"/></maths> So in order for the pre-equalizer to generate channel inputs <i>x'(n)</i> it needs to know the value of y(n-1), which is the channel past. However, assuming that the equalizer did a good job so far, we can assume that <i>y(n-1)</i> = <i>x(n-1),</i> so the equation for x'(n) now becomes: <maths id="math0002" num=""><math display="inline"><mi mathvariant="italic">xʹ</mi><mfenced><mi>n</mi></mfenced><mo>=</mo><mfrac><mrow><mi>x</mi><mfenced><mi>n</mi></mfenced><mo>-</mo><mi>p</mi><mo>⋅</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mrow><mrow><mn>1</mn><mo>-</mo><mi>p</mi></mrow></mfrac><mn>.</mn></math><img id="ib0002" file="imgb0002.tif" wi="45" he="14" img-content="math" img-format="tif" inline="yes"/></maths> Note that the next equalized symbol depends on the previous two input symbols, as is. No real multiplication of any kind is involved.</p><p id="p0037" num="0037"><figref idrefs="f0001"><b>Figure 2</b></figref> shows the concept of phase-only pre-equalization in the complex plane, At the sampling instant the phase of y(n) equals the wanted phase of <i>x(n)</i> by applying a constant-envelope x'(n) to the channel input. The magnitude of x'(n) and x(n) are both constant, but the magnitude of y(n) is not.<!-- EPO <DP n="9"> --></p><p id="p0038" num="0038">In case a system is used where phase shift keying (PSK) is employed to transmit information over the channel, the phase of the transmitted signal would contain the information whereas the amplitude of the transmitted signal would remain constant. This constant amplitude would allow for an energy-efficient power amplifier driving the channel (since constant-envelope power amplifiers are typically more power efficient than power amplifiers that have to create a signal with varying amplitude).</p><p id="p0039" num="0039">However, when having to drive a bandwidth-limited channel causing inter-symbol interference combined with using the zero-forcing pre-equalizing technique described before to remove said inter-symbol interference, the signal <i>applied to</i> the channel (x') would <i>not</i> be of constant envelope (in order to make the signal <i>after</i> the channel <i>(y)</i> of constant envelope and with a phase carrying the information without ISI being present).</p><p id="p0040" num="0040">This means that to apply the pre-equalized signal to the channel, a power amplifier that can generate signals of varying amplitude would be needed, which are typically less power efficient than constant-envelope power amplifiers. Additionally, generating such varying amplitude typically requires more hardware, for example a full polar-modulator with separate phase and amplitude signal paths in the transmitter.</p><p id="p0041" num="0041">The improved method makes use of the fact that the amplitude of the transmitted signal does not contain information when a pure PSK is used. The pre-equalizer described here removes inter-symbol interference from the <i>phase</i> of the signal at the receiver side while allowing the <i>amplitude</i> of the signal to vary. Allowing a variable received amplitude makes it possible to use an energy-efficient constant-envelope power amplifier at the transmitter side.</p><p id="p0042" num="0042">A non-linear pre-equalizer is proposed that calculates the phase of <i>constant-envelope</i> signal x' (the signal driving the channel) such that ISI in the <i>phase</i> of the channel output (the phase of y) is cancelled. Ideally it calculates a signals x'(n) under the boundary conditions:
<ol><li>1. Magnitude of x' is constant to allow for an energy-efficient constant-envelope power-amplifier driving the channel.</li><li>2. Phase of the resulting channel output y when applying x' at the channel input is equal to the phase of x (the information-carrying quantity in a PSK system) and therefore ISI-free.</li></ol></p><heading id="h0007">However both condition may be relaxed.</heading><p id="p0043" num="0043">A phase-only pre-equalizer does not force <i>y(n)</i> to equal <i>x(n)</i> as was done in zero-forcing, but rather only forces the <i>phase</i> of <i>y(n)</i> to equal the <i>phase</i> of <i>x(n),</i> since we assumed a PSK system where the amplitude of the channel output does not carry information and can therefore be ignored in the receiving side. In order to enable the use of a constant-envelope power amplifier, we may add another boundary condition on the solution, namely that the <i>magnitude</i> of x' should be constant. For ease of explanation, we will assume that this constant magnitude equals 1. Below we derive how a next symbol may be computed.:<!-- EPO <DP n="10"> --></p><p id="p0044" num="0044">First, we can again write the function of the pre-equalizer in a discrete time equation: <i>y(n) = p·y(n-1) + (1-p)·x'(n) = α(n)·x(n),</i> wherein α(n) is a (currently unknown) positive real number (as opposed to y, x and x' which are complex numbers with a certain magnitude and phase) representing the fact that the phase of y(n) equals that of <i>x(n)</i> but their magnitudes may differ.</p><p id="p0045" num="0045">We add the boundary condition: |x'(n)| ≡ 1 to indicate the constant-envelope signal driving the channel. One may prove that these equations can be solved as: <maths id="math0003" num=""><math display="inline"><mi mathvariant="italic">xʹ</mi><mfenced><mi>n</mi></mfenced><mo>=</mo><mfrac><mrow><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>⋅</mo><mi>x</mi><mfenced><mi>n</mi></mfenced><mo>-</mo><mi>p</mi><mo>⋅</mo><mi>α</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mrow><mrow><mn>1</mn><mo>-</mo><mi>p</mi></mrow></mfrac><mo>,</mo></math><img id="ib0003" file="imgb0003.tif" wi="72" he="14" img-content="math" img-format="tif" inline="yes"/></maths> with the value of α(n) defined recursively as: <maths id="math0004" num=""><math display="block"><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>=</mo><mi>α</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><mi>Re</mi><mo>⁢</mo><mfenced separators=""><mi>p</mi><mo>⋅</mo><mover><mi>x</mi><mo>‾</mo></mover><mfenced><mi>n</mi></mfenced><mo>⁢</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mfenced><mo>+</mo><msqrt><msup><mi>α</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><msup><mi>Re</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><mi>p</mi><mo>⋅</mo><mover><mi>x</mi><mo>‾</mo></mover><mfenced><mi>n</mi></mfenced><mo>⁢</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mfenced><mo>+</mo><msup><mfenced open="|" close="|" separators=""><mn>1</mn><mo>-</mo><mi>p</mi></mfenced><mn>2</mn></msup><mo>-</mo><msup><mi>α</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><msup><mfenced open="|" close="|"><mi>p</mi></mfenced><mn>2</mn></msup></msqrt></math><img id="ib0004" file="imgb0004.tif" wi="156" he="13" img-content="math" img-format="tif"/></maths></p><p id="p0046" num="0046">The above two formula's give recursive definitions for the equalized stream and for the adjusting stream. Using the above values for the adjusting stream 130 gives a phase-only adjusted pre-equalized stream. However, it is noted that by relaxing the conditions, e.g., by approximating the adjusting stream <i>α(n)</i> (sometimes denoted herein as a(n)), advantageous results may be achieved. The transmission system is described in the time-discrete baseband domain, meaning that the typical complete transceiver chain (digital-to-analog conversion, RF up-conversion, power amplifier, transmit antenna, channel, receive antenna, RF downconversion, analog-to-digital conversion) is modeled only at the time-discrete sample instants.</p><p id="p0047" num="0047"><figref idrefs="f0002"><b>Figure 3</b></figref> illustrates a Phase-only pre-equalizer implementation. This figure shows an implementation of computing the equalized stream x'(n). The block marked <i>α</i> contains an implementation of the mathematical function describing the adjusting stream. This block may also contain a simplified function that <i>approximates</i> the equation defined above.</p><p id="p0048" num="0048">The double-line signals in <figref idrefs="f0002">Figure 3</figref> indicate complex signals. The multipliers in <figref idrefs="f0002">Figure 3</figref> are half-complex multipliers, which are implemented using two real multipliers. The adder is a full-complex adder, which is implemented using two real adders. Finally, the gain stages are complex gain stages, implemented using four real multipliers and two adders, or three multipliers and five adders.</p><p id="p0049" num="0049">The modulation technique following the pre-equalizer (signal x' typically modulates an RF carrier) or the power amplifier driving the antenna may be implemented using conventional means. For example, a typical <i>polar-modulator</i> may be used, however, without the need for an amplitude path since the amplitude of x' is constant by construction.</p><p id="p0050" num="0050">It should be noted that in many cases the last amplification block 1/(1-p) in <figref idrefs="f0002">Figure 3</figref> can be completely left out, since its function is mostly not necessary in a PSK system: the constant amplitude gain of 1/abs(1-<i>p</i>) it provides is usually not important, since we are dealing with a PSK system. The constant phase rotation of -arg(1-p) it provides is usually also not important since a constant phase rotation typically can be handled by the system (for example in differential PSK systems, where the information is in fact encoded in phase <i>differences).</i><!-- EPO <DP n="11"> --></p><p id="p0051" num="0051">The block marked α in <figref idrefs="f0002">Figure 3</figref> may be expensive to realize if using the square-root function described above. Instead of implementing such an equalizer, however, it is also possible to approximate the solution. In that case the ISI would not completely be cancelled, but at least be reduced significantly. Below, one approach to such an approximated solution is given that simplifies implementation of the pre-equalizer.</p><p id="p0052" num="0052">One <i>example</i> of a simplified function α<i>(n)</i> is given below (the bar above x represents complex conjugation): <maths id="math0005" num=""><math display="block"><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>≈</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>⋅</mo><mfenced separators=""><mn>1</mn><mo>-</mo><msup><mi>α</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><msup><mfenced open="|" close="|"><mi>p</mi></mfenced><mn>2</mn></msup><mo>-</mo><msup><mfenced open="|" close="|" separators=""><mi>p</mi><mo>-</mo><mn>1</mn></mfenced><mn>2</mn></msup></mfenced><mo>⁢</mo><mfenced separators=""><mn>1</mn><mo>+</mo><msup><mi>α</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><mi>Re</mi><mo>⁢</mo><mfenced separators=""><mi>p</mi><mo>⋅</mo><mover><mi>x</mi><mo>‾</mo></mover><mfenced><mi>n</mi></mfenced><mo>⁢</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mfenced></mfenced><mn>.</mn></math><img id="ib0005" file="imgb0005.tif" wi="124" he="13" img-content="math" img-format="tif"/></maths></p><p id="p0053" num="0053">This approximation involves only addition and (complex) multiplications. These approximations are given only to clarify that the rather complicated function given by above does not need to be implemented literally but may be approximated in some way to reduce hardware complexity.</p><p id="p0054" num="0054">The digital hardware required for phase-only pre-equalization is more complicated than that needed for the conventional zero-forcing approach. The power consumed in the extra digital hardware is outweighed by the power gained in the analog up-conversion / power amplification circuitry.</p><p id="p0055" num="0055"><figref idrefs="f0003 f0004"><b>Figure 4-9</b></figref> illustrate simulated results. The behavior of the pre-equalizer has been verified and compared to situations where no pre-equalizer is used or where an ideal zero-forcing pre-equalizer is used. Also, the approximation techniques have been verified this way. Also, some non-ideal situations are illustrated, e.g., wherein the predicted channel pole p is slightly different from the actual channel pole, or cases where the phases that can be produced by the transmitter are quantized with a certain accuracy rather than having a continuous range of producible phases available at the modulator output.</p><p id="p0056" num="0056">For the simulations, an 8PSK modulation was used. The pole location p was chosen such that the channel -3dB bandwidth was only 18% of the symbol frequency and such that the channel was mistuned by 3% of the symbol frequency. For example, in 13.56MHz RFID, the channel in the RF domain is a bandpass filter that is ideally centered around the carrier. In this simulation it was mistuned by 3% of the symbol frequency. The input symbols x (symbols to be transmitted) were chosen randomly from the 8PSK alphabet with no correlation between symbols.</p><p id="p0057" num="0057">The RMS and peak values of the ISI-induced phase error are given normalized to a symbol interval (S.I.) which is the phase difference between two adjacent symbols in the PSK symbol alphabet. An error larger than 0.5 S.I. means that a slicing level has been crossed, corresponding to a symbol error. From the RMS and peak error numbers it follows that equalization is necessary to prevent symbol errors for the channel used in the simulations.</p><p id="p0058" num="0058"><figref idrefs="f0003"><b>Figure 4a and 4b</b></figref> show the values of the channel output (y) (plotted in the complex plane) when no pre-equalization is done altogether. Note that the left plot shows<!-- EPO <DP n="12"> --> results for 8PSK using the full circle (2π-PSK), whereas the right-hand side corresponds to the part-circle PSK that was proposed to the ISO standardization body for use in very-high bit rate 13.56MHz RFID systems. The grey rays originating from the figure origin indicate the so-called hard slicing-levels, which are the decision levels used to determine which symbol was transmitted.</p><p id="p0059" num="0059"><figref idrefs="f0003">Figure 4a</figref> is using 2π-PSK, and has RMS phase error: 0.31 S.I. and Peak phase error: 0.73 S.I. <figref idrefs="f0003">Figure 4b</figref> is using 56° PSK segment and has RMS phase error: 0.74 S.I, Peak phase error: 1.58 S.I.</p><p id="p0060" num="0060"><figref idrefs="f0003"><b>Figure 5a and 5b</b></figref> show the results when applying the phase-only pre-equalizer. It is clearly visible that the phases of y are completely ISI-free and that the amplitude (magnitude) of <i>y</i> indeed shows some variation (especially so in the case of 2π-PSK). The set of grey circles on the unit circle show the range of applied channel inputs (x') necessary to realize the ISI-free signal. <figref idrefs="f0003">Figure 5a</figref> uses 2π-PSK. <figref idrefs="f0003">Figure 5b</figref> uses 56° PSK segment.</p><p id="p0061" num="0061"><figref idrefs="f0003"><b>Figure 6a and 6b</b></figref> show the performance of the approximated phase-only pre-equalizer according to equation 330 of <figref idrefs="f0010">figure 12</figref>. Even though performance is obviously not completely ISI-free, the amount of ISI compared to no equalization is still reduced with an order of magnitude in this channel. <figref idrefs="f0003">Figure 6a</figref> uses 2π-PSK and has RMS phase error: 0.029 S.I and Peak phase error: 0.11 S.I. <figref idrefs="f0003">Figure 6b</figref> uses 56° PSK segment and has RMS phase error: 0.072 S.I and Peak phase error: 0.20 S.I.</p><p id="p0062" num="0062"><figref idrefs="f0004"><b>Figure 7a and 7b</b> and <b>Figure 8a and 8b</b></figref> show the results under the influence of non-ideal conditions (now using the perfect implementation of the α(n) function according to the unapproximated equation featuring the square-root operation).</p><p id="p0063" num="0063"><figref idrefs="f0004">Figures 7a and 7b</figref> show the results when the actual channel is different from what the pre-equalizer predicted (actual channel bandwith is 10% higher than given by p, mistuning is 0 in p but 3% of the symbol frequency in the actual channel). <figref idrefs="f0004">Figures 8a and 8b</figref> assume a limited accuracy of the phase of the channel input signal x' (the phases were rounded to multiples of ¼ S.I. before applying them to the channel). The results are still acceptable in that the peak error is well below the 0.5 S.I. limit.</p><p id="p0064" num="0064"><figref idrefs="f0004">Figure 7a</figref> uses 2π-PSK and has RMS phase error: 0.076 S.I. and Peak phase error: 0.38 S.I. <figref idrefs="f0004">Figure 7b</figref> uses a 56° PSK segment and has RMS phase error: 0.089 S.I and Peak phase error: 0.29 S.I.</p><p id="p0065" num="0065"><figref idrefs="f0004">Figure 8a</figref> uses 2π-PSK and has RMS phase error: 0.079 S.I. and Peak phase error: 0.18 S.I. <figref idrefs="f0004">Figure 8b</figref> uses a 56° PSK segment and has RMS phase error: 0.050 S.I Peak phase error: 0.11 S.I.</p><p id="p0066" num="0066"><figref idrefs="f0004"><b>Figure 9a and 9b</b></figref> show the values of a conventional zero-forcing pre-equalizer output x' (grey circles) and corresponding channel output y (black dots) when backing off the power amplifier such that the peak amplitude of x' equals 1. <figref idrefs="f0004">Figure 9a</figref> uses 2π-PSK, <figref idrefs="f0004">figure 9b</figref> uses a 56° PSK segment.<!-- EPO <DP n="13"> --></p><p id="p0067" num="0067">A phase-only pre-equalizer does not suffer from lower transmitted power compared to the conventional zero-forcing equalizer even though the amplitude of the channel output y seems to be lower on average than when using the zero-forcing equalizer which would force the points y on the unit circle. When using the zero-forcing equalizer, one would have to back-off the power amplifier to allow the peak amplitudes that it needs to generate to fit within the output range, whereas when using the phase-only pre-equalizer, one can always operate the power amplifier at maximum power.</p><p id="p0068" num="0068">In the simulations, we scale the values of the pre-equalizer output x' such that the <i>maximum</i> amplitude of x' equals 1. Then we calculate the resulting variance of the channel output y, which is a measure for the power contained in that signal.</p><p id="p0069" num="0069"><figref idrefs="f0004">Figure 9a and 9b</figref> illustrate the performance of the conventional zero-forcing equalizer including said amplitude scaling (the versions for the phase-only pre-equalizer were already shown in <figref idrefs="f0003">figure 5a and 5b</figref>). For the channel conditions used, the power in the channel output signal y when using the phase-only pre-equalizer is in fact 60% higher in the 56° PSK case and even more than 70% higher in the 2π-PSK case when compared to using zero-forcing equalization with power amplifier back-off.</p><p id="p0070" num="0070"><figref idrefs="f0006"><b>Figure 11a</b></figref> illustrates an embodiment of a pre-equalizer 200.</p><p id="p0071" num="0071">The figure shows a symbol source 200 from which an input stream of symbols is received. For example, a stream of digital information is encoded in the input stream of symbols. Only phases are used for the encoding, i.e., the input stream has constant magnitudes. We will assume that each input symbol comprises an in-phase and a quadrature component, but polar representation is also possible. The input stream may be digital, e.g., pairs of two digital numbers, e.g., I/Q pairs, but they may also be represented as pairs of analog signals.</p><p id="p0072" num="0072">The input stream is received as an input interface, e.g., a receiver for receiving the input stream. The pre-equalizer 200 comprises a delay element 220 for delaying the input stream by one symbol. A received input symbol (i.e., the next symbol) is multiplied in first real multiplier 232. The delayed input symbol (i.e. the previous symbol) is multiplied in second real multiplier 234. The real numbers used for the multiplications are obtained from an adjustment stream source 230. Adjustment stream source 230 produces adjusting real numbers. Pre-equalizer 200 comprises a symbol combiner 240, which combines the multiplied numbers. For example, the delayed number may be multiplied with '-p' and added to the other multiplied number. Herein 'p' denotes a model, e.g.., an approximation, of the channel pole. The combiner 250 may be a conventional zero-forcing combiner. Obtaining a value for 'p' is known in the art.</p><p id="p0073" num="0073">The result of the symbol combiner 240 may be forwarded to an up-converter 207 via output interface 250. The upconverted signal is amplified using a switching power amplifier 208, and finally transmitted via antenna 209. The pre-equalizer may be combined with a<!-- EPO <DP n="14"> --> suitable symbol source, upconverter, amplifier and antenna and used in a digital transmission system. A digital to analog converter may be used between the pre-equalizer 200 and the upconverter.</p><p id="p0074" num="0074">A corresponding receiver will receive less inter-symbol interference because of the pre-equalization when it receives the transmitted signal. The corresponding receiver will not receive a constant magnitude but that is not a problem since a PSK system is used.</p><p id="p0075" num="0075"><figref idrefs="f0007"><b>Figure 11b</b></figref> shows how adjusting stream source 230 may be arranged in pre-equalizer 200. Adjustment stream source 230 receives the next input stream symbol from the input interface 210 and the previous symbol from delay element 220, it computes, e.g., using a computer program adjusting numbers for use in multipliers 232 and 234.</p><p id="p0076" num="0076"><figref idrefs="f0008"><b>Figure 11c</b></figref> shows a further variation. This system comprises a further delay element 221 for delaying the stream by one number. Adjusting stream source 230 receives the next input symbol, the previous input symbol and the previous adjusting number. This allows a recursive definition of the adjusting number stream.</p><p id="p0077" num="0077"><figref idrefs="f0009"><b>Figure 11d</b></figref> shows yet a further variation, which avoids the need for a second multiplier. Multiplier 232 receives a next symbol from input interface 210 and is multiplied by a next adjusting number obtained from source 230. The multiplied number is input to combiner 240. Delay element 220 delays the multiplied stream instead of the input stream. Combiner 240 receives the previous multiplied symbol from delay element 220. Source 230 may be connected to input interface through an additional one-symbol delay element 222.</p><p id="p0078" num="0078">Typically, the pre-equalizer 200 comprises a microprocessor (not shown) which executes appropriate software stored at the device, e.g., a corresponding memory, e.g. RAM or ROM (not shown). The adjusting number source 230 may also be equipped with its own microprocessors and memory (not shown), e.g., for a program and/or for storage. Pre-equalizer may also be implemented on a DSP.</p><p id="p0079" num="0079"><figref idrefs="f0010"><b>Figure 12</b></figref> summarizes particular advantageous formulas. Formula 310 gives a recursive definition of the next equalized symbol. The formula 310 is implemented in the symbol combiner 240. The implementation may be in software, or in hardware (say in cmos), or in a combination. Formula 320 a formula which may be used by adjusting number source 230. Formula 330 a formula which may alternatively be used by adjusting number source 230; it is an approximation of formula 320. Note that many other approximations are possible.</p><p id="p0080" num="0080"><figref idrefs="f0011"><b>Figure 13</b></figref> illustrates in a flow chart an embodiment 400 of a method for pre-equalizing a digital modulated RF signal. In step 410 a next symbol is received of an input stream of symbols (x(i)) representing a phase change and magnitude of an RF signal, the magnitudes of the symbols in the input stream are constant, the phase changes of the symbols in the input stream encode digital information. The input stream is adjusting to reduce inter-symbol interference in transmission by the method.<!-- EPO <DP n="15"> --></p><p id="p0081" num="0081">In step 420 the received next input symbol is stored in a memory for use in the next iteration, as the previous symbol. In step 430 a next adjusting real number is computed, from the next and previous symbol, and the previous adjusting number. In the step 440 the next adjusting real number is stored for use in the next iteration, as the previous adjusting number. Step 430 may use formula 320 or formula 330 or another approximation of formula 320. In step 450 the next input symbol is multiplied with the next adjusting real number, thus the next multiplied input symbol is obtained. In step 460 the next multiplied input symbol is stored for use in the next iteration as the previous multiplied input symbol. In step 470 the next equalized symbol is computed from the multiplied next input symbol and the previous multiplied input symbol. Step 470 may use formula 310. After the next equalized symbol is computed in step 470 the method return to step 420 to receive a next input symbol. Steps 420, 440 and 460 may use a memory for storage, e.g., a RAM memory. The memory may be internal to pre-equalizer 200.</p><p id="p0082" num="0082">Many different ways of executing the method are possible, as will be apparent to a person skilled in the art. For example, the order of the steps can be varied or some steps may be executed in parallel. Moreover, in between steps other method steps may be inserted. The inserted steps may represent refinements of the method such as described herein, or may be unrelated to the method. For example, some steps may be executed, at least partially, in parallel. Moreover, a given step may not have finished completely before a next step is started.</p><p id="p0083" num="0083">A method according to the invention may be executed using software, which comprises instructions for causing a processor system to perform method 400. Software may only include those steps taken by a particular sub-entity of the system. The software may be stored in a suitable storage medium, such as a hard disk, a floppy, a memory etc. The software may be sent as a signal along a wire, or wireless, or using a data network, e.g., the Internet. The software may be made available for download and/or for remote usage on a server.</p><p id="p0084" num="0084">It will be appreciated that the invention also extends to computer programs, particularly computer programs on or in a carrier, adapted for putting the invention into practice. The program may be in the form of source code, object code, a code intermediate source and object code such as partially compiled form, or in any other form suitable for use in the implementation of the method according to the invention. An embodiment relating to a computer program product comprises computer executable instructions corresponding to each of the processing steps of at least one of the methods set forth. These instructions may be subdivided into subroutines and/or be stored in one or more files that may be linked statically or dynamically. Another embodiment relating to a computer program product comprises computer executable instructions corresponding to each of the means of at least one of the systems and/or products set forth.<!-- EPO <DP n="16"> --></p><p id="p0085" num="0085">It should be noted that the above-mentioned embodiments illustrate rather than limit the invention, and that those skilled in the art will be able to design many alternative embodiments.</p><p id="p0086" num="0086">In the claims, any reference signs placed between parentheses shall not be construed as limiting the claim. Use of the verb "comprise" and its conjugations does not exclude the presence of elements or steps other than those stated in a claim. The article "a" or "an" preceding an element does not exclude the presence of a plurality of such elements. The invention may be implemented by means of hardware comprising several distinct elements, and by means of a suitably programmed computer. In the device claim enumerating several means, several of these means may be embodied by one and the same item of hardware. The mere fact that certain measures are recited in mutually different dependent claims does not indicate that a combination of these measures cannot be used to advantage.</p><p id="p0087" num="0087">Appendix A and B are included for illustrative purposes.</p><heading id="h0008"><b>Appendix A: Derivation of phase-only pre-equalizer transfer</b></heading><p id="p0088" num="0088">One application of the phase-only pre-equalizer was captured in two equations which are repeated here for convenience: <maths id="math0006" num="1)"><math display="block"><mi>y</mi><mfenced><mi>n</mi></mfenced><mo>=</mo><mi>p</mi><mo>⋅</mo><mi>y</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>+</mo><mfenced separators=""><mn>1</mn><mo>-</mo><mi>p</mi></mfenced><mo>⋅</mo><mi mathvariant="italic">xʹ</mi><mfenced><mi>n</mi></mfenced><mo>=</mo><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>⋅</mo><mi>x</mi><mfenced><mi>n</mi></mfenced></math><img id="ib0006" file="imgb0006.tif" wi="135" he="14" img-content="math" img-format="tif"/></maths> <maths id="math0007" num="2)"><math display="block"><mfenced open="|" close="|" separators=""><mi mathvariant="italic">xʹ</mi><mfenced><mi>n</mi></mfenced></mfenced><mo>≡</mo><mn>1</mn></math><img id="ib0007" file="imgb0007.tif" wi="140" he="14" img-content="math" img-format="tif"/></maths><br/>
with x(n) the time-discrete phasor (complex amplitude) describing the pure PSK wanted channel output, x'(n) the phasor of the signal driving the channel and <i>y(n)</i> is the phasor describing the actual channel output. The channel transfer is described by pole p. The symbol α<i>(n)</i> is a <i>positive real</i> number representing the fact that the phase of y(n) equals that of <i>x(n)</i> if the phase-only pre-equalizer does a good job.</p><p id="p0089" num="0089">The equation can solved for x'(n): <maths id="math0008" num="3)"><math display="block"><mi mathvariant="italic">xʹ</mi><mfenced><mi>n</mi></mfenced><mo>=</mo><mfrac><mrow><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>⋅</mo><mi>x</mi><mfenced><mi>n</mi></mfenced><mo>-</mo><mi>p</mi><mo>⋅</mo><mi>y</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mrow><mrow><mn>1</mn><mo>-</mo><mi>p</mi></mrow></mfrac></math><img id="ib0008" file="imgb0008.tif" wi="140" he="14" img-content="math" img-format="tif"/></maths><br/>
where α<i>(n)</i> is unknown at this point in the derivation. In fact, solving for α<i>(n)</i> is the main point of this appendix.</p><p id="p0090" num="0090">Using the second equality in equation (1) we can substitute <i>y(n-1) =</i> α<i>(n)·x(n-1)</i> <maths id="math0009" num="4)"><math display="block"><mi mathvariant="italic">xʹ</mi><mfenced><mi>n</mi></mfenced><mo>=</mo><mfrac><mrow><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>⋅</mo><mi>x</mi><mfenced><mi>n</mi></mfenced><mo>-</mo><mi>p</mi><mo>⋅</mo><mi>α</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mrow><mrow><mn>1</mn><mo>-</mo><mi>p</mi></mrow></mfrac></math><img id="ib0009" file="imgb0009.tif" wi="136" he="15" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="17"> --></p><p id="p0091" num="0091">First, we add the boundary condition on the magnitude of x' (equation (2)) to solve for α<i>(n):</i> <maths id="math0010" num="5)"><math display="block"><mfenced open="|" close="|" separators=""><mi mathvariant="italic">xʹ</mi><mfenced><mi>n</mi></mfenced></mfenced><mo>=</mo><mfenced open="|" close="|"><mfrac><mrow><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>⋅</mo><mi>x</mi><mfenced><mi>n</mi></mfenced><mo>-</mo><mi>p</mi><mo>⋅</mo><mi>α</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mrow><mrow><mn>1</mn><mo>-</mo><mi>p</mi></mrow></mfrac></mfenced><mo>≡</mo><mn>1</mn></math><img id="ib0010" file="imgb0010.tif" wi="137" he="18" img-content="math" img-format="tif"/></maths><br/>
from which directly follows: <maths id="math0011" num="6)"><math display="block"><msup><mfenced open="|" close="|" separators=""><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>⋅</mo><mi>x</mi><mfenced><mi>n</mi></mfenced><mo>-</mo><mi>p</mi><mo>⋅</mo><mi>α</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mfenced><mn>2</mn></msup><mo>=</mo><msup><mfenced open="|" close="|" separators=""><mn>1</mn><mo>-</mo><mi>p</mi></mfenced><mn>2</mn></msup></math><img id="ib0011" file="imgb0011.tif" wi="134" he="12" img-content="math" img-format="tif"/></maths></p><p id="p0092" num="0092">The left-hand side can be written as: <maths id="math0012" num="7)"><math display="block"><mtable columnalign="left"><mtr><mtd><msup><mfenced open="|" close="|" separators=""><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>⋅</mo><mi>x</mi><mfenced><mi>n</mi></mfenced><mo>-</mo><mi>p</mi><mo>⋅</mo><mi>α</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mfenced><mn>2</mn></msup><mo>=</mo></mtd></mtr><mtr><mtd><mfenced separators=""><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>⋅</mo><mi>x</mi><mfenced><mi>n</mi></mfenced><mo>-</mo><mi>p</mi><mo>⋅</mo><mi>α</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mfenced><mo>⋅</mo><mfenced><mover><mrow><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>⋅</mo><mi>x</mi><mfenced><mi>n</mi></mfenced><mo>-</mo><mi>p</mi><mo>⋅</mo><mi>α</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mrow><mo>‾</mo></mover></mfenced><mo>=</mo></mtd></mtr><mtr><mtd><mfenced separators=""><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>⋅</mo><mi>x</mi><mfenced><mi>n</mi></mfenced><mo>-</mo><mi>p</mi><mo>⋅</mo><mi>α</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mfenced><mo>⋅</mo><mfenced separators=""><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>⋅</mo><mover><mi>x</mi><mo>‾</mo></mover><mfenced><mi>n</mi></mfenced><mo>-</mo><mi>α</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mover><mi>p</mi><mo>‾</mo></mover><mo>⋅</mo><mover><mrow><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mrow><mo>‾</mo></mover></mfenced><mo>=</mo></mtd></mtr><mtr><mtd><msup><mi>α</mi><mn>2</mn></msup><mfenced><mi>n</mi></mfenced><mo>⋅</mo><msup><mfenced open="|" close="|" separators=""><mi>x</mi><mfenced><mi>n</mi></mfenced></mfenced><mn>2</mn></msup><mo>-</mo><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>⋅</mo><mi>α</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mn>2</mn><mspace width="1em"/><mi>Re</mi><mo>⁢</mo><mfenced separators=""><mi>p</mi><mo>⋅</mo><mover><mi>x</mi><mo>‾</mo></mover><mfenced><mi>n</mi></mfenced><mo>⁢</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mfenced><mo>+</mo><msup><mi>α</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><mfenced open="|" close="|" separators=""><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mfenced></mtd></mtr></mtable></math><img id="ib0012" file="imgb0012.tif" wi="137" he="36" img-content="math" img-format="tif"/></maths><br/>
where the top-bars indicate complex conjugation.</p><p id="p0093" num="0093">The magnitude of the original (wanted) constellation points x(n) equals 1, since we are using a pure PSK. This (slightly) reduces equation (7) to: <maths id="math0013" num="8)"><math display="block"><mtable columnalign="left"><mtr><mtd><msup><mfenced open="|" close="|" separators=""><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>⋅</mo><mi>x</mi><mfenced><mi>n</mi></mfenced><mo>-</mo><mi>p</mi><mo>⋅</mo><mi>α</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mfenced><mn>2</mn></msup><mo>=</mo></mtd></mtr><mtr><mtd><mspace width="3em"/><msup><mi>α</mi><mn>2</mn></msup><mfenced><mi>n</mi></mfenced><mo>-</mo><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>⋅</mo><mi>α</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mn>2</mn><mspace width="1em"/><mi>Re</mi><mo>⁢</mo><mfenced separators=""><mi>p</mi><mo>⋅</mo><mover><mi>x</mi><mo>‾</mo></mover><mfenced><mi>n</mi></mfenced><mo>⁢</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mfenced><mo>+</mo><msup><mi>α</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><msup><mfenced open="|" close="|"><mi>p</mi></mfenced><mn>2</mn></msup></mtd></mtr></mtable></math><img id="ib0013" file="imgb0013.tif" wi="137" he="21" img-content="math" img-format="tif"/></maths></p><p id="p0094" num="0094">Combining equations (6) and (8) results in a quadratic equation in α<i>(n):</i>
<maths id="math0014" num=""><img id="ib0014" file="imgb0014.tif" wi="136" he="14" img-content="math" img-format="tif"/></maths></p><p id="p0095" num="0095">The general solution to this quadratic equation is: <maths id="math0015" num="10)"><math display="block"><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>=</mo><mfrac><mrow><mo>-</mo><mi>b</mi><mo>±</mo><msqrt><msup><mi>b</mi><mn>2</mn></msup><mo>-</mo><mn>4</mn><mo>⁢</mo><mi>c</mi></msqrt></mrow><mn>2</mn></mfrac></math><img id="ib0015" file="imgb0015.tif" wi="139" he="17" img-content="math" img-format="tif"/></maths><br/>
with <maths id="math0016" num="11)"><math display="block"><mtable columnalign="left"><mtr><mtd><mi>b</mi><mo>=</mo><mo>-</mo><mn>2</mn><mo>⁢</mo><mi>α</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><mi>Re</mi><mo>⁢</mo><mfenced separators=""><mi>p</mi><mo>⋅</mo><mover><mi>x</mi><mo>‾</mo></mover><mfenced><mi>n</mi></mfenced><mo>⁢</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mfenced></mtd></mtr><mtr><mtd><mi>c</mi><mo>=</mo><msup><mi>α</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><msup><mfenced open="|" close="|"><mi>p</mi></mfenced><mn>2</mn></msup><mo>-</mo><msup><mfenced open="|" close="|" separators=""><mn>1</mn><mo>-</mo><mi>p</mi></mfenced><mn>2</mn></msup></mtd></mtr></mtable></math><img id="ib0016" file="imgb0016.tif" wi="135" he="18" img-content="math" img-format="tif"/></maths></p><p id="p0096" num="0096">Substituting equation (11) in equation (10) results in:<!-- EPO <DP n="18"> --> <maths id="math0017" num="12)"><math display="block"><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>=</mo><mi>α</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mspace width="1em"/><mi>Re</mi><mo>⁢</mo><mfenced separators=""><mi>p</mi><mo>⋅</mo><mover><mi>x</mi><mo>‾</mo></mover><mfenced><mi>n</mi></mfenced><mo>⁢</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mfenced><mo>+</mo><msqrt><msup><mi>α</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mspace width="1em"/><msup><mi>Re</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><mi>p</mi><mo>⋅</mo><mover><mi>x</mi><mo>‾</mo></mover><mfenced><mi>n</mi></mfenced><mo>⁢</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mfenced><mo>+</mo><msup><mfenced open="|" close="|" separators=""><mn>1</mn><mo>-</mo><mi>p</mi></mfenced><mn>2</mn></msup><mo>-</mo><msup><mi>α</mi><mn>2</mn></msup></msqrt></math><img id="ib0017" file="imgb0017.tif" wi="153" he="19" img-content="math" img-format="tif"/></maths></p><p id="p0097" num="0097">Note that the -solution of equation (10) does not suffice since it results in a negative value for α<i>(n).</i></p><p id="p0098" num="0098">Finally, the value of α<i>(n)</i> can be used in equation (3) to get the desired value of <i>x'(n)</i> as a function of (known) input values x and the previous value of α.</p><heading id="h0009"><b>Appendix B: Approximating the phase-only pre-equalizer solution</b></heading><p id="p0099" num="0099">A first-order Taylor expansion of the quadratic equation of equation (9) is performed, such that a linear equation remains that can be solved without resulting in a square-root operator. The Taylor expansion of the left-hand side of equation (9) around α<i>(n) = α<sub>0</sub> (α<sub>0</sub></i> being some real-valued constant that would be close the solution of the quadratic equation) is given by: <maths id="math0018" num="13)"><math display="block"><msup><mi>α</mi><mn>2</mn></msup><mfenced><mi>n</mi></mfenced><mo>+</mo><mi>b</mi><mo>⁢</mo><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>+</mo><mi>c</mi><mo>≈</mo><msubsup><mi>α</mi><mn>0</mn><mn>2</mn></msubsup><mo>+</mo><mi>b</mi><mo>⁢</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><mi>c</mi><mo>+</mo><mfenced separators=""><mn>2</mn><mo>⁢</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><mi>b</mi></mfenced><mo>⋅</mo><mfenced separators=""><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>-</mo><msub><mi>α</mi><mn>0</mn></msub></mfenced><mo>=</mo><mo>-</mo><msubsup><mi>α</mi><mn>0</mn><mn>2</mn></msubsup><mo>+</mo><mi>c</mi><mo>+</mo><mrow><mo>(</mo></mrow><mn>2</mn><mo>⁢</mo><msub><mi>α</mi><mn>0</mn></msub></math><img id="ib0018" file="imgb0018.tif" wi="136" he="14" img-content="math" img-format="tif"/></maths></p><p id="p0100" num="0100">The root of this (now linear) equation is: <maths id="math0019" num="14)"><math display="block"><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>≈</mo><mfrac><mrow><msubsup><mi>α</mi><mn>0</mn><mn>2</mn></msubsup><mo>-</mo><mi>c</mi></mrow><mrow><mn>2</mn><mo>⁢</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><mi>b</mi></mrow></mfrac></math><img id="ib0019" file="imgb0019.tif" wi="137" he="14" img-content="math" img-format="tif"/></maths><br/>
which does not involve square-root evaluation.</p><p id="p0101" num="0101">For <i>example,</i> assuming that the solution for α<i>(n)</i> is always close to 1 (meaning <i>y(n)≈x(n),</i> which turns out to be not too far off for channels with moderate bandwidth limitations), the solution of quadratic equation (9) can be reasonably well approximated using equation (14) with α<sub>0</sub>=1: <maths id="math0020" num="15)"><math display="block"><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>≈</mo><mfrac><mrow><mn>1</mn><mo>-</mo><mi>c</mi></mrow><mrow><mn>2</mn><mo>+</mo><mi>b</mi></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>⋅</mo><mfrac><mrow><mn>1</mn><mo>-</mo><msup><mi>α</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><msup><mfenced open="|" close="|"><mi>p</mi></mfenced><mn>2</mn></msup><mo>-</mo><msup><mfenced open="|" close="|" separators=""><mn>1</mn><mo>-</mo><mi>p</mi></mfenced><mn>2</mn></msup></mrow><mrow><mn>1</mn><mo>-</mo><msup><mi>α</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mspace width="1em"/><mi>Re</mi><mo>⁢</mo><mfenced separators=""><mi>p</mi><mo>⋅</mo><mover><mi>x</mi><mo>‾</mo></mover><mfenced><mi>n</mi></mfenced><mo>⁢</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mfenced></mrow></mfrac></math><img id="ib0020" file="imgb0020.tif" wi="134" he="19" img-content="math" img-format="tif"/></maths></p><p id="p0102" num="0102">One can approximate even further if one also wants to remove of the division with variable denominator in equation (14) as follows: <maths id="math0021" num="16)"><math display="block"><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>≈</mo><mfrac><mrow><msubsup><mi>α</mi><mn>0</mn><mn>2</mn></msubsup><mo>-</mo><mi>c</mi></mrow><mrow><mn>2</mn><mo>⁢</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><mi>b</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mfenced separators=""><msubsup><mi>α</mi><mn>0</mn><mn>2</mn></msubsup><mo>-</mo><mi>c</mi></mfenced><mo>⁢</mo><mfenced separators=""><mn>2</mn><mo>⁢</mo><msub><mi>α</mi><mn>0</mn></msub><mo>-</mo><mi>b</mi></mfenced></mrow><mrow><mn>4</mn><mo>⁢</mo><msubsup><mi>α</mi><mn>0</mn><mn>2</mn></msubsup><mo>-</mo><msup><mi>b</mi><mn>2</mn></msup></mrow></mfrac><mo>≈</mo><mfrac><mn>1</mn><mrow><mn>4</mn><mo>⁢</mo><msubsup><mi>α</mi><mn>0</mn><mn>2</mn></msubsup></mrow></mfrac><mo>⋅</mo><mfenced separators=""><msubsup><mi>α</mi><mn>0</mn><mn>2</mn></msubsup><mo>-</mo><mi>c</mi></mfenced><mo>⁢</mo><mfenced separators=""><mn>2</mn><mo>⁢</mo><msub><mi>α</mi><mn>0</mn></msub><mo>-</mo><mi>b</mi></mfenced></math><img id="ib0021" file="imgb0021.tif" wi="136" he="19" img-content="math" img-format="tif"/></maths><br/>
where the latter approximation holds when b<sup>2</sup> &lt;&lt; 4 α<sub>0</sub><sup>2</sup>.</p><p id="p0103" num="0103">So, again for <i>example,</i> for α<sub>0</sub>=1 this would reduce to:<!-- EPO <DP n="19"> --> <maths id="math0022" num="17)"><math display="block"><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>≈</mo><mfrac><mn>1</mn><mn>4</mn></mfrac><mo>⋅</mo><mfenced separators=""><mn>1</mn><mo>-</mo><mi>c</mi></mfenced><mo>⁢</mo><mfenced separators=""><mn>2</mn><mo>-</mo><mi>b</mi></mfenced><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>⋅</mo><mfenced separators=""><mn>1</mn><mo>-</mo><msup><mi>α</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><msup><mfenced open="|" close="|"><mi>p</mi></mfenced><mn>2</mn></msup><mo>-</mo><msup><mfenced open="|" close="|" separators=""><mn>1</mn><mo>-</mo><mi>p</mi></mfenced><mn>2</mn></msup></mfenced><mrow><mo>(</mo></mrow><mn>1</mn><mo>+</mo><msup><mi>α</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mspace width="1em"/><mi>Re</mi><mrow><mo>(</mo></mrow><mi>p</mi><mo>⋅</mo><mover><mi>x</mi><mo>‾</mo></mover><mfenced><mi>n</mi></mfenced></math><img id="ib0022" file="imgb0022.tif" wi="146" he="18" img-content="math" img-format="tif"/></maths></p><p id="p0104" num="0104">Finally, one could pursue this approach further to get better approximations. Continuing from equation (16): <maths id="math0023" num="18)"><math display="block"><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>≈</mo><mfrac><mrow><msubsup><mi>α</mi><mn>0</mn><mn>2</mn></msubsup><mo>-</mo><mi>c</mi></mrow><mrow><mn>2</mn><mo>⁢</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><mi>b</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mfenced separators=""><msubsup><mi>α</mi><mn>0</mn><mn>2</mn></msubsup><mo>-</mo><mi>c</mi></mfenced><mo>⁢</mo><mfenced separators=""><mn>2</mn><mo>⁢</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><mi>b</mi></mfenced><mo>⁢</mo><mfenced separators=""><mn>4</mn><mo>⁢</mo><msubsup><mi>α</mi><mn>0</mn><mn>2</mn></msubsup><mo>+</mo><msup><mi>b</mi><mn>2</mn></msup></mfenced></mrow><mrow><mn>16</mn><mo>⁢</mo><msubsup><mi>α</mi><mn>0</mn><mn>4</mn></msubsup><mo>-</mo><msup><mi>b</mi><mn>4</mn></msup></mrow></mfrac><mo>≈</mo><mfrac><mn>1</mn><mrow><mn>16</mn><mo>⁢</mo><msubsup><mi>α</mi><mn>0</mn><mn>4</mn></msubsup></mrow></mfrac><mo>⋅</mo><mfenced separators=""><msubsup><mi>α</mi><mn>0</mn><mn>2</mn></msubsup><mo>-</mo><mi>c</mi></mfenced><mo>⁢</mo><mfenced separators=""><mn>2</mn><mo>⁢</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><mi>b</mi></mfenced></math><img id="ib0023" file="imgb0023.tif" wi="139" he="19" img-content="math" img-format="tif"/></maths><br/>
which, for α<sub>0</sub>=1 reduces to: <maths id="math0024" num="19)"><math display="block"><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>≈</mo><mfrac><mn>1</mn><mn>16</mn></mfrac><mo>⋅</mo><mfenced separators=""><mn>1</mn><mo>-</mo><mi>c</mi></mfenced><mo>⁢</mo><mfenced separators=""><mn>2</mn><mo>+</mo><mi>b</mi></mfenced><mo>⁢</mo><mfenced separators=""><mn>4</mn><mo>+</mo><msup><mi>b</mi><mn>2</mn></msup></mfenced></math><img id="ib0024" file="imgb0024.tif" wi="137" he="15" img-content="math" img-format="tif"/></maths></p></description><claims mxw-id="PCLM56976184" lang="EN" load-source="patent-office"><!-- EPO <DP n="20"> --><claim id="c-en-0001" num="0001"><claim-text>A method for pre-equalizing a digital modulated RF signal, the method comprising
<claim-text>- receiving an input stream of symbols (x(i)) representing a phase change and magnitude of an RF signal, wherein the magnitudes of the symbols in the input stream are constant and the phase changes of the symbols in the input stream encode digital information, and</claim-text>
<claim-text>- adjusting the input stream of symbols to reduce inter-symbol interference in transmission of an RF signal modulated according to the input stream, thus obtaining an equalized stream of symbols (x'(i)), each symbol of the equalized stream representing a phase change and magnitude of an RF signal,</claim-text>
<claim-text>- the adjusting comprising iteratively determining a next symbol of the equalized stream (x'(n)) after receiving a next symbol of the input stream (x(n)) by</claim-text>
<claim-text>- multiplying said next symbol of the input stream (x(n)) with a next adjusting real number (a(n)),</claim-text>
<claim-text>- multiplying a previous symbol of the input stream (x(n-1)) with a previous adjusting real number (a(n-1)), said previous symbol being received directly before said next symbol of the input stream, and</claim-text>
<claim-text>- computing the next symbol of the equalized stream from the multiplied next symbol of the input stream and the multiplied previous symbol of the input stream.</claim-text></claim-text></claim><claim id="c-en-0002" num="0002"><claim-text>A method as in Claim 1, comprising
<claim-text>- iteratively generating an adjusting stream of adjusting real numbers, comprising</claim-text>
<claim-text>- after receiving the next symbol of the input stream determining the next adjusting real number of the adjusting stream, the next adjusting real number of the adjusting stream depending on said next symbol of the input stream, said previous symbol of the input stream and the previous adjusting real number in the adjusting stream of adjusting real numbers.</claim-text></claim-text></claim><claim id="c-en-0003" num="0003"><claim-text>A method as in Claim 1 or 2, comprising
<claim-text>- computing the next symbol of the equalized stream comprises multiplying said multiplied previous symbol with a modeling complex number (-p) indicating the<!-- EPO <DP n="21"> --> RF channel through which a RF signal modulated according to the equalized stream is to be sent, and adding to the result to said multiplied next symbol.</claim-text></claim-text></claim><claim id="c-en-0004" num="0004"><claim-text>A method as in any one of the preceding claims, wherein the magnitude of the symbols in the equalized stream of symbols (x'(i)) are within a target magnitude multiplied with an upper-margin and target magnitude multiplied with a lower-margin, wherein the upper-margin is 1.1 and the lower-margin is 0.9.</claim-text></claim><claim id="c-en-0005" num="0005"><claim-text>A method as in any one of the preceding claims, wherein the magnitude of the symbols in the equalized stream of symbols are equal.</claim-text></claim><claim id="c-en-0006" num="0006"><claim-text>Method for transmitting a digital modulated signal comprising the method of pre-equalizing a digital modulated signal as in any one of the preceding claims and further comprising,
<claim-text>- upconverting the equalized stream of symbols into an RF signal,</claim-text></claim-text></claim><claim id="c-en-0007" num="0007"><claim-text>Method for transmitting as in Claim 6, comprising amplifying the RF signal using a switching power amplifier.</claim-text></claim><claim id="c-en-0008" num="0008"><claim-text>A pre-equalizer for use in a digital modulation RF transmitter, comprising
<claim-text>- an input interface for receiving an input stream of symbols (x(i)) representing a phase change and magnitude of an RF signal, wherein the magnitudes of the symbols in the input stream are constant and the phase changes of the symbols in the input stream encode digital information, and</claim-text>
<claim-text>- an output interface for outputting an equalized stream of symbols (x'(i)) obtained by adjusting the input stream of symbols to reduce inter-symbol interference in transmission of an RF signal modulated according to the input stream, each symbol of the equalized stream representing a phase change and magnitude of an RF signal,</claim-text>
<claim-text>- the pre-equalizer is configured to iteratively determine a next symbol of the equalized stream (x'(n)) after receiving a next symbol of the input stream (x(n)), the pre-equalizer comprises a</claim-text>
<claim-text>- a first multiplier configured to multiply said next symbol of the input stream (x(n)) with a next adjusting real number (a(n)),</claim-text>
<claim-text>- a second multiplier configured to multiply a previous symbol of the input stream (x(n-1)) with a previous adjusting real number (a(n-1)), said previous symbol being received directly before said next symbol of the input stream, and<!-- EPO <DP n="22"> --></claim-text>
<claim-text>- a symbol combiner configured to compute the next symbol of the equalized stream from the multiplied next symbol of the input stream and the multiplied previous symbol of the input stream.</claim-text></claim-text></claim><claim id="c-en-0009" num="0009"><claim-text>A pre-equalizer for use in a digital modulation RF transmitter as in Claim 8, comprising an adjustment stream source configured to iteratively generate an adjusting stream of adjusting real numbers, by after receiving the next symbol of the input stream determining the next adjusting real number of the adjusting stream, the next adjusting real number of the adjusting stream depending on said next symbol of the input stream, said previous symbol of the input stream and the previous adjusting real number in the adjusting stream of adjusting real numbers.</claim-text></claim><claim id="c-en-0010" num="0010"><claim-text>A digital modulation RF transmitter comprising a pre-equalizer as in any one of claims 8 or 9, an upconverter configured to upconvert the equalized stream of symbols into an RF signal, and a switching power amplifier configured to amplifying the RF signal of the upconverter.</claim-text></claim><claim id="c-en-0011" num="0011"><claim-text>A computer program comprising computer program code means adapted to perform all the steps of any one of the claims 1 to 3 when the computer program is run on a computer.</claim-text></claim><claim id="c-en-0012" num="0012"><claim-text>A computer program as claimed in claim 11 embodied on a computer readable medium.</claim-text></claim></claims><amended-claims mxw-id="PCLM56976183" lang="EN" load-source="patent-office" amended-claim-type="EPC"><!-- EPO <DP n="23"> --><heading id="h0010">Amended claims in accordance with Rule 137(2) EPC.</heading><claim id="ac-en-0001" num="1"><claim-text><b>1.</b> A method for pre-equalizing a digital modulated RF signal, the method comprising - receiving an input stream (110) of symbols (x(i)) representing a phase change and magnitude of an RF signal, wherein the magnitudes of the symbols in the input stream (110) are constant and the phase changes of the symbols in the input stream (110) encode digital information, and
<claim-text>- adjusting the input stream (110) of symbols to reduce inter-symbol interference in transmission of an RF signal modulated according to the input stream (110), thus obtaining an equalized stream (120) of symbols (x'(i)), each symbol of the equalized stream (120) representing a phase change and magnitude of an RF signal,</claim-text>
<claim-text>- the adjusting comprising iteratively determining a next symbol of the equalized stream (x'(n)) after receiving a next symbol of the input stream (x(n)) by</claim-text>
<claim-text>- multiplying said next symbol of the input stream (x(n)) with a next adjusting real number (a(n)),</claim-text>
<claim-text>- multiplying a previous symbol of the input stream (x(n-1)) with a previous adjusting real number (a(n-1)), said previous symbol being received directly before said next symbol of the input stream (110), and</claim-text>
<claim-text>- computing the next symbol of the equalized stream (120) from the multiplied next symbol of the input stream (110) and the multiplied previous symbol of the input stream (110),<br/>
<b>characterized in that</b> the equalized stream (120) is defined by the following formula:
<claim-text><maths id="math0025" num=""><math display="inline"><mi mathvariant="italic">xʹ</mi><mfenced><mi>n</mi></mfenced><mo>=</mo><mfrac><mrow><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>⋅</mo><mi>x</mi><mfenced><mi>n</mi></mfenced><mo>-</mo><mi>p</mi><mo>⋅</mo><mi>α</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mrow><mrow><mn>1</mn><mo>-</mo><mi>p</mi></mrow></mfrac><mo>,</mo></math><img id="ib0025" file="imgb0025.tif" wi="73" he="14" img-content="math" img-format="tif" inline="yes"/></maths>, with the value of <i>α</i>(<i>n</i>) defined recursively as:
<claim-text>, <maths id="math0026" num=""><math display="inline"><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>=</mo><mi>α</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><mi>Re</mi><mo>⁢</mo><mfenced separators=""><mi>p</mi><mo>⋅</mo><mover><mi>x</mi><mo> ‾</mo></mover><mfenced><mi>n</mi></mfenced><mo>⁢</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mfenced><mo>+</mo><msqrt><msup><mi>α</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><msup><mi>Re</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><mi>p</mi><mo>⋅</mo><mover><mi>x</mi><mo> ‾</mo></mover><mfenced><mi>n</mi></mfenced><mo>⁢</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mfenced><mo>+</mo><msup><mfenced open="|" close="|" separators=""><mn>1</mn><mo>-</mo><mi>p</mi></mfenced><mn>2</mn></msup><mo>-</mo><msup><mi>α</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><msup><mfenced open="|" close="|"><mi>p</mi></mfenced><mn>2</mn></msup></msqrt></math><img id="ib0026" file="imgb0026.tif" wi="153" he="9" img-content="math" img-format="tif" inline="yes"/></maths>wherein x'(n) represents the equalized stream (120), <i>α</i>(<i>n</i>) represents an adjusting stream (130), and p represents a model of the RF channel.</claim-text></claim-text></claim-text></claim-text></claim><claim id="ac-en-0002" num="2"><claim-text><b>2.</b> A method as in Claim 1, comprising
<claim-text>- iteratively generating the adjusting stream (130) of adjusting real numbers, comprising<!-- EPO <DP n="24"> --></claim-text>
<claim-text>- after receiving the next symbol of the input stream (110) determining the next adjusting real number of the adjusting stream (130), the next adjusting real number of the adjusting stream (130) depending on said next symbol of the input stream (110), said previous symbol of the input stream (110) and the previous adjusting real number in the adjusting stream of adjusting real numbers.</claim-text></claim-text></claim><claim id="ac-en-0003" num="3"><claim-text><b>3.</b> A method as in Claim 1 or 2, comprising
<claim-text>- computing the next symbol of the equalized stream (120) comprises multiplying said multiplied previous symbol with a modeling complex number (-p) indicating the RF channel through which a RF signal modulated according to the equalized stream is to be sent, and adding to the result to said multiplied next symbol.</claim-text></claim-text></claim><claim id="ac-en-0004" num="4"><claim-text><b>4.</b> Method for transmitting a digital modulated signal comprising the method of pre-equalizing a digital modulated signal as in any one of the preceding claims and further comprising,
<claim-text>- upconverting the equalized stream (120) of symbols into an RF signal,</claim-text></claim-text></claim><claim id="ac-en-0005" num="5"><claim-text><b>5.</b> Method for transmitting as in Claim 4, comprising amplifying the RF signal using a switching power amplifier (208).</claim-text></claim><claim id="ac-en-0006" num="6"><claim-text><b>6.</b> A pre-equalizer (200) for use in a digital modulation RF transmitter, comprising
<claim-text>- an input interface (210) for receiving an input stream (110) of symbols (x(i)) representing a phase change and magnitude of an RF signal, wherein the magnitudes of the symbols in the input stream (110) are constant and the phase changes of the symbols in the input stream (110) encode digital information, and</claim-text>
<claim-text>- an output interface (250) for outputting an equalized stream (120) of symbols (x'(i)) obtained by adjusting the input stream (110) of symbols to reduce inter-symbol interference in transmission of an RF signal modulated according to the input stream (110), each symbol of the equalized stream (120) representing a phase change and magnitude of an RF signal,</claim-text>
<claim-text>- the pre-equalizer (200) is configured to iteratively determine a next symbol of the equalized stream (x'(n)) after receiving a next symbol of the input stream (x(n)), the pre-equalizer comprises a</claim-text>
<claim-text>- a first multiplier (232) configured to multiply said next symbol of the input stream (x(n)) with a next adjusting real number (a(n)),</claim-text>
<claim-text>- a second multiplier (234) configured to multiply a previous symbol of the input stream (x(n-1)) with a previous adjusting real number (a(n-1)), said previous symbol being received directly before said next symbol of the input stream (110), and<!-- EPO <DP n="25"> --></claim-text>
<claim-text>- a symbol combiner (240) configured to compute the next symbol of the equalized stream (120) from the multiplied next symbol of the input stream (110) and the multiplied previous symbol of the input stream (110),<br/>
<b>characterized in that</b> the equalized stream (120) is defined by the following formula:
<claim-text><maths id="math0027" num=""><math display="inline"><mi mathvariant="italic">xʹ</mi><mfenced><mi>n</mi></mfenced><mo>=</mo><mfrac><mrow><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>⋅</mo><mi>x</mi><mfenced><mi>n</mi></mfenced><mo>-</mo><mi>p</mi><mo>⋅</mo><mi>α</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mrow><mrow><mn>1</mn><mo>-</mo><mi>p</mi></mrow></mfrac><mo>,</mo></math><img id="ib0027" file="imgb0027.tif" wi="72" he="14" img-content="math" img-format="tif" inline="yes"/></maths> with the value of <i>α</i>(<i>n</i>) defined recursively as:
<claim-text>, <maths id="math0028" num=""><math display="inline"><mi>α</mi><mfenced><mi>n</mi></mfenced><mo>=</mo><mi>α</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><mi>Re</mi><mo>⁢</mo><mfenced separators=""><mi>p</mi><mo>⋅</mo><mover><mi>x</mi><mo> ‾</mo></mover><mfenced><mi>n</mi></mfenced><mo>⁢</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mfenced><mo>+</mo><msqrt><msup><mi>α</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><msup><mi>Re</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><mi>p</mi><mo>⋅</mo><mover><mi>x</mi><mo> ‾</mo></mover><mfenced><mi>n</mi></mfenced><mo>⁢</mo><mi>x</mi><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced></mfenced><mo>+</mo><msup><mfenced open="|" close="|" separators=""><mn>1</mn><mo>-</mo><mi>p</mi></mfenced><mn>2</mn></msup><mo>-</mo><msup><mi>α</mi><mn>2</mn></msup><mo>⁢</mo><mfenced separators=""><mi>n</mi><mo>-</mo><mn>1</mn></mfenced><mo>⁢</mo><msup><mfenced open="|" close="|"><mi>p</mi></mfenced><mn>2</mn></msup></msqrt><mo>,</mo></math><img id="ib0028" file="imgb0028.tif" wi="152" he="9" img-content="math" img-format="tif" inline="yes"/></maths> wherein x'(n) represents the equalized stream (120), <i>α</i>(<i>n</i>) represents an adjusting stream (130), and p represents a model of the RF channel.</claim-text></claim-text></claim-text></claim-text></claim><claim id="ac-en-0007" num="7"><claim-text><b>7.</b> A pre-equalizer (200) for use in a digital modulation RF transmitter as in Claim 6, comprising an adjustment stream source (230) configured to iteratively generate the adjusting stream (130) of adjusting real numbers, by after receiving the next symbol of the input stream (110) determining the next adjusting real number of the adjusting stream (130), the next adjusting real number of the adjusting stream (130) depending on said next symbol of the input stream (110), said previous symbol of the input stream (110) and the previous adjusting real number in the adjusting stream (130) of adjusting real numbers.</claim-text></claim><claim id="ac-en-0008" num="8"><claim-text><b>8.</b> A digital modulation RF transmitter comprising a pre-equalizer (200) as in any one of claims 6 or 7, an upconverter (207) configured to upconvert the equalized stream (120) of symbols into an RF signal, and a switching power amplifier (208) configured to amplifying the RF signal of the upconverter (207).</claim-text></claim><claim id="ac-en-0009" num="9"><claim-text><b>9.</b> A computer program comprising computer program code means adapted to perform all the steps of any one of the claims 1 to 3 when the computer program is run on a computer.</claim-text></claim><claim id="ac-en-0010" num="10"><claim-text><b>10.</b> A computer program as claimed in claim 9 embodied on a computer readable medium.</claim-text></claim></amended-claims><drawings mxw-id="PDW16666967" load-source="patent-office"><!-- EPO <DP n="26"> --><figure id="f0001" num="1,2"><img id="if0001" file="imgf0001.tif" wi="105" he="190" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="27"> --><figure id="f0002" num="3"><img id="if0002" file="imgf0002.tif" wi="164" he="110" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="28"> --><figure id="f0003" num="4a,4b,5a,5b,6a,6b"><img id="if0003" file="imgf0003.tif" wi="165" he="217" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="29"> --><figure id="f0004" num="7a,7b,8a,8b,9a,9b"><img id="if0004" file="imgf0004.tif" wi="165" he="217" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="30"> --><figure id="f0005" num="10"><img id="if0005" file="imgf0005.tif" wi="156" he="136" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="31"> --><figure id="f0006" num="11a"><img id="if0006" file="imgf0006.tif" wi="124" he="214" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="32"> --><figure id="f0007" num="11b"><img id="if0007" file="imgf0007.tif" wi="108" he="214" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="33"> --><figure id="f0008" num="11c"><img id="if0008" file="imgf0008.tif" wi="104" he="211" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="34"> --><figure id="f0009" num="11d"><img id="if0009" file="imgf0009.tif" wi="95" he="214" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="35"> --><figure id="f0010" num="12"><img id="if0010" file="imgf0010.tif" wi="165" he="199" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="36"> --><figure id="f0011" num="13"><img id="if0011" file="imgf0011.tif" wi="165" he="220" img-content="drawing" img-format="tif"/></figure></drawings><search-report-data><doc-page id="srep0001" file="srep0001.tif" wi="161" he="233" type="tif"/><doc-page id="srep0002" file="srep0002.tif" wi="155" he="233" type="tif"/></search-report-data><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
