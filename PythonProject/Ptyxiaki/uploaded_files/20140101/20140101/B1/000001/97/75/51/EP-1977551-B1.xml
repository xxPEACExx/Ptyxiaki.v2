<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-1977551-B1" country="EP" doc-number="1977551" kind="B1" date="20140101" family-id="38286953" file-reference-id="306747" date-produced="20180826" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146553513" ucid="EP-1977551-B1"><document-id><country>EP</country><doc-number>1977551</doc-number><kind>B1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-07716933-A" is-representative="NO"><document-id mxw-id="PAPP154827436" load-source="docdb" format="epo"><country>EP</country><doc-number>07716933</doc-number><kind>A</kind><date>20070123</date><lang>EN</lang></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140454803" ucid="US-2007001800-W" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>2007001800</doc-number><kind>W</kind><date>20070123</date></document-id></priority-claim><priority-claim mxw-id="PPC140445390" ucid="US-33869006-A" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>33869006</doc-number><kind>A</kind><date>20060125</date></document-id></priority-claim></priority-claims><dates-of-public-availability><intention-to-grant-date><date>20130730</date></intention-to-grant-date><search-report-dispatch-date><date>20120619</date></search-report-dispatch-date></dates-of-public-availability><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988138567" load-source="ipcr">G06F  21/12        20130101AFI20130711BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL1988107634" load-source="docdb" scheme="CPC">G06F  21/125       20130101 FI20130101BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132193023" lang="DE" load-source="patent-office">BINDUNG EINES GESCHÜTZTEN ANWENDUNGSPROGRAMMS AN EINEN SHELLCODE</invention-title><invention-title mxw-id="PT132193024" lang="EN" load-source="patent-office">BINDING A PROTECTED APPLICATION PROGRAM TO SHELL CODE</invention-title><invention-title mxw-id="PT132193025" lang="FR" load-source="patent-office">LIAISON D'UN PROGRAMME D'APPLICATION PROTÉGÉE À UN CODE D'ENVELOPPE</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR918163085" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>SAFENET INC</last-name><address><country>US</country></address></addressbook></applicant><applicant mxw-id="PPAR918141068" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>SAFENET, INC.</last-name></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918154549" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>ELTETO LASZLO</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918160922" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>ELTETO, LASZLO</last-name></addressbook></inventor><inventor mxw-id="PPAR918997070" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>ELTETO, LASZLO</last-name><address><street>185 Santa Louisa</street><city>Irvine, California 92606</city><country>US</country></address></addressbook></inventor></inventors><assignees><assignee mxw-id="PPAR918997071" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>SafeNet, Inc.</last-name><iid>100212482</iid><address><street>4690 Millennium Drive</street><city>Belcamp, MD 21017</city><country>US</country></address></addressbook></assignee></assignees><agents><agent mxw-id="PPAR918997072" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>de Zeeuw, Johan Diederick</last-name><iid>100051370</iid><address><street>Murgitroyd &amp; Company Scotland House 165-169 Scotland Street</street><city>Glasgow G5 8PL</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="US-2007001800-W"><document-id><country>US</country><doc-number>2007001800</doc-number><kind>W</kind><date>20070123</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2007087316-A2"><document-id><country>WO</country><doc-number>2007087316</doc-number><kind>A2</kind><date>20070802</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS548987585" load-source="docdb">AT</country><country mxw-id="DS548883965" load-source="docdb">BE</country><country mxw-id="DS548863022" load-source="docdb">BG</country><country mxw-id="DS548977771" load-source="docdb">CH</country><country mxw-id="DS548883966" load-source="docdb">CY</country><country mxw-id="DS548987586" load-source="docdb">CZ</country><country mxw-id="DS548978394" load-source="docdb">DE</country><country mxw-id="DS548883967" load-source="docdb">DK</country><country mxw-id="DS548883968" load-source="docdb">EE</country><country mxw-id="DS548975962" load-source="docdb">ES</country><country mxw-id="DS548863023" load-source="docdb">FI</country><country mxw-id="DS548977772" load-source="docdb">FR</country><country mxw-id="DS548978395" load-source="docdb">GB</country><country mxw-id="DS548883969" load-source="docdb">GR</country><country mxw-id="DS548987587" load-source="docdb">HU</country><country mxw-id="DS548975963" load-source="docdb">IE</country><country mxw-id="DS548883970" load-source="docdb">IS</country><country mxw-id="DS548863024" load-source="docdb">IT</country><country mxw-id="DS548883971" load-source="docdb">LI</country><country mxw-id="DS548863025" load-source="docdb">LT</country><country mxw-id="DS548973209" load-source="docdb">LU</country><country mxw-id="DS548863026" load-source="docdb">LV</country><country mxw-id="DS548863027" load-source="docdb">MC</country><country mxw-id="DS548973250" load-source="docdb">NL</country><country mxw-id="DS548973251" load-source="docdb">PL</country><country mxw-id="DS548975964" load-source="docdb">PT</country><country mxw-id="DS548828980" load-source="docdb">RO</country><country mxw-id="DS548973252" load-source="docdb">SE</country><country mxw-id="DS548978396" load-source="docdb">SI</country><country mxw-id="DS548977773" load-source="docdb">SK</country><country mxw-id="DS548883972" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><description mxw-id="PDES63957245" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001">BACKGROUND OF THE INVENTION</heading><heading id="h0002">Field of the Invention</heading><p id="p0001" num="0001">The invention described herein relates to digital rights management and more particularly to the prevention of unauthorized use of software.</p><heading id="h0003">Related Art</heading><p id="p0002" num="0002">One of the longstanding problems in the commercial distribution of software is controlling the use of the software. From the perspective of the software developer, only the party who has purchased or licensed the software may use the software. There may be other restrictions in place as well. For example, the software developer may wish to restrict use of the software on a particular mashine. The developer may also wish to restrict the time interval during which the software may be used. Such restrictions, if enforced, limit the conditions under which a software package is used. Use of a software package, i.e., use that is outside the boundaries of what is specified in restrictions such as those above, represents unauthorized use. From the perspective of the software developer, software should only be used under conditions specified by the software developer, in agreement with the purchaser or licensor. Use of the software package outside of these conditions represents use that has not been paid for. Such unauthorized use therefore represents money lost to the software developer.</p><p id="p0003" num="0003">One solution to the problem of unauthorized use of software involves using an additional software module, known as a shell. This is illustrated in <figref idrefs="f0001">FIG. 1</figref>. An application program 110 comprises a header 120, followed by code 130 and data 140. Appended to the end of application 110 is a shell module, shell runtime code 150. A pointer 160 resides in header 120. Pointer 160 assures that shell runtime code 150 executes prior to execution of application 110.<!-- EPO <DP n="2"> --></p><p id="p0004" num="0004">The shell module 150 performs one or more security checks. These checks determine whether various conditions for the use of the software are being met. For example, shell module 150 may determine whether application 110 will be executing on an authorized machine. In addition, shell module 150 may check whether application 110 will be executing within the authorized time window. Shell module 150 may also check whether a security token, if required, is in place. If and only if all the checks in shell module 150 are passed, application 110 can then begin execution.</p><p id="p0005" num="0005">The use of such a shell module is not always sufficient, however. A hacker may, for example, separate the shell from the application. The shell module may be deleted, or functionally disconnected from the application so that security checks are never made. There is a need, therefore, for a mechanism through which a shell module can be bound to an application, such that if the shell module is deleted or functionally disconnected from the application, the application will not be useable.<br/>
The document <patcit id="pcit0001" dnum="WO03009114A2"><text>WO-03/009114-A2</text></patcit> discloses a method of protecting an application module by overwriting its executable code at identified authorisation points with control transfers to a managed challenge system. The managed challenge system is constructed to include the overwritten executable code and performs an authorisation check upon acquiring control from an authorisation point. The managed challenge system is linked to the rewritten application module.<br/>
The document <patcit id="pcit0002" dnum="US6202176B1"><text>US-6202176-B1</text></patcit> discloses a method of preventing deliberate manipulation of program executions of software programs by preventing the overwriting of return addresses. A safeguard memory that cannot be addressed from outside the system is used for protecting the return addresses by evaluating safeguard information generated when the return addresses are stored.</p><heading id="h0004">SUMMARY OF THE INVENTION</heading><p id="p0006" num="0006">The invention described herein is a system and method for binding a protected application to a shell module. The shell module is appended to the application. The shell module executes prior to the execution of the application, and first creates a resource. After the shell module finishes execution, the application tries to access the created resource. If the access is successful, the application is allowed to proceed. Otherwise, the application terminates. The inability of the application to access the resource is an indication that the shell module never actually created the resource. This suggests that the shell module never executed; the shell module may have been either removed or functionally disconnected from the application. This further implies that the security functionality of the shell module has not executed. The application is therefore not permitted to execute, since the shell's security checks have probably not been performed.</p><p id="p0007" num="0007">Further embodiments, features, and advantages of the present invention, as well as the structure and operation of the various embodiments of<!-- EPO <DP n="3"> --><!-- EPO <DP n="4"> --> the present invention, are described below with reference to the accompanying figures.</p><heading id="h0005">BRIEF DESCRIPTION OF THE FIGURES</heading><p id="p0008" num="0008"><figref idrefs="f0001">FIG. 1</figref> illustrates an application program with an appended shell module, according to the prior art.</p><p id="p0009" num="0009"><figref idrefs="f0002">FIG. 2</figref> illustrates a computing platform on which the invention may execute, according to an embodiment of the invention.</p><p id="p0010" num="0010"><figref idrefs="f0003">FIG. 3</figref> is a block diagram illustrating an embodiment of the invention in which the shell module allocates a memory location that the application subsequently tries to access.</p><p id="p0011" num="0011"><figref idrefs="f0004">FIG. 4</figref> is a flow chart illustrating the processing associated with the embodiment of <figref idrefs="f0003">FIG. 3</figref>.</p><p id="p0012" num="0012"><figref idrefs="f0005">FIG. 5</figref> is a block diagram illustrating an embodiment of the invention in which the shell module creates a mutex that the application subsequently tries to access.</p><p id="p0013" num="0013"><figref idrefs="f0006">FIG. 6</figref> is a flow chart illustrating the processing associated with the embodiment of <figref idrefs="f0005">FIG. 5</figref>.</p><heading id="h0006">DETAILED DESCRIPTION OF THE INVENTION</heading><p id="p0014" num="0014">A preferred embodiment of the present invention is now described with reference to the figures, where like reference numbers indicate identical or functionally similar elements. Also, in the figures, the left-most digit of each reference number corresponds to the figure in which the reference number is first used. While specific configurations and arrangements are discussed, it should be understood that this is done for illustrative purposes only. A person skilled in the relevant art will recognize that other configurations and arrangements can be used without departing from the spirit and scope of the invention. It will also be apparent to a person skilled in the relevant art that this invention can also be employed in a variety of other systems and applications.<!-- EPO <DP n="5"> --></p><heading id="h0007">I. Overview</heading><p id="p0015" num="0015">The invention described herein is a system and method for binding a protected application to a shell module. The shell module is appended to the application. The shell module executes prior to the execution of the application, and first creates a resource. After the shell module finishes execution, the application tries to access the created resource. If the access is successful, the application is allowed to proceed. Otherwise, the application terminates. The inability of the application to access the resource is an indication that the shell module never actually created the resource. This suggests that the shell module never executed; the shell module may have been either removed or functionally disconnected from the application. This further implies that the security functionality of the shell module has not executed. The application is therefore not permitted to execute, since the shell's security checks have probably not been performed.</p><heading id="h0008">II. System</heading><p id="p0016" num="0016">The invention described herein can take the form of software that executes in a computing environment such as the one illustrated in <figref idrefs="f0002">FIG. 2</figref>.</p><p id="p0017" num="0017">An example of a computer system 200 is shown in <figref idrefs="f0002">FIG. 2</figref>. The computer system 200 may include one or more processors, such as processor 204. The processor 204 may be connected to a communication infrastructure 206 (e.g., a communications bus or network). After reading this description, it will become apparent to a person skilled in the relevant art(s) how to implement the invention with respect to other computer systems and/or computer architectures.</p><p id="p0018" num="0018">Computer system 200 may include a display interface 202 that may forward graphics, text, and other data from the communication infrastructure 206 for display on the display unit 230.</p><p id="p0019" num="0019">Computer system 200 may also include a main memory 208, e.g., random access memory (RAM), and may also include a secondary memory 210. The secondary memory 210 may include, for example, a hard disk drive<!-- EPO <DP n="6"> --> 212 and/or a removable storage drive 214, representing a magnetic tape drive, an optical disk drive, etc., but which is not limited thereto. The removable storage drive 214 may read from and/or write to a removable storage unit 218 in a well known manner. Removable storage unit 218, may represent a floppy disk, magnetic tape, optical disk, etc., which may be read by and/or written to by removable storage drive 214. As will be appreciated, the removable storage unit 218 may include a computer usable storage medium having stored therein computer software and/or data.</p><p id="p0020" num="0020">In alternative embodiments, secondary memory 210 may include other similar means for allowing computer programs or other instructions to be loaded into computer system 200. Such means may include, for example, a removable storage unit 222 and an interface 220. Examples of such may include, but are not limited to, a removable memory chip (such as an EPROM, or PROM) and associated socket, and/or other removable storage units 222 and interfaces 220 that may allow software and data to be transferred from the removable storage unit 222 to computer system 200.</p><p id="p0021" num="0021">Computer system 200 may also include a communications interface 224. Communications interface 224 may allow software and data to be transferred between computer system 200 and external devices. Examples of communications interface 224 may include, but are not limited to, a modem, a network interface (such as an Ethernet card), a communications port, a PCMCIA slot and card, etc. Software and data transferred via communications interface 224 are in the form of signals 228 which may be, for example, electronic, electromagnetic, optical or other signals capable of being received by communications interface 224. These signals 228 may be provided to communications interface 224 via a communications path (i.e., channel) 226. This channel 226 may carry signals 228 and may be implemented using wire or cable, fiber optics, a phone line, a cellular phone link, an RF link and/or other communications channels.</p><p id="p0022" num="0022">In this document, the terms "computer program medium" and "computer usable medium" are used to generally refer to media such as, but not limited to, removable storage unit 218, a hard disk installed in hard disk drive 212, and/or signals 228. These computer program media are means for providing software to computer system 200.<!-- EPO <DP n="7"> --></p><p id="p0023" num="0023">Computer programs (also called computer control logic) may be stored in main memory 208 and/or secondary memory 210. Computer programs may also be received via communications interface 224. Such computer programs, when executed, enable the computer system 200 to perform the features of the present invention as discussed herein. In particular, the computer programs, when executed, may enable the processor 204 to perform the present invention in accordance with the embodiments described below. Accordingly, such computer programs represent controllers of the computer system 200.</p><p id="p0024" num="0024">Software embodying the invention may be stored in a computer program product and loaded into computer system 200 using, for example, removable storage drive 214, hard drive 212, interface 220, or communications interface 224. The control logic (software), when executed by the processor 204, causes the processor 204 to perform the functions of the invention as described herein.</p><heading id="h0009">III. Method</heading><p id="p0025" num="0025">The processing of an embodiment of the invention is illustrated in <figref idrefs="f0003">FIGS. 3</figref> and <figref idrefs="f0004">4</figref>. In <figref idrefs="f0003">FIG. 3</figref>, a protected application 310 is shown as consisting of header 320, code 330, and data 340. Appended to the application 310 is shell runtime code 350. The overall processing has some similarities to that of <figref idrefs="f0001">FIG. 1</figref>, in that the shell module 350 executes prior to the execution of application 310. Among its other security related functions, shell module 350 allocates memory location 360. Memory location 360 is located at address 370. In addition to allocating memory 360, shell module 350 also stores an agreed upon value 380 in memory location 360. In an embodiment of the invention, the agreed upon value 380 can be a predetermined value provided by the developer of the application 310.</p><p id="p0026" num="0026">Shell module 350 then stores address 370 in a location readily accessible by the application. In the illustrated embodiment, the address 370 is stored in or with a date/time stamp 390, which is located within header 320.</p><p id="p0027" num="0027">Once the application begins to execute, the application retrieves address 370, goes to that address, i.e., to memory location 360, and attempts to<!-- EPO <DP n="8"> --> read the agreed upon value 380. If the value that is read matches the agreed upon value 380, then the application proceeds. If the value does not match, the application 310 terminates. Moreover, if address 370 is not found by the application 310, then the application terminates.</p><p id="p0028" num="0028">Note that if a hacker succeeds in removing shell module 350, or otherwise functionally disconnects shell 350 from the application, then date/time stamp 390 will not receive an address, and the application will fail to access the memory location 360. Alternatively, the application may have some address in date/time stamp field 390, but the value found at that address would likely not match the agreed upon value 380.</p><p id="p0029" num="0029">In order to circumvent this sequence of checks, a hacker would now have to simulate the actions of shell module 350. The hacker would have to place an address in the location expected by the application, i.e., date/time stamp field 390. This would be difficult for a hacker to do.</p><p id="p0030" num="0030">Moreover, this could be made more difficult by obfuscating the stored address 370. The shell module 350 could, for example, take address 370, and combine it in a deterministic reversible manner with some known constant. Address 370 could be combined with the constant using a bitwise XOR operation, for example. The application 310 would then read the obfuscated address from date/time stamp 390 then apply the constant to the obfuscated address in order to recover the actual address 370. In an embodiment of the invention, some of all of the constant is supplied by the application developer.</p><p id="p0031" num="0031">The processing associated with the embodiment of <figref idrefs="f0003">FIG. 3</figref> is presented in the flow chart of <figref idrefs="f0004">FIG. 4</figref>. The process begins at step 405. In step 410, the shell module allocates a memory location. In step 415, the shell module stores an agreed-upon value into the allocated memory location. As discussed above, the agreed-upon value may be provided by the software developer of the application. In step 420, the address of the allocated memory is stored in the executable header of the application. One possible location for storage of the address would be the date/time stamp of the header, as discussed above.</p><p id="p0032" num="0032">In step 425, the application attempts to retrieve the address from the header. In step 430, a determination is made as to whether this retrieval is successful. If not, the application terminates at step 440. If retrieval is successful, then the process continues at 435. Here, the memory contents are<!-- EPO <DP n="9"> --> read. In step 445, a determination is made as to whether the correct value has been found in the allocated memory location. If not, the application terminates at step 440. If the correct value is found, as determined in step 445, then the application continues, and the process concludes at step 450.</p><p id="p0033" num="0033">An alternative embodiment of the invention is shown in <figref idrefs="f0005">FIG. 5</figref>. Similar to previous illustrations, an application consists of code 530, along with header 520 and data 540. Again, a shell module 550 is appended, where the shell module 550 is used to create a resource. In this embodiment, the shell module 550 creates a mutual exclusion object, or "mutex" 560. A mutex is a program object used by program threads to share access to, say, a data structure such as a file. Any thread that needs the file must lock the mutex against other threads while using the file. The mutex is unlocked when the file is no longer needed or the routine is completed.</p><p id="p0034" num="0034">Here, the created mutex 560 is given a name by the shell module 550. The mutex name is based on name information. One example of name information is the process ID. The mutex name can therefore be the process ID, or can be based on the process ID. In the illustrated embodiment, the name for the mutex 560 is the value of a function f(process ID). After the shell module 550 completes execution, control returns to code 530.</p><p id="p0035" num="0035">Code 530 then attempts to recreate the name of the mutex 560. To do so in the example shown, code 530 would have to create the name on the basis of the process ID if the name is a function of the ID. If the name is simply the process ID, code 530 simply obtains the process ID. In either event, code 530 would then attempt to access the named mutex 560. The inability to access mutex 560 would be an indication that the shell module 550 has been deleted, disabled, or otherwise functionally disconnected from the application 510. If shell module 550 were not present or had been disabled, no mutex having a name based on the process ID would have been created by the shell module 550. Code 530 would then be attempting to access a resource that had not been created, and would obviously be unable to do so.</p><p id="p0036" num="0036">The processing of this embodiment of the invention is illustrated in the flow chart of <figref idrefs="f0006">FIG. 6</figref>. This process starts at step 605. In step 610, the shell module obtains name information, i.e., information that will be used to name the mutex to be created. In the example illustrated, the process ID is used as<!-- EPO <DP n="10"> --> the name information. In step 615, the shell module creates a name string, such as a hex representation of the process ID. In step 620, the shell module creates a named resource such as a mutex, identified by the name string. In step 625, the application retrieves the name information. In step 630, the application creates a name string based on the name information. In step 635, the application attempts to access the resource bearing that name. In step 640, a determination is made as to whether the access to the named resource is successful. If not, the application terminates in step 645. If the attempt to access the named resource is successful, then the process continues at step 650.</p><p id="p0037" num="0037">Note that in alternative embodiments of the invention, the name information can come from several sources. In the illustrated embodiment, the name information is the process ID. Alternatively, other process specific information can be used to derive a name for the mutex. One possibility is the start time for the process. The name would then be the start time or a function thereof. In yet another alternative embodiment, the name can be based on name information provided by the software developer of the application.</p><p id="p0038" num="0038">Note also that in alternative embodiments, an object other than a mutex can be created by the shell module. The shell module may create a semaphore, for example, or another sort of named resource. As in the mutex embodiment, the resource can be named on the basis of name information derived from the process or supplied by the application developer. The application can verify the operation of the shell module by attempting to access the resource using the name.</p><heading id="h0010">IV. Conclusion</heading><p id="p0039" num="0039">While some embodiments of the present invention have been described above, it should be understood that it has been presented by way of examples only and not meant to limit the invention. It will be understood by those skilled in the art that various changes in form and detail may be made therein without departing from the spirit and scope of the invention as defined in the appended claims. Thus, the breadth and scope of the present invention should<!-- EPO <DP n="11"> --> not be limited by the above-described exemplary embodiments, but should be defined only in accordance with the following claims and their equivalents.</p></description><claims mxw-id="PCLM56979224" lang="DE" load-source="patent-office"><!-- EPO <DP n="16"> --><claim id="c-de-01-0001" num="0001"><claim-text>Ein Verfahren zum Binden eines Sicherheitscodeshellmoduls an eine Anwendung, das die folgenden Schritte beinhaltet:
<claim-text>a. Erzeugen eines Betriebsmittels, durchgeführt durch das Shellmodul;</claim-text>
<claim-text>b. Versuchen des Zugriffs auf das Betriebsmittel, durchgeführt durch die Anwendung; und</claim-text>
<claim-text>c. wenn der Zugriff nicht erfolgreich ist, Beenden der Anwendung, <b>dadurch gekennzeichnet, dass</b> das Betriebsmittel zugeteilten Speicher beinhaltet, wobei das Verfahren ferner Folgendes beinhaltet:</claim-text>
<claim-text>d. Abspeichern eines vereinbarten Werts in dem zugeteilten Speicher;</claim-text>
<claim-text>e. Speichern einer Anzeige der Adresse des zugeteilten Speichers, durchgeführt durch das Shellmodul nach Schritt a. und vor Schritt b., wobei die Anzeige der Adresse des zugeteilten Speichers in einem ausführbaren Header der Anwendung gespeichert ist.</claim-text></claim-text></claim><claim id="c-de-01-0002" num="0002"><claim-text>Verfahren gemäß Anspruch 1, wobei die Anzeige der Adresse eine Adresse des zugeteilten Speichers beinhaltet, optional in Kombination mit einer Konstante, die sowohl der Anwendung als auch dem Shellmodul bekannt ist.</claim-text></claim><claim id="c-de-01-0003" num="0003"><claim-text>Verfahren gemäß Anspruch 1, wobei der Schritt b. Folgendes beinhaltet:
<claim-text>i. Versuchen des Wiedererlangens der Anzeige der Adresse aus dem ausführbaren Header, wobei das Misslingen des Wiedererlangens der Anzeige der Adresse aus dem ausführbaren Header einen nicht erfolgreichen Zugriff des Betriebsmittels bedeutet.</claim-text></claim-text></claim><claim id="c-de-01-0004" num="0004"><claim-text>Verfahren gemäß Anspruch 3, wobei der Schritt b ferner Folgendes beinhaltet:
<claim-text>ii. Lesen der Inhalte des zugeteilten Speichers; und</claim-text>
<claim-text>iii. Bestimmen, ob die Leseinhalte mit dem vereinbarten Wert übereinstimmen, wobei das Misslingen der Übereinstimmung mit dem vereinbarten Wert nicht erfolgreichen Zugriff des Betriebsmittels bedeutet.</claim-text></claim-text></claim><claim id="c-de-01-0005" num="0005"><claim-text>Verfahren gemäß einem der Ansprüche 1 bis 4, wobei das Betriebsmittel ein benanntes Betriebsmittel beinhaltet, wobei der Schritt a das Ableiten eines Namens für das benannte Betriebsmittel beinhaltet und wobei die Ableitung des Namens für das benannte Betriebsmittel Folgendes beinhaltet:
<claim-text>i. Erlangen von Namensinformationen; und</claim-text>
<claim-text>ii. Erzeugen des Namens auf der Grundlage der Namensinformationen,<br/>
<!-- EPO <DP n="17"> -->und wobei der Schritt b. Folgendes beinhaltet:
<claim-text>i. Wiedererlangen der Namensinformationen;</claim-text>
<claim-text>ii. Erzeugen des Namens auf der Grundlage der Namensinformationen; und</claim-text>
<claim-text>iii. Versuchen des Zugriffs auf das benannte Betriebsmittel unter Verwendung des erzeugten Namens.</claim-text></claim-text></claim-text></claim><claim id="c-de-01-0006" num="0006"><claim-text>Verfahren gemäß Anspruch 5, wobei die Namensinformationen durch einen Entwickler der Anwendung gelieferte Informationen beinhalten.</claim-text></claim><claim id="c-de-01-0007" num="0007"><claim-text>Verfahren gemäß Anspruch 5, wobei die Namensinformationen einen prozessspezifischen Wert beinhalten.</claim-text></claim><claim id="c-de-01-0008" num="0008"><claim-text>Verfahren gemäß Anspruch 7, wobei der prozessspezifische Wert die Startzeit eines Prozesses beinhaltet.</claim-text></claim><claim id="c-de-01-0009" num="0009"><claim-text>Verfahren gemäß Anspruch 7, wobei der prozessspezifische Wert eine Prozess-ID beinhaltet.</claim-text></claim><claim id="c-de-01-0010" num="0010"><claim-text>Ein Computerprogrammprodukt, das ein computernutzbares Medium beinhaltet, auf dem eine Computerprogrammlogik aufgezeichnet ist, die, wenn auf einem Computer ausgeführt, ein Sicherheitscodeshellmodul an eine Anwendung bindet, wobei die Computerprogrammlogik Folgendes beinhaltet:
<claim-text>erste Computerprogrammlogik in dem Shellmodul, die bewirkt, dass der Computer ein Betriebsmittel erzeugt;</claim-text>
<claim-text>zweite Computerprogrammlogik in der Anwendung, die bewirkt, dass der Computer den Zugriff auf das Betriebsmittel versucht; und</claim-text>
<claim-text>dritte Computerprogrammlogik, die bewirkt, dass der Computer die Anwendung beendet, wenn der Zugriff nicht erfolgreich ist, <b>dadurch gekennzeichnet, dass</b> das Betriebsmittel zugeteilten Speicher beinhaltet, wobei das Computerprogrammprodukt ferner Folgendes beinhaltet:
<claim-text>vierte Computerprogrammlogik, die bewirkt, dass der Computer einen vereinbarten Wert in dem zugeteilten Speicher abspeichert; und</claim-text>
<claim-text>fünfte Computerprogrammlogik, die bewirkt, dass der Computer eine Anzeige der Adresse des zugeteilten Speichers speichert, wobei die vierte und fünfte Computerprogrammlogik nach der ersten und vor der zweiten Computerprogrammlogik ausgeführt werden, wobei die Anzeige der Adresse des zugeteilten Speichers in einem ausführbaren Header der Anwendung gespeichert ist.</claim-text></claim-text><!-- EPO <DP n="18"> --></claim-text></claim><claim id="c-de-01-0011" num="0011"><claim-text>Computerprogrammprodukt gemäß Anspruch 10, wobei die zweite Computerprogrammlogik Folgendes beinhaltet:
<claim-text>i. Computerprogrammlogik, die bewirkt, dass der Computer versucht, die Anzeige der Adresse aus dem ausführbaren Header wiederzuerlangen, wobei das Misslingen des Wiedererlangens der Anzeige der Adresse aus dem ausführbaren Header nicht erfolgreichen Zugriff des Betriebsmittels bedeutet;</claim-text>
<claim-text>ii. Computerprogrammlogik, die bewirkt, dass der Computer die Inhalte des zugeteilten Speichers liest; und</claim-text>
<claim-text>iii. Computerprogrammlogik, die bewirkt, dass der Computer bestimmt, ob die Leseinhalte mit dem vereinbarten Wert übereinstimmen, wobei das Misslingen der Übereinstimmung mit dem vereinbarten Wert nicht erfolgreichen Zugriff des Betriebsmittels bedeutet.</claim-text></claim-text></claim><claim id="c-de-01-0012" num="0012"><claim-text>Computerprogrammprodukt gemäß Anspruch 10 oder 11, wobei das Betriebsmittel ein benanntes Betriebsmittel beinhaltet, und wobei die erste Computerprogrammlogik Folgendes beinhaltet:
<claim-text>i. Computerprogrammlogik, die bewirkt, dass der Computer Namensinformationen erlangt;</claim-text>
<claim-text>ii. Computerprogrammlogik, die bewirkt, dass der Computer einen Namen für das Betriebsmittel auf der Grundlage der Namensinformationen erzeugt,<br/>
und wobei die zweite Computerprogrammlogik Folgendes beinhaltet:
<claim-text>i. Computerprogrammlogik, die bewirkt, dass der Computer Namensinformationen wiedererlangt;</claim-text>
<claim-text>ii. Computerprogrammlogik, die bewirkt, dass der Computer den Namen auf der Grundlage der Namensinformationen erzeugt; und</claim-text>
<claim-text>iii. Computerprogrammlogik, die bewirkt, dass der Computer Zugriff auf das benannte Betriebsmittel unter Verwendung des erzeugten Namens versucht, wobei das Misslingen des Zugriffs auf das benannte Betriebsmittel unter Verwendung des erzeugten Namens einen nicht erfolgreichen Zugriff des Betriebsmittels bedeutet.</claim-text></claim-text></claim-text></claim></claims><claims mxw-id="PCLM56979225" lang="EN" load-source="patent-office"><!-- EPO <DP n="12"> --><claim id="c-en-01-0001" num="0001"><claim-text>A method of binding a security code shell module to an application, comprising the steps of:
<claim-text>a. creating a resource, performed by the shell module;</claim-text>
<claim-text>b. attempting to access the resource performed by the application; and</claim-text>
<claim-text>c. if the access is not successful, terminating the application, <b>characterized in that</b> the resource comprises allocated memory, said method further comprising:</claim-text>
<claim-text>d. storing an agreed upon value into the allocated memory;</claim-text>
<claim-text>e. saving an indication of the address of the allocated memory, performed by the shell module after step a. and before step b., wherein the indication of the address of the allocated memory is saved in an executable header of the application.</claim-text></claim-text></claim><claim id="c-en-01-0002" num="0002"><claim-text>The method of claim 1, wherein the indication of the address comprises an address of the allocated memory, optionally in combination with a constant known to both the application and the shell module.</claim-text></claim><claim id="c-en-01-0003" num="0003"><claim-text>The method of claim 1, wherein said step b. comprises:
<claim-text>i. attempting to retrieve the indication of the address from the executable header, wherein failure to retrieve the indication of the address from the executable header represents unsuccessful access of the resource.</claim-text></claim-text></claim><claim id="c-en-01-0004" num="0004"><claim-text>The method of claim 3, wherein said step b further comprises:
<claim-text>ii. reading the contents of the allocated memory; and</claim-text>
<claim-text>iii. determining if the read contents match the agreed upon value, wherein failure to match the agreed upon value represents unsuccessful access of the resource.</claim-text></claim-text></claim><claim id="c-en-01-0005" num="0005"><claim-text>The method of any of claims 1 to 4, wherein the resource comprises a named resource wherein said step a comprises deriving a name for the named resource and wherein said derivation of the name for the named resource comprises:
<claim-text>i. obtaining name information; and<!-- EPO <DP n="13"> --></claim-text>
<claim-text>ii. creating the name based on the name information and wherein said step b. comprises:
<claim-text>i. retrieving the name information;</claim-text>
<claim-text>ii. creating the name based on the name information; and</claim-text>
<claim-text>iii. attempting to access the named resource using the created name.</claim-text></claim-text></claim-text></claim><claim id="c-en-01-0006" num="0006"><claim-text>The method of claim 5, wherein the name information comprises information supplied by a developer of the application.</claim-text></claim><claim id="c-en-01-0007" num="0007"><claim-text>The method of claim 5, wherein the name information comprises a process specific value.</claim-text></claim><claim id="c-en-01-0008" num="0008"><claim-text>The method of claim 7, wherein said process specific value comprises the start time of a process.</claim-text></claim><claim id="c-en-01-0009" num="0009"><claim-text>The method of claim 7, wherein said process specific value comprises a process ID.</claim-text></claim><claim id="c-en-01-0010" num="0010"><claim-text>A computer program product comprising a computer useable medium having computer program logic recorded thereon, which, when executed on a computer, binds a security code shell module to an application, said computer program logic comprising:
<claim-text>first computer program logic, in the shell module, that causes the computer to create a resource;</claim-text>
<claim-text>second computer program logic, in the application, that causes the computer to attempt to access the resource; and</claim-text>
<claim-text>third computer program logic that causes the computer to terminate the application if the access is not successful, <b>characterized in that</b> the resource comprises allocated memory, said computer program product further comprising:
<claim-text>fourth computer program logic that causes the computer to store an agreed upon value into the allocated memory; and<!-- EPO <DP n="14"> --></claim-text>
<claim-text>fifth computer program logic that causes the computer to save an indication of the address of the allocated memory, wherein said fourth and fifth computer program logic execute after said first and before said second computer program logic, wherein the indication of the address of the allocated memory is saved in an executable header of the application.</claim-text></claim-text></claim-text></claim><claim id="c-en-01-0011" num="0011"><claim-text>The computer program product of claim 10, wherein said second computer program logic comprises:
<claim-text>i. computer program logic that causes the computer to attempt to retrieve the indication of the address from the executable header, wherein failure to retrieve the indication of the address from the executable header represents unsuccessful access of the resource;</claim-text>
<claim-text>ii. computer program logic that causes the computer to read the contents of the allocated memory; and</claim-text>
<claim-text>iii. computer program logic that causes the computer determine if the read contents match the agreed upon value, wherein failure to match the agreed upon value represents unsuccessful access of the resource.</claim-text></claim-text></claim><claim id="c-en-01-0012" num="0012"><claim-text>The computer program product of claim 10 or 11, wherein the resource comprises a named resource, and wherein said first computer program logic comprises:
<claim-text>i. computer program logic that causes the computer to obtaining name information;</claim-text>
<claim-text>ii. computer program logic that causes the computer to create a name for the resource based on the name information<br/>
and wherein said second computer program logic comprises:
<claim-text>i. computer program logic that causes the computer to retrieve the name information;</claim-text>
<claim-text>ii. computer program logic that causes the computer to create the name based on the name information; and<!-- EPO <DP n="15"> --></claim-text>
<claim-text>iii. computer program logic that causes the computer to attempt to access the named resource using the created name, wherein failure to access the named resource using the created name represents unsuccessful access of the resource.</claim-text></claim-text></claim-text></claim></claims><claims mxw-id="PCLM56979226" lang="FR" load-source="patent-office"><!-- EPO <DP n="19"> --><claim id="c-fr-01-0001" num="0001"><claim-text>Un procédé pour lier un module shell de code de sécurité à une application, comprenant les étapes consistant :
<claim-text>a. à créer une ressource, ce qu'effectue le module shell ;</claim-text>
<claim-text>b. à tenter d'accéder à la ressource, ce qu'effectue l'application ; et</claim-text>
<claim-text>c. si l'accès est infructueux, à mettre fin à l'application, <b>caractérisé en ce que</b> la ressource comprend une mémoire allouée, ledit procédé comprenant en outre :</claim-text>
<claim-text>d. le fait de stocker une valeur convenue dans la mémoire allouée ;</claim-text>
<claim-text>e. le fait de sauvegarder une indication de l'adresse de la mémoire allouée, ce qu'effectue le module shell après l'étape a. et avant l'étape b., dans lequel l'indication de l'adresse de la mémoire allouée est sauvegardée dans un en-tête exécutable de l'application.</claim-text></claim-text></claim><claim id="c-fr-01-0002" num="0002"><claim-text>Le procédé de la revendication 1, dans lequel l'indication de l'adresse comprend une adresse de la mémoire allouée, facultativement en combinaison avec une constante connue à la fois de l'application et du module shell.</claim-text></claim><claim id="c-fr-01-0003" num="0003"><claim-text>Le procédé de la revendication 1, dans lequel ladite étape b. comprend :
<claim-text>i. le fait de tenter de récupérer l'indication de l'adresse de l'en-tête exécutable, la non-récupération de l'indication de l'adresse de l'en-tête exécutable représentant un accès infructueux à la ressource.</claim-text></claim-text></claim><claim id="c-fr-01-0004" num="0004"><claim-text>Le procédé de la revendication 3, dans lequel ladite étape b comprend en outre :
<claim-text>ii. le fait de lire le contenu de la mémoire allouée ; et</claim-text>
<claim-text>iii. le fait de déterminer si le contenu lu équivaut à la valeur convenue, la non-équivalence avec la valeur convenue représentant un accès infructueux à la ressource.</claim-text></claim-text></claim><claim id="c-fr-01-0005" num="0005"><claim-text>Le procédé de n'importe lesquelles des revendications 1 à 4, dans lequel la ressource comprend une ressource nommée, ladite étape a comprenant le fait de dériver un nom pour la ressource nommée et ladite dérivation du nom pour la ressource nommée comprenant :
<claim-text>i. le fait d'obtenir des informations de nom ; et</claim-text>
<claim-text>ii. le fait de créer le nom sur la base des informations de nom et ladite étape b. comprenant :
<claim-text>i. le fait de récupérer les informations de nom ;</claim-text>
<claim-text>ii. le fait de créer le nom sur la base des informations de nom ; et<!-- EPO <DP n="20"> --></claim-text>
<claim-text>iii. le fait de tenter d'accéder à la ressource nommée en utilisant le nom créé.</claim-text></claim-text></claim-text></claim><claim id="c-fr-01-0006" num="0006"><claim-text>Le procédé de la revendication 5, dans lequel les informations de nom comprennent des informations fournies par un développeur de l'application.</claim-text></claim><claim id="c-fr-01-0007" num="0007"><claim-text>Le procédé de la revendication 5, dans lequel les informations de nom comprennent une valeur spécifique au processus.</claim-text></claim><claim id="c-fr-01-0008" num="0008"><claim-text>Le procédé de la revendication 7, dans lequel ladite valeur spécifique au processus comprend le moment du début d'un processus.</claim-text></claim><claim id="c-fr-01-0009" num="0009"><claim-text>Le procédé de la revendication 7, dans lequel ladite valeur spécifique au processus comprend un identificateur de processus.</claim-text></claim><claim id="c-fr-01-0010" num="0010"><claim-text>Un produit-programme informatique comprenant un support utilisable par un ordinateur sur lequel est enregistrée une logique de programme informatique qui, lorsqu'elle est exécutée sur un ordinateur, lie un module shell de code de sécurité à une application, ladite logique de programme informatique comprenant :
<claim-text>une première logique de programme informatique, dans le module shell, qui amène l'ordinateur à créer une ressource ;</claim-text>
<claim-text>une deuxième logique de programme informatique, dans l'application, qui amène l'ordinateur à tenter d'accéder à la ressource ; et</claim-text>
<claim-text>une troisième logique de programme informatique qui amène l'ordinateur à mettre fin à l'application si l'accès est infructueux, <b>caractérisé en ce que</b> la ressource comprend une mémoire allouée, ledit produit-programme informatique comprenant en outre :
<claim-text>une quatrième logique de programme informatique qui amène l'ordinateur à stocker une valeur convenue dans la mémoire allouée ; et</claim-text>
<claim-text>une cinquième logique de programme informatique qui amène l'ordinateur à sauvegarder une indication de l'adresse de la mémoire allouée, ladite quatrième et</claim-text>
<claim-text>ladite cinquième logique de programme informatique s'exécutant après ladite première et avant ladite deuxième logique de programme informatique, dans lequel l'indication de l'adresse de la mémoire allouée est sauvegardée dans un en-tête exécutable de l'application.</claim-text></claim-text></claim-text></claim><claim id="c-fr-01-0011" num="0011"><claim-text>Le produit-programme informatique de la revendication 10, dans lequel ladite deuxième logique de programme informatique comprend :
<claim-text>i. une logique de programme informatique qui amène l'ordinateur à tenter de récupérer l'indication de l'adresse de l'en-tête exécutable, la non-récupération de<!-- EPO <DP n="21"> --> l'indication de l'adresse de l'en-tête exécutable représentant un accès infructueux à la ressource ;</claim-text>
<claim-text>ii. une logique de programme informatique qui amène l'ordinateur à lire le contenu de la mémoire allouée ; et</claim-text>
<claim-text>iii. une logique de programme informatique qui amène l'ordinateur à déterminer si le contenu lu équivaut à la valeur convenue, la non-équivalence avec la valeur convenue représentant un accès infructueux à la ressource.</claim-text></claim-text></claim><claim id="c-fr-01-0012" num="0012"><claim-text>Le produit-programme informatique de la revendication 10 ou de la revendication 11, dans lequel la ressource comprend une ressource nommée, et dans lequel ladite première logique de programme informatique comprend :
<claim-text>i. une logique de programme informatique qui amène l'ordinateur à obtenir des informations de nom ;</claim-text>
<claim-text>ii. une logique de programme informatique qui amène l'ordinateur à créer un nom pour la ressource sur la base des informations de nom<br/>
et dans lequel ladite deuxième logique de programme informatique comprend :
<claim-text>i. une logique de programme informatique qui amène l'ordinateur à récupérer les informations de nom ;</claim-text>
<claim-text>ii. une logique de programme informatique qui amène l'ordinateur à créer le nom sur la base des informations de nom ; et</claim-text>
<claim-text>iii. une logique de programme informatique qui amène l'ordinateur à tenter d'accéder à la ressource nommée en utilisant le nom créé, le non-accès à la ressource nommée en utilisant le nom créé représentant un accès infructueux à la ressource.</claim-text></claim-text></claim-text></claim></claims><drawings mxw-id="PDW16668805" load-source="patent-office"><!-- EPO <DP n="22"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="139" he="194" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="23"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="153" he="164" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="24"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="147" he="191" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="25"> --><figure id="f0004" num="4"><img id="if0004" file="imgf0004.tif" wi="151" he="185" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="26"> --><figure id="f0005" num="5"><img id="if0005" file="imgf0005.tif" wi="150" he="188" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="27"> --><figure id="f0006" num="6"><img id="if0006" file="imgf0006.tif" wi="135" he="185" img-content="drawing" img-format="tif"/></figure></drawings><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
