<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2539890-B1" country="EP" doc-number="2539890" kind="B1" date="20140101" family-id="42320982" file-reference-id="315064" date-produced="20180823" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146552059" ucid="EP-2539890-B1"><document-id><country>EP</country><doc-number>2539890</doc-number><kind>B1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-11705524-A" is-representative="NO"><document-id mxw-id="PAPP154825982" load-source="docdb" format="epo"><country>EP</country><doc-number>11705524</doc-number><kind>A</kind><date>20110222</date><lang>EN</lang></document-id><document-id mxw-id="PAPP254255389" load-source="docdb" format="original"><country>EP</country><doc-number>11705524.4</doc-number><date>20110222</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140451850" ucid="EP-10154956-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>10154956</doc-number><kind>A</kind><date>20100226</date></document-id></priority-claim><priority-claim mxw-id="PPC140448379" ucid="EP-11705524-A" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>11705524</doc-number><kind>A</kind><date>20110222</date></document-id></priority-claim><priority-claim mxw-id="PPC140450820" ucid="EP-2011052605-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>2011052605</doc-number><kind>W</kind><date>20110222</date></document-id></priority-claim></priority-claims><dates-of-public-availability><intention-to-grant-date><date>20130712</date></intention-to-grant-date></dates-of-public-availability><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988099588" load-source="docdb">G10L  19/018       20130101AFI20130620BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-2142257687" load-source="docdb" scheme="CPC">H04H  60/29        20130101 LA20141029BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2142261826" load-source="docdb" scheme="CPC">H04H  60/33        20130101 LA20141029BHEP        </classification-cpc><classification-cpc mxw-id="PCL-2142266580" load-source="docdb" scheme="CPC">H04H  20/14        20130101 LA20141029BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988133378" load-source="docdb" scheme="CPC">G10L  19/018       20130101 FI20130823BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132188661" lang="DE" load-source="patent-office">Wasserzeichensignalversorger und Wasserzeicheneinbettung</invention-title><invention-title mxw-id="PT132188662" lang="EN" load-source="patent-office">Watermark signal provision and watermark embedding</invention-title><invention-title mxw-id="PT132188663" lang="FR" load-source="patent-office">Fourniture de signal de filigrane et insertion de filigrane</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR918156687" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>FRAUNHOFER GES FORSCHUNG</last-name><address><country>DE</country></address></addressbook></applicant><applicant mxw-id="PPAR918141156" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>FRAUNHOFER-GESELLSCHAFT ZUR FOERDERUNG DER ANGEWANDTEN FORSCHUNG E.V.</last-name></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918138401" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>WABNIK STEFAN</last-name><address><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918153110" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>WABNIK, STEFAN</last-name></addressbook></inventor><inventor mxw-id="PPAR918994575" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>WABNIK, STEFAN</last-name><address><street>Hultschiner Str. 16a</street><city>26129 Oldenburg</city><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918158922" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>PICKEL JOERG</last-name><address><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918139316" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>PICKEL, JOERG</last-name></addressbook></inventor><inventor mxw-id="PPAR918994576" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>PICKEL, JOERG</last-name><address><street>Herbsttal 2</street><city>91230 Happurg</city><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918145740" load-source="docdb" sequence="3" format="epo"><addressbook><last-name>GREEVENBOSCH BERT</last-name><address><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR918136231" load-source="docdb" sequence="3" format="intermediate"><addressbook><last-name>GREEVENBOSCH, BERT</last-name></addressbook></inventor><inventor mxw-id="PPAR918994579" load-source="patent-office" sequence="3" format="original"><addressbook><last-name>GREEVENBOSCH, BERT</last-name><address><street>Roestmos 12</street><city>NL-3069 AR Rotterdam</city><country>NL</country></address></addressbook></inventor><inventor mxw-id="PPAR918143715" load-source="docdb" sequence="4" format="epo"><addressbook><last-name>GRILL BERNHARD</last-name><address><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918153067" load-source="docdb" sequence="4" format="intermediate"><addressbook><last-name>GRILL, BERNHARD</last-name></addressbook></inventor><inventor mxw-id="PPAR918994573" load-source="patent-office" sequence="4" format="original"><addressbook><last-name>GRILL, BERNHARD</last-name><address><street>Peter-Henlein-Str. 7</street><city>91027 Lauf</city><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918138604" load-source="docdb" sequence="5" format="epo"><addressbook><last-name>EBERLEIN ERNST</last-name><address><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918160951" load-source="docdb" sequence="5" format="intermediate"><addressbook><last-name>EBERLEIN, ERNST</last-name></addressbook></inventor><inventor mxw-id="PPAR918994572" load-source="patent-office" sequence="5" format="original"><addressbook><last-name>EBERLEIN, ERNST</last-name><address><street>Waldstrasse 28</street><city>91091 Grossenseebach</city><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918150173" load-source="docdb" sequence="6" format="epo"><addressbook><last-name>DEL GALDO GIOVANNI</last-name><address><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918149067" load-source="docdb" sequence="6" format="intermediate"><addressbook><last-name>DEL GALDO, GIOVANNI</last-name></addressbook></inventor><inventor mxw-id="PPAR918994578" load-source="patent-office" sequence="6" format="original"><addressbook><last-name>DEL GALDO, GIOVANNI</last-name><address><street>Neue Länder 20</street><city>98693 Martinroda</city><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918151856" load-source="docdb" sequence="7" format="epo"><addressbook><last-name>KRAEGELOH STEFAN</last-name><address><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918146651" load-source="docdb" sequence="7" format="intermediate"><addressbook><last-name>KRAEGELOH, STEFAN</last-name></addressbook></inventor><inventor mxw-id="PPAR918994571" load-source="patent-office" sequence="7" format="original"><addressbook><last-name>KRAEGELOH, STEFAN</last-name><address><street>Schobertweg 51</street><city>91056 Erlangen</city><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918164754" load-source="docdb" sequence="8" format="epo"><addressbook><last-name>ZITZMANN REINHARD</last-name><address><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918154578" load-source="docdb" sequence="8" format="intermediate"><addressbook><last-name>ZITZMANN, REINHARD</last-name></addressbook></inventor><inventor mxw-id="PPAR918994577" load-source="patent-office" sequence="8" format="original"><addressbook><last-name>ZITZMANN, REINHARD</last-name><address><street>Johann-Sebastian- Bach-Strasse 25</street><city>91083 Baiersdorf</city><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918132497" load-source="docdb" sequence="9" format="epo"><addressbook><last-name>BLIEM TOBIAS</last-name><address><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918152777" load-source="docdb" sequence="9" format="intermediate"><addressbook><last-name>Bliem, Tobias</last-name></addressbook></inventor><inventor mxw-id="PPAR918994583" load-source="patent-office" sequence="9" format="original"><addressbook><last-name>Bliem, Tobias</last-name><address><street>Tennenloher Str. 26</street><city>91058 Erlangen</city><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918159459" load-source="docdb" sequence="10" format="epo"><addressbook><last-name>BORSUM JULIANE</last-name><address><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918140717" load-source="docdb" sequence="10" format="intermediate"><addressbook><last-name>BORSUM, JULIANE</last-name></addressbook></inventor><inventor mxw-id="PPAR918994580" load-source="patent-office" sequence="10" format="original"><addressbook><last-name>BORSUM, JULIANE</last-name><address><street>Taeublingstr. 22</street><city>91058 Erlangen</city><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918135560" load-source="docdb" sequence="11" format="epo"><addressbook><last-name>BREILING MARCO</last-name><address><country>DE</country></address></addressbook></inventor><inventor mxw-id="PPAR918156776" load-source="docdb" sequence="11" format="intermediate"><addressbook><last-name>BREILING, MARCO</last-name></addressbook></inventor><inventor mxw-id="PPAR918994574" load-source="patent-office" sequence="11" format="original"><addressbook><last-name>BREILING, MARCO</last-name><address><street>Christian-Ernst-Str. 8</street><city>91052 Erlangen</city><country>DE</country></address></addressbook></inventor></inventors><assignees><assignee mxw-id="PPAR918994581" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Fraunhofer-Gesellschaft zur Förderung der angewandten Forschung e.V.</last-name><iid>100125356</iid><address><street>Hansastrasse 27c</street><city>80686 München</city><country>DE</country></address></addressbook></assignee></assignees><agents><agent mxw-id="PPAR918994582" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Burger, Markus</last-name><suffix>et al</suffix><iid>101188636</iid><address><street>Schoppe Zimmermann Stöckeler Zinkler &amp; Partner Postfach 246</street><city>82043 Pullach</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="EP-2011052605-W"><document-id><country>EP</country><doc-number>2011052605</doc-number><kind>W</kind><date>20110222</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2011104233-A1"><document-id><country>WO</country><doc-number>2011104233</doc-number><kind>A1</kind><date>20110901</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS548820495" load-source="docdb">AL</country><country mxw-id="DS548953993" load-source="docdb">AT</country><country mxw-id="DS548872114" load-source="docdb">BE</country><country mxw-id="DS548932059" load-source="docdb">BG</country><country mxw-id="DS548942879" load-source="docdb">CH</country><country mxw-id="DS548872115" load-source="docdb">CY</country><country mxw-id="DS548954074" load-source="docdb">CZ</country><country mxw-id="DS548820496" load-source="docdb">DE</country><country mxw-id="DS548872116" load-source="docdb">DK</country><country mxw-id="DS548872117" load-source="docdb">EE</country><country mxw-id="DS548945182" load-source="docdb">ES</country><country mxw-id="DS548932060" load-source="docdb">FI</country><country mxw-id="DS548942880" load-source="docdb">FR</country><country mxw-id="DS548820497" load-source="docdb">GB</country><country mxw-id="DS548872138" load-source="docdb">GR</country><country mxw-id="DS548820498" load-source="docdb">HR</country><country mxw-id="DS548954075" load-source="docdb">HU</country><country mxw-id="DS548945183" load-source="docdb">IE</country><country mxw-id="DS548872139" load-source="docdb">IS</country><country mxw-id="DS548932061" load-source="docdb">IT</country><country mxw-id="DS548872140" load-source="docdb">LI</country><country mxw-id="DS548932146" load-source="docdb">LT</country><country mxw-id="DS548844357" load-source="docdb">LU</country><country mxw-id="DS548932147" load-source="docdb">LV</country><country mxw-id="DS548932148" load-source="docdb">MC</country><country mxw-id="DS548844358" load-source="docdb">MK</country><country mxw-id="DS548844359" load-source="docdb">MT</country><country mxw-id="DS548844360" load-source="docdb">NL</country><country mxw-id="DS548942881" load-source="docdb">NO</country><country mxw-id="DS548844361" load-source="docdb">PL</country><country mxw-id="DS548945184" load-source="docdb">PT</country><country mxw-id="DS548947601" load-source="docdb">RO</country><country mxw-id="DS548945185" load-source="docdb">RS</country><country mxw-id="DS548844362" load-source="docdb">SE</country><country mxw-id="DS548820499" load-source="docdb">SI</country><country mxw-id="DS548942882" load-source="docdb">SK</country><country mxw-id="DS548942883" load-source="docdb">SM</country><country mxw-id="DS548872141" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><description mxw-id="PDES63956733" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001"><u>Technical Field</u></heading><p id="p0001" num="0001">The present invention relates to a watermark signal provider for providing a watermark signal and watermark embedding using the watermark signal.</p><heading id="h0002"><u>Background of the Invention</u></heading><p id="p0002" num="0002">In many technical applications, it is desired to include an extra information into an information or signal representing useful data or "main data" like, for example, an audio signal, a video signal, graphics, a measurement quantity and so on. In many cases, it is desired to include the extra information such that the extra information is bound to the main data (for example, audio data, video data, still image data, measurement data, text data, and so on) in a way that it is not perceivable by a user of said data. Also, in some cases it is desirable to include the extra data such that the extra data are not easily removable from the main data (e.g. audio data, video data, still image data, measurement data, and so on).</p><p id="p0003" num="0003">This is particularly true in applications in which it is desirable to implement a digital rights management. However, it is sometimes simply desired to add substantially unperceivable side information to the useful data. For example, in some cases it is desirable to add side information to audio data, such that the side information provides an information about the source of the audio data, the content of the audio data, rights related to the audio data and so on.</p><p id="p0004" num="0004">For embedding extra data into useful data or "main data", a concept called "watermarking" may be used. Watermarking concepts have been discussed in the literature for many different kinds of useful data, like audio data, still image data, video data, text data, and so on.</p><p id="p0005" num="0005">In the following, some references will be given in which watermarking concepts are discussed. However, the reader's attention is also drawn to the wide field of textbook literature and publications related to the watermarking for further details.<!-- EPO <DP n="2"> --></p><p id="p0006" num="0006"><patcit id="pcit0001" dnum="DE19640814C2"><text>DE 196 40 814 C2</text></patcit> describes a coding method for introducing a non-audible data signal into an audio signal and a method for decoding a data signal, which is included in an audio signal in a non-audible form. The coding method for introducing a non-audible data signal into an audio signal comprises converting the audio signal into the spectral domain. The coding method also comprises determining the masking threshold of the audio signal and the provision of a pseudo noise signal. The coding method also comprises providing the data signal and multiplying the pseudo noise signal with the data signal, in order to obtain a frequency-spread data signal. The coding method also comprises weighting the spread data signal with the masking threshold and overlapping the audio signal and the weighted data signal.</p><p id="p0007" num="0007">In addition, <patcit id="pcit0002" dnum="WO9307689A"><text>WO 93/07689</text></patcit> describes a method and apparatus for automatically identifying a program broadcast by a radio station or by a television channel, or recorded on a medium, by adding an inaudible encoded message to the sound signal of the program, the message identifying the broadcasting channel or station, the program and/or the exact date. In an embodiment discussed in said document, the sound signal is transmitted via an analog-to-digital converter to a data processor enabling frequency components to be split up, and enabling the energy in some of the frequency components to be altered in a predetermined manner to form an encoded identification message. The output from the data processor is connected by a digital-to-analog converter to an audio output for broadcasting or recording the sound signal. In another embodiment discussed in said document, an analog bandpass is employed to separate a band of frequencies from the sound signal so that energy in the separated band may be thus altered to encode the sound signal.</p><p id="p0008" num="0008"><patcit id="pcit0003" dnum="US5450490A"><text>US 5, 450,490</text></patcit> describes apparatus and methods for including a code having at least one code frequency component in an audio signal. The abilities of various frequency components in the audio signal to mask the code frequency component to human hearing are evaluated and based on these evaluations an amplitude is assigned to the code frequency component. Methods and apparatus for detecting a code in an encoded audio signal are also described. A code frequency component in the encoded audio signal is detected based on an expected code amplitude or on a noise amplitude within a range of audio frequencies including the frequency of the code component.</p><p id="p0009" num="0009"><patcit id="pcit0004" dnum="WO9411989A"><text>WO 94/11989</text></patcit> describes a method and apparatus for encoding/decoding broadcast or recorded segments and monitoring audience exposure thereto. Methods and apparatus for encoding and decoding information in broadcasts or recorded segment signals are described. In an embodiment described in the document, an audience monitoring system<!-- EPO <DP n="3"> --> encodes identification information in the audio signal portion of a broadcast or a recorded segment using spread spectrum encoding. The monitoring device receives an acoustically reproduced version of the broadcast or recorded signal via a microphone, decodes the identification information from the audio signal portion despite significant ambient noise and stores this information, automatically providing a diary for the audience member, which is later uploaded to a centralized facility. A separate monitoring device decodes additional information from the broadcast signal, which is matched with the audience diary information at the central facility. This monitor may simultaneously send data to the centralized facility using a dial-up telephone line, and receives data from the centralized facility through a signal encoded using a spread spectrum technique and modulated with a broadcast signal from a third party.</p><p id="p0010" num="0010"><patcit id="pcit0005" dnum="WO9527349A"><text>WO 95/27349</text></patcit> describes apparatus and methods for including codes in audio signals and decoding. An apparatus and methods for including a code having at least one code frequency component in an audio signal are described. The abilities of various frequency components in the audio signal to mask the code frequency component to human hearing are evaluated, and based on these evaluations, an amplitude is assigned to the code frequency components. Methods and apparatus for detecting a code in an encoded audio signal are also described. A code frequency component in the encoded audio signal is detected based on an expected code amplitude or on a noise amplitude within a range of audio frequencies including the frequency of the code component.</p><p id="p0011" num="0011"><patcit id="pcit0006" dnum="DE102008014311A1"><text>DE 10 2008 014311 A1</text></patcit> describes a further known watermark embedder comprising a watermark signal provider which employs psycho-acoustic frequency masking for embedding a watermark into an audio data stream.</p><p id="p0012" num="0012">However, when inserting the watermark information into a time/frequency spectrogram of an audio signal, it is difficult to hide the watermark information below the masking threshold or to find an optimal tradeoff between the assignment of as much energy as possible to the watermark information - thus increasing the extractability at the decoder side -, and keeping the watermark information being embedded inaudible when reproducing the watermarked audio signal.</p><heading id="h0003"><u>Summary of the Invention</u></heading><p id="p0013" num="0013">In view of this situation, it is the object of the present invention to provide a scheme for providing a watermark signal and a scheme for watermark embedding using that watermark signal, which allows for a better trade-off between extractability and inaudibility of the watermark signal.<!-- EPO <DP n="4"> --><!-- EPO <DP n="5"> --></p><p id="p0014" num="0014">This object is achieved by a watermark signal provider according to claim 1, a watermark, embedder according to claim 8, methods according to claim 9 or 10 and a computer program according to claim 11.</p><p id="p0015" num="0015">According to an embodiment of the present invention, a watermark signal provider for providing a watermark signal suitable for being hidden in an audio signal when the watermark signal is added to the audio signal, such that the watermark signal represents watermark data, comprises a psychoacoustical processor for determining a masking threshold of the audio signal; and a modulator for generating the watermark signal from a superposition of sample-shaping functions spaced apart from each other at a sample time interval of a time-discrete representation of the watermark data, each sample-shaping function being amplitude-weighted with a respective sample of the time-discrete representation multiplied by a respective amplitude weight depending on the masking threshold, the modulator being configured such that the sample time interval is shorter than a time extension of the sample-shaping functions; and the respective amplitude weight also depends on samples of the time-discrete representation neighboring the respective sample in time.</p><p id="p0016" num="0016">The present invention is based on the finding that a better trade-off between extractability and inaudibility of the watermark signal may be achieved by selecting the amplitude weights for amplitude-weighting the sample-shaping functions which form, in superposition, the watermarking signal, not only dependent on the masking threshold, but also dependent on samples of the time-discrete representation of the watermark data neighboring the respective sample. In this way, the sample-shaping functions at neighboring sample positions may overlap each other, i.e. the sample time interval may be shorter than the time extension of the sample-shaping function and, despite this, interference between such neighboring sample-shaping functions may be compensated by taking into account samples of the time-discrete representation neighboring the currently weighted sample when setting the amplitude weight. Even further, since the sample-shaping functions are allowed to have a larger time extension, their frequency responses may be made narrower, thereby rendering the extractability of the watermark signal stronger against reverberation, i.e. when the watermarked audio signal is reproduced in a reverberant environment. In other words, the dependency of the respective amplitude weight not only on the masking threshold, but also on samples of the time-discrete representation of the watermark data neighboring the respective sample enables compensating for audible interferences between neighboring sample-shaping functions, which could otherwise lead to a violence of the masking threshold.<!-- EPO <DP n="6"> --></p><heading id="h0004"><u>Brief Description of the Figures</u></heading><p id="p0017" num="0017">Embodiments according to the invention will subsequently be described taking reference to the enclosed figures, in which:
<dl id="dl0001"><dt>Fig. 1</dt><dd>shows a block schematic diagram of a watermark inserter according to an embodiment of the invention;</dd><dt>Fig. 2</dt><dd>shows a block-schematic diagram of a watermark decoder, according to an embodiment of the invention;</dd><dt>Fig. 3</dt><dd>shows a detailed block-schematic diagram of a watermark generator, according to an embodiment of the invention;</dd><dt>Fig. 4</dt><dd>shows a detailed block-schematic diagram of a modulator, for use in an embodiment of the invention;</dd><dt>Fig. 5</dt><dd>shows a detailed block-schematic diagram of a psychoacoustical processing module, for use in an embodiment of the invention;</dd><dt>Fig. 6</dt><dd>shows a block-schematic diagram of a psychoacoustical model processor, for use in an embodiment of the invention;</dd><dt>Fig. 7</dt><dd>shows a graphical representation of a power spectrum of an audio signal output by block 801 over frequency;</dd><dt>Fig. 8</dt><dd>shows a graphical representation of a power spectrum of an audio signal output by block 802 over frequency;</dd><dt>Fig. 9</dt><dd>shows a block-schematic diagram of an amplitude calculation;</dd><dt>Fig. 10a</dt><dd>shows a block schematic diagram of a modulator;</dd><dt>Fig. 10b</dt><dd>shows a graphical representation of the location of coefficients on the time-frequency claim;</dd><dt>Figs. 11a and 11b</dt><dd>show a block-schematic diagrams of implementation alternatives of the synchronization module;<!-- EPO <DP n="7"> --></dd><dt>Fig. 12a</dt><dd>shows a graphical representation of the problem of finding the temporal alignment of a watermark;</dd><dt>Fig. 12b</dt><dd>shows a graphical representation of the problem of identifying the message start;</dd><dt>Fig. 12c</dt><dd>shows a graphical representation of a temporal alignment of synchronization sequences in a full message synchronization mode;</dd><dt>Fig. 12d</dt><dd>shows a graphical representation of the temporal alignment of the synchronization sequences in a partial message synchronization mode;</dd><dt>Fig. 12e</dt><dd>shows a graphical representation of input data of the synchronization module;</dd><dt>Fig. 12f</dt><dd>shows a graphical representation of a concept of identifying a synchronization hit;</dd><dt>Fig. 12g</dt><dd>shows a block-schematic diagram of a synchronization signature correlator;</dd><dt>Fig. 13 a</dt><dd>shows a graphical representation of an example for a temporal despreading;</dd><dt>Fig. 13b</dt><dd>shows a graphical representation of an example for an element-wise multiplication between bits and spreading sequences;</dd><dt>Fig. 13c</dt><dd>shows a graphical representation of an output of the synchronization signature correlator after temporal averaging;</dd><dt>Fig. 13d</dt><dd>shows a graphical representation of an output of the synchronization signature correlator filtered with the auto-correlation function of the synchronization signature;</dd><dt>Fig. 14</dt><dd>shows a block-schematic diagram of a watermark extractor, according to an embodiment of the invention;</dd><dt>Fig. 15</dt><dd>shows a schematic representation of a selection of a part of the time-frequency-domain representation as a candidate message;<!-- EPO <DP n="8"> --></dd><dt>Fig. 16</dt><dd>shows a block-schematic diagram of an analysis module;</dd><dt>Fig. 17a</dt><dd>shows a graphical representation of an output of a synchronization correlator;</dd><dt>Fig. 17b</dt><dd>shows a graphical representation of decoded messages;</dd><dt>Fig. 17c</dt><dd>shows a graphical representation of a synchronization position, which is extracted from a watermarked signal;</dd><dt>Fig. 18a</dt><dd>shows a graphical representation of a payload, a payload with a Viterbi termination sequence, a Viterbi-encoded payload and a repetition-coded version of the Viterbi-coded payload;</dd><dt>Fig. 18b</dt><dd>shows a graphical representation of subcarners used for embedding a watermarked signal;</dd><dt>Fig. 19</dt><dd>shows a graphical representation of an uncoded message, a coded message, a synchronization message and a watermark signal, in which the synchronization sequence is applied to the messages;</dd><dt>Fig. 20</dt><dd>shows a schematic representation of a first step of a so-called "ABC synchronization" concept;</dd><dt>Fig. 21</dt><dd>shows a graphical representation of a second step of the so-called "ABC synchronization" concept;</dd><dt>Fig. 22</dt><dd>shows a graphical representation of a third step of the so-called "ABC synchronization" concept;</dd><dt>Fig. 23</dt><dd>shows a graphical representation of a message comprising a payload and a CRC portion;</dd><dt>Fig. 24</dt><dd>shows a block-schematic diagram of a watermark signal provider according to an embodiment of the invention; and<!-- EPO <DP n="9"> --></dd><dt>Fig. 25</dt><dd>shows a block-schematic diagram of a watermark embedder according to an embodiment of the present invention.</dd></dl></p><heading id="h0005"><u>Detailed Description of the Embodiments</u></heading><heading id="h0006">1. Watermark signal provision</heading><p id="p0018" num="0018">In the following, a watermark signal provider 2400 will be described referring to <figref idrefs="f0034">Fig. 24</figref>. The watermark signal provider 2400 comprises a psychoacoustical processor 2410 and a modulator 2420. The psychoacoustical processor 2410 is configured to receive the audio signal 2430 for which the watermark signal provider 2400 is to provide the watermark signal 2440. The modulator 2420, in turn, is configured to use the masking threshold provided by the psychoacoustical processor 2410 in order to generate the watermark signal 2440. In particular, modulator 2420 is configured to generate the watermark signal 2440 from a superposition of sample-shaping functions spaced apart from each other at a sample time interval of a time-discreet representation of watermark data 2450 to be represented by the watermark signal 2440. In particular, modulator 2420 uses the masking threshold when generating the watermark signal 2440 such that the watermark signal 2440 is suitable for being hidden in the audio signal 2430 when the watermark signal 2440 is added to the audio signal 2430 in order to obtain a watermarked audio signal.</p><p id="p0019" num="0019">As is described in more detail below, the time-discrete representation of the watermark data may, in fact, be a time/frequency-discrete representation and may be derived from the watermark data 2450 by use of spreading in time domain and/or frequency domain. The time or time/frequency grid to the grid positions of which the samples of the time-discrete representation are assigned may be fixed in time and, especially, independent from the audio signal 2430. The superposition, in turn, may be interpreted as a convolution of the time/discrete representation having its samples arranged at the grid positions of the just-mentioned grid, the samples being weighted with amplitude-weights which, in turn, not only depend on the masking threshold but also on the samples of the time-discrete representation neighboring in time.</p><p id="p0020" num="0020">The dependency of the amplitude-weights from the masking threshold may be as follows: a amplitude-weight which is for being multiplied with a certain sample of the time-discrete representation at a certain time block, is derived from the respective time block of the masking threshold which, in turn, is itself time and frequency dependent. Thus, in case of a time/frequency-discrete representation of the watermark data, each sample is multiplied<!-- EPO <DP n="10"> --> with a amplitude-weight which corresponds to masking threshold sampled at the respective time/frequency grid position of that watermark representation sample.</p><p id="p0021" num="0021">Furthermore, it is possible to use time-differential coding for retrieving the time-discrete representation from the watermark data 2450. Details on a specific embodiment are describe below.</p><p id="p0022" num="0022">The modulator 2420 is configured to generate the watermark signal 2440 from the superposition of the sample-shaping functions such that each sample-shaping function is amplitude-weighted with a respective sample of the time-discrete representation multiplied by a respective amplitude weight depending on the masking threshold determined by the psychoacoustical processor 2410. In particular, modulator 2420 is configured such that the sample time interval is shorter than a time extension of the sample-shaping function, and such that the respective amplitude weight also depends on samples of the time-discrete representation neighboring the respective sample.</p><p id="p0023" num="0023">As will be outlined in more detail below, the fact that the sample time interval is shorter than the time extension of the sample-shaping functions results in an interference between the sample-shaping functions neighboring in time, thereby increasing the risk of violating the masking threshold by accident. Such a violence of the masking threshold is, however, compensated for by making the amplitude weights also dependent on the samples of the time-discrete representation neighboring the current sample.</p><p id="p0024" num="0024">In the embodiment for a watermark system outlined below, the just-mentioned dependency is realized by an iterative setting of the amplitude weights. In particular, the psychoacoustical processor 2410 may determine the masking threshold independent from the watermark data, while the modulator 2420 may be configured to iteratively set the amplitude weights by preliminarily determining the amplitude weights based on the masking threshold independent from the watermark data. Modulator 2420 may then be configured to check as to whether the superposition of the sample-shaping functions as amplitude-weighted with the samples of the watermark representation multiplied by the preliminarily-determined amplitude weights violates the masking threshold. If so, the modulator 2420 may vary the preliminarily-determined amplitude weights so as to obtain a further superposition. Modulator 2420 may repeat these iterations comprising the check and the variation with the subsequent superposition until a respective break condition is fulfilled such as the amplitude-weights maintaining their values within a certain variance threshold. Since, in the above-mentioned check, the neighboring samples of the time-discrete representation influence/interfere with each other due to the superposition and the<!-- EPO <DP n="11"> --> time extension of the sample-shaping functions exceeding the sample time interval, the hole iterative process for generating is dependent on these neighboring samples of the watermark data representation.</p><p id="p0025" num="0025">It should be noted that in the embodiments outlined below, a spreading of the watermark data in time-domain is used in order to reveal the time-discrete representation just-mentioned. However, such a time-spreading may be left away. The same applies to the frequency-spreading also used in the embodiments outlined below.</p><heading id="h0007">2. Watermark embedder</heading><p id="p0026" num="0026"><figref idrefs="f0035">Fig. 25</figref> shows a watermark embedder using the watermark signal provider 2400 of <figref idrefs="f0034">Fig. 24</figref>. In particular, the watermark embedder of <figref idrefs="f0035">Fig. 25</figref> is generally indicated with the reference number 2500 and comprises, besides the watermark signal provider 2400, an adder 2510 for adding the watermark signal 2440 as output by watermark signal provider 2400 and the audio signal 2430 so as to obtain the watermarked audio signal 2530.</p><heading id="h0008"><u>3. System Description</u></heading><p id="p0027" num="0027">In the following, a system for a watermark transmission will be described, which comprises a watermark inserter and a watermark decoder. Naturally, the watermark inserter and the watermark decoder can be used independent from each other.</p><p id="p0028" num="0028">For the description of the system a top-down approach is chosen here. First, it is distinguished between encoder and decoder. Then, in sections 3.1 to 3.5 each processing block is described in detail.</p><p id="p0029" num="0029">The basic structure of the system can be seen in <figref idrefs="f0001">Figures 1</figref> and <figref idrefs="f0002">2</figref>, which depict the encoder and decoder side, respectively. <figref idrefs="f0001">Fig 1</figref> shows a block schematic diagram of a watermark inserter 100. At the encoder side, the watermark signal 101b is generated in the processing block 101 (also designated as watermark generator) from binary data 101a and on the basis of information 104, 105 exchanged with the psychoacoustical processing module 102. The information provided from block 102 typically guarantees that the watermark is inaudible. The watermark generated by the watermark generator101 is then added to the audio signal 106. The watermarked signal 107 can then be transmitted, stored, or further processed. In case of a multimedia file, e.g., an audio-video file, a proper delay needs to be added to the video stream not to lose audio-video synchronicity. In case of a multichannel audio signal,<!-- EPO <DP n="12"> --> each channel is processed separately as explained in this document. The processing blocks 101 (watermark generator) and 102 (psychoacoustical processing module) are explained in detail in Sections 3.1 and 3.2, respectively.</p><p id="p0030" num="0030">The decoder side is depicted in <figref idrefs="f0002">Figure 2</figref>, which shows a block schematic diagram of a watermark detector 200. A watermarked audio signal 200a, e.g., recorded by a microphone, is made available to the system 200. A first block 203, which is also designated as an analysis module, demodulates and transforms the data (e.g., the watermarked audio signal) in time/frequency domain (thereby obtaining a time-frequency-domain representation 204 of the watermarked audio signal 200a) passing it to the synchronization module 201, which analyzes the input signal 204 and carries out a temporal synchronization, namely, determines the temporal alignment of the encoded data (e.g. of the encoded watermark data relative to the time-frequency-domain representation). This information (e.g., the resulting synchronization information 205) is given to the watermark extractor 202, which decodes the data (and consequently provides the binary data 202a, which represent the data content of the watermarked audio signal 200a).</p><heading id="h0009"><b>3.1 The Watermark Generator 101</b></heading><p id="p0031" num="0031">The watermark generator 101 is depicted detail in <figref idrefs="f0003">Figure 3</figref>. Binary data (expressed as ±1) to be hidden in the audio signal 106 is given to the watermark generator 101. The block 301 organizes the data 101a in packets of equal length M<sub>p</sub>. Overhead bits are added (e.g. appended) for signaling purposes to each packet. Let M<sub>s</sub> denote their number. Their use will be explained in detail in Section 3.5. Note that in the following each packet of payload bits together with the signaling overhead bits is denoted message.</p><p id="p0032" num="0032">Each message 301a, of length N<sub>m</sub> = M<sub>s</sub> + M<sub>p</sub>, is handed over to the processing block 302, the channel encoder, which is responsible of coding the bits for protection against errors. A possible embodiment of this module consists of a convolutional encoder together with an interleaver. The ratio of the convolutional encoder influences greatly the overall degree of protection against errors of the watermarking system. The interleaver, on the other hand, brings protection against noise bursts. The range of operation of the interleaver can be limited to one message but it could also be extended to more messages. Let R<sub>c</sub> denote the code ratio, e.g., 1/4. The number of coded bits for each message is N<sub>m</sub>/R<sub>c</sub>. The channel encoder provides, for example, an encoded binary message 302a.<!-- EPO <DP n="13"> --></p><p id="p0033" num="0033">The next processing block, 303, carries out a spreading in frequency domain. In order to achieve sufficient signal to noise ratio, the information (e.g. the information of the binary message 302a) is spread and transmitted in N<sub>f</sub> carefully chosen subbands. Their exact position in frequency is decided a priori and is known to both the encoder and the decoder. Details on the choice of this important system parameter is given in Section 3.2.2. The spreading in frequency is determined by the spreading sequence c<sub>f</sub> of size N<sub>f</sub> ×1. The output 303a of the block 303 consists of N<sub>f</sub> bit streams, one for each subband. The i-th bit stream is obtained by multiplying the input bit with the i-th component of spreading sequence c<sub>f</sub>. The simplest spreading consists of copying the bit stream to each output stream, namely use a spreading sequence of all ones.</p><p id="p0034" num="0034">Block 304, which is also designated as a synchronization scheme inserter, adds a synchronization signal to the bit stream. A robust synchronization is important as the decoder does not know the temporal alignment of neither bits nor the data structure, i.e., when each message starts. The synchronization signal consists of N<sub>s</sub> sequences of N<sub>f</sub> bits each. The sequences are multiplied element wise and periodically to the bit stream (or bit streams 303a). For instance, let <b>a</b>, <b>b</b>, and <b>c</b>, be the Ns = 3 synchronization sequences (also designated as synchronization spreading sequences). Block 304 multiplies <b>a</b> to the first spread bit, <b>b</b> to the second spread bit, and <b>c</b> to the third spread bit. For the following bits the process is periodically iterated, namely, <b>a</b> to the fourth bit, <b>b</b> for the fifth bit and so on. Accordingly, a combined information-synchronization information 304a is obtained. The synchronization sequences (also designated as synchronization spread sequences) are carefully chosen to minimize the risk of a false synchronization. More details are given in Section 3.4. Also, it should be noted that a sequence <b>a</b>, <b>b</b>, <b>c</b>,... may be considered as a sequence of synchronization spread sequences.</p><p id="p0035" num="0035">Block 305 carries out a spreading in time domain. Each spread bit at the input, namely a vector of length N<sub>f</sub> , is repeated in time domain N<sub>t</sub> times. Similarly to the spreading in frequency, we define a spreading sequence c<sub>t</sub> of size N<sub>t</sub>×1. The i-th temporal repetition is multiplied with the i-th component of c<sub>t</sub>.</p><p id="p0036" num="0036">The operations of blocks 302 to 305 can be put in mathematical terms as follows. Let <b>m</b> of size 1 ×N<sub>m</sub>=R<sub>c</sub> be a coded message, output of 302. The output 303a (which may be considered as a spread information representation <b>R</b>) of block 303 is <maths id="math0001" num="(1)"><math display="block"><msub><mi>c</mi><mi mathvariant="normal">f</mi></msub><mo>⋅</mo><mi>m</mi><mspace width="2em"/><mi>of size</mi><mspace width="1em"/><msub><mi>N</mi><mi mathvariant="normal">f</mi></msub><mo>×</mo><msub><mi>N</mi><mi mathvariant="normal">m</mi></msub><mo>/</mo><msub><mi>R</mi><mi mathvariant="normal">c</mi></msub></math><img id="ib0001" file="imgb0001.tif" wi="110" he="19" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="14"> --> the output 304a of block 304, which may be considered as a combined information-synchronization representation <b>C</b>, is <maths id="math0002" num="(2)"><math display="block"><mi>S</mi><mo>∘</mo><mfenced separators=""><msub><mi>c</mi><mi mathvariant="normal">f</mi></msub><mo>⋅</mo><mi>m</mi></mfenced><mspace width="2em"/><mi>of size</mi><mspace width="1em"/><msub><mi>N</mi><mi mathvariant="normal">f</mi></msub><mo>×</mo><msub><mi>N</mi><mi mathvariant="normal">m</mi></msub><mo>/</mo><msub><mi>R</mi><mi mathvariant="normal">c</mi></msub></math><img id="ib0002" file="imgb0002.tif" wi="124" he="18" img-content="math" img-format="tif"/></maths> where denotes the Schur element-wise product and <maths id="math0003" num="(3)"><math display="block"><mi>S</mi><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><mo>…</mo></mtd><mtd><mi>a</mi></mtd><mtd><mi>b</mi></mtd><mtd><mi>c</mi></mtd><mtd><mo>…</mo></mtd><mtd><mi>a</mi></mtd><mtd><mi>b</mi></mtd><mtd><mo>…</mo></mtd></mtr></mtable></mfenced><mspace width="1em"/><mi>of size</mi><mspace width="1em"/><msub><mi>N</mi><mi mathvariant="normal">f</mi></msub><mo>×</mo><msub><mi>N</mi><mi mathvariant="normal">m</mi></msub><mo>/</mo><msub><mi>R</mi><mi mathvariant="normal">c</mi></msub><mn>.</mn></math><img id="ib0003" file="imgb0003.tif" wi="151" he="18" img-content="math" img-format="tif"/></maths></p><p id="p0037" num="0037">The output 305a of 305 is <maths id="math0004" num="(4)"><math display="block"><mfenced separators=""><mi>S</mi><mo>∘</mo><mfenced separators=""><msub><mi>c</mi><mi mathvariant="normal">f</mi></msub><mo>⋅</mo><mi>m</mi></mfenced></mfenced><mo>⁢</mo><msubsup><mi>◇c</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">T</mi></msubsup><mspace width="2em"/><mi>of size</mi><mspace width="1em"/><msub><mi>N</mi><mi mathvariant="normal">f</mi></msub><mo>×</mo><msub><mi>N</mi><mi mathvariant="normal">t</mi></msub><mo>⋅</mo><msub><mi>N</mi><mi mathvariant="normal">m</mi></msub><mo>/</mo><msub><mi>R</mi><mi mathvariant="normal">c</mi></msub></math><img id="ib0004" file="imgb0004.tif" wi="128" he="18" img-content="math" img-format="tif"/></maths> where ◇ and <sup>T</sup> denote the Kronecker product and transpose, respectively. Please recall that binary data is expressed as ±1.</p><p id="p0038" num="0038">Block <b>306</b> performs a differential encoding of the bits. This step gives the system additional robustness against phase shifts due to movement or local oscillator mismatches. More details on this matter are given in Section 3.3. If b(i; j) is the bit for the i-th frequency band and j-th time block at the input of block 306, the output bit b<sub>diff</sub> (i; j) is <maths id="math0005" num="(5)"><math display="block"><msub><mi>b</mi><mi>diff</mi></msub><mfenced><mi>i</mi><mi>j</mi></mfenced><mo>=</mo><msub><mi>b</mi><mi>diff</mi></msub><mo>⁢</mo><mfenced separators=""><mi>i</mi><mo>,</mo><mi>j</mi><mo>-</mo><mn>1</mn></mfenced><mo>⋅</mo><mi>b</mi><mfenced><mi>i</mi><mi>j</mi></mfenced><mn>.</mn></math><img id="ib0005" file="imgb0005.tif" wi="129" he="17" img-content="math" img-format="tif"/></maths></p><p id="p0039" num="0039">At the beginning of the stream, that is for j = 0, b<sub>diff</sub> (i,j - 1) is set to 1.</p><p id="p0040" num="0040">Block 307 carries out the actual modulation, i.e., the generation of the watermark signal waveform depending on the binary information 306a given at its input. A more detailed schematics is given in <figref idrefs="f0004">Figure 4</figref>. N<sub>f</sub> parallel inputs, 401 to 40N<sub>f</sub> contain the bit streams for the different subbands. Each bit of each subband stream is processed by a bit shaping block (411 to 41N<sub>f</sub> ). The output of the bit shaping blocks are waveforms in time domain. The waveform generated for the j-th time block and i-th subband, denoted by s<sub>i;j</sub>(t), on the basis of the input bit b<sub>diff</sub>(i,j)<!-- EPO <DP n="15"> --> is computed as follows <maths id="math0006" num="(6)"><math display="block"><msub><mi>s</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mfenced><mi>t</mi></mfenced><mo>=</mo><msub><mi>b</mi><mi>diff</mi></msub><mfenced><mi>i</mi><mi>j</mi></mfenced><mo>⁢</mo><mi>γ</mi><mfenced><mi>i</mi><mi>j</mi></mfenced><mo>⋅</mo><msub><mi>g</mi><mi>i</mi></msub><mo>⁢</mo><mfenced separators=""><mi>t</mi><mo>-</mo><mi>j</mi><mo>⋅</mo><msub><mi>T</mi><mi mathvariant="normal">b</mi></msub></mfenced><mo>,</mo></math><img id="ib0006" file="imgb0006.tif" wi="125" he="18" img-content="math" img-format="tif"/></maths> where γ(i;j) is a weighting factor provided by the psychoacoustical processing unit 102, T<sub>b</sub> is the bit time interval, and g<sub>i</sub>(t) is the bit forming function for the i-th subband. The bit forming function is obtained from a baseband function <maths id="math0007" num=""><math display="inline"><msubsup><mi>g</mi><mi>i</mi><mi mathvariant="normal">T</mi></msubsup><mfenced><mi>t</mi></mfenced></math><img id="ib0007" file="imgb0007.tif" wi="12" he="6" img-content="math" img-format="tif" inline="yes"/></maths> modulated in frequency with a cosine <maths id="math0008" num="(7)"><math display="block"><msub><mi>g</mi><mi>i</mi></msub><mfenced><mi>t</mi></mfenced><mo>=</mo><msubsup><mi>g</mi><mi>i</mi><mi mathvariant="normal">T</mi></msubsup><mfenced><mi>t</mi></mfenced><mo>⋅</mo><mi>cos</mi><mfenced separators=""><mn>2</mn><mo>⁢</mo><mi>π</mi><mo>⁢</mo><msub><mi>f</mi><mi>i</mi></msub><mo>⁢</mo><mi>t</mi></mfenced></math><img id="ib0008" file="imgb0008.tif" wi="113" he="18" img-content="math" img-format="tif"/></maths><br/>
where f<sub>i</sub> is the center frequency of the i-th subband and the superscript T stands for transmitter. The baseband functions can be different for each subband. If chosen identical, a more efficient implementation at the decoder is possible. See Section 3.3 for more details.</p><p id="p0041" num="0041">The bit shaping for each bit is repeated in an iterative process controlled by the psychoacoustical processing module (102). Iterations are necessary to fine tune the weights γ(i, j) to assign as much energy as possible to the watermark while keeping it inaudible. More details are given in Section 3.2.</p><p id="p0042" num="0042">The complete waveform at the output of the i-th bit shaping fillter 41i is <maths id="math0009" num="(8)"><math display="block"><msub><mi>s</mi><mi>i</mi></msub><mfenced><mi>t</mi></mfenced><mo>=</mo><mstyle displaystyle="false"><mstyle displaystyle="true"><munder><mo>∑</mo><mi>j</mi></munder></mstyle><msub><mi>s</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mfenced><mi>t</mi></mfenced></mstyle><mn>.</mn></math><img id="ib0009" file="imgb0009.tif" wi="99" he="20" img-content="math" img-format="tif"/></maths></p><p id="p0043" num="0043">The bit forming baseband function <i>g<sub>i</sub></i><sup>T</sup>(t) is normally non zero for a time interval much larger than T<sub>b</sub>, although the main energy is concentrated within the bit interval. An example can be seen if <figref idrefs="f0014">Figure 12a</figref> where the same bit forming baseband function is plotted for two adjacent bits. In the figure we have T<sub>b</sub> = 40 ms. The choice of T<sub>b</sub> as well as the shape of the function affect the system considerably. In fact, longer symbols provide narrower frequency responses. This is particularly beneficial in reverberant environments. In fact, in such scenarios the watermarked signal reaches the microphone via several propagation paths, each characterized by a different propagation time. The resulting channel exhibits strong frequency selectivity. Interpreted in time domain, longer symbols<!-- EPO <DP n="16"> --> are beneficial as echoes with a delay comparable to the bit interval yield constructive interference, meaning that they increase the received signal energy. Notwithstanding, longer symbols bring also a few drawbacks; larger overlaps might lead to intersymbol interference (ISI) and are for sure more difficult to hide in the audio signal, so that the psychoacoustical processing module would allow less energy than for shorter symbols.</p><p id="p0044" num="0044">The watermark signal is obtained by summing all outputs of the bit shaping filters <maths id="math0010" num="(9)"><math display="block"><mstyle displaystyle="false"><mstyle displaystyle="true"><munder><mo>∑</mo><mi>i</mi></munder></mstyle><msub><mi>s</mi><mi>i</mi></msub><mfenced><mi>t</mi></mfenced></mstyle><mn>.</mn></math><img id="ib0010" file="imgb0010.tif" wi="94" he="21" img-content="math" img-format="tif"/></maths></p><heading id="h0010"><b>3.2 The Psychoacoustical Processing Module 102</b></heading><p id="p0045" num="0045">As depicted in <figref idrefs="f0005">Figure 5</figref>, the psychoacoustical processing module 102 consists of 3 parts. The first step is an analysis module <b>501</b> which transforms the time audio signal into the time/frequency domain. This analysis module may carry out parallel analyses in different time/frequency resolutions. After the analysis module, the time/frequency data is transferred to the psychoacoustic model (PAM) <b>502</b>, in which masking thresholds for the watermark signal are calculated according to psychoacoustical considerations (see E. Zwicker H.Fastl, "Psychoacoustics Facts and models"). The masking thresholds indicate the amount of energy which can be hidden in the audio signal for each subband and time block. The last block in the psychoacoustical processing module 102 depicts the amplitude calculation module <b>503</b>. This module determines the amplitude gains to be used in the generation of the watermark signal so that the masking thresholds are satisfied, i.e., the embedded energy is less or equal to the energy defined by the masking thresholds.</p><heading id="h0011"><b>3.2.1 The Time/Frequency Analysis 501</b></heading><p id="p0046" num="0046">Block <b>501</b> carries out the time/frequency transformation of the audio signal by means of a lapped transform. The best audio quality can be achieved when multiple time/frequency resolutions are performed. One efficient embodiment of a lapped transform is the short time Fourier transform (STFT), which is based on fast Fourier transforms (FFT) of windowed time blocks. The length of the window determines the time/frequency resolution, so that longer windows yield lower time and higher frequency resolutions, while shorter windows vice versa. The shape of the window, on the other hand, among other things, determines the frequency leakage.<!-- EPO <DP n="17"> --></p><p id="p0047" num="0047">For the proposed system, we achieve an inaudible watermark by analyzing the data with two different resolutions. A first filter bank is characterized by a hop size of T<sub>b</sub>, i.e., the bit length. The hop size is the time interval between two adjacent time blocks. The window length is approximately T<sub>b</sub>. Please note that the window shape does not have to be the same as the one used for the bit shaping, and in general should model the human hearing system. Numerous publications study this problem.</p><p id="p0048" num="0048">The second filter bank applies a shorter window. The higher temporal resolution achieved is particularly important when embedding a watermark in speech, as its temporal structure is in general finer than T<sub>b</sub>.</p><p id="p0049" num="0049">The sampling rate of the input audio signal is not important, as long as it is large enough to describe the watermark signal without aliasing. For instance, if the largest frequency component contained in the watermark signal is 6 kHz, then the sampling rate of the time signals must be at least 12 kHz.</p><heading id="h0012"><b>3.2.2 The Psychoacoustical Model 502</b></heading><p id="p0050" num="0050">The psychoacoustical model 502 has the task to determine the masking thresholds, i.e., the amount of energy which can be hidden in the audio signal for each subband and time block keeping the watermarked audio signal indistinguishable from the original.</p><p id="p0051" num="0051">The i-th subband is defined between two limits, namely <maths id="math0011" num=""><math display="inline"><msubsup><mi>f</mi><mi>i</mi><mfenced><mi>min</mi></mfenced></msubsup></math><img id="ib0011" file="imgb0011.tif" wi="9" he="6" img-content="math" img-format="tif" inline="yes"/></maths> and <maths id="math0012" num=""><math display="inline"><msubsup><mi>f</mi><mi>i</mi><mfenced><mi>max</mi></mfenced></msubsup><mn>.</mn></math><img id="ib0012" file="imgb0012.tif" wi="10" he="6" img-content="math" img-format="tif" inline="yes"/></maths> The subbands are determined by defining N<sub>f</sub> center frequencies f<sub>i</sub> and letting <maths id="math0013" num=""><math display="inline"><msubsup><mi>f</mi><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow><mfenced><mi>max</mi></mfenced></msubsup><mo>=</mo><msubsup><mi>f</mi><mi>i</mi><mfenced><mi>min</mi></mfenced></msubsup><mo>⁢</mo><mi mathvariant="normal">i</mi></math><img id="ib0013" file="imgb0013.tif" wi="25" he="6" img-content="math" img-format="tif" inline="yes"/></maths> for i = 2, 3, ... , N<sub>f</sub> . An appropriate choice for the center frequencies is given by the Bark scale proposed by Zwicker in 1961. The subbands become larger for higher center frequencies. A possible implementation of the system uses 9 subbands ranging from 1.5 to 6 kHz arranged in an appropriate way.</p><p id="p0052" num="0052">The following processing steps are carried out separately for each time/frequency resolution for each subband and each time block. The processing step <b>801</b> carries out a spectral smoothing. In fact, tonal elements, as well as notches in the power spectrum need to be smoothed. This can be carried out in several ways. A tonality measure may be computed and then used to drive an adaptive smoothing filter. Alternatively, in a simpler implementation of this block, a median-like filter can be used. The median filter considers<!-- EPO <DP n="18"> --> a vector of values and outputs their median value. In a median-like filter the value corresponding to a different quantile than 50% can be chosen. The filter width is defined in Hz and is applied as a non-linear moving average which starts at the lower frequencies and ends up at the highest possible frequency. The operation of <b>801</b> is illustrated in <figref idrefs="f0007">Figure 7</figref>. The red curve is the output of the smoothing.</p><p id="p0053" num="0053">Once the smoothing has been carried out, the thresholds are computed by block <b>802</b> considering only frequency masking. Also in this case there are different possibilities. One way is to use the minimum for each subband to compute the masking energy E<sub>i</sub>. This is the equivalent energy of the signal which effectively operates a masking. From this value we can simply multiply a certain scaling factor to obtain the masked energy J<sub>i</sub>. These factors are different for each subband and time/frequency resolution and are obtained via empirical psychoacoustical experiments. These steps are illustrated in <figref idrefs="f0008">Figure 8</figref>.</p><p id="p0054" num="0054">In block <b>805</b>, temporal masking is considered. In this case, different time blocks for the same subband are analyzed. The masked energies J<sub>i</sub> are modified according to an empirically derived postmasking profile. Let us consider two adjacent time blocks, namely k-1 and k. The corresponding masked energies are J<sub>i</sub>(k-1) and J<sub>i</sub>(k). The postmasking profile defines that, e.g., the masking energy E<sub>i</sub> can mask an energy J; at time k and a · J<sub>i</sub> at time k+1. In this case, block <b>805</b> compares J<sub>i</sub>(k) (the energy masked by the current time block) and α·J<sub>i</sub>(k+1) (the energy masked by the previous time block) and chooses the maximum. Postmasking profiles are available in the literature and have been obtained via empirical psychoacoustical experiments. Note that for large T<sub>b</sub>, i.e., &gt; 20 ms, postmasking is applied only to the time/frequency resolution with shorter time windows.</p><p id="p0055" num="0055">Summarizing, at the output of block <b>805</b> we have the masking thresholds per each subband and time block obtained for two different time/frequency resolutions. The thresholds have been obtained by considering both frequency and time masking phenomena. In block 806, the thresholds for the different time/frequency resolutions are merged. For instance, a possible implementation is that <b>806</b> considers all thresholds corresponding to the time and frequency intervals in which a bit is allocated, and chooses the minimum.</p><heading id="h0013"><b>3.2.3 The Amplitude Calculation Block 503</b></heading><p id="p0056" num="0056">Please refer to <figref idrefs="f0009">Figure 9</figref>. The input of 503 are the thresholds 505 from the psychoacoustical model 502 where all psychoacoustics motivated calculations are carried out. In the amplitude calculator 503 additional computations with the thresholds are performed. First, an amplitude mapping <b>901</b> takes place. This block merely converts the masking thresholds<!-- EPO <DP n="19"> --> (normally expressed as energies) into amplitudes which can be used to scale the bit shaping function defined in Section 3.1. Afterwards, the amplitude adaptation block <b>902</b> is run. This block iteratively adapts the amplitudes rei, j) which are used to multiply the bit shaping functions in the watermark generator 101 so that the masking thresholds are indeed fulfilled. In fact, as already discussed, the bit shaping function normally extends for a time interval larger than T<sub>b</sub>. Therefore, multiplying the correct amplitude γ(i, j) which fulfills the masking threshold at point i, j does not necessarily fulfill the requirements at point i, j-1. This is particularly crucial at strong onsets, as a preecho becomes audible. Another situation which needs to be avoided is the unfortunate superposition of the tails of different bits which might lead to an audible watermark. Therefore, block 902 analyzes the signal generated by the watermark generator to check whether the thresholds have been fulfilled. If not, it modifies the amplitudes y(i, j) accordingly.</p><p id="p0057" num="0057">This concludes the encoder side. The following sections deal with the processing steps carried out at the receiver (also designated as watermark decoder).</p><heading id="h0014"><b>3.3 The Analysis Module 203</b></heading><p id="p0058" num="0058">The analysis module 203 is the first step (or block) of the watermark extraction process. Its purpose is to transform the watermarked audio signal 200a back into N<sub>f</sub> bit streams <i>b̂<sub>i</sub></i>(<i>j</i>) (also designated with 204), one for each spectral subband i. These are further processed by the synchronization module 201 and the watermark extractor 202, as discussed in Sections 3.4 and 3.5, respectively. Note that the <i>b̂<sub>i</sub></i>(<i>j</i>) are soft bit streams, i.e., they can take, for example, any real value and no hard decision on the bit is made yet.</p><p id="p0059" num="0059">The analysis module consists of three parts which are depicted in <figref idrefs="f0025">Figure 16</figref>: The analysis filter bank 1600, the amplitude normalization block 1604 and the differential decoding 1608.</p><heading id="h0015"><b>3.3.1 Analysis filter bank 1600</b></heading><p id="p0060" num="0060">The watermarked audio signal is transformed into the time-frequency domain by the analysis filter bank 1600 which is shown in detail in <figref idrefs="f0010">Figure 10a</figref>. The input of the filter bank is the received watermarked audio signal r(t). Its output are the complex coefficients<!-- EPO <DP n="20"> --> <maths id="math0014" num=""><math display="inline"><msubsup><mi>b</mi><mi>i</mi><mi mathvariant="italic">AFB</mi></msubsup><mfenced><mi>j</mi></mfenced></math><img id="ib0014" file="imgb0014.tif" wi="15" he="7" img-content="math" img-format="tif" inline="yes"/></maths> for the i-th branch or subband at time instant j. These values contain information about the amplitude and the phase of the signal at center frequency f<sub>i</sub> and time j·Tb.</p><p id="p0061" num="0061">The filter bank 1600 consists of N<sub>f</sub> branches, one for each spectral subband i. Each branch splits up into an upper subbranch for the in-phase component and a lower subbranch for the quadrature component of the subband i. Although the modulation at the watermark generator and thus the watermarked audio signal are purely real-valued, the complex-valued analysis of the signal at the receiver is needed because rotations of the modulation constellation introduced by the channel and by synchronization misalignments are not known at the receiver. In the following we consider the i-th branch of the filter bank. By combining the in-phase and the quadrature subbranch, we can define the complex-valued baseband signal <maths id="math0015" num=""><math display="inline"><msubsup><mi>b</mi><mi>i</mi><mi>AFB</mi></msubsup><mfenced><mi>t</mi></mfenced></math><img id="ib0015" file="imgb0015.tif" wi="14" he="6" img-content="math" img-format="tif" inline="yes"/></maths> as <maths id="math0016" num="(10)"><math display="block"><msubsup><mi>b</mi><mi>i</mi><mi>AFB</mi></msubsup><mfenced><mi>t</mi></mfenced><mo>=</mo><mi>r</mi><mfenced><mi>t</mi></mfenced><mo>⋅</mo><msup><mi>e</mi><mrow><mo>-</mo><mi>j</mi><mo>⁢</mo><mn>2</mn><mo>⁢</mo><mi>π</mi><mo>⁢</mo><msub><mi>f</mi><mi>i</mi></msub><mo>⁢</mo><mi>t</mi></mrow></msup><mo>*</mo><msubsup><mi>g</mi><mi>i</mi><mi mathvariant="normal">R</mi></msubsup><mfenced><mi>t</mi></mfenced></math><img id="ib0016" file="imgb0016.tif" wi="118" he="20" img-content="math" img-format="tif"/></maths><br/>
where * indicates convolution and <maths id="math0017" num=""><math display="inline"><msubsup><mi>g</mi><mi>i</mi><mi mathvariant="normal">R</mi></msubsup><mfenced><mi>t</mi></mfenced></math><img id="ib0017" file="imgb0017.tif" wi="13" he="6" img-content="math" img-format="tif" inline="yes"/></maths> is the impulse response of the receiver lowpass filter of subband i. Usually <maths id="math0018" num=""><math display="inline"><msubsup><mi>g</mi><mi>i</mi><mi mathvariant="normal">R</mi></msubsup><mo>⁢</mo><msub><mfenced><mi>t</mi></mfenced><mi mathvariant="normal">i</mi></msub></math><img id="ib0018" file="imgb0018.tif" wi="13" he="7" img-content="math" img-format="tif" inline="yes"/></maths> (t) is equal to the baseband bit forming function <maths id="math0019" num=""><math display="inline"><msubsup><mi>g</mi><mi>i</mi><mi mathvariant="normal">T</mi></msubsup><mfenced><mi>t</mi></mfenced></math><img id="ib0019" file="imgb0019.tif" wi="10" he="5" img-content="math" img-format="tif" inline="yes"/></maths> of subband i in the modulator 307 in order to fulfill the matched filter condition, but other impulse responses are possible as well.</p><p id="p0062" num="0062">In order to obtain the coefficients <maths id="math0020" num=""><math display="inline"><msubsup><mi>b</mi><mi>i</mi><mi>AFB</mi></msubsup><mfenced><mi>j</mi></mfenced></math><img id="ib0020" file="imgb0020.tif" wi="18" he="5" img-content="math" img-format="tif" inline="yes"/></maths> with rate 1=T<sub>b</sub>, the continuous output <maths id="math0021" num=""><math display="inline"><msubsup><mi>b</mi><mi>i</mi><mi>AFB</mi></msubsup><mfenced><mi>t</mi></mfenced></math><img id="ib0021" file="imgb0021.tif" wi="13" he="5" img-content="math" img-format="tif" inline="yes"/></maths> must be sampled. If the correct timing of the bits was known by the receiver, sampling with rate 1=T<sub>b</sub> would be sufficient. However, as the bit synchronization is not known yet, sampling is carried out with rate N<sub>os</sub>/T<sub>b</sub> where N<sub>os</sub> is the analysis filter bank oversampling factor. By choosing N<sub>os</sub> sufficiently large (e.g. N<sub>os</sub> = 4), we can assure that at least one sampling cycle is close enough to the ideal bit synchronization. The decision on the best oversampling layer is made during the synchronization process, so all the oversampled data is kept until then. This process is described in detail in Section 3.4.</p><p id="p0063" num="0063">At the output of the i-th branch we have the coefficients <maths id="math0022" num=""><math display="inline"><msubsup><mi>b</mi><mi>i</mi><mi>AFB</mi></msubsup><mfenced><mi>j</mi><mi>k</mi></mfenced><mo>,</mo></math><img id="ib0022" file="imgb0022.tif" wi="19" he="7" img-content="math" img-format="tif" inline="yes"/></maths> where j indicates the bit number or time instant and k indicates the oversampling position within this single bit, where k = 1; 2; ...., Nos.</p><p id="p0064" num="0064"><figref idrefs="f0011">Figure 10b</figref> gives an exemplary overview of the location of the coefficients on the time-frequency plane. The oversampling factor is N<sub>os</sub> = 2. The height and the width of the<!-- EPO <DP n="21"> --> rectangles indicate respectively the bandwidth and the time interval of the part of the signal that is represented by the corresponding coefficient <maths id="math0023" num=""><math display="inline"><msubsup><mi>b</mi><mi>i</mi><mi>AFB</mi></msubsup><mfenced><mi>j</mi><mi>k</mi></mfenced><mn>.</mn></math><img id="ib0023" file="imgb0023.tif" wi="17" he="6" img-content="math" img-format="tif" inline="yes"/></maths></p><p id="p0065" num="0065">If the subband frequencies f<sub>i</sub> are chosen as multiples of a certain interval Δf the analysis filter bank can be efficiently implemented using the Fast Fourier Transform (FFT).</p><heading id="h0016"><b>3.3.2 Amplitude normalization 1604</b></heading><p id="p0066" num="0066">Without loss of generality and to simplify the description, we assume that the bit synchronization is known and that N<sub>os</sub> = 1 in the following. That is, we have complex coeffcients <maths id="math0024" num=""><math display="inline"><msubsup><mi>b</mi><mi>i</mi><mi>AFB</mi></msubsup><mfenced><mi>j</mi></mfenced></math><img id="ib0024" file="imgb0024.tif" wi="17" he="6" img-content="math" img-format="tif" inline="yes"/></maths> at the input of the normalization block 1604. As no channel state information is available at the receiver (i.e., the propagation channel in unknown), an equal gain combining (EGC) scheme is used. Due to the time and frequency dispersive channel, the energy of the sent bit b<sub>i</sub>(j) is not only found around the center frequency f<sub>i</sub> and time instant j, but also at adjacent frequencies and time instants. Therefore, for a more precise weighting, additional coefficients at frequencies f<sub>i</sub> ±n Δf are calculated and used for normalization of coefficient <maths id="math0025" num=""><math display="inline"><msubsup><mi>b</mi><mi>i</mi><mi>AFB</mi></msubsup><mfenced><mi>j</mi></mfenced><mn>.</mn></math><img id="ib0025" file="imgb0025.tif" wi="15" he="6" img-content="math" img-format="tif" inline="yes"/></maths> we have, for example, <maths id="math0026" num="(11)"><math display="block"><msubsup><mi>b</mi><mi>i</mi><mi>norm</mi></msubsup><mfenced><mi>j</mi></mfenced><mo>=</mo><mfrac><mrow><msubsup><mi>b</mi><mi>i</mi><mi>AFB</mi></msubsup><mfenced><mi>j</mi></mfenced></mrow><msqrt><mn>1</mn><mo>/</mo><mn>3</mn><mo>⋅</mo><mfenced separators=""><msup><mfenced open="|" close="|" separators=""><msubsup><mi>b</mi><mi>i</mi><mi>AFB</mi></msubsup><mfenced><mi>j</mi></mfenced></mfenced><mn>2</mn></msup><mo>+</mo><msup><mfenced open="|" close="|" separators=""><msubsup><mi>b</mi><msub><mi>i</mi><mrow><mo>-</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>f</mi></mrow></msub><mi>AFB</mi></msubsup><mfenced><mi>j</mi></mfenced></mfenced><mn>2</mn></msup><mo>+</mo><msup><mfenced open="|" close="|" separators=""><msubsup><mi>b</mi><msub><mi>i</mi><mrow><mo>+</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>f</mi></mrow></msub><mi>AFB</mi></msubsup><mfenced><mi>j</mi></mfenced></mfenced><mn>2</mn></msup></mfenced></msqrt></mfrac></math><img id="ib0026" file="imgb0026.tif" wi="148" he="24" img-content="math" img-format="tif"/></maths></p><p id="p0067" num="0067">The normalization for n &gt; 1 is a straightforward extension of the formula above. In the same fashion we can also choose to normalize the soft bits by considering more than one time instant. The normalization is carried out for each subband i and each time instant j. The actual combining of the EGC is done at later steps of the extraction process.</p><heading id="h0017"><b>3.3.3 Differential decoding 1608</b></heading><p id="p0068" num="0068">At the input of the differential decoding block 1608 we have amplitude normalized complex coefficients <maths id="math0027" num=""><math display="inline"><msubsup><mi>b</mi><mi>i</mi><mi mathvariant="italic">norm</mi></msubsup><mfenced><mi>j</mi></mfenced></math><img id="ib0027" file="imgb0027.tif" wi="15" he="6" img-content="math" img-format="tif" inline="yes"/></maths> which contain information about the phase of the signal components at frequency f<sub>i</sub> and time instant j. As the bits are differentially encoded at the transmitter, the inverse operation must be performed here. The soft bits <i>b̂i</i>(<i>j</i>) are obtained by first calculating the difference in phase of two consecutive coefficients and then taking the real part:<!-- EPO <DP n="22"> --> <maths id="math0028" num="(12)"><math display="block"><msub><mover><mi>b</mi><mo>^</mo></mover><mi>i</mi></msub><mfenced><mi>j</mi></mfenced><mo>=</mo><mi>Re</mi><mfenced open="{" close="}" separators=""><msubsup><mi>b</mi><mi>i</mi><mi>norm</mi></msubsup><mfenced><mi>j</mi></mfenced><mo>⋅</mo><msubsup><mi>b</mi><mi>i</mi><mrow><mi>norm</mi><mo>*</mo></mrow></msubsup><mo>⁢</mo><mfenced separators=""><mi>j</mi><mo>-</mo><mn>1</mn></mfenced></mfenced></math><img id="ib0028" file="imgb0028.tif" wi="121" he="20" img-content="math" img-format="tif"/></maths> <maths id="math0029" num="(13)"><math display="block"><mo>=</mo><mi>Re</mi><mfenced open="{" close="}" separators=""><mfenced open="|" close="|" separators=""><msubsup><mi>b</mi><mi>i</mi><mi>norm</mi></msubsup><mfenced><mi>j</mi></mfenced></mfenced><mo>⋅</mo><mfenced open="|" close="|" separators=""><msubsup><mi>b</mi><mi>i</mi><mi>norm</mi></msubsup><mo>⁢</mo><mfenced separators=""><mi>j</mi><mo>-</mo><mn>1</mn></mfenced></mfenced><mo>⋅</mo><msup><mi>e</mi><mrow><mi>j</mi><mo>⁢</mo><mfenced separators=""><msub><mi>ϕ</mi><mi>j</mi></msub><mo>-</mo><msub><mi>ϕ</mi><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow></msub></mfenced></mrow></msup></mfenced></math><img id="ib0029" file="imgb0029.tif" wi="121" he="22" img-content="math" img-format="tif"/></maths></p><p id="p0069" num="0069">This has to be carried out separately for each subband because the channel normally introduces different phase rotations in each subband.</p><heading id="h0018"><b>3.4 The Synchronization Module 201</b></heading><p id="p0070" num="0070">The synchronization module's task is to fmd the temporal alignment of the watermark. The problem of synchronizing the decoder to the encoded data is twofold. In a first step, the analysis filterbank must be aligned with the encoded data, namely the bit shaping functions <maths id="math0030" num=""><math display="inline"><msubsup><mi>g</mi><mi>i</mi><mi mathvariant="normal">T</mi></msubsup><mfenced><mi>t</mi></mfenced></math><img id="ib0030" file="imgb0030.tif" wi="12" he="6" img-content="math" img-format="tif" inline="yes"/></maths> used in the synthesis in the modulator must be aligned with the filters <maths id="math0031" num=""><math display="inline"><msubsup><mi>g</mi><mi>i</mi><mi mathvariant="normal">R</mi></msubsup><mfenced><mi>t</mi></mfenced></math><img id="ib0031" file="imgb0031.tif" wi="15" he="6" img-content="math" img-format="tif" inline="yes"/></maths> used for the analysis. This problem is illustrated in <figref idrefs="f0014">Figure 12a</figref>, where the analysis filters are identical to the synthesis ones. At the top, three bits are visible. For simplicity, the waveforms for all three bits are not scaled. The temporal offset between different bits is T<sub>b</sub>. The bottom part illustrates the synchronization issue at the decoder: the filter can be applied at different time instants, however, only the position marked in red (curve 1299a) is correct and allows to extract the first bit with the best signal to noise ratio SNR and signal to interference ratio SIR. In fact, an incorrect alignment would lead to a degradation of both SNR and SIR. We refer to this first alignment issue as "bit synchronization". Once the bit synchronization has been achieved, bits can be extracted, optimally. However, to correctly decode a message, it is necessary to know at which bit a new message starts. This issue is illustrated in <figref idrefs="f0015">Figure 12b</figref> and is referred to as message synchronization. In the stream of decoded bits only the starting position marked in red (position 1299b) is correct and allows to decode the k-th message.</p><p id="p0071" num="0071">We first address the message synchronization only. The synchronization signature, as explained in Section 3.1, is composed of Ns sequences in a predetermined order which are embedded continuously and periodically in the watermark. The synchronization module is capable of retrieving the temporal alignment of the synchronization sequences. Depending<!-- EPO <DP n="23"> --> on the size N<sub>s</sub> we can distinguish between two modes of operation, which are depicted in <figref idrefs="f0015">Figure 12c</figref> and <figref idrefs="f0016">12d</figref>, respectively.</p><p id="p0072" num="0072">In the full message synchronization mode (<figref idrefs="f0015">Fig. 12c</figref>) we have N<sub>s</sub> = N<sub>m</sub>/R<sub>c</sub>. For simplicity in the figure we assume N<sub>s</sub> = N<sub>m</sub>/R<sub>c</sub> = 6 and no time spreading, i.e., N<sub>t</sub> = 1. The synchronization signature used, for illustration purposes, is shown beneath the messages. In reality, they are modulated depending on the coded bits and frequency spreading sequences, as explained in Section 3.1. In this mode, the periodicity of the synchronization signature is identical to the one of the messages. The synchronization module therefore can identify the beginning of each message by finding the temporal alignment of the synchronization signature. We refer to the temporal positions at which a new synchronization signature starts as synchronization hits. The synchronization hits are then passed to the watermark extractor 202.</p><p id="p0073" num="0073">The second possible mode, the partial message synchronization mode (<figref idrefs="f0016">Fig. 12d</figref>), is depicted in <figref idrefs="f0016">Figure 12d</figref>. In this case we have N<sub>s</sub> &lt; Nm=R<sub>c</sub>. In the figure we have taken N<sub>s</sub> = 3, so that the three synchronization sequences are repeated twice for each message. Please note that the periodicity of the messages does not have to be multiple of the periodicity of the synchronization signature. In this mode of operation, not all synchronization hits correspond to the beginning of a message. The synchronization module has no means of distinguishing between hits and this task is given to the watermark extractor 202.</p><p id="p0074" num="0074">The processing blocks of the synchronization module are depicted in <figref idrefs="f0012">Figures 11a</figref> and <figref idrefs="f0013">11b</figref>. The synchronization module carries out the bit synchronization and the message synchronization (either full or partial) at once by analyzing the output of the synchronization signature correlator 1201. The data in time/frequency domain 204 is provided by the analysis module. As the bit synchronization is not yet available, block 203 oversamples the data with factor N<sub>os</sub>, as described in Section 3.3. An illustration of the input data is given in <figref idrefs="f0017">Figure 12e</figref>. For this example we have taken N<sub>os</sub> = 4, Nt = 2, and N<sub>s</sub> = 3. In other words, the synchronization signature consists of 3 sequences (denoted with a, b, and c). The time spreading, in this case with spreading sequence c<sub>t</sub> = [11]<sup>T</sup>, simply repeats each bit twice in time domain. The exact synchronization hits are denoted with arrows and correspond to the beginning of each synchronization signature. The period of the synchronization signature is N<sub>t</sub> · N<sub>os</sub> · N<sub>s</sub> = N<sub>sbl</sub> which is 2 · 4 · 3 = 24, for example. Due to the periodicity of the synchronization signature, the synchronization signature correlator (1201) arbitrarily divides the time axis in blocks, called search blocks, of size N<sub>sbl</sub>, whose subscript stands for search block length. Every search block must contain (or typically contains) one synchronization hit as depicted in <figref idrefs="f0018">Figure 12f</figref>. Each of the N<sub>sbl</sub> bits is a<!-- EPO <DP n="24"> --> candidate synchronization hit. Block 1201's task is to compute a likelihood measure for each of candidate bit of each block. This information is then passed to block 1204 which computes the synchronization hits.</p><heading id="h0019"><b>3.4.1 The synchronization signature correlator 1201</b></heading><p id="p0075" num="0075">For each of the N<sub>sbl</sub> candidate synchronization positions the synchronization signature correlator computes a likelihood measure, the latter is larger the more probable it is that the temporal alignment (both bit and partial or full message synchronization) has been found. The processing steps are depicted in <figref idrefs="f0019">Figure 12g</figref>.</p><p id="p0076" num="0076">Accordingly, a sequence 1201aof likelihood values, associated with different positional choices, may be obtained.</p><p id="p0077" num="0077">Block 1301 carries out the temporal despreading, i.e., multiplies every N<sub>t</sub> bits with the temporal spreading sequence c<sub>t</sub> and then sums them. This is carried out for each of the N<sub>f</sub> frequency subbands. <figref idrefs="f0020">Figure 13a</figref> shows an example. We take the same parameters as described in the previous section, namely N<sub>os</sub> = 4, N<sub>t</sub> = 2, and N<sub>s</sub> = 3. The candidate synchronization position is marked. From that bit, with N<sub>os</sub> offset, N<sub>t</sub> · N<sub>s</sub> are taken by block 1301 and time despread with sequence c<sub>t</sub>, so that Ns bits are left.</p><p id="p0078" num="0078">In block 1302 the bits are multiplied element-wise with the N<sub>s</sub> spreading sequences (see <figref idrefs="f0021">Figure 13b</figref>).</p><p id="p0079" num="0079">In block 1303 the frequency despreading is carried out, namely, each bit is multiplied with the spreading sequence c<sub>f</sub> and then summed along frequency.</p><p id="p0080" num="0080">At this point, if the synchronization position were correct, we would have N<sub>s</sub> decoded bits. As the bits are not known to the receiver, block 1304 computes the likelihood measure by taking the absolute values of the N<sub>s</sub> values and sums.</p><p id="p0081" num="0081">The output of block 1304 is in principle a non coherent correlator which looks for the synchronization signature. In fact, when choosing a small N<sub>s</sub>, namely the partial message synchronization mode, it is possible to use synchronization sequences (e.g. <b>a</b>, <b>b</b>, <b>c</b>) which are mutually orthogonal. In doing so, when the correlator is not correctly aligned with the signature, its output will be very small, ideally zero. When using the full message synchronization mode it is advised to use as many orthogonal synchronization sequences<!-- EPO <DP n="25"> --> as possible, and then create a signature by carefully choosing the order in which they are used. In this case, the same theory can be applied as when looking for spreading sequences with good auto correlation functions. When the correlator is only slightly misaligned, then the output of the correlator will not be zero even in the ideal case, but anyway will be smaller compared to the perfect alignment, as the analysis filters cannot capture the signal energy optimally.</p><heading id="h0020"><b>3.4.2 Synchronization hits computation 1204</b></heading><p id="p0082" num="0082">This block analyzes the output of the synchronization signature correlator to decide where the synchronization positions are. Since the system is fairly robust against misalignments of up to T<sub>b</sub>/4 and the T<sub>b</sub> is normally taken around 40 ms, it is possible to integrate the output of 1201 over time to achieve a more stable synchronization. A possible implementation of this is given by an IIR filter applied along time with a exponentially decaying impulse response. Alternatively, a traditional FIR moving average filter can be applied. Once the averaging has been carried out, a second correlation along different N<sub>t</sub>·N<sub>s</sub> is carried out ("different positional choice"). In fact, we want to exploit the information that the autocorrelation function of the synchronization function is known. This corresponds to a Maximum Likelihood estimator. The idea is shown in <figref idrefs="f0022">Figure 13c</figref>. The curve shows the output of block 1201 after temporal integration. One possibility to determine the synchronization hit is simply to find the maximum of this function. In <figref idrefs="f0022">Figure 13d</figref> we see the same function (in black) filtered with the autocorrelation function of the synchronization signature. The resulting function is plotted in red. In this case the maximum is more pronounced and gives us the position of the synchronization hit. The two methods are fairly similar for high SNR but the second method performs much better in lower SNR regimes. Once the synchronization hits have been found, they are passed to the watermark extractor 202 which decodes the data.</p><p id="p0083" num="0083">In some embodiments, in order to obtain a robust synchronization signal, synchronization is performed in partial message synchronization mode with short synchronization signatures. For this reason many decodings have to be done, increasing the risk of false positive message detections. To prevent this, in some embodiments signaling sequences may be inserted into the messages with a lower bit rate as a consequence.</p><p id="p0084" num="0084">This approach is a solution to the problem arising from a sync signature shorter than the message, which is already addressed in the above discussion of the enhanced synchronization. In this case, the decoder doesn't know where a new message starts and<!-- EPO <DP n="26"> --> attempts to decode at several synchronization points. To distinguish between legitimate messages and false positives, in some embodiments a signaling word is used (i.e. payload is sacrified to embed a known control sequence). In some embodiments, a plausibility check is used (alternatively or in addition) to distinguish between legitimate messages and false positives.</p><heading id="h0021"><b>3.5 The Watermark Extractor 202</b></heading><p id="p0085" num="0085">The parts constituting the watermark extractor 202 are depicted in <figref idrefs="f0023">Figure 14</figref>. This has two inputs, namely 204 and 205 from blocks 203 and 201, respectively. The synchronization module 201 (see Section 3.4) provides synchronization timestamps, i.e., the positions in time domain at which a candidate message starts. More details on this matter are given in Section 3.4. The analysis filterbank block 203, on the other hand, provides the data in time/frequency domain ready to be decoded.</p><p id="p0086" num="0086">The first processing step, the data selection block 1501, selects from the input 204 the part identified as a candidate message to be decoded. <figref idrefs="f0024">Figure 15</figref> shows this procedure graphically. The input 204 consists of N<sub>f</sub>streams of real values. Since the time alignment is not known to the decoder a priori, the analysis block 203 carries out a frequency analysis with a rate higher than 1/T<sub>b</sub> Hz (oversampling). In <figref idrefs="f0024">Figure 15</figref> we have used an oversampling factor of 4, namely, 4 vectors of size N<sub>f</sub>× 1 are output every T<sub>b</sub> seconds. When the synchronization block 201 identifies a candidate message, it delivers a timestamp 205 indicating the starting point of a candidate message. The selection block 1501 selects the information required for the decoding, namely a matrix of size N<sub>f</sub> × N<sub>m</sub>/R<sub>c</sub>. This matrix 1501a is given to block 1502 for further processing.</p><p id="p0087" num="0087">Blocks 1502, 1503, and 1504 carry out the same operations of blocks 1301, 1302, and 1303 explained in Section 3.4.</p><p id="p0088" num="0088">An alternative embodiment of the invention consists in avoiding the computations done in 1502-1504 by letting the synchronization module deliver also the data to be decoded. Conceptually it is a detail. From the implementation point of view, it is just a matter of how the buffers are realized. In general, redoing the computations allows us to have smaller buffers.</p><p id="p0089" num="0089">The channel decoder 1505 carries out the inverse operation of block 302. If channel encoder, in a possible embodiment of this module, consisted of a convolutional encoder together with an interleaver, then the channel decoder would perform the deinterleaving<!-- EPO <DP n="27"> --> and the convolutional decoding, e.g., with the well known Viterbi algorithm. At the output of this block we have N<sub>m</sub> bits, i.e., a candidate message.</p><p id="p0090" num="0090">Block 1506, the signaling and plausibility block, decides whether the input candidate message is indeed a message or not. To do so, different strategies are possible.</p><p id="p0091" num="0091">The basic idea is to use a signaling word (like a CRC sequence) to distinguish between true and false messages. This however reduces the number of bits available as payload. Alternatively we can use plausibility checks. If the messages for instance contain a timestamp, consecutive messages must have consecutive timestamps. If a decoded message possesses a timestamp which is not the correct order, we can discard it.</p><p id="p0092" num="0092">When a message has been correctly detected the system may choose to apply the look ahead and/or look back mechanisms. We assume that both bit and message synchronization have been achieved. Assuming that the user is not zapping, the system "looks back" in time and attempts to decode the past messages (if not decoded already) using the same synchronization point (look back approach). This is particularly useful when the system starts. Moreover, in bad conditions, it might take 2 messages to achieve synchronization. In this case, the first message has no chance. With the look back option we can save "good" messages which have not been received only due to back synchronization. The look ahead is the same but works in the future. If we have a message now we know where the next message should be, and we can attempt to decode it anyhow.</p><heading id="h0022">3.6. Synchronization Details</heading><p id="p0093" num="0093">For the encoding of a payload, for example, a Viterbi algorithm may be used. <figref idrefs="f0028">Fig. 18a</figref> shows a graphical representation of a payload 1810, a Viterbi termination sequence 1820, a Viterbi encoded payload 1830 and a repetition-coded version 1840 of the Viterbi-coded payload. For example, the payload length may be 34 bits and the Viterbi termination sequence may comprise 6 bits. If, for example a Viterbi code rate of 1/7 may be used the Viterbi-coded payload may comprise (34+6)*7=280 bits. Further, by using a repetition coding of 1/2, the repetition coded version 1840 of the Viterbi-encoded payload 1830 may comprise 280*2=560 bits. In this example, considering a bit time interval of 42.66 ms, the message length would be 23.9 s. The signal may be embedded with, for example, 9 subcarriers (e.g. placed according to the critical bands) from 1.5 to 6 kHz as indicated by the frequency spectrum shown in <figref idrefs="f0028">Fig. 18b</figref>. Alternatively, also another number of<!-- EPO <DP n="28"> --> subcarriers (e.g. 4, 6, 12, 15 or a number between 2 and 20) within a frequency range between 0 and 20 kHz maybe used.</p><p id="p0094" num="0094"><figref idrefs="f0029">Fig. 19</figref> shows a schematic illustration of the basic concept 1900 for the synchronization, also called ABC synch. It shows a schematic illustration of an uncoded messages 1910, a coded message 1920 and a synchronization sequence (synch sequence) 1930 as well as the application of the synch to several messages 1920 following each other.</p><p id="p0095" num="0095">The synchronization sequence or synch sequence mentioned in connection with the explanation of this synchronization concept (shown in <figref idrefs="f0029 f0030 f0031 f0032 f0033">Fig. 19 - 23</figref>) may be equal to the synchronization signature mentioned before.</p><p id="p0096" num="0096">Further, <figref idrefs="f0030">Fig. 20</figref> shows a schematic illustration of the synchronization found by correlating with the synch sequence. If the synchronization sequence 1930 is shorter than the message, more than one synchronization point 1940 (or alignment time block) may be found within a single message. In the example shown in <figref idrefs="f0030">Fig. 20</figref>, <figref idrefs="f0004">4</figref> synchronization points are found within each message. Therefore, for each synchronization found, a Viterbi decoder (a Viterbi decoding sequence) may be started. In this way, for each synchronization point 1940 a message 2110 may be obtained, as indicated in <figref idrefs="f0031">Fig. 21</figref>.</p><p id="p0097" num="0097">Based on these messages the true messages 2210 may be identified by means of a CRC sequence (cyclic redundancy check sequence) and/or a plausibility check, as shown in <figref idrefs="f0032">Fig. 22</figref>.</p><p id="p0098" num="0098">The CRC detection (cyclic redundancy check detection) may use a known sequence to identify true messages from false positive. <figref idrefs="f0033">Fig. 23</figref> shows an example for a CRC sequence added to the end of a payload.</p><p id="p0099" num="0099">The probability of false positive (a message generated based on a wrong synchronization point) may depend on the length of the CRC sequence and the number of Viterbi decoders (number of synchronization points within a single message) started. To increase the length of the payload without increasing the probability of false positive a plausibility may be exploited (plausibility test) or the length of the synchronization sequence (synchronization signature) may be increased.</p><heading id="h0023">4. <u>Concepts and Advantages</u></heading><!-- EPO <DP n="29"> --><p id="p0100" num="0100">In the following, some aspects of the above discussed system will be described, which are considered as being innovative. Also, the relation of those aspects to the state-of-the-art technologies will be discussed.</p><heading id="h0024">4.1. Continuous synchronization</heading><p id="p0101" num="0101">Some embodiments allow for a continuous synchronization. The synchronization signal, which we denote as synchronization signature, is embedded continuously and parallel to the data via multiplication with sequences (also designated as synchronization spread sequences) known to both transmit and receive side.</p><p id="p0102" num="0102">Some conventional systems use special symbols (other than the ones used for the data), while some embodiments according to the invention do not use such special symbols. Other classical methods consist of embedding a known sequence of bits (preamble) time-multiplexed with the data, or embedding a signal frequency-multiplexed with the data.</p><p id="p0103" num="0103">However, it has been found that using dedicated sub-bands for synchronization is undesired, as the channel might have notches at those frequencies, making the synchronization unreliable. Compared to the other methods, in which a preamble or a special symbol is time-multiplexed with the data, the method described herein is more advantageous as the method described herein allows to track changes in the synchronization (due e.g. to movement) continuously.</p><p id="p0104" num="0104">Furthermore, the energy of the watermark signal is unchanged (e.g. by the multiplicative introduction of the watermark into the spread information representation), and the synchronization can be designed independent from the psychoacoustical model and data rate. The length in time of the synchronization signature, which determines the robustness of the synchronization, can be designed at will completely independent of the data rate.</p><p id="p0105" num="0105">Another classical method consists of embedding a synchronization sequence code-multiplexed with the data. When compared to this classical method, the advantage of the method described herein is that the energy of the data does not represent an interfering factor in the computation of the correlation, bringing more robustness. Furthermore, when using code-multiplexing, the number of orthogonal sequences available for the synchronization is reduced as some are necessary for the data.<!-- EPO <DP n="30"> --></p><p id="p0106" num="0106">To summarize, the continuous synchronization approach described herein brings along a large number of advantages over the conventional concepts.</p><p id="p0107" num="0107">However, in some embodiments according to the invention, a different synchronization concept may be applied.</p><heading id="h0025">4.2. 2D spreading</heading><p id="p0108" num="0108">Some embodiments of the proposed system carry out spreading in both time and frequency domain, i.e. a 2-dimensional spreading (briefly designated as 2D-spreading). It has been found that this is advantageous with respect to 1D systems as the bit error rate can be further reduced by adding redundance in e.g. time domain.</p><p id="p0109" num="0109">However, in some embodiments according to the invention, a different spreading concept may be applied.</p><heading id="h0026">4.3. Differential encoding and Differential decoding</heading><p id="p0110" num="0110">In some embodiments according to the invention, an increased robustness against movement and frequency mismatch of the local oscillators (when compared to conventional systems) is brought by the differential modulation. It has been found that in fact, the Doppler effect (movement) and frequency mismatches lead to a rotation of the BPSK constellation (in other words, a rotation on the complex plane of the bits). In some embodiments, the detrimental effects of such a rotation of the BPSK constellation (or any other appropriate modulation constellation) are avoided by using a differential encoding or differential decoding.</p><p id="p0111" num="0111">However, in some embodiments according to the invention, a different encoding concept or decoding concept may be applied. Also, in some cases, the differential encoding may be omitted.</p><heading id="h0027">4.4. Bit shaping</heading><!-- EPO <DP n="31"> --><p id="p0112" num="0112">In some embodiments according to the invention, bit shaping brings along a significant improvement of the system performance, because the reliability of the detection can be increased using a filter adapted to the bit shaping.</p><p id="p0113" num="0113">In accordance with some embodiments, the usage of bit shaping with respect to watermarking brings along improved reliability of the watermarking process. It has been found that particularly good results can be obtained if the bit shaping function is longer than the bit interval.</p><p id="p0114" num="0114">However, in some embodiments according to the invention, a different bit shaping concept may be applied. Also, in some cases, the bit shaping may be omitted.</p><heading id="h0028">4.5. Interactive between Psychoacoustic Model (PAM) and Filter Bank (FB) synthesis</heading><p id="p0115" num="0115">In some embodiments, the psychoacoustical model interacts with the modulator to fine tune the amplitudes which multiply the bits.</p><p id="p0116" num="0116">However, in some other-embodiments, this interaction may be omitted.</p><heading id="h0029">4.6. Look ahead and look back features</heading><p id="p0117" num="0117">In some embodiments, so called "Look back" and "look ahead" approaches are applied.</p><p id="p0118" num="0118">In the following, these concepts will be briefly summarized. When a message is correctly decoded, it is assumed that synchronization has been achieved. Assuming that the user is not zapping, in some embodiments a look back in time is performed and it is tried to decode the past messages (if not decoded already) using the same synchronization point (look back approach). This is particularly useful when the system starts.</p><p id="p0119" num="0119">In bad conditions, it might take 2 messages to achieve synchronization. In this case, the first message has no chance in conventional systems. With the look back option, which is used in some embodiments of the invention, it is possible to save (or decode) "good" messages which have not been received only due to back synchronization.</p><p id="p0120" num="0120">The look ahead is the same but works in the future. If I have a message now I know where my next message should be, and I can try to decode it anyhow. Accordingly, overlapping messages can be decoded.<!-- EPO <DP n="32"> --></p><p id="p0121" num="0121">However, in some embodiments according to the invention, the look ahead feature and/or the look back feature may be omitted.</p><heading id="h0030">4.7. Increased synchronization robustness</heading><p id="p0122" num="0122">In some embodiments, in order to obtain a robust synchronization signal, synchronization is performed in partial message synchronization mode with short synchronization signatures. For this reason many decodings have to be done, increasing the risk of false positive message detections. To prevent this, in some embodiments signaling sequences may be inserted into the messages with a lower bit rate as a consequence.</p><p id="p0123" num="0123">However, in some embodiments according to the invention, a different concept for improving the synchronization robustness may be applied. Also, in some cases, the usage of any concepts for increasing the synchronization robustness may be omitted.</p><heading id="h0031">4.8. Other enhancements</heading><p id="p0124" num="0124">In the following, some other general enhancements of the above described system with respect to background art will be put forward and discussed:
<ol><li>1. lower computational complexity</li><li>2. better audio quality due to the better psychoacoustical model</li><li>3. more robustness in reverberant environments due to the narrowband multicarrier signals</li><li>4. an SNR estimation is avoided in some embodiments. This allows for better robustness, especially in low SNR regimes.</li></ol></p><p id="p0125" num="0125">Some embodiments according to the invention are better than conventional systems, which use very narrow bandwidths of, for example, 8Hz for the following reasons:
<ol><li>1. 8 Hz bandwidths (or a similar very narrow bandwidth) requires very long time symbols because the psychoacoustical model allows very little energy to make it inaudible;<!-- EPO <DP n="33"> --></li><li>2. 8 Hz (or a similar very narrow bandwidth) makes it sensitive against time varying Doppler spectra. Accordingly, such a narrow band system is typically not good enough if implemented, e.g., in a watch.</li></ol></p><p id="p0126" num="0126">Some embodiments according to the invention are better than other technologies for the following reasons:
<ol><li>1. Techniques which input an echo fail completely in reverberant rooms. In contrast, in some embodiments of the invention, the introduction of an echo is avoided.</li><li>2. Techniques which use only time spreading have longer message duration in comparison embodiments of the above described system in which a two-dimensional spreading, for example both in time and in frequency, is used.</li></ol></p><p id="p0127" num="0127">Some embodiments according to the invention are better than the system described in <patcit id="pcit0007" dnum="DE19640814"><text>DE 196 40 814</text></patcit>, because one of more of the following disadvantages of the system according to said document are overcome:
<ul><li>the complexity in the decoder according to <patcit id="pcit0008" dnum="DE19640814"><text>DE 196 40 814</text></patcit> is very high, a filter of length 2N with N = 128 is used</li><li>the system according to <patcit id="pcit0009" dnum="DE19640814"><text>DE 196 40 814</text></patcit> comprises a long message duration</li><li>in the system according to <patcit id="pcit0010" dnum="DE19640814"><text>DE 196 40 814</text></patcit> spreading only in time domain with relatively high spreading gain (e.g. 128)</li><li>in the system according to <patcit id="pcit0011" dnum="DE19640814"><text>DE 196 40 814</text></patcit> the signal is generated in time domain, transformed to spectral domain, weighted, transformed back to time domain, and superposed to audio, which makes the system very complex</li></ul></p><heading id="h0032">5. <u>Applications</u></heading><p id="p0128" num="0128">The invention comprises a method to modify an audio signal in order to hide digital data and a corresponding decoder capable of retrieving this information while the perceived quality of the modified audio signal remains indistinguishable to the one of the original.</p><p id="p0129" num="0129">Examples of possible applications of the invention are given in the following:<!-- EPO <DP n="34"> -->
<ol><li>1. Broadcast monitoring: a watermark containing information on e.g. the station and time is hidden in the audio signal of radio or television programs. Decoders, incorporated in small devices worn by test subjects, are capable to retrieve the watermark, and thus collect valuable information for advertisements agencies, namely who watched which program and when.</li><li>2. Auditing: a watermark can be hidden in, e.g., advertisements. By automatically monitoring the transmissions of a certain station it is then possible to know when exactly the ad was broadcast. In a similar fashion it is possible to retrieve statistical information about the programming schedules of different radios, for instance, how often a certain music piece is played, etc.</li><li>3. Metadata embedding: the proposed method can be used to hide digital information about the music piece or program, for instance the name and author of the piece or the duration of the program etc.</li></ol></p><p id="p0130" num="0130">Summarizing the above embodiments and comparing the embodiments of <figref idrefs="f0001 f0002 f0003 f0004 f0005 f0006 f0007 f0008 f0009 f0010 f0011 f0012 f0013 f0014 f0015 f0016 f0017 f0018 f0019 f0020 f0021 f0022 f0023 f0024 f0025 f0026 f0027 f0028 f0029 f0030 f0031 f0032 f0033">Fig. 1 to 23</figref> with the embodiments of <figref idrefs="f0034">Fig. 24</figref> and <figref idrefs="f0035">25</figref>, these embodiments described a watermark signal provider 2400 for providing a watermark signal 2440; 101b suitable for being hidden in an audio signal 2430; 106 when the watermark signal is added to the audio signal, such that the watermark signal represents watermark data 2450; 101a, the watermark signal provider comprising a psychoacoustical processor 2410; 102 for determining a masking threshold of the audio signal; and a modulator 2420; 307 in 101 for generating the watermark signal from a superposition as represented by equation 8 and shown in <figref idrefs="f0014">Fig. 12a</figref>, for example, of sample-shaping functions <maths id="math0032" num=""><math display="inline"><msubsup><mi>g</mi><mi>i</mi><mi mathvariant="normal">T</mi></msubsup><mfenced><mi>t</mi></mfenced></math><img id="ib0032" file="imgb0032.tif" wi="12" he="6" img-content="math" img-format="tif" inline="yes"/></maths> spaced apart from each other at a sample time interval T<sub>b</sub> of a time-discrete representation b<sub>diff</sub> (i, j) of the watermark data, namely the above-mentioned packets of equal length M<sub>p</sub>, each sample-shaping function <maths id="math0033" num=""><math display="inline"><msubsup><mi>g</mi><mi>i</mi><mi mathvariant="normal">T</mi></msubsup><mfenced><mi>t</mi></mfenced></math><img id="ib0033" file="imgb0033.tif" wi="12" he="6" img-content="math" img-format="tif" inline="yes"/></maths> being amplitude-weighted with a respective sample b<sub>diff</sub> (i, j) of the time-discrete representation, multiplied by a respective amplitude weight γ(i; j) depending on the masking threshold, the modulator being configured such that the sample time interval T<sub>b</sub> is shorter than a time extension of the sample-shaping functions as exemplarily shown in <figref idrefs="f0014">Fig. 12a</figref>; and the respective amplitude weight y(i; j) also depends on samples of the time-discrete representation neighboring the respective sample in time.</p><p id="p0131" num="0131">In particular, the psychoacoustical processor may be configured to determine the masking threshold independent from the watermark data 2450 and the modulator may be configured to generate the watermark signal iteratively by preliminarily determining a preliminary<!-- EPO <DP n="35"> --> amplitude weight γ(i; j) based on the masking threshold independent from the watermark data, and then checking as to whether the superposition of the sample-shaping functions using the preliminary amplitude weight as the respective amplitude weight violates the masking threshold. If so, then the preliminary amplitude weight is varied so as to obtain a superposition of the sample-shaping functions using the varied amplitude weight as the respective amplitude weight. As already outlined above, since in the check, the neighboring samples of the time-discrete representation influence/interfere with each other due to the superposition and the time extension of the sample-shaping functions exceeding the sample time interval, the hole iterative process for generating the watermark signal 2440 and the finally used amplitude-weightings, respectively, are dependent on these neighboring samples of the watermark data representation. In other words, the check, induces a dependency of the finally used amplitude weights γ(i; j) from the samples b<sub>diff</sub>(i, j±1) and enables a good tradeoff between watermark extractability and inaudibility of the watermark signal. Of course, the procedure of checking, superpositioning and varying may iteratively repeated.</p><p id="p0132" num="0132">The just-mentioned dependency on the neighboring samples of the watermark data representation may, alternatively, be implemented by non-iteratively setting the amplitude-weightings. For example, the modulator may analytically determine the amplitude weights γ(i; j) based on both the masking threshold at (i,j) as well as the neighboring watermark samples b<sub>diff</sub>(i, j±1).</p><p id="p0133" num="0133">A time-spreader 305 may be used to spread the watermark data in time in order to obtain the time-discrete representation. Further, a frequency-spreader 303 may be used to spread the watermark data in a frequency domain in order to obtain the time-discrete representation. A time/frequency analyzer 501 may be used transfer the audio signal from the time domain to a frequency domain by means of a lapped transform using a first window length of approximately the sample time interval. The time/frequency analyzer may be configured to transfer the audio signal from the time domain to the frequency domain by means of the lapped transform also using a second window length being shorter than the first window length.</p><p id="p0134" num="0134">When the time-discrete representation is composed of time-discrete subbands, the modulator may be configured to generate the watermark signal from, for each time-discrete subband, a superposition according to both equation 8 and 9 of sample-shaping functions spaced apart at the sample time interval with each sample-shaping function being amplitude-weighted with a respective sample of the respective time-discrete subband multiplied by a respective amplitude weight depending on the masking threshold, the<!-- EPO <DP n="36"> --> sample-shaping functions <maths id="math0034" num=""><math display="inline"><msubsup><mi>g</mi><mi>i</mi><mi mathvariant="normal">T</mi></msubsup><mfenced><mi>t</mi></mfenced></math><img id="ib0034" file="imgb0034.tif" wi="11" he="6" img-content="math" img-format="tif" inline="yes"/></maths> of the superposition for a respective time-discrete subband comprising a carrier frequency at a center frequency f<sub>i</sub> of the respective time-discreet subband i.</p><p id="p0135" num="0135">Further, the above embodiments described a watermark embedder 2500; 100 comprising a watermark signal provider 2400 and an adder 2510 for adding the watermark signal and the audio signal to obtain a watermarked audio signal.</p><heading id="h0033">6. <u>Implementation Alternatives</u></heading><p id="p0136" num="0136">Although some aspects have been described in the context of an apparatus, it is clear that these aspects also represent a description of the corresponding method, where a block or device corresponds to a method step or a feature of a method step. Analogously, aspects described in the context of a method step also represent a description of a corresponding block or item or feature of a corresponding apparatus. Some or all of the method steps may be executed by (or using) a hardware apparatus, like for example, a microprocessor, a programmable computer or an electronic circuit. In some embodiments, some one or more of the most important method steps may be executed by such an apparatus.</p><p id="p0137" num="0137">The inventive encoded watermark signal, or an audio signal into which the watermark signal is embedded, can be stored on a digital storage medium or can be transmitted on a transmission medium such as a wireless transmission medium or a wired transmission medium such as the Internet.</p><p id="p0138" num="0138">Depending on certain implementation requirements, embodiments of the invention can be implemented in hardware or in software. The implementation can be performed using a digital storage medium, for example a floppy disk, a DVD, a Blue-Ray, a CD, a ROM, a PROM, an EPROM, an EEPROM or a FLASH memory, having electronically readable control signals stored thereon, which cooperate (or are capable of cooperating) with a programmable computer system such that the respective method is performed. Therefore, the digital storage medium may be computer readable.</p><p id="p0139" num="0139">Some embodiments according to the invention comprise a data carrier having electronically readable control signals, which are capable of cooperating with a programmable computer system, such that one of the methods described herein is performed.<!-- EPO <DP n="37"> --></p><p id="p0140" num="0140">Generally, embodiments of the present invention can be implemented as a computer program product with a program code, the program code being operative for performing one of the methods when the computer program product runs on a computer. The program code may for example be stored on a machine readable carrier.</p><p id="p0141" num="0141">Other embodiments comprise the computer program for performing one of the methods described herein, stored on a machine readable carrier.</p><p id="p0142" num="0142">In other words, an embodiment of the inventive method is, therefore, a computer program having a program code for performing one of the methods described herein, when the computer program runs on a computer.</p><p id="p0143" num="0143">A further embodiment of the inventive methods is, therefore, a data carrier (or a digital storage medium, or a computer-readable medium) comprising, recorded thereon, the computer program for performing one of the methods described herein.</p><p id="p0144" num="0144">A further embodiment of the inventive method is, therefore, a data stream or a sequence of signals representing the computer program for performing one of the methods described herein. The data stream or the sequence of signals may for example be configured to be transferred via a data communication connection, for example via the Internet.</p><p id="p0145" num="0145">A further embodiment comprises a processing means, for example a computer, or a programmable logic device, configured to or adapted to perform one of the methods described herein.</p><p id="p0146" num="0146">A further embodiment comprises a computer having installed thereon the computer program for performing one of the methods described herein.</p><p id="p0147" num="0147">In some embodiments, a programmable logic device (for example a field programmable gate array) may be used to perform some or all of the functionalities of the methods described herein. In some embodiments, a field programmable gate array may cooperate with a microprocessor in order to perform one of the methods described herein. Generally, the methods are preferably performed by any hardware apparatus.</p><p id="p0148" num="0148">The above described embodiments are merely illustrative for the principles of the present invention. It is understood that modifications and variations of the arrangements and the details described herein will be apparent to others skilled in the art. It is the intent,<!-- EPO <DP n="38"> --> therefore, to be limited only by the scope of the impending patent claims and not by the specific details presented by way of description and explanation of the embodiments herein.</p></description><claims mxw-id="PCLM56977688" lang="DE" load-source="patent-office"><!-- EPO <DP n="42"> --><claim id="c-de-01-0001" num="0001"><claim-text>Wasserzeichensignalbereitsteller (2400) zum Bereitstellen eines Wasserzeichensignals (2440; 101b), das geeignet ist, um in einem Audiosignal (2430; 106) versteckt zu sein, wenn das Wasserzeichensignal zu dem Audiosignal addiert ist, derart, dass das Wasserzeichensignal Wasserzeichendaten (2450; 101 a) darstellt, wobei der Wasserzeichensignalbereitsteller folgende Merkmale aufweist:
<claim-text>einen psychoakustischen Prozessor (2410; 102) zum Bestimmen einer Maskierungsschwelle des Audiosignals; und</claim-text>
<claim-text>einen Modulator (2420; 307) zum Erzeugen des Wasserzeichensignals aus einer Überlagerung von Abtastformungsfunktionen, die voneinander bei einem Abtastzeitintervall (T<sub>b</sub>) einer zeitdiskreten Darstellung der Wasserzeichendaten beabstandet sind, wobei jede Abtastwertformungsfunktion mit einem entsprechenden Abtastwert der zeitdiskreten Darstellung amplitudengewichtet ist, multipliziert mit einem entsprechenden Amplitudengewicht abhängig von der Maskierungsschwelle, wobei der Modulator derart ausgebildet ist, dass<br/>
das Abtastzeitintervall kürzer ist als eine Zeiterstreckung der Abtastformungsfunktionen; und<br/>
das entsprechende Amplitudengewicht auch von Abtastwerten der zeitdiskreten Darstellung zeitlich benachbart zu dem entsprechenden Abtastwert abhängt.</claim-text></claim-text></claim><claim id="c-de-01-0002" num="0002"><claim-text>Wasserzeichensignalbereitsteller gemäß Anspruch 1, bei dem der psychoakustische Prozessor ausgebildet ist, um die Maskierungsschwelle unabhängig von den Wasserzeichendaten zu bestimmen und der Modulator ausgebildet ist, um das Wasserzeichensignal iterativ zu erzeugen durch<br/>
vorab Bestimmen eines Vorab-Amplitudengewichts basierend auf der Maskierungsschwelle unabhängig von den Wasserzeichendaten;<br/>
<!-- EPO <DP n="43"> -->Prüfen, ob eine Überlagerung der Abtastformungsfunktionen unter Verwendung des Vorab-Amplitudengewichts als das entsprechende Amplitudengewicht die Maskierungsschwelle verletzt; und<br/>
wenn die Überlagerung der Abtastformungsfunktionen unter Verwendung des Vorab-Amplitudengewichts als das entsprechende Amplitudengewicht die Maskierungsschwelle verletzt, Variieren des Vorab-Amplitudengewichts, um eine Überlagerung der Abtastformungsfunktionen zu erhalten, unter Verwendung des variierten Amplitudengewichts als das entsprechende Amplitudengewicht.</claim-text></claim><claim id="c-de-01-0003" num="0003"><claim-text>Wasserzeichensignalbereitsteller gemäß Anspruch 1 oder 2, der ferner einen Zeitspreizer (305) aufweist zum zeitlichen Spreizen der Wasserzeichendaten, um eine zeitdiskrete Darstellung zu erhalten.</claim-text></claim><claim id="c-de-01-0004" num="0004"><claim-text>Wasserzeichensignalbereitsteller gemäß einem der Ansprüche 1 bis 3, der ferner einen Frequenzspreizer (303) aufweist zum Spreizen der Wasserzeichendaten in einem Frequenzbereich, um die zeitdiskrete Darstellung zu erhalten.</claim-text></claim><claim id="c-de-01-0005" num="0005"><claim-text>Wasserzeichensignalbereitsteller gemäß einem der vorangehenden Ansprüche, bei dem der psychoakustische Prozessor einen Zeit-/Frequenz-Analysator (501) aufweist, der das Audiosignal aus dem Zeitbereich in einen Frequenzbereich überträgt, mit Hilfe einer überlappten Transformation unter Verwendung einer ersten Fensterlänge von ungefähr dem Abtastzeitintervall.</claim-text></claim><claim id="c-de-01-0006" num="0006"><claim-text>Wasserzeichensignalbereitsteller gemäß Anspruch 5, bei dem der Zeit-/Frequenz-Analysator ausgebildet ist, um das Audiosignal aus dem Zeitbereich in den Frequenzbereich mit Hilfe der überlappten Transformation zu übertragen, ferner unter Verwendung einer zweiten Fensterlänge, die kürzer ist als die erste Fensterlänge.</claim-text></claim><claim id="c-de-01-0007" num="0007"><claim-text>Wasserzeichensignalbereitsteller gemäß einem der vorangehenden Ansprüche, bei dem die zeitdiskrete Darstellung aus zeitdiskreten Teilbändern besteht, wobei der Modulator ausgebildet ist, um das Wasserzeichensignal zu erzeugen, für jedes zeitdiskrete Teilband, aus einer Überlagerung von Abtastformungsfunktionen, beabstandet an dem Abtastzeitintervall, wobei jede Abtastformungsfunktion amplitudengewichtet ist mit einem entsprechenden Abtastwert des entsprechenden zeitdiskreten Teilbandes multipliziert mit einem entsprechenden Amplitudengewicht abhängig von der Maskierungsschwelle, wobei die Abtastformungsfunktionen der Überlagerung<!-- EPO <DP n="44"> --> für ein entsprechendes, zeitdiskretes Teilband eine Trägerfrequenz an einer Mittenfrequenz des entsprechenden zeitdiskreten Teilbands aufweisen.</claim-text></claim><claim id="c-de-01-0008" num="0008"><claim-text>Wasserzeicheneinbetter, der folgende Merkmale aufweist:
<claim-text>einen Wasserzeichensignalbereitsteller zum Bereitstellen eines Wasserzeichensignals, das geeignet ist, um in einem Audiosignal versteckt zu sein, wenn das Wasserzeichensignal zu dem Audiosignal addiert ist, derart, dass das Wasserzeichensignal Wasserzeichendaten darstellt, gemäß einem der vorangehenden Ansprüche,</claim-text>
<claim-text>einen Addierer zum Addieren des Wasserzeichensignals und des Audiosignals, um ein mit Wasserzeichen versehenes Audiosignal zu erhalten.</claim-text></claim-text></claim><claim id="c-de-01-0009" num="0009"><claim-text>Verfahren zum Bereitstellen eines Wasserzeichensignals (101b), das geeignet ist, um in einem Audiosignal (106) versteckt zu sein, wenn das Wasserzeichensignal zu dem Audiosignal hinzugefügt ist, derart, dass das Wasserzeichensignal Wasserzeichendaten (101 a) darstellt, wobei das Verfahren folgende Schritte aufweist:
<claim-text>Bestimmen einer Maskierungsschwelle des Audiosignals; und</claim-text>
<claim-text>Erzeugen des Wasserzeichensignals aus einer Überlagerung von Abtastformungsfunktionen, die voneinander bei einem Abtastzeitintervall (T<sub>b</sub>) einer zeitdiskreten Darstellung der Wasserzeichendaten beabstandet sind, wobei jede Abtastformungsfunktion mit einem entsprechenden Abtastwert der zeitdiskreten Darstellung amplitudengewichtet ist, multipliziert mit einem entsprechenden Amplitudengewicht abhängig von der Maskierungsschwelle, wobei die Erzeugung derart ausgeführt wird, dass<br/>
das Abtastzeitintervall kürzer ist als eine Zeiterstreckung der Abtastformungsfunktionen; und<br/>
das entsprechende Amplitudengewicht auch von Abtastwerten der zeitdiskreten Darstellung zeitlich benachbart zu dem entsprechenden Abtastwert abhängt.</claim-text></claim-text></claim><claim id="c-de-01-0010" num="0010"><claim-text>Wasserzeicheneinbettungsverfahren, das folgende Schritte aufweist:<!-- EPO <DP n="45"> -->
<claim-text>Bereitstellen eines Wasserzeichensignals, das geeignet ist, um in einem Audiosignal versteckt zu sein, wenn das Wasserzeichensignal zu dem Audiosignal addiert ist, derart, dass das Wasserzeichensignal Wasserzeichendaten darstellt, gemäß Anspruch 9, und</claim-text>
<claim-text>Addieren des Wasserzeichensignals und des Audiosignals, um ein mit Wasserzeichen versehenes Audiosignal zu erhalten.</claim-text></claim-text></claim><claim id="c-de-01-0011" num="0011"><claim-text>Computerprogramm mit darauf gespeicherten Anweisungen, angepasst zum Ausführen, wenn es auf einem Computer ausgeführt wird, eines Verfahrens gemäß Anspruch 9 oder 10.</claim-text></claim></claims><claims mxw-id="PCLM56977689" lang="EN" load-source="patent-office"><!-- EPO <DP n="39"> --><claim id="c-en-01-0001" num="0001"><claim-text>Watermark signal provider (2400) for providing a watermark signal (2440; 101b) suitable for being hidden in an audio signal (2430; 106) when the watermark signal is added to the audio signal, such that the watermark signal represents watermark data (2450; 101a), the watermark signal provider comprising:
<claim-text>a psychoacoustical processor (2410; 102) for determining a masking threshold of the audio signal; and</claim-text>
<claim-text>a modulator (2420; 307) for generating the watermark signal from a superposition of sample-shaping functions spaced apart from each other at a sample time interval (T<sub>b</sub>) of a time-discrete representation of the watermark data, each sample-shaping function being amplitude-weighted with a respective sample of the time-discrete representation, multiplied by a respective amplitude weight depending on the masking threshold, the modulator being configured such that<br/>
the sample time interval is shorter than a time extension of the sample-shaping functions; and<br/>
the respective amplitude weight also depends on samples of the time-discrete representation neighboring the respective sample in time.</claim-text></claim-text></claim><claim id="c-en-01-0002" num="0002"><claim-text>Watermark signal provider according to claim 1, wherein the psychoacoustical processor is configured to determine the masking threshold independent from the watermark data and the modulator is configured to generate the watermark signal iteratively by<br/>
preliminarily determining a preliminary amplitude weight based on the masking threshold independent from the watermark data;<br/>
checking as to whether a superposition of the sample-shaping functions using the preliminary amplitude weight as the respective amplitude weight violates the masking threshold; and<br/>
if the superposition of the sample-shaping functions using the preliminary amplitude weight as the respective amplitude weight violates the masking threshold, varying the preliminary amplitude weight so as to obtain a superposition of the sample-shaping<!-- EPO <DP n="40"> --> functions using the varied amplitude weight as the respective amplitude weight.</claim-text></claim><claim id="c-en-01-0003" num="0003"><claim-text>Watermark signal provider according to claim 1 or 2, further comprising a time-spreader (305) for spreading the watermark data in time in order to obtain the time-discrete representation.</claim-text></claim><claim id="c-en-01-0004" num="0004"><claim-text>Watermark signal provider according to any of claims 1 to 3, further comprising a frequency-spreader (303) for spreading the watermark data in a frequency domain in order to obtain the time-discrete representation.</claim-text></claim><claim id="c-en-01-0005" num="0005"><claim-text>Watermark signal provider according to any of the preceding claims, wherein the psychoacoustical processor comprises a time/frequency analyzer (501) transferring the audio signal from the time domain to a frequency domain by means of a lapped transform using a first window length of approximately the sample time interval.</claim-text></claim><claim id="c-en-01-0006" num="0006"><claim-text>Watermark signal provider according to claim 5, wherein the time/frequency analyzer is configured to transfer the audio signal from the time domain to the frequency domain by means of the lapped transform also using a second window length being shorter than the first window length.</claim-text></claim><claim id="c-en-01-0007" num="0007"><claim-text>Watermark signal provider according to any of the preceding claims, wherein the time-discreet representation is composed of time-discrete subbands, wherein the modulator is configured to generate the watermark signal from, for each time-discrete subband, a superposition of sample-shaping functions spaced apart at the sample time interval with each sample-shaping function being amplitude-weighted with a respective sample of the respective time-discrete subband multiplied by a respective amplitude weight depending on the masking threshold, the sample-shaping functions of the superposition for a respective time-discrete subband comprising a carrier frequency at a center frequency of the respective time-discreet subband.</claim-text></claim><claim id="c-en-01-0008" num="0008"><claim-text>Watermark embedder comprising<br/>
a watermark signal provider for providing a watermark signal suitable for being hidden in an audio signal when the watermark signal is added to the audio signal, such that the watermark signal represents watermark data, according to any of the preceding claims, and<br/>
<!-- EPO <DP n="41"> -->an adder for adding the watermark signal and the audio signal to obtain a watermarked audio signal.</claim-text></claim><claim id="c-en-01-0009" num="0009"><claim-text>Method for providing a watermark signal (101b) suitable for being hidden in an audio signal (106) when the watermark signal is added to the audio signal, such that the watermark signal represents watermark data (101a), the method comprising:
<claim-text>determining a masking threshold of the audio signal; and</claim-text>
<claim-text>generating the watermark signal from a superposition of sample-shaping functions spaced apart from each other at a sample time interval (T<sub>b</sub>) of a time-discrete representation of the watermark data, each sample-shaping function being amplitude-weighted with a respective sample of the time-discrete representation, multiplied by a respective amplitude weight depending on the masking threshold, the generation being performed such that<br/>
the sample time interval is shorter than a time extension of the sample-shaping functions; and<br/>
the respective amplitude weight also depends on samples of the time-discrete representation neighboring the respective sample in time.</claim-text></claim-text></claim><claim id="c-en-01-0010" num="0010"><claim-text>Watermark embedding method comprising<br/>
providing a watermark signal suitable for being hidden in an audio signal when the watermark signal is added to the audio signal, such that the watermark signal represents watermark data, according to claim 9, and<br/>
adding the watermark signal and the audio signal to obtain a watermarked audio signal.</claim-text></claim><claim id="c-en-01-0011" num="0011"><claim-text>Computer program having instructions stored thereon adapted to perform, when running on a computer, a method according to claim 9 or 10.</claim-text></claim></claims><claims mxw-id="PCLM56977690" lang="FR" load-source="patent-office"><!-- EPO <DP n="46"> --><claim id="c-fr-01-0001" num="0001"><claim-text>Fournisseur de signal de filigrane (2400) pour fournir un signal de filigrane (2440; 101 b) convenant pour être caché dans un signal audio (2430; 106) lorsque le signal de filigrane est ajouté au signal audio, de sorte que le signal de filigrane représente les données de filigrane (2450; lOla), le fournisseur de signal de filigrane comprenant:
<claim-text>un processeur psychoacoustique (2410; 102) destiné à déterminer un seuil de masquage du signal audio; et</claim-text>
<claim-text>un modulateur (2420; 307) destiné à générer le signal de filigrane à partir d'une superposition de fonctions de façonnage d'échantillon distantes l'une de l'autre dans un intervalle de temps d'échantillon (T<sub>b</sub>) d'une représentation discrète dans le temps des données de filigrane, chaque fonction de façonnage d'échantillon étant pondérée en amplitude par un échantillon respectif de la représentation discrète dans le temps, multipliée par un poids d'amplitude respectif en fonction du seuil de masquage, le modulateur étant configuré de sorte que<br/>
l'intervalle de temps d'échantillon soit plus court qu'une étendue de temps des fonctions de façonnage d'échantillon; et<br/>
le poids d'amplitude respectif dépende également des échantillons de la représentation discrète dans le temps voisine de l'échantillon dans le temps respectif.</claim-text></claim-text></claim><claim id="c-fr-01-0002" num="0002"><claim-text>Fournisseur de signal de filigrane selon la revendication 1, dans lequel le processeur psychoacoustique est configuré pour déterminer le seuil de masquage indépendamment des données de filigrane et le modulateur est configuré pour générer le signal de filigrane de manière itérative<br/>
en déterminant de manière préliminaire un poids d'amplitude<!-- EPO <DP n="47"> --> préliminaire sur base du seuil de masquage indépendamment des données de filigrane;<br/>
en vérifiant si une superposition des fonctions de façonnage d'échantillon à l'aide du poids d'amplitude préliminaire comme poids d'amplitude respectif viole le seuil de masquage; et<br/>
si la superposition des fonctions de façonnage d'échantillon à l'aide du poids d'amplitude préliminaire comme poids d'amplitude respectif viole le seuil de masquage, modifier le poids d'amplitude préliminaire de manière à obtenir une superposition des fonctions de façonnage d'échantillon à l'aide du poids d'amplitude modifié comme poids d'amplitude respectif.</claim-text></claim><claim id="c-fr-01-0003" num="0003"><claim-text>Fournisseur de signal de filigrane selon la revendication 1 ou 2, comprenant par ailleurs un étaleur de temps (305) pour étaler les données de filigrane dans le temps, pour obtenir une représentation discrète dans le temps.</claim-text></claim><claim id="c-fr-01-0004" num="0004"><claim-text>Fournisseur de signal de filigrane selon l'une quelconque des revendications 1 à 3, comprenant par ailleurs un étaleur de fréquence (303) pour étaler les données de filigrane dans un domaine fréquentiel, pour obtenir la représentation discrète dans le temps.</claim-text></claim><claim id="c-fr-01-0005" num="0005"><claim-text>Fournisseur de signal de filigrane selon l'une quelconque des revendications précédentes, dans lequel le processeur psychoacoustique comprend un analyseur de temps/fréquence (501) transférant le signal audio du domaine temporel à un domaine fréquentiel à l'aide d'une transformée à recouvrement en utilisant une première longueur de fenêtre d'environ l'intervalle de temps de l'échantillon.</claim-text></claim><claim id="c-fr-01-0006" num="0006"><claim-text>Fournisseur de signal de filigrane selon la revendication 5, dans lequel l'analyseur de temps/fréquence est configuré pour transférer le signal audio du domaine temporel au domaine fréquentiel à l'aide de la transformée à recouvrement en utilisant<!-- EPO <DP n="48"> --> également une deuxième longueur de fenêtre plus courte que la première longueur de fenêtre.</claim-text></claim><claim id="c-fr-01-0007" num="0007"><claim-text>Fournisseur de signal de filigrane selon l'une quelconque des revendications précédentes, dans lequel la représentation discrète dans le temps se compose de sous-bandes discrètes dans le temps, dans lequel le modulateur est configuré pour générer le signal de filigrane, pour chaque sous-bande discrète dans le temps, à partir d'une superposition de fonctions de façonnage d'échantillon distantes dans l'intervalle de temps d'échantillon, chaque fonction de façonnage d'échantillon étant pondérée en amplitude, un échantillon respectif de la sous-bande discrète dans le temps respective étant multiplié par un poids d'amplitude respectif en fonction du seuil de masquage, les fonctions de façonnage d'échantillon de la superposition d'une sous-bande discrète dans le temps respective comprenant une fréquence porteuse à une fréquence centrale de la sous-bande discrète dans le temps respective.</claim-text></claim><claim id="c-fr-01-0008" num="0008"><claim-text>Incorporateur de filigrane, comprenant<br/>
un fournisseur de signal de filigrane destiné à fournir un signal de filigrane convenant pour être caché dans un signal audio lorsque le signal de filigrane est ajouté au signal audio, de sorte que le signal de filigrane représente des données de filigrane, selon l'une quelconque des revendications précédentes, et<br/>
un additionneur destiné à additionner le signal de filigrane et le signal audio, pour obtenir un signal audio à filigrane.</claim-text></claim><claim id="c-fr-01-0009" num="0009"><claim-text>Procédé pour fournir un signal de filigrane (101b) convenant pour être caché dans un signal audio (106) lorsque le signal de filigrane est ajouté au signal audio, de sorte que le signal de filigrane représente des données de filigrane (101a), le procédé comprenant le fait de:
<claim-text>déterminer un seuil de masquage du signal audio; et<!-- EPO <DP n="49"> --></claim-text>
<claim-text>générer le signal de filigrane à partir d'une superposition (T<sub>b</sub>) d'une représentation discrète dans le temps des données de filigrane, chaque fonction de façonnage d'échantillon étant pondérée en amplitude par un échantillon respectif de la représentation discrète dans le temps multiplié par un poids d'amplitude respectif en fonction du seuil de masquage, le modulateur étant configuré de sorte que<br/>
l'intervalle de temps d'échantillon soit plus court qu'une étendue de temps des fonctions de façonnage d'échantillon; et<br/>
le poids d'amplitude respectif dépende également des échantillons de la représentation discrète dans le temps voisine de l'échantillon dans le temps respectif.</claim-text></claim-text></claim><claim id="c-fr-01-0010" num="0010"><claim-text>Procédé d'incorporation de filigrane, comprenant:
<claim-text>fournir un signal de filigrane convenant pour être caché dans un signal audio lorsque le signal de filigrane est ajouté au signal audio, de sorte que le signal de filigrane représente des données de filigrane, selon la revendication 9, et</claim-text>
<claim-text>additionner le signal de filigrane et le signal audio, pour obtenir un signal audio à filigrane.</claim-text></claim-text></claim><claim id="c-fr-01-0011" num="0011"><claim-text>Programme d'ordinateur présentant des instructions y mémorisées, adapté pour réaliser, lorsqu'il est exécuté sur un ordinateur, un procédé selon la revendication 9 ou 10.</claim-text></claim></claims><drawings mxw-id="PDW16668353" load-source="patent-office"><!-- EPO <DP n="50"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="138" he="169" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="51"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="132" he="196" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="52"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="146" he="227" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="53"> --><figure id="f0004" num="4"><img id="if0004" file="imgf0004.tif" wi="165" he="207" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="54"> --><figure id="f0005" num="5"><img id="if0005" file="imgf0005.tif" wi="118" he="223" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="55"> --><figure id="f0006" num="6"><img id="if0006" file="imgf0006.tif" wi="158" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="56"> --><figure id="f0007" num="7"><img id="if0007" file="imgf0007.tif" wi="121" he="204" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="57"> --><figure id="f0008" num="8"><img id="if0008" file="imgf0008.tif" wi="151" he="228" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="58"> --><figure id="f0009" num="9"><img id="if0009" file="imgf0009.tif" wi="146" he="181" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="59"> --><figure id="f0010" num="10A"><img id="if0010" file="imgf0010.tif" wi="165" he="204" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="60"> --><figure id="f0011" num="10B"><img id="if0011" file="imgf0011.tif" wi="162" he="225" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="61"> --><figure id="f0012" num="11A"><img id="if0012" file="imgf0012.tif" wi="159" he="209" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="62"> --><figure id="f0013" num="11B"><img id="if0013" file="imgf0013.tif" wi="155" he="223" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="63"> --><figure id="f0014" num="12A"><img id="if0014" file="imgf0014.tif" wi="164" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="64"> --><figure id="f0015" num="12B,12C"><img id="if0015" file="imgf0015.tif" wi="165" he="205" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="65"> --><figure id="f0016" num="12D"><img id="if0016" file="imgf0016.tif" wi="165" he="131" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="66"> --><figure id="f0017" num="12E"><img id="if0017" file="imgf0017.tif" wi="132" he="230" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="67"> --><figure id="f0018" num="12F"><img id="if0018" file="imgf0018.tif" wi="163" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="68"> --><figure id="f0019" num="12G"><img id="if0019" file="imgf0019.tif" wi="165" he="216" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="69"> --><figure id="f0020" num="13A"><img id="if0020" file="imgf0020.tif" wi="162" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="70"> --><figure id="f0021" num="13B"><img id="if0021" file="imgf0021.tif" wi="165" he="229" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="71"> --><figure id="f0022" num="13C,13D"><img id="if0022" file="imgf0022.tif" wi="165" he="229" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="72"> --><figure id="f0023" num="14"><img id="if0023" file="imgf0023.tif" wi="147" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="73"> --><figure id="f0024" num="15"><img id="if0024" file="imgf0024.tif" wi="160" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="74"> --><figure id="f0025" num="16"><img id="if0025" file="imgf0025.tif" wi="113" he="232" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="75"> --><figure id="f0026" num="17A"><img id="if0026" file="imgf0026.tif" wi="91" he="226" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="76"> --><figure id="f0027" num="17B,17C"><img id="if0027" file="imgf0027.tif" wi="150" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="77"> --><figure id="f0028" num="18A,18B"><img id="if0028" file="imgf0028.tif" wi="165" he="215" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="78"> --><figure id="f0029" num="19"><img id="if0029" file="imgf0029.tif" wi="130" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="79"> --><figure id="f0030" num="20"><img id="if0030" file="imgf0030.tif" wi="136" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="80"> --><figure id="f0031" num="21"><img id="if0031" file="imgf0031.tif" wi="158" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="81"> --><figure id="f0032" num="22"><img id="if0032" file="imgf0032.tif" wi="161" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="82"> --><figure id="f0033" num="23"><img id="if0033" file="imgf0033.tif" wi="103" he="73" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="83"> --><figure id="f0034" num="24"><img id="if0034" file="imgf0034.tif" wi="145" he="156" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="84"> --><figure id="f0035" num="25"><img id="if0035" file="imgf0035.tif" wi="141" he="186" img-content="drawing" img-format="tif"/></figure></drawings><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
