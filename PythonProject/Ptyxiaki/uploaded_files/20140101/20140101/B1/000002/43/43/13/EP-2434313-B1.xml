<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2434313-B1" country="EP" doc-number="2434313" kind="B1" date="20140101" family-id="39050214" file-reference-id="290038" date-produced="20180823" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146552425" ucid="EP-2434313-B1"><document-id><country>EP</country><doc-number>2434313</doc-number><kind>B1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-11185562-A" is-representative="NO"><document-id mxw-id="PAPP154826348" load-source="docdb" format="epo"><country>EP</country><doc-number>11185562</doc-number><kind>A</kind><date>20070813</date><lang>EN</lang></document-id><document-id mxw-id="PAPP246863243" load-source="docdb" format="original"><country>EP</country><doc-number>11185562.3</doc-number><date>20070813</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140448984" ucid="EP-07872732-A" linkage-type="3" load-source="docdb"><document-id format="epo"><country>EP</country><doc-number>07872732</doc-number><kind>A</kind><date>20070813</date></document-id></priority-claim><priority-claim mxw-id="PPC140451736" ucid="US-82219506-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>82219506</doc-number><kind>P</kind><date>20060811</date></document-id></priority-claim><priority-claim mxw-id="PPC140449098" ucid="US-83813307-A" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>83813307</doc-number><kind>A</kind><date>20070813</date></document-id></priority-claim></priority-claims><dates-of-public-availability><intention-to-grant-date><date>20130726</date></intention-to-grant-date></dates-of-public-availability><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988105008" load-source="docdb">G01S  19/51        20100101ALI20120322BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988105602" load-source="docdb">G01S  19/15        20100101AFI20120322BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988113683" load-source="docdb">G01S  19/11        20100101ALI20100101RMUS        </classification-ipcr><classification-ipcr mxw-id="PCL1988127223" load-source="docdb">G01S   5/14        20060101A I20100710RMEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL1988125688" load-source="docdb" scheme="CPC">G01S  19/51        20130101 LI20130101BHEP        </classification-cpc><classification-cpc mxw-id="PCL1988138704" load-source="docdb" scheme="CPC">G01S  19/15        20130101 FI20130101BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132189759" lang="DE" load-source="patent-office">Verfahren zur Verschmelzung mehrerer GPS-Messungsarten in eine gewichtete Kleinstquadratlösung</invention-title><invention-title mxw-id="PT132189760" lang="EN" load-source="patent-office">Method for fusing multiple GPS measurement types into a weighted least squares solution</invention-title><invention-title mxw-id="PT132189761" lang="FR" load-source="patent-office">Procédé de fusion de plusieurs types de mesures GPS dans une solution de moindres carrés pondérés</invention-title></technical-data><related-documents><relation type="division"><child-doc ucid="EP-11185562-A"><document-id load-source="patent-office" format="epo"><country>EP</country><doc-number>11185562</doc-number><kind>A</kind><date>20070813</date></document-id></child-doc><parent-doc ucid="EP-07872732.8"><document-id load-source="patent-office" format="epo"><country>EP</country><doc-number>07872732.8</doc-number><date>20070813</date></document-id></parent-doc></relation></related-documents><parties><applicants><applicant mxw-id="PPAR918138894" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>SIERRA NEVADA CORP</last-name><address><country>US</country></address></addressbook></applicant><applicant mxw-id="PPAR918161783" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>SIERRA NEVADA CORPORATION</last-name></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918166383" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>HANSEN JOSEPH HENRY JR</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918168698" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>Hansen, Joseph Henry Jr</last-name></addressbook></inventor><inventor mxw-id="PPAR918995001" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Hansen, Joseph Henry Jr</last-name><address><street>1473 W. Flint Meadow Drive</street><city>Kaysville, UT 84037</city><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918153191" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>WRIGHT WILLIAM G</last-name><address><country>US</country></address></addressbook></inventor><inventor mxw-id="PPAR918140625" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>Wright, William G</last-name></addressbook></inventor><inventor mxw-id="PPAR918995002" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>Wright, William G</last-name><address><street>2274 Blossomwood Circle</street><city>Sandy, UT 84093</city><country>US</country></address></addressbook></inventor></inventors><assignees><assignee mxw-id="PPAR918994999" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Sierra Nevada Corporation</last-name><iid>100780295</iid><address><street>444 Salomon Circle</street><city>Sparks, NV 89434</city><country>US</country></address></addressbook></assignee></assignees><agents><agent mxw-id="PPAR918995000" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Holz, Ulrike</last-name><iid>101212717</iid><address><street>Haseltine Lake LLP Lincoln House, 5th Floor 300 High Holborn</street><city>London WC1V 7JH</city><country>GB</country></address></addressbook></agent></agents></parties><international-convention-data><designated-states><ep-contracting-states><country mxw-id="DS548847285" load-source="docdb">AT</country><country mxw-id="DS548954312" load-source="docdb">BE</country><country mxw-id="DS548947801" load-source="docdb">BG</country><country mxw-id="DS548960362" load-source="docdb">CH</country><country mxw-id="DS548949217" load-source="docdb">CY</country><country mxw-id="DS548847286" load-source="docdb">CZ</country><country mxw-id="DS548822329" load-source="docdb">DE</country><country mxw-id="DS548954313" load-source="docdb">DK</country><country mxw-id="DS548949226" load-source="docdb">EE</country><country mxw-id="DS548875356" load-source="docdb">ES</country><country mxw-id="DS548947802" load-source="docdb">FI</country><country mxw-id="DS548947803" load-source="docdb">FR</country><country mxw-id="DS548954322" load-source="docdb">GB</country><country mxw-id="DS548954323" load-source="docdb">GR</country><country mxw-id="DS548949227" load-source="docdb">HU</country><country mxw-id="DS548960363" load-source="docdb">IE</country><country mxw-id="DS548954324" load-source="docdb">IS</country><country mxw-id="DS548947804" load-source="docdb">IT</country><country mxw-id="DS548949228" load-source="docdb">LI</country><country mxw-id="DS548822330" load-source="docdb">LT</country><country mxw-id="DS548847287" load-source="docdb">LU</country><country mxw-id="DS548822331" load-source="docdb">LV</country><country mxw-id="DS548822332" load-source="docdb">MC</country><country mxw-id="DS548958733" load-source="docdb">MT</country><country mxw-id="DS548847288" load-source="docdb">NL</country><country mxw-id="DS548847289" load-source="docdb">PL</country><country mxw-id="DS548875357" load-source="docdb">PT</country><country mxw-id="DS548847290" load-source="docdb">RO</country><country mxw-id="DS548847291" load-source="docdb">SE</country><country mxw-id="DS548822333" load-source="docdb">SI</country><country mxw-id="DS548960364" load-source="docdb">SK</country><country mxw-id="DS548958734" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data></bibliographic-data><description mxw-id="PDES63956825" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001">BACKGROUND</heading><heading id="h0002"><u>1. Field of the Invention</u></heading><p id="p0001" num="0001">The present invention relates to Global Positioning System (GPS)-based Relative Navigation Systems, and more particularly to a method for processing the relative state of the position component of an airborne navigation System.</p><heading id="h0003"><u>2. Background of the Invention</u></heading><p id="p0002" num="0002">A need has been found for providing a rapidly deployable, adverse weather, adverse terrain, day-night, survivable, and mobile precision approach and landing capability that supports the principles of forward presence, crisis response and mobility. The capability should enable military forces to land on any suitable surface world wide (land and sea), under both peace time and hostile conditions, with ceiling and/or visibility the limiting factor.</p><p id="p0003" num="0003">The Joint Precision Approach and Landing System (JPALS) is an integral part of such a strategic system. JPALS is a differential GPS that provides a rapidly deployable, mobile, adverse weather, adverse terrain, day-night, and survivable precision approach and landing capability. The JPALS allows an aircraft to land on any suitable land or sea-based surface worldwide, while minimizing the impact to airfield operations, because of low ceiling or poor visibility. This approach and landing system provides the capability of performing conventional and special<!-- EPO <DP n="2"> --> operations from a fixed-base, shipboard, and austere environments under a wide range of meteorological and terrain conditions.</p><p id="p0004" num="0004">One of the primary functions of sea-based JPALS is to determine the relative state (position, velocity and acceleration) of an airborne vehicle with respect to its assigned ship. This function is called "Relative State Function" or "Relative Navigation" ("RelNav"). Existing civil and military systems do not satisfy JPALS requirements because they have a number of shortcomings that limit joint operations. The multiplicity of systems, in and of itself, hinders inter-Service, civil, and allied operations.</p><p id="p0005" num="0005">Among the limitations of conventional systems, especially as applied to calculating position data of an aircraft closing in on a target, is that in order to calculate an aircraft's position, numerous measurements must taken. Certain measurement types have better accuracy but require more processing time to achieve results. Traditionally, four measurements of the same type are needed to be used in a solution; otherwise optimal solutions can not be made available. Conventional methods that use a weighted least squares position solution use only a single measurement type. Furthermore, conventional methods have been less than satisfactory when relative position estimation is needed between two moving vehicles (e.g., between an aircraft and a ship).<br/>
<patcit id="pcit0001" dnum="US5991691A"><text>US5991691</text></patcit> discloses a system for determining high accuracy relative position solutions between two moving platforms.<br/>
<patcit id="pcit0002" dnum="US2006074558A"><text>US2006/074558</text></patcit> discloses methods and apparatuses for maintaining the integrity of an estimation process associated with time-varying operations. In one application of the disclosed methods and apparatuses, a receiver aircraft involved in Navy style aerial refuelling with a drogue forms a relative state vector between the drogue and the receiver aircraft.</p><heading id="h0004">SUMMARY OF THE INVENTION</heading><p id="p0006" num="0006">As used herein, the terms "invention" and "present invention" are to be understood as encompassing the invention described herein in its various embodiments and aspects, as well as any equivalents that may suggest themselves to those skilled in the pertinent arts.<!-- EPO <DP n="3"> --></p><p id="p0007" num="0007">The present invention provides a novel and effective system and method for a GPS-based airborne navigation system to process the position component of the Relative State Function by fusing different types measurement data, i.e., data representing several different measured parameters. More specifically, the present invention provides an improved method and system of calculating the position data of aircraft closing in on target locations.</p><p id="p0008" num="0008">The present invention enhances the speed and accuracy of such position calculations. This is accomplished by the fusing some or all of the different types of measurement data available in a GPS-based system into a weighted least squares algorithm to determine the appropriate covariance matrix, given the different measurement types.<br/>
According to an aspect of the invention, there is provided a method of calculating a relative vector solution between a location of a moving craft and a reference receiver, comprising receiving Global Positioning System, GPS, signals from a plurality of GPS satellites at the moving craft and at the reference receiver; computing position, velocity, and estimated wide lane phase ambiguity data at the reference receiver; transmitting the computed data from the reference receiver to the moving craft; and calculating, at the moving craft, the relative vector solution between the location of the moving craft and the reference receiver by fusing GPS-based measurement data and the computed data received from the reference receiver with a weighted least squares, WLS, algorithm, the calculating comprising selecting the GPS-based measurement data having the lowest variance for each of the plurality of GPS satellites, calculating a weighting covariance matrix for the selected data, and fusing the selected data in the WLS algorithm utilizing the calculated covariance matrix.<br/>
According to another aspect of the invention, there is provided a landing system for a moving craft, comprising means at a reference receiver for computing and transmitting reference receiver position, velocity, and estimated wide lane phase ambiguity data, the data computed using Global Positioning System, GPS, signals received by the reference receiver from a plurality of GPS satellites; a receiver on the moving craft that is operable to receive GPS signals from the plurality of GPS satellites and the computed data from the reference receiver; and a calculating system associated with the receiver on the moving craft that is operable to calculate a relative vector solution between the location of the moving craft and the reference receiver by fusing the GPS-based measurement data computed by the moving craft and the computed data received from the reference receiver with a weighted least squares, WLS, algorithm, the calculation comprising selecting the GPS-based measurement data having the lowest variance for each of the plurality of GPS satellites, calculating a weighting covariance matrix for the selected data, and fusing the selected data in the WLS algorithm utilizing the calculated covariance matrix.<br/>
<!-- EPO <DP n="4"> -->This method and system allows optimal accuracy in the position solution by including all satellites, and their best available measurements. Moreover, the invention can operate and provide satisfactory results whenever relative position estimation is needed between two vehicles (e.g., an aircraft and a ship).</p><heading id="h0005">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p0009" num="0009"><figref idrefs="f0001">FIG. 1</figref> is an illustration of the overall set up of a relative navigation system, of the type in which the system and method of the present invention may be employed;</p><p id="p0010" num="0010"><figref idrefs="f0002">FIG. 2</figref> is an architectural block diagram of an airborne relative state system that includes an airborne RelNav computer system and interfaces;</p><p id="p0011" num="0011"><figref idrefs="f0003">FIG. 3</figref> is a flow diagram showing major functional/processing blocks of an airborne RelNav system including the RelNav computer system and interfaces; and</p><p id="p0012" num="0012"><figref idrefs="f0004">FIG. 4</figref> is a flow chart identifying process steps to calculate position data in accordance with present invention.</p><heading id="h0006">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading><p id="p0013" num="0013">The following definitions are provided as they are typically (but not exclusively) used in GPS-based navigation systems implementing the various adaptive aspects of the present invention.</p><p id="p0014" num="0014">The GPS is a satellite-based navigation system having a constellation of 24 Earth orbiting satellites. These satellites are approximately uniformly dispersed around six circular orbits having four satellites in each orbit. Each GPS satellite transmits at two frequencies: L1 (1575.42 MHz) and L2 (1227.60 MHz). The L1 frequency has two different spread-spectrum codes modulated on it: a coarse acquisition (CA) code, and a Y code. The Y code is also<!-- EPO <DP n="5"> --> modulated onto the L2 carrier.</p><p id="p0015" num="0015">Earth centered, Earth fixed (ECEF) is a Cartesian coordinate system used for GPS. It represents positions as X, Y, and Z coordinates in meters. The point (0,0,0) denotes the center of the earth, hence the name Earth-Centered.</p><p id="p0016" num="0016">World Geodetic System of 1984 (WGS 84) a geodetic reference systems used by GPS and developed by the U.S. Defense Mapping Agency.</p><p id="p0017" num="0017">Double Difference (technique) is a measurement method using two receivers. Differences are formed at each measurement epoch between two satellites on each receiver and then between the same two receivers.</p><p id="p0018" num="0018">To better understand the invention, an overall system description is given, and the function and operation of the present invention will be described in specific detail.</p><p id="p0019" num="0019"><figref idrefs="f0001">Fig. 1</figref> shows an overall set up for a relative navigation system 100 between an aircraft 102 and a ship 106. Both the aircraft 102 and the ship 106 receive L1 and L2 GPS measurements from a GPS satellite constellation 104. The ship 106 processes its measurement data to generate its state (position, velocity) and estimated wide lane phase ambiguities. Ship measurement data are generated from as many as 4 GPS antennas. The computed ship state (position, velocity) and estimated wide lane phase ambiguities are broadcast, using radio frequencies, for use by all aircraft within broadcast range of the ship.</p><p id="p0020" num="0020">The aircraft 102 combines its own measurements with the ship measurements, state, and ambiguities received over the broadcast, to produce a relative vector solution between its own GPS antenna and the ship's reference point. It also determines the quality of the relative vector solution.</p><p id="p0021" num="0021">Referring to <figref idrefs="f0002">Fig. 2</figref>, an Airborne Relative State System 110 includes an Airborne RelNav computer system 116 that computes the relative position and velocity vector between the ship<!-- EPO <DP n="6"> --> 106 and the aircraft 102. It also computes the uncertainty of the computed position and velocity vectors. The computed relative state and its uncertainty are inputted to a guidance and control (G&amp;C) system 118 for guidance and control of the aircraft 102.</p><p id="p0022" num="0022">To assure system modularity, the interfaces in the airborne relative state system 110 are well defined. Five such interfaces are shown in <figref idrefs="f0002">Figs. 2</figref> and <figref idrefs="f0003">3</figref>:
<ul><li>Aircraft Avionic System 117 and its associated avionics interface (AI) 117A;</li><li>Airborne GPS receiver 119 and its associated GPS receiver interface (AGRI) 119A;</li><li>Airborne Data Link 112 and its associated data link interface (DLI) 112A;</li><li>Configuration data 114 and its associated configuration date interface (CDI) 114A; and</li><li>Airborne Guidance and Control system 118 and its associated guidance and control interface (GCI) 118A.</li></ul></p><p id="p0023" num="0023">The Relative State Function has been partitioned into several sub-functions, as illustrated in <figref idrefs="f0003">Fig. 3</figref>. The algorithms to implement each sub-function are not described; only the sub-functions performed are identified. A detailed description of functionality and algorithmic implementation is provided only for the Precision Relative State module (PRS) 137, since its architecture and operation embody the present invention.</p><p id="p0024" num="0024">The functional representation of the RelNav computer system 116 in <figref idrefs="f0003">FIG. 3</figref> identifies nine functional blocks along with three sub-blocks. A Measurement Management and Validation (MMV) function 129 receives data from Airborne GPS receivers 119 via the AGRI 119A, Configuration Data 114 via the CDI 114A, and Ship Data Uncompressed (DU) 125 via the DLI 112A. The DU 125 converts ship position and velocity data to WGS-84 ECEF coordinates. The MMV function 129 validates Pseudo Range (PR) and Carrier Phase (CP) data ("Measurement Validation" 127), synchronizes the use of ephemeral data between ship and aircraft ("Sync. of Ephemeral Data" 127a), propagates ship position and velocity data to aircraft time ("Propagation of Ship Data..." 126), synchronizes aircraft measurements to ship time ("Sync. of Aircraft Data..." 128), and computes the sigma value of each aircraft GPS measurement ("Compute Sigma" 128a).<!-- EPO <DP n="7"> --></p><p id="p0025" num="0025">A Ship Troposphere Correction (STC) function 131 applies tropospheric corrections to ship GPS measurements. An Aircraft Troposphere Correction function (ATC) 132 applies tropospheric corrections to aircraft GPS measurements. An Absolute Position and Velocity (APV) function 130 computes the aircraft's absolute position, the positions of satellites from the ephemeral data, and the aircraft's absolute velocity solution. A Relative Measurements (RM) function 133 calculates Double-Difference (DD) measurements (L1 PR, L2 PR, L1 CP, L2 CP, WL CP, NL PR) at ship time, and calculates variance components (multipath and noise, ionosphere corrections, troposphere corrections) of DD measurements from Single-Difference (SD) measurements (L1 PR, L2 PR, L1 CP, L2 CP, WL CP, NL PR) and variances at ship time. The satellite highest in elevation is chosen as a reference, and the RM function 133 calculates covariance matrices components (multipath and noise, ionosphere corrections, troposphere corrections) of the DD measurements. Since ship measurements may come from four separate antennas, four separate solutions may be required.</p><p id="p0026" num="0026">A Wide Lane Ambiguities (WLA) function 134 determines WL float ambiguities and covariance (Ship UD, Aircraft UD, SD, and DD). It determines the probability of correctly fixing WL ambiguities, and it also determines the Discrimination Ratio of integer ambiguities, validates integer ambiguities, and fixes WL ambiguities. An L1/L2 Ambiguities (L1L2A) function 135 is performed assuming WL fixed ambiguities have been resolved successfully. It determines L1 and L2 float ambiguities and covariance, determines the probability of correctly fixing L1 and L2 ambiguities, determines the Discrimination Ratio (DR) of resolved L1 and L2 integer ambiguities, validates integer ambiguities, and fixes L1 and L2 ambiguities. A Basic Relative State (BRS) function 136 computes a Basic Relative State (position and velocity) at aircraft time and computes a Covariance of Basic Relative State (position and velocity).</p><p id="p0027" num="0027">The G &amp; C Interface (GCI) 118A provides precision relative state outputs to Guidance and Control functions, and it receives input from the Precision Relative State module (PRS) 137. The Avionics Interface (AI) 117A provides Basic Relative State outputs to the aircraft avionics system. The PRS module 137 determines a Precision Relative State only if an aircraft's distance to the ship is less than 10 nautical miles A satellite should only be considered in a particular<!-- EPO <DP n="8"> --> solution if its measurements have been consecutively available for a configurable amount of time. The initial interval is set at 30 seconds or 60 samples.</p><p id="p0028" num="0028">A functional block diagram for the Precision Relative State (PRS) module 137 is shown in <figref idrefs="f0004">FIG. 4</figref>, illustrating the different calculations performed to arrive at a Precision Relative State solution. A first computing module 138 computes code range and phase range values from Measurements and Covariance. DD NL Code Range Observables are calculated by Equations (1), (2) and (3): <maths id="math0001" num="(1)"><math display="block"><msub><mi>λ</mi><mi>nl</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>λ</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>λ</mi><mn>2</mn></msub></mrow><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>+</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow></mfrac></math><img id="ib0001" file="imgb0001.tif" wi="156" he="15" img-content="math" img-format="tif"/></maths> <maths id="math0002" num="(2)"><math display="block"><msub><mi>R</mi><mi mathvariant="italic">nl</mi></msub><mo>=</mo><msub><mi>λ</mi><mi>nl</mi></msub><mo>⁢</mo><mfenced open="[" close="]" separators=""><mfrac><msub><mi>R</mi><mn>1</mn></msub><msub><mi>λ</mi><mn>1</mn></msub></mfrac><mo>+</mo><mfrac><msub><mi>R</mi><mn>2</mn></msub><msub><mi>λ</mi><mn>2</mn></msub></mfrac></mfenced></math><img id="ib0002" file="imgb0002.tif" wi="156" he="17" img-content="math" img-format="tif"/></maths> <maths id="math0003" num="(3)"><math display="block"><msub><mi>C</mi><msub><mi>R</mi><mi mathvariant="italic">nl</mi></msub></msub><mo>=</mo><msup><mfenced><mfrac><msub><mi>λ</mi><mi>nl</mi></msub><msub><mi>λ</mi><mn>1</mn></msub></mfrac></mfenced><mn>2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">C</mi><mrow><msub><mi>DD_L</mi><mn>1</mn></msub><mi>_</mi><mi>M</mi><mo>,</mo><mi>E</mi></mrow></msub><mo>+</mo><msup><mfenced><mfrac><msub><mi>λ</mi><mi>nl</mi></msub><msub><mi>λ</mi><mn>2</mn></msub></mfrac></mfenced><mn>2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">C</mi><mrow><msub><mi>DD_L</mi><mn>2</mn></msub><mi>_</mi><mi>M</mi><mo>,</mo><mi>E</mi></mrow></msub><mo>+</mo><msub><mi mathvariant="normal">C</mi><mrow><msub><mi>DD_L</mi><mn>1</mn></msub><mi>_</mi><mi mathvariant="italic">tropo</mi></mrow></msub><mo>+</mo><msup><mfenced><mfrac><msub><mi>λ</mi><mn>2</mn></msub><msub><mi>λ</mi><mn>1</mn></msub></mfrac></mfenced><mn>2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">C</mi><mrow><msub><mi>DD_L</mi><mn>1</mn></msub><mi>_</mi><mi mathvariant="italic">iono</mi></mrow></msub></math><img id="ib0003" file="imgb0003.tif" wi="156" he="17" img-content="math" img-format="tif"/></maths><br/>
where R<sub>1</sub> and R<sub>2</sub> are DD code ranges<br/>
DD Phase Range Observrables are calculated by Equations (4) to (9):
<ul><li>L1 Float:- <maths id="math0004" num="(4)"><math display="block"><msub><mi mathvariant="normal">Φ</mi><mrow><mn>1</mn><mi>_flo</mi></mrow></msub><mo>=</mo><msub><mi mathvariant="normal">Φ</mi><mn>1</mn></msub><mo>-</mo><msub><mi mathvariant="normal">λ</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi mathvariant="normal">N</mi><mrow><mn>1</mn><mi>_flo</mi></mrow></msub></math><img id="ib0004" file="imgb0004.tif" wi="154" he="9" img-content="math" img-format="tif"/></maths> <maths id="math0005" num=""><math display="block"><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mn>1</mn></msub></msub><mo>=</mo><msub><mi mathvariant="normal">C</mi><mrow><msub><mi>DD_L</mi><mn>1</mn></msub><mi>_</mi><mi>m</mi><mo>,</mo><mi>e</mi></mrow></msub><mo>+</mo><msub><mi mathvariant="normal">C</mi><mrow><msub><mi>DD_L</mi><mn>1</mn></msub><mi>_</mi><mi mathvariant="italic">iono</mi></mrow></msub><mo>+</mo><msub><mi mathvariant="normal">C</mi><mrow><msub><mi>DD_L</mi><mn>1</mn></msub><mi>_</mi><mi mathvariant="italic">tropo</mi></mrow></msub></math><img id="ib0005" file="imgb0005.tif" wi="73" he="8" img-content="math" img-format="tif"/></maths> <maths id="math0006" num=""><math display="block"><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mrow><mn>1</mn><mi mathvariant="italic">_</mi><mi mathvariant="italic">flo</mi></mrow></msub></msub><mo>=</mo><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mn>1</mn></msub></msub><mo>+</mo><msup><msub><mi>λ</mi><mn>1</mn></msub><mn>2</mn></msup><mo>⁢</mo><msub><mi>C</mi><msub><mi>N</mi><mrow><mn>1</mn><mi mathvariant="italic">_</mi><mi mathvariant="italic">flo</mi></mrow></msub></msub></math><img id="ib0006" file="imgb0006.tif" wi="46" he="10" img-content="math" img-format="tif"/></maths></li><li>L2 Float:- <maths id="math0007" num=""><math display="block"><msub><mi mathvariant="normal">Φ</mi><mrow><mn mathvariant="normal">2</mn><mi mathvariant="normal">_</mi><mi>flo</mi></mrow></msub><mo>=</mo><msub><mi mathvariant="normal">Φ</mi><mn mathvariant="normal">2</mn></msub><mo>-</mo><msub><mi mathvariant="normal">λ</mi><mn mathvariant="normal">2</mn></msub><mo>⁢</mo><msub><mi mathvariant="normal">N</mi><mrow><mn mathvariant="normal">2</mn><mi mathvariant="normal">_</mi><mi>flo</mi></mrow></msub></math><img id="ib0007" file="imgb0007.tif" wi="40" he="7" img-content="math" img-format="tif"/></maths> <maths id="math0008" num="(5)"><math display="block"><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mn>1</mn></msub></msub><mo>=</mo><msub><mi mathvariant="normal">C</mi><mrow><msub><mi>DD_L</mi><mn>2</mn></msub><mi>_</mi><mi>m</mi><mo>,</mo><mi>e</mi></mrow></msub><mo>+</mo><msub><mi mathvariant="normal">C</mi><mrow><msub><mi>DD_L</mi><mn>2</mn></msub><mi>_</mi><mi mathvariant="italic">iono</mi></mrow></msub><mo>+</mo><msub><mi mathvariant="normal">C</mi><mrow><msub><mi>DD_L</mi><mn>2</mn></msub><mi>_</mi><mi mathvariant="italic">tropo</mi></mrow></msub></math><img id="ib0008" file="imgb0008.tif" wi="154" he="8" img-content="math" img-format="tif"/></maths> <maths id="math0009" num=""><math display="block"><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mrow><mn>2</mn><mi mathvariant="italic">_</mi><mi mathvariant="italic">flo</mi></mrow></msub></msub><mo>=</mo><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mn>2</mn></msub></msub><mo>+</mo><msup><msub><mi>λ</mi><mn>2</mn></msub><mn>2</mn></msup><mo>⁢</mo><msub><mi>C</mi><msub><mi>N</mi><mrow><mn>2</mn><mi mathvariant="italic">_</mi><mi mathvariant="italic">flo</mi></mrow></msub></msub></math><img id="ib0009" file="imgb0009.tif" wi="47" he="10" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="9"> --></li><li>L1 Fixed:- <maths id="math0010" num="(6)"><math display="block"><msub><mi mathvariant="normal">Φ</mi><mrow><mn>1</mn><mi>_fix</mi></mrow></msub><mo>=</mo><msub><mi mathvariant="normal">Φ</mi><mn>1</mn></msub><mo>-</mo><msub><mi mathvariant="normal">λ</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi mathvariant="normal">N</mi><mrow><mn>1</mn><mi>_fix</mi></mrow></msub></math><img id="ib0010" file="imgb0010.tif" wi="151" he="7" img-content="math" img-format="tif"/></maths> <maths id="math0011" num=""><math display="block"><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mrow><mn>1</mn><mi mathvariant="italic">_</mi><mi mathvariant="italic">fix</mi></mrow></msub></msub><mo>=</mo><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mn>1</mn></msub></msub></math><img id="ib0011" file="imgb0011.tif" wi="23" he="9" img-content="math" img-format="tif"/></maths></li><li>L2 Fixed:- <maths id="math0012" num="(7)"><math display="block"><msub><mi mathvariant="normal">Φ</mi><mrow><mn>2</mn><mi>_fix</mi></mrow></msub><mo>=</mo><msub><mi mathvariant="normal">Φ</mi><mn>2</mn></msub><mo>-</mo><msub><mi mathvariant="normal">λ</mi><mn>2</mn></msub><mo>⁢</mo><msub><mi mathvariant="normal">N</mi><mrow><mn>2</mn><mi>_fix</mi></mrow></msub></math><img id="ib0012" file="imgb0012.tif" wi="151" he="7" img-content="math" img-format="tif"/></maths> <maths id="math0013" num=""><math display="block"><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mrow><mn>2</mn><mi mathvariant="italic">_</mi><mi mathvariant="italic">fix</mi></mrow></msub></msub><mo>=</mo><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mn>2</mn></msub></msub></math><img id="ib0013" file="imgb0013.tif" wi="25" he="9" img-content="math" img-format="tif"/></maths></li><li>WL Float :- <maths id="math0014" num=""><math display="block"><msub><mi>λ</mi><mrow><mi mathvariant="normal">w</mi><mo>⁢</mo><mn mathvariant="normal">1</mn></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>λ</mi><mn mathvariant="normal">1</mn></msub><mo>⁢</mo><msub><mi>λ</mi><mn mathvariant="normal">2</mn></msub></mrow><mrow><msub><mi>λ</mi><mn mathvariant="normal">2</mn></msub><mo>-</mo><msub><mi>λ</mi><mn mathvariant="normal">1</mn></msub></mrow></mfrac></math><img id="ib0014" file="imgb0014.tif" wi="24" he="13" img-content="math" img-format="tif"/></maths> <maths id="math0015" num="(8)"><math display="block"><msub><mi mathvariant="normal">Φ</mi><mi mathvariant="italic">wl</mi></msub><mo>=</mo><msub><mi>λ</mi><mi>wl</mi></msub><mo>⁢</mo><mfenced open="[" close="]"><mfenced separators=""><mfrac><msub><mi mathvariant="normal">Φ</mi><msub><mi>DD_L</mi><mn>1</mn></msub></msub><msub><mi>λ</mi><mn>1</mn></msub></mfrac><mo>-</mo><mfrac><msub><mi mathvariant="normal">Φ</mi><msub><mi>DD_L</mi><mn>2</mn></msub></msub><msub><mi>λ</mi><mn>2</mn></msub></mfrac></mfenced></mfenced></math><img id="ib0015" file="imgb0015.tif" wi="143" he="15" img-content="math" img-format="tif"/></maths> <maths id="math0016" num=""><math display="block"><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mi mathvariant="italic">wl</mi></msub></msub><mo>=</mo><msup><mfenced><mfrac><msub><mi>λ</mi><mi>wl</mi></msub><msub><mi>λ</mi><mn>1</mn></msub></mfrac></mfenced><mn>2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">C</mi><mrow><msub><mi>DD_L</mi><mn>1</mn></msub><mi>_</mi><mi>m</mi><mo>,</mo><mi>e</mi></mrow></msub><mo>+</mo><msup><mfenced><mfrac><msub><mi>λ</mi><mi>wl</mi></msub><msub><mi>λ</mi><mn>2</mn></msub></mfrac></mfenced><mn>2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">C</mi><mrow><msub><mi>DD_L</mi><mn>2</mn></msub><mi>_</mi><mi>m</mi><mo>,</mo><mi>e</mi></mrow></msub><mo>+</mo><msub><mi mathvariant="normal">C</mi><mrow><msub><mi>DD_L</mi><mn>1</mn></msub><mi>_</mi><mi mathvariant="italic">tropo</mi></mrow></msub><mo>+</mo><msup><mfenced><mfrac><msub><mi>λ</mi><mn>2</mn></msub><msub><mi>λ</mi><mn>1</mn></msub></mfrac></mfenced><mn>2</mn></msup><mo>⁢</mo><msub><mi mathvariant="normal">C</mi><mrow><msub><mi>DD_L</mi><mn>1</mn></msub><mi>_</mi><mi mathvariant="italic">iono</mi></mrow></msub></math><img id="ib0016" file="imgb0016.tif" wi="132" he="14" img-content="math" img-format="tif"/></maths> <maths id="math0017" num=""><math display="block"><msub><mi mathvariant="normal">Φ</mi><mi>wl_flo</mi></msub><mo>=</mo><msub><mi mathvariant="normal">Φ</mi><mi mathvariant="italic">wl</mi></msub><mo>-</mo><msub><mi>λ</mi><mi mathvariant="italic">wl</mi></msub><mo>⁢</mo><msub><mi mathvariant="normal">N</mi><mi>wl_flo</mi></msub></math><img id="ib0017" file="imgb0017.tif" wi="50" he="9" img-content="math" img-format="tif"/></maths> <maths id="math0018" num=""><math display="block"><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mi mathvariant="italic">wl_flo</mi></msub></msub><mo>=</mo><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mi mathvariant="italic">wl</mi></msub></msub><mo>+</mo><msup><msub><mi>λ</mi><mi mathvariant="italic">wl</mi></msub><mn>2</mn></msup><mo>⁢</mo><msub><mi>C</mi><msub><mi>N</mi><mi mathvariant="italic">wl_flo</mi></msub></msub></math><img id="ib0018" file="imgb0018.tif" wi="50" he="9" img-content="math" img-format="tif"/></maths></li><li>WL Fixed :- <maths id="math0019" num="(9)"><math display="block"><msub><mi mathvariant="normal">Φ</mi><mi>wl_fix</mi></msub><mo>=</mo><msub><mi mathvariant="normal">Φ</mi><mi mathvariant="italic">wl</mi></msub><mo>-</mo><msub><mi>λ</mi><mi mathvariant="italic">wl</mi></msub><mo>⁢</mo><msub><mi mathvariant="normal">N</mi><mi>wl_fix</mi></msub></math><img id="ib0019" file="imgb0019.tif" wi="153" he="8" img-content="math" img-format="tif"/></maths> <maths id="math0020" num=""><math display="block"><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mrow><mi mathvariant="italic">wl_</mi><mi mathvariant="italic">fix</mi></mrow></msub></msub><mo>=</mo><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mi mathvariant="italic">wl</mi></msub></msub></math><img id="ib0020" file="imgb0020.tif" wi="29" he="10" img-content="math" img-format="tif"/></maths></li></ul></p><p id="p0029" num="0029">After the calculations are performed by the first computing module 138, first and second functional modules 139 and 140 select measurement data for further processing. The best data are selected based on measurement variance from each of the double difference pair, using the above-defined methods. The orders are: L1 fixed, L2 fixed, L1 float, L2 float, Wide Lane Fixed, Wide Lane Float, and Narrow Lane Code. This way every visible satellite is used in the solution, weighted only by its own relative uncertainty.</p><p id="p0030" num="0030">A third functional module 141 assembles data for a covariance matrix element calculation. The covariance matrix to be used in the solution is more difficult to generate than the other solutions and is done element by element. Diagonal elements for this solution are simply<!-- EPO <DP n="10"> --> taken from the diagonal elements of the double difference covariance matrix, and the measurement type is determined using the equations above. For example, if measurement two were a wide land fixed measurement, the M(2, 2) element would be taken from the WL fixed covariance matrix and placed in the hybrid covariance matrix in the same spot.</p><p id="p0031" num="0031">A fourth functional module 142 performs the covariance matrix element calculation. Off diagonal elements are determined by the relationships between each measurement type. The simplest way to provide the information is to show a complete example and provide the algorithms. For this example the hybrid solution includes each type of measurement in descending order as follows, and each of these measurements is the first measurement in its respective solution type.<br/>
<i>L1_fixed</i><br/>
<i>L2_fixed</i><br/>
<i>L1_float</i><br/>
<i>L2_float</i><br/>
<i>WL_fixed</i><br/>
<i>WL_float</i><br/>
<i>NL_Code</i></p><p id="p0032" num="0032">The covariance matrix is shown by Equation (10): <maths id="math0021" num="(10)"><math display="block"><mfenced open="[" close="]"><mtable><mtr><mtd><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mrow><mn>1</mn><mi mathvariant="italic">_</mi><mi mathvariant="italic">fix</mi></mrow></msub></msub><mfenced separators=""><mn>1</mn><mo>⁢</mo><mn>1</mn></mfenced></mtd><mtd><mi>a</mi></mtd><mtd><mi>c</mi></mtd><mtd><mi>d</mi></mtd><mtd><mi>e</mi></mtd><mtd><mi>e</mi></mtd><mtd><mi>f</mi></mtd></mtr><mtr><mtd><mi>a</mi></mtd><mtd><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mrow><mn>2</mn><mi mathvariant="italic">_</mi><mi mathvariant="italic">fix</mi></mrow></msub></msub><mfenced separators=""><mn>1</mn><mo>⁢</mo><mn>1</mn></mfenced></mtd><mtd><mi>h</mi></mtd><mtd><mi>i</mi></mtd><mtd><mi>j</mi></mtd><mtd><mi>j</mi></mtd><mtd><mi>k</mi></mtd></mtr><mtr><mtd><mi>c</mi></mtd><mtd><mi>h</mi></mtd><mtd><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mrow><mn>1</mn><mi mathvariant="italic">_</mi><mi mathvariant="italic">flo</mi></mrow></msub></msub><mfenced separators=""><mn>1</mn><mo>⁢</mo><mn>1</mn></mfenced></mtd><mtd><mi>m</mi></mtd><mtd><mi>n</mi></mtd><mtd><mi>n</mi></mtd><mtd><mi>o</mi></mtd></mtr><mtr><mtd><mi>d</mi></mtd><mtd><mi>i</mi></mtd><mtd><mi>m</mi></mtd><mtd><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mrow><mn>2</mn><mi mathvariant="italic">_</mi><mi mathvariant="italic">flo</mi></mrow></msub></msub><mfenced separators=""><mn>1</mn><mo>⁢</mo><mn>1</mn></mfenced></mtd><mtd><mi>q</mi></mtd><mtd><mi>q</mi></mtd><mtd><mi>r</mi></mtd></mtr><mtr><mtd><mi>e</mi></mtd><mtd><mi>j</mi></mtd><mtd><mi>n</mi></mtd><mtd><mi>q</mi></mtd><mtd><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mrow><mi mathvariant="italic">WL_</mi><mi mathvariant="italic">fix</mi></mrow></msub></msub><mfenced separators=""><mn>1</mn><mo>⁢</mo><mn>1</mn></mfenced></mtd><mtd><mi>s</mi></mtd><mtd><mi>t</mi></mtd></mtr><mtr><mtd><mi>e</mi></mtd><mtd><mi>j</mi></mtd><mtd><mi>n</mi></mtd><mtd><mi>q</mi></mtd><mtd><mi>s</mi></mtd><mtd><msub><mi>C</mi><msub><mi mathvariant="normal">Φ</mi><mrow><mi mathvariant="italic">WL_</mi><mi mathvariant="italic">flo</mi></mrow></msub></msub><mfenced separators=""><mn>1</mn><mo>⁢</mo><mn>1</mn></mfenced></mtd><mtd><mi>t</mi></mtd></mtr><mtr><mtd><mi>f</mi></mtd><mtd><mi>k</mi></mtd><mtd><mi>o</mi></mtd><mtd><mi>r</mi></mtd><mtd><mi>t</mi></mtd><mtd><mi>t</mi></mtd><mtd><msub><mi>C</mi><msub><mi>R</mi><mi mathvariant="italic">NL</mi></msub></msub><mfenced separators=""><mn>1</mn><mo>⁢</mo><mn>1</mn></mfenced></mtd></mtr></mtable></mfenced></math><img id="ib0021" file="imgb0021.tif" wi="163" he="50" img-content="math" img-format="tif"/></maths> where the elements of matrix calculated by Equations (11) to (32: <maths id="math0022" num="(11)"><math display="block"><mi>a</mi><mo>=</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup><mo>+</mo><mfenced><mfrac><msubsup><mi>λ</mi><mn>2</mn><mn>2</mn></msubsup><msubsup><mi>λ</mi><mn>1</mn><mn>2</mn></msubsup></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_iono_key_sv</mi></mrow><mn>2</mn></msubsup></math><img id="ib0022" file="imgb0022.tif" wi="158" he="15" img-content="math" img-format="tif"/></maths> <maths id="math0023" num="(12)"><math display="block"><mi>b</mi><mo>=</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_</mi><mi>m</mi><mo>,</mo><mi mathvariant="italic">e_key_SV</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_iono__key_sv</mi></mrow><mn>2</mn></msubsup></math><img id="ib0023" file="imgb0023.tif" wi="158" he="10" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="11"> --> <maths id="math0024" num="(13)"><math display="block"><mi>c</mi><mo>=</mo><mfenced separators=""><mn>1</mn><mo>-</mo><mfrac><msub><mi>λ</mi><mn>1</mn></msub><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>-</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_</mi><mi>m</mi><mo>,</mo><mi mathvariant="italic">e_key_SV</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup><mo>+</mo><mfenced><mfrac><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>+</mo><mn>2</mn><mo>⁢</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow><msub><mi>λ</mi><mn>1</mn></msub></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_iono_key_sv</mi></mrow><mn>2</mn></msubsup></math><img id="ib0024" file="imgb0024.tif" wi="159" he="18" img-content="math" img-format="tif"/></maths> <maths id="math0025" num="(14)"><math display="block"><mi>d</mi><mo>=</mo><mo>-</mo><mfenced><mfrac><msub><mi>λ</mi><mn>2</mn></msub><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>-</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_</mi><mi>m</mi><mo>,</mo><mi mathvariant="italic">e_key_SV</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup><mo>+</mo><mfenced><mfrac><mrow><mn>2</mn><mo>⁢</mo><msubsup><mi>λ</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub><mo>⁢</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow><msup><msub><mi>λ</mi><mn>1</mn></msub><mn>2</mn></msup></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_iono_key_sv</mi></mrow><mn>2</mn></msubsup></math><img id="ib0025" file="imgb0025.tif" wi="159" he="18" img-content="math" img-format="tif"/></maths> <maths id="math0026" num="(15)"><math display="block"><mi>e</mi><mo>=</mo><mfenced><mfrac><msub><mi>λ</mi><mi mathvariant="italic">WL</mi></msub><msub><mi>λ</mi><mn>1</mn></msub></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_</mi><mi>m</mi><mo>,</mo><mi mathvariant="italic">e_key_SV</mi></mrow><mn>2</mn></msubsup><mo>-</mo><mfenced><mfrac><msub><mi>λ</mi><mn>2</mn></msub><msub><mi>λ</mi><mn>1</mn></msub></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_</mi><mi mathvariant="italic">iono</mi><mi mathvariant="italic">_key_sv</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup></math><img id="ib0026" file="imgb0026.tif" wi="159" he="16" img-content="math" img-format="tif"/></maths> <maths id="math0027" num="(16)"><math display="block"><mi>f</mi><mo>=</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup><mo>-</mo><mfenced><mfrac><msub><mi>λ</mi><mn>2</mn></msub><msub><mi>λ</mi><mn>1</mn></msub></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_iono_key_sv</mi></mrow><mn>2</mn></msubsup></math><img id="ib0027" file="imgb0027.tif" wi="159" he="16" img-content="math" img-format="tif"/></maths> <maths id="math0028" num="(17)"><math display="block"><mi>g</mi><mo>=</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>2</mn><mi mathvariant="italic">_</mi><mi>m</mi><mo>,</mo><mi mathvariant="italic">e_key_SV</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup><mo>+</mo><mfenced><mfrac><msubsup><mi>λ</mi><mn>2</mn><mn>4</mn></msubsup><msubsup><mi>λ</mi><mn>1</mn><mn>4</mn></msubsup></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_iono_key_sv</mi></mrow><mn>2</mn></msubsup></math><img id="ib0028" file="imgb0028.tif" wi="159" he="16" img-content="math" img-format="tif"/></maths> <maths id="math0029" num="(18)"><math display="block"><mi>h</mi><mo>=</mo><mfenced><mfrac><msub><mi>λ</mi><mn>1</mn></msub><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>-</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>2</mn><mi mathvariant="italic">_</mi><mi>m</mi><mo>,</mo><mi mathvariant="italic">e_key_SV</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup><mo>+</mo><mfenced><mfrac><mrow><msubsup><mi>λ</mi><mn>2</mn><mn>3</mn></msubsup><mo>+</mo><mn>2</mn><mo>⁢</mo><msub><mi>λ</mi><mn>1</mn></msub><mo>⁢</mo><msubsup><mi>λ</mi><mn>2</mn><mn>2</mn></msubsup></mrow><msubsup><mi>λ</mi><mn>1</mn><mn>3</mn></msubsup></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_iono_key_sv</mi></mrow><mn>2</mn></msubsup></math><img id="ib0029" file="imgb0029.tif" wi="159" he="16" img-content="math" img-format="tif"/></maths> <maths id="math0030" num="(19)"><math display="block"><mi>i</mi><mo>=</mo><mfenced separators=""><mn>1</mn><mo>+</mo><mfrac><msub><mi>λ</mi><mn>2</mn></msub><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>-</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>2</mn><mi mathvariant="italic">_</mi><mi>m</mi><mo>,</mo><mi mathvariant="italic">e_key_SV</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup><mo>+</mo><mfenced><mfrac><mrow><mn>2</mn><mo>⁢</mo><msubsup><mi>λ</mi><mn>2</mn><mn>4</mn></msubsup><mo>+</mo><msubsup><mi>λ</mi><mn>2</mn><mn>3</mn></msubsup><mo>⁢</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow><msubsup><mi>λ</mi><mn>1</mn><mn>4</mn></msubsup></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_iono_key_sv</mi></mrow><mn>2</mn></msubsup></math><img id="ib0030" file="imgb0030.tif" wi="159" he="17" img-content="math" img-format="tif"/></maths> <maths id="math0031" num="(20)"><math display="block"><mi>j</mi><mo>=</mo><mo>-</mo><mfenced><mfrac><msub><mi>λ</mi><mi mathvariant="italic">WL</mi></msub><msub><mi>λ</mi><mn>2</mn></msub></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>2</mn><mi mathvariant="italic">_</mi><mi>m</mi><mo>,</mo><mi mathvariant="italic">e_key_SV</mi></mrow><mn>2</mn></msubsup><mo>-</mo><mfenced><mfrac><msubsup><mi>λ</mi><mn>2</mn><mn>3</mn></msubsup><msubsup><mi>λ</mi><mn>1</mn><mn>3</mn></msubsup></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_</mi><mi mathvariant="italic">iono</mi><mi mathvariant="italic">_key_sv</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup></math><img id="ib0031" file="imgb0031.tif" wi="159" he="16" img-content="math" img-format="tif"/></maths> <maths id="math0032" num="(21)"><math display="block"><mi>k</mi><mo>=</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup><mo>-</mo><mfenced><mfrac><msubsup><mi>λ</mi><mn>2</mn><mn>3</mn></msubsup><msubsup><mi>λ</mi><mn>1</mn><mn>3</mn></msubsup></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_iono_key_sv</mi></mrow><mn>2</mn></msubsup></math><img id="ib0032" file="imgb0032.tif" wi="159" he="16" img-content="math" img-format="tif"/></maths> <maths id="math0033" num="(22)"><math display="block"><mi>l</mi><mo>=</mo><msup><mfenced separators=""><mn>1</mn><mo>-</mo><mfrac><msub><mi>λ</mi><mn>1</mn></msub><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>-</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow></mfrac></mfenced><mn>2</mn></msup><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_</mi><mi>m</mi><mo>,</mo><mi mathvariant="italic">e_key_SV</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msup><mfenced><mfrac><msub><mi>λ</mi><mn>1</mn></msub><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>-</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow></mfrac></mfenced><mn>2</mn></msup><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>2</mn><mi mathvariant="italic">_</mi><mi>m</mi><mo>,</mo><mi mathvariant="italic">e_key_SV</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup><mo>+</mo><mfenced><mfrac><mrow><mn>2</mn><mo>⁢</mo><msub><mi>λ</mi><mn>1</mn></msub><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub></mrow><msub><mi>λ</mi><mn>1</mn></msub></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_iono_key_sv</mi></mrow><mn>2</mn></msubsup></math><img id="ib0033" file="imgb0033.tif" wi="159" he="31" img-content="math" img-format="tif"/></maths> <maths id="math0034" num="(23)"><math display="block"><mtable columnalign="left"><mtr><mtd><mi>m</mi><mo>=</mo><mo>-</mo><mfenced separators=""><mn>1</mn><mo>-</mo><mfrac><msub><mi>λ</mi><mn>1</mn></msub><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>-</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow></mfrac></mfenced><mo>⁢</mo><mfenced><mfrac><msub><mi>λ</mi><mn>2</mn></msub><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>-</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_</mi><mi>m</mi><mo>,</mo><mi mathvariant="italic">e_key_SV</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup></mtd></mtr><mtr><mtd><mo>+</mo><mfenced separators=""><mn>1</mn><mo>+</mo><mfrac><msub><mi>λ</mi><mn>2</mn></msub><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>-</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow></mfrac></mfenced><mo>⁢</mo><mfenced><mfrac><msub><mi>λ</mi><mn>1</mn></msub><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>-</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>2</mn><mi mathvariant="italic">_</mi><mi>m</mi><mo>,</mo><mi mathvariant="italic">e_key_SV</mi></mrow><mn>2</mn></msubsup></mtd></mtr><mtr><mtd><mo>+</mo><mfenced><mfrac><mrow><mn>2</mn><mo>⁢</mo><msubsup><mi>λ</mi><mn>2</mn><mn>3</mn></msubsup><mo>+</mo><mn>5</mn><mo>⁢</mo><msubsup><mi>λ</mi><mn>2</mn><mn>2</mn></msubsup><mo>⁢</mo><msub><mi>λ</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><mo>⁢</mo><msubsup><mi>λ</mi><mn>1</mn><mn>2</mn></msubsup><mo>⁢</mo><msub><mi>λ</mi><mn>2</mn></msub></mrow><msubsup><mi>λ</mi><mn>1</mn><mn>3</mn></msubsup></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_iono_key_sv</mi></mrow><mn>2</mn></msubsup></mtd></mtr></mtable></math><img id="ib0034" file="imgb0034.tif" wi="159" he="44" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="12"> --> <maths id="math0035" num="(24)"><math display="block"><mi>n</mi><mo>=</mo><mo>-</mo><mfenced><mfrac><msub><mi>λ</mi><mi mathvariant="italic">WL</mi></msub><msub><mi>λ</mi><mn>2</mn></msub></mfrac></mfenced><mo>*</mo><mfenced><mfrac><msub><mi>λ</mi><mn>1</mn></msub><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>-</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>2</mn><mi mathvariant="italic">_</mi><mi>m</mi><mo>,</mo><mi mathvariant="italic">e_key_SV</mi></mrow><mn>2</mn></msubsup><mo>+</mo><mfenced><mfrac><msub><mi>λ</mi><mi mathvariant="italic">WL</mi></msub><msub><mi>λ</mi><mn>1</mn></msub></mfrac></mfenced><mo>*</mo><mfenced separators=""><mn>1</mn><mo>-</mo><mfrac><msub><mi>λ</mi><mn>1</mn></msub><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>-</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_</mi><mi>m</mi><mo>,</mo><mi mathvariant="italic">e_key_SV</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup><mo>-</mo><mfenced><mfrac><mrow><mn>2</mn><mo>⁢</mo><msub><mi>λ</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>λ</mi><mn>2</mn></msub><mo>+</mo><msubsup><mi>λ</mi><mn>2</mn><mn>2</mn></msubsup></mrow><msubsup><mi>λ</mi><mn>1</mn><mn>2</mn></msubsup></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_iono_key_sv</mi></mrow><mn>2</mn></msubsup></math><img id="ib0035" file="imgb0035.tif" wi="157" he="32" img-content="math" img-format="tif"/></maths> <maths id="math0036" num="(25)"><math display="block"><mi>o</mi><mo>=</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup><mo>-</mo><mfenced><mfrac><mrow><mn>2</mn><mo>⁢</mo><msub><mi>λ</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>λ</mi><mn>2</mn></msub><mo>+</mo><msubsup><mi>λ</mi><mn>2</mn><mn>2</mn></msubsup></mrow><msubsup><mi>λ</mi><mn>1</mn><mn>2</mn></msubsup></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_iono_key_sv</mi></mrow><mn>2</mn></msubsup></math><img id="ib0036" file="imgb0036.tif" wi="158" he="17" img-content="math" img-format="tif"/></maths> <maths id="math0037" num="(26)"><math display="block"><mi>p</mi><mo>=</mo><msup><mfenced><mfrac><msub><mi>λ</mi><mn>2</mn></msub><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>-</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow></mfrac></mfenced><mn>2</mn></msup><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_</mi><mi>m</mi><mo>,</mo><mi mathvariant="italic">e_key_SV</mi></mrow><mn>2</mn></msubsup><mo>+</mo><mfenced separators=""><mn>1</mn><mo>+</mo><mfrac><msub><mi>λ</mi><mn>2</mn></msub><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>-</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>2</mn><mi mathvariant="italic">_</mi><mi>m</mi><mo>,</mo><mi mathvariant="italic">e_key_SV</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup><mo>+</mo><mfenced><mfrac><mrow><mn>2</mn><mo>⁢</mo><msubsup><mi>λ</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub><mo>⁢</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow><msubsup><mi>λ</mi><mn>1</mn><mn>2</mn></msubsup></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_iono_key_sv</mi></mrow><mn>2</mn></msubsup></math><img id="ib0037" file="imgb0037.tif" wi="158" he="32" img-content="math" img-format="tif"/></maths> <maths id="math0038" num="(27)"><math display="block"><mi>q</mi><mo>=</mo><mo>-</mo><mfenced><mfrac><msub><mi>λ</mi><mi mathvariant="italic">WL</mi></msub><msub><mi>λ</mi><mn>1</mn></msub></mfrac></mfenced><mo>*</mo><mfenced><mfrac><msub><mi>λ</mi><mn>2</mn></msub><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>-</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_</mi><mi>m</mi><mo>,</mo><mi mathvariant="italic">e_key_SV</mi></mrow><mn>2</mn></msubsup><mo>-</mo><mfenced><mfrac><msub><mi>λ</mi><mi mathvariant="italic">WL</mi></msub><msub><mi>λ</mi><mn>2</mn></msub></mfrac></mfenced><mo>*</mo><mfenced separators=""><mn>1</mn><mo>+</mo><mfrac><msub><mi>λ</mi><mn>2</mn></msub><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>-</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>2</mn><mi mathvariant="italic">_</mi><mi>m</mi><mo>,</mo><mi mathvariant="italic">e_key_SV</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup><mo>-</mo><mfenced><mfrac><mrow><mn>2</mn><mo>⁢</mo><msubsup><mi>λ</mi><mn>2</mn><mn>3</mn></msubsup><mo>+</mo><msubsup><mi>λ</mi><mn>2</mn><mn>2</mn></msubsup><mo>⁢</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow><msubsup><mi>λ</mi><mn>1</mn><mn>3</mn></msubsup></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_iono_key_sv</mi></mrow><mn>2</mn></msubsup></math><img id="ib0038" file="imgb0038.tif" wi="157" he="30" img-content="math" img-format="tif"/></maths> <maths id="math0039" num="(28)"><math display="block"><mi>r</mi><mo>=</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup><mo>-</mo><mfenced><mfrac><mrow><mn>2</mn><mo>⁢</mo><msubsup><mi>λ</mi><mn>2</mn><mn>3</mn></msubsup><mo>+</mo><msubsup><mi>λ</mi><mn>2</mn><mn>2</mn></msubsup><mo>⁢</mo><msub><mi>λ</mi><mn>1</mn></msub></mrow><msubsup><mi>λ</mi><mn>1</mn><mn>3</mn></msubsup></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_iono_key_sv</mi></mrow><mn>2</mn></msubsup></math><img id="ib0039" file="imgb0039.tif" wi="156" he="17" img-content="math" img-format="tif"/></maths> <maths id="math0040" num="(29)"><math display="block"><mi>s</mi><mo>=</mo><msup><mfenced><mfrac><msub><mi>λ</mi><mi mathvariant="italic">WL</mi></msub><msub><mi>λ</mi><mn>2</mn></msub></mfrac></mfenced><mn>2</mn></msup><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>2</mn><mi mathvariant="italic">_</mi><mi>m</mi><mo>,</mo><mi mathvariant="italic">e_key_SV</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msup><mfenced><mfrac><msub><mi>λ</mi><mi mathvariant="italic">WL</mi></msub><msub><mi>λ</mi><mn>1</mn></msub></mfrac></mfenced><mn>2</mn></msup><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_</mi><mi>m</mi><mo>,</mo><mi mathvariant="italic">e_key_SV</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup><mo>+</mo><mfenced><mfrac><msubsup><mi>λ</mi><mn>2</mn><mn>2</mn></msubsup><msubsup><mi>λ</mi><mn>1</mn><mn>2</mn></msubsup></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_iono_key_sv</mi></mrow><mn>2</mn></msubsup></math><img id="ib0040" file="imgb0040.tif" wi="158" he="31" img-content="math" img-format="tif"/></maths> <maths id="math0041" num="(30)"><math display="block"><mi>t</mi><mo>=</mo><mfenced><mfrac><msubsup><mi>λ</mi><mn>2</mn><mn>2</mn></msubsup><msubsup><mi>λ</mi><mn>1</mn><mn>2</mn></msubsup></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_</mi><mi mathvariant="italic">iono_key_sv</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup></math><img id="ib0041" file="imgb0041.tif" wi="158" he="16" img-content="math" img-format="tif"/></maths> <maths id="math0042" num="(31)"><math display="block"><mi>u</mi><mo>=</mo><mi>s</mi><mo>+</mo><msubsup><mi>λ</mi><mi mathvariant="italic">WL</mi><mn>2</mn></msubsup><mo>*</mo><msub><mi>C</mi><mi mathvariant="italic">mw_SD_fl_key</mi></msub></math><img id="ib0042" file="imgb0042.tif" wi="157" he="15" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="13"> --> <maths id="math0043" num="(32)"><math display="block"><mi>v</mi><mo>=</mo><msup><mfenced><mfrac><msub><mi>λ</mi><mi mathvariant="italic">NL</mi></msub><msub><mi>λ</mi><mn>1</mn></msub></mfrac></mfenced><mn>2</mn></msup><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_</mi><mi>M</mi><mo>,</mo><mi mathvariant="italic">E__key_SV</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msup><mfenced><mfrac><msub><mi>λ</mi><mi mathvariant="italic">NL</mi></msub><msub><mi>λ</mi><mn>2</mn></msub></mfrac></mfenced><mn>2</mn></msup><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>2</mn><mi mathvariant="italic">_</mi><mi>M</mi><mo>,</mo><mi mathvariant="italic">E__key_SV</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mi mathvariant="italic">AB_tropo_key_sv</mi><mn>2</mn></msubsup><mo>+</mo><mfenced><mfrac><msubsup><mi>λ</mi><mn>2</mn><mn>2</mn></msubsup><msubsup><mi>λ</mi><mn>1</mn><mn>2</mn></msubsup></mfrac></mfenced><mo>*</mo><msubsup><mi>σ</mi><mrow><mi mathvariant="italic">AB_</mi><mi mathvariant="italic">L</mi><mo>⁢</mo><mn>1</mn><mi mathvariant="italic">_iono__key_sv</mi></mrow><mn>2</mn></msubsup></math><img id="ib0043" file="imgb0043.tif" wi="158" he="32" img-content="math" img-format="tif"/></maths></p><p id="p0033" num="0033">The cases not covered in the example are the relationships between common solutions. In these cases the following applies:
<ul><li>L1_fixed to L1_fixed is equivalent to <i>b</i>;</li><li>L2_fixed to L2_fixed is equivalent to <i>g</i>;</li><li>L1_float to L1_float is equivalent to <i>l</i>;</li><li>L2 float to L2_float is equivalent to <i>p</i>;</li><li>WL_fixed to WL fixed is equivalent to <i>s</i>;</li><li>WL_float to WL_float is equivalent to <i>u</i>; and</li><li>NL code to NL code is equivalent to <i>v</i>;</li></ul></p><p id="p0034" num="0034">A fifth functional module 143 calculates a Relative Position Solution using the Weighted Least Squares Method. The measurements should include every satellite, using the most accurate (smallest variance) measurement available for that satellite. The calculations executed by different steps of the WLS algorithm are shown below. The initialization is performed once at the start of a filter. All other steps are iterated (2 or 3 times) until a solution converges.</p><p id="p0035" num="0035">Step initializes the baseline vector b (at start of the filter) by Equation (33) <maths id="math0044" num="(33)"><math display="block"><msubsup><mi>x</mi><mi>k</mi><mo>-</mo></msubsup><mo>=</mo><mn>0</mn></math><img id="ib0044" file="imgb0044.tif" wi="156" he="13" img-content="math" img-format="tif"/></maths></p><p id="p0036" num="0036">Step 2 calculates Measurements and Covariance by Equations (34), (35) and (36): <maths id="math0045" num="(34)"><math display="block"><mi>Z</mi><mo>=</mo><msub><mi>Z</mi><mi mathvariant="italic">Hybrid</mi></msub></math><img id="ib0045" file="imgb0045.tif" wi="157" he="10" img-content="math" img-format="tif"/></maths> <maths id="math0046" num="(35)"><math display="block"><msub><mi>C</mi><mi>z</mi></msub><mo>=</mo><msub><mi mathvariant="normal">Σ</mi><mi mathvariant="italic">Hybrid</mi></msub></math><img id="ib0046" file="imgb0046.tif" wi="159" he="11" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="14"> --> <maths id="math0047" num="(36)"><math display="block"><mi mathvariant="normal">W</mi><mo>=</mo><msubsup><mi mathvariant="normal">C</mi><mi mathvariant="normal">z</mi><mrow><mo>-</mo><mn mathvariant="normal">1</mn></mrow></msubsup></math><img id="ib0047" file="imgb0047.tif" wi="158" he="10" img-content="math" img-format="tif"/></maths></p><p id="p0037" num="0037">Step 3 calculates LOS (Line of Sight) vectors from Ship and Aircraft to Satellite j by Equations (37)-(42):
<ul><li>In the equations, satellite position {x<sup>s</sup>,y<sup>s</sup>,z<sup>s</sup>} is from ephemeris and ship position{x<sub>A</sub>,y<sub>A</sub>,z<sub>A</sub>} is from an absolute position solution.</li><li>LOS Vectors: <maths id="math0048" num="(37)"><math display="block"><mi>Ship</mi><mspace width="1em"/><mfenced><mi mathvariant="normal">A</mi></mfenced><mspace width="1em"/><mi>to satellite j</mi><mspace width="2em"/><mi>as</mi><mfenced><mi mathvariant="normal">j</mi></mfenced><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><msup><mi mathvariant="normal">x</mi><mi mathvariant="normal">s</mi></msup><mfenced><mi mathvariant="normal">j</mi></mfenced><mo>-</mo><msub><mi mathvariant="normal">x</mi><mi mathvariant="normal">A</mi></msub></mtd></mtr><mtr><mtd><msup><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></msup><mfenced><mi mathvariant="normal">j</mi></mfenced><mo>-</mo><msub><mi mathvariant="normal">y</mi><mi mathvariant="normal">A</mi></msub></mtd></mtr><mtr><mtd><msup><mi mathvariant="normal">z</mi><mi mathvariant="normal">s</mi></msup><mfenced><mi mathvariant="normal">j</mi></mfenced><mo>-</mo><msub><mi mathvariant="normal">z</mi><mi mathvariant="normal">A</mi></msub></mtd></mtr></mtable></mfenced></math><img id="ib0048" file="imgb0048.tif" wi="157" he="24" img-content="math" img-format="tif"/></maths> <maths id="math0049" num="(38)"><math display="block"><mi>Aircraft</mi><mspace width="1em"/><mfenced><mi mathvariant="normal">B</mi></mfenced><mspace width="1em"/><mi>to satellite j bs</mi><mfenced><mi mathvariant="normal">j</mi></mfenced><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><msup><mi mathvariant="normal">x</mi><mi mathvariant="normal">s</mi></msup><mfenced><mi mathvariant="normal">j</mi></mfenced><mo>-</mo><msub><mi mathvariant="normal">x</mi><mi mathvariant="normal">B</mi></msub></mtd></mtr><mtr><mtd><msup><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></msup><mfenced><mi mathvariant="normal">j</mi></mfenced><mo>-</mo><msub><mi mathvariant="normal">y</mi><mi mathvariant="normal">B</mi></msub></mtd></mtr><mtr><mtd><msup><mi mathvariant="normal">z</mi><mi mathvariant="normal">s</mi></msup><mfenced><mi mathvariant="normal">j</mi></mfenced><mo>-</mo><msub><mi mathvariant="normal">z</mi><mi mathvariant="normal">B</mi></msub></mtd></mtr></mtable></mfenced><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><msup><mi mathvariant="normal">x</mi><mi mathvariant="normal">s</mi></msup><mfenced><mi mathvariant="normal">j</mi></mfenced><mo>-</mo><mfenced separators=""><msub><mi mathvariant="normal">x</mi><mi mathvariant="normal">A</mi></msub><mo>+</mo><msub><mover><mi mathvariant="normal">b</mi><mo>^</mo></mover><mi mathvariant="normal">x</mi></msub></mfenced></mtd></mtr><mtr><mtd><msup><mi mathvariant="normal">y</mi><mi mathvariant="normal">s</mi></msup><mfenced><mi mathvariant="normal">j</mi></mfenced><mo>-</mo><mfenced separators=""><msub><mi mathvariant="normal">y</mi><mi mathvariant="normal">A</mi></msub><mo>+</mo><msub><mover><mi mathvariant="normal">b</mi><mo>^</mo></mover><mi mathvariant="normal">y</mi></msub></mfenced></mtd></mtr><mtr><mtd><msup><mi mathvariant="normal">z</mi><mi mathvariant="normal">s</mi></msup><mfenced><mi mathvariant="normal">j</mi></mfenced><mo>-</mo><mfenced separators=""><msub><mi mathvariant="normal">z</mi><mi mathvariant="normal">A</mi></msub><mo>+</mo><msub><mover><mi mathvariant="normal">b</mi><mo>^</mo></mover><mi mathvariant="normal">z</mi></msub></mfenced></mtd></mtr></mtable></mfenced></math><img id="ib0049" file="imgb0049.tif" wi="157" he="26" img-content="math" img-format="tif"/></maths></li></ul>
Magnitudes of LOS vectors: <maths id="math0050" num="(39)"><math display="block"><mi>as_mag</mi><mfenced><mi mathvariant="normal">j</mi></mfenced><mo>=</mo><mo>‖</mo><mi>as</mi><mfenced><mi mathvariant="normal">j</mi></mfenced><mo>‖</mo><mo>;</mo></math><img id="ib0050" file="imgb0050.tif" wi="130" he="10" img-content="math" img-format="tif"/></maths> <maths id="math0051" num="(40)"><math display="block"><mi>bs_mag</mi><mfenced><mi mathvariant="normal">j</mi></mfenced><mo>=</mo><mo>‖</mo><mi>bs</mi><mfenced><mi mathvariant="normal">j</mi></mfenced><mo>‖</mo></math><img id="ib0051" file="imgb0051.tif" wi="130" he="10" img-content="math" img-format="tif"/></maths><br/>
Predicted SD Measurement (as-bs) <maths id="math0052" num="(41)"><math display="block"><mi>dab</mi><mfenced><mi mathvariant="normal">j</mi></mfenced><mo>=</mo><mi>as_mag</mi><mfenced><mi mathvariant="normal">j</mi></mfenced><mo>-</mo><mi>bs_mag</mi><mfenced><mi mathvariant="normal">j</mi></mfenced><mo>;</mo></math><img id="ib0052" file="imgb0052.tif" wi="154" he="8" img-content="math" img-format="tif"/></maths><br/>
Predicted DD Measurements <maths id="math0053" num="(42)"><math display="block"><msubsup><mi mathvariant="normal">Z</mi><mi mathvariant="normal">k</mi><mo>-</mo></msubsup><mo>=</mo><mfenced open="[" close="]"><mtable columnalign="left"><mtr><mtd><mi>dab</mi><mfenced><mn>1</mn></mfenced><mo>-</mo><mi>dab</mi><mfenced><mn>2</mn></mfenced></mtd></mtr><mtr><mtd><mi>dab</mi><mfenced><mn>1</mn></mfenced><mo>-</mo><mi>dab</mi><mfenced><mn>3</mn></mfenced></mtd></mtr><mtr><mtd><mo>•</mo></mtd></mtr><mtr><mtd><mi>dab</mi><mfenced><mn>1</mn></mfenced><mo>-</mo><mi>dab</mi><mfenced><mi mathvariant="normal">K</mi></mfenced></mtd></mtr></mtable></mfenced></math><img id="ib0053" file="imgb0053.tif" wi="156" he="28" img-content="math" img-format="tif"/></maths><br/>
using satellite 1 (highest) as reference</p><p id="p0038" num="0038">Step 4 performs Linearization by evaluating Equations (43)- (45):<!-- EPO <DP n="15"> -->
<ul><li>Unit LOS Vectors from Aircraft to Satellite j: <maths id="math0054" num="(43)"><math display="block"><mfenced open="[" close="]"><mtable><mtr><mtd><msub><mn mathvariant="normal">1</mn><mi mathvariant="normal">x</mi></msub><mfenced><mi mathvariant="normal">j</mi></mfenced></mtd></mtr><mtr><mtd><msub><mn mathvariant="normal">1</mn><mi mathvariant="normal">y</mi></msub><mfenced><mi mathvariant="normal">j</mi></mfenced></mtd></mtr><mtr><mtd><msub><mn mathvariant="normal">1</mn><mi mathvariant="normal">z</mi></msub><mfenced><mi mathvariant="normal">j</mi></mfenced></mtd></mtr></mtable></mfenced><mo>=</mo><mi>bs</mi><mfenced><mi mathvariant="normal">j</mi></mfenced><mo>/</mo><mi>bs_mag</mi><mfenced><mi mathvariant="normal">j</mi></mfenced></math><img id="ib0054" file="imgb0054.tif" wi="158" he="25" img-content="math" img-format="tif"/></maths></li><li>Differences of unit vectors <maths id="math0055" num="(44)"><math display="block"><mtable><mtr><mtd><mtable><mtr><mtd><msub><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi></msub><mfenced separators=""><mn mathvariant="normal">1</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mfenced><mo>=</mo><msub><mn mathvariant="normal">1</mn><mi mathvariant="normal">x</mi></msub><mfenced><mn mathvariant="normal">1</mn></mfenced><mo>-</mo><msub><mn mathvariant="normal">1</mn><mi mathvariant="normal">x</mi></msub><mfenced><mi mathvariant="normal">j</mi></mfenced></mtd></mtr><mtr><mtd><msub><mi mathvariant="normal">e</mi><mi mathvariant="normal">y</mi></msub><mfenced separators=""><mn mathvariant="normal">1</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mfenced><mo>=</mo><msub><mn mathvariant="normal">1</mn><mi mathvariant="normal">y</mi></msub><mfenced><mn mathvariant="normal">1</mn></mfenced><mo>-</mo><msub><mn mathvariant="normal">1</mn><mi mathvariant="normal">y</mi></msub><mfenced><mi mathvariant="normal">j</mi></mfenced></mtd></mtr></mtable></mtd></mtr><mtr><mtd><msub><mi mathvariant="normal">e</mi><mi mathvariant="normal">z</mi></msub><mfenced separators=""><mn mathvariant="normal">1</mn><mo>⁢</mo><mi mathvariant="normal">j</mi></mfenced><mo>=</mo><msub><mn mathvariant="normal">1</mn><mi mathvariant="normal">z</mi></msub><mfenced><mn mathvariant="normal">1</mn></mfenced><mo>-</mo><msub><mn mathvariant="normal">1</mn><mi mathvariant="normal">z</mi></msub><mfenced><mi mathvariant="normal">j</mi></mfenced></mtd></mtr></mtable></math><img id="ib0055" file="imgb0055.tif" wi="157" he="22" img-content="math" img-format="tif"/></maths></li><li>H Matrix (matrix formed by differenced unit vectors) <maths id="math0056" num="(45)"><math display="block"><mi mathvariant="normal">H</mi><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><msub><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi></msub><mfenced separators=""><mn mathvariant="normal">1</mn><mo>⁢</mo><mn mathvariant="normal">2</mn></mfenced></mtd><mtd><msub><mi mathvariant="normal">e</mi><mi mathvariant="normal">y</mi></msub><mfenced separators=""><mn mathvariant="normal">1</mn><mo>⁢</mo><mn mathvariant="normal">2</mn></mfenced></mtd><mtd><msub><mi mathvariant="normal">e</mi><mi mathvariant="normal">z</mi></msub><mfenced separators=""><mn mathvariant="normal">1</mn><mo>⁢</mo><mn mathvariant="normal">2</mn></mfenced></mtd></mtr><mtr><mtd><msub><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi></msub><mfenced separators=""><mn mathvariant="normal">1</mn><mo>⁢</mo><mn mathvariant="normal">3</mn></mfenced></mtd><mtd><msub><mi mathvariant="normal">e</mi><mi mathvariant="normal">y</mi></msub><mfenced separators=""><mn mathvariant="normal">1</mn><mo>⁢</mo><mn mathvariant="normal">3</mn></mfenced></mtd><mtd><msub><mi mathvariant="normal">e</mi><mi mathvariant="normal">z</mi></msub><mfenced separators=""><mn mathvariant="normal">1</mn><mo>⁢</mo><mn mathvariant="normal">3</mn></mfenced></mtd></mtr><mtr><mtd><mo>•</mo></mtd><mtd><mo>•</mo></mtd><mtd><mo>•</mo></mtd></mtr><mtr><mtd><mo>•</mo></mtd><mtd><mo>•</mo></mtd><mtd><mo>•</mo></mtd></mtr><mtr><mtd><mo>•</mo></mtd><mtd><mo>•</mo></mtd><mtd><mo>•</mo></mtd></mtr></mtable></mfenced></math><img id="ib0056" file="imgb0056.tif" wi="159" he="35" img-content="math" img-format="tif"/></maths></li></ul></p><p id="p0039" num="0039">Steps 5 computes the Weighted Least Square Relative Position solution by Equations (46)-(49):
<ul><li>Filter Observable: <maths id="math0057" num="(46)"><math display="block"><mi mathvariant="normal">ΔZ</mi><mo>=</mo><mfenced open="[" close="]" separators=""><msub><mi mathvariant="normal">Z</mi><mi mathvariant="normal">k</mi></msub><mo>-</mo><msubsup><mi mathvariant="normal">Z</mi><mi mathvariant="normal">k</mi><mo>-</mo></msubsup></mfenced></math><img id="ib0057" file="imgb0057.tif" wi="157" he="9" img-content="math" img-format="tif"/></maths></li><li>WLS Solution and Solution Covariance: <maths id="math0058" num="(47)"><math display="block"><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mover><mi>x</mi><mo>^</mo></mover><mo>=</mo><msup><mfenced open="[" close="]" separators=""><msup><mi mathvariant="normal">H</mi><mi mathvariant="normal">T</mi></msup><mo>⁢</mo><mi>WH</mi></mfenced><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><msup><mi mathvariant="normal">H</mi><mi mathvariant="normal">T</mi></msup><mo>⁢</mo><mi>W ΔZ</mi></math><img id="ib0058" file="imgb0058.tif" wi="158" he="11" img-content="math" img-format="tif"/></maths> <maths id="math0059" num="(48)"><math display="block"><msubsup><mover><mi mathvariant="normal">x</mi><mo>^</mo></mover><mi mathvariant="normal">k</mi><mo>+</mo></msubsup><mo>=</mo><msubsup><mover><mi mathvariant="normal">x</mi><mo>^</mo></mover><mi mathvariant="normal">k</mi><mo>-</mo></msubsup><mo>+</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mover><mi mathvariant="normal">x</mi><mo>^</mo></mover></math><img id="ib0059" file="imgb0059.tif" wi="158" he="9" img-content="math" img-format="tif"/></maths> <maths id="math0060" num="(49)"><math display="block"><mstyle displaystyle="false"><munder><mo>∑</mo><mover><mi>x</mi><mo>^</mo></mover></munder><mo>=</mo></mstyle><msup><mfenced open="[" close="]" separators=""><msup><mi mathvariant="normal">H</mi><mi mathvariant="normal">T</mi></msup><mspace width="1em"/><mi>WH</mi></mfenced><mrow><mo>-</mo><mn>1</mn></mrow></msup></math><img id="ib0060" file="imgb0060.tif" wi="158" he="13" img-content="math" img-format="tif"/></maths></li></ul><!-- EPO <DP n="16"> --></p><p id="p0040" num="0040">The solution is arrived at by transforming each Relative Position Solution and its Covariance from WGS-84 to NED coordinates (north-east-down coordinates at ship reference point).</p><p id="p0041" num="0041">The final output from the process includes the following data:
<ul><li>Hybrid Relative Position NED</li><li>Covariance of Hybrid Relative Position</li></ul></p></description><claims mxw-id="PCLM56977964" lang="DE" load-source="patent-office"><!-- EPO <DP n="19"> --><claim id="c-de-01-0001" num="0001"><claim-text>Verfahren zum Berechnen einer relativen Vektorlösung zwischen einem Ort eines sich bewegenden Flugzeugs und einem Referenzempfänger, umfassend:
<claim-text>das Empfangen von Signalen des Global-Positioning-Systems, GPS, von mehreren GPS-Satelliten (104) in dem sich bewegenden Flugzeug (102) und an dem Referenzempfänger (106);</claim-text>
<claim-text>das Berechnen von Positions-, Geschwindigkeits- und geschätzten Phasenmehrdeutigkeits-Daten in breiten Flugschneisen am Referenzempfänger (106);</claim-text>
<claim-text>das Übertragen der berechneten Daten von dem Referenzempfänger (106) an das sich bewegende Flugzeug (102); und</claim-text>
<claim-text>das Berechnen, im sich bewegenden Flugzeug (102), der relativen Vektorlösung zwischen dem Ort des sich bewegenden Flugzeugs (102) und dem Referenzempfänger (106) durch das Verschmelzen von GPS-gestützten Messdaten und der berechneten Daten, die von dem Referenzempfänger (106) empfangen wurden, mit einem Algorithmus der gewichteten kleinsten Fehlerquadrate, WLS, wobei das Berechnen das Wählen der GPS-gestützten Messdaten umfasst, die für jeden der GPS-Satelliten die geringste Varianz haben, das Berechnen einer Gewichtungs-Kovarianzmatrix für die gewählten Daten, und das Verschmelzen der gewählten Daten in dem WLS-Algorithmus unter Verwendung der berechneten Kovarianzmatrix.</claim-text></claim-text></claim><claim id="c-de-01-0002" num="0002"><claim-text>Landesystem für ein sich bewegendes Flugzeug (102), umfassend:
<claim-text>in einem Referenzempfänger (106) Mittel zum Berechnen und Übertragen von Positions-, Geschwindigkeits- und geschätzten Phasenmehrdeutigkeits-Daten in breiten Flugschneisen am Referenzempfänger, wobei die Daten mit Hilfe von Signalen des Global-Positioning-Systems, GPS, berechnet werden, die der Referenzempfänger (106) von mehreren GPS-Satelliten (104) empfängt;</claim-text>
<claim-text>einen Empfänger (112, 119) in dem sich bewegenden Flugzeug (102), der dafür betreibbar ist, GPS-Signale von den GPS-Satelliten (104) und die berechneten Daten von dem Referenzempfänger (106) zu empfangen; und</claim-text>
<claim-text>ein Berechnungssystem (116), das dem Empfänger in dem sich bewegenden Flugzeug (102) zugeordnet ist, und das dafür betreibbar ist, eine relative Vektorlösung zwischen dem Ort des sich bewegenden Flugzeugs (102) und dem Referenzempfänger (106) zu berechnen, und zwar durch das Verschmelzen der GPS-gestützten<!-- EPO <DP n="20"> --> Messdaten und der berechneten Daten, die von dem Referenzempfänger (106) empfangen wurden, mit einem Algorithmus der gewichteten kleinsten Fehlerquadrate, WLS, wobei das Berechnen das Wählen der GPS-gestützten Messdaten umfasst, die für jeden der GPS-Satelliten die geringste Varianz haben, das Berechnen einer Gewichtungs-Kovarianzmatrix für die gewählten Daten, und das Verschmelzen der gewählten Daten in dem WLS-Algorithmus unter Verwendung der berechneten Kovarianzmatrix.</claim-text></claim-text></claim><claim id="c-de-01-0003" num="0003"><claim-text>Landesystem nach Anspruch 2, wobei der Referenzempfänger (106) ein Relative-Navigation-System, RelNav, aufweist, das dazu betreibbar ist, eine relative Position und einen Geschwindigkeitsvektor zwischen dem Referenzempfänger (106) und dem sich bewegenden Flugzeug (102) zu berechnen.</claim-text></claim></claims><claims mxw-id="PCLM56977965" lang="EN" load-source="patent-office"><!-- EPO <DP n="17"> --><claim id="c-en-01-0001" num="0001"><claim-text>A method of calculating a relative vector solution between a location of a moving craft and a reference receiver, comprising:
<claim-text>receiving Global Positioning System, GPS, signals from a plurality of GPS satellites (104) at the moving craft (102) and at the reference receiver (106);</claim-text>
<claim-text>computing position, velocity, and estimated wide lane phase ambiguity data at the reference receiver (106);</claim-text>
<claim-text>transmitting the computed data from the reference receiver (106) to the moving craft (102); and</claim-text>
<claim-text>calculating, at the moving craft (102), the relative vector solution between the location of the moving craft (102) and the reference receiver (106) by fusing GPS-based measurement data and the computed data received from the reference receiver (106) with a weighted least squares, WLS, algorithm, the calculating comprising selecting the GPS-based measurement data having the lowest variance for each of the plurality of GPS satellites, calculating a weighting covariance matrix for the selected data, and fusing the selected data in the WLS algorithm utilizing the calculated covariance matrix.</claim-text></claim-text></claim><claim id="c-en-01-0002" num="0002"><claim-text>A landing system for a moving craft (102), comprising:
<claim-text>means at a reference receiver (106) for computing and transmitting reference receiver position, velocity, and estimated wide lane phase ambiguity data, the data computed using Global Positioning System, GPS, signals received by the reference receiver (106) from a plurality of GPS satellites (104);</claim-text>
<claim-text>a receiver (112, 119) on the moving craft (102) that is operable to receive GPS signals from the plurality of GPS satellites (104) and the computed data from the reference receiver (106); and</claim-text>
<claim-text>a calculating system (116) associated with the receiver on the moving craft (102) that is operable to calculate a relative vector solution between the location of the moving craft (102) and the reference receiver (106) by fusing the GPS-based measurement data and the computed data received from the reference receiver (106) with a weighted least squares, WLS, algorithm, the calculation comprising selecting the GPS-based measurement data having the lowest variance for each of the plurality of GPS satellites, calculating a weighting covariance matrix for the selected data, and fusing the selected data in the WLS algorithm utilizing the calculated covariance matrix.</claim-text><!-- EPO <DP n="18"> --></claim-text></claim><claim id="c-en-01-0003" num="0003"><claim-text>The landing system of claim 2, wherein the reference receiver (106) has a Relative Navigation, RelNav, system operable to calculate a relative position and a velocity vector between the reference receiver (106) and the moving craft (102).</claim-text></claim></claims><claims mxw-id="PCLM56977966" lang="FR" load-source="patent-office"><!-- EPO <DP n="21"> --><claim id="c-fr-01-0001" num="0001"><claim-text>Procédé de calcul d'une solution de vecteur relatif entre un emplacement d'un engin mobile et d'un récepteur de référence, comprenant :
<claim-text>la réception de signaux d'un Système de Positionnement Global, GPS, d'une pluralité de satellites GPS (104) à l'engin mobile (102) et au récepteur de référence (106) ;</claim-text>
<claim-text>le calcul de la position, de la vitesse et de données d'ambiguïté de phase de couloir large estimées au récepteur de référence (106) ;</claim-text>
<claim-text>la transmission des données calculées du récepteur de référence (106) à l'engin mobile (102) ; et</claim-text>
<claim-text>le calcul, à l'engin mobile (102), de la solution de vecteur relatif entre l'emplacement de l'engin mobile (102) et le récepteur de référence (106) par la fusion de données de mesure à base de GPS et des données calculées reçues du récepteur de référence (106) avec un algorithme des moindres carrés pondérés, WLS, le calcul comprenant la sélection des données de mesure à base de GPS ayant la variance la plus basse pour chacun de la pluralité de satellites GPS, le calcul d'un matrice de covariance de pondération pour les données sélectionnées, et la fusion des données sélectionnées dans l'algorithme WLS en utilisant la matrice de covariance calculée.</claim-text></claim-text></claim><claim id="c-fr-01-0002" num="0002"><claim-text>Système d'atterrissage pour un engin mobile (102), comprenant :
<claim-text>des moyens à un récepteur de référence (106) pour calculer et transmettre la position de récepteur de référence, la vitesse et des données d'ambiguïté de phase de couloir large estimées, les données calculées en utilisant les signaux du Système de Positionnement Global, GPS, reçus par le récepteur de référence (106) d'une pluralité de satellites GPS (104) ;</claim-text>
<claim-text>un récepteur (112, 119) sur l'engin mobile (102) qui est apte à recevoir des signaux GPS de la pluralité de<!-- EPO <DP n="22"> --> satellites GPS (104) et les données calculées du récepteur de référence (106) ; et</claim-text>
<claim-text>un système de calcul (116) associé au récepteur sur l'engin mobile (102) qui est apte à calculer une solution de vecteur relatif entre l'emplacement de l'engin mobile (102) et le récepteur de référence (106) en fusionnant les données de mesure à base du GPS et les données calculées reçues du récepteur de référence (106) avec un algorithme des moindres carrés pondérés, WLS, le calcul comprenant la sélection des données de mesure basées sur le GPS ayant la variance la plus basse pour chacun de la pluralité de satellites GPS, le calcul d'une matrice de covariance de pondération pour les données sélectionnées, et la fusion des données sélectionnées dans l'algorithme WLS en utilisant la matrice de covariance calculée.</claim-text></claim-text></claim><claim id="c-fr-01-0003" num="0003"><claim-text>Système d'atterrissage selon la revendication 2, dans lequel le récepteur de référence (106) comporte un système de Navigation Relative, RelNav, apte à calculer une position relative et un vecteur de vitesse entre le récepteur de référence (106) et l'engin mobile (102).</claim-text></claim></claims><drawings mxw-id="PDW16668442" load-source="patent-office"><!-- EPO <DP n="23"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="131" he="183" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="24"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="131" he="195" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="25"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="153" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="26"> --><figure id="f0004" num="4"><img id="if0004" file="imgf0004.tif" wi="165" he="219" img-content="drawing" img-format="tif"/></figure></drawings><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
