<?xml version="1.0" encoding="UTF-8"?>
<patent-document ucid="EP-2502091-B1" country="EP" doc-number="2502091" kind="B1" date="20140101" family-id="44010937" file-reference-id="315059" date-produced="20180823" status="corrected" lang="EN"><bibliographic-data><publication-reference fvid="146552336" ucid="EP-2502091-B1"><document-id><country>EP</country><doc-number>2502091</doc-number><kind>B1</kind><date>20140101</date><lang>EN</lang></document-id></publication-reference><application-reference ucid="EP-10801266-A" is-representative="NO"><document-id mxw-id="PAPP154826259" load-source="docdb" format="epo"><country>EP</country><doc-number>10801266</doc-number><kind>A</kind><date>20101110</date><lang>EN</lang></document-id><document-id mxw-id="PAPP223316810" load-source="docdb" format="original"><country>EP</country><doc-number>10801266.7</doc-number><date>20101110</date></document-id></application-reference><priority-claims><priority-claim mxw-id="PPC140454381" ucid="IB-2010002883-W" linkage-type="W" load-source="docdb"><document-id format="epo"><country>IB</country><doc-number>2010002883</doc-number><kind>W</kind><date>20101110</date></document-id></priority-claim><priority-claim mxw-id="PPC140446475" ucid="US-26177209-P" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>26177209</doc-number><kind>P</kind><date>20091117</date></document-id></priority-claim><priority-claim mxw-id="PPC140447625" ucid="US-94310210-A" load-source="docdb"><document-id format="epo"><country>US</country><doc-number>94310210</doc-number><kind>A</kind><date>20101110</date></document-id></priority-claim></priority-claims><dates-of-public-availability><intention-to-grant-date><date>20130712</date></intention-to-grant-date></dates-of-public-availability><technical-data><classifications-ipcr><classification-ipcr mxw-id="PCL1988120150" load-source="docdb">G01S  19/20        20100101ALI20110607BHEP        </classification-ipcr><classification-ipcr mxw-id="PCL1988128632" load-source="docdb">G01S  19/44        20100101AFI20110607BHEP        </classification-ipcr></classifications-ipcr><classifications-cpc><classification-cpc mxw-id="PCL-1697568277" load-source="docdb" scheme="CPC">G01S  19/44        20130101 LI20180216BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1697568278" load-source="docdb" scheme="CPC">G01S  19/20        20130101 LI20180216BHEP        </classification-cpc><classification-cpc mxw-id="PCL-1744180325" load-source="docdb" scheme="CPC">G01S  19/43        20130101 FI20171018BHEP        </classification-cpc></classifications-cpc><invention-title mxw-id="PT132189492" lang="DE" load-source="patent-office">NACHWEIS UND KORREKTUR VON ANOMALEN MESSUNGEN UND MEHRDEUTIGKEITSAUFLÖSUNG BEI EINEM EMPFÄNGER EINES GLOBALEN NAVIGATIONSSATELLITENSYSTEMS</invention-title><invention-title mxw-id="PT132189493" lang="EN" load-source="patent-office">DETECTION AND CORRECTION OF ANOMALOUS MEASUREMENTS AND AMBIGUITY RESOLUTION IN A GLOBAL NAVIGATION SATELLITE SYSTEM RECEIVER</invention-title><invention-title mxw-id="PT132189494" lang="FR" load-source="patent-office">DÉTECTION ET CORRECTION DE MESURES ANORMALES ET RÉSOLUTION D'AMBIGUÏTÉ DANS RÉCEPTEUR DE GÉOLOCALISATION ET NAVIGATION PAR SYSTÈME DE SATELLITES</invention-title></technical-data><parties><applicants><applicant mxw-id="PPAR918162201" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>TOPCON POSITIONING SYSTEMS INC</last-name><address><country>US</country></address></addressbook></applicant><applicant mxw-id="PPAR918132536" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>TOPCON POSITIONING SYSTEMS, INC.</last-name></addressbook></applicant></applicants><inventors><inventor mxw-id="PPAR918156645" load-source="docdb" sequence="1" format="epo"><addressbook><last-name>MILYUTIN DANIEL</last-name><address><country>RU</country></address></addressbook></inventor><inventor mxw-id="PPAR918145605" load-source="docdb" sequence="1" format="intermediate"><addressbook><last-name>MILYUTIN, DANIEL</last-name></addressbook></inventor><inventor mxw-id="PPAR918994861" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>MILYUTIN, DANIEL</last-name><address><street>Ap. 286 Bld. 32 Korneychuk Street</street><city>Moscow 127543</city><country>RU</country></address></addressbook></inventor><inventor mxw-id="PPAR918161398" load-source="docdb" sequence="2" format="epo"><addressbook><last-name>PLENKIN ANDREY</last-name><address><country>RU</country></address></addressbook></inventor><inventor mxw-id="PPAR918168889" load-source="docdb" sequence="2" format="intermediate"><addressbook><last-name>PLENKIN, ANDREY</last-name></addressbook></inventor><inventor mxw-id="PPAR918994862" load-source="patent-office" sequence="2" format="original"><addressbook><last-name>PLENKIN, ANDREY</last-name><address><street>Ap. 73 Bld. 15/3 Lenin Street</street><city>Kashira 142903</city><country>RU</country></address></addressbook></inventor></inventors><assignees><assignee mxw-id="PPAR918994863" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Topcon Positioning Systems, Inc.</last-name><iid>101249944</iid><address><street>7400 National Drive</street><city>Livermore CA 94551</city><country>US</country></address></addressbook></assignee></assignees><agents><agent mxw-id="PPAR918994860" load-source="patent-office" sequence="1" format="original"><addressbook><last-name>Kuhnen &amp; Wacker</last-name><iid>101158360</iid><address><street>Patent- und Rechtsanwaltsbüro Prinz-Ludwig-Strasse 40A</street><city>85354 Freising</city><country>DE</country></address></addressbook></agent></agents></parties><international-convention-data><pct-or-regional-filing-data ucid="IB-2010002883-W"><document-id><country>IB</country><doc-number>2010002883</doc-number><kind>W</kind><date>20101110</date><lang>EN</lang></document-id></pct-or-regional-filing-data><pct-or-regional-publishing-data ucid="WO-2011061587-A2"><document-id><country>WO</country><doc-number>2011061587</doc-number><kind>A2</kind><date>20110526</date><lang>EN</lang></document-id></pct-or-regional-publishing-data><designated-states><ep-contracting-states><country mxw-id="DS548946905" load-source="docdb">AL</country><country mxw-id="DS548957039" load-source="docdb">AT</country><country mxw-id="DS548946906" load-source="docdb">BE</country><country mxw-id="DS548821872" load-source="docdb">BG</country><country mxw-id="DS548874326" load-source="docdb">CH</country><country mxw-id="DS548952164" load-source="docdb">CY</country><country mxw-id="DS548957040" load-source="docdb">CZ</country><country mxw-id="DS548946907" load-source="docdb">DE</country><country mxw-id="DS548952165" load-source="docdb">DK</country><country mxw-id="DS548952170" load-source="docdb">EE</country><country mxw-id="DS548957782" load-source="docdb">ES</country><country mxw-id="DS548821873" load-source="docdb">FI</country><country mxw-id="DS548821874" load-source="docdb">FR</country><country mxw-id="DS548946908" load-source="docdb">GB</country><country mxw-id="DS548952171" load-source="docdb">GR</country><country mxw-id="DS548946909" load-source="docdb">HR</country><country mxw-id="DS548957041" load-source="docdb">HU</country><country mxw-id="DS548874327" load-source="docdb">IE</country><country mxw-id="DS548952172" load-source="docdb">IS</country><country mxw-id="DS548821875" load-source="docdb">IT</country><country mxw-id="DS548952173" load-source="docdb">LI</country><country mxw-id="DS548945149" load-source="docdb">LT</country><country mxw-id="DS548957050" load-source="docdb">LU</country><country mxw-id="DS548945150" load-source="docdb">LV</country><country mxw-id="DS548945151" load-source="docdb">MC</country><country mxw-id="DS548845917" load-source="docdb">MK</country><country mxw-id="DS548845918" load-source="docdb">MT</country><country mxw-id="DS548946910" load-source="docdb">NL</country><country mxw-id="DS548821876" load-source="docdb">NO</country><country mxw-id="DS548945152" load-source="docdb">PL</country><country mxw-id="DS548874328" load-source="docdb">PT</country><country mxw-id="DS548946911" load-source="docdb">RO</country><country mxw-id="DS548874329" load-source="docdb">RS</country><country mxw-id="DS548945153" load-source="docdb">SE</country><country mxw-id="DS548874330" load-source="docdb">SI</country><country mxw-id="DS548821877" load-source="docdb">SK</country><country mxw-id="DS548945154" load-source="docdb">SM</country><country mxw-id="DS548952178" load-source="docdb">TR</country></ep-contracting-states></designated-states></international-convention-data><office-specific-data><eptags><ep-no-a-document-published>*</ep-no-a-document-published></eptags></office-specific-data></bibliographic-data><description mxw-id="PDES63956794" lang="EN" load-source="patent-office"><!-- EPO <DP n="1"> --><heading id="h0001">BACKGROUND OF THE INVENTION</heading><p id="p0001" num="0001">The present invention relates generally to global navigation satellite systems, and more particularly to detection and correction of anomalous measurements and ambiguity estimation in a navigation receiver.</p><p id="p0002" num="0002">Global navigation satellite systems (GNSSs) can determine locations with high accuracy. Currently deployed global navigation satellite systems are the United States Global Positioning System (GPS) and the Russian GLONASS. Other global navigation satellite systems, such as the European GALILEO system, are under development. In a GNSS, a navigation receiver receives and processes radio signals transmitted by satellites located within a line-of-sight distance of the navigation receiver. The satellite signals comprise carrier signals modulated by pseudo-random binary codes. The navigation rec6eiver measures the time delays of the received signals relative to a local reference clock or oscillator. Code measurements enable the navigation receiver to determine the pseudo-ranges between the navigation receiver and the satellites. The pseudo-ranges differ from the actual ranges (distances) between the navigation receiver and the satellites due to various error sources and due to variations in the time scales of the satellites and the navigation receiver. If signals are received from a sufficiently large number of satellites, then the measured pseudo-ranges can be processed to determine the code coordinates and coordinate time scales at the navigation receiver. This operational mode is referred to as a stand-alone mode, since the measurements are<!-- EPO <DP n="2"> --> determined by a single navigation receiver. A stand-alone system typically provides meter-level accuracy.</p><p id="p0003" num="0003">To improve the accuracy, precision, stability, and reliability of measurements, differential navigation (DN) systems have been developed. In a DN system, the position of a user is determined relative to a base station (also referred to as a base) whose coordinates are precisely known. The base contains a navigation receiver that receives satellite signals. The user, whose position is to be determined, can be stationary or mobile and is often referred to as a rover. The rover also contains a navigation receiver that receives satellite signals. Signal measurements processed at the base are transmitted to the rover via a communications link. The communications link, for example, can be provided over a cable or optical fiber. To accommodate a mobile rover, the communications link is often a wireless link.</p><p id="p0004" num="0004">The rover processes the measurements received from the base, along with measurements taken with its own navigation receiver, to improve the accuracy of determining its position. Accuracy is improved in the differential navigation mode because errors incurred by the navigation receiver at the rover and by the navigation receiver at the base are highly correlated. Since the coordinates of the base are accurately known, measurements from the base can be used to compensate for the errors at the rover. A differential global positioning system (DGPS) computes locations based on pseudo-ranges only.</p><p id="p0005" num="0005">The location determination accuracy of a differential navigation system can be further improved by supplementing the code pseudo-range measurements with measurements of the phases of the satellite carrier signals. If the carrier phases of the signals transmitted by the same satellite are measured by both the navigation receiver at the base and the navigation receiver at the rover, processing the two sets of carrier phase measurements can yield a location determination accuracy to within several percent of the carrier's wavelength. A differential navigation system that computes locations based on real-time carrier signals, in addition to the code pseudo-ranges, is often referred to as a real-time<!-- EPO <DP n="3"> --> kinematic (RTK) system. Processing carrier phase measurements to determine coordinates includes the step of ambiguity resolution; that is, determining the integer number of cycles in the carrier signal received by a navigation receiver from an individual satellite.</p><p id="p0006" num="0006">In many instances, a navigation receiver (in particular, the navigation receiver at the rover) operates in a complex environment in which various external influences cause measurement errors. For example, external signals can interfere with the satellite signals, and structures and terrain can result in multipath errors. Errors can be classified into two broad categories: normal errors and abnormal errors. Normal errors are normally-distributed white noise errors that can be compensated for during calculation of location coordinates. Abnormal errors are large systematic errors that can prevent the system from calculating an accurate location. In some instances, abnormal errors are caused by spikes of intrinsic noise. More often, they result from environmental conditions. For example, strong reflected signals that interfere with the direct satellite signal can cause an abnormal error. Similarly, extreme radio interference can also result in abnormal errors.</p><p id="p0007" num="0007">Partial or complete shading of the navigation receiver can result in errors due to radio wave diffraction. If the shading is partial and minor, the measurement error can be minimal. If a satellite is completely shaded (that is, blocked), however, only the multipath signal remains. As a result, tracking in the channel is interrupted, and the measured phase is lost, resulting in an abnormal error. Dynamic effects on the navigation receiver (for example, specific motions of the rover) can also cause abnormal errors. Impulse accelerations impact both the receiving antenna and the quartz crystal of the local reference oscillator, resulting in drift of the intermediate carrier frequency and measured phase.</p><p id="p0008" num="0008">One specific type of abnormal error is a phase-lock loop (PLL) cycle slip, which is a cycle slip in the PLL circuits that track the satellite carrier signal. After a cycle slip occurs, the PLL circuit transitions to a new point of steady balance, after which it continues tracking the satellite carrier signal. If a cycle slip occurs during signal tracking, an abnormal error equal to several integer number of<!-- EPO <DP n="4"> --> semi-cycles (half-cycles) is introduced into the carrier phase measurements. If a cycle slip occurs after signal lock, an abnormal error equal to several integer number of cycles is introduced into the carrier phase measurements.</p><p id="p0009" num="0009">Calculating coordinates from received satellite signals entails the calculation of complex mathematical algorithms. These algorithms are computationally intense, often utilizing high processor and memory capacity. What are needed are methods and apparatus for detection and correction, or elimination, of abnormal measurements prior to execution of complex algorithms.<br/>
<patcit id="pcit0001" dnum="US2007052583A1"><text>US 2007/052583 A1</text></patcit> discloses a method and apparatus for determining the relative position of a mobile unit that moves from an initial location to a plurality of successive positions. The mobile unit receives signals from a plurality of navigation satellites and tracks the carrier phases of the signals during movement. For each of the received signals, carrier phase increments are calculated over a plurality of epochs. Anomalous carrier phase increments are determined and eliminated from further calculations. The non-eliminated carrier phase increments are then used to calculate coordinate increments for each of the time epochs.<br/>
<patcit id="pcit0002" dnum="US2002021241A1"><text>US 2002/021241 A1</text></patcit> discloses a method and apparatus for positioning a mobile user in a differential global navigation satellite system. The method includes a procedure for resolving ambiguities in phase measurements. The procedure of resolution of phase measurement ambiguities comprises the preliminary estimation of floating ambiguities by a recurrent (e.g., iterative) procedure including the simultaneous processing of code and phase measurements for all satellites for each processing time interval, and the gradual improvement of the result as the information is accumulated. After the resolution of ambiguity, the user coordinates are estimated with centimeter accuracy on the basis of phase measurements on the carrier frequency.<!-- EPO <DP n="5"> --></p><heading id="h0002">BRIEF SUMMARY OF THE INVENTION</heading><p id="p0010" num="0010">A global navigation system includes a first navigation receiver located in a rover and a second navigation receiver located in a base station. A first plurality of measurements based on a first plurality of carrier signals received by the first navigation receiver from a plurality of global navigation satellites is received. A second plurality of measurements based on a second plurality of carrier signals received by the second navigation receiver from the plurality of global navigation satellites is received. Each carrier signal in the second plurality of carrier signals corresponds to a carrier signal in the first plurality of carrier signals, and each measurement in the second plurality of measurements corresponds to a measurement in the first plurality of measurements.</p><p id="p0011" num="0011">In an embodiment, anomalous measurements are detected and eliminated prior to performing computations for determining the output position of the rover. To detect anomalous measurements, a first plurality of single differences based on the first plurality of measurements and the second plurality of measurements are calculated. A state vector based on the first plurality of single differences is determined. A second plurality of single differences based on an observation model is calculated. A plurality of residuals based on the first plurality of single differences and the second plurality of single differences is calculated. Whether the first plurality of single differences and the second plurality of single differences are consistent with the observation model is determined. When the first plurality of single differences and the second plurality of single differences are not consistent, anomalous measurements are detected and eliminated.</p><p id="p0012" num="0012">In an embodiment, integer ambiguities are resolved. Single differences of pseudo-ranges and carrier phases are first calculated. The single differences are linearized, and an observation vector and matrix are calculated. If the position of the rover is known, then an inverse operation is performed to determine an estimate of the integer ambiguities vector. If the position of the rover is not known, then the ambiguities are filtered and float ambiguities are estimated. An integer ambiguities vector candidate is determined and evaluated against fix criteria.<!-- EPO <DP n="6"> --> If the fix criteria are met, then an estimate of the integer ambiguities vector is generated.</p><p id="p0013" num="0013">In an embodiment, anomalous measurements are detected and removed prior to filtering ambiguities. Fast search procedures are used in the calculations for detecting anomalies. The calculations for resolving integer ambiguities involve generating a Cholessky information Kalman filter and performing a Householder transformation on the Cholessky information Kalman filter.</p><p id="p0014" num="0014">These and other advantages of the invention will be apparent to those of ordinary skill in the art by reference to the following detailed description and the accompanying drawings. The invention is defined by the claims.</p><heading id="h0003">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p0015" num="0015"><figref idrefs="f0001">Fig. 1</figref> shows a flowchart of a method for detecting and correcting anomalous measurements;</p><p id="p0016" num="0016"><figref idrefs="f0002">Fig. 2</figref> shows a flowchart of a method for resolving integer ambiguities;</p><p id="p0017" num="0017"><figref idrefs="f0003">Fig. 3</figref> shows an expression for initial Cholessky information coordinates;</p><p id="p0018" num="0018"><figref idrefs="f0004">Fig. 4</figref> shows an expression for Cholessky information coordinates at a later epoch;</p><p id="p0019" num="0019"><figref idrefs="f0005">Fig. 5</figref> shows pseudo-code for an algorithm for updating a state vector;</p><p id="p0020" num="0020"><figref idrefs="f0006">Fig. 6</figref> shows an expression for a matrix used in resolving integer ambiguities when a reference satellite changes;</p><p id="p0021" num="0021"><figref idrefs="f0007">Fig. 7</figref> and <figref idrefs="f0008">Fig. 8</figref> show pseudo-code for algorithms used in resolving integer ambiguities when a satellite sets; and</p><p id="p0022" num="0022"><figref idrefs="f0009">Fig. 9</figref> shows a high-level schematic of a computational system.<!-- EPO <DP n="7"> --></p><heading id="h0004">DETAILED DESCRIPTION</heading><p id="p0023" num="0023">The navigation measurements of interest can be viewed as solutions for the unknown components of a state vector of a system. Components of the state vector include: position vector of the rover; velocity vector of the rover (if required); clock errors in the local reference oscillators in the navigation receivers at the base and at the rover; and the <i>n</i> integer ambiguities of the phase measurements of the carrier signals received by the navigation receivers at the base and the rover. The number <i>n</i> is discussed below. To simplify the terminology, a navigation receiver is also referred to herein as a receiver.</p><p id="p0024" num="0024">In principle, time is measured with respect to a common system clock. In practice, each satellite transmitter and each receiver has its own local reference clock. The local reference clock in a receiver is typically a quartz oscillator, which can have variations in frequency and phase. These variations result in clock errors. There are also clock errors corresponding to the local reference clock in a satellite transmitter. The clock in a satellite transmitter is typically more precise and stable than the clock in a receiver; however, for precise measurements, clock errors in the satellite transmitter are also taken into account. The difference in time determined by a local clock in a receiver or satellite and the time determined by the common system clock is referred to as the clock offset. In a global navigation satellite system (GNSS), a discrete time scale is often used. The time instants referenced to timing signals transmitted by a satellite are referred to as epochs. Other time instants are referenced to digital processing circuits in receivers.</p><p id="p0025" num="0025">The carrier phase of a carrier signal is the sum of an integer number of cycles and a fractional cycle. The fractional cycle can be directly measured, but the integer number of cycles is initially indeterminate and, therefore, is often referred to as the integer ambiguity. The process of determining the integer number of cycles is referred to as ambiguity resolution. Hereinafter, carrier phase refers to the ambiguous carrier phase initially determined by the receiver, and unambiguous phase refers to the unambiguous carrier phase after ambiguity resolution.<!-- EPO <DP n="8"> --></p><p id="p0026" num="0026">For a single-frequency receiver, the number <i>n</i> of integer ambiguities that needs to be resolved is equal to the number of satellites whose signals are being received and processed. Each satellite in a global navigation satellite system, however, transmits signals on more than one carrier frequency. For example, a GPS satellite can transmit signals on a carrier in the <i>L</i><sub>1</sub> frequency band and on a carrier in the <i>L</i><sub>2</sub> frequency band. If the receiver is a dual-frequency unit, then the number <i>n</i> is equal to twice the number of satellites whose signals are being received and processed. That is, the number <i>n</i> is equal to the number of satellite channels being received and processed, where a satellite channel is specified by the identity of the satellite and the carrier frequency. Receiving signals on two carrier frequencies allows corrections for ionospheric delays; these corrections simplify ambiguity resolution.</p><p id="p0027" num="0027">A carrier signal transmitted by a satellite follows one direct propagation path to the rover receiver and a second direct propagation path to the base receiver. Herein, a carrier signal received by the rover receiver corresponds to a carrier signal received by the base receiver when both received carrier signals correspond to the same carrier signal transmitted by a satellite. The state vector is calculated from an observation vector, whose components include two sets of navigation parameters. One set is determined from data measured by the base receiver; and a corresponding set is determined from data measured by the rover receiver. Each set of navigation parameters includes the pseudo-range of each satellite to the receiver and the carrier phase of each satellite carrier signal. The pseudo-range between a satellite and a receiver is obtained by measuring the time delay of a code modulation signal transmitted by the satellite and received by the receiver. The code modulation signal is tracked by a delay-lock loop (DLL) circuit in a satellite tracking channel. The carrier phase of a carrier signal is tracked by a phase-lock-loop (PLL) in the satellite tracking channel. The navigation parameters are determined at discrete instants of time, and an observation vector is generated as the collection of the navigation parameters over a time range.<!-- EPO <DP n="9"> --></p><p id="p0028" num="0028">The relationship between the state vector and the observation vector is defined by a well-known system of navigation equations. Given an observation vector, the system of equations can be solved to find the state vector if the number of equations equals or exceeds the number of unknowns in the state vector. Conventional statistical methods can be used to solve the system of equations; for example, the least squares method (LSM), the dynamic Kalman filtering method, and various modifications and combinations of LSM and Kalman.</p><p id="p0029" num="0029">Practical implementations of these methods in digital form can vary widely. In implementing a method in a processor, there is typically a compromise between the accuracy of the results, speed of calculation, and load on the processor. One general scheme includes the following steps. A set of navigation parameters determined by the base receiver is transmitted to the rover. A corresponding set of navigation parameters is determined by the rover receiver. For each satellite channel at specific instants of time, the single difference between the pseudo-range measured at the base receiver and the pseudo-range measured at the rover receiver is determined, and the single difference between the carrier phase measured at the base receiver and the carrier phase measured at the rover receiver is determined.</p><p id="p0030" num="0030">Measurements at the base receiver and at the rover receiver contain errors which are strongly correlated. For example, clock errors in a satellite transmitter are common to the signals received by both the base receiver and the rover receiver. As another example, if the base and the rover are sufficiently close together, errors caused by signal propagation through the atmosphere are common to the signals received by both the base receiver and the rover receiver. Single differences compensate for strongly correlated errors; that is, the strongly correlated errors are substantially cancelled.</p><p id="p0031" num="0031">The residuals of the single differences are then determined by subtracting calculated values from the measured values. Calculated values are based on an observation model. The processing of residuals allows the initial nonlinear system of navigation equations to be linearized (sometimes several iterations<!-- EPO <DP n="10"> --> are necessary). Well-known mathematical techniques for solving systems of linear equations can then be applied. For example, in one embodiment, the single-difference measurements are first processed by the Gauss-Newton algorithm, and initial residuals are generated. The initial residuals are then processed by multiple iterations of the Gauss-Newton algorithm until convergence is reached. The final solution generates final residuals. Detection and elimination of anomalies are based on the final residuals. Algorithms other than the Gauss-Newton method can be used. For example, the Newton method can be used; however, this requires double derivatives of residuals. Methods for linearization during iterations include the Zeidel method and the Jacobi method. Also, calculations include searching for minima of functions, and methods of optimization can be used instead (such as the Rosenbrock method, simplex method, quasi-gradient method, and quasi-Newton method).</p><p id="p0032" num="0032">The components of the state vector, including the ambiguities, are determined. The calculated values of the ambiguities, however, are not necessarily processed as integer numbers; they are often processed as floating point numbers, referred to as float (or floating) ambiguities. An ambiguity resolution process rounds off the set of floating point values to a set of integer values. The true values of the residuals are then calculated from the set of integer values, and the system of equations is solved again with these integer values. The coordinates of the rover and the corrections to the clock offset in the rover are then determined. To simplify the terminology, calculating corrections to the clock offset is also referred to as calculating the clock offset.</p><p id="p0033" num="0033">Calculating coordinates and clock offset from received satellite signals entails the calculation of complex mathematical algorithms. These algorithms are computationally intensive, often utilizing high processor and memory capacity. Detection and correction, or elimination, of abnormal measurements prior to execution of complex algorithms are advantageous for reducing processor and memory utilization. Furthermore, the time for calculating coordinates is reduced, and the accuracy of the coordinates is increased.<!-- EPO <DP n="11"> --></p><p id="p0034" num="0034">Abnormal measurements are also referred to herein as anomalous measurements. Anomalous measurements impact various operations, such as the calculation of positions and the resolution of ambiguities. When there is an anomalous measurement in the positioning operation or in the ambiguity resolution operation, for example, the state vector will be distorted. Anomalous measurements need to be corrected or eliminated first. Since optimal position calculation and ambiguity resolution over the whole set of equations consume considerable computational resources, it is advantageous to correct or eliminate the anomalous measurements prior to the execution of complex algorithms.</p><p id="p0035" num="0035">In embodiments of the invention, anomalous measurements are detected by an anomaly detector that determines the consistency of measurements with an observation model. Methods for fast searching and enumeration, as described in more detail below, increase computational efficiency and reduce the number of operations; consequently, computational speed is increased. After an anomaly has been detected, it can be corrected, or eliminated, prior to further processing of the measurements.</p><p id="p0036" num="0036"><figref idrefs="f0001">Fig. 1</figref> shows a high-level flowchart of steps for processing measurements, according to an embodiment of the invention.</p><p id="p0037" num="0037">Measurements 101 include pseudo-ranges, carrier phase increments over an epoch, and unambiguous phases measured at the base navigation receiver and at the rover navigation receiver. For the unambiguous phases, initial processing to calculate estimates of the ambiguities were previously performed. In step 102, single differences of the measurements measured at the rover navigation receiver and the corresponding measurements measured at the base navigation receiver are calculated.</p><p id="p0038" num="0038">In step 104, a state vector is determined from the single differences. Step 104 includes correcting the pseudo-range single differences and the unambiguous phase single differences for troposphere delays. In an embodiment, the Gauss-Newton process is used for determining the state vector.<!-- EPO <DP n="12"> --> The troposphere corrections depend on the rover position and are evaluated during the Gauss-Newton process.</p><p id="p0039" num="0039">The process then passes to step 106, in which residuals of the single differences are calculated. As discussed above, residuals are determined by subtracting values of single differences calculated from an observation model from the single differences calculated from the measurements. In an embodiment, multiple iterations of the Gauss-Newton process are used to generate a final set of residuals.</p><p id="p0040" num="0040">The process then passes to step 108, in which measurement consistency is checked. Consistency criteria are discussed in more detail below. The process then passes to decision step 110. If the set of measurements is consistent, then the process generates output 111, which includes the rover position (as specified by rover coordinates) and flags identifying which measurements, if any, are anomalous (referred to herein as measurement flags).</p><p id="p0041" num="0041">If the set of measurements is not consistent, then the process passes to step 114, in which anomalies are detected and removed. The process then passes to decision step 116. If the state vector cannot be determined from the remaining measurements, then the process passes to step 118, in which all the measurements are eliminated. In order for the state vector to be determined, the remaining measurements need to include measurements from at least four satellites. If the state vector can be determined from the remaining measurements, then the process passes to step 120, in which the state vector is corrected; that is, the state vector is re-calculated after the anomalous measurements have been removed. Correction can be done with a more efficient technique than least square method (LSM) for the remaining measurements. In an embodiment, a technique based on the peer-to-peer LSM modification (described in more detail below) is used. The process then returns to step 106 for another iteration.</p><p id="p0042" num="0042">In step 108, different criteria can be used to determine whether or not the measurements are consistent. Herein, measurements from the rover receiver and corresponding measurements from the base receiver are consistent if<!-- EPO <DP n="13"> --> their single differences are consistent with the observation model. Examples of consistency criteria include the following:
<ul><li>Measurements are consistent if the absolute value of each residual does not exceed a user-defined threshold value. This method is effective if a behavioral model is <i>a priori</i> known.</li><li>Measurements are consistent if the absolute value of each weighted residual does not exceed a user-defined threshold value. A weighted residual is a residual multiplied by a factor referred to as a weight. Each residual can be multiplied by a different weight. More details are described below.</li><li>Measurements are consistent if the weighted sum of residual squares (WSRS) does not exceed a user-defined threshold value. This method is comprehensive, since it uses all the measurements. More details of WSRS are described below.</li><li>Any combination of the above criteria can also be used via the logical operations "AND" or "OR".</li></ul></p><p id="p0043" num="0043">In step 114, different search methods can be used to detect an anomaly. Examples of search methods include:
<ul><li>Search for a maximum absolute value of a residual. The corresponding measurement is regarded as an anomaly.</li><li>Search for a maximum absolute value of a weighted residual. The corresponding measurement is regarded as an anomaly.</li><li>Search for a specific measurement such that removal of the specific measurement will result in a minimal value of WSRS for the updated solution. This method examines the measurements one at a time.</li></ul></p><p id="p0044" num="0044">After at least one anomalous measurement has been detected, a single measurement or a group of measurements can be selected to be designated as anomalous and corrected or eliminated. Methods for selection include:
<ul><li>Only the detected measurement is designated to be anomalous.</li><li>All measurements for the current channel are designated to be anomalous. If the code measurement is anomalous, the carrier phase measurement is also<!-- EPO <DP n="14"> --> designated to be anomalous. Similarly, if the carrier phase measurement is anomalous, the code measurement is also designated to be anomalous.</li></ul>
<ul><li>If measurements on the civilian channel are anomalous, measurements on the protected channel are also designated to be anomalous. In GPS and GLONASS, some signals can be decoded by all users, and some signals can be decoded only by authorized users (such as the military). For GPS, the protected P-signal can be decoded by using the civilian C-signal information.</li><li>All measurements from the satellite from which an anomaly was detected are designated to be anomalous.</li></ul>
The choice of method influences the performance of the anomaly detector.</p><p id="p0045" num="0045">Embodiments of anomaly detectors (as shown in <figref idrefs="f0001">Fig. 1</figref>) are described below.
<ul><li><b>Anomaly Detector Based on Pseudo-Range Single Differences.</b> Single differences of pseudo-ranges are calculated. The ionospheric contribution is assumed to be negligible or compensated by a model. By solving equations for pseudo-range single differences, a differential code solution can be obtained. A WSRS can be calculated from this solution. If this sum exceeds a user-defined threshold value, a decision concerning anomalies is made and correction follows.</li><li><b>Anomaly Detector Based on Carrier Phase Single Difference Increments over an Epoch.</b> For the first epoch, rover coordinates are determined using only code measurements to determine pseudo-ranges. Starting from the second epoch, and using carrier phase increments over an epoch, rover coordinate increments (changes in coordinates) are determined. The current coordinates can be determined by adding coordinate increments to previous coordinates. If there are no anomalies (cycle slips), the rover coordinate increments are calculated at carrier phase (cm) accuracy, but the entire rover trajectory is shifted relative to the true trajectory (by tens of meters in the stand-alone mode and by tens of cm in DGPS mode). The shift arises from<!-- EPO <DP n="15"> --> inaccuracy of the initial coordinates determined from the code measurements. Further details are provided below.</li><li><b>Anomaly Detector Based on Unambiguous Phase Single Differences.</b> Single differences of unambiguous phase measurements are calculated. A differential phase solution can be obtained by solving the equations with respect to single differences of unambiguous phases. A WSRS can be calculated from this solution. If this WSRS exceeds a user-defined threshold value, a decision concerning anomalies is made and correction follows.</li></ul></p><p id="p0046" num="0046">Examples of algorithms for detection of anomalies are discussed below. These algorithms fall into two categories: detection of anomalies during the calculation of positions and detection of anomalies before resolution of ambiguities. Detection of anomalies during the calculation of positions results in more precise coordinates. Detection of anomalies before resolution of ambiguities provides a better estimate of the ambiguities (which in turn also affects the calculation of positions).</p><p id="p0047" num="0047"><b>Definition of Variables and Notation Convention</b>. In the algorithms below, the following variables and notation are used. Vectors and matrices are shown in bold font.
<ul><li><b>r</b> = (<i>x, y,</i> z)<i><sup>T</sup></i> is the position vector, also referred to herein as the radius vector, in the World Geodetic System 84 (WGS 84) coordinate frame referenced to the center of the Earth. Components {<b>r</b>}<sub>x</sub>, {<b>r</b>}<sub>y</sub>, {<b>r</b>}<sub>z</sub> designate vector projections onto the corresponding Cartesian <i>x,y,z</i> axes.</li><li>The set of index numbers <maths id="math0001" num=""><math display="inline"><mtable><mtr><mtd><mi>f</mi><mo>,</mo><mi>s</mi></mtd></mtr><mtr><mtd><mi>r</mi><mo>,</mo><mi>k</mi></mtd></mtr></mtable></math><img id="ib0001" file="imgb0001.tif" wi="8" he="10" img-content="math" img-format="tif" inline="yes"/></maths> refer to the following:
<ul><li><i>f</i> is the index number of the frequency band (for example, <i>f</i> = 1 can refer to the <i>L<sub>1</sub></i> frequency band, and <i>f</i> = 2 can refer to the<!-- EPO <DP n="16"> --> <i>L</i><sub>2</sub> frequency band). Future GNSSs can have more than two frequency bands.</li><li><i>S</i> is the index number of a satellite.</li><li><i>r</i> is the index number of a receiver (<i>r</i> = 0 refers to the rover receiver, and <i>r</i> = 1 refers to the base receiver.)</li><li><i>k</i> is the index number of a system time instant.</li></ul></li><li><maths id="math0002" num=""><math display="inline"><msubsup><mi>ρ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></math><img id="ib0002" file="imgb0002.tif" wi="11" he="9" img-content="math" img-format="tif" inline="yes"/></maths> are line-of-sight pseudo-ranges (in meters) between satellite S and receiver <i>r</i> ; pseudo-ranges are also referred to as code measurements.</li><li><maths id="math0003" num=""><math display="inline"><msubsup><mi>ϕ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></math><img id="ib0003" file="imgb0003.tif" wi="10" he="9" img-content="math" img-format="tif" inline="yes"/></maths> are line-of-sight carrier phase measurements (in meters) between satellite <i>S</i> and receiver <i>r</i>. Here <maths id="math0004" num=""><math display="inline"><msubsup><mi>ϕ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></math><img id="ib0004" file="imgb0004.tif" wi="11" he="8" img-content="math" img-format="tif" inline="yes"/></maths> represent the carrier phases in cycles multiplied by the carrier wavelength.</li><li>C is the speed of light (2.99792458 x 10<sup>8</sup> m/s).</li><li><maths id="math0005" num=""><math display="inline"><msubsup><mi>R</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>=</mo><mi>R</mi><mo>⁢</mo><mfenced separators=""><msubsup><mi mathvariant="bold">r</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msubsup><mi mathvariant="bold">b</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>,</mo><msubsup><mi mathvariant="bold">r</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msubsup><mi mathvariant="bold">c</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></mfenced></math><img id="ib0005" file="imgb0005.tif" wi="74" he="11" img-content="math" img-format="tif" inline="yes"/></maths> is the distance from the phase center of the transmitting antenna on satellite S to the phase center of the receiving antenna on receiver r, where:
<ul><li>R(<b>r</b>, <b>r'</b>) = |<b>r</b> - r'| + c<sup>-1</sup>Ω<sub>e</sub>({<b>r'</b>}<sub>x</sub>. {<b>r</b>}<i><sub>y</sub></i> - {<b>r'</b>}<sub>y</sub>· {<b>r</b>}<sub>x</sub>)is the geometric distance from the satellite S with radius vector <b>r'</b> to the point with radius vector <b>r</b> plus a correction factor accounting for the rotation of the Earth.</li><li>Ω<i><sub>e</sub></i> is the angular rotational speed of the Earth (<i>c</i><sup>-1</sup>Ω<i><sub>e</sub></i> = 2.432387791 x 10<sup>-13</sup> m<sup>-1</sup>).</li><li><maths id="math0006" num=""><math display="inline"><msubsup><mi mathvariant="bold">r</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup></math><img id="ib0006" file="imgb0006.tif" wi="9" he="8" img-content="math" img-format="tif" inline="yes"/></maths> is the radius vector of satellite <i>S</i> at the instant that the satellite signal is received at receiver <i>r</i>. Satellite signals are broadcast<!-- EPO <DP n="17"> --> (transmitted) at different time instants. Also, a satellite signal broadcast at a single time instant will arrive at different receivers at different time instants. Therefore, the values of <maths id="math0007" num=""><math display="inline"><msubsup><mi mathvariant="bold">r</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup></math><img id="ib0007" file="imgb0007.tif" wi="9" he="10" img-content="math" img-format="tif" inline="yes"/></maths> can vary from one receiver to another.</li><li><maths id="math0008" num=""><math display="inline"><msubsup><mi mathvariant="bold">b</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></math><img id="ib0008" file="imgb0008.tif" wi="13" he="9" img-content="math" img-format="tif" inline="yes"/></maths> is the displacement vector of the phase center (for the frequency band f) of the receiving antenna on the receiver r relative to the antenna reference point; this vector depends on the direction of satellite S. More explicitly:
<ul><li><maths id="math0009" num=""><math display="inline"><msubsup><mi mathvariant="bold">b</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>=</mo><msubsup><mi mathvariant="bold">offs</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mi>f</mi></msubsup><mo>+</mo><msup><mi mathvariant="italic">PCV</mi><mi>f</mi></msup><mfenced><msubsup><mi>θ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup></mfenced><mo>⋅</mo><msubsup><mi mathvariant="bold">h</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup><mn>.</mn></math><img id="ib0009" file="imgb0009.tif" wi="82" he="10" img-content="math" img-format="tif" inline="yes"/></maths> Here, the term <maths id="math0010" num=""><math display="inline"><msubsup><mi mathvariant="bold">offs</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mi>f</mi></msubsup></math><img id="ib0010" file="imgb0010.tif" wi="17" he="11" img-content="math" img-format="tif" inline="yes"/></maths> represents the phase offset (independent of direction); <maths id="math0011" num=""><math display="inline"><msup><mi mathvariant="italic">PCV</mi><mi>f</mi></msup><mfenced><msubsup><mi>θ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup></mfenced></math><img id="ib0011" file="imgb0011.tif" wi="31" he="10" img-content="math" img-format="tif" inline="yes"/></maths> represents the phase center variation (dependent on elevation angle); and <maths id="math0012" num=""><math display="inline"><msubsup><mi mathvariant="bold">h</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup></math><img id="ib0012" file="imgb0012.tif" wi="12" he="10" img-content="math" img-format="tif" inline="yes"/></maths> represents the directional cosine from satellite to receiver. The second term accounts for the directional properties of antennas operating in different frequency bands.</li></ul></li><li><maths id="math0013" num=""><math display="inline"><msubsup><mi mathvariant="bold">c</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></math><img id="ib0013" file="imgb0013.tif" wi="11" he="11" img-content="math" img-format="tif" inline="yes"/></maths> is the displacement vector of the phase center (for the frequency band f) of the transmitting antenna on the satellite S relative to the center-of-mass of the-satellite; in general, this displacement depends on the direction to the receiver r. More explicitly: <maths id="math0014" num=""><math display="inline"><msubsup><mi mathvariant="bold">c</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>=</mo><mover><mi mathvariant="bold">o</mi><mn>2</mn></mover><mo>⁢</mo><msubsup><mi mathvariant="bold">ffs</mi><mi>k</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>+</mo><mover><mi mathvariant="italic">P</mi><mn>2</mn></mover><mo>⁢</mo><msup><mi mathvariant="italic">CV</mi><mrow><mi>s</mi><mo>,</mo><mi>f</mi></mrow></msup><mfenced><msubsup><mover><mi>θ</mi><mo>˜</mo></mover><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup></mfenced><mo>⋅</mo><msubsup><mi mathvariant="bold">h</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup><mn>.</mn></math><img id="ib0014" file="imgb0014.tif" wi="84" he="12" img-content="math" img-format="tif" inline="yes"/></maths> Here the term <maths id="math0015" num=""><math display="inline"><mover><mi mathvariant="bold">o</mi><mn>2</mn></mover><mo>⁢</mo><msubsup><mi mathvariant="bold">ffs</mi><mi>k</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></math><img id="ib0015" file="imgb0015.tif" wi="19" he="10" img-content="math" img-format="tif" inline="yes"/></maths> represents the offset from the center-of-mass of the satellite to the transmitting antenna on the satellite; <maths id="math0016" num=""><math display="inline"><msubsup><mover><mi>θ</mi><mo>˜</mo></mover><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mover><mi>s</mi><mo>‾</mo></mover></msubsup></math><img id="ib0016" file="imgb0016.tif" wi="11" he="13" img-content="math" img-format="tif" inline="yes"/></maths><!-- EPO <DP n="18"> --> represents the elevation angle from the satellite antenna plane; and <maths id="math0017" num=""><math display="inline"><mover><mi mathvariant="italic">P</mi><mn>2</mn></mover><mo>⁢</mo><msup><mi mathvariant="italic">CV</mi><mrow><mi>s</mi><mo>,</mo><mi>f</mi></mrow></msup></math><img id="ib0017" file="imgb0017.tif" wi="20" he="10" img-content="math" img-format="tif" inline="yes"/></maths> represents the satellite phase center variation. Note that the effect of <maths id="math0018" num=""><math display="inline"><msubsup><mi mathvariant="bold">c</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></math><img id="ib0018" file="imgb0018.tif" wi="10" he="9" img-content="math" img-format="tif" inline="yes"/></maths> is negligible when single differences of measurements or time increments of measurements (or both) are processed.</li></ul></li><li><i>λ<sup>f,s</sup></i> is the wavelength of the carrier signal transmitted by satellite S on frequency band <i>f</i>. The Global Positioning System (GPS) and GALILEO (GAL) use code-division multiple access (CDMA), and GLONASS (GLN) uses frequency-division multiple access (FDMA). Wavelength is related to carrier frequency ω according to <maths id="math0019" num=""><math display="inline"><mi>λ</mi><mo>=</mo><mfrac><mi>c</mi><mi>ω</mi></mfrac><mn>.</mn></math><img id="ib0019" file="imgb0019.tif" wi="19" he="13" img-content="math" img-format="tif" inline="yes"/></maths> For GPS and GAL, the wavelength is the same for all carriers within the same frequency band <i>f.</i> For GLN, for frequency band <i>f,</i> a carrier frequency is specified by a center frequency <maths id="math0020" num=""><math display="inline"><msubsup><mi>F</mi><mn>0</mn><mi>f</mi></msubsup></math><img id="ib0020" file="imgb0020.tif" wi="8" he="9" img-content="math" img-format="tif" inline="yes"/></maths> and a frequency increment <maths id="math0021" num=""><math display="inline"><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msubsup><mi>F</mi><mn>0</mn><mi>f</mi></msubsup><mn>.</mn></math><img id="ib0021" file="imgb0021.tif" wi="14" he="9" img-content="math" img-format="tif" inline="yes"/></maths> For each satellite S , there is a corresponding satellite frequency channel number <i>l<sup>s</sup></i> (an integer). The carrier frequency for satellite S is then <maths id="math0022" num=""><math display="inline"><msup><mi>F</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>=</mo><msubsup><mi>F</mi><mn>0</mn><mi>f</mi></msubsup><mo>+</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msubsup><mi>F</mi><mn>0</mn><mi>f</mi></msubsup><mo>⋅</mo><msup><mi>l</mi><mi>s</mi></msup><mn>.</mn></math><img id="ib0022" file="imgb0022.tif" wi="52" he="10" img-content="math" img-format="tif" inline="yes"/></maths> The corresponding wavelength is <maths id="math0023" num=""><math display="inline"><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>=</mo><mfrac><mi>c</mi><msup><mi>F</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup></mfrac><mo>=</mo><mfrac><mi>c</mi><mrow><msubsup><mi>F</mi><mn>0</mn><mi>f</mi></msubsup><mo>+</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msubsup><mi>F</mi><mn>0</mn><mi>f</mi></msubsup><mo>⋅</mo><msup><mi>l</mi><mi>s</mi></msup></mrow></mfrac><mo>,</mo></math><img id="ib0023" file="imgb0023.tif" wi="72" he="16" img-content="math" img-format="tif" inline="yes"/></maths> which can be transformed into the expression <maths id="math0024" num=""><math display="inline"><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>=</mo><mfrac><mrow><mi>c</mi><mo>/</mo><msubsup><mi>F</mi><mn>0</mn><mi>f</mi></msubsup></mrow><mrow><mn>1</mn><mo>+</mo><mfenced separators=""><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msubsup><mi>F</mi><mn>0</mn><mi>f</mi></msubsup><mo>/</mo><msubsup><mi>F</mi><mn>0</mn><mi>f</mi></msubsup></mfenced><mo>⋅</mo><msup><mi>l</mi><mi>s</mi></msup></mrow></mfrac><mo>=</mo><mfrac><msubsup><mi>λ</mi><mn>0</mn><mi>f</mi></msubsup><mrow><mn>1</mn><mo>+</mo><msubsup><mi>ε</mi><mn>0</mn><mi>f</mi></msubsup><mo>⋅</mo><msup><mi>l</mi><mi>s</mi></msup></mrow></mfrac><mo>,</mo></math><img id="ib0024" file="imgb0024.tif" wi="93" he="18" img-content="math" img-format="tif" inline="yes"/></maths>, where <maths id="math0025" num=""><math display="inline"><msubsup><mi>λ</mi><mn>0</mn><mi>f</mi></msubsup><mo>=</mo><mi>c</mi><mo>/</mo><msubsup><mi>F</mi><mn>0</mn><mi>f</mi></msubsup><mo>,</mo><msubsup><mi>ε</mi><mn>0</mn><mi>f</mi></msubsup><mo>=</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><msubsup><mi>F</mi><mn>0</mn><mi>f</mi></msubsup><mo>/</mo><msubsup><mi>F</mi><mn>0</mn><mi>f</mi></msubsup><mn>.</mn></math><img id="ib0025" file="imgb0025.tif" wi="71" he="12" img-content="math" img-format="tif" inline="yes"/></maths> To maintain uniform convention for all GNSSs, channels in GPS and GAL are assigned a parameter <maths id="math0026" num=""><math display="inline"><msubsup><mi>ε</mi><mn>0</mn><mi>f</mi></msubsup></math><img id="ib0026" file="imgb0026.tif" wi="7" he="9" img-content="math" img-format="tif" inline="yes"/></maths> as<!-- EPO <DP n="19"> --> well (this parameter is equal to zero, since the increment between satellite frequency channel numbers is zero). For GLN frequency bands: <maths id="math0027" num=""><math display="block"><msubsup><mi>ε</mi><mn>0</mn><mrow><mi>GLN</mi><mn>.</mn><mi mathvariant="normal">L</mi><mo>⁢</mo><mn>1</mn></mrow></msubsup><mo>=</mo><mfrac><mn>562500</mn><mn>1602000000</mn></mfrac><mo>=</mo><mfrac><mn>1</mn><mn>2848</mn></mfrac><mo>≈</mo><mn>3.511</mn><mo>⁢</mo><mi mathvariant="normal">e</mi><mo>-</mo><mn>004</mn></math><img id="ib0027" file="imgb0027.tif" wi="118" he="18" img-content="math" img-format="tif"/></maths> <maths id="math0028" num=""><math display="block"><msubsup><mi>ε</mi><mn>0</mn><mrow><mi>GLN</mi><mn>.</mn><mi mathvariant="normal">L</mi><mo>⁢</mo><mn>2</mn></mrow></msubsup><mo>=</mo><mfrac><mn>437500</mn><mn>1246000000</mn></mfrac><mo>=</mo><mfrac><mn>1</mn><mn>2848</mn></mfrac><mo>≈</mo><mn>3.511</mn><mo>⁢</mo><mi mathvariant="normal">e</mi><mo>-</mo><mn>004</mn></math><img id="ib0028" file="imgb0028.tif" wi="118" he="17" img-content="math" img-format="tif"/></maths> <maths id="math0029" num=""><math display="block"><msubsup><mi>ε</mi><mn>0</mn><mrow><mi>GLN</mi><mn>.</mn><mi mathvariant="normal">L</mi><mo>⁢</mo><mn>3</mn></mrow></msubsup><mo>=</mo><mfrac><mn>421875</mn><mn>1201500000</mn></mfrac><mo>=</mo><mfrac><mn>1</mn><mn>2848</mn></mfrac><mo>≈</mo><mn>3.511</mn><mo>⁢</mo><mi mathvariant="normal">e</mi><mo>-</mo><mn>004.</mn></math><img id="ib0029" file="imgb0029.tif" wi="118" he="19" img-content="math" img-format="tif"/></maths>
<br/>
These values are therefore the same for different frequency bands. As discussed above, for GPS and GAL, these values are also the same for different frequency bands since they are all equal to zero. For any GNSS, therefore, the assumption holds that <maths id="math0030" num=""><math display="inline"><msubsup><mi>ε</mi><mn>0</mn><mi>f</mi></msubsup></math><img id="ib0030" file="imgb0030.tif" wi="7" he="9" img-content="math" img-format="tif" inline="yes"/></maths> does not depend on the frequency band. This value is referred to as <maths id="math0031" num=""><math display="inline"><msubsup><mi>ε</mi><mn>0</mn><mi mathvariant="italic">SYS</mi></msubsup><mo>,</mo></math><img id="ib0031" file="imgb0031.tif" wi="12" he="9" img-content="math" img-format="tif" inline="yes"/></maths> where <i>SYS</i> refers to a particular GNSS.
</li><li><maths id="math0032" num=""><math display="inline"><msubsup><mi>τ</mi><mi>k</mi><mi mathvariant="italic">s</mi></msubsup></math><img id="ib0032" file="imgb0032.tif" wi="6" he="8" img-content="math" img-format="tif" inline="yes"/></maths> and <maths id="math0033" num=""><math display="inline"><msubsup><mi>τ</mi><mi>k</mi><mi>r</mi></msubsup></math><img id="ib0033" file="imgb0033.tif" wi="7" he="8" img-content="math" img-format="tif" inline="yes"/></maths> are the clock offsets of the satellite clock and the receiver clock, respectively, relative to the system time.</li><li><maths id="math0034" num=""><math display="inline"><mi>δ</mi><mo>⁢</mo><msubsup><mi>τ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mfenced><mi mathvariant="italic">ρ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></math><img id="ib0034" file="imgb0034.tif" wi="19" he="9" img-content="math" img-format="tif" inline="yes"/></maths> and <maths id="math0035" num=""><math display="inline"><mi>δ</mi><mo>⁢</mo><msubsup><mi>τ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></math><img id="ib0035" file="imgb0035.tif" wi="19" he="9" img-content="math" img-format="tif" inline="yes"/></maths> are the code-measurement channel delay and phase-measurement channel delay, respectively. These delays result from radiofrequency (RF) and digital signal processing of the satellite signals received by a receiver. To a good approximation, it can be assumed that the values do not depend on satellite, time, and measurement type; therefore <maths id="math0036" num=""><math display="inline"><mi>δ</mi><mo>⁢</mo><msubsup><mi>τ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mfenced><mi mathvariant="italic">ρ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>=</mo><mi>δ</mi><mo>⁢</mo><msubsup><mi>τ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>≡</mo><mi>δ</mi><mo>⁢</mo><msubsup><mi>τ</mi><mi>r</mi><mi>f</mi></msubsup><mn>.</mn></math><img id="ib0036" file="imgb0036.tif" wi="62" he="12" img-content="math" img-format="tif" inline="yes"/></maths><!-- EPO <DP n="20"> --></li><li><maths id="math0037" num=""><math display="inline"><msubsup><mi>T</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup></math><img id="ib0037" file="imgb0037.tif" wi="9" he="8" img-content="math" img-format="tif" inline="yes"/></maths> is the troposphere delay. This delay is caused by the refraction coefficient of troposphere.</li><li><maths id="math0038" num=""><math display="inline"><msubsup><mi>I</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></math><img id="ib0038" file="imgb0038.tif" wi="10" he="9" img-content="math" img-format="tif" inline="yes"/></maths> is the ionosphere delay caused by propagation of the satellite signal through the ionosphere. More explicitly: For a sufficiently high carrier frequency F<sup>f,s</sup>, <maths id="math0039" num=""><math display="inline"><msubsup><mi>I</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>=</mo><mfrac><mi>C</mi><msup><mfenced open="[" close="]"><msup><mi>F</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup></mfenced><mn>2</mn></msup></mfrac><mo>⁢</mo><munder><mo>∫</mo><mi>L</mi></munder><mo>⁢</mo><msub><mi>n</mi><mi>e</mi></msub><mo>⁢</mo><mi mathvariant="italic">ds</mi><mo>,</mo><mi>L</mi><mo>=</mo><msubsup><mi>L</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup><mo>,</mo><msub><mi>n</mi><mi>e</mi></msub><mo>=</mo><msub><mi>n</mi><mi>e</mi></msub><mfenced separators=""><mi>x</mi><mo>⁢</mo><mi>y</mi><mo>⁢</mo><mi>z</mi><mo>⁢</mo><msub><mi>t</mi><mi>k</mi></msub></mfenced><mo>,</mo></math><img id="ib0039" file="imgb0039.tif" wi="118" he="17" img-content="math" img-format="tif" inline="yes"/></maths> where <i>n<sub>e</sub></i> is the electron density, <i>L</i> is the signal trajectory, <i>C</i> is a constant, and ds is a differential distance along the propagation path. Note that the frequency dependence arises from the [<i>F<sup>f,s</sup></i> ]<sup>2</sup> term. An arbitrary reference band with index number <i>f<sub>ref</sub></i> (for example, <i>L</i><sub>1</sub>) can be chosen; then
<chemistry id="chem0001" num="0001"><img id="ib0040" file="imgb0040.tif" wi="77" he="54" img-content="chem" img-format="tif"/></chemistry></li><li><maths id="math0040" num=""><math display="inline"><msup><mi>μ</mi><mrow><mi>f</mi><mo>/</mo><msub><mi>f</mi><mi mathvariant="italic">ref</mi></msub><mo>,</mo><mi>s</mi></mrow></msup><mo>=</mo><mfrac><msup><mfenced open="[" close="]"><msup><mi>F</mi><mrow><msub><mi>f</mi><mi mathvariant="italic">ref</mi></msub><mo>,</mo><mi>s</mi></mrow></msup></mfenced><mn>2</mn></msup><msup><mfenced open="[" close="]"><msup><mi>F</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup></mfenced><mn>2</mn></msup></mfrac><mo>=</mo><msup><mfenced separators=""><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>/</mo><msup><mi>λ</mi><mrow><msub><mi>f</mi><mi mathvariant="italic">ref</mi></msub><mo>,</mo><mi>s</mi></mrow></msup></mfenced><mn>2</mn></msup></math><img id="ib0041" file="imgb0041.tif" wi="86" he="17" img-content="math" img-format="tif" inline="yes"/></maths> is the ionosphere frequency ratio, where <i>f<sub>ref</sub></i> is the index number of a reference frequency band.<!-- EPO <DP n="21"> --></li><li><maths id="math0041" num=""><math display="inline"><msubsup><mi>M</mi><mi>r</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>≡</mo><msubsup><mi>N</mi><mi>r</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>+</mo><msubsup><mi>ϕ</mi><mrow><mi>r</mi><mo>,</mo><mn>0</mn></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></math><img id="ib0042" file="imgb0042.tif" wi="47" he="11" img-content="math" img-format="tif" inline="yes"/></maths> are floating point ambiguities; where
<ul><li><maths id="math0042" num=""><math display="inline"><msubsup><mi>N</mi><mi>r</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></math><img id="ib0043" file="imgb0043.tif" wi="12" he="9" img-content="math" img-format="tif" inline="yes"/></maths> are integer ambiguities;</li><li><maths id="math0043" num=""><math display="inline"><msubsup><mi>ϕ</mi><mrow><mi>r</mi><mo>,</mo><mn>0</mn></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>=</mo><msubsup><mi>ϕ</mi><mn>0</mn><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>-</mo><msubsup><mi>ϕ</mi><mrow><mi>r</mi><mo>,</mo><mn>0</mn></mrow><mi>f</mi></msubsup></math><img id="ib0044" file="imgb0044.tif" wi="42" he="10" img-content="math" img-format="tif" inline="yes"/></maths> is the phase offset which is the initial phase of the satellite reference oscillator minus the initial phase of the receiver reference oscillator.</li></ul></li><li><maths id="math0044" num=""><math display="inline"><msubsup><mi>ψ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup><mo>=</mo><msubsup><mi>ψ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mfenced><mo>⊥</mo></mfenced><mo>,</mo><mi>s</mi></mrow></msubsup><mo>+</mo><msubsup><mi>ψ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mfenced><mi mathvariant="normal">P</mi></mfenced><mo>,</mo><mi>s</mi></mrow></msubsup></math><img id="ib0045" file="imgb0045.tif" wi="49" he="11" img-content="math" img-format="tif" inline="yes"/></maths> is the phase incursion (phase increment) due to change in mutual orientation of the antenna on satellite <i>S</i> and the antenna on receiver r. It includes a linear increment <maths id="math0045" num=""><math display="inline"><msubsup><mi>ψ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mfenced><mo>⊥</mo></mfenced><mo>,</mo><mi>s</mi></mrow></msubsup></math><img id="ib0046" file="imgb0046.tif" wi="14" he="9" img-content="math" img-format="tif" inline="yes"/></maths> caused by turning the antennas in the plane of their dipole axes, and a nonlinear increment <maths id="math0046" num=""><math display="inline"><msubsup><mi>ψ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mfenced><mi mathvariant="normal">P</mi></mfenced><mo>,</mo><mi>s</mi></mrow></msubsup></math><img id="ib0047" file="imgb0047.tif" wi="13" he="10" img-content="math" img-format="tif" inline="yes"/></maths> caused by mutual deviation of axes normal to antenna dipoles from the line of sight.</li><li><maths id="math0047" num=""><math display="inline"><msubsup><mi>ζ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></math><img id="ib0048" file="imgb0048.tif" wi="17" he="10" img-content="math" img-format="tif" inline="yes"/></maths> and <maths id="math0048" num=""><math display="inline"><msubsup><mi>ζ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></math><img id="ib0049" file="imgb0049.tif" wi="17" he="10" img-content="math" img-format="tif" inline="yes"/></maths> are code noise error (including DLL errors and multipath errors) and phase noise error (including PLL errors and multipath errors), respectively. They are considered to be white Gaussian noise with zero expected (mean) values and non-zero variances. The standard deviation (STD) value of code noise error is approximately 1 m, and the STD value of phase noise error is approximately 1 cm.</li><li>Signal-to-noise ratio is designated <maths id="math0049" num=""><math display="inline"><msubsup><mi mathvariant="italic">SNR</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mn>.</mn></math><img id="ib0050" file="imgb0050.tif" wi="20" he="9" img-content="math" img-format="tif" inline="yes"/></maths></li></ul></p><p id="p0048" num="0048"><b>Observation Equations.</b> Received satellite signals are processed by channel algorithms to generate raw measurements (or, more precisely, estimates of raw measurements). In some embodiments, the raw measurements are smoothed. The raw measurements then undergo further processing depending on the particular operating mode (stand-alone, DGPS, or RTK).</p><p id="p0049" num="0049">An embodiment of an observation model is based on the following mathematical model. The mathematical model is applicable to raw measurements<!-- EPO <DP n="22"> --> for all global navigation satellite systems (GNSSs) and can be formulated by the following observation equations: <maths id="math0050" num="(E1)"><math display="block"><msubsup><mi>ρ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>=</mo><msubsup><mi>R</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>+</mo><mi>c</mi><mo>⁢</mo><mfenced separators=""><msub><mi>τ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>+</mo><mi>δ</mi><mo>⁢</mo><msubsup><mi>τ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>-</mo><msubsup><mi>τ</mi><mi>k</mi><mi>s</mi></msubsup></mfenced><mo>+</mo><msubsup><mi>T</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msup><mi>μ</mi><mrow><mi>f</mi><mo>/</mo><msub><mi>f</mi><mi mathvariant="italic">ref</mi></msub><mo>,</mo><mi>s</mi></mrow></msup><mo>⁢</mo><msubsup><mi>I</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>s</mi><mo>,</mo><msub><mi>f</mi><mi mathvariant="italic">ref</mi></msub></mrow></msubsup><mo>+</mo><msubsup><mi>ζ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></math><img id="ib0051" file="imgb0051.tif" wi="143" he="26" img-content="math" img-format="tif"/></maths><br/>
and <maths id="math0051" num="(E2)"><math display="block"><msubsup><mi>ϕ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>=</mo><msubsup><mi>R</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>+</mo><mi>c</mi><mo>⁢</mo><mfenced separators=""><msub><mi>τ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow></msub><mo>+</mo><mi>δ</mi><mo>⁢</mo><msubsup><mi>τ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>-</mo><msubsup><mi>τ</mi><mi>k</mi><mi>s</mi></msubsup></mfenced><mo>+</mo><msubsup><mi>T</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup><mo>-</mo><msup><mi>μ</mi><mrow><mi>f</mi><mo>/</mo><msub><mi>f</mi><mi mathvariant="italic">ref</mi></msub><mo>,</mo><mi>s</mi></mrow></msup><mo>⁢</mo><msubsup><mi>I</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>s</mi><mo>,</mo><msub><mi>f</mi><mi mathvariant="italic">ref</mi></msub></mrow></msubsup><mo>+</mo><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>⁢</mo><mfenced separators=""><msubsup><mi>M</mi><mi>r</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>+</mo><msubsup><mi>ψ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup></mfenced><mo>+</mo><msubsup><mi>ζ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mn>.</mn></math><img id="ib0052" file="imgb0052.tif" wi="145" he="25" img-content="math" img-format="tif"/></maths><br/>
The observation equation for the pseudo-range single differences is then: <maths id="math0052" num="(E3)"><math display="block"><msubsup><mi>ρ</mi><mi>k</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>=</mo><msubsup><mi>R</mi><mrow><mn>0</mn><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup><mo>+</mo><mi>c</mi><mo>⁢</mo><mfenced separators=""><msub><mi>τ</mi><mi>k</mi></msub><mo>+</mo><mi>δ</mi><mo>⁢</mo><msubsup><mi>τ</mi><mi>k</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mfenced><mo>+</mo><msup><mi>μ</mi><mrow><mi>f</mi><mo>/</mo><msub><mi>f</mi><mi mathvariant="italic">ref</mi></msub><mo>,</mo><mi>s</mi></mrow></msup><mo>⁢</mo><msubsup><mi>I</mi><mi>k</mi><mi>s</mi></msubsup><mo>+</mo><msubsup><mi>ζ</mi><mi>k</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>;</mo></math><img id="ib0053" file="imgb0053.tif" wi="144" he="14" img-content="math" img-format="tif"/></maths><br/>
and the observation equation for the carrier phase single differences is then: <maths id="math0053" num="(E4)"><math display="block"><msubsup><mi>ϕ</mi><mi>k</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>=</mo><msubsup><mi>R</mi><mrow><mn>0</mn><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup><mo>+</mo><mi>c</mi><mo>⁢</mo><mfenced separators=""><msub><mi>τ</mi><mi>k</mi></msub><mo>+</mo><mi>δ</mi><mo>⁢</mo><msubsup><mi>τ</mi><mi>k</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mfenced><mo>-</mo><msup><mi>μ</mi><mrow><mi>f</mi><mo>/</mo><msub><mi>f</mi><mi mathvariant="italic">ref</mi></msub><mo>,</mo><mi>s</mi></mrow></msup><mo>⁢</mo><msubsup><mi>I</mi><mi>k</mi><mi>s</mi></msubsup><mo>+</mo><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>⁢</mo><mfenced separators=""><msup><mi>M</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>+</mo><msubsup><mi>ψ</mi><mi>k</mi><mfenced><mo>⊥</mo></mfenced></msubsup></mfenced><mo>+</mo><msubsup><mi>ζ</mi><mi>k</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mn>.</mn></math><img id="ib0054" file="imgb0054.tif" wi="144" he="22" img-content="math" img-format="tif"/></maths><br/>
In (E3) and (E4):
<ul><li>For simplicity, the single differences operator Δ<sub>0,1</sub> has been omitted. For example, the pseudo-range single differences are<!-- EPO <DP n="23"> --> <maths id="math0054" num=""><math display="block"><msub><mi mathvariant="normal">Δ</mi><mrow><mn>0</mn><mo>,</mo><mn>1</mn></mrow></msub><mfenced><msubsup><mi>ρ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></mfenced><mo>=</mo><msubsup><mi>ρ</mi><mrow><mi>r</mi><mo>=</mo><mn>0</mn><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>-</mo><msubsup><mi>ρ</mi><mrow><mi>r</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>→</mo><msubsup><mi>ρ</mi><mi>k</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>;</mo></math><img id="ib0055" file="imgb0055.tif" wi="90" he="14" img-content="math" img-format="tif"/></maths><br/>
and the carrier phase single differences are <maths id="math0055" num=""><math display="block"><msub><mi mathvariant="normal">Δ</mi><mrow><mn>0</mn><mo>,</mo><mn>1</mn></mrow></msub><mfenced><msubsup><mi>ϕ</mi><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></mfenced><mo>=</mo><msubsup><mi>ϕ</mi><mrow><mi>r</mi><mo>=</mo><mn>0</mn><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>-</mo><msubsup><mi>ϕ</mi><mrow><mi>r</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>k</mi></mrow><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>→</mo><msubsup><mi>ϕ</mi><mi>k</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mn>.</mn></math><img id="ib0056" file="imgb0056.tif" wi="86" he="12" img-content="math" img-format="tif"/></maths></li><li>Ranges are referenced to the antenna reference point.</li><li>The following parameters are compensated (cancelled):
<ul><li>Calculated range from a satellite to the base</li><li>Troposphere contribution</li><li>Phase incursion (increment) caused by changing the mutual orientation of the satellite antenna and the receiver antenna</li><li>Antenna phase center offsets (offsets between the antenna reference point and the antenna phase center for the rover antenna and the base antenna).</li></ul></li><li><maths id="math0056" num=""><math display="inline"><msubsup><mi>I</mi><mi>k</mi><mi>s</mi></msubsup></math><img id="ib0057" file="imgb0057.tif" wi="6" he="8" img-content="math" img-format="tif" inline="yes"/></maths> designates single differences of ionosphere errors for the reference frequency.</li></ul></p><p id="p0050" num="0050">In (E3) and (E4), solving for the individual variables (more precisely, estimates of individual variables), requires additional information in some instances. Some combinations of the variables, however, can be estimated by processing double differences.</p><p id="p0051" num="0051">A double difference of a variable refers to the difference of a variable as a function of the satellite whose signal is received and processed. A particular satellite is selected as a reference <i>satellite S<sub>ref</sub>.</i> Typically, the reference satellite is chosen as the satellite with the highest elevation angle. For a variable corresponding to a (non-reference) satellite S , the double difference operator is represented by the <i>symbol ∇<sup>s,s<sub2>ref</sub2></sup>.</i> Then, for example,<!-- EPO <DP n="24"> --> <maths id="math0057" num=""><math display="block"><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msub><mi>I</mi><mi>k</mi></msub><mo>=</mo><msubsup><mi>I</mi><mi>k</mi><mi>s</mi></msubsup><mo>-</mo><msubsup><mi>I</mi><mi>k</mi><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></msubsup><mo>;</mo></math><img id="ib0058" file="imgb0058.tif" wi="53" he="13" img-content="math" img-format="tif"/></maths> <maths id="math0058" num=""><math display="block"><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mi>M</mi><mi>f</mi></msup><mo>=</mo><msup><mi>M</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>-</mo><msup><mi>M</mi><mrow><mi>f</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>=</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup><mo>;</mo></math><img id="ib0059" file="imgb0059.tif" wi="100" he="14" img-content="math" img-format="tif"/></maths> <maths id="math0059" num=""><math display="block"><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup><mo>=</mo><msup><mi>N</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>-</mo><msup><mi>N</mi><mrow><mi>f</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mn>.</mn></math><img id="ib0060" file="imgb0060.tif" wi="67" he="14" img-content="math" img-format="tif"/></maths></p><p id="p0052" num="0052">The following variables are defined: <maths id="math0060" num=""><math display="block"><msub><mfenced open="{" close="}" separators=""><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup><mo>=</mo><mi>c</mi><mo>⁢</mo><msub><mi>τ</mi><mi>k</mi></msub><mo>+</mo><mi>c</mi><mo>⁢</mo><mi>δ</mi><mo>⁢</mo><msup><mi>τ</mi><mi>f</mi></msup><mo>+</mo><msup><mi>μ</mi><mrow><mi>f</mi><mo>/</mo><msub><mi>f</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msubsup><mi>I</mi><mi>k</mi><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></msubsup></mfenced><mi>f</mi></msub><mo>,</mo></math><img id="ib0061" file="imgb0061.tif" wi="83" he="10" img-content="math" img-format="tif"/></maths> <maths id="math0061" num=""><math display="block"><msub><mfenced open="{" close="}" separators=""><msubsup><mi mathvariant="normal">Ψ</mi><mi>k</mi><mi>f</mi></msubsup><mo>=</mo><mfenced separators=""><msubsup><mi>ψ</mi><mi>k</mi><mfenced><mo>⊥</mo></mfenced></msubsup><mo>+</mo><msup><mi>M</mi><mrow><mi>f</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup></mfenced><mo>-</mo><mn>2</mn><mo>⁢</mo><msup><mi>μ</mi><mrow><mi>f</mi><mo>/</mo><msub><mi>f</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msubsup><mi>I</mi><mi>k</mi><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></msubsup><mo>/</mo><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup></mfenced><mi>f</mi></msub><mo>,</mo></math><img id="ib0062" file="imgb0062.tif" wi="119" he="11" img-content="math" img-format="tif"/></maths> <maths id="math0062" num=""><math display="block"><msub><mfenced open="{" close="}" separators=""><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup></mfenced><mrow><mi>f</mi><mo>,</mo><mi>s</mi><mo>≠</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msub><mo>,</mo></math><img id="ib0063" file="imgb0063.tif" wi="49" he="12" img-content="math" img-format="tif"/></maths> <maths id="math0063" num=""><math display="block"><msub><mfenced open="{" close="}" separators=""><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mi>I</mi><mi>s</mi></msup></mfenced><mrow><mi>s</mi><mo>≠</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msub><mn>.</mn></math><img id="ib0064" file="imgb0064.tif" wi="43" he="12" img-content="math" img-format="tif"/></maths><br/>
Here, <maths id="math0064" num=""><math display="inline"><msub><mfenced open="{" close="}"><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup></mfenced><mi>f</mi></msub></math><img id="ib0065" file="imgb0065.tif" wi="16" he="10" img-content="math" img-format="tif" inline="yes"/></maths> refers to the set of <maths id="math0065" num=""><math display="inline"><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup></math><img id="ib0066" file="imgb0066.tif" wi="9" he="9" img-content="math" img-format="tif" inline="yes"/></maths> for all values of f, and <i>{∇<sup>s,s<sub2>ref</sub2></sup> N<sup>f</sup>}<sub>f,s≠s<sub2>ref</sub2></sub></i> refers to the set of <i>∇<sup>s,s<sub2>ref</sub2></sup> N<sup>f</sup></i> for all values of <i>f</i> and for all satellites <i>S</i> , excluding the reference satellite <i>S<sub>ref</sub></i>. The set of equations, (E3) and (E4), previously expressed as a function of the set of variables <maths id="math0066" num=""><math display="block"><msub><mi mathvariant="bold">r</mi><mrow><mn mathvariant="bold">0</mn><mo>,</mo><mi mathvariant="bold">k</mi></mrow></msub><mo>,</mo></math><img id="ib0067" file="imgb0067.tif" wi="14" he="9" img-content="math" img-format="tif"/></maths> <maths id="math0067" num=""><math display="block"><mi>c</mi><mo>⁢</mo><msub><mi>τ</mi><mi>k</mi></msub><mo>,</mo></math><img id="ib0068" file="imgb0068.tif" wi="14" he="7" img-content="math" img-format="tif"/></maths> <maths id="math0068" num=""><math display="block"><msubsup><mi>ψ</mi><mi>k</mi><mfenced><mo>⊥</mo></mfenced></msubsup><mo>,</mo></math><img id="ib0069" file="imgb0069.tif" wi="17" he="9" img-content="math" img-format="tif"/></maths> <maths id="math0069" num=""><math display="block"><msub><mfenced open="{" close="}" separators=""><mi>c</mi><mo>⁢</mo><mi>δ</mi><mo>⁢</mo><msup><mi>τ</mi><mi>f</mi></msup></mfenced><mrow><mi>f</mi><mo>≠</mo><msub><mi>f</mi><mi mathvariant="italic">ref</mi></msub></mrow></msub><mo>,</mo></math><img id="ib0070" file="imgb0070.tif" wi="34" he="10" img-content="math" img-format="tif"/></maths> <maths id="math0070" num=""><math display="block"><msub><mfenced open="{" close="}"><msup><mi>M</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup></mfenced><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msub><mo>,</mo></math><img id="ib0071" file="imgb0071.tif" wi="29" he="10" img-content="math" img-format="tif"/></maths> <maths id="math0071" num=""><math display="block"><msub><mfenced open="{" close="}"><msup><mi>I</mi><mi>s</mi></msup></mfenced><mi>s</mi></msub></math><img id="ib0072" file="imgb0072.tif" wi="17" he="10" img-content="math" img-format="tif"/></maths><br/>
<!-- EPO <DP n="25"> -->can then be expressed as a function of the set of variables: <maths id="math0072" num=""><math display="block"><msub><mfenced open="{" close="}"><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup></mfenced><mi>f</mi></msub><mo>,</mo></math><img id="ib0073" file="imgb0073.tif" wi="24" he="9" img-content="math" img-format="tif"/></maths> <maths id="math0073" num=""><math display="block"><msub><mfenced open="{" close="}"><msubsup><mi mathvariant="normal">Ψ</mi><mi>k</mi><mi>f</mi></msubsup></mfenced><mi>f</mi></msub><mo>,</mo></math><img id="ib0074" file="imgb0074.tif" wi="24" he="10" img-content="math" img-format="tif"/></maths> <maths id="math0074" num=""><math display="block"><msub><mi mathvariant="bold">r</mi><mrow><mn mathvariant="bold">0</mn><mo>,</mo><mi mathvariant="bold">k</mi></mrow></msub><mo>,</mo></math><img id="ib0075" file="imgb0075.tif" wi="14" he="8" img-content="math" img-format="tif"/></maths> <maths id="math0075" num=""><math display="block"><msub><mfenced open="{" close="}" separators=""><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup></mfenced><mrow><mi>f</mi><mo>,</mo><mi>s</mi><mo>≠</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msub><mo>,</mo></math><img id="ib0076" file="imgb0076.tif" wi="47" he="11" img-content="math" img-format="tif"/></maths> <maths id="math0076" num=""><math display="block"><msub><mfenced open="{" close="}" separators=""><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mi>I</mi><mi>s</mi></msup></mfenced><mrow><mi>s</mi><mo>≠</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msub><mn>.</mn></math><img id="ib0077" file="imgb0077.tif" wi="41" he="12" img-content="math" img-format="tif"/></maths><br/>
The observation equation for the carrier phase single differences is then: <maths id="math0077" num="(E5)"><math display="block"><msubsup><mi>ϕ</mi><mi>k</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>=</mo><msubsup><mi>R</mi><mrow><mn>0</mn><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup><mo>+</mo><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>⁢</mo><msubsup><mi mathvariant="normal">Ψ</mi><mi>k</mi><mi>f</mi></msubsup><mo>-</mo><msup><mi>μ</mi><mrow><mi>f</mi><mo>/</mo><msub><mi>f</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msub><mi>I</mi><mi>k</mi></msub><mo>+</mo><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>⁢</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup><mo>-</mo><mn>2</mn><mo>⁢</mo><msup><mi>μ</mi><mrow><mi>f</mi><mo>/</mo><msub><mi>f</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><mfenced separators=""><mn>1</mn><mo>-</mo><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>/</mo><msup><mi>λ</mi><mrow><mi>f</mi><mo>/</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup></mfenced><mo>⁢</mo><msubsup><mi>I</mi><mi>k</mi><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></msubsup><mo>+</mo><msubsup><mi>ζ</mi><mi>k</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mn>.</mn></math><img id="ib0078" file="imgb0078.tif" wi="156" he="24" img-content="math" img-format="tif"/></maths><br/>
The <i>term</i> <maths id="math0078" num=""><math display="inline"><mn>2</mn><mo>⁢</mo><msup><mi>μ</mi><mrow><mi>f</mi><mo>/</mo><msub><mi>f</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><mfenced separators=""><mn>1</mn><mo>-</mo><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>/</mo><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup></mfenced><mo>⁢</mo><msubsup><mi>I</mi><mi>k</mi><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></msubsup></math><img id="ib0079" file="imgb0079.tif" wi="69" he="11" img-content="math" img-format="tif" inline="yes"/></maths> is zero for GPS and GAL, and is less then 1 cm for GLN; therefore, this term can be assumed to be zero for all systems. With this assumption, the observation equations become <maths id="math0079" num="(E6)"><math display="block"><msubsup><mi>ρ</mi><mi>k</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>=</mo><msubsup><mi>R</mi><mrow><mn>0</mn><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup><mo>+</mo><msup><mi>μ</mi><mrow><mi>f</mi><mo>/</mo><msub><mi>f</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msub><mi>I</mi><mi>k</mi></msub><mo>+</mo><msubsup><mi>ζ</mi><mi>k</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></math><img id="ib0080" file="imgb0080.tif" wi="142" he="15" img-content="math" img-format="tif"/></maths><br/>
and <maths id="math0080" num="(E7)"><math display="block"><msubsup><mi>ϕ</mi><mi>k</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>=</mo><msubsup><mi>R</mi><mrow><mn>0</mn><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup><mo>+</mo><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>⁢</mo><msubsup><mi mathvariant="normal">Ψ</mi><mi>k</mi><mi>f</mi></msubsup><mo>-</mo><msup><mi>μ</mi><mrow><mi>f</mi><mo>/</mo><msub><mi>f</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msub><mi>I</mi><mi>k</mi></msub><mo>+</mo><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>⁢</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup><mo>+</mo><msubsup><mi>ζ</mi><mi>k</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></math><img id="ib0081" file="imgb0081.tif" wi="143" he="24" img-content="math" img-format="tif"/></maths></p><p id="p0053" num="0053">Now consider the calculation of the rover position from code measurements (code positioning) and the calculation of the rover position from<!-- EPO <DP n="26"> --> carrier phase measurements (phase positioning). The short baseline ionospheric delays {∇<sup>s,sr</sup><i><sup>ef</sup>I</i>}<i><sub>s≠s<sub2>ref</sub2></sub></i> are assumed to be zero. The single-difference observation equations for code positioning (E6) then reduce to: <maths id="math0081" num="(E8)"><math display="block"><msubsup><mi>ρ</mi><mi>k</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>=</mo><msubsup><mi>R</mi><mrow><mn>0</mn><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup><mo>+</mo><msubsup><mi>ζ</mi><mi>k</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mn>.</mn></math><img id="ib0082" file="imgb0082.tif" wi="104" he="14" img-content="math" img-format="tif"/></maths><br/>
In case of phase positioning, ambiguities {<i>∇<sup>s,s<sub2>ref</sub2></sup> N<sup>f</sup>}<sub>f,s≠s<sub2>ref</sub2></sub></i> are assumed to be known and compensated; therefore, the single-difference observation equations for phase positioning (E7) then reduce to: <maths id="math0082" num="(E9)"><math display="block"><msubsup><mi>ϕ</mi><mi>k</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>=</mo><msubsup><mi>R</mi><mrow><mn>0</mn><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup><mo>+</mo><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>⁢</mo><msubsup><mi mathvariant="normal">Ψ</mi><mi>k</mi><mi>f</mi></msubsup><mo>+</mo><msubsup><mi>ζ</mi><mi>k</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mn>.</mn></math><img id="ib0083" file="imgb0083.tif" wi="130" he="12" img-content="math" img-format="tif"/></maths></p><p id="p0054" num="0054"><b>Receiver Clock Offsets.</b> Receiver clock offsets need to be corrected. One method attempts to eliminate clock offsets from measurements by processing double differences. If the double difference operator is applied to (E8), then <maths id="math0083" num="(E10)"><math display="block"><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msubsup><mi>ρ</mi><mi>k</mi><mi>f</mi></msubsup><mo>=</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msub><mi>R</mi><mrow><mn>0</mn><mo>,</mo><mi>k</mi></mrow></msub><mo>+</mo><msup><mi>μ</mi><mrow><mi>f</mi><mo>/</mo><msub><mi>f</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msub><mi>I</mi><mi>k</mi></msub><mo>+</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msubsup><mi>ζ</mi><mi>k</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup><mn>.</mn></math><img id="ib0084" file="imgb0084.tif" wi="157" he="16" img-content="math" img-format="tif"/></maths><br/>
Note that the clock term <maths id="math0084" num=""><math display="inline"><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup></math><img id="ib0085" file="imgb0085.tif" wi="8" he="8" img-content="math" img-format="tif" inline="yes"/></maths> is eliminated. The noise terms,<br/>
<maths id="math0085" num=""><math display="inline"><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msubsup><mi>ζ</mi><mi>k</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup><mo>=</mo><msubsup><mi>ζ</mi><mi>k</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>-</mo><msubsup><mi>ζ</mi><mi>k</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msubsup><mo>,</mo></math><img id="ib0086" file="imgb0086.tif" wi="77" he="9" img-content="math" img-format="tif" inline="yes"/></maths> however, are correlated, since the common noise <maths id="math0086" num=""><math display="inline"><msubsup><mi>ζ</mi><mi>k</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msubsup></math><img id="ib0087" file="imgb0087.tif" wi="21" he="10" img-content="math" img-format="tif" inline="yes"/></maths> term is present in the equations. For GPS and GAL, applying the double difference operator to (E9) then yields:<!-- EPO <DP n="27"> --> <maths id="math0087" num="(E11)"><math display="block"><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msubsup><mi>ϕ</mi><mi>k</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>=</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msubsup><mi>R</mi><mrow><mn>0</mn><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup><mo>-</mo><msup><mi>μ</mi><mrow><mi>f</mi><mo>/</mo><msub><mi>f</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msub><mi>I</mi><mi>k</mi></msub><mo>+</mo><msup><mi>λ</mi><mi>f</mi></msup><mo>⁢</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup><mo>+</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msubsup><mi>ζ</mi><mi>k</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mn>.</mn></math><img id="ib0088" file="imgb0088.tif" wi="134" he="26" img-content="math" img-format="tif"/></maths></p><p id="p0055" num="0055">For GPS and GAL the clock term, <maths id="math0088" num=""><math display="inline"><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup><mo>,</mo></math><img id="ib0089" file="imgb0089.tif" wi="11" he="8" img-content="math" img-format="tif" inline="yes"/></maths> and the phase offset term, <maths id="math0089" num=""><math display="inline"><msubsup><mi mathvariant="normal">Ψ</mi><mi>k</mi><mi>f</mi></msubsup><mo>,</mo></math><img id="ib0090" file="imgb0090.tif" wi="12" he="9" img-content="math" img-format="tif" inline="yes"/></maths> are eliminated. The noise terms, however, again are correlated. For GLN, the analysis is more involved because different wavelengths are involved. There are then two types of double differences. The first type eliminates <maths id="math0090" num=""><math display="inline"><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup><mo>;</mo></math><img id="ib0091" file="imgb0091.tif" wi="10" he="8" img-content="math" img-format="tif" inline="yes"/></maths> and the second type eliminates <maths id="math0091" num=""><math display="inline"><msubsup><mi mathvariant="normal">Ψ</mi><mi>k</mi><mi>f</mi></msubsup><mn>.</mn></math><img id="ib0092" file="imgb0092.tif" wi="12" he="8" img-content="math" img-format="tif" inline="yes"/></maths> In both instances, however, the noise terms are correlated. The correlation of double differences presents computational complexity because calculation of a covariance matrix and its inversion to produce a weight matrix are needed. Also, as discussed above, double difference processing for GLN presents additional processing. Therefore, a direct double difference approach is not satisfactory for eliminating receiver clock offsets and phase offsets.</p><p id="p0056" num="0056">In an embodiment, a technique for eliminating clock offsets and phase offsets is based on Householder's transformations to the corresponding normalized equations. A normalized equation refers to an observation equation in which all the terms are divided by the standard deviation (STD) of the noise; the STD of the normalized noise is then equal to one. The method has less computational complexity and greater computational stability than the double differences approach. Less computational complexity ensues because the equations are already normalized and do not require a covariance matrix and a weight matrix. Greater computational stability ensues because Householder's transformations inherently possess better stability. Details of Householder's transformations are described in C. L. Lawson and R. J. Hanson, "Solving Least Squares Problems", Prentice-Hall, Inc., Englewood Cliffs, NJ, USA (1974) ["Lawson"] and in G.H. Golub and C. F. Van Loan, "Matrix Computations", The Johns Hopkins University Press, Baltimore, MD, USA (Third Edition, 1996) ["Golub"].<!-- EPO <DP n="28"> --></p><p id="p0057" num="0057">Consider the pseudo-range equation (E8) for one frequency. First write a matrix and a vector of the observation model with normalized noise: <maths id="math0092" num="(E12)"><math display="block"><mfenced open="[" close="]"><mtable><mtr><mtd><msup><mover><mi mathvariant="bold">w</mi><mo>‾</mo></mover><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></mtd><mtd><msubsup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mi>cos</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable></mfenced></math><img id="ib0093" file="imgb0093.tif" wi="130" he="12" img-content="math" img-format="tif"/></maths> <maths id="math0093" num=""><math display="block"><msubsup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mi>cos</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup><mo>=</mo><msub><mfenced separators=""><msup><mfenced open="[" close="]"><msup><mi>σ</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup></mfenced><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><msup><mfenced open="[" close="]"><msubsup><mi mathvariant="bold">h</mi><mrow><mn>0</mn><mo>,</mo><mi>k</mi></mrow><mrow><mfenced><mi>a</mi></mfenced><mo>⁢</mo><mi>s</mi></mrow></msubsup></mfenced><mi>T</mi></msup></mfenced><mi>s</mi></msub></math><img id="ib0094" file="imgb0094.tif" wi="76" he="14" img-content="math" img-format="tif"/></maths> <maths id="math0094" num=""><math display="block"><msup><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>=</mo><msub><mfenced separators=""><msup><mfenced open="[" close="]"><msup><mi>σ</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup></mfenced><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><msub><mi mathvariant="normal">Δ</mi><mrow><mn>0</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>⁢</mo><mi>δ</mi><mo>⁢</mo><msubsup><mi>ρ</mi><mi>k</mi><mrow><mfenced><mi>a</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></mfenced><mi>s</mi></msub><mn>.</mn></math><img id="ib0095" file="imgb0095.tif" wi="83" he="14" img-content="math" img-format="tif"/></maths><br/>
Here σ<sup>(ρ)f,s</sup> stands for the code single difference noise standard deviation (STD). <i><b><o>w</o></b><sup>(ρ)f</sup> =</i> ([<i>σ<sup>(ρ)f,s</sup></i>]<sup>-1</sup>)<i><sub>s</sub></i> is the column vector containing STD <i>σ<sup>(ρ)f,s</sup>,</i> also referred to as weight roots. The superscript a refers to the <i>a priori</i> position used in the calculation of residuals. The inverse to the covariance matrix is called the weight matrix in the case of measurements covariance and the information matrix in case the case of estimate covariance. Here, a square root of a weight matrix is calculated. Calculation of single difference square root weights is simpler than the calculation of a double difference weight matrix (which is non-diagonal). To simplify the notation, the index <sub>k</sub> of time instant has been omitted.</p><p id="p0058" num="0058">Next, use Householder's reflection (see Lawson) to expand the matrix <maths id="math0095" num=""><math display="inline"><mfenced open="[" close="]" separators=""><msup><mover><mi mathvariant="bold">w</mi><mo>‾</mo></mover><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mspace width="1em"/><msubsup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mi>cos</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup><mrow><mo>|</mo></mrow><msup><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mi>f</mi></msup></mfenced><mn>.</mn></math><img id="ib0096" file="imgb0096.tif" wi="48" he="10" img-content="math" img-format="tif" inline="yes"/></maths> This operation sets all the column elements (except for the first one) <i><o>w</o><sup>f</sup></i> equal to zero, resulting in <maths id="math0096" num="(E13)"><math display="block"><mfenced open="[" close="]"><mtable><mtr><mtd><mtable><mtr><mtd><msubsup><mi>C</mi><mrow><mi>τ</mi><mo>,</mo><mi>τ</mi></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mi mathvariant="bold">C</mi><mrow><mi>τ</mi><mo>,</mo><mi>r</mi></mrow><mrow><mfenced><msub><mi>ρ</mi><mn>1</mn></msub></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msub><mn mathvariant="bold">0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mn>1</mn></mrow></msub></mtd><mtd><msubsup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable><mrow><mo>|</mo></mrow></mtd><mtd><mtable><mtr><mtd><msubsup><mi>c</mi><mi>τ</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable></mtd></mtr></mtable></mfenced><mn>.</mn></math><img id="ib0097" file="imgb0097.tif" wi="128" he="23" img-content="math" img-format="tif"/></maths><br/>
<!-- EPO <DP n="29"> -->Here <i>NS</i> is the number of acceptable measurements for the given frequency <i><sup>f</sup></i>. <i>NS</i> is determined as follows. A measurement is designated to be "acceptable" if the channel has a SNR greater than or equal to a SNR threshold value and the corresponding satellite has an elevation greater than or equal to an elevation threshold value. These measurements should be marked as "acceptable" by channel algorithms and by anomaly detectors. If the channel has a SNR less than the SNR threshold value, or if the corresponding satellite has an elevation less than the elevation threshold value, the measurements of the channel or satellite should be marked as "unacceptable" by channel algorithms and by anomaly detectors.</p><p id="p0059" num="0059">The clock offset corresponds to the first row of the matrix (E13). The rest of the rows of this matrix determine the normalized equations for pseudo-range double differences. This result follows because the operation of calculating pseudo-range double differences corresponds to the operation of multiplying observation equations by the matrix, which sets coefficients of clock offset to zero. The same operation is performed here, but with a different matrix. As a result, linearized equivalent observation equations for code measurements with the expanded matrix <maths id="math0097" num=""><math display="inline"><mfenced open="[" close="]" separators=""><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup><mrow><mo>|</mo></mrow><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mfenced></math><img id="ib0098" file="imgb0098.tif" wi="37" he="9" img-content="math" img-format="tif" inline="yes"/></maths> are obtained. These do not depend on clock offset.</p><p id="p0060" num="0060">Next, consider the procedure for eliminating clock offset and phase offset for phase positioning equation (E9). First, write a matrix and a vector of the observation model with normalized noise: <maths id="math0098" num="(E14)"><math display="block"><mfenced open="[" close="]"><mtable><mtr><mtd><msup><mover><mi mathvariant="bold">w</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></mtd><mtd><msup><mover><mi mathvariant="bold">λ</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></mtd><mtd><msubsup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mi>cos</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable></mfenced></math><img id="ib0099" file="imgb0099.tif" wi="129" he="11" img-content="math" img-format="tif"/></maths> <maths id="math0099" num=""><math display="block"><msubsup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mi>cos</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup><mo>=</mo><msub><mfenced separators=""><msup><mfenced open="[" close="]"><msup><mi>σ</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup></mfenced><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><msup><mfenced open="[" close="]"><msubsup><mi mathvariant="bold">h</mi><mrow><mn>0</mn><mo>,</mo><mi>k</mi></mrow><mrow><mfenced><mi>a</mi></mfenced><mo>⁢</mo><mi>s</mi></mrow></msubsup></mfenced><mi>T</mi></msup></mfenced><mi>s</mi></msub></math><img id="ib0100" file="imgb0100.tif" wi="74" he="14" img-content="math" img-format="tif"/></maths> <maths id="math0100" num=""><math display="block"><msup><mover><mi mathvariant="bold">λ</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>=</mo><msub><mfenced separators=""><msup><mfenced open="[" close="]"><msup><mi>σ</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup></mfenced><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup></mfenced><mi>s</mi></msub></math><img id="ib0101" file="imgb0101.tif" wi="67" he="14" img-content="math" img-format="tif"/></maths> <maths id="math0101" num=""><math display="block"><msup><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>=</mo><msub><mfenced separators=""><msup><mfenced open="[" close="]"><msup><mi>σ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup></mfenced><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><msub><mi mathvariant="normal">Δ</mi><mrow><mn>0</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>⁢</mo><mi>δ</mi><mo>⁢</mo><msubsup><mi>ϕ</mi><mi>k</mi><mrow><mfenced><mi>a</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup></mfenced><mi>s</mi></msub><mn>.</mn></math><img id="ib0102" file="imgb0102.tif" wi="73" he="13" img-content="math" img-format="tif"/></maths><br/>
<!-- EPO <DP n="30"> -->Compared to matrix (E13), matrix (E14) has an extra column <i><o>λ</o></i><sup>(ϕ)f</sup>. For GPS and GAL, this column is proportional to the vector <i><o>w</o></i><sup>(<i>ϕ</i>)<i>f</i></sup>. Therefore, for these systems, it is sufficient to combine the corresponding variables into one and apply the scheme previously used to eliminate clock offset for (E8) (that is, use the variable <maths id="math0102" num=""><math display="inline"><msubsup><mover><mi mathvariant="normal">Γ</mi><mo>˜</mo></mover><mi>k</mi><mi>f</mi></msubsup><mo>=</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup><mo>+</mo><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>⁢</mo><msubsup><mi mathvariant="normal">Ψ</mi><mi>k</mi><mi>f</mi></msubsup><mrow><mo>)</mo></mrow><mn>.</mn></math><img id="ib0103" file="imgb0103.tif" wi="49" he="10" img-content="math" img-format="tif" inline="yes"/></maths></p><p id="p0061" num="0061">For GLONASS, as discussed above, <maths id="math0103" num=""><math display="block"><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>=</mo><mfrac><msubsup><mi>λ</mi><mn>0</mn><mi>f</mi></msubsup><mrow><mn>1</mn><mo>+</mo><msubsup><mi>ε</mi><mn>0</mn><mi>f</mi></msubsup><mo>⋅</mo><msup><mi>l</mi><mi>s</mi></msup></mrow></mfrac><mn>.</mn></math><img id="ib0104" file="imgb0104.tif" wi="49" he="23" img-content="math" img-format="tif"/></maths><br/>
Express vector <i><o>w</o></i><sup>(<i>ϕ</i>)<i>f</i></sup> as a sum of a projection onto vector <i><o>λ</o></i> <sup>(ϕ)f</sup> and an additional component: <maths id="math0104" num="(E15)"><math display="block"><msup><mover><mi mathvariant="bold">w</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>=</mo><msup><mfenced open="[" close="]"><msubsup><mi>λ</mi><mn>0</mn><mi>f</mi></msubsup></mfenced><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><mfenced separators=""><mn>1</mn><mo>-</mo><msub><mi>ε</mi><mn>0</mn></msub><mo>⁢</mo><msup><mi>l</mi><mfenced><mi mathvariant="italic">av</mi></mfenced></msup></mfenced><mo>⋅</mo><msup><mover><mi mathvariant="bold">λ</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>+</mo><msubsup><mi>ε</mi><mn>0</mn><mi>f</mi></msubsup><mo>⁢</mo><msup><mover><mi mathvariant="bold">b</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></math><img id="ib0105" file="imgb0105.tif" wi="140" he="12" img-content="math" img-format="tif"/></maths> <maths id="math0105" num=""><math display="block"><msup><mover><mi mathvariant="bold">b</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>=</mo><msub><mfenced separators=""><msup><mfenced open="[" close="]"><msup><mi>σ</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup></mfenced><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><mfenced separators=""><msup><mi>l</mi><mi>s</mi></msup><mo>-</mo><msup><mi>l</mi><mfenced><mi mathvariant="italic">av</mi></mfenced></msup></mfenced><mo>⁢</mo><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>/</mo><msubsup><mi>λ</mi><mn>0</mn><mi>f</mi></msubsup></mfenced><mi>s</mi></msub></math><img id="ib0106" file="imgb0106.tif" wi="101" he="15" img-content="math" img-format="tif"/></maths> <maths id="math0106" num=""><math display="block"><msup><mi>l</mi><mfenced><mi mathvariant="italic">av</mi></mfenced></msup><mo>=</mo><mfrac><mrow><msub><mi mathvariant="normal">Σ</mi><mi>s</mi></msub><mo>⁢</mo><msup><mfenced separators=""><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>/</mo><msup><mi>σ</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup></mfenced><mn>2</mn></msup><mo>⁢</mo><msup><mi>l</mi><mi>s</mi></msup></mrow><mrow><msub><mi mathvariant="normal">Σ</mi><mi>s</mi></msub><mo>⁢</mo><msup><mfenced separators=""><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>/</mo><msup><mi>σ</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup></mfenced><mn>2</mn></msup></mrow></mfrac><mn>.</mn></math><img id="ib0107" file="imgb0107.tif" wi="75" he="24" img-content="math" img-format="tif"/></maths></p><p id="p0062" num="0062">Since <maths id="math0107" num=""><math display="inline"><msubsup><mi>ε</mi><mn>0</mn><mi>f</mi></msubsup></math><img id="ib0108" file="imgb0108.tif" wi="7" he="9" img-content="math" img-format="tif" inline="yes"/></maths> is negligible, vectors <b><o>w</o></b><sup>(<i>ϕ</i>)<i>f</i></sup>,<o>λ</o><sup>(<i>ϕ)</i>f</sup> are almost parallel. This results in a worse matrix conditioning than if columns <b><o>w</o></b><sup>(<i>ϕ</i>)</sup><i><sup>f</sup>, <o>λ</o></i><sup>(<i>ϕ</i>)<i>f</i></sup> are directly eliminated.<!-- EPO <DP n="31"> --></p><p id="p0063" num="0063">Assume that there is a clock offset estimate <maths id="math0108" num=""><math display="inline"><msub><mi mathvariant="normal">Δ</mi><mrow><mn>0</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>⁢</mo><mi>c</mi><mo>⁢</mo><msubsup><mi>τ</mi><mi>k</mi><mrow><mfenced><mi>a</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></math><img id="ib0109" file="imgb0109.tif" wi="24" he="9" img-content="math" img-format="tif" inline="yes"/></maths> with error <maths id="math0109" num=""><math display="inline"><msubsup><mi>ν</mi><mi>k</mi><mrow><mfenced separators=""><mi mathvariant="italic">cτ</mi><mo>⁢</mo><mi>a</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup><mn>.</mn></math><img id="ib0110" file="imgb0110.tif" wi="19" he="9" img-content="math" img-format="tif" inline="yes"/></maths> Such an estimate can be determined, for example, from a code solution. Then, compensating for <maths id="math0110" num=""><math display="inline"><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mrow><mfenced><mi>a</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></math><img id="ib0111" file="imgb0111.tif" wi="14" he="10" img-content="math" img-format="tif" inline="yes"/></maths> in (E14), obtain equations <maths id="math0111" num="(E16)"><math display="block"><mtable columnalign="left"><mtr><mtd><msup><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></mtd><mtd><mo>=</mo><msubsup><mi>ε</mi><mn>0</mn><mi>f</mi></msubsup><mo>⁢</mo><msubsup><mi mathvariant="bold-italic">ν</mi><mi>k</mi><mrow><mfenced separators=""><mi mathvariant="italic">cτ</mi><mo>⁢</mo><mi>a</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup><mo>⁢</mo><msup><mover><mi mathvariant="bold">b</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>+</mo><mrow><mo>(</mo><msup><mfenced open="[" close="]"><msubsup><mi>λ</mi><mn>0</mn><mi>f</mi></msubsup></mfenced><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><mfenced separators=""><mn>1</mn><mo>-</mo><msubsup><mi>ε</mi><mn>0</mn><mi>f</mi></msubsup><mo>⁢</mo><msup><mi>l</mi><mfenced><mi mathvariant="italic">av</mi></mfenced></msup></mfenced><mo>⁢</mo><msubsup><mi mathvariant="bold-italic">ν</mi><mi>k</mi><mrow><mfenced separators=""><mi mathvariant="italic">cτ</mi><mo>⁢</mo><mi>a</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>+</mo><msub><mo>∂</mo><mn>1</mn></msub><mo>⁢</mo><msubsup><mover><mi>ψ</mi><mrow><mn>0</mn><mo>/</mo></mrow></mover><mover><mrow><mi>r</mi><mo>,</mo><mi>k</mi></mrow><mn>0</mn></mover><mi>f</mi></msubsup><mrow><mo>)</mo></mrow><msup><mover><mi mathvariant="bold">λ</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>+</mo><msubsup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mi>cos</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>,</mo><mi>f</mi></mrow></msubsup><mo>⋅</mo><mi mathvariant="bold">Δ</mi><mo>⁢</mo><msub><mi mathvariant="bold">r</mi><mi>k</mi></msub></mtd></mtr></mtable><mo>,</mo></math><img id="ib0112" file="imgb0112.tif" wi="157" he="21" img-content="math" img-format="tif"/></maths><br/>
which contain a residual error determined by the vector <maths id="math0112" num=""><math display="inline"><msubsup><mi>ε</mi><mn>0</mn><mi>f</mi></msubsup><mo>⁢</mo><msubsup><mi>ν</mi><mi>k</mi><mrow><mfenced separators=""><mi mathvariant="italic">cτ</mi><mo>⁢</mo><mi>a</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup><mo>⁢</mo><msup><mover><mi mathvariant="bold">b</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mn>.</mn></math><img id="ib0113" file="imgb0113.tif" wi="38" he="9" img-content="math" img-format="tif" inline="yes"/></maths><br/>
Therefore, if the value <maths id="math0113" num=""><math display="inline"><mfenced open="|" close="|" separators=""><msubsup><mi>ε</mi><mn>0</mn><mi>f</mi></msubsup><mo>⁢</mo><msubsup><mi>ν</mi><mi>k</mi><mrow><mfenced separators=""><mi mathvariant="italic">cτ</mi><mo>⁢</mo><mi>a</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mfenced><mo>⋅</mo><mfenced open="|" close="|"><msup><mover><mi mathvariant="bold">b</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></mfenced></math><img id="ib0114" file="imgb0114.tif" wi="44" he="10" img-content="math" img-format="tif" inline="yes"/></maths> lies within user-defined limits, it can be neglected. Most of the error <maths id="math0114" num=""><math display="inline"><msubsup><mi>ν</mi><mi>k</mi><mrow><mfenced separators=""><mi mathvariant="italic">cτ</mi><mo>⁢</mo><mi>a</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></math><img id="ib0115" file="imgb0115.tif" wi="18" he="9" img-content="math" img-format="tif" inline="yes"/></maths> goes into the estimate of the value <maths id="math0115" num=""><math display="inline"><msubsup><mi mathvariant="normal">Ψ</mi><mi>k</mi><mi>f</mi></msubsup></math><img id="ib0116" file="imgb0116.tif" wi="10" he="9" img-content="math" img-format="tif" inline="yes"/></maths> and does not substantially affect the coordinate estimate.</p><p id="p0064" num="0064">Another method for eliminating clock offset and phase offset utilizes addition of the equation from the code task to the extended matrix (E14) as follows: <maths id="math0116" num="(E17)"><math display="block"><mfenced open="[" close="]"><mtable><mtr><mtd><mtable><mtr><mtd><msubsup><mi mathvariant="normal">C</mi><mrow><mi>τ</mi><mo>,</mo><mi>τ</mi></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><msubsup><mi mathvariant="normal">C</mi><mrow><mi>τ</mi><mo>,</mo><mover><mi>r</mi><mi mathvariant="normal">r</mi></mover></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msup><mover><mi mathvariant="bold">w</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></mtd><mtd><msup><mover><mi mathvariant="bold">λ</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></mtd><mtd><msubsup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mi>cos</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable><mrow><mo>|</mo></mrow></mtd><mtd><mtable><mtr><mtd><msubsup><mi>c</mi><mi>τ</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msup><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></mtd></mtr></mtable></mtd></mtr></mtable></mfenced><mn>.</mn></math><img id="ib0117" file="imgb0117.tif" wi="129" he="24" img-content="math" img-format="tif"/></maths><br/>
The elimination of clock offset and phase offset is performed by two successive Householder's transformations of (E17). The first transformation resets subdiagonal elements of the first column (sets them to 0); the second transformation resets subdiagonal elements of the second column:<!-- EPO <DP n="32"> --> <maths id="math0117" num="(E18)"><math display="block"><mfenced open="[" close="]"><mtable><mtr><mtd><mtable><mtr><mtd><msubsup><mi>C</mi><mrow><mi>τ</mi><mo>,</mo><mi>τ</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mi>C</mi><mrow><mi>τ</mi><mo>,</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>ψ</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mi mathvariant="bold">C</mi><mrow><mi>τ</mi><mo>,</mo><mover><mi>r</mi><mi mathvariant="normal">r</mi></mover></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msubsup><mi>C</mi><mrow><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>ψ</mi><mo>,</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>ψ</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mi mathvariant="bold">C</mi><mrow><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>ψ</mi><mo>,</mo><mover><mi>r</mi><mi mathvariant="normal">r</mi></mover></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msub><mn mathvariant="bold">0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mn mathvariant="bold">0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mn>1</mn></mrow></msub></mtd><mtd><msubsup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable><mrow><mo>|</mo></mrow></mtd><mtd><mtable><mtr><mtd><msubsup><mi>c</mi><mi>τ</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mi>c</mi><mrow><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>ψ</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable></mtd></mtr></mtable></mfenced><mn>.</mn></math><img id="ib0118" file="imgb0118.tif" wi="133" he="35" img-content="math" img-format="tif"/></maths><br/>
As a result, obtain linearized observation equations for unambiguous phases with expanded matrix <maths id="math0118" num=""><math display="inline"><mfenced open="[" close="]" separators=""><msubsup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup><mrow><mo>|</mo></mrow><msubsup><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mfenced></math><img id="ib0119" file="imgb0119.tif" wi="36" he="10" img-content="math" img-format="tif" inline="yes"/></maths> that are independent of clock offset and phase offset. This method for eliminating clock offset and phase offset provides a heuristic procedure for co-processing code and carrier phase measurements.</p><p id="p0065" num="0065">Positioning. Positioning is implemented according to normal equations. Matrices are generated according to: <maths id="math0119" num="(E19)"><math display="block"><mi mathvariant="bold">D</mi><mo>=</mo><mstyle displaystyle="false"><mstyle displaystyle="true"><munder><mo>∑</mo><mi>f</mi></munder></mstyle><msup><mfenced open="[" close="]"><msup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mi>f</mi></msup></mfenced><mi>T</mi></msup><mfenced open="[" close="]"><msup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mi>f</mi></msup></mfenced></mstyle></math><img id="ib0120" file="imgb0120.tif" wi="107" he="19" img-content="math" img-format="tif"/></maths> <maths id="math0120" num=""><math display="block"><mi mathvariant="bold">d</mi><mo>=</mo><mstyle displaystyle="false"><mstyle displaystyle="true"><munder><mo>∑</mo><mi>f</mi></munder></mstyle><msup><mfenced open="[" close="]"><msup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mi>f</mi></msup></mfenced><mi>T</mi></msup><mfenced open="[" close="]"><msup><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mi>f</mi></msup></mfenced></mstyle></math><img id="ib0121" file="imgb0121.tif" wi="55" he="19" img-content="math" img-format="tif"/></maths><br/>
and a correction to the current position is determined: <maths id="math0121" num="(E20)"><math display="block"><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi mathvariant="bold">r</mi><mo>=</mo><msup><mi mathvariant="bold">D</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⋅</mo><mi mathvariant="bold">d</mi><mn>.</mn></math><img id="ib0122" file="imgb0122.tif" wi="107" he="13" img-content="math" img-format="tif"/></maths><br/>
<o>H</o><i><sup>f</sup></i>, <o>y</o><i><sup>f</sup></i> correspond to the normalized double differences obtained from (E13), (E17), and (E18). <b>d</b> is referred to as an information vector. <b>D</b> is referred to as an information matrix of estimate. It is related to the covariance matrix <b>P</b> as follows: <b>P</b>=<b>D</b><sup>-1</sup>. The combined set {<b>D,d</b>} is called information coordinates.<!-- EPO <DP n="33"> --></p><p id="p0066" num="0066"><b>Generating Residuals.</b> In solving a problem with normalized double difference combinations, coordinate estimates are determined using double differences, but clock offset <maths id="math0122" num=""><math display="inline"><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup></math><img id="ib0123" file="imgb0123.tif" wi="9" he="9" img-content="math" img-format="tif" inline="yes"/></maths> and phase offset <maths id="math0123" num=""><math display="inline"><msubsup><mi mathvariant="normal">Ψ</mi><mi>k</mi><mi>f</mi></msubsup></math><img id="ib0124" file="imgb0124.tif" wi="9" he="9" img-content="math" img-format="tif" inline="yes"/></maths> are not determined. To correct anomalies, single differences are defined instead of double differences. It is important to make sure that reference satellite anomalies do not affect all the remaining measurements. For example, for one frequency, the following code measurements are available: <maths id="math0124" num="(E21)"><math display="block"><msup><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>=</mo><msup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>⁢</mo><msup><mi mathvariant="bold">x</mi><mi>f</mi></msup></math><img id="ib0125" file="imgb0125.tif" wi="134" he="13" img-content="math" img-format="tif"/></maths> <maths id="math0125" num=""><math display="block"><msup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>:</mo><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><msup><mover><mi mathvariant="bold">w</mi><mo>‾</mo></mover><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></mtd><mtd><msubsup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mi>cos</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable></mfenced></math><img id="ib0126" file="imgb0126.tif" wi="67" he="16" img-content="math" img-format="tif"/></maths> <maths id="math0126" num=""><math display="block"><msup><mi mathvariant="bold">x</mi><mi>f</mi></msup><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><mi>c</mi><mo>⁢</mo><msup><mi>τ</mi><mi>f</mi></msup></mtd></mtr><mtr><mtd><mi mathvariant="bold">Δr</mi></mtd></mtr></mtable></mfenced><mn>.</mn></math><img id="ib0127" file="imgb0127.tif" wi="35" he="19" img-content="math" img-format="tif"/></maths><br/>
Assume equations (E21) are linearized for a code solution. Then the estimate of the position correction is equal to zero: <b>Δr</b> = 0. Vector <b><o>y</o></b><sup>(<i>ρ</i>)<i>f</i></sup> is the vector of partial residuals based on geometric coordinates. Then (E21) transforms into: <maths id="math0127" num="(E22)"><math display="block"><msup><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>=</mo><msup><mover><mi mathvariant="bold">w</mi><mo>‾</mo></mover><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>⁢</mo><mi>c</mi><mo>⁢</mo><msup><mi>τ</mi><mi>f</mi></msup></math><img id="ib0128" file="imgb0128.tif" wi="106" he="14" img-content="math" img-format="tif"/></maths><br/>
with unknown Γ<i><sup>f</sup></i>. The value Γ<i><sup>f</sup></i> can be estimated as follows: <maths id="math0128" num=""><math display="block"><msup><mover><mi mathvariant="normal">Γ</mi><mo>^</mo></mover><mi>f</mi></msup><mo>=</mo><mfrac><mrow><mo>〈</mo><msup><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>,</mo><msup><mover><mi mathvariant="bold">w</mi><mo>‾</mo></mover><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>〉</mo></mrow><mrow><mo>〈</mo><msup><mover><mi mathvariant="bold">w</mi><mo>‾</mo></mover><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>,</mo><msup><mover><mi mathvariant="bold">w</mi><mo>‾</mo></mover><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>〉</mo></mrow></mfrac></math><img id="ib0129" file="imgb0129.tif" wi="59" he="24" img-content="math" img-format="tif"/></maths><br/>
and compensate it from (E22):<!-- EPO <DP n="34"> --> <maths id="math0129" num="(E23)"><math display="block"><mi mathvariant="bold">δ</mi><mo>⁢</mo><msup><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>=</mo><msup><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>-</mo><msup><mover><mi mathvariant="bold">w</mi><mo>‾</mo></mover><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>⁢</mo><msup><mover><mi mathvariant="normal">Γ</mi><mo>^</mo></mover><mi>f</mi></msup><mn>.</mn></math><img id="ib0130" file="imgb0130.tif" wi="130" he="14" img-content="math" img-format="tif"/></maths><br/>
Vector δ<b><o>y</o></b><sup>(<i>ρ</i>)<i>f</i></sup> is the desired vector of single difference residuals. In (E23), LSM-estimate of clock offset has been used. Single differences residuals for other anomaly detectors are defined in a similar way.</p><p id="p0067" num="0067"><b>Criteria for Detecting Anomalies</b>. Anomaly criteria are used to specify when there is an anomaly in the current set of measurements. The weighted sum of residual squares (WSRS) |δ<b><o>y</o></b>|<sup>2</sup> has a distribution <i>χ<sup>2</sup></i>(<i>m- n</i>) [see Lawson], where <i>m</i> is the number of equations, and <i>n</i> is the number of unknowns. In an embodiment, measurements are anomalous if <maths id="math0130" num="(E24)"><math display="block"><msup><mfenced open="|" close="|" separators=""><mi mathvariant="bold">δ</mi><mo>⁢</mo><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mn>2</mn></msup><mo>&gt;</mo><msubsup><mi>χ</mi><mrow><mn>1</mn><mo>-</mo><mi>α</mi></mrow><mn>2</mn></msubsup><mo>⁢</mo><mfenced separators=""><mi>m</mi><mo>-</mo><mi>n</mi></mfenced><mo>,</mo></math><img id="ib0131" file="imgb0131.tif" wi="109" he="15" img-content="math" img-format="tif"/></maths><br/>
where α is the confidence level for the measurements. Here measurements refer to the code single differences, phase single differences, and phase increments single differences.</p><p id="p0068" num="0068">In another embodiment, measurements are anomalous if the residuals |δγ<sub>i</sub>| or the weighted residuals |<i>δ<o>γ</o><sub>¡</sub></i>| exceed user-specified threshold values: <maths id="math0131" num="(E25)"><math display="block"><mfenced open="|" close="|" separators=""><mi>δ</mi><mo>⁢</mo><msub><mi>y</mi><mi>i</mi></msub></mfenced><mo>&gt;</mo><mi>MaxRes</mi></math><img id="ib0132" file="imgb0132.tif" wi="109" he="13" img-content="math" img-format="tif"/></maths> <maths id="math0132" num="(E26)"><math display="block"><mfenced open="|" close="|" separators=""><mi>δ</mi><mo>⁢</mo><msub><mover><mi>y</mi><mo>‾</mo></mover><mi>i</mi></msub></mfenced><mo>&gt;</mo><mi>MaxWRes</mi><mn>.</mn></math><img id="ib0133" file="imgb0133.tif" wi="109" he="13" img-content="math" img-format="tif"/></maths><br/>
For example, value of MaxWRes=3 corresponds to the "three sigmas rule".</p><p id="p0069" num="0069">Consider a linear model of observation:<!-- EPO <DP n="35"> --> <maths id="math0133" num="(E27)"><math display="block"><mi mathvariant="bold">y</mi><mo>=</mo><mi mathvariant="bold">Hx</mi><mo>+</mo><msup><mi mathvariant="bold">ζ</mi><mi mathvariant="bold">y</mi></msup><mn mathvariant="bold">.</mn></math><img id="ib0134" file="imgb0134.tif" wi="107" he="16" img-content="math" img-format="tif"/></maths><br/>
Then consider the corresponding observation model with normalized noise: <maths id="math0134" num="(E28)"><math display="block"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mo>=</mo><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mo>⁢</mo><mi mathvariant="bold">x</mi><mo>+</mo><msup><mover><mi mathvariant="bold">ζ</mi><mo>‾</mo></mover><mi mathvariant="bold">y</mi></msup><mn mathvariant="bold">.</mn></math><img id="ib0135" file="imgb0135.tif" wi="105" he="15" img-content="math" img-format="tif"/></maths><br/>
If anomalies are not present, then the weighted sum of residuals squares |δ<b><o>y</o></b>(<b>x̂</b>)|<sup>2</sup> has a distribution χ<sup>2</sup> (<i>m - n</i>), where <i>m</i> is the number of equations, and <i>n</i> is the number of unknowns. Now assume two hypotheses:
<dl id="dl0001" compact="compact"><dt><i>H</i><sub>0</sub> : the</dt><dd>sum of residuals squares has a distribution χ<sup>2</sup> (<i>m</i> - <i>n</i>) (no anomalies present).</dd><dt><i>H</i><sub>1</sub> : the</dt><dd>sum of residuals squares has a different distribution (at least one anomaly present).</dd></dl>
Designate the probability of a type 1 error (also referred to as a "false alarm") as α.<br/>
According to a criterion based on the χ<sup>2</sup> distribution, a measurement is anomalous if: <maths id="math0135" num="(E29)"><math display="block"><msup><mfenced open="|" close="|" separators=""><mi mathvariant="bold">δ</mi><mo>⁢</mo><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mn>2</mn></msup><mo>&gt;</mo><msubsup><mi>χ</mi><mrow><mn>1</mn><mo>-</mo><mi>α</mi></mrow><mn>2</mn></msubsup><mo>⁢</mo><mfenced separators=""><mi>m</mi><mo>-</mo><mi>n</mi></mfenced><mn>.</mn></math><img id="ib0136" file="imgb0136.tif" wi="106" he="15" img-content="math" img-format="tif"/></maths><br/>
If the weighted sum of residuals squares exceeds a threshold value (which is a fractile of the distribution) <maths id="math0136" num=""><math display="inline"><msubsup><mi>χ</mi><mrow><mn>1</mn><mo>-</mo><mi>α</mi></mrow><mn>2</mn></msubsup><mo>⁢</mo><mfenced separators=""><mi>m</mi><mo>-</mo><mi>n</mi></mfenced><mo>,</mo></math><img id="ib0137" file="imgb0137.tif" wi="31" he="9" img-content="math" img-format="tif" inline="yes"/></maths> then an anomaly is assumed to be present.<!-- EPO <DP n="36"> --></p><p id="p0070" num="0070">Elimination of anomalous measurements can be done according to the following method. For the range <i>i</i> = <o>1; m</o>, remove the <i>i</i> - <i>th</i> equation from the observation model. Then solve the LSM task and determine the weighted sum of residuals squares |δ<b><o>y</o></b><sub>(<i>i</i>)</sub>(<b>x̂</b><sub>(<i>i</i>)</sub>)|<sup>2</sup> for solution <b>x̂</b><sub>(<i>i</i>)</sub>. The measurement for which the value |δ<b><o>y</o></b><sub>(<i>i</i>)</sub>(<b>x̂</b><sub>(<i>i</i>)</sub>)|<sup>2</sup> is minimal is considered to be anomalous. If the weighted sum of residuals squares in the process of eliminating the anomalous equation exceeds the threshold <maths id="math0137" num=""><math display="inline"><msup><mfenced open="|" close="|" separators=""><mi mathvariant="bold">δ</mi><mo>⁢</mo><msub><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mfenced><mi>i</mi></mfenced></msub></mfenced><mn>2</mn></msup><mo>&gt;</mo><msubsup><mi>χ</mi><mrow><mn>1</mn><mo>-</mo><mi>α</mi></mrow><mn>2</mn></msubsup><mo>⁢</mo><mfenced separators=""><mi>m</mi><mo>-</mo><mn>1</mn><mo>-</mo><mi>n</mi></mfenced><mo>,</mo></math><img id="ib0138" file="imgb0138.tif" wi="62" he="12" img-content="math" img-format="tif" inline="yes"/></maths> then repeat the procedure for observations <maths id="math0138" num="(E30)"><math display="block"><msub><mi mathvariant="bold">y</mi><mfenced><mi>i</mi></mfenced></msub><mo>=</mo><msub><mi mathvariant="bold">H</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><mi>x</mi><mo>+</mo><msub><mi mathvariant="normal">ζ</mi><mfenced><mi>i</mi></mfenced></msub><mn>.</mn></math><img id="ib0139" file="imgb0139.tif" wi="119" he="14" img-content="math" img-format="tif"/></maths></p><p id="p0071" num="0071">The searching procedure described above is very time consuming because it requires solving the LSM task for each observation model. It utilizes approximately <i>O</i>((<i>n<sup>2</sup>·m + n<sup>3</sup></i> / 3)<i>m</i>) flops. Since <i>m</i> is large, there are O(<i>n<sup>2</sup>m<sup>2</sup></i>) flops. A faster scheme for estimating and obtaining weighted sums of residuals squares is described below. It utilizes <i>O</i>(<i>n<sup>2</sup>m</i>) flops; therefore, it is <i>m</i> times smaller. This is substantial for GNSS, where <i>m</i> can be 20 or greater. This approach reduces processor load substantially and yields the same result. For simplicity, assume that the covariance matrix of the observation noise is diagonal. The process of elimination used for the original observation model is followed. This scheme is effective for applications in addition to GNSS. One skilled in the art can apply the method expanded for any observation model represented by (E28).</p><p id="p0072" num="0072">The LSM estimate of the state vector for the whole set of observation equations is equal to<!-- EPO <DP n="37"> --> <maths id="math0139" num="(E31)"><math display="block"><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover><mo>=</mo><msup><mfenced open="[" close="]"><mover><mi mathvariant="bold">D</mi><mo>^</mo></mover></mfenced><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><mover><mi mathvariant="bold">d</mi><mo>^</mo></mover><mo>,</mo></math><img id="ib0140" file="imgb0140.tif" wi="116" he="12" img-content="math" img-format="tif"/></maths> <maths id="math0140" num=""><math display="block"><mover><mi mathvariant="bold">D</mi><mo>^</mo></mover><mo>=</mo><msup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mi>T</mi></msup><mo>⁢</mo><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover></math><img id="ib0141" file="imgb0141.tif" wi="33" he="10" img-content="math" img-format="tif"/></maths> <maths id="math0141" num=""><math display="block"><mover><mi mathvariant="bold">d</mi><mo>^</mo></mover><mo>=</mo><msup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mi>T</mi></msup><mo>⁢</mo><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mn>.</mn></math><img id="ib0142" file="imgb0142.tif" wi="33" he="12" img-content="math" img-format="tif"/></maths><br/>
The weighted sum of residuals squares is then: <maths id="math0142" num="(E32)"><math display="block"><msup><mfenced open="|" close="|" separators=""><mi mathvariant="bold">δ</mi><mo>⁢</mo><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mfenced><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover></mfenced></mfenced><mn>2</mn></msup><mo>=</mo><msup><mfenced open="|" close="|" separators=""><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mo>-</mo><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mo>⁢</mo><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover></mfenced><mn>2</mn></msup><mn>.</mn></math><img id="ib0143" file="imgb0143.tif" wi="119" he="16" img-content="math" img-format="tif"/></maths><br/>
When the <i>i</i> - <i>th</i> measurement is eliminated, the estimate <b>x̂</b><sub>(<i>i</i>)</sub> is obtained. To express it through the estimated <b>x̂</b><sub>(<i>i</i>)</sub> and eliminated measurement <i>y<sub>i</sub></i>, designate <b>h</b><sub>(i)</sub> = <b><o>H</o></b><sub>[<i>i</i>],[:]</sub>. The peer-to-peer information coordinates updates are: <maths id="math0143" num="(E33)"><math display="block"><msub><mover><mi mathvariant="bold">D</mi><mo>^</mo></mover><mfenced><mi>i</mi></mfenced></msub><mo>:</mo><mo>=</mo><mover><mi mathvariant="bold">D</mi><mo>^</mo></mover><mo>-</mo><msup><mfenced open="[" close="]"><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub></mfenced><mi>T</mi></msup><mfenced open="[" close="]"><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub></mfenced></math><img id="ib0144" file="imgb0144.tif" wi="118" he="13" img-content="math" img-format="tif"/></maths> <maths id="math0144" num=""><math display="block"><msub><mover><mi mathvariant="bold">d</mi><mo>^</mo></mover><mfenced><mi>i</mi></mfenced></msub><mo>:</mo><mo>=</mo><mover><mi mathvariant="bold">d</mi><mo>^</mo></mover><mo>-</mo><msup><mfenced open="[" close="]"><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub></mfenced><mi>T</mi></msup><mo>⁢</mo><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>i</mi></msub><mn>.</mn></math><img id="ib0145" file="imgb0145.tif" wi="56" he="15" img-content="math" img-format="tif"/></maths><br/>
Therefore: <maths id="math0145" num="(E34)"><math display="block"><mtable columnalign="left"><mtr><mtd><msub><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover><mfenced><mi>i</mi></mfenced></msub></mtd><mtd><mo>=</mo><msup><msub><mover><mi mathvariant="bold">D</mi><mo>^</mo></mover><mfenced><mi>i</mi></mfenced></msub><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><msub><mover><mi mathvariant="bold">d</mi><mo>^</mo></mover><mfenced><mi>i</mi></mfenced></msub></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><msup><mfenced separators=""><mover><mi mathvariant="bold">D</mi><mo>^</mo></mover><mo>-</mo><msubsup><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced><mi>T</mi></msubsup><mo>⁢</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub></mfenced><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><mfenced separators=""><mover><mi mathvariant="bold">d</mi><mo>^</mo></mover><mo>-</mo><msubsup><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced><mi>T</mi></msubsup><mo>⁢</mo><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>i</mi></msub></mfenced></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><mfenced separators=""><msup><mover><mi mathvariant="bold">D</mi><mo>^</mo></mover><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>+</mo><msub><mi>c</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><msub><mi mathvariant="bold">w</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><msup><msub><mi mathvariant="bold">w</mi><mfenced><mi>i</mi></mfenced></msub><mi>T</mi></msup></mfenced><mo>⁢</mo><mfenced separators=""><mover><mi mathvariant="bold">d</mi><mo>^</mo></mover><mo>-</mo><msubsup><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced><mi>T</mi></msubsup><mo>⁢</mo><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>i</mi></msub></mfenced><mo>,</mo></mtd></mtr></mtable></math><img id="ib0146" file="imgb0146.tif" wi="129" he="28" img-content="math" img-format="tif"/></maths><br/>
where <maths id="math0146" num="(E35)"><math display="block"><msub><mi mathvariant="bold">w</mi><mfenced><mi>i</mi></mfenced></msub><mo>=</mo><msup><mover><mi mathvariant="bold">D</mi><mo>^</mo></mover><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><msup><mfenced open="[" close="]"><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub></mfenced><mi>T</mi></msup></math><img id="ib0147" file="imgb0147.tif" wi="110" he="14" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="38"> --> <maths id="math0147" num=""><math display="block"><msub><mi>c</mi><mfenced><mi>i</mi></mfenced></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>-</mo><msub><mi>k</mi><mfenced><mi>i</mi></mfenced></msub></mrow></mfrac></math><img id="ib0148" file="imgb0148.tif" wi="40" he="22" img-content="math" img-format="tif"/></maths> <maths id="math0148" num=""><math display="block"><msub><mi>k</mi><mfenced><mi>i</mi></mfenced></msub><mo>=</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><msub><mi mathvariant="bold">w</mi><mfenced><mi>i</mi></mfenced></msub><mn>.</mn></math><img id="ib0149" file="imgb0149.tif" wi="40" he="12" img-content="math" img-format="tif"/></maths><br/>
Multiplying the matrices in (E34), and substituting the values in (E35), yields peer-to-peer state vector update: <maths id="math0149" num="(E36)"><math display="block"><msub><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover><mfenced><mi>i</mi></mfenced></msub><mo>=</mo><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover><mo>-</mo><msub><mi>c</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><msub><mi mathvariant="bold">w</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><mfenced separators=""><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>i</mi></msub><mo>-</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover></mfenced><mn>.</mn></math><img id="ib0150" file="imgb0150.tif" wi="118" he="13" img-content="math" img-format="tif"/></maths><br/>
The weighted sum of residuals squares peer-to-peer update for the eliminated <i>i</i> - <i>th</i> equation is then: <maths id="math0150" num="(E37)"><math display="block"><mtable columnalign="left"><mtr><mtd><msup><mfenced open="|" close="|" separators=""><mi mathvariant="bold">δ</mi><mo>⁢</mo><msub><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mfenced><mi>i</mi></mfenced></msub><mfenced><msub><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover><mfenced><mi>i</mi></mfenced></msub></mfenced></mfenced><mn>2</mn></msup></mtd><mtd><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo>≠</mo><mi>i</mi></mrow><mi>m</mi></munderover></mstyle><msup><mfenced separators=""><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>j</mi></msub><mo>-</mo><msub><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mrow><mfenced open="[" close="]"><mi>j</mi></mfenced><mo>,</mo><mfenced open="[" close="]"><mo>:</mo></mfenced></mrow></msub><mo>⁢</mo><msub><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover><mfenced><mi>i</mi></mfenced></msub></mfenced><mn>2</mn></msup></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover></mstyle><msup><mfenced separators=""><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>j</mi></msub><mo>-</mo><msub><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mrow><mfenced open="[" close="]"><mi>j</mi></mfenced><mo>,</mo><mfenced open="[" close="]"><mo>:</mo></mfenced></mrow></msub><mo>⁢</mo><msub><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover><mfenced><mi>i</mi></mfenced></msub></mfenced><mn>2</mn></msup><mo>-</mo><msup><mfenced separators=""><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>i</mi></msub><mo>-</mo><msub><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mrow><mfenced open="[" close="]"><mi>i</mi></mfenced><mo>,</mo><mfenced open="[" close="]"><mo>:</mo></mfenced></mrow></msub><mo>⁢</mo><msub><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover><mfenced><mi>i</mi></mfenced></msub></mfenced><mn>2</mn></msup></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><msup><mfenced open="|" close="|" separators=""><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mo>-</mo><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mo>⁢</mo><msub><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover><mfenced><mi>i</mi></mfenced></msub></mfenced><mn>2</mn></msup><mo>-</mo><msup><mfenced separators=""><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>i</mi></msub><mo>-</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><msub><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover><mfenced><mi>i</mi></mfenced></msub></mfenced><mn>2</mn></msup><mn>.</mn></mtd></mtr></mtable></math><img id="ib0151" file="imgb0151.tif" wi="165" he="47" img-content="math" img-format="tif"/></maths><br/>
(E37) can be simplified as: <maths id="math0151" num="(E38)"><math display="block"><mtable columnalign="left"><mtr><mtd><msup><mfenced open="|" close="|" separators=""><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mo>-</mo><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mo>⁢</mo><msub><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover><mfenced><mi>i</mi></mfenced></msub></mfenced><mn>2</mn></msup></mtd><mtd><mo>=</mo><msup><mfenced open="|" close="|" separators=""><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mo>-</mo><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mo>⁢</mo><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover></mfenced><mn>2</mn></msup><mo>+</mo><msup><mfenced open="|" close="|" separators=""><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mo>⁢</mo><msub><mi mathvariant="bold">w</mi><mfenced><mi>i</mi></mfenced></msub></mfenced><mn>2</mn></msup><mo>⁢</mo><msubsup><mi>c</mi><mfenced><mi>i</mi></mfenced><mn>2</mn></msubsup><mo>⁢</mo><msup><mfenced separators=""><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>i</mi></msub><mo>-</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover></mfenced><mn>2</mn></msup></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><msup><mfenced open="|" close="|" separators=""><mi mathvariant="bold">δ</mi><mo>⁢</mo><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mfenced><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover></mfenced></mfenced><mn>2</mn></msup><mo>+</mo><msub><mi>k</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><msubsup><mi>c</mi><mfenced><mi>i</mi></mfenced><mn>2</mn></msubsup><mo>⁢</mo><msup><mfenced separators=""><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>i</mi></msub><mo>-</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover></mfenced><mn>2</mn></msup><mn>.</mn></mtd></mtr></mtable></math><img id="ib0152" file="imgb0152.tif" wi="158" he="25" img-content="math" img-format="tif"/></maths><br/>
This follows from:<!-- EPO <DP n="39"> --> <maths id="math0152" num=""><math display="block"><mtable columnalign="left"><mtr><mtd><msup><mfenced open="|" close="|" separators=""><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mo>⁢</mo><msub><mi mathvariant="bold">w</mi><mfenced><mi>i</mi></mfenced></msub></mfenced><mn>2</mn></msup></mtd><mtd><mo>=</mo><msubsup><mi mathvariant="bold">w</mi><mfenced><mi>i</mi></mfenced><mi>T</mi></msubsup><mo>⁢</mo><msup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mi>T</mi></msup><mo>⁢</mo><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mo>⁢</mo><msub><mi mathvariant="bold">w</mi><mfenced><mi>i</mi></mfenced></msub></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><msubsup><mi mathvariant="bold">w</mi><mfenced><mi>i</mi></mfenced><mi>T</mi></msubsup><mo>⁢</mo><mover><mi mathvariant="bold">D</mi><mo>^</mo></mover><mo>⁢</mo><msub><mi mathvariant="bold">w</mi><mfenced><mi>i</mi></mfenced></msub></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><msup><mover><mi mathvariant="bold">D</mi><mo>^</mo></mover><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><mover><mi mathvariant="bold">D</mi><mo>^</mo></mover><mo>⁢</mo><msub><mi mathvariant="bold">w</mi><mfenced><mi>i</mi></mfenced></msub></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><msub><mi mathvariant="bold">w</mi><mfenced><mi>i</mi></mfenced></msub></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><msub><mi>k</mi><mfenced><mi>i</mi></mfenced></msub></mtd></mtr></mtable></math><img id="ib0153" file="imgb0153.tif" wi="69" he="49" img-content="math" img-format="tif"/></maths><br/>
and <maths id="math0153" num=""><math display="block"><msup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mi>T</mi></msup><mo>⁢</mo><mfenced separators=""><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mo>-</mo><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mo>⁢</mo><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover></mfenced><mo>=</mo><mn>0.</mn></math><img id="ib0154" file="imgb0154.tif" wi="47" he="13" img-content="math" img-format="tif"/></maths><br/>
Using <maths id="math0154" num=""><math display="block"><mtable columnalign="left"><mtr><mtd><mn>1</mn><mo>+</mo><msub><mi>c</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><msub><mi>k</mi><mfenced><mi>i</mi></mfenced></msub></mtd><mtd><mo>=</mo><mn>1</mn><mo>+</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>-</mo><msub><mi>k</mi><mfenced><mi>i</mi></mfenced></msub></mrow></mfrac><mo>⁢</mo><msub><mi>k</mi><mfenced><mi>i</mi></mfenced></msub></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>-</mo><msub><mi>k</mi><mfenced><mi>i</mi></mfenced></msub></mrow></mfrac></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><msub><mi>c</mi><mfenced><mi>i</mi></mfenced></msub><mo>,</mo></mtd></mtr></mtable></math><img id="ib0155" file="imgb0155.tif" wi="70" he="46" img-content="math" img-format="tif"/></maths><br/>
then calculate: <maths id="math0155" num="(E39)"><math display="block"><mtable columnalign="left"><mtr><mtd><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>i</mi></msub><mo>-</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><msub><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover><mfenced><mi>i</mi></mfenced></msub></mtd><mtd><mo>=</mo><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>i</mi></msub><mo>-</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><mfenced separators=""><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover><mo>-</mo><msub><mi>c</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><msub><mi mathvariant="bold">w</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><mfenced separators=""><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>i</mi></msub><mo>-</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover></mfenced></mfenced></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><mfenced separators=""><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>i</mi></msub><mo>-</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover></mfenced><mo>+</mo><msub><mi>c</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><msub><mi mathvariant="bold">w</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><mfenced separators=""><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>i</mi></msub><mo>-</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover></mfenced></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><msub><mi>c</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><mfenced separators=""><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>i</mi></msub><mo>-</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover></mfenced><mn>.</mn></mtd></mtr></mtable></math><img id="ib0156" file="imgb0156.tif" wi="142" he="28" img-content="math" img-format="tif"/></maths><br/>
After all these transformations have been performed, the weighted sum of residuals squares when the <i>i</i> - <i>th</i> equation is eliminated is:<!-- EPO <DP n="40"> --> <maths id="math0156" num="(E40)"><math display="block"><mtable columnalign="left"><mtr><mtd><msup><mfenced open="|" close="|" separators=""><mi mathvariant="bold">δ</mi><mo>⁢</mo><msub><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mfenced><mi>i</mi></mfenced></msub><mfenced><msub><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover><mfenced><mi>i</mi></mfenced></msub></mfenced></mfenced><mn>2</mn></msup></mtd><mtd><mo>=</mo><msup><mfenced open="|" close="|" separators=""><mi mathvariant="bold">δ</mi><mo>⁢</mo><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mfenced><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover></mfenced></mfenced><mn>2</mn></msup><mo>+</mo><msub><mi>k</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><msubsup><mi>c</mi><mfenced><mi>i</mi></mfenced><mn>2</mn></msubsup><mo>⁢</mo><msup><mfenced separators=""><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>i</mi></msub><mo>-</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover></mfenced><mn>2</mn></msup><mo>-</mo><msubsup><mi>c</mi><mfenced><mi>i</mi></mfenced><mn>2</mn></msubsup><mo>⁢</mo><msup><mfenced separators=""><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>i</mi></msub><mo>-</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover></mfenced><mn>2</mn></msup></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><msup><mfenced open="|" close="|" separators=""><mi mathvariant="bold">δ</mi><mo>⁢</mo><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mfenced><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover></mfenced></mfenced><mn>2</mn></msup><mo>-</mo><msub><mi>c</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><msup><mfenced separators=""><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>i</mi></msub><mo>-</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover></mfenced><mn>2</mn></msup><mn>.</mn></mtd></mtr></mtable></math><img id="ib0157" file="imgb0157.tif" wi="146" he="34" img-content="math" img-format="tif"/></maths><br/>
Therefore, minimization of the weighted sum of residuals squares is equivalent to maximization of values <i>C</i><sub>(<i>i</i>)</sub> ([<b><o>y</o></b>]<i><sub>i</sub></i> - <b>h</b><sub>(<i>i</i>)</sub><b>x̂</b>)<sup>2</sup>. Since the residual is equal to <maths id="math0157" num="(E41)"><math display="block"><mtable columnalign="left"><mtr><mtd><mi mathvariant="bold">δ</mi><mo>⁢</mo><msub><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mi>i</mi></msub><mfenced><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover></mfenced></mtd><mtd><mo>=</mo><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>i</mi></msub><mo>-</mo><msub><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mrow><mfenced open="[" close="]"><mi>i</mi></mfenced><mo>,</mo><mfenced open="[" close="]"><mo>:</mo></mfenced></mrow></msub><mo>⁢</mo><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><msub><mfenced open="[" close="]"><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mi>i</mi></msub><mo>-</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover><mo>,</mo></mtd></mtr></mtable></math><img id="ib0158" file="imgb0158.tif" wi="118" he="21" img-content="math" img-format="tif"/></maths><br/>
the searching algorithm differs from selecting the absolute maximal residual in having the extra weight multiplier C<sub>(<i>i</i>)</sub>, which was determined in (E35).</p><p id="p0073" num="0073">The searching procedure for one anomaly in information coordinates can be described by the following pseudo-code:<!-- EPO <DP n="41"> --> <maths id="math0158" num="(E42)"><math display="block"><mtable columnalign="left"><mtr><mtd><mfenced open="[" close="]" separators=""><msub><mi>i</mi><mi>min</mi></msub><mo>⁢</mo><msub><mi>V</mi><mi>min</mi></msub><mo>⁢</mo><msub><mi>c</mi><mi>min</mi></msub><mo>⁢</mo><msub><mi mathvariant="bold">w</mi><mi>min</mi></msub></mfenced><mo>:</mo><mo>=</mo><mi>BadMeasSearch</mi><mfenced separators=""><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mo>,</mo><mi mathvariant="bold">δ</mi><mo>⁢</mo><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mo>,</mo><mo>&amp;</mo><mi mathvariant="bold">P</mi><mo>,</mo><mo>&amp;</mo><mi mathvariant="bold">x</mi></mfenced></mtd></mtr><mtr><mtd><mspace width="2em"/><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mo>∈</mo><msub><mi mathvariant="bold">M</mi><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow></msub><mfenced><mi mathvariant="normal">i</mi></mfenced><mo>,</mo><mi mathvariant="bold">δ</mi><mo>⁢</mo><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mo>∈</mo><msub><mi mathvariant="bold">M</mi><mrow><mi>m</mi><mo>×</mo><mn>1</mn></mrow></msub><mfenced><mi mathvariant="normal">i</mi></mfenced><mo>,</mo><mi mathvariant="bold">P</mi><mo>∈</mo><msub><mi mathvariant="bold">M</mi><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow></msub><mfenced><mi mathvariant="normal">i</mi></mfenced><mo>,</mo><mi mathvariant="bold">x</mi><mo>∈</mo><msub><mi mathvariant="bold">M</mi><mrow><mi>n</mi><mo>×</mo><mn>1</mn></mrow></msub><mfenced><mi mathvariant="normal">i</mi></mfenced></mtd></mtr><mtr><mtd><mrow><mo>{</mo></mrow></mtd></mtr><mtr><mtd><mspace width="2em"/><msub><mi>V</mi><mi>min</mi></msub><mo>:</mo><mo>=</mo><mn>0</mn><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><msub><mi mathvariant="bold">w</mi><mi>min</mi></msub><mo>:</mo><mo>=</mo><msub><mn mathvariant="bold">0</mn><mrow><mi>n</mi><mo>×</mo><mn>1</mn></mrow></msub><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><msub><mi>c</mi><mi>min</mi></msub><mo>:</mo><mo>=</mo><mn>0</mn><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><msub><mi>i</mi><mi>min</mi></msub><mo>:</mo><mo>=</mo><mo>-</mo><mn>1</mn><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mi>if</mi><mfenced separators=""><mi>m</mi><mo>≤</mo><mi>n</mi></mfenced></mtd></mtr><mtr><mtd><mspace width="4em"/><mi>return</mi><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mi>for</mi><mfenced separators=""><mi>i</mi><mo>:</mo><mo>=</mo><mfenced open="[" close="]" separators=""><mn>1</mn><mo>:</mo><mi>m</mi></mfenced></mfenced></mtd></mtr><mtr><mtd><mspace width="2em"/><mrow><mo>{</mo></mrow></mtd></mtr><mtr><mtd><mspace width="4em"/><mi mathvariant="bold">w</mi><mo>:</mo><mo>=</mo><mi mathvariant="bold">P</mi><mo>⋅</mo><msup><mfenced open="[" close="]"><msub><mi mathvariant="bold">H</mi><mrow><mi>i</mi><mo>,</mo><mfenced open="[" close="]"><mo>:</mo></mfenced></mrow></msub></mfenced><mi>T</mi></msup><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="4em"/><mi>k</mi><mo>:</mo><mo>=</mo><msub><mi mathvariant="bold">H</mi><mrow><mi>i</mi><mo>,</mo><mfenced open="[" close="]"><mo>:</mo></mfenced></mrow></msub><mo>⋅</mo><mi mathvariant="bold">w</mi><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="4em"/><mi>if</mi><mfenced separators=""><mi>k</mi><mo>≥</mo><mn>1</mn></mfenced></mtd></mtr><mtr><mtd><mspace width="4em"/><mi>error</mi><mfenced><mi>ʹLost Positive Definitenessʹ</mi></mfenced><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mi>c</mi><mo>:</mo><mo>=</mo><msup><mfenced separators=""><mn>1</mn><mo>-</mo><mi>k</mi></mfenced><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mi>V</mi><mo>:</mo><mo>=</mo><mi>c</mi><mo>⋅</mo><msup><mfenced><msub><mfenced open="[" close="]"><mi mathvariant="bold">δy</mi></mfenced><mi>i</mi></msub></mfenced><mn>2</mn></msup><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mi>if</mi><mfenced separators=""><mi>V</mi><mo>&lt;</mo><msub><mi>V</mi><mi>min</mi></msub></mfenced></mtd></mtr><mtr><mtd><mspace width="2em"/><mrow><mo>{</mo></mrow></mtd></mtr><mtr><mtd><mspace width="6em"/><msub><mi>V</mi><mi>min</mi></msub><mo>:</mo><mo>=</mo><mi>V</mi><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="6em"/><msub><mi>i</mi><mi>min</mi></msub><mo>:</mo><mo>=</mo><mi>i</mi><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="6em"/><msub><mi mathvariant="bold">w</mi><mi>min</mi></msub><mo>:</mo><mo>=</mo><mi mathvariant="bold">w</mi><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="6em"/><msub><mi>c</mi><mi>min</mi></msub><mo>:</mo><mo>=</mo><mi>c</mi><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mrow><mo>}</mo></mrow></mtd></mtr><mtr><mtd><mspace width="1em"/><mrow><mo>}</mo></mrow></mtd></mtr><mtr><mtd><mrow><mo>}</mo></mrow></mtd></mtr></mtable></math><img id="ib0159" file="imgb0159.tif" wi="165" he="166" img-content="math" img-format="tif"/></maths><br/>
The symbol &amp; in front of an argument variable indicates that the argument variable is an input/output variable. The value of this variable can be changed in the procedure. One skilled in the art can convert the pseudo-code to computer-executable code.</p><p id="p0074" num="0074">The algorithm for removing information about an anomaly (fast recalculation of estimates and WSRS after an anomalous measurement has been<!-- EPO <DP n="42"> --> excluded) can be expressed by the following pseudo-code: <maths id="math0159" num="(E43)"><math display="block"><mtable columnalign="left"><mtr><mtd><mi>RemoveBadMeas</mi><mfenced separators=""><mo>&amp;</mo><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mo>,</mo><mo>&amp;</mo><mi mathvariant="bold">δ</mi><mo>⁢</mo><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mo>,</mo><mo>&amp;</mo><mi mathvariant="bold">P</mi><mo>,</mo><mo>&amp;</mo><mi>SumRes</mi><mo>,</mo><mfenced separators=""><msub><mi>i</mi><mi>min</mi></msub><mo>⁢</mo><msub><mi>V</mi><mi>min</mi></msub><mo>⁢</mo><msub><mi>c</mi><mi>min</mi></msub><mo>⁢</mo><msub><mi mathvariant="bold">w</mi><mi>min</mi></msub></mfenced></mfenced><mo>;</mo></mtd></mtr><mtr><mtd><mrow><mo>{</mo></mrow></mtd></mtr><mtr><mtd><mspace width="2em"/><mi mathvariant="bold">P</mi><mo>:</mo><mo>=</mo><mi mathvariant="bold">P</mi><mo>-</mo><msub><mi>c</mi><mi>min</mi></msub><mo>⋅</mo><msub><mi mathvariant="bold">w</mi><mi>min</mi></msub><mo>⋅</mo><msubsup><mi mathvariant="bold">w</mi><mi>min</mi><mi>T</mi></msubsup><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mi mathvariant="bold">x</mi><mo>:</mo><mo>=</mo><mi mathvariant="bold">x</mi><mo>-</mo><msub><mi>c</mi><mi>min</mi></msub><mo>⋅</mo><msub><mi mathvariant="bold">w</mi><mi>min</mi></msub><mo>⋅</mo><msub><mfenced open="[" close="]" separators=""><mi mathvariant="bold">δ</mi><mo>⁢</mo><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><msub><mi>i</mi><mi>min</mi></msub></msub><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mi>SumRes</mi><mo>:</mo><mo>=</mo><mi>SumRes</mi><mo>-</mo><msub><mi>V</mi><mi>min</mi></msub><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mn>.</mn><mi>DeleteRow</mi><mfenced><msub><mi>i</mi><mi>min</mi></msub></mfenced><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mn>.</mn><mi>DeleteRow</mi><mfenced><msub><mi>i</mi><mi>min</mi></msub></mfenced><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mi mathvariant="bold">δ</mi><mo>⁢</mo><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mn>.</mn><mi>DeleteRow</mi><mfenced><msub><mi>i</mi><mi>min</mi></msub></mfenced><mo>;</mo></mtd></mtr><mtr><mtd><mrow><mo>}</mo></mrow></mtd></mtr></mtable></math><img id="ib0160" file="imgb0160.tif" wi="165" he="60" img-content="math" img-format="tif"/></maths><br/>
One skilled in the art can convert the pseudo-code to computer-executable code. The whole problem (testing measurements for consistency, detecting anomalous measurements, removing anomalous measurements, and iterating the procedure for the remaining measurements) can be solved with the procedure expressed by the following pseudo-code:<!-- EPO <DP n="43"> --> <maths id="math0160" num="(E44)"><math display="block"><mtable columnalign="left"><mtr><mtd><mi>LSM</mi><mn>.</mn><mi>Run</mi><mfenced separators=""><mo>&amp;</mo><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mo>,</mo><mo>&amp;</mo><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced></mtd></mtr><mtr><mtd><mrow><mo>{</mo></mrow></mtd></mtr><mtr><mtd><mspace width="2em"/><mover><mi mathvariant="bold">D</mi><mo>^</mo></mover><mo>:</mo><mo>=</mo><msup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mi>T</mi></msup><mo>⁢</mo><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mover><mi mathvariant="bold">d</mi><mo>^</mo></mover><mo>:</mo><mo>=</mo><msup><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mi>T</mi></msup><mo>⁢</mo><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mover><mi mathvariant="bold">P</mi><mo>^</mo></mover><mo>:</mo><mo>=</mo><msup><mover><mi mathvariant="bold">D</mi><mo>^</mo></mover><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover><mo>:</mo><mo>=</mo><mover><mi mathvariant="bold">P</mi><mo>^</mo></mover><mo>⋅</mo><mover><mi mathvariant="bold">d</mi><mo>^</mo></mover><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mi mathvariant="bold">δ</mi><mo>⁢</mo><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mo>:</mo><mo>=</mo><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mo>-</mo><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mo>⁢</mo><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mi>SumRes</mi><mo>:</mo><mo>=</mo><mi mathvariant="bold">δ</mi><mo>⁢</mo><msup><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mi>T</mi></msup><mo>⋅</mo><mi mathvariant="bold">δ</mi><mo>⁢</mo><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mi>while</mi><mo>⁢</mo><mfenced separators=""><mi>SumRes</mi><mo>≥</mo><mi>chi</mi><mo>⁢</mo><mn>2</mn><mo>⁢</mo><mi>inv</mi><mo>⁢</mo><mfenced separators=""><mi mathvariant="bold">y</mi><mn>.</mn><mi>numRow</mi><mo>-</mo><mi mathvariant="bold">x</mi><mn>.</mn><mi>numRow</mi><mo>,</mo><mn>1</mn><mo>-</mo><mi>α</mi></mfenced></mfenced></mtd></mtr><mtr><mtd><mspace width="2em"/><mrow><mo>{</mo></mrow></mtd></mtr><mtr><mtd><mspace width="4em"/><mfenced open="[" close="]"><mi>iVcw</mi></mfenced><mo>:</mo><mo>=</mo><mi>BadMeasSearch</mi><mfenced separators=""><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mo>,</mo><mi mathvariant="bold">δ</mi><mo>⁢</mo><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mo>,</mo><mo>&amp;</mo><mover><mi mathvariant="bold">P</mi><mo>^</mo></mover><mo>,</mo><mo>&amp;</mo><mover><mi mathvariant="bold">x</mi><mo>^</mo></mover></mfenced><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="4em"/><mi>if</mi><mo>⁢</mo><mfenced separators=""><mi>i</mi><mo>=</mo><mo>=</mo><mo>-</mo><mn>1</mn></mfenced></mtd></mtr><mtr><mtd><mspace width="8em"/><mi>return with no solution available</mi><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="4em"/><mi>RemoveBadMeas</mi><mfenced separators=""><mo>&amp;</mo><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mo>,</mo><mo>&amp;</mo><mi mathvariant="bold">δ</mi><mo>⁢</mo><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover><mo>,</mo><mo>&amp;</mo><mover><mi mathvariant="bold">P</mi><mo>^</mo></mover><mo>,</mo><mo>&amp;</mo><mi>SumRes</mi><mo>,</mo><mfenced><mi>iVcw</mi></mfenced></mfenced><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mrow><mo>}</mo></mrow></mtd></mtr><mtr><mtd><mrow><mo>}</mo></mrow></mtd></mtr></mtable></math><img id="ib0161" file="imgb0161.tif" wi="165" he="112" img-content="math" img-format="tif"/></maths><br/>
One skilled in the art can convert the pseudo-code to computer-executable code.</p><p id="p0075" num="0075">The discussion above considered LSM in the form of normal equations. In an embodiment, LSM is used with Cholessky's estimate of information coordinates. A Cholessky information matrix (CIM) can be represented by <b>D</b> = <i><b>S<sup>T</sup>S</b>,</i> where <b>S</b> is an upper triangular matrix. The vector <b>s</b> = <b>S·x</b> (where X represents a state vector) is called a Cholessky information vector (CIV). The set {<b>S,s</b>} is called Cholessky information coordinates (CIC).</p><p id="p0076" num="0076">LSM used with Cholessky's estimate of information coordinates yields:<!-- EPO <DP n="44"> --> <maths id="math0161" num="(E45)"><math display="block"><mtable columnalign="left"><mtr><mtd><msub><mi>k</mi><mfenced><mi>i</mi></mfenced></msub></mtd><mtd><mo>=</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><msub><mi mathvariant="bold">w</mi><mfenced><mi>i</mi></mfenced></msub></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><msup><mover><mi mathvariant="bold">D</mi><mo>^</mo></mover><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><msubsup><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced><mi>T</mi></msubsup></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><msup><mfenced open="[" close="]" separators=""><msup><mover><mi mathvariant="bold">S</mi><mo>^</mo></mover><mi>T</mi></msup><mo>⁢</mo><mover><mi mathvariant="bold">S</mi><mo>^</mo></mover></mfenced><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><msubsup><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced><mi>T</mi></msubsup></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><msub><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced></msub><mo>⁢</mo><msup><mover><mi mathvariant="bold">S</mi><mo>^</mo></mover><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><msup><mover><mi mathvariant="bold">S</mi><mo>^</mo></mover><mrow><mo>-</mo><mi>T</mi></mrow></msup><mo>⁢</mo><msubsup><mi mathvariant="bold">h</mi><mfenced><mi>i</mi></mfenced><mi>T</mi></msubsup></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><msup><mfenced open="|" close="|"><msub><mi mathvariant="bold">v</mi><mfenced><mi>i</mi></mfenced></msub></mfenced><mn>2</mn></msup><mo>,</mo></mtd></mtr></mtable></math><img id="ib0162" file="imgb0162.tif" wi="117" he="48" img-content="math" img-format="tif"/></maths><br/>
where <b>v</b><sub>(i)</sub> = <b>Ŝ</b><sup>-<i>T</i></sup><b>h</b><i><sup>T</sup></i><sub>(i)</sub>. Calculation of <i>k</i><sub>(i)</sub> requires about 0.5<i>n</i><sup>2</sup> flops when calculation procedures with normal equations or Cholessky information coordinates are used. Note that the fast searching procedure works for a linear case. For a nonlinear observation model, some iteration for each eliminated equation <i>i</i> can be done. In the case considered above, the non-linearity is weak, and iterations are not needed.</p><p id="p0077" num="0077"><b>Ambiguities Resolution</b>. In the positioning task described above, ambiguities were assumed to have been resolved. Carrier phase single differences, however, are accurate but ambiguous measurements. By transforming carrier phase single differences into unambiguous measurements, a position estimate to an accuracy on the order of 1 cm can be obtained. This estimate can be obtained by the maximum likelihood technique. The solution can be divided into two steps. In the first step, float ambiguities are determined. Various methods, such as a Kalman filter or a recursive LSM, can be used for this step. In the second step, using integer calculations, fixed ambiguities are resolved.</p><p id="p0078" num="0078"><b>Observation Equations and State Vector for Ambiguities Resolution</b>. Refer back to (E8) and (E9). Assume that variables of the first row change independently both in time and relative to each other. Combining equations (E8) and (E9) in a manner similar to treating double differences, eliminate these values from consideration. Combined equations go to the filter input. Only coordinates, double differences of ambiguities, and double differences of ionosphere<!-- EPO <DP n="45"> --> errors are determined in the filter. Integer resolution is made for the filtered set of float ambiguities <i>(∇<sup>s,s<sub2>ref</sub2></sup> N<sup>f</sup>}<sub>f,s≠s<sub2>ref</sub2></sub>.</i> Filters are described in more detail below.</p><p id="p0079" num="0079"><b>Inverse Problem</b>. Assume that the baseline (the distance between the base and the rover) is short and that the rover coordinates are known. Then integer resolution can be simplified. Using code measurements, estimate <maths id="math0162" num=""><math display="inline"><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup><mn>.</mn></math><img id="ib0163" file="imgb0163.tif" wi="9" he="8" img-content="math" img-format="tif" inline="yes"/></maths> Assume that the estimate has an associated error <i>q</i>. Subtract known ranges and <maths id="math0163" num=""><math display="inline"><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup></math><img id="ib0164" file="imgb0164.tif" wi="8" he="9" img-content="math" img-format="tif" inline="yes"/></maths> from phase measurements and form double differences from the obtained values: <maths id="math0164" num="(E46)"><math display="block"><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><mfrac><mfenced separators=""><msubsup><mi>ϕ</mi><mi>k</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>-</mo><mi>c</mi><mo>⁢</mo><msub><mi>τ</mi><mi>k</mi></msub><mo>+</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup><mo>-</mo><msubsup><mi>R</mi><mrow><mn>0</mn><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup></mfenced><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup></mfrac><mo>=</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup><mo>+</mo><msup><mover><mi>q</mi><mo>˜</mo></mover><mi>f</mi></msup><mo>⁢</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mi>l</mi><mi>s</mi></msup><mo>+</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><mfrac><msubsup><mi>ζ</mi><mi>k</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup></mfrac><mn>.</mn></math><img id="ib0165" file="imgb0165.tif" wi="133" he="40" img-content="math" img-format="tif"/></maths><br/>
The value <i>q̃</i><sup>f</sup>∇<sup>s,s<sub2>ref</sub2></sup> <i>l<sup>s</sup></i> is formed from the double differences <maths id="math0165" num=""><math display="inline"><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><mfrac><mi>q</mi><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup></mfrac><mo>,</mo></math><img id="ib0166" file="imgb0166.tif" wi="28" he="13" img-content="math" img-format="tif" inline="yes"/></maths> via the following equation: <maths id="math0166" num="(E47)"><math display="block"><mtable columnalign="left"><mtr><mtd><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><mfrac><mi>q</mi><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup></mfrac></mtd><mtd><mo>=</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><mfrac><mrow><mn>1</mn><mo>+</mo><msubsup><mi>ε</mi><mn>0</mn><mi mathvariant="italic">SYS</mi></msubsup><mo>⁢</mo><msup><mi>l</mi><mi>s</mi></msup></mrow><msubsup><mi>λ</mi><mn>0</mn><mi>f</mi></msubsup></mfrac><mo>⁢</mo><mi>q</mi></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><mfrac><msubsup><mi>ε</mi><mn>0</mn><mi mathvariant="italic">SYS</mi></msubsup><msubsup><mi>λ</mi><mn>0</mn><mi>f</mi></msubsup></mfrac><mo>⁢</mo><mi>q</mi><mo>⁢</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mi>l</mi><mi>s</mi></msup></mtd></mtr><mtr><mtd><mspace width="1em"/></mtd><mtd><mo>=</mo><msup><mover><mi>q</mi><mo>˜</mo></mover><mi>f</mi></msup><mo>⋅</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mi>l</mi><mi>s</mi></msup><mn>.</mn></mtd></mtr></mtable></math><img id="ib0167" file="imgb0167.tif" wi="131" he="51" img-content="math" img-format="tif"/></maths></p><p id="p0080" num="0080">Considering the typical accuracy of code measurements, the absolute value of <i>q</i> can be assumed to be less than or equal to ~10 m. Therefore,<!-- EPO <DP n="46"> --> the absolute value of <maths id="math0167" num=""><math display="inline"><msup><mover><mi>q</mi><mo>˜</mo></mover><mi>f</mi></msup><mo>=</mo><mfrac><msubsup><mi>ε</mi><mn>0</mn><mi mathvariant="italic">SYS</mi></msubsup><msubsup><mi>λ</mi><mn>0</mn><mi>f</mi></msubsup></mfrac><mo>⁢</mo><mi>q</mi></math><img id="ib0168" file="imgb0168.tif" wi="30" he="18" img-content="math" img-format="tif" inline="yes"/></maths> is less than one hundredth of a cycle and can be neglected. Since the phase error is much less than a cycle, estimates of double differences of integer ambiguities can be obtained by rounding off values in the left-hand side. The value <maths id="math0168" num=""><math display="inline"><mfenced open="|" close="|" separators=""><msup><mover><mi>q</mi><mo>˜</mo></mover><mi>f</mi></msup><mo>⁢</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mi>l</mi><mi>s</mi></msup><mo>+</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><mfrac><msubsup><mi>ζ</mi><mi>k</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup></mfrac></mfenced></math><img id="ib0169" file="imgb0169.tif" wi="65" he="20" img-content="math" img-format="tif" inline="yes"/></maths> is less then 0.5 cycle. So rounding of (E46) leads to the equation: <maths id="math0169" num="(E48)"><math display="block"><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup><mo>=</mo><mi>ROUND</mi><mo>⁢</mo><mfenced open="[" close="]" separators=""><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msub><mi>s</mi><mi mathvariant="italic">ref</mi></msub></mrow></msup><mo>⁢</mo><mfrac><mfenced separators=""><msubsup><mi>ϕ</mi><mi>k</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msubsup><mo>-</mo><mi>c</mi><mo>⁢</mo><msub><mi>τ</mi><mi>k</mi></msub><mo>+</mo><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup><mo>-</mo><msubsup><mi>R</mi><mrow><mn>0</mn><mo>,</mo><mi>k</mi></mrow><mi>s</mi></msubsup></mfenced><msup><mi>λ</mi><mrow><mi>f</mi><mo>,</mo><mi>s</mi></mrow></msup></mfrac></mfenced><mn>.</mn></math><img id="ib0170" file="imgb0170.tif" wi="165" he="32" img-content="math" img-format="tif"/></maths><br/>
After the integers <i>∇<sup>s,s<sub2>ref</sub2></sup> N<sup>f</sup></i> have been obtained, the value <maths id="math0170" num=""><math display="inline"><msubsup><mi mathvariant="normal">Ψ</mi><mi>k</mi><mi>f</mi></msubsup></math><img id="ib0171" file="imgb0171.tif" wi="9" he="9" img-content="math" img-format="tif" inline="yes"/></maths> can be determined as well. Note that <maths id="math0171" num=""><math display="inline"><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup></math><img id="ib0172" file="imgb0172.tif" wi="8" he="9" img-content="math" img-format="tif" inline="yes"/></maths> does not need to be eliminated for GPS and GAL measurements, since it is cancelled in the single differences. It can be compensated, however, if a correct estimate of the value <maths id="math0172" num=""><math display="inline"><msubsup><mi mathvariant="normal">Ψ</mi><mi>k</mi><mi>f</mi></msubsup></math><img id="ib0173" file="imgb0173.tif" wi="10" he="9" img-content="math" img-format="tif" inline="yes"/></maths> is needed. For GPS and GAL, values <maths id="math0173" num=""><math display="inline"><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup></math><img id="ib0174" file="imgb0174.tif" wi="9" he="9" img-content="math" img-format="tif" inline="yes"/></maths> and <maths id="math0174" num=""><math display="inline"><msubsup><mi mathvariant="normal">Ψ</mi><mi>k</mi><mi>f</mi></msubsup></math><img id="ib0175" file="imgb0175.tif" wi="9" he="9" img-content="math" img-format="tif" inline="yes"/></maths> cannot be estimated using only phase measurements. For this purpose, <maths id="math0175" num=""><math display="inline"><msubsup><mi mathvariant="normal">Γ</mi><mi>k</mi><mi>f</mi></msubsup></math><img id="ib0176" file="imgb0176.tif" wi="9" he="9" img-content="math" img-format="tif" inline="yes"/></maths> is estimated via code measurements.</p><p id="p0081" num="0081"><b>Ambiguities Resolution Flowchart</b>. <figref idrefs="f0002">Fig. 2</figref> shows a flowchart of steps for resolving ambiguities. [Here it is assumed that there are no GLONASS biases due to receivers of different characteristics (for examples, receivers from different manufacturers) being installed in the rover and in the base.] Measurements 201 include pseudo-ranges and carrier phases measured at the base navigation receiver and at the rover navigation receiver. In step 202, single differences of the<!-- EPO <DP n="47"> --> measurements measured at the rover navigation receiver and the corresponding measurements measured at the base navigation receiver are calculated. The process then passes to step 204, in which the single differences are linearized. The process then passes to step 206, in which an observation vector and matrix are determined from the linearized single differences. The process then passes to decision step 208. If an estimate of the rover position is known, then the process passes to step 210, in which an inverse task is performed to generate integer ambiguities estimates 211. The rover position, for example, can be extrapolated from a previously known position via single differences of carrier phase increments.</p><p id="p0082" num="0082">In step 208, if an estimate of the rover position is not known, then the process passes to step 220, in which anomalous measurements, based on single differences of pseudo-ranges and single differences of carrier phase increments, are detected and removed. The process then passes to step 222, in which the ambiguities are filtered. Details of step 222 are described in further detail below. The process then passes to step 224, in which float ambiguities are estimated. Further details of estimating the float ambiguities are given below. Briefly, the vector of float ambiguities is a sub-vector of the state vector; therefore, the float ambiguities are estimated during the filtering of the state vector.</p><p id="p0083" num="0083">The process then passes to step 226, in which an integer ambiguities vector candidate is determined. Integer resolution is based on the MLAMBDA method (see below). The following integer minimization of quad form is determined: <maths id="math0176" num=""><math display="block"><mi>q</mi><mo>=</mo><msup><mfenced separators=""><mi mathvariant="bold">N</mi><mo>-</mo><mover><mi mathvariant="bold">N</mi><mo>˜</mo></mover></mfenced><mi>T</mi></msup><mo>⁢</mo><mi mathvariant="bold">D</mi><mo>⁢</mo><mfenced separators=""><mi mathvariant="bold">N</mi><mo>-</mo><mover><mi mathvariant="bold">N</mi><mo>˜</mo></mover></mfenced><mo>→</mo><mi>min</mi><mo>,</mo></math><img id="ib0177" file="imgb0177.tif" wi="86" he="12" img-content="math" img-format="tif"/></maths><br/>
where <b>N</b> is an integer ambiguities vector, <b>Ñ</b> is the float ambiguities vector estimated in the filter, and <b>D</b> is the information matrix for the float ambiguities vector estimate. Two minima <i>q</i><sub>1</sub> ≤ <i>q</i><sub>2</sub> (where <i>q</i><sub>1</sub> is the first minimum and <i>q</i><sub>2</sub> is the second minimum after the first) and the corresponding integer ambiguities<!-- EPO <DP n="48"> --> vectors <b>N</b><sub>1</sub>, <b>N</b><sub>2</sub> are determined. The integer ambiguity vector <b>N</b><sub>1</sub> is selected to be an integer ambiguities vector candidate.</p><p id="p0084" num="0084">The process then passes to step 228, in which fix criteria are evaluated for the integer ambiguities vector candidate. Herein, a fix process refers to the process of determining an integer ambiguity vector from a floating ambiguity vector. There is a probability that the fix process determines an incorrect integer ambiguity vector ("wrong fix"). Fix criteria correspond to the probability of a wrong fix. In an embodiment, fix criteria are based on the contrast ratio, which is defined from the LAMBDA (or modifications of the LAMBDA) algorithm output. [For details of LAMBDA and modifications of LAMBDA, see <nplcit id="ncit0001" npl-type="s"><text>X.-W. Chang, X. Yang, and T. Zhou, "MLAMBDA: A modified LAMBDA method for integer least-squares estimation", Journal of Geodesy, Volume 79, Issue 9, pp 552 - 565, December, 2005</text></nplcit>. As the contrast ratio increases, the probability of a wrong fix decreases.</p><p id="p0085" num="0085">The outputs of the LAMBDA algorithm are integer ambiguity vectors and quadratic form values. The contrast ratio (the ratio of the second smallest quadratic form value to the first smallest one), <i>C=q</i><sub>2</sub> / <i>q</i><sub>1</sub>, is calculated and compared to a user-defined threshold <i>T</i> (which depends on the number of ambiguities present in vector). If <i>C</i> ≥ <i>T</i>, a fix is attained [that is, a specific integer ambiguity vector is determined with a user-defined minimum probability of being correct], and <b>N̂</b> = <b>N</b><sub>1</sub> is designated to be an estimate of the integer ambiguities vector. If the contrast ratio is lower than the threshold value, then filtration is continued to obtain a higher contrast ratio.</p><p id="p0086" num="0086">The process then passes to decision step 230. If the fix criteria are met, then the process yields integer ambiguities estimates 211. If the fix criteria are not met, then the process yields float ambiguities estimates 221. Integer ambiguities estimates 211 and float ambiguities estimates 221 can then be used in the calculation of unambiguous phases, with integer ambiguities estimates providing<!-- EPO <DP n="49"> --> more precise results than float ambiguities estimates. In an embodiment, the unambiguous phases are provided as measurements 101 in <figref idrefs="f0001">Fig. 1</figref>.</p><p id="p0087" num="0087">For static and kinematic modes, the same overall method can be used. Details of step 222, filter ambiguity, differ, however. Different methods can be used to implement each of the steps. Some are described below.</p><p id="p0088" num="0088"><b>Computational Sequence of Ambiguities Resolution</b>. To filter ambiguities, a Kalman filter with estimating Cholessky information coordinates, referred to herein as a Cholessky information Kalman filter (CIKF), is used in an embodiment. Only coordinates and double differences of ambiguities are estimated. The remaining values are eliminated in the process of taking double differences. The coordinates and double differences of ambiguities are included in the state vector for the ambiguity estimation task in the form: <maths id="math0177" num="(E49)"><math display="block"><mi>x</mi><mo>=</mo><mfenced open="[" close="]" separators=""><mover><mi>r</mi><mi mathvariant="normal">r</mi></mover><mo>⁢</mo><msub><mfenced separators=""><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msubsup><mi>s</mi><mi mathvariant="italic">ref</mi><mn>1</mn></msubsup></mrow></msup><mo>⁢</mo><msub><mi mathvariant="normal">Δ</mi><mrow><mn>0</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>⁢</mo><msup><mi>N</mi><mn>1</mn></msup></mfenced><mrow><mi>s</mi><mo>≠</mo><msubsup><mi>s</mi><mi>ref</mi><mn>1</mn></msubsup></mrow></msub><mo>⁢</mo><mi mathvariant="normal">K</mi><mo>⁢</mo><msub><mfenced separators=""><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><msubsup><mi>s</mi><mi mathvariant="italic">ref</mi><mi mathvariant="italic">NF</mi></msubsup></mrow></msup><mo>⁢</mo><msub><mi mathvariant="normal">Δ</mi><mrow><mn>0</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>⁢</mo><msup><mi>N</mi><mi mathvariant="italic">NF</mi></msup></mfenced><mrow><mi>s</mi><mo>≠</mo><msubsup><mi>s</mi><mi>ref</mi><mi mathvariant="italic">NF</mi></msubsup></mrow></msub></mfenced><mn>.</mn></math><img id="ib0178" file="imgb0178.tif" wi="156" he="18" img-content="math" img-format="tif"/></maths><br/>
Only those ambiguities in each frequency that can be defined from the observation equation are used. Therefore, the ambiguity sub-vector size in (E49) changes under certain circumstances: when phase measurements are being tracked, when phase measurements lose tracking, and when phase measurements are deleted by anomaly detectors. An important consideration is consistency in variable sequencing in the state vector from one epoch to another. Formally, different reference satellites <maths id="math0178" num=""><math display="inline"><msubsup><mi>s</mi><mi mathvariant="italic">ref</mi><mi>f</mi></msubsup></math><img id="ib0179" file="imgb0179.tif" wi="9" he="10" img-content="math" img-format="tif" inline="yes"/></maths> are chosen for each frequency since a reference measurement for a particular frequency band can be removed by the anomaly detector.</p><p id="p0089" num="0089">In embodiments of the invention, methods for ambiguity resolution analyze the current state of the satellite constellation during the transition from one epoch to another epoch. The scenarios taken into account include:<!-- EPO <DP n="50"> -->
<ul><li>A reference satellite changes. The state vector and corresponding Cholessky information coordinates (CICs) are recalculated.</li><li>A satellite (non-reference) rises (appears). Corresponding ambiguities are introduced into the state vector.</li><li>A satellite (non-reference) sets (disappears). Corresponding ambiguities from the state vector are removed.</li></ul>
A satellite rises (or appears) when it enters the line-of-sight of a receiver; that is, the receiver starts receiving signals from a satellite from which it previously did not receive signals. A satellite sets (or disappears) when it leaves the line-of-sight of a receiver; that is, the receiver stops receiving signals from a satellite from which it previously did receive signals. A stable solution is maintained during various changes in the state of the satellite constellation. Information is retained under various scenarios. In previous procedures, information is lost, and calculations (filter CICs) need to be re-initialized, consuming computational resources. For example, if a reference satellite is changed, the whole filter is reset. A great amount of information is lost. Similar results occur when a satellite appears or disappears. In an embodiment, an algorithm for recalculation of CICs is used to retain previously acquired information.</p><p id="p0090" num="0090">Cholessky information coordinates are divided into blocks, as shown in <figref idrefs="f0003">Fig. 3</figref> (E50). At the next epoch, if the constellation remains the same, the CICs change as shown in <figref idrefs="f0004">Fig. 4</figref> (E51). Here <i>β</i> ∈ [0;1] is the coordinate aging coefficient, and α ∈ [0;1] is the ambiguity aging coefficient. The ambiguity aging coefficient is used to model degradation of estimate accuracy during periods when no measurements are received. (Also, it provides a mechanism to prevent floating number overflow during program execution.) At <i>β</i> = 0, coordinates change independently from epoch to epoch. At <i>β</i> = 1 coordinates do not age (this occurs when the rover is static).<!-- EPO <DP n="51"> --></p><p id="p0091" num="0091">Correction is made according to linearized double differences of code and phase observations. The matrix of the linearized observation model for double differences is: <maths id="math0179" num="(E52)"><math display="block"><mfenced open="[" close="]"><mtable><mtr><mtd><mtable><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mn>1</mn></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">O</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd></mtr><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mn>1</mn></mrow></msubsup></mtd><mtd><msubsup><mover><mi>A</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mn>1</mn></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mn>2</mn></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><msubsup><mover><mi>A</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mn>2</mn></mrow></msubsup></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">O</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd></mtr><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi><mo>-</mo><mn>1</mn></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><msubsup><mover><mi>A</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi><mo>-</mo><mn>1</mn></mrow></msubsup></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mn>0</mn></mtd><mtd><msubsup><mover><mi>A</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi></mrow></msubsup></mtd></mtr></mtable><mrow><mo>|</mo></mrow></mtd><mtd><mtable><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><mi mathvariant="normal">M</mi></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mn>2</mn></mrow></msubsup></mtd></mtr><mtr><mtd><mi mathvariant="normal">M</mi></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi><mo>-</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi></mrow></msubsup></mtd></mtr></mtable></mtd></mtr></mtable></mfenced><mn>.</mn></math><img id="ib0180" file="imgb0180.tif" wi="165" he="79" img-content="math" img-format="tif"/></maths></p><p id="p0092" num="0092">A procedure for updating information coordinates is used in accordance with the observation model, except for preliminary processing of the block for code observations. The matrix has a high number of zeros in block rows corresponding to code observations; therefore, processing of zeros can be reduced. The following matrix comes at the input of the updating algorithm for CIKF:<!-- EPO <DP n="52"> --> <maths id="math0180" num="(E53)"><math display="block"><mfenced open="[" close="]" separators=""><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover><mrow><mo>|</mo></mrow><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mfenced><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><mtable><mtr><mtd><msubsup><mi>S</mi><mi mathvariant="italic">DD</mi><mfenced><mi>ρ</mi></mfenced></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mn>1</mn></mrow></msubsup></mtd><mtd><msubsup><mover><mi>A</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mn>1</mn></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mn>2</mn></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><msubsup><mover><mi>A</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mn>2</mn></mrow></msubsup></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">O</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd></mtr><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi><mo>-</mo><mn>1</mn></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><msubsup><mover><mi>A</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi><mo>-</mo><mn>1</mn></mrow></msubsup></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mn>0</mn></mtd><mtd><msubsup><mover><mi>A</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi></mrow></msubsup></mtd></mtr></mtable><mrow><mo>|</mo></mrow></mtd><mtd><mtable><mtr><mtd><msubsup><mi>s</mi><mi mathvariant="italic">DD</mi><mfenced><mi>ρ</mi></mfenced></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mn>2</mn></mrow></msubsup></mtd></mtr><mtr><mtd><mi mathvariant="normal">M</mi></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi><mo>-</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi></mrow></msubsup></mtd></mtr></mtable></mtd></mtr></mtable></mfenced></math><img id="ib0181" file="imgb0181.tif" wi="165" he="72" img-content="math" img-format="tif"/></maths><br/>
where <maths id="math0181" num=""><math display="inline"><msubsup><mi>S</mi><mi mathvariant="italic">DD</mi><mfenced><mi>ρ</mi></mfenced></msubsup><mo>,</mo><msubsup><mi>s</mi><mi mathvariant="italic">DD</mi><mfenced><mi>ρ</mi></mfenced></msubsup></math><img id="ib0182" file="imgb0182.tif" wi="24" he="10" img-content="math" img-format="tif" inline="yes"/></maths> are the Cholessky information coordinates for the rover positions obtained from pseudo-orange double differences according to the following computational scheme: <maths id="math0182" num="(E54)"><math display="block"><mtable columnalign="right"><mtr><mtd><mfenced open="[" close="]" separators=""><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mfenced><mi>ρ</mi></mfenced></msubsup><mrow><mo>|</mo></mrow><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mfenced><mi>ρ</mi></mfenced></msubsup></mfenced><mo>=</mo><mfenced open="[" close="]" separators=""><mtable><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><mi mathvariant="normal">M</mi></mtd></mtr><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi></mrow></msubsup></mtd></mtr></mtable><mrow><mo>|</mo></mrow><mtable><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><mi mathvariant="normal">M</mi></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi></mrow></msubsup></mtd></mtr></mtable></mfenced></mtd></mtr><mtr><mtd><munder><mo>→</mo><mi mathvariant="italic">QR</mi></munder><mfenced open="[" close="]"><mtable><mtr><mtd><mtable><mtr><mtd><msubsup><mi>S</mi><mi mathvariant="italic">DD</mi><mfenced><mi>ρ</mi></mfenced></msubsup></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr></mtable><mrow><mo>|</mo></mrow></mtd><mtd><mtable><mtr><mtd><msubsup><mi>s</mi><mi mathvariant="italic">DD</mi><mfenced><mi>ρ</mi></mfenced></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi>r</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mfenced><mi>ρ</mi></mfenced></msubsup></mtd></mtr></mtable></mtd></mtr></mtable></mfenced><mn>.</mn></mtd></mtr></mtable></math><img id="ib0183" file="imgb0183.tif" wi="133" he="64" img-content="math" img-format="tif"/></maths><br/>
<!-- EPO <DP n="53"> -->QR transformation is discussed in Lawson and in Golub. Briefly, QR decomposition of matrix <b>A</b> is <b>A</b> = <b>Q</b> · <b>R</b> where <b>Q</b> is orthogonal and <b>R</b> is upper triangular.<br/>
The QR-transformation of system [<b>A</b>|<b>y</b>] results in the system [<b>R</b> | <b>Q</b><i><sup>T</sup></i><b>y</b>].</p><p id="p0093" num="0093">Updating filter matrices is implemented by the following procedure: <maths id="math0183" num="(E55)"><math display="block"><mrow><mo>[</mo></mrow><mtable columnalign="right"><mtr><mtd><mtable><mtr><mtd><msup><mover><mi mathvariant="bold">S</mi><mo>˜</mo></mover><mi mathvariant="bold">x</mi></msup></mtd></mtr><mtr><mtd><mover><mi mathvariant="bold">H</mi><mo>‾</mo></mover></mtd></mtr></mtable><mrow><mo>|</mo></mrow><mtable><mtr><mtd><msup><mover><mi mathvariant="bold">s</mi><mo>˜</mo></mover><mi mathvariant="bold">x</mi></msup></mtd></mtr><mtr><mtd><mover><mi mathvariant="bold">y</mi><mo>‾</mo></mover></mtd></mtr></mtable><mrow><mo>]</mo></mrow><munder><mo>→</mo><mi mathvariant="italic">QR</mi></munder><mrow><mo>[</mo></mrow><mtable><mtr><mtd><mtable><mtr><mtd><msup><mover><mi mathvariant="bold">S</mi><mo>^</mo></mover><mi mathvariant="bold">x</mi></msup></mtd></mtr><mtr><mtd><mn mathvariant="bold">0</mn></mtd></mtr></mtable><mrow><mo>|</mo></mrow></mtd><mtd><mtable><mtr><mtd><msup><mover><mi mathvariant="bold">s</mi><mo>^</mo></mover><mi mathvariant="bold">x</mi></msup></mtd></mtr><mtr><mtd><mover><mi mathvariant="bold">r</mi><mo>‾</mo></mover></mtd></mtr></mtable></mtd></mtr></mtable><mrow><mo>]</mo></mrow><mn mathvariant="bold">.</mn></mtd></mtr></mtable></math><img id="ib0184" file="imgb0184.tif" wi="118" he="24" img-content="math" img-format="tif"/></maths><br/>
Here the symbol □ refers to predicted values, and the symbol <sup>∧</sup> refers to updated values.</p><p id="p0094" num="0094"><b>Generating Double Differences for Ambiguity Filter.</b> Refer back to (E8) and (E9). An expanded matrix for this set of equations is: <maths id="math0184" num="(E56)"><math display="block"><mfenced open="[" close="]"><mtable><mtr><mtd><mtable><mtr><mtd><msup><mover><mi>w</mi><mo>‾</mo></mover><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></mtd><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>×</mo><mn>1</mn></mrow></msub></mtd><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi>cos</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>×</mo><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><msup><mover><mi>w</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></mtd><mtd><msup><mover><mi>λ</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></mtd><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi>cos</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msup><mover><mi>A</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></mtd></mtr></mtable><mrow><mo>|</mo></mrow></mtd><mtd><mtable><mtr><mtd><msup><mover><mi>y</mi><mo>‾</mo></mover><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></mtd></mtr><mtr><mtd><msup><mover><mi>y</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></mtd></mtr></mtable></mtd></mtr></mtable></mfenced><mn>.</mn></math><img id="ib0185" file="imgb0185.tif" wi="144" he="26" img-content="math" img-format="tif"/></maths><br/>
In this representation, the carrier phase equations in the first equation would correspond to the reference satellite, and a matrix shown below is introduced: <maths id="math0185" num="(E57)"><math display="block"><msup><mover><mi>A</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><msub><mn>0</mn><mrow><mn>1</mn><mo>×</mo><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><mi>diag</mi><mfenced><msup><mover><mi>w</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></mfenced></mtd></mtr></mtable></mfenced><mn>.</mn></math><img id="ib0186" file="imgb0186.tif" wi="122" he="21" img-content="math" img-format="tif"/></maths></p><p id="p0095" num="0095">First consider the block row, which corresponds to code equations, similar to equations (E12):<!-- EPO <DP n="54"> --> <maths id="math0186" num="(E58)"><math display="block"><mfenced open="[" close="]"><mtable columnlines="solid"><mtr><mtd><mtable><mtr><mtd><msubsup><mi>C</mi><mrow><mi>τ</mi><mo>,</mo><mi>τ</mi></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><msubsup><mi>C</mi><mrow><mi>τ</mi><mo>,</mo><mover><mi>r</mi><mi mathvariant="normal">r</mi></mover></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msub><mn>0</mn><mrow><mn>1</mn><mo>×</mo><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mn>1</mn></mrow></msub></mtd><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><msup><mover><mi>w</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></mtd><mtd><msup><mover><mi>λ</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></mtd><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi>cos</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msup><mover><mi>A</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></mtd></mtr></mtable></mtd><mtd><mtable><mtr><mtd><msubsup><mi>C</mi><mi>τ</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msup><mover><mi>y</mi><mo>‾</mo></mover><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msup></mtd></mtr></mtable></mtd></mtr></mtable></mfenced><mn>.</mn></math><img id="ib0187" file="imgb0187.tif" wi="145" he="35" img-content="math" img-format="tif"/></maths></p><p id="p0096" num="0096">Apply a Householder's transformation that resets all the elements of column <i><o>w</o></i><sup>(ϕ)<i>f</i></sup>, excluding the first one: <maths id="math0187" num="(E59)"><math display="block"><mfenced open="[" close="]"><mtable columnlines="solid"><mtr><mtd><mtable><mtr><mtd><msubsup><mi>C</mi><mrow><mi>τ</mi><mo>,</mo><mi>τ</mi></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><msubsup><mi>C</mi><mrow><mi>τ</mi><mo>,</mo><mover><mi>r</mi><mi mathvariant="normal">r</mi></mover></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msub><mn>0</mn><mrow><mn>1</mn><mo>×</mo><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mn>1</mn></mrow></msub></mtd><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><msubsup><mi>C</mi><mrow><mi>τ</mi><mo>,</mo><mi>τ</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mi>C</mi><mrow><mi>τ</mi><mo>,</mo><mi>ψ</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mi>C</mi><mrow><mi>τ</mi><mo>,</mo><mover><mi>r</mi><mi mathvariant="normal">r</mi></mover></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mi>C</mi><mrow><mi>τ</mi><mo>,</mo><mi>N</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mn>1</mn></mrow></msub></mtd><mtd><msubsup><mover><mi>λ</mi><mo>‾</mo></mover><mfenced><mn>0</mn></mfenced><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mfenced><mn>0</mn></mfenced><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mover><mi>A</mi><mo>‾</mo></mover><mfenced><mn>0</mn></mfenced><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable></mtd><mtd><mtable><mtr><mtd><msubsup><mi>c</mi><mi>τ</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mi>c</mi><mrow><mfenced><mn>0</mn></mfenced><mo>⁢</mo><mi>τ</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mfenced><mn>0</mn></mfenced><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable></mtd></mtr></mtable></mfenced><mn>.</mn></math><img id="ib0188" file="imgb0188.tif" wi="145" he="43" img-content="math" img-format="tif"/></maths></p><p id="p0097" num="0097">Then apply a Givens rotation [see Lawson] to reset element <maths id="math0188" num=""><math display="inline"><msubsup><mi>C</mi><mrow><mi>τ</mi><mo>,</mo><mi>τ</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup><mo>:</mo></math><img id="ib0189" file="imgb0189.tif" wi="17" he="10" img-content="math" img-format="tif" inline="yes"/></maths> <maths id="math0189" num="(E60)"><math display="block"><mfenced open="[" close="]"><mtable columnlines="solid"><mtr><mtd><mtable><mtr><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>0</mn></mfenced><mo>⁢</mo><mi>τ</mi><mo>,</mo><mi>τ</mi></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>0</mn></mfenced><mo>⁢</mo><mi>τ</mi><mo>,</mo><mover><mi>r</mi><mi mathvariant="normal">r</mi></mover></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>0</mn></mfenced><mo>⁢</mo><mi>τ</mi><mo>,</mo><mi>N</mi></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mn>1</mn></mrow></msub></mtd><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>0</mn></mfenced><mo>⁢</mo><mi>τ</mi><mo>,</mo><mi>ψ</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>0</mn></mfenced><mo>⁢</mo><mi>τ</mi><mo>,</mo><mover><mi>r</mi><mi mathvariant="normal">r</mi></mover></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>0</mn></mfenced><mo>⁢</mo><mi>τ</mi><mo>,</mo><mi>N</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mn>1</mn></mrow></msub></mtd><mtd><msubsup><mover><mi>λ</mi><mo>‾</mo></mover><mfenced><mn>0</mn></mfenced><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mfenced><mn>0</mn></mfenced><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mover><mi>A</mi><mo>‾</mo></mover><mfenced><mn>0</mn></mfenced><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable></mtd><mtd><mtable><mtr><mtd><msubsup><mi>c</mi><mrow><mfenced><mn>0</mn></mfenced><mo>⁢</mo><mi>τ</mi></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mi>c</mi><mrow><mfenced><mn>0</mn></mfenced><mo>⁢</mo><mi>τ</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mfenced><mn>0</mn></mfenced><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable></mtd></mtr></mtable></mfenced><mn>.</mn></math><img id="ib0190" file="imgb0190.tif" wi="142" he="45" img-content="math" img-format="tif"/></maths></p><p id="p0098" num="0098">Again, apply a Householder's transformation to zero out all the column elements <maths id="math0190" num=""><math display="inline"><mfenced open="[" close="]"><mtable><mtr><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>0</mn></mfenced><mo>⁢</mo><mi>τ</mi><mo>,</mo><mi>ψ</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi>λ</mi><mo>‾</mo></mover><mfenced><mn>0</mn></mfenced><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable></mfenced><mo>,</mo></math><img id="ib0191" file="imgb0191.tif" wi="25" he="20" img-content="math" img-format="tif" inline="yes"/></maths> excluding the first:<!-- EPO <DP n="55"> --> <maths id="math0191" num="(E61)"><math display="block"><mfenced open="[" close="]"><mtable columnlines="solid"><mtr><mtd><mtable><mtr><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>0</mn></mfenced><mo>⁢</mo><mi>τ</mi><mo>,</mo><mi>τ</mi></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>0</mn></mfenced><mo>⁢</mo><mi>τ</mi><mo>,</mo><mover><mi>r</mi><mi mathvariant="normal">r</mi></mover></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>0</mn></mfenced><mo>⁢</mo><mi>τ</mi><mo>,</mo><mi>N</mi></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mn>1</mn></mrow></msub></mtd><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>1</mn></mfenced><mo>⁢</mo><mi>ψ</mi><mo>,</mo><mi>ψ</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>1</mn></mfenced><mo>⁢</mo><mi>ψ</mi><mo>,</mo><mover><mi>r</mi><mi mathvariant="normal">r</mi></mover></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>1</mn></mfenced><mo>⁢</mo><mi>ψ</mi><mo>,</mo><mi>N</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mn>1</mn></mrow></msub></mtd><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mfenced><mn>1</mn></mfenced><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mover><mi>A</mi><mo>‾</mo></mover><mfenced><mn>1</mn></mfenced><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable></mtd><mtd><mtable><mtr><mtd><msubsup><mi>c</mi><mrow><mfenced><mn>0</mn></mfenced><mo>⁢</mo><mi>τ</mi></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mi>c</mi><mrow><mfenced><mn>1</mn></mfenced><mo>⁢</mo><mi>ψ</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mfenced><mn>1</mn></mfenced><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable></mtd></mtr></mtable></mfenced><mn>.</mn></math><img id="ib0192" file="imgb0192.tif" wi="156" he="46" img-content="math" img-format="tif"/></maths></p><p id="p0099" num="0099">Now rearrange the rows to obtain the matrix <maths id="math0192" num="(E62)"><math display="block"><mfenced open="[" close="]"><mtable rowlines="solid" columnlines="solid"><mtr><mtd><mtable><mtr><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>0</mn></mfenced><mo>⁢</mo><mi>τ</mi><mo>,</mo><mi>τ</mi></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>1</mn></mfenced><mo>⁢</mo><mi>ψ</mi><mo>,</mo><mi>ψ</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable></mtd><mtd><mtable><mtr><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>0</mn></mfenced><mo>⁢</mo><mi>τ</mi><mo>,</mo><mover><mi>τ</mi><mi mathvariant="normal">r</mi></mover></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>0</mn></mfenced><mo>⁢</mo><mi>τ</mi><mo>,</mo><mi>N</mi></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>1</mn></mfenced><mo>⁢</mo><mi>ψ</mi><mo>,</mo><mover><mi>τ</mi><mi mathvariant="normal">r</mi></mover></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>1</mn></mfenced><mo>⁢</mo><mi>ψ</mi><mo>,</mo><mi>N</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable></mtd><mtd><mtable><mtr><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>0</mn></mfenced><mo>⁢</mo><mi>τ</mi></mrow><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mi>C</mi><mrow><mfenced><mn>1</mn></mfenced><mo>⁢</mo><mi>ψ</mi></mrow><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable></mtd></mtr><mtr><mtd><mtable><mtr><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mn>1</mn></mrow></msub></mtd></mtr></mtable></mtd><mtd><mtable><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mover><mi>A</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable></mtd><mtd><mtable><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable></mtd></mtr></mtable></mfenced><mn>.</mn></math><img id="ib0193" file="imgb0193.tif" wi="154" he="45" img-content="math" img-format="tif"/></maths></p><p id="p0100" num="0100">For estimating ambiguities double differences, the following block is of interest: <maths id="math0193" num="(E63)"><math display="block"><mfenced open="[" close="]"><mtable><mtr><mtd><mtable><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msub><mn>0</mn><mrow><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn><mo>×</mo><mi mathvariant="italic">NS</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd><mtd><msubsup><mover><mi>A</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable><mrow><mo>|</mo></mrow></mtd><mtd><mtable><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi>f</mi></mrow></msubsup></mtd></mtr></mtable></mtd></mtr></mtable></mfenced><mn>.</mn></math><img id="ib0194" file="imgb0194.tif" wi="118" he="24" img-content="math" img-format="tif"/></maths></p><p id="p0101" num="0101">Thus arranging the observation matrix in all frequencies for the ambiguity filter yields the following full matrix:<!-- EPO <DP n="56"> --> <maths id="math0194" num="(E64)"><math display="block"><mfenced open="[" close="]"><mtable><mtr><mtd><mtable><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mn>1</mn></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">O</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd></mtr><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mn>1</mn></mrow></msubsup></mtd><mtd><msubsup><mover><mi>A</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mn>1</mn></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mn>2</mn></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><msubsup><mover><mi>A</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mn>2</mn></mrow></msubsup></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">O</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd></mtr><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi><mo>-</mo><mn>1</mn></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><msubsup><mover><mi>A</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi><mo>-</mo><mn>1</mn></mrow></msubsup></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><msubsup><mover><mi>H</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi></mrow></msubsup></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mn>0</mn></mtd><mtd><msubsup><mover><mi>A</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi></mrow></msubsup></mtd></mtr></mtable><mrow><mo>|</mo></mrow></mtd><mtd><mtable><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mrow><mi>ρ</mi><mo>)</mo></mrow><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><mi mathvariant="normal">M</mi></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ρ</mi></mfenced><mo>⁢</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mn>2</mn></mrow></msubsup></mtd></mtr><mtr><mtd><mi mathvariant="normal">M</mi></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi><mo>-</mo><mn>1</mn></mrow></msubsup></mtd></mtr><mtr><mtd><msubsup><mover><mi>y</mi><mo>‾</mo></mover><mi mathvariant="italic">DD</mi><mrow><mfenced><mi>ϕ</mi></mfenced><mo>⁢</mo><mi mathvariant="italic">NF</mi></mrow></msubsup></mtd></mtr></mtable></mtd></mtr></mtable></mfenced><mn>.</mn></math><img id="ib0195" file="imgb0195.tif" wi="158" he="77" img-content="math" img-format="tif"/></maths><br/>
This matrix is the same as the one previously calculated as in (E52). &lt;&lt;Even though it is redundant, I will keep it. Otherwise there is a lot of work to renumber the remaining equations and figures.</p><p id="p0102" num="0102"><b>State Vector Updating.</b> An updating algorithm for CIC according to computational procedure (CI-LSM) is described. At the algorithm input in matrices <b>S</b>∈<b>M</b><sub><i>n</i>×<i>n</i></sub>(¡),<b>S</b>∈<b>M</b><sub><i>n</i>×1</sub>(¡), <i>a priori</i> values of CIC (<b>S̃</b><sup>x</sup>, <b>S̃</b><sup>x</sup>) are set. Matrices <b>H</b> ∈ M<sub><i>m</i>×<i>n</i></sub> (¡), <b><o>y</o></b> ∈ <b>M</b><sub><i>m</i>×1</sub>) (¡) are the matrices of the observation model and observation vector with normalized noise. All input matrices are re-calculated in processing the algorithm. At the output in matrices <b>S,s,</b> there are updated CIC (<b>Ŝ</b><sup>x</sup>, <b>Ŝ</b><sup>x</sup>) , and matrix <b><o>H</o></b> is reset, while in vector <b><o>y</o></b> there are weighted residuals. The updating algorithm yields matrix <b>S̃</b><sup>x</sup> as the upper triangular matrix. Pseudo-code for the updating algorithm is shown in <figref idrefs="f0005">Fig. 5</figref> (E65). Obtaining estimate <b>X̂</b> is implemented with the help of the procedure of backward substitution [see Golub]. Values <b>X̂</b> are obtained in vector <b>S</b>. The matrix procedure<!-- EPO <DP n="57"> --> "<b>A</b>.dotCol(<i>i</i>,[<b>B</b>,]<i>j</i>)" returns the dot product of columns as follows: <maths id="math0195" num=""><math display="inline"><msubsup><mi>A</mi><mrow><mo>:</mo><mo>,</mo><mi>i</mi></mrow><mi>T</mi></msubsup><mo>⋅</mo><msub><mi>B</mi><mrow><mo>:</mo><mo>,</mo><mi>j</mi></mrow></msub><mn>.</mn></math><img id="ib0196" file="imgb0196.tif" wi="26" he="13" img-content="math" img-format="tif" inline="yes"/></maths> The matrix procedure " <b>A</b>.saxpyCol(<i>i</i>, <i>t</i>, [<b>B</b>, <i>j</i> = 1])" rewrites the columns of <b>A</b> as follows: <i>A</i><sub>.,</sub><i><sub>i</sub> :=A</i><sub>:,<i>i</i></sub> + <i>t</i> · <i>B</i><sub>:,<i>j</i></sub>. if <b>B</b> ≡ <b>A</b> then <b>B</b> is omitted as follows: " <b>A</b>.dotCol(<i>i, j</i>) " and <b>A</b>.saxpyCoi(<i>i,t,j</i>)". When the number of columns of <b>B</b> is 1, the argument " <i>j</i> " is omitted in "saxpyCol". One skilled in the art can convert the pseudo-code to computer-executable code.</p><p id="p0103" num="0103"><b>Changing Reference Satellite.</b> Assume that according to frequency variables <i><sup>f</sup></i> a new reference satellite has been selected with number <maths id="math0196" num=""><math display="inline"><mi>j</mi><mo>≡</mo><msubsup><mi>s</mi><mrow><mi>ref</mi><mo>,</mo><mi>k</mi></mrow><mi>f</mi></msubsup><mn>.</mn></math><img id="ib0197" file="imgb0197.tif" wi="24" he="10" img-content="math" img-format="tif" inline="yes"/></maths> Old variables (for reference satellite <maths id="math0197" num=""><math display="inline"><mi>r</mi><mo>≡</mo><msubsup><mi>s</mi><mrow><mi>ref</mi><mo>,</mo><mi>k</mi><mo>-</mo><mn>1</mn></mrow><mi>f</mi></msubsup></math><img id="ib0198" file="imgb0198.tif" wi="24" he="11" img-content="math" img-format="tif" inline="yes"/></maths>) are expressed using new ones (reference satellite <i>j</i>) according to: <maths id="math0198" num="(E66)"><math display="block"><mtable columnalign="left"><mtr><mtd columnalign="right"><msup><mi>M</mi><mrow><mi>f</mi><mo>,</mo><mi>r</mi></mrow></msup></mtd><mtd><mo>=</mo><msup><mi>M</mi><mrow><mi>f</mi><mo>,</mo><mi>j</mi></mrow></msup><mo>+</mo><msup><mo>∇</mo><mrow><mi>r</mi><mo>,</mo><mi>j</mi></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup></mtd></mtr><mtr><mtd columnalign="right"><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><mi>r</mi></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup></mtd><mtd><mo>=</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup><mo>-</mo><msup><mo>∇</mo><mrow><mi>r</mi><mo>,</mo><mi>j</mi></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup></mtd></mtr><mtr><mtd columnalign="right"><mrow><mo>(</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup></mrow></mtd><mtd><mo>≡</mo><mn>0</mn><mo>∀</mo><mi>s</mi><mrow><mo>)</mo></mrow><mn>.</mn></mtd></mtr></mtable></math><img id="ib0199" file="imgb0199.tif" wi="131" he="32" img-content="math" img-format="tif"/></maths></p><p id="p0104" num="0104">When processing double differences, substitution of phase offsets does not affect the task, since the phase offsets are eliminated in double differences; hence, only ambiguities double differences are important. In matrix form, the ambiguities vector for frequency <i><sup>f</sup></i> changes according to the rule: <maths id="math0199" num="(E67)"><math display="block"><msub><mfenced separators=""><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><mi>r</mi></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup></mfenced><mrow><mi>s</mi><mo>≠</mo><mi>r</mi></mrow></msub><mo>=</mo><msup><mi>A</mi><mi>f</mi></msup><mo>⋅</mo><msub><mfenced separators=""><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup></mfenced><mrow><mi>s</mi><mo>≠</mo><mi>j</mi></mrow></msub></math><img id="ib0200" file="imgb0200.tif" wi="130" he="20" img-content="math" img-format="tif"/></maths><!-- EPO <DP n="58"> --> <maths id="math0200" num=""><math display="block"><msup><mi>A</mi><mi>f</mi></msup><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><msub><mi>Id</mi><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd><mtd><mo>-</mo><msub><mn>1</mn><mrow><mi>j</mi><mo>-</mo><mn>1</mn><mo>×</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mn>0</mn><mrow><mi>j</mi><mo>-</mo><mn>1</mn><mo>×</mo><mi>n</mi><mo>-</mo><mi>j</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mn>0</mn><mrow><mn>1</mn><mo>×</mo><mi>j</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd><mtd><mo>-</mo><mn>1</mn></mtd><mtd><msub><mn>0</mn><mrow><mn>1</mn><mo>×</mo><mi>n</mi><mo>-</mo><mi>j</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd><msub><mn>0</mn><mrow><mi>n</mi><mo>-</mo><mi>j</mi><mo>-</mo><mn>1</mn><mo>×</mo><mi>j</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd><mtd><mo>-</mo><msub><mn>1</mn><mrow><mi>n</mi><mo>-</mo><mi>j</mi><mo>-</mo><mn>1</mn><mo>×</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>Id</mi><mrow><mi>n</mi><mo>-</mo><mi>j</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd></mtr></mtable></mfenced><mn>.</mn></math><img id="ib0201" file="imgb0201.tif" wi="106" he="37" img-content="math" img-format="tif"/></maths><br/>
Here α<sub><i>p</i>×<i>q</i></sub> represents the matrix of the corresponding dimension, all the elements of which are equal to <i>a</i>; and <i>n</i> is the number of ambiguities on frequency <i>f</i>.</p><p id="p0105" num="0105">New variables are expressed through old ones in a similar way <maths id="math0201" num="(E68)"><math display="block"><mtable columnalign="left"><mtr><mtd columnalign="right"><msup><mi>M</mi><mrow><mi>f</mi><mo>,</mo><mi>j</mi></mrow></msup></mtd><mtd><mo>=</mo><msup><mi>M</mi><mrow><mi>f</mi><mo>,</mo><mi>r</mi></mrow></msup><mo>-</mo><msup><mo>∇</mo><mrow><mi>r</mi><mo>,</mo><mi>j</mi></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup></mtd></mtr><mtr><mtd columnalign="right"><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup></mtd><mtd><mo>=</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><mi>r</mi></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup><mo>+</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup></mtd></mtr><mtr><mtd columnalign="right"><mrow><mo>(</mo><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><mi>s</mi></mrow></msup><mo>⁢</mo><msup><mi>N</mi><mi>f</mi></msup></mrow></mtd><mtd><mo>≡</mo><mn>0</mn><mo>∀</mo><mi>s</mi><mrow><mo>)</mo></mrow><mn>.</mn></mtd></mtr></mtable></math><img id="ib0202" file="imgb0202.tif" wi="120" he="31" img-content="math" img-format="tif"/></maths><br/>
Note that <maths id="math0202" num="(E69)"><math display="block"><msub><mfenced separators=""><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msup><mo>⁢</mo><mi>N</mi></mfenced><mrow><mi>s</mi><mo>≠</mo><mi>j</mi></mrow></msub><mo>=</mo><msup><mi>A</mi><mi>f</mi></msup><mo>⋅</mo><msub><mfenced separators=""><msup><mo>∇</mo><mrow><mi>s</mi><mo>,</mo><mi>r</mi></mrow></msup><mo>⁢</mo><mi>N</mi></mfenced><mrow><mi>s</mi><mo>≠</mo><mi>r</mi></mrow></msub></math><img id="ib0203" file="imgb0203.tif" wi="122" he="14" img-content="math" img-format="tif"/></maths><br/>
with the above-mentioned substitution matrix <i>A<sup>f</sup></i>. For the whole state vector: <maths id="math0203" num="(E70)"><math display="block"><mtable columnalign="left"><mtr><mtd><msub><mi>x</mi><mi mathvariant="italic">old</mi></msub></mtd><mtd><mo>=</mo><msub><mi mathvariant="italic">Ax</mi><mi mathvariant="italic">new</mi></msub><mo>,</mo></mtd></mtr><mtr><mtd><mi>A</mi></mtd><mtd><mo>=</mo><mi>diag</mi><mfenced separators=""><msub><mi>Id</mi><mn>3</mn></msub><mo>⁢</mo><msup><mi>A</mi><mn>1</mn></msup><mo>⁢</mo><mi mathvariant="normal">K</mi><mo>⁢</mo><msup><mi>A</mi><mi mathvariant="italic">NF</mi></msup></mfenced><mn>.</mn></mtd></mtr></mtable></math><img id="ib0204" file="imgb0204.tif" wi="135" he="18" img-content="math" img-format="tif"/></maths><br/>
To re-calculate CIC elements <i>S</i><sup>x</sup>, <i>S</i><sup>x</sup>, note that <maths id="math0204" num=""><math display="inline"><msubsup><mi>S</mi><mi mathvariant="italic">old</mi><mi>x</mi></msubsup><mo>⁢</mo><msub><mi>x</mi><mi mathvariant="italic">old</mi></msub><mo>=</mo><msubsup><mi>s</mi><mi mathvariant="italic">old</mi><mi>x</mi></msubsup><mo>;</mo></math><img id="ib0205" file="imgb0205.tif" wi="34" he="9" img-content="math" img-format="tif" inline="yes"/></maths>; hence <maths id="math0205" num=""><math display="inline"><mfenced separators=""><msubsup><mi>S</mi><mi mathvariant="italic">old</mi><mi>x</mi></msubsup><mo>⁢</mo><mi>A</mi></mfenced><mo>⁢</mo><msub><mi>x</mi><mi mathvariant="italic">new</mi></msub><mo>=</mo><msubsup><mi>s</mi><mi mathvariant="italic">old</mi><mi>x</mi></msubsup><mn>.</mn></math><img id="ib0206" file="imgb0206.tif" wi="45" he="10" img-content="math" img-format="tif" inline="yes"/></maths> Therefore, <maths id="math0206" num=""><math display="inline"><msubsup><mi>S</mi><mi mathvariant="italic">new</mi><mi>x</mi></msubsup><mo>⁢</mo><msub><mi>x</mi><mi mathvariant="italic">new</mi></msub><mo>=</mo><msubsup><mi>s</mi><mi mathvariant="italic">new</mi><mi>x</mi></msubsup><mn>.</mn></math><img id="ib0207" file="imgb0207.tif" wi="38" he="9" img-content="math" img-format="tif" inline="yes"/></maths> Matrix <maths id="math0207" num=""><math display="inline"><mfenced open="[" close="]" separators=""><msubsup><mi>S</mi><mi mathvariant="italic">new</mi><mi>x</mi></msubsup><mrow><mo>|</mo></mrow><msubsup><mi>s</mi><mi mathvariant="italic">new</mi><mi>x</mi></msubsup></mfenced></math><img id="ib0208" file="imgb0208.tif" wi="28" he="10" img-content="math" img-format="tif" inline="yes"/></maths> is derived from <maths id="math0208" num=""><math display="inline"><mfenced open="[" close="]" separators=""><msubsup><mi>S</mi><mi mathvariant="italic">old</mi><mi>x</mi></msubsup><mo>⁢</mo><mi>A</mi><mrow><mo>|</mo></mrow><msubsup><mi>s</mi><mi mathvariant="italic">old</mi><mi>x</mi></msubsup></mfenced></math><img id="ib0209" file="imgb0209.tif" wi="30" he="9" img-content="math" img-format="tif" inline="yes"/></maths> after its reduction to the upper triangular form using the<!-- EPO <DP n="59"> --> <i>QR -</i> transformation. Matrix <maths id="math0209" num=""><math display="inline"><msubsup><mi>S</mi><mi mathvariant="italic">old</mi><mi>x</mi></msubsup><mo>⁢</mo><mi>A</mi></math><img id="ib0210" file="imgb0210.tif" wi="15" he="8" img-content="math" img-format="tif" inline="yes"/></maths> <i>A</i> has the following structure shown in <figref idrefs="f0006">Fig. 6</figref> (E71).</p><p id="p0106" num="0106">Blocks <i>S</i><sub>[</sub><i><sub>N</sub>f</i><sub><i>'</i>]<i>,</i>[N</sub>f<sub>]</sub> <i>A<sup>f</sup></i> are computed considering the structure of matrices <i>A<sup>f</sup></i> and <i>S</i><sub>[</sub><i><sub>N<sup2>f'</sup2></sub>f</i><sub>],[<i>N<sup>f</sup></i>]</sub><i>.</i> The product of right multiplication for an arbitrary matrix <i>M</i> by matrix <i>A<sup>f</sup></i>, determined previously, differs from <i>M</i> only in that <i>j</i> -th column equal to <maths id="math0210" num=""><math display="inline"><mo>−</mo><msubsup><mi>M</mi><mn>1</mn><mi>i</mi></msubsup><mn>.</mn></math><img id="ib0211" file="imgb0211.tif" wi="19" he="12" img-content="math" img-format="tif" inline="yes"/></maths> For matrix <i>M</i> = [<i>M</i><sub>1</sub>,...,<i>M<sub>j</sub></i> ,... <i>M<sub>n</sub></i>], written in columns, <maths id="math0211" num="(E72)"><math display="block"><msub><mi mathvariant="italic">MA</mi><mn>0</mn></msub><mo>=</mo><mfenced open="[" close="]" separators=""><msub><mi>M</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>M</mi><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>M</mi><mo>⁢</mo><mn>1</mn><mo>,</mo><msub><mi>M</mi><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>M</mi><mi>n</mi></msub></mfenced><mo>,</mo></math><img id="ib0212" file="imgb0212.tif" wi="144" he="16" img-content="math" img-format="tif"/></maths><br/>
where <maths id="math0212" num=""><math display="inline"><msub><mover><mfenced open="[" close="]" separators=""><mi>M</mi><mo>⁢</mo><mn>1</mn></mfenced><mrow><mspace width="1em"/><mi mathvariant="normal">r</mi></mrow></mover><mi>i</mi></msub><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover></mstyle><msub><mi>M</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mn>.</mn></math><img id="ib0213" file="imgb0213.tif" wi="44" he="17" img-content="math" img-format="tif" inline="yes"/></maths> For the arbitrary upper triangular matrix <i>M</i>, the number of operations can be reduced by cancelling known zero summands: <maths id="math0213" num="(E73)"><math display="block"><mover><msub><mfenced open="[" close="]" separators=""><mi>M</mi><mo>⁢</mo><mn>1</mn></mfenced><mi>i</mi></msub><mi mathvariant="normal">r</mi></mover><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mi>i</mi></mrow><mi>n</mi></munderover></mstyle><msub><mi>M</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mn>.</mn></math><img id="ib0214" file="imgb0214.tif" wi="106" he="18" img-content="math" img-format="tif"/></maths><br/>
Multiplication of <i>A<sup>f</sup></i> is applied on upper triangular and square matrices. Since <i>A<sup>f</sup></i> has a particular special structure, the result of multiplication can be obtained with substantially fewer number of flops; consequently, the load on the central processing unit (CPU) is substantially reduced. For an upper triangular matrix, the number of flops can be reduced almost by a factor of two compared to that of a square one.</p><p id="p0107" num="0107">Thus matrix (E69) is transformed to the upper triangular form. This matrix partially has the required structure. Most of the sub-diagonal elements are<!-- EPO <DP n="60"> --> zero, except for the columns corresponding to the old reference satellite. It is sufficient to transform diagonal <i>blocks S</i><sub>[<i>N<sup>f</sup></i>]</sub><i>,</i><sub>[<i>N<sup>f</sup></i>]</sub><i>A<sup>f</sup></i> to the upper triangular form. The structure of this block is given by <maths id="math0214" num="(E74)"><math display="block"><mfenced open="[" close="]"><mtable rowlines="dashed" columnlines="dashed"><mtr><mtd><mspace width="1em"/></mtd><mtd><mtable><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd><mtd><mspace width="1em"/></mtd><mtd><mspace width="2em"/><mi>j</mi><mo>-</mo><mn>1</mn></mtd></mtr></mtable></mtd><mtd><mtable><mtr><mtd><mi>j</mi></mtd><mtd><mi>j</mi><mo>+</mo><mn>1</mn></mtd><mtd><mi>j</mi><mo>+</mo><mn>2</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mi>n</mi><mo>-</mo><mn>1</mn></mtd><mtd><mi>n</mi></mtd></mtr></mtable></mtd></mtr><mtr><mtd><mtable><mtr><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>2</mn></mtd></mtr><mtr><mtd><mi mathvariant="normal">M</mi></mtd></mtr><mtr><mtd><mi>j</mi><mo>-</mo><mn>1</mn></mtd></mtr></mtable></mtd><mtd><mtable><mtr><mtd><mo>×</mo></mtd><mtd><mo>×</mo></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mspace width="2em"/><mo>×</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mo>×</mo></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mspace width="2em"/><mo>×</mo></mtd></mtr><mtr><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">O</mi></mtd><mtd><mspace width="2em"/><mi mathvariant="normal">M</mi></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mspace width="2em"/><mo>×</mo></mtd></mtr></mtable></mtd><mtd><mtable><mtr><mtd columnalign="left"><mo>×</mo><mspace width="1em"/></mtd><mtd columnalign="left"><mo>×</mo><mspace width="1em"/></mtd><mtd><mo>×</mo></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mo>×</mo></mtd><mtd columnalign="right"><mspace width="1em"/><mo>×</mo></mtd></mtr><mtr><mtd columnalign="left"><mo>×</mo></mtd><mtd columnalign="left"><mo>×</mo></mtd><mtd><mo>×</mo></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mo>×</mo></mtd><mtd columnalign="right"><mo>×</mo></mtd></mtr><mtr><mtd columnalign="left"><mi mathvariant="normal">M</mi></mtd><mtd columnalign="left"><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">O</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd columnalign="right"><mi mathvariant="normal">M</mi></mtd></mtr><mtr><mtd columnalign="left"><mo>×</mo></mtd><mtd columnalign="left"><mo>×</mo></mtd><mtd><mo>×</mo></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mo>×</mo></mtd><mtd columnalign="right"><mo>×</mo></mtd></mtr></mtable></mtd></mtr><mtr><mtd><mtable><mtr><mtd><mi>j</mi></mtd></mtr><mtr><mtd><mi>j</mi><mo>+</mo><mn>1</mn></mtd></mtr><mtr><mtd><mi>j</mi><mo>+</mo><mn>2</mn></mtd></mtr><mtr><mtd><mi mathvariant="normal">M</mi></mtd></mtr><mtr><mtd><mi>n</mi><mo>-</mo><mn>1</mn></mtd></mtr><mtr><mtd><mi>n</mi></mtd></mtr></mtable></mtd><mtd><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mspace width="2em"/><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mspace width="2em"/><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mspace width="2em"/><mn>0</mn></mtd></mtr><mtr><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">O</mi></mtd><mtd><mspace width="2em"/><mi mathvariant="normal">M</mi></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mspace width="2em"/><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mspace width="2em"/><mn>0</mn></mtd></mtr></mtable></mtd><mtd><mtable><mtr><mtd columnalign="left"><mo>×</mo><mspace width="1em"/></mtd><mtd columnalign="left"><mo>×</mo><mspace width="1em"/></mtd><mtd><mo>×</mo></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mo>×</mo></mtd><mtd columnalign="right"><mspace width="1em"/><mo>×</mo></mtd></mtr><mtr><mtd columnalign="left"><mo>×</mo></mtd><mtd columnalign="left"><mo>×</mo></mtd><mtd><mo>×</mo></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mo>×</mo></mtd><mtd columnalign="right"><mo>×</mo></mtd></mtr><mtr><mtd columnalign="left"><mo>×</mo></mtd><mtd columnalign="left"><mn>0</mn></mtd><mtd><mo>×</mo></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mo>×</mo></mtd><mtd columnalign="right"><mo>×</mo></mtd></mtr><mtr><mtd columnalign="left"><mi mathvariant="normal">M</mi></mtd><mtd columnalign="left"><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">O</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd columnalign="right"><mi mathvariant="normal">M</mi></mtd></mtr><mtr><mtd columnalign="left"><mo>×</mo></mtd><mtd columnalign="left"><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mo>×</mo></mtd><mtd columnalign="right"><mo>×</mo></mtd></mtr><mtr><mtd columnalign="left"><mo>×</mo></mtd><mtd columnalign="left"><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">L</mi></mtd><mtd><mn>0</mn></mtd><mtd columnalign="right"><mo>×</mo></mtd></mtr></mtable></mtd></mtr></mtable></mfenced><mn>.</mn></math><img id="ib0215" file="imgb0215.tif" wi="132" he="75" img-content="math" img-format="tif"/></maths></p><p id="p0108" num="0108">Note that only the lower right block is transformed to the upper triangular form. To do this, the QR-update algorithm [see Lawson or Golub] is used. This algorithm reduces the number of flops. Note that for each block <i>S</i><sub>[<i>N<sup>f</sup></i>]</sub><i>,</i><sub>[<i>N<sup>f</sup></i>]</sub><i>A<sup>f</sup>,</i> elements of blocks S<sub>[<i>N<sup>f'</sup></i>]</sub><i>,</i><sub>[<i>N<sup>f</sup></i>]</sub><i>A<sup>f</sup> , f'</i> &gt; <i>f</i> and corresponding components <i>S<sub>[N<sup2>f</sup2>]</sub></i> are re-calculated. That is, a block row of the extended matrix associated with [<i>N<sup>f</sup></i>] is re-calculated. This procedure is successively performed for each system frequency band. The validity of this procedure follows from the fact that, in the process of changing the reference satellite in one frequency, the elements corresponding to other block rows do not change. This is a property of the QR-transformation (made by QR-update). After the reference satellite has changed, the CIC is recalculated.<!-- EPO <DP n="61"> --></p><p id="p0109" num="0109"><b>Ambiguity Processing for a Setting Satellite.</b> For the satellite that disappears, the columns in the observation matrix which correspond to its ambiguities are zero. Hence no information can be obtained for them. When a satellite disappears, outdated information about its ambiguities first needs to be removed from the CIC. Such a situation can occur when there is fading or interruption in the satellite link. Non-information variables are removed from the state vector and CIC to avoid their estimation. For this purpose, the following algorithm, expressed in pseudo-code, can be used: <maths id="math0215" num="(E75)"><math display="block"><mtable columnalign="left"><mtr><mtd><mi>RemoveVariable</mi><mfenced separators=""><mo>&amp;</mo><mi mathvariant="bold">S</mi><mo>,</mo><mo>&amp;</mo><mi mathvariant="bold">s</mi><mo>,</mo><mi mathvariant="normal">d</mi></mfenced></mtd></mtr><mtr><mtd><mrow><mo>{</mo></mrow></mtd></mtr><mtr><mtd><mspace width="2em"/><mi mathvariant="bold">w</mi><mo>:</mo><mo>=</mo><msub><mi mathvariant="bold">S</mi><mrow><mfenced open="[" close="]"><mo>:</mo></mfenced><mo>,</mo><mi>d</mi></mrow></msub><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mi>nw</mi><mo>⁢</mo><mn>2</mn><mo>:</mo><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>d</mi></munderover></mstyle><msup><mfenced><msub><mfenced open="[" close="]"><mi mathvariant="bold">w</mi></mfenced><mi>i</mi></msub></mfenced><mn>2</mn></msup><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mi>FormFactors</mi><mfenced separators=""><mi>w</mi><mo>,</mo><mi>nw</mi><mo>⁢</mo><mn>2</mn><mo>,</mo><mo>&amp;</mo><mi mathvariant="bold">a</mi><mo>,</mo><mo>&amp;</mo><mi mathvariant="bold">α</mi><mo>,</mo><mn>1</mn><mo>,</mo><mo>&amp;</mo><munder><mi>n</mi><mo>̲</mo></munder></mfenced><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mi>for</mi><mo>⁢</mo><mfenced separators=""><mi>i</mi><mo>:</mo><mo>=</mo><mn>1</mn><mo>;</mo><mi>i</mi><mo>&lt;</mo><mi>d</mi><mo>;</mo><mi>i</mi><mo>:</mo><mo>=</mo><mi>i</mi><mo>+</mo><mn>1</mn></mfenced></mtd></mtr><mtr><mtd><mspace width="2em"/><mi>Multiply</mi><mfenced separators=""><msub><mi mathvariant="bold">S</mi><mrow><mfenced open="[" close="]"><mo>:</mo></mfenced><mo>,</mo><mi>i</mi></mrow></msub><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi mathvariant="bold">a</mi><mo>⁢</mo><mi mathvariant="bold">α</mi><mo>⁢</mo><mi mathvariant="bold">w</mi><mo>⁢</mo><mn>1</mn><mo>⁢</mo><mi>d</mi></mfenced><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mi>for</mi><mo>⁢</mo><mfenced separators=""><mi>i</mi><mo>:</mo><mo>=</mo><mi>d</mi><mo>+</mo><mn>1</mn><mo>;</mo><mi>i</mi><mo>≤</mo><mi>n</mi><mo>;</mo><mi>i</mi><mo>:</mo><mo>=</mo><mi>i</mi><mo>+</mo><mn>1</mn></mfenced></mtd></mtr><mtr><mtd><mspace width="2em"/><mi>Multiply</mi><mfenced separators=""><msub><mi mathvariant="bold">S</mi><mrow><mfenced open="[" close="]"><mo>:</mo></mfenced><mo>,</mo><mi>i</mi></mrow></msub><mo>⁢</mo><mi>d</mi><mo>⁢</mo><mi mathvariant="bold">a</mi><mo>⁢</mo><mi mathvariant="bold">α</mi><mo>⁢</mo><mi mathvariant="bold">w</mi><mo>⁢</mo><mn>1</mn><mo>⁢</mo><mi>d</mi></mfenced><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mi>Multiply</mi><mfenced separators=""><mi mathvariant="bold">s</mi><mo>⁢</mo><mi>d</mi><mo>⁢</mo><mi mathvariant="bold">a</mi><mo>⁢</mo><mi mathvariant="bold">α</mi><mo>⁢</mo><mi mathvariant="bold">w</mi><mo>⁢</mo><mn>1</mn><mo>⁢</mo><mi>d</mi></mfenced><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mi mathvariant="bold">S</mi><mn>.</mn><mi>delRow</mi><mfenced><mi>d</mi></mfenced><mo>;</mo><mi mathvariant="bold">S</mi><mn>.</mn><mi>delCol</mi><mfenced><mi>d</mi></mfenced><mo>;</mo></mtd></mtr><mtr><mtd><mspace width="2em"/><mi mathvariant="bold">S</mi><mn>.</mn><mi>delRow</mi><mfenced><mi>d</mi></mfenced><mo>;</mo></mtd></mtr><mtr><mtd><mrow><mo>}</mo></mrow></mtd></mtr></mtable></math><img id="ib0216" file="imgb0216.tif" wi="134" he="110" img-content="math" img-format="tif"/></maths><br/>
One skilled in the art can convert the pseudo-code to computer-executable code.</p><p id="p0110" num="0110">Consider the algorithms shown in <figref idrefs="f0007">Fig. 7</figref> (E76) and shown in <figref idrefs="f0008">Fig. 8</figref> (E77), expressed in pseudo-code. The algorithm shown in <figref idrefs="f0007">Fig 7</figref> forms coefficients <b>a</b>, α for the matrix which is the Cholessky decomposition to projection matrix; this<!-- EPO <DP n="62"> --> operation eliminates the column of S corresponding to the variable to be excluded. The projection matrix can be written as <maths id="math0216" num="(E78)"><math display="block"><mi mathvariant="bold">P</mi><mo>=</mo><mi mathvariant="bold">Id</mi><mo>-</mo><msup><mfenced open="|" close="|"><mi mathvariant="bold">w</mi></mfenced><mrow><mo>-</mo><mn>2</mn></mrow></msup><mo>⁢</mo><mi mathvariant="bold">w</mi><mo>⋅</mo><msup><mi mathvariant="bold">w</mi><mi>T</mi></msup><mo>,</mo><mi mathvariant="bold">w</mi><mo>=</mo><msub><mi mathvariant="bold">S</mi><mrow><mfenced open="[" close="]"><mo>:</mo></mfenced><mo>,</mo><mfenced open="[" close="]"><mi>d</mi></mfenced></mrow></msub><mn>.</mn></math><img id="ib0217" file="imgb0217.tif" wi="132" he="17" img-content="math" img-format="tif"/></maths><br/>
Its Cholessky matrix can be expressed as <maths id="math0217" num="(E79)"><math display="block"><mi mathvariant="bold">Γ</mi><mo>=</mo><mi>diag</mi><mfenced><mi mathvariant="bold">a</mi></mfenced><mo>+</mo><mi>diag</mi><mfenced separators=""><mi mathvariant="bold">α</mi><mo>⁢</mo><mn>0</mn></mfenced><mo>⁢</mo><mi mathvariant="bold">W</mi><mfenced><mi mathvariant="bold">w</mi></mfenced><mo>,</mo></math><img id="ib0218" file="imgb0218.tif" wi="133" he="14" img-content="math" img-format="tif"/></maths><br/>
where <maths id="math0218" num="(E80)"><math display="block"><mi mathvariant="bold">a</mi><mo>=</mo><msubsup><mfenced><msub><mi>a</mi><mi>i</mi></msub></mfenced><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mo>,</mo><mi mathvariant="bold">α</mi><mo>=</mo><msubsup><mfenced><msub><mi>α</mi><mi>i</mi></msub></mfenced><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msubsup><mo>,</mo></math><img id="ib0219" file="imgb0219.tif" wi="137" he="12" img-content="math" img-format="tif"/></maths> <maths id="math0219" num=""><math display="block"><mi mathvariant="bold">W</mi><mfenced><mi mathvariant="bold">w</mi></mfenced><mo>=</mo><mfenced open="[" close="]"><mtable><mtr><mtd><mn>0</mn></mtd><mtd><msub><mfenced open="[" close="]"><mi mathvariant="bold">w</mi></mfenced><mn>2</mn></msub></mtd><mtd><msub><mfenced open="[" close="]"><mi mathvariant="bold">w</mi></mfenced><mn>3</mn></msub></mtd><mtd><mi mathvariant="normal">K</mi></mtd><mtd><msub><mfenced open="[" close="]"><mi mathvariant="bold">w</mi></mfenced><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mfenced open="[" close="]"><mi mathvariant="bold">w</mi></mfenced><mi>n</mi></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><msub><mfenced open="[" close="]"><mi mathvariant="bold">w</mi></mfenced><mn>3</mn></msub></mtd><mtd><mi mathvariant="normal">K</mi></mtd><mtd><msub><mfenced open="[" close="]"><mi mathvariant="bold">w</mi></mfenced><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mfenced open="[" close="]"><mi mathvariant="bold">w</mi></mfenced><mi>n</mi></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">K</mi></mtd><mtd><msub><mfenced open="[" close="]"><mi mathvariant="bold">w</mi></mfenced><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mfenced open="[" close="]"><mi mathvariant="bold">w</mi></mfenced><mi>n</mi></msub></mtd></mtr><mtr><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">O</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd><mtd><mi mathvariant="normal">M</mi></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">K</mi></mtd><mtd><mn>0</mn></mtd><mtd><msub><mfenced open="[" close="]"><mi mathvariant="bold">w</mi></mfenced><mi>n</mi></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">K</mi></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mfenced><mn>.</mn></math><img id="ib0220" file="imgb0220.tif" wi="112" he="63" img-content="math" img-format="tif"/></maths><br/>
Since Γ has a special structure, left multiplication is made with fewer number of flops. The multiply procedure performs that operation.</p><p id="p0111" num="0111"><b>Ambiguity Processing for a Rising Satellite.</b> This situation occurs when a new satellite rises in the constellation. To add this variable to the state vector of ambiguity filter, matrices <b>S<sup>x</sup></b>, <b>S<sup>x</sup></b> are expanded, and the<!-- EPO <DP n="63"> --> corresponding row and column are filled with zeros. That means that a new variable with zero information has been added to the state vector.</p><p id="p0112" num="0112">The procedures discussed above for treating change of a reference satellite, appearance of a satellite, and disappearance of a satellite are performed for all satellites and on all frequencies.</p><p id="p0113" num="0113">An embodiment of a computational system for performing the processes discussed above for detecting and correcting anomalies and resolving ambiguities is shown in <figref idrefs="f0009">Fig. 9</figref>. The computational system 902 is typically located in the navigation receiver of a rover; however, it can be a separate unit. One skilled in the art can construct the computational system 902 from various combinations of hardware, firmware, and software. One skilled in the art can construct the computational system 902 from various electronic components, including one or more general purpose microprocessors, one or more digital signal processors, one or more application-specific integrated circuits (ASICs), and one or more field-programmable gate arrays (FPGAs).</p><p id="p0114" num="0114">Computational system 902 comprises computer 906, which includes a central processing unit (CPU) 908, memory 910, and data storage device 912. Data storage device 912 comprises at least one persistent, non-transitory, tangible computer readable medium, such as non-volatile semiconductor memory, a magnetic hard drive, or a compact disc read only memory. In an embodiment of the invention, computer 906 is implemented as an integrated device.</p><p id="p0115" num="0115">Computational system 902 can further comprise user input/output interface 914, which interfaces computer 906 to user input/output device 922. Examples of input/output device 922 include a keyboard, a mouse, and a local access terminal. Data, including computer executable code, can be transferred to and from computer 906 via input/output interface 914.</p><p id="p0116" num="0116">Computational system 902 can further comprise communications network interface 916, which interfaces computer 906 with remote access network 924. Examples of remote access network 924 include a local area network and a wide area network. A user can access computer 906 via a remote access terminal<!-- EPO <DP n="64"> --> (not shown). Data, including computer executable code, can be transferred to and from computer 906 via communications network interface 916.</p><p id="p0117" num="0117">Computational system 902 can further comprise a modem interface 918, which interfaces computer 906 with modem 926. In general, a modem refers to a communications device which receives input data from the base or other data source.</p><p id="p0118" num="0118">Computational system 902 can further comprise data bus interface 920, which interfaces computer 906 with other signal processing systems and data processing systems 928, such as an RF front end (which processes the RF signals received by the antenna of the navigation receiver), an analog-to-digital converter, digital channel processing system, and GNSS coordinate computational system (which calculates the coordinates of the rover).</p><p id="p0119" num="0119">As is well known, a computer operates under control of computer software, which defines the overall operation of the computer and applications. CPU 908 controls the overall operation of the computer and applications by executing computer program instructions which define the overall operation and applications. The computer program instructions can be stored in data storage device 912 and loaded into memory 910 when execution of the program instructions is desired. The method steps shown in the flowcharts in <figref idrefs="f0001">Fig. 1</figref> and <figref idrefs="f0002">Fig. 2</figref> can be defined by computer program instructions stored in the memory 910 or in the data storage device 912 (or in a combination of memory 910 and data storage device 912) and controlled by the CPU 908 executing the computer program instructions. For example, the computer program instructions can be implemented as computer executable code programmed by one skilled in the art to perform algorithms implementing the method steps shown in the flowcharts in <figref idrefs="f0001">Fig. 1</figref> and <figref idrefs="f0002">Fig. 2</figref>. Accordingly, by executing the computer program instructions, the CPU 908 executes algorithms implementing the method steps shown in the flowcharts in <figref idrefs="f0001">Fig. 1</figref> and <figref idrefs="f0002">Fig. 2</figref>.</p></description><claims mxw-id="PCLM56977871" lang="DE" load-source="patent-office"><!-- EPO <DP n="68"> --><claim id="c-de-01-0001" num="0001"><claim-text>Verfahren zum Auflösen von Unklarheiten in einem globalen Satellitennavigationssystem, aufweisend einen ersten Navigationsempfänger, der sich in einem Fahrzeug befindet, und einen zweiten Navigationsempfänger, der sich in einer Basisstation befindet, wobei das Verfahren die folgenden Schritte aufweist:
<claim-text>Empfangen einer ersten Vielzahl an Messungen auf Basis einer ersten Vielzahl an Trägersignalen, die durch den ersten Navigationsempfänger von einer Vielzahl an globalen Navigationssatelliten (201) empfangen werden, wobei die erste Vielzahl an Messungen eine erste Vielzahl an Pseudo-Reichweiten und eine erste Vielzahl an Trägerphasen aufweist;</claim-text>
<claim-text>Empfangen einer zweiten Vielzahl an Messungen auf Basis einer zweiten Vielzahl an Trägersignalen, die durch den zweiten Navigationsempfänger von der Vielzahl an globalen Navigationssatelliten (201) empfangen werden, wobei die zweite Vielzahl an Messungen eine zweite Vielzahl an Pseudo-Reichweiten und eine zweite Vielzahl an Trägerphasen aufweist,</claim-text>
<claim-text>wobei jedes Trägersignal in der zweiten Vielzahl an Trägersignalen einem Trägersignal in der ersten Vielzahl an Trägersignalen entspricht, und wobei jede Messung in der zweiten Vielzahl an Messungen einer Messung in der ersten Vielzahl an Messungen entspricht;</claim-text>
<claim-text>Berechnen einer Vielzahl an Einzeldifferenzen auf Basis der ersten Vielzahl an Messungen und der zweiten Vielzahl an Messungen (202);</claim-text>
<claim-text>Linearisieren der Vielzahl an Einzeldifferenzen (204);</claim-text>
<claim-text>Bestimmen eines Beobachtungsvektors und einer Beobachtungsmatrix auf Basis der linearisierten Einzeldifferenzen (206);</claim-text>
<claim-text>Filtern von Unklarheiten (222), wobei das Filtern von Unklarheiten das Folgende aufweist:
<claim-text>Erzeugen eines Cholesky-Informations-Kalman-Filters; und</claim-text>
<claim-text>Durchführen einer Householder-Transformation an dem Cholesky-Informations-Kalman-Filter;</claim-text><!-- EPO <DP n="69"> --></claim-text>
<claim-text>Schätzen von Gleitkomma-Unklarheiten auf Basis der gefilterten Unklarheiten (224);</claim-text>
<claim-text>Bestimmen eines Ganzzahl-Unklarheiten-Vektorkandidaten (226);</claim-text>
<claim-text>Bestimmen, ob der Ganzzahl-Unklarheiten-Vektorkandidat feste Kriterien (230) erfüllt; und</claim-text>
<claim-text>Erzeugen einer Schätzung des Ganzzahl-Unklarheiten-Vektors (211, 221) in Reaktion auf die Bestimmung, dass der Ganzzahl-Unklarheiten-Vektorkandidat die festen Kriterien erfüllt.</claim-text></claim-text></claim><claim id="c-de-01-0002" num="0002"><claim-text>Verfahren nach Anspruch 1, ferner aufweisend den folgenden Schritt:
<claim-text>Erfassen und Entfernen anormaler Messungen vor dem Schritt des Filterns von Unklarheiten (220).</claim-text></claim-text></claim><claim id="c-de-01-0003" num="0003"><claim-text>Verfahren nach Anspruch 1, wobei der Schritt des Bestimmens, ob der Ganzzahl-Unklarheiten-Vektorkandidat feste Kriterien erfüllt, die folgenden Schritte aufweist:
<claim-text>Berechnen eines Kontrastverhältnisses;</claim-text>
<claim-text>Vergleichen des Kontrastverhältnisses mit einem Schwellenwert;</claim-text>
<claim-text>Bestimmen, dass feste Kriterien erfüllt werden, wenn das Kontrastverhältnis größer oder gleich dem Schwellenwert ist; und</claim-text>
<claim-text>Bestimmen, dass die festen Kriterien nicht erfüllt werden, wenn das Kontrastverhältnis kleiner ist als der Schwellenwert.</claim-text></claim-text></claim><claim id="c-de-01-0004" num="0004"><claim-text>Verfahren nach Anspruch 1, wobei der Schritt des Filterns von Unklarheiten ferner die folgenden Schritte aufweist:
<claim-text>Auswählen eines bestimmten Satelliten aus der Vielzahl an Satelliten als Referenzsatellit; und</claim-text>
<claim-text>für jeden Nicht-Referenzsatelliten aus der Vielzahl an Satelliten:
<claim-text>Berechnen doppelter Differenzen benutzerdefinierter Variablen auf Basis der Werte der Variablen, die dem Nicht-Referenzsatelliten entsprechen, und der Werte der Variablen, die dem Referenzsatelliten entsprechen.</claim-text></claim-text><!-- EPO <DP n="70"> --></claim-text></claim><claim id="c-de-01-0005" num="0005"><claim-text>Verfahren nach Anspruch 4, ferner aufweisend den folgenden Schritt:
<claim-text>Bestimmen einer Zustandsänderung der Vielzahl an Satelliten von einer ersten Epoche zu einer zweiten Epoche.</claim-text></claim-text></claim><claim id="c-de-01-0006" num="0006"><claim-text>Verfahren nach Anspruch 5, wobei der Schritt des Bestimmens einer Zustandsänderung der Vielzahl an Satelliten von einer ersten Epoche zu einer zweiten Epoche die folgenden Schritte aufweist:
<claim-text>Bestimmen, ob ein neuer Referenzsatellit ausgewählt wurde;</claim-text>
<claim-text>Bestimmen, ob ein neuer Satellit aufgestiegen ist; und</claim-text>
<claim-text>Bestimmen, ob ein Satellit aus der Vielzahl an Satelliten untergegangen ist.</claim-text></claim-text></claim><claim id="c-de-01-0007" num="0007"><claim-text>Vorrichtung, die Mittel zum Durchführen des Verfahrens nach einem der Ansprüche 1 bis 6 aufweist.</claim-text></claim><claim id="c-de-01-0008" num="0008"><claim-text>Computerprogramm zum Nutzen eines Computers zum Durchführen des Verfahrens nach einem der Ansprüche 1 bis 6.</claim-text></claim><claim id="c-de-01-0009" num="0009"><claim-text>Computerlesbares Medium, auf dem das Computerprogramm nach Anspruch 8 gespeichert ist.</claim-text></claim></claims><claims mxw-id="PCLM56977872" lang="EN" load-source="patent-office"><!-- EPO <DP n="65"> --><claim id="c-en-01-0001" num="0001"><claim-text>A method for resolving ambiguities in a global navigation satellite system comprising a first navigation receiver located in a rover and a second navigation receiver located in a base station, the method comprising the steps of:
<claim-text>receiving a first plurality of measurements based on a first plurality of carrier signals received by the first navigation receiver from a plurality of global navigation satellites(201), the first plurality of measurements comprising a first plurality of pseudo-ranges and a first plurality of carrier phases;</claim-text>
<claim-text>receiving a second plurality of measurements based on a second plurality of carrier signals received by the second navigation receiver from the plurality of global navigation satellites(201), the second plurality of measurements comprising a second plurality of pseudo-ranges and a second plurality of carrier phases, each carrier signal in the second plurality of carrier signals corresponding to a carrier signal in the first plurality of carrier signals, and each measurement in the second plurality of measurements corresponding to a measurement in the first plurality of measurements;</claim-text>
<claim-text>calculating a plurality of single differences based on the first plurality of measurements and the second plurality of measurements(202);</claim-text>
<claim-text>linearizing the plurality of single differences (204);</claim-text>
<claim-text>determining an observation vector and an observation matrix based on the linearized single differences (206);</claim-text>
<claim-text>filtering ambiguities (222), wherein filtering ambiguities comprises;
<claim-text>generating a Cholessky information Kalman filter; and</claim-text>
<claim-text>performing a Householder transformation on the Cholessky information Kalman filter;</claim-text></claim-text>
<claim-text>estimating float ambiguities based on the filtered ambiguities (224);</claim-text>
<claim-text>determining an integer ambiguities vector candidate (226);</claim-text>
<claim-text>determining whether the integer ambiguities vector candidate meets fix criteria (230); and<!-- EPO <DP n="66"> --></claim-text>
<claim-text>in response to determining that the integer ambiguities vector candidate meets the fix criteria, generating an estimate of the integer ambiguities vector (211, 221).</claim-text></claim-text></claim><claim id="c-en-01-0002" num="0002"><claim-text>The method of claim 1, further comprising the step of:
<claim-text>detecting and removing anomalous measurements prior to the step of filtering ambiguities (220).</claim-text></claim-text></claim><claim id="c-en-01-0003" num="0003"><claim-text>The method of claim 1, wherein the step of determining whether the integer ambiguities vector candidate meets fix criteria comprises the steps of:
<claim-text>calculating a contrast ratio;</claim-text>
<claim-text>comparing the contrast ratio to a threshold value;</claim-text>
<claim-text>determining that fix criteria are met when the contrast ratio is greater than or equal to the threshold value; and</claim-text>
<claim-text>determining that the fix criteria are not met when the contrast ratio is less than the threshold value.</claim-text></claim-text></claim><claim id="c-en-01-0004" num="0004"><claim-text>The method of claim 1, wherein the step of filtering ambiguities further comprises the steps of:
<claim-text>selecting a particular satellite from the plurality of satellites as a reference satellite; and</claim-text>
<claim-text>for each non-reference satellite in the plurality of satellites:
<claim-text>calculating double differences of user-defined variables based on the values of the variables corresponding to the non-reference satellite and the values of the variables corresponding to the reference satellite.</claim-text></claim-text></claim-text></claim><claim id="c-en-01-0005" num="0005"><claim-text>The method of claim 4, further comprising the step of:
<claim-text>determining a change in state of the plurality of satellites from a first epoch to a second epoch.</claim-text><!-- EPO <DP n="67"> --></claim-text></claim><claim id="c-en-01-0006" num="0006"><claim-text>The method of claim 5, wherein the step of determining a change in state of the plurality of satellites from a first epoch to a second epoch comprises the steps of:
<claim-text>determining whether a new reference satellite has been selected;</claim-text>
<claim-text>determining whether a new satellite has risen; and</claim-text>
<claim-text>determining whether a satellite in the plurality of satellites has set.</claim-text></claim-text></claim><claim id="c-en-01-0007" num="0007"><claim-text>An apparatus comprising means for performing the method according to any one of the claims 1 to 6.</claim-text></claim><claim id="c-en-01-0008" num="0008"><claim-text>A computer program for instructing a computer for performing the method according to any one of the claims 1 to 6.</claim-text></claim><claim id="c-en-01-0009" num="0009"><claim-text>A computer readable medium storing the computer program according to claim 8.</claim-text></claim></claims><claims mxw-id="PCLM56977873" lang="FR" load-source="patent-office"><!-- EPO <DP n="71"> --><claim id="c-fr-01-0001" num="0001"><claim-text>Procédé pour résoudre des ambiguïtés dans un système global de navigation par satellite comprenant un premier récepteur de navigation situé dans une astromobile et un deuxième récepteur de navigation situé dans une station de base, le procédé comprenant les étapes suivantes :
<claim-text>la réception d'une première pluralité de mesures basées sur une première pluralité de signaux de porteuse reçus par le premier récepteur de navigation en provenance d'une pluralité de satellites de navigation globale (201), la première pluralité de mesures comprenant une première pluralité de pseudo-distances et une première pluralité de phases de porteuse ;</claim-text>
<claim-text>la réception d'une deuxième pluralité de mesures basées sur une deuxième pluralité de signaux de porteuse reçus par le deuxième récepteur de navigation en provenance de la pluralité de satellites de navigation globale (201), la deuxième pluralité de mesures comprenant une deuxième pluralité de pseudo-distances et une deuxième pluralité de phases de<!-- EPO <DP n="72"> --> porteuse, chaque signal porteur dans la deuxième pluralité de signaux de porteuse correspondant à un signal porteur dans la première pluralité de signaux de porteuse, et chaque mesure dans la deuxième pluralité de mesures correspondant à une mesure dans la première pluralité de mesures ;</claim-text>
<claim-text>le calcul d'une pluralité de différences individuelles sur la base de la première pluralité de mesures et la deuxième pluralité de mesures (202) ;</claim-text>
<claim-text>la linéarisation de la pluralité de différences individuelles (204) ;</claim-text>
<claim-text>la détermination d'un vecteur d'observation et d'une matrice d'observation sur la base des différences individuelles linéarisées (206) ;</claim-text>
<claim-text>le filtrage d'ambiguïtés (222), dans lequel le filtrage d'ambiguïtés comprend :
<claim-text>- la génération d'un filtre de Kalman d'informations de Cholesky ; et</claim-text>
<claim-text>- l'exécution d'une transformation de Propriétaire sur le filtre de Kalman d'informations de Cholesky ;</claim-text></claim-text>
<claim-text>l'estimation d'ambiguïtés flottantes sur la base des ambiguïtés filtrées (224) ;</claim-text>
<claim-text>la détermination d'un candidat de vecteur d'ambiguïtés entières (226) ;</claim-text>
<claim-text>la détermination du fait que le candidat de vecteur d'ambiguïtés entières remplisse des critères fixes (230) ; et</claim-text>
<claim-text>en réponse à la détermination du fait que le candidat de vecteur d'ambiguïtés entières remplisse les critères fixes, la génération d'une estimation du vecteur d'ambiguïtés entières (211, 221).</claim-text><!-- EPO <DP n="73"> --></claim-text></claim><claim id="c-fr-01-0002" num="0002"><claim-text>Procédé selon la revendication 1, comprenant en outre les étapes suivantes :
<claim-text>la détection et l'élimination de mesures anormales avant l'étape de filtrage d'ambiguïtés (220).</claim-text></claim-text></claim><claim id="c-fr-01-0003" num="0003"><claim-text>Procédé selon la revendication 1, dans lequel l'étape de détermination du fait que le candidat de vecteur d'ambiguïtés entières remplisse des critères fixes comprend les étapes suivantes :
<claim-text>le calcul d'un rapport de contraste ;</claim-text>
<claim-text>la comparaison du rapport de contraste à une valeur de seuil ;</claim-text>
<claim-text>la détermination du fait que des critères fixes soient remplis quand le rapport de contraste est supérieur ou égal à la valeur de seuil ; et</claim-text>
<claim-text>la détermination du fait que des critères fixes ne soient pas remplis quand le rapport de contraste est inférieur à la valeur de seuil.</claim-text></claim-text></claim><claim id="c-fr-01-0004" num="0004"><claim-text>Procédé selon la revendication 1, dans lequel l'étape de filtrage d'ambiguïtés comprend en outre les étapes suivantes :
<claim-text>la sélection d'un satellite particulier parmi la pluralité de satellites comme un satellite de référence ; et</claim-text>
<claim-text>pour chaque satellite non de référence dans la pluralité de satellites :
<claim-text>- le calcul de doubles différences de variables définies par l'utilisateur sur la base des valeurs des variables correspondant au satellite non de référence et des valeurs des variables correspondant au satellite de référence.</claim-text></claim-text><!-- EPO <DP n="74"> --></claim-text></claim><claim id="c-fr-01-0005" num="0005"><claim-text>Procédé selon la revendication 4, comprenant en outre les étapes suivantes :
<claim-text>la détermination d'un changement d'état de la pluralité de satellites d'une première époque à une deuxième époque.</claim-text></claim-text></claim><claim id="c-fr-01-0006" num="0006"><claim-text>Procédé selon la revendication 5, dans lequel l'étape de détermination d'un changement d'état de la pluralité de satellites d'une première époque à une deuxième époque comprend les étapes suivantes :
<claim-text>la détermination du fait qu'un nouveau satellite de référence ait été sélectionné ;</claim-text>
<claim-text>la détermination du fait qu'un nouveau satellite ait augmenté ; et</claim-text>
<claim-text>la détermination du fait qu'un satellite dans la pluralité de satellites se soit établi.</claim-text></claim-text></claim><claim id="c-fr-01-0007" num="0007"><claim-text>Dispositif comprenant des moyens pour exécuter le procédé selon l'une quelconque des revendications 1 à 6.</claim-text></claim><claim id="c-fr-01-0008" num="0008"><claim-text>Programme d'ordinateur pour donner instruction à un ordinateur d'exécuter le procédé selon l'une quelconque des revendications 1 à 6.</claim-text></claim><claim id="c-fr-01-0009" num="0009"><claim-text>Support lisible par ordinateur stockant le programme d'ordinateur selon la revendication 8.</claim-text></claim></claims><drawings mxw-id="PDW16668412" load-source="patent-office"><!-- EPO <DP n="75"> --><figure id="f0001" num="1"><img id="if0001" file="imgf0001.tif" wi="165" he="204" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="76"> --><figure id="f0002" num="2"><img id="if0002" file="imgf0002.tif" wi="165" he="206" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="77"> --><figure id="f0003" num="3"><img id="if0003" file="imgf0003.tif" wi="147" he="202" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="78"> --><figure id="f0004" num="4"><img id="if0004" file="imgf0004.tif" wi="136" he="233" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="79"> --><figure id="f0005" num="5"><img id="if0005" file="imgf0005.tif" wi="164" he="227" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="80"> --><figure id="f0006" num="6"><img id="if0006" file="imgf0006.tif" wi="126" he="216" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="81"> --><figure id="f0007" num="7"><img id="if0007" file="imgf0007.tif" wi="165" he="200" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="82"> --><figure id="f0008" num="8"><img id="if0008" file="imgf0008.tif" wi="145" he="195" img-content="drawing" img-format="tif"/></figure><!-- EPO <DP n="83"> --><figure id="f0009" num="9"><img id="if0009" file="imgf0009.tif" wi="165" he="219" img-content="drawing" img-format="tif"/></figure></drawings><copyright>User acknowledges that Fairview Research LLC and its third party providers retain all right, title and interest in and to this xml under applicable copyright laws.  User acquires no ownership rights to this xml including but not limited to its format.  User hereby accepts the terms and conditions of the Licence Agreement</copyright></patent-document>
